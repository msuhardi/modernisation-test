      *-----------------------*                                                 
       IDENTIFICATION DIVISION.                                                 
      *-----------------------*                                                 
       PROGRAM-ID.    BP13C657.                                                 
       AUTHOR.        RML.                                                      
      *DATE-WRITTEN.  31/05/93.                                                 
                                                                                
      * ============================================================== *        
      *                  SYSTEM OF COMMITMENT  (BP13)                  *        
      * ============================================================== *        
      *   OBJECTIVE   :  1.  THIS IS A PROGRAM TO PRINT OUT LETTERS    *        
      *                      TO INFORM APPLICANTS OF NOTICE TO         *        
      *                      EXECUTE THE AGREEMENT ORDER AND SALES     *        
      *                      AGREEMENT.                                *        
      *                                                                *        
      *   FOR SA-TP ¦ CA=N ¦ SALES-TYPE=10 ¦ SERS                      *        
      * ============================================================== *        
      *                                                                *        
      * CHGE-NO  BY    DATE   DESCRIPTION                              *        
      * -------- --- -------- -----------------------------------------*        
      * BP130415 RHB  19971204 NEW PROGRAM FOR SERS, CA-TAG = N.       *        
      * BP130415 LLW  19980103 ENABLE PRINTING OF HOUSEHOLD INCOME     *        
      *                        LETTER (BP1305) FOR SERS CASES.         *        
      * BP130415 LLW  19980105 USE 'BLANKF' TO REPLACE 'BP13B4' FOR    *        
      *                        PRINTING BLANK FORM IN PORTRAIT FORMAT  *        
      * BP130480 SGK  19980418 TO REFLECT AB03K050 KEY & SIZE CHANGES. *        
      * BP130454 SGK  19980424 TO WRITE COPY OF APPOINTMENT LETTER INTO*        
      *                        P13L657B (FOR SER CASE ONLY) &          *        
      *                        TO WRITE SKIPPED CASES INTO P13L657C    *        
      * BP130418 SGK  19980916 TO CATER FOR Y2K.                       *        
      * BP130636 JMS  19990212 TO CATER FOR TC RECOVERY AMOUNT         *        
      * BP130454 JMS  19990415 TO CATER FOR PRINTING OF SERS LETTERS.  *        
      * BP130669 JMS  19990602 TO INCLUDE SALES-TYPE-SURVEY            *        
      * BP130669 JMS  19990602 TO CATER FOR PRINTING OF STD TAG        *        
      *                        ACCORDING TO THE SALES TYPE             *        
      * BP130885 RAS  20000626 TO CHANGE BP13C902 TO BP13C903          *        
      * BP130952 CLT  20001212 TO CATER FOR RED CASES AND COMPUTE      *        
      *                        STAMP FEES WITH OCS TAG = 'N'(SERS)     *        
      * BP130952 MCC  20001219 TO PUT * FOR OFFER SELLING PRICE        *        
      * BP130998 clt  20010502 ENHANCE AB20C900 FOR SA FLAT            *        
      * BP131036 RAS  20010614 TO CATER FOR ALLOC CODES: SFC & SRC     *        
      * BP132037 CKK  20011016 TO REDUCE 30% IN STAMP FEE DUE TO       *        
      *                        2001 OFF-BUDGET MEASURE                 *        
      * BP132097 MALC 20020214 TO CATER FOR MARRIED CHILD PRIO SCHEME  *        
      * BP132125 MCC  20020407 ROUNDING OF ODD CENTS                   *        
      * BP132095 CKK  20020422 TO PRINT BARCODE FOR QMS AND TO REMOVE  *        
      *                        PRINTING OF JUNK-MAIL LETTER            *        
      * BP132127 CKK  13052002 CHANGE LETTER LAYOUT DUE TO RELOCATION  *        
      * BP132160 AS1  27062002 MOVE THE BAR CODE FROM TOP TO BOTTOM    *        
      * BP132237 MALC 28102002 TO RESTORE ORIGINAL FEES AND TO SHOW    *        
      *                        30% OFF-BUDGET DISC IN BRACKET          *        
      * BP132263 MALC 14112002 TO REMOVE 30% OFF-BUDGET DISC           *        
      *                        & TO CATER FOR CHANGE OF GST            *        
      * BP132352 CKK7 12062003 TO READ K022 AND K024                   *        
      * BP132352 SK   07062003 TO REMOVE PRINTING HP NUMBER            *        
      * BP132399 MALC 15082003 CALL BP13C904 TO GET CD PERCENTAGE      *        
      * BP132429 MALC 14112003 TO HARDCODE 5% GST                      *        
      * BP132485 MJ16 02032004 TO INCLUDE CHECKING OF SERS TABLE       *        
      *                        TO SERS INCLUDE 3 NEW ALLOC SCHEMES     *        
      *                        TABLE.('SFO','SRO','SJO')               *        
      * BP132554 JF4  07072004 PRINT BO/TC/CC CODE IN APPT LETTER      *        
      * BP132563 JF4  08072004 CATER FOR MARKET INTEREST RATE FOR CA=N *        
      *                        AND ALLOC-CDE SSP, SPO, SPP, SPS OR SRP *        
      * BP132568 JF4  22072004 CATER FOR ENHANCEMENT OF APPT LETTER    *        
      * BP132588 JF4  24082004 PASS SYSTEM DATE TO AB20C900 PROGRAM    *        
      * BP132660 JF4  15032005 CATER FOR OCS OPT-IN                    *        
      * BP135109 JGO1 24122013 REMOVE HARDCODE OF HDBSALES EMAIL       *        
      * BP139485 KAC1 02012024 TO CALL BP13C90D FOR 9 % GST RATE       *        
      *                        WEF 20240101                            *        
      * ============================================================== *        
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F310  ASSIGN       TO BP13F310.                           
                                                                                
           SELECT BP13K022  ASSIGN       TO BP13K022                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K022-KEY-FLD                        
                            ALTERNATE RECORD KEY IS K022-NUM-REGN               
                            WITH DUPLICATES                                     
                            FILE STATUS  IS BP13K022-STATUS.                    
                                                                                
           SELECT BP13K024  ASSIGN       TO BP13K024                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K024-KEY-FLD                        
                            FILE STATUS  IS BP13K024-STATUS.                    
                                                                                
           SELECT BP13K800  ASSIGN       TO BP13K800                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K800-NUM-REGN                       
                            FILE STATUS  IS BP13K800-STATUS.                    
                                                                                
           SELECT BP13K820  ASSIGN       TO BP13K820                            
                            ACCESS MODE  IS DYNAMIC                             
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K820-KEY-FLD                        
                            FILE STATUS  IS BP13K820-STATUS.                    
                                                                                
           SELECT BP13K830  ASSIGN       TO BP13K830                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K830-KEY-FLD                        
                            ALTERNATE RECORD KEY IS K830-NUM-REGN               
                            FILE STATUS  IS BP13K830-STATUS.                    
                                                                                
           SELECT BM06K110  ASSIGN       TO BM06K110                            
                            ACCESS  MODE IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD   KEY IS K110-KEY-FLD                        
                            FILE STATUS  IS BM06K110-STATUS.                    
                                                                                
           SELECT BM06K100  ASSIGN       TO BM06K100                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K100-KEY-FLD                        
                            FILE STATUS  IS BM06K100-STATUS.                    
                                                                                
           SELECT AB03K050  ASSIGN       TO AB03K050                            
                            ACCESS MODE  IS DYNAMIC                             
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K050-KEY                            
                            FILE STATUS  IS AB03K050-STATUS.                    
                                                                                
                                                                                
           SELECT P13L657B  ASSIGN       TO P13L657B.                           
           SELECT P13L657C  ASSIGN       TO P13L657C.                           
           SELECT P13L657D  ASSIGN       TO P13L657D.                           
                                                                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD   BP13F310                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 150 CHARACTERS.                                     
       COPY BP13F310.                                                           
                                                                                
       FD   BP13K022                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K022.                                                           
                                                                                
       FD   BP13K024                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K024.                                                           
                                                                                
       FD   BM06K100                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K100.                                                           
                                                                                
       FD   BM06K110                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K110.                                                           
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD   BP13K830                                                            
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD   AB03K050                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY AB03K050.                                                           
                                                                                
       FD  P13L657B                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 80  CHARACTERS.                                      
       01  L657B-PRINT-REC                  PIC X(80).                          
                                                                                
       FD  P13L657C                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 80  CHARACTERS.                                      
       01  P13L657C-REC                     PIC X(80).                          
                                                                                
       FD  P13L657D                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132 CHARACTERS.                                      
       01  PRINT-REC2                       PIC X(132).                         
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       COPY SERSCH.                                                             
       COPY AB20M97C.                                                           
       COPY P13COMCD.                                                           
                                                                                
       01  WS-C908-PARAMETERS.                                                  
           05  WS-INPUT-PARAMETERS.                                             
               10  WS-C908-TXT-IN-SIZE       PIC 9(2).                          
               10  WS-C908-TXT-INPUT         PIC X(30).                         
           05  WS-OUTPUT-PARAMETERS.                                            
               10  WS-C908-TXT-OUT-SIZE      PIC 9(2).                          
               10  WS-C908-TXT-OUTPUT        PIC X(40).                         
           05  WS-C908-RETCODE               PIC S9(04)  COMP.                  
                                                                                
       01  WS-INDICATORS.                                                       
           05  BP13K022-STATUS              PIC 99    VALUE ZEROS.              
           05  BP13K024-STATUS              PIC 99    VALUE ZEROS.              
           05  BP13K800-STATUS              PIC 99    VALUE ZEROS.              
           05  BP13K820-STATUS              PIC 99    VALUE ZEROS.              
           05  BP13K830-STATUS              PIC 99    VALUE ZEROS.              
           05  BM06K100-STATUS              PIC 99    VALUE ZEROS.              
           05  BM06K110-STATUS              PIC 99    VALUE ZEROS.              
           05  AB03K050-STATUS              PIC 99    VALUE ZEROS.              
           05  WS-F310-EOF                  PIC X     VALUE 'N'.                
           05  WS-K050-EOF                  PIC X     VALUE 'N'.                
           05  WS-K820-EOF                  PIC X     VALUE 'N'.                
           05  K110-NOT-FOUND               PIC X     VALUE 'N'.                
           05  K800-NOT-FOUND               PIC X     VALUE 'N'.                
           05  K820-NOT-FOUND               PIC X     VALUE 'N'.                
           05  K830-NOT-FOUND               PIC X     VALUE 'N'.                
           05  K022-FOUND                   PIC X     VALUE 'N'.                
           05  K024-FOUND                   PIC X     VALUE 'N'.                
           05  WS-FIRST-CASE                PIC X     VALUE 'Y'.                
           05  WS-NUM-OIC                   PIC X(5).                           
           05  WS-OIC-TABLE.                                                    
               10 WS-OIC-TAB OCCURS 5 TIMES PIC X.                              
           05  WS-OIC-EMAIL-TABLE.                                              
               10 WS-OIC-EMAIL-TAB OCCURS 5 TIMES PIC X.                        
                                                                                
       01  WS-AB03K050-REC                  PIC X(200) VALUE SPACES.            
       01  WS-K050-CDE-LOAN-SCH             PIC X      VALUE SPACES.            
       01  WS-COUNTERS.                                                         
           05  WS-CNT-F310                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CNT-K110                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CNT-K820                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CNT-K830                  PIC 9(3)  VALUE ZEROS.              
           05  WS-PAGE-NO                   PIC 9(4)  VALUE ZEROS.              
           05  WS-CNT                       PIC 9(2)  VALUE ZEROS.              
           05  WS-SEQ-NO                    PIC 9(4)  VALUE ZEROS.              
           05  WS-CNT-PROC                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CNT-LETTERS               PIC 9(3)  VALUE ZEROS.              
           05  WS-PRINT-LETTERS             PIC X(1)  VALUE SPACE.              
           05  WS-CNT-SKIPPED               PIC 9(3)  VALUE ZERO.               
           05  WS-CNT-K022                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CNT-K024                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CTR                       PIC 9     VALUE ZEROS.              
           05  WS-CTR2                      PIC 9     VALUE ZEROS.              
                                                                                
       01  WS-OTHER-VARIABLES.                                                  
           05  WS-NAME                      PIC X(66) VALUE SPACES.             
           05  WS-EMAIL                     PIC X(19)  VALUE SPACES.            
           05  WS-HDR-PHONE-DID             PIC X(25)  VALUE SPACES.            
                                                                                
           05  WS-K820-KEY.                                                     
               10  WS-K820-REGN             PIC X(8)  VALUE SPACES.             
               10  FILLER                   PIC X(9)  VALUE SPACES.             
                                                                                
           05  WS-ACC.                                                          
               10  WS-ACCOUNT               PIC X(4)  VALUE SPACES.             
               10  WS-CDG                   PIC X(1)  VALUE SPACE.              
                                                                                
           05  WS-NUM-FIELD.                                                    
               10  WS-REM                   PIC 9(3)  VALUE ZEROES.             
               10  WS-YEAR                  PIC 9(4)  VALUE ZEROES.             
               10  WS-IN-DATE               PIC 9(8)  VALUE ZEROES.             
               10  WS-SC-CC1-AMT            PIC 9(5)V99     VALUE ZEROS.        
               10  WS-SC-CC2-AMT            PIC 9(5)V99     VALUE ZEROS.        
               10  WS-S903-SC-CC1-GST       PIC 9(4)V99     VALUE ZEROS.        
               10  WS-S903-SC-CC2-GST       PIC 9(4)V99     VALUE ZEROS.        
               10  WS-S903-SC-CC3-GST       PIC 9(4)V99     VALUE ZEROS.        
               10  WS-S903-SC-TC1-GST       PIC 9(4)V99     VALUE ZEROS.        
               10  WS-S903-SC-TC2-GST       PIC 9(4)V99     VALUE ZEROS.        
               10  WS-S903-SC-TC3-GST       PIC 9(4)V99     VALUE ZEROS.        
               10  WS-SC-CC-NUM-AMT         PIC 9(4)V99     VALUE ZEROS.        
               10  WS-SC-CC-NUM-AMT-GST     PIC 9(4)V99     VALUE ZEROS.        
                                                                                
           05  WS-SUB-UNIT.                                                     
               10  FILLER                   PIC X     VALUE '-'.                
               10  SUB-UNIT-NO              PIC X(3)  VALUE ZEROES.             
                                                                                
           05  WS-SC-CC-DESC.                                                   
               10  FILLER                   PIC X(1)   VALUE '('.               
               10  WS-SC-CC-AMT             PIC ZZ9.99 VALUE SPACES.            
               10  FILLER                   PIC X(1)   VALUE '+'.               
               10  WS-SC-CC-AMT-GST         PIC   9.99 VALUE SPACES.            
               10  FILLER                   PIC X(3)   VALUE 'GST'.             
               10  WS-SC-CC-SIGN            PIC X(1)   VALUE '-'.               
               10  WS-SC-CC-REBATE-AMT      PIC   Z.ZZ VALUE SPACES.            
               10  WS-SC-CC-REBATE-DESC     PIC X(3)   VALUE 'REB'.             
               10  WS-SC-CC-SIGN2           PIC X(1)   VALUE '-'.               
               10  WS-SC-CC-GRANT-AMT       PIC   Z.ZZ VALUE SPACES.            
               10  WS-SC-CC-GRANT-DESC      PIC X(3)   VALUE 'GRT'.             
               10  WS-SC-CC-SIGN3           PIC X(1)   VALUE '-'.               
               10  WS-SC-CC-REB-SP-AMT      PIC   Z.ZZ VALUE SPACES.            
               10  WS-SC-CC-REB-SP-DESC     PIC X(3)   VALUE 'SP)'.             
                                                                                
           05  WS-SKIP-PR-LINE              PIC 9(2)     VALUE 60.              
           05  WS-SKIP-PAGE-NO              PIC 9(3)     VALUE ZERO.            
                                                                                
           05  WS-K110-CSPRICE              PIC 9(8)     VALUE ZEROES.          
           05  WS-K110-OFFER                PIC 9(8)     VALUE ZEROES.          
           05  WS-COMP-SELLPR               PIC S9(8)V99  VALUE ZEROES.         
           05  WS-COMP-LS-FEE               PIC S9(8)V99  VALUE ZEROES.         
           05  WS-COMP-CV-FEE               PIC S9(8)V99  VALUE ZEROES.         
           05  WS-COMP-TOTAL                PIC S9(8)V99  VALUE ZEROES.         
           05  WS-LS-LEAVE                  PIC S9(8)V99  VALUE ZEROES.         
           05  WS-CONV-LEAVE                PIC S9(8)V99  VALUE ZEROES.         
           05  WS-ROUND-CONVFEE             PIC S9(8)V99  VALUE ZEROES.         
           05  WS-TOTAL-SELLPR              PIC S9(8)V99  VALUE ZEROES.         
           05  WS-BALANCE-AMT               PIC S9(8)V99  VALUE ZEROES.         
           05  WS-MAX-LOAN-AMT              PIC S9(7)V99  VALUE ZEROES.         
           05  WS-TOTAL-CD                  PIC S9(7)V99  VALUE ZEROES.         
           05  WS-TOTAL-FEES                PIC S9(6)V99  VALUE ZEROES.         
           05  WS-COMP-SURVEY-FEE           PIC S9(5)V99  VALUE ZEROES.         
           05  WS-COMP-LEASE                PIC S9(5)V99  VALUE ZEROES.         
           05  WS-COMP-MORTGAGE             PIC S9(5)V99  VALUE ZEROES.         
           05  WS-TOT-STAMP-FEE             PIC S9(5)V99  VALUE ZEROES.         
           05  WS-MORT-STAMP-FEE            PIC S9(5)V99  VALUE ZEROES.         
           05  WS-TOT-SCCC                  PIC S9(5)V99  VALUE ZEROES.         
           05  WS-INTREST-RATE              PIC 9(2)V99  VALUE ZEROES.          
           05  WS-MTHLY-INSTAL              PIC 9(5)V99  VALUE ZEROES.          
           05  WS-LOAN-ROUND-DOWN.                                              
               10  WS-LOAN-INT-5            PIC 9(5)    VALUE ZEROS.            
               10  WS-LOAN-INT-2            PIC 9(2)V99 VALUE ZEROS.            
                                                                                
           05  WS-EDT-OFFER-PRICE           PIC $,$$$,$$9.                      
           05  WS-EDT-OCS-AMT               PIC $$$9.                           
           05  WS-OSP-OCP-AMT               PIC 9(08).                          
           05  WS-SELL-PRICE                PIC 9(08).                          
           05  WS-PODF-AMT                  PIC 9(06)   VALUE ZEROS.            
           05  WS-EDT-PODF-AMT              PIC $$$$9.                          
           05  WS-NUM-OPT-IN                PIC X(1)    VALUE SPACE.            
                                                                                
           05  WS-COMPUTE-DATE.                                                 
               10  WS-COMPUTE-YYYY      PIC 9(4)   VALUE ZEROS.                 
               10  WS-COMPUTE-MM        PIC 99     VALUE ZEROS.                 
               10  WS-COMPUTE-DD        PIC 99     VALUE ZEROS.                 
                                                                                
       01 WS-SERS-VARIABLES.                                                    
          05 WS-ALLOC-SCH               PIC X(03).                              
          05 WS-SCH-FND                 PIC X(01).                              
                                                                                
      *****LAY OUT FOR  SKIPPED CASES                                           
       01 L657C-HEADER-1.                                                       
          05   FILLER                   PIC X(15)    VALUE SPACES.              
          05   FILLER                   PIC X(50)    VALUE                      
                  'LIST OF SA-TP LETTER (CA = Y/E) SKIPPED CASES'.              
          05   FILLER                   PIC X(15)    VALUE SPACES.              
                                                                                
       01 L657C-HEADER-2.                                                       
          05   FILLER                   PIC X(01)    VALUE SPACES.              
          05   FILLER                   PIC X(08)    VALUE 'P13L657C'.          
          05   FILLER                   PIC X(10)    VALUE SPACES.              
          05   FILLER                   PIC X(08)    VALUE 'DATE : '.           
          05   L657C-PRT-DATE           PIC X(10)    VALUE SPACES.              
          05   FILLER                   PIC X(33)    VALUE SPACES.              
          05   FILLER                   PIC X(06)    VALUE 'PAGE: '.            
          05   L657C-PAGE-NO            PIC ZZ99.                               
                                                                                
       01 L657C-HEADER-3.                                                       
          05   FILLER                   PIC X(08)  VALUE 'REGN NO.'.            
          05   FILLER                   PIC X(02)  VALUE SPACES.                
          05   FILLER                   PIC X(12)  VALUE 'REPAY.PERIOD'.        
          05   FILLER                   PIC X(02)  VALUE SPACES.                
          05   FILLER                   PIC X(12)  VALUE 'INTR.FACTOR '.        
          05   FILLER                   PIC X(02)  VALUE SPACES.                
          05   FILLER                   PIC X(12)  VALUE 'INTEREST    '.        
          05   FILLER                   PIC X(01)  VALUE SPACES.                
          05   FILLER                   PIC X(12)  VALUE 'REMARKS     '.        
                                                                                
       01 L657C-DETAIL.                                                         
          05   L657C-REGN-NO            PIC X(08)  VALUE SPACES.                
          05   FILLER                   PIC X(07)  VALUE SPACES.                
          05   L657C-REPAY-PD           PIC Z9.                                 
          05   FILLER                   PIC X(12)  VALUE SPACES.                
          05   L657C-FAC                PIC 99     VALUE ZERO.                  
          05   FILLER                   PIC X(10)  VALUE SPACES.                
          05   L657C-INT                PIC Z9.99.                              
          05   FILLER                   PIC X(05)  VALUE SPACES.                
          05   L657C-REMARK             PIC X(29)  VALUE SPACES.                
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED  TO SUB-PROGRAM "BP13C901"         *             
      *-----------------------------------------------------------*             
       01  WS-LINK-S901.                                                        
           05  WS-S901-INT                 PIC 9V9(4)   VALUE ZEROES.           
           05  WS-S901-FAC                 PIC 9(2)     VALUE ZEROES.           
           05  WS-S901-ERL                 PIC X        VALUE SPACE.            
           05  WS-S901-LOAN-AMT            PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S901-ERL-LOAN-AMT        PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S901-REPAY-PD            PIC 99       VALUE ZEROES.           
           05  WS-S901-RM                  PIC X(2)     VALUE SPACES.           
           05  WS-S901-DESIGN              PIC X(3)     VALUE SPACES.           
           05  FILLER                      PIC X(1)     VALUE SPACE.            
           05  WS-S901-MTH-INSTAL          PIC S9(5)V99 VALUE +0.               
           05  WS-S901-SUB-INSTAL          PIC S9(5)V99 VALUE +0.               
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABELS PASSED  TO SUB-PROGRAM "BP13C905"         *             
      *-----------------------------------------------------------*             
       01  WS-LINK-S905.                                                        
           05  WS-S905-SC-CC1              PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S905-SC-CC2              PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S905-SC-CC3              PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S905-SC-TOTAL-AMT        PIC 9(7)V99  VALUE ZEROES.           
                                                                                
       01  WS-DATE-VARIABLES.                                                   
           05  WS-DTE.                                                          
               10  WS-DTE-YYYY              PIC X(4)  VALUE SPACES.             
               10  WS-DTE-MM                PIC X(2)  VALUE SPACES.             
               10  WS-DTE-DD                PIC X(2)  VALUE SPACES.             
                                                                                
           05  WS-DTE-EXPIRED-TP.                                               
               10  WS-DTE-EXPIRED-TP-DD     PIC X(2)  VALUE SPACES.             
               10  WS-SLASH1                PIC X     VALUE SPACE.              
               10  WS-DTE-EXPIRED-TP-MM     PIC X(2)  VALUE SPACES.             
               10  WS-SLASH2                PIC X     VALUE SPACE.              
               10  WS-DTE-EXPIRED-TP-YYYY   PIC X(4)  VALUE SPACES.             
                                                                                
           05  WS-ACCEPTANCE-DATE.                                              
               10  WS-ACCEPTANCE-YYYY       PIC 9(4)  VALUE 00.                 
               10  WS-ACCEPTANCE-MM         PIC 9(2)  VALUE 00.                 
               10  WS-ACCEPTANCE-DD         PIC 9(2)  VALUE 00.                 
                                                                                
           05  WS-CUR-YYYYMMDD.                                                 
               10  WS-CUR-YYYY              PIC 9(4)  VALUE 00.                 
               10  WS-CUR-MM                PIC 99    VALUE 00.                 
               10  WS-CUR-DD                PIC 9(2)  VALUE 00.                 
                                                                                
           05  WS-EDITED-DATE.                                                  
               10  WS-EDIT-DD               PIC X(2)  VALUE SPACES.             
               10  FILLER                   PIC X     VALUE '/'.                
               10  WS-EDIT-MM               PIC XX    VALUE SPACES.             
               10  FILLER                   PIC X     VALUE '/'.                
               10  WS-EDIT-YYYY             PIC X(4)  VALUE SPACES.             
                                                                                
           05  WS-CURRENT-DATE.                                                 
               10  WS-CURRENT-DD            PIC 99    VALUE 00.                 
               10  FILLER                   PIC X     VALUE '/'.                
               10  WS-CURRENT-MM            PIC 99    VALUE 00.                 
               10  FILLER                   PIC X     VALUE '/'.                
               10  WS-CURRENT-YYYY          PIC 9(4)  VALUE 00.                 
                                                                                
           05  WS-CURR-DATE.                                                    
                   15  WS-YYYY              PIC 9(4)  VALUE 00.                 
                   15  WS-MM                PIC 9(2)  VALUE 00.                 
                   15  WS-DD                PIC 9(2)  VALUE 00.                 
                                                                                
           05  WS-EXPIRY-DATE.                                                  
                   15  WS-EXPIRY-YYYY       PIC 9(4)  VALUE 00.                 
                   15  WS-EXPIRY-MM         PIC 9(2)  VALUE 00.                 
                   15  WS-EXPIRY-DD         PIC 9(2)  VALUE 00.                 
                                                                                
           05  WS-DTE-OPT-EXP.                                                  
               10  WS-DTE-OPT-YYYY          PIC X(4)  VALUE SPACES.             
               10  WS-DTE-OPT-MM            PIC X(2)  VALUE SPACES.             
               10  WS-DTE-OPT-DD            PIC X(2)  VALUE SPACES.             
                                                                                
           05  WS-DTE-OCS.                                                      
               10  WS-DTE-OCS-YYYY          PIC X(4)  VALUE SPACES.             
               10  WS-DTE-OCS-MM            PIC X(2)  VALUE SPACES.             
               10  WS-DTE-OCS-DD            PIC X(2)  VALUE SPACES.             
                                                                                
           05  WS-DTE-WEF.                                                      
               10  WS-WEF-YYYY              PIC X(4)  VALUE SPACES.             
               10  FILLER                   PIC X(1)  VALUE SPACE.              
               10  WS-WEF-MM                PIC X(2)  VALUE SPACES.             
               10  FILLER                   PIC X(1)  VALUE SPACE.              
               10  WS-WEF-DD                PIC X(2)  VALUE SPACES.             
                                                                                
           05  WS-DTE-SCCC.                                                     
               10  WS-SCCC-DD               PIC X(2)  VALUE SPACES.             
               10  FILLER                   PIC X     VALUE '/'.                
               10  WS-SCCC-MM               PIC X(2)  VALUE SPACES.             
               10  FILLER                   PIC X     VALUE '/'.                
               10  WS-SCCC-YYYY             PIC X(4)  VALUE SPACES.             
                                                                                
                                                                                
       01  DATE-REC.                                                            
           05  CAL-DATE.                                                        
               10  CAL-YEAR                 PIC 9(4).                           
                   88  VALID-YEAR               VALUE 1900 THRU 2100.           
               10  CAL-MONTH                PIC 9(2).                           
                   88  31-DAY-MONTH             VALUE 01, 03, 05, 07,           
                                                      08, 10, 12.               
                   88  30-DAY-MONTH             VALUE 04, 06, 09, 11.           
                   88  28-29-DAY-MONTH          VALUE 02.                       
                   88  VALID-MONTH              VALUE 01 THRU 12.               
               10  CAL-DAY                  PIC 9(2).                           
                   88  VALID-DAY                VALUE 01 THRU 31.               
                                                                                
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED TO SUB-PROGRAM "BP13C903"          *             
      *-----------------------------------------------------------*             
       01  WS-LINK-S903.                                                        
           05  WS-S903-NUM-SCH-ACC          PIC X(9)     VALUE SPACES.          
           05  WS-S903-SO-EFF-DATE.                                             
               10  WS-S903-SO-EFF-CC        PIC 9(2)     VALUE ZEROES.          
               10  WS-S903-SO-EFF-YYMMDD    PIC 9(6)     VALUE ZEROES.          
           05  WS-S903-DESIGN-TY            PIC X(3)     VALUE SPACES.          
           05  WS-S903-ROOM-TY              PIC X(2)     VALUE SPACES.          
           05  WS-S903-SC-CC1               PIC 9(6)V99  VALUE ZEROES.          
           05  WS-S903-SC-CC2               PIC 9(6)V99  VALUE ZEROES.          
           05  WS-S903-SC-CC3               PIC 9(6)V99  VALUE ZEROES.          
           05  WS-S903-SC-TOTAL-AMT         PIC 9(7)V99  VALUE ZEROES.          
           05  WS-S903-SC-REBATE1           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REBATE2           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REBATE3           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-GRANT1            PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-GRANT2            PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-GRANT3            PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REC-TC1           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REC-TC2           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REC-TC3           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REB-SP1           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REB-SP2           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REB-SP3           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-CURR-EFF-DATE     PIC X(10)    VALUE SPACES.          
           05  WS-S903-SC-NEXT-EFF-DATE     PIC X(10)    VALUE SPACES.          
           05  WS-S903-RET-CODE             PIC X(2)     VALUE SPACES.          
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED TO SUB-PROGRAM "AV02C021"          *             
      *-----------------------------------------------------------*             
       COPY P13GST01.                                                           
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED TO SUB-PROGRAM "BP13C90B"          *             
      *-----------------------------------------------------------*             
       COPY P13GST02.                                                           
                                                                                
      *------------------------*                                                
      *  LINKAGE FOR AV02C015  *                                                
      *------------------------*                                                
       01  WS-LINK-AV02C015.                                                    
           05  AV02C015-IN-POSTCODE         PIC X(6).                           
           05  AV02C015-OUT-POSTCODE-CHKSUM PIC X(9).                           
                                                                                
       01  BLANK-LINE                       PIC X(80) VALUE SPACES.             
                                                                                
      *-----------------------------------------------------------*             
      *    WS PRINT LAY-OUT FOR LETTERS  (BP1336)                 *             
      *-----------------------------------------------------------*             
                                                                                
       01  L657-LINE-OIC.                                                       
           05  FILLER                     PIC X(10)  VALUE SPACES.              
           05  L657-OIC-NAME              PIC X(30)  VALUE SPACES.              
           05  FILLER                     PIC X(26)  VALUE SPACES.              
                                                                                
       01  L657-LINE-OIC1.                                                      
           05  FILLER                     PIC X(10)  VALUE SPACES.              
           05  L657-OIC-DESG              PIC X(24)  VALUE SPACES.              
           05  FILLER                     PIC X(32)  VALUE SPACES.              
                                                                                
       01  L657-LINE-BARCODE.                                                   
           05  FILLER                     PIC X(66)  VALUE SPACES.              
           05  L657-BARCODE-REGN          PIC X(13)  VALUE SPACES.              
                                                                                
       01  L657-LINE-BARCODE1.                                                  
           05  FILLER                     PIC X(82)  VALUE SPACES.              
           05  L657-BARCODE1-PREFIX       PIC X(2)   VALUE SPACES.              
           05  L657-BARCODE1-REGN         PIC X(8)   VALUE SPACES.              
                                                                                
       01  L657-PR-LINE-0.                                                      
           05  FILLER                     PIC X(28)  VALUE SPACES.              
           05  L657-BOTCCC.                                                     
               10  L657-BO                PIC X(2)   VALUE SPACES.              
               10  L657-SLASH1            PIC X      VALUE SPACE.               
               10  L657-TC                PIC X(2)   VALUE SPACES.              
               10  L657-SLASH2            PIC X      VALUE SPACE.               
               10  L657-CC                PIC X(2)   VALUE SPACES.              
           05  FILLER                     PIC X(35)  VALUE SPACES.              
                                                                                
       01  L657-PR-LINE-1A.                                                     
           05  FILLER                     PIC X(28)  VALUE SPACES.              
           05  L657-CDE-NT                PIC X(3)   VALUE 'XX'.                
           05  FILLER                     PIC X(1)   VALUE '/'.                 
           05  L657-RECOM-ROOM-TYPE       PIC X(2)   VALUE 'X'.                 
           05  FILLER                     PIC X(1)   VALUE '/'.                 
           05  L657-REGN-NO               PIC X(8)   VALUE 'XXXXXXX '.          
           05  FILLER                     PIC X(3)   VALUE '  ('.               
           05  L657-ALLOCATION-SCHEME     PIC X(3)   VALUE SPACES.              
           05  FILLER                     PIC X(1)   VALUE ')'.                 
                                                                                
       01  L657-PR-LINE-2.                                                      
           05  FILLER                     PIC X(28)  VALUE SPACES.              
           05  L657-SCHEME                PIC X(4)   VALUE 'XXXX'.              
           05  D1                         PIC X      VALUE '-'.                 
           05  L657-ACC                   PIC X(4)   VALUE 'XXXX'.              
           05  D2                         PIC X      VALUE '-'.                 
           05  L657-CDG                   PIC X      VALUE 'X'.                 
           05  D3                         PIC X      VALUE '-'.                 
           05  L657-ACC-TYPE              PIC X(2)   VALUE 'XX'.                
           05  FILLER                     PIC X(35)  VALUE SPACES.              
           05  L657-HDR-PHONE-DID         PIC X(24)  VALUE SPACES.              
                                                                                
       01  L657-PR-LINE-3.                                                      
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L657-APPL-NAME             PIC X(66)  VALUE SPACES.              
           05  FILLER                     PIC X(8)   VALUE SPACES.              
           05  L657-EMAIL                 PIC X(19)  VALUE SPACES.              
                                                                                
       01  L657-PR-LINE-4.                                                      
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L657-COAPPL-NAME           PIC X(66)  VALUE SPACES.              
                                                                                
       01  L657-PR-LINE-4A.                                                     
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L657-THIRD-NAME            PIC X(66)  VALUE SPACES.              
                                                                                
       01  L657-PR-LINE-4B.                                                     
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L657-FOURTH-NAME           PIC X(66)  VALUE SPACES.              
                                                                                
       01  L657-PR-LINE-5.                                                      
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L657-BLKNO                 PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(2)   VALUE SPACES.              
           05  L657-NUM-FLAT.                                                   
               10  L657-CHAR              PIC X      VALUE SPACE.               
               10  L657-LEVEL             PIC X(2)   VALUE SPACES.              
               10  L657-DASH              PIC X      VALUE SPACE.               
               10  L657-HSE-MAIN          PIC X(4)   VALUE SPACES.              
               10  L657-HSE-SUB           PIC X(3)   VALUE SPACES.              
                                                                                
       01  L657-PR-LINE-6.                                                      
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L657-STREET-NAME           PIC X(65)  VALUE SPACES.              
                                                                                
       01  L657-PR-LINE-7.                                                      
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L657-POST-CODE             PIC X(16)  VALUE SPACES.              
           05  L657-DOT                   PIC X(1)   VALUE SPACE.               
                                                                                
       01  L657-PR-LINE-7A.                                                     
           05  FILLER                     PIC X(77)  VALUE SPACES.              
           05  PRINT-DATE                 PIC X(10)  VALUE 'XX/XX/XX'.          
                                                                                
       01  L657-PR-LINE-7B.                                                     
           05  FILLER                     PIC X(10)  VALUE SPACES.              
           05  L657-BAR-CODE              PIC X(09)  VALUE SPACES.              
                                                                                
       01  L657-PR-LINE-8.                                                      
           05  FILLER                     PIC X(18)  VALUE SPACES.              
           05  L657-BLK-NO                PIC X(5)   VALUE ' XXX'.              
           05  FILLER                     PIC X(2)   VALUE SPACES.              
           05  FILLER                     PIC X(1)   VALUE '#'.                 
           05  L657-LEVEL-NO              PIC X(2)   VALUE SPACES.              
           05  FILLER                     PIC X      VALUE '-'.                 
           05  L657-MAIN-UNIT             PIC X(5)   VALUE SPACES.              
           05  FILLER                     PIC X(2)   VALUE SPACES.              
           05  L657-ST-NAME               PIC X(20)  VALUE SPACES.              
           05  FILLER                     PIC X(2)   VALUE SPACES.              
           05  L657-COUNTRY-POSTCDE       PIC X(17)  VALUE 'SINGAPORE '.        
                                                                                
       01  L657-PR-LINE-9.                                                      
           05  FILLER                     PIC X(26)  VALUE SPACES.              
           05  L657-CURR-SELL-PR          PIC $$$,$$$,$$9.99.                   
           05  FILLER                     PIC X(03)  VALUE SPACES.              
           05  L657-CA-TAG                PIC X(06)  VALUE 'CA = N'.            
           05  FILLER                     PIC X(03)  VALUE SPACES.              
           05  L657-STD-TAG               PIC X(12)  VALUE SPACES.              
                                                                                
       01  L657-PR-LINE-10.                                                     
           05  FILLER                     PIC X(68)  VALUE SPACES.              
           05  L657-NEW-ACC-REJ-DATE7     PIC X(10)  VALUE SPACES.              
                                                                                
       01  L657-PR-LINE-11.                                                     
           05  FILLER                     PIC X(10)  VALUE SPACES.              
           05  L657-DTE-OPTION-EXP        PIC X(10)  VALUE SPACES.              
                                                                                
       01  L657-PR-LINE-11A.                                                    
           05  FILLER                     PIC X(74)  VALUE SPACES.              
           05  L657-AMT-INSURED           PIC ZZZ,ZZ9.99.                       
           05  L657-AMT-I-R REDEFINES L657-AMT-INSURED                          
                                          PIC X(10).                            
       01  L657-PR-LINE-11B.                                                    
           05  FILLER                     PIC X(22)  VALUE SPACES.              
           05  L657-AMT-PREMIUM           PIC ZZ9.99.                           
           05  L657-AMT-P-R REDEFINES L657-AMT-PREMIUM                          
                                          PIC X(6).                             
       01  L657-PR-LINE-12.                                                     
           05  FILLER                     PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(13)  VALUE                      
                                                     '(ED FOR TP : '.           
           05  L657-DTE-EXPIRED           PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(1)   VALUE ')'.                 
                                                                                
       01  L657-PR-LINE-13.                                                     
           05  FILLER                     PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(03)  VALUE 'SC:'.               
           05  L657-AMT-CURR-SCCC         PIC ZZ9.99.                           
                                                                                
                                                                                
       01  L657-PR-LINE-14.                                                     
           05  FILLER                     PIC X(13)  VALUE SPACES.              
           05  L657-AMT-NEXT-SCCC         PIC ZZ9.99.                           
                                                                                
      *-----------------------------------------------------------*             
      *    WS PRINT LAY-OUT FOR LETTERS  (BP1336)                 *             
      *    AND CONTRACT PERSONS                                   *             
      *-----------------------------------------------------------*             
       01  L657-DTL-HAND-PHONE.                                                 
           05  FILLER                     PIC X(53)  VALUE SPACES.              
           05  L657-ASSIST-HP             PIC X(12)  VALUE SPACES.              
                                                                                
       01  L657-DTL-DID.                                                        
           05  FILLER                     PIC X(50)  VALUE SPACES.              
           05  L657-CHG-APPT-DID          PIC X(8)   VALUE SPACES.              
                                                                                
      *==> PART-A PRINT VARIABLES                                               
       01  L310A-PR-HEAD-09.                                                    
           05  FILLER                      PIC X(20) VALUE SPACES.              
           05  L211-CDE-NT                 PIC X(3)   VALUE 'XXX'.              
           05  FILLER                      PIC X(1)   VALUE '/'.                
           05  L211-RECOM-ROOM-TYPE        PIC X(2)   VALUE 'X'.                
           05  FILLER                      PIC X(1)   VALUE '/'.                
           05  L211-REGN-NO                PIC X(8)  VALUE SPACES.              
           05  FILLER                      PIC X(3)   VALUE '  ('.              
           05  L211-ALLOCATION-SCHEME      PIC X(3)   VALUE SPACES.             
           05  FILLER                      PIC X(1)   VALUE ')'.                
                                                                                
       01  L310A-PR-HEAD-9A.                                                    
           05  FILLER                      PIC X(20) VALUE SPACES.              
           05  L211-CA-TAG                 PIC X(13) VALUE                      
                                               'CA = N (SERS)'.                 
       01  L310A-PR-HEAD-10.                                                    
           05  FILLER                      PIC X(27)  VALUE SPACES.             
           05  L211-TXT-LS-FEE             PIC X(25)  VALUE SPACES.             
           05  L211-AMT-OFFER-PRICE        PIC Z,ZZZ,ZZ9.                       
           05  FILLER                      PIC X(05)  VALUE SPACES.             
           05  L211-AMT-LS-FEE             PIC ZZZ,ZZ9.99.                      
                                                                                
       01  L310A-PR-HEAD-11.                                                    
           05  FILLER                      PIC X(28) VALUE SPACES.              
           05  L211-ACT-CV-FEE             PIC Z,ZZ9.99.                        
           05  FILLER                      PIC X(6)  VALUE SPACES.              
           05  L211-GST-CV-FEE             PIC ZZ9.99.                          
           05  FILLER                      PIC X(18) VALUE SPACES.              
           05  L211-AMT-CV-FEE             PIC ZZZ,ZZ9.99.                      
                                                                                
       01  L310A-PR-HEAD-12.                                                    
           05  FILLER                      PIC X(18) VALUE SPACES.              
           05  L211-NUM-DEPOSIT            PIC Z9.                              
           05  L211-NUM-DEPOSIT-PER        PIC X VALUE '%'.                     
           05  FILLER                      PIC X(30) VALUE SPACES.              
           05  L211-AMT-ORIG-SP            PIC ZZ,ZZZ,ZZ9.                      
           05  FILLER                      PIC X(01) VALUE SPACES.              
           05  L211-AMT-SELL-PRICE         PIC ZZZ,ZZZ,ZZ9.99.                  
                                                                                
                                                                                
       01  L310A-PR-HEAD-TOTAL.                                                 
           05  FILLER                      PIC X(62) VALUE SPACES.              
           05  L211-AMT-TOTAL              PIC ZZZ,ZZZ,ZZ9.99.                  
                                                                                
      *==> PART-A PRINT NOTES                                                   
       01  L310A-PR-LINE-15.                                                    
           05  FILLER                      PIC X(20) VALUE SPACES.              
           05  L310-SYS-DATE               PIC X(10) VALUE SPACES.              
                                                                                
       01  L310A-PR-LINE-16.                                                    
           05  FILLER                      PIC X(17) VALUE SPACES.              
           05  L310-AMT-CURR-SCCC          PIC ZZ9.99.                          
           05  FILLER                      PIC X(5)  VALUE ' WEF '.             
           05  L310-DTE-CURR-SCCC          PIC X(10) VALUE SPACES.              
           05  FILLER                      PIC X(1)  VALUE SPACE.               
           05  L310-CURR-GST-DESC          PIC X(48) VALUE SPACES.              
                                                                                
       01  L310A-PR-LINE-17.                                                    
           05  FILLER                      PIC X(17) VALUE SPACES.              
           05  L310-AMT-NEXT-SCCC          PIC ZZ9.99.                          
           05  FILLER                      PIC X(5)  VALUE ' WEF '.             
           05  L310-DTE-NEXT-SCCC          PIC X(10) VALUE SPACES.              
           05  FILLER                      PIC X(1)  VALUE SPACE.               
           05  L310-NEXT-GST-DESC          PIC X(48) VALUE SPACES.              
                                                                                
      *==> PART-B PRINT VARIABLES                                               
       01  L400C-PR-LINE-1.                                                     
           05  FILLER                   PIC X(18)  VALUE SPACES.                
           05  FILLER                   PIC X(19)  VALUE                        
               'Repayment Period:  '.                                           
           05  400C-REPAY-PRD           PIC ZZ9.                                
           05  FILLER                   PIC X(06)  VALUE ' Years'.              
           05  FILLER                   PIC X(01)  VALUE spaces.                
           05  FILLER                   PIC X(23)  VALUE                        
               '*Offer Selling Price:$ '.                                       
           05  400C-1ST-OSP             PIC ZZZ,ZZ9.                            
                                                                                
       01  L400C-PR-LINE-2.                                                     
           05  FILLER                   PIC X(18)  VALUE SPACES.                
           05  FILLER                   PIC X(19)  VALUE                        
               'Interest Rate   :  '.                                           
           05  400C-INT-RATE            PIC Z9.99.                              
           05  FILLER                   PIC X(2)   VALUE ' %'.                  
           05  FILLER                   PIC X(04)  VALUE SPACES.                
           05  400C-DISC-TXT            PIC X(22)  VALUE                        
               'Discount OCS       :$ '.                                        
           05  400C-OCS-DISC            PIC ZZZ,ZZ9.                            
                                                                                
       01  L400C-PR-LINE-2-B.                                                   
           05  FILLER                   PIC X(18)  VALUE SPACES.                
           05  FILLER                   PIC X(19)  VALUE                        
               'Purchase Price  :$ '.                                           
           05  400C-SELL-PRICE          PIC ZZZ,ZZ9.                            
           05  FILLER                   PIC X(04)  VALUE SPACES.                
           05  FILLER                   PIC X(22)  VALUE                        
               'Discount SERS/RED  :$ '.                                        
           05  400C-SERS-DISC           PIC ZZZ,ZZ9.                            
                                                                                
       01  L400C-PR-LINE-3.                                                     
           05  FILLER                   PIC X(59)  VALUE SPACES.                
           05  400C-SELLING-PRICE       PIC ZZ,ZZZ,ZZ9.99.                      
                                                                                
       01  L400C-PR-LINE-4.                                                     
           05  FILLER                   PIC X(50)  VALUE SPACES.                
           05  400C-LEASE-FEE           PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-5.                                                     
           05  FILLER                   PIC X(50)  VALUE SPACES.                
           05  400C-MORT-STAMP-FEE      PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-6.                                                     
           05  FILLER                   PIC X(50)  VALUE SPACES.                
           05  400C-MORTGAGE-FEE        PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-7.                                                     
           05  FILLER                   PIC X(50)  VALUE SPACES.                
           05  400C-TOT-STAMP-FEE       PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-8.                                                     
           05  FILLER                   PIC X(24)  VALUE SPACES.                
           05  FILLER                   PIC X(1)   VALUE '('.                   
           05  400C-SURVEY-FEE-ACT      PIC Z,ZZ9.99.                           
           05  FILLER                   PIC X(3)   VALUE ' + '.                 
           05  400C-SURVEY-FEE-GST      PIC ZZ9.99.                             
           05  FILLER                   PIC X(8)   VALUE ' GST)'.               
           05  400C-TOT-SURVEY-FEE      PIC ZZZ,ZZ9.99.                         
           05  FILLER                   PIC X(2)   VALUE SPACES.                
           05  400C-TOT-FEES            PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-9.                                                     
           05  FILLER                   PIC X(59)  VALUE SPACES.                
           05  400C-TOT-SELLPR          PIC ZZ,ZZZ,ZZ9.99.                      
                                                                                
       01  L400C-PR-LINE-10.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CASH             PIC ZZZZ,ZZ9.99.                        
                                                                                
       01  L400C-PR-LINE-11.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CPF1             PIC ZZZZ,ZZ9.99.                        
           05  FILLER                   PIC X(3)   VALUE SPACES.                
           05  400C-CD-CPF1-TXT         PIC X(5)   VALUE SPACES.                
                                                                                
       01  L400C-PR-LINE-12.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CPF2             PIC ZZZZ,ZZ9.99.                        
                                                                                
       01  L400C-PR-LINE-13.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CPF3             PIC ZZZZ,ZZ9.99.                        
                                                                                
       01  L400C-PR-LINE-14.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CPF4             PIC ZZZZ,ZZ9.99.                        
           05  FILLER                   PIC X      VALUE SPACES.                
           05  400C-TOTAL-CD            PIC ZZZZ,ZZ9.99.                        
                                                                                
       01  L400C-PR-LINE-15.                                                    
           05  FILLER                   PIC X(59)  VALUE SPACES.                
           05  400C-BALANCE-AMT         PIC ZZ,ZZZ,ZZ9.99.                      
                                                                                
       01  L400C-PR-LINE-16.                                                    
           05  FILLER                   PIC X(60)  VALUE SPACES.                
           05  400C-MAX-LOAN-AMT        PIC Z,ZZZ,ZZ9.99.                       
                                                                                
       01  L400C-PR-LINE-17.                                                    
           05  FILLER                   PIC X(64)  VALUE SPACES.                
           05  400C-MTHLY-INSTAL        PIC Z,ZZ9.99.                           
                                                                                
       01  L400C-PR-LINE-18.                                                    
           05  FILLER                   PIC X(64)  VALUE SPACES.                
           05  400C-SC-CC-AMT           PIC Z,ZZ9.99.                           
                                                                                
       01  L400C-PR-LINE-19.                                                    
           05  FILLER                     PIC X(8)   VALUE SPACES.              
           05  FILLER                     PIC X(13)  VALUE                      
                                                     '(ED FOR TP : '.           
           05  L400C-DTE-EXPIRED          PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(1)   VALUE ')'.                 
                                                                                
       01  WS-LINK-S900.                                                        
           05  WS-S900-SELL-PR             PIC 9(8)     VALUE ZEROES.           
           05  WS-S900-DESIGN              PIC X(3)     VALUE SPACES.           
           05  WS-S900-RM                  PIC X(2)     VALUE SPACES.           
           05  WS-S900-CD-PREV-PAID        PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S900-TOT-ICP             PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S900-REPAY-PD            PIC 99       VALUE ZEROES.           
           05  WS-S900-PREM-ST-FEE         PIC 9(5)V99  VALUE ZEROES.           
           05  WS-S900-SURVEY-FEE          PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-LS-ESCROW-FEE       PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-LS-REGN-FEE         PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-CONVEY-FEE          PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-MORT-ESCROW-FEE     PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-MORT-ST-FEE         PIC 9(5)V99  VALUE ZEROES.           
           05  WS-S900-MORT-REGN-FEE       PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-LOAN                PIC S9(7)V99 VALUE ZEROES.           
           05  WS-S900-ORIG-SELL           PIC 9(8)     VALUE ZEROES.           
           05  WS-S900-SALE-TYPE           PIC X(2)     VALUE SPACES.           
           05  WS-S900-PREMIUM-CODE        PIC X(2)     VALUE SPACES.           
           05  WS-S900-SURVEY-FEE-GST      PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-CONVEY-FEE-GST      PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-SALES-TYPE-SURVEY   PIC X(2)     VALUE SPACES.           
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
      ******************************************************************        
       100-MAIN-ROUTINE.                                                        
      ******************************************************************        
           PERFORM 200-OPEN-FILES              THRU    200-EXIT.                
           PERFORM 250-MOVE-GST-RATE           THRU    250-EXIT.                
           PERFORM 300-READ-BP13F310           THRU    300-EXIT.                
           PERFORM 400-ALLOCATION-STATUS-CHECK THRU    400-EXIT                 
                       UNTIL WS-F310-EOF = 'Y'.                                 
           PERFORM 1000-CLOSE-ROUTINE          THRU    1000-EXIT.               
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       110-CHK-SERS.                                                            
      ******************************************************************        
      *-----------------------------------*                                     
      * SEARCH SCHEME IN ALLOC SCH TABLE  *                                     
      *-----------------------------------*                                     
           IF WS-ALLOC-SCH  NOT =  LOW-VALUES AND SPACES                        
               SET WS-SERS-PTR  TO 1                                            
               SEARCH WS-SERS-SCH                                               
                   AT END                                                       
                   MOVE 'N' TO WS-SCH-FND                                       
                   WHEN WS-SERS-SCHEME(WS-SERS-PTR) = WS-ALLOC-SCH              
                   MOVE 'Y' TO WS-SCH-FND                                       
               END-SEARCH                                                       
           ELSE                                                                 
               MOVE 'N' TO WS-SCH-FND                                           
           END-IF.                                                              
                                                                                
       110-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       200-OPEN-FILES.                                                          
      ******************************************************************        
           OPEN INPUT BP13K800                                                  
                      BP13K022                                                  
                      BP13K024                                                  
                      BP13K820                                                  
                      BP13K830                                                  
                      BM06K100                                                  
                      BM06K110                                                  
                      AB03K050                                                  
                      BP13F310                                                  
               OUTPUT P13L657B                                                  
                      P13L657C                                                  
                      P13L657D.                                                 
                                                                                
           IF BP13K022-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K022-STATUS ' BP13K022-STATUS          
              MOVE     BP13K022-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF BP13K024-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K024-STATUS ' BP13K024-STATUS          
              MOVE     BP13K024-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF BP13K800-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K800-STATUS ' BP13K800-STATUS          
              MOVE     BP13K800-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF BP13K820-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K820-STATUS ' BP13K820-STATUS          
              MOVE     BP13K820-STATUS TO RETURN-CODE                           
              PERFORM 1000-CLOSE-ROUTINE.                                       
                                                                                
           IF BP13K830-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K830-STATUS ' BP13K830-STATUS          
              MOVE     BP13K830-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF BM06K100-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BM06K100-STATUS ' BM06K100-STATUS          
              MOVE     BM06K100-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF BM06K110-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BM06K110-STATUS ' BM06K110-STATUS          
              MOVE     BM06K110-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           MOVE 30 TO WS-CNT.                                                   
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       250-MOVE-GST-RATE.                                                       
      ******************************************************************        
      *-----------------------------------------------------------*             
      *    CALL BP13C90D TO GET GST-RATE                          *             
      *-----------------------------------------------------------*             
           CALL 'BP13C90D' USING WS-COMM-AREA-GST.                              
                                                                                
       250-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       300-READ-BP13F310.                                                       
      ******************************************************************        
      *--------------------------------------------------------*                
      *    1.   READ FILE BP13F310.                            *                
      *    2.   CHECK F310-ALLOC-STATUS.                       *                
      *--------------------------------------------------------*                
                                                                                
           READ BP13F310                                                        
                AT END MOVE 'Y' TO WS-F310-EOF                                  
                       GO TO 300-EXIT.                                          
                                                                                
           ADD  1  TO  WS-CNT-F310.                                             
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       400-ALLOCATION-STATUS-CHECK.                                             
      ******************************************************************        
           PERFORM 500-ELIGIBILITY-CHECK  THROUGH  500-EXIT.                    
           PERFORM 300-READ-BP13F310      THROUGH  300-EXIT.                    
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       500-ELIGIBILITY-CHECK.                                                   
      ******************************************************************        
           PERFORM 700-READ-SOC-MASTER THRU 700-EXIT.                           
           MOVE  K800-NUM-ALLO-SCHEME  TO   WS-ALLOC-SCH.                       
           DISPLAY '~K800-NUM-ALLO-SCHEME:' K800-NUM-ALLO-SCHEME                
           PERFORM 110-CHK-SERS        THRU 110-EXIT.                           
                                                                                
           IF (K800-NUM-ALLO-SCHEME NOT = 'RED' AND                             
               WS-SCH-FND           NOT = 'Y') OR                               
              (K800-NUM-CA-TAG NOT = 'N')                                       
              DISPLAY '~~INSIDE ALLO'                                           
              GO TO 500-EXIT.                                                   
                                                                                
           PERFORM 550-INITIALIZE-WORKSHEET  THRU 550-EXIT.                     
           PERFORM 600-ACCESS-BM06K110       THRU 600-EXIT.                     
                                                                                
           MOVE    ZEROS   TO WS-ACCEPTANCE-DATE.                               
           IF K110-NOT-FOUND = 'Y'                                              
              MOVE ZEROS  TO WS-ACCEPTANCE-DATE                                 
              DISPLAY '~~ NOT FND K110'                                         
              GO TO 500-EXIT                                                    
           ELSE                                                                 
              MOVE K110-DTE-ACCEPTANCE TO WS-ACCEPTANCE-DATE                    
              IF  (K110-DTE-KEY-AVAIL  = SPACES OR LOW-VALUES OR ZEROES)        
              OR  (K110-DTE-KEY-AVAIL  NOT NUMERIC)                             
              DISPLAY '~~ K110 DTE ERR'                                         
                   GO TO 500-EXIT.                                              
                                                                                
           ADD     1   TO    WS-CNT-PROC.                                       
           PERFORM 750-GET-REGN-CHKDIGIT     THRU 750-EXIT.                     
           PERFORM 800-SETUP-LETTERS         THRU 800-EXIT.                     
           PERFORM 900-SETUP-WORKSHEET       THRU 900-EXIT.                     
           PERFORM 830-READ-BP13K022         THRU 830-EXIT.                     
           PERFORM 840-GET-CSM-INFO          THRU 840-EXIT.                     
           PERFORM 810-PRINT-1ST-LETTER      THRU 810-EXIT.                     
           PERFORM 815-SER-LETTER-COPY       THRU 815-EXIT.                     
           PERFORM 950-PROCESS-PRINT-WSHEET  THRU 950-EXIT.                     
                                                                                
       500-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       550-INITIALIZE-WORKSHEET.                                                
      ******************************************************************        
           MOVE SPACES   TO L211-REGN-NO        L310-SYS-DATE                   
                            400C-CD-CPF1-TXT                                    
                            L310-DTE-CURR-SCCC  L310-CURR-GST-DESC              
                            L310-DTE-NEXT-SCCC  L310-NEXT-GST-DESC.             
                                                                                
           MOVE ZEROES   TO L211-NUM-DEPOSIT                                    
                            L211-AMT-SELL-PRICE  L211-AMT-LS-FEE                
                            L211-AMT-OFFER-PRICE L211-AMT-ORIG-SP               
                            L211-ACT-CV-FEE      L211-GST-CV-FEE                
                            L211-AMT-CV-FEE      L211-AMT-TOTAL                 
                            L310-AMT-CURR-SCCC   L310-AMT-NEXT-SCCC             
                            400C-REPAY-PRD       400C-INT-RATE                  
                            400C-SELLING-PRICE   400C-LEASE-FEE                 
                            400C-MORT-STAMP-FEE  400C-MORTGAGE-FEE              
                            400C-TOT-STAMP-FEE   400C-SURVEY-FEE-ACT            
                            400C-SURVEY-FEE-GST  400C-TOT-SURVEY-FEE            
                            400C-TOT-FEES        400C-TOT-SELLPR                
                            400C-CD-CASH         400C-CD-CPF1                   
                            400C-CD-CPF2         400C-CD-CPF3                   
                            400C-CD-CPF4         400C-TOTAL-CD                  
                            400C-BALANCE-AMT     400C-MAX-LOAN-AMT              
                            400C-MTHLY-INSTAL    400C-SC-CC-AMT                 
                            400C-1ST-OSP         400C-SELL-PRICE.               
                                                                                
           MOVE SPACES TO L657-BARCODE-REGN.                                    
           MOVE SPACES TO L657-BARCODE1-REGN.                                   
           MOVE SPACES TO L657-BARCODE1-PREFIX.                                 
                                                                                
       550-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       600-ACCESS-BM06K110.                                                     
      ******************************************************************        
      *--------------------------------------------------------*                
      *    USE F310-SCH-ACCT-NO TO ACCESS BM06K110 FOR NEW     *                
      *        FLAT INFORMATION.                               *                
      *--------------------------------------------------------*                
           MOVE 'N'          TO K110-NOT-FOUND.                                 
           MOVE F310-SCH-ACC TO K110-KEY-FLD.                                   
                                                                                
           READ BM06K110.                                                       
                                                                                
           IF BM06K110-STATUS = 00 OR 02                                        
              DISPLAY 'FOUND :'                                                 
           ELSE                                                                 
           IF BM06K110-STATUS = 23                                              
              MOVE    'Y'  TO K110-NOT-FOUND                                    
              DISPLAY 'REC NOT FND, K110-KEY-FLD   ' K110-KEY-FLD               
           ELSE                                                                 
              DISPLAY 'READ ERROR, K110-STATUS  = ' BM06K110-STATUS             
              DISPLAY '            K110-KEY-FLD = ' K110-KEY-FLD                
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           ADD  1  TO  WS-CNT-K110.                                             
                                                                                
       600-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       700-READ-SOC-MASTER.                                                     
      ******************************************************************        
           MOVE F310-REGN-NO TO K800-NUM-REGN.                                  
           DISPLAY '~~F310-REGN-NO:' F310-REGN-NO                               
                                                                                
           READ BP13K800.                                                       
                                                                                
           IF BP13K800-STATUS = 00                                              
              MOVE    'N'  TO K800-NOT-FOUND                                    
           ELSE                                                                 
           IF BP13K800-STATUS = 23                                              
              MOVE    'Y'  TO K800-NOT-FOUND                                    
              GO TO    500-EXIT                                                 
           ELSE                                                                 
              DISPLAY 'READ ERROR, BP13K800-STATUS ' BP13K800-STATUS            
              MOVE     BP13K800-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF K800-NUM-SCH-ACC = SPACES OR LOW-VALUES                           
              GO TO 500-EXIT.                                                   
                                                                                
           IF K800-DTE-SALE-AGMT NOT = SPACES AND LOW-VALUES AND ZEROS          
              GO TO 500-EXIT.                                                   
                                                                                
           IF K800-DTE-AO-APPT   NOT = SPACES AND LOW-VALUES AND ZEROS          
              GO TO 500-EXIT.                                                   
                                                                                
       700-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       750-GET-REGN-CHKDIGIT.                                                   
      *-------------------------------------------------------------            
           STRING 'SL' K800-NUM-REGN DELIMITED BY SIZE                          
             INTO  WS-C908-TXT-INPUT.                                           
                                                                                
           MOVE SPACES               TO WS-C908-TXT-OUTPUT.                     
           MOVE 10                   TO WS-C908-TXT-IN-SIZE.                    
           MOVE ZEROS                TO WS-C908-RETCODE                         
                                        WS-C908-TXT-OUT-SIZE.                   
                                                                                
           CALL 'BP13C908'    USING WS-C908-PARAMETERS.                         
                                                                                
           IF WS-C908-RETCODE = ZEROS                                           
              MOVE WS-C908-TXT-OUTPUT(1:WS-C908-TXT-OUT-SIZE) TO                
                   L657-BARCODE-REGN                                            
           ELSE                                                                 
              DISPLAY 'ERROR IN BP13C908-REGN: ' WS-C908-TXT-INPUT              
              MOVE SPACES                 TO  L657-BARCODE-REGN.                
                                                                                
       750-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       800-SETUP-LETTERS.                                                       
      ******************************************************************        
      *--------------------------------------------------------*                
      *    PRINT LETTERS FOR LEASE AGREEMENT.                  *                
      *--------------------------------------------------------*                
           ADD  1                    TO  WS-CNT-LETTERS.                        
           MOVE K800-NUM-NEW-TOWN    TO  L657-CDE-NT                            
                                         L211-CDE-NT.                           
           IF F310-CDE-TYP-ACTUSE = '06'                                        
              MOVE 'E ' TO L657-RECOM-ROOM-TYPE                                 
                           L211-RECOM-ROOM-TYPE                                 
           ELSE                                                                 
           IF F310-CDE-TYP-ACTUSE = '08'                                        
              MOVE 'MG' TO L657-RECOM-ROOM-TYPE                                 
                           L211-RECOM-ROOM-TYPE                                 
           ELSE                                                                 
           IF F310-CDE-TYP-ACTUSE = '04' AND                                    
              F310-CDE-MODL-DESG  = '06'                                        
              MOVE '4S' TO L657-RECOM-ROOM-TYPE                                 
                           L211-RECOM-ROOM-TYPE                                 
           ELSE                                                                 
              MOVE F310-CDE-TYP-ACTUSE TO L657-RECOM-ROOM-TYPE                  
                                          L211-RECOM-ROOM-TYPE.                 
                                                                                
           MOVE K800-NUM-REGN        TO L657-REGN-NO                            
                                        L657-BARCODE1-REGN.                     
                                                                                
           MOVE 'SL'   TO L657-BARCODE1-PREFIX.                                 
                                                                                
           MOVE K800-NUM-ALLO-SCHEME TO L657-ALLOCATION-SCHEME                  
                                        L211-ALLOCATION-SCHEME.                 
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8)                                      
                                     TO WS-CUR-YYYYMMDD.                        
           MOVE WS-CUR-DD            TO WS-EDIT-DD.                             
           MOVE WS-CUR-MM            TO WS-EDIT-MM.                             
           MOVE WS-CUR-YYYY          TO WS-EDIT-YYYY.                           
           MOVE SPACES               TO PRINT-DATE.                             
                                                                                
           MOVE    '-'               TO D1 D2 D3.                               
           MOVE    F310-SCH          TO L657-SCHEME.                            
           MOVE    F310-ACC          TO WS-ACC.                                 
           MOVE    WS-ACCOUNT        TO L657-ACC.                               
           MOVE    WS-CDG            TO L657-CDG.                               
           MOVE    F310-LESSEE-CODE  TO L657-ACC-TYPE.                          
                                                                                
           MOVE    F310-CDE-BO       TO L657-BO.                                
           MOVE    F310-CDE-CC       TO L657-CC.                                
           MOVE    F310-CDE-TC       TO L657-TC.                                
           MOVE    '/'               TO L657-SLASH1                             
                                        L657-SLASH2.                            
                                                                                
           MOVE    K800-NUM-REGN     TO K820-NUM-REGN.                          
           MOVE    K800-NUM-NRIC1    TO K820-NUM-NRIC.                          
           PERFORM 850-GET-NAME    THRU 850-EXIT.                               
           MOVE    WS-NAME           TO L657-APPL-NAME.                         
                                                                                
           IF K800-NUM-NRIC2(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC2      NOT = SPACES                                  
              MOVE    K800-NUM-REGN     TO K820-NUM-REGN                        
              MOVE    K800-NUM-NRIC2    TO K820-NUM-NRIC                        
              PERFORM 850-GET-NAME      THRU  850-EXIT                          
              MOVE    WS-NAME           TO L657-COAPPL-NAME                     
           ELSE                                                                 
              MOVE SPACES               TO L657-COAPPL-NAME.                    
                                                                                
           IF K800-NUM-NRIC3(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC3      NOT = SPACES                                  
              MOVE K800-NUM-REGN     TO K820-NUM-REGN                           
              MOVE K800-NUM-NRIC3    TO K820-NUM-NRIC                           
              PERFORM 850-GET-NAME   THRU 850-EXIT                              
              MOVE WS-NAME           TO L657-THIRD-NAME                         
           ELSE                                                                 
              MOVE SPACES            TO L657-THIRD-NAME.                        
                                                                                
           IF K800-NUM-NRIC4(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC4      NOT = SPACES                                  
              MOVE K800-NUM-REGN     TO K820-NUM-REGN                           
              MOVE K800-NUM-NRIC4    TO K820-NUM-NRIC                           
              PERFORM 850-GET-NAME   THRU 850-EXIT                              
              MOVE WS-NAME           TO L657-FOURTH-NAME                        
           ELSE                                                                 
              MOVE SPACES            TO L657-FOURTH-NAME.                       
                                                                                
           PERFORM 860-READ-K830     THRU  860-EXIT.                            
                                                                                
           IF K110-NOT-FOUND = 'Y'                                              
              MOVE ZEROS             TO L657-CURR-SELL-PR                       
           ELSE                                                                 
              MOVE K110-CURR-SELLING-PRICE TO L657-CURR-SELL-PR.                
                                                                                
           MOVE F310-NUM-BLK         TO L657-BLK-NO.                            
           MOVE F310-NUM-LEVEL       TO L657-LEVEL-NO.                          
           MOVE F310-NUM-MAIN        TO L657-MAIN-UNIT.                         
           MOVE F310-NME-STREET      TO L657-ST-NAME.                           
                                                                                
           IF   F310-NUM-POSTAL = SPACES OR LOW-VALUES  OR ZEROES               
                MOVE SPACES          TO L657-COUNTRY-POSTCDE                    
           ELSE                                                                 
                STRING 'SINGAPORE ' F310-NUM-POSTAL '.'                         
                DELIMITED BY SIZE  INTO L657-COUNTRY-POSTCDE.                   
                                                                                
           MOVE K800-DTE-EXPIRED-TP TO WS-DTE.                                  
           MOVE '/'                 TO WS-SLASH1  WS-SLASH2.                    
           MOVE WS-DTE-YYYY         TO WS-DTE-EXPIRED-TP-YYYY.                  
           MOVE WS-DTE-MM           TO WS-DTE-EXPIRED-TP-MM.                    
           MOVE WS-DTE-DD           TO WS-DTE-EXPIRED-TP-DD.                    
                                                                                
           MOVE  WS-DTE-EXPIRED-TP  TO L657-DTE-EXPIRED                         
                                       L400C-DTE-EXPIRED.                       
           IF K800-DTE-OPTION-EXP NOT NUMERIC                                   
              MOVE ZEROS TO WS-IN-DATE                                          
           ELSE                                                                 
              MOVE K800-DTE-OPTION-EXP TO WS-IN-DATE.                           
                                                                                
           IF WS-IN-DATE = ZEROS OR LOW-VALUES                                  
              PERFORM 1500-COMPUTE-EXPIRY-DATE  THRU 1500-EXIT                  
           ELSE                                                                 
              MOVE WS-IN-DATE TO WS-DTE-OPT-EXP.                                
                                                                                
           MOVE K110-AIX1 TO K100-KEY-FLD.                                      
                                                                                
           READ BM06K100.                                                       
                                                                                
           IF BM06K100-STATUS = 00                                              
              NEXT SENTENCE                                                     
           ELSE                                                                 
           IF BM06K100-STATUS = 23                                              
              DISPLAY 'REC NOT FOUND IN BM06K100 = ' K100-KEY-FLD               
              GO TO    800-EXIT                                                 
           ELSE                                                                 
              DISPLAY 'READ ERROR, BM06K100-STATUS ' BM06K100-STATUS            
              MOVE     BM06K100-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF K100-DTE-OCS-DUE  IS  NOT NUMERIC                                 
              MOVE ZEROES            TO WS-DTE-OCS                              
           ELSE                                                                 
           IF K100-DTE-OCS-DUE  NOT  <  WS-CURR-DATE                            
              MOVE K100-DTE-OCS-DUE  TO WS-DTE-OCS                              
           ELSE                                                                 
              MOVE ZEROES            TO WS-DTE-OCS.                             
                                                                                
           IF K100-DTE-POD-DUE NOT NUMERIC                                      
              MOVE ZEROES    TO K100-DTE-POD-DUE                                
           END-IF.                                                              
                                                                                
           IF K100-DTE-POF-DUE NOT NUMERIC                                      
              MOVE ZEROES    TO K100-DTE-POF-DUE                                
           END-IF.                                                              
                                                                                
           IF K100-DTE-POD-DUE > ZEROS OR K100-DTE-POF-DUE > ZEROS              
              MOVE 'Y'       TO WS-NUM-OPT-IN                                   
           END-IF.                                                              
                                                                                
           IF K110-AMT-POD NOT NUMERIC                                          
              MOVE ZEROES    TO K110-AMT-POD                                    
           END-IF.                                                              
                                                                                
           IF K110-AMT-POF NOT NUMERIC                                          
              MOVE ZEROES    TO K110-AMT-POF                                    
           END-IF.                                                              
                                                                                
           STRING WS-DTE-OPT-DD '/' WS-DTE-OPT-MM '/' WS-DTE-OPT-YYYY           
                  DELIMITED BY SIZE INTO L657-DTE-OPTION-EXP.                   
           STRING WS-DTE-OPT-DD '/' WS-DTE-OPT-MM '/' WS-DTE-OPT-YYYY           
                  DELIMITED BY SIZE INTO L657-NEW-ACC-REJ-DATE7.                
                                                                                
           MOVE SPACES TO                L657-NEW-ACC-REJ-DATE7                 
                                         L657-DTE-OPTION-EXP.                   
                                                                                
           MOVE F310-CDE-TYP-ACTUSE     TO  BM97-NUM-FLAT-TYPE.                 
           MOVE F310-CDE-MODL-DESG      TO  BM97-CDE-MODL-DESG.                 
           MOVE FUNCTION CURRENT-DATE(1:8)                                      
                                        TO  WS-CURR-DATE.                       
           MOVE WS-CURR-DATE            TO  BM97-DTE-COMPARE.                   
           INITIALIZE                       BM97-NUM-ERROR                      
                                            BM97-NUM-SYSERR.                    
                                                                                
                                                                                
           CALL 'AB20C900' USING WS-BM97-AREA.                                  
                                                                                
           IF BM97-NUM-ERROR = ZEROS OR SPACES AND                              
              BM97-NUM-SYSERR = ZEROS                                           
              MOVE BM97-AMT-INSURED     TO  L657-AMT-INSURED                    
              MOVE BM97-AMT-PREMIUM     TO  L657-AMT-PREMIUM                    
                                                                                
           ELSE                                                                 
              MOVE BM97-NUM-SYSERR      TO  RETURN-CODE                         
              DISPLAY 'ERROR IN CALLING AB20C900, ' BM97-NUM-ERROR              
              MOVE SPACES               TO  L657-AMT-I-R                        
                                            L657-AMT-P-R.                       
                                                                                
           PERFORM 890-CALL-BP13C903  THRU  890-EXIT.                           
                                                                                
       800-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       805-CALL-AV02C015.                                                       
      *****************************************************************         
           CALL 'AV02C015'          USING                                       
                                    AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM.               
       805-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------*                
       810-PRINT-1ST-LETTER.                                                    
      *--------------------------------------------------------*                
           MOVE  SPACES    TO   PRINT-REC2.                                     
           WRITE PRINT-REC2 AFTER PAGE.                                         
                                                                                
           IF F310-CDE-SALES-TYPE = '3A'                                        
              MOVE '(BB - SERS)'    TO   L657-STD-TAG                           
           ELSE                                                                 
              IF F310-CDE-SALES-TYPE = '03'                                     
                 MOVE '(RP - SERS)' TO   L657-STD-TAG                           
              ELSE                                                              
                 MOVE '(SERS)'      TO   L657-STD-TAG                           
              END-IF                                                            
           END-IF.                                                              
                                                                                
           WRITE PRINT-REC2 FROM L657-PR-LINE-0 AFTER 4.                        
           WRITE PRINT-REC2 FROM L657-PR-LINE-1A.                               
           WRITE PRINT-REC2 FROM L657-PR-LINE-7A AFTER 0.                       
           WRITE PRINT-REC2 FROM L657-PR-LINE-2.                                
           WRITE PRINT-REC2 FROM L657-PR-LINE-3 AFTER 2.                        
           WRITE PRINT-REC2 FROM L657-PR-LINE-4 AFTER 1.                        
                                                                                
           IF K800-NUM-NRIC3(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC3     NOT = SPACES                                   
              WRITE PRINT-REC2 FROM L657-PR-LINE-4A AFTER 1                     
              WRITE PRINT-REC2 FROM L657-PR-LINE-4B AFTER 1                     
              WRITE PRINT-REC2 FROM L657-PR-LINE-5                              
              WRITE PRINT-REC2 FROM L657-PR-LINE-6                              
              WRITE PRINT-REC2 FROM L657-PR-LINE-7                              
              WRITE PRINT-REC2 FROM L657-PR-LINE-7B                             
              WRITE PRINT-REC2 FROM L657-PR-LINE-8 AFTER 5                      
           ELSE                                                                 
              WRITE PRINT-REC2 FROM L657-PR-LINE-5                              
              WRITE PRINT-REC2 FROM L657-PR-LINE-6                              
              WRITE PRINT-REC2 FROM L657-PR-LINE-7                              
              WRITE PRINT-REC2 FROM L657-PR-LINE-7B AFTER 3                     
              WRITE PRINT-REC2 FROM L657-PR-LINE-8 AFTER 5.                     
                                                                                
           WRITE PRINT-REC2 FROM L657-PR-LINE-9 AFTER 2.                        
           MOVE  SPACES     TO   L657-PR-LINE-11                                
                                 L657-PR-LINE-10.                               
           WRITE PRINT-REC2 FROM L657-PR-LINE-10 AFTER 8.                       
                                                                                
      *--------------------------------------------------------*                
      *    TO INSERT LINES TO BEAT THE FCB                     *                
      *--------------------------------------------------------*                
           MOVE  SPACES    TO   L657-PR-LINE-11.                                
           WRITE PRINT-REC2 FROM L657-PR-LINE-11  AFTER 4.                      
           WRITE PRINT-REC2 FROM L657-PR-LINE-11A AFTER 03.                     
           WRITE PRINT-REC2 FROM L657-PR-LINE-11B AFTER 01.                     
                                                                                
           WRITE PRINT-REC2 FROM L657-LINE-OIC    AFTER 18.                     
           WRITE PRINT-REC2 FROM L657-LINE-OIC1   AFTER 1.                      
           WRITE PRINT-REC2 FROM L657-LINE-BARCODE  AFTER 2.                    
           WRITE PRINT-REC2 FROM L657-LINE-BARCODE1 AFTER 1.                    
                                                                                
       810-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------*                
       815-SER-LETTER-COPY.                                                     
      *--------------------------------------------------------*                
           MOVE  SPACES    TO   PRINT-REC2.                                     
           WRITE PRINT-REC2 AFTER PAGE.                                         
                                                                                
           IF F310-CDE-SALES-TYPE = '3A'                                        
              MOVE '(BB - SERS)'    TO   L657-STD-TAG                           
           ELSE                                                                 
              IF F310-CDE-SALES-TYPE = '03'                                     
                 MOVE '(RP - SERS)' TO   L657-STD-TAG                           
              ELSE                                                              
                 MOVE '(SERS)' TO L657-STD-TAG                                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
           WRITE PRINT-REC2 FROM L657-PR-LINE-0 AFTER 4.                        
           WRITE PRINT-REC2 FROM L657-PR-LINE-1A.                               
           WRITE PRINT-REC2 FROM L657-PR-LINE-7A AFTER 0.                       
           WRITE PRINT-REC2 FROM L657-PR-LINE-2.                                
           WRITE PRINT-REC2 FROM L657-PR-LINE-3 AFTER 2.                        
           WRITE PRINT-REC2 FROM L657-PR-LINE-4 AFTER 1.                        
                                                                                
           IF K800-NUM-NRIC3(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC3     NOT = SPACES                                   
              WRITE PRINT-REC2 FROM L657-PR-LINE-4A AFTER 1                     
              WRITE PRINT-REC2 FROM L657-PR-LINE-4B AFTER 1                     
              WRITE PRINT-REC2 FROM L657-PR-LINE-5                              
              WRITE PRINT-REC2 FROM L657-PR-LINE-6                              
              WRITE PRINT-REC2 FROM L657-PR-LINE-7                              
              WRITE PRINT-REC2 FROM L657-PR-LINE-7B                             
              WRITE PRINT-REC2 FROM L657-PR-LINE-8 AFTER 5                      
           ELSE                                                                 
              WRITE PRINT-REC2 FROM L657-PR-LINE-5                              
              WRITE PRINT-REC2 FROM L657-PR-LINE-6                              
              WRITE PRINT-REC2 FROM L657-PR-LINE-7                              
              WRITE PRINT-REC2 FROM L657-PR-LINE-7B AFTER 3                     
              WRITE PRINT-REC2 FROM L657-PR-LINE-8  AFTER 5.                    
                                                                                
           WRITE PRINT-REC2 FROM L657-PR-LINE-9 AFTER 2.                        
           MOVE  SPACES    TO   L657-PR-LINE-11                                 
                                L657-PR-LINE-10.                                
           WRITE PRINT-REC2 FROM L657-PR-LINE-10 AFTER 8.                       
                                                                                
      *--------------------------------------------------------*                
      *    TO INSERT LINES TO BEAT THE FCB                     *                
      *--------------------------------------------------------*                
           MOVE  SPACES    TO   L657-PR-LINE-11.                                
           WRITE PRINT-REC2 FROM L657-PR-LINE-11 AFTER 4.                       
           WRITE PRINT-REC2 FROM L657-PR-LINE-11A AFTER 03.                     
           WRITE PRINT-REC2 FROM L657-PR-LINE-11B AFTER 01.                     
                                                                                
           WRITE PRINT-REC2 FROM L657-LINE-OIC    AFTER 18.                     
           WRITE PRINT-REC2 FROM L657-LINE-OIC1   AFTER 1.                      
           WRITE PRINT-REC2 FROM L657-LINE-BARCODE  AFTER 2.                    
           WRITE PRINT-REC2 FROM L657-LINE-BARCODE1 AFTER 1.                    
                                                                                
       815-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       830-READ-BP13K022.                                                       
      ******************************************************************        
           MOVE 'N'          TO K022-FOUND.                                     
           MOVE F310-REGN-NO TO K022-NUM-REGN.                                  
                                                                                
           READ BP13K022 KEY IS K022-NUM-REGN.                                  
                                                                                
           IF BP13K022-STATUS = 00                                              
              MOVE 'Y' TO K022-FOUND                                            
           ELSE                                                                 
           IF BP13K022-STATUS = 23                                              
              MOVE 'N' TO K022-FOUND                                            
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K022 = '  BP13K022-STATUS              
              MOVE 'N' TO K022-FOUND.                                           
                                                                                
           MOVE 'N'          TO K024-FOUND.                                     
           IF K022-FOUND = 'Y'                                                  
              ADD 1                       TO   WS-CNT-K022                      
              MOVE K022-NUM-OIC           TO   K024-NUM-OIC                     
              PERFORM 835-READ-BP13K024   THRU 835-EXIT                         
           END-IF.                                                              
                                                                                
       830-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       835-READ-BP13K024.                                                       
      ******************************************************************        
           READ BP13K024 KEY IS K024-KEY-FLD.                                   
                                                                                
           IF BP13K024-STATUS = 00                                              
              MOVE 'Y' TO K024-FOUND                                            
           ELSE                                                                 
           IF BP13K024-STATUS = 23                                              
              MOVE 'N' TO K024-FOUND                                            
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K024 = '  BP13K024-STATUS              
              MOVE 'N' TO K024-FOUND.                                           
                                                                                
           IF K024-FOUND = 'Y'                                                  
              ADD   1  TO WS-CNT-K024                                           
           END-IF.                                                              
                                                                                
       835-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       840-GET-CSM-INFO.                                                        
      ******************************************************************        
           MOVE SPACES TO L657-HDR-PHONE-DID                                    
                          L657-DTL-HAND-PHONE                                   
                          L657-EMAIL                                            
                          L657-DTL-DID                                          
                          L657-OIC-NAME                                         
                          L657-OIC-DESG                                         
                          WS-HDR-PHONE-DID                                      
                          WS-EMAIL.                                             
                                                                                
           IF K024-FOUND = 'Y'                                                  
              PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 5               
                 MOVE SPACES TO WS-OIC-EMAIL-TAB(WS-CTR)                        
                 MOVE SPACES TO WS-OIC-TAB(WS-CTR)                              
              END-PERFORM                                                       
                                                                                
              MOVE K024-NME-OIC                 TO L657-OIC-NAME                
              MOVE 'CUSTOMER SERVICE MANAGER'   TO L657-OIC-DESG                
              MOVE K024-NUM-DID                 TO L657-HDR-PHONE-DID           
                                                   L657-CHG-APPT-DID            
              MOVE '1800-8663066'               TO L657-ASSIST-HP               
      *       MOVE 'HDBSALES@HDB.GOV.SG'        TO WS-EMAIL                     
           ELSE                                                                 
              MOVE '1800-8663066(TOLL-FREE)'    TO WS-HDR-PHONE-DID             
              MOVE FUNCTION LOWER-CASE(WS-HDR-PHONE-DID)                        
                                                TO L657-HDR-PHONE-DID           
              MOVE '64903783'                   TO L657-CHG-APPT-DID            
              MOVE '1800-8663066'               TO L657-ASSIST-HP               
      *       MOVE 'HDBSALES@HDB.GOV.SG'        TO WS-EMAIL                     
           END-IF.                                                              
                                                                                
      *    MOVE FUNCTION LOWER-CASE(WS-EMAIL)   TO L657-EMAIL.                  
                                                                                
       840-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       850-GET-NAME.                                                            
      ******************************************************************        
           READ BP13K820.                                                       
                                                                                
           IF BP13K820-STATUS = 00                                              
              MOVE K820-NME-OCCP    TO WS-NAME                                  
           ELSE                                                                 
           IF BP13K820-STATUS = 23                                              
              MOVE     SPACES       TO WS-NAME                                  
              DISPLAY 'BP13K820 RECORD NOT FOUND = ' BP13K820-STATUS            
              DISPLAY 'K820-KEY-FLD  = '    K820-KEY-FLD                        
           ELSE                                                                 
              MOVE     SPACES       TO WS-NAME                                  
              DISPLAY 'ERROR READING BP13K820 = '  BP13K820-STATUS.             
                                                                                
           ADD 1 TO WS-CNT-K820.                                                
                                                                                
       850-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       860-READ-K830.                                                           
      ******************************************************************        
           MOVE     F310-REGN-NO     TO    K830-NUM-REGN.                       
                                                                                
           READ BP13K830 KEY IS K830-NUM-REGN.                                  
                                                                                
           IF BP13K830-STATUS = 00 OR 02                                        
              IF K830-NUM-MAIL-ADDR = SPACES OR LOW-VALUES                      
                 IF K830-NUM-ADDR-TYPE = 'H'                                    
                    MOVE SPACES              TO L657-STREET-NAME                
                    MOVE K830-NUM-BLK        TO L657-BLKNO                      
                    MOVE K830-NUM-LVL-CHAR   TO L657-CHAR                       
                    MOVE K830-NUM-LVL-NUM    TO L657-LEVEL                      
                    MOVE K830-NUM-LVL-DASH   TO L657-DASH                       
                    MOVE K830-NUM-HSEMAIN    TO L657-HSE-MAIN                   
                    MOVE K830-NUM-HSESUB     TO L657-HSE-SUB                    
                    MOVE K830-NME-STREET     TO L657-STREET-NAME                
                                                                                
                    IF K830-NUM-POSTAL = SPACES OR LOW-VALUES OR ZEROES         
                       MOVE SPACES           TO L657-POST-CODE L657-DOT         
                    ELSE                                                        
                       STRING 'SINGAPORE ' K830-NUM-POSTAL                      
                       DELIMITED BY SIZE   INTO L657-POST-CODE                  
                       MOVE  '.'             TO L657-DOT                        
                    END-IF                                                      
                                                                                
                 ELSE                                                           
                    MOVE SPACES               TO L657-STREET-NAME               
                    MOVE K830-NUM-BLK         TO L657-BLKNO                     
                    MOVE K830-NUM-FLAT        TO L657-NUM-FLAT                  
                    MOVE K830-NME-STREET-BLDG TO L657-STREET-NAME               
                                                                                
                    IF K830-NUM-POSTAL = SPACES OR LOW-VALUES OR ZEROES         
                       MOVE SPACES            TO L657-POST-CODE                 
                    ELSE                                                        
                       STRING 'SINGAPORE '  K830-NUM-POSTAL                     
                       DELIMITED BY SIZE    INTO L657-POST-CODE                 
                       MOVE  '.'              TO L657-DOT                       
                    END-IF                                                      
                 END-IF                                                         
      *--------TO GET THE BAR CODE -----------------------------------          
                                                                                
              MOVE SPACES                     TO WS-LINK-AV02C015               
              MOVE K830-NUM-POSTAL            TO AV02C015-IN-POSTCODE           
              PERFORM 805-CALL-AV02C015       THRU 805-EXIT                     
              MOVE AV02C015-OUT-POSTCODE-CHKSUM TO L657-BAR-CODE                
                                                                                
            ELSE                                                                
               IF K830-NUM-MAIL-ADDR-TYPE = 'H'                                 
                  MOVE SPACES                 TO L657-STREET-NAME               
                  MOVE K830-NUM-MAIL-BLK      TO L657-BLKNO                     
                  MOVE K830-NUM-MAIL-LVL-CHAR TO L657-CHAR                      
                  MOVE K830-NUM-MAIL-LVL-NUM  TO L657-LEVEL                     
                  MOVE K830-NUM-MAIL-LVL-DASH TO L657-DASH                      
                  MOVE K830-NUM-MAIL-HSEMAIN  TO L657-HSE-MAIN                  
                  MOVE K830-NUM-MAIL-HSESUB   TO L657-HSE-SUB                   
                  MOVE K830-NME-MAIL-STREET   TO L657-STREET-NAME               
                                                                                
                  IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR             
                                            ZEROES                              
                     MOVE SPACES              TO L657-POST-CODE L657-DOT        
                  ELSE                                                          
                     STRING 'SINGAPORE '    K830-NUM-MAIL-POSTAL                
                     DELIMITED BY SIZE      INTO L657-POST-CODE                 
                     MOVE  '.'                TO L657-DOT                       
                  END-IF                                                        
                                                                                
               ELSE                                                             
                  MOVE SPACES                 TO L657-STREET-NAME               
                  MOVE K830-NUM-MAIL-BLK      TO L657-BLKNO                     
                  MOVE K830-NUM-MAIL-FLAT     TO L657-NUM-FLAT                  
                  MOVE K830-NME-MAIL-STR-BLDG TO L657-STREET-NAME               
                                                                                
                  IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR             
                                            ZEROES                              
                     MOVE SPACES              TO L657-POST-CODE                 
                  ELSE                                                          
                     STRING 'SINGAPORE '    K830-NUM-MAIL-POSTAL                
                     DELIMITED BY SIZE      INTO L657-POST-CODE                 
                     MOVE  '.'                TO L657-DOT                       
                  END-IF                                                        
               END-IF                                                           
      *--------TO GET THE BAR CODE -----------------------------------          
                                                                                
              MOVE SPACES                     TO WS-LINK-AV02C015               
              MOVE K830-NUM-MAIL-POSTAL       TO AV02C015-IN-POSTCODE           
              PERFORM 805-CALL-AV02C015       THRU 805-EXIT                     
              MOVE AV02C015-OUT-POSTCODE-CHKSUM TO L657-BAR-CODE                
                                                                                
           ELSE                                                                 
           IF BP13K830-STATUS = 23                                              
              MOVE SPACES  TO L657-BLKNO                                        
                              L657-NUM-FLAT                                     
                              L657-STREET-NAME                                  
                              L657-POST-CODE                                    
                              L657-DOT                                          
              DISPLAY 'BP13K830 RECORD NOT FOUND  = ' BP13K830-STATUS           
              DISPLAY '         K830-NUM-REGN     = ' K830-NUM-REGN             
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K830 = ' BP13K830-STATUS               
              DISPLAY '      K830-NUM-REGN    = ' K830-NUM-REGN                 
              GO TO    1000-CLOSE-ROUTINE.                                      
                                                                                
           ADD 1 TO WS-CNT-K830.                                                
                                                                                
       860-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       890-CALL-BP13C903.                                                       
      ******************************************************************        
           MOVE     FUNCTION CURRENT-DATE(1:8)                                  
                                         TO    WS-S903-SO-EFF-DATE.             
           MOVE     ZEROES               TO    WS-S903-SC-CC1                   
                                               WS-S903-SC-CC2                   
                                               WS-S903-SC-CC3.                  
           MOVE     ZEROES               TO    WS-S903-SC-REBATE1               
                                               WS-S903-SC-REBATE2               
                                               WS-S903-SC-REBATE3               
                                               WS-S903-SC-GRANT1                
                                               WS-S903-SC-GRANT2                
                                               WS-S903-SC-GRANT3                
                                               WS-S903-SC-REC-TC1               
                                               WS-S903-SC-REC-TC2               
                                               WS-S903-SC-REC-TC3               
                                               WS-S903-SC-TOTAL-AMT.            
           MOVE     ZEROES               TO    WS-S903-SC-TOTAL-AMT.            
           MOVE     F310-SCH-ACC(1:9)    TO    WS-S903-NUM-SCH-ACC.             
           MOVE     F310-CDE-TYP-ACTUSE  TO    WS-S903-ROOM-TY.                 
           MOVE     F310-CDE-MODL-DESG   TO    WS-S903-DESIGN-TY.               
                                                                                
      *-----------------------------------------------------------*             
      *    CALL BP13C903 TO GET THE SC-CC1,SC-CC2 AND SC-CC3      *             
      *-----------------------------------------------------------*             
           CALL 'BP13C903' USING WS-LINK-S903.                                  
                                                                                
      *-----------------------------------------------------------*             
      *    CALL AV02C021 TO COMPUTE THE GST FOR SC-CC1 & SC-CC2   *             
      *-----------------------------------------------------------*             
           MOVE  WS-S903-SC-CC1     TO WS-AMT-NETT.                             
           CALL 'AV02C021' USING WS-COMM-AREA-GST.                              
           MOVE  WS-AMT-GST         TO WS-S903-SC-CC1-GST.                      
                                                                                
           MOVE  WS-S903-SC-REC-TC1 TO WS-AMT-NETT.                             
           CALL 'AV02C021' USING WS-COMM-AREA-GST.                              
           MOVE  WS-AMT-GST         TO WS-S903-SC-TC1-GST.                      
                                                                                
           IF (K800-NUM-SCCC-ELGBTY = 'N' OR 'Z') OR                            
              (K800-NUM-ALLO-SCHEME = 'SPO' OR 'SPP' OR 'SSP' OR                
                                      'SPS' OR 'SRP')                           
              COMPUTE WS-SC-CC1-AMT =  WS-S903-SC-CC1     +                     
                                       WS-S903-SC-CC1-GST +                     
                                       WS-S903-SC-REC-TC1 +                     
                                       WS-S903-SC-TC1-GST                       
           ELSE                                                                 
              COMPUTE WS-SC-CC1-AMT =  WS-S903-SC-CC1     +                     
                                       WS-S903-SC-CC1-GST -                     
                                       WS-S903-SC-REBATE1 -                     
                                       WS-S903-SC-GRANT1  -                     
                                       WS-S903-SC-REB-SP1                       
           END-IF.                                                              
                                                                                
           MOVE WS-SC-CC1-AMT       TO  L310-AMT-CURR-SCCC.                     
                                                                                
           MOVE WS-S903-SC-CURR-EFF-DATE TO WS-DTE-WEF.                         
           MOVE WS-WEF-DD                TO WS-SCCC-DD.                         
           MOVE WS-WEF-MM                TO WS-SCCC-MM.                         
           MOVE WS-WEF-YYYY              TO WS-SCCC-YYYY.                       
           MOVE WS-DTE-SCCC              TO L310-DTE-CURR-SCCC.                 
                                                                                
           IF (K800-NUM-SCCC-ELGBTY        = 'N' OR 'Z') OR                     
              (K800-NUM-ALLO-SCHEME        = 'SPO' OR 'SPP' OR 'SSP' OR         
                                             'SPS' OR 'SRP')                    
              COMPUTE WS-SC-CC-NUM-AMT     =  WS-S903-SC-CC1 +                  
                                              WS-S903-SC-REC-TC1                
              COMPUTE WS-SC-CC-NUM-AMT-GST =  WS-S903-SC-CC1-GST +              
                                              WS-S903-SC-TC1-GST                
              MOVE WS-SC-CC-NUM-AMT        TO WS-SC-CC-AMT                      
              MOVE WS-SC-CC-NUM-AMT-GST    TO WS-SC-CC-AMT-GST                  
           ELSE                                                                 
              MOVE WS-S903-SC-CC1          TO WS-SC-CC-AMT                      
              MOVE WS-S903-SC-CC1-GST      TO WS-SC-CC-AMT-GST                  
           END-IF.                                                              
                                                                                
           IF (K800-NUM-SCCC-ELGBTY      = 'N' OR 'Z') OR                       
              (K800-NUM-ALLO-SCHEME      = 'SPO' OR 'SSP' OR 'SPP' OR           
                                           'SPS' OR 'SRP')                      
              MOVE ')'                   TO WS-SC-CC-SIGN                       
              MOVE ZEROES                TO WS-SC-CC-REBATE-AMT                 
              MOVE SPACES                TO WS-SC-CC-REBATE-DESC                
              MOVE SPACES                TO WS-SC-CC-SIGN2                      
              MOVE ZEROES                TO WS-SC-CC-GRANT-AMT                  
              MOVE SPACES                TO WS-SC-CC-GRANT-DESC                 
              MOVE SPACES                TO WS-SC-CC-SIGN3                      
              MOVE ZEROES                TO WS-SC-CC-REB-SP-AMT                 
              MOVE SPACES                TO WS-SC-CC-REB-SP-DESC                
           ELSE                                                                 
           IF WS-S903-SC-REBATE1         =  ZEROES                              
              IF WS-S903-SC-GRANT1       =  ZEROES                              
                 IF WS-S903-SC-REB-SP1   =  ZEROES OR                           
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN                       
                    MOVE ZEROES          TO WS-SC-CC-REBATE-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REBATE-DESC                
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN                       
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-REBATE-AMT              
                    MOVE  'SP)'          TO WS-SC-CC-REBATE-DESC                
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN                       
                 MOVE WS-S903-SC-GRANT1  TO WS-SC-CC-REBATE-AMT                 
                 MOVE 'GRT'              TO WS-SC-CC-REBATE-DESC                
                 IF WS-S903-SC-REB-SP1    =  ZEROES  OR                         
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              MOVE '-'                   TO WS-SC-CC-SIGN                       
              MOVE WS-S903-SC-REBATE1    TO WS-SC-CC-REBATE-AMT                 
              MOVE 'REB'                 TO WS-SC-CC-REBATE-DESC                
              IF WS-S903-SC-GRANT1        =  ZEROES                             
                 IF WS-S903-SC-REB-SP1    =  ZEROES OR                          
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN2                      
                 MOVE WS-S903-SC-GRANT1  TO WS-SC-CC-GRANT-AMT                  
                 MOVE 'GRT'              TO WS-SC-CC-GRANT-DESC                 
                 IF WS-S903-SC-REB-SP1    =  ZEROES OR                          
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN3                      
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-REB-SP-AMT              
                    MOVE  'SP)'          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE WS-SC-CC1-AMT            TO L657-AMT-CURR-SCCC.                 
           MOVE WS-SC-CC-DESC            TO L310-CURR-GST-DESC.                 
                                                                                
           IF   WS-S903-SC-CC1           =  WS-S903-SC-CC2                      
                MOVE WS-S903-SC-CC1-GST  TO WS-S903-SC-CC2-GST                  
           ELSE                                                                 
                MOVE WS-S903-SC-CC2      TO WS-AMT-NETT                         
                CALL 'AV02C021'       USING WS-COMM-AREA-GST                    
                MOVE WS-AMT-GST          TO WS-S903-SC-CC2-GST.                 
                                                                                
           IF   WS-S903-SC-REC-TC1       =  WS-S903-SC-REC-TC2                  
                MOVE WS-S903-SC-TC1-GST  TO WS-S903-SC-TC2-GST                  
           ELSE                                                                 
                MOVE WS-S903-SC-REC-TC2  TO WS-AMT-NETT                         
                CALL 'AV02C021'       USING WS-COMM-AREA-GST                    
                MOVE WS-AMT-GST          TO WS-S903-SC-TC2-GST.                 
                                                                                
           IF (K800-NUM-SCCC-ELGBTY = 'N' OR 'Z') OR                            
              (K800-NUM-ALLO-SCHEME = 'SPO' OR 'SPP' OR 'SSP' OR                
                                      'SPS' OR 'SRP')                           
              COMPUTE WS-SC-CC2-AMT =  WS-S903-SC-CC2     +                     
                                       WS-S903-SC-CC2-GST +                     
                                       WS-S903-SC-REC-TC2 +                     
                                       WS-S903-SC-TC2-GST                       
           ELSE                                                                 
              COMPUTE WS-SC-CC2-AMT =  WS-S903-SC-CC2     +                     
                                       WS-S903-SC-CC2-GST -                     
                                       WS-S903-SC-REBATE2 -                     
                                       WS-S903-SC-GRANT2  -                     
                                       WS-S903-SC-REB-SP2                       
           END-IF.                                                              
                                                                                
           MOVE WS-SC-CC2-AMT       TO  L310-AMT-NEXT-SCCC.                     
                                                                                
           MOVE WS-S903-SC-NEXT-EFF-DATE TO WS-DTE-WEF.                         
           MOVE WS-WEF-DD                TO WS-SCCC-DD.                         
           MOVE WS-WEF-MM                TO WS-SCCC-MM.                         
           MOVE WS-WEF-YYYY              TO WS-SCCC-YYYY                        
           MOVE WS-DTE-SCCC              TO L310-DTE-NEXT-SCCC.                 
                                                                                
           IF (K800-NUM-SCCC-ELGBTY        = 'N' OR 'Z') OR                     
              (K800-NUM-ALLO-SCHEME        = 'SPO' OR 'SPP' OR 'SSP' OR         
                                             'SPS' OR 'SRP')                    
              COMPUTE WS-SC-CC-NUM-AMT     =  WS-S903-SC-CC2 +                  
                                              WS-S903-SC-REC-TC2                
              COMPUTE WS-SC-CC-NUM-AMT-GST =  WS-S903-SC-CC2-GST +              
                                              WS-S903-SC-TC2-GST                
              MOVE WS-SC-CC-NUM-AMT        TO WS-SC-CC-AMT                      
              MOVE WS-SC-CC-NUM-AMT-GST    TO WS-SC-CC-AMT-GST                  
           ELSE                                                                 
              MOVE WS-S903-SC-CC2          TO WS-SC-CC-AMT                      
              MOVE WS-S903-SC-CC2-GST      TO WS-SC-CC-AMT-GST                  
           END-IF.                                                              
                                                                                
           IF (K800-NUM-SCCC-ELGBTY      = 'N' OR 'Z') OR                       
              (K800-NUM-ALLO-SCHEME      = 'SPO' OR 'SPP' OR 'SSP' OR           
                                           'SPS' OR 'SRP')                      
              MOVE ')'                   TO WS-SC-CC-SIGN                       
              MOVE ZEROES                TO WS-SC-CC-REBATE-AMT                 
              MOVE SPACES                TO WS-SC-CC-REBATE-DESC                
              MOVE SPACES                TO WS-SC-CC-SIGN2                      
              MOVE ZEROES                TO WS-SC-CC-GRANT-AMT                  
              MOVE SPACES                TO WS-SC-CC-GRANT-DESC                 
              MOVE SPACES                TO WS-SC-CC-SIGN3                      
              MOVE ZEROES                TO WS-SC-CC-REB-SP-AMT                 
              MOVE SPACES                TO WS-SC-CC-REB-SP-DESC                
           ELSE                                                                 
           IF WS-S903-SC-REBATE2         =  ZEROES                              
              IF WS-S903-SC-GRANT2       =  ZEROES                              
                 IF WS-S903-SC-REB-SP2   =  ZEROES OR                           
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN                       
                    MOVE ZEROES          TO WS-SC-CC-REBATE-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REBATE-DESC                
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN                       
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-REBATE-AMT              
                    MOVE  'SP)'          TO WS-SC-CC-REBATE-DESC                
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN                       
                 MOVE WS-S903-SC-GRANT2  TO WS-SC-CC-REBATE-AMT                 
                 MOVE 'GRT'              TO WS-SC-CC-REBATE-DESC                
                 IF WS-S903-SC-REB-SP2    =  ZEROES OR                          
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              MOVE '-'                   TO WS-SC-CC-SIGN                       
              MOVE WS-S903-SC-REBATE2    TO WS-SC-CC-REBATE-AMT                 
              MOVE 'REB'                 TO WS-SC-CC-REBATE-DESC                
              IF WS-S903-SC-GRANT1        =  ZEROES                             
                 IF WS-S903-SC-REB-SP2    =  ZEROES  OR                         
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN2                      
                 MOVE WS-S903-SC-GRANT2  TO WS-SC-CC-GRANT-AMT                  
                 MOVE 'GRT'              TO WS-SC-CC-GRANT-DESC                 
                 IF WS-S903-SC-REB-SP2    =  ZEROES OR                          
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN3                      
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-REB-SP-AMT              
                    MOVE  'SP)'          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE WS-SC-CC2-AMT            TO L657-AMT-NEXT-SCCC.                 
           MOVE WS-SC-CC-DESC            TO L310-NEXT-GST-DESC.                 
                                                                                
           COMPUTE WS-TOT-SCCC ROUNDED = WS-SC-CC1-AMT +                        
                                        (WS-SC-CC2-AMT * 2)                     
           MOVE WS-TOT-SCCC              TO 400C-SC-CC-AMT.                     
                                                                                
       890-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       900-SETUP-WORKSHEET.                                                     
      ******************************************************************        
           PERFORM 910-COMPUTE-COMM-DEPOSIT  THRU  910-EXIT.                    
           PERFORM 920-COMPUTE-LSTAMP-FEE    THRU  920-EXIT.                    
           PERFORM 930-COMPUTE-CONVEY-FEE    THRU  930-EXIT.                    
           PERFORM 940-COMPUTE-PARTB-WSHEET  THRU  940-EXIT.                    
                                                                                
       900-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       910-COMPUTE-COMM-DEPOSIT.                                                
      ******************************************************************        
           MOVE ZEROES TO L211-NUM-DEPOSIT.                                     
           IF K110-CURR-SELLING-PRICE IS NUMERIC                                
              MOVE K110-CURR-SELLING-PRICE  TO WS-K110-CSPRICE                  
                                               L211-AMT-ORIG-SP                 
           ELSE                                                                 
              MOVE ZEROES                   TO WS-K110-CSPRICE                  
                                               L211-AMT-ORIG-SP.                
                                                                                
           IF K110-1ST-OFFER-SELLING-PRICE IS NUMERIC                           
              MOVE K110-1ST-OFFER-SELLING-PRICE  TO                             
                                           L211-AMT-OFFER-PRICE                 
                                           WS-K110-OFFER                        
           ELSE                                                                 
              MOVE ZEROES               TO L211-AMT-OFFER-PRICE                 
                                           L211-AMT-ORIG-SP                     
                                           WS-K110-OFFER.                       
                                                                                
           COMPUTE WS-K110-OFFER = WS-K110-OFFER + K110-AMT-POD +               
                                   K110-AMT-POF.                                
                                                                                
           PERFORM 915-GET-CD-PERCENT   THRU 915-EXIT.                          
                                                                                
           COMPUTE WS-COMP-SELLPR = (WS-SR08-CD-PCT / 100) *                    
                                     WS-K110-CSPRICE.                           
                                                                                
           MOVE WS-SR08-CD-PCT   TO L211-NUM-DEPOSIT.                           
           MOVE WS-COMP-SELLPR   TO L211-AMT-SELL-PRICE.                        
                                                                                
       910-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       915-GET-CD-PERCENT.                                                      
      ******************************************************************        
           MOVE SPACES                  TO WS-SR08-COMMAREA.                    
           INITIALIZE                      WS-SR08-COMMAREA.                    
                                                                                
           MOVE F310-SCH-ACC            TO WS-SR08-SCH-ACC.                     
           MOVE K800-NUM-IDP-SCHEME     TO WS-SR08-IDP-SCH.                     
           MOVE K800-NUM-ALLO-SCHEME    TO WS-SR08-ALLOC-SCH.                   
           MOVE K800-NUM-ELIG-SCHEME    TO WS-SR08-ELIG-SCH.                    
           MOVE SPACES                  TO WS-SR08-HALF-IDP.                    
           MOVE ZEROES                  TO WS-SR08-CD-PCT                       
                                           WS-SR08-JT-BALLOT-MTF.               
           MOVE SPACES                  TO WS-SR08-CDE-ERROR.                   
                                                                                
           CALL 'BP13C904' USING WS-SR08-COMMAREA.                              
                                                                                
       915-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       920-COMPUTE-LSTAMP-FEE.                                                  
      ******************************************************************        
           IF K110-1ST-OFFER-SELLING-PRICE IS NOT NUMERIC                       
              MOVE  ZERO         TO    K110-1ST-OFFER-SELLING-PRICE.            
           IF K110-AMT-OCS-DISCOUNT        IS NOT NUMERIC                       
              MOVE  ZERO         TO    K110-AMT-OCS-DISCOUNT.                   
           IF K110-AMT-FLAT-DISCOUNT       IS NOT NUMERIC                       
              MOVE  ZERO         TO    K110-AMT-FLAT-DISCOUNT.                  
                                                                                
           MOVE  K110-1ST-OFFER-SELLING-PRICE TO  WS-SELL-PRICE                 
                                                  400C-1ST-OSP.                 
                                                                                
           IF K110-CDE-OCS-TAG = 'N'                                            
              MOVE  K110-AMT-OCS-DISCOUNT     TO  400C-OCS-DISC                 
              MOVE 'DISCOUNT OCS       :$ '   TO  400C-DISC-TXT                 
           ELSE                                                                 
              IF WS-NUM-OPT-IN = 'Y'                                            
                 COMPUTE WS-PODF-AMT = K110-AMT-POD + K110-AMT-POF              
                 MOVE  WS-PODF-AMT             TO  400C-OCS-DISC                
                 MOVE 'PODF AMOUNT        :$ ' TO  400C-DISC-TXT                
              ELSE                                                              
                 MOVE  ZEROES                  TO  400C-OCS-DISC                
                 MOVE 'DISCOUNT OCS       :$ ' TO  400C-DISC-TXT                
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE  K110-AMT-FLAT-DISCOUNT        TO  400C-SERS-DISC.              
                                                                                
           IF ((K800-NUM-ALLO-SCHEME = 'STD' OR 'RED' OR 'RP ') OR              
               (WS-SCH-FND = 'Y')) AND (K110-CDE-OCS-TAG = 'N')                 
              MOVE  K110-1ST-OFFER-SELLING-PRICE                                
                                            TO WS-EDT-OFFER-PRICE               
              MOVE  K110-AMT-OCS-DISCOUNT   TO WS-EDT-OCS-AMT                   
              STRING '(*OSP' WS-EDT-OFFER-PRICE                                 
                     '-OCS'  WS-EDT-OCS-AMT ')'                                 
                      DELIMITED BY SIZE INTO    L211-TXT-LS-FEE                 
                                                                                
              COMPUTE WS-OSP-OCP-AMT =  K110-CURR-SELLING-PRICE  +              
                                        K110-AMT-FLAT-DISCOUNT                  
              MOVE    WS-OSP-OCP-AMT TO L211-AMT-OFFER-PRICE                    
                                        WS-K110-OFFER                           
                                        WS-SELL-PRICE                           
                                                                                
              IF K800-NUM-ALLO-SCHEME = 'STD' OR 'SMS' OR 'SEF' OR              
                               'SMF' OR 'RP'  OR 'RED' OR 'SRD' OR              
                               'SSD' OR 'SJD' OR 'SDF' OR                       
                               'SFO' OR 'SRO' OR 'SJO'                          
                 MOVE K110-CURR-SELLING-PRICE   TO WS-SELL-PRICE                
              END-IF                                                            
           ELSE                                                                 
              IF ((K800-NUM-ALLO-SCHEME = 'STD' OR 'RED' OR 'RP ') OR           
                  (WS-SCH-FND = 'Y')) AND (WS-NUM-OPT-IN = 'Y')                 
                 MOVE  K110-1ST-OFFER-SELLING-PRICE                             
                                               TO WS-EDT-OFFER-PRICE            
                 MOVE  WS-PODF-AMT             TO WS-EDT-PODF-AMT               
                 STRING '(*OSP' WS-EDT-OFFER-PRICE                              
                        '+PODF'  WS-EDT-PODF-AMT ')'                            
                         DELIMITED BY SIZE INTO    L211-TXT-LS-FEE              
                                                                                
                 COMPUTE WS-OSP-OCP-AMT =  K110-CURR-SELLING-PRICE  +           
                                           K110-AMT-FLAT-DISCOUNT               
                 MOVE    WS-OSP-OCP-AMT TO L211-AMT-OFFER-PRICE                 
                                           WS-K110-OFFER                        
                                           WS-SELL-PRICE                        
                                                                                
                 IF K800-NUM-ALLO-SCHEME = 'STD' OR 'SMS' OR 'SEF' OR           
                                  'SMF' OR 'RP'  OR 'RED' OR 'SRD' OR           
                                  'SSD' OR 'SJD' OR 'SDF' OR                    
                                  'SFO' OR 'SRO' OR 'SJO'                       
                    MOVE K110-CURR-SELLING-PRICE   TO WS-SELL-PRICE             
                 END-IF                                                         
              ELSE                                                              
                 IF K800-NUM-ALLO-SCHEME = 'STD' OR 'SMS' OR 'SEF' OR           
                                           'SRD' OR 'SMF' OR 'RP'  OR           
                                           'SSD' OR 'SJD' OR 'SDF' OR           
                                           'SFO' OR 'SRO' OR 'SJO'              
                    COMPUTE WS-OSP-OCP-AMT =  K110-CURR-SELLING-PRICE           
                                           +  K110-AMT-FLAT-DISCOUNT            
                    MOVE  WS-OSP-OCP-AMT      TO  WS-EDT-OFFER-PRICE            
                    MOVE  SPACES   TO L310A-PR-HEAD-10                          
                    STRING '(BASED ON *OP ' WS-EDT-OFFER-PRICE ')'              
                          DELIMITED BY SIZE INTO  L211-TXT-LS-FEE               
                 ELSE                                                           
                    MOVE   SPACES             TO  L211-TXT-LS-FEE               
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE WS-SELL-PRICE          TO 400C-SELL-PRICE.                      
                                                                                
      ***BP132207 REMOVE 30% DISCOUNT                                           
      *==> 0.007 --> 0.01 (REMOVE DISCOUNT FROM 2001 OFF-BUDGET)                
      *==> 0.014 --> 0.02 (REMOVE DISCOUNT FROM 2001 OFF-BUDGET)                
      *==> 0.021 --> 0.03 (REMOVE DISCOUNT FROM 2001 OFF-BUDGET)                
                                                                                
           IF WS-K110-OFFER   NOT > 180000                                      
              COMPUTE WS-COMP-LS-FEE = 0.01 * WS-K110-OFFER                     
           ELSE                                                                 
              COMPUTE WS-LS-LEAVE = WS-K110-OFFER  - 180000                     
              IF WS-LS-LEAVE NOT  > 180000                                      
                 COMPUTE WS-COMP-LS-FEE = 0.01 * 180000 +                       
                                         (0.02 * WS-LS-LEAVE)                   
              ELSE                                                              
                 COMPUTE WS-LS-LEAVE    = WS-K110-OFFER  - 360000               
                 COMPUTE WS-COMP-LS-FEE = (0.01 * 180000) +                     
                                          (0.02 * 180000) +                     
                                          (0.03 * WS-LS-LEAVE).                 
      *==> SC/CC AD VALOREM                                                     
           IF (K800-NUM-SCCC-ELGBTY  = 'N' OR 'Z') OR                           
              (K800-NUM-ALLO-SCHEME  = 'SPO' OR 'SPP' OR 'SSP' OR               
                                       'SPS' OR 'SRP')                          
              COMPUTE WS-S905-SC-CC1 = WS-S903-SC-CC1 +                         
                                       WS-S903-SC-REC-TC1                       
              COMPUTE WS-S905-SC-CC2 = WS-S903-SC-CC2 +                         
                                       WS-S903-SC-REC-TC2                       
              COMPUTE WS-S905-SC-CC3 = WS-S903-SC-CC3 +                         
                                       WS-S903-SC-REC-TC3                       
              MOVE ZEROES           TO WS-S905-SC-TOTAL-AMT                     
           ELSE                                                                 
              MOVE WS-S903-SC-CC1   TO WS-S905-SC-CC1                           
              MOVE WS-S903-SC-CC2   TO WS-S905-SC-CC2                           
              MOVE WS-S903-SC-CC3   TO WS-S905-SC-CC3                           
              MOVE ZEROES           TO WS-S905-SC-TOTAL-AMT                     
           END-IF.                                                              
                                                                                
      *==> CALL BP13C905 TO GET THE AD VALOREM STAMP FEE                        
      *    COMPUTE THE SC/CC AD-VALOREM , USE PURE SC-CC ONLY!                  
                                                                                
           CALL 'BP13C905' USING WS-LINK-S905.                                  
           IF WS-S905-SC-TOTAL-AMT IS NUMERIC                                   
              ADD  WS-S905-SC-TOTAL-AMT  TO  WS-COMP-LS-FEE.                    
      *==> $1.40 FOR DUPLICATE SALES AGREEMENT (2001 OFF-BUDGET)                
      *==> $2 FOR DUPLICATE SALES AGREEMENT (ORIGINAL)                          
           ADD  2                        TO  WS-COMP-LS-FEE.                    
                                                                                
           MOVE WS-COMP-LS-FEE           TO L211-AMT-LS-FEE.                    
                                                                                
       920-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       930-COMPUTE-CONVEY-FEE.                                                  
      ******************************************************************        
           IF WS-K110-CSPRICE NOT > 30000                                       
              COMPUTE WS-COMP-CV-FEE = 0.0009 * WS-K110-CSPRICE                 
           ELSE                                                                 
              COMPUTE WS-CONV-LEAVE = WS-K110-CSPRICE - 30000                   
              IF WS-CONV-LEAVE NOT  > 30000                                     
                 COMPUTE WS-COMP-CV-FEE = 0.0009 * 30000 +                      
                                          (0.00072 * WS-CONV-LEAVE)             
              ELSE                                                              
                 COMPUTE WS-CONV-LEAVE    = WS-K110-CSPRICE -                   
                                            60000                               
                 COMPUTE WS-COMP-CV-FEE = (0.0009 * 30000) +                    
                                          (0.00072 * 30000) +                   
                                          (0.00060 * WS-CONV-LEAVE).            
                                                                                
      *==> THE MINIMUM CONVEY FEE IS $20                                        
      *    ROUND IT UP TO THE NEAREST DOLLAR EG. $51.20 BECOME $52.00           
                                                                                
            IF WS-COMP-CV-FEE NOT > 20                                          
               MOVE 20              TO  WS-COMP-CV-FEE                          
            ELSE                                                                
               ADD 0.49             TO  WS-COMP-CV-FEE                          
               COMPUTE WS-ROUND-CONVFEE ROUNDED = WS-COMP-CV-FEE / 100          
               COMPUTE WS-COMP-CV-FEE          = WS-ROUND-CONVFEE * 100.        
                                                                                
      *==> COMPUTING GST FOR CONVEYANCING FEES                                  
            MOVE  WS-COMP-CV-FEE     TO   WS-AMT-NETT                           
                                          L211-ACT-CV-FEE.                      
                                                                                
            CALL 'AV02C021' USING WS-COMM-AREA-GST.                             
                                                                                
            ADD   WS-AMT-GST         TO   WS-COMP-CV-FEE.                       
            MOVE  WS-AMT-GST         TO   L211-GST-CV-FEE.                      
            MOVE  WS-COMP-CV-FEE     TO   L211-AMT-CV-FEE.                      
                                                                                
      * TO REMOVE ODD CENTS                                                     
            MOVE SPACES              TO   WS-COMM-AREA-ODDCENTS.                
            INITIALIZE                    WS-COMM-AREA-ODDCENTS.                
                                                                                
            MOVE  WS-COMP-CV-FEE     TO   WS-COMM-ODD-TOTAL-FEE.                
            MOVE  WS-NUM-GST-RATE    TO   WS-COMM-ODD-GST-RATE.                 
                                                                                
            CALL 'BP13C90B' USING WS-COMM-AREA-ODDCENTS.                        
                                                                                
            IF WS-COMM-ODD-CENTS-SW = 'Y'                                       
               MOVE WS-COMM-ODD-GST       TO WS-AMT-GST                         
                                             L211-GST-CV-FEE                    
               MOVE WS-COMM-ODD-BASE-FEE  TO L211-ACT-CV-FEE                    
               MOVE WS-COMM-ODD-TOTAL-FEE TO WS-COMP-CV-FEE                     
                                             L211-AMT-CV-FEE                    
            END-IF.                                                             
                                                                                
            COMPUTE   WS-COMP-TOTAL   =   WS-COMP-LS-FEE +                      
                                          WS-COMP-CV-FEE +                      
                                          WS-COMP-SELLPR.                       
                                                                                
            MOVE      WS-COMP-TOTAL   TO  L211-AMT-TOTAL.                       
                                                                                
       930-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       940-COMPUTE-PARTB-WSHEET.                                                
      ******************************************************************        
           MOVE ZEROES                   TO WS-TOTAL-CD.                        
           ADD WS-COMP-SELLPR            TO WS-TOTAL-CD.                        
           IF K800-AMT-CD-CPF1 IS NUMERIC                                       
              ADD  K800-AMT-CD-CPF1      TO WS-TOTAL-CD.                        
           IF K800-AMT-CD-CPF2 IS NUMERIC                                       
              ADD  K800-AMT-CD-CPF2      TO WS-TOTAL-CD.                        
           IF K800-AMT-CD-CPF3 IS NUMERIC                                       
              ADD  K800-AMT-CD-CPF3      TO WS-TOTAL-CD.                        
           IF K800-AMT-CD-CPF4 IS NUMERIC                                       
              ADD  K800-AMT-CD-CPF4      TO WS-TOTAL-CD.                        
                                                                                
      ***********************************************************               
      *   CD TO BE PAID                                                         
      *************************************************************             
           PERFORM 943-CALL-BP13C900   THRU 943-EXIT.                           
           ADD WS-LOAN-INT-2           TO WS-S900-TOT-ICP.                      
           MOVE ZEROES                 TO WS-LOAN-INT-2.                        
           MOVE WS-LOAN-ROUND-DOWN     TO WS-MAX-LOAN-AMT.                      
           PERFORM 943-CALL-BP13C900   THRU 943-EXIT.                           
                                                                                
           COMPUTE WS-TOTAL-CD = WS-TOTAL-CD + WS-LOAN-INT-2.                   
           COMPUTE WS-TOT-STAMP-FEE = WS-COMP-LEASE + WS-MORT-STAMP-FEE         
                                    + WS-COMP-MORTGAGE.                         
           COMPUTE WS-TOTAL-FEES    = WS-TOT-STAMP-FEE +                        
                                      WS-COMP-SURVEY-FEE.                       
           COMPUTE WS-TOTAL-SELLPR  = WS-TOTAL-FEES +                           
                                      WS-K110-CSPRICE.                          
           COMPUTE WS-BALANCE-AMT   = WS-TOTAL-SELLPR - WS-TOTAL-CD.            
                                                                                
           MOVE K110-CURR-SELLING-PRICE  TO 400C-SELLING-PRICE.                 
           MOVE WS-COMP-LEASE            TO 400C-LEASE-FEE.                     
           MOVE WS-COMP-SURVEY-FEE       TO 400C-TOT-SURVEY-FEE.                
           MOVE WS-MORT-STAMP-FEE        TO 400C-MORT-STAMP-FEE.                
           MOVE WS-COMP-MORTGAGE         TO 400C-MORTGAGE-FEE.                  
           MOVE WS-TOT-STAMP-FEE         TO 400C-TOT-STAMP-FEE.                 
           MOVE WS-TOTAL-FEES            TO 400C-TOT-FEES.                      
           MOVE WS-TOTAL-SELLPR          TO 400C-TOT-SELLPR.                    
           MOVE WS-TOTAL-CD              TO 400C-TOTAL-CD.                      
           MOVE WS-COMP-SELLPR           TO 400C-CD-CASH.                       
           MOVE WS-LOAN-INT-2            TO 400C-CD-CPF1.                       
           MOVE SPACES                   TO 400C-CD-CPF1-TXT.                   
           MOVE K800-AMT-CD-CPF2         TO 400C-CD-CPF2.                       
           MOVE K800-AMT-CD-CPF3         TO 400C-CD-CPF3.                       
           MOVE K800-AMT-CD-CPF4         TO 400C-CD-CPF4.                       
           MOVE WS-BALANCE-AMT           TO 400C-BALANCE-AMT.                   
           MOVE WS-MAX-LOAN-AMT          TO 400C-MAX-LOAN-AMT.                  
                                                                                
      *==> GET INTEREST RATE                                                    
           MOVE   FUNCTION CURRENT-DATE(1:7)  TO  WS-COMPUTE-DATE.              
                                                                                
           MOVE 01                     TO WS-COMPUTE-DD.                        
           PERFORM 941-READ-AB03K050   THRU 941-EXIT.                           
                                                                                
      *==> TO GET INSTALMENT                                                    
           MOVE   'N'                    TO WS-S901-ERL.                        
           MOVE    F310-CDE-TYP-ACTUSE   TO WS-S901-RM.                         
           MOVE    F310-CDE-MODL-DESG    TO WS-S901-DESIGN.                     
           MOVE    25                    TO WS-S901-REPAY-PD.                   
                                                                                
           COMPUTE WS-S901-INT = WS-INTREST-RATE * 0.01.                        
                                                                                
           IF  WS-S901-INT IS NOT NUMERIC OR WS-S901-INT = ZERO                 
               MOVE 'INT.RATE = 0 IN BP13C901' TO  L657C-REMARK                 
               PERFORM  2500-SKIP-REC      THRU    2500-EXIT                    
               GO TO 500-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF  WS-S901-REPAY-PD IS NOT NUMERIC OR                               
               WS-S901-REPAY-PD = ZERO                                          
               MOVE 'REPAY-PD = 0 IN BP13C901' TO  L657C-REMARK                 
               PERFORM  2500-SKIP-REC      THRU    2500-EXIT                    
               GO TO 500-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF  WS-S901-FAC      IS NOT NUMERIC OR                               
               WS-S901-FAC  = ZERO                                              
               MOVE 'S901-FAC = 0 IN BP13C901' TO  L657C-REMARK                 
               PERFORM  2500-SKIP-REC      THRU    2500-EXIT                    
               GO TO 500-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE    WS-MAX-LOAN-AMT       TO WS-S901-LOAN-AMT.                   
           MOVE    ZEROES                TO WS-S901-ERL-LOAN-AMT.               
           CALL   'BP13C901' USING WS-LINK-S901.                                
           MOVE    WS-S901-MTH-INSTAL   TO WS-MTHLY-INSTAL.                     
           MOVE WS-MTHLY-INSTAL         TO 400C-MTHLY-INSTAL.                   
                                                                                
       940-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       941-READ-AB03K050.                                                       
      ******************************************************************        
            IF (K800-NUM-ALLO-SCHEME  = 'SPO' OR 'SPP' OR 'SSP' OR              
                                        'SPS' OR 'SRP')                         
               MOVE   'M'             TO  K050-CDE-LOAN-SCH                     
                                          WS-K050-CDE-LOAN-SCH                  
            ELSE                                                                
               MOVE   'P'             TO  K050-CDE-LOAN-SCH                     
                                          WS-K050-CDE-LOAN-SCH                  
            END-IF.                                                             
                                                                                
            MOVE  'N'                  TO    WS-K050-EOF.                       
            MOVE LOW-VALUES            TO    K050-DTE-INT-EFF.                  
                                                                                
            START  AB03K050  KEY > K050-KEY.                                    
                                                                                
            IF  AB03K050-STATUS NOT = 00                                        
               DISPLAY 'ERROR READING AB03K050, STATUS '                        
                                      AB03K050-STATUS                           
               MOVE AB03K050-STATUS TO RETURN-CODE                              
               PERFORM  1000-CLOSE-ROUTINE                                      
            END-IF.                                                             
                                                                                
            PERFORM  UNTIL K050-DTE-INT-EFF >= WS-COMPUTE-DATE                  
                       OR  WS-K050-EOF = 'Y'                                    
             MOVE  AB03K050-REC       TO     WS-AB03K050-REC                    
             READ  AB03K050  NEXT  AT END  MOVE 'Y'  TO  WS-K050-EOF            
                                           GO TO 941-CHECK-DATE                 
             END-READ                                                           
             IF AB03K050-STATUS NOT = 00                                        
               DISPLAY 'ERROR READING AB03K050, STATUS '                        
                                      AB03K050-STATUS                           
               MOVE AB03K050-STATUS TO RETURN-CODE                              
               PERFORM  1000-CLOSE-ROUTINE                                      
             END-IF                                                             
                                                                                
             IF  K050-CDE-LOAN-SCH NOT = WS-K050-CDE-LOAN-SCH                   
                 MOVE  'Y'      TO    WS-K050-EOF                               
             END-IF                                                             
           END-PERFORM.                                                         
                                                                                
       941-CHECK-DATE.                                                          
                                                                                
           IF  K050-DTE-INT-EFF  >  WS-COMPUTE-DATE OR                          
               WS-K050-CDE-LOAN-SCH NOT = K050-CDE-LOAN-SCH                     
               MOVE   WS-AB03K050-REC    TO    AB03K050-REC                     
           END-IF.                                                              
                                                                                
           IF  K050-DTE-INT-EFF IS NOT NUMERIC                                  
               DISPLAY 'NO RECORD MATCH IN AB03K050    '                        
               MOVE '99'            TO RETURN-CODE                              
               PERFORM  1000-CLOSE-ROUTINE                                      
           END-IF.                                                              
                                                                                
             MOVE K050-PCT-PA-INT        TO WS-INTREST-RATE                     
             MOVE K050-CDE-PA-FACTOR     TO WS-S901-FAC.                        
                                                                                
           MOVE 25                TO 400C-REPAY-PRD.                            
           MOVE WS-INTREST-RATE   TO 400C-INT-RATE.                             
                                                                                
       941-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       943-CALL-BP13C900.                                                       
      ******************************************************************        
           MOVE WS-TOTAL-CD              TO WS-S900-CD-PREV-PAID.               
           MOVE K110-CURR-SELLING-PRICE  TO WS-S900-SELL-PR.                    
           MOVE F310-CDE-TYP-ACTUSE      TO WS-S900-RM.                         
           MOVE F310-CDE-MODL-DESG       TO WS-S900-DESIGN.                     
           MOVE 25                       TO WS-S900-REPAY-PD.                   
           MOVE '10'                     TO WS-S900-SALE-TYPE.                  
           MOVE F310-CDE-SALES-TYPE      TO WS-S900-SALES-TYPE-SURVEY.          
           MOVE K110-CURR-SELLING-PRICE  TO WS-S900-ORIG-SELL.                  
           MOVE '00'                     TO WS-S900-PREMIUM-CODE.               
           MOVE ZEROS                    TO WS-S900-TOT-ICP.                    
                                                                                
           CALL 'BP13C900' USING WS-LINK-S900.                                  
                                                                                
           IF F310-CDE-SALES-TYPE = '03' OR '3A'                                
              MOVE ZEROES TO WS-S900-SURVEY-FEE                                 
                             WS-S900-SURVEY-FEE-GST                             
           END-IF.                                                              
                                                                                
           MOVE WS-S900-SURVEY-FEE       TO WS-COMP-SURVEY-FEE                  
                                            400C-SURVEY-FEE-ACT.                
           ADD  WS-S900-SURVEY-FEE-GST   TO WS-COMP-SURVEY-FEE.                 
           MOVE WS-S900-SURVEY-FEE-GST   TO 400C-SURVEY-FEE-GST.                
           MOVE WS-COMP-SURVEY-FEE       TO 400C-TOT-SURVEY-FEE.                
                                                                                
           COMPUTE WS-COMP-LEASE  =  WS-S900-LS-ESCROW-FEE +                    
                                     WS-S900-LS-REGN-FEE.                       
                                                                                
           MOVE WS-S900-MORT-ST-FEE     TO WS-MORT-STAMP-FEE.                   
                                                                                
           COMPUTE WS-COMP-MORTGAGE =  WS-S900-MORT-ESCROW-FEE +                
                                       WS-S900-MORT-REGN-FEE.                   
                                                                                
           MOVE WS-S900-LOAN          TO WS-LOAN-ROUND-DOWN.                    
                                                                                
       943-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       950-PROCESS-PRINT-WSHEET.                                                
      ******************************************************************        
      *==> PRINT PARTA                                                          
           MOVE F310-REGN-NO    TO   L211-REGN-NO.                              
           WRITE L657B-PRINT-REC FROM L310A-PR-HEAD-09 AFTER PAGE.              
           WRITE L657B-PRINT-REC FROM L310A-PR-HEAD-9A.                         
           WRITE L657B-PRINT-REC FROM L310A-PR-HEAD-10 AFTER 4.                 
           WRITE L657B-PRINT-REC FROM L310A-PR-HEAD-11 AFTER 2.                 
           WRITE L657B-PRINT-REC FROM L310A-PR-HEAD-12 AFTER 2.                 
           WRITE L657B-PRINT-REC FROM L310A-PR-HEAD-TOTAL AFTER 2.              
                                                                                
      *==> PRINT PARTB                                                          
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-1 AFTER 2.                  
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-2 AFTER 1.                  
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-2-B AFTER 1.                
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-3 AFTER 2.                  
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-4 AFTER 2.                  
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-5 AFTER 2.                  
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-6 AFTER 2.                  
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-7 AFTER 2.                  
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-8 AFTER 2.                  
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-9 AFTER 2.                  
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-10 AFTER 3.                 
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-11 AFTER 2.                 
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-12 AFTER 2.                 
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-13 AFTER 2.                 
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-14 AFTER 2.                 
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-15 AFTER 2.                 
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-16 AFTER 2.                 
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-17 AFTER 2.                 
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-18 AFTER 2.                 
                                                                                
      *==> PRINT NOTE                                                           
           MOVE  WS-EDITED-DATE  TO L310-SYS-DATE.                              
           WRITE L657B-PRINT-REC FROM L310A-PR-LINE-15 AFTER 10                 
           WRITE L657B-PRINT-REC FROM L310A-PR-LINE-16 AFTER 1.                 
           WRITE L657B-PRINT-REC FROM L310A-PR-LINE-17 AFTER 1.                 
           WRITE L657B-PRINT-REC FROM L400C-PR-LINE-19 AFTER 1.                 
                                                                                
       950-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       1000-CLOSE-ROUTINE.                                                      
      ******************************************************************        
            DISPLAY '                                        '.                 
            DISPLAY ' *****   BP13C657 CONTROL TOTALS   *****'.                 
            DISPLAY '                                        '.                 
            DISPLAY ' NO READ FROM F310 : ' WS-CNT-F310.                        
            DISPLAY ' NO READ FROM K110 : ' WS-CNT-K110.                        
            DISPLAY ' NO READ FROM K820 : ' WS-CNT-K820.                        
            DISPLAY ' NO READ FROM K830 : ' WS-CNT-K830.                        
            DISPLAY ' NO PROCESSED      : ' WS-CNT-PROC.                        
            DISPLAY ' NO PRINTED        : ' WS-CNT-LETTERS.                     
            DISPLAY ' NO SKIPPED        : ' WS-CNT-SKIPPED.                     
                                                                                
            CLOSE BP13F310                                                      
                  BP13K022                                                      
                  BP13K024                                                      
                  BP13K800                                                      
                  BP13K820                                                      
                  BP13K830                                                      
                  BM06K100                                                      
                  BM06K110                                                      
                  AB03K050                                                      
                  P13L657B                                                      
                  P13L657C                                                      
                  P13L657D.                                                     
                                                                                
            IF BP13K800-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BP13K800-STAT ' BP13K800-STATUS.          
            IF BP13K022-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BP13K022-STAT ' BP13K022-STATUS.          
            IF BP13K024-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BP13K024-STAT ' BP13K024-STATUS.          
            IF BP13K820-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BP13K820-STAT ' BP13K820-STATUS.          
            IF BP13K830-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BP13K830-STAT ' BP13K830-STATUS.          
            IF BM06K100-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BM06K100-STAT ' BM06K100-STATUS.          
            IF BM06K110-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BM06K110-STAT ' BM06K110-STATUS.          
                                                                                
            STOP RUN.                                                           
                                                                                
       1000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1500-COMPUTE-EXPIRY-DATE.                                                
      ******************************************************************        
      *--------------------------------------------------------*                
      *      ROUTINE TO COMPUTE THE EXPIRY DATE                *                
      *      IE. 2 MONTH AFTER THE BOOKING DATE                *                
      *--------------------------------------------------------*                
           MOVE     ZEROS                  TO     WS-NUM-FIELD.                 
           MOVE     K110-DTE-ACCEPTANCE    TO     WS-EXPIRY-DATE.               
           MOVE     WS-EXPIRY-DATE         TO     DATE-REC.                     
           PERFORM  1600-CHECK-DATE        THRU   1600-EXIT.                    
           ADD       2                     TO      CAL-MONTH.                   
                                                                                
           IF NOT VALID-MONTH                                                   
              SUBTRACT  12   FROM  CAL-MONTH                                    
              ADD       1    TO    CAL-YEAR.                                    
                                                                                
            PERFORM 1700-PROCESS-DATE  THRU   1700-EXIT.                        
            MOVE    DATE-REC           TO     WS-DTE-OPT-EXP.                   
                                                                                
       1500-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1600-CHECK-DATE.                                                         
      ******************************************************************        
            IF CAL-DATE   IS NUMERIC AND                                        
               VALID-DAY             AND                                        
               VALID-MONTH           AND                                        
               VALID-YEAR                                                       
               NEXT SENTENCE                                                    
            ELSE                                                                
               DISPLAY 'INVALID INPUT DATE : ' DATE-REC                         
               ADD      2          TO CAL-MONTH                                 
               MOVE     DATE-REC   TO WS-DTE-OPT-EXP.                           
                                                                                
       1600-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1700-PROCESS-DATE.                                                       
      ******************************************************************        
            IF 31-DAY-MONTH                                                     
               IF CAL-DAY IS NOT LESS THAN 32                                   
                  MOVE 31 TO CAL-DAY.                                           
                                                                                
            IF 30-DAY-MONTH                                                     
               IF CAL-DAY IS NOT LESS THAN 31                                   
                  MOVE 30 TO CAL-DAY.                                           
                                                                                
            IF 28-29-DAY-MONTH                                                  
               IF CAL-DAY IS LESS THAN 29                                       
                  GO TO 1700-EXIT                                               
               ELSE                                                             
                  PERFORM 1800-FEBRUARY                                         
            ELSE                                                                
               NEXT SENTENCE.                                                   
                                                                                
       1700-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1800-FEBRUARY.                                                           
      ******************************************************************        
            DIVIDE 4 INTO CAL-YEAR   GIVING WS-YEAR REMAINDER WS-REM.           
                                                                                
            IF WS-REM IS EQUAL TO ZERO AND CAL-DAY IS GREATER THAN 29           
               MOVE 29 TO CAL-DAY.                                              
                                                                                
            IF WS-REM IS NOT EQUAL TO ZERO                                      
                                   AND CAL-DAY IS GREATER THAN 28               
               MOVE 28 TO CAL-DAY.                                              
                                                                                
       1800-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       2500-SKIP-REC.                                                           
      ******************************************************************        
            IF   WS-SKIP-PR-LINE   >  55                                        
                  ADD       1       TO     WS-SKIP-PAGE-NO                      
                  PERFORM   2550-WRITE-HEADER    THRU  2550-EXIT                
            END-IF.                                                             
                                                                                
            MOVE   F310-REGN-NO          TO    L657C-REGN-NO.                   
            MOVE   WS-S901-REPAY-PD      TO    L657C-REPAY-PD.                  
            MOVE   WS-S901-FAC           TO    L657C-FAC.                       
            MOVE   WS-S901-INT           TO    L657C-INT.                       
            WRITE  P13L657C-REC          FROM  L657C-DETAIL.                    
            ADD    1                     TO    WS-SKIP-PR-LINE.                 
                                                                                
            ADD    1                     TO    WS-CNT-SKIPPED.                  
                                                                                
       2500-EXIT.                                                               
              EXIT.                                                             
                                                                                
                                                                                
      ******************************************************************        
       2550-WRITE-HEADER.                                                       
      ******************************************************************        
             WRITE  P13L657C-REC     FROM   L657C-HEADER-1 AFTER PAGE.          
                                                                                
             MOVE FUNCTION CURRENT-DATE(1:8)                                    
                                       TO WS-CUR-YYYYMMDD.                      
             MOVE WS-CUR-DD            TO WS-EDIT-DD.                           
             MOVE WS-CUR-MM            TO WS-EDIT-MM.                           
             MOVE WS-CUR-YYYY          TO WS-EDIT-YYYY.                         
             MOVE WS-EDITED-DATE       TO L657C-PRT-DATE.                       
                                                                                
             MOVE   WS-SKIP-PAGE-NO    TO     L657C-PAGE-NO.                    
             WRITE  P13L657C-REC       FROM   L657C-HEADER-2  AFTER 2.          
                                                                                
             MOVE   ALL '-'            TO     P13L657C-REC.                     
             WRITE  P13L657C-REC       AFTER 1.                                 
                                                                                
             WRITE  P13L657C-REC       FROM   L657C-HEADER-3  AFTER 1.          
                                                                                
             MOVE   ALL '-'            TO     P13L657C-REC.                     
             WRITE  P13L657C-REC       AFTER 1.                                 
                                                                                
       2550-EXIT.                                                               
              EXIT.                                                             
