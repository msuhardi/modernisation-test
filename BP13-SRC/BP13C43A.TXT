      *-----------------------*                                         00010000
       IDENTIFICATION DIVISION.                                         00020000
      *-----------------------*                                         00030000
       PROGRAM-ID.    BP13C43A.                                         00040000
      *AUTHOR.        JOHN BARCEGA.                                     00050000
      *DATE-WRITTEN.  26/08/13.                                         00060000
                                                                        00070000
      * ========================================================= *     00080000
      * SYSTEM OF COMMITMENT  (BP13)                              *     00090000
      * ========================================================= *     00100000
      *    OBJECTIVE :                                            *     00110000
      *      1. TO PRINT VOUCHER FOR STAMPING OF DBSS SUBTRANSFER *     00120000
      *         CASES (BP1343AJ)                                  *     00130000
      *                                                           *     00140000
      *    I/O FILES :                                            *     00150000
      *       INPUT  :  BP13F315 - TRANSACTION FILE (SEQ)         *     00160000
      *                 BP13K800 - SOC APPLICATION MASTER (VSAM)  *     00170000
      *      OUTPUT  :  BP13K625 - STAMP FEE MASTER (SEQ)         *     00180000
      *                 AG07F225 - STAMPING FILE    (SEQ)         *     00190000
      *                 BP1343AJ - STAMPING DOA FOR SOC FLAT      *     00200000
      *                                                           *     00210000
      * --------------------------------------------------------- *     00220000
      * CHG REF  DATE   BY   DESCRIPTIONS                         *     00230000
      * -------- ------ ---  ------------                         *     00240000
      * BP135032 260813 JGO1 STAMPING FOR DBSS SUBTRANSFER        *     00250000
      * BP135061 111113 JGO1 READ K410 AND K893 IF NOT IN K800    *     00260000
      * BP135061 151113 JGO1 FIX THE TRANSFER DATE BEING BLANK    *     00270000
      * BP135096 291113 JGO1 UPDATE VOUCHER FROM 'SU' TO 'SS'     *     00280000
      * BP135120 210714 JGO1 CHANGE OUTPUT FROM F220 TO F225      *     00290000
      * BP135437 120814 JGO1 CHANGE VOUCHER INFO                  *     00300000
      * BP135179 120821 JGO1 PASS DTE-SNP-RETURNED TO DTE AGRM    *     00310000
      * BP135520 241014 JGO1 SKIP EARMARK FOR ZERO AMOUNTS        *     00320000
      * BP135832 190515 JGO1 UPDATE VALUE PASSED TO F225 BANK     *     00330000
      * BP137140 101217 PCL4 TO REDEFINE AG07 FILE ERROR CODE     *     00340000
      * BP138339 070820 KR13 REMOVED P1343AJ1 - IOM8 CONVERSION.  *     00350000
      * BP139164 040522 KV8  INCLUDED ADDRESS AND COMMENTED STREET*     00351001
      * ========================================================= *     00360000
                                                                        00370000
      *----------------------*                                          00380000
       ENVIRONMENT DIVISION.                                            00390000
      *----------------------*                                          00400000
       CONFIGURATION SECTION.                                           00410000
       SOURCE-COMPUTER.   IBM-3090.                                     00420000
       OBJECT-COMPUTER.   IBM-3090.                                     00430000
                                                                        00440000
       INPUT-OUTPUT SECTION.                                            00450000
       FILE-CONTROL.                                                    00460000
                                                                        00470000
           SELECT B05K006   ASSIGN       TO B05K006                     00480000
                            ACCESS MODE  IS RANDOM                      00490000
                            ORGANIZATION IS INDEXED                     00500000
                            RECORD KEY   IS K006-HDB-REF-SF             00510000
                            FILE STATUS  IS WS-K006-STATUS.             00520000
                                                                        00530000
           SELECT BP13KD00  ASSIGN       TO BP13KD00                    00540000
                            ACCESS MODE  IS RANDOM                      00550000
                            ORGANIZATION IS INDEXED                     00560000
                            RECORD KEY   IS KD00-NUM-REGN               00570000
                            FILE STATUS  IS WS-KD00-STATUS.             00580000
                                                                        00590000
           SELECT BP13KD03  ASSIGN       TO BP13KD03                    00600000
                            ACCESS MODE  IS RANDOM                      00610000
                            ORGANIZATION IS INDEXED                     00620000
                            RECORD KEY   IS KD03-KEY-FLD                00630000
                            FILE STATUS  IS WS-KD03-STATUS.             00640000
                                                                        00650000
           SELECT BP13K410  ASSIGN       TO BP13K410                    00660000
                            ACCESS MODE  IS RANDOM                      00670000
                            ORGANIZATION IS INDEXED                     00680000
                            RECORD KEY   IS K410-KEY-FLD                00690000
                            FILE STATUS  IS WS-K410-STATUS.             00700000
                                                                        00710000
                                                                        00720000
           SELECT BP13K800  ASSIGN       TO BP13K800                    00730000
                            ACCESS MODE  IS RANDOM                      00740000
                            ORGANIZATION IS INDEXED                     00750000
                            RECORD KEY   IS K800-NUM-REGN               00760000
                            FILE STATUS  IS WS-K800-STATUS.             00770000
                                                                        00780000
                                                                        00790000
           SELECT BP13K893  ASSIGN       TO BP13K893                    00800000
                            ACCESS MODE  IS DYNAMIC                     00810000
                            ORGANIZATION IS INDEXED                     00820000
                            RECORD KEY   IS K893-KEY-FLD                00830000
                            FILE STATUS  IS WS-K893-STATUS.             00840000
                                                                        00850000
           SELECT BP13KD40  ASSIGN       TO BP13KD40                    00860000
                            ACCESS MODE  IS RANDOM                      00870000
                            ORGANIZATION IS INDEXED                     00880000
                            RECORD KEY   IS KD40-KEY-FLD                00890000
                            FILE STATUS  IS WS-KD40-STATUS.             00900000
                                                                        00910000
           SELECT BP13KD45  ASSIGN       TO BP13KD45                    00920000
                            ORGANIZATION IS INDEXED                     00930000
                            ACCESS MODE  IS DYNAMIC                     00940000
                            RECORD KEY   IS KD45-KEY-FLD                00950000
                            FILE STATUS  IS WS-KD45-STATUS.             00960000
                                                                        00970000
           SELECT BP13K625  ASSIGN       TO BP13K625                    00980000
                            ACCESS MODE  IS DYNAMIC                     00990000
                            ORGANIZATION IS INDEXED                     01000000
                            RECORD KEY   IS K625-KEY-FLD                01010000
                            FILE STATUS  IS WS-K625-STATUS.             01020000
                                                                        01030000
           SELECT BP13F315  ASSIGN       TO BP13F315.                   01040000
           SELECT AG07F225  ASSIGN       TO AG07F225.                   01050000
                                                                        01060000
           SELECT BP1343AJ  ASSIGN       TO BP1343AJ.                   01070000
           SELECT BP1343AK  ASSIGN       TO BP1343AK.                   01080000
                                                                        01090000
      *---------------*                                                 01100000
       DATA DIVISION.                                                   01110000
      *---------------*                                                 01120000
       FILE SECTION.                                                    01130000
      *---------------*                                                 01140000
                                                                        01150000
       FD   B05K006.                                                    01160000
       COPY B05K006.                                                    01170000
                                                                        01180000
       FD   BP13KD40                                                    01190000
            RECORD CONTAINS 1500 CHARACTERS.                            01200000
       COPY BP13KD40.                                                   01210000
                                                                        01220000
       FD   BP13KD00                                                    01230000
            RECORD CONTAINS 1600 CHARACTERS.                            01240000
       COPY BP13KD00.                                                   01250000
                                                                        01260000
       FD   BP13KD03                                                    01270000
            RECORD CONTAINS 1600 CHARACTERS.                            01280000
       COPY BP13KD03.                                                   01290000
                                                                        01300000
       FD   BP13K410                                                    01310000
            RECORD CONTAINS 2000 CHARACTERS.                            01320000
       COPY BP13K410.                                                   01330000
                                                                        01340000
       FD   BP13K800                                                    01350000
            RECORD CONTAINS 2000 CHARACTERS.                            01360000
       COPY BP13K800.                                                   01370000
                                                                        01380000
       FD   BP13K893                                                    01390000
            RECORD CONTAINS 2050 CHARACTERS.                            01400000
       COPY BP13K893.                                                   01410000
                                                                        01420000
       FD   BP13KD45                                                    01430000
            RECORD CONTAINS 1550 CHARACTERS.                            01440000
       COPY BP13KD45.                                                   01450000
                                                                        01460000
       FD   BP13K625                                                    01470000
            RECORD CONTAINS 500  CHARACTERS.                            01480000
       COPY BP13K625.                                                   01490000
                                                                        01500000
       FD   BP13F315                                                    01510000
            BLOCK  CONTAINS 0    RECORDS                                01520000
            RECORD CONTAINS 500  CHARACTERS                             01530000
            LABEL  RECORDS  ARE  STANDARD                               01540000
            RECORDING MODE  IS   F.                                     01550000
       COPY BP13F315.                                                   01560000
                                                                        01570000
       FD   AG07F225                                                    01580000
            RECORDING MODE  IS  F                                       01590000
            RECORD CONTAINS 600 CHARACTERS.                             01600000
       COPY AG07F225.                                                   01610000
      *FD   AG07F220                                                    01620000
      *     BLOCK  CONTAINS 0    RECORDS                                01630000
      *     RECORD CONTAINS 450  CHARACTERS                             01640000
      *     LABEL  RECORDS  ARE  STANDARD                               01650000
      *     RECORDING MODE  IS   F.                                     01660000
      *COPY AG07F220.                                                   01670000
                                                                        01680000
      *---------------------------------------                          01690000
      * LISTING FOR STAMPING DOA FOR SOC FLAT                           01700000
      *---------------------------------------                          01710000
       FD   BP1343AJ                                                    01720000
            RECORD CONTAINS 132 CHARACTERS                              01730000
            LABEL  RECORDS  ARE OMITTED                                 01740000
            RECORDING MODE  IS  F.                                      01750000
       01   L43AJ-PRINT-REC          PIC X(132).                        01760000
                                                                        01770000
       FD   BP1343AK                                                    01780000
            RECORD CONTAINS 132 CHARACTERS                              01790000
            LABEL  RECORDS  ARE OMITTED                                 01800000
            RECORDING MODE  IS  F.                                      01810000
       01   L43AK-PRINT-REC          PIC X(132).                        01820000
                                                                        01830000
      *------------------------*                                        01840000
       WORKING-STORAGE SECTION.                                         01850000
      *------------------------*                                        01860000
      *-----------------------------------------------------------*     01870000
      *    DEFINE HEADING LINES                                   *     01880000
      *-----------------------------------------------------------*     01890000
       01  PRT-L43A-HDG-1.                                              01900000
           05  L43A-REPORT-ID       PIC X(8)  VALUE SPACES.             01910000
           05  FILLER               PIC X(10) VALUE '      HDB3'.       01920000
           05  FILLER               PIC X(27) VALUE SPACES.             01930000
           05  FILLER               PIC X(39) VALUE                     01940000
               'S Y S T E M   O F   C O M M I T M E N T'.               01950000
           05  FILLER               PIC X(14) VALUE SPACES.             01960000
           05  FILLER               PIC X(7)  VALUE 'DATE : '.          01970000
           05  L43A-CURRENT-DATE    PIC X(10) VALUE SPACES.             01980000
           05  FILLER               PIC X(4)  VALUE SPACES.             01990000
           05  FILLER               PIC X(7)  VALUE 'PAGE : '.          02000000
           05  L43A-PAGE            PIC ZZZZ9.                          02010000
                                                                        02020000
       01  PRT-L43A-HDG-2.                                              02030000
           05  FILLER               PIC X(30) VALUE                     02040000
               'HOUSING AND DEVELOPMENT BOARD'.                         02050000
           05  FILLER               PIC X(20) VALUE SPACES.             02060000
           05  FILLER               PIC X(30) VALUE                     02070000
               'P A Y M E N T    V O U C H E R'.                        02080000
           05  FILLER               PIC X(25) VALUE SPACES.             02090000
           05  L43A-COPY-NAME       PIC X(20) VALUE SPACES.             02100000
                                                                        02110000
       01  PRT-L43A-HDG-3.                                              02120000
           05  L43A-REPORT-ID-DESC  PIC X(132).                         02130000
                                                                        02140000
       01  PRT-L43A-HDG-4.                                              02150000
           05  FILLER               PIC X(46) VALUE SPACES.             02160000
           05  FILLER               PIC X(85) VALUE ALL '-'.            02170000
                                                                        02180000
       01  PRT-L43A-HDG-5.                                              02190000
           05  FILLER               PIC X(46) VALUE                     02200000
               'SALES UNIT (AGREEMENT TEAM)'.                           02210000
           05  FILLER               PIC X(1)  VALUE '¦'.                02220000
           05  FILLER               PIC X(27) VALUE                     02230000
               ' FOR FINANCE DEPARTMENT USE'.                           02240000
           05  FILLER               PIC X(21) VALUE SPACES.             02250000
           05  FILLER               PIC X(17) VALUE                     02260000
               '¦  BATCH NO    : '.                                     02270000
           05  L43A-BATCH-NO        PIC X(14) VALUE SPACES.             02280000
           05  FILLER               PIC X(4)  VALUE SPACES.             02290000
           05  FILLER               PIC X(1)  VALUE '¦'.                02300000
                                                                        02310000
       01  PRT-L43A-HDG-6.                                              02320000
           05  FILLER               PIC X(46) VALUE SPACES.             02330000
           05  FILLER               PIC X(1)  VALUE '¦'.                02340000
           05  FILLER               PIC X(48) VALUE SPACES.             02350000
           05  FILLER               PIC X(1)  VALUE '¦'.                02360000
           05  FILLER               PIC X(34) VALUE SPACES.             02370000
           05  FILLER               PIC X(1)  VALUE '¦'.                02380000
                                                                        02390000
       01  PRT-L43A-HDG-7.                                              02400000
           05  FILLER               PIC X(46) VALUE 'SYSTEM CODE : 04'. 02410000
           05  FILLER               PIC X(14) VALUE '¦ CHECKED BY :'.   02420000
           05  FILLER               PIC X(35) VALUE SPACES.             02430000
           05  FILLER               PIC X(17) VALUE '¦  VOUCHER NO  :'. 02440000
           05  L43A-VOUCHER-NO      PIC X(14) VALUE SPACES.             02450000
           05  FILLER               PIC X(4)  VALUE SPACES.             02460000
           05  FILLER               PIC X(1)  VALUE '¦'.                02470000
                                                                        02480000
       01  PRT-L43A-HDG-8.                                              02490000
           05  FILLER               PIC X(46) VALUE                     02500000
              'GL CODE     : 0000000104250'.                            02510000
           05  FILLER               PIC X(85) VALUE ALL '-'.            02520000
                                                                        02530000
       01  PRT-L43A-HDG-9.                                              02540000
           05  FILLER               PIC X(46) VALUE                     02550000
              'DESCRIPTION : STAMP FEES'.                               02560000
                                                                        02570000
       01  PRT-L43A-HDG-10.                                             02580000
           05  FILLER               PIC X(53)   VALUE                   02590000
              'PAYABLE TO  : COMMISSIONER OF STAMP DUTIES         '.    02600000
           05  FILLER               PIC X(13)   VALUE  SPACES.          02610000
           05  FILLER               PIC X(20)   VALUE                   02620000
              'BANK   : DBS        '.                                   02630000
           05  FILLER               PIC X(11)   VALUE  SPACES.          02640000
           05  FILLER               PIC X(25)   VALUE                   02650000
              'BANK CODE   : DBSSSGSGXXX'.                              02660000
                                                                        02670000
       01  PRT-L43A-HDG-10A.                                            02680000
           05  FILLER               PIC X(24)   VALUE                   02690000
              'A/C NO      : 0010468600'.                               02700000
           05  FILLER               PIC X(42)   VALUE  SPACES.          02710000
                                                                        02720000
       01  PRT-L43A-HDG-11.                                             02730000
           05  FILLER               PIC X(11)   VALUE                   02740000
               'REMITTANCE '.                                           02750000
           05  FILLER               PIC X(55)   VALUE                   02760000
              'ADVICE  DESPATCH TO :  C/O SC(STAMPING) OF SALES UNIT'.  02770000
                                                                        02780000
      *-----------------------------------------------------------*     02790000
      *    DEFINE BP13L43AA & BP13L43AD SUB-HEADING LINES         *     02800000
      *-----------------------------------------------------------*     02810000
       01  PRT-L43A-SUBHDG-1.                                           02820000
           05  FILLER               PIC X(69) VALUE SPACES.             02830000
           05  FILLER               PIC X(19) VALUE                     02840000
               'DATE OF      DOA   '.                                   02850000
           05  FILLER               PIC X(6)  VALUE SPACES.             02860000
           05  FILLER               PIC X(6)  VALUE '  MORT'.           02870000
           05  FILLER               PIC X(16) VALUE SPACES.             02880000
           05  FILLER               PIC X(3)  VALUE 'DOC'.              02890000
           05  FILLER               PIC X(2)  VALUE SPACES.             02900000
                                                                        02910000
       01  PRT-L43A-SUBHDG-2.                                           02920000
           05  FILLER               PIC X(4)  VALUE 'S/NO'.             02930000
           05  FILLER               PIC X     VALUE SPACE.              02940000
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.       02950000
           05  FILLER               PIC X(5)  VALUE SPACES.             02960000
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.          02970000
           05  FILLER               PIC X     VALUE SPACE.              02980000
           05  FILLER               PIC X(5)  VALUE 'BLOCK'.            02990000
           05  FILLER               PIC X     VALUE SPACE.              03000000
           05  FILLER               PIC X(25) VALUE                     03010000
               'FLAT ADDRESS/STREET NAME'.                              03020000
           05  FILLER               PIC X(1)  VALUE SPACE.              03030000
           05  FILLER               PIC X(8)  VALUE 'FLAT NO'.          03040000
           05  FILLER               PIC X(8)  VALUE 'TRANSFER'.         03050000
           05  FILLER               PIC X(3)  VALUE SPACES.             03060000
           05  FILLER               PIC X(10) VALUE 'STAMP FEE '.       03070000
           05  FILLER               PIC X(3)  VALUE SPACES.             03080000
           05  FILLER               PIC X(9)  VALUE 'STAMP FEE'.        03090000
           05  FILLER               PIC X(5)  VALUE SPACES.             03100000
           05  FILLER               PIC X(7)  VALUE 'SSD AMT'.          03110000
           05  FILLER               PIC X(2)  VALUE SPACES.             03120000
           05  FILLER               PIC X(4)  VALUE 'TYPE'.             03130000
           05  FILLER               PIC X(3)  VALUE SPACES.             03140000
           05  FILLER               PIC X(5)  VALUE 'TOTAL'.            03150000
                                                                        03160000
       01  PRT-L43A-SUBHDG-3.                                           03170000
           05  FILLER               PIC X(4)  VALUE ALL '-'.            03180000
           05  FILLER               PIC X     VALUE SPACES.             03190000
           05  FILLER               PIC X(14) VALUE ALL '-'.            03200000
           05  FILLER               PIC X     VALUE SPACES.             03210000
           05  FILLER               PIC X(8)  VALUE ALL '-'.            03220000
           05  FILLER               PIC X     VALUE SPACES.             03230000
           05  FILLER               PIC X(5)  VALUE ALL '-'.            03240000
           05  FILLER               PIC X     VALUE SPACES.             03250000
           05  FILLER               PIC X(25) VALUE ALL '-'.            03260000
           05  FILLER               PIC X(1)  VALUE SPACES.             03270000
           05  FILLER               PIC X(7)  VALUE ALL '-'.            03280000
           05  FILLER               PIC X(1)  VALUE SPACES.             03290000
           05  FILLER               PIC X(9)  VALUE ALL '-'.            03300000
           05  FILLER               PIC X(2)  VALUE SPACES.             03310000
           05  FILLER               PIC X(10) VALUE ALL '-'.            03320000
           05  FILLER               PIC X(3)  VALUE SPACES.             03330000
           05  FILLER               PIC X(9)  VALUE ALL '-'.            03340000
           05  FILLER               PIC X(2)  VALUE SPACES.             03350000
           05  FILLER               PIC X(10) VALUE ALL '-'.            03360000
           05  FILLER               PIC X(2)  VALUE SPACES.             03370000
           05  FILLER               PIC X(4)  VALUE ALL '-'.            03380000
           05  FILLER               PIC X(3)  VALUE SPACES.             03390000
           05  FILLER               PIC X(10) VALUE ALL '-'.            03400000
                                                                        03410000
                                                                        03420000
      *-----------------------------------------------------------*     03430000
      *    DEFINE BP13L43AA & BP13L43AD DETAIL LINES              *     03440000
      *-----------------------------------------------------------*     03450000
       01  L43A-REC-DETAIL.                                             03460000
           05  L43A-SERIAL-NO               PIC ZZZ9.                   03470000
           05  FILLER                       PIC X     VALUE SPACE.      03480000
           05  L43A-SCH-ACC                 PIC X(14) VALUE SPACES.     03490000
           05  FILLER                       PIC X     VALUE SPACE.      03500000
           05  L43A-REGN-NO                 PIC X(8)  VALUE SPACES.     03510000
           05  FILLER                       PIC X     VALUE SPACE.      03520000
           05  L43A-BLKNO                   PIC X(5)  VALUE SPACES.     03530000
           05  FILLER                       PIC X     VALUE SPACE.      03540000
           05  L43A-STREET                  PIC X(25) VALUE SPACES.     03550000
           05  FILLER                       PIC X     VALUE SPACE.      03560000
           05  L43A-FLATNO                  PIC X(7)  VALUE SPACES.     03570000
           05  FILLER                       PIC X     VALUE SPACE.      03580000
           05  L43A-SALE-DD                 PIC X(2)  VALUE SPACES.     03590000
           05  L43A-DASH1                   PIC X     VALUE SPACE.      03600000
           05  L43A-SALE-MM                 PIC X(2)  VALUE SPACES.     03610000
           05  L43A-DASH2                   PIC X     VALUE SPACE.      03620000
           05  L43A-SALE-CC                 PIC X(2)  VALUE SPACES.     03630000
           05  L43A-SALE-YY                 PIC X(2)  VALUE SPACES.     03640000
           05  FILLER                       PIC X(1)  VALUE SPACES.     03650000
           05  L43A-DOA-AMT                 PIC $$$,$$9.99.             03660000
           05  FILLER                       PIC X(2)  VALUE SPACES.     03670000
           05  L43A-MORT-STAMP              PIC $$$,$$9.99.             03680000
           05  FILLER                       PIC X(2)  VALUE SPACES.     03690000
           05  L43A-SSD-AMT                 PIC $$$,$$9.99.             03700000
           05  FILLER                       PIC X(2)  VALUE SPACES.     03710000
           05  L43A-DOC-TYPE                PIC X(3)  VALUE SPACES.     03720000
           05  L43A-TAG                     PIC X(1)  VALUE SPACES.     03730000
           05  FILLER                       PIC X(1)  VALUE SPACES.     03740000
           05  L43A-DETL-AMT-TOTAL          PIC $$$$,$$9.99.            03750000
                                                                        03760000
      *-----------------------------------------------------------*     03770000
      *    DEFINE BP13L43AA & BP13L43AD TOTAL LINES               *     03780000
      *-----------------------------------------------------------*     03790000
       01  PRT-L43A-DASH-LINE.                                          03800000
           05  FILLER                       PIC X(78)   VALUE SPACES.   03810000
           05  FILLER                       PIC X(54)   VALUE ALL '='.  03820000
                                                                        03830000
       01  PRT-L43A-TOTAL-LINE.                                         03840000
           05  FILLER                       PIC X(35) VALUE SPACES.     03850000
           05  FILLER                       PIC X(13) VALUE             03860000
               'SERIAL NO : ('.                                         03870000
           05  L43A-VR-NO-LOW               PIC X(4)  VALUE '0001'.     03880000
           05  FILLER                       PIC X(4)  VALUE ' TO '.     03890000
           05  L43A-VR-NO-HIGH              PIC X(4)  VALUE '0025'.     03900000
           05  FILLER                       PIC X(4)  VALUE ')'.        03910000
           05  FILLER                       PIC X(14) VALUE 'TOTAL :'.  03920000
           05  L43A-TOTAL-DOA-AMT           PIC $,$$$,$$9.99.           03930000
           05  FILLER                       PIC X(2)  VALUE SPACES.     03940000
           05  L43A-TOTAL-MORT-STAMP        PIC $$$,$$9.99.             03950000
           05  L43A-TOTAL-SSD-AMT           PIC $,$$$,$$9.99.           03960000
           05  FILLER                       PIC X(6)  VALUE SPACES.     03970000
           05  L43A-TOTAL-AMT               PIC $,$$$,$$9.99.           03980000
                                                                        03990000
      *-----------------------------------------------------------*     04000000
      *    DEFINE FOOTING LINES                                   *     04010000
      *-----------------------------------------------------------*     04020000
       01  PRT-L43A-FTG-1.                                              04030000
           05  FILLER              PIC X(15)   VALUE 'NET PAYABLE  : '. 04040000
           05  L43A-AMT-WORDS.                                          04050000
               10  L43A-AMT-DESC1  PIC X(60)   VALUE SPACES.            04060000
               10  L43A-AMT-DESC2  PIC X(60)   VALUE SPACES.            04070000
                                                                        04080000
       01  PRT-L43A-FTG-2.                                              04090000
           05  FILLER              PIC X(35)   VALUE SPACES.            04100000
           05  FILLER              PIC X(14)   VALUE 'CHECKED BY :'.    04110000
           05  FILLER              PIC X(15)   VALUE ALL '_'.           04120000
           05  FILLER              PIC X(10)   VALUE SPACES.            04130000
           05  FILLER              PIC X(16)   VALUE 'CERTIFIED BY :'.  04140000
           05  FILLER              PIC X(15)   VALUE ALL '_'.           04150000
                                                                        04160000
      *-----------------------------------------------------------*     04170000
      *    DEFINE BP13L43A  HEADING LINES                         *     04180000
      *-----------------------------------------------------------*     04190000
       01  MAIN-HEADER.                                                 04200000
           05  HEADER-LISTID             PIC X(8)  VALUE SPACES.        04210000
           05  FILLER                    PIC X(16) VALUE SPACES.        04220000
           05  FILLER                    PIC X(4)  VALUE 'HDB3'.        04230000
           05  FILLER                    PIC X(16) VALUE SPACES.        04240000
           05  FILLER                    PIC X(39) VALUE                04250000
               'S Y S T E M   O F   C O M M I T M E N T'.               04260000
           05  FILLER                    PIC X(16) VALUE SPACES.        04270000
           05  FILLER                    PIC X(7)  VALUE 'DATE : '.     04280000
           05  HEADER-DATE               PIC X(10).                     04290000
           05  FILLER                    PIC X(4)  VALUE SPACES.        04300000
           05  FILLER                    PIC X(7)  VALUE 'PAGE : '.     04310000
           05  HEADER-PAGE               PIC ZZZZ9.                     04320000
                                                                        04330000
      *-----------------------------------------------------------*     04340000
      *    DEFINE BP1343AK REPORT LINES                           *     04350000
      *-----------------------------------------------------------*     04360000
       01  L43AK-HEADER2.                                               04370000
           05  FILLER                    PIC X(47) VALUE SPACES.        04380000
           05  FILLER                    PIC X(35)  VALUE               04390000
               'REPORT ON CASES WITH EARMARK ERROR'.                    04400000
                                                                        04410000
       01  L43AK-HEADER3.                                               04420000
           05  FILLER               PIC X(4)  VALUE 'S/NO'.             04430000
           05  FILLER               PIC X(3)  VALUE SPACE.              04440000
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.       04450000
           05  FILLER               PIC X(9)  VALUE SPACES.             04460000
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.          04470000
           05  FILLER               PIC X(5)  VALUE SPACE.              04480000
           05  FILLER               PIC X(13) VALUE 'JR VOUCHER NO'.    04490000
           05  FILLER               PIC X(5)  VALUE SPACES.             04500000
           05  FILLER               PIC X(12) VALUE 'TOTAL AMOUNT'.     04510000
           05  FILLER               PIC X(4)  VALUE SPACES.             04520000
           05  FILLER               PIC X(17) VALUE 'ERROR DESCRIPTION'.04530000
                                                                        04540000
       01  L43AK-REC-DETAIL.                                            04550000
           05  L43AK-SERIAL-NO              PIC ZZZ9.                   04560000
           05  FILLER                       PIC X(3)  VALUE SPACE.      04570000
           05  L43AK-SCH-ACC                PIC X(14) VALUE SPACES.     04580000
           05  FILLER                       PIC X(5)  VALUE SPACE.      04590000
           05  L43AK-REGN-NO                PIC X(8)  VALUE SPACES.     04600000
           05  FILLER                       PIC X(5)  VALUE SPACE.      04610000
           05  L43AK-JR-VCHR-NO             PIC X(13) VALUE SPACES.     04620000
           05  FILLER                       PIC X(5)  VALUE SPACES.     04630000
           05  L43AK-AMT-TOTAL              PIC $$$$,$$9.99.            04640000
           05  FILLER                       PIC X(5)  VALUE SPACES.     04650000
           05  L43AK-ERROR-DESC             PIC X(30).                  04660000
                                                                        04670000
       01  L43AK-UNDERLINE                  PIC X(132) VALUE ALL '-'.   04680000
                                                                        04690000
      *-----------------------------------------------------------*     04700000
      *    DEFINE ERROR MESSAGE FORMAT                            *     04710000
      *-----------------------------------------------------------*     04720000
       01  WS-ERRMSG-HEADER.                                            04730000
           05  FILLER                       PIC X(46) VALUE             04740000
               ' *************   ERROR MESSAGE   *************'.        04750000
                                                                        04760000
       01  WS-ERROR.                                                    04770000
           05  FILLER                       PIC X(24) VALUE             04780000
               ' ERROR ENCOUNTERED WHEN '.                              04790000
           05  WS-CUR-PROC                  PIC X(21).                  04800000
                                                                        04810000
       01  WS-FILE-STATUS.                                              04820000
           05  FILLER                       PIC X(15) VALUE             04830000
               ' STATUS CODE = '.                                       04840000
           05  WS-CUR-STATUS                PIC X(2).                   04850000
                                                                        04860000
      *-----------------------------------------------------------*     04870000
      *    DEFINE SUMMARY FORMAT                                  *     04880000
      *-----------------------------------------------------------*     04890000
       01  WS-SUMMARY-HEADER.                                           04900000
           05  FILLER                       PIC X     VALUE SPACES.     04910000
           05  FILLER                       PIC X(16) VALUE ALL '*'.    04920000
           05  FILLER                       PIC X(20) VALUE             04930000
               'BP13C43A SUMMARY RPT'.                                  04940000
           05  FILLER                       PIC X(19) VALUE ALL '*'.    04950000
                                                                        04960000
       01  WS-READ-CASES.                                               04970000
           05  FILLER                       PIC X(52) VALUE             04980000
               ' NO OF RECORDS READ FROM TRANS FILE  (BP13F315) = '.    04990000
           05  WS-EDIT-BP13F315-READ        PIC ZZZ9.                   05000000
                                                                        05010000
       01  WS-DOA-PAYMENT-PRINTED.                                      05020000
           05  FILLER                       PIC X(52) VALUE             05030000
               ' NO OF DOA PAYMENTS   (BP13L43AA)               = '.    05040000
           05  WS-EDIT-L43AA-PRINT          PIC ZZZ9.                   05050000
                                                                        05060000
       01  WS-L43AJ-PRINTED.                                            05070000
           05  FILLER                       PIC X(52) VALUE             05080000
               ' NO OF                (BP13L43AJ)               = '.    05090000
           05  WS-EDIT-L43AJ-PRINT          PIC ZZZ9.                   05100000
                                                                        05110000
       01  WS-STAMP-FEES-REC-WRITTEN.                                   05120000
           05  FILLER                       PIC X(52) VALUE             05130000
               ' NO OF RECORDS WRITTEN TO STAMP FILE (AG07F225) = '.    05140000
           05  WS-EDIT-AG07F225-WRITE       PIC ZZZ9.                   05150000
                                                                        05160000
       01  WS-SUMMARY-TRAILER.                                          05170000
           05  FILLER                       PIC X     VALUE SPACES.     05180000
           05  FILLER                       PIC X(55) VALUE ALL '*'.    05190000
                                                                        05200000
      *-----------------------------------------------------------*     05210000
      *    CONSTANTS LIST                                         *     05220000
      *-----------------------------------------------------------*     05230000
       01  WS-ERROR-PROCEDURE-NAMES.                                    05240000
           05  CLOSE-K006                   PIC X(21) VALUE             05250000
                   'CLOSING FILE  B05K006'.                             05260000
           05  CLOSE-KD40                   PIC X(21) VALUE             05270000
                   'CLOSING FILE BP13KD40'.                             05280000
           05  CLOSE-KD45                   PIC X(21) VALUE             05290000
                   'CLOSING FILE BP13KD45'.                             05300000
           05  CLOSE-K625                   PIC X(21) VALUE             05310000
                   'CLOSING FILE BP13K625'.                             05320000
           05  NOTFND-IN-FIS                PIC X(23) VALUE             05330000
                   'REC NOT FOUND IN K315'.                             05340000
           05  NOTFND-IN-MST                PIC X(23) VALUE             05350000
                   'REC NOT FOUND IN K006'.                             05360000
           05  OPEN-K006                    PIC X(21) VALUE             05370000
                   'OPENING FILE  B05K006'.                             05380000
           05  OPEN-K800                    PIC X(21) VALUE             05390000
                   'OPENING FILE BP13K800'.                             05400000
           05  OPEN-K410                    PIC X(21) VALUE             05410000
                   'OPENING FILE BP13K800'.                             05420000
           05  OPEN-K893                    PIC X(21) VALUE             05430000
                   'OPENING FILE BP13K800'.                             05440000
           05  OPEN-KD00                    PIC X(21) VALUE             05450000
                   'OPENING FILE BP13KD00'.                             05460000
           05  OPEN-KD03                    PIC X(21) VALUE             05470000
                   'OPENING FILE BP13KD03'.                             05480000
           05  OPEN-KD40                    PIC X(21) VALUE             05490000
                   'OPENING FILE BP13KD40'.                             05500000
           05  OPEN-KD45                    PIC X(21) VALUE             05510000
                   'OPENING FILE BP13KD45'.                             05520000
           05  OPEN-K625                    PIC X(21) VALUE             05530000
                   'OPENING FILE BP13K625'.                             05540000
           05  READ-F315                    PIC X(21) VALUE             05550000
                   'READING FILE BP13F315'.                             05560000
           05  WRITE-K625                   PIC X(21) VALUE             05570000
                   'WRITING FILE BP13K625'.                             05580000
           05  READ-K006                    PIC X(21) VALUE             05590000
                   'READING FILE  B05K006'.                             05600000
           05  READ-KD40                    PIC X(21) VALUE             05610000
                   'READING FILE BP13KD40'.                             05620000
           05  READ-KD45                    PIC X(21) VALUE             05630000
                   'READING FILE BP13KD45'.                             05640000
           05  READ-K625                    PIC X(21) VALUE             05650000
                   'READING FILE BP13K625'.                             05660000
           05  START-KD45                   PIC X(21) VALUE             05670000
                   'STARTBR FILE BP13KD45'.                             05680000
           05  START-KD03                   PIC X(21) VALUE             05690000
                   'STARTBR FILE BP13KD03'.                             05700000
                                                                        05710000
       01  HYPHEN                           PIC X     VALUE '-'.        05720000
       01  MAX-REC-PER-PAGE                 PIC 9(2)  VALUE 39.         05730000
       01  MAX-DETLS-PER-PAGE               PIC 9(3)  VALUE 25.         05740000
                                                                        05750000
      *-----------------------------------------------------------*     05760000
      *    LEVEL-88 VARIABLES                                     *     05770000
      *-----------------------------------------------------------*     05780000
       01  WS-EOF                           PIC X     VALUE 'N'.        05790000
           88  END-OF-BP13F315                        VALUE 'Y'.        05800000
       01  WS-REPORT-ID-SW                  PIC X(1)  VALUE SPACE.      05810000
       01  WS-PREV-REPORT-ID                PIC X(1)  VALUE SPACE.      05820000
           88  REPORT-L43AJ                           VALUE 'J'.        05830000
                                                                        05840000
      *-----------------------------------------------------------*     05850000
      *    OTHER VARIABLES                                        *     05860000
      *-----------------------------------------------------------*     05870000
       01  WS-COUNTERS.                                                 05880000
           05  WS-BP13F315-READ-CNT         PIC 9(4)    VALUE ZEROS.    05890000
           05  WS-AG07-STATUS               PIC 9(2)    VALUE ZEROS.    05900000
           05  WS-AG07-STAT-X REDEFINES WS-AG07-STATUS PIC X(2).        05910000
           05  WS-BP13K625-WRITE-CNT        PIC 9(4)    VALUE ZEROES.   05920000
           05  WS-AG07F225-WRITE-CNT        PIC 9(4)    VALUE ZEROES.   05930000
      *    -----------------------                                      05940000
      *    FOR L43AJ -     LISTING                                      05950000
      *    -----------------------                                      05960000
           05  WS-L43AJ-PRINT-CNT           PIC 9(4)    VALUE ZEROS.    05970000
           05  WS-L43AJ-PAGE-CNT            PIC 9(5)    VALUE ZEROS.    05980000
           05  WS-L43AJ-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.       05990000
           05  WS-L43AJ-DOA-CNT             PIC 9(7)V99 VALUE ZEROS.    06000000
           05  WS-L43AJ-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.    06010000
           05  WS-L43AJ-SSD-CNT             PIC 9(7)V99 VALUE ZEROS.    06020000
           05  WS-L43AJ-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.    06030000
                                                                        06040000
      *    --------------------------                                   06050000
      *    FOR L43AK - ERROR LISTING                                    06060000
      *    --------------------------                                   06070000
           05  WS-L43AK-PRINT-CNT           PIC 9(4)    VALUE ZEROS.    06080000
           05  WS-L43AK-PAGE-CNT            PIC 9(5)    VALUE ZEROS.    06090000
           05  WS-L43AK-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.       06100000
                                                                        06110000
       01  WS-FLATNO.                                                   06120000
           05  WS-NUM-LEVEL                 PIC X(2).                   06130000
           05  FILLER                       PIC X       VALUE '-'.      06140000
           05  WS-NUM-MAIN                  PIC X(5).                   06150000
                                                                        06160000
       01  WS-SCH-ACC.                                                  06170000
           05  WS-SCH                       PIC X(4).                   06180000
           05  WS-SCH-SEP1                  PIC X.                      06190000
           05  WS-ACC                       PIC X(4).                   06200000
           05  WS-SCH-SEP2                  PIC X.                      06210000
           05  WS-CHK                       PIC X.                      06220000
           05  WS-SCH-SEP3                  PIC X.                      06230000
           05  WS-LESCDE                    PIC X(2).                   06240000
                                                                        06250000
       01  WS-F315-ACC-CHK.                                             06260000
           05  WS-F315-ACC                  PIC X(4).                   06270000
           05  WS-F315-CHK                  PIC X(1).                   06280000
                                                                        06290000
       01  WS-AO-DATE.                                                  06300000
           05  WS-AO-CC                     PIC X(2).                   06310000
           05  WS-AO-YY                     PIC X(2).                   06320000
           05  WS-AO-MM                     PIC X(2).                   06330000
           05  WS-AO-DD                     PIC X(2).                   06340000
                                                                        06350000
       01  WS-SALE-DATE.                                                06360000
           05  WS-SALE-CC                   PIC X(2).                   06370000
           05  WS-SALE-YY                   PIC X(2).                   06380000
           05  WS-SALE-MM                   PIC X(2).                   06390000
           05  WS-SALE-DD                   PIC X(2).                   06400000
                                                                        06410000
       01  WS-TEMPORARY-BUFFER.                                         06420000
           05  WS-TEMP-TOTAL                PIC 9(7)V99.                06430000
           05  WS-TEMP-DIFF                 PIC 9(7)V99.                06440000
                                                                        06450000
       01  WS-BLANK-LINE                    PIC X     VALUE SPACES.     06460000
                                                                        06470000
       01  WS-F315-STATUS                   PIC 9(2)  VALUE ZEROS.      06480000
       01  WS-K006-STATUS                   PIC 9(2)  VALUE ZEROS.      06490000
       01  WS-K410-STATUS                   PIC 9(2)  VALUE ZEROS.      06500000
       01  WS-K800-STATUS                   PIC 9(2)  VALUE ZEROS.      06510000
       01  WS-K893-STATUS                   PIC 9(2)  VALUE ZEROS.      06520000
       01  WS-KD00-STATUS                   PIC 9(2)  VALUE ZEROS.      06530000
       01  WS-KD03-STATUS                   PIC 9(2)  VALUE ZEROS.      06540000
       01  WS-KD40-STATUS                   PIC 9(2)  VALUE ZEROS.      06550000
       01  WS-KD45-STATUS                   PIC 9(2)  VALUE ZEROS.      06560000
       01  WS-K625-STATUS                   PIC 9(2)  VALUE ZEROS.      06570000
       01  WS-K625-EOF                      PIC X(1)  VALUE 'N'.        06580000
       01  WS-KD45-EOF                      PIC X(1)  VALUE 'N'.        06590000
       01  WS-DOA-AMT                       PIC S9(5)V99 VALUE ZEROS.   06600000
       01  WS-MORT-STAMP                    PIC S9(5)V99 VALUE ZEROS.   06610000
       01  WS-SSD-AMT                       PIC S9(5)V99 VALUE ZEROS.   06620000
       01  WS-LEASE-STAMP                   PIC S9(5)V99 VALUE ZEROS.   06630000
       01  WS-ANNUAL-RENT                   PIC 9(7)V99.                06640000
       01  WS-LOAN-GRANTED                  PIC 9(7)V99.                06650000
       01  WS-SELL-PRICE                    PIC 9(8)  VALUE ZEROES.     06660000
       01  WS-LEASE-AMT                     PIC 9(10)V99 VALUE ZEROES.  06670000
       01  WS-NUM-HDB-REF                   PIC X(11) VALUE SPACES.     06680000
       01  WS-NUM-DOC                       PIC X(3)  VALUE SPACES.     06690000
       01  WS-NUM-DOC-TYP                   PIC X(1)  VALUE SPACES.     06700000
       01  WS-NUM-DOC-CNT                   PIC 9(1)  VALUE ZEROES.     06710000
       01  WS-AMT-STAMP-DUTY                PIC 9(13)V99 VALUE ZEROES.  06720000
       01  WS-AMT-STAMP-DUTY-DUP            PIC 9(13)V99 VALUE ZEROES.  06730000
       01  WS-AMT-EARMARK                   PIC 9(10)V99 VALUE ZEROES.  06740000
       01  WS-EM-LEASE-STAMP                PIC S9(5)V99 VALUE ZEROS.   06750000
       01  WS-EM-MORT-SF                    PIC S9(5)V99 VALUE ZEROS.   06760000
       01  WS-EM-SUP-SF                     PIC S9(5)V99 VALUE ZEROS.   06770000
       01  WS-EM-DUP-DOA                    PIC 9(2)V99  VALUE ZEROS.   06780000
       01  WS-KD03-FND                      PIC X(1)    VALUE 'N'.      06790000
           88  KD03-FND                     VALUE 'Y'.                  06800000
       01  WS-K893-FND                      PIC X(1)    VALUE 'N'.      06810000
           88  K893-FND                     VALUE 'Y'.                  06820000
       01  WS-K893-EOF                      PIC X(1)    VALUE 'N'.      06830000
           88  K893-EOF                     VALUE 'Y'.                  06840000
                                                                        06850000
      *----------------------------------------------------------*      06860000
      *    WS VARIABLES USED BY F225                             *      06870000
      *----------------------------------------------------------*      06880000
       01  WS-NEW-VOUCHER                   PIC X      VALUE 'Y'.       06890000
       01  WS-NEW-BATCH                     PIC X      VALUE 'Y'.       06900000
       01  WS-NEW-HEADER                    PIC X      VALUE 'Y'.       06910000
       01  WS-DTE-SALE-AGRM                 PIC X(08)  VALUE SPACES.    06920000
       01  WS-NUM-VOUCHER                   PIC X(11)  VALUE SPACES.    06930000
       01  WS-NUM-BATCH-TYPE                PIC X(4)   VALUE SPACES.    06940000
       01  WS-NUM-FIN-YEAR                  PIC 9(4)   VALUE ZEROES.    06950000
       01  WS-NUM-BATCH-SERIAL              PIC 9(5)   VALUE ZEROES.    06960000
       01  WS-SCH-ACCT-NO                   PIC X(11)  VALUE SPACES.    06970000
       01  WS-TXT-INFO                      PIC X(50)  VALUE SPACES.    06980000
       01  WS-NME-FIN-SOLICITOR             PIC X(50)  VALUE SPACES.    06990000
       01  WS-STAFF-START                   PIC X(9) VALUE '29586H   '. 07000000
       01  WS-CNT-DETAILS                   PIC 9(4)   VALUE ZEROES.    07010000
       01  WS-AMT-TRANS                     PIC 9(7)V99 VALUE ZEROES.   07020000
       01  WS-AMT-TOTAL                     PIC 9(7)V99 VALUE ZEROES.   07030000
       01  WS-PREV-SA-TP-TAG                PIC X(1)   VALUE SPACE.     07040000
       01  WS-PREV-PROJ-CODE                PIC X(3)   VALUE SPACE.     07050000
       01  WS-EDITED-VOUCHER-NO.                                        07060000
           05  WS-EDITED-NUM-DDD            PIC X(3)   VALUE SPACES.    07070000
           05  FILLER                       PIC X(1)   VALUE '-'.       07080000
           05  WS-EDITED-NUM-FIN-YEAR       PIC X(2)   VALUE SPACES.    07090000
           05  FILLER                       PIC X(1)   VALUE '-'.       07100000
           05  WS-EDITED-NUM-VR-SERIAL      PIC X(6)   VALUE SPACES.    07110000
       01  WS-L43AJ-DESC.                                               07120000
           05  FILLER                       PIC X(38)  VALUE SPACES.    07130000
           05  FILLER                       PIC X(42)  VALUE            07140000
              '            STAMPING FOR DBSS SUBTRANSFER '.             07150000
           05  FILLER                       PIC X(17)  VALUE            07160000
              '                 '.                                      07170000
       01  WS-L43AJL-DESC.                                              07180000
           05  FILLER                       PIC X(47)  VALUE SPACES.    07190000
           05  FILLER                       PIC X(42)  VALUE            07200000
              'LEASE PREPARATION FEES TO SOLICITOR       '.             07210000
                                                                        07220000
      *----------------------------------------------------------*      07230000
      *    WS VARIABLES PASSED FROM SUB-PROGRAM "AG07C907"       *      07240000
      *----------------------------------------------------------*      07250000
       COPY AG7C907C.                                                   07260000
                                                                        07270000
      *----------------------------------------------------------*      07280000
      *    WS VARIABLES PASSED FROM SUB-PROGRAM "BP13C906"       *      07290000
      *----------------------------------------------------------*      07300000
       COPY P13C906C.                                                   07310000
                                                                        07320000
      *----------------------------------------------------------*      07330000
      *    WS VARIABLES PASSED FROM SUB-PROGRAM "AB05C902"       *      07340000
      *----------------------------------------------------------*      07350000
       COPY AB05902C.                                                   07360000
                                                                        07370000
      *----------------------------------------------------------*      07380000
      *    WS VARIABLES FOR CONVERTING AMOUNT TO WORDS           *      07390000
      *----------------------------------------------------------*      07400000
       01  WS-SUBSCRIPTS.                                               07410000
           05  WA-SUB              PIC 999   VALUE 0.                   07420000
           05  WF-SUB              PIC 999   VALUE 0.                   07430000
           05  WL-SUB              PIC 999   VALUE 0.                   07440000
           05  WS-SUB              PIC 999   VALUE 0.                   07450000
           05  WS-FIRST-SUB        PIC 999   VALUE 0.                   07460000
                                                                        07470000
       01  WA-NAMES.                                                    07480000
           05  FILLER              PIC X(10) VALUE '3ONE      '.        07490000
           05  FILLER              PIC X(10) VALUE '3TWO      '.        07500000
           05  FILLER              PIC X(10) VALUE '5THREE    '.        07510000
           05  FILLER              PIC X(10) VALUE '4FOUR     '.        07520000
           05  FILLER              PIC X(10) VALUE '4FIVE     '.        07530000
           05  FILLER              PIC X(10) VALUE '3SIX      '.        07540000
           05  FILLER              PIC X(10) VALUE '5SEVEN    '.        07550000
           05  FILLER              PIC X(10) VALUE '5EIGHT    '.        07560000
           05  FILLER              PIC X(10) VALUE '4NINE     '.        07570000
           05  FILLER              PIC X(10) VALUE '3TEN      '.        07580000
           05  FILLER              PIC X(10) VALUE '6ELEVEN   '.        07590000
           05  FILLER              PIC X(10) VALUE '6TWELVE   '.        07600000
           05  FILLER              PIC X(10) VALUE '8THIRTEEN '.        07610000
           05  FILLER              PIC X(10) VALUE '8FOURTEEN '.        07620000
           05  FILLER              PIC X(10) VALUE '7FIFTEEN  '.        07630000
           05  FILLER              PIC X(10) VALUE '7SIXTEEN  '.        07640000
           05  FILLER              PIC X(10) VALUE '9SEVENTEEN'.        07650000
           05  FILLER              PIC X(10) VALUE '8EIGHTEEN '.        07660000
           05  FILLER              PIC X(10) VALUE '8NINETEEN '.        07670000
           05  FILLER              PIC X(10) VALUE '6TWENTY   '.        07680000
           05  FILLER              PIC X(10) VALUE '6THIRTY   '.        07690000
           05  FILLER              PIC X(10) VALUE '5FORTY    '.        07700000
           05  FILLER              PIC X(10) VALUE '5FIFTY    '.        07710000
           05  FILLER              PIC X(10) VALUE '5SIXTY    '.        07720000
           05  FILLER              PIC X(10) VALUE '7SEVENTY  '.        07730000
           05  FILLER              PIC X(10) VALUE '6EIGHTY   '.        07740000
           05  FILLER              PIC X(10) VALUE '6NINETY   '.        07750000
       01  WA-NAMER REDEFINES WA-NAMES.                                 07760000
           05  WA-NAME             PIC X(10) OCCURS 27 TIMES.           07770000
                                                                        07780000
       01  WS-LITERALS.                                                 07790000
           05  L-CENT              PIC X(5)  VALUE '4CENT'.             07800000
           05  L-AND               PIC X(4)  VALUE '3AND'.              07810000
           05  L-X                 PIC X     VALUE '%'.                 07820000
           05  L-MILLION           PIC X(8)  VALUE '7MILLION'.          07830000
           05  L-THOUSAND          PIC X(9)  VALUE '8THOUSAND'.         07840000
           05  L-DOLLARS           PIC X(8)  VALUE '7DOLLARS'.          07850000
           05  L-CENTS             PIC X(6)  VALUE '6CENTS'.            07860000
           05  L-ONLY              PIC X(6)  VALUE '5ONLY '.            07870000
           05  L-HUNDRED           PIC X(8)  VALUE '7HUNDRED'.          07880000
           05  L-DOLLAR            PIC X(7)  VALUE '6DOLLAR'.           07890000
                                                                        07900000
       01  SWITCHES.                                                    07910000
           05  WS-SWITCH           PIC 9     VALUE 0.                   07920000
           05  WS-THO-SW           PIC 9     VALUE 0.                   07930000
           05  WS-CNT-SW           PIC 9     VALUE 0.                   07940000
           05  WS-LIT-SW           PIC 9     VALUE 0.                   07950000
           05  WS-TEN-SW           PIC 9     VALUE 0.                   07960000
           05  WS-AND-SW           PIC 9     VALUE 0.                   07970000
                                                                        07980000
       01  WS-PLACE-COUNTER        PIC 999   VALUE 0.                   07990000
       01  WL-AREA-SAVE            PIC X(12) VALUE SPACES.              08000000
       01  WS-RESULT               PIC 999   VALUE 0.                   08010000
       01  WL-AREA.                                                     08020000
           05  WL-ITEM1            PIC 9     VALUE 0.                   08030000
           05  FILLER              PIC X(11) VALUE SPACE.               08040000
       01  WL-ITM REDEFINES WL-AREA.                                    08050000
           05  WL-ITEM             PIC X     OCCURS 12 TIMES.           08060000
                                                                        08070000
       01  WS-CHEQUE-DETAILS.                                           08080000
           05  WS-AMT              PIC 9(7)V99 VALUE 0.                 08090000
           05  WS-DIGIT REDEFINES  WS-AMT OCCURS 9 TIMES PIC 9.         08100000
           05  WF-DETAILS.                                              08110000
               10  WF-LINE-1       PIC X(60).                           08120000
               10  WF-LINE-2       PIC X(60).                           08130000
           05  WF-ITEM REDEFINES WF-DETAILS OCCURS 120 PIC X.           08140000
           05  WP-ITEM REDEFINES WF-DETAILS OCCURS 2 PIC X(60).         08150000
                                                                        08160000
                                                                        08170000
      *------------------*                                              08180000
       PROCEDURE DIVISION.                                              08190000
      *------------------*                                              08200000
                                                                        08210000
      ******************************************************************08220000
       0000-CONTROL.                                                    08230000
      ******************************************************************08240000
            PERFORM  0100-SET-DATE               THRU  0100-EXIT.       08250000
            PERFORM  0200-OPEN-FILES             THRU  0200-EXIT.       08260000
            PERFORM  1100-READ-BP13F315          THRU  1100-EXIT.       08270000
            PERFORM  0900-CHECK-SALES-TYPE       THRU  0900-EXIT.       08280000
                                                                        08290000
            MOVE     WS-REPORT-ID-SW             TO    WS-PREV-REPORT-ID08300000
            MOVE     F315-CDE-SA-TP-TAG          TO    WS-PREV-SA-TP-TAG08310000
            MOVE     F315-CDE-PROJECT            TO    WS-PREV-PROJ-CODE08320000
            PERFORM  1000-READ-AND-PRINT-LOOP    THRU  1000-EXIT        08330000
                          UNTIL END-OF-BP13F315.                        08340000
                                                                        08350000
            PERFORM  8000-DISPLAY-STATISTICS     THRU  8000-EXIT.       08360000
            PERFORM  9000-CLOSE-FILES            THRU  9000-EXIT.       08370000
                                                                        08380000
       0000-EXIT.                                                       08390000
            EXIT.                                                       08400000
                                                                        08410000
                                                                        08420000
      ******************************************************************08430000
       0100-SET-DATE.                                                   08440000
      ******************************************************************08450000
            STRING  FUNCTION CURRENT-DATE(7:2) '/'                      08460000
                    FUNCTION CURRENT-DATE(5:2) '/'                      08470000
                    FUNCTION CURRENT-DATE(1:4)                          08480000
            DELIMITED BY SIZE INTO HEADER-DATE.                         08490000
                                                                        08500000
            MOVE HEADER-DATE           TO   L43A-CURRENT-DATE.          08510000
                                                                        08520000
       0100-EXIT.                                                       08530000
            EXIT.                                                       08540000
                                                                        08550000
                                                                        08560000
      ******************************************************************08570000
       0200-OPEN-FILES.                                                 08580000
      ******************************************************************08590000
            OPEN INPUT  BP13F315                                        08600000
                        B05K006                                         08610000
                        BP13K410                                        08620000
                        BP13K800                                        08630000
                        BP13K893                                        08640000
                        BP13KD00                                        08650000
                        BP13KD03                                        08660000
                        BP13KD40                                        08670000
                        BP13KD45                                        08680000
                 I-O    BP13K625                                        08690000
                 OUTPUT AG07F225                                        08700000
                        BP1343AJ                                        08710000
                        BP1343AK.                                       08720000
                                                                        08730000
            IF WS-K006-STATUS NOT = 00 AND 97                           08740000
               MOVE    OPEN-K006                  TO   WS-CUR-PROC      08750000
               MOVE    WS-K006-STATUS             TO   WS-CUR-STATUS    08760000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT        08770000
               PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT.       08780000
                                                                        08790000
            IF WS-K410-STATUS NOT = 00 AND 97                           08800000
               MOVE    OPEN-K410                  TO    WS-CUR-PROC     08810000
               MOVE    WS-K410-STATUS             TO    WS-CUR-STATUS   08820000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT       08830000
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.      08840000
                                                                        08850000
            IF WS-K800-STATUS NOT = 00 AND 97                           08860000
               MOVE    OPEN-K800                  TO    WS-CUR-PROC     08870000
               MOVE    WS-K800-STATUS             TO    WS-CUR-STATUS   08880000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT       08890000
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.      08900000
                                                                        08910000
            IF WS-K893-STATUS NOT = 00 AND 97                           08920000
               MOVE    OPEN-K893                  TO    WS-CUR-PROC     08930000
               MOVE    WS-K893-STATUS             TO    WS-CUR-STATUS   08940000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT       08950000
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.      08960000
                                                                        08970000
            IF WS-KD00-STATUS NOT = 00 AND 97                           08980000
               MOVE    OPEN-KD00                  TO    WS-CUR-PROC     08990000
               MOVE    WS-KD00-STATUS             TO    WS-CUR-STATUS   09000000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT       09010000
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.      09020000
                                                                        09030000
            IF WS-KD03-STATUS NOT = 00 AND 97                           09040000
               MOVE    OPEN-KD03                  TO    WS-CUR-PROC     09050000
               MOVE    WS-KD03-STATUS             TO    WS-CUR-STATUS   09060000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT       09070000
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.      09080000
                                                                        09090000
            IF WS-KD40-STATUS NOT = 00 AND 97                           09100000
               MOVE    OPEN-KD40                  TO    WS-CUR-PROC     09110000
               MOVE    WS-KD40-STATUS             TO    WS-CUR-STATUS   09120000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT       09130000
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.      09140000
                                                                        09150000
            IF WS-KD45-STATUS NOT = 00 AND 97                           09160000
               MOVE    OPEN-KD45                  TO    WS-CUR-PROC     09170000
               MOVE    WS-KD45-STATUS             TO    WS-CUR-STATUS   09180000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT       09190000
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.      09200000
                                                                        09210000
            IF WS-K625-STATUS NOT = 00 AND 97                           09220000
               MOVE    OPEN-K625                TO    WS-CUR-PROC       09230000
               MOVE    WS-K625-STATUS           TO    WS-CUR-STATUS     09240000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT       09250000
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.      09260000
                                                                        09270000
      * VOUCHER NUMBER                                                  09280000
            MOVE 'AG07K960' TO    C907-NUM-FILENME.                     09290000
            CALL 'K960OPEN' USING AG07C907-AREA.                        09300000
                                                                        09310000
            IF C907-NUM-FILE-STATUS NOT = ('00' AND '97')               09320000
               DISPLAY 'ERROR OPENING AG07K960, STATUS = '              09330000
                        C907-NUM-FILE-STATUS                            09340000
               MOVE     C907-NUM-FILE-STATUS    TO     WS-AG07-STATUS   09350000
               MOVE     WS-AG07-STATUS          TO     RETURN-CODE      09360000
               PERFORM  9000-CLOSE-FILES        THRU   9000-EXIT        09370000
            END-IF.                                                     09380000
                                                                        09390000
      * BATCH NUMBER (17/07/1999 - ROMAR)                               09400000
            MOVE 'BP13K620' TO    C906-NUM-FILENME.                     09410000
            CALL 'K620OPEN' USING BP13C906-AREA.                        09420000
                                                                        09430000
            IF C906-NUM-FILE-STATUS NOT = ('00' AND '97')               09440000
               DISPLAY 'ERROR OPENING BP13K620, STATUS = '              09450000
                        C906-NUM-FILE-STATUS                            09460000
               MOVE     C906-NUM-FILE-STATUS    TO     RETURN-CODE      09470000
               PERFORM  9000-CLOSE-FILES        THRU   9000-EXIT        09480000
            END-IF.                                                     09490000
                                                                        09500000
      **CALL AB05C902 TO OPEN B05K006 AND AB05K009 FILES(CODE='O')      09510000
            MOVE SPACES              TO   WS-B902-AREA.                 09520000
            INITIALIZE                    WS-B902-AREA.                 09530000
            MOVE 'O'                 TO   B902-CDE-TYPE.                09540000
            CALL 'AB05C902'  USING WS-B902-AREA.                        09550000
                                                                        09560000
            IF B902-CDE-ERROR NOT = ZEROES                              09570000
               MOVE B902-CDE-SYSERR  TO   RETURN-CODE                   09580000
               DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'            09590000
               PERFORM  9000-CLOSE-FILES  THRU 9000-EXIT                09600000
            END-IF.                                                     09610000
                                                                        09620000
       0200-EXIT.                                                       09630000
            EXIT.                                                       09640000
                                                                        09650000
                                                                        09660000
      ******************************************************************09670000
       0900-CHECK-SALES-TYPE.                                           09680000
      ******************************************************************09690000
            MOVE  'J'           TO     WS-REPORT-ID-SW.                 09700000
            MOVE  'DBST'        TO     WS-NUM-BATCH-TYPE.               09710000
                                                                        09720000
       0900-EXIT.                                                       09730000
            EXIT.                                                       09740000
                                                                        09750000
                                                                        09760000
      ******************************************************************09770000
       1000-READ-AND-PRINT-LOOP.                                        09780000
      ******************************************************************09790000
            IF F315-CDE-TRANS = 'DT'                                    09800000
               IF (WS-REPORT-ID-SW    NOT = WS-PREV-REPORT-ID) OR       09810000
                  (F315-CDE-SA-TP-TAG NOT = WS-PREV-SA-TP-TAG) OR       09820000
                  (F315-CDE-PROJECT   NOT = WS-PREV-PROJ-CODE)          09830000
                                                                        09840000
                   PERFORM  5000-WRITE-TRAILER-F225                     09850000
                      THRU  5000-TRAILER-EXIT                           09860000
                   MOVE     ZEROES               TO  WS-CNT-DETAILS     09870000
                   MOVE     ZEROES               TO  WS-TEMP-TOTAL      09880000
                   MOVE     'Y'                  TO  WS-NEW-BATCH       09890000
                                                     WS-NEW-VOUCHER     09900000
                                                     WS-NEW-HEADER      09910000
                   MOVE     WS-REPORT-ID-SW      TO  WS-PREV-REPORT-ID  09920000
                   MOVE     F315-CDE-SA-TP-TAG   TO  WS-PREV-SA-TP-TAG  09930000
                   MOVE     F315-CDE-PROJECT     TO  WS-PREV-PROJ-CODE  09940000
               END-IF                                                   09950000
                                                                        09960000
               PERFORM  1050-PROCESS-RECORD      THRU 1050-EXIT         09970000
               PERFORM  1055-EARMARK-ACCOUNT     THRU 1055-EXIT         09980000
                                                                        09990000
               IF B902-CDE-SYSERR NOT = ZEROES                          10000000
                  DISPLAY 'ERROR CALLING AB05C902, STATUS = '           10010000
                           B902-CDE-SYSERR                              10020000
                  MOVE     '99'                 TO RETURN-CODE          10030000
                  PERFORM  9000-CLOSE-FILES                             10040000
               END-IF                                                   10050000
                                                                        10060000
               IF B902-CDE-ERROR-ACCT(1) = SPACES                       10070000
                  IF WS-NEW-HEADER = 'Y'                                10080000
                     PERFORM  5000-WRITE-HEADER-F225                    10090000
                              THRU 5000-HEADER-EXIT                     10100000
                     MOVE  'N'             TO   WS-NEW-HEADER           10110000
                  END-IF                                                10120000
                  PERFORM  1060-PRINT-RECORD        THRU 1060-EXIT      10130000
                  MOVE F315-CDE-SA-TP-TAG  TO   WS-PREV-SA-TP-TAG       10140000
                  MOVE F315-CDE-PROJECT    TO   WS-PREV-PROJ-CODE       10150000
                  PERFORM  6000-WRITE-STAMPING-FILE THRU 6000-EXIT      10160000
               END-IF                                                   10170000
                                                                        10180000
            END-IF.                                                     10190000
                                                                        10200000
            PERFORM 1100-READ-BP13F315       THRU 1100-EXIT.            10210000
                                                                        10220000
            IF NOT END-OF-BP13F315                                      10230000
               PERFORM 0900-CHECK-SALES-TYPE THRU 0900-EXIT             10240000
            END-IF.                                                     10250000
                                                                        10260000
       1000-EXIT.                                                       10270000
            EXIT.                                                       10280000
                                                                        10290000
                                                                        10300000
      ******************************************************************10310000
       1050-PROCESS-RECORD.                                             10320000
      ******************************************************************10330000
            PERFORM 1300-READ-BP13K800 THRU 1300-EXIT.                  10340000
                                                                        10350000
            PERFORM 1310-READ-BP13KD00 THRU 1310-EXIT.                  10360000
                                                                        10370000
            PERFORM 1400-READ-BP13KD40 THRU 1400-EXIT.                  10380000
                                                                        10390000
            IF WS-LOAN-GRANTED            NOT NUMERIC                   10400000
               MOVE ZEROS  TO WS-LOAN-GRANTED.                          10410000
                                                                        10420000
      * GENERATE BATCH NUMBER.                                          10430000
            IF WS-NEW-BATCH = 'Y'                                       10440000
               MOVE WS-NUM-BATCH-TYPE TO C906-NUM-BATCH-TYPE            10450000
               MOVE  'BP13K620'       TO C906-NUM-FILENME               10460000
                                                                        10470000
               CALL 'BP13C906'  USING BP13C906-AREA                     10480000
                                                                        10490000
               IF C906-NUM-FILE-STATUS =  '00'                          10500000
                  MOVE C906-NUM-BATCH-TYPE      TO  WS-NUM-BATCH-TYPE   10510000
                  MOVE C906-NUM-FIN-YEAR        TO  WS-NUM-FIN-YEAR     10520000
                  MOVE C906-NUM-BATCH-SERIAL    TO  WS-NUM-BATCH-SERIAL 10530000
                  MOVE    'N'                   TO  WS-NEW-BATCH        10540000
               ELSE                                                     10550000
                  DISPLAY 'ERROR CALLING BP13C906, FILE STATUS = '      10560000
                           C906-NUM-FILE-STATUS                         10570000
                  MOVE     C906-NUM-FILE-STATUS TO RETURN-CODE          10580000
                  PERFORM  9000-CLOSE-FILES                             10590000
            END-IF.                                                     10600000
                                                                        10610000
      * GENERATE VOUCHER NUMBER.                                        10620000
            IF WS-NEW-VOUCHER = 'Y'                                     10630000
      *        MOVE  'SU '      TO C907-NUM-DDD                         10640000
               MOVE  'SS '      TO C907-NUM-DDD                         10650000
               MOVE  'AG07K960' TO C907-NUM-FILENME                     10660000
                                                                        10670000
               CALL 'AG07C907'  USING AG07C907-AREA                     10680000
                                                                        10690000
               IF C907-NUM-FILE-STATUS =  '00'                          10700000
                  MOVE    'N'   TO    WS-NEW-VOUCHER                    10710000
               ELSE                                                     10720000
                  DISPLAY 'ERROR CALLING AG07C907, FILE STATUS = '      10730000
                           C907-NUM-FILE-STATUS                         10740000
                  MOVE     C907-NUM-FILE-STATUS TO WS-AG07-STAT-X       10750000
                  MOVE     WS-AG07-STATUS       TO RETURN-CODE          10760000
                  PERFORM  9000-CLOSE-FILES                             10770000
            END-IF.                                                     10780000
                                                                        10790000
       1050-EXIT.                                                       10800000
            EXIT.                                                       10810000
                                                                        10820000
                                                                        10830000
      ******************************************************************10840000
       1055-EARMARK-ACCOUNT.                                            10850000
      ******************************************************************10860000
      **CALL AB05C902 TO EARMARK ACCOUNT(CODE='E')                      10870000
            MOVE SPACES              TO   WS-B902-AREA.                 10880000
            INITIALIZE                    WS-B902-AREA.                 10890000
                                                                        10900000
            STRING C907-NUM-DDD  C907-NUM-FIN-YR                        10910000
                   C907-NUM-VR-SERIAL                                   10920000
                   DELIMITED BY SIZE INTO B902-VR-NO                    10930000
            END-STRING.                                                 10940000
                                                                        10950000
            MOVE 'E'                     TO   B902-CDE-TYPE.            10960000
            MOVE 'BP13'                  TO   B902-CDE-SYSTEMID.        10970000
            MOVE FUNCTION CURRENT-DATE   TO   B902-DTE-TRANS.           10980000
            MOVE 'P13C43A'               TO   B902-NUM-USERID-UPDATE.   10990000
            MOVE 'CV'                    TO   B902-CDE-EARMARK-REASON.  11000000
            MOVE 01                      TO   B902-NUM-HDB-REF-CNT.     11010000
            MOVE F315-SCH-ACC            TO   B902-NUM-HDB-REF(1).      11020000
            MOVE ZEROES                  TO   WS-AMT-EARMARK.           11030000
                                                                        11040000
            PERFORM 1057-COMP-TRANS-AMT  THRU 1057-EXIT.                11050000
            IF WS-AMT-EARMARK = ZEROES                                  11060000
               GO TO 1055-EXIT                                          11070000
            END-IF.                                                     11080000
            MOVE WS-AMT-EARMARK          TO   B902-AMT-EARMARK(1).      11090000
                                                                        11100000
            DISPLAY '----------------'.                                 11110000
            DISPLAY 'B902-VR-NO       = ' B902-VR-NO.                   11120000
            DISPLAY 'B902-CDE-TYPE    = ' B902-CDE-TYPE.                11130000
            DISPLAY 'CDE-SYSTEMID     = ' B902-CDE-SYSTEMID.            11140000
            DISPLAY 'B902-DTE-TRANS   = ' B902-DTE-TRANS.               11150000
            DISPLAY 'NUM-USERID       = ' B902-NUM-USERID-UPDATE.       11160000
            DISPLAY 'HDB-REF-CNT      = ' B902-NUM-HDB-REF-CNT.         11170000
            DISPLAY 'NUM-HDB-REF      = ' B902-NUM-HDB-REF(1).          11180000
            DISPLAY 'B902-AMT-EARMARK = ' B902-AMT-EARMARK(1).          11190000
                                                                        11200000
            CALL 'AB05C902'  USING WS-B902-AREA.                        11210000
                                                                        11220000
            DISPLAY 'CDE-ERROR-ACCT   = ' B902-CDE-ERROR-ACCT(1).       11230000
            DISPLAY '----------------'.                                 11240000
                                                                        11250000
            EVALUATE B902-CDE-ERROR-ACCT(1)                             11260000
               WHEN SPACES                                              11270000
                  CONTINUE                                              11280000
               WHEN OTHER                                               11290000
                  PERFORM 6500-PRINT-L43AK-REPORT     THRU 6500-EXIT    11300000
            END-EVALUATE.                                               11310000
                                                                        11320000
       1055-EXIT.                                                       11330000
            EXIT.                                                       11340000
                                                                        11350000
                                                                        11360000
      ******************************************************************11370000
       1057-COMP-TRANS-AMT.                                             11380000
      ******************************************************************11390000
                                                                        11400000
            IF  F315-AMT-SUB-TRF-DOA NOT NUMERIC                        11410000
                MOVE ZEROES TO F315-AMT-SUB-TRF-DOA                     11420000
            END-IF.                                                     11430000
                                                                        11440000
            IF  F315-AMT-MORT-SF     NOT NUMERIC                        11450000
                MOVE ZEROES TO F315-AMT-MORT-SF                         11460000
            END-IF.                                                     11470000
                                                                        11480000
            IF  F315-AMT-SELLER-STAMP-DUTY NOT NUMERIC                  11490000
                MOVE ZEROES TO F315-AMT-SELLER-STAMP-DUTY               11500000
            END-IF.                                                     11510000
                                                                        11520000
            MOVE F315-AMT-SUB-TRF-DOA       TO  WS-DOA-AMT.             11530000
            MOVE F315-AMT-MORT-SF           TO  WS-MORT-STAMP.          11540000
            MOVE F315-AMT-SELLER-STAMP-DUTY TO  WS-SSD-AMT.             11550000
                                                                        11560000
            COMPUTE WS-AMT-EARMARK = (WS-DOA-AMT + WS-MORT-STAMP +      11570000
                                     WS-SSD-AMT).                       11580000
                                                                        11590000
            MOVE WS-AMT-EARMARK             TO  WS-LEASE-STAMP.         11600000
            DISPLAY 'NUM-REGN            = ' F315-REGN-NO.              11610000
            DISPLAY 'WS-AMT-EARMARK     = ' WS-AMT-EARMARK.             11620000
                                                                        11630000
       1057-EXIT.                                                       11640000
           EXIT.                                                        11650000
                                                                        11660000
                                                                        11670000
      ******************************************************************11680000
       1060-PRINT-RECORD.                                               11690000
      ******************************************************************11700000
            PERFORM 2150-HANDLE-SER  THRU  2150-EXIT.                   11710000
                                                                        11720000
       1060-EXIT.                                                       11730000
            EXIT.                                                       11740000
                                                                        11750000
                                                                        11760000
      ******************************************************************11770000
       1100-READ-BP13F315.                                              11780000
      ******************************************************************11790000
            READ BP13F315                                               11800000
              AT END                                                    11810000
                 MOVE    'Y'  TO WS-EOF                                 11820000
                 PERFORM 4200-PRINT-LAST-LINES THRU 4200-EXIT           11830000
                 GO TO   1100-EXIT.                                     11840000
                                                                        11850000
            DISPLAY 'F315-CDE-TRANS =' F315-CDE-TRANS.                  11860000
            DISPLAY 'F315-REGN-NO   =' F315-REGN-NO.                    11870000
            IF F315-CDE-TRANS = 'DT'                                    11880000
               ADD  1                 TO  WS-BP13F315-READ-CNT          11890000
               MOVE F315-REGN-NO      TO  KD40-NUM-REGN.                11900000
                                                                        11910000
            MOVE    F315-SCH          TO  WS-SCH.                       11920000
            MOVE    F315-ACC          TO  WS-F315-ACC-CHK.              11930000
            MOVE    WS-F315-ACC       TO  WS-ACC.                       11940000
            MOVE    WS-F315-CHK       TO  WS-CHK.                       11950000
            MOVE    F315-LESSEE-CODE  TO  WS-LESCDE.                    11960000
            MOVE    HYPHEN            TO  WS-SCH-SEP1.                  11970000
            MOVE    HYPHEN            TO  WS-SCH-SEP2.                  11980000
            MOVE    HYPHEN            TO  WS-SCH-SEP3.                  11990000
            MOVE    F315-NUM-LEVEL    TO  WS-NUM-LEVEL.                 12000000
            MOVE    F315-NUM-MAIN     TO  WS-NUM-MAIN.                  12010000
                                                                        12020000
            IF F315-CDE-SA-TP-TAG  =  LOW-VALUE                         12030000
               MOVE SPACE             TO  F315-CDE-SA-TP-TAG            12040000
            END-IF.                                                     12050000
                                                                        12060000
       1100-EXIT.                                                       12070000
            EXIT.                                                       12080000
                                                                        12090000
                                                                        12100000
      ******************************************************************12110000
       1300-READ-BP13K800.                                              12120000
      ******************************************************************12130000
            DISPLAY '1300'.                                             12140000
      *---------------------------------------------------------------* 12150000
      *     USE F315-REGN-NO TO ACCESS BP13K800                       * 12160000
      *---------------------------------------------------------------* 12170000
            MOVE SPACES                      TO   BP13K800-MASTER.      12180000
            INITIALIZE                            BP13K800-MASTER.      12190000
                                                                        12200000
            MOVE F315-REGN-NO                TO   K800-NUM-REGN.        12210000
                                                                        12220000
            DISPLAY 'F315-REGN-NO   = ' F315-REGN-NO.                   12230000
                                                                        12240000
            READ BP13K800.                                              12250000
                                                                        12260000
            IF WS-K800-STATUS = 00                                      12270000
               CONTINUE                                                 12280000
            ELSE                                                        12290000
               PERFORM 1600-READ-BP13K410 THRU 1600-EXIT                12300000
            END-IF.                                                     12310000
                                                                        12320000
       1300-EXIT.                                                       12330000
            EXIT.                                                       12340000
                                                                        12350000
      ******************************************************************12360000
       1310-READ-BP13KD00.                                              12370000
      ******************************************************************12380000
            DISPLAY '1310'.                                             12390000
      *---------------------------------------------------------------* 12400000
      *     USE SUBTRANSFER REG NUM TO ACCESS BP13KD00                * 12410000
      *---------------------------------------------------------------* 12420000
            MOVE 'N'                         TO   WS-KD03-FND.          12430000
            MOVE SPACES                      TO   BP13KD00-REC.         12440000
            INITIALIZE                            BP13KD00-REC.         12450000
                                                                        12460000
            MOVE F315-REGN-NO                TO   KD00-NUM-REGN.        12470000
                                                                        12480000
            DISPLAY 'F315-REGN-NO   = ' F315-REGN-NO.                   12490000
                                                                        12500000
            READ BP13KD00.                                              12510000
                                                                        12520000
            IF WS-KD00-STATUS = 00                                      12530000
               MOVE  KD00-DTE-SNP-RETURNED   TO   WS-DTE-SALE-AGRM      12540000
            ELSE                                                        12550000
                PERFORM 1350-READ-KD03        THRU 1350-EXIT            12560000
                IF KD03-FND                                             12570000
                   MOVE BP13KD03-REC TO     BP13KD00-REC                12580000
                   MOVE KD03-DTE-SNP-RETURNED TO WS-DTE-SALE-AGRM       12590000
                ELSE                                                    12600000
                   MOVE SPACES       TO     WS-DTE-SALE-AGRM            12610000
                END-IF                                                  12620000
            END-IF.                                                     12630000
                                                                        12640000
       1310-EXIT.                                                       12650000
            EXIT.                                                       12660000
                                                                        12670000
      ******************************************************************12680000
       1350-READ-KD03.                                                  12690000
      ******************************************************************12700000
            DISPLAY '1350'.                                             12710000
      *---------------------------------------------------------------* 12720000
      *     USE SUBTRANSFER REG NUM TO ACCESS BP13KD00                * 12730000
      *---------------------------------------------------------------* 12740000
           MOVE   SPACES             TO     BP13KD03-REC.               12750000
           INITIALIZE                       BP13KD03-REC.               12760000
           MOVE  F315-REGN-NO              TO  KD03-NUM-REGN.           12770000
                                                                        12780000
           READ BP13KD03.                                               12790000
                                                                        12800000
           IF WS-KD03-STATUS = 00 OR 02                                 12810000
                MOVE 'Y'             TO     WS-KD03-FND                 12820000
           ELSE                                                         12830000
                MOVE 'N'             TO     WS-KD03-FND                 12840000
           END-IF.                                                      12850000
                                                                        12860000
       1350-EXIT.                                                       12870000
            EXIT.                                                       12880000
                                                                        12890000
      ******************************************************************12900000
       1400-READ-BP13KD40.                                              12910000
      ******************************************************************12920000
            DISPLAY '1400'.                                             12930000
      *---------------------------------------------------------------* 12940000
      *     USE F315-REGN-NO TO ACCESS BP13KD40 (GET DATE, FEES ETC)  * 12950000
      *---------------------------------------------------------------* 12960000
            INITIALIZE                            WS-LOAN-GRANTED       12970000
                                                  WS-SELL-PRICE.        12980000
                                                                        12990000
            MOVE SPACES                      TO   BP13KD40-REC.         13000000
            INITIALIZE                            BP13KD40-REC.         13010000
                                                                        13020000
            MOVE F315-REGN-NO                TO   KD40-NUM-REGN.        13030000
            MOVE '01'                        TO   KD40-NUM-PP-SCHDL.    13040000
                                                                        13050000
            DISPLAY 'F315-REGN-NO   = ' F315-REGN-NO.                   13060000
            READ BP13KD40.                                              13070000
            DISPLAY 'WS-KD40-STATUS = ' WS-KD40-STATUS.                 13080000
            IF WS-KD40-STATUS = 00                                      13090000
               IF F315-NUM-ADHOC-SF = SPACES                            13100000
                  MOVE  KD40-AMT-LOAN-GRANTED     TO   WS-LOAN-GRANTED  13110000
                  MOVE  KD40-AMT-CURR-SELLPR      TO   WS-SELL-PRICE    13120000
               END-IF                                                   13130000
               COMPUTE WS-ANNUAL-RENT = 0                               13140000
               IF KD40-AMT-SOLICITOR-BILL IS NOT NUMERIC                13150000
                  MOVE ZEROES TO KD40-AMT-SOLICITOR-BILL                13160000
               END-IF                                                   13170000
            ELSE                                                        13180000
               IF WS-KD40-STATUS = 23                                   13190000
                  PERFORM 1425-READ-BP13KD40-TR      THRU 1425-EXIT     13200000
               ELSE                                                     13210000
                  MOVE    READ-KD40                  TO WS-CUR-PROC     13220000
                  MOVE    WS-KD40-STATUS             TO WS-CUR-STATUS   13230000
                  PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT     13240000
                  PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT     13250000
               END-IF                                                   13260000
            END-IF.                                                     13270000
                                                                        13280000
       1400-EXIT.                                                       13290000
            EXIT.                                                       13300000
                                                                        13310000
      ******************************************************************13320000
       1425-READ-BP13KD40-TR.                                           13330000
      ******************************************************************13340000
            DISPLAY '1425'.                                             13350000
      *---------------------------------------------------------------* 13360000
      *     USE F315-REGN-NO TO ACCESS BP13KD40 (GET DATE, FEES ETC)  * 13370000
      *---------------------------------------------------------------* 13380000
                                                                        13390000
            MOVE SPACES                      TO   BP13KD40-REC.         13400000
            INITIALIZE                            BP13KD40-REC.         13410000
                                                                        13420000
            MOVE F315-REGN-NO                TO   KD40-NUM-REGN.        13430000
            MOVE 'TR'                        TO   KD40-NUM-PP-SCHDL.    13440000
                                                                        13450000
            DISPLAY 'F315-REGN-NO   = ' F315-REGN-NO.                   13460000
            READ BP13KD40.                                              13470000
            DISPLAY 'WS-KD40-STATUS = ' WS-KD40-STATUS.                 13480000
            IF WS-KD40-STATUS = 00                                      13490000
               IF F315-NUM-ADHOC-SF = SPACES                            13500000
                  MOVE  KD40-AMT-LOAN-GRANTED     TO   WS-LOAN-GRANTED  13510000
                  MOVE  KD40-AMT-CURR-SELLPR      TO   WS-SELL-PRICE    13520000
               END-IF                                                   13530000
               COMPUTE WS-ANNUAL-RENT = 0                               13540000
               IF KD40-AMT-SOLICITOR-BILL IS NOT NUMERIC                13550000
                  MOVE ZEROES TO KD40-AMT-SOLICITOR-BILL                13560000
               END-IF                                                   13570000
            ELSE                                                        13580000
               IF WS-KD40-STATUS = 23                                   13590000
                  PERFORM 1500-READ-BP13KD45         THRU 1500-EXIT     13600000
               ELSE                                                     13610000
                  MOVE    READ-KD40                  TO WS-CUR-PROC     13620000
                  MOVE    WS-KD40-STATUS             TO WS-CUR-STATUS   13630000
                  PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT     13640000
                  PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT     13650000
               END-IF                                                   13660000
            END-IF.                                                     13670000
                                                                        13680000
       1425-EXIT.                                                       13690000
            EXIT.                                                       13700000
                                                                        13710000
                                                                        13720000
      ******************************************************************13730000
       1500-READ-BP13KD45.                                              13740000
      ******************************************************************13750000
           DISPLAY '1500'.                                              13760000
           MOVE SPACES                     TO BP13KD45-REC.             13770000
           INITIALIZE                         BP13KD45-REC.             13780000
                                                                        13790000
           MOVE 'N'                        TO WS-KD45-EOF.              13800000
                                                                        13810000
           MOVE F315-REGN-NO               TO KD45-NUM-REGN-HIST.       13820000
           MOVE SPACES                     TO KD45-DTE-UPDATE-HIST      13830000
                                              KD45-TME-UPDATE-HIST.     13840000
                                                                        13850000
           START BP13KD45 KEY >= KD45-KEY-FLD.                          13860000
                                                                        13870000
           EVALUATE WS-KD45-STATUS                                      13880000
           WHEN 00                                                      13890000
              PERFORM 1510-READNXT-BP13KD45 THRU 1510-EXIT              13900000
                 UNTIL WS-KD45-EOF = 'Y'                                13910000
           WHEN 10                                                      13920000
           WHEN 23                                                      13930000
              MOVE    WS-KD45-STATUS             TO   WS-CUR-STATUS     13940000
              MOVE    START-KD45                 TO   WS-CUR-PROC       13950000
              PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT         13960000
              PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT         13970000
           WHEN OTHER                                                   13980000
              MOVE    START-KD45                 TO WS-CUR-PROC         13990000
              MOVE    WS-KD45-STATUS             TO WS-CUR-STATUS       14000000
              PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT         14010000
              PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT         14020000
           END-EVALUATE.                                                14030000
                                                                        14040000
       1500-EXIT.                                                       14050000
            EXIT.                                                       14060000
                                                                        14070000
                                                                        14080000
      ******************************************************************14090000
       1510-READNXT-BP13KD45.                                           14100000
      ******************************************************************14110000
            DISPLAY '1510'.                                             14120000
           READ BP13KD45 NEXT RECORD.                                   14130000
                                                                        14140000
           EVALUATE WS-KD45-STATUS                                      14150000
           WHEN 00                                                      14160000
              IF KD45-NUM-REGN-HIST = F315-REGN-NO                      14170000
                 IF KD45-NUM-PP-SCHDL = '01' OR 'TR'                    14180000
                    IF F315-NUM-ADHOC-SF = SPACES                       14190000
                       MOVE KD45-AMT-LOAN-GRANTED  TO  WS-LOAN-GRANTED  14200000
                       MOVE KD45-AMT-CURR-SELLPR   TO  WS-SELL-PRICE    14210000
                       MOVE    'Y'                 TO  WS-KD45-EOF      14220000
                       COMPUTE WS-ANNUAL-RENT = 0                       14230000
                       IF KD45-AMT-SOLICITOR-BILL NOT NUMERIC           14240000
                          MOVE ZEROES TO KD45-AMT-SOLICITOR-BILL        14250000
                       END-IF                                           14260000
                    END-IF                                              14270000
                 END-IF                                                 14280000
              ELSE                                                      14290000
                 MOVE    'Y'                        TO   WS-KD45-EOF    14300000
                 MOVE    WS-KD45-STATUS             TO   WS-CUR-STATUS  14310000
                 MOVE    READ-KD45                  TO   WS-CUR-PROC    14320000
                 PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT      14330000
                 PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT      14340000
              END-IF                                                    14350000
           WHEN 10                                                      14360000
           WHEN 23                                                      14370000
              MOVE    'Y'                        TO   WS-KD45-EOF       14380000
              MOVE    WS-KD45-STATUS             TO   WS-CUR-STATUS     14390000
              MOVE    READ-KD45                  TO   WS-CUR-PROC       14400000
              PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT         14410000
              PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT         14420000
           WHEN OTHER                                                   14430000
              MOVE    READ-KD45                  TO   WS-CUR-PROC       14440000
              MOVE    WS-KD45-STATUS             TO   WS-CUR-STATUS     14450000
              PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT         14460000
              PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT         14470000
           END-EVALUATE.                                                14480000
                                                                        14490000
       1510-EXIT.                                                       14500000
            EXIT.                                                       14510000
                                                                        14520000
      ******************************************************************14530000
       1600-READ-BP13K410.                                              14540000
      ******************************************************************14550000
            DISPLAY '1600'.                                             14560000
      *---------------------------------------------------------------* 14570000
      *     USE F315-REGN-NO TO ACCESS BP13K800                       * 14580000
      *---------------------------------------------------------------* 14590000
            MOVE SPACES                      TO   BP13K410-REC.         14600000
            INITIALIZE                            BP13K410-REC.         14610000
                                                                        14620000
            MOVE F315-REGN-NO                TO   K410-KEY-FLD.         14630000
                                                                        14640000
            READ BP13K410.                                              14650000
                                                                        14660000
            DISPLAY 'WS-K410-STATUS = ' WS-K410-STATUS.                 14670000
                                                                        14680000
            IF WS-K410-STATUS = 00                                      14690000
               PERFORM 1650-READ-BP13K893 THRU 1650-EXIT                14700000
            ELSE                                                        14710000
               MOVE  SPACES            TO   WS-DTE-SALE-AGRM            14720000
            END-IF.                                                     14730000
                                                                        14740000
       1600-EXIT.                                                       14750000
            EXIT.                                                       14760000
                                                                        14770000
      ******************************************************************14780000
       1650-READ-BP13K893.                                              14790000
      ******************************************************************14800000
                                                                        14810000
           MOVE SPACES                           TO BP13K893-MASTER.    14820000
           INITIALIZE                               BP13K893-MASTER.    14830000
                                                                        14840000
           MOVE F315-REGN-NO         TO K893-NUM-REGN-HIST              14850000
           MOVE 'N'                              TO WS-K893-EOF         14860000
                                                    WS-K893-FND         14870000
                                                                        14880000
           START BP13K893 KEY >= K893-KEY-FLD.                          14890000
                                                                        14900000
           EVALUATE WS-K893-STATUS                                      14910000
              WHEN 00                                                   14920000
                 PERFORM 1651-READNEXT-BP13K893 THRU 1651-EXIT          14930000
                   UNTIL K893-NUM-REGN-HIST NOT = F315-REGN-NO          14940000
                      OR WS-K893-EOF = 'Y'                              14950000
                      OR K893-FND                                       14960000
              WHEN OTHER                                                14970000
                MOVE  SPACES            TO   WS-DTE-SALE-AGRM           14980000
                                                                        14990000
           END-EVALUATE.                                                15000000
                                                                        15010000
           IF K893-FND                                                  15020000
              CONTINUE                                                  15030000
           ELSE                                                         15040000
              MOVE SPACES            TO K800-NUM-DBSS-REGN-SUBTRF       15050000
              MOVE SPACES            TO WS-DTE-SALE-AGRM                15060000
           END-IF.                                                      15070000
                                                                        15080000
                                                                        15090000
       1650-EXIT.                                                       15100000
           EXIT.                                                        15110000
                                                                        15120000
      *-------------------------------------------------------------*   15130000
       1651-READNEXT-BP13K893.                                          15140000
      *-------------------------------------------------------------*   15150000
                                                                        15160000
           READ BP13K893 NEXT RECORD                                    15170000
             AT END                                                     15180000
                MOVE 'Y'                         TO WS-K893-EOF         15190000
           END-READ.                                                    15200000
                                                                        15210000
           EVALUATE WS-K893-STATUS                                      15220000
              WHEN 00                                                   15230000
              WHEN 02                                                   15240000
                 IF K893-NUM-REGN-HIST = F315-REGN-NO                   15250000
                    MOVE K893-NUM-DBSS-REGN-SUBTRF TO                   15260000
                         K800-NUM-DBSS-REGN-SUBTRF                      15270000
                    MOVE 'Y' TO WS-K893-FND                             15280000
                 END-IF                                                 15290000
              WHEN OTHER                                                15300000
                 MOVE SPACES TO K800-NUM-DBSS-REGN-SUBTRF               15310000
                 MOVE  SPACES            TO   WS-DTE-SALE-AGRM          15320000
           END-EVALUATE.                                                15330000
                                                                        15340000
                                                                        15350000
       1651-EXIT.                                                       15360000
           EXIT.                                                        15370000
                                                                        15380000
      ******************************************************************15390000
       1800-READ-B05K006.                                               15400000
      ******************************************************************15410000
            MOVE  ' '                TO L43A-TAG.                       15420000
            MOVE  SPACES             TO K006-HDB-REF-SF.                15430000
            MOVE  F315-SCH-ACC       TO K006-HDB-REF-SF.                15440000
                                                                        15450000
            READ  B05K006.                                              15460000
                                                                        15470000
            IF WS-K006-STATUS = 00                                      15480000
               PERFORM 1810-CHECK-ADHOC-BLANK-CASES THRU 1810-EXIT      15490000
            END-IF.                                                     15500000
                                                                        15510000
       1800-EXIT.                                                       15520000
            EXIT.                                                       15530000
                                                                        15540000
                                                                        15550000
      ******************************************************************15560000
       1810-CHECK-ADHOC-BLANK-CASES.                                    15570000
      ******************************************************************15580000
                                                                        15590000
           IF (K006-BALANCES > WS-LEASE-STAMP) OR                       15600000
              (K006-BALANCES = WS-LEASE-STAMP)                          15610000
               NEXT SENTENCE                                            15620000
           ELSE                                                         15630000
               MOVE '*'          TO L43A-TAG                            15640000
           END-IF.                                                      15650000
                                                                        15660000
       1810-EXIT.                                                       15670000
            EXIT.                                                       15680000
                                                                        15690000
                                                                        15700000
      ******************************************************************15710000
       2000-DISPLAY-ERROR-MESSAGE.                                      15720000
      ******************************************************************15730000
            DISPLAY ' *************   ERROR MESSAGE   *************'.   15740000
            DISPLAY 'ERROR ENCOUNTERED WHEN ' WS-CUR-PROC.              15750000
            DISPLAY 'STATUS CODE = ' WS-CUR-STATUS.                     15760000
                                                                        15770000
       2000-EXIT.                                                       15780000
            EXIT.                                                       15790000
                                                                        15800000
                                                                        15810000
      ******************************************************************15820000
       2150-HANDLE-SER.                                                 15830000
      ******************************************************************15840000
      *--------------------------------*                                15850000
      *     PRINT  L43AJ-RECORD (DOA)  *                                15860000
      *--------------------------------*                                15870000
            ADD    1                      TO  WS-CNT-DETAILS.           15880000
                                                                        15890000
      *     -----------------------                                     15900000
      *     SET UP L43AJ-REC-DETAIL                                     15910000
      *     -----------------------                                     15920000
            MOVE   WS-CNT-DETAILS         TO  L43A-SERIAL-NO            15930000
            MOVE   WS-SCH-ACC             TO  L43A-SCH-ACC              15940000
            MOVE   F315-REGN-NO           TO  L43A-REGN-NO              15950000
            MOVE   F315-NUM-BLK           TO  L43A-BLKNO                15960000
            MOVE   F315-NME-STREET        TO  L43A-STREET               15970000
            MOVE   WS-DTE-SALE-AGRM       TO  WS-SALE-DATE              15980000
            MOVE   WS-SALE-CC             TO  L43A-SALE-CC              15990000
            MOVE   WS-SALE-YY             TO  L43A-SALE-YY              16000000
            MOVE   WS-SALE-MM             TO  L43A-SALE-MM              16010000
            MOVE   WS-SALE-DD             TO  L43A-SALE-DD              16020000
            MOVE   '/'                    TO  L43A-DASH1  L43A-DASH2    16030000
            MOVE   WS-FLATNO              TO  L43A-FLATNO               16040000
                                                                        16050000
            MOVE   WS-DOA-AMT             TO  L43A-DOA-AMT.             16060000
            MOVE   WS-MORT-STAMP          TO  L43A-MORT-STAMP.          16070000
            MOVE   WS-SSD-AMT             TO  L43A-SSD-AMT.             16080000
            MOVE   F315-CDE-SUBTRANSFER-DOC TO  L43A-DOC-TYPE.          16090000
            MOVE   WS-LEASE-STAMP         TO  L43A-DETL-AMT-TOTAL.      16100000
                                                                        16110000
            PERFORM  1800-READ-B05K006 THRU 1800-EXIT.                  16120000
                                                                        16130000
            MOVE    F315-SCH-ACC          TO  WS-SCH-ACCT-NO.           16140000
            MOVE    WS-LEASE-STAMP        TO  WS-AMT-TRANS.             16150000
            ADD     1                     TO  WS-L43AJ-PRINT-CNT.       16160000
            ADD     WS-DOA-AMT            TO  WS-L43AJ-DOA-CNT.         16170000
            ADD     WS-MORT-STAMP         TO  WS-L43AJ-MORT-CNT.        16180000
            ADD     WS-SSD-AMT            TO  WS-L43AJ-SSD-CNT.         16190000
            ADD     WS-LEASE-STAMP        TO  WS-L43AJ-IND-TOT-CNT.     16200000
            MOVE    WS-L43AJ-IND-TOT-CNT  TO  WS-AMT-TOTAL.             16210000
            WRITE   L43AJ-PRINT-REC  FROM  L43A-REC-DETAIL AFTER 1      16220000
                                                                        16230000
            MOVE    'J'                   TO  WS-PREV-REPORT-ID.        16240000
            MOVE   'NS PAYMENT FOR LEASE/MORTGAGE STAMP FEES'           16250000
                                          TO  WS-TXT-INFO.              16260000
                                                                        16270000
            PERFORM 5000-WRITE-TRANS-DETAIL-F225 THRU  5000-DETAIL-EXIT.16280000
                                                                        16290000
            IF (WS-CNT-DETAILS = MAX-DETLS-PER-PAGE)                    16300000
                PERFORM 5000-WRITE-TRAILER-F225  THRU 5000-TRAILER-EXIT 16310000
                MOVE    ZEROES                   TO   WS-CNT-DETAILS    16320000
                MOVE    'Y'                      TO   WS-NEW-BATCH      16330000
                                                      WS-NEW-VOUCHER    16340000
                                                      WS-NEW-HEADER     16350000
            END-IF.                                                     16360000
                                                                        16370000
       2150-EXIT.                                                       16380000
            EXIT.                                                       16390000
                                                                        16400000
                                                                        16410000
      ******************************************************************16420000
       4200-PRINT-LAST-LINES.                                           16430000
      ******************************************************************16440000
            PERFORM 5000-WRITE-TRAILER-F225                             16450000
               THRU 5000-TRAILER-EXIT.                                  16460000
                                                                        16470000
       4200-EXIT.                                                       16480000
            EXIT.                                                       16490000
                                                                        16500000
                                                                        16510000
      ******************************************************************16520000
       4295-PRINT-L43AJ-GRAND-TOTAL.                                    16530000
      ******************************************************************16540000
            IF WS-CNT-DETAILS = ZEROES                                  16550000
               GO TO 4295-EXIT                                          16560000
            END-IF.                                                     16570000
                                                                        16580000
            MOVE  WS-CNT-DETAILS        TO L43A-VR-NO-HIGH.             16590000
            MOVE  WS-L43AJ-DOA-CNT      TO L43A-TOTAL-DOA-AMT.          16600000
            MOVE  WS-L43AJ-MORT-CNT     TO L43A-TOTAL-MORT-STAMP.       16610000
            MOVE  WS-L43AJ-SSD-CNT      TO L43A-TOTAL-SSD-AMT.          16620000
            MOVE  WS-L43AJ-IND-TOT-CNT  TO L43A-TOTAL-AMT.              16630000
            WRITE L43AJ-PRINT-REC  FROM PRT-L43A-DASH-LINE  AFTER 2     16640000
            WRITE L43AJ-PRINT-REC  FROM PRT-L43A-TOTAL-LINE AFTER 1     16650000
            WRITE L43AJ-PRINT-REC  FROM PRT-L43A-DASH-LINE  AFTER 1     16660000
            MOVE     WS-L43AJ-IND-TOT-CNT  TO   WS-AMT.                 16670000
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.              16680000
            MOVE     WP-ITEM (1)           TO   L43A-AMT-DESC1.         16690000
            MOVE     WP-ITEM (2)           TO   L43A-AMT-DESC2.         16700000
                                                                        16710000
            WRITE    L43AJ-PRINT-REC       FROM PRT-L43A-FTG-1 AFTER 3. 16720000
            WRITE    L43AJ-PRINT-REC       FROM PRT-L43A-FTG-2 AFTER 6. 16730000
            MOVE     ZEROES                TO   WS-L43AJ-DOA-CNT        16740000
                                                WS-L43AJ-MORT-CNT       16750000
                                                WS-L43AJ-SSD-CNT        16760000
                                                WS-L43AJ-IND-TOT-CNT.   16770000
       4295-EXIT.                                                       16780000
            EXIT.                                                       16790000
                                                                        16800000
                                                                        16810000
      ******************************************************************16820000
       4770-PRINT-L43AJ-HEADER.                                         16830000
      ******************************************************************16840000
            MOVE 'P13L43AJ'          TO L43A-REPORT-ID                  16850000
                                                                        16860000
            MOVE  WS-L43AJ-DESC      TO L43A-REPORT-ID-DESC.            16870000
            ADD   1                  TO WS-L43AJ-PAGE-CNT.              16880000
            MOVE  WS-L43AJ-PAGE-CNT  TO L43A-PAGE.                      16890000
                                                                        16900000
            MOVE "FINANCE'S COPY"          TO L43A-COPY-NAME.           16910000
            WRITE L43AJ-PRINT-REC  FROM PRT-L43A-HDG-1    AFTER PAGE.   16920000
            WRITE L43AJ-PRINT-REC  FROM PRT-L43A-HDG-2    AFTER 2.      16930000
            WRITE L43AJ-PRINT-REC  FROM PRT-L43A-HDG-3    AFTER 1.      16940000
            WRITE L43AJ-PRINT-REC  FROM PRT-L43A-HDG-4    AFTER 2.      16950000
            WRITE L43AJ-PRINT-REC  FROM PRT-L43A-HDG-5    AFTER 1.      16960000
            WRITE L43AJ-PRINT-REC  FROM PRT-L43A-HDG-6    AFTER 1.      16970000
            WRITE L43AJ-PRINT-REC  FROM PRT-L43A-HDG-7    AFTER 1.      16980000
            WRITE L43AJ-PRINT-REC  FROM PRT-L43A-HDG-8    AFTER 1.      16990000
            WRITE L43AJ-PRINT-REC  FROM PRT-L43A-HDG-9    AFTER 1.      17000000
            WRITE L43AJ-PRINT-REC  FROM PRT-L43A-HDG-10   AFTER 1.      17010000
            WRITE L43AJ-PRINT-REC  FROM PRT-L43A-HDG-10A  AFTER 1.      17020000
            WRITE L43AJ-PRINT-REC  FROM PRT-L43A-HDG-11   AFTER 1.      17030000
            WRITE L43AJ-PRINT-REC  FROM PRT-L43A-SUBHDG-1 AFTER 3.      17040000
            WRITE L43AJ-PRINT-REC  FROM PRT-L43A-SUBHDG-2 AFTER 1.      17050000
            WRITE L43AJ-PRINT-REC  FROM PRT-L43A-SUBHDG-3 AFTER 1.      17060000
            MOVE  SPACES             TO L43AJ-PRINT-REC.                17070000
            WRITE L43AJ-PRINT-REC AFTER 1.                              17080000
                                                                        17090000
       4770-EXIT.                                                       17100000
            EXIT.                                                       17110000
                                                                        17120000
                                                                        17130000
      ******************************************************************17140000
       5000-WRITE-HEADER-F225.                                          17150000
      ******************************************************************17160000
            INITIALIZE                         AG07F225-HEADER.         17170000
            MOVE    SPACES                TO   AG07F225-HEADER.         17180000
                                                                        17190000
            MOVE    C907-NUM-DDD          TO   F225-NUM-DDD.            17200000
            MOVE    C907-NUM-FIN-YR       TO   F225-NUM-FIN-YEAR.       17210000
            MOVE    C907-NUM-VR-SERIAL    TO   F225-NUM-VR-SERIAL.      17220000
            MOVE    F225-NUM-VR           TO   WS-NUM-VOUCHER.          17230000
            MOVE    00                    TO   F225-NUM-REC-TYP.        17240000
            MOVE   'PV'                   TO   F225-NUM-VR-TYP.         17250000
            MOVE   'TL'                   TO   F225-NUM-VR-SUB-TYP.     17260000
            MOVE   'SOC'                  TO   F225-NUM-TRANS-TYP.      17270000
            MOVE  FUNCTION CURRENT-DATE   TO   F225-DTE-VR-CREATE       17280000
                                               F225-DTE-VR-PRT-FINAL.   17290000
            MOVE   'STPFEE  '             TO   F225-NUM-DDD-FILE-REF.   17300000
            MOVE   'BP13C43A'      TO   F225-NUM-VR-CREATE-USERID       17310000
                                        F225-NUM-VR-PRT-FINAL-USERID.   17320000
            MOVE   'COMMISSIONER OF STAMP DUTIES'   TO  F225-NME-PAYEE1.17330000
      *     MOVE   'C/O SC(STAMPING) OF SALES UNIT' TO  F225-NME-STREET.17340001
            MOVE   'SALES AGREEMENT TEAM' TO   F225-NME-COLL-OFFCR.     17350000
            MOVE   '64903781'           TO   F225-NUM-COLL-OFFCR-PHONE. 17360000
            MOVE   'SALES AGREEMENT TEAM' TO F225-NME-CONTACT-OFFCR.    17370000
            MOVE   '64903781'           TO  F225-NUM-CONTACT-PHONE.     17380000
            MOVE   'DBSSSGSGXXX'        TO  F225-NUM-PAYEE-BANK.        17390000
            MOVE   SPACES               TO  F225-NUM-PAYEE-BANK-BRNCH.  17400000
            MOVE   '0010468600'         TO  F225-NUM-PAYEE-IBG-ACCT.    17410000
            MOVE   SPACES               TO  F225-NUM-ROOT-ACCT.         17420000
            MOVE   SPACES               TO  F225-NUM-PAYEE-UIN1.        17430000
            MOVE   SPACES               TO  F225-NME-PAYEE2.            17440000
            MOVE   SPACES               TO  F225-NUM-PAYEE-UIN2.        17450000
            MOVE   SPACES               TO  F225-NUM-PAYEE-TAX-REGN.    17460000
            MOVE   '55'                 TO  F225-NUM-BLK-HSE.           17461001
            MOVE   'NEWTON ROAD'        TO  F225-NME-STREET.            17462001
            MOVE   'REVENUE HOUSE'      TO  F225-NME-BLDNG.             17463001
            MOVE   '307987'             TO  F225-NUM-POSTAL.            17464001
            MOVE   SPACES               TO  F225-TXT-REJECT-HDR.        17470000
            MOVE   'STPFEE  '           TO  F225-NUM-INTRFC-FR-HDR.     17480000
            MOVE   'CV'                 TO  F225-NUM-ACTION-TYP.        17490000
            MOVE   SPACES               TO  F225-NUM-PRCS-TERM.         17500000
            MOVE   SPACES               TO  F225-NUM-ROUTE-FLAG.        17510000
            IF F315-USERID   = 'BP13P001'                               17520000
              MOVE WS-STAFF-START         TO F225-NUM-STAFF-ID-PREP     17530000
                                             F225-NUM-USERID-START      17540000
            ELSE                                                        17550000
              MOVE F315-USERID            TO F225-NUM-STAFF-ID-PREP     17560000
                                             F225-NUM-USERID-START      17570000
            END-IF.                                                     17580000
            MOVE   'PREP'               TO   F225-NUM-VCHR-STATE-START. 17590000
            MOVE   SPACES               TO   F225-DTE-PYMNT-DUE.        17600000
                                                                        17610000
            WRITE AG07F225-HEADER.                                      17620000
                                                                        17630000
            ADD     1                     TO   WS-AG07F225-WRITE-CNT.   17640000
            MOVE    C907-NUM-DDD          TO   WS-EDITED-NUM-DDD.       17650000
            MOVE    C907-NUM-FIN-YR       TO   WS-EDITED-NUM-FIN-YEAR.  17660000
            MOVE    C907-NUM-VR-SERIAL    TO   WS-EDITED-NUM-VR-SERIAL. 17670000
            MOVE    WS-EDITED-VOUCHER-NO  TO   L43A-VOUCHER-NO.         17680000
                                                                        17690000
            MOVE    SPACES                TO   L43A-BATCH-NO.           17700000
                                                                        17710000
            STRING WS-NUM-BATCH-TYPE   DELIMITED BY SPACE               17720000
                   WS-NUM-FIN-YEAR     DELIMITED BY SPACE               17730000
                   '-'                 DELIMITED BY SIZE                17740000
                   WS-NUM-BATCH-SERIAL DELIMITED BY SPACE               17750000
                   INTO L43A-BATCH-NO                                   17760000
            END-STRING.                                                 17770000
                                                                        17780000
            PERFORM 4770-PRINT-L43AJ-HEADER   THRU 4770-EXIT.           17790000
                                                                        17800000
       5000-HEADER-EXIT.                                                17810000
            EXIT.                                                       17820000
                                                                        17830000
                                                                        17840000
      ******************************************************************17850000
       5000-WRITE-TRANS-DETAIL-F225.                                    17860000
      ******************************************************************17870000
            INITIALIZE AG07F225-TRANS.                                  17880000
            MOVE    SPACES             TO    AG07F225-TRANS.            17890000
            MOVE    WS-NUM-VOUCHER     TO    F225-NUM-VR-T.             17900000
            MOVE    WS-CNT-DETAILS     TO    F225-NUM-TRANS-SERIAL.     17910000
            MOVE   '04'                TO    F225-NUM-SYS.              17920000
            MOVE    WS-SCH-ACCT-NO     TO    F225-NUM-HDB-REF.          17930000
            MOVE   '0000000104250'     TO    F225-NUM-GL-ACCT.          17940000
            MOVE    WS-AMT-TRANS       TO    F225-AMT-TRANS.            17950000
            MOVE   'D'                 TO    F225-NUM-TRANS-DR-CR       17960000
            MOVE    ZEROES             TO    F225-AMT-TRANS-GST.        17970000
            MOVE    F315-REGN-NO       TO    F225-TXT-INFO.             17980000
            MOVE    SPACES             TO    F225-NUM-TAX-CDE.          17990000
            MOVE    SPACES             TO    F225-NUM-CPF.              18000000
            MOVE    SPACES             TO    F225-TXT-REJECT-DTL.       18010000
            MOVE    'STPFEE  '         TO    F225-NUM-INTRFC-FR-T.      18020000
                                                                        18030000
            WRITE   AG07F225-TRANS.                                     18040000
                                                                        18050000
            ADD     1                  TO    WS-AG07F225-WRITE-CNT.     18060000
                                                                        18070000
       5000-DETAIL-EXIT.                                                18080000
            EXIT.                                                       18090000
                                                                        18100000
                                                                        18110000
      ******************************************************************18120000
       5000-WRITE-TRAILER-F225.                                         18130000
      ******************************************************************18140000
            IF WS-CNT-DETAILS = ZEROES                                  18150000
               GO TO 5000-TRAILER-EXIT                                  18160000
            END-IF.                                                     18170000
                                                                        18180000
            PERFORM 4295-PRINT-L43AJ-GRAND-TOTAL THRU 4295-EXIT         18190000
            MOVE    WS-AMT             TO  WS-AMT-TOTAL                 18200000
                                                                        18210000
            INITIALIZE AG07F225-TRAILER.                                18220000
            MOVE       SPACES             TO  AG07F225-TRAILER.         18230000
            MOVE       WS-NUM-VOUCHER     TO  F225-NUM-VR-R.            18240000
            MOVE       99                 TO  F225-NUM-TRAILER-SERIAL.  18250000
            MOVE       'PAYMENT FOR LEASE/MORTGAGE STAMP FEES'          18260000
                                          TO  F225-TXT-VOUCHER-NARRATION18270000
            MOVE       WS-CNT-DETAILS     TO  F225-QTY-VR-TRANS.        18280000
            MOVE       WS-AMT-TOTAL       TO  F225-AMT-VR-DR-TOTAL.     18290000
            MOVE       ZEROES             TO  F225-AMT-VR-CR-TOTAL.     18300000
            MOVE       SPACES             TO  F225-TXT-REJECT-TLR.      18310000
            MOVE       'STPFEE  '         TO  F225-NUM-INTRFC-FR.       18320000
                                                                        18330000
            WRITE      AG07F225-TRAILER.                                18340000
                                                                        18350000
            ADD        1                  TO    WS-AG07F225-WRITE-CNT.  18360000
                                                                        18370000
       5000-TRAILER-EXIT.                                               18380000
            EXIT.                                                       18390000
                                                                        18400000
                                                                        18410000
      ******************************************************************18420000
       6000-WRITE-STAMPING-FILE.                                        18430000
      ******************************************************************18440000
            DISPLAY '6000-WRITE-STAMPING-FILE'.                         18450000
            INITIALIZE BP13K625-REC.                                    18460000
            MOVE  SPACES                TO BP13K625-REC.                18470000
                                                                        18480000
            PERFORM 1400-READ-BP13KD40  THRU 1400-EXIT.                 18490000
                                                                        18500000
            MOVE F315-SCH-ACC           TO WS-NUM-HDB-REF.              18510000
            MOVE F315-CDE-SUBTRANSFER-DOC  TO   WS-NUM-DOC.             18520000
                                                                        18530000
      ****  WRITE DETAIL PART FOR ORIGINAL MORTGAGE STAMP FEE*******    18540000
            MOVE  'O'                   TO WS-NUM-DOC-TYP.              18550000
                                                                        18560000
            MOVE  WS-LEASE-STAMP         TO WS-AMT-STAMP-DUTY.          18570000
            MOVE  ZEROES                 TO WS-AMT-STAMP-DUTY-DUP.      18580000
                                                                        18590000
            PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT           18600000
            PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT           18610000
            MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY           18620000
            MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP       18630000
            IF WS-AMT-STAMP-DUTY = ZEROES                               18640000
               MOVE 'Y'                TO K625-NUM-DBST-ZERO            18650000
            END-IF                                                      18660000
            WRITE BP13K625-REC                                          18670000
            ADD   1   TO  WS-BP13K625-WRITE-CNT                         18680000
                                                                        18690000
      ****  WRITE DETAIL PART FOR DUPLICATE                   *******   18700000
            MOVE  'D'                    TO WS-NUM-DOC-TYP.             18710000
            MOVE  ZEROES                 TO WS-AMT-STAMP-DUTY.          18720000
            MOVE  ZEROES                 TO WS-AMT-STAMP-DUTY-DUP.      18730000
                                                                        18740000
            IF WS-AMT-STAMP-DUTY-DUP > 0                                18750000
               PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT        18760000
               PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT        18770000
               MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY        18780000
               MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP    18790000
               WRITE BP13K625-REC                                       18800000
               ADD   1   TO  WS-BP13K625-WRITE-CNT                      18810000
            ELSE                                                        18820000
               NEXT SENTENCE                                            18830000
            END-IF.                                                     18840000
                                                                        18850000
       6000-EXIT.                                                       18860000
           EXIT.                                                        18870000
                                                                        18880000
                                                                        18890000
      ******************************************************************18900000
       6100-CHK-EXISTING-BP13K625.                                      18910000
      ******************************************************************18920000
           MOVE WS-NUM-HDB-REF          TO K625-NUM-HDB-REF.            18930000
           MOVE WS-NUM-DOC              TO K625-NUM-DOC.                18940000
           MOVE WS-NUM-DOC-TYP          TO K625-NUM-DOC-TYP.            18950000
           MOVE 1                       TO K625-NUM-DOC-CNT.            18960000
           MOVE 'N'                     TO WS-K625-EOF.                 18970000
                                                                        18980000
           START BP13K625 KEY = K625-KEY-FLD.                           18990000
                                                                        19000000
           EVALUATE  WS-K625-STATUS                                     19010000
              WHEN '00'                                                 19020000
                    PERFORM 6200-READNEXT-BP13K625 THRU 6200-EXIT       19030000
                            UNTIL WS-K625-EOF = 'Y'                     19040000
                    ADD  1              TO WS-NUM-DOC-CNT               19050000
              WHEN '10'                                                 19060000
              WHEN '23'                                                 19070000
                    MOVE 1              TO WS-NUM-DOC-CNT               19080000
              WHEN OTHER                                                19090000
                    DISPLAY 'ERROR WHILE STARTING BROWSE-BP13K625 '     19100000
                    MOVE WS-K625-STATUS TO RETURN-CODE                  19110000
                    PERFORM 9000-CLOSE-FILES THRU 9000-EXIT             19120000
           END-EVALUATE.                                                19130000
                                                                        19140000
       6100-EXIT.                                                       19150000
           EXIT.                                                        19160000
                                                                        19170000
                                                                        19180000
      ******************************************************************19190000
       6200-READNEXT-BP13K625.                                          19200000
      ******************************************************************19210000
           READ BP13K625 NEXT AT END MOVE 'Y' TO WS-K625-EOF            19220000
              GO TO 6200-EXIT.                                          19230000
                                                                        19240000
           IF (K625-NUM-HDB-REF NOT = WS-NUM-HDB-REF) OR                19250000
              (K625-NUM-DOC     NOT = WS-NUM-DOC)     OR                19260000
              (K625-NUM-DOC-TYP NOT = WS-NUM-DOC-TYP)                   19270000
              MOVE 'Y'                  TO WS-K625-EOF                  19280000
              GO TO 6200-EXIT                                           19290000
           END-IF.                                                      19300000
                                                                        19310000
           MOVE K625-NUM-DOC-CNT        TO WS-NUM-DOC-CNT.              19320000
                                                                        19330000
       6200-EXIT.                                                       19340000
           EXIT.                                                        19350000
                                                                        19360000
                                                                        19370000
      ******************************************************************19380000
       6300-MAIN-DETAILS-TO-K625.                                       19390000
      ******************************************************************19400000
            MOVE  SPACES                 TO BP13K625-REC.               19410000
            INITIALIZE                      BP13K625-REC.               19420000
                                                                        19430000
            MOVE  F315-SCH-ACC           TO K625-NUM-HDB-REF.           19440000
            MOVE  WS-NUM-DOC             TO K625-NUM-DOC.               19450000
            MOVE  WS-NUM-DOC-TYP         TO K625-NUM-DOC-TYP.           19460000
            MOVE  WS-NUM-DOC-CNT         TO K625-NUM-DOC-CNT.           19470000
            MOVE  C907-NUM-DDD           TO K625-NUM-DDD.               19480000
            MOVE  C907-NUM-FIN-YR        TO K625-NUM-FIN-YEAR.          19490000
            MOVE  C907-NUM-VR-SERIAL     TO K625-NUM-VR-SERIAL.         19500000
            MOVE  C906-NUM-BATCH-TYPE    TO K625-NUM-BATCH-TYPE.        19510000
            MOVE  C906-NUM-FIN-YEAR      TO K625-NUM-CAL-YEAR.          19520000
            MOVE  C906-NUM-BATCH-SERIAL  TO K625-NUM-BATCH-SERIAL.      19530000
            MOVE  F315-REGN-NO           TO K625-NUM-REGN.              19540000
            MOVE  WS-DTE-SALE-AGRM       TO K625-DTE-DOC-PREPARE.       19550000
            MOVE  WS-SELL-PRICE          TO K625-AMT-PURCHASE-PRICE.    19560000
            MOVE  WS-ANNUAL-RENT         TO K625-AMT-ANNUAL-RENT.       19570000
            MOVE  SPACES                 TO K625-NUM-INCREASE-SCCC.     19580000
            MOVE  WS-LOAN-GRANTED        TO K625-AMT-LOAN.              19590000
            MOVE  'BP13C43A'             TO K625-NUM-SYSTEM.            19600000
            MOVE  FUNCTION CURRENT-DATE  TO K625-DTE-UPDATE.            19610000
            COMPUTE K625-NUM-LEASE-TERM = 99 * 12.                      19620000
            MOVE  WS-SSD-AMT             TO K625-AMT-SELLER-DUTY.       19630000
                                                                        19640000
       6300-EXIT.                                                       19650000
           EXIT.                                                        19660000
                                                                        19670000
                                                                        19680000
      ******************************************************************19690000
       6500-PRINT-L43AK-REPORT.                                         19700000
      ******************************************************************19710000
           IF WS-L43AK-REC-ON-PAGE-CNT > 65                             19720000
              PERFORM 6510-PRINT-L43A-HEADER     THRU 6510-EXIT         19730000
           END-IF.                                                      19740000
                                                                        19750000
           MOVE SPACES                TO L43AK-REC-DETAIL.              19760000
           INITIALIZE                    L43AK-REC-DETAIL.              19770000
                                                                        19780000
           ADD  1                     TO WS-L43AK-PRINT-CNT.            19790000
           MOVE WS-L43AK-PRINT-CNT    TO L43AK-SERIAL-NO.               19800000
           MOVE F315-REGN-NO          TO L43AK-REGN-NO.                 19810000
                                                                        19820000
           STRING F315-SCH-ACC(1:4) '-'                                 19830000
                  F315-SCH-ACC(5:4) '-'                                 19840000
                  F315-SCH-ACC(9:1) '-'                                 19850000
                  F315-SCH-ACC(10:2)                                    19860000
                  DELIMITED BY SIZE INTO L43AK-SCH-ACC                  19870000
           END-STRING.                                                  19880000
                                                                        19890000
           STRING C907-NUM-DDD    '-'                                   19900000
                  C907-NUM-FIN-YR '-'                                   19910000
                  C907-NUM-VR-SERIAL                                    19920000
                  DELIMITED BY SIZE INTO L43AK-JR-VCHR-NO               19930000
           END-STRING.                                                  19940000
                                                                        19950000
           MOVE WS-AMT-EARMARK    TO L43AK-AMT-TOTAL.                   19960000
                                                                        19970000
           EVALUATE B902-CDE-ERROR-ACCT(1)                              19980000
              WHEN 'S0045'                                              19990000
                 MOVE 'B05K006 FILE ERROR'         TO L43AK-ERROR-DESC  20000000
              WHEN 'S0052'                                              20010000
                 MOVE 'INVALID INPUT      '        TO L43AK-ERROR-DESC  20020000
              WHEN 'S0053'                                              20030000
                 MOVE 'AB05K009 FILE ERROR'        TO L43AK-ERROR-DESC  20040000
              WHEN 'S0054'                                              20050000
                 MOVE 'B05K006 REC NOT FND'        TO L43AK-ERROR-DESC  20060000
              WHEN 'S0055'                                              20070000
                 MOVE 'NOT ENOUGH BALANCE'         TO L43AK-ERROR-DESC  20080000
              WHEN OTHER                                                20090000
                 MOVE 'AB05C902 SUBROUTINE ERROR'  TO L43AK-ERROR-DESC  20100000
           END-EVALUATE.                                                20110000
                                                                        20120000
           WRITE L43AK-PRINT-REC  FROM L43AK-REC-DETAIL  AFTER 1.       20130000
                                                                        20140000
           ADD   1     TO  WS-L43AK-REC-ON-PAGE-CNT.                    20150000
                                                                        20160000
       6500-EXIT.                                                       20170000
           EXIT.                                                        20180000
                                                                        20190000
                                                                        20200000
      ******************************************************************20210000
       6510-PRINT-L43A-HEADER.                                          20220000
      ******************************************************************20230000
           ADD  1                 TO   WS-L43AK-PAGE-CNT.               20240000
           MOVE WS-L43AK-PAGE-CNT TO   L43A-PAGE.                       20250000
           MOVE 'P13L43AK'        TO   L43A-REPORT-ID.                  20260000
           WRITE L43AK-PRINT-REC  FROM PRT-L43A-HDG-1    AFTER PAGE.    20270000
           WRITE L43AK-PRINT-REC  FROM L43AK-HEADER2     AFTER 2.       20280000
           WRITE L43AK-PRINT-REC  FROM L43AK-HEADER3     AFTER 2.       20290000
           WRITE L43AK-PRINT-REC  FROM L43AK-UNDERLINE   AFTER 1.       20300000
           MOVE  6                TO   WS-L43AK-REC-ON-PAGE-CNT.        20310000
                                                                        20320000
       6510-EXIT.                                                       20330000
           EXIT.                                                        20340000
                                                                        20350000
                                                                        20360000
      ******************************************************************20370000
       8000-DISPLAY-STATISTICS.                                         20380000
      ******************************************************************20390000
            MOVE    WS-BP13F315-READ-CNT  TO  WS-EDIT-BP13F315-READ.    20400000
            MOVE    WS-L43AJ-PRINT-CNT    TO  WS-EDIT-L43AJ-PRINT.      20410000
            MOVE    WS-AG07F225-WRITE-CNT TO  WS-EDIT-AG07F225-WRITE.   20420000
                                                                        20430000
            DISPLAY WS-BLANK-LINE.                                      20440000
            DISPLAY WS-SUMMARY-HEADER.                                  20450000
            DISPLAY WS-BLANK-LINE.                                      20460000
            DISPLAY WS-READ-CASES.                                      20470000
            DISPLAY WS-DOA-PAYMENT-PRINTED.                             20480000
            DISPLAY WS-L43AJ-PRINTED.                                   20490000
            DISPLAY WS-STAMP-FEES-REC-WRITTEN.                          20500000
            DISPLAY WS-BLANK-LINE.                                      20510000
            DISPLAY WS-SUMMARY-TRAILER.                                 20520000
            DISPLAY 'NO OF RECORDS WRITTEN TO             (BP13K625) = '20530000
                    WS-BP13K625-WRITE-CNT.                              20540000
            DISPLAY 'NO OF RECS WITH ERROR IN EARMARK                = '20550000
                    WS-L43AK-PRINT-CNT.                                 20560000
                                                                        20570000
       8000-EXIT.                                                       20580000
            EXIT.                                                       20590000
                                                                        20600000
                                                                        20610000
      ******************************************************************20620000
       9000-CLOSE-FILES.                                                20630000
      ******************************************************************20640000
      *     CLOSE  B05K006                                              20650000
            CLOSE  BP13F315                                             20660000
                   AG07F225                                             20670000
                   BP13K410                                             20680000
                   BP13K800                                             20690000
                   BP13K893                                             20700000
                   BP13KD00                                             20710000
                   BP13KD03                                             20720000
                   BP13KD40                                             20730000
                   BP13KD45                                             20740000
                                                                        20750000
                   BP1343AJ                                             20760000
                                                                        20770000
                   BP1343AK                                             20780000
                                                                        20790000
                   BP13K625.                                            20800000
                                                                        20810000
            IF WS-K006-STATUS NOT = 00 AND 97                           20820000
               DISPLAY 'ERROR CLOSING B05K006, STAT = ' WS-K006-STATUS  20830000
               MOVE     WS-K006-STATUS     TO  RETURN-CODE              20840000
            END-IF.                                                     20850000
                                                                        20860000
            IF WS-K410-STATUS NOT = 00 AND 97                           20870000
               DISPLAY 'ERROR CLOSING BP13K410, STAT = ' WS-K410-STATUS 20880000
               MOVE     WS-K410-STATUS      TO  RETURN-CODE             20890000
            END-IF.                                                     20900000
                                                                        20910000
            IF WS-K800-STATUS NOT = 00 AND 97                           20920000
               DISPLAY 'ERROR CLOSING BP13K800, STAT = ' WS-K800-STATUS 20930000
               MOVE     WS-K800-STATUS      TO  RETURN-CODE             20940000
            END-IF.                                                     20950000
                                                                        20960000
            IF WS-K893-STATUS NOT = 00 AND 97                           20970000
               DISPLAY 'ERROR CLOSING BP13K893, STAT = ' WS-K893-STATUS 20980000
               MOVE     WS-K893-STATUS      TO  RETURN-CODE             20990000
            END-IF.                                                     21000000
                                                                        21010000
            IF WS-KD00-STATUS NOT = 00 AND 97                           21020000
               DISPLAY 'ERROR CLOSING BP13KD00, STAT = ' WS-KD00-STATUS 21030000
               MOVE     WS-KD00-STATUS      TO  RETURN-CODE             21040000
            END-IF.                                                     21050000
                                                                        21060000
            IF WS-KD03-STATUS NOT = 00 AND 97                           21070000
               DISPLAY 'ERROR CLOSING BP13KD03, STAT = ' WS-KD03-STATUS 21080000
               MOVE     WS-KD03-STATUS      TO  RETURN-CODE             21090000
            END-IF.                                                     21100000
                                                                        21110000
            IF WS-KD40-STATUS NOT = 00 AND 97                           21120000
               DISPLAY 'ERROR CLOSING BP13KD40, STAT = ' WS-KD40-STATUS 21130000
               MOVE     WS-KD40-STATUS      TO  RETURN-CODE             21140000
            END-IF.                                                     21150000
                                                                        21160000
            IF WS-KD45-STATUS NOT = 00 AND 97                           21170000
               DISPLAY 'ERROR CLOSING BP13KD45, STAT = ' WS-KD45-STATUS 21180000
               MOVE     WS-KD45-STATUS      TO  RETURN-CODE             21190000
            END-IF.                                                     21200000
                                                                        21210000
            IF WS-K625-STATUS NOT = 00 AND 97                           21220000
              DISPLAY 'ERROR CLOSING BP13K625, STAT = ' WS-K625-STATUS  21230000
              MOVE     WS-K625-STATUS      TO  RETURN-CODE              21240000
            END-IF.                                                     21250000
                                                                        21260000
            MOVE 'AG07K960'  TO     C907-NUM-FILENME.                   21270000
            CALL 'K960CLSE'  USING  AG07C907-AREA.                      21280000
                                                                        21290000
            IF C907-NUM-FILE-STATUS NOT = ('00' AND '97')               21300000
               DISPLAY 'ERROR CLOSING AG07K960, STATUS = '              21310000
                        C907-NUM-FILE-STATUS                            21320000
               MOVE     C907-NUM-FILE-STATUS    TO     WS-AG07-STATUS   21330000
               MOVE     C907-NUM-FILE-STATUS    TO     RETURN-CODE      21340000
            END-IF.                                                     21350000
                                                                        21360000
            MOVE 'BP13K620'  TO     C906-NUM-FILENME.                   21370000
            CALL 'K620MCLS'  USING  BP13C906-AREA.                      21380000
                                                                        21390000
            IF C906-NUM-FILE-STATUS NOT = ('00' AND '97')               21400000
               DISPLAY 'ERROR CLOSING BP13K620, STATUS = '              21410000
                        C906-NUM-FILE-STATUS                            21420000
               MOVE     C906-NUM-FILE-STATUS    TO     RETURN-CODE      21430000
            END-IF.                                                     21440000
                                                                        21450000
      **CALL AB05C902 TO CLOSE B05K006 AND AB05K009 FILES(CODE='C')     21460000
            MOVE SPACES              TO   WS-B902-AREA.                 21470000
            INITIALIZE                    WS-B902-AREA.                 21480000
            MOVE 'C'                 TO   B902-CDE-TYPE.                21490000
            CALL 'AB05C902'  USING WS-B902-AREA.                        21500000
                                                                        21510000
            IF B902-CDE-ERROR NOT = ZEROES                              21520000
               MOVE B902-CDE-SYSERR  TO   RETURN-CODE                   21530000
               DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'            21540000
            END-IF.                                                     21550000
                                                                        21560000
            STOP RUN.                                                   21570000
                                                                        21580000
       9000-EXIT.                                                       21590000
            EXIT.                                                       21600000
                                                                        21610000
                                                                        21620000
      ******************************************************************21630000
       9500-CONVT-AMT-WORD.                                             21640000
      ******************************************************************21650000
      *------------------------------------------------------------*    21660000
      *                                                            *    21670000
      *     OBJECTIVE  :  CONVERSION FROM AMOUNT IN DIGITS         *    21680000
      *                              INTO AMOUNT IN WORDS          *    21690000
      *                                                            *    21700000
      *------------------------------------------------------------*    21710000
            MOVE SPACES TO WF-DETAILS.                                  21720000
            MOVE ZERO   TO WS-SWITCH                                    21730000
                           WS-THO-SW                                    21740000
                           WS-CNT-SW                                    21750000
                           WS-LIT-SW                                    21760000
                           WS-TEN-SW                                    21770000
                           WS-AND-SW.                                   21780000
            MOVE 60     TO WS-PLACE-COUNTER.                            21790000
            MOVE 1      TO WF-SUB.                                      21800000
                                                                        21810000
            PERFORM B000-ROUTINE THRU B990-EXIT                         21820000
                         VARYING WS-SUB FROM 1 BY 1 UNTIL WS-SUB = 10.  21830000
                                                                        21840000
       9500-EXIT.                                                       21850000
            EXIT.                                                       21860000
                                                                        21870000
                                                                        21880000
      ******************************************************************21890000
       B000-ROUTINE SECTION.                                            21900000
      ******************************************************************21910000
       B000-GO.                                                         21920000
            IF WS-DIGIT (WS-SUB) = ZERO                                 21930000
                 IF WS-TEN-SW = ZERO                                    21940000
                    GO TO B800-MOVE-TYPE                                21950000
                 ELSE                                                   21960000
                    GO TO B010-PROCESS.                                 21970000
                                                                        21980000
            IF WS-FIRST-SUB = ZERO                                      21990000
               MOVE WS-SUB TO WS-FIRST-SUB.                             22000000
                                                                        22010000
            IF WS-SWITCH = ZERO                                         22020000
               MOVE 1 TO WS-SWITCH.                                     22030000
                                                                        22040000
       B010-PROCESS.                                                    22050000
            IF WS-SUB = 8                                               22060000
               MOVE 9 TO WS-CNT-SW.                                     22070000
                                                                        22080000
            IF WS-SUB = 9                                               22090000
               IF WS-CNT-SW = ZERO                                      22100000
                  MOVE WS-DIGIT (WS-SUB) TO WS-CNT-SW.                  22110000
                                                                        22120000
            IF WS-SUB = 2 OR 3 OR 4                                     22130000
               MOVE 1 TO WS-THO-SW.                                     22140000
                                                                        22150000
            MOVE WS-DIGIT (WS-SUB) TO WA-SUB.                           22160000
            IF WS-SUB = 3 OR 6 OR 8                                     22170000
               IF WS-DIGIT (WS-SUB) = 1                                 22180000
                  MOVE 1 TO WS-TEN-SW                                   22190000
                  GO TO B990-EXIT                                       22200000
               ELSE                                                     22210000
                  ADD 18 TO WA-SUB                                      22220000
            ELSE                                                        22230000
            IF WS-SUB = 1 OR 4 OR 7 OR 9                                22240000
               IF WS-TEN-SW = 1                                         22250000
                  MOVE 0 TO WS-TEN-SW                                   22260000
                  ADD 10 TO WA-SUB.                                     22270000
            MOVE WA-NAME (WA-SUB) TO WL-AREA.                           22280000
            PERFORM R000-LOAD-IN.                                       22290000
                                                                        22300000
       B300-TENS.                                                       22310000
            IF WS-SUB = 3 OR 6 OR 8                                     22320000
               GO TO B990-EXIT.                                         22330000
                                                                        22340000
       B400-MOVE-HUNDRED.                                               22350000
            IF WS-SUB = 2 OR 5                                          22360000
               MOVE L-HUNDRED TO WL-AREA                                22370000
               MOVE 1 TO WS-LIT-SW                                      22380000
               PERFORM R000-LOAD-IN                                     22390000
               MOVE 1 TO WS-AND-SW                                      22400000
               GO TO B990-EXIT.                                         22410000
                                                                        22420000
       B800-MOVE-TYPE.                                                  22430000
            IF WS-SWITCH = ZERO                                         22440000
               GO TO B990-EXIT.                                         22450000
                                                                        22460000
            IF WS-SUB = 1                                               22470000
               MOVE  L-MILLION TO WL-AREA                               22480000
               MOVE  1         TO WS-LIT-SW                             22490000
               MOVE  1         TO WS-AND-SW                             22500000
               GO TO B880-LOAD-IN.                                      22510000
                                                                        22520000
            IF WS-SUB = 7                                               22530000
               MOVE 1 TO WS-LIT-SW WS-AND-SW                            22540000
               IF WS-FIRST-SUB = 7  AND                                 22550000
                  WS-DIGIT (WS-SUB) = 1                                 22560000
                  MOVE L-DOLLAR TO WL-AREA                              22570000
                  GO TO B880-LOAD-IN                                    22580000
               ELSE                                                     22590000
                  MOVE L-DOLLARS TO WL-AREA                             22600000
                  GO TO B880-LOAD-IN.                                   22610000
                                                                        22620000
            IF WS-SUB = 4 AND WS-THO-SW = 1                             22630000
               MOVE 1 TO WS-AND-SW WS-LIT-SW                            22640000
               MOVE L-THOUSAND TO WL-AREA                               22650000
               GO TO B880-LOAD-IN.                                      22660000
                                                                        22670000
            IF WS-SUB = 9                                               22680000
               MOVE 1 TO WS-LIT-SW                                      22690000
               IF WS-CNT-SW = ZERO                                      22700000
                  MOVE L-ONLY TO WL-AREA                                22710000
                  GO TO B880-LOAD-IN                                    22720000
               ELSE                                                     22730000
               IF WS-CNT-SW = 1                                         22740000
                  MOVE L-CENT TO WL-AREA                                22750000
                  PERFORM R000-LOAD-IN                                  22760000
                  MOVE L-ONLY TO WL-AREA                                22770000
                  GO TO B880-LOAD-IN                                    22780000
               ELSE                                                     22790000
                  MOVE L-CENTS TO WL-AREA                               22800000
                  PERFORM R000-LOAD-IN                                  22810000
                  MOVE L-ONLY TO WL-AREA                                22820000
                  GO TO B880-LOAD-IN.                                   22830000
            GO TO B990-EXIT.                                            22840000
                                                                        22850000
       B880-LOAD-IN.                                                    22860000
            PERFORM R000-LOAD-IN.                                       22870000
                                                                        22880000
       B990-EXIT.                                                       22890000
            EXIT.                                                       22900000
                                                                        22910000
                                                                        22920000
      ******************************************************************22930000
       R000-LOAD-IN SECTION.                                            22940000
      ******************************************************************22950000
      *------------------------------------------------------------*    22960000
      *                                                            *    22970000
      *     THIS SECTION LOADS THE WORDS INTO THE THREE LINES      *    22980000
      *     AND JUST KEEPS INCREMENTING A SUBSCRIPT.               *    22990000
      *                                                            *    23000000
      *------------------------------------------------------------*    23010000
                                                                        23020000
       R001-GO.                                                         23030000
            IF WS-LIT-SW = 1                                            23040000
               MOVE ZERO TO WS-LIT-SW                                   23050000
               GO TO R050-CONT.                                         23060000
                                                                        23070000
            IF WS-SUB = 2 OR 5                                          23080000
               GO TO R050-CONT.                                         23090000
                                                                        23100000
       R025-ADD-TEST.                                                   23110000
            IF WS-AND-SW NOT = 1                                        23120000
               GO TO R050-CONT.                                         23130000
                                                                        23140000
            MOVE ZERO TO WS-AND-SW.                                     23150000
            MOVE WL-AREA TO WL-AREA-SAVE.                               23160000
            MOVE L-AND TO WL-AREA.                                      23170000
            PERFORM R200-LOADUP.                                        23180000
            MOVE WL-AREA-SAVE TO WL-AREA.                               23190000
                                                                        23200000
       R050-CONT.                                                       23210000
            PERFORM R200-LOADUP.                                        23220000
                                                                        23230000
       R099-EXIT.                                                       23240000
            EXIT.                                                       23250000
                                                                        23260000
                                                                        23270000
      ******************************************************************23280000
       R200-LOADUP SECTION.                                             23290000
      ******************************************************************23300000
       R201-GO.                                                         23310000
            ADD WL-ITEM1 WF-SUB GIVING WS-RESULT.                       23320000
            IF  WS-RESULT > WS-PLACE-COUNTER                            23330000
                ADD 1 WS-PLACE-COUNTER GIVING WF-SUB                    23340000
                ADD 60 TO WS-PLACE-COUNTER.                             23350000
                                                                        23360000
            PERFORM R500-LOAD VARYING WL-SUB FROM 2 BY 1 UNTIL          23370000
                    WL-ITEM (WL-SUB) = L-X.                             23380000
                                                                        23390000
       R490-EXIT.                                                       23400000
           EXIT.                                                        23410000
                                                                        23420000
                                                                        23430000
      ******************************************************************23440000
       R500-LOAD SECTION.                                               23450000
      ******************************************************************23460000
       R501-GO.                                                         23470000
                                                                        23480000
            MOVE WL-ITEM (WL-SUB) TO WF-ITEM (WF-SUB).                  23490000
            ADD  1                TO WF-SUB.                            23500000
            IF WL-ITEM (WL-SUB) = SPACE                                 23510000
               ADD   1     TO     WL-SUB                                23520000
               MOVE  L-X   TO     WL-ITEM (WL-SUB)                      23530000
               SUBTRACT 1  FROM   WL-SUB.                               23540000
                                                                        23550000
       R990-EXIT.                                                       23560000
            EXIT.                                                       23570000
