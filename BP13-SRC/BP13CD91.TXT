       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.   BP13CD91.                                                  
      *DATE-WRITTEN. 06 JUN 2012.                                               
      *AUTHOR.       IRVIN CHING.                                               
      * ========================================================== *            
      * SYSTEM OF COMMITMENT (BP13)                                *            
      * ========================================================== *            
      *                                                            *            
      *  OBJECTIVE: 1) EMAIL THAT WILL SEND WHEN 2ND CONC LOAN FOR *            
      *                DBSS IS COMPLETED                           *            
      *                                                            *            
      * ---------------------------------------------------------- *            
      * CHG REF  DATE     BY    DESCRIPTION                        *            
      * -------- -------- ----- -----------                        *            
      * BP134515 06062012 IMC1  NEW PGM                            *            
      * BP134269 13062012 IMC1  UPDATED THE RECEIPTIENT'S ADD      *            
      * BP134571 12072012 IMC1  ADDED CYM3 AND JL47                *            
      * BP134573 23072012 IMC1  ADDED GSH2 AND KCH1                *            
      * BP134573 25072012 IMC1  REMOVED CWL1                       *            
      * BP134744 12032013 RJE1  REMOVED TGM1, KCH1. ADDED HBB1,    *            
      *                         LJL1 AND NST1                      *            
      * BP134974 09072013 RJE1  REMOVED LJL1 AND NST1              *            
      * BP135249 28042014 ESD1  CHANGE SENDER TO SOC SYSTEM.       *            
      * BP135247 02052014 ESD1  ADD DATE FIELD.                    *            
      * BP135248 12052014 ESD1  CHANGE FROM FIELD TO SOC_SYSTEM    *            
      * BP135195 16062014 ESD1  CATER TO ADD NOTIFICATION TO CSM   *            
      * BP136477 31102016 RJB1  REMOVE LKH2                        *            
      * BP136509 02112016 RJB1  REMOVE JL47                        *            
      * BP139451 25022023 kv5   REMOVE cym3                        *            
      * BP139451 25022023 kv5   add Bernice_JH_GAN@hdb.gov.sg      *            
      *                         TENG_Siew_Hong@hdb.gov.sg          *            
      * BP139175 25022023 kv5   REPL Bernice_JH_GAN@hdb.gov.sg WITH*            
      *                         Iris_LL_KOR@hdb.gov.sg             *            
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
      *-------------------------------------------------------------            
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT SY02F001 ASSIGN TO SY02F001.                                  
           SELECT BP13F482 ASSIGN TO BP13F482.                                  
           SELECT BP13K486 ASSIGN TO BP13K486                                   
                     ACCESS MODE   IS DYNAMIC                                   
                     ORGANIZATION  IS INDEXED                                   
                     RECORD KEY    IS K486-KEY-FLD                              
                     FILE STATUS   IS WS-K486-STATUS.                           
                                                                                
           SELECT BB24K010 ASSIGN        TO BB24K010                            
                     ACCESS MODE   IS RANDOM                                    
                     ORGANIZATION  IS INDEXED                                   
                     RECORD KEY    IS K010-KEY-FLD                              
                                    OF BB24K010-REC                             
                     ALTERNATE KEY IS K010-ALT-KEY1                             
                     FILE STATUS   IS WS-K010-STATUS.                           
                                                                                
           SELECT BB24K050 ASSIGN        TO BB24K050                            
                           ACCESS MODE   IS RANDOM                              
                           ORGANIZATION  IS INDEXED                             
                           RECORD KEY    IS K050-KEY-FLD                        
                                         OF BB24K050-REC                        
                           ALTERNATE KEY IS K050-ALT-KEY                        
                           FILE STATUS   IS WS-K050-STATUS.                     
                                                                                
           SELECT BP13K022  ASSIGN       TO BP13K022                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K022-KEY-FLD                        
                            ALTERNATE RECORD KEY IS K022-NUM-REGN               
                            WITH DUPLICATES                                     
                            FILE STATUS  IS WS-K022-STATUS.                     
                                                                                
           SELECT BP13MAIL ASSIGN TO BP13MAIL.                                  
           SELECT BP13FOIC ASSIGN TO BP13FOIC.                                  
                                                                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       COPY SY02F001.                                                           
                                                                                
       FD  BP13F482                                                             
           RECORD CONTAINS 1000 CHARACTERS                                      
           RECORDING MODE  IS  F.                                               
       COPY BP13F482.                                                           
                                                                                
       FD  BP13K486                                                             
           RECORD CONTAINS 400 CHARACTERS.                                      
       COPY BP13K486.                                                           
                                                                                
       FD   BB24K010                                                            
            RECORD CONTAINS 5000 CHARACTERS.                                    
       COPY BB24K010.                                                           
                                                                                
       FD   BB24K050                                                            
            RECORD CONTAINS 250  CHARACTERS.                                    
       COPY BB24K050.                                                           
                                                                                
       FD   BP13K022                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K022.                                                           
                                                                                
       FD  BP13MAIL                                                             
           RECORD CONTAINS 80 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  MAIL-PRTREC              PIC X(80).                                  
                                                                                
       FD  BP13FOIC                                                             
           RECORD CONTAINS 80 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  OIC-PRTREC              PIC X(80).                                   
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
       01  WS-F482-READ             PIC 9(4)   VALUE ZERO.                      
       01  WS-F482-EOF              PIC X      VALUE 'N'.                       
       01  WS-SNO                   PIC 9(4)   VALUE ZEROS.                     
       01  WS-PREV-CSM              PIC X(05)  VALUE SPACES.                    
       01  WS-SYS-DATE              PIC X(08)  VALUE SPACES.                    
       01  WS-I                     PIC 9(2)   VALUE ZERO.                      
       01  WS-TOTALS.                                                           
           05  WS-TOT-CPF-AVAIL     PIC 9(7)   VALUE ZERO.                      
           05  WS-TOT-CPF-REQD      PIC 9(7)   VALUE ZERO.                      
           05  WS-TOT-CPF-BAL       PIC 9(7)   VALUE ZERO.                      
           05  WS-TOT-CASH-AVAIL    PIC 9(7)   VALUE ZERO.                      
           05  WS-TOT-CASH-REQD     PIC 9(7)   VALUE ZERO.                      
           05  WS-TOT-CASH-BAL      PIC 9(7)   VALUE ZERO.                      
       01  WS-K486-STATUS           PIC 9(2)   VALUE ZERO.                      
       01  WS-K010-STATUS           PIC 9(2)   VALUE ZERO.                      
       01  WS-K050-STATUS           PIC 9(2)   VALUE ZERO.                      
       01  WS-K022-STATUS           PIC 9(2)   VALUE ZERO.                      
       01  WS-CSM-MAIL-ID           PIC X(5)   VALUE SPACES.                    
       01  WS-RSL-MAIL-ID           PIC X(5)   VALUE SPACES.                    
                                                                                
       01  WS-K486-FND              PIC X(01)  VALUE SPACES.                    
           88  K486-FND             VALUE 'Y'.                                  
       01  WS-K010-FND              PIC X(01)  VALUE SPACES.                    
           88  K010-FND             VALUE 'Y'.                                  
       01  WS-K050-FND              PIC X(01)  VALUE SPACES.                    
           88  K050-FND             VALUE 'Y'.                                  
       01  WS-K022-FND              PIC X(01)  VALUE SPACES.                    
           88  K022-FND             VALUE 'Y'.                                  
       01  WS-K486-INFO.                                                        
           03  WS-NRIC-INFO             PIC X(100).                             
           03  FILLER REDEFINES WS-NRIC-INFO OCCURS 4 TIMES.                    
               05  WS-NRIC              PIC X(09).                              
               05  WS-CAVAIL            PIC 9(06)V99.                           
               05  WS-CREQ              PIC 9(06)V99.                           
      *-------------------------------------------------------------            
      * LAYOUT BP13MAIL  -  DATASET FOR EMAIL                                   
      *-------------------------------------------------------------            
       01  MAIL-HDR1.                                                           
           05  FILLER PIC X(80)  VALUE 'HELO SGPHDB1'.                          
                                                                                
       01  MAIL-HDR2.                                                           
           05  FILLER PIC X(80)  VALUE 'MAIL FROM:<OPCP@SGPHDB1>'.              
                                                                                
       01  MAIL-DTL1B.                                                          
           05  FILLER          PIC X(37)                                        
                 VALUE 'RCPT TO:<Iris_LL_KOR@hdb.gov.sg>'.                      
                                                                                
       01  MAIL-DTL1C.                                                          
           05  FILLER          PIC X(37)                                        
                 VALUE 'RCPT TO:<TENG_Siew_Hong@hdb.gov.sg>'.                   
                                                                                
       01  MAIL-DTL1G.                                                          
           05  FILLER          PIC X(25)                                        
                               VALUE 'RCPT TO:<GSH2@HDB.GOV.SG>'.               
                                                                                
       01  MAIL-DTL1H.                                                          
           05  FILLER          PIC X(25)                                        
                               VALUE 'RCPT TO:<HBB1@HDB.GOV.SG>'.               
                                                                                
       01  MAIL-DTL2.                                                           
           05  FILLER PIC X(04) VALUE 'DATA'.                                   
                                                                                
       01  MAIL-DTL3.                                                           
           05  FILLER PIC X(27) VALUE 'FROM: SOC_SYSTEM@HDB.GOV.SG'.            
                                                                                
       01  MAIL-DTL4B.                                                          
           05  FILLER PIC X(37) VALUE 'TO:<Iris_LL_KOR@hdb.gov.sg>'.            
                                                                                
       01  MAIL-DTL4C.                                                          
           05  FILLER PIC X(37) VALUE 'TO:<TENG_Siew_Hong@hdb.gov.sg>'.         
                                                                                
       01  MAIL-DTL4G.                                                          
           05  FILLER          PIC X(20)  VALUE 'TO:<GSH2@HDB.GOV.SG>'.         
                                                                                
       01  MAIL-DTL4H.                                                          
           05  FILLER          PIC X(20)  VALUE 'TO:<HBB1@HDB.GOV.SG>'.         
                                                                                
       01  MAIL-DTL5.                                                           
           05  FILLER          PIC X(10)  VALUE 'SUBJECT : '.                   
           05  MAIL-SUBJECT    PIC X(32)  VALUE                                 
               'REVISED 2ND CONC LOAN FOR DBSS'.                                
           05  FILLER          PIC X(9)   VALUE SPACES.                         
                                                                                
       01  MAIL-DTL6.                                                           
           05  WS-DATE-RPT-DTL.                                                 
               10 FILLER                PIC X(6)  VALUE 'DATE: '.               
               10 WS-DATE-RPT           PIC X(10) VALUE SPACES.                 
                                                                                
       01  MAIL-BODY01.                                                         
           05 FILLER                   PIC X(09)  VALUE 'REGN NO: '.            
           05 MAIL-NUM-REGN            PIC X(08)  VALUE SPACES.                 
                                                                                
       01  MAIL-BODY02.                                                         
           05 FILLER                   PIC X(20)   VALUE SPACES.                
           05 FILLER                   PIC X(03)  VALUE 'CPF'.                  
           05 FILLER                   PIC X(07)   VALUE SPACES.                
           05 FILLER                   PIC X(03)  VALUE 'CPF'.                  
           05 FILLER                   PIC X(08)   VALUE SPACES.                
           05 FILLER                   PIC X(03)  VALUE 'CPF'.                  
           05 FILLER                   PIC X(07)   VALUE SPACES.                
           05 FILLER                   PIC X(04)  VALUE 'CASH'.                 
           05 FILLER                   PIC X(07)   VALUE SPACES.                
           05 FILLER                   PIC X(04)  VALUE 'CASH'.                 
           05 FILLER                   PIC X(07)   VALUE SPACES.                
           05 FILLER                   PIC X(04)  VALUE 'CASH'.                 
                                                                                
       01  MAIL-BODY03.                                                         
           05 FILLER                   PIC X(19)   VALUE SPACES.                
           05 FILLER                   PIC X(05)  VALUE 'AVAIL'.                
           05 FILLER                   PIC X(06)   VALUE SPACES.                
           05 FILLER                   PIC X(04)  VALUE 'REQD'.                 
           05 FILLER                   PIC X(07)   VALUE SPACES.                
           05 FILLER                   PIC X(03)  VALUE 'BAL'.                  
           05 FILLER                   PIC X(07)   VALUE SPACES.                
           05 FILLER                   PIC X(05)  VALUE 'AVAIL'.                
           05 FILLER                   PIC X(06)   VALUE SPACES.                
           05 FILLER                   PIC X(04)  VALUE 'REQD'.                 
           05 FILLER                   PIC X(07)   VALUE SPACES.                
           05 FILLER                   PIC X(03)  VALUE 'BAL'.                  
                                                                                
       01  MAIL-BODY04.                                                         
           05 FILLER                   PIC X(15)  VALUE SPACES.                 
           05 FILLER                   PIC X(10)  VALUE ALL '-'.                
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 FILLER                   PIC X(10)  VALUE ALL '-'.                
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 FILLER                   PIC X(10)  VALUE ALL '-'.                
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 FILLER                   PIC X(10)  VALUE ALL '-'.                
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 FILLER                   PIC X(10)  VALUE ALL '-'.                
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 FILLER                   PIC X(10)  VALUE ALL '-'.                
                                                                                
       01  MAIL-BODY06.                                                         
           05 FILLER                   PIC X(05)  VALUE 'CPF1-'.                
           05 MAIL-CPF1-NRIC           PIC X(09)  VALUE SPACES.                 
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF1-CPF-AVAIL      PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF1-CPF-REQD       PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF1-CPF-BAL        PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF1-CASH-AVAIL     PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF1-CASH-REQD      PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF1-CASH-BAL       PIC ZZZ,ZZZ.00.                          
                                                                                
       01  MAIL-BODY07.                                                         
           05 FILLER                   PIC X(05)  VALUE 'CPF2-'.                
           05 MAIL-CPF2-NRIC           PIC X(09)  VALUE SPACES.                 
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF2-CPF-AVAIL      PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF2-CPF-REQD       PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF2-CPF-BAL        PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF2-CASH-AVAIL     PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF2-CASH-REQD      PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF2-CASH-BAL       PIC ZZZ,ZZZ.00.                          
                                                                                
       01  MAIL-BODY08.                                                         
           05 FILLER                   PIC X(05)  VALUE 'CPF3-'.                
           05 MAIL-CPF3-NRIC           PIC X(09)  VALUE SPACES.                 
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF3-CPF-AVAIL      PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF3-CPF-REQD       PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF3-CPF-BAL        PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF3-CASH-AVAIL     PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF3-CASH-REQD      PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF3-CASH-BAL       PIC ZZZ,ZZZ.00.                          
                                                                                
       01  MAIL-BODY09.                                                         
           05 FILLER                   PIC X(05)  VALUE 'CPF4-'.                
           05 MAIL-CPF4-NRIC           PIC X(09)  VALUE SPACES.                 
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF4-CPF-AVAIL      PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF4-CPF-REQD       PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF4-CPF-BAL        PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF4-CASH-AVAIL     PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF4-CASH-REQD      PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-CPF4-CASH-BAL       PIC ZZZ,ZZZ.00.                          
                                                                                
       01  MAIL-BODY10.                                                         
           05 FILLER                   PIC X(15)  VALUE SPACES.                 
           05 FILLER                   PIC X(10)  VALUE ALL '-'.                
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 FILLER                   PIC X(10)  VALUE ALL '-'.                
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 FILLER                   PIC X(10)  VALUE ALL '-'.                
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 FILLER                   PIC X(10)  VALUE ALL '-'.                
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 FILLER                   PIC X(10)  VALUE ALL '-'.                
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 FILLER                   PIC X(10)  VALUE ALL '-'.                
                                                                                
       01  MAIL-BODY11.                                                         
           05 FILLER                   PIC X(05)  VALUE 'TOTAL'.                
           05 FILLER                   PIC X(10)  VALUE SPACES.                 
           05 MAIL-TOT-CPF-AVAIL       PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-TOT-CPF-REQD        PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-TOT-CPF-BAL         PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-TOT-CASH-AVAIL      PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-TOT-CASH-REQD       PIC ZZZ,ZZZ.00.                          
           05 FILLER                   PIC X(01)  VALUE SPACES.                 
           05 MAIL-TOT-CASH-BAL        PIC ZZZ,ZZZ.00.                          
                                                                                
                                                                                
       01  MAIL-END.                                                            
           05 FILLER                   PIC X      VALUE '.'.                    
                                                                                
       01  MAIL-SPACES.                                                         
           05 FILLER                   PIC X(80)  VALUE SPACES.                 
                                                                                
       01  MAIL-TXT-1.                                                          
           05 FILLER                   PIC X(80)  VALUE                         
              'This is a DBSS 2nd con loan case. Please do the 1st level        
      -       ' check :'.                                                       
                                                                                
       01  MAIL-TXT-2.                                                          
           05 FILLER                   PIC X(80)  VALUE                         
              '(i) check if there is disbursed / undisbursed DBSS loan'.        
                                                                                
       01  MAIL-TXT-3.                                                          
           05 FILLER                   PIC X(80)  VALUE                         
              '(ii) then re-do the DBSS Progress Payment Schedule. '.           
                                                                                
       01  MAIL-TXT-4.                                                          
           05 FILLER                   PIC X(80)  VALUE                         
              'For 2nd level check, please check with Agreement Officers        
      -       '.'.                                                              
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
      *-------------------------------------------------------------            
       0000-MAIN-LOGIC.                                                         
      *-------------------------------------------------------------            
                                                                                
           PERFORM 1000-INITIALIZATION THRU 1000-EXIT.                          
           PERFORM 2000-READ-BP13F482  THRU 2000-EXIT.                          
           PERFORM 3000-WRITE-MAIL     THRU 3000-EXIT                           
                   UNTIL WS-F482-EOF = 'Y'.                                     
           PERFORM 9000-CLOSE-ROUTINE  THRU 9000-EXIT.                          
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       1000-INITIALIZATION.                                                     
      *-------------------------------------------------------------            
                                                                                
           OPEN INPUT  BP13F482                                                 
                       BP13K486                                                 
                       BB24K010                                                 
                       BB24K050                                                 
                       BP13K022                                                 
                       SY02F001                                                 
                OUTPUT BP13MAIL                                                 
                       BP13FOIC.                                                
                                                                                
           IF WS-K486-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K486 - OPEN ERROR (' WS-K486-STATUS ')'              
              MOVE WS-K486-STATUS  TO RETURN-CODE                               
              GO TO 9000-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           IF WS-K022-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K022 - OPEN ERROR (' WS-K022-STATUS ')'              
              MOVE WS-K022-STATUS  TO RETURN-CODE                               
              GO TO 9000-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           IF WS-K010-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BB24K010 - OPEN ERROR (' WS-K010-STATUS ')'              
              MOVE WS-K010-STATUS  TO RETURN-CODE                               
              GO TO 9000-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           IF WS-K050-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BB24K050 - OPEN ERROR (' WS-K050-STATUS ')'              
              MOVE WS-K050-STATUS  TO RETURN-CODE                               
              GO TO 9000-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           READ SY02F001.                                                       
           MOVE F001-DTE-CURRENT   TO WS-SYS-DATE.                              
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       2000-READ-BP13F482.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13F482 AT END                                                 
                MOVE 'Y' TO WS-F482-EOF                                         
                GO TO 2000-EXIT.                                                
                                                                                
           ADD 1 TO WS-F482-READ.                                               
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       3000-WRITE-MAIL.                                                         
      *-------------------------------------------------------------            
                                                                                
           IF F482-DTE-DISPOSAL-COMPLETN = WS-SYS-DATE                          
              PERFORM 4000-WRITE-EMAIL THRU 4000-EXIT                           
           ELSE                                                                 
              IF F482-DTE-DISPOSAL-COMPLETN > WS-SYS-DATE                       
                 MOVE 'Y' TO WS-F482-EOF                                        
                 GO TO 3000-EXIT                                                
              END-IF                                                            
           END-IF                                                               
                                                                                
           PERFORM 2000-READ-BP13F482 THRU 2000-EXIT.                           
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       4000-WRITE-EMAIL.                                                        
      *-------------------------------------------------------------            
                                                                                
           INITIALIZE     MAIL-PRTREC                                           
                          MAIL-BODY06                                           
                          MAIL-BODY07                                           
                          MAIL-BODY08                                           
                          MAIL-BODY09                                           
                          WS-K486-INFO                                          
                          WS-TOTALS                                             
                          WS-K050-FND.                                          
                                                                                
           PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 4                      
              MOVE SPACES      TO WS-NRIC(WS-I)                                 
              MOVE ZEROES      TO WS-CAVAIL(WS-I)                               
              MOVE ZEROES      TO WS-CREQ(WS-I)                                 
           END-PERFORM.                                                         
                                                                                
           PERFORM 4500-PRINT-MAIL-HDR  THRU 4500-EXIT                          
           PERFORM 4550-PRINT-OIC-HDR   THRU 4550-EXIT                          
                                                                                
           IF F482-AMT-TOTL-CPF1-AVAIL NOT NUMERIC                              
              MOVE ZEROES                 TO F482-AMT-TOTL-CPF1-AVAIL           
           END-IF                                                               
                                                                                
           IF F482-AMT-TOTL-CPF2-AVAIL NOT NUMERIC                              
              MOVE ZEROES                 TO F482-AMT-TOTL-CPF2-AVAIL           
           END-IF                                                               
                                                                                
           IF F482-AMT-TOTL-CPF3-AVAIL NOT NUMERIC                              
              MOVE ZEROES                 TO F482-AMT-TOTL-CPF3-AVAIL           
           END-IF                                                               
                                                                                
           IF F482-AMT-TOTL-CPF4-AVAIL NOT NUMERIC                              
              MOVE ZEROES                 TO F482-AMT-TOTL-CPF4-AVAIL           
           END-IF                                                               
                                                                                
           IF F482-AMT-TOTL-CPF1-REQ NOT NUMERIC                                
              MOVE ZEROES                 TO F482-AMT-TOTL-CPF1-REQ             
           END-IF                                                               
                                                                                
           IF F482-AMT-TOTL-CPF2-REQ NOT NUMERIC                                
              MOVE ZEROES                 TO F482-AMT-TOTL-CPF2-REQ             
           END-IF                                                               
                                                                                
           IF F482-AMT-TOTL-CPF3-REQ NOT NUMERIC                                
              MOVE ZEROES                 TO F482-AMT-TOTL-CPF3-REQ             
           END-IF                                                               
                                                                                
           IF F482-AMT-TOTL-CPF4-REQ NOT NUMERIC                                
              MOVE ZEROES                 TO F482-AMT-TOTL-CPF4-REQ             
           END-IF                                                               
                                                                                
           IF F482-AMT-TOTL-CPF1-PAID NOT NUMERIC                               
              MOVE ZEROES                 TO F482-AMT-TOTL-CPF1-PAID            
           END-IF                                                               
                                                                                
           IF F482-AMT-TOTL-CPF2-PAID NOT NUMERIC                               
              MOVE ZEROES                 TO F482-AMT-TOTL-CPF2-PAID            
           END-IF                                                               
                                                                                
           IF F482-AMT-TOTL-CPF3-PAID NOT NUMERIC                               
              MOVE ZEROES                 TO F482-AMT-TOTL-CPF3-PAID            
           END-IF                                                               
                                                                                
           IF F482-AMT-TOTL-CPF4-PAID NOT NUMERIC                               
              MOVE ZEROES                 TO F482-AMT-TOTL-CPF4-PAID            
           END-IF                                                               
                                                                                
           MOVE F482-AMT-TOTL-CPF1-AVAIL  TO MAIL-CPF1-CPF-AVAIL                
           MOVE F482-AMT-TOTL-CPF2-AVAIL  TO MAIL-CPF2-CPF-AVAIL                
           MOVE F482-AMT-TOTL-CPF3-AVAIL  TO MAIL-CPF3-CPF-AVAIL                
           MOVE F482-AMT-TOTL-CPF4-AVAIL  TO MAIL-CPF4-CPF-AVAIL                
           MOVE F482-AMT-TOTL-CPF1-REQ    TO MAIL-CPF1-CPF-REQD                 
           MOVE F482-AMT-TOTL-CPF2-REQ    TO MAIL-CPF2-CPF-REQD                 
           MOVE F482-AMT-TOTL-CPF3-REQ    TO MAIL-CPF3-CPF-REQD                 
           MOVE F482-AMT-TOTL-CPF4-REQ    TO MAIL-CPF4-CPF-REQD                 
           MOVE F482-AMT-TOTL-CPF1-PAID   TO MAIL-CPF1-CPF-BAL                  
           MOVE F482-AMT-TOTL-CPF2-PAID   TO MAIL-CPF2-CPF-BAL                  
           MOVE F482-AMT-TOTL-CPF3-PAID   TO MAIL-CPF3-CPF-BAL                  
           MOVE F482-AMT-TOTL-CPF4-PAID   TO MAIL-CPF4-CPF-BAL                  
                                                                                
           MOVE F482-NUM-NRIC1-NEW        TO MAIL-CPF1-NRIC                     
                                             WS-NRIC(1).                        
           MOVE F482-NUM-NRIC2-NEW        TO MAIL-CPF2-NRIC                     
                                             WS-NRIC(2).                        
           MOVE F482-NUM-NRIC3-NEW        TO MAIL-CPF3-NRIC                     
                                             WS-NRIC(3).                        
           MOVE F482-NUM-NRIC4-NEW        TO MAIL-CPF4-NRIC                     
                                             WS-NRIC(4).                        
                                                                                
           MOVE 1                         TO WS-I                               
                                                                                
           PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 4                      
              IF WS-NRIC(WS-I) NOT = SPACES AND LOW-VALUES                      
                 MOVE WS-NRIC(WS-I)            TO K486-NUM-NRIC                 
                 MOVE F482-NUM-HDBREF-NEW      TO K486-NUM-HDBREF-NEW           
                 MOVE F482-NUM-HDBREF-DISPOSAL TO K486-NUM-HDBREF-EXIST         
                 PERFORM 4600-READ-BP13K486    THRU 4600-EXIT                   
                 IF K486-FND                                                    
                    IF K486-AMT-PROCEED-CASH-AVAIL NOT NUMERIC                  
                       MOVE ZEROES        TO K486-AMT-PROCEED-CASH-AVAIL        
                    END-IF                                                      
                       MOVE K486-AMT-PROCEED-CASH-AVAIL                         
                                          TO WS-CAVAIL(WS-I)                    
                    IF K486-AMT-PROCEED-CASH-REQ  NOT NUMERIC                   
                       MOVE ZEROES        TO K486-AMT-PROCEED-CASH-REQ          
                    END-IF                                                      
                       MOVE K486-AMT-PROCEED-CASH-REQ                           
                                          TO WS-CREQ(WS-I)                      
      *             MOVE                             TO WS-CREQ(WS-I)           
                 END-IF                                                         
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
           MOVE WS-CAVAIL(1)              TO MAIL-CPF1-CASH-AVAIL               
           MOVE WS-CAVAIL(2)              TO MAIL-CPF2-CASH-AVAIL               
           MOVE WS-CAVAIL(3)              TO MAIL-CPF3-CASH-AVAIL               
           MOVE WS-CAVAIL(4)              TO MAIL-CPF4-CASH-AVAIL               
           MOVE WS-CREQ(1)                TO MAIL-CPF1-CASH-REQD                
           MOVE WS-CREQ(2)                TO MAIL-CPF2-CASH-REQD                
           MOVE WS-CREQ(3)                TO MAIL-CPF3-CASH-REQD                
           MOVE WS-CREQ(4)                TO MAIL-CPF4-CASH-REQD                
           MOVE ZEROES                    TO MAIL-CPF1-CASH-BAL                 
           MOVE ZEROES                    TO MAIL-CPF2-CASH-BAL                 
           MOVE ZEROES                    TO MAIL-CPF3-CASH-BAL                 
           MOVE ZEROES                    TO MAIL-CPF4-CASH-BAL                 
                                                                                
           COMPUTE WS-TOT-CPF-AVAIL =  F482-AMT-TOTL-CPF1-AVAIL +               
                                       F482-AMT-TOTL-CPF2-AVAIL +               
                                       F482-AMT-TOTL-CPF3-AVAIL +               
                                       F482-AMT-TOTL-CPF4-AVAIL                 
                                                                                
           COMPUTE WS-TOT-CPF-REQD  =  F482-AMT-TOTL-CPF1-REQ +                 
                                       F482-AMT-TOTL-CPF2-REQ +                 
                                       F482-AMT-TOTL-CPF3-REQ +                 
                                       F482-AMT-TOTL-CPF4-REQ                   
                                                                                
           COMPUTE WS-TOT-CPF-BAL   =  F482-AMT-TOTL-CPF1-PAID +                
                                       F482-AMT-TOTL-CPF2-PAID +                
                                       F482-AMT-TOTL-CPF3-PAID +                
                                       F482-AMT-TOTL-CPF4-PAID                  
                                                                                
           COMPUTE WS-TOT-CASH-AVAIL =  WS-CAVAIL(1) +                          
                                        WS-CAVAIL(2) +                          
                                        WS-CAVAIL(3) +                          
                                        WS-CAVAIL(4)                            
                                                                                
           COMPUTE WS-TOT-CASH-REQD  =  WS-CREQ(1) +                            
                                        WS-CREQ(2) +                            
                                        WS-CREQ(3) +                            
                                        WS-CREQ(4)                              
                                                                                
           IF F482-AMT-TOTL-CASH-PAID NOT NUMERIC                               
              MOVE ZEROES             TO F482-AMT-TOTL-CASH-PAID                
           END-IF                                                               
                                                                                
           COMPUTE WS-TOT-CASH-BAL   =  F482-AMT-TOTL-CASH-PAID                 
                                                                                
           MOVE WS-TOT-CPF-AVAIL          TO MAIL-TOT-CPF-AVAIL                 
           MOVE WS-TOT-CPF-REQD           TO MAIL-TOT-CPF-REQD                  
           MOVE WS-TOT-CPF-BAL            TO MAIL-TOT-CPF-BAL                   
           MOVE WS-TOT-CASH-AVAIL         TO MAIL-TOT-CASH-AVAIL                
           MOVE WS-TOT-CASH-REQD          TO MAIL-TOT-CASH-REQD                 
           MOVE WS-TOT-CASH-BAL           TO MAIL-TOT-CASH-BAL                  
                                                                                
           WRITE MAIL-PRTREC FROM MAIL-BODY06.                                  
           WRITE MAIL-PRTREC FROM MAIL-BODY07.                                  
           WRITE MAIL-PRTREC FROM MAIL-BODY08.                                  
           WRITE MAIL-PRTREC FROM MAIL-BODY09.                                  
           WRITE MAIL-PRTREC FROM MAIL-BODY10.                                  
           WRITE MAIL-PRTREC FROM MAIL-BODY11.                                  
           WRITE MAIL-PRTREC FROM MAIL-SPACES.                                  
           WRITE MAIL-PRTREC FROM MAIL-TXT-1.                                   
           WRITE MAIL-PRTREC FROM MAIL-TXT-2.                                   
           WRITE MAIL-PRTREC FROM MAIL-TXT-3.                                   
           WRITE MAIL-PRTREC FROM MAIL-SPACES.                                  
           WRITE MAIL-PRTREC FROM MAIL-TXT-4.                                   
           WRITE MAIL-PRTREC FROM MAIL-SPACES.                                  
           WRITE MAIL-PRTREC FROM MAIL-END.                                     
                                                                                
           IF K050-FND                                                          
              WRITE OIC-PRTREC FROM MAIL-BODY06                                 
              WRITE OIC-PRTREC FROM MAIL-BODY07                                 
              WRITE OIC-PRTREC FROM MAIL-BODY08                                 
              WRITE OIC-PRTREC FROM MAIL-BODY09                                 
              WRITE OIC-PRTREC FROM MAIL-BODY10                                 
              WRITE OIC-PRTREC FROM MAIL-BODY11                                 
              WRITE OIC-PRTREC FROM MAIL-SPACES                                 
              WRITE OIC-PRTREC FROM MAIL-TXT-1                                  
              WRITE OIC-PRTREC FROM MAIL-TXT-2                                  
              WRITE OIC-PRTREC FROM MAIL-TXT-3                                  
              WRITE OIC-PRTREC FROM MAIL-SPACES                                 
              WRITE OIC-PRTREC FROM MAIL-TXT-4                                  
              WRITE OIC-PRTREC FROM MAIL-SPACES                                 
              WRITE OIC-PRTREC FROM MAIL-END                                    
           END-IF.                                                              
                                                                                
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       4500-PRINT-MAIL-HDR.                                                     
      *-------------------------------------------------------------            
                                                                                
           MOVE SPACES       TO MAIL-PRTREC.                                    
           INITIALIZE           MAIL-PRTREC.                                    
           MOVE F482-NUM-REGN             TO MAIL-NUM-REGN                      
                                                                                
           WRITE MAIL-PRTREC FROM MAIL-HDR1.                                    
           WRITE MAIL-PRTREC FROM MAIL-HDR2.                                    
      *    WRITE MAIL-PRTREC FROM MAIL-DTL1A.                                   
           WRITE MAIL-PRTREC FROM MAIL-DTL1B.                                   
           WRITE MAIL-PRTREC FROM MAIL-DTL1C.                                   
      *    WRITE MAIL-PRTREC FROM MAIL-DTL1E.                                   
      *    WRITE MAIL-PRTREC FROM MAIL-DTL1F.                                   
           WRITE MAIL-PRTREC FROM MAIL-DTL1G.                                   
           WRITE MAIL-PRTREC FROM MAIL-DTL1H.                                   
      *    WRITE MAIL-PRTREC FROM MAIL-DTL1I.                                   
      *    WRITE MAIL-PRTREC FROM MAIL-DTL1J.                                   
           WRITE MAIL-PRTREC FROM MAIL-DTL2.                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL3.                                    
      *    WRITE MAIL-PRTREC FROM MAIL-DTL4A.                                   
           WRITE MAIL-PRTREC FROM MAIL-DTL4B.                                   
           WRITE MAIL-PRTREC FROM MAIL-DTL4C.                                   
      *    WRITE MAIL-PRTREC FROM MAIL-DTL4E.                                   
      *    WRITE MAIL-PRTREC FROM MAIL-DTL4F.                                   
           WRITE MAIL-PRTREC FROM MAIL-DTL4G.                                   
           WRITE MAIL-PRTREC FROM MAIL-DTL4H.                                   
      *    WRITE MAIL-PRTREC FROM MAIL-DTL4I.                                   
      *    WRITE MAIL-PRTREC FROM MAIL-DTL4J.                                   
           WRITE MAIL-PRTREC FROM MAIL-DTL5.                                    
           STRING WS-SYS-DATE(7:2) '/' WS-SYS-DATE(5:2) '/'                     
                  WS-SYS-DATE(1:4)                                              
                  DELIMITED BY SIZE INTO WS-DATE-RPT                            
           WRITE MAIL-PRTREC  FROM MAIL-DTL6                                    
           WRITE MAIL-PRTREC FROM MAIL-SPACES.                                  
           WRITE MAIL-PRTREC FROM MAIL-BODY01.                                  
           WRITE MAIL-PRTREC FROM MAIL-BODY02.                                  
           WRITE MAIL-PRTREC FROM MAIL-BODY03.                                  
           WRITE MAIL-PRTREC FROM MAIL-BODY04.                                  
           WRITE MAIL-PRTREC FROM MAIL-SPACES.                                  
                                                                                
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       4550-PRINT-OIC-HDR.                                                      
      *-------------------------------------------------------------            
                                                                                
           PERFORM 4700-READ-BB24K010 THRU 4700-EXIT.                           
           IF K050-FND                                                          
              CONTINUE                                                          
           ELSE                                                                 
              GO TO 4550-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE SPACES       TO OIC-PRTREC.                                     
           INITIALIZE           OIC-PRTREC.                                     
           MOVE F482-NUM-REGN   TO MAIL-NUM-REGN                                
                                   K022-NUM-REGN                                
           WRITE OIC-PRTREC FROM MAIL-HDR1.                                     
           WRITE OIC-PRTREC FROM MAIL-HDR2.                                     
                                                                                
           MOVE SPACES  TO OIC-PRTREC                                           
           STRING 'RCPT TO:<' DELIMITED BY SIZE                                 
                   K050-NME-LOTUS-NOTES DELIMITED BY SPACES                     
                  '@HDB.GOV.SG>'                                                
                  DELIMITED BY SPACES INTO OIC-PRTREC                           
           WRITE OIC-PRTREC                                                     
           PERFORM 4800-READ-BP13K022  THRU 4800-EXIT                           
                                                                                
           IF (WS-CSM-MAIL-ID NOT = SPACES AND LOW-VALUES)                      
               MOVE SPACES  TO OIC-PRTREC                                       
               STRING 'RCPT TO:<' DELIMITED BY SIZE                             
                       WS-CSM-MAIL-ID DELIMITED BY SPACES                       
                      '@HDB.GOV.SG>'                                            
                       DELIMITED BY SPACES INTO OIC-PRTREC                      
               WRITE OIC-PRTREC                                                 
           END-IF                                                               
                                                                                
           WRITE OIC-PRTREC FROM MAIL-DTL2.                                     
           WRITE OIC-PRTREC FROM MAIL-DTL3.                                     
                                                                                
           MOVE SPACES  TO OIC-PRTREC                                           
           STRING 'TO:<' DELIMITED BY SIZE                                      
                   K050-NME-LOTUS-NOTES DELIMITED BY SPACES                     
                  '@HDB.GOV.SG>'                                                
                  DELIMITED BY SPACES INTO OIC-PRTREC                           
           WRITE OIC-PRTREC                                                     
                                                                                
           IF (WS-CSM-MAIL-ID NOT = SPACES AND LOW-VALUES)                      
               MOVE SPACES  TO OIC-PRTREC                                       
               STRING 'TO:<' DELIMITED BY SIZE                                  
                       WS-CSM-MAIL-ID DELIMITED BY SPACES                       
                      '@HDB.GOV.SG>'                                            
                       DELIMITED BY SPACES INTO OIC-PRTREC                      
               WRITE OIC-PRTREC                                                 
           END-IF                                                               
                                                                                
           WRITE OIC-PRTREC FROM MAIL-DTL5.                                     
           MOVE SPACES TO OIC-PRTREC                                            
           STRING WS-SYS-DATE(7:2) '/' WS-SYS-DATE(5:2) '/'                     
                  WS-SYS-DATE(1:4)                                              
                  DELIMITED BY SIZE INTO WS-DATE-RPT                            
           WRITE OIC-PRTREC  FROM MAIL-DTL6                                     
           WRITE OIC-PRTREC FROM MAIL-SPACES.                                   
           WRITE OIC-PRTREC FROM MAIL-BODY01.                                   
           WRITE OIC-PRTREC FROM MAIL-BODY02.                                   
           WRITE OIC-PRTREC FROM MAIL-BODY03.                                   
           WRITE OIC-PRTREC FROM MAIL-BODY04.                                   
           WRITE OIC-PRTREC FROM MAIL-SPACES.                                   
                                                                                
       4550-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4600-READ-BP13K486.                                                      
      *----------------------------------------------------------------*        
                                                                                
           READ BP13K486.                                                       
                                                                                
           IF WS-K486-STATUS = 00 OR 02                                         
              MOVE 'Y'                        TO WS-K486-FND                    
           ELSE                                                                 
              IF WS-K486-STATUS = 23                                            
                 MOVE 'N'                     TO WS-K486-FND                    
              ELSE                                                              
                 DISPLAY 'BP13K486 - READ ERROR (' WS-K486-STATUS ')'           
                 MOVE WS-K486-STATUS          TO RETURN-CODE                    
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       4700-READ-BB24K010.                                                      
      *-------------------------------------------------------------            
                                                                                
           MOVE F482-NUM-HDBREF-DISPOSAL    TO K010-NUM-HDB-REF                 
                                            OF BB24K010-REC                     
                                                                                
           READ BB24K010 KEY IS K010-ALT-KEY1.                                  
                                                                                
           IF WS-K010-STATUS = 00 OR 02                                         
              PERFORM 4750-READ-BB24K050 THRU 4750-EXIT                         
           ELSE                                                                 
              IF WS-K010-STATUS = 23                                            
                 MOVE 'N'            TO WS-K010-FND                             
              ELSE                                                              
                 DISPLAY 'BB24K010 - READ ERROR (' WS-K010-STATUS ')'           
                 MOVE WS-K010-STATUS  TO RETURN-CODE                            
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       4750-READ-BB24K050.                                                      
      *-------------------------------------------------------------            
                                                                                
           MOVE K010-CDE-INIT-OIC1     TO K050-CDE-INIT-OIC                     
                                                                                
           READ BB24K050 KEY IS K050-ALT-KEY.                                   
                                                                                
           IF WS-K050-STATUS = 00 OR 02                                         
              MOVE 'Y'               TO WS-K050-FND                             
           ELSE                                                                 
              IF WS-K050-STATUS = 23                                            
                 MOVE 'N'            TO WS-K050-FND                             
              ELSE                                                              
                 DISPLAY 'BB24K050 - READ ERROR (' WS-K050-STATUS ')'           
                 MOVE WS-K050-STATUS TO RETURN-CODE                             
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4750-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       4800-READ-BP13K022.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13K022 KEY IS K022-NUM-REGN.                                  
                                                                                
           IF WS-K022-STATUS = 00 OR 02                                         
              IF K022-NUM-OIC-APPL = SPACES OR LOW-VALUES                       
                 MOVE K022-NUM-OIC        TO    WS-CSM-MAIL-ID                  
              ELSE                                                              
                 MOVE K022-NUM-OIC-APPL   TO    WS-CSM-MAIL-ID                  
              END-IF                                                            
           ELSE                                                                 
              IF WS-K022-STATUS = 23                                            
                 MOVE SPACES         TO WS-CSM-MAIL-ID                          
              ELSE                                                              
                 DISPLAY 'BP13K022 - READ ERROR (' WS-K022-STATUS ')'           
                 MOVE WS-K022-STATUS TO RETURN-CODE                             
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       9000-CLOSE-ROUTINE.                                                      
      *-------------------------------------------------------------            
                                                                                
                                                                                
           DISPLAY '- BP13CD91 CONTROL TOTAL --------'.                         
           DISPLAY ' NO OF REC READ FROM BP13F482  = '                          
                     WS-F482-READ.                                              
           DISPLAY ' NO OF REC WRITTEN TO BP13MAIL = '                          
                     WS-SNO.                                                    
           DISPLAY SPACES.                                                      
                                                                                
           CLOSE       BP13F482                                                 
                       BP13K486                                                 
                       BB24K010                                                 
                       BB24K050                                                 
                       BP13K022                                                 
                       BP13MAIL                                                 
                       BP13FOIC.                                                
                                                                                
           IF WS-K486-STATUS NOT = 00                                           
              DISPLAY 'BP13K486 - CLOSE ERROR (' WS-K486-STATUS ')'             
           END-IF.                                                              
           IF WS-K022-STATUS NOT = 00                                           
              DISPLAY 'BP13K022 - CLOSE ERROR (' WS-K022-STATUS ')'             
           END-IF.                                                              
           IF WS-K010-STATUS NOT = 00                                           
              DISPLAY 'BB24K010 - CLOSE ERROR (' WS-K010-STATUS ')'             
           END-IF.                                                              
           IF WS-K050-STATUS NOT = 00                                           
              DISPLAY 'BB24K050 - CLOSE ERROR (' WS-K050-STATUS ')'             
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
