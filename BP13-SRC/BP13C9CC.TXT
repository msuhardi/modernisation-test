      *-----------------------*                                         00010006
       IDENTIFICATION DIVISION.                                         00020006
      *-----------------------*                                         00030006
       PROGRAM-ID.    BP13C9CC.                                         00040006
      *AUTHOR.        CECIL.                                            00050006
      *DTE WRITTEN.   12DEC2002.                                        00060006
                                                                        00070006
      **********************************************************        00080006
      *    SYSTEM NAME : SYSTEM OF COMMITMENT                  *        00090006
      *    SYSTEM ID   : BP13                                  *        00100006
      **********************************************************        00110006
      *    OBJECTIVES  :                                       *        00120006
      *                                                        *        00130006
      *    1.  TO CREATE BP13K730 AND BP13K825 RECORDS WITH    *        00140006
      *        THE FILE FROM UPLOADED FROM BTO INTERNET MODULE.*        00150006
      *        (SIMILAR TO BP13C796)                           *        00160006
      *                                                        *        00170006
      *    INPUT FILES : BP13F757 - BTO FILE                   *        00180006
      *                                                        *        00190006
      *    OUTPUT FILE : BP13F730 - MATURE REQUEST FOR REGN    *        00200006
      *                  BP13F830 - CORR ADDRESS FILE          *        00210006
      *                  BP13F825 - REQUEST OCCUPIER FILE      *        00220006
      *                  BP13F857 - BP13T.K857.EMAIL           *        00230006
      *                  BP13L9CC - LIST OF APPLICANTS W/O     *        00240006
      *                             REGISTRATION NUMBER        *        00250006
      *                  BE01F500 - MHA INTERFACE FILE         *        00260006
      *                                                        *        00270006
      *--------------------------------------------------------*        00280006
      * CHG-NO   BY    DATE   DETAILS                          *        00290006
      * ======= ====  ======  ================================ *        00300006
      * BP132254 MCC  121202  NEW PROGRAM                      *        00310006
      * BP132376 MJ16 080103  INCLUDED OUTPUT FILE BE01F500    *        00320006
      * BP132396 CKK7 082003  CHOICE2 TO BE USED AS FLAT-TYPE  *        00330006
      *                       MOVE SPACES TO NT2.              *        00340006
      * BP132396 SK   092003  ADD 0 TO NUM-LEVEL               *        00350006
      * BP132455 CKK7 191203  MOVE NUM-PPO TO BP13K730         *        00360006
      * BP132496 CKK7 230304  MOVE 'NN' TO NUM-REQUEST-REASON  *        00370006
      * BP132538 CKK7 250504  MOVE MCPS OPTIONS TO BP13K730    *        00380006
      * BP132583 SSD  260804  MOVE MCPS POSTAL AND PORT ELIG   *        00390006
      *                       TAG TO BP13K730                  *        00400006
      * BP132601 SSD  151004  CHGE OPTN-CHOICE1 TO ESTATE-ZONE *        00410006
      *                       & OPTN-CHOICE2 TO FLAT-TYPE      *        00420006
      * BP132626 SK   241104  DELETE K730-DTE-REGN             *        00430006
      * BP132957 CKK  261106  ADD EMAIL FIELD                  *        00440006
      * BP133030 BA2  260307  TO ENHANCE THE REFERRENCE FLD    *        00450006
      * BP133010 CKK7 020407  TO MOVE DTE-BALLOT TO BP13K730   *        00460006
      * BP133056 CKK7 260407  TO MOVE APPT DATE/TIME AND QUEUE *        00470006
      * BP133051 BA3  150507  TO CATER FOR STATUS CODES 02 & 22*        00480006
      * BP133155 MTSR 191107  TO REMOVE OCCUP6-8               *        00490006
      * BP133155 BA2  261107  TO CATER FOR NUM-PPO             *        00500006
      * BP133761 ZDD  241109  MOVE F757-NUM-REGN-PAIRED TO     *        00510006
      *                       K730-NUM-JB-REGN                 *        00520006
      * BP133891 PCL3 190510  MOVE F757-TME-REQUESTED TO       *        00530006
      *                       K730-TME-SYSTEM                  *        00540006
      * BP134229 MRN1 200511  WRITE TO SEQTL INTEAD OF VSAM    *        00550006
      * BP134482 IL5  210312  NEW FIELDS FOR APPS AND MGPS     *        00560006
      * BP134906 SMR2 290413  TO CATER FOR PPS-PREGNANT & DWP  *        00570006
      * BP134906 SMR2 290513  RENAME DWP TO AST                *        00580006
      * BP134996 SMR2 190713  TO INITIALISE NUM-FT2T TO 'N'    *        00590006
      *                       CEASE WRITING OF XIN TO BE01F500 *        00600006
      * BP135485 SMR2 250914  CATER FOR PASSING OF LOW-VALUES  *        00610006
      * BP135944 SMR2 010915  CATER FOR HH INCOME & ELDERLY    *        00620006
      * BP136007 SMR2 181115  DEFAULT NTIMER TO 'N' FOR 2F     *        00630006
      * BP136505 SMR2 031116  WRITE PRSN1 AND PRSN2 RECORDS IN *        00640006
      *                       BE01F500 ONLY WHEN SPEC-SCHEME   *        00650006
      *                       IS 'P' OR 'C'                    *        00660006
      * BP136852 SMR2 210717  DEFAULT NTIMER TO 'N' FOR RF     *        00670006
      * BP137749 AM25 040419  MOVE F757 SPOUSE NRIC TO K825    *        00680006
      * BP138591 AM25 200121  CATER FOR NUM-CCA                *        00690006
      *          IL5  090221  INITIALISE NUM-NTIMER TO 'N'     *        00700006
      * BP138971 KR13 211221  CATER FOR NEW FIN SERIES 'M'     *        00701006
      * BP139582 YCH2 280623  MOVE HA1 CITIZENSHIP FROM K757   *        00702006
      *                        INSTEAD OF DEFAULT AS '10'      *        00703006
      * BP139280 EAA2 031123  EXPAND BP13F757 FROM 3000 TO 4000*        00704006
      *                       INCLUDE OCCUPIER 6               *        00705006
      * BP139780 AM25 301123  CATER FOR NTIMER IN 2F/1F FLAT   *        00705110
      * BP139778 YCH2 071223  FORCE IN HA1 CITIZENSHIP & CORE  *        00705210
      *                       FAMILY FOR INTRANET APPLICATION  *        00705310
      *                       WHICH DO NOT HAVE HFE            *        00705410
      * BP139280 YCH2 081223  ELDERLY ONLY MOVE WHEN FLAT TYPE *        00705513
      *                       2F 1F RF                         *        00705613
      * ====================================================== *        00706006
                                                                        00707006
      *-----------------------*                                         00708006
       ENVIRONMENT DIVISION.                                            00709006
      *-----------------------*                                         00710006
       CONFIGURATION SECTION.                                           00720006
      *-----------------------*                                         00730006
                                                                        00740006
       SOURCE-COMPUTER. IBM-9121.                                       00750006
       OBJECT-COMPUTER. IBM-9121.                                       00760006
                                                                        00770006
      *-----------------------*                                         00780006
       INPUT-OUTPUT SECTION.                                            00790006
      *-----------------------*                                         00800006
       FILE-CONTROL.                                                    00810006
                                                                        00820006
           SELECT BP13F757 ASSIGN    TO BP13F757.                       00830006
                                                                        00840006
           SELECT BE01F500 ASSIGN    TO BE01F500.                       00850006
                                                                        00860006
           SELECT BP13F830 ASSIGN    TO BP13F830.                       00870006
                                                                        00880006
           SELECT BP13F857 ASSIGN    TO BP13F857.                       00890006
                                                                        00900006
           SELECT BP13F730 ASSIGN    TO BP13F730.                       00910006
                                                                        00920006
           SELECT BP13F825 ASSIGN    TO BP13F825.                       00930006
                                                                        00940006
           SELECT BP13L9CC ASSIGN    TO BP13L9CC.                       00950006
                                                                        00960006
                                                                        00970006
      *-----------------------*                                         00980006
       DATA DIVISION.                                                   00990006
      *-----------------------*                                         01000006
       FILE SECTION.                                                    01010006
      *-----------------------*                                         01020006
                                                                        01030006
       FD   BP13F757                                                    01040006
            BLOCK      CONTAINS 0    RECORDS                            01050006
            RECORD     CONTAINS 4000 CHARACTERS                         01060006
            LABEL      RECORDS  ARE  STANDARD                           01070006
            RECORDING  MODE     IS  F.                                  01080006
       COPY BP13F757.                                                   01090006
                                                                        01100006
       FD   BE01F500                                                    01110006
            BLOCK      CONTAINS 0   RECORDS                             01120006
            RECORD     CONTAINS 50  CHARACTERS                          01130006
            LABEL      RECORDS  ARE STANDARD                            01140006
            RECORDING  MODE     IS  F.                                  01150006
       COPY BE01F500.                                                   01160006
                                                                        01170006
       FD   BP13F830                                                    01180006
            BLOCK      CONTAINS 0   RECORDS                             01190006
            RECORD     CONTAINS 250 CHARACTERS                          01200006
            LABEL      RECORDS  ARE STANDARD                            01210006
            RECORDING  MODE     IS  F.                                  01220006
       COPY BP13K830.                                                   01230006
                                                                        01240006
       FD   BP13F857                                                    01250006
            BLOCK      CONTAINS 0   RECORDS                             01260006
            RECORD     CONTAINS 200 CHARACTERS                          01270006
            LABEL      RECORDS  ARE STANDARD                            01280006
            RECORDING  MODE     IS  F.                                  01290006
       COPY BP13K857.                                                   01300006
                                                                        01310006
       FD   BP13F730                                                    01320006
            BLOCK      CONTAINS 0   RECORDS                             01330006
            RECORD     CONTAINS 500 CHARACTERS                          01340006
            LABEL      RECORDS  ARE STANDARD                            01350006
            RECORDING  MODE     IS  F.                                  01360006
       COPY BP13K730.                                                   01370006
                                                                        01380006
       FD   BP13F825                                                    01390006
            BLOCK      CONTAINS 0   RECORDS                             01400006
            RECORD     CONTAINS 200 CHARACTERS                          01410006
            LABEL      RECORDS  ARE STANDARD                            01420006
            RECORDING  MODE     IS  F.                                  01430006
       COPY BP13K825.                                                   01440006
                                                                        01450006
       FD   BP13L9CC                                                    01460006
            BLOCK     CONTAINS 0   RECORDS                              01470006
            RECORD    CONTAINS 132 CHARACTERS                           01480006
            LABEL     RECORDS  ARE OMITTED                              01490006
            RECORDING MODE     IS  F.                                   01500006
       01   BP13L9CC-REC           PIC X(132).                          01510006
                                                                        01520006
      *-----------------------*                                         01530006
       WORKING-STORAGE SECTION.                                         01540006
      *-----------------------*                                         01550006
                                                                        01560006
       COPY IDPTABLE.                                                   01570006
                                                                        01580006
       01  WS-FILE-CONTROLS.                                            01590006
           05  WS-K830-STATUS             PIC 9(2)    VALUE  0.         01600006
           05  WS-K857-STATUS             PIC 9(2)    VALUE  0.         01610006
           05  WS-K825-STATUS             PIC 9(2)    VALUE  0.         01620006
           05  WS-K730-STATUS             PIC 9(2)    VALUE  0.         01630006
           05  WS-F757-EOF-SW             PIC X(1)    VALUE 'N'.        01640006
                                                                        01650006
       01  WS-L9CC-CONTROLS.                                            01660006
           05  WS-L9CC-LINECTR            PIC 9(2)    VALUE 25.         01670006
           05  WS-L9CC-PAGECTR            PIC 9(4)    VALUE 0.          01680006
           05  WS-L9CC-S-NO               PIC 9(5)    VALUE 0.          01690006
                                                                        01700006
       01  WS-RECORD-COUNTERS.                                          01710006
           05  WS-F757-READ-CTR           PIC 9(5)    VALUE 0.          01720006
           05  WS-F500-WRITE-CTR          PIC 9(5)    VALUE 0.          01730006
           05  WS-K730-WRITE-CTR          PIC 9(5)    VALUE 0.          01740006
           05  WS-K825-WRITE-CTR          PIC 9(5)    VALUE 0.          01750006
           05  WS-K830-WRITE-CTR          PIC 9(5)    VALUE 0.          01760006
           05  WS-K857-WRITE-CTR          PIC 9(5)    VALUE 0.          01770006
           05  WS-K730-ERROR-CTR          PIC 9(5)    VALUE 0.          01780006
           05  WS-K825-ERROR-CTR          PIC 9(5)    VALUE 0.          01790006
           05  WS-K830-ERROR-CTR          PIC 9(5)    VALUE 0.          01800006
                                                                        01810006
       01  WS-DATES.                                                    01820006
           05  WS-EDITED-DATE.                                          01830006
               10  WS-EDITED-DD           PIC 9(2).                     01840006
               10  FILLER                 PIC X(1)    VALUE '/'.        01850006
               10  WS-EDITED-MM           PIC 9(2).                     01860006
               10  FILLER                 PIC X(1)    VALUE '/'.        01870006
               10  WS-EDITED-YY           PIC 9(4).                     01880006
           05  WS-CURRENT-DATE.                                         01890006
               10  WS-CURR-CCYY.                                        01900006
                   15  WS-CURR-YY         PIC 9(4).                     01910006
               10  WS-CURR-MM             PIC 9(2).                     01920006
               10  WS-CURR-DD             PIC 9(2).                     01930006
                                                                        01940006
       01  WS-SYSTEM-DATE.                                              01950006
           05  WS-SYS-YY                  PIC 9(4).                     01960006
           05  WS-SYS-MM                  PIC 9(2).                     01970006
           05  WS-SYS-DD                  PIC 9(2).                     01980006
                                                                        01990006
       01  WS-TEMPORARY-FIELDS.                                         02000006
           05  WS-TEMP-NAME               PIC X(66).                    02010006
           05  WS-TEMP-DTE-BIRTH          PIC X(10).                    02020006
           05  WS-TEMP-REGN               PIC X(8).                     02030006
           05  WS-TEMP-NRIC               PIC X(9).                     02040006
           05  WS-TEMP-MSTATUS            PIC X(1).                     02050006
           05  WS-TEMP-INCOME             PIC 9(5).                     02060006
           05  WS-TEMP-CITIZENSHIP        PIC X(2).                     02070006
           05  WS-TEMP-RELATIONSHIP       PIC X(2).                     02080006
           05  WS-TEMP-LESSEE             PIC X(1).                     02090006
           05  WS-TEMP-RACE               PIC X(1).                     02100006
           05  WS-TEMP-SEX                PIC X(1).                     02110006
           05  WS-TEMP-NRIC-SPOUSE        PIC X(9).                     02120006
           05  WS-TEMP-EDN-LVL            PIC X(1).                     02130006
           05  WS-TEMP-PHONE              PIC X(8).                     02140006
           05  WS-TEMP-HP-PAGER           PIC X(8).                     02150006
           05  WS-TEMP-HH-INC             PIC 9(5).                     02160006
                                                                        02170006
       01  WS-OTHERS.                                                   02180006
           05  WS-TMP-EDN                 PIC 9(1).                     02190006
           05  WS-FOUND-SW                PIC X(1)    VALUE 'N'.        02200006
           05  WS-DESC                    PIC X(3)    VALUE SPACES.     02210006
                                                                        02220006
       01  WS-CONSTANT-TEXTS.                                           02230006
           05  WS-ERROR-MESSAGES.                                       02240006
               10  K-K730-ERROR           PIC X(40)   VALUE             02250006
                   'ERROR WRITING TO BP13K730'.                         02260006
               10  K-K825-ERROR           PIC X(40)   VALUE             02270006
                   'ERROR WRITING TO BP13K825'.                         02280006
               10  K-K830-ERROR           PIC X(40)   VALUE             02290006
                   'ERROR WRITING TO BP13K830'.                         02300006
           05  WS-TOTAL-DESC.                                           02310006
               10  K-F757-RECORDS-READ    PIC X(50)   VALUE             02320006
                      'TOTAL RECORDS READ IN BP13F757            : '.   02330006
               10  K-F500-RECORDS-WRITE   PIC X(50)   VALUE             02340006
                      'TOTAL RECORDS WRITE TO BE01F500           : '.   02350006
               10  K-K830-RECORDS-WRITE   PIC X(50)   VALUE             02360006
                      'TOTAL RECORDS WRITE TO BP13K830           : '.   02370006
               10  K-K830-UNSUCC-WRITE    PIC X(50)   VALUE             02380006
                      'TOTAL UNSUCCESSFUL WRITES TO BP13K830     : '.   02390006
               10  K-K825-RECORDS-WRITE   PIC X(50)   VALUE             02400006
                      'TOTAL RECORDS WRITE TO BP13K825           : '.   02410006
               10  K-K825-UNSUCC-WRITE    PIC X(50)   VALUE             02420006
                      'TOTAL UNSUCCESSFUL WRITES TO BP13K825     : '.   02430006
               10  K-K730-RECORDS-WRITE   PIC X(50)   VALUE             02440006
                      'TOTAL RECORDS WRITE TO BP13K730           : '.   02450006
               10  K-K730-UNSUCC-WRITE    PIC X(50)   VALUE             02460006
                      'TOTAL UNSUCCESSFUL WRITES TO BP13K730     : '.   02470006
               10  K-K857-RECORDS-WRITE   PIC X(50)   VALUE             02480006
                      'TOTAL RECORDS WRITE TO BP13K857           : '.   02490006
                                                                        02500006
      **************************************************************    02510006
      *       BP13L9CC -  R E P O R T   L A Y O U T                *    02520006
      **************************************************************    02530006
       01  L9CC-HEADING-01.                                             02540006
           05  FILLER              PIC X(08)     VALUE 'BP13L9CC'.      02550006
           05  FILLER              PIC X(06)     VALUE SPACES.          02560006
           05  FILLER              PIC X(08)     VALUE 'HDB3'.          02570006
           05  FILLER              PIC X(24)     VALUE SPACES.          02580006
           05  FILLER              PIC X(39)     VALUE                  02590006
               'S Y S T E M   O F   C O M M I T M E N T'.               02600006
           05  FILLER              PIC X(13)     VALUE SPACES.          02610006
           05  FILLER              PIC X(07)     VALUE 'DATE :'.        02620006
           05  L9CC-RUN-DATE       PIC X(10).                           02630006
           05  FILLER              PIC X(04)     VALUE SPACES.          02640006
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.       02650006
           05  L9CC-PAGE-NO        PIC ZZZZ9 .                          02660006
                                                                        02670006
       01  L9CC-HEADING-02.                                             02680006
           05  FILLER              PIC X(100)    VALUE SPACES.          02690006
           05  FILLER              PIC X(32)     VALUE                  02700006
               'SALES UNIT (ALLOCATION TEAM)'.                          02710006
                                                                        02720006
       01  L9CC-HEADING-03.                                             02730006
           05  FILLER              PIC X(26)     VALUE SPACES.          02740006
           05  FILLER              PIC X(78)     VALUE                  02750006
               'ERRORS ENCOUNTERED FOR INTERNET APPLICATION'.           02760006
                                                                        02770006
       01  L9CC-HEADING-04.                                             02780006
           05  FILLER              PIC X(08)     VALUE SPACES.          02790006
           05  FILLER              PIC X(05)     VALUE ' S/N'.          02800006
           05  FILLER              PIC X(05)     VALUE SPACES.          02810006
           05  FILLER              PIC X(08)     VALUE ' REF NO '.      02820006
           05  FILLER              PIC X(05)     VALUE SPACES.          02830006
           05  FILLER              PIC X(09)     VALUE '  NRIC'.        02840006
           05  FILLER              PIC X(07)     VALUE SPACES.          02850006
           05  FILLER              PIC X(11)     VALUE 'ERROR NRIC'.    02860006
           05  FILLER              PIC X(05)     VALUE SPACES.          02870006
           05  FILLER              PIC X(40)     VALUE 'REMARKS'.       02880006
                                                                        02890006
       01  L9CC-HEADING-05.                                             02900006
           05  FILLER              PIC X(132)    VALUE ALL '_'.         02910006
                                                                        02920006
       01  L9CC-DETAIL-01.                                              02930006
           05  FILLER              PIC X(08)     VALUE SPACES.          02940006
           05  L9CC-S-NO           PIC X(05).                           02950006
           05  FILLER              PIC X(05)     VALUE SPACES.          02960006
           05  L9CC-REF-NO         PIC X(08).                           02970006
           05  FILLER              PIC X(05)     VALUE SPACES.          02980006
           05  L9CC-NRIC           PIC X(09).                           02990006
           05  FILLER              PIC X(07)     VALUE SPACES.          03000006
           05  L9CC-ERROR-NRIC     PIC X(09).                           03010006
           05  FILLER              PIC X(07)     VALUE SPACES.          03020006
           05  L9CC-REMARKS        PIC X(40).                           03030006
           05  FILLER              PIC X(47)     VALUE SPACES.          03040006
                                                                        03050006
       01  L9CC-TOTALS             REDEFINES     L9CC-DETAIL-01.        03060006
           05  FILLER              PIC X(41).                           03070006
           05  L9CC-TOTAL-DESC     PIC X(50).                           03080006
           05  L9CC-TOTAL-VALUE    PIC X(05).                           03090006
                                                                        03100006
                                                                        03110006
      *-----------------------*                                         03120006
       PROCEDURE DIVISION.                                              03130006
      *-----------------------*                                         03140006
                                                                        03150006
      ******************************************************************03160006
       0000-MAIN.                                                       03170006
      ******************************************************************03180006
           PERFORM  1000-OPEN-FILES         THRU 1000-EXIT.             03190006
           PERFORM  2000-MAIN-ROUTINE       THRU 2000-EXIT.             03200006
           PERFORM  8000-PRINT-REPORT       THRU 8000-EXIT.             03210006
           PERFORM  9000-CLOSE-FILES        THRU 9000-EXIT.             03220006
                                                                        03230006
       0000-EXIT.                                                       03240006
           EXIT.                                                        03250006
                                                                        03260006
                                                                        03270006
      ******************************************************************03280006
       1000-OPEN-FILES.                                                 03290006
      ******************************************************************03300006
           OPEN INPUT  BP13F757                                         03310006
                OUTPUT BP13L9CC                                         03320006
                       BE01F500                                         03330006
                       BP13F730                                         03340006
                       BP13F857                                         03350006
                       BP13F830                                         03360006
                       BP13F825.                                        03370006
                                                                        03380006
           MOVE FUNCTION CURRENT-DATE TO WS-SYSTEM-DATE                 03390006
           MOVE   WS-SYS-YY                TO    WS-EDITED-YY           03400006
                                                 WS-CURR-YY.            03410006
           MOVE   WS-SYS-MM                TO    WS-EDITED-MM           03420006
                                                 WS-CURR-MM.            03430006
           MOVE   WS-SYS-DD                TO    WS-EDITED-DD           03440006
                                                 WS-CURR-DD.            03450006
           MOVE   WS-EDITED-DATE           TO    L9CC-RUN-DATE.         03460006
                                                                        03470006
       1000-EXIT.                                                       03480006
           EXIT.                                                        03490006
                                                                        03500006
                                                                        03510006
      ******************************************************************03520006
       2000-MAIN-ROUTINE.                                               03530006
      ******************************************************************03540006
           PERFORM  3000-BP13F757-READ     THRU 3000-EXIT.              03550006
                                                                        03560006
           PERFORM  4000-PROCESS-F757-REC  THRU 4000-EXIT               03570006
              UNTIL WS-F757-EOF-SW = 'Y'.                               03580006
                                                                        03590006
       2000-EXIT.                                                       03600006
           EXIT.                                                        03610006
                                                                        03620006
                                                                        03630006
      ******************************************************************03640006
       3000-BP13F757-READ.                                              03650006
      ******************************************************************03660006
           READ BP13F757                                                03670006
              AT END MOVE 'Y'     TO WS-F757-EOF-SW                     03680006
              GO TO  3000-EXIT                                          03690006
           END-READ.                                                    03700006
                                                                        03710006
           ADD +1                 TO WS-F757-READ-CTR.                  03720006
                                                                        03730006
           PERFORM 3100-EDIT-NUMERIC-FIELDS    THRU 3100-EXIT.          03740006
                                                                        03750006
       3000-EXIT.                                                       03760006
           EXIT.                                                        03770006
                                                                        03780006
                                                                        03790006
      **********************************************************        03800006
       3100-EDIT-NUMERIC-FIELDS.                                        03810006
      **********************************************************        03820006
           INSPECT F757-AMT-APPLT1-INCOME                               03830006
              REPLACING LEADING SPACES BY ZEROS.                        03840006
                                                                        03850006
           INSPECT F757-AMT-APPLT2-INCOME                               03860006
              REPLACING LEADING SPACES BY ZEROS.                        03870006
                                                                        03880006
           INSPECT F757-AMT-APPLT3-INCOME                               03890006
              REPLACING LEADING SPACES BY ZEROS.                        03900006
                                                                        03910006
           INSPECT F757-AMT-APPLT4-INCOME                               03920006
              REPLACING LEADING SPACES BY ZEROS.                        03930006
                                                                        03940006
           INSPECT F757-AMT-OCCUP1-INCOME                               03950006
              REPLACING LEADING SPACES BY ZEROS.                        03960006
                                                                        03970006
           INSPECT F757-AMT-OCCUP2-INCOME                               03980006
              REPLACING LEADING SPACES BY ZEROS.                        03990006
                                                                        04000006
           INSPECT F757-AMT-OCCUP3-INCOME                               04010006
              REPLACING LEADING SPACES BY ZEROS.                        04020006
                                                                        04030006
           INSPECT F757-AMT-OCCUP4-INCOME                               04040006
              REPLACING LEADING SPACES BY ZEROS.                        04050006
                                                                        04060006
           INSPECT F757-AMT-OCCUP5-INCOME                               04070006
              REPLACING LEADING SPACES BY ZEROS.                        04080006
                                                                        04090006
           INSPECT F757-AMT-OCCUP6-INCOME                               04100006
              REPLACING LEADING SPACES BY ZEROS.                        04110006
                                                                        04120006
       3100-EXIT.                                                       04130006
           EXIT.                                                        04140006
                                                                        04150006
                                                                        04160006
      **********************************************************        04170006
       4000-PROCESS-F757-REC.                                           04180006
      **********************************************************        04190006
           MOVE SPACES TO WS-TEMP-SEX                                   04200006
                          WS-TEMP-RACE                                  04210006
                          WS-TEMP-MSTATUS.                              04220006
           MOVE ZEROES TO WS-TEMP-HH-INC.                               04230006
                                                                        04240006
           IF F757-NUM-REGN = SPACE OR LOW-VALUES                       04250006
              PERFORM 3000-BP13F757-READ THRU 3000-EXIT                 04260006
              GO TO 4000-EXIT.                                          04270006
                                                                        04280006
           PERFORM 4050-WRITE-MHA-INFO  THRU 4050-EXIT.                 04290006
           MOVE F757-NUM-REGN           TO WS-TEMP-REGN.                04300006
           MOVE F757-NME-APPLT1         TO WS-TEMP-NAME.                04310006
           MOVE F757-DTE-APPLT1-BIRTH   TO WS-TEMP-DTE-BIRTH.           04320006
           MOVE F757-NUM-APPLT1-UIN     TO WS-TEMP-NRIC.                04330006
           MOVE F757-NUM-APPLT1-MARITAL-STATUS TO WS-TEMP-MSTATUS.      04340006
           MOVE F757-AMT-APPLT1-INCOME  TO WS-TEMP-INCOME.              04350006
           ADD F757-AMT-APPLT1-INCOME   TO WS-TEMP-HH-INC.              04360006
                                                                        04360109
      * CATER FOR INTRANET APPLICATION                                  04360209
                                                                        04360309
           IF F757-NUM-PAYMODE = 'CS'                                   04360409
              IF F757-NUM-APPLT1-CITIZENSHIP = SPACES OR LOW-VALUE      04361009
                 MOVE '10'                        TO WS-TEMP-CITIZENSHIP04370009
              ELSE                                                      04370109
                 MOVE F757-NUM-APPLT1-CITIZENSHIP TO WS-TEMP-CITIZENSHIP04370209
              END-IF                                                    04370409
                                                                        04370509
              IF F757-NUM-CORE-FAMILY-HA1 = SPACES OR LOW-VALUE         04370609
                 MOVE 'Y'                         TO WS-TEMP-LESSEE     04370709
              ELSE                                                      04370809
                 MOVE F757-NUM-CORE-FAMILY-HA1    TO WS-TEMP-LESSEE     04370909
              END-IF                                                    04371009
           ELSE                                                         04372009
              MOVE F757-NUM-APPLT1-CITIZENSHIP    TO WS-TEMP-CITIZENSHIP04380009
              MOVE F757-NUM-CORE-FAMILY-HA1       TO WS-TEMP-LESSEE     04381609
           END-IF.                                                      04381709
                                                                        04381809
           MOVE '00'                    TO WS-TEMP-RELATIONSHIP.        04382006
                                                                        04382109
           MOVE F757-NUM-APPLT1-RACE    TO WS-TEMP-RACE.                04384006
           MOVE F757-NUM-APPLT1-SEX     TO WS-TEMP-SEX.                 04385006
           MOVE F757-NUM-APPLT1-EDN-LVL TO WS-TEMP-EDN-LVL.             04386006
           MOVE F757-NUM-APPLT1-PHONE   TO WS-TEMP-PHONE.               04387006
           MOVE F757-NUM-APPLT1-HP-PAGER TO WS-TEMP-HP-PAGER.           04388006
           MOVE F757-NUM-APPLT1-SPOUSE-UIN TO WS-TEMP-NRIC-SPOUSE.      04389006
                                                                        04390006
           PERFORM 4200-BP13K825-WRITE  THRU 4200-EXIT.                 04400006
           PERFORM 4250-WRITE-CO-APPL   THRU 4250-EXIT.                 04410006
           PERFORM 4260-WRITE-OCCUP     THRU 4260-EXIT.                 04420006
           PERFORM 4300-BP13K730-WRITE  THRU 4300-EXIT.                 04430006
           PERFORM 4400-BP13K830-WRITE  THRU 4400-EXIT.                 04440006
           PERFORM 4500-BP13K857-WRITE  THRU 4500-EXIT.                 04450006
                                                                        04460006
           PERFORM 3000-BP13F757-READ      THRU 3000-EXIT.              04470006
                                                                        04480006
       4000-EXIT.                                                       04490006
           EXIT.                                                        04500006
                                                                        04510006
                                                                        04520006
      **********************************************************        04530006
       4050-WRITE-MHA-INFO.                                             04540006
      **********************************************************        04550006
      *-----------------------> WRITE APPLICANT    1                    04560006
           MOVE SPACES                        TO   BE01F500-REC.        04570006
           MOVE F757-NUM-APPLT1-UIN           TO   BE01F500-IDNO.       04580006
           PERFORM 4051-BE01F500-WRITE        THRU 4051-EXIT.           04590006
                                                                        04600006
      *-----------------------> WRITE CO-APPLICANT 1                    04610006
           IF F757-NUM-APPLT2-UIN   NOT = SPACES                        04620006
              MOVE SPACES                     TO   BE01F500-REC         04630006
              MOVE F757-NUM-APPLT2-UIN        TO   BE01F500-IDNO        04640006
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            04650006
           END-IF.                                                      04660006
                                                                        04670006
      *-----------------------> WRITE CO-APPLICANT 2                    04680006
           IF F757-NUM-APPLT3-UIN  NOT = SPACES                         04690006
              MOVE SPACES                     TO   BE01F500-REC         04700006
              MOVE F757-NUM-APPLT3-UIN        TO   BE01F500-IDNO        04710006
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            04720006
           END-IF.                                                      04730006
                                                                        04740006
      *-----------------------> WRITE CO-APPLICANT 3                    04750006
           IF F757-NUM-APPLT4-UIN   NOT = SPACES                        04760006
              MOVE SPACES                     TO   BE01F500-REC         04770006
              MOVE F757-NUM-APPLT4-UIN        TO   BE01F500-IDNO        04780006
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            04790006
           END-IF.                                                      04800006
                                                                        04810006
      *-----------------------> WRITE OCCUPIER     1                    04820006
           IF F757-NUM-OCCUP1-UIN NOT = SPACES                          04830006
              MOVE SPACES                     TO   BE01F500-REC         04840006
              MOVE F757-NUM-OCCUP1-UIN        TO   BE01F500-IDNO        04850006
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            04860006
           END-IF.                                                      04870006
                                                                        04880006
      *-----------------------> WRITE OCCUPIER     2                    04890006
           IF F757-NUM-OCCUP2-UIN NOT = SPACES                          04900006
              MOVE SPACES                     TO   BE01F500-REC         04910006
              MOVE F757-NUM-OCCUP2-UIN        TO   BE01F500-IDNO        04920006
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            04930006
           END-IF.                                                      04940006
                                                                        04950006
      *-----------------------> WRITE OCCUPIER     3                    04960006
           IF F757-NUM-OCCUP3-UIN NOT = SPACES                          04970006
              MOVE SPACES                     TO   BE01F500-REC         04980006
              MOVE F757-NUM-OCCUP3-UIN        TO   BE01F500-IDNO        04990006
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            05000006
           END-IF.                                                      05010006
                                                                        05020006
      *-----------------------> WRITE OCCUPIER     4                    05030006
           IF F757-NUM-OCCUP4-UIN NOT = SPACES                          05040006
              MOVE SPACES                     TO   BE01F500-REC         05050006
              MOVE F757-NUM-OCCUP4-UIN        TO   BE01F500-IDNO        05060006
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            05070006
           END-IF.                                                      05080006
                                                                        05090006
      *-----------------------> WRITE OCCUPIER     5                    05100006
           IF F757-NUM-OCCUP5-UIN NOT = SPACES                          05110006
              MOVE SPACES                     TO   BE01F500-REC         05120006
              MOVE F757-NUM-OCCUP5-UIN        TO   BE01F500-IDNO        05130006
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            05140006
           END-IF.                                                      05150006
                                                                        05160006
      *-----------------------> WRITE OCCUPIER     6                    05170006
           IF F757-NUM-OCCUP6-UIN NOT = SPACES                          05180006
              MOVE SPACES                     TO   BE01F500-REC         05190006
              MOVE F757-NUM-OCCUP6-UIN        TO   BE01F500-IDNO        05200006
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            05210006
           END-IF.                                                      05220006
                                                                        05230006
      *-----------------------> WRITE MCPS RESIDENT1                    05240006
           IF F757-NUM-PRSN1-UIN NOT = SPACES                           05250006
              IF F757-NUM-SPEC-SCHEME = 'P' OR 'C'                      05260006
                 MOVE SPACES                  TO   BE01F500-REC         05270006
                 MOVE F757-NUM-PRSN1-UIN      TO   BE01F500-IDNO        05280006
                 PERFORM 4051-BE01F500-WRITE  THRU 4051-EXIT            05290006
              END-IF                                                    05300006
           END-IF.                                                      05310006
                                                                        05320006
      *-----------------------> WRITE MCPS RESIDENT2                    05330006
           IF F757-NUM-PRSN2-UIN NOT = SPACES                           05340006
              IF F757-NUM-SPEC-SCHEME = 'P' OR 'C'                      05350006
                 MOVE SPACES                  TO   BE01F500-REC         05360006
                 MOVE F757-NUM-PRSN2-UIN      TO   BE01F500-IDNO        05370006
                 PERFORM 4051-BE01F500-WRITE  THRU 4051-EXIT            05380006
              END-IF                                                    05390006
           END-IF.                                                      05400006
                                                                        05410006
       4050-EXIT.                                                       05420006
           EXIT.                                                        05430006
                                                                        05440006
                                                                        05450006
      **********************************************************        05460006
       4051-BE01F500-WRITE.                                             05470006
      **********************************************************        05480006
           IF BE01F500-IDNO(1:1) = 'S' OR 'T'                           05490006
               MOVE 'UIN'            TO   BE01F500-IDNO-TYPE            05500006
           ELSE                                                         05510006
             IF BE01F500-IDNO(1:1) = 'G' OR 'F' OR 'M'                  05520006
               MOVE 'FIN'          TO   BE01F500-IDNO-TYPE              05530006
             ELSE                                                       05540006
               GO TO 4051-EXIT                                          05550006
             END-IF                                                     05560006
           END-IF.                                                      05570006
                                                                        05580006
           MOVE WS-SYSTEM-DATE            TO BE01F500-DATE-FIRST-SENT.  05590006
           MOVE  'BP13'                   TO  BE01F500-SOURCE.          05600006
           MOVE  'N'                      TO  BE01F500-DB-TAG.          05610006
           MOVE F757-NUM-REGN          TO   BE01F500-REF-NO(1:8).       05620006
           WRITE BE01F500-REC.                                          05630006
           ADD   +1                    TO   WS-F500-WRITE-CTR.          05640006
                                                                        05650006
       4051-EXIT.                                                       05660006
           EXIT.                                                        05670006
                                                                        05680006
                                                                        05690006
      **********************************************************        05700006
       4200-BP13K825-WRITE.                                             05710006
      **********************************************************        05720006
           MOVE SPACES               TO BP13K825-REC.                   05730006
           MOVE ZEROS                TO K825-AMT-INCOME                 05740006
                                        K825-AMT-INCOME-TP.             05750006
                                                                        05760006
           MOVE WS-TEMP-REGN         TO K825-NUM-REGN.                  05770006
           MOVE WS-TEMP-NAME         TO K825-NME-OCCP.                  05780006
           MOVE WS-TEMP-DTE-BIRTH    TO K825-DTE-BIRTH.                 05790006
           IF WS-TEMP-NRIC(1:1) = '-'                                   05800006
              MOVE 'X'                  TO K825-NUM-NRIC(1:1)           05810006
              MOVE WS-TEMP-NRIC(2:8)    TO K825-NUM-NRIC(2:8)           05820006
           ELSE                                                         05830006
              MOVE WS-TEMP-NRIC         TO K825-NUM-NRIC.               05840006
                                                                        05850006
           IF F757-NUM-PPS-NRIC-PREGNANT = SPACES OR LOW-VALUES         05860006
              MOVE SPACES               TO K825-NUM-PPS-PREGNANT        05870006
           ELSE                                                         05880006
              IF F757-NUM-PPS-NRIC-PREGNANT = WS-TEMP-NRIC              05890006
                 MOVE 'Y'               TO K825-NUM-PPS-PREGNANT        05900006
              ELSE                                                      05910006
                 MOVE SPACES            TO K825-NUM-PPS-PREGNANT        05920006
              END-IF                                                    05930006
           END-IF.                                                      05940006
                                                                        05950006
           IF F757-NUM-NRIC-AST = SPACES OR LOW-VALUES                  05960006
              MOVE SPACES               TO K825-NUM-AST                 05970006
           ELSE                                                         05980006
              IF F757-NUM-NRIC-AST = WS-TEMP-NRIC                       05990006
                 MOVE 'Y'               TO K825-NUM-AST                 06000006
              ELSE                                                      06010006
                 MOVE SPACES            TO K825-NUM-AST                 06020006
              END-IF                                                    06030006
           END-IF.                                                      06040006
                                                                        06050006
           PERFORM 4270-CONVERT-SEX-RACE-MSTATUS THRU 4270-EXIT.        06060006
                                                                        06070006
           IF WS-TEMP-INCOME NOT NUMERIC                                06080006
              MOVE ZEROES            TO K825-AMT-INCOME                 06090006
           ELSE                                                         06100006
              MOVE WS-TEMP-INCOME    TO K825-AMT-INCOME                 06110006
           END-IF.                                                      06120006
           MOVE WS-TEMP-CITIZENSHIP  TO K825-NUM-CITIZENSHIP.           06130006
           MOVE WS-TEMP-RELATIONSHIP TO K825-NUM-RELATIONSHIP.          06140006
           MOVE WS-TEMP-LESSEE       TO K825-NUM-LESSEE-CHECK.          06150006
           IF WS-TEMP-MSTATUS = 'M'                                     06160006
              IF WS-TEMP-NRIC-SPOUSE(1:1) = '-'                         06170006
                 IF WS-TEMP-NRIC-SPOUSE(2:8) = SPACES OR LOW-VALUES     06180006
                    MOVE SPACES            TO K825-NUM-NRIC-SPOUSE      06190006
                 ELSE                                                   06200006
                    MOVE 'X'               TO K825-NUM-NRIC-SPOUSE(1:1) 06210006
                    MOVE WS-TEMP-NRIC-SPOUSE(2:8)                       06220006
                                           TO K825-NUM-NRIC-SPOUSE(2:8) 06230006
                 END-IF                                                 06240006
              ELSE                                                      06250006
                 MOVE WS-TEMP-NRIC-SPOUSE  TO K825-NUM-NRIC-SPOUSE      06260006
              END-IF                                                    06270006
           ELSE                                                         06280006
              MOVE SPACES                  TO K825-NUM-NRIC-SPOUSE      06290006
           END-IF.                                                      06300006
                                                                        06310006
           MOVE WS-TEMP-EDN-LVL      TO WS-TMP-EDN.                     06320006
           ADD +1                    TO WS-TMP-EDN.                     06330006
           MOVE WS-TMP-EDN           TO K825-NUM-EDUCATION.             06340006
                                                                        06350006
           MOVE WS-TEMP-PHONE        TO K825-NUM-PHONE.                 06360006
           MOVE WS-TEMP-HP-PAGER     TO K825-NUM-HP-PGR.                06370006
           MOVE WS-CURRENT-DATE      TO K825-DTE-UPDATE.                06380006
           MOVE 'P13C9CC'            TO K825-NUM-USERID.                06390006
                                                                        06400006
           WRITE BP13K825-REC.                                          06410006
           ADD  +1                TO WS-K825-WRITE-CTR.                 06420006
                                                                        06430006
       4200-EXIT.                                                       06440006
           EXIT.                                                        06450006
                                                                        06460006
                                                                        06470006
      **********************************************************        06480006
       4250-WRITE-CO-APPL.                                              06490006
      **********************************************************        06500006
      *    MOVE SPACES                            TO WS-TEMP-RACE       06510006
      *                                              WS-TEMP-SEX.       06520006
      *------------> CO-APPLICANT  1                                    06530006
           IF F757-NUM-APPLT2-UIN NOT = SPACES                          06540006
              MOVE F757-NUM-APPLT2-UIN            TO WS-TEMP-NRIC       06550006
              MOVE F757-NME-APPLT2                TO WS-TEMP-NAME       06560006
              MOVE F757-DTE-APPLT2-BIRTH          TO WS-TEMP-DTE-BIRTH  06570006
              MOVE F757-AMT-APPLT2-INCOME         TO WS-TEMP-INCOME     06580006
              ADD F757-AMT-APPLT2-INCOME          TO WS-TEMP-HH-INC     06590006
              MOVE F757-NUM-APPLT2-RACE           TO WS-TEMP-RACE       06600006
              MOVE F757-NUM-APPLT2-SEX            TO WS-TEMP-SEX        06610006
              MOVE F757-NUM-APPLT2-MARITAL-STATUS TO WS-TEMP-MSTATUS    06620006
              MOVE F757-NUM-APPLT2-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 06630006
              MOVE F757-NUM-APPLT2-RLTNSP-APPLT1 TO WS-TEMP-RELATIONSHIP06640006
              MOVE F757-NUM-APPLT2-EDN-LVL       TO WS-TEMP-EDN-LVL     06650006
              MOVE F757-NUM-APPLT2-PHONE         TO WS-TEMP-PHONE       06660006
              MOVE F757-NUM-APPLT2-HP-PAGER      TO WS-TEMP-HP-PAGER    06670006
              MOVE F757-NUM-CORE-FAMILY-HA2      TO WS-TEMP-LESSEE      06680006
              MOVE F757-NUM-APPLT2-SPOUSE-UIN    TO WS-TEMP-NRIC-SPOUSE 06690006
                                                                        06700006
              PERFORM 4200-BP13K825-WRITE      THRU 4200-EXIT           06710006
           END-IF.                                                      06720006
                                                                        06730006
      *------------> CO-APPLICANT  2                                    06740006
           IF F757-NUM-APPLT3-UIN NOT = SPACES                          06750006
              MOVE F757-NUM-APPLT3-UIN            TO WS-TEMP-NRIC       06760006
              MOVE F757-NME-APPLT3                TO WS-TEMP-NAME       06770006
              MOVE F757-DTE-APPLT3-BIRTH          TO WS-TEMP-DTE-BIRTH  06780006
              MOVE F757-AMT-APPLT3-INCOME         TO WS-TEMP-INCOME     06790006
              ADD F757-AMT-APPLT3-INCOME          TO WS-TEMP-HH-INC     06800006
              MOVE F757-NUM-APPLT3-RACE           TO WS-TEMP-RACE       06810006
              MOVE F757-NUM-APPLT3-SEX            TO WS-TEMP-SEX        06820006
              MOVE F757-NUM-APPLT3-MARITAL-STATUS TO WS-TEMP-MSTATUS    06830006
              MOVE F757-NUM-APPLT3-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 06840006
              MOVE F757-NUM-APPLT3-RLTNSP-APPLT1 TO WS-TEMP-RELATIONSHIP06850006
              MOVE F757-NUM-APPLT3-EDN-LVL       TO WS-TEMP-EDN-LVL     06860006
              MOVE F757-NUM-APPLT3-PHONE         TO WS-TEMP-PHONE       06870006
              MOVE F757-NUM-APPLT3-HP-PAGER      TO WS-TEMP-HP-PAGER    06880006
              MOVE F757-NUM-CORE-FAMILY-HA3      TO WS-TEMP-LESSEE      06890006
              MOVE F757-NUM-APPLT3-SPOUSE-UIN    TO WS-TEMP-NRIC-SPOUSE 06900006
                                                                        06910006
              PERFORM 4200-BP13K825-WRITE      THRU 4200-EXIT           06920006
           END-IF.                                                      06930006
                                                                        06940006
      *------------> CO-APPLICANT  3                                    06950006
           IF F757-NUM-APPLT4-UIN NOT = SPACES                          06960006
              MOVE F757-NUM-APPLT4-UIN            TO WS-TEMP-NRIC       06970006
              MOVE F757-NME-APPLT4                TO WS-TEMP-NAME       06980006
              MOVE F757-DTE-APPLT4-BIRTH          TO WS-TEMP-DTE-BIRTH  06990006
              MOVE F757-AMT-APPLT4-INCOME         TO WS-TEMP-INCOME     07000006
              ADD F757-AMT-APPLT4-INCOME          TO WS-TEMP-HH-INC     07010006
              MOVE F757-NUM-APPLT4-RACE           TO WS-TEMP-RACE       07020006
              MOVE F757-NUM-APPLT4-SEX            TO WS-TEMP-SEX        07030006
              MOVE F757-NUM-APPLT4-MARITAL-STATUS TO WS-TEMP-MSTATUS    07040006
              MOVE F757-NUM-APPLT4-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 07050006
              MOVE F757-NUM-APPLT4-RLTNSP-APPLT1 TO WS-TEMP-RELATIONSHIP07060006
              MOVE F757-NUM-APPLT4-EDN-LVL       TO WS-TEMP-EDN-LVL     07070006
              MOVE F757-NUM-APPLT4-PHONE         TO WS-TEMP-PHONE       07080006
              MOVE F757-NUM-APPLT4-HP-PAGER      TO WS-TEMP-HP-PAGER    07090006
              MOVE F757-NUM-CORE-FAMILY-HA4      TO WS-TEMP-LESSEE      07100006
              MOVE F757-NUM-APPLT4-SPOUSE-UIN    TO WS-TEMP-NRIC-SPOUSE 07110006
                                                                        07120006
              PERFORM 4200-BP13K825-WRITE      THRU 4200-EXIT           07130006
           END-IF.                                                      07140006
                                                                        07150006
       4250-EXIT.                                                       07160006
           EXIT.                                                        07170006
                                                                        07180006
                                                                        07190006
      **********************************************************        07200006
       4260-WRITE-OCCUP.                                                07210006
      **********************************************************        07220006
      *------------> OCCUPANT  1                                        07230006
           IF F757-NUM-OCCUP1-UIN NOT = SPACES                          07240006
              MOVE F757-NUM-OCCUP1-UIN            TO WS-TEMP-NRIC       07250006
              MOVE F757-NME-OCCUP1                TO WS-TEMP-NAME       07260006
              MOVE F757-DTE-OCCUP1-BIRTH          TO WS-TEMP-DTE-BIRTH  07270006
              MOVE F757-AMT-OCCUP1-INCOME         TO WS-TEMP-INCOME     07280006
              IF (F757-CDE-ALLOC-SCH NOT = 'FTS') OR                    07290006
                 (F757-CDE-ALLOC-SCH = 'FTS' AND                        07300006
                  F757-CDE-ELIG-SCH = 'NCS' AND                         07310006
                  F757-NUM-OCCUP1-RLTNSP-APPLT1 = '20 ')                07320006
                 ADD F757-AMT-OCCUP1-INCOME       TO WS-TEMP-HH-INC     07330006
              END-IF                                                    07340006
              MOVE F757-NUM-OCCUP1-MARITAL-STATUS TO WS-TEMP-MSTATUS    07350006
              MOVE F757-NUM-OCCUP1-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 07360006
              MOVE F757-NUM-OCCUP1-RLTNSP-APPLT1 TO                     07370006
                                                   WS-TEMP-RELATIONSHIP 07380006
              MOVE F757-NUM-OCCUP1-RACE         TO WS-TEMP-RACE         07390006
              MOVE F757-NUM-OCCUP1-SEX          TO WS-TEMP-SEX          07400006
      *       MOVE SPACES                       TO WS-TEMP-LESSEE       07410006
              MOVE F757-NUM-CORE-FAMILY-OCC1    TO WS-TEMP-LESSEE       07420006
              MOVE F757-NUM-OCCUP1-EDN-LVL      TO WS-TEMP-EDN-LVL      07430006
              MOVE F757-NUM-OCCUP1-PHONE        TO WS-TEMP-PHONE        07440006
              MOVE F757-NUM-OCCUP1-HP-PAGER     TO WS-TEMP-HP-PAGER     07450006
              MOVE F757-NUM-OCCUP1-SPOUSE-UIN   TO WS-TEMP-NRIC-SPOUSE  07460006
                                                                        07470006
              PERFORM 4200-BP13K825-WRITE     THRU 4200-EXIT            07480006
           END-IF.                                                      07490006
                                                                        07500006
      *------------> OCCUPANT  2                                        07510006
           IF F757-NUM-OCCUP2-UIN NOT = SPACES                          07520006
              MOVE F757-NUM-OCCUP2-UIN            TO WS-TEMP-NRIC       07530006
              MOVE F757-NME-OCCUP2                TO WS-TEMP-NAME       07540006
              MOVE F757-DTE-OCCUP2-BIRTH          TO WS-TEMP-DTE-BIRTH  07550006
              MOVE F757-AMT-OCCUP2-INCOME         TO WS-TEMP-INCOME     07560006
              IF (F757-CDE-ALLOC-SCH NOT = 'FTS') OR                    07570006
                 (F757-CDE-ALLOC-SCH = 'FTS' AND                        07580006
                  F757-CDE-ELIG-SCH = 'NCS' AND                         07590006
                  F757-NUM-OCCUP2-RLTNSP-APPLT1 = '20 ')                07600006
                 ADD F757-AMT-OCCUP2-INCOME       TO WS-TEMP-HH-INC     07610006
              END-IF                                                    07620006
              MOVE F757-NUM-OCCUP2-MARITAL-STATUS TO WS-TEMP-MSTATUS    07630006
              MOVE F757-NUM-OCCUP2-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 07640006
              MOVE F757-NUM-OCCUP2-RLTNSP-APPLT1 TO                     07650006
                                                   WS-TEMP-RELATIONSHIP 07660006
              MOVE F757-NUM-OCCUP2-RACE         TO WS-TEMP-RACE         07670006
              MOVE F757-NUM-OCCUP2-SEX          TO WS-TEMP-SEX          07680006
      *       MOVE SPACES                       TO WS-TEMP-LESSEE       07690006
              MOVE F757-NUM-CORE-FAMILY-OCC2    TO WS-TEMP-LESSEE       07691006
              MOVE F757-NUM-OCCUP2-EDN-LVL      TO WS-TEMP-EDN-LVL      07692006
              MOVE F757-NUM-OCCUP2-PHONE        TO WS-TEMP-PHONE        07693006
              MOVE F757-NUM-OCCUP2-HP-PAGER     TO WS-TEMP-HP-PAGER     07694006
              MOVE F757-NUM-OCCUP2-SPOUSE-UIN   TO WS-TEMP-NRIC-SPOUSE  07695006
                                                                        07696006
              PERFORM 4200-BP13K825-WRITE     THRU 4200-EXIT            07697006
           END-IF.                                                      07698006
                                                                        07699006
      *------------> OCCUPANT  3                                        07700006
           IF F757-NUM-OCCUP3-UIN NOT = SPACES                          07710006
              MOVE F757-NUM-OCCUP3-UIN            TO WS-TEMP-NRIC       07720006
              MOVE F757-NME-OCCUP3                TO WS-TEMP-NAME       07730006
              MOVE F757-DTE-OCCUP3-BIRTH          TO WS-TEMP-DTE-BIRTH  07740006
              MOVE F757-AMT-OCCUP3-INCOME         TO WS-TEMP-INCOME     07750006
              IF (F757-CDE-ALLOC-SCH NOT = 'FTS') OR                    07760006
                 (F757-CDE-ALLOC-SCH = 'FTS' AND                        07770006
                  F757-CDE-ELIG-SCH = 'NCS' AND                         07780006
                  F757-NUM-OCCUP3-RLTNSP-APPLT1 = '20 ')                07790006
                 ADD F757-AMT-OCCUP3-INCOME       TO WS-TEMP-HH-INC     07800006
              END-IF                                                    07810006
              MOVE F757-NUM-OCCUP3-MARITAL-STATUS TO WS-TEMP-MSTATUS    07820006
              MOVE F757-NUM-OCCUP3-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 07830006
              MOVE F757-NUM-OCCUP3-RLTNSP-APPLT1 TO                     07840006
                                                   WS-TEMP-RELATIONSHIP 07850006
              MOVE F757-NUM-OCCUP3-RACE         TO WS-TEMP-RACE         07860006
              MOVE F757-NUM-OCCUP3-SEX          TO WS-TEMP-SEX          07870006
      *       MOVE SPACES                       TO WS-TEMP-LESSEE       07880006
              MOVE F757-NUM-CORE-FAMILY-OCC3    TO WS-TEMP-LESSEE       07890006
              MOVE F757-NUM-OCCUP3-EDN-LVL      TO WS-TEMP-EDN-LVL      07900006
              MOVE F757-NUM-OCCUP3-PHONE        TO WS-TEMP-PHONE        07910006
              MOVE F757-NUM-OCCUP3-HP-PAGER     TO WS-TEMP-HP-PAGER     07920006
              MOVE F757-NUM-OCCUP3-SPOUSE-UIN   TO WS-TEMP-NRIC-SPOUSE  07930006
                                                                        07940006
              PERFORM 4200-BP13K825-WRITE     THRU 4200-EXIT            07950006
           END-IF.                                                      07960006
                                                                        07970006
      *------------> OCCUPANT  4                                        07980006
           IF F757-NUM-OCCUP4-UIN NOT = SPACES                          07990006
              MOVE F757-NUM-OCCUP4-UIN            TO WS-TEMP-NRIC       08000006
              MOVE F757-NME-OCCUP4                TO WS-TEMP-NAME       08010006
              MOVE F757-DTE-OCCUP4-BIRTH          TO WS-TEMP-DTE-BIRTH  08020006
              MOVE F757-AMT-OCCUP4-INCOME         TO WS-TEMP-INCOME     08030006
              IF (F757-CDE-ALLOC-SCH NOT = 'FTS') OR                    08040006
                 (F757-CDE-ALLOC-SCH = 'FTS' AND                        08050006
                  F757-CDE-ELIG-SCH = 'NCS' AND                         08060006
                  F757-NUM-OCCUP4-RLTNSP-APPLT1 = '20 ')                08070006
                 ADD F757-AMT-OCCUP4-INCOME       TO WS-TEMP-HH-INC     08080006
              END-IF                                                    08090006
              MOVE F757-NUM-OCCUP4-MARITAL-STATUS TO WS-TEMP-MSTATUS    08100006
              MOVE F757-NUM-OCCUP4-CITIZENSHIP  TO WS-TEMP-CITIZENSHIP  08110006
              MOVE F757-NUM-OCCUP4-RLTNSP-APPLT1 TO                     08120006
                                                   WS-TEMP-RELATIONSHIP 08130006
              MOVE F757-NUM-OCCUP4-RACE         TO WS-TEMP-RACE         08140006
              MOVE F757-NUM-OCCUP4-SEX          TO WS-TEMP-SEX          08150006
      *       MOVE SPACES                       TO WS-TEMP-LESSEE       08160006
              MOVE F757-NUM-CORE-FAMILY-OCC4    TO WS-TEMP-LESSEE       08170006
              MOVE F757-NUM-OCCUP4-EDN-LVL      TO WS-TEMP-EDN-LVL      08180006
              MOVE F757-NUM-OCCUP4-PHONE        TO WS-TEMP-PHONE        08190006
              MOVE F757-NUM-OCCUP4-HP-PAGER     TO WS-TEMP-HP-PAGER     08200006
              MOVE F757-NUM-OCCUP4-SPOUSE-UIN   TO WS-TEMP-NRIC-SPOUSE  08210006
                                                                        08220006
              PERFORM 4200-BP13K825-WRITE     THRU 4200-EXIT            08230006
           END-IF.                                                      08240006
                                                                        08250006
      *------------> OCCUPANT  5                                        08260006
           IF F757-NUM-OCCUP5-UIN NOT = SPACES                          08270006
              MOVE F757-NUM-OCCUP5-UIN            TO WS-TEMP-NRIC       08280006
              MOVE F757-NME-OCCUP5                TO WS-TEMP-NAME       08290006
              MOVE F757-DTE-OCCUP5-BIRTH          TO WS-TEMP-DTE-BIRTH  08300006
              MOVE F757-AMT-OCCUP5-INCOME         TO WS-TEMP-INCOME     08310006
              IF (F757-CDE-ALLOC-SCH NOT = 'FTS') OR                    08320006
                 (F757-CDE-ALLOC-SCH = 'FTS' AND                        08330006
                  F757-CDE-ELIG-SCH = 'NCS' AND                         08340006
                  F757-NUM-OCCUP5-RLTNSP-APPLT1 = '20 ')                08350006
                 ADD F757-AMT-OCCUP5-INCOME       TO WS-TEMP-HH-INC     08360006
              END-IF                                                    08370006
              MOVE F757-NUM-OCCUP5-MARITAL-STATUS TO WS-TEMP-MSTATUS    08380006
              MOVE F757-NUM-OCCUP5-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 08390006
              MOVE F757-NUM-OCCUP5-RLTNSP-APPLT1 TO                     08400006
                                                   WS-TEMP-RELATIONSHIP 08410006
              MOVE F757-NUM-OCCUP5-RACE         TO WS-TEMP-RACE         08420006
              MOVE F757-NUM-OCCUP5-SEX          TO WS-TEMP-SEX          08430006
      *       MOVE SPACES                       TO WS-TEMP-LESSEE       08440006
              MOVE F757-NUM-CORE-FAMILY-OCC5    TO WS-TEMP-LESSEE       08450006
              MOVE F757-NUM-OCCUP5-EDN-LVL      TO WS-TEMP-EDN-LVL      08460006
              MOVE F757-NUM-OCCUP5-PHONE        TO WS-TEMP-PHONE        08470006
              MOVE F757-NUM-OCCUP5-HP-PAGER     TO WS-TEMP-HP-PAGER     08480006
              MOVE F757-NUM-OCCUP5-SPOUSE-UIN   TO WS-TEMP-NRIC-SPOUSE  08490006
                                                                        08500006
              PERFORM 4200-BP13K825-WRITE     THRU 4200-EXIT            08510006
           END-IF.                                                      08520006
                                                                        08530006
      *------------> OCCUPANT  6                                        08540006
           IF F757-NUM-OCCUP6-UIN NOT = SPACES                          08550006
              MOVE F757-NUM-OCCUP6-UIN            TO WS-TEMP-NRIC       08560006
              MOVE F757-NME-OCCUP6                TO WS-TEMP-NAME       08570006
              MOVE F757-DTE-OCCUP6-BIRTH          TO WS-TEMP-DTE-BIRTH  08580006
              MOVE F757-AMT-OCCUP6-INCOME         TO WS-TEMP-INCOME     08581006
              IF (F757-CDE-ALLOC-SCH NOT = 'FTS') OR                    08582006
                 (F757-CDE-ALLOC-SCH = 'FTS' AND                        08583006
                  F757-CDE-ELIG-SCH = 'NCS' AND                         08584006
                  F757-NUM-OCCUP6-RLTNSP-APPLT1 = '20 ')                08585006
                 ADD F757-AMT-OCCUP6-INCOME       TO WS-TEMP-HH-INC     08586006
              END-IF                                                    08587006
              MOVE F757-NUM-OCCUP6-MARITAL-STATUS TO WS-TEMP-MSTATUS    08588006
              MOVE F757-NUM-OCCUP6-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 08589006
              MOVE F757-NUM-OCCUP6-RLTNSP-APPLT1 TO                     08589106
                                                   WS-TEMP-RELATIONSHIP 08589206
              MOVE F757-NUM-OCCUP6-RACE         TO WS-TEMP-RACE         08589306
              MOVE F757-NUM-OCCUP6-SEX          TO WS-TEMP-SEX          08589406
      *       MOVE SPACES                       TO WS-TEMP-LESSEE       08589506
              MOVE F757-NUM-CORE-FAMILY-OCC6    TO WS-TEMP-LESSEE       08589606
              MOVE F757-NUM-OCCUP6-EDN-LVL      TO WS-TEMP-EDN-LVL      08589706
              MOVE F757-NUM-OCCUP6-PHONE        TO WS-TEMP-PHONE        08589806
              MOVE F757-NUM-OCCUP6-HP-PAGER     TO WS-TEMP-HP-PAGER     08589906
              MOVE F757-NUM-OCCUP6-SPOUSE-UIN   TO WS-TEMP-NRIC-SPOUSE  08590006
                                                                        08590106
              PERFORM 4200-BP13K825-WRITE     THRU 4200-EXIT            08590206
           END-IF.                                                      08590306
                                                                        08590406
       4260-EXIT.                                                       08590506
           EXIT.                                                        08590606
                                                                        08590706
                                                                        08590806
      **********************************************************        08590906
       4270-CONVERT-SEX-RACE-MSTATUS.                                   08591006
      **********************************************************        08592006
           IF WS-TEMP-SEX = 'M'                                         08593006
              MOVE '1' TO K825-NUM-SEX                                  08594006
           ELSE                                                         08595006
           IF WS-TEMP-SEX = 'F'                                         08596006
              MOVE '2' TO K825-NUM-SEX                                  08597006
           END-IF.                                                      08598006
                                                                        08599006
           IF WS-TEMP-MSTATUS = 'S'                                     08600006
             MOVE '1' TO K825-NUM-MARITAL-STATUS                        08610006
           ELSE                                                         08620006
           IF WS-TEMP-MSTATUS = 'O'                                     08630006
             MOVE '1' TO K825-NUM-MARITAL-STATUS                        08640006
           ELSE                                                         08650006
           IF WS-TEMP-MSTATUS = 'M'                                     08660006
             MOVE '2' TO K825-NUM-MARITAL-STATUS                        08670006
           ELSE                                                         08680006
           IF WS-TEMP-MSTATUS = 'W'                                     08690006
             MOVE '3' TO K825-NUM-MARITAL-STATUS                        08700006
           ELSE                                                         08710006
           IF WS-TEMP-MSTATUS = 'D'                                     08720006
             MOVE '4' TO K825-NUM-MARITAL-STATUS                        08730006
           ELSE                                                         08740006
           IF WS-TEMP-MSTATUS = 'P'                                     08750006
             MOVE '5' TO K825-NUM-MARITAL-STATUS                        08760006
           END-IF.                                                      08770006
                                                                        08780006
           IF WS-TEMP-RACE = 'C'                                        08790006
              MOVE '0' TO K825-NUM-ETHNIC                               08800006
           ELSE                                                         08810006
           IF WS-TEMP-RACE = 'M'                                        08820006
              MOVE '5' TO K825-NUM-ETHNIC                               08830006
           ELSE                                                         08840006
           IF WS-TEMP-RACE = 'I'                                        08850006
              MOVE '6' TO K825-NUM-ETHNIC                               08860006
           ELSE                                                         08870006
           IF WS-TEMP-RACE = 'O'                                        08880006
              MOVE '7' TO K825-NUM-ETHNIC                               08890006
           END-IF.                                                      08900006
                                                                        08910006
       4270-EXIT.                                                       08920006
           EXIT.                                                        08930006
                                                                        08940006
                                                                        08950006
      **********************************************************        08960006
       4300-BP13K730-WRITE.                                             08970006
      **********************************************************        08980006
           MOVE SPACES                      TO BP13K730-REC.            08990006
           MOVE ZEROS                       TO K730-NUM-WAIT-TIME       09000006
                                               K730-NUM-JB-CNT          09010006
                                               K730-NUM-BALLOT-POSITION.09020006
                                                                        09030006
           MOVE F757-NUM-REGN               TO K730-NUM-REF             09040006
                                               K730-NUM-REGN.           09050006
                                                                        09060006
           MOVE F757-NUM-SALES-MODE            TO K730-NUM-ALLO-CAT.    09070006
                                                                        09080006
           MOVE 'NN'                        TO K730-NUM-REQUEST-REASON. 09090006
                                                                        09100006
           IF F757-NUM-APPLT1-UIN(1:1) = '-'                            09110006
              MOVE 'X'                      TO K730-NUM-NRIC1(1:1)      09120006
              MOVE F757-NUM-APPLT1-UIN(2:8) TO K730-NUM-NRIC1(2:8)      09130006
           ELSE                                                         09140006
              MOVE F757-NUM-APPLT1-UIN      TO K730-NUM-NRIC1.          09150006
                                                                        09160006
           IF F757-NUM-APPLT2-UIN NOT = SPACES                          09170006
              IF F757-NUM-APPLT2-UIN(1:1) = '-'                         09180006
                 MOVE 'X'                      TO K730-NUM-NRIC2(1:1)   09190006
                 MOVE F757-NUM-APPLT2-UIN(2:8) TO K730-NUM-NRIC2(2:8)   09200006
              ELSE                                                      09210006
                 MOVE F757-NUM-APPLT2-UIN      TO K730-NUM-NRIC2        09220006
              END-IF                                                    09230006
           ELSE                                                         09240006
              MOVE '##'                     TO K730-NUM-NRIC2(1:2)      09250006
              MOVE F757-NUM-APPLT1-UIN(3:7) TO K730-NUM-NRIC2(3:7)      09260006
           END-IF.                                                      09270006
                                                                        09280006
           IF F757-NUM-APPLT3-UIN NOT = SPACES                          09290006
              IF F757-NUM-APPLT3-UIN(1:1) = '-'                         09300006
                 MOVE 'X'                      TO K730-NUM-NRIC3(1:1)   09310006
                 MOVE F757-NUM-APPLT3-UIN(2:8) TO K730-NUM-NRIC3(2:8)   09320006
              ELSE                                                      09330006
                 MOVE F757-NUM-APPLT3-UIN      TO K730-NUM-NRIC3        09340006
              END-IF                                                    09350006
           ELSE                                                         09360006
              MOVE '##'                     TO K730-NUM-NRIC3(1:2)      09370006
              MOVE F757-NUM-APPLT1-UIN(3:7) TO K730-NUM-NRIC3(3:7)      09380006
           END-IF.                                                      09390006
                                                                        09400006
           IF F757-NUM-APPLT4-UIN NOT = SPACES                          09410006
              IF F757-NUM-APPLT4-UIN(1:1) = '-'                         09420006
                 MOVE 'X'                      TO K730-NUM-NRIC4(1:1)   09430006
                 MOVE F757-NUM-APPLT4-UIN(2:8) TO K730-NUM-NRIC4(2:8)   09440006
              ELSE                                                      09450006
                 MOVE F757-NUM-APPLT4-UIN      TO K730-NUM-NRIC4        09460006
              END-IF                                                    09470006
           ELSE                                                         09480006
              MOVE '##'                     TO K730-NUM-NRIC4(1:2)      09490006
              MOVE F757-NUM-APPLT1-UIN(3:7) TO K730-NUM-NRIC4(3:7)      09500006
           END-IF.                                                      09510006
                                                                        09520006
           IF (F757-NUM-DISPOSED-PTE-PRTY = 'Y') AND                    09530006
              (F757-NUM-OWN-PTE-PRTY = 'Y')                             09540006
              MOVE 'C'                      TO K730-NUM-PPO             09550006
           ELSE                                                         09560006
           IF F757-NUM-DISPOSED-PTE-PRTY = 'Y'                          09570006
              MOVE 'A'                      TO K730-NUM-PPO             09580006
           ELSE                                                         09590006
           IF F757-NUM-OWN-PTE-PRTY = 'Y'                               09600006
              MOVE 'B'                      TO K730-NUM-PPO             09610006
           ELSE                                                         09620006
              MOVE SPACES                   TO K730-NUM-PPO             09630006
           END-IF.                                                      09640006
                                                                        09650006
           MOVE F757-NUM-ESTATE-ZONE        TO K730-CDE-NT1.            09660006
           MOVE F757-NUM-CCA                TO K730-NUM-CCA.            09670006
                                                                        09680006
      *** MOVE SPACE TO NT2 FOR AUG 2003 BTO. CHOICE2 USED AS FLAT-TYPE 09690006
                                                                        09700006
           MOVE SPACES                      TO K730-CDE-NT2.            09710006
           MOVE 'N'                         TO K730-CDE-NT-WITH-LAND.   09720006
           MOVE SPACES                      TO K730-CDE-JB-PARENT       09730006
                                               K730-NUM-MCPS.           09740006
                                                                        09750006
      *** READ FLAT TYPE FOR AUG 2003 BTO FROM CHOICE2                  09760006
           MOVE F757-NUM-FLAT-TYPE          TO K730-CDE-FLAT-TYPE.      09770006
                                                                        09780006
           MOVE F757-CDE-ELIG-SCH           TO K730-CDE-ELIG-SCH.       09790006
           IF F757-NUM-SPEC-SCHEME NOT = SPACES AND LOW-VALUES AND      09800006
                                         'M' AND 'P' AND 'C'            09810006
              MOVE F757-NUM-SPEC-SCHEME     TO K730-CDE-ALLOC-SCH       09820006
           ELSE                                                         09830006
              MOVE F757-CDE-ALLOC-SCH       TO K730-CDE-ALLOC-SCH       09840006
           END-IF.                                                      09850006
                                                                        09860006
           IF F757-NUM-SPEC-SCHEME = 'TCP'                              09870006
              MOVE F757-NUM-SPEC-SCHEME     TO K730-CDE-ELIG-SCH        09880006
           END-IF.                                                      09890006
                                                                        09900006
           EVALUATE K730-CDE-ALLOC-SCH                                  09910006
           WHEN 'JB'                                                    09920006
             MOVE         '1' TO K730-CDE-JB                            09930006
           WHEN 'MT'                                                    09940006
           WHEN 'MTS'                                                   09950006
             MOVE         '4' TO K730-CDE-JB                            09960006
           WHEN 'TCP'                                                   09970006
             MOVE         '9' TO K730-CDE-JB                            09980006
           WHEN OTHER                                                   09990006
             MOVE         '0' TO K730-CDE-JB                            10000006
           END-EVALUATE.                                                10010006
                                                                        10020006
      *** COMMENTED OUT FOR DUXTON PLAIN BTO. FIELD USED FOR MCPS       10030006
      *** READ JB NRIC FOR AUG 2003 BTO FROM F757-NUM-PRSN1-UIN         10040006
      ***  IF K730-CDE-ALLOC-SCH = 'JB'                                 10050006
      ***     MOVE F757-NUM-PRSN1-UIN       TO K730-NUM-JB-NRIC.        10060006
                                                                        10070006
      **  READ MCPS RES NRIC1 FOR DUXTON PLAIN BTO FROM NUM-PRSN1-UIN   10080006
           IF (F757-NUM-SPEC-SCHEME = 'C' OR 'P') AND                   10090006
              (F757-NUM-PRSN1-UIN NOT = SPACES)                         10100006
              MOVE F757-NUM-PRSN1-UIN       TO K730-NUM-RES-NRIC1.      10110006
                                                                        10120006
      **  READ MCPS RES NRIC2 FOR DUXTON PLAIN BTO FROM NUM-PRSN2-UIN   10130006
           IF (F757-NUM-SPEC-SCHEME = 'C' OR 'P') AND                   10140006
              (F757-NUM-PRSN2-UIN NOT = SPACES)                         10150006
              MOVE F757-NUM-PRSN2-UIN       TO K730-NUM-RES-NRIC2.      10160006
                                                                        10170006
      **  MOVE MCPS CODE TO K730-NUM-MCPS FOR 'C', 'P' OR 'M'           10180006
           IF F757-NUM-SPEC-SCHEME = 'C' OR 'P' OR 'M'                  10190006
              MOVE F757-NUM-SPEC-SCHEME     TO K730-NUM-MCPS.           10200006
                                                                        10210006
      **  MOVE MCPS POSTAL CODE TO K730-NUM-MCPS-POSTAL                 10220006
           IF F757-NUM-MCPS-POSTAL = SPACES OR LOW-VALUES               10230006
              MOVE SPACES                   TO K730-NUM-MCPS-POSTAL     10240006
           ELSE                                                         10250006
              MOVE F757-NUM-MCPS-POSTAL     TO K730-NUM-MCPS-POSTAL.    10260006
                                                                        10270006
      **  MOVE MCPS POSTAL CODE TO K730-NUM-MCPS-POSTAL                 10280006
           IF F757-NUM-PORT-ELIG-TAG = SPACES OR LOW-VALUES             10290006
              MOVE SPACES                   TO K730-NUM-PORT-ELIG-TAG   10300006
           ELSE                                                         10310006
              MOVE F757-NUM-PORT-ELIG-TAG   TO K730-NUM-PORT-ELIG-TAG.  10320006
                                                                        10330006
      **  MOVE APPS REQ TO K730-NUM-APPS                                10340006
           IF  F757-NUM-APPS-SCHEME = SPACES OR LOW-VALUES OR 'N'       10350006
              MOVE SPACES                    TO K730-NUM-APPS           10360006
           ELSE                                                         10370006
              MOVE F757-NUM-APPS-SCHEME(1:1) TO K730-NUM-APPS.          10380006
                                                                        10390006
      **  MOVE MGPS REQ TO K730-NUM-MGPS                                10400006
           IF  F757-NUM-MGPS-APPL-TYPE = SPACES OR LOW-VALUES OR 'N'    10410006
              MOVE SPACES                    TO K730-NUM-MGPS           10420006
           ELSE                                                         10430006
              MOVE F757-NUM-MGPS-APPL-TYPE   TO K730-NUM-MGPS.          10440006
      *---------------------------                                      10450006
      * DECODE IPD SCHEME                                               10460006
      *---------------------------                                      10470006
           MOVE 'Y'                         TO WS-FOUND-SW.             10480006
           MOVE SPACES                      TO WS-DESC.                 10490006
           SET WS-IDP-PTR                   TO 1.                       10500006
                                                                        10510006
           SEARCH WS-IDP-SCH                                            10520006
             AT   END MOVE 'N'              TO   WS-FOUND-SW            10530006
                 WHEN WS-ALC-SCH-CODE (WS-IDP-PTR) = K730-CDE-ALLOC-SCH 10540006
                      MOVE WS-IDP-SCH-CODE (WS-IDP-PTR) TO WS-DESC      10550006
           END-SEARCH.                                                  10560006
                                                                        10570006
           IF  WS-FOUND-SW = 'N'                                        10580006
               MOVE 'PA '                  TO  WS-DESC                  10590006
           END-IF.                                                      10600006
                                                                        10610006
           MOVE WS-DESC                     TO K730-CDE-IDP-SCH.        10620006
                                                                        10630006
           MOVE F757-NUM-LOAN-REQ           TO K730-NUM-APPL-LOAN-REQ.  10640006
           MOVE F757-DTE-BALLOT             TO K730-DTE-BALLOT.         10650006
                                                                        10660006
      **   MOVE SPACES                      TO K730-NUM-RES-NRIC1       10670006
      **                                       K730-NUM-RES-NRIC2.      10680006
           MOVE F757-DTE-REQUESTED          TO K730-DTE-REQUEST.        10690006
           MOVE F757-TME-REQUESTED          TO K730-TME-SYSTEM.         10700006
           MOVE 'I'                         TO K730-NUM-APPLN-TYPE.     10710006
           IF F757-DTE-BK-APPT NOT = SPACES AND LOW-VALUES              10720006
              MOVE  F757-DTE-BK-APPT        TO K730-DTE-BK-APPT         10730006
              MOVE  F757-TME-BK-APPT        TO K730-TME-BK-APPT         10740006
              MOVE  F757-NUM-LAST-QUEUE     TO K730-NUM-NT-FT-QUEUE     10750006
              MOVE  'V'                     TO K730-CDE-REQUEST-STATUS  10760006
              MOVE  F757-NUM-ESTATE-ZONE    TO K730-CDE-SUCC-NT-ZONE    10770006
           ELSE                                                         10780006
              MOVE  SPACES                  TO K730-DTE-BK-APPT         10790006
                                               K730-TME-BK-APPT         10800006
                                               K730-NUM-NT-FT-QUEUE     10810006
                                               K730-CDE-REQUEST-STATUS  10820006
                                               K730-CDE-SUCC-NT-ZONE    10830006
           END-IF.                                                      10840006
                                                                        10850006
           MOVE F757-NUM-REGN-PAIRED        TO K730-NUM-JB-REGN.        10860006
                                                                        10870006
           IF F757-NUM-NRIC-AST NOT = SPACES AND LOW-VALUES             10880006
              MOVE 'R'                      TO K730-NUM-AST             10890006
           ELSE                                                         10900006
              MOVE SPACES                   TO K730-NUM-AST             10910006
           END-IF.                                                      10920006
           MOVE 'N'                         TO K730-NUM-FT2T.           10930010
           MOVE WS-TEMP-HH-INC              TO K730-AMT-HSE-INCOME.     10940006
           IF F757-NUM-FLAT-TYPE = '2F' OR 'RF' OR '1F'                 10960006
              MOVE F757-NUM-ELDERLY         TO K730-NUM-ELDERLY         10960112
              IF F757-NUM-NTIMER = SPACES OR LOW-VALUES                 10961010
                 MOVE 'N'                   TO K730-NUM-NTIMER          10962010
              ELSE                                                      10963010
                 MOVE F757-NUM-NTIMER       TO K730-NUM-NTIMER          10964010
              END-IF                                                    10965010
           END-IF.                                                      10980006
                                                                        10990006
9280       MOVE F757-NUM-HOUSEHOLD         TO  K730-CDE-HOUSEHOLD.      10991008
           MOVE F757-NUM-FT2T              TO  K730-NUM-FT2T.           10991108
           MOVE F757-NUM-ORIG-LOAN-TAG     TO  K730-NUM-ORIG-LOAN-TAG.  10991308
KIV   *    MOVE F757-NUM-5YR-OCCUPN        TO  K730-NUM-5YR-OCCUPN.     10992111
      *    MOVE F757-NUM-MTH-RESIDE        TO  K730-NUM-MTH-RESIDE.     10993008
      *    MOVE F757-NUM-MTH-SUBLET        TO  K730-NUM-MTH-SUBLET.     10994008
      *    MOVE F757-NUM-PARENT-CHILD      TO  K730-CDE-PARENT-CHILD.   10995008
                                                                        10996007
           MOVE WS-SYSTEM-DATE              TO K730-DTE-UPDATE.         11000006
           MOVE 'P13C9CC'                   TO K730-NUM-USER-ID.        11010006
                                                                        11020006
           WRITE BP13K730-REC.                                          11030006
           ADD   +1                         TO WS-K730-WRITE-CTR.       11040006
                                                                        11050006
       4300-EXIT.                                                       11060006
           EXIT.                                                        11070006
                                                                        11080006
                                                                        11090006
      **********************************************************        11100006
       4400-BP13K830-WRITE.                                             11110006
      **********************************************************        11120006
           MOVE SPACES                      TO BP13K830-REC.            11130006
                                                                        11140006
           MOVE F757-NUM-REGN               TO K830-KEY-FLD.            11150006
           MOVE F757-NUM-REGN               TO K830-NUM-REGN.           11160006
                                                                        11170006
           MOVE F757-NUM-MAIN-BLK           TO K830-NUM-MAIL-MAIN-BLK.  11180006
           MOVE F757-NUM-SUB-BLK            TO K830-NUM-MAIL-SUB-BLK.   11190006
                                                                        11200006
           IF F757-NUM-SUB-BLK NOT = SPACES AND LOW-VALUES              11210006
              MOVE '-'                      TO K830-NUM-MAIL-BLK-DASH   11220006
           ELSE                                                         11230006
              MOVE SPACES                   TO K830-NUM-MAIL-BLK-DASH   11240006
           END-IF.                                                      11250006
                                                                        11260006
           MOVE '#'                         TO K830-NUM-MAIL-LVL-CHAR.  11270006
                                                                        11280006
           IF (F757-NUM-LEVEL(1:1) = SPACES OR LOW-VALUES) AND          11290006
              (F757-NUM-LEVEL(2:1) NOT = SPACES AND LOW-VALUES)         11300006
              STRING '0', F757-NUM-LEVEL(2:1)                           11310006
                 DELIMITED BY SIZE                                      11320006
                 INTO  K830-NUM-MAIL-LVL-NUM                            11330006
              END-STRING                                                11340006
           ELSE                                                         11350006
             IF (F757-NUM-LEVEL(2:1) = SPACES OR LOW-VALUES) AND        11360006
                (F757-NUM-LEVEL(1:1) NOT = SPACES AND LOW-VALUES)       11370006
                STRING '0', F757-NUM-LEVEL(1:1)                         11380006
                   DELIMITED BY SIZE                                    11390006
                   INTO  K830-NUM-MAIL-LVL-NUM                          11400006
                END-STRING                                              11410006
             ELSE                                                       11420006
                MOVE F757-NUM-LEVEL   TO K830-NUM-MAIL-LVL-NUM          11430006
             END-IF                                                     11440006
           END-IF.                                                      11450006
                                                                        11460006
           MOVE '-'                         TO K830-NUM-MAIL-LVL-DASH.  11470006
           MOVE F757-NUM-MAIN-UNIT          TO K830-NUM-MAIL-HSEMAIN.   11480006
           MOVE F757-NUM-SUB-UNIT           TO K830-NUM-MAIL-HSESUB.    11490006
                                                                        11500006
           MOVE F757-NUM-CORRESP-STREET     TO K830-NME-MAIL-STR-BLDG.  11510006
           MOVE F757-CDE-CORRESP-POST       TO K830-NUM-MAIL-POSTAL.    11520006
                                                                        11530006
           IF F757-NUM-MAIN-BLK  NOT = SPACES AND                       11540006
              F757-NUM-MAIN-UNIT NOT = SPACES AND                       11550006
              F757-NUM-CORRESP-STREET NOT = SPACES                      11560006
              MOVE 'BLK'                    TO K830-NUM-MAIL-BLK-HDR    11570006
              MOVE 'H'                      TO K830-NUM-MAIL-ADDR-TYPE  11580006
           ELSE                                                         11590006
              IF F757-NUM-MAIN-BLK  = SPACES AND                        11600006
                 F757-NUM-MAIN-UNIT = SPACES AND                        11610006
                 F757-NUM-CORRESP-STREET NOT = SPACES                   11620006
                 MOVE 'N'                   TO K830-NUM-MAIL-ADDR-TYPE  11630006
              ELSE                                                      11640006
                 MOVE SPACES                TO K830-NUM-MAIL-ADDR-TYPE  11650006
              END-IF                                                    11660006
              MOVE SPACES                   TO K830-NUM-MAIL-LVL-CHAR   11670006
                                               K830-NUM-MAIL-LVL-DASH   11680006
           END-IF.                                                      11690006
                                                                        11700006
           IF F757-CDE-CORRESP-POST = SPACES                            11710006
              MOVE SPACES TO K830-NUM-MAIL-ADDR                         11720006
           END-IF.                                                      11730006
                                                                        11740006
           MOVE WS-CURRENT-DATE             TO K830-DTE-UPDATE.         11750006
           MOVE 'P13C9CC'                   TO K830-NUM-USERID.         11760006
                                                                        11770006
           WRITE BP13K830-REC.                                          11780006
                                                                        11790006
           ADD   +1                         TO WS-K830-WRITE-CTR.       11800006
                                                                        11810006
       4400-EXIT.                                                       11820006
           EXIT.                                                        11830006
                                                                        11840006
                                                                        11850006
      **********************************************************        11860006
       4500-BP13K857-WRITE.                                             11870006
      **********************************************************        11880006
           MOVE SPACES                      TO BP13K857-REC.            11890006
                                                                        11900006
           MOVE F757-NUM-REGN               TO K857-KEY-FLD             11910006
                                               K857-NUM-REF.            11920006
                                                                        11930006
           MOVE F757-NUM-APPLT1-UIN         TO K857-NUM-NRIC1.          11940006
           MOVE F757-NUM-APPLT1-EMAIL       TO K857-NUM-EMAIL.          11950006
           MOVE 'P13C9CC'                   TO K857-NUM-USERID.         11960006
           MOVE WS-CURRENT-DATE             TO K857-DTE-UPDATE.         11970006
                                                                        11980006
           WRITE BP13K857-REC.                                          11990006
                                                                        12000006
           ADD   +1                      TO WS-K857-WRITE-CTR.          12010006
                                                                        12020006
       4500-EXIT.                                                       12030006
           EXIT.                                                        12040006
                                                                        12050006
                                                                        12060006
      **********************************************************        12070006
       7000-PRINT-ERROR.                                                12080006
      **********************************************************        12090006
           IF WS-L9CC-LINECTR > 24                                      12100006
              PERFORM 7100-PRINT-HEADING THRU 7100-EXIT                 12110006
           END-IF.                                                      12120006
                                                                        12130006
           ADD   +1                      TO   WS-L9CC-S-NO.             12140006
           MOVE WS-L9CC-S-NO             TO   L9CC-S-NO.                12150006
                                                                        12160006
           MOVE F757-NUM-REGN            TO   L9CC-REF-NO.              12170006
           MOVE F757-NUM-APPLT1-UIN      TO   L9CC-NRIC.                12180006
                                                                        12190006
           IF WS-TEMP-NRIC(1:1) = '-'                                   12200006
              MOVE 'X'                  TO L9CC-ERROR-NRIC(1:1)         12210006
              MOVE WS-TEMP-NRIC(2:8)    TO L9CC-ERROR-NRIC(2:8)         12220006
           ELSE                                                         12230006
              MOVE WS-TEMP-NRIC         TO L9CC-ERROR-NRIC.             12240006
                                                                        12250006
           WRITE BP13L9CC-REC          FROM   L9CC-DETAIL-01            12260006
                                      AFTER   ADVANCING 2 LINES.        12270006
                                                                        12280006
           ADD  +1                       TO   WS-L9CC-LINECTR.          12290006
                                                                        12300006
       7000-EXIT.                                                       12310006
           EXIT.                                                        12320006
                                                                        12330006
                                                                        12340006
      **********************************************************        12350006
       7100-PRINT-HEADING.                                              12360006
      **********************************************************        12370006
           ADD   +1               TO WS-L9CC-PAGECTR.                   12380006
           MOVE WS-L9CC-PAGECTR   TO L9CC-PAGE-NO.                      12390006
                                                                        12400006
           WRITE BP13L9CC-REC   FROM L9CC-HEADING-01                    12410006
                               AFTER ADVANCING PAGE.                    12420006
                                                                        12430006
           WRITE BP13L9CC-REC   FROM L9CC-HEADING-02                    12440006
                               AFTER ADVANCING 1 LINE.                  12450006
                                                                        12460006
           WRITE BP13L9CC-REC   FROM L9CC-HEADING-03                    12470006
                               AFTER ADVANCING 1 LINE.                  12480006
                                                                        12490006
           WRITE BP13L9CC-REC   FROM L9CC-HEADING-04                    12500006
                               AFTER ADVANCING 2 LINES.                 12510006
                                                                        12520006
           WRITE BP13L9CC-REC   FROM L9CC-HEADING-05                    12530006
                               AFTER ADVANCING 1 LINES.                 12540006
                                                                        12550006
           MOVE ZEROS             TO WS-L9CC-LINECTR.                   12560006
                                                                        12570006
       7100-EXIT.                                                       12580006
           EXIT.                                                        12590006
                                                                        12600006
                                                                        12610006
      **********************************************************        12620006
       8000-PRINT-REPORT.                                               12630006
      **********************************************************        12640006
      *--------------> PRINT FILE STATISTICS ON NEW PAGE                12650006
                                                                        12660006
           ADD   +1               TO WS-L9CC-PAGECTR.                   12670006
           MOVE WS-L9CC-PAGECTR   TO L9CC-PAGE-NO.                      12680006
                                                                        12690006
           WRITE BP13L9CC-REC   FROM L9CC-HEADING-01                    12700006
                               AFTER ADVANCING PAGE.                    12710006
                                                                        12720006
           WRITE BP13L9CC-REC   FROM L9CC-HEADING-02                    12730006
                               AFTER ADVANCING 1 LINE.                  12740006
                                                                        12750006
           MOVE SPACES                      TO   L9CC-TOTALS.           12760006
                                                                        12770006
      *--------------> BP13F757 STATISTICS                              12780006
                                                                        12790006
           MOVE  K-F757-RECORDS-READ        TO   L9CC-TOTAL-DESC.       12800006
           MOVE  WS-F757-READ-CTR           TO   L9CC-TOTAL-VALUE.      12810006
           WRITE BP13L9CC-REC             FROM   L9CC-TOTALS            12820006
                                         AFTER   ADVANCING 2 LINES.     12830006
                                                                        12840006
      *--------------> BE01F500 STATISTICS                              12850006
                                                                        12860006
           MOVE  K-F500-RECORDS-WRITE       TO   L9CC-TOTAL-DESC.       12870006
           MOVE  WS-F500-WRITE-CTR          TO   L9CC-TOTAL-VALUE.      12880006
           WRITE BP13L9CC-REC             FROM   L9CC-TOTALS            12890006
                                         AFTER   ADVANCING 2 LINES.     12900006
                                                                        12910006
      *--------------> BP13K825 STATISTICS                              12920006
                                                                        12930006
           MOVE  K-K825-RECORDS-WRITE       TO   L9CC-TOTAL-DESC.       12940006
           MOVE  WS-K825-WRITE-CTR          TO   L9CC-TOTAL-VALUE.      12950006
           WRITE BP13L9CC-REC             FROM   L9CC-TOTALS            12960006
                                         AFTER   ADVANCING 2 LINES.     12970006
                                                                        12980006
           MOVE  K-K825-UNSUCC-WRITE        TO   L9CC-TOTAL-DESC.       12990006
           MOVE  WS-K825-ERROR-CTR          TO   L9CC-TOTAL-VALUE.      13000006
           WRITE BP13L9CC-REC             FROM   L9CC-TOTALS            13010006
                                         AFTER   ADVANCING 1 LINES.     13020006
                                                                        13030006
      *--------------> BP13K830 STATISTICS                              13040006
                                                                        13050006
           MOVE  K-K830-RECORDS-WRITE       TO   L9CC-TOTAL-DESC.       13060006
           MOVE  WS-K830-WRITE-CTR          TO   L9CC-TOTAL-VALUE.      13070006
           WRITE BP13L9CC-REC             FROM   L9CC-TOTALS            13080006
                                         AFTER   ADVANCING 2 LINES.     13090006
                                                                        13100006
           MOVE  K-K830-UNSUCC-WRITE        TO   L9CC-TOTAL-DESC.       13110006
           MOVE  WS-K830-ERROR-CTR          TO   L9CC-TOTAL-VALUE.      13120006
           WRITE BP13L9CC-REC             FROM   L9CC-TOTALS            13130006
                                         AFTER   ADVANCING 1 LINES.     13140006
                                                                        13150006
      *--------------> BP13K730 STATISTICS                              13160006
                                                                        13170006
           MOVE  K-K730-RECORDS-WRITE       TO   L9CC-TOTAL-DESC.       13180006
           MOVE  WS-K730-WRITE-CTR          TO   L9CC-TOTAL-VALUE.      13190006
           WRITE BP13L9CC-REC             FROM   L9CC-TOTALS            13200006
                                         AFTER   ADVANCING 2 LINES.     13210006
                                                                        13220006
           MOVE  K-K730-UNSUCC-WRITE        TO   L9CC-TOTAL-DESC.       13230006
           MOVE  WS-K730-ERROR-CTR          TO   L9CC-TOTAL-VALUE.      13240006
           WRITE BP13L9CC-REC             FROM   L9CC-TOTALS            13250006
                                         AFTER   ADVANCING 1 LINES.     13260006
                                                                        13270006
      *--------------> BP13K857 STATISTICS                              13280006
                                                                        13290006
           MOVE  K-K857-RECORDS-WRITE       TO   L9CC-TOTAL-DESC.       13300006
           MOVE  WS-K857-WRITE-CTR          TO   L9CC-TOTAL-VALUE.      13310006
           WRITE BP13L9CC-REC             FROM   L9CC-TOTALS            13320006
                                         AFTER   ADVANCING 2 LINES.     13330006
                                                                        13340006
       8000-EXIT.                                                       13350006
           EXIT.                                                        13360006
                                                                        13370006
                                                                        13380006
      **********************************************************        13390006
       9000-CLOSE-FILES.                                                13400006
      **********************************************************        13410006
           CLOSE BP13F757                                               13420006
                 BP13F730                                               13430006
                 BP13F825                                               13440006
                 BP13F830                                               13450006
                 BP13F857                                               13460006
                 BE01F500                                               13470006
                 BP13L9CC.                                              13480006
                                                                        13490006
           STOP RUN.                                                    13500006
                                                                        13510006
       9000-EXIT.                                                       13520006
           EXIT.                                                        13530006
