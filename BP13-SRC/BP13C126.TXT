      ***************************                                               
       IDENTIFICATION DIVISION.                                                 
      ***************************                                               
                                                                                
       PROGRAM-ID.    BP13C126.                                                 
       AUTHOR.        TAN M K.                                                  
       DATE-WRITTEN.  06/10/89.                                                 
       DATE-COMPILED.                                                           
      **********************************************************                
      *                                                        *                
      *    SYSTEM NAME : SYSTEM OF COMMITMENT                  *                
      *                                                        *                
      *    SYSTEM ID : BP13                                    *                
      *                                                        *                
      *    OBJECTIVE :                                         *                
      *      1.  THIS IS A PROGRAM TO PRINT A LIST OF          *                
      *          SOC - AUDIT TRAIL FOR SA DEPENDING            *                
      *          ON PAYMENT TYPES SOC, CD, BK, IDP, LSE        *                
      *          AND CON                                       *                
      *                                                        *                
      *    INPUT FILES:                                        *                
      *      1.  BP13F120 (CASH TRANS FILE FOR VALIDATED       *                
      *          CASES FROM FIRST SYSTEM)                      *                
      *      2.  BP13K800 (APPLICATION MASTER)                 *                
      *      3.  BP13K893 (SOC APPLICATION HISTORY)            *                
      *                                                        *                
      *    LISTING:                                            *                
      *      1.  CONTROL LISTING    (BP13L126)                 *                
      *      2.  MISMATCHED LISTING (BP13L26A)                 *                
      *                                                        *                
      * CHG-NO   BY  ON        DESCRIPTION                     *                
      * -------  --- --------  --------------------------      *                
      * SOC-PH8  JEP 14/07/93  USE BP13K800 FILE INSTEAD       *                
      *                        OF  P10K020  FILE               *                
      * C930829  LJL 26/01/94  TO PRINT THE GST AMT FOR        *                
      *                        CONVEYANCING FEES.              *                
      * BP130015 SSS 13/09/95  CONVERT TO LASER PRINT REPORT   *                
      *                        CHG HEADING TO ROW 1 AFTER PAGE *                
      * BP130103 EG1 13/03/96  TO CATER FOR SUB-TRANSFER.      *                
      * BP130144 EVM 08/07/96  TO PRINT SUB-TOTAL AND GRAND-TO-*                
      *                        TAL OF NO. OF CASES AND AMOUNT  *                
      *                        RECEIPT FOR EVERY CHANGE IN     *                
      *                        TRANS DATE.                     *                
      * BP130144 EVM 19/07/96  TO PRINT SUB-TOTAL FOR EVERY    *                
      *                        CHANGE IN PAYMENT-TYPE.         *                
      * BP130275 LJL 15/05/97  TO CHANGE SOC AS DR TO BE       *                
      *                        CONISTENT WITH GL EVEN THOUGH   *                
      *                        THE SIGN IS POSITIVE.           *                
      * BP130320 LJL 25/06/97  TO CATER FOR REGISTRATION       *                
      *                        DEPOSIT.                        *                
      * BP130418 RHB 25/08/98  TO CATER FOR Y2000.             *                
      * BP131016 ED  21/05/01  TO CATER FOR STUD. APTS.        *                
      * BP130998 ED  21/05/01  CD* TO SHOW CR CD-AMT, SUB-TOT  *                
      * BP131016 ED  15/06/01  INCREASE COUNT TO 17 FOR GL CODE*                
      * BP131039 SN  15/07/01  SA FL TYPE '1A' '2A' HDG        *                
      * BP133566 ESA120/05/09  CATER FOR NEW SA ACTIVITY CODE  *                
      * BP133566 ESA101/06/09  READ BP13K893 WHEN NOT FOUND IN *                
      *                        BP13K800                        *                
      * BP133850 JB8 03/05/10  TO CATER FOR SOC                *                
      * BP134034 ESA111/02/11  TO CATER FOR NEW ERL GL ACCOUNT *                
      * BP136098 KSJ 02/03/16  TO CATER FOR 2 ROOM FLEXI       *                
      * BP136161 KSJ 10/05/16  TO INCLUDE LEASE TENURE FOR 2F  *                
      * BP136224 KSJ 02/06/16  TO INCLUDE LEASE BUY BACK CASES *                
      *                        IN SA TOTALS                    *                
      * BP136803 FNP 05/06/17  CATER FOR TMP PAYMENT TYPE      *                
      * BP136869 FNP 05/07/17  CHANGE PP-SCHED FR 45 TO 60     *                
      * BP137181 FNP 29/06/18  CATER FOR MLF PAYMENT TYPE      *                
      * BP138663 FNP 21/09/21  CATER FOR 1F FLAT TYPE          *                
      * BP138663 FP6 04/10/21  INCLUDE 1F IN 2F REPORT         *                
      **********************************************************                
                                                                                
      ************************                                                  
       ENVIRONMENT DIVISION.                                                    
      ************************                                                  
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F120  ASSIGN       TO BP13F120.                           
           SELECT BP13K800  ASSIGN       TO BP13K800                    00470000
                            ORGANIZATION IS INDEXED                     00490000
                            ACCESS MODE  IS RANDOM                      00480000
                            RECORD KEY   IS K800-NUM-REGN               00500000
                            FILE STATUS  IS K800-STATUS.                00510000
           SELECT BP13K893  ASSIGN       TO BP13K893                    00470000
                            ORGANIZATION IS INDEXED                     00490000
                            ACCESS MODE  IS DYNAMIC                     00480000
                            RECORD KEY   IS K893-KEY-FLD                00500000
                            FILE STATUS  IS K893-STATUS.                00510000
           SELECT SY02F001  ASSIGN       TO SY02F001.                           
           SELECT BP13L126  ASSIGN       TO BP13L126.                           
           SELECT BP13L26A  ASSIGN       TO BP13L26A.                           
                                                                                
                                                                                
      *****************                                                         
       DATA DIVISION.                                                           
      *****************                                                         
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD   BP13F120                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 150 CHARACTERS.                                     
       COPY BP13F120.                                                           
                                                                        00630000
       FD   BP13K800                                                    00640000
            RECORD CONTAINS 2000 CHARACTERS.                            00660000
       COPY BP13K800.                                                   00680000
                                                                                
       FD   BP13K893                                                    00640000
            RECORD CONTAINS 2050 CHARACTERS.                            00660000
       COPY BP13K893.                                                   00680000
                                                                                
       FD  BP13L126                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132 CHARACTERS.                                      
       01  L126-PRINT-REC              PIC X(132).                              
                                                                                
       FD  BP13L26A                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132 CHARACTERS.                                      
       01  L26A-PRINT-REC              PIC X(132).                              
                                                                                
       COPY SY02F001.                                                           
                                                                                
      *                                                                         
       WORKING-STORAGE SECTION.                                                 
       01  WS1-FILE-ACCESS-STATUS.                                              
           05  K800-STATUS             PIC 9(2)     VALUE ZEROS.                
           05  K893-STATUS             PIC 9(2)     VALUE ZEROS.                
      *                                                                         
       01  WS2-COUNTERS.                                                        
           05  WS2-CNT-F120-READ       PIC 9(5)     VALUE ZEROS.                
           05  WS2-CNT-K800-READ       PIC 9(5)     VALUE ZEROS.                
           05  WS2-CNT-PRINT-L126      PIC 9(5)     VALUE ZEROS.                
           05  WS2-CNT-PRINT-L26A      PIC 9(5)     VALUE ZEROS.                
           05  WS2-CNT-LINE-ON-L126    PIC 9(2)     VALUE 66.                   
           05  WS2-CNT-LINE-ON-L26A    PIC 9(2)     VALUE 66.                   
           05  WS2-CNT-L126-PAGE       PIC 9(5)     VALUE ZEROS.                
           05  WS2-CNT-L26A-PAGE       PIC 9(5)     VALUE ZEROS.                
      *                                                                         
       01  WS3-ACCUM-FIELDS.                                                    
           05  WS3-SUBTOT-DRCR-AMT     PIC S9(9)V99 COMP-3 VALUE +0.            
           05  WS3-SUBTOT-DR-AMT       PIC S9(9)V99 COMP-3 VALUE +0.            
           05  WS3-SUBTOT-CR-AMT       PIC S9(9)V99 COMP-3 VALUE +0.            
           05  WS3-TOT-DRCR-AMT        PIC S9(9)V99 COMP-3 VALUE +0.            
           05  WS3-TOT-CR-AMT          PIC S9(9)V99 COMP-3 VALUE +0.            
           05  WS3-TOT-DR-AMT          PIC S9(9)V99 COMP-3 VALUE +0.            
           05  WS-SUB-AMT              PIC S9(9)V99 COMP-3 VALUE +0.            
           05  WS-SUB-PTYPE-AMT        PIC S9(9)V99 COMP-3 VALUE +0.            
           05  WS-GRD-AMT              PIC S9(9)V99 COMP-3 VALUE +0.            
           05  WS-SUB-CASENO           PIC 9(3)     VALUE ZEROES.               
           05  WS-GRD-CASENO           PIC 9(3)     VALUE ZEROES.               
      *                                                                         
       01  WS4-SWITCHES-N-RANGE.                                                
           05  WS4-EOF-IND             PIC X(01)    VALUE SPACES.               
               88  WS4-EOF                          VALUE 'Y'.                  
           05  WS4-1ST-TIME-IND        PIC X(01)    VALUE 'Y'.                  
               88  WS4-1ST-TIME                     VALUE 'Y'.                  
           05  WS4-ONLY-SOC-IND        PIC X(01)    VALUE SPACES.               
               88  WS4-ONLY-SOC                     VALUE 'Y'.                  
           05  WS4-SUBTOT-PRTED-IND    PIC X(01)    VALUE SPACES.               
               88  WS4-SUBTOT-PRTED                 VALUE 'Y'.                  
           05  SY02F001-EOF            PIC X(01)    VALUE 'N'.                  
      *                                                                         
       01  WS5-DATES-VARIABLES.                                                 
           05  WS-DATE                 PIC X(08)    VALUE SPACES.               
           05  WS5-CURRENT-DATE.                                                
               10  WS5-CUR-CC          PIC 99.                                  
               10  WS5-CUR-YY          PIC 99.                                  
               10  WS5-CUR-MM          PIC 99.                                  
               10  WS5-CUR-DD          PIC 99.                                  
           05  WS5-PRT-DATE.                                                    
               10  WS5-PRT-DD          PIC XX.                                  
               10  FILLER              PIC X        VALUE '/'.                  
               10  WS5-PRT-MM          PIC XX.                                  
               10  FILLER              PIC X        VALUE '/'.                  
               10  WS5-PRT-CC          PIC XX.                                  
               10  WS5-PRT-YY          PIC XX.                                  
           05  WS5-TRAN-DATE.                                                   
               10  WS5-TRAN-CCYY.                                               
                   15  WS5-TRAN-CC     PIC X(2).                                
                   15  WS5-TRAN-YY     PIC X(2).                                
               10  WS5-TRAN-MM         PIC X(2).                                
               10  WS5-TRAN-DD         PIC X(2).                                
           05  WS5-CCYY                PIC X(4).                                
           05  WS5-CCYY-NUM  REDEFINES   WS5-CCYY PIC 9(4).                     
                                                                                
       01  WS6-DEFAULT-VALUES.                                                  
           05  WS6-MAX-LINES           PIC 9(2)     VALUE  60.                  
           05  WS6-SR-SLASH            PIC X(1)     VALUE  '/'.                 
           05  WS6-L126-RPT-ID         PIC X(14)    VALUE 'BP13L126'.           
           05  WS6-L26A-RPT-ID         PIC X(14)    VALUE 'BP13L26A'.           
                                                                                
       01  WS7-SCHEME-ACCT.                                                     
           05  WS7-SCH-ACC.                                                     
               10  WS7-SCH-1-4         PIC X(4)     VALUE SPACES.               
               10  WS7-SCH-5-8         PIC X(4)     VALUE SPACES.               
               10  WS7-SCH-9-9         PIC X(1)     VALUE SPACES.               
               10  WS7-SCH-10-11       PIC X(2)     VALUE SPACES.               
                                                                                
           05  WS7-SCH-ACC-2.                                                   
               10  WS7-SCH-1-4         PIC X(4)     VALUE SPACES.               
               10  FILLER              PIC X(01)    VALUE '-'.                  
               10  WS7-SCH-5-8         PIC X(4)     VALUE SPACES.               
               10  FILLER              PIC X(01)    VALUE '-'.                  
               10  WS7-SCH-9-9         PIC X(1)     VALUE SPACES.               
               10  FILLER              PIC X(01)    VALUE '-'.                  
               10  WS7-SCH-10-11       PIC X(2)     VALUE SPACES.               
                                                                                
                                                                                
      *------------------------------------------------*                        
      *  GL ACCOUNT CONVERSION BASED ON PAYMENT TYPE   *                        
      *------------------------------------------------*                        
       01  WS8-GL-ACC-DESCRIPTION.                                              
           05  FILLER                  PIC X(21)    VALUE                       
              'SOC0 00 00 00 10 4518'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'CD 0 00 00 00 10 4517'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'CD*0 00 00 00 10 4517'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'BK 0 00 00 00 10 4516'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'IDP0 00 00 00 10 2830'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'LSE0 00 00 00 10 4250'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'CON9 00 00 00 40 5424'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'CST0 00 00 00 40 3753'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'SUS0 00 00 00 10 4009'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'RDE0 00 00 00 10 4515'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'PRM9 00 29 ZZ 40 698X'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'SA 0 00 00 00 40 4033'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'LRF0 00 00 00 10 4250'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'SRV9 00 BB 00 40 5422'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'SST0 00 00 00 40 3753'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'ADV0 00 00 00 40 4353'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'LVL9 00 29 ZZ 40 6XXX'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'VRL0 40 76 00 57 4041'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'FSH0 41 92 00 57 4045'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'TMP0 00 00 00 54 0810'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'MLF0 00 00 00 54 0810'.                                          
       01  WS8-GL-ACC-TABLE  REDEFINES WS8-GL-ACC-DESCRIPTION.                  
           05  WS8-GL-ACC       OCCURS 21 TIMES INDEXED BY WS8-IDX.             
               10  WS8-GL-PAYT         PIC X(3).                                
               10  WS8-GL-ACC-DESC     PIC X(18).                               
                                                                                
       01  WS8-GL-ACC-DESCRIPTION2.                                             
           05  FILLER                  PIC X(21)    VALUE                       
              'CON9 00 00 00 57 5424'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'CST0 00 00 00 57 3753'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'SRV9 00 BB 00 57 5422'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'SST0 00 00 00 57 3753'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'ADV0 00 00 00 57 4353'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'SA 0 00 00 00 57 4033'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'VRL0 40 76 00 57 4041'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'FSH0 41 92 00 57 4045'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'TMP0 00 00 00 54 0810'.                                          
           05  FILLER                  PIC X(21)    VALUE                       
              'MLF0 00 00 00 54 0810'.                                          
       01  WS8-GL-ACC-TABLE2 REDEFINES WS8-GL-ACC-DESCRIPTION2.                 
           05  WS8-GL-ACC2      OCCURS 10 TIMES INDEXED BY WS8-IDX2.            
               10  WS8-GL-PAYT2        PIC X(3).                                
               10  WS8-GL-ACC-DESC2    PIC X(18).                               
                                                                                
      *------------------------------------------------*                        
      * TRANSACTION TO FINANCIAL DATE CONVERSION TABLE *                        
      *------------------------------------------------*                        
       01  WS9-TRAN-FIN-MTH-CONV.                                               
           05  FILLER                  PIC X(04)    VALUE '0401'.               
           05  FILLER                  PIC X(04)    VALUE '0502'.               
           05  FILLER                  PIC X(04)    VALUE '0603'.               
           05  FILLER                  PIC X(04)    VALUE '0704'.               
           05  FILLER                  PIC X(04)    VALUE '0805'.               
           05  FILLER                  PIC X(04)    VALUE '0906'.               
           05  FILLER                  PIC X(04)    VALUE '1007'.               
           05  FILLER                  PIC X(04)    VALUE '1108'.               
           05  FILLER                  PIC X(04)    VALUE '1209'.               
           05  FILLER                  PIC X(04)    VALUE '0110'.               
           05  FILLER                  PIC X(04)    VALUE '0211'.               
           05  FILLER                  PIC X(04)    VALUE '0312'.               
       01  WS9-TF-MTH-CONV-TABLE REDEFINES WS9-TRAN-FIN-MTH-CONV.               
           05  WS9-TF-MTH       OCCURS 12 TIMES INDEXED BY WS9-IDX.             
               10  WS9-TRAN-MM         PIC X(2).                                
               10  WS9-FIN-MM          PIC X(2).                                
                                                                                
       01  WS10-SALES-REF.                                                      
           05  WS10-SREF-ZONE          PIC X(04)    VALUE SPACES.               
           05  FILLER                  PIC X(01)    VALUE '/'.                  
           05  WS10-SREF-CUR-REG       PIC X(08)    VALUE SPACES.               
                                                                                
       01  WS11-JOURNAL-NO.                                                     
           05  FILLER                  PIC X(02)    VALUE 'SO'.                 
           05  WS11-JOURN-MM           PIC X(02)    VALUE SPACES.               
           05  WS11-JOURN-CCYY         PIC X(04)    VALUE SPACES.               
                                                                                
       01  WS12-SOC-AMT.                                                        
           05  WS12-SOC-CR-AMT         PIC S9(9)V99 COMP-3 VALUE +0.            
           05  WS12-SOC-DR-AMT         PIC S9(9)V99 COMP-3 VALUE +0.            
                                                                                
       01  WS13-FLAG-INDICATOR.                                                 
           05  WS-K893-EOF             PIC X(01)    VALUE 'N'.                  
           05  WS-K800-FND             PIC X(01)    VALUE 'N'.                  
           05  WS-K893-FND             PIC X(01)    VALUE 'N'.                  
                                                                                
       01  WS30-MISCLLANEOUS.                                                   
           05  WS30-PREV-PAYT-TYPE     PIC X(03)    VALUE SPACES.               
           05  WS30-PREV-GL-ACC        PIC X(18)    VALUE SPACES.               
           05  WS30-LAST-FIN-MM        PIC X(02)    VALUE SPACES.               
           05  WS30-LAST-FIN-CCYY      PIC X(04)    VALUE SPACES.               
           05  WS-PREV-DTE-TRANS       PIC X(08)    VALUE SPACES.               
           05  WS-PREV-PAYMENT-TYPE    PIC X(03)    VALUE SPACES.               
                                                                                
                                                                                
      **********************************************************                
      *         REPORT LAY-OUT  FOR L126                       *                
      **********************************************************                
                                                                                
      *========================================================*                
      *           FORMAT  FOR  HEADING  OF L126                *                
      *========================================================*                
       01  L126-PRT-HEAD-1.                                                     
           05  L126-HD1-RPT-ID         PIC X(14)    VALUE 'BP13L126'.           
           05  FILLER                  PIC X(8)     VALUE 'HDBCAT 3'.           
           05  FILLER                  PIC X(18)    VALUE SPACES.               
           05  FILLER                  PIC X(39)    VALUE                       
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                  PIC X(18)    VALUE SPACES.               
           05  FILLER                  PIC X(7)     VALUE 'DATE: '.             
           05  L126-HD1-DATE           PIC X(10)    VALUE SPACES.               
           05  FILLER                  PIC X(1)     VALUE SPACES.               
           05  FILLER                  PIC X(7)     VALUE 'PAGE: '.             
           05  L126-HD1-PAGE-NO        PIC ZZZZ9.                               
                                                                                
       01  L126-PRT-HEAD-2A.                                                    
           05  FILLER                  PIC X(28)    VALUE SPACES.               
           05  FILLER                  PIC X(46)    VALUE                       
               'SOC - AUDIT TRAIL FOR POSTED TRANSACTIONS FOR '.                
           05  FILLER                  PIC X(36)    VALUE                       
               'SALES AGREEMENT/SUB-TRANSFER/TP-SA'.                            
                                                                                
       01  L126-PRT-HEAD-2B.                                                    
           05  FILLER                  PIC X(28)    VALUE SPACES.               
           05  FILLER                  PIC X(46)    VALUE                       
               'SOC - AUDIT TRAIL FOR POSTED TRANSACTIONS FOR '.                
           05  FILLER                  PIC X(37)    VALUE                       
               'SALES AGREEMENT/SUB-TRANSFER/OTHERS'.                           
                                                                                
       01  L126-PRT-HEAD-2C.                                                    
           05  FILLER                  PIC X(28)    VALUE SPACES.               
           05  FILLER                  PIC X(46)    VALUE                       
               'SOC - AUDIT TRAIL FOR POSTED TRANSACTIONS FOR '.                
           05  FILLER                  PIC X(36)    VALUE                       
               'SALES AGREEMENT/SUB-TRANSFER/TP-2F'.                            
                                                                                
                                                                                
       01  L126-PRT-HEAD-3.                                                     
           05  FILLER                  PIC X(54)    VALUE SPACES.               
           05  FILLER                  PIC X(14)    VALUE                       
              'FOR THE MONTH '.                                                 
           05  L126-HD3-DATE           PIC X(08)    VALUE SPACES.               
                                                                                
       01  L126-PRT-HEAD-4.                                                     
           05  FILLER                  PIC X(48)    VALUE SPACES.               
           05  FILLER                  PIC X(25)    VALUE                       
              'JOURNAL NUMBER ISSUED = '.                                       
           05  L126-HD4-JOURNAL-NO     PIC X(08)    VALUE SPACES.               
                                                                                
       01  L126-PRT-HEAD-5.                                                     
           05  FILLER                  PIC X(13)    VALUE SPACES.               
           05  FILLER                  PIC X(04)    VALUE SPACES.               
           05  FILLER                  PIC X(13)    VALUE SPACES.               
           05  FILLER                  PIC X(12)    VALUE 'SALES'.              
           05  FILLER                  PIC X(44)    VALUE SPACES.               
           05  FILLER                  PIC X(04)    VALUE 'PAYT'.               
                                                                                
       01  L126-PRT-HEAD-6.                                                     
           05  FILLER                  PIC X(05)    VALUE SPACES.               
           05  FILLER                  PIC X(10)    VALUE 'DATE'.               
           05  FILLER                  PIC X(02)    VALUE SPACES.               
           05  FILLER                  PIC X(08)    VALUE 'REGN NO'.            
           05  FILLER                  PIC X(05)    VALUE SPACES.               
           05  FILLER                  PIC X(12)    VALUE 'REF NO'.             
           05  FILLER                  PIC X(05)    VALUE SPACES.               
           05  FILLER                  PIC X(13)    VALUE 'GL ACCOUNT'.         
           05  FILLER                  PIC X(05)    VALUE SPACES.               
           05  FILLER                  PIC X(12)  VALUE 'SCHEME-AC-NO'.         
           05  FILLER                  PIC X(09)    VALUE SPACES.               
           05  FILLER                  PIC X(04)    VALUE 'TYPE'.               
           05  FILLER                  PIC X(13)    VALUE SPACES.               
           05  FILLER                  PIC X(16)    VALUE                       
                                                    '       AMOUNT'.            
                                                                                
      *========================================================*                
      *           FORMAT  FOR DETAIL LINE                      *                
      *========================================================*                
       01  L126-PRT-DETAIL-1.                                                   
           05  FILLER                  PIC X(05)    VALUE SPACES.               
           05  L126-DATE               PIC X(10)    VALUE SPACES.               
           05  FILLER                  PIC X(02)    VALUE SPACES.               
           05  L126-REGN               PIC X(08)    VALUE SPACES.               
           05  FILLER                  PIC X(04)    VALUE SPACES.               
           05  L126-SALES-REF          PIC X(13)    VALUE SPACES.               
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  L126-GL-ACC             PIC X(18)    VALUE SPACES.               
           05  FILLER                  PIC X(03)    VALUE SPACES.               
           05  L126-SCH-ACC            PIC X(14)    VALUE SPACES.               
           05  FILLER                  PIC X(07)    VALUE SPACES.               
           05  L126-PAYT-TYPE          PIC X(03)    VALUE SPACES.               
           05  FILLER                  PIC X(13)    VALUE SPACES.               
           05  L126-AMOUNT             PIC ZZZ,ZZZ,ZZ9.99.                      
           05  L126-DRCR               PIC X(02).                               
                                                                                
      *====================================================*                    
      *       FORMAT FOR SUBTOTAL HEADING, DETAIL          *                    
      *====================================================*                    
       01  L126-PRT-SUBTOT-HEAD.                                                
           05  FILLER                  PIC X(25)    VALUE SPACES.               
           05  FILLER                  PIC X(21)    VALUE                       
              'TOTAL FOR GL ACCOUNT '.                                          
           05  L126-PRT-SUBTOT-LINE.                                            
               10  L126-SUBTOT-GL-ACC  PIC X(18)    VALUE SPACES.               
               10  FILLER              PIC X(37)    VALUE SPACES.               
               10  L126-SUBTOT-DRCR-AMT PIC ZZZ,ZZZ,ZZ9.99.                     
               10  L126-SUBTOT-DRCR    PIC X(02)    VALUE SPACES.               
                                                                                
       01  L126-PRT-SUBTOT-DASH.                                                
           05  FILLER                  PIC X(99)    VALUE SPACES.               
           05  FILLER                  PIC X(18)    VALUE ALL '-'.              
                                                                                
      *====================================================*                    
      *        FORMAT FOR TOTAL HEADING AND DETAIL         *                    
      *====================================================*                    
       01  L126-PRT-TOT-HEAD.                                                   
           05  FILLER                  PIC X(25)    VALUE SPACES.               
           05  FILLER                  PIC X(21)    VALUE                       
              'TOTAL FOR ALL TRANS  '.                                          
           05  L126-PRT-TOT-LINE.                                               
               10  FILLER              PIC X(55)    VALUE SPACES.               
               10  L126-TOT-DRCR-AMT   PIC ZZZ,ZZZ,ZZ9.99.                      
               10  L126-TOT-DRCR       PIC X(02)    VALUE SPACES.               
                                                                                
       01  L126-PRT-GRAND-TOTAL-HEAD-1.                                         
           05  FILLER                  PIC X(30)    VALUE SPACES.               
           05  FILLER                  PIC X(23)    VALUE                       
              'TOTAL DEBITS       =   '.                                        
           05  L126-TOT-DR-AMT         PIC ZZZ,ZZZ,ZZ9.99.                      
                                                                                
       01  L126-PRT-GRAND-TOTAL-HEAD-2.                                         
           05  FILLER                  PIC X(30)    VALUE SPACES.               
           05  FILLER                  PIC X(23)    VALUE                       
              'TOTAL CREDITS      =   '.                                        
           05  L126-TOT-CR-AMT         PIC ZZZ,ZZZ,ZZ9.99.                      
                                                                                
                                                                                
      **********************************************************                
      *         LAY-OUT FOR MISMATCHED LISTING L26A            *                
      **********************************************************                
       01  L26A-PRT-HEAD-4.                                             02740000
           05  FILLER                  PIC X(42)    VALUE SPACES.       02750000
           05  FILLER                  PIC X(90)    VALUE               02760000
              ' UNMATCHED LISTING FOR PAYMENT TYPE '.                   02770001
                                                                                
       01  L26A-PRT-HEAD-5.                                                     
           05  FILLER                  PIC X(13)    VALUE SPACES.               
           05  FILLER                  PIC X(04)    VALUE SPACES.               
           05  FILLER                  PIC X(13)    VALUE SPACES.               
           05  FILLER                  PIC X(12)    VALUE 'SALES'.              
           05  FILLER                  PIC X(44)    VALUE SPACES.               
           05  FILLER                  PIC X(04)    VALUE 'PAYT'.               
                                                                                
       01  L26A-PRT-HEAD-6.                                                     
           05  FILLER                  PIC X(05)    VALUE SPACES.               
           05  FILLER                  PIC X(10)    VALUE 'DATE'.               
           05  FILLER                  PIC X(02)    VALUE SPACES.               
           05  FILLER                  PIC X(08)    VALUE 'REGN NO'.            
           05  FILLER                  PIC X(05)    VALUE SPACES.               
           05  FILLER                  PIC X(12)    VALUE 'REF NO'.             
           05  FILLER                  PIC X(05)    VALUE SPACES.               
           05  FILLER                  PIC X(13)    VALUE 'REMARKS   '.         
           05  FILLER                  PIC X(05)    VALUE SPACES.               
           05  FILLER                  PIC X(12)  VALUE 'SCHEME-AC-NO'.         
           05  FILLER                  PIC X(09)    VALUE SPACES.               
           05  FILLER                  PIC X(04)    VALUE 'TYPE'.               
           05  FILLER                  PIC X(13)    VALUE SPACES.               
           05  FILLER                  PIC X(12)    VALUE                       
                                                    '      AMOUNT'.             
                                                                        02880000
       01  L26A-PRT-HEAD-7.                                             02890001
           05  FILLER                  PIC X(02)    VALUE SPACES.       02900000
           05  FILLER                  PIC X(130)   VALUE ALL '-'.      02910000
                                                                        02880000
       01  L26A-PRT-DASH1.                                              02890001
           05  FILLER                  PIC X(100)   VALUE SPACES.       02900000
           05  FILLER                  PIC X(17)    VALUE ALL '-'.      02910000
                                                                        02880000
       01  L26A-PRT-DASH2.                                              02890001
           05  FILLER                  PIC X(100)   VALUE SPACES.       02900000
           05  FILLER                  PIC X(17)    VALUE ALL '='.      02910000
                                                                        02920000
       01  L26A-PRT-SPACES.                                             02890001
           05  FILLER                  PIC X(132)   VALUE SPACES.       02900000
                                                                                
       01  L26A-PRT-DETAIL-1.                                                   
           05  FILLER                  PIC X(05)    VALUE SPACES.               
           05  L26A-DATE               PIC X(10)    VALUE SPACES.               
           05  FILLER                  PIC X(02)    VALUE SPACES.               
           05  L26A-REGN               PIC X(08)    VALUE SPACES.               
           05  FILLER                  PIC X(04)    VALUE SPACES.               
           05  L26A-SALES-REF          PIC X(13)    VALUE SPACES.               
           05  FILLER                  PIC X(01)    VALUE SPACES.               
           05  L26A-REMARKS            PIC X(18)    VALUE SPACES.               
           05  FILLER                  PIC X(03)    VALUE SPACES.               
           05  L26A-SCH-ACC            PIC X(14)    VALUE SPACES.               
           05  FILLER                  PIC X(07)    VALUE SPACES.               
           05  L26A-PAYT-TYPE          PIC X(03)    VALUE SPACES.               
           05  FILLER                  PIC X(13)    VALUE SPACES.               
           05  L26A-AMOUNT             PIC ZZZ,ZZZ,ZZ9.99.                      
           05  L26A-AMOUNT-DRCR        PIC X(02).                               
                                                                                
       01  L26A-PRT-SUBTOT.                                                     
           05  FILLER                  PIC X(5)     VALUE SPACES.               
           05  FILLER                  PIC X(15)    VALUE                       
               'NO. OF CASES : '.                                               
           05  L26A-SUB-CASENO         PIC ZZ9.                                 
           05  FILLER                  PIC X(59)    VALUE SPACES.               
           05  FILLER                  PIC X(14)    VALUE                       
               'SUB - TOTAL : '.                                                
           05  FILLER                  PIC X(5)     VALUE SPACES.               
           05  L26A-SUB-AMT            PIC ZZZ,ZZZ,ZZ9.99.                      
           05  L26A-SUB-AMT-DRCR       PIC X(2)     VALUE SPACES.               
                                                                                
       01  L26A-PRT-SUBPTYPE.                                                   
           05  FILLER                  PIC X(80)    VALUE SPACES.               
           05  FILLER                  PIC X(10)    VALUE                       
               'TOTAL FOR '.                                                    
           05  L26A-SUB-PTYPE          PIC X(3)     VALUE SPACES.               
           05  FILLER                  PIC X(3)     VALUE ' : '.                
           05  FILLER                  PIC X(5)     VALUE SPACES.               
           05  L26A-SUB-PTYPE-AMT      PIC ZZZ,ZZZ,ZZ9.99.                      
           05  L26A-SUB-PTYPE-DRCR     PIC X(2)     VALUE SPACES.               
                                                                                
       01  L26A-PRT-GRDTOT.                                                     
           05  FILLER                  PIC X(5)     VALUE SPACES.               
           05  FILLER                  PIC X(21)    VALUE                       
               'TOTAL NO. OF CASES : '.                                         
           05  L26A-GRD-CASENO         PIC ZZ9.                                 
           05  FILLER                  PIC X(51)    VALUE SPACES.               
           05  FILLER                  PIC X(16)    VALUE                       
               'GRAND - TOTAL : '.                                              
           05  FILLER                  PIC X(5)     VALUE SPACES.               
           05  L26A-GRD-AMT            PIC ZZZ,999,999.99.                      
           05  L26A-GRD-AMT-DRCR       PIC X(2)     VALUE SPACES.               
                                                                                
                                                                                
      **********************************************************                
       PROCEDURE DIVISION.                                                      
      **********************************************************                
                                                                                
      *                                                                         
       MAIN-ROUTINE SECTION.                                                    
      *====================*                                                    
            PERFORM 100-OPEN-FILES     THRU  100-EXIT.                          
            PERFORM 150-READ-BP13F120  THRU  150-EXIT  UNTIL WS4-EOF.           
            PERFORM 600-PRINT-TOTAL    THRU  600-EXIT.                          
            PERFORM 900-CLOSE-ROUTINE  THRU  900-EXIT.                          
                                                                                
       MAIN-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *                                                                         
       100-OPEN-FILES.                                                          
      *========================*                                                
           OPEN INPUT  BP13F120                                                 
                       BP13K800                                                 
                       BP13K893                                                 
                       SY02F001                                                 
                OUTPUT BP13L126  BP13L26A.                                      
      *                                                                         
           IF K800-STATUS NOT = 00 AND NOT = 97                                 
              DISPLAY ' OPENING ERROR, BP13K800-STATUS = ' K800-STATUS          
              MOVE K800-STATUS  TO RETURN-CODE                                  
              PERFORM 900-CLOSE-ROUTINE.                                        
                                                                                
           IF K893-STATUS NOT = 00 AND NOT = 97                                 
              DISPLAY ' OPENING ERROR, K893-STATUS = ' K893-STATUS              
              MOVE K893-STATUS  TO RETURN-CODE                                  
              PERFORM 900-CLOSE-ROUTINE.                                        
      *                                                                         
           READ SY02F001 AT END MOVE 'Y' TO SY02F001-EOF.                       
           IF SY02F001-EOF = 'Y'                                                
              DISPLAY 'RECORD NOT FOUND IN SY02F001.'                           
              DISPLAY 'PROCESSING TERMINATED.'                                  
              PERFORM 900-CLOSE-ROUTINE                                         
           ELSE                                                                 
              STRING F001-CURR-MM '/'                                           
                     F001-CURR-CC                                               
                     F001-CURR-YY DELIMITED BY SIZE                             
                     INTO WS-DATE                                               
           END-IF.                                                              
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *                                                                         
       150-READ-BP13F120.                                                       
      *===========================*                                             
      **************************************************************            
      *                                                            *            
      *   1. READ FILE BP13F120.                                   *            
      *   2. PROCESS NECESSARY DETAILS FOR PRINTING.               *            
      *   3. CALL ROUTINE TO PRINT REPORT.                         *            
      *                                                            *            
      **************************************************************            
           READ BP13F120                                                        
                         AT END MOVE 'Y' TO WS4-EOF-IND                         
                         GO TO 150-EXIT.                                        
                                                                                
           ADD  1 TO WS2-CNT-F120-READ.                                         
           MOVE 'N'            TO WS-K800-FND                                   
                                  WS-K893-FND.                                  
           MOVE F120-NUM-REGN  TO K800-NUM-REGN.                                
                                                                                
      ***CHANGE PAYMENT TYPE FOR FSH TO READ THE TABLE                          
           IF F120-CDE-PAYMENT-TYPE = 'VRL'                                     
              IF F120-CDE-VALID = 'H'                                           
                 MOVE 'FSH'      TO F120-CDE-PAYMENT-TYPE                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           READ BP13K800.                                                       
                                                                                
           IF K800-STATUS = 00                                                  
              MOVE 'Y'    TO  WS-K800-FND                                       
              PERFORM 200-MOVE-PRT-L126   THRU  200-EXIT                        
           ELSE                                                                 
           IF K800-STATUS = 10 OR 23                                            
              PERFORM 160-START-BP13K893  THRU  160-EXIT                        
           ELSE                                                                 
              DISPLAY ' ERROR READING, BP13K800 = ' K800-STATUS                 
              MOVE K800-STATUS  TO RETURN-CODE                                  
              PERFORM 900-CLOSE-ROUTINE   THRU  900-EXIT.                       
                                                                                
           ADD 1 TO WS2-CNT-K800-READ.                                          
                                                                                
      *                                                                         
       150-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *                                                                         
       160-START-BP13K893.                                                      
      *===========================*                                             
           MOVE  'N'             TO WS-K893-EOF.                                
           INITIALIZE            BP13K893-MASTER.                               
           MOVE SPACES           TO K893-KEY-FLD.                               
           MOVE F120-NUM-REGN    TO K893-NUM-REGN-HIST.                         
                                                                                
           START BP13K893 KEY >= K893-KEY-FLD.                                  
                                                                                
           IF K893-STATUS = 00 OR 02                                            
              PERFORM 170-READNEXT-BP13K893   THRU 170-EXIT                     
                        UNTIL WS-K893-EOF = 'Y'                                 
           ELSE                                                                 
           IF K893-STATUS = 10 OR 23                                            
              MOVE SPACES                 TO    L26A-SALES-REF                  
              MOVE 'REC NOT FD IN SOC   ' TO    L26A-REMARKS                    
              PERFORM 300-MOVE-PRT-L26A   THRU  300-EXIT                        
           ELSE                                                                 
              DISPLAY 'START BROWSE ERROR BP13K893,STATUS IS '                  
                          K893-STATUS                                           
              MOVE K893-STATUS  TO RETURN-CODE                                  
              PERFORM 900-CLOSE-ROUTINE   THRU  900-EXIT.                       
                                                                                
      *                                                                         
       160-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *                                                                         
       170-READNEXT-BP13K893.                                                   
      *===========================*                                             
           READ BP13K893 NEXT RECORD                                            
                AT END                                                          
                   MOVE 'Y'  TO  WS-K893-EOF                                    
           END-READ.                                                            
                                                                                
           IF K893-STATUS = 00 OR 02                                            
              IF F120-NUM-REGN = K893-NUM-REGN-HIST                             
                 IF K893-NUM-SCH-ACC NOT = SPACES AND LOW-VALUES                
                    MOVE 'Y'      TO    WS-K893-FND                             
                    PERFORM 200-MOVE-PRT-L126   THRU  200-EXIT                  
                    MOVE 'Y'      TO    WS-K893-EOF                             
                 ELSE                                                           
                    CONTINUE                                                    
                 END-IF                                                         
              ELSE                                                              
                 MOVE SPACES                 TO    L26A-SALES-REF               
                 MOVE 'REC NOT FD IN SOC   ' TO    L26A-REMARKS                 
                 PERFORM 300-MOVE-PRT-L26A   THRU  300-EXIT                     
                 MOVE 'Y'                    TO    WS-K893-EOF                  
              END-IF                                                            
           ELSE                                                                 
              IF K893-STATUS = 10 OR 23                                         
                 MOVE SPACES                 TO    L26A-SALES-REF               
                 MOVE 'REC NOT FD IN SOC   ' TO    L26A-REMARKS                 
                 PERFORM 300-MOVE-PRT-L26A   THRU  300-EXIT                     
                 MOVE 'Y'       TO    WS-K893-EOF                               
              ELSE                                                              
                 DISPLAY ' ERROR READING, BP13K893 = ' K893-STATUS              
                 MOVE K893-STATUS  TO RETURN-CODE                               
                 PERFORM 900-CLOSE-ROUTINE   THRU  900-EXIT                     
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *                                                                         
       170-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
       200-MOVE-PRT-L126.                                                       
      *===========================*                                             
      **********************************************************                
      *                                                        *                
      *   MOVE NECESSARY DETAILS TO REPORT AND PRINT           *                
      *                                                        *                
      **********************************************************                
           MOVE F120-NUM-REGN          TO  L126-REGN.                           
           IF WS-K800-FND = 'Y'                                                 
              MOVE K800-NUM-NEW-TOWN      TO  WS10-SREF-ZONE                    
              MOVE K800-NUM-REGN          TO  WS10-SREF-CUR-REG                 
           END-IF.                                                              
           IF WS-K893-FND = 'Y'                                                 
              MOVE K893-NUM-NEW-TOWN      TO  WS10-SREF-ZONE                    
              MOVE K893-NUM-REGN          TO  WS10-SREF-CUR-REG                 
           END-IF.                                                              
           MOVE WS10-SALES-REF         TO  L126-SALES-REF.                      
           MOVE F120-DTE-TRANS         TO  WS5-TRAN-DATE.                       
           MOVE WS5-TRAN-CC            TO  WS5-PRT-CC.                          
           MOVE WS5-TRAN-YY            TO  WS5-PRT-YY.                          
           MOVE WS5-TRAN-MM            TO  WS5-PRT-MM.                          
           MOVE WS5-TRAN-DD            TO  WS5-PRT-DD.                          
           MOVE WS5-PRT-DATE           TO  L126-DATE.                           
           MOVE F120-NUM-SCH-ACCT      TO  WS7-SCH-ACC.                         
           MOVE CORR WS7-SCH-ACC       TO  WS7-SCH-ACC-2.                       
           MOVE WS7-SCH-ACC-2          TO  L126-SCH-ACC.                        
           MOVE F120-CDE-PAYMENT-TYPE  TO  L126-PAYT-TYPE.                      
           IF F120-CDE-PAYMENT-TYPE = 'FSH'                                     
              MOVE 'VRL'               TO  L126-PAYT-TYPE                       
           END-IF.                                                              
           IF   F120-CDE-PAYMENT-TYPE  = 'CST'                                  
           MOVE 'GST'                  TO  L126-PAYT-TYPE.                      
           MOVE F120-AMT-RECEIPT       TO  L126-AMOUNT.                         
                                                                                
      *--------------------------------------------------*                      
      * GET FINANCIAL MONTH FROM TRANSACTION MONTH       *                      
      * (IF FIN. MTH = 1,2 OR 3 - BELONG TO LAST FIN. YR *                      
      *--------------------------------------------------*                      
           SET WS9-IDX TO 1.                                                    
           SEARCH WS9-TF-MTH                                                    
                  WHEN WS9-TRAN-MM(WS9-IDX) = WS5-TRAN-MM                       
                       MOVE WS9-FIN-MM(WS9-IDX) TO WS11-JOURN-MM.               
                                                                                
           IF WS5-TRAN-MM = '01' OR '02' OR '03'                                
              MOVE WS5-TRAN-CCYY   TO  WS5-CCYY                                 
              COMPUTE WS5-CCYY-NUM  =  WS5-CCYY-NUM - 1                         
              MOVE WS5-CCYY        TO  WS11-JOURN-CCYY                          
           ELSE                                                                 
              MOVE WS5-TRAN-CCYY   TO  WS11-JOURN-CCYY.                         
           MOVE WS11-JOURNAL-NO  TO  L126-HD4-JOURNAL-NO.                       
                                                                                
      *--------------------------------------------*                            
      * GET GL ACCOUNT FROM  PAYMENT TYPE          *                            
      *--------------------------------------------*                            
           SET WS8-IDX TO 1.                                                    
           SEARCH WS8-GL-ACC AT END                                             
                  MOVE SPACES                 TO   L126-GL-ACC                  
                  IF WS-K800-FND = 'Y'                                          
                     MOVE K800-NUM-NEW-TOWN      TO   WS10-SREF-ZONE            
                     MOVE K800-NUM-REGN          TO   WS10-SREF-CUR-REG         
                  END-IF                                                        
                  IF WS-K893-FND = 'Y'                                          
                     MOVE K893-NUM-NEW-TOWN      TO   WS10-SREF-ZONE            
                     MOVE K893-NUM-REGN          TO   WS10-SREF-CUR-REG         
                  END-IF                                                        
                  MOVE WS10-SALES-REF         TO   L26A-SALES-REF               
                  MOVE 'INVALID PAYMENT TYPE' TO   L26A-REMARKS                 
                  PERFORM 300-MOVE-PRT-L26A   THRU 300-EXIT                     
           WHEN   WS8-GL-PAYT(WS8-IDX) = F120-CDE-PAYMENT-TYPE                  
                  IF F120-NUM-PP-SCHEDULE NOT NUMERIC                           
                     MOVE 0 TO F120-NUM-PP-SCHEDULE                             
                  END-IF                                                        
                                                                                
                  IF (((F120-NUM-FLAT-TYPE-SA = '1A' OR '2A') OR                
                       (F120-CDE-VALID        = 'L')) AND                       
                     (F120-CDE-PAYMENT-TYPE = 'CON' OR 'CST' OR                 
                      'SRV' OR 'SST' OR 'ADV' OR 'SA' OR 'TMP' OR               
                      'MLF'))                                                   
                     PERFORM 210-CHECK-GL-ACC-DESC-57 THRU 210-EXIT             
                  ELSE                                                          
                    IF ((F120-NUM-FLAT-TYPE-SA = '2F') AND                      
                        (F120-NUM-PP-SCHEDULE  > 0     AND                      
                         F120-NUM-PP-SCHEDULE <= 60)   AND                      
                        (F120-CDE-PAYMENT-TYPE = 'CON' OR 'CST' OR              
                        'SRV' OR 'SST' OR 'ADV' OR 'VRL' OR 'TMP' OR            
                         'MLF'))                                                
                        PERFORM 210-CHECK-GL-ACC-DESC-57 THRU 210-EXIT          
                    ELSE                                                        
                       IF F120-NUM-FLAT-TYPE-SA = '1F' AND                      
                          F120-CDE-PAYMENT-TYPE = 'VRL'                         
                          MOVE '0 40 76 00 57 4046' TO L126-GL-ACC              
                       ELSE                                                     
                          MOVE WS8-GL-ACC-DESC(WS8-IDX) TO L126-GL-ACC          
                       END-IF                                                   
                     END-IF                                                     
                  END-IF.                                                       
                                                                                
           IF F120-CDE-PAYMENT-TYPE = 'SRV'                                     
              MOVE F120-CDE-BO         TO L126-GL-ACC(06:2)                     
           END-IF.                                                              
                                                                                
           IF F120-CDE-PAYMENT-TYPE = 'PRM'                                     
              MOVE F120-NUM-FLAT-TYPE-SA(1:1) TO L126-GL-ACC(18:1)              
           END-IF.                                                              
                                                                                
           IF F120-CDE-PAYMENT-TYPE = 'LVL'                                     
              EVALUATE F120-NUM-FLAT-TYPE-RSL                                   
                 WHEN '01'                                                      
                      MOVE '894'       TO L126-GL-ACC(16:3)                     
                 WHEN '02'                                                      
                      MOVE '896'       TO L126-GL-ACC(16:3)                     
                 WHEN '03'                                                      
                      MOVE '898'       TO L126-GL-ACC(16:3)                     
                 WHEN '04'                                                      
                      MOVE '900'       TO L126-GL-ACC(16:3)                     
                 WHEN '05'                                                      
                      MOVE '902'       TO L126-GL-ACC(16:3)                     
                 WHEN '06'                                                      
                      MOVE '904'       TO L126-GL-ACC(16:3)                     
                 WHEN '08'                                                      
                      MOVE '905'       TO L126-GL-ACC(16:3)                     
                 WHEN OTHER                                                     
                      MOVE 'XXX'       TO L126-GL-ACC(16:3)                     
              END-EVALUATE                                                      
           END-IF.                                                              
                                                                                
      *--------------------------------------------*                            
      * IF PAYMENT TYPE CHANGES - PRINT SUBTOTAL   *                            
      *--------------------------------------------*                            
           IF  F120-CDE-PAYMENT-TYPE NOT  =  WS30-PREV-PAYT-TYPE                
               OR L126-GL-ACC NOT = WS30-PREV-GL-ACC                            
               MOVE F120-CDE-PAYMENT-TYPE TO WS30-PREV-PAYT-TYPE                
               IF WS4-1ST-TIME                                                  
                  MOVE SPACE         TO  WS4-1ST-TIME-IND                       
                  MOVE L126-GL-ACC   TO  WS30-PREV-GL-ACC                       
               ELSE                                                             
                  PERFORM 550-PRINT-SUBTOT THRU  550-EXIT                       
           ELSE                                                                 
              NEXT SENTENCE.                                                    
                                                                                
      *-------------------------------------------------------------*           
      * NEGATIVE AMOUNT MEANS DEBIT AND POSITIVE MEANS CREDIT                   
      *   FOR ALL PAYMENT TYPES EXCEPT FOR 'SOC'                                
      * SOC - NEGATIVE AMT MEANS CREDIT AND POSITIVE AMT MEANS DEBIT            
      *-------------------------------------------------------------*           
           IF F120-CDE-PAYMENT-TYPE = 'SOC'                                     
              MOVE 'Y' TO WS4-ONLY-SOC-IND                                      
              IF F120-AMT-RECEIPT > 0                                           
                 MOVE 'DB'             TO L126-DRCR                             
                 COMPUTE WS3-SUBTOT-DR-AMT =                                    
                         WS3-SUBTOT-DR-AMT - F120-AMT-RECEIPT                   
                 COMPUTE WS3-TOT-DR-AMT    =                                    
                         WS3-TOT-DR-AMT    - F120-AMT-RECEIPT                   
              ELSE                                                              
                 MOVE 'CR'             TO L126-DRCR                             
                 COMPUTE WS3-SUBTOT-CR-AMT =                                    
                         WS3-SUBTOT-CR-AMT - F120-AMT-RECEIPT                   
                 COMPUTE WS3-TOT-CR-AMT    =                                    
                         WS3-TOT-CR-AMT    - F120-AMT-RECEIPT                   
           ELSE                                                                 
              MOVE SPACE TO WS4-ONLY-SOC-IND                                    
              IF F120-AMT-RECEIPT > 0                                           
                 MOVE 'CR'             TO L126-DRCR                             
                 ADD F120-AMT-RECEIPT  TO WS3-SUBTOT-CR-AMT                     
                                          WS3-TOT-CR-AMT                        
              ELSE                                                              
                 MOVE 'DB'             TO L126-DRCR                             
                 ADD F120-AMT-RECEIPT  TO WS3-SUBTOT-DR-AMT                     
                                          WS3-TOT-DR-AMT.                       
      *                                                                         
           PERFORM 400-PRINT   THRU  400-EXIT.                                  
      *                                                                         
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *                                                                         
       210-CHECK-GL-ACC-DESC-57.                                                
      *===========================*                                             
                                                                                
           SET WS8-IDX2 TO 1.                                                   
           SEARCH WS8-GL-ACC2 AT END                                            
                  MOVE SPACES                 TO   L126-GL-ACC                  
                  IF WS-K800-FND = 'Y'                                          
                     MOVE K800-NUM-NEW-TOWN      TO   WS10-SREF-ZONE            
                     MOVE K800-NUM-REGN          TO   WS10-SREF-CUR-REG         
                  END-IF                                                        
                  IF WS-K893-FND = 'Y'                                          
                     MOVE K893-NUM-NEW-TOWN      TO   WS10-SREF-ZONE            
                     MOVE K893-NUM-REGN          TO   WS10-SREF-CUR-REG         
                  END-IF                                                        
                  MOVE WS10-SALES-REF         TO   L26A-SALES-REF               
                  MOVE 'INVALID PAYMENT TYPE' TO   L26A-REMARKS                 
                  PERFORM 300-MOVE-PRT-L26A   THRU 300-EXIT                     
           WHEN   WS8-GL-PAYT2(WS8-IDX2) = F120-CDE-PAYMENT-TYPE                
                  MOVE WS8-GL-ACC-DESC2(WS8-IDX2) TO L126-GL-ACC.               
                                                                                
                                                                                
       210-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *                                                                         
       300-MOVE-PRT-L26A.                                                       
      *===========================*                                             
      **************************************************************    04670000
      *                                                            *    04680000
      *      PRINT MISTMATCHED LISTING.                            *    04690000
      *                                                            *    04700000
      **************************************************************    04710000
           MOVE WS6-L26A-RPT-ID        TO    L126-HD1-RPT-ID.           04720000
                                                                        04730000
           PERFORM 500-CHECK-LINECT    THRU  500-EXIT.                  04740000
                                                                        04750000
           ADD 1                       TO    WS2-CNT-PRINT-L26A         04760000
                                             WS2-CNT-LINE-ON-L26A.      04770000
                                                                                
      *==> PRINT SUB-TOTAL FOR EVERY CHANGE IN TRANS-DATE                       
                                                                                
           IF WS2-CNT-PRINT-L26A = 1                                    04760000
              MOVE F120-DTE-TRANS         TO WS-PREV-DTE-TRANS                  
              MOVE F120-CDE-PAYMENT-TYPE  TO WS-PREV-PAYMENT-TYPE.              
                                                                                
           IF F120-DTE-TRANS NOT = WS-PREV-DTE-TRANS                            
              WRITE L26A-PRINT-REC     FROM L26A-PRT-DASH1 AFTER 1      04850000
              MOVE WS-SUB-CASENO       TO   L26A-SUB-CASENO                     
              MOVE WS-SUB-AMT          TO   L26A-SUB-AMT                        
              IF WS-SUB-AMT > 0                                                 
                 MOVE 'CR'             TO   L26A-SUB-AMT-DRCR                   
              ELSE                                                              
                 MOVE 'DR'             TO   L26A-SUB-AMT-DRCR                   
              END-IF                                                            
              WRITE L26A-PRINT-REC     FROM L26A-PRT-SUBTOT AFTER 1     04850000
              WRITE L26A-PRINT-REC     FROM L26A-PRT-SPACES AFTER 1     04850000
              ADD 3                    TO   WS2-CNT-LINE-ON-L26A        04770000
              MOVE ZEROES              TO   WS-SUB-CASENO WS-SUB-AMT            
              MOVE F120-DTE-TRANS      TO   WS-PREV-DTE-TRANS.                  
                                                                                
           IF F120-CDE-PAYMENT-TYPE NOT = WS-PREV-PAYMENT-TYPE                  
              WRITE L26A-PRINT-REC     FROM L26A-PRT-DASH1 AFTER 1      04850000
              MOVE WS-PREV-PAYMENT-TYPE  TO L26A-SUB-PTYPE                      
              MOVE WS-SUB-PTYPE-AMT    TO   L26A-SUB-PTYPE-AMT                  
              IF WS-SUB-PTYPE-AMT > 0                                           
                 MOVE 'CR'             TO   L26A-SUB-PTYPE-DRCR                 
              ELSE                                                              
                 MOVE 'DR'             TO   L26A-SUB-PTYPE-DRCR                 
              END-IF                                                            
              WRITE L26A-PRINT-REC     FROM L26A-PRT-SUBPTYPE AFTER 1   04850000
              WRITE L26A-PRINT-REC     FROM L26A-PRT-SPACES AFTER 1     04850000
              ADD 3                      TO WS2-CNT-LINE-ON-L26A        04770000
              MOVE ZEROES                TO WS-SUB-PTYPE-AMT                    
              MOVE F120-CDE-PAYMENT-TYPE TO WS-PREV-PAYMENT-TYPE.               
                                                                                
           MOVE F120-NUM-REGN          TO    L26A-REGN.                         
           MOVE F120-DTE-TRANS         TO    WS5-TRAN-DATE.                     
           MOVE WS5-TRAN-CC            TO    WS5-PRT-CC.                        
           MOVE WS5-TRAN-YY            TO    WS5-PRT-YY.                        
           MOVE WS5-TRAN-MM            TO    WS5-PRT-MM.                        
           MOVE WS5-TRAN-DD            TO    WS5-PRT-DD.                        
           MOVE WS5-PRT-DATE           TO    L26A-DATE                          
           MOVE F120-NUM-SCH-ACCT      TO    WS7-SCH-ACC.                       
           MOVE CORR WS7-SCH-ACC       TO    WS7-SCH-ACC-2.                     
           MOVE WS7-SCH-ACC-2          TO    L26A-SCH-ACC.                      
           MOVE F120-CDE-PAYMENT-TYPE  TO    L26A-PAYT-TYPE.                    
           IF   F120-CDE-PAYMENT-TYPE  =  'SOC'                                 
           COMPUTE F120-AMT-RECEIPT = -1 *   F120-AMT-RECEIPT.                  
           MOVE F120-AMT-RECEIPT       TO    L26A-AMOUNT.                       
           IF F120-AMT-RECEIPT > 0                                              
              MOVE 'CR'                TO    L26A-AMOUNT-DRCR                   
           ELSE                                                                 
              MOVE 'DR'                TO    L26A-AMOUNT-DRCR.                  
           ADD  F120-AMT-RECEIPT       TO    WS-SUB-AMT                         
                                             WS-SUB-PTYPE-AMT                   
                                             WS-GRD-AMT.                        
           ADD 1                       TO    WS-SUB-CASENO                      
                                             WS-GRD-CASENO.                     
           DISPLAY ' GRAND TOTAL '           WS-GRD-AMT.                        
                                                                                
           WRITE L26A-PRINT-REC        FROM  L26A-PRT-DETAIL-1 AFTER 1. 04850000
           MOVE  SPACES                TO    L26A-PRINT-REC.            04860000
           MOVE  SPACES                TO    L26A-PRT-DETAIL-1.         04860000
                                                                                
       300-EXIT.                                                        04870000
           EXIT.                                                        04880000
                                                                        04890000
                                                                                
      *                                                                         
       400-PRINT.                                                               
      *===================*                                                     
      ******************************************************************        
      *                                                                *        
      *       PRINT DETAIL LINE FOR REPORT L126                        *        
      *                                                                *        
      ******************************************************************        
           MOVE WS6-L126-RPT-ID    TO    L126-HD1-RPT-ID.               04980000
      *                                                                         
           PERFORM 500-CHECK-LINECT.                                            
      *                                                                         
           ADD 1                   TO    WS2-CNT-PRINT-L126                     
                                         WS2-CNT-LINE-ON-L126.                  
           WRITE L126-PRINT-REC    FROM  L126-PRT-DETAIL-1 AFTER 1.             
           MOVE SPACES             TO    L126-PRINT-REC.                        
      *                                                                         
           ADD 1                   TO    WS2-CNT-LINE-ON-L126.                  
           MOVE SPACE              TO    WS4-SUBTOT-PRTED-IND.                  
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *                                                                         
       500-CHECK-LINECT.                                                        
      *==========================*                                              
      ******************************************************************        
      *                                                                *        
      *          CHECK LINE COUNT TO DETERMINE PAGE THROW              *        
      *                FOR REPORT                                      *        
      *                                                                *        
      ******************************************************************        
           IF (L126-HD1-RPT-ID = WS6-L126-RPT-ID)                       05310000
              IF (WS2-CNT-LINE-ON-L126 > WS6-MAX-LINES) OR              05320000
                 (WS30-LAST-FIN-MM NOT = WS11-JOURN-MM) OR                      
                 (WS30-LAST-FIN-CCYY NOT = WS11-JOURN-CCYY)                     
      *                                                                         
                 MOVE WS11-JOURN-MM TO WS30-LAST-FIN-MM                         
                 MOVE WS11-JOURN-CCYY TO WS30-LAST-FIN-CCYY                     
                 PERFORM 560-PRINT-RPT-HEADING   THRU 560-EXIT          05330000
                 MOVE 1  TO WS2-CNT-LINE-ON-L126.                       05340000
      *                                                                         
                                                                        05300000
           IF (L126-HD1-RPT-ID = WS6-L26A-RPT-ID)    AND                05260000
              (WS2-CNT-LINE-ON-L26A > WS6-MAX-LINES)                    05270000
               PERFORM 560-PRINT-RPT-HEADING                            05280000
               MOVE 17 TO WS2-CNT-LINE-ON-L26A.                         05290000
                                                                        05300000
      *                                                                         
       500-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *                                                                         
       550-PRINT-SUBTOT.                                                        
      *==========================*                                              
      ******************************************************************        
      *                                                                *        
      *       PRINT SUB-TOTAL FOR EACH PAYMENT TYPE                    *        
      *                                                                *        
      ******************************************************************        
           MOVE  WS30-PREV-GL-ACC TO   L126-SUBTOT-GL-ACC.                      
           ADD   3                TO   WS2-CNT-LINE-ON-L126.                    
           WRITE L126-PRINT-REC   FROM L126-PRT-SUBTOT-DASH AFTER 2.            
           MOVE  SPACES           TO   L126-PRINT-REC.                          
      *                                                                         
           COMPUTE WS3-SUBTOT-DRCR-AMT = WS3-SUBTOT-DR-AMT +                    
                                         WS3-SUBTOT-CR-AMT.                     
      *                                                                         
           MOVE WS3-SUBTOT-DRCR-AMT TO  L126-SUBTOT-DRCR-AMT.                   
           IF WS3-SUBTOT-DRCR-AMT > 0                                           
              MOVE 'CR'  TO  L126-SUBTOT-DRCR                                   
           ELSE                                                                 
              MOVE 'DB'  TO  L126-SUBTOT-DRCR.                                  
                                                                                
           MOVE  0              TO    WS3-SUBTOT-CR-AMT                         
                                      WS3-SUBTOT-DR-AMT                         
                                      WS3-SUBTOT-DRCR-AMT.                      
                                                                                
           WRITE L126-PRINT-REC FROM  L126-PRT-SUBTOT-HEAD AFTER 1.             
           ADD   4              TO    WS2-CNT-LINE-ON-L126.                     
           MOVE  SPACES         TO    L126-PRINT-REC.                           
           WRITE L126-PRINT-REC AFTER 2.                                        
                                                                                
           MOVE 'Y'   TO  WS4-SUBTOT-PRTED-IND.                                 
      *                                                                         
      * TO UPDATE GL ACC WHEN IT CHANGES                                        
      *                                                                         
           IF  L126-GL-ACC NOT = WS30-PREV-GL-ACC                               
               MOVE L126-GL-ACC  TO WS30-PREV-GL-ACC.                           
                                                                                
      *                                                                         
       550-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *                                                                 05660000
       560-PRINT-RPT-HEADING.                                           05670000
      *================================*                                05680000
      ****************************************************************  05690000
      *                                                              *  05700000
      * PRINT HEADING EITHER FOR L126 OR L26A DEPENDING ON INDICATOR *  05710000
      *                                                              *  05720000
      ****************************************************************  05730000
           MOVE FUNCTION CURRENT-DATE TO WS5-CURRENT-DATE.                      
           MOVE WS5-CUR-DD            TO    WS5-PRT-DD.                 05760000
           MOVE WS5-CUR-MM            TO    WS5-PRT-MM.                 05770000
           MOVE WS5-CUR-CC            TO    WS5-PRT-CC.                 05780000
           MOVE WS5-CUR-YY            TO    WS5-PRT-YY.                 05780000
           MOVE WS5-PRT-DATE          TO    L126-HD1-DATE                       
           MOVE WS-DATE               TO    L126-HD3-DATE.                      
      *                                                                 05800000
           IF L126-HD1-RPT-ID = WS6-L126-RPT-ID AND                     05810000
              ((WS2-CNT-LINE-ON-L126 > WS6-MAX-LINES) OR                05320000
               (WS30-LAST-FIN-MM NOT = WS11-JOURN-MM) OR                        
               (WS30-LAST-FIN-CCYY NOT = WS11-JOURN-CCYY))                      
              MOVE  SPACES            TO    L126-PRINT-REC              05820001
              ADD   1                 TO    WS2-CNT-L126-PAGE           05740000
              MOVE  WS2-CNT-L126-PAGE TO    L126-HD1-PAGE-NO            05750000
                                                                                
              IF (F120-NUM-FLAT-TYPE-SA  = '1A' OR '2A') OR                     
                 (F120-CDE-VALID         = 'L')                                 
                 MOVE 'BP13L126'      TO    L126-HD1-RPT-ID                     
                 WRITE L126-PRINT-REC FROM  L126-PRT-HEAD-1 AFTER PAGE          
                 WRITE L126-PRINT-REC FROM  L126-PRT-HEAD-2A AFTER 2    05850001
              ELSE                                                              
                 IF (F120-NUM-FLAT-TYPE-SA  = '2F' OR '1F') AND                 
                    (F120-NUM-PP-SCHEDULE   > 0    AND                          
                     F120-NUM-PP-SCHEDULE  <= 60)                               
                    IF F120-NUM-VR-DDD = SPACES                                 
                       MOVE 'BP13L126-A'    TO   L126-HD1-RPT-ID                
                    ELSE                                                        
                       MOVE 'BP13L126-B'    TO   L126-HD1-RPT-ID                
                    END-IF                                                      
                    WRITE L126-PRINT-REC FROM L126-PRT-HEAD-1 AFTER PAGE        
                    WRITE L126-PRINT-REC FROM  L126-PRT-HEAD-2C AFTER 2 05850001
                 ELSE                                                           
                    MOVE 'BP13L126-C'    TO   L126-HD1-RPT-ID                   
                    WRITE L126-PRINT-REC FROM L126-PRT-HEAD-1 AFTER PAGE        
                    WRITE L126-PRINT-REC FROM  L126-PRT-HEAD-2B AFTER 2 05850001
                 END-IF                                                         
              END-IF                                                            
                                                                                
              WRITE L126-PRINT-REC    FROM  L126-PRT-HEAD-3 AFTER 3     05860001
              WRITE L126-PRINT-REC    FROM  L126-PRT-HEAD-4 AFTER 2     05870001
              WRITE L126-PRINT-REC    FROM  L126-PRT-HEAD-5 AFTER 2     05880001
              WRITE L126-PRINT-REC    FROM  L126-PRT-HEAD-6 AFTER 1     05881001
              MOVE  SPACES            TO    L126-PRINT-REC              05890001
                                            L126-HD1-RPT-ID             05900001
              WRITE L126-PRINT-REC    AFTER 2                           05910000
           ELSE                                                         05920000
              ADD   1                 TO    WS2-CNT-L26A-PAGE           05740000
              MOVE  WS2-CNT-L26A-PAGE TO    L126-HD1-PAGE-NO            05750000
              MOVE  SPACES            TO    L26A-PRINT-REC              05930001
                                                                                
              IF (F120-NUM-FLAT-TYPE-SA  = '1A' OR '2A') OR                     
                 (F120-CDE-VALID         = 'L')                                 
                 MOVE 'BP13L26A'      TO   L126-HD1-RPT-ID                      
                 WRITE L26A-PRINT-REC FROM  L126-PRT-HEAD-1 AFTER PAGE          
                 WRITE L26A-PRINT-REC FROM  L126-PRT-HEAD-2A AFTER 2    05960001
              ELSE                                                              
                 IF (F120-NUM-FLAT-TYPE-SA  = '2F' OR '1F') AND                 
                    (F120-NUM-PP-SCHEDULE   > 0    AND                          
                     F120-NUM-PP-SCHEDULE  <= 60)                               
                    IF F120-NUM-VR-DDD = SPACES                                 
                       MOVE 'BP13L26A-A'    TO   L126-HD1-RPT-ID                
                    ELSE                                                        
                       MOVE 'BP13L26A-B'    TO   L126-HD1-RPT-ID                
                    END-IF                                                      
                    WRITE L26A-PRINT-REC FROM L126-PRT-HEAD-1 AFTER PAGE        
                    WRITE L26A-PRINT-REC FROM  L126-PRT-HEAD-2C AFTER 2 05850001
                 ELSE                                                           
                    MOVE 'BP13L26A-C'    TO   L126-HD1-RPT-ID                   
                    WRITE L26A-PRINT-REC FROM L126-PRT-HEAD-1 AFTER PAGE        
                    WRITE L26A-PRINT-REC FROM  L126-PRT-HEAD-2B AFTER 2 05850001
                 END-IF                                                         
              END-IF                                                            
                                                                                
              WRITE L26A-PRINT-REC    FROM  L126-PRT-HEAD-3 AFTER 3     05970001
              WRITE L26A-PRINT-REC    FROM  L26A-PRT-HEAD-4 AFTER 2     05980001
              WRITE L26A-PRINT-REC    FROM  L26A-PRT-HEAD-5 AFTER 2     05990001
              WRITE L26A-PRINT-REC    FROM  L26A-PRT-HEAD-6 AFTER 1     05990001
              MOVE  SPACES            TO    L26A-PRINT-REC              06010001
                                            L126-HD1-RPT-ID             06020001
              WRITE L26A-PRINT-REC    AFTER 2.                          06030000
                                                                        06040000
       560-EXIT.                                                        06050000
           EXIT.                                                        06060000
                                                                                
      *                                                                         
       600-PRINT-TOTAL.                                                         
      *=========================*                                               
      ******************************************************************        
      *                                                                *        
      *       PRINT TOTAL FOR ALL TRANSACTIONS AND GRAND TOTAL         *        
      *         FOR DEBTI AND CREDIT AMOUNTS.                          *        
      *                                                                *        
      ******************************************************************        
      *                                                                         
      * IF SUBTOTAL NOT YET PRINTED - PRINT SUBTOTAL FIRST *                    
      *                                                                         
           IF WS4-SUBTOT-PRTED                                                  
              NEXT SENTENCE                                                     
           ELSE                                                                 
              PERFORM 550-PRINT-SUBTOT.                                         
      *                                                                         
           PERFORM 500-CHECK-LINECT.                                            
      *                                                                         
                                                                                
      *                                                                         
      * PRINT TOTAL FOR ALL TRANSACTIONS *                                      
      *                                                                         
           COMPUTE WS3-TOT-DRCR-AMT = WS3-TOT-DR-AMT +                          
                                      WS3-TOT-CR-AMT.                           
           IF WS3-TOT-DRCR-AMT > 0                                              
              MOVE 'CR' TO L126-TOT-DRCR                                        
           ELSE                                                                 
              MOVE 'DB' TO L126-TOT-DRCR.                                       
                                                                                
           MOVE  WS3-TOT-DRCR-AMT TO   L126-TOT-DRCR-AMT.                       
           ADD   3                TO   WS2-CNT-LINE-ON-L126.                    
      *    WRITE L126-PRINT-REC   FROM L126-PRT-TOT-HEAD                .       
      *                                AFTER 2.                         .       
           MOVE  SPACES           TO   L126-PRINT-REC.                          
      *                                                                         
      * PRINT GRAND TOTAL FOR DEBIT AND CREDIT AMOUNTS *                        
      *                                                                         
           ADD   4                TO   WS2-CNT-LINE-ON-L126.                    
           MOVE  WS3-TOT-DR-AMT   TO   L126-TOT-DR-AMT.                         
           WRITE L126-PRINT-REC   FROM L126-PRT-GRAND-TOTAL-HEAD-1      .       
                                       AFTER 3.                         .       
           MOVE  SPACES           TO   L126-PRINT-REC.                          
           MOVE  WS3-TOT-CR-AMT   TO   L126-TOT-CR-AMT.                         
           WRITE L126-PRINT-REC   FROM L126-PRT-GRAND-TOTAL-HEAD-2      .       
                                       AFTER 1.                         .       
           MOVE  SPACES           TO   L126-PRINT-REC.                          
                                                                                
      *==> PRINT SUB-TOTAL OF BREAK IN TRANS-DATE                               
           PERFORM 500-CHECK-LINECT.                                            
           WRITE L26A-PRINT-REC     FROM L26A-PRT-DASH1 AFTER 1         04850000
           MOVE WS-SUB-CASENO       TO   L26A-SUB-CASENO                        
           MOVE WS-SUB-AMT          TO   L26A-SUB-AMT.                          
           IF WS-SUB-AMT > 0                                                    
              MOVE 'CR'             TO   L26A-SUB-AMT-DRCR                      
           ELSE                                                                 
              MOVE 'DR'             TO   L26A-SUB-AMT-DRCR.                     
           WRITE L26A-PRINT-REC     FROM L26A-PRT-SUBTOT AFTER 1                
           ADD 2                    TO   WS2-CNT-LINE-ON-L26A.                  
      *==> PRINT SUB-TOTAL OF BREAK IN PAYMENT-TYPE                             
           PERFORM 500-CHECK-LINECT.                                            
           WRITE L26A-PRINT-REC     FROM L26A-PRT-DASH1 AFTER 1         04850000
           MOVE WS-PREV-PAYMENT-TYPE  TO L26A-SUB-PTYPE.                        
           MOVE WS-SUB-PTYPE-AMT    TO   L26A-SUB-PTYPE-AMT.                    
           IF WS-SUB-PTYPE-AMT > 0                                              
              MOVE 'CR'             TO   L26A-SUB-PTYPE-DRCR                    
           ELSE                                                                 
              MOVE 'DR'             TO   L26A-SUB-PTYPE-DRCR.                   
           WRITE L26A-PRINT-REC     FROM L26A-PRT-SUBPTYPE AFTER 1              
           ADD 2                    TO   WS2-CNT-LINE-ON-L26A.                  
      *==> PRINT GRAND-TOTAL OF BP13L26A-REC                                    
           PERFORM 500-CHECK-LINECT.                                            
           WRITE L26A-PRINT-REC     FROM L26A-PRT-DASH1 AFTER 1         04850000
           WRITE L26A-PRINT-REC     FROM L26A-PRT-SPACES AFTER 1                
           MOVE WS-GRD-CASENO       TO   L26A-GRD-CASENO                        
           MOVE WS-GRD-AMT          TO   L26A-GRD-AMT.                          
           IF WS-GRD-AMT > 0                                                    
              MOVE 'CR'             TO   L26A-GRD-AMT-DRCR                      
           ELSE                                                                 
              MOVE 'DR'             TO   L26A-GRD-AMT-DRCR.                     
           DISPLAY ' GRAND TOTAL - PR '      WS-GRD-AMT.                        
           WRITE L26A-PRINT-REC     FROM L26A-PRT-GRDTOT AFTER 1                
           WRITE L26A-PRINT-REC     FROM L26A-PRT-DASH2 AFTER 1.        04850000
      *                                                                         
       600-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *                                                                         
       900-CLOSE-ROUTINE SECTION.                                               
      *===========================*                                             
      ****************************************************************          
      *                                                              *          
      *            CLOSE FILES AND END PROCESSING                    *          
      *                                                              *          
      ****************************************************************          
           DISPLAY SPACES.                                                      
           DISPLAY ' ** BP13C126 ** '.                                          
           DISPLAY 'NO OF RECORDS READ FROM FILE (BP13F120)  = '                
                    WS2-CNT-F120-READ.                                          
           DISPLAY 'NO OF RECORDS PRINTED (BP13L126) = '                        
                    WS2-CNT-PRINT-L126.                                         
           DISPLAY 'NO OF RECORDS PRINTED (BP13L26A) = '                        
                    WS2-CNT-PRINT-L26A.                                         
                                                                                
           CLOSE BP13K800                                                       
                 BP13K893                                                       
                 BP13F120                                                       
                 SY02F001                                                       
                 BP13L126                                                       
                 BP13L26A.                                                      
                                                                                
           IF K800-STATUS NOT = 00 AND 97                                       
              MOVE K800-STATUS TO RETURN-CODE                                   
              DISPLAY 'CLOSING ERROR, K800-STATUS' K800-STATUS.                 
                                                                                
           IF K893-STATUS NOT = 00 AND 97                                       
              MOVE K893-STATUS TO RETURN-CODE                                   
              DISPLAY 'CLOSING ERROR, K893-STATUS' K893-STATUS.                 
                                                                                
           STOP RUN.                                                            
                                                                                
       900-EXIT.                                                                
           EXIT.                                                                
                                                                                
