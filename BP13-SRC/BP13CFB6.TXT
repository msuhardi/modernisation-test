       IDENTIFICATION DIVISION.                                         00010000
       PROGRAM-ID.    BP13CFB6.                                         00020000
       AUTHOR.        PP11.                                             00030000
       DATE-WRITTEN.  14-06-2022.                                       00040000
                                                                        00050000
      *************************************************************     00060000
      *        SYSTEM OF COMMITMENT               (BP13)          *     00070000
      *===========================================================*     00080000
      *                                                           *     00090000
      *  OBJECTIVE   : Generate XML files for FTP to send         *     00100000
      *                automated SMS                              *     00110000
      *                                                           *     00120000
      *  APPOINTMENT TYPE: BK BL BI BM BS DI BN DN K1-K3 K5-K7    *     00130000
      *                    L1-L3 L5-L7 PD W2 M1 M2 CI CN EI EN    *     00140004
      *                                                           *     00150000
      *  INPUT FILES  : BP13F203                                  *     00160000
      *               : SY02F001                                  *     00170000
      *                                                           *     00180000
      *                                                           *     00190000
      *                                                           *     00200000
      *  OUTPUT FILE  : BP13F203                                  *     00210000
      *                                                           *     00220000
      *-----------------------------------------------------------*     00230000
      *                                                           *     00240000
      * CHGE REQ #   DATE       AUTHOR    REMARKS                 *     00250000
      * ----------   --------   ------    -------                 *     00260000
      * BP138926     14062022   PP11      NEW PROGRAM             *     00270000
      * BP138926     30092022   PP11      Removed return code set *     00271000
      *                                   as 01                   *     00280000
      * BP138926     01102022   PP11      cater for date of       *     00280100
      *                                   appointment             *     00280200
      * BP138926     04102022   PP11      cater for w1 and c1     *     00280302
      * BP138342     18052023   MRR5      cater for M1 and M2     *     00280402
      * BP139611     11092023   MRR5      cater for CI and CN     *     00280503
      *                                                           *     00281000
      *************************************************************     00290000
                                                                        00300000
       ENVIRONMENT DIVISION.                                            00310000
                                                                        00320000
       CONFIGURATION SECTION.                                           00330000
                                                                        00340000
       SOURCE-COMPUTER. IBM-3090.                                       00350000
       OBJECT-COMPUTER. IBM-3090.                                       00360000
                                                                        00370000
       INPUT-OUTPUT SECTION.                                            00380000
                                                                        00390000
       FILE-CONTROL.                                                    00400000
                                                                        00410000
           SELECT SY02F001  ASSIGN        TO  SY02F001.                 00420000
                                                                        00430000
           SELECT B13DUMMY  ASSIGN        TO  B13DUMMY.                 00440000
                                                                        00450000
           SELECT BP13F203  ASSIGN        TO  BP13F203                  00460000
                            ORGANIZATION  IS SEQUENTIAL                 00470000
                            FILE STATUS   IS WS-BP13F203-STAT.          00480000
                                                                        00490000
           SELECT BP13K209  ASSIGN        TO BP13K209                   00500000
                            ACCESS MODE   IS RANDOM                     00510000
                            ORGANIZATION  IS INDEXED                    00520000
                            RECORD KEY    IS K209-KEY-FLD               00530000
                            FILE STATUS   IS WS-BP13K209-STAT.          00540000
                                                                        00550000
           SELECT B13F203A  ASSIGN        TO  B13F203A.                 00560000
           SELECT B13F203B  ASSIGN        TO  B13F203B.                 00570000
           SELECT B13F203C  ASSIGN        TO  B13F203C.                 00580000
           SELECT B13F203D  ASSIGN        TO  B13F203D.                 00590000
           SELECT B13F203E  ASSIGN        TO  B13F203E.                 00600000
                                                                        00610000
       DATA DIVISION.                                                   00620000
                                                                        00630000
       FILE SECTION.                                                    00640000
                                                                        00650000
       FD   B13F203A                    RECORD CONTAINS 2000 CHARACTERS 00660000
                                        RECORDING MODE IS F.            00670000
       01   B13F203A-REC                PIC X(2000).                    00680000
                                                                        00690000
       FD   B13F203B                    RECORD CONTAINS 2000 CHARACTERS 00700000
                                        RECORDING MODE IS F.            00710000
       01   B13F203B-REC                PIC X(2000).                    00720000
                                                                        00730000
       FD   B13F203C                    RECORD CONTAINS 2000 CHARACTERS 00740000
                                        RECORDING MODE IS F.            00750000
       01   B13F203C-REC                PIC X(2000).                    00760000
                                                                        00770000
       FD   B13F203D                    RECORD CONTAINS 2000 CHARACTERS 00780000
                                        RECORDING MODE IS F.            00790000
       01   B13F203D-REC                PIC X(2000).                    00800000
                                                                        00810000
       FD   B13F203E                    RECORD CONTAINS 2000 CHARACTERS 00820000
                                        RECORDING MODE IS F.            00830000
       01   B13F203E-REC                PIC X(2000).                    00840000
                                                                        00850000
       FD   B13DUMMY                    RECORD CONTAINS 20  CHARACTERS  00860000
                                        RECORDING MODE IS F.            00870000
       01   B13DUMMY-REC.                                               00880000
            05 B13DUMMY-NUM-MOBILE      PIC X(8).                       00890000
            05 FILLER                   PIC X(12).                      00900000
                                                                        00910000
       FD   BP13F203                    RECORD CONTAINS 200 CHARACTERS  00920000
                                        RECORDING MODE IS F.            00930000
       COPY BP13F203.                                                   00940000
                                                                        00950000
       FD   BP13K209                    RECORD CONTAINS 2000 CHARACTERS.00960000
                                                                        00970000
       COPY BP13K209.                                                   00980000
                                                                        00990000
       COPY SY02F001.                                                   01000000
                                                                        01010000
       WORKING-STORAGE SECTION.                                         01020000
                                                                        01030000
       01  WS-COUNTERS.                                                 01040000
           05  WS-CTR-BP13F203-READ      PIC 9(07) VALUE 0.             01050000
           05  WS-B13F203A-WRT           PIC 9(07) VALUE 0.             01060000
           05  WS-B13F203B-WRT           PIC 9(07) VALUE 0.             01070000
           05  WS-B13F203C-WRT           PIC 9(07) VALUE 0.             01080000
           05  WS-B13F203D-WRT           PIC 9(07) VALUE 0.             01090000
           05  WS-B13F203E-WRT           PIC 9(07) VALUE 0.             01100000
                                                                        01110000
       01  WS-VARIABLES.                                                01120000
           05  WS-BP13K993-STATUS        PIC 9(2)  VALUE 0.             01130000
           05  WS-BP13F203-EOF           PIC X(1)  VALUE  'N'.          01140000
           05  WS-BP13K209-STAT          PIC X(02) VALUE SPACES.        01150000
           05  WS-BP13F203-STAT          PIC X(02) VALUE SPACES.        01160000
           05  WS-DTE-BALLOT-YY          PIC X(06).                     01170000
           05  WS-DTE-BALLOT-CCYY        PIC X(08).                     01180000
           05  WS-B13DUMMY-EOF           PIC X(1)  VALUE  'N'.          01190000
           05  WS-DTE-CURRENT            PIC X(08).                     01200000
           05  WS-DAY-OF-WEEK            PIC X(3)  VALUE SPACES.        01210000
           05  WS-HOLIDAY                PIC X(3)  VALUE SPACES.        01220000
           05  WS-DTE-PROP-SEND.                                        01230000
               10 WS-DTE-PROP-SEND-CY    PIC X(4)  VALUE SPACES.        01240000
               10 WS-DTE-PROP-SEND-MM    PIC X(2)  VALUE SPACES.        01250000
               10 WS-DTE-PROP-SEND-DD    PIC X(2)  VALUE '15'.          01260000
           05  WS-NUM-TYPE               PIC X(12) VALUE '1STREM2TO4'.  01270000
           05  WS-SEND-LESSEE            PIC X     VALUE 'N'.           01280000
           05  WS-ALLO-MODE              PIC X(03) VALUE SPACES.        01290000
           05  WS-QUEUE-MSG              PIC X(05) VALUE SPACES.        01300000
           05  WS-BALLOT-MONTH           PIC X(04) VALUE SPACES.        01310000
           05  WS-APPT-DTE               PIC X(09) VALUE SPACES.        01320000
           05  WS-APPT-DTE-CCYY          PIC X(11) VALUE SPACES.        01321000
           05  WS-APPT-DTE-CCYY2         PIC X(10) VALUE SPACES.        01322000
           05  WS-APPT-TIME              PIC X(05) VALUE SPACES.        01330000
           05  WS-DATE                   PIC X(08) VALUE SPACES.        01331000
           05  WS-START                  PIC 9(05) VALUE ZEROES.        01340000
                                                                        01350000
       01  WS-BP13F203-REC.                                             01360000
           05  FILLER                    PIC X(5)                       01370000
                                         VALUE '<SMS>'.                 01380000
           05  FILLER                    PIC X(11)                      01390000
                                         VALUE '<AGENCYREF>'.           01400000
           05  WS-NUM-SMS                PIC 9(16)                      01410000
                                         VALUE ZEROES.                  01420000
           05  FILLER                    PIC X(12)                      01430000
                                         VALUE '</AGENCYREF>'.          01440000
           05  FILLER                    PIC X(06)                      01450000
                                         VALUE '<DEST>'.                01460000
           05  WS-NUM-MOBILE             PIC X(8)                       01470000
                                         VALUE SPACES.                  01480000
           05  FILLER                    PIC X(07)                      01490000
                                         VALUE '</DEST>'.               01500000
           05  FILLER                    PIC X(05)                      01510000
                                         VALUE '<MSG>'.                 01520000
           05  WS-SMS                    PIC X(1930).                   01530000
      *    05  FILLER                    PIC X(06)                      01540000
      *                                  VALUE '</MSG>'.                01550000
      *    05  FILLER                    PIC X(06)                      01560000
      *                                  VALUE '</SMS>'.                01570000
                                                                        01590000
       01  WS-BP13F203-REC-A.                                           01600000
           05  FILLER                    PIC X(5)                       01610000
                                         VALUE '<SMS>'.                 01620000
           05  FILLER                    PIC X(11)                      01630000
                                         VALUE '<AGENCYREF>'.           01640000
           05  WS-NUM-SMS-A              PIC 9(16)                      01650000
                                         VALUE ZEROES.                  01660000
           05  FILLER                    PIC X(12)                      01670000
                                         VALUE '</AGENCYREF>'.          01680000
           05  FILLER                    PIC X(06)                      01690000
                                         VALUE '<DEST>'.                01700000
           05  WS-NUM-MOBILE-A           PIC X(8)                       01710000
                                         VALUE SPACES.                  01720000
           05  FILLER                    PIC X(07)                      01730000
                                         VALUE '</DEST>'.               01740000
           05  FILLER                    PIC X(05)                      01750000
                                         VALUE '<MSG>'.                 01760000
           05  WS-SMS-A                  PIC X(1930).                   01770000
      *    05  FILLER                    PIC X(06)                      01780000
      *                                  VALUE '</MSG>'.                01790000
      *    05  FILLER                    PIC X(06)                      01800000
      *                                  VALUE '</SMS>'.                01810000
                                                                        01830000
       01  WS-MESSAGES.                                                 01840000
           05  WS-LESSEE-MSG             PIC X(1930) VALUE SPACES.      01850000
                                                                        01860000
           05  WS-START-SMS-MSG          PIC X(1918) VALUE              01870000
               'Automated SMS sending has started.'.                    01880000
           05  WS-END-SMS-MSG            PIC X(1918) VALUE              01890000
               'Automated SMS sending is finished.'.                    01900000
                                                                        01910000
       01  WS-XML-HEADER                 PIC X(2000) VALUE              01920000
               "<?xml version='1.0' encoding='UTF-8'?>".                01930000
       01  WS-XML-START                  PIC X(2000) VALUE              01940000
               '<SENDSMSBROADCASTREQ>'.                                 01950000
       01  WS-END-XML                    PIC X(2000) VALUE              01960000
               '</SENDSMSBROADCASTREQ>'.                                01970000
                                                                        01980000
       PROCEDURE DIVISION.                                              01990000
                                                                        02000000
      ***************************************************************   02010000
       0000-CONTROL.                                                    02020000
      ***************************************************************   02030000
                                                                        02040000
           PERFORM 1000-START-UP           THRU 1000-EXIT.              02050000
           PERFORM 4000-MAIN-ROUTINE       THRU 4000-EXIT               02060000
                   UNTIL WS-BP13F203-EOF = 'Y'.                         02070000
                                                                        02080000
           PERFORM 9999-WRAP-UP            THRU 9999-EXIT.              02090000
                                                                        02100000
                                                                        02110000
      ***************************************************************   02120000
       1000-START-UP.                                                   02130000
      ***************************************************************   02140000
                                                                        02150000
           OPEN INPUT  BP13F203                                         02160000
                       BP13K209                                         02170000
                       SY02F001                                         02180000
                OUTPUT B13F203A                                         02190000
                       B13F203B                                         02200000
                       B13F203C                                         02210000
                       B13F203D                                         02220000
                       B13F203E.                                        02230000
                                                                        02240000
      *----------------------------------                               02250000
      * Read current date from SY02F001                                 02260000
      *----------------------------------                               02270000
                                                                        02280000
           READ SY02F001.                                               02290000
           MOVE F001-DTE-CURRENT          TO  WS-DTE-CURRENT.           02300000
                                                                        02310000
           MOVE F001-DTE-CURRENT(1:4)     TO  WS-DTE-PROP-SEND-CY.      02320000
           MOVE F001-DTE-CURRENT(5:2)     TO  WS-DTE-PROP-SEND-MM.      02330000
                                                                        02340000
       1000-EXIT.                                                       02350000
            EXIT.                                                       02360000
                                                                        02370000
      ***************************************************************   02380000
       4000-MAIN-ROUTINE.                                               02390000
      ***************************************************************   02400000
                                                                        02410000
           PERFORM 5000-BP13F203-READ    THRU 5000-EXIT.                02420000
           PERFORM 6000-CHANGE-MSG-DTL   THRU 6000-EXIT.                02430000
           PERFORM 8000-WRITE-XML-FILE   THRU 8000-EXIT.                02440000
                                                                        02450000
       4000-EXIT.                                                       02460000
            EXIT.                                                       02470000
                                                                        02480000
      ***************************************************************   02490000
       5000-BP13F203-READ.                                              02500000
      ***************************************************************   02510000
                                                                        02520000
           READ BP13F203                                                02530000
                AT END                                                  02540000
                   MOVE 'Y'           TO   WS-BP13F203-EOF              02550000
                NOT AT END                                              02560000
                   CONTINUE                                             02561000
           END-READ.                                                    02562000
                                                                        02610000
           EVALUATE WS-BP13F203-STAT                                    02611000
             WHEN 00                                                    02612000
               ADD  1                  TO WS-CTR-BP13F203-READ          02612100
                                          WS-NUM-SMS                    02612200
                                                                        02612300
               PERFORM 5100-READ-BP13K209-MSG THRU 5100-EXIT            02612400
                                                                        02612500
             WHEN 10                                                    02615000
               MOVE 'Y'           TO   WS-BP13F203-EOF                  02616000
             WHEN OTHER                                                 02617000
               DISPLAY 'READ ERROR IN BP13F203'                         02618000
               MOVE WS-BP13F203-STAT    TO  RETURN-CODE                 02619000
               DISPLAY 'RETURN CODE: '      RETURN-CODE                 02619100
               PERFORM 9999-WRAP-UP         THRU 9999-EXIT              02619200
           END-EVALUATE.                                                02619400
                                                                        02619500
       5000-EXIT.                                                       02620000
           EXIT.                                                        02630000
                                                                        02640000
      *---------------------------------------------------------------  02650000
       5100-READ-BP13K209-MSG.                                          02660000
      *---------------------------------------------------------------  02670000
           MOVE F203-TYPE-APPMT  TO K209-KEY-FLD.                       02671000
                                                                        02680000
           READ BP13K209 KEY IS K209-KEY-FLD.                           02690000
           IF WS-BP13K209-STAT = 00                                     02700000
              PERFORM 5200-PASS-MSG  THRU 5200-EXIT                     02710000
                                                                        02720000
           ELSE                                                         02730000
               IF WS-BP13K209-STAT = 23                                 02740000
                  DISPLAY 'APPOINTMENT TYPE NOT FOUND : ' K209-KEY-FLD  02750000
                  MOVE WS-BP13K209-STAT TO RETURN-CODE                  02760000
                  GO TO 4000-EXIT                                       02770000
               ELSE                                                     02771000
                  DISPLAY 'BP13K209 READ ERROR : ' K209-KEY-FLD         02771100
                  MOVE WS-BP13K209-STAT TO RETURN-CODE                  02772000
                  GO TO 4000-EXIT                                       02773000
               END-IF                                                   02780000
           END-IF.                                                      02790000
                                                                        02800000
       5100-EXIT.                                                       02810000
           EXIT.                                                        02820000
                                                                        02830000
      *---------------------------------------------------------------  02840000
       5200-PASS-MSG.                                                   02850000
      *---------------------------------------------------------------  02860000
           PERFORM 5300-GET-F203-DETAILS      THRU 5300-EXIT.           02870000
                                                                        02880000
       5200-EXIT.                                                       02890000
           EXIT.                                                        02900000
                                                                        02910000
      *---------------------------------------------------------------  02920000
       5300-GET-F203-DETAILS.                                           02930000
      *---------------------------------------------------------------  02940000
           MOVE F203-NUM-HP          TO WS-NUM-MOBILE                   02950000
           MOVE F203-NUM-QUEUE       TO WS-QUEUE-MSG                    02960000
           MOVE K209-NUM-MSG         TO WS-LESSEE-MSG                   02970000
                                                                        02980000
           IF F203-NUM-ALLO-MODE NOT = SPACES AND LOW-VALUES AND ZEROES 02990000
              MOVE F203-NUM-ALLO-MODE  TO WS-ALLO-MODE                  03000000
           END-IF.                                                      03010000
                                                                        03020000
           PERFORM 5360-GET-DATE-BALLOT   THRU 5360-EXIT                03040000
                                                                        03050000
           IF F203-TYPE-APPMT = 'BK' OR 'BL' OR 'BS'                    03060000
              MOVE F203-DTE-APPMT              TO WS-DATE               03060100
                                                                        03060200
              PERFORM 5350-GET-BALLOT-MONTH  THRU 5350-EXIT             03061000
                                                                        03062000
              STRING F203-DTE-APPMT(7:2) ' '                            03070000
                     WS-BALLOT-MONTH                                    03080000
                     F203-DTE-APPMT(3:2)                                03090000
                     DELIMITED BY SIZE                                  03100000
                INTO WS-APPT-DTE                                        03110000
           END-IF.                                                      03120000
                                                                        03120100
           IF F203-TYPE-APPMT = 'PD' OR 'SA' OR 'TP' OR 'SP' OR         03121000
                                'SR' OR 'SE'                            03121100
              STRING F203-DTE-APPMT(7:2) '/'                            03122000
                     F203-DTE-APPMT(5:2) '/'                            03123000
                     F203-DTE-APPMT(1:4)                                03124000
                     DELIMITED BY SIZE                                  03125000
                INTO WS-APPT-DTE-CCYY2                                  03126000
           END-IF.                                                      03127000
                                                                        03128000
           IF F203-TYPE-APPMT = 'BI' OR 'BM' OR 'BN' OR 'DI' OR 'W1' OR 03130000
                                'DN' OR 'K1' OR 'K5' OR 'L1' OR 'L5' OR 03140002
                                'M1' OR 'M2' OR 'CI' OR 'CN' OR 'EI' OR 03140104
                                'EN'                                    03140204
                                                                        03140304
              MOVE F203-DTE-APPMT              TO WS-DATE               03141000
                                                                        03142000
              PERFORM 5350-GET-BALLOT-MONTH  THRU 5350-EXIT             03150000
                                                                        03151000
              STRING F203-DTE-APPMT(7:2) ' '                            03160000
                     WS-BALLOT-MONTH                                    03170000
                     F203-DTE-APPMT(1:4)                                03180000
                     DELIMITED BY SIZE                                  03190000
                INTO WS-APPT-DTE-CCYY                                   03200000
           END-IF.                                                      03210000
                                                                        03211000
           IF F203-TME-APPMT NOT = SPACES AND LOW-VALUES AND ZEROES     03220000
                                                                        03221000
              STRING F203-TME-APPMT(1:2) ':'                            03230000
                     F203-TME-APPMT(3:2)                                03240000
                     DELIMITED BY SIZE                                  03250000
                INTO WS-APPT-TIME                                       03260000
           END-IF.                                                      03270000
                                                                        03280000
       5300-EXIT.                                                       03290000
           EXIT.                                                        03300000
                                                                        03310000
                                                                        03320000
      *---------------------------------------------------------------  03330000
       5350-GET-BALLOT-MONTH.                                           03340000
      *---------------------------------------------------------------  03350000
                                                                        03360000
           EVALUATE WS-DATE(5:2)                                        03370000
             WHEN '01'                                                  03380000
               MOVE 'Jan'             TO WS-BALLOT-MONTH                03390000
             WHEN '02'                                                  03400000
               MOVE 'Feb'             TO WS-BALLOT-MONTH                03410000
             WHEN '03'                                                  03420000
               MOVE 'Mar'             TO WS-BALLOT-MONTH                03430000
             WHEN '04'                                                  03440000
               MOVE 'Apr'             TO WS-BALLOT-MONTH                03450000
             WHEN '05'                                                  03460000
               MOVE 'May'             TO WS-BALLOT-MONTH                03470000
             WHEN '06'                                                  03480000
               MOVE 'Jun'             TO WS-BALLOT-MONTH                03490000
             WHEN '07'                                                  03500000
               MOVE 'Jul'             TO WS-BALLOT-MONTH                03510000
             WHEN '08'                                                  03520000
               MOVE 'Aug'             TO WS-BALLOT-MONTH                03530000
             WHEN '09'                                                  03540000
               MOVE 'Sep'             TO WS-BALLOT-MONTH                03550000
             WHEN '10'                                                  03560000
               MOVE 'Oct'             TO WS-BALLOT-MONTH                03570000
             WHEN '11'                                                  03580000
               MOVE 'Nov'             TO WS-BALLOT-MONTH                03590000
             WHEN '12'                                                  03600000
               MOVE 'Dec'             TO WS-BALLOT-MONTH                03610000
           END-EVALUATE.                                                03620000
                                                                        03630000
       5350-EXIT.                                                       03640000
           EXIT.                                                        03650000
                                                                        03660000
      *---------------------------------------------------------------  03670000
       5360-GET-DATE-BALLOT.                                            03680000
      *---------------------------------------------------------------  03690000
                                                                        03700000
           IF F203-DTE-BALLOT NOT = SPACES AND LOW-VALUES AND ZEROES    03710000
                                                                        03720000
              MOVE F203-DTE-BALLOT             TO WS-DATE               03721000
                                                                        03721100
              PERFORM 5350-GET-BALLOT-MONTH  THRU 5350-EXIT             03722000
                                                                        03723000
              STRING WS-BALLOT-MONTH                                    03730000
                     F203-DTE-BALLOT(3:2)                               03740000
                     DELIMITED BY SIZE                                  03750000
                INTO WS-DTE-BALLOT-YY                                   03760000
                                                                        03770000
              STRING WS-BALLOT-MONTH                                    03780000
                     F203-DTE-BALLOT(1:4)                               03790000
                     DELIMITED BY SIZE                                  03800000
                INTO WS-DTE-BALLOT-CCYY                                 03810000
           END-IF.                                                      03820000
                                                                        03830000
       5360-EXIT.                                                       03840000
           EXIT.                                                        03850000
                                                                        03860000
      *---------------------------------------------------------------  03870000
       6000-CHANGE-MSG-DTL.                                             03880000
      *---------------------------------------------------------------  03890000
           IF F203-TYPE-APPMT = 'BK' OR 'BL' OR 'BS'                    03900000
              IF F203-TYPE-APPMT = 'BK'                                 03910000
                 PERFORM 6100-CHG-BALLOT-DTE-YY     THRU 6100-EXIT      03920000
                 PERFORM 6300-CHG-SEL-TYPE          THRU 6300-EXIT      03921000
              END-IF                                                    03930000
              PERFORM 6500-CHG-APPT-DTE-BK       THRU 6500-EXIT         03940000
              PERFORM 6600-CHG-APPT-TME          THRU 6600-EXIT         03950000
           END-IF.                                                      03960000
           IF F203-TYPE-APPMT = 'BI' OR 'BM' OR 'BN' OR 'DI' OR         03970000
                                'DN' OR 'K1' OR 'K5' OR 'L1' OR         03980000
                                'L5' OR 'M1' OR 'M2' OR 'CI' OR         03990004
                                'CN' OR 'EI' OR 'EN'                    03991004
              IF F203-TYPE-APPMT = 'BI' OR 'BN' OR 'DI' OR 'DN' OR      04000000
                                   'K1' OR 'K5' OR 'L1' OR 'L5' OR      04010002
                                   'M1' OR 'M2' OR 'CI' OR 'CN' OR      04011004
                                   'EI' OR 'EN'                         04012004
                 PERFORM 6200-CHG-BALLOT-DTE-CCYY   THRU 6200-EXIT      04020000
                 PERFORM 6300-CHG-SEL-TYPE          THRU 6300-EXIT      04021000
              END-IF                                                    04030000
              PERFORM 6350-CHG-APPT-DTE-BI       THRU 6350-EXIT         04050000
              PERFORM 6600-CHG-APPT-TME          THRU 6600-EXIT         04060000
           END-IF.                                                      04070000
                                                                        04080000
           IF F203-TYPE-APPMT = 'SA' OR 'TP' OR 'SP' OR 'SR' OR         04080100
                                'SE'                                    04080200
              PERFORM 6400-CHG-APPT-DTE          THRU 6400-EXIT         04080300
              PERFORM 6600-CHG-APPT-TME          THRU 6600-EXIT         04080400
           END-IF.                                                      04080500
                                                                        04080600
           IF F203-TYPE-APPMT = 'PD'                                    04081000
              PERFORM 6400-CHG-APPT-DTE          THRU 6400-EXIT         04082000
           END-IF.                                                      04083000
                                                                        04084000
           IF F203-TYPE-APPMT = 'W1'                                    04084100
                PERFORM 6450-CHG-APPT-DTE-W1       THRU 6450-EXIT       04084200
           END-IF.                                                      04084300
                                                                        04084400
           IF F203-TYPE-APPMT = 'P6' OR 'PY'                            04085000
              PERFORM 6700-CHG-REGN              THRU 6700-EXIT         04086000
           END-IF.                                                      04087000
                                                                        04088000
           IF F203-TYPE-APPMT = 'C1'                                    04089000
              PERFORM 6750-CHG-BOOK-PD           THRU 6750-EXIT         04089100
           END-IF.                                                      04089200
           PERFORM 6800-APPND-CLOSE-TAG   THRU 6800-EXIT.               04089300
       6000-EXIT.                                                       04090000
           EXIT.                                                        04100000
                                                                        04110000
      *---------------------------------------------------------------  04120000
       6100-CHG-BALLOT-DTE-YY.                                          04130000
      *---------------------------------------------------------------  04140000
           MOVE ZEROES              TO WS-START.                        04150000
           PERFORM VARYING WS-START FROM 1 BY 1 UNTIL WS-START > 1930   04160000
              IF WS-LESSEE-MSG(WS-START:6) = 'BLTDTE'                   04170000
                 MOVE WS-DTE-BALLOT-YY TO WS-LESSEE-MSG(WS-START:6)     04180000
                 MOVE 1931             TO WS-START                      04190000
              END-IF                                                    04200000
           END-PERFORM.                                                 04210000
                                                                        04220000
       6100-EXIT.                                                       04230000
           EXIT.                                                        04240000
                                                                        04250000
      *---------------------------------------------------------------  04260000
       6200-CHG-BALLOT-DTE-CCYY.                                        04270000
      *---------------------------------------------------------------  04280000
           MOVE ZEROES              TO WS-START.                        04290000
           PERFORM VARYING WS-START FROM 1 BY 1 UNTIL WS-START > 1930   04300000
              IF WS-LESSEE-MSG(WS-START:8) = 'BLTDCCYY'                 04310000
                 MOVE WS-DTE-BALLOT-CCYY TO WS-LESSEE-MSG(WS-START:8)   04320000
                 MOVE 1931               TO WS-START                    04330000
              END-IF                                                    04340000
           END-PERFORM.                                                 04350000
                                                                        04360000
       6200-EXIT.                                                       04370000
           EXIT.                                                        04380000
                                                                        04390000
      *---------------------------------------------------------------  04400000
       6300-CHG-SEL-TYPE.                                               04410000
      *---------------------------------------------------------------  04420000
           MOVE ZEROES              TO WS-START.                        04430000
           PERFORM VARYING WS-START FROM 1 BY 1 UNTIL WS-START > 1930   04440000
              IF WS-LESSEE-MSG(WS-START:3) = 'SEL'                      04450000
                 MOVE WS-ALLO-MODE  TO WS-LESSEE-MSG(WS-START:3)        04460000
                 MOVE 1931          TO WS-START                         04470000
              END-IF                                                    04480000
           END-PERFORM.                                                 04490000
                                                                        04500000
       6300-EXIT.                                                       04510000
           EXIT.                                                        04520000
                                                                        04530000
      *---------------------------------------------------------------  04530100
       6350-CHG-APPT-DTE-BI.                                            04531000
      *---------------------------------------------------------------  04532000
                                                                        04533000
           MOVE ZEROES         TO WS-START.                             04534000
           PERFORM VARYING WS-START FROM 1 BY 1 UNTIL WS-START > 1930   04535000
              IF WS-LESSEE-MSG(WS-START:11) = 'DD/MMM/CCYY'             04536000
                 MOVE WS-APPT-DTE-CCYY  TO WS-LESSEE-MSG(WS-START:11)   04537000
                 MOVE 1931              TO WS-START                     04538000
              END-IF                                                    04539000
           END-PERFORM.                                                 04539100
                                                                        04539200
       6350-EXIT.                                                       04539300
           EXIT.                                                        04539400
                                                                        04539500
      *---------------------------------------------------------------  04540000
       6400-CHG-APPT-DTE.                                               04550000
      *---------------------------------------------------------------  04560000
                                                                        04570000
           MOVE ZEROES         TO WS-START.                             04580000
           PERFORM VARYING WS-START FROM 1 BY 1 UNTIL WS-START > 1930   04590000
              IF WS-LESSEE-MSG(WS-START:10) = 'DD/MM/CCYY'              04600000
                 MOVE WS-APPT-DTE-CCYY2 TO WS-LESSEE-MSG(WS-START:10)   04610000
                 MOVE 1931              TO WS-START                     04620000
              END-IF                                                    04630000
           END-PERFORM.                                                 04640000
                                                                        04650000
       6400-EXIT.                                                       04660000
           EXIT.                                                        04670000
                                                                        04680000
      *---------------------------------------------------------------  04681000
       6450-CHG-APPT-DTE-W1.                                            04682000
      *---------------------------------------------------------------  04683000
            MOVE ZEROES         TO WS-START.                            04684000
            PERFORM VARYING WS-START FROM 1 BY 1 UNTIL WS-START > 1930  04685000
               IF WS-LESSEE-MSG(WS-START:8) = 'DDMMCCYY'                04686000
                 STRING F203-DTE-BOOK-PD-END(7:2)                       04687100
                        F203-DTE-BOOK-PD-END(5:2)                       04687200
                        F203-DTE-BOOK-PD-END(1:4)                       04687300
                        DELIMITED BY SIZE INTO                          04687400
                                       WS-LESSEE-MSG(WS-START:8)        04687500
                  MOVE 1931              TO WS-START                    04688000
               END-IF                                                   04689000
            END-PERFORM.                                                04689100
                                                                        04689200
       6450-EXIT.                                                       04689300
           EXIT.                                                        04689400
                                                                        04689500
      *---------------------------------------------------------------  04690000
       6500-CHG-APPT-DTE-BK.                                            04700000
      *---------------------------------------------------------------  04710000
                                                                        04720000
           MOVE ZEROES         TO WS-START.                             04730000
           PERFORM VARYING WS-START FROM 1 BY 1 UNTIL WS-START > 1930   04740000
              IF WS-LESSEE-MSG(WS-START:9) = 'DD/MMM/YY'                04750000
                 MOVE WS-APPT-DTE  TO WS-LESSEE-MSG(WS-START:9)         04760000
                 MOVE 1931         TO WS-START                          04770000
              END-IF                                                    04780000
           END-PERFORM.                                                 04790000
                                                                        04800000
       6500-EXIT.                                                       04810000
           EXIT.                                                        04820000
                                                                        04830000
      *---------------------------------------------------------------  04841000
       6600-CHG-APPT-TME.                                               04850000
      *---------------------------------------------------------------  04851000
                                                                        04870000
           MOVE ZEROES         TO WS-START.                             04880000
           PERFORM VARYING WS-START FROM 1 BY 1 UNTIL WS-START > 1930   04890000
              IF WS-LESSEE-MSG(WS-START:5) = 'HH:MM'                    04900000
                 MOVE WS-APPT-TIME TO WS-LESSEE-MSG(WS-START:5)         04910000
                 MOVE 1931         TO WS-START                          04920000
              END-IF                                                    04930000
           END-PERFORM.                                                 04940000
                                                                        04950000
       6600-EXIT.                                                       04960000
           EXIT.                                                        04970000
                                                                        04980000
      *---------------------------------------------------------------  04990100
       6700-CHG-REGN.                                                   04990200
      *---------------------------------------------------------------  04990300
                                                                        04990500
           MOVE ZEROES              TO WS-START.                        04990600
           PERFORM VARYING WS-START FROM 1 BY 1 UNTIL WS-START > 1930   04990700
              IF WS-LESSEE-MSG(WS-START:8) = 'XXXXREGN'                 04990800
                 ADD 4              TO WS-START                         04990900
                 MOVE F203-NUM-REGN(5:4)                                04991000
                                    TO WS-LESSEE-MSG(WS-START:4)        04991100
                 MOVE 1931          TO WS-START                         04991200
              END-IF                                                    04991300
           END-PERFORM.                                                 04991400
                                                                        04991500
       6700-EXIT.                                                       04991600
           EXIT.                                                        04991700
                                                                        04991800
      *---------------------------------------------------------------  04992000
       6750-CHG-BOOK-PD.                                                04992100
      *---------------------------------------------------------------  04992200
                                                                        04992300
           MOVE F203-DTE-BOOK-PD-END        TO WS-DATE                  04992400
                                                                        04992500
           PERFORM 5350-GET-BALLOT-MONTH  THRU 5350-EXIT                04992600
                                                                        04992700
           MOVE ZEROES              TO WS-START.                        04992800
           PERFORM VARYING WS-START FROM 1 BY 1 UNTIL WS-START > 1930   04992900
              IF WS-LESSEE-MSG(WS-START:11) = 'DD MMM YYYY'             04993000
                 STRING F203-DTE-BOOK-PD-END(7:2) ' '                   04993100
                        WS-BALLOT-MONTH                                 04993200
                        F203-DTE-BOOK-PD-END(1:4)                       04993300
                        DELIMITED BY SIZE INTO                          04993400
                                       WS-LESSEE-MSG(WS-START:11)       04993500
                 MOVE 1931           TO WS-START                        04993600
              END-IF                                                    04993700
           END-PERFORM.                                                 04993800
                                                                        04993900
       6750-EXIT.                                                       04994000
           EXIT.                                                        04994100
                                                                        04994200
      *---------------------------------------------------------------  04994300
       6800-APPND-CLOSE-TAG.                                            04994400
      *---------------------------------------------------------------  04994500
                                                                        04994600
           MOVE ZEROES              TO WS-START.                        04994700
           PERFORM VARYING WS-START FROM 1 BY 1 UNTIL WS-START > 1930   04994800
              IF WS-LESSEE-MSG(WS-START:12) = '            '            04994900
                 STRING '</MSG></SMS>'                                  04995000
                        DELIMITED BY SIZE INTO                          04995100
                                       WS-LESSEE-MSG(WS-START:12)       04995200
                 MOVE 1931           TO WS-START                        04995300
              END-IF                                                    04995400
           END-PERFORM.                                                 04995500
                                                                        04995600
       6800-EXIT.                                                       04995700
           EXIT.                                                        04995800
                                                                        04995900
      *---------------------------------------------------------------  04996000
       8000-WRITE-XML-FILE.                                             05000000
      *---------------------------------------------------------------  05001000
                                                                        05020000
            IF WS-NUM-SMS >     0 AND WS-NUM-SMS <=  2000               05030000
               PERFORM 8100-WRITE-B13F203A      THRU 8100-EXIT          05040000
            ELSE IF WS-NUM-SMS >  2000 AND WS-NUM-SMS <=  4000          05050000
               PERFORM 8200-WRITE-B13F203B      THRU 8200-EXIT          05060000
            ELSE IF WS-NUM-SMS >  4000 AND WS-NUM-SMS <=  6000          05070000
               PERFORM 8300-WRITE-B13F203C      THRU 8300-EXIT          05080000
            ELSE IF WS-NUM-SMS >  6000 AND WS-NUM-SMS <=  8000          05090000
               PERFORM 8400-WRITE-B13F203D      THRU 8400-EXIT          05100000
            ELSE IF WS-NUM-SMS >  8000 AND WS-NUM-SMS <= 10000          05110000
               PERFORM 8500-WRITE-B13F203E      THRU 8500-EXIT          05120000
            END-IF.                                                     05130000
                                                                        05140000
       8000-EXIT.                                                       05150000
            EXIT.                                                       05160000
                                                                        05170000
      *---------------------------------------------------------------  05181000
       8100-WRITE-B13F203A.                                             05190000
      *---------------------------------------------------------------  05191000
                                                                        05210000
           IF WS-BP13F203-EOF = 'Y'                                     05220000
              IF WS-NUM-SMS > 0                                         05230000
                 ADD 1                     TO WS-NUM-SMS                05240000
                 MOVE 'N'                  TO WS-SEND-LESSEE            05250000
                 MOVE WS-END-SMS-MSG       TO WS-SMS-A                  05260000
                 PERFORM 8700-WRITE-DUMMY-HP THRU 8700-EXIT             05270000
                 WRITE B13F203A-REC        FROM WS-END-XML              05280000
              END-IF                                                    05290000
              GO TO 8100-EXIT                                           05300000
           END-IF.                                                      05310000
                                                                        05320000
           IF WS-B13F203A-WRT = 0                                       05330000
              WRITE B13F203A-REC        FROM WS-XML-HEADER              05340000
              WRITE B13F203A-REC        FROM WS-XML-START               05350000
                                                                        05360000
      *-------------------------------*                                 05370000
      * WRITE DUMMY RECORD            *                                 05380000
      *-------------------------------*                                 05390000
      * Notify start of sms sending   *                                 05400000
      *-------------------------------*                                 05410000
              MOVE 'N'                  TO WS-SEND-LESSEE               05420000
              MOVE WS-START-SMS-MSG     TO WS-SMS-A                     05430000
              PERFORM 8700-WRITE-DUMMY-HP THRU 8700-EXIT                05440000
                                                                        05450000
      *-------------------------------*                                 05460000
      * Send text msg sent to lessees *                                 05470000
      *-------------------------------*                                 05480000
              MOVE 'Y'                  TO WS-SEND-LESSEE               05490000
              MOVE WS-LESSEE-MSG        TO WS-SMS                       05500000
              PERFORM 8700-WRITE-DUMMY-HP THRU 8700-EXIT                05510000
                                                                        05520000
              MOVE F203-NUM-HP          TO WS-NUM-MOBILE                05530000
              MOVE F203-NUM-QUEUE       TO WS-QUEUE-MSG                 05540000
           END-IF.                                                      05550000
                                                                        05560000
           MOVE WS-LESSEE-MSG        TO WS-SMS                          05570000
           WRITE B13F203A-REC        FROM WS-BP13F203-REC               05580000
           ADD 1                     TO WS-B13F203A-WRT.                05590000
                                                                        05600000
           IF WS-B13F203A-WRT = 2000                                    05610000
              WRITE B13F203A-REC        FROM WS-END-XML.                05620000
                                                                        05630000
       8100-EXIT.                                                       05640000
           EXIT.                                                        05650000
                                                                        05660000
      *---------------------------------------------------------------  05671000
       8200-WRITE-B13F203B.                                             05680000
      *---------------------------------------------------------------  05681000
                                                                        05700000
           IF WS-BP13F203-EOF = 'Y'                                     05710000
              IF WS-NUM-SMS > 0                                         05720000
                 ADD 1                     TO WS-NUM-SMS                05730000
                 MOVE 'N'                  TO WS-SEND-LESSEE            05740000
                 MOVE WS-END-SMS-MSG       TO WS-SMS-A                  05750000
                 PERFORM 8700-WRITE-DUMMY-HP THRU 8700-EXIT             05760000
                 MOVE B13DUMMY-NUM-MOBILE  TO WS-NUM-MOBILE             05770000
                 WRITE B13F203B-REC        FROM WS-END-XML              05780000
              END-IF                                                    05790000
              GO TO 8200-EXIT                                           05800000
           END-IF.                                                      05810000
                                                                        05820000
           IF WS-B13F203B-WRT = 0                                       05830000
              WRITE B13F203B-REC        FROM WS-XML-HEADER              05840000
              WRITE B13F203B-REC        FROM WS-XML-START               05850000
           END-IF.                                                      05860000
                                                                        05870000
           MOVE F203-NUM-HP          TO WS-NUM-MOBILE                   05880000
           MOVE F203-NUM-QUEUE       TO WS-QUEUE-MSG                    05890000
           MOVE WS-LESSEE-MSG        TO WS-SMS                          05900000
           WRITE B13F203B-REC        FROM WS-BP13F203-REC               05910000
           ADD 1                     TO WS-B13F203B-WRT.                05920000
                                                                        05930000
           IF WS-B13F203B-WRT = 2000                                    05940000
              WRITE B13F203B-REC        FROM WS-END-XML.                05950000
                                                                        05960000
       8200-EXIT.                                                       05970000
           EXIT.                                                        05980000
                                                                        05990000
      *---------------------------------------------------------------  06001000
       8300-WRITE-B13F203C.                                             06010000
      *---------------------------------------------------------------  06011000
                                                                        06030000
           IF WS-BP13F203-EOF = 'Y'                                     06040000
              IF WS-NUM-SMS > 0                                         06050000
                 ADD 1                     TO WS-NUM-SMS                06060000
                 MOVE 'N'                  TO WS-SEND-LESSEE            06070000
                 MOVE WS-END-SMS-MSG       TO WS-SMS-A                  06080000
                 PERFORM 8700-WRITE-DUMMY-HP THRU 8700-EXIT             06090000
                 WRITE B13F203C-REC        FROM WS-END-XML              06100000
              END-IF                                                    06110000
              GO TO 8300-EXIT                                           06120000
           END-IF.                                                      06130000
                                                                        06140000
           IF WS-B13F203C-WRT = 0                                       06150000
              WRITE B13F203C-REC        FROM WS-XML-HEADER              06160000
              WRITE B13F203C-REC        FROM WS-XML-START               06170000
           END-IF.                                                      06180000
                                                                        06190000
           MOVE F203-NUM-HP          TO WS-NUM-MOBILE                   06200000
           MOVE F203-NUM-QUEUE       TO WS-QUEUE-MSG                    06210000
           MOVE WS-LESSEE-MSG        TO WS-SMS                          06220000
           WRITE B13F203C-REC        FROM WS-BP13F203-REC               06230000
           ADD 1                     TO WS-B13F203C-WRT.                06240000
                                                                        06250000
           IF WS-B13F203C-WRT = 2000                                    06260000
              WRITE B13F203C-REC        FROM WS-END-XML.                06270000
                                                                        06280000
       8300-EXIT.                                                       06290000
           EXIT.                                                        06300000
                                                                        06310000
      *---------------------------------------------------------------  06321000
       8400-WRITE-B13F203D.                                             06330000
      *---------------------------------------------------------------  06331000
                                                                        06350000
           IF WS-BP13F203-EOF = 'Y'                                     06360000
              IF WS-NUM-SMS > 0                                         06370000
                 ADD 1                     TO WS-NUM-SMS                06380000
                 MOVE 'N'                  TO WS-SEND-LESSEE            06390000
                 MOVE WS-END-SMS-MSG       TO WS-SMS-A                  06400000
                 PERFORM 8700-WRITE-DUMMY-HP THRU 8700-EXIT             06410000
                 WRITE B13F203D-REC        FROM WS-END-XML              06420000
              END-IF                                                    06430000
              GO TO 8400-EXIT                                           06440000
           END-IF.                                                      06450000
                                                                        06460000
           IF WS-B13F203D-WRT = 0                                       06470000
              WRITE B13F203D-REC        FROM WS-XML-HEADER              06480000
              WRITE B13F203D-REC        FROM WS-XML-START               06490000
           END-IF.                                                      06500000
                                                                        06510000
           MOVE F203-NUM-HP          TO WS-NUM-MOBILE                   06520000
           MOVE F203-NUM-QUEUE       TO WS-QUEUE-MSG                    06530000
           MOVE WS-LESSEE-MSG        TO WS-SMS                          06540000
           WRITE B13F203D-REC        FROM WS-BP13F203-REC               06550000
           ADD 1                     TO WS-B13F203D-WRT.                06560000
                                                                        06570000
           IF WS-B13F203D-WRT = 2000                                    06580000
              WRITE B13F203D-REC        FROM WS-END-XML.                06590000
                                                                        06600000
       8400-EXIT.                                                       06610000
           EXIT.                                                        06620000
                                                                        06630000
      ****************************************************************  06640000
       8500-WRITE-B13F203E.                                             06650000
      ****************************************************************  06660000
                                                                        06670000
           IF WS-BP13F203-EOF = 'Y'                                     06680000
              IF WS-NUM-SMS > 0                                         06690000
                 ADD 1                     TO WS-NUM-SMS                06700000
                 MOVE 'N'                  TO WS-SEND-LESSEE            06710000
                 MOVE WS-END-SMS-MSG       TO WS-SMS-A                  06720000
                 PERFORM 8700-WRITE-DUMMY-HP THRU 8700-EXIT             06730000
                 WRITE B13F203E-REC        FROM WS-END-XML              06740000
              END-IF                                                    06750000
              GO TO 8500-EXIT                                           06760000
           END-IF.                                                      06770000
                                                                        06780000
           IF WS-B13F203E-WRT = 0                                       06790000
              WRITE B13F203E-REC        FROM WS-XML-HEADER              06800000
              WRITE B13F203E-REC        FROM WS-XML-START               06810000
           END-IF.                                                      06820000
                                                                        06830000
           MOVE F203-NUM-HP          TO WS-NUM-MOBILE                   06840000
           MOVE F203-NUM-QUEUE       TO WS-QUEUE-MSG                    06850000
           MOVE WS-LESSEE-MSG        TO WS-SMS                          06860000
           WRITE B13F203E-REC        FROM WS-BP13F203-REC               06870000
           ADD 1                     TO WS-B13F203E-WRT.                06880000
                                                                        06890000
           IF WS-B13F203E-WRT = 2000                                    06900000
              WRITE B13F203E-REC        FROM WS-END-XML.                06910000
                                                                        06920000
       8500-EXIT.                                                       06930000
           EXIT.                                                        06940000
                                                                        06950000
      ****************************************************************  06960000
       8700-WRITE-DUMMY-HP.                                             06970000
      ****************************************************************  06980000
                                                                        06990000
           MOVE 'N'                     TO WS-B13DUMMY-EOF.             07000000
           OPEN INPUT B13DUMMY.                                         07010000
                                                                        07020000
           PERFORM 8710-WRITE-DUMMY          THRU 8710-EXIT             07030000
                   UNTIL WS-B13DUMMY-EOF = 'Y'.                         07040000
                                                                        07050000
           CLOSE B13DUMMY.                                              07060000
                                                                        07070000
       8700-EXIT.                                                       07080000
           EXIT.                                                        07090000
                                                                        07100000
      ****************************************************************  07110000
       8710-WRITE-DUMMY.                                                07120000
      ****************************************************************  07130000
                                                                        07140000
           READ B13DUMMY                                                07150000
                AT END                                                  07160000
                   MOVE 'Y'            TO WS-B13DUMMY-EOF               07170000
                   GO TO 8710-EXIT.                                     07180000
                                                                        07190000
                                                                        07200000
           IF WS-SEND-LESSEE = 'N'                                      07210000
              MOVE B13DUMMY-NUM-MOBILE  TO WS-NUM-MOBILE-A              07220000
           ELSE                                                         07230000
              MOVE B13DUMMY-NUM-MOBILE  TO WS-NUM-MOBILE                07240000
           END-IF.                                                      07250000
                                                                        07260000
           IF WS-SEND-LESSEE = 'N'                                      07270000
              IF WS-NUM-SMS >     0 AND WS-NUM-SMS <=  2000             07280000
                  MOVE WS-NUM-SMS       TO WS-NUM-SMS-A                 07290000
                  WRITE B13F203A-REC    FROM WS-BP13F203-REC-A          07300000
                  ADD 1                 TO WS-B13F203A-WRT              07310000
              ELSE IF WS-NUM-SMS >  2000 AND WS-NUM-SMS <=  4000        07320000
                  MOVE WS-NUM-SMS       TO WS-NUM-SMS-A                 07330000
                  WRITE B13F203B-REC    FROM WS-BP13F203-REC-A          07340000
                  ADD 1                 TO WS-B13F203B-WRT              07350000
              ELSE IF WS-NUM-SMS >  4000 AND WS-NUM-SMS <=  6000        07360000
                  MOVE WS-NUM-SMS       TO WS-NUM-SMS-A                 07370000
                  WRITE B13F203C-REC    FROM WS-BP13F203-REC-A          07380000
                  ADD 1                 TO WS-B13F203C-WRT              07390000
              ELSE IF WS-NUM-SMS >  6000 AND WS-NUM-SMS <=  8000        07400000
                  MOVE WS-NUM-SMS       TO WS-NUM-SMS-A                 07410000
                  WRITE B13F203D-REC    FROM WS-BP13F203-REC-A          07420000
                  ADD 1                 TO WS-B13F203D-WRT              07430000
              ELSE IF WS-NUM-SMS >  8000 AND WS-NUM-SMS <= 10000        07440000
                  MOVE WS-NUM-SMS       TO WS-NUM-SMS-A                 07450000
                  WRITE B13F203E-REC    FROM WS-BP13F203-REC-A          07460000
                  ADD 1                 TO WS-B13F203E-WRT              07470000
              END-IF                                                    07480000
           ELSE                                                         07490000
              IF WS-NUM-SMS >     0 AND WS-NUM-SMS <=  2000             07500000
                  WRITE B13F203A-REC    FROM WS-BP13F203-REC            07510000
                  ADD 1                 TO WS-B13F203A-WRT              07520000
              ELSE IF WS-NUM-SMS >  2000 AND WS-NUM-SMS <=  4000        07530000
                  WRITE B13F203B-REC    FROM WS-BP13F203-REC            07540000
                  ADD 1                 TO WS-B13F203B-WRT              07550000
              ELSE IF WS-NUM-SMS >  4000 AND WS-NUM-SMS <=  6000        07560000
                  WRITE B13F203C-REC    FROM WS-BP13F203-REC            07570000
                  ADD 1                 TO WS-B13F203C-WRT              07580000
              ELSE IF WS-NUM-SMS >  6000 AND WS-NUM-SMS <=  8000        07590000
                  WRITE B13F203D-REC    FROM WS-BP13F203-REC            07600000
                  ADD 1                 TO WS-B13F203D-WRT              07610000
              ELSE IF WS-NUM-SMS >  8000 AND WS-NUM-SMS <= 10000        07620000
                  WRITE B13F203E-REC    FROM WS-BP13F203-REC            07630000
                  ADD 1                 TO WS-B13F203E-WRT              07640000
              END-IF                                                    07650000
           END-IF.                                                      07660000
                                                                        07670000
           ADD 1                     TO WS-NUM-SMS.                     07680000
                                                                        07690000
       8710-EXIT.                                                       07700000
           EXIT.                                                        07710000
                                                                        07720000
      ***************************************************************   07730000
       9999-WRAP-UP.                                                    07740000
      ***************************************************************   07750000
                                                                        07760000
           DISPLAY SPACES.                                              07770000
           DISPLAY '********** CONTROL TOTALS *************'.           07780000
           DISPLAY ' PROGRAM ID                 : BP13CFB6'.            07790000
           DISPLAY '----------------------------------------'.          07800000
           DISPLAY 'CURRENT DATE :                            : '       07810000
                                        WS-DTE-CURRENT.                 07820000
           DISPLAY 'TOTAL BP13F203 RECS READ                  : '       07830000
                                        WS-CTR-BP13F203-READ.           07840000
           DISPLAY 'TOTAL CASES B13F203A WRITTEN              : '       07850000
                                        WS-B13F203A-WRT.                07860000
           DISPLAY 'TOTAL CASES B13F203B WRITTEN              : '       07870000
                                        WS-B13F203B-WRT.                07880000
           DISPLAY 'TOTAL CASES B13F203C WRITTEN              : '       07890000
                                        WS-B13F203C-WRT.                07900000
           DISPLAY 'TOTAL CASES B13F203D WRITTEN              : '       07910000
                                        WS-B13F203D-WRT.                07920000
           DISPLAY 'TOTAL CASES B13F203E WRITTEN              : '       07930000
                                        WS-B13F203E-WRT.                07940000
           DISPLAY 'Note : The first and last record written are dummy  07950000
      -            'records'.                                           07960000
           DISPLAY SPACES.                                              07970000
                                                                        07980000
                                                                        08010000
           CLOSE B13F203A                                               08020000
                 B13F203B                                               08030000
                 B13F203C                                               08040000
                 B13F203D                                               08050000
                 B13F203E                                               08060000
                 SY02F001                                               08070000
                 BP13F203                                               08080000
                 BP13K209.                                              08090000
                                                                        08100000
                                                                        08110000
           STOP RUN.                                                    08120000
                                                                        08130000
       9999-EXIT.                                                       08140000
            EXIT.                                                       08150000
                                                                        08160000
