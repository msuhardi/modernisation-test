      *--------------------------------------------------------------*          
       IDENTIFICATION DIVISION.                                                 
      *--------------------------------------------------------------*          
       PROGRAM-ID.    BP13C20L.                                                 
      *AUTHOR.        ELAINE S ARGA.                                            
      *DATE-WRITTEN.  09-03-2009                                                
      *--------------------------------------------------------------*          
      *                                                              *          
      *    SYSTEM NAME : SYSTEM OF COMMITMENT  (SOC)                 *          
      *                                                              *          
      *    SYSTEM ID   : BP13                                        *          
      *                                                              *          
      *    OBJECTIVES :  MONTHLY CANCELLATION OF BTO/BE APPLICATION  *          
      *                                                              *          
      *    INPUT FILES  : P13F800C                                   *          
      *                 : BP13K820                                   *          
      *    I-O          : BP13K800                                   *          
      *                 : BP13K840                                   *          
      *                 : BP13K848                                   *          
      *                 : BP13K810                                   *          
      *                 : BP13K893                                   *          
      *    OUTPUT       : P13F800D                                   *          
      *                 : BP13F915                                   *          
      *--------------------------------------------------------------*          
      * CHG-NO  BY   DATE     DETAILS                                *          
      *-------- ---- -------- ---------------------------------------*          
      *BP133555 ESA1 02042009 NEW PGM                                *          
      *BP134135 ESA1 08042011 CORRECT READING OF BP13K595            *          
      *BP134548 ESA1 26072012 ADD UPDATE OF BP13F915                 *          
      *BP134681 ESA1 20092012 CATER FOR 3-BYTES ZONE                 *          
      *BP134714 ESA1 04122012 CATER FOR 'NC','NF','SC','SF' ALLO-TAG *          
      *BP134827 ESA1 19042013 CORRECT LOGIC FOR CANCELLATION         *          
      *BP134997 ESA1 21082013 CORRECT UPDATE OF DTE-CANCEL           *          
      *BP135494 ESA1 07102014 TO CATER FOR EXTENSION OF SDS APPLN    *          
      *BP137200 FNP1 08032018 CHANGE 'DE' TXN-TYPE TO 'TE' IN F915   *          
      *BP137326 FNP1 06122018 BLANK OFF OTHER DETAILS FOR  'TE' IN F915         
      *BP137918 KV6  09072019 TO CATER FOR REMOVAL OF DTE-DEFER-EXPIRY          
      *                       AND NUM-DEFER-ZONE-FT                  *          
      *-------- ---- -------- ---------------------------------------*          
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-4341.                                               
       OBJECT-COMPUTER. IBM-4341.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT P13F800C ASSIGN TO P13F800C.                                  
           SELECT P13F800D ASSIGN TO P13F800D.                                  
           SELECT BP13F915 ASSIGN TO BP13F915.                                  
                                                                                
           SELECT BP13K800 ASSIGN TO BP13K800                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K800-NUM-REGN                              
                  FILE STATUS     IS WS-K800-STATUS.                            
                                                                                
           SELECT BP13K840 ASSIGN TO BP13K840                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K840-KEY-FLD                               
                  FILE STATUS     IS WS-K840-STATUS.                            
                                                                                
           SELECT BP13K820 ASSIGN TO BP13K820                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K820-KEY-FLD                               
                  FILE STATUS     IS WS-K820-STATUS.                            
                                                                                
           SELECT BP13K848 ASSIGN TO BP13K848                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K848-KEY-FLD                               
                  FILE STATUS     IS WS-K848-STATUS.                            
                                                                                
           SELECT BP13K810 ASSIGN TO BP13K810                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K810-KEY-FLD                               
                  FILE STATUS     IS WS-K810-STATUS.                            
                                                                                
           SELECT BP13K595 ASSIGN TO BP13K595                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K595-KEY-FLD                               
                  FILE STATUS     IS WS-K595-STATUS.                            
                                                                                
           SELECT BP13K893  ASSIGN        TO BP13K893                           
                  ACCESS MODE   IS DYNAMIC                                      
                  ORGANIZATION  IS INDEXED                                      
                  RECORD KEY    IS K893-KEY-FLD                                 
                  FILE STATUS   IS WS-K893-STATUS.                              
                                                                                
      *--------------------------------------------------------------*          
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *--------------------------------------------------------------*          
                                                                                
       FD   P13F800C                                                            
            RECORD CONTAINS 2000 CHARACTERS                                     
            RECORDING MODE  IS F.                                               
       COPY BP13F800.                                                           
                                                                                
       FD   P13F800D                                                            
            RECORD CONTAINS 2000 CHARACTERS                                     
            RECORDING MODE  IS F.                                               
       01   P13F800D-REC.                                                       
            05 FILLER               PIC X(508).                                 
            05 F800D-DTE-BK-APPT    PIC X(08).                                  
            05 FILLER               PIC X(1484).                                
                                                                                
       FD   BP13F915                                                            
            RECORD CONTAINS 800 CHARACTERS                                      
            BLOCK CONTAINS 0 RECORDS                                            
            LABEL RECORD IS STANDARD                                            
            RECORDING MODE IS F.                                                
       COPY BP13F915.                                                           
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K840                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13K840.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD   BP13K848                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K848.                                                           
                                                                                
       FD   BP13K810                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K810.                                                           
                                                                                
       FD   BP13K595                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13K595.                                                           
                                                                                
       FD   BP13K893                                                            
            RECORD CONTAINS 2050 CHARACTERS.                                    
       COPY BP13K893.                                                           
                                                                                
      *--------------------------------------------------------------*          
       WORKING-STORAGE SECTION.                                                 
      *--------------------------------------------------------------*          
                                                                                
       01  WS-FILE-CONTROLS.                                                    
           05  WS-F800C-EOF               PIC X(1)  VALUE 'N'.                  
           05  WS-F800C-COUNTER           PIC 9(2)  VALUE 0.                    
           05  WS-K595-EOF                PIC X(1)  VALUE 'N'.                  
           05  WS-K893-EOF                PIC X(1)  VALUE 'N'.                  
           05  WS-K820-EOF                PIC X(1)  VALUE 'N'.                  
           05  WS-REC-PROCESS             PIC X(1)  VALUE 'N'.                  
                                                                                
           05  WS-K820-FOUND              PIC X(1)  VALUE 'N'.                  
           05  WS-K840-FOUND              PIC X(1)  VALUE 'N'.                  
           05  WS-K800-STATUS             PIC 9(2)  VALUE 0.                    
           05  WS-K840-STATUS             PIC 9(2)  VALUE 0.                    
           05  WS-K820-STATUS             PIC 9(2)  VALUE 0.                    
           05  WS-K848-STATUS             PIC 9(2)  VALUE 0.                    
           05  WS-K810-STATUS             PIC 9(2)  VALUE 0.                    
           05  WS-K595-STATUS             PIC 9(2)  VALUE 0.                    
           05  WS-K893-STATUS             PIC 9(2)  VALUE 0.                    
           05  WS-F80A-COUNTER            PIC 9(2)  VALUE 0.                    
           05  WS-F893-COUNTER            PIC 9(2)  VALUE 0.                    
                                                                                
           05  WS-CNT-K800-UPD            PIC 9(8)  VALUE 0.                    
           05  WS-CNT-K595-UPD            PIC 9(8)  VALUE 0.                    
           05  WS-CNT-K840-UPD            PIC 9(8)  VALUE 0.                    
           05  WS-CNT-K893-UPD            PIC 9(8)  VALUE 0.                    
           05  WS-CNT-K840-WRITE          PIC 9(8)  VALUE 0.                    
           05  WS-CNT-K848-WRITE          PIC 9(8)  VALUE 0.                    
           05  WS-CNT-K810-WRITE          PIC 9(8)  VALUE 0.                    
           05  WS-CNT-F915-WRITE          PIC 9(8)  VALUE 0.                    
           05  WS-K820-NOTFND             PIC 9(8)  VALUE 0.                    
           05  WS-F800D-WRITE             PIC 9(8)  VALUE 0.                    
                                                                                
       01  WS-MISCELLANEOUS-VARS.                                               
           05  WS-EDITED-DATE             PIC X(10) VALUE SPACES.               
           05  WS-NRIC                    PIC X(9)  VALUE SPACES.               
                                                                                
           05  WS-CNT-F800C-READ          PIC 9(8)  VALUE 0.                    
                                                                                
       01  WS-SYSTEM-DATE.                                                      
           05  WS-SYS-CCYY                PIC 9(4).                             
           05  WS-SYS-MM                  PIC 9(2).                             
           05  WS-SYS-DD                  PIC 9(2).                             
                                                                                
       01  WS-SYSTEM-TIME.                                                      
           05 WS-HH                       PIC 9(2).                             
           05 WS-MM                       PIC 9(2).                             
           05 WS-SS                       PIC 9(2).                             
           05 WS-MI                       PIC 9(2).                             
                                                                                
                                                                                
       01 WS-NUM-REGN                     PIC X(8)  VALUE SPACES.               
                                                                                
      *--------------------------------------------------------------*          
       PROCEDURE DIVISION.                                                      
      *--------------------------------------------------------------*          
                                                                                
      *--------------------------------------------------------------*          
       0000-MAIN-ROUTINE.                                                       
      *--------------------------------------------------------------*          
                                                                                
           PERFORM 1000-OPEN-ROUTINE      THRU 1000-EXIT.                       
                                                                                
           PERFORM 1200-READ-F800C        THRU 1200-EXIT.                       
                                                                                
           PERFORM 2000-PROCESS           THRU 2000-EXIT                        
                UNTIL WS-F800C-EOF = 'Y'.                                       
                                                                                
           PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT.                       
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       1000-OPEN-ROUTINE.                                                       
      *--------------------------------------------------------------*          
                                                                                
           OPEN INPUT  P13F800C                                                 
                       BP13K820                                                 
                I-O    BP13K800                                                 
                       BP13K840                                                 
                       BP13K848                                                 
                       BP13K810                                                 
                       BP13K595                                                 
                       BP13K893                                                 
                OUTPUT P13F800D                                                 
                       BP13F915.                                                
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-SYSTEM-DATE.                   
                                                                                
           STRING WS-SYS-DD '/' WS-SYS-MM '/' WS-SYS-CCYY                       
                  DELIMITED BY SIZE                                             
                  INTO WS-EDITED-DATE                                           
           END-STRING.                                                          
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------------*          
       1200-READ-F800C.                                                         
      *--------------------------------------------------------------*          
                                                                                
           READ P13F800C                                                        
                AT END  MOVE 'Y' TO WS-F800C-EOF                                
                GO TO 1200-EXIT                                                 
           END-READ.                                                            
                                                                                
           ADD 1 TO WS-CNT-F800C-READ.                                          
                                                                                
       1200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------------*          
       2000-PROCESS.                                                            
      *--------------------------------------------------------------*          
           PERFORM 3000-PROCESS1          THRU 3000-EXIT.                       
                                                                                
           PERFORM 1200-READ-F800C        THRU 1200-EXIT.                       
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       3000-PROCESS1.                                                           
      *--------------------------------------------------------------*          
                                                                                
           MOVE F800-NUM-REGN         TO WS-NUM-REGN.                           
           PERFORM 4000-READ-K800     THRU 4000-EXIT.                           
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       4000-READ-K800.                                                          
      *--------------------------------------------------------------*          
           MOVE LOW-VALUES            TO K800-NUM-REGN.                         
           MOVE WS-NUM-REGN           TO K800-NUM-REGN.                         
                                                                                
           READ BP13K800.                                                       
           EVALUATE WS-K800-STATUS                                              
              WHEN 00                                                           
              WHEN 02                                                           
                   IF (K800-NUM-STATUS NOT = 'C') OR                            
                      ((K800-NUM-STATUS = 'C') AND                              
                      (K800-NUM-ALLOC-TAG = 'RQ' OR 'NC' OR 'NF' OR             
                                            'SC' OR 'SF') AND                   
                      (K800-DTE-REQ-CANCEL = SPACES OR LOW-VALUES OR            
                                             ZEROES))                           
                       PERFORM 6700-WRITE-K800-IMAGE THRU 6700-EXIT             
                       PERFORM 6800-WRITE-K810       THRU 6800-EXIT             
                       PERFORM 4100-REWRITE-K800     THRU 4100-EXIT             
                       PERFORM 5000-READ-K840        THRU 5000-EXIT             
                       PERFORM 8600-READ-BP13K595    THRU 8600-EXIT             
                       PERFORM 9000-PROCESS-CDB      THRU 9000-EXIT             
                   END-IF                                                       
              WHEN 23                                                           
                   PERFORM 4200-READ-K893     THRU 4200-EXIT                    
              WHEN OTHER                                                        
                   DISPLAY 'ERROR READING BP13K800. STATUS IS '                 
                           WS-K800-STATUS                                       
                   PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       4100-REWRITE-K800.                                                       
      *--------------------------------------------------------------*          
           MOVE 'C'                     TO K800-NUM-STATUS.                     
                                                                                
           IF K800-NUM-ALLOC-TAG = 'RQ'                                         
              CONTINUE                                                          
           ELSE                                                                 
              IF K800-DTE-CANCEL = SPACES OR LOW-VALUES OR ZEROES               
                 MOVE WS-SYSTEM-DATE TO K800-DTE-CANCEL                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE K800-NUM-ALLOC-TAG TO K800-NUM-ALLOC-TAG-PREV.                  
           MOVE F800-NUM-ALLOC-TAG TO K800-NUM-CANCEL-REASON                    
                                      K800-NUM-ALLOC-TAG.                       
                                                                                
           MOVE F800-NUM-USERID         TO K800-NUM-USERID.                     
                                                                                
           MOVE WS-SYSTEM-DATE    TO K800-DTE-UPDATE.                           
           MOVE SPACES            TO K800-DTE-LETTER-RECV-CAN.                  
                                                                                
           IF F800-NUM-HALF-IDP = 'A' OR 'Q'                                    
              MOVE SPACES    TO K800-NUM-HALF-IDP                               
           END-IF.                                                              
                                                                                
           MOVE 'N'               TO K800-NUM-REGN-REFUND.                      
           MOVE WS-SYSTEM-DATE    TO K800-DTE-REQ-CANCEL.                       
           MOVE SPACES            TO K800-TME-QUEUE                             
                                     K800-TME-QUEUE-PRIO-IFPA                   
                                     K800-NUM-SHORTLIST-PA-HHTY                 
                                     K800-NUM-SHORTLIST-PA-CAT                  
                                     K800-NUM-SHORTLIST-PRIO-HHTY               
                                     K800-NUM-SHORTLIST-PRIO-CAT                
                                     K800-NUM-SLIST-PA-ZNFT                     
                                     K800-NUM-SLIST-PA-ZNFT-CAT                 
                                     K800-NUM-SLIST-PRIO-ZNFT                   
                                     K800-NUM-SLIST-PRIO-ZNFT-CAT.              
                                                                                
            REWRITE BP13K800-MASTER.                                            
                                                                                
            EVALUATE WS-K800-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                    ADD 1    TO WS-CNT-K800-UPD                                 
                    MOVE BP13K800-MASTER    TO P13F800D-REC                     
                    MOVE 'NOINVITE'         TO F800D-DTE-BK-APPT                
                    WRITE P13F800D-REC                                          
                    ADD 1   TO WS-F800D-WRITE                                   
                    CONTINUE                                                    
               WHEN OTHER                                                       
                    DISPLAY 'ERROR UPDATING BP13K800. STATUS IS '               
                            WS-K800-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
            END-EVALUATE.                                                       
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------*           
       4200-READ-K893.                                                          
      *-------------------------------------------------------------*           
            MOVE LOW-VALUES            TO K893-KEY-FLD.                         
            MOVE F800-NUM-REGN         TO K893-KEY-FLD.                         
                                                                                
            START BP13K893 KEY >= K893-KEY-FLD.                                 
            EVALUATE WS-K893-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                    MOVE 'N'           TO  WS-K893-EOF                          
                    PERFORM 4300-READNEXT-K893    THRU 4300-EXIT                
                       UNTIL WS-K893-EOF = 'Y'                                  
                    PERFORM 6000-READ-K840        THRU 6000-EXIT                
               WHEN 23                                                          
                    CONTINUE                                                    
               WHEN OTHER                                                       
                    DISPLAY 'START BROWSE ERROR BP13K893. STATUS IS '           
                            WS-K893-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
            END-EVALUATE.                                                       
                                                                                
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       4300-READNEXT-K893.                                                      
      *-------------------------------------------------------------            
           READ BP13K893 NEXT AT END                                            
                MOVE    'Y'   TO WS-K893-EOF.                                   
                                                                                
           EVALUATE WS-K893-STATUS                                              
            WHEN 00                                                             
            WHEN 02                                                             
              IF K893-NUM-REGN = F800-NUM-REGN                                  
                 IF ((K893-NUM-STATUS = 'C') AND                                
                     (K893-NUM-ALLOC-TAG = 'RQ' OR 'NC' OR 'NF' OR              
                                          'SC' OR 'SF') AND                     
                     (K893-DTE-REQ-CANCEL = SPACES OR LOW-VALUES OR             
                                            ZEROES))                            
                     PERFORM 6900-WRITE-K893-IMAGE THRU 6900-EXIT               
                     PERFORM 7000-WRITE-K810       THRU 7000-EXIT               
                     PERFORM 4400-REWRITE-K893     THRU 4400-EXIT               
                     PERFORM 8600-READ-BP13K595    THRU 8600-EXIT               
                     PERFORM 9000-PROCESS-CDB      THRU 9000-EXIT               
                     MOVE    'Y'     TO WS-K893-EOF                             
                 END-IF                                                         
              ELSE                                                              
                 MOVE 'Y'        TO   WS-K893-EOF                               
              END-IF                                                            
            WHEN 10                                                             
            WHEN 23                                                             
                 MOVE 'Y'        TO WS-K893-EOF                                 
            WHEN OTHER                                                          
               DISPLAY 'ERROR READING BP13K893' WS-K893-STATUS                  
               PERFORM 9999-CLOSE-ROUTINE   THRU 9999-EXIT                      
           END-EVALUATE.                                                        
                                                                                
       4300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       4400-REWRITE-K893.                                                       
      *--------------------------------------------------------------*          
           MOVE 'C'                  TO K893-NUM-STATUS.                        
                                                                                
           IF K893-NUM-ALLOC-TAG = 'RQ'                                         
              CONTINUE                                                          
           ELSE                                                                 
              IF K893-DTE-CANCEL = SPACES OR LOW-VALUES OR ZEROES               
                 MOVE WS-SYSTEM-DATE TO K893-DTE-CANCEL                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE K893-NUM-ALLOC-TAG TO K893-NUM-ALLOC-TAG-PREV.                  
           MOVE F800-NUM-ALLOC-TAG TO K893-NUM-CANCEL-REASON                    
                                      K893-NUM-ALLOC-TAG.                       
                                                                                
           MOVE F800-NUM-USERID    TO K893-NUM-USERID.                          
                                                                                
           MOVE WS-SYSTEM-DATE     TO K893-DTE-UPDATE.                          
           MOVE SPACES             TO K893-DTE-LETTER-RECV-CAN.                 
                                                                                
           IF F800-NUM-HALF-IDP = 'A' OR 'Q'                                    
              MOVE SPACES          TO K893-NUM-HALF-IDP                         
           END-IF.                                                              
                                                                                
           MOVE 'N'                TO K893-NUM-REGN-REFUND.                     
           MOVE WS-SYSTEM-DATE     TO K893-DTE-REQ-CANCEL.                      
           MOVE SPACES             TO K893-TME-QUEUE                            
                                      K893-TME-QUEUE-PRIO-IFPA                  
                                      K893-NUM-SHORTLIST-PA-HHTY                
                                      K893-NUM-SHORTLIST-PA-CAT                 
                                      K893-NUM-SHORTLIST-PRIO-HHTY              
                                      K893-NUM-SHORTLIST-PRIO-CAT               
                                      K893-NUM-SLIST-PA-ZNFT                    
                                      K893-NUM-SLIST-PA-ZNFT-CAT                
                                      K893-NUM-SLIST-PRIO-ZNFT                  
                                      K893-NUM-SLIST-PRIO-ZNFT-CAT.             
                                                                                
            REWRITE BP13K893-MASTER.                                            
                                                                                
            EVALUATE WS-K893-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                    ADD 1    TO WS-CNT-K893-UPD                                 
                    MOVE BP13K893-MASTER(1:2000) TO P13F800D-REC                
                    MOVE 'NOINVITE'              TO F800D-DTE-BK-APPT           
                    WRITE P13F800D-REC                                          
                    ADD 1   TO WS-F800D-WRITE                                   
                    CONTINUE                                                    
               WHEN OTHER                                                       
                    DISPLAY 'ERROR UPDATING BP13K893. STATUS IS '               
                            WS-K893-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
            END-EVALUATE.                                                       
                                                                                
       4400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       5000-READ-K840.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE 'N'              TO WS-K840-FOUND                              
            MOVE LOW-VALUES       TO K840-NUM-REGN.                             
            MOVE WS-NUM-REGN      TO K840-NUM-REGN.                             
                                                                                
            READ BP13K840.                                                      
                                                                                
            EVALUATE WS-K840-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                    PERFORM 5100-MOVE-PARA      THRU 5100-EXIT                  
                    PERFORM 5200-REWRITE-K840   THRU 5200-EXIT                  
               WHEN 23                                                          
                    PERFORM 5300-WRITE-K840     THRU 5300-EXIT                  
               WHEN OTHER                                                       
                    DISPLAY 'ERROR WRITING BP13K840. STATUS IS '                
                            WS-K840-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
            END-EVALUATE.                                                       
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       5100-MOVE-PARA.                                                          
      *--------------------------------------------------------------*          
                                                                                
           MOVE WS-NUM-REGN                 TO K840-NUM-REGN.                   
                                                                                
           MOVE F800-NUM-ALLOC-TAG          TO K840-NUM-CANCEL.                 
                                                                                
           MOVE WS-SYSTEM-DATE        TO K840-DTE-CANCEL                        
                                         K840-DTE-UPDATE.                       
           MOVE 'P13C20L'             TO K840-NUM-USERID.                       
                                                                                
           MOVE K800-DTE-REGN         TO K840-DTE-REGN.                         
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       5110-MOVE-PARA1.                                                         
      *--------------------------------------------------------------*          
                                                                                
           MOVE K800-NUM-ZONE            TO K840-NUM-ZONE.                      
           MOVE K800-NUM-BTO-ZONE        TO K840-NUM-BTO-ZONE.                  
           MOVE K800-NUM-FLAT-TYPE       TO K840-NUM-FLAT-TYPE.                 
           MOVE K800-NUM-NEW-TOWN        TO K840-NUM-NEW-TOWN.                  
           MOVE K800-NUM-IDP-SCHEME      TO K840-NUM-IDP-SCH.                   
           MOVE K800-NUM-ALLO-SCHEME     TO K840-NUM-ALLOC-SCH.                 
                                                                                
       5110-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       5120-MOVE-PARA2.                                                         
      *--------------------------------------------------------------*          
                                                                                
           MOVE K800-NUM-NRIC1       TO K840-NUM-NRIC1                          
                                        WS-NRIC.                                
                                                                                
           MOVE 'N' TO WS-K820-FOUND.                                           
                                                                                
           PERFORM 5400-READ-BP13K820    THRU 5400-EXIT.                        
                                                                                
           IF WS-K820-FOUND = 'Y'                                               
              IF K820-NME-OCCP NOT = SPACES AND LOW-VALUES                      
                 MOVE K820-NME-OCCP  TO K840-NME-APPL1                          
              ELSE                                                              
                 MOVE SPACES         TO K840-NME-APPL1                          
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF (K800-NUM-NRIC2 NOT = SPACES AND LOW-VALUES) AND                  
              (K800-NUM-NRIC2(1:1) NOT = '#')                                   
              MOVE K800-NUM-NRIC2        TO K840-NUM-NRIC2                      
                                            WS-NRIC                             
              MOVE 'N' TO WS-K820-FOUND                                         
              PERFORM 5400-READ-BP13K820 THRU 5400-EXIT                         
              IF WS-K820-FOUND = 'Y'                                            
                 IF K820-NME-OCCP NOT = SPACES AND LOW-VALUES                   
                    MOVE K820-NME-OCCP  TO K840-NME-APPL2                       
                 ELSE                                                           
                    MOVE SPACES         TO K840-NME-APPL2                       
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              STRING '#' K840-NUM-REGN                                          
                     DELIMITED BY SIZE INTO K840-NUM-NRIC2                      
              MOVE K840-NUM-NRIC2 TO WS-NRIC                                    
              MOVE SPACES         TO K840-NME-APPL2                             
           END-IF.                                                              
                                                                                
           IF (K800-NUM-NRIC3 NOT = SPACES AND LOW-VALUES) AND                  
              (K800-NUM-NRIC3(1:1) NOT = '#')                                   
              MOVE K800-NUM-NRIC3        TO K840-NUM-NRIC3                      
                                            WS-NRIC                             
              MOVE 'N' TO WS-K820-FOUND                                         
              PERFORM 5400-READ-BP13K820 THRU 5400-EXIT                         
              IF WS-K820-FOUND = 'Y'                                            
                 IF K820-NME-OCCP NOT = SPACES AND LOW-VALUES                   
                    MOVE K820-NME-OCCP  TO K840-NME-APPL3                       
                 ELSE                                                           
                    MOVE SPACES         TO K840-NME-APPL3                       
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              STRING '#' K840-NUM-REGN                                          
                     DELIMITED BY SIZE INTO K840-NUM-NRIC3                      
              MOVE K840-NUM-NRIC3 TO WS-NRIC                                    
              MOVE SPACES         TO K840-NME-APPL3                             
           END-IF.                                                              
                                                                                
           IF (K800-NUM-NRIC4 NOT = SPACES AND LOW-VALUES) AND                  
              (K800-NUM-NRIC4(1:1) NOT = '#')                                   
              MOVE K800-NUM-NRIC4        TO K840-NUM-NRIC4                      
                                            WS-NRIC                             
              MOVE 'N' TO WS-K820-FOUND                                         
                                                                                
              PERFORM 5400-READ-BP13K820 THRU 5400-EXIT                         
                                                                                
              IF WS-K820-FOUND = 'Y'                                            
                 IF K820-NME-OCCP NOT = SPACES AND LOW-VALUES                   
                    MOVE K820-NME-OCCP  TO K840-NME-APPL4                       
                 ELSE                                                           
                    MOVE SPACES         TO K840-NME-APPL4                       
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              STRING '#' K840-NUM-REGN                                          
                     DELIMITED BY SIZE INTO K840-NUM-NRIC4                      
              MOVE K840-NUM-NRIC4 TO WS-NRIC                                    
              MOVE SPACES         TO K840-NME-APPL4                             
           END-IF.                                                              
                                                                                
                                                                                
       5120-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       5200-REWRITE-K840.                                                       
      *--------------------------------------------------------------*          
                                                                                
            REWRITE BP13K840-REC.                                               
                                                                                
            EVALUATE WS-K840-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                    ADD 1 TO WS-CNT-K840-UPD                                    
               WHEN OTHER                                                       
                    DISPLAY 'ERROR UPDATING BP13K840. STATUS IS '               
                            WS-K840-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
            END-EVALUATE.                                                       
                                                                                
       5200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       5300-WRITE-K840.                                                         
      *--------------------------------------------------------------*          
                                                                                
            MOVE SPACES              TO BP13K840-REC.                           
            INITIALIZE                  BP13K840-REC.                           
                                                                                
            MOVE 'Y'                 TO WS-K840-FOUND.                          
                                                                                
            PERFORM 5100-MOVE-PARA   THRU 5100-EXIT.                            
            PERFORM 5110-MOVE-PARA1  THRU 5110-EXIT.                            
            PERFORM 5120-MOVE-PARA2  THRU 5120-EXIT.                            
                                                                                
            WRITE BP13K840-REC.                                                 
                                                                                
            EVALUATE WS-K840-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                    ADD 1 TO WS-CNT-K840-WRITE                                  
               WHEN OTHER                                                       
                    DISPLAY 'ERROR WRITING BP13K840. STATUS IS '                
                            WS-K840-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
            END-EVALUATE.                                                       
                                                                                
       5300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       5400-READ-BP13K820.                                                      
      *--------------------------------------------------------------*          
                                                                                
            MOVE LOW-VALUES            TO K820-KEY-FLD.                         
            MOVE WS-NUM-REGN           TO K820-NUM-REGN.                        
            MOVE WS-NRIC               TO K820-NUM-NRIC.                        
                                                                                
            READ BP13K820.                                                      
                                                                                
            EVALUATE WS-K820-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                    MOVE 'Y' TO WS-K820-FOUND                                   
               WHEN 23                                                          
                    DISPLAY 'NOT FOUND IN BP13K820, KEY '                       
                            K820-KEY-FLD                                        
               WHEN OTHER                                                       
                    DISPLAY 'ERROR WRITING BP13K820. STATUS IS '                
                            WS-K820-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
            END-EVALUATE.                                                       
                                                                                
       5400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6000-READ-K840.                                                          
      *--------------------------------------------------------------*          
                                                                                
            MOVE 'N'              TO WS-K840-FOUND                              
            MOVE LOW-VALUES       TO K840-NUM-REGN.                             
            MOVE WS-NUM-REGN      TO K840-NUM-REGN.                             
                                                                                
            READ BP13K840.                                                      
                                                                                
            EVALUATE WS-K840-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                    PERFORM 6100-MOVE-PARA      THRU 6100-EXIT                  
                    PERFORM 6200-REWRITE-K840   THRU 6200-EXIT                  
               WHEN 23                                                          
                    PERFORM 6300-WRITE-K840     THRU 6300-EXIT                  
               WHEN OTHER                                                       
                    DISPLAY 'ERROR WRITING BP13K840. STATUS IS '                
                            WS-K840-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
            END-EVALUATE.                                                       
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6100-MOVE-PARA.                                                          
      *--------------------------------------------------------------*          
                                                                                
           MOVE WS-NUM-REGN                 TO K840-NUM-REGN.                   
                                                                                
           MOVE F800-NUM-ALLOC-TAG          TO K840-NUM-CANCEL.                 
                                                                                
           MOVE WS-SYSTEM-DATE        TO K840-DTE-CANCEL                        
                                         K840-DTE-UPDATE.                       
           MOVE 'P13C20L'             TO K840-NUM-USERID.                       
                                                                                
           MOVE K893-DTE-REGN         TO K840-DTE-REGN.                         
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6110-MOVE-PARA1.                                                         
      *--------------------------------------------------------------*          
                                                                                
           MOVE K893-NUM-ZONE            TO K840-NUM-ZONE.                      
           MOVE K893-NUM-FLAT-TYPE       TO K840-NUM-FLAT-TYPE.                 
           MOVE K893-NUM-NEW-TOWN        TO K840-NUM-NEW-TOWN.                  
           MOVE K893-NUM-IDP-SCHEME      TO K840-NUM-IDP-SCH.                   
           MOVE K893-NUM-ALLO-SCHEME     TO K840-NUM-ALLOC-SCH.                 
                                                                                
       6110-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6120-MOVE-PARA2.                                                         
      *--------------------------------------------------------------*          
                                                                                
           MOVE K893-NUM-NRIC1       TO K840-NUM-NRIC1                          
                                        WS-NRIC.                                
                                                                                
           MOVE 'N' TO WS-K820-FOUND.                                           
                                                                                
           PERFORM 5400-READ-BP13K820    THRU 5400-EXIT.                        
                                                                                
           IF WS-K820-FOUND = 'Y'                                               
              IF K820-NME-OCCP NOT = SPACES AND LOW-VALUES                      
                 MOVE K820-NME-OCCP  TO K840-NME-APPL1                          
              ELSE                                                              
                 MOVE SPACES         TO K840-NME-APPL1                          
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF (K893-NUM-NRIC2 NOT = SPACES AND LOW-VALUES) AND                  
              (K893-NUM-NRIC2(1:1) NOT = '#')                                   
              MOVE K893-NUM-NRIC2        TO K840-NUM-NRIC2                      
                                            WS-NRIC                             
              MOVE 'N' TO WS-K820-FOUND                                         
              PERFORM 5400-READ-BP13K820 THRU 5400-EXIT                         
              IF WS-K820-FOUND = 'Y'                                            
                 IF K820-NME-OCCP NOT = SPACES AND LOW-VALUES                   
                    MOVE K820-NME-OCCP  TO K840-NME-APPL2                       
                 ELSE                                                           
                    MOVE SPACES         TO K840-NME-APPL2                       
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              STRING '#' K840-NUM-REGN                                          
                     DELIMITED BY SIZE INTO K840-NUM-NRIC2                      
              MOVE K840-NUM-NRIC2 TO WS-NRIC                                    
              MOVE SPACES         TO K840-NME-APPL2                             
           END-IF.                                                              
                                                                                
           IF (K893-NUM-NRIC3 NOT = SPACES AND LOW-VALUES) AND                  
              (K893-NUM-NRIC3(1:1) NOT = '#')                                   
              MOVE K893-NUM-NRIC3        TO K840-NUM-NRIC3                      
                                            WS-NRIC                             
              MOVE 'N' TO WS-K820-FOUND                                         
              PERFORM 5400-READ-BP13K820 THRU 5400-EXIT                         
              IF WS-K820-FOUND = 'Y'                                            
                 IF K820-NME-OCCP NOT = SPACES AND LOW-VALUES                   
                    MOVE K820-NME-OCCP  TO K840-NME-APPL3                       
                 ELSE                                                           
                    MOVE SPACES         TO K840-NME-APPL3                       
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              STRING '#' K840-NUM-REGN                                          
                     DELIMITED BY SIZE INTO K840-NUM-NRIC3                      
              MOVE K840-NUM-NRIC3 TO WS-NRIC                                    
              MOVE SPACES         TO K840-NME-APPL3                             
           END-IF.                                                              
                                                                                
           IF (K893-NUM-NRIC4 NOT = SPACES AND LOW-VALUES) AND                  
              (K893-NUM-NRIC4(1:1) NOT = '#')                                   
              MOVE K893-NUM-NRIC4        TO K840-NUM-NRIC4                      
                                            WS-NRIC                             
              MOVE 'N' TO WS-K820-FOUND                                         
                                                                                
              PERFORM 5400-READ-BP13K820 THRU 5400-EXIT                         
                                                                                
              IF WS-K820-FOUND = 'Y'                                            
                 IF K820-NME-OCCP NOT = SPACES AND LOW-VALUES                   
                    MOVE K820-NME-OCCP  TO K840-NME-APPL4                       
                 ELSE                                                           
                    MOVE SPACES         TO K840-NME-APPL4                       
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              STRING '#' K840-NUM-REGN                                          
                     DELIMITED BY SIZE INTO K840-NUM-NRIC4                      
              MOVE K840-NUM-NRIC4 TO WS-NRIC                                    
              MOVE SPACES         TO K840-NME-APPL4                             
           END-IF.                                                              
                                                                                
                                                                                
       6120-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6200-REWRITE-K840.                                                       
      *--------------------------------------------------------------*          
                                                                                
            REWRITE BP13K840-REC.                                               
                                                                                
            EVALUATE WS-K840-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                    ADD 1 TO WS-CNT-K840-UPD                                    
               WHEN OTHER                                                       
                    DISPLAY 'ERROR UPDATING BP13K840. STATUS IS '               
                            WS-K840-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
            END-EVALUATE.                                                       
                                                                                
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6300-WRITE-K840.                                                         
      *--------------------------------------------------------------*          
                                                                                
            MOVE SPACES              TO BP13K840-REC.                           
            INITIALIZE                  BP13K840-REC.                           
                                                                                
            MOVE 'Y'                 TO WS-K840-FOUND.                          
                                                                                
            PERFORM 6100-MOVE-PARA   THRU 6100-EXIT.                            
            PERFORM 6110-MOVE-PARA1  THRU 6110-EXIT.                            
            PERFORM 6120-MOVE-PARA2  THRU 6120-EXIT.                            
                                                                                
            WRITE BP13K840-REC.                                                 
                                                                                
            EVALUATE WS-K840-STATUS                                             
               WHEN 00                                                          
               WHEN 02                                                          
                    ADD 1 TO WS-CNT-K840-WRITE                                  
               WHEN OTHER                                                       
                    DISPLAY 'ERROR WRITING BP13K840. STATUS IS '                
                            WS-K840-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
            END-EVALUATE.                                                       
                                                                                
       6300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6700-WRITE-K800-IMAGE.                                                   
      *--------------------------------------------------------------*          
                                                                                
           MOVE BP13K800-MASTER TO BP13K848-MASTER.                             
           MOVE 'C20L'          TO K848-NUM-TRANS-BKIMAGE.                      
                                                                                
           MOVE F800-NUM-USERID TO K848-NUM-USERID.                             
           MOVE WS-SYSTEM-DATE  TO K848-DTE-BKIMAGE.                            
                                                                                
           MOVE FUNCTION CURRENT-DATE(9:8) TO WS-SYSTEM-TIME.                   
                                                                                
           MOVE WS-SYSTEM-TIME  TO K848-TME-BKIMAGE.                            
           MOVE K848-NUM-REGN   TO K848-NUM-REGN-BKIMAGE.                       
                                                                                
           WRITE BP13K848-MASTER.                                               
                                                                                
           EVALUATE WS-K848-STATUS                                              
               WHEN 00                                                          
                    ADD 1 TO WS-CNT-K848-WRITE                                  
                    CONTINUE                                                    
               WHEN OTHER                                                       
                    DISPLAY 'ERROR WRITING BP13K848. STATUS IS '                
                            WS-K848-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
           END-EVALUATE.                                                        
                                                                                
       6700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6800-WRITE-K810.                                                         
      *--------------------------------------------------------------*          
                                                                                
           MOVE SPACES                 TO BP13K810-MASTER.                      
           INITIALIZE                     BP13K810-MASTER.                      
                                                                                
           MOVE K800-NUM-REGN          TO K810-NUM-REGN                         
                                          WS-NUM-REGN.                          
           MOVE WS-SYSTEM-DATE         TO K810-DTE-UPDATE.                      
           MOVE FUNCTION CURRENT-DATE(9:8) TO WS-SYSTEM-TIME.                   
                                                                                
           MOVE WS-SYSTEM-TIME(1:7)    TO K810-TME-UPDATE.                      
           MOVE SPACES                 TO K810-NUM-REF.                         
           MOVE 'C'                    TO K810-NUM-STATUS                       
           MOVE K800-NUM-NRIC1         TO K810-NUM-NRIC1.                       
           MOVE K800-NUM-NRIC2         TO K810-NUM-NRIC2.                       
           MOVE K800-NUM-NRIC3         TO K810-NUM-NRIC3.                       
           MOVE K800-NUM-NRIC4         TO K810-NUM-NRIC4.                       
           MOVE K800-NUM-ZONE          TO K810-NUM-ZONE.                        
           MOVE K800-NUM-FLAT-TYPE     TO K810-NUM-FLAT-TYPE.                   
           MOVE K800-NUM-NEW-TOWN      TO K810-NUM-NEW-TOWN.                    
           MOVE K800-NUM-IDP-SCHEME    TO K810-NUM-IDP-SCHEME.                  
           MOVE K800-NUM-ALLO-SCHEME   TO K810-NUM-ALLO-SCHEME.                 
           MOVE K800-NUM-ELIG-SCHEME   TO K810-NUM-ELIG-SCHEME.                 
           MOVE K800-NUM-CAT           TO K810-NUM-CAT.                         
           MOVE K800-NUM-HOUSEHOLD     TO K810-NUM-HOUSEHOLD.                   
           MOVE SPACES                 TO K810-DTE-CHANGE-ZONE-FT.              
           MOVE K800-QTY-JT-BALLOT     TO K810-QTY-JT-BALLOT.                   
           MOVE K800-NUM-JT-BALLOT-MTF TO K810-NUM-JT-BALLOT.                   
           MOVE K800-NUM-SCH-ACC       TO K810-NUM-SCH-ACC.                     
           MOVE K800-NUM-CUR-REGN      TO K810-NUM-CUR-REGN.                    
           MOVE SPACES                 TO K810-NUM-DEFER-TAG.                   
           MOVE K800-NUM-WAIT-TIME     TO K810-NUM-WAIT-TIME.                   
           MOVE K800-NUM-ZONE-FT-QUEUE TO K810-NUM-ZONE-FT-QUEUE.               
           MOVE K800-NUM-5YR-OCCUPN    TO K810-NUM-5YR-OCCUPN.                  
           MOVE K800-NUM-PARENT-CHILD  TO K810-NUM-PARENT-CHILD.                
           MOVE K800-NUM-HOLDING-TYPE  TO K810-NUM-HOLDING-TYPE.                
           MOVE K800-NUM-SHORTLIST-PA-HHTY                                      
                                       TO K810-NUM-SHORTLIST-PA-HHTY.           
           MOVE K800-NUM-SHORTLIST-PA-CAT                                       
                                       TO K810-NUM-SHORTLIST-PA-CAT.            
           MOVE K800-NUM-SHORTLIST-PRIO-HHTY                                    
                                       TO K810-NUM-SHORTLIST-PRIO-HHTY.         
           MOVE K800-NUM-SHORTLIST-PRIO-CAT                                     
                                       TO K810-NUM-SHORTLIST-PRIO-CAT.          
           MOVE K800-DTE-BALLOT        TO K810-DTE-BALLOT.                      
                                                                                
                                                                                
           MOVE K800-TME-QUEUE         TO K810-TME-QUEUE.                       
           MOVE K800-TME-QUEUE         TO K810-TME-QUEUE.                       
           MOVE K800-NUM-JT-BALLOT-REGN TO K810-NUM-JT-BALLOT-REGN-1.           
           MOVE SPACES                 TO K810-NUM-JT-BALLOT-REGN-2.            
           MOVE SPACES                 TO K810-NUM-JT-BALLOT-REGN-3.            
           MOVE SPACES                 TO K810-NUM-JT-BALLOT-REGN-4.            
           MOVE SPACES                 TO K810-NUM-JT-BALLOT-REGN-5.            
           MOVE SPACES                 TO K810-NUM-JT-BALLOT-REGN-6.            
           MOVE K800-NUM-LOAN-TAG      TO K810-NUM-LOAN-TAG.                    
           MOVE F800-NUM-USERID        TO K810-NUM-USERID.                      
                                                                                
           IF  K800-NUM-NRIC1      NOT = SPACES AND LOW-VALUES                  
               MOVE K800-NUM-NRIC1     TO WS-NRIC                               
               PERFORM 5400-READ-BP13K820 THRU 5400-EXIT                        
               MOVE K820-NME-OCCP      TO K810-NME-HA1                          
           ELSE                                                                 
               MOVE SPACES             TO K810-NME-HA1.                         
                                                                                
           IF  (K800-NUM-NRIC2 NOT = SPACES AND LOW-VALUES) AND                 
               (K800-NUM-NRIC2(1:1) NOT = '#')                                  
               MOVE K800-NUM-NRIC2     TO WS-NRIC                               
               PERFORM 5400-READ-BP13K820 THRU 5400-EXIT                        
               MOVE K820-NME-OCCP      TO K810-NME-HA2                          
           ELSE                                                                 
               MOVE SPACES             TO K810-NME-HA2.                         
                                                                                
           IF  (K800-NUM-NRIC3      NOT = SPACES AND LOW-VALUES) AND            
               (K800-NUM-NRIC3(1:1) NOT = '#')                                  
               MOVE K800-NUM-NRIC3     TO WS-NRIC                               
               PERFORM 5400-READ-BP13K820 THRU 5400-EXIT                        
               MOVE K820-NME-OCCP      TO K810-NME-HA3                          
           ELSE                                                                 
               MOVE SPACES             TO K810-NME-HA3.                         
                                                                                
           IF  (K800-NUM-NRIC4      NOT = SPACES AND LOW-VALUES) AND            
               (K800-NUM-NRIC4(1:1) NOT = '#')                                  
               MOVE K800-NUM-NRIC4     TO WS-NRIC                               
               PERFORM 5400-READ-BP13K820 THRU 5400-EXIT                        
               MOVE K820-NME-OCCP      TO K810-NME-HA4                          
           ELSE                                                                 
               MOVE SPACES             TO K810-NME-HA4.                         
                                                                                
           MOVE 'C20L'                 TO K810-NUM-SCREENID.                    
                                                                                
           WRITE BP13K810-MASTER.                                               
                                                                                
           EVALUATE WS-K810-STATUS                                              
               WHEN 00                                                          
                    ADD 1 TO WS-CNT-K810-WRITE                                  
               WHEN OTHER                                                       
                    DISPLAY 'ERROR WRITING BP13K810. STATUS IS '                
                            WS-K810-STATUS                                      
                    DISPLAY K810-KEY-FLD ' KEY 810'                             
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
           END-EVALUATE.                                                        
                                                                                
       6800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       6900-WRITE-K893-IMAGE.                                                   
      *--------------------------------------------------------------*          
                                                                                
           MOVE BP13K893-MASTER TO BP13K848-MASTER.                             
           MOVE 'C20L'          TO K848-NUM-TRANS-BKIMAGE.                      
                                                                                
           MOVE F800-NUM-USERID TO K848-NUM-USERID.                             
           MOVE WS-SYSTEM-DATE  TO K848-DTE-BKIMAGE.                            
                                                                                
           MOVE FUNCTION CURRENT-DATE(9:8) TO WS-SYSTEM-TIME.                   
                                                                                
           MOVE WS-SYSTEM-TIME  TO K848-TME-BKIMAGE.                            
           MOVE K893-NUM-REGN   TO K848-NUM-REGN-BKIMAGE.                       
                                                                                
           WRITE BP13K848-MASTER.                                               
                                                                                
           EVALUATE WS-K893-STATUS                                              
               WHEN 00                                                          
                    ADD 1 TO WS-CNT-K848-WRITE                                  
                    CONTINUE                                                    
               WHEN OTHER                                                       
                    DISPLAY 'ERROR WRITING BP13K848. STATUS IS '                
                            WS-K848-STATUS                                      
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
           END-EVALUATE.                                                        
                                                                                
       6900-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       7000-WRITE-K810.                                                         
      *--------------------------------------------------------------*          
                                                                                
           MOVE SPACES                 TO BP13K810-MASTER.                      
           INITIALIZE                     BP13K810-MASTER.                      
                                                                                
           MOVE K893-NUM-REGN          TO K810-NUM-REGN                         
                                          WS-NUM-REGN.                          
           MOVE WS-SYSTEM-DATE         TO K810-DTE-UPDATE.                      
           MOVE FUNCTION CURRENT-DATE(9:8) TO WS-SYSTEM-TIME.                   
                                                                                
           MOVE WS-SYSTEM-TIME(1:7)    TO K810-TME-UPDATE.                      
           MOVE SPACES                 TO K810-NUM-REF.                         
           MOVE 'C'                    TO K810-NUM-STATUS                       
           MOVE K893-NUM-NRIC1         TO K810-NUM-NRIC1.                       
           MOVE K893-NUM-NRIC2         TO K810-NUM-NRIC2.                       
           MOVE K893-NUM-NRIC3         TO K810-NUM-NRIC3.                       
           MOVE K893-NUM-NRIC4         TO K810-NUM-NRIC4.                       
           MOVE K893-NUM-ZONE          TO K810-NUM-ZONE.                        
           MOVE K893-NUM-FLAT-TYPE     TO K810-NUM-FLAT-TYPE.                   
           MOVE K893-NUM-NEW-TOWN      TO K810-NUM-NEW-TOWN.                    
           MOVE K893-NUM-IDP-SCHEME    TO K810-NUM-IDP-SCHEME.                  
           MOVE K893-NUM-ALLO-SCHEME   TO K810-NUM-ALLO-SCHEME.                 
           MOVE K893-NUM-ELIG-SCHEME   TO K810-NUM-ELIG-SCHEME.                 
           MOVE K893-NUM-CAT           TO K810-NUM-CAT.                         
           MOVE K893-NUM-HOUSEHOLD     TO K810-NUM-HOUSEHOLD.                   
           MOVE SPACES                 TO K810-DTE-CHANGE-ZONE-FT.              
           MOVE K893-QTY-JT-BALLOT     TO K810-QTY-JT-BALLOT.                   
           MOVE K893-NUM-JT-BALLOT-MTF TO K810-NUM-JT-BALLOT.                   
           MOVE K893-NUM-SCH-ACC       TO K810-NUM-SCH-ACC.                     
           MOVE K893-NUM-CUR-REGN      TO K810-NUM-CUR-REGN.                    
           MOVE SPACES                 TO K810-NUM-DEFER-TAG.                   
           MOVE K893-NUM-WAIT-TIME     TO K810-NUM-WAIT-TIME.                   
           MOVE K893-NUM-ZONE-FT-QUEUE TO K810-NUM-ZONE-FT-QUEUE.               
           MOVE K893-NUM-5YR-OCCUPN    TO K810-NUM-5YR-OCCUPN.                  
           MOVE K893-NUM-PARENT-CHILD  TO K810-NUM-PARENT-CHILD.                
           MOVE K893-NUM-HOLDING-TYPE  TO K810-NUM-HOLDING-TYPE.                
           MOVE K893-NUM-SHORTLIST-PA-HHTY                                      
                                       TO K810-NUM-SHORTLIST-PA-HHTY.           
           MOVE K893-NUM-SHORTLIST-PA-CAT                                       
                                       TO K810-NUM-SHORTLIST-PA-CAT.            
           MOVE K893-NUM-SHORTLIST-PRIO-HHTY                                    
                                       TO K810-NUM-SHORTLIST-PRIO-HHTY.         
           MOVE K893-NUM-SHORTLIST-PRIO-CAT                                     
                                       TO K810-NUM-SHORTLIST-PRIO-CAT.          
           MOVE K893-DTE-BALLOT        TO K810-DTE-BALLOT.                      
                                                                                
           MOVE K893-NUM-BTO-ZONE      TO  K810-NUM-BTO-ZONE.                   
                                                                                
           MOVE K893-TME-QUEUE         TO K810-TME-QUEUE.                       
           MOVE K893-TME-QUEUE         TO K810-TME-QUEUE.                       
           MOVE K893-NUM-JT-BALLOT-REGN TO K810-NUM-JT-BALLOT-REGN-1.           
           MOVE SPACES                 TO K810-NUM-JT-BALLOT-REGN-2.            
           MOVE SPACES                 TO K810-NUM-JT-BALLOT-REGN-3.            
           MOVE SPACES                 TO K810-NUM-JT-BALLOT-REGN-4.            
           MOVE SPACES                 TO K810-NUM-JT-BALLOT-REGN-5.            
           MOVE SPACES                 TO K810-NUM-JT-BALLOT-REGN-6.            
           MOVE K893-NUM-LOAN-TAG      TO K810-NUM-LOAN-TAG.                    
           MOVE F800-NUM-USERID        TO K810-NUM-USERID.                      
                                                                                
           IF  K893-NUM-NRIC1      NOT = SPACES AND LOW-VALUES                  
               MOVE K893-NUM-NRIC1     TO WS-NRIC                               
               PERFORM 5400-READ-BP13K820 THRU 5400-EXIT                        
               MOVE K820-NME-OCCP      TO K810-NME-HA1                          
           ELSE                                                                 
               MOVE SPACES             TO K810-NME-HA1.                         
                                                                                
           IF  (K893-NUM-NRIC2 NOT = SPACES AND LOW-VALUES) AND                 
               (K893-NUM-NRIC2(1:1) NOT = '#')                                  
               MOVE K893-NUM-NRIC2     TO WS-NRIC                               
               PERFORM 5400-READ-BP13K820 THRU 5400-EXIT                        
               MOVE K820-NME-OCCP      TO K810-NME-HA2                          
           ELSE                                                                 
               MOVE SPACES             TO K810-NME-HA2.                         
                                                                                
           IF  (K893-NUM-NRIC3      NOT = SPACES AND LOW-VALUES) AND            
               (K893-NUM-NRIC3(1:1) NOT = '#')                                  
               MOVE K893-NUM-NRIC3     TO WS-NRIC                               
               PERFORM 5400-READ-BP13K820 THRU 5400-EXIT                        
               MOVE K820-NME-OCCP      TO K810-NME-HA3                          
           ELSE                                                                 
               MOVE SPACES             TO K810-NME-HA3.                         
                                                                                
           IF  (K893-NUM-NRIC4      NOT = SPACES AND LOW-VALUES) AND            
               (K893-NUM-NRIC4(1:1) NOT = '#')                                  
               MOVE K893-NUM-NRIC4     TO WS-NRIC                               
               PERFORM 5400-READ-BP13K820 THRU 5400-EXIT                        
               MOVE K820-NME-OCCP      TO K810-NME-HA4                          
           ELSE                                                                 
               MOVE SPACES             TO K810-NME-HA4.                         
                                                                                
           MOVE 'C20L'                 TO K810-NUM-SCREENID.                    
                                                                                
           WRITE BP13K810-MASTER.                                               
                                                                                
           EVALUATE WS-K810-STATUS                                              
               WHEN 00                                                          
                    ADD 1 TO WS-CNT-K810-WRITE                                  
               WHEN OTHER                                                       
                    DISPLAY 'ERROR WRITING BP13K810. STATUS IS '                
                            WS-K810-STATUS                                      
                    DISPLAY K810-KEY-FLD ' KEY 810'                             
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                  
           END-EVALUATE.                                                        
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       8600-READ-BP13K595.                                                      
      *--------------------------------------------------------------*          
            MOVE SPACES                TO K595-KEY-FLD.                         
            MOVE K800-NUM-REGN         TO K595-NUM-REGN-REF.                    
                                                                                
            MOVE 'N'                   TO  WS-K595-EOF.                         
                                                                                
           START BP13K595 KEY >= K595-KEY-FLD                                   
           IF WS-K595-STATUS = ZEROS                                            
              PERFORM 8700-READNEXT-BP13K595 THRU 8700-EXIT                     
                 UNTIL K595-NUM-REGN-REF NOT = K800-NUM-REGN                    
                    OR WS-K595-EOF = 'Y'                                        
           ELSE                                                                 
              DISPLAY 'START BROWSE ERROR, BP13K595 STATUS IS '                 
                      WS-K595-STATUS                                            
              MOVE WS-K595-STATUS           TO RETURN-CODE                      
              PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                         
           END-IF.                                                              
                                                                                
       8600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------*          
       8700-READNEXT-BP13K595.                                                  
      *--------------------------------------------------------------*          
                                                                                
           READ BP13K595 NEXT                                                   
                AT END                                                          
                   MOVE 'Y'      TO WS-K595-EOF                                 
           END-READ.                                                            
                                                                                
           IF K800-NUM-REGN  = K595-NUM-REGN-REF                                
              IF (K595-CDE-REQUEST-STATUS NOT = SPACES AND                      
                                                LOW-VALUES) AND                 
                 (K595-NUM-NT-FT-QUEUE NOT = SPACES AND LOW-VALUES)             
                  AND (K800-NUM-ALLOC-TAG = 'NC' OR 'NF' OR 'NV')               
                  MOVE K800-NUM-ALLOC-TAG   TO K595-NUM-BOOK-STATUS             
                  REWRITE BP13K595-REC                                          
                                                                                
                  EVALUATE WS-K595-STATUS                                       
                    WHEN 00                                                     
                    WHEN 02                                                     
                        ADD 1    TO WS-CNT-K595-UPD                             
                        CONTINUE                                                
                    WHEN OTHER                                                  
                        DISPLAY 'ERROR UPDATING BP13K595. STATUS IS '           
                             WS-K595-STATUS                                     
                        PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT              
                  END-EVALUATE                                                  
              END-IF                                                            
           ELSE                                                                 
              MOVE 'Y'      TO WS-K595-EOF                                      
           END-IF.                                                              
                                                                                
       8700-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------------*          
       9000-PROCESS-CDB.                                                        
      *--------------------------------------------------------------*          
           MOVE SPACES                   TO BP13K820-REC.                       
           INITIALIZE                       BP13K820-REC.                       
                                                                                
           MOVE 'N'                      TO WS-K820-EOF                         
                                            WS-REC-PROCESS.                     
                                                                                
           MOVE F800-NUM-REGN            TO K820-NUM-REGN.                      
                                                                                
           START BP13K820 KEY >= K820-KEY-FLD.                                  
                                                                                
           EVALUATE WS-K820-STATUS                                              
               WHEN 00                                                          
                    PERFORM 9100-READNEXT-BP13K820 THRU 9100-EXIT               
                      UNTIL K820-NUM-REGN NOT = F800-NUM-REGN                   
                         OR WS-K820-EOF = 'Y'                                   
               WHEN 10                                                          
               WHEN 23                                                          
                    ADD 1                TO WS-K820-NOTFND                      
               WHEN OTHER                                                       
                    DISPLAY 'BP13K820 START BROWSE ERROR : '                    
                            WS-K820-STATUS                                      
                    MOVE WS-K820-STATUS  TO RETURN-CODE                         
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *--------------------------------------------------------------*          
       9100-READNEXT-BP13K820.                                                  
      *--------------------------------------------------------------*          
                                                                                
           READ BP13K820 NEXT RECORD.                                           
                                                                                
           EVALUATE WS-K820-STATUS                                              
               WHEN 00                                                          
                    IF K820-NUM-REGN = F800-NUM-REGN                            
                       MOVE 'Y'          TO WS-K820-FOUND                       
                                            WS-REC-PROCESS                      
                       PERFORM 9200-WRITE-BP13F915 THRU 9200-EXIT               
                    ELSE                                                        
                       IF WS-REC-PROCESS = 'N'                                  
                          ADD 1          TO WS-K820-NOTFND                      
                       END-IF                                                   
                       MOVE 'Y'          TO WS-K820-EOF                         
                    END-IF                                                      
               WHEN 10                                                          
               WHEN 23                                                          
                    ADD 1                TO WS-K820-NOTFND                      
                    MOVE 'Y'             TO WS-K820-EOF                         
               WHEN OTHER                                                       
                    DISPLAY 'BP13K820 READ NEXT ERROR : ' WS-K820-STATUS        
                    MOVE WS-K820-STATUS  TO RETURN-CODE                         
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       9100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *************************************************************             
       9200-WRITE-BP13F915.                                                     
      *************************************************************             
           IF K820-NUM-CSTMR-SOURCE NOT = SPACES AND LOW-VALUES                 
              MOVE SPACES                   TO BP13F915-REC                     
              INITIALIZE                       BP13F915-REC                     
                                                                                
              MOVE  'TE'                    TO F915-TXN-TYPE                    
              MOVE  'P'                     TO F915-CSTMR-TYPE                  
              MOVE  'BP13'                  TO F915-NUM-UPDATE-SOURCE           
              MOVE  'BP13C20L'              TO F915-NUM-UPDATE-USERID           
              MOVE  K820-NUM-CSTMR-SOURCE   TO F915-NUM-CSTMR-SOURCE            
                                                                                
              IF K820-NUM-NRIC = K800-NUM-NRIC1                                 
                 MOVE '011'                 TO F915-NUM-ROLE                    
              ELSE                                                              
                 IF (K820-NUM-NRIC = K800-NUM-NRIC2) OR                         
                    (K820-NUM-NRIC = K800-NUM-NRIC3) OR                         
                    (K820-NUM-NRIC = K800-NUM-NRIC4)                            
                     MOVE '012'             TO F915-NUM-ROLE                    
                 ELSE                                                           
                     MOVE '013'             TO F915-NUM-ROLE                    
                 END-IF                                                         
              END-IF                                                            
                                                                                
              MOVE  K820-NUM-REGN           TO F915-NUM-BSNS-REF                
                                                                                
              STRING K800-DTE-CANCEL(1:4) '-'                                   
                     K800-DTE-CANCEL(5:2) '-'                                   
                     K800-DTE-CANCEL(7:2)                                       
                     DELIMITED BY SIZE                                          
                INTO F915-DTE-ROLE-END                                          
                                                                                
              STRING WS-SYSTEM-DATE(1:4) '-'                                    
                     WS-SYSTEM-DATE(5:2) '-'                                    
                     WS-SYSTEM-DATE(7:2)                                        
                     DELIMITED BY SIZE                                          
                INTO F915-DTE-UPDATE-SOURCE                                     
                                                                                
              WRITE BP13F915-REC                                                
                                                                                
              ADD 1                         TO WS-CNT-F915-WRITE                
                                                                                
           END-IF.                                                              
                                                                                
       9200-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *--------------------------------------------------------------*          
       9999-CLOSE-ROUTINE.                                                      
      *--------------------------------------------------------------*          
                                                                                
           CLOSE BP13K800                                                       
                 BP13K840                                                       
                 BP13K820                                                       
                 BP13K848                                                       
                 BP13K810                                                       
                 P13F800C                                                       
                 P13F800D                                                       
                 BP13F915                                                       
                 BP13K893                                                       
                 BP13K595.                                                      
                                                                                
           EVALUATE WS-K800-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 MOVE WS-K800-STATUS        TO RETURN-CODE                      
                 DISPLAY 'CLOSE BP13K800 FAIL. STATUS=' WS-K800-STATUS          
           END-EVALUATE.                                                        
                                                                                
           EVALUATE WS-K840-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 MOVE WS-K840-STATUS        TO RETURN-CODE                      
                 DISPLAY 'CLOSE BP13K840 FAIL. STATUS=' WS-K840-STATUS          
           END-EVALUATE.                                                        
                                                                                
           EVALUATE WS-K820-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 MOVE WS-K820-STATUS        TO RETURN-CODE                      
                 DISPLAY 'CLOSE BP13K820 FAIL. STATUS=' WS-K820-STATUS          
           END-EVALUATE.                                                        
                                                                                
                                                                                
           EVALUATE WS-K848-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 MOVE WS-K848-STATUS        TO RETURN-CODE                      
                 DISPLAY 'CLOSE BP13K848 FAIL. STATUS=' WS-K848-STATUS          
           END-EVALUATE.                                                        
                                                                                
           EVALUATE WS-K810-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 MOVE WS-K810-STATUS        TO RETURN-CODE                      
                 DISPLAY 'CLOSE BP13K810 FAIL. STATUS=' WS-K810-STATUS          
           END-EVALUATE.                                                        
                                                                                
           EVALUATE WS-K595-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 MOVE WS-K595-STATUS        TO RETURN-CODE                      
                 DISPLAY 'CLOSE BP13K595 FAIL. STATUS=' WS-K595-STATUS          
           END-EVALUATE.                                                        
                                                                                
           EVALUATE WS-K893-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 MOVE WS-K893-STATUS        TO RETURN-CODE                      
                 DISPLAY 'CLOSE BP13K893 FAIL. STATUS=' WS-K893-STATUS          
           END-EVALUATE.                                                        
                                                                                
           DISPLAY SPACES.                                                      
           DISPLAY '********* BP13C20L CONTROL *********'.                      
           DISPLAY 'DATE : ' WS-EDITED-DATE.                                    
           DISPLAY SPACES.                                                      
           DISPLAY 'NO. OF READ (P13F800C) = ' WS-CNT-F800C-READ.               
           DISPLAY SPACES.                                                      
           DISPLAY 'NO. OF RECS NOT FOUND  = '.                                 
           DISPLAY '    (BP13K820)         = ' WS-K820-NOTFND.                  
           DISPLAY 'NO. OF RECS UPDATED    = '.                                 
           DISPLAY '    (BP13K800)         = ' WS-CNT-K800-UPD.                 
           DISPLAY 'NO. OF RECS UPDATED    = '.                                 
           DISPLAY '    (BP13K840)         = ' WS-CNT-K840-UPD.                 
           DISPLAY 'NO. OF RECS UPDATED    = '.                                 
           DISPLAY '    (BP13K893)         = ' WS-CNT-K893-UPD.                 
           DISPLAY 'NO. OF RECS WRITE      = '.                                 
           DISPLAY '    (BP13K840)         = ' WS-CNT-K840-WRITE.               
           DISPLAY SPACES.                                                      
           DISPLAY 'NO. OF RECS WRITE      = '.                                 
           DISPLAY '    (BP13K848)         = ' WS-CNT-K848-WRITE.               
           DISPLAY SPACES.                                                      
           DISPLAY 'NO. OF RECS WRITE      = '.                                 
           DISPLAY '    (BP13K810)         = ' WS-CNT-K810-WRITE.               
           DISPLAY SPACES.                                                      
           DISPLAY 'NO. OF RECS WRITE      = ' .                                
           DISPLAY '    (P13F800D)         = ' WS-F800D-WRITE.                  
           DISPLAY 'NO. OF RECS WRITE      = ' .                                
           DISPLAY '    (BP13F915)         = ' WS-CNT-F915-WRITE.               
           DISPLAY SPACES.                                                      
           DISPLAY '************************************'.                      
                                                                                
           STOP RUN.                                                            
                                                                                
       9999-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ***************** E N D  O F  P R O G R A M *****************             
