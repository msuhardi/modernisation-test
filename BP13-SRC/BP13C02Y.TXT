      *-----------------------*                                                 
       IDENTIFICATION DIVISION.                                                 
      *-----------------------*                                                 
       PROGRAM-ID.    BP13C02Y.                                                 
      *AUTHOR.        ZARITA DANE SARMIENTO.                                    
      *DTE WRITTEN.   31AUG2010.                                                
      **********************************************************                
      *    SYSTEM NAME : SYSTEM OF COMMITMENT                  *                
      *    SYSTEM ID   : BP13                                  *                
      **********************************************************                
      *                                                        *                
      *    OBJECTIVES  :                                       *                
      *                                                        *                
      *    1.  TO CREATE APPLICATION DATA ON EC   REQUEST FOR  *                
      *         DEVELOPER VIA SFTP.                            *                
      *                                                        *                
      *    INPUT FILES : BP13FA80 - DBS FILE                   *                
      *                                                        *                
      *    OUTPUT FILE : BP13FB66 - FTP FILE TO BE SENT TO SIM *                
      *                             LIAN                       *                
      *                                                        *                
      *--------------------------------------------------------*                
      * CHG-NO   BY    DATE   DETAILS                          *                
      * ======= ====  ======  ================================ *                
      * BP134015 ZDD1 310810  NEW PGM - PATTERN TO BP13C02E    *                
      * BP134443 IL5  170112  ADD CODES E11 AND K11            *                
      *                       SAME PROCESS AS E01              *                
      * BP134443 IL5  080212  REMOVE K11                       *                
      *                       SEND RECORDS BOOKED AFTER 10PM   *                
      *                       NEXT DAY                         *                
      * BP134704 SMR2 221112  ADD NUM-SHARE-VALUE              *                
      * BP134789 IL5  100513  PROCESS E20 LIKE E11             *                
      * BP139607 MRR5 260623  ADD OTHR-PRVTE-PRPRTY            *                
      * ====================================================== *                
                                                                                
      *-----------------------*                                                 
       ENVIRONMENT DIVISION.                                                    
      *-----------------------*                                                 
       CONFIGURATION SECTION.                                                   
      *-----------------------*                                                 
                                                                                
       SOURCE-COMPUTER. IBM-9121.                                               
       OBJECT-COMPUTER. IBM-9121.                                               
                                                                                
      *-----------------------*                                                 
       INPUT-OUTPUT SECTION.                                                    
      *-----------------------*                                                 
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13FA80 ASSIGN    TO BP13FA80.                               
                                                                                
           SELECT BP13FB66 ASSIGN    TO BP13FB66.                               
                                                                                
           SELECT BP13KA30 ASSIGN    TO BP13KA30                                
                           ACCESS MODE   IS DYNAMIC                             
                           ORGANIZATION  IS INDEXED                             
                           RECORD KEY    IS KA30-KEY-FLD                        
                           ALTERNATE KEY IS KA30-NUM-REGN                       
                           FILE STATUS   IS WS-KA30-STATUS.                     
                                                                                
      *-----------------------*                                                 
       DATA DIVISION.                                                           
      *-----------------------*                                                 
       FILE SECTION.                                                            
      *-----------------------*                                                 
                                                                                
       FD   BP13FA80                                                            
            BLOCK      CONTAINS 0    RECORDS                                    
            RECORD     CONTAINS 4000 CHARACTERS                                 
            LABEL      RECORDS  ARE  STANDARD                                   
            RECORDING  MODE     IS  F.                                          
       COPY BP13FA80.                                                           
                                                                                
       FD   BP13KA30                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13KA30.                                                           
                                                                                
                                                                                
       FD   BP13FB66                                                            
            BLOCK     CONTAINS 0   RECORDS                                      
            RECORD    CONTAINS 3000 CHARACTERS                                  
            LABEL     RECORDS  ARE OMITTED                                      
            RECORDING MODE     IS  F.                                           
       COPY BP13FB66.                                                           
                                                                                
                                                                                
      *-----------------------*                                                 
       WORKING-STORAGE SECTION.                                                 
      *-----------------------*                                                 
                                                                                
       COPY IDPTABLE.                                                           
                                                                                
       01  WS-FILE-CONTROLS.                                                    
           05  WS-FA80-EOF-SW             PIC X(1)    VALUE 'N'.                
           05  WS-KA30-STATUS             PIC X(2)    VALUE SPACES.             
                                                                                
       01  WS-RECORD-COUNTERS.                                                  
           05  WS-CNT-FB66                PIC 9(5) COMP VALUE 0.                
           05  WS-CNT-FA80                PIC 9(5) COMP VALUE 0.                
                                                                                
       01  WS-DATES.                                                            
           05  WS-EDITED-DATE.                                                  
               10  WS-EDITED-DD           PIC 9(2).                             
               10  FILLER                 PIC X(1)    VALUE '/'.                
               10  WS-EDITED-MM           PIC 9(2).                             
               10  FILLER                 PIC X(1)    VALUE '/'.                
               10  WS-EDITED-YY           PIC 9(4).                             
           05  WS-CURRENT-DATE.                                                 
               10  WS-CURR-CCYY.                                                
                   15  WS-CURR-YY         PIC 9(4).                             
               10  WS-CURR-MM             PIC 9(2).                             
               10  WS-CURR-DD             PIC 9(2).                             
                                                                                
       01  WS-SYSTEM-DATE.                                                      
           05  WS-TODAY-DATE.                                                   
               10  WS-SYS-YY              PIC 9(4).                             
               10  WS-SYS-MM              PIC 9(2).                             
               10  WS-SYS-DD              PIC 9(2).                             
           05  WS-TODAY-DATE1 REDEFINES WS-TODAY-DATE PIC 9(8).                 
           05  WS-TIME-NUM                PIC 9(9).                             
           05  WS-TIME REDEFINES WS-TIME-NUM.                                   
               10  WS-HH                  PIC 9(2).                             
               10  WS-MM                  PIC 9(2).                             
               10  WS-SS                  PIC 9(2).                             
               10  WS-GG                  PIC 9(2).                             
                                                                                
       01  WS-DATE-COMPUTE.                                                     
           05  WS-DATE-INT                PIC S9(9).                            
                                                                                
       01  WS-HHMM-START.                                                       
           05  WS-START-HH                PIC 9(2).                             
           05  WS-START-MM                PIC 9(2).                             
                                                                                
       01  WS-HHMM-END.                                                         
           05  WS-END-HH                  PIC 9(2).                             
           05  WS-END-MM                  PIC 9(2).                             
                                                                                
       01  WS-CHECK-DATE.                                                       
           05  WS-FA80-DTE-REQUESTED      PIC X(8).                             
           05  WS-DATE-CHAR REDEFINES WS-FA80-DTE-REQUESTED.                    
               10  WS-FA80-DATE           PIC 9(8).                             
                                                                                
       01  WS-CHECK-TIME.                                                       
           05  WS-FA80-TME-REQUESTED      PIC X(8).                             
           05  WS-HH-CHAR2 REDEFINES WS-FA80-TME-REQUESTED.                     
               10  WS-FA80-HHMM           PIC 9(4).                             
               10  WS-FA80-SS             PIC 9(2).                             
               10  WS-FA80-GG             PIC 9(2).                             
                                                                                
       77  WS-PREV-DATE                   PIC 9(8).                             
                                                                                
       01  WS-TEMPORARY-FIELDS.                                                 
           05  WS-TEMP-NAME               PIC X(66).                            
           05  WS-TEMP-DTE-BIRTH          PIC X(10).                            
           05  WS-TEMP-REGN               PIC X(8).                             
           05  WS-TEMP-NRIC               PIC X(9).                             
           05  WS-TEMP-MSTATUS            PIC X(1).                             
           05  WS-TEMP-INCOME             PIC X(5).                             
           05  WS-TEMP-CITIZENSHIP        PIC X(2).                             
           05  WS-TEMP-RELATIONSHIP       PIC X(2).                             
           05  WS-TEMP-LESSEE             PIC X(1).                             
           05  WS-TEMP-RACE               PIC X(1).                             
           05  WS-TEMP-SEX                PIC X(1).                             
           05  WS-TEMP-NRIC-SPOUSE        PIC X(9).                             
           05  WS-TEMP-EDN-LVL            PIC X(1).                             
           05  WS-TEMP-PHONE              PIC X(8).                             
           05  WS-TEMP-HP-PAGER           PIC X(8).                             
                                                                                
       01  WS-OTHERS.                                                           
           05  WS-OCC-REL                 PIC X(2).                             
           05  WS-TMP-REL                 PIC X(2).                             
           05  WS-TMP-EDN                 PIC 9(1).                             
           05  WS-FOUND-SW                PIC X(1)    VALUE 'N'.                
           05  WS-DESC                    PIC X(3)    VALUE SPACES.             
                                                                                
      *-----------------------*                                                 
       PROCEDURE DIVISION.                                                      
      *-----------------------*                                                 
                                                                                
      ******************************************************************        
       0000-MAIN.                                                               
      ******************************************************************        
           PERFORM  1000-OPEN-FILES         THRU 1000-EXIT.                     
           PERFORM  2000-MAIN-ROUTINE       THRU 2000-EXIT.                     
           PERFORM  9000-CLOSE-FILES        THRU 9000-EXIT.                     
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       1000-OPEN-FILES.                                                         
      ******************************************************************        
           OPEN INPUT  BP13FA80                                                 
                       BP13KA30                                                 
                OUTPUT BP13FB66.                                                
                                                                                
           IF WS-KA30-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPEN ERROR, BP13KA30-STATUS ' WS-KA30-STATUS             
              MOVE     WS-KA30-STATUS TO RETURN-CODE                            
              PERFORM  9000-CLOSE-FILES       THRU 9000-EXIT                    
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE TO WS-SYSTEM-DATE                         
           MOVE   WS-SYS-YY                TO    WS-EDITED-YY                   
                                                 WS-CURR-YY.                    
           MOVE   WS-SYS-MM                TO    WS-EDITED-MM                   
                                                 WS-CURR-MM.                    
           MOVE   WS-SYS-DD                TO    WS-EDITED-DD                   
                                                 WS-CURR-DD.                    
                                                                                
           IF WS-HH =  08                                                       
              MOVE 22     TO WS-START-HH                                        
              MOVE 00     TO WS-START-MM                                        
              MOVE WS-HH  TO WS-END-HH                                          
              MOVE 00     TO WS-END-MM                                          
           ELSE                                                                 
              COMPUTE WS-START-HH = WS-HH - 1                                   
              MOVE 00       TO WS-START-MM                                      
              MOVE    WS-HH TO WS-END-HH                                        
              MOVE 00       TO WS-END-MM                                        
           END-IF.                                                              
                                                                                
           COMPUTE WS-DATE-INT  =                                               
                            FUNCTION INTEGER-OF-DATE(WS-TODAY-DATE1)            
           COMPUTE WS-DATE-INT  = WS-DATE-INT - 1                               
           COMPUTE WS-PREV-DATE =                                               
                            FUNCTION DATE-OF-INTEGER(WS-DATE-INT).              
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       2000-MAIN-ROUTINE.                                                       
      ******************************************************************        
           PERFORM  3000-BP13FA80-READ     THRU 3000-EXIT.                      
                                                                                
           PERFORM  4000-PROCESS-FA80-REC  THRU 4000-EXIT                       
              UNTIL WS-FA80-EOF-SW = 'Y'.                                       
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       3000-BP13FA80-READ.                                                      
      ******************************************************************        
           READ BP13FA80                                                        
              AT END MOVE 'Y'     TO WS-FA80-EOF-SW                             
              GO TO  3000-EXIT                                                  
           END-READ.                                                            
                                                                                
           ADD +1                 TO WS-CNT-FA80.                               
                                                                                
           PERFORM 3100-EDIT-NUMERIC-FIELDS    THRU 3100-EXIT.                  
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      **********************************************************                
       3100-EDIT-NUMERIC-FIELDS.                                                
      **********************************************************                
           INSPECT FA80-AMT-APPLT1-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS                                 
                                                                                
           INSPECT FA80-AMT-APPLT2-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS                                 
                                                                                
           INSPECT FA80-AMT-APPLT3-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS                                 
                                                                                
           INSPECT FA80-AMT-APPLT4-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS                                 
                                                                                
           INSPECT FA80-AMT-OCCUP1-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS                                 
                                                                                
           INSPECT FA80-AMT-OCCUP2-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS                                 
                                                                                
           INSPECT FA80-AMT-OCCUP3-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS                                 
                                                                                
           INSPECT FA80-AMT-OCCUP4-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS                                 
                                                                                
           INSPECT FA80-AMT-OCCUP5-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS                                 
                                                                                
           INSPECT FA80-AMT-OCCUP6-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS.                                
                                                                                
           INSPECT FA80-AMT-OCCUP7-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS.                                
                                                                                
           INSPECT FA80-AMT-OCCUP8-INCOME                                       
              REPLACING LEADING SPACES BY ZEROS.                                
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      **********************************************************                
       4000-PROCESS-FA80-REC.                                                   
      **********************************************************                
                                                                                
           IF FA80-NUM-REGN      = SPACE OR LOW-VALUES                          
              PERFORM 3000-BP13FA80-READ THRU 3000-EXIT                         
              GO TO 4000-EXIT.                                                  
                                                                                
           MOVE FA80-TME-LOG        TO WS-FA80-TME-REQUESTED.                   
           MOVE FA80-DTE-LOG        TO WS-FA80-DTE-REQUESTED.                   
                                                                                
           IF FA80-NUM-ACCEPTANCE NOT = 'A' AND 'R'                             
              PERFORM 3000-BP13FA80-READ THRU 3000-EXIT                         
              GO TO 4000-EXIT                                                   
           END-IF.                                                              
                                                                                
           EVALUATE FA80-NUM-PROJECT                                            
             WHEN 'E01'                                                         
             WHEN 'E11'                                                         
             WHEN 'E20'                                                         
               IF WS-HH = 08                                                    
                  IF FA80-DTE-LOG = WS-PREV-DATE                                
                     IF WS-FA80-HHMM >= WS-HHMM-START                           
                         PERFORM 4300-FB66-WRITE         THRU 4300-EXIT         
                     END-IF                                                     
                  ELSE                                                          
                     IF FA80-DTE-LOG = WS-CURRENT-DATE                          
                        IF WS-FA80-HHMM < WS-HHMM-END                           
                         PERFORM 4300-FB66-WRITE         THRU 4300-EXIT         
                        END-IF                                                  
                     END-IF                                                     
                  END-IF                                                        
               ELSE                                                             
                  IF FA80-DTE-LOG   = WS-CURRENT-DATE                           
                     IF WS-FA80-HHMM  >= WS-HHMM-START                          
                        IF WS-FA80-HHMM < WS-HHMM-END                           
                         PERFORM 4300-FB66-WRITE         THRU 4300-EXIT         
                        END-IF                                                  
                     END-IF                                                     
                  END-IF                                                        
               END-IF                                                           
                                                                                
             WHEN OTHER                                                         
               IF FA80-DTE-LOG = WS-CURRENT-DATE OR                             
                 (FA80-DTE-LOG = WS-PREV-DATE AND                               
                  WS-FA80-HHMM >= 2200 AND                                      
                  WS-FA80-HHMM <= 2359)                                         
                  PERFORM 4300-FB66-WRITE         THRU 4300-EXIT                
               END-IF                                                           
                                                                                
           END-EVALUATE.                                                        
                                                                                
           PERFORM 3000-BP13FA80-READ      THRU 3000-EXIT.                      
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************************************************                
       4150-MOVE-SPOU-NRIC.                                                     
      **********************************************************                
      *--------------------------------------------------------*                
      * GET THE SPOUSE NRIC FROM FA80 AND MOVE TO K825         *                
      *--------------------------------------------------------*                
           MOVE SPACES  TO WS-TEMP-NRIC-SPOUSE.                                 
                                                                                
           EVALUATE TRUE                                                        
           WHEN WS-OCC-REL = '20'                                               
      *    ---MOVE THE HUSBUND NRIC TO WIFE'S    SPOUSE-NRIC FIELD              
                MOVE FA80-NUM-APPLT1-UIN  TO WS-TEMP-NRIC-SPOUSE                
                                                                                
           WHEN WS-OCC-REL = '00'                                               
      *    ---MOVE THE WIFE OR FIANCE NRIC TO HUSBUND'S SPOUSE-NRIC             
                MOVE '20'                 TO WS-TMP-REL                         
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                        
                                                                                
           WHEN WS-OCC-REL = '02'                                               
      *    ---MOVE THE MOTHER  NRIC TO FATHER'S  SPOUSE-NRIC FIELD              
                MOVE '12'                 TO WS-TMP-REL                         
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                        
                                                                                
           WHEN WS-OCC-REL = '12'                                               
      *    ---MOVE THE FATHER  NRIC TO MOTHER'S  SPOUSE-NRIC FIELD              
                MOVE '02'                 TO WS-TMP-REL                         
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                        
                                                                                
           WHEN WS-OCC-REL = '32'                                               
      *    ---MOVE THE FATHER-IN-LAW NRIC TO MOTHER'S  SPOUSE-NRIC              
                MOVE '22'                 TO WS-TMP-REL                         
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                        
                                                                                
           WHEN WS-OCC-REL = '22'                                               
      *    ---MOVE THE MOTHER-IN-LAW NRIC TO MOTHER'S  SPOUSE-NRIC              
                MOVE '32'                 TO WS-TMP-REL                         
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                        
                                                                                
           WHEN WS-OCC-REL = '98'                                               
      *    ---MOVE THE PARENTS NRIC                                             
                MOVE '98'                 TO WS-TMP-REL                         
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                        
                                                                                
           WHEN WS-OCC-REL = '01'                                               
      *    ---MOVE THE MOTHER-IN-LAW NRIC                                       
                MOVE '01'                 TO WS-TMP-REL                         
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                        
                                                                                
           WHEN WS-OCC-REL = '97'                                               
      *    ---MOVE THE MOTHER-IN-LAW NRIC                                       
                MOVE '97'                 TO WS-TMP-REL                         
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                        
                                                                                
           END-EVALUATE.                                                        
                                                                                
       4150-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      **********************************************************                
       4175-GET-SPOUSE.                                                         
      **********************************************************                
      *--------------------------------------------------------*                
      * GET THE SPOUSE NRIC FROM FA80 AND MOVE TO K825         *                
      *--------------------------------------------------------*                
           EVALUATE TRUE                                                        
           WHEN FA80-NUM-APPLT2-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FA80-NUM-APPLT2-UIN NOT = WS-TEMP-NRIC                          
                MOVE FA80-NUM-APPLT2-UIN TO WS-TEMP-NRIC-SPOUSE                 
                                                                                
           WHEN FA80-NUM-APPLT3-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FA80-NUM-APPLT3-UIN NOT = WS-TEMP-NRIC                          
                MOVE FA80-NUM-APPLT3-UIN TO WS-TEMP-NRIC-SPOUSE                 
                                                                                
           WHEN FA80-NUM-APPLT4-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FA80-NUM-APPLT4-UIN NOT = WS-TEMP-NRIC                          
                MOVE FA80-NUM-APPLT4-UIN TO WS-TEMP-NRIC-SPOUSE                 
                                                                                
           WHEN FA80-NUM-OCCUP1-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FA80-NUM-OCCUP1-UIN NOT = WS-TEMP-NRIC                          
                MOVE FA80-NUM-OCCUP1-UIN  TO WS-TEMP-NRIC-SPOUSE                
                                                                                
           WHEN FA80-NUM-OCCUP2-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FA80-NUM-OCCUP2-UIN NOT = WS-TEMP-NRIC                          
                MOVE FA80-NUM-OCCUP2-UIN  TO WS-TEMP-NRIC-SPOUSE                
                                                                                
           WHEN FA80-NUM-OCCUP3-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FA80-NUM-OCCUP3-UIN NOT = WS-TEMP-NRIC                          
                MOVE FA80-NUM-OCCUP3-UIN  TO WS-TEMP-NRIC-SPOUSE                
                                                                                
           WHEN FA80-NUM-OCCUP4-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FA80-NUM-OCCUP4-UIN NOT = WS-TEMP-NRIC                          
                MOVE FA80-NUM-OCCUP4-UIN  TO WS-TEMP-NRIC-SPOUSE                
                                                                                
           WHEN FA80-NUM-OCCUP5-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FA80-NUM-OCCUP5-UIN NOT = WS-TEMP-NRIC                          
                MOVE FA80-NUM-OCCUP5-UIN  TO WS-TEMP-NRIC-SPOUSE                
                                                                                
           WHEN FA80-NUM-OCCUP6-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FA80-NUM-OCCUP6-UIN NOT = WS-TEMP-NRIC                          
                MOVE FA80-NUM-OCCUP6-UIN  TO WS-TEMP-NRIC-SPOUSE                
                                                                                
           WHEN FA80-NUM-OCCUP7-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FA80-NUM-OCCUP7-UIN NOT = WS-TEMP-NRIC                          
                MOVE FA80-NUM-OCCUP7-UIN  TO WS-TEMP-NRIC-SPOUSE                
                                                                                
           WHEN FA80-NUM-OCCUP8-RLTNSP-APPLT1 = WS-TMP-REL AND                  
                FA80-NUM-OCCUP8-UIN NOT = WS-TEMP-NRIC                          
                MOVE FA80-NUM-OCCUP8-UIN  TO WS-TEMP-NRIC-SPOUSE                
                                                                                
           END-EVALUATE.                                                        
                                                                                
       4175-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      **********************************************************                
       4250-WRITE-CO-APPL.                                                      
      **********************************************************                
      *------------> APPLICANT  1                                               
           IF FA80-NUM-APPLT1-UIN NOT = SPACES                                  
              MOVE FA80-NUM-APPLT1-UIN            TO                            
                   FB66-NUM-APPLT1-UIN                                          
              MOVE FA80-NME-APPLT1                TO                            
                   FB66-NME-APPLT1                                              
              MOVE FA80-DTE-APPLT1-BIRTH          TO                            
                   FB66-DTE-APPLT1-BIRTH                                        
              MOVE FA80-NUM-APPLT1-RACE           TO                            
                   FB66-NUM-APPLT1-RACE                                         
              MOVE FA80-NUM-APPLT1-SEX            TO                            
                   FB66-NUM-APPLT1-SEX                                          
              MOVE FA80-NUM-APPLT1-MARITAL-STATUS TO                            
                   FB66-NUM-APPLT1-MARITAL-STATUS                               
              MOVE FA80-AMT-APPLT1-INCOME         TO                            
                   FB66-AMT-APPLT1-INCOME                                       
              MOVE FA80-NUM-APPLT1-EMPLY-STATUS   TO                            
                   FB66-NUM-APPLT1-EMPLY-STATUS                                 
              MOVE FA80-NME-APPLT1-OCCUPATION     TO                            
                   FB66-NME-APPLT1-OCCUPATION                                   
              MOVE FA80-NUM-APPLT1-PHONE          TO                            
                   FB66-NUM-APPLT1-PHONE                                        
              MOVE FA80-NUM-APPLT1-HP-PAGER       TO                            
                   FB66-NUM-APPLT1-HP-PAGER                                     
              MOVE FA80-NUM-APPLT1-EDN-LVL        TO                            
                   FB66-NUM-APPLT1-EDN-LVL                                      
              MOVE '00'                           TO WS-OCC-REL                 
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB66-NUM-APPLT1-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
      *------------> APPLICANT  2                                               
           IF FA80-NUM-APPLT2-UIN NOT = SPACES                                  
              MOVE FA80-NUM-APPLT2-UIN            TO                            
                   FB66-NUM-APPLT2-UIN                                          
              MOVE FA80-NME-APPLT2                TO                            
                   FB66-NME-APPLT2                                              
              MOVE FA80-NUM-APPLT2-CITIZENSHIP    TO                            
                   FB66-NUM-APPLT2-CITIZENSHIP                                  
              MOVE FA80-DTE-APPLT2-BIRTH          TO                            
                   FB66-DTE-APPLT2-BIRTH                                        
              MOVE FA80-NUM-APPLT2-RACE           TO                            
                   FB66-NUM-APPLT2-RACE                                         
              MOVE FA80-NUM-APPLT2-SEX            TO                            
                   FB66-NUM-APPLT2-SEX                                          
              MOVE FA80-NUM-APPLT2-MARITAL-STATUS TO                            
                   FB66-NUM-APPLT2-MARITAL-STATUS                               
              MOVE FA80-NUM-APPLT2-RLTNSP-APPLT1  TO                            
                   FB66-NUM-APPLT2-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FA80-AMT-APPLT2-INCOME         TO                            
                   FB66-AMT-APPLT2-INCOME                                       
              MOVE FA80-NUM-APPLT2-EMPLY-STATUS   TO                            
                   FB66-NUM-APPLT2-EMPLY-STATUS                                 
              MOVE FA80-NME-APPLT2-OCCUPATION     TO                            
                   FB66-NME-APPLT2-OCCUPATION                                   
              MOVE FA80-NUM-APPLT2-PHONE          TO                            
                   FB66-NUM-APPLT2-PHONE                                        
              MOVE FA80-NUM-APPLT2-HP-PAGER       TO                            
                   FB66-NUM-APPLT2-HP-PAGER                                     
              MOVE FA80-NUM-APPLT2-EDN-LVL        TO                            
                   FB66-NUM-APPLT2-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB66-NUM-APPLT2-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
      *------------> APPLICANT  3                                               
           IF FA80-NUM-APPLT3-UIN NOT = SPACES                                  
              MOVE FA80-NUM-APPLT3-UIN            TO                            
                   FB66-NUM-APPLT3-UIN                                          
              MOVE FA80-NME-APPLT3                TO                            
                   FB66-NME-APPLT3                                              
              MOVE FA80-NUM-APPLT3-CITIZENSHIP    TO                            
                   FB66-NUM-APPLT3-CITIZENSHIP                                  
              MOVE FA80-DTE-APPLT3-BIRTH          TO                            
                   FB66-DTE-APPLT3-BIRTH                                        
              MOVE FA80-NUM-APPLT3-RACE           TO                            
                   FB66-NUM-APPLT3-RACE                                         
              MOVE FA80-NUM-APPLT3-SEX            TO                            
                   FB66-NUM-APPLT3-SEX                                          
              MOVE FA80-NUM-APPLT3-MARITAL-STATUS TO                            
                   FB66-NUM-APPLT3-MARITAL-STATUS                               
              MOVE FA80-NUM-APPLT3-RLTNSP-APPLT1  TO                            
                   FB66-NUM-APPLT3-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FA80-AMT-APPLT3-INCOME         TO                            
                   FB66-AMT-APPLT3-INCOME                                       
              MOVE FA80-NUM-APPLT3-EMPLY-STATUS   TO                            
                   FB66-NUM-APPLT3-EMPLY-STATUS                                 
              MOVE FA80-NME-APPLT3-OCCUPATION     TO                            
                   FB66-NME-APPLT3-OCCUPATION                                   
              MOVE FA80-NUM-APPLT3-PHONE          TO                            
                   FB66-NUM-APPLT3-PHONE                                        
              MOVE FA80-NUM-APPLT3-HP-PAGER       TO                            
                   FB66-NUM-APPLT3-HP-PAGER                                     
              MOVE FA80-NUM-APPLT3-EDN-LVL        TO                            
                   FB66-NUM-APPLT3-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB66-NUM-APPLT3-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
      *------------> APPLICANT  4                                               
           IF FA80-NUM-APPLT4-UIN NOT = SPACES                                  
              MOVE FA80-NUM-APPLT4-UIN            TO                            
                   FB66-NUM-APPLT4-UIN                                          
              MOVE FA80-NME-APPLT4                TO                            
                   FB66-NME-APPLT4                                              
              MOVE FA80-NUM-APPLT4-CITIZENSHIP    TO                            
                   FB66-NUM-APPLT4-CITIZENSHIP                                  
              MOVE FA80-DTE-APPLT4-BIRTH          TO                            
                   FB66-DTE-APPLT4-BIRTH                                        
              MOVE FA80-NUM-APPLT4-RACE           TO                            
                   FB66-NUM-APPLT4-RACE                                         
              MOVE FA80-NUM-APPLT4-SEX            TO                            
                   FB66-NUM-APPLT4-SEX                                          
              MOVE FA80-NUM-APPLT4-MARITAL-STATUS TO                            
                   FB66-NUM-APPLT4-MARITAL-STATUS                               
              MOVE FA80-NUM-APPLT4-RLTNSP-APPLT1  TO                            
                   FB66-NUM-APPLT4-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FA80-AMT-APPLT4-INCOME         TO                            
                   FB66-AMT-APPLT4-INCOME                                       
              MOVE FA80-NUM-APPLT4-EMPLY-STATUS   TO                            
                   FB66-NUM-APPLT4-EMPLY-STATUS                                 
              MOVE FA80-NME-APPLT4-OCCUPATION     TO                            
                   FB66-NME-APPLT4-OCCUPATION                                   
              MOVE FA80-NUM-APPLT4-PHONE          TO                            
                   FB66-NUM-APPLT4-PHONE                                        
              MOVE FA80-NUM-APPLT4-HP-PAGER       TO                            
                   FB66-NUM-APPLT4-HP-PAGER                                     
              MOVE FA80-NUM-APPLT4-EDN-LVL        TO                            
                   FB66-NUM-APPLT4-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB66-NUM-APPLT4-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
                                                                                
       4250-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      **********************************************************                
       4260-WRITE-OCCUP.                                                        
      **********************************************************                
           MOVE SPACES                          TO WS-TEMP-NRIC-SPOUSE.         
                                                                                
      *------------> OCCUPANT  1                                                
           IF FA80-NUM-OCCUP1-UIN NOT = SPACES                                  
              MOVE FA80-NUM-OCCUP1-UIN            TO                            
                   FB66-NUM-OCCUP1-UIN                                          
              MOVE FA80-NME-OCCUP1                TO                            
                   FB66-NME-OCCUP1                                              
              MOVE FA80-NUM-OCCUP1-CITIZENSHIP    TO                            
                   FB66-NUM-OCCUP1-CITIZENSHIP                                  
              MOVE FA80-DTE-OCCUP1-BIRTH          TO                            
                   FB66-DTE-OCCUP1-BIRTH                                        
              MOVE FA80-NUM-OCCUP1-RACE           TO                            
                   FB66-NUM-OCCUP1-RACE                                         
              MOVE FA80-NUM-OCCUP1-SEX            TO                            
                   FB66-NUM-OCCUP1-SEX                                          
              MOVE FA80-NUM-OCCUP1-MARITAL-STATUS TO                            
                   FB66-NUM-OCCUP1-MARITAL-STATUS                               
              MOVE FA80-NUM-OCCUP1-RLTNSP-APPLT1  TO                            
                   FB66-NUM-OCCUP1-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FA80-AMT-OCCUP1-INCOME         TO                            
                   FB66-AMT-OCCUP1-INCOME                                       
              MOVE FA80-NUM-OCCUP1-EMPLY-STATUS   TO                            
                   FB66-NUM-OCCUP1-EMPLY-STATUS                                 
              MOVE FA80-NME-OCCUP1-OCCUPATION     TO                            
                   FB66-NME-OCCUP1-OCCUPATION                                   
              MOVE FA80-NUM-OCCUP1-PHONE          TO                            
                   FB66-NUM-OCCUP1-PHONE                                        
              MOVE FA80-NUM-OCCUP1-HP-PAGER       TO                            
                   FB66-NUM-OCCUP1-HP-PAGER                                     
              MOVE FA80-NUM-OCCUP1-EDN-LVL        TO                            
                   FB66-NUM-OCCUP1-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB66-NUM-OCCUP1-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
      *------------> OCCUPANT  2                                                
           IF FA80-NUM-OCCUP2-UIN NOT = SPACES                                  
              MOVE FA80-NUM-OCCUP2-UIN            TO                            
                   FB66-NUM-OCCUP2-UIN                                          
              MOVE FA80-NME-OCCUP2                TO                            
                   FB66-NME-OCCUP2                                              
              MOVE FA80-NUM-OCCUP2-CITIZENSHIP    TO                            
                   FB66-NUM-OCCUP2-CITIZENSHIP                                  
              MOVE FA80-DTE-OCCUP2-BIRTH          TO                            
                   FB66-DTE-OCCUP2-BIRTH                                        
              MOVE FA80-NUM-OCCUP2-RACE           TO                            
                   FB66-NUM-OCCUP2-RACE                                         
              MOVE FA80-NUM-OCCUP2-SEX            TO                            
                   FB66-NUM-OCCUP2-SEX                                          
              MOVE FA80-NUM-OCCUP2-MARITAL-STATUS TO                            
                   FB66-NUM-OCCUP2-MARITAL-STATUS                               
              MOVE FA80-NUM-OCCUP2-RLTNSP-APPLT1  TO                            
                   FB66-NUM-OCCUP2-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FA80-AMT-OCCUP2-INCOME         TO                            
                   FB66-AMT-OCCUP2-INCOME                                       
              MOVE FA80-NUM-OCCUP2-EMPLY-STATUS   TO                            
                   FB66-NUM-OCCUP2-EMPLY-STATUS                                 
              MOVE FA80-NME-OCCUP2-OCCUPATION     TO                            
                   FB66-NME-OCCUP2-OCCUPATION                                   
              MOVE FA80-NUM-OCCUP2-PHONE          TO                            
                   FB66-NUM-OCCUP2-PHONE                                        
              MOVE FA80-NUM-OCCUP2-HP-PAGER       TO                            
                   FB66-NUM-OCCUP2-HP-PAGER                                     
              MOVE FA80-NUM-OCCUP2-EDN-LVL        TO                            
                   FB66-NUM-OCCUP2-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB66-NUM-OCCUP2-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
      *------------> OCCUPANT  3                                                
           IF FA80-NUM-OCCUP3-UIN NOT = SPACES                                  
              MOVE FA80-NUM-OCCUP3-UIN            TO                            
                   FB66-NUM-OCCUP3-UIN                                          
              MOVE FA80-NME-OCCUP3                TO                            
                   FB66-NME-OCCUP3                                              
              MOVE FA80-NUM-OCCUP3-CITIZENSHIP    TO                            
                   FB66-NUM-OCCUP3-CITIZENSHIP                                  
              MOVE FA80-DTE-OCCUP3-BIRTH          TO                            
                   FB66-DTE-OCCUP3-BIRTH                                        
              MOVE FA80-NUM-OCCUP3-RACE           TO                            
                   FB66-NUM-OCCUP3-RACE                                         
              MOVE FA80-NUM-OCCUP3-SEX            TO                            
                   FB66-NUM-OCCUP3-SEX                                          
              MOVE FA80-NUM-OCCUP3-MARITAL-STATUS TO                            
                   FB66-NUM-OCCUP3-MARITAL-STATUS                               
              MOVE FA80-NUM-OCCUP3-RLTNSP-APPLT1  TO                            
                   FB66-NUM-OCCUP3-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FA80-AMT-OCCUP3-INCOME         TO                            
                   FB66-AMT-OCCUP3-INCOME                                       
              MOVE FA80-NUM-OCCUP3-EMPLY-STATUS   TO                            
                   FB66-NUM-OCCUP3-EMPLY-STATUS                                 
              MOVE FA80-NME-OCCUP3-OCCUPATION     TO                            
                   FB66-NME-OCCUP3-OCCUPATION                                   
              MOVE FA80-NUM-OCCUP3-PHONE          TO                            
                   FB66-NUM-OCCUP3-PHONE                                        
              MOVE FA80-NUM-OCCUP3-HP-PAGER       TO                            
                   FB66-NUM-OCCUP3-HP-PAGER                                     
              MOVE FA80-NUM-OCCUP3-EDN-LVL        TO                            
                   FB66-NUM-OCCUP3-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB66-NUM-OCCUP3-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
      *------------> OCCUPANT  4                                                
           IF FA80-NUM-OCCUP4-UIN NOT = SPACES                                  
              MOVE FA80-NUM-OCCUP4-UIN            TO                            
                   FB66-NUM-OCCUP4-UIN                                          
              MOVE FA80-NME-OCCUP4                TO                            
                   FB66-NME-OCCUP4                                              
              MOVE FA80-NUM-OCCUP4-CITIZENSHIP    TO                            
                   FB66-NUM-OCCUP4-CITIZENSHIP                                  
              MOVE FA80-DTE-OCCUP4-BIRTH          TO                            
                   FB66-DTE-OCCUP4-BIRTH                                        
              MOVE FA80-NUM-OCCUP4-RACE           TO                            
                   FB66-NUM-OCCUP4-RACE                                         
              MOVE FA80-NUM-OCCUP4-SEX            TO                            
                   FB66-NUM-OCCUP4-SEX                                          
              MOVE FA80-NUM-OCCUP4-MARITAL-STATUS TO                            
                   FB66-NUM-OCCUP4-MARITAL-STATUS                               
              MOVE FA80-NUM-OCCUP4-RLTNSP-APPLT1  TO                            
                   FB66-NUM-OCCUP4-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FA80-AMT-OCCUP4-INCOME         TO                            
                   FB66-AMT-OCCUP4-INCOME                                       
              MOVE FA80-NUM-OCCUP4-EMPLY-STATUS   TO                            
                   FB66-NUM-OCCUP4-EMPLY-STATUS                                 
              MOVE FA80-NME-OCCUP4-OCCUPATION     TO                            
                   FB66-NME-OCCUP4-OCCUPATION                                   
              MOVE FA80-NUM-OCCUP4-PHONE          TO                            
                   FB66-NUM-OCCUP4-PHONE                                        
              MOVE FA80-NUM-OCCUP4-HP-PAGER       TO                            
                   FB66-NUM-OCCUP4-HP-PAGER                                     
              MOVE FA80-NUM-OCCUP4-EDN-LVL        TO                            
                   FB66-NUM-OCCUP4-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB66-NUM-OCCUP4-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
      *------------> OCCUPANT  5                                                
           IF FA80-NUM-OCCUP5-UIN NOT = SPACES                                  
              MOVE FA80-NUM-OCCUP5-UIN            TO                            
                   FB66-NUM-OCCUP5-UIN                                          
              MOVE FA80-NME-OCCUP5                TO                            
                   FB66-NME-OCCUP5                                              
              MOVE FA80-NUM-OCCUP5-CITIZENSHIP    TO                            
                   FB66-NUM-OCCUP5-CITIZENSHIP                                  
              MOVE FA80-DTE-OCCUP5-BIRTH          TO                            
                   FB66-DTE-OCCUP5-BIRTH                                        
              MOVE FA80-NUM-OCCUP5-RACE           TO                            
                   FB66-NUM-OCCUP5-RACE                                         
              MOVE FA80-NUM-OCCUP5-SEX            TO                            
                   FB66-NUM-OCCUP5-SEX                                          
              MOVE FA80-NUM-OCCUP5-MARITAL-STATUS TO                            
                   FB66-NUM-OCCUP5-MARITAL-STATUS                               
              MOVE FA80-NUM-OCCUP5-RLTNSP-APPLT1  TO                            
                   FB66-NUM-OCCUP5-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FA80-AMT-OCCUP5-INCOME         TO                            
                   FB66-AMT-OCCUP5-INCOME                                       
              MOVE FA80-NUM-OCCUP5-EMPLY-STATUS   TO                            
                   FB66-NUM-OCCUP5-EMPLY-STATUS                                 
              MOVE FA80-NME-OCCUP5-OCCUPATION     TO                            
                   FB66-NME-OCCUP5-OCCUPATION                                   
              MOVE FA80-NUM-OCCUP5-PHONE          TO                            
                   FB66-NUM-OCCUP5-PHONE                                        
              MOVE FA80-NUM-OCCUP5-HP-PAGER       TO                            
                   FB66-NUM-OCCUP5-HP-PAGER                                     
              MOVE FA80-NUM-OCCUP5-EDN-LVL        TO                            
                   FB66-NUM-OCCUP5-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB66-NUM-OCCUP5-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
      *------------> OCCUPANT  6                                                
           IF FA80-NUM-OCCUP6-UIN NOT = SPACES                                  
              MOVE FA80-NUM-OCCUP6-UIN            TO                            
                   FB66-NUM-OCCUP6-UIN                                          
              MOVE FA80-NME-OCCUP6                TO                            
                   FB66-NME-OCCUP6                                              
              MOVE FA80-NUM-OCCUP6-CITIZENSHIP    TO                            
                   FB66-NUM-OCCUP6-CITIZENSHIP                                  
              MOVE FA80-DTE-OCCUP6-BIRTH          TO                            
                   FB66-DTE-OCCUP6-BIRTH                                        
              MOVE FA80-NUM-OCCUP6-RACE           TO                            
                   FB66-NUM-OCCUP6-RACE                                         
              MOVE FA80-NUM-OCCUP6-SEX            TO                            
                   FB66-NUM-OCCUP6-SEX                                          
              MOVE FA80-NUM-OCCUP6-MARITAL-STATUS TO                            
                   FB66-NUM-OCCUP6-MARITAL-STATUS                               
              MOVE FA80-NUM-OCCUP6-RLTNSP-APPLT1  TO                            
                   FB66-NUM-OCCUP6-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FA80-AMT-OCCUP6-INCOME         TO                            
                   FB66-AMT-OCCUP6-INCOME                                       
              MOVE FA80-NUM-OCCUP6-EMPLY-STATUS   TO                            
                   FB66-NUM-OCCUP6-EMPLY-STATUS                                 
              MOVE FA80-NME-OCCUP6-OCCUPATION     TO                            
                   FB66-NME-OCCUP6-OCCUPATION                                   
              MOVE FA80-NUM-OCCUP6-PHONE          TO                            
                   FB66-NUM-OCCUP6-PHONE                                        
              MOVE FA80-NUM-OCCUP6-HP-PAGER       TO                            
                   FB66-NUM-OCCUP6-HP-PAGER                                     
              MOVE FA80-NUM-OCCUP6-EDN-LVL        TO                            
                   FB66-NUM-OCCUP6-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB66-NUM-OCCUP6-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
      *------------> OCCUPANT  7                                                
           IF FA80-NUM-OCCUP7-UIN NOT = SPACES                                  
              MOVE FA80-NUM-OCCUP7-UIN            TO                            
                   FB66-NUM-OCCUP7-UIN                                          
              MOVE FA80-NME-OCCUP7                TO                            
                   FB66-NME-OCCUP7                                              
              MOVE FA80-NUM-OCCUP7-CITIZENSHIP    TO                            
                   FB66-NUM-OCCUP7-CITIZENSHIP                                  
              MOVE FA80-DTE-OCCUP7-BIRTH          TO                            
                   FB66-DTE-OCCUP7-BIRTH                                        
              MOVE FA80-NUM-OCCUP7-RACE           TO                            
                   FB66-NUM-OCCUP7-RACE                                         
              MOVE FA80-NUM-OCCUP7-SEX            TO                            
                   FB66-NUM-OCCUP7-SEX                                          
              MOVE FA80-NUM-OCCUP7-MARITAL-STATUS TO                            
                   FB66-NUM-OCCUP7-MARITAL-STATUS                               
              MOVE FA80-NUM-OCCUP7-RLTNSP-APPLT1  TO                            
                   FB66-NUM-OCCUP7-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FA80-AMT-OCCUP7-INCOME         TO                            
                   FB66-AMT-OCCUP7-INCOME                                       
              MOVE FA80-NUM-OCCUP7-EMPLY-STATUS   TO                            
                   FB66-NUM-OCCUP7-EMPLY-STATUS                                 
              MOVE FA80-NME-OCCUP7-OCCUPATION     TO                            
                   FB66-NME-OCCUP7-OCCUPATION                                   
              MOVE FA80-NUM-OCCUP7-PHONE          TO                            
                   FB66-NUM-OCCUP7-PHONE                                        
              MOVE FA80-NUM-OCCUP7-HP-PAGER       TO                            
                   FB66-NUM-OCCUP7-HP-PAGER                                     
              MOVE FA80-NUM-OCCUP7-EDN-LVL        TO                            
                   FB66-NUM-OCCUP7-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB66-NUM-OCCUP7-SPOUSE-UIN                                   
                                                                                
      *------------> OCCUPANT  8                                                
           IF FA80-NUM-OCCUP8-UIN NOT = SPACES                                  
              MOVE FA80-NUM-OCCUP8-UIN            TO                            
                   FB66-NUM-OCCUP8-UIN                                          
              MOVE FA80-NME-OCCUP8                TO                            
                   FB66-NME-OCCUP8                                              
              MOVE FA80-NUM-OCCUP8-CITIZENSHIP    TO                            
                   FB66-NUM-OCCUP8-CITIZENSHIP                                  
              MOVE FA80-DTE-OCCUP8-BIRTH          TO                            
                   FB66-DTE-OCCUP8-BIRTH                                        
              MOVE FA80-NUM-OCCUP8-RACE           TO                            
                   FB66-NUM-OCCUP8-RACE                                         
              MOVE FA80-NUM-OCCUP8-SEX            TO                            
                   FB66-NUM-OCCUP8-SEX                                          
              MOVE FA80-NUM-OCCUP8-MARITAL-STATUS TO                            
                   FB66-NUM-OCCUP8-MARITAL-STATUS                               
              MOVE FA80-NUM-OCCUP8-RLTNSP-APPLT1  TO                            
                   FB66-NUM-OCCUP8-RLTNSP-APPLT1                                
                   WS-OCC-REL                                                   
              MOVE FA80-AMT-OCCUP8-INCOME         TO                            
                   FB66-AMT-OCCUP8-INCOME                                       
              MOVE FA80-NUM-OCCUP8-EMPLY-STATUS   TO                            
                   FB66-NUM-OCCUP8-EMPLY-STATUS                                 
              MOVE FA80-NME-OCCUP8-OCCUPATION     TO                            
                   FB66-NME-OCCUP8-OCCUPATION                                   
              MOVE FA80-NUM-OCCUP8-PHONE          TO                            
                   FB66-NUM-OCCUP8-PHONE                                        
              MOVE FA80-NUM-OCCUP8-HP-PAGER       TO                            
                   FB66-NUM-OCCUP8-HP-PAGER                                     
              MOVE FA80-NUM-OCCUP8-EDN-LVL        TO                            
                   FB66-NUM-OCCUP8-EDN-LVL                                      
                                                                                
              PERFORM 4150-MOVE-SPOU-NRIC         THRU 4150-EXIT                
              MOVE WS-TEMP-NRIC-SPOUSE            TO                            
                   FB66-NUM-OCCUP8-SPOUSE-UIN                                   
                                                                                
           END-IF.                                                              
                                                                                
       4260-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      **********************************************************                
       4300-FB66-WRITE.                                                         
      **********************************************************                
                                                                                
           MOVE SPACES TO FB66-REC.                                             
                                                                                
           PERFORM  8000-MOVE-DELIMITER     THRU 8000-EXIT.                     
      * KEY FIELDS                                                              
           MOVE FA80-NUM-PROJECT                          TO                    
                FB66-NUM-PROJECT.                                               
           MOVE FA80-NUM-REGN                             TO                    
                FB66-NUM-REGN.                                                  
                                                                                
      ** INTEREST IN ANOTHER HDB FLAT                                           
           MOVE FA80-NUM-FLAT-INHERIT                     TO                    
                FB66-NUM-FLAT-INHERIT.                                          
           MOVE FA80-NME-PRSN1-INHERIT                    TO                    
                FB66-NME-PRSN1-INHERIT.                                         
           MOVE FA80-NUM-PRSN1-UIN-INHERIT                TO                    
                FB66-NUM-PRSN1-UIN-INHERIT.                                     
           MOVE FA80-TXT-PRSN1-ADDR-INHERIT               TO                    
                FB66-TXT-PRSN1-ADDR-INHERIT.                                    
           MOVE FA80-NME-PRSN2-INHERIT                    TO                    
                FB66-NME-PRSN2-INHERIT.                                         
           MOVE FA80-NUM-PRSN2-UIN-INHERIT                TO                    
                FB66-NUM-PRSN2-UIN-INHERIT.                                     
           MOVE FA80-TXT-PRSN2-ADDR-INHERIT               TO                    
                FB66-TXT-PRSN2-ADDR-INHERIT.                                    
           MOVE FA80-NME-PRSN2-INHERIT                    TO                    
                FB66-NME-PRSN2-INHERIT.                                         
           MOVE FA80-NUM-PRSN2-UIN-INHERIT                TO                    
                FB66-NUM-PRSN2-UIN-INHERIT.                                     
           MOVE FA80-TXT-PRSN2-ADDR-INHERIT               TO                    
                FB66-TXT-PRSN2-ADDR-INHERIT.                                    
                                                                                
      * INTEREST IN A PRIVATE PROPERTY                                          
           MOVE FA80-NUM-OWN-PTE-PRTY                     TO                    
                FB66-NUM-OWN-PTE-PRTY.                                          
           MOVE FA80-NUM-DISPOSED-PTE-PRTY                TO                    
                FB66-NUM-DISPOSED-PTE-PRTY.                                     
           MOVE FA80-OTHR-PRVTE-PRPRTY                    TO                    
                FB66-OTHR-PRVTE-PRPRTY.                                         
                                                                                
      * CORRESPONDING ADDRESS                                                   
           MOVE FA80-NUM-MAIN-BLK                         TO                    
                FB66-NUM-MAIN-BLK.                                              
           MOVE FA80-NUM-SUB-BLK                          TO                    
                FB66-NUM-SUB-BLK.                                               
           MOVE FA80-NUM-LEVEL-CORR                       TO                    
                FB66-NUM-LEVEL.                                                 
           MOVE FA80-NUM-MAIN-UNIT-CORR                   TO                    
                FB66-NUM-MAIN-UNIT.                                             
           MOVE FA80-NUM-SUB-UNIT-CORR                    TO                    
                FB66-NUM-SUB-UNIT.                                              
           MOVE FA80-NUM-CORRESP-STREET                   TO                    
                FB66-NUM-CORRESP-STREET.                                        
           MOVE FA80-CDE-CORRESP-POST                     TO                    
                FB66-CDE-CORRESP-POST.                                          
           MOVE FA80-NUM-CPFHG-REQ                        TO                    
                FB66-NUM-CPFHG-REQ.                                             
                                                                                
      * DATE/TIME OF REQUEST                                                    
           MOVE FA80-DTE-REQUESTED                        TO                    
                FB66-DTE-REQUESTED.                                             
           MOVE FA80-TME-REQUESTED                        TO                    
                FB66-TME-REQUESTED.                                             
                                                                                
      * APPLICATION DETAILS                                                     
           MOVE FA80-NUM-RACE                             TO                    
                FB66-NUM-ETHNIC.                                                
                                                                                
           IF FA80-NUM-HH     = 'T'                                             
              MOVE 'H'   TO   FB66-NUM-HOUSEHOLD-TYPE                           
           ELSE                                                                 
              MOVE FA80-NUM-HH                        TO                        
                FB66-NUM-HOUSEHOLD-TYPE                                         
           END-IF.                                                              
                                                                                
           MOVE FA80-CDE-ELIG-SCH                         TO                    
                FB66-CDE-ELIG-SCH.                                              
           MOVE FA80-CDE-ALLOC-SCH                        TO                    
                FB66-CDE-ALLOC-SCH.                                             
           MOVE FA80-NUM-DBSS-ELIG                        TO                    
                FB66-ELIG-TO-BUY.                                               
           MOVE FA80-NUM-EMAIL                            TO                    
                FB66-NUM-EMAIL.                                                 
                                                                                
      * BALLOTING INFORMATION                                                   
           MOVE SPACES                                    TO                    
                FB66-DTE-BOOK-APPT.                                             
           MOVE SPACES                                    TO                    
                FB66-TME-BOOK-APPT.                                             
                                                                                
      ***BOOKING DETAILS                                                        
           MOVE FA80-NUM-ACCEPTANCE  TO FB66-NUM-ACCEPTANCE.                    
           MOVE FA80-DTE-OPTION(1:2) TO FB66-DTE-OPTION(7:2).                   
           MOVE FA80-DTE-OPTION(4:2) TO FB66-DTE-OPTION(5:2).                   
           MOVE FA80-DTE-OPTION(7:4) TO FB66-DTE-OPTION(1:4).                   
           MOVE FA80-AMT-TRANS-PRICE TO FB66-NUM-TRANSC-PRICE.                  
           MOVE FA80-AMT-OPTION-FEE  TO FB66-NUM-OPTION-FEE.                    
           MOVE FA80-NUM-BLOCK(1:4)  TO FB66-NUM-SELECT-BLK.                    
           MOVE FA80-NUM-BLOCK(5:1)  TO FB66-NUM-SELECT-SUB-BLK.                
           MOVE FA80-NUM-LEVEL       TO FB66-NUM-SELECT-LEVEL.                  
           MOVE FA80-NUM-UNIT        TO FB66-NUM-SELECT-MAIN-UNIT.              
           MOVE FA80-NUM-SERIAL      TO FB66-NUM-SERIAL.                        
           MOVE FA80-CDE-UNIT-TYP    TO FB66-NUM-UNIT-TYP.                      
           MOVE FA80-NUM-CHEQUE      TO FB66-NUM-CHEQUE1.                       
           MOVE FA80-NME-BANK        TO FB66-NME-BANK1.                         
           MOVE FA80-NUM-CHEQUE-2    TO FB66-NUM-CHEQUE2.                       
           MOVE FA80-NME-BANK-2      TO FB66-NME-BANK2.                         
           MOVE FA80-NUM-PAYMENT-SCHEME TO FB66-NUM-PAYMENT-SCHEME              
           MOVE FA80-NUM-USERID-CONTENT TO  FB66-NUM-USERID.                    
           MOVE FA80-DTE-LOG         TO FB66-DTE-UPDATE.                        
           MOVE FA80-TME-LOG         TO FB66-TME-UPDATE.                        
                                                                                
           PERFORM 4250-WRITE-CO-APPL   THRU 4250-EXIT.                         
           PERFORM 4260-WRITE-OCCUP     THRU 4260-EXIT.                         
                                                                                
      *NEW FIELDS                                                               
           IF FA80-NUM-PROJECT > 'E13' OR                                       
              FA80-NUM-PROJECT > 'K13'                                          
              PERFORM 4400-READ-BP13KA30    THRU 4400-EXIT                      
              MOVE ';' TO FB66-FIL256 FB66-FIL257 FB66-FIL258                   
                          FB66-FIL259                                           
              MOVE FA80-NUM-HHTYPE-DECLARE TO FB66-NUM-HHTYPE-DECLARE           
              MOVE FA80-NUM-AGENT-CDE      TO FB66-NUM-AGENT-CDE                
              MOVE KA30-NUM-FLOOR-AREA     TO FB66-NUM-FLOOR-AREA               
              MOVE KA30-NUM-SHARE-VAL      TO FB66-NUM-SHARE-VALUE              
           END-IF.                                                              
                                                                                
           MOVE SPACES    TO FB66-REC(2979:22).                                 
                                                                                
           WRITE FB66-REC.                                                      
           ADD +1                 TO WS-CNT-FB66.                               
                                                                                
       4300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-----------------------------------------------------------*             
       4400-READ-BP13KA30.                                                      
      *-----------------------------------------------------------*             
                                                                                
           MOVE SPACES           TO BP13KA30-REC.                               
           INITIALIZE               BP13KA30-REC.                               
                                                                                
           MOVE FA80-NUM-REGN   TO KA30-NUM-REGN                                
           READ BP13KA30  KEY IS KA30-NUM-REGN.                                 
                                                                                
           EVALUATE WS-KA30-STATUS                                              
              WHEN 00                                                           
              WHEN 02                                                           
                   CONTINUE                                                     
              WHEN 23                                                           
                   MOVE SPACES   TO BP13KA30-REC                                
                   INITIALIZE       BP13KA30-REC                                
              WHEN OTHER                                                        
                DISPLAY 'READ ERROR, BP13KA30-STATUS ' WS-KA30-STATUS           
                MOVE     WS-KA30-STATUS TO RETURN-CODE                          
                PERFORM  9000-CLOSE-FILES       THRU 9000-EXIT                  
           END-EVALUATE.                                                        
                                                                                
       4400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-----------------------------------------------------------*             
       8000-MOVE-DELIMITER.                                                     
      *-----------------------------------------------------------*             
                                                                                
           MOVE ';' TO  FB66-FIL001 FB66-FIL011 FB66-FIL021                     
                        FB66-FIL002 FB66-FIL012 FB66-FIL022                     
                        FB66-FIL003 FB66-FIL013 FB66-FIL023                     
                        FB66-FIL004 FB66-FIL014 FB66-FIL024                     
                        FB66-FIL005 FB66-FIL015 FB66-FIL025                     
                        FB66-FIL006 FB66-FIL016 FB66-FIL026                     
                        FB66-FIL007 FB66-FIL017 FB66-FIL027                     
                        FB66-FIL008 FB66-FIL018 FB66-FIL028                     
                        FB66-FIL009 FB66-FIL019 FB66-FIL029                     
                        FB66-FIL010 FB66-FIL020 FB66-FIL030                     
                        FB66-FIL031 FB66-FIL041 FB66-FIL051                     
                        FB66-FIL032 FB66-FIL042 FB66-FIL052                     
                        FB66-FIL033 FB66-FIL043 FB66-FIL053                     
                        FB66-FIL034 FB66-FIL044 FB66-FIL054                     
                        FB66-FIL035 FB66-FIL045 FB66-FIL055                     
                        FB66-FIL036 FB66-FIL046 FB66-FIL056                     
                        FB66-FIL037 FB66-FIL047 FB66-FIL057                     
                        FB66-FIL038 FB66-FIL048 FB66-FIL058                     
                        FB66-FIL039 FB66-FIL049 FB66-FIL059                     
                        FB66-FIL040 FB66-FIL050 FB66-FIL060                     
                        FB66-FIL061 FB66-FIL071 FB66-FIL081                     
                        FB66-FIL062 FB66-FIL072 FB66-FIL082                     
                        FB66-FIL063 FB66-FIL073 FB66-FIL083                     
                        FB66-FIL064 FB66-FIL074 FB66-FIL084                     
                        FB66-FIL065 FB66-FIL075 FB66-FIL085                     
                        FB66-FIL066 FB66-FIL076 FB66-FIL086                     
                        FB66-FIL067 FB66-FIL077 FB66-FIL087                     
                        FB66-FIL068 FB66-FIL078 FB66-FIL088                     
                        FB66-FIL069 FB66-FIL079 FB66-FIL089                     
                        FB66-FIL070 FB66-FIL080 FB66-FIL090                     
                        FB66-FIL091 FB66-FIL101 FB66-FIL111                     
                        FB66-FIL092 FB66-FIL102 FB66-FIL112                     
                        FB66-FIL093 FB66-FIL103 FB66-FIL113                     
                        FB66-FIL094 FB66-FIL104 FB66-FIL114                     
                        FB66-FIL095 FB66-FIL105 FB66-FIL115                     
                        FB66-FIL096 FB66-FIL106 FB66-FIL116                     
                        FB66-FIL097 FB66-FIL107 FB66-FIL117                     
                        FB66-FIL098 FB66-FIL108 FB66-FIL118                     
                        FB66-FIL099 FB66-FIL109 FB66-FIL119                     
                        FB66-FIL100 FB66-FIL110 FB66-FIL120                     
                        FB66-FIL121 FB66-FIL131 FB66-FIL141                     
                        FB66-FIL122 FB66-FIL132 FB66-FIL142                     
                        FB66-FIL123 FB66-FIL133 FB66-FIL143                     
                        FB66-FIL124 FB66-FIL134 FB66-FIL144                     
                        FB66-FIL125 FB66-FIL135 FB66-FIL145                     
                        FB66-FIL126 FB66-FIL136 FB66-FIL146                     
                        FB66-FIL127 FB66-FIL137 FB66-FIL147                     
                        FB66-FIL128 FB66-FIL138 FB66-FIL148                     
                        FB66-FIL129 FB66-FIL139 FB66-FIL149                     
                        FB66-FIL130 FB66-FIL140 FB66-FIL150                     
                        FB66-FIL151 FB66-FIL161 FB66-FIL171                     
                        FB66-FIL152 FB66-FIL162 FB66-FIL172                     
                        FB66-FIL153 FB66-FIL163 FB66-FIL173                     
                        FB66-FIL154 FB66-FIL164 FB66-FIL174                     
                        FB66-FIL155 FB66-FIL165 FB66-FIL175                     
                        FB66-FIL156 FB66-FIL166 FB66-FIL176                     
                        FB66-FIL157 FB66-FIL167 FB66-FIL177                     
                        FB66-FIL158 FB66-FIL168 FB66-FIL178                     
                        FB66-FIL159 FB66-FIL169 FB66-FIL179                     
                        FB66-FIL160 FB66-FIL170 FB66-FIL180                     
                        FB66-FIL181 FB66-FIL191 FB66-FIL201                     
                        FB66-FIL182 FB66-FIL192 FB66-FIL202                     
                        FB66-FIL183 FB66-FIL193 FB66-FIL203                     
                        FB66-FIL184 FB66-FIL194 FB66-FIL204                     
                        FB66-FIL185 FB66-FIL195 FB66-FIL205                     
                        FB66-FIL186 FB66-FIL196 FB66-FIL206                     
                        FB66-FIL187 FB66-FIL197 FB66-FIL207                     
                        FB66-FIL188 FB66-FIL198 FB66-FIL208                     
                        FB66-FIL189 FB66-FIL199 FB66-FIL209                     
                        FB66-FIL190 FB66-FIL200 FB66-FIL210                     
                        FB66-FIL211 FB66-FIL221 FB66-FIL231                     
                        FB66-FIL212 FB66-FIL222 FB66-FIL232                     
                        FB66-FIL213 FB66-FIL223 FB66-FIL233                     
                        FB66-FIL214 FB66-FIL224 FB66-FIL234                     
                        FB66-FIL215 FB66-FIL225 FB66-FIL235                     
                        FB66-FIL216 FB66-FIL226 FB66-FIL236                     
                        FB66-FIL217 FB66-FIL227 FB66-FIL237                     
                        FB66-FIL218 FB66-FIL228 FB66-FIL238                     
                        FB66-FIL219 FB66-FIL229 FB66-FIL239                     
                        FB66-FIL220 FB66-FIL230 FB66-FIL240                     
                        FB66-FIL241 FB66-FIL242 FB66-FIL243                     
                        FB66-FIL244 FB66-FIL245 FB66-FIL246                     
                        FB66-FIL247 FB66-FIL248 FB66-FIL249                     
                        FB66-FIL250 FB66-FIL251 FB66-FIL252                     
                        FB66-FIL253 FB66-FIL254 FB66-FIL255                     
                        FB66-FIL260.                                            
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
                                                                                
      **********************************************************                
       9000-CLOSE-FILES.                                                        
      **********************************************************                
           DISPLAY '******* CONTROL   TOTALS ********'.                         
           DISPLAY 'PROGRAM-ID : BP13C02Y'.                                     
           DISPLAY '---------------------'.                                     
           DISPLAY 'NO OF BP13FB38 RECORDS READ..........: '                    
                    WS-CNT-FA80.                                                
           DISPLAY 'NO OF BP13FB66 RECORDS WRITTEN.......: '                    
                    WS-CNT-FB66.                                                
                                                                                
           CLOSE BP13FA80                                                       
                 BP13KA30                                                       
                 BP13FB66.                                                      
                                                                                
           IF WS-KA30-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR, BP13KA30-STATUS ' WS-KA30-STATUS            
              MOVE     WS-KA30-STATUS TO RETURN-CODE                            
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
