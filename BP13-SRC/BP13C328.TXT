      *------------------------------------------------------------*            
       IDENTIFICATION DIVISION.                                                 
      *------------------------------------------------------------*            
       PROGRAM-ID.    BP13C328.                                                 
      *AUTHOR. SK.                                                              
      *DATE-WRITTEN.  25/06/2004.                                               
                                                                                
      *------------------------------------------------------------*            
      *OBJECTIVE : SUB-TRANSFER CASES ONLY                         *            
      *           1. TO READ RESALE CPFIBG FILE TO UPDATE          *            
      *              CPF WITHDRAWAL FOR BANK ORIGINATION CASES.    *            
      *                                                            *            
      *     INPUT FILES:                                           *            
      *           1. BB24F04A (CPFIBG FILE)                        *            
      *                                                            *            
      *     INPUT/OUTPUT FILE:                                     *            
      *           2. BP13K671 (BANK ORIGINATION CPF WITHDRAWAL)    *            
      *           3. BP13K110 (FIS FILE)                           *            
      *           4. BP13F120 (CPF TRANS FILE)                     *            
      *           5. BP13F121 (CPF CASH TRANS FILE)                *            
      *           6. BP13L328 (REPORT)                             *            
      *------------------------------------------------------------*            
      * CHG REQ# BY    DATE     DESCRIPTION                        *            
      * -------- ---- --------  -----------------------------------*            
      * BP132526 SK   25/06/04  NEW PROGRAM                        *            
      *------------------------------------------------------------*            
                                                                                
      *------------------------------------------------------------*            
       ENVIRONMENT DIVISION.                                                    
      *------------------------------------------------------------*            
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
      *------------------------------------------------------------*            
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
      *------------------------------------------------------------*            
                                                                                
           SELECT BB24F04A ASSIGN TO BB24F04A.                                  
           SELECT BP13F121 ASSIGN TO BP13F121.                                  
           SELECT BP13F120 ASSIGN TO BP13F120.                                  
           SELECT SY02F001 ASSIGN TO SY02F001.                                  
                                                                                
           SELECT BM06K110 ASSIGN TO BM06K110                                   
                  ACCESS MODE     IS RANDOM                                     
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K110-KEY-FLD                               
                  FILE STATUS     IS WS-K110-STATUS.                            
                                                                                
           SELECT BP13K671 ASSIGN TO BP13K671                                   
                  ACCESS MODE     IS RANDOM                                     
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K671-NUM-REGN                              
                  FILE STATUS     IS WS-K671-STATUS.                            
                                                                                
           SELECT BP13L328 ASSIGN TO BP13L328.                                  
                                                                                
      *------------------------------------------------------------*            
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *------------------------------------------------------------*            
                                                                                
       FD  BB24F04A                                                             
           RECORD CONTAINS 150 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       COPY BB24F04A.                                                           
                                                                                
       FD  BM06K110                                                             
           RECORD CONTAINS 500 CHARACTERS.                                      
       COPY BM06K110.                                                           
                                                                                
       FD   BP13K671                                                            
            RECORD CONTAINS 3000 CHARACTERS.                                    
       COPY BP13K671.                                                           
                                                                                
       FD  BP13F121                                                             
           RECORD CONTAINS 150 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       COPY BP13F121.                                                           
                                                                                
       FD  BP13F120                                                             
           RECORD CONTAINS 150 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       COPY BP13F120.                                                           
                                                                                
       COPY SY02F001.                                                           
                                                                                
       FD  BP13L328                                                             
           LABEL RECORDS ARE OMITTED                                            
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       01 BP13L328-REC          PIC X(132).                                     
                                                                                
      *------------------------------------------------------------*            
       WORKING-STORAGE SECTION.                                                 
      *------------------------------------------------------------*            
                                                                                
       01  WS-COUNTER.                                                          
           05  WS-LINE-CTR               PIC 9(2)    VALUE 55.                  
           05  WS-PAGE-CTR               PIC 9(7)    VALUE ZEROS.               
           05  WS-READ-CNT               PIC 9(7)    VALUE ZEROS.               
           05  WS-PRINT-CNT              PIC 9(7)    VALUE ZEROS.               
           05  WS-PROCESS-CNT            PIC 9(7)    VALUE ZEROS.               
           05  WS-READ-K110              PIC 9(7)    VALUE ZEROS.               
           05  WS-READ-K671              PIC 9(7)    VALUE ZEROS.               
           05  WS-NOT-FND-K671           PIC 9(7)    VALUE ZEROS.               
           05  WS-NOT-MTCH-K671          PIC 9(7)    VALUE ZEROS.               
           05  WS-NOT-FND-K110           PIC 9(7)    VALUE ZEROS.               
           05  WS-WRITE-F120             PIC 9(8)    VALUE ZEROS.               
           05  WS-WRITE-F121             PIC 9(8)    VALUE ZEROS.               
           05  WS-CTR                    PIC 9(2)    VALUE ZEROS.               
           05  WS-POS                    PIC 9(1)    VALUE ZEROS.               
                                                                                
       01  WS-FILE-STATUS.                                                      
           05  WS-K110-STATUS            PIC 9(2)    VALUE 0.                   
           05  WS-K671-STATUS            PIC 9(2)    VALUE 0.                   
                                                                                
       01  WS-PROGRAM-SWITCHES.                                                 
           05  WS-EOF                    PIC X       VALUE 'N'.                 
           05  WS-SY02-EOF               PIC X       VALUE 'N'.                 
           05  WS-FND-K671               PIC X       VALUE 'N'.                 
           05  WS-FND-K110               PIC X       VALUE 'N'.                 
                                                                                
       01  WS-OTHER-VARIABLES.                                                  
           05  WS-DATE                   PIC X(8)     VALUE SPACES.             
           05  WS-NUM-REGN               PIC X(8)     VALUE SPACES.             
           05  WS-NUM-CPF                PIC X(9)     VALUE SPACES.             
           05  WS-SCH-ACCT               PIC X(11)    VALUE SPACES.             
           05  WS-NUM-VALUE-DATE         PIC X(8)     VALUE SPACES.             
           05  WS-F04A-IDP               PIC 9(9)V99  VALUE 0.                  
           05  WS-F04A-IDP1              PIC 9(9)V99  VALUE 0.                  
           05  WS-F04A-STAMP-LEGAL-FEE   PIC 9(7)V99  VALUE 0.                  
           05  WS-F04A-STAMP-LEGAL-FEE1  PIC 9(7)V99  VALUE 0.                  
           05  WS-PRINT-TOTAL-FEE        PIC 9(7)V99  VALUE 0.                  
           05  WS-PRINT-IDP-REQ          PIC 9(7)V99  VALUE 0.                  
           05  WS-PRINT-IDP-PD           PIC 9(7)V99  VALUE 0.                  
           05  WS-REMARKS                PIC X(34)    VALUE SPACES.             
           05  WS-TOTAL-LEGAL-FEES       PIC S9(7)V99 VALUE 0.                  
           05  WS-LEGAL-FEES-REQ         PIC S9(7)V99 VALUE 0.                  
           05  WS-PAY-TYPE               PIC X(3)     VALUE SPACES.             
           05  WS-CDE-APPLT-CPF          PIC X(1)     VALUE SPACES.             
           05  WS-NRIC                   PIC X(9)     VALUE SPACES.             
           05  WS-AMOUNT                 PIC S9(7)V99 VALUE 0.                  
           05  WS-AMT-REQUIRED           PIC S9(7)V99 VALUE 0.                  
           05  WS-AMT-PAID               PIC S9(7)V99 VALUE 0.                  
                                                                                
       01  WS-PAID-TABLE.                                                       
           05  WS-PAID-TAB OCCURS 4 TIMES.                                      
               10 WS-TOTAL-PD            PIC 9(7)V99 VALUE 0.                   
               10 WS-TOTAL-REQ           PIC 9(7)V99 VALUE 0.                   
               10 WS-TOTAL-LUMP-IDP-REQ  PIC 9(7)V99 VALUE 0.                   
               10 WS-TOTAL-LUMP-IDP-PD   PIC 9(7)V99 VALUE 0.                   
               10 WS-LUMPSUM-REQ         PIC 9(7)V99 VALUE 0.                   
               10 WS-LUMPSUM-PD          PIC 9(7)V99 VALUE 0.                   
               10 WS-IDP-REQ             PIC 9(7)V99 VALUE 0.                   
               10 WS-IDP-PD              PIC 9(7)V99 VALUE 0.                   
               10 WS-LEASE-SF-REQ        PIC 9(7)V99 VALUE 0.                   
               10 WS-LEASE-SF-PD         PIC 9(7)V99 VALUE 0.                   
               10 WS-SALE-CF-REQ         PIC 9(7)V99 VALUE 0.                   
               10 WS-SALE-CF-PD          PIC 9(7)V99 VALUE 0.                   
               10 WS-MORT-CF-REQ         PIC 9(7)V99 VALUE 0.                   
               10 WS-MORT-CF-PD          PIC 9(7)V99 VALUE 0.                   
               10 WS-CAVEAT-REQ          PIC 9(7)V99 VALUE 0.                   
               10 WS-CAVEAT-PD           PIC 9(7)V99 VALUE 0.                   
               10 WS-SOLICIT-REQ         PIC 9(7)V99 VALUE 0.                   
               10 WS-SOLICIT-PD          PIC 9(7)V99 VALUE 0.                   
               10 WS-LSE-ESCR-REQ        PIC 9(7)V99 VALUE 0.                   
               10 WS-LSE-ESCR-PD         PIC 9(7)V99 VALUE 0.                   
               10 WS-LSE-REGN-REQ        PIC 9(7)V99 VALUE 0.                   
               10 WS-LSE-REGN-PD         PIC 9(7)V99 VALUE 0.                   
               10 WS-SRVY-FEE-REQ        PIC 9(7)V99 VALUE 0.                   
               10 WS-SRVY-FEE-PD         PIC 9(7)V99 VALUE 0.                   
               10 WS-FRESH-CV-REQ        PIC 9(7)V99 VALUE 0.                   
               10 WS-FRESH-CV-PD         PIC 9(7)V99 VALUE 0.                   
               10 WS-SUBTR-SF-REQ        PIC 9(7)V99 VALUE 0.                   
               10 WS-SUBTR-SF-PD         PIC 9(7)V99 VALUE 0.                   
               10 WS-SUBTR-CF-REQ        PIC 9(7)V99 VALUE 0.                   
               10 WS-SUBTR-CF-PD         PIC 9(7)V99 VALUE 0.                   
               10 WS-BUYER-WCV-REQ       PIC 9(7)V99 VALUE 0.                   
               10 WS-BUYER-WCV-PD        PIC 9(7)V99 VALUE 0.                   
               10 WS-BANK-WCV-REQ        PIC 9(7)V99 VALUE 0.                   
               10 WS-BANK-WCV-PD         PIC 9(7)V99 VALUE 0.                   
                                                                                
       01  WS-SYSTEM-DATE.                                                      
           05  WS-SYS-CCYY             PIC 9(4).                                
           05  WS-SYS-MM               PIC 9(2).                                
           05  WS-SYS-DD               PIC 9(2).                                
                                                                                
       01  WS-DTE-CPF.                                                          
           05  WS-CPF-CCYY             PIC 9(4).                                
           05  WS-CPF-MM               PIC 9(2).                                
           05  WS-CPF-DD               PIC 9(2).                                
                                                                                
      *------------------------------------------------------------*            
      * REPORT LAYOUT                                                           
      *------------------------------------------------------------*            
       01  L328-HEADER1.                                                        
           05 FILLER                     PIC X(8)   VALUE 'BP13L328'.           
           05 FILLER                     PIC X(47)  VALUE SPACES.               
           05 FILLER                     PIC X(20)  VALUE                       
              'SYSTEM OF COMMITMENT'.                                           
           05 FILLER                     PIC X(38)  VALUE SPACES.               
           05 FILLER                     PIC X(7)   VALUE 'DATE : '.            
           05 L328-DATE                  PIC X(10)  VALUE SPACES.               
                                                                                
       01  L328-HEADER2.                                                        
           05 FILLER                     PIC X(41)  VALUE SPACES.               
           05 FILLER                     PIC X(58)  VALUE                       
           'CONTROL LIST OF HBL1 CPF UPDATE FOR BO CPF PAYMENT (SUBTR)'.        
           05 FILLER                     PIC X(22)  VALUE SPACES.               
           05 FILLER                     PIC X(8)   VALUE 'PAGE : '.            
           05 L328-PAGE                  PIC Z,ZZZ,ZZ9 VALUE ZEROS.             
                                                                                
       01  L328-HEADER3.                                                        
           05 FILLER                     PIC X(41)  VALUE                       
              'SNO        REGN     CPF NO    SCH ACCT'.                         
           05 FILLER                     PIC X(2)   VALUE SPACES.               
           05 FILLER                     PIC X(47)  VALUE                       
              'VAL DATE LUMPSUM REQ LUMPSUM PD     SF REQ'.                     
           05 FILLER                     PIC X(20)  VALUE                       
              ' SF PD  REMARKS'.                                                
                                                                                
       01  L328-DETAIL.                                                         
           05 L328-SNO                   PIC Z(6)9.                             
           05 FILLER                     PIC X(1)  VALUE SPACES.                
           05 L328-NUM-REGN              PIC X(8)  VALUE SPACES.                
           05 FILLER                     PIC X(1)  VALUE SPACES.                
           05 L328-NUM-CPF               PIC X(9)  VALUE SPACES.                
           05 FILLER                     PIC X(1)  VALUE SPACES.                
           05 L328-NUM-SCH-ACCT          PIC X(14) VALUE SPACES.                
           05 FILLER                     PIC X(1)  VALUE SPACES.                
           05 L328-NUM-VALUE-DATE        PIC X(10) VALUE SPACES.                
           05 FILLER                     PIC X(1)  VALUE SPACES.                
           05 L328-AMT-IDP-REQ           PIC ZZZ,ZZ9.99.                        
           05 FILLER                     PIC X(1)  VALUE SPACES.                
           05 L328-AMT-IDP-PD            PIC ZZZ,ZZ9.99.                        
           05 FILLER                     PIC X(1)  VALUE SPACES.                
           05 L328-AMT-STAMP-FEE-REQ     PIC ZZZ,ZZ9.99.                        
           05 FILLER                     PIC X(1)  VALUE SPACES.                
           05 L328-AMT-STAMP-FEE-PD      PIC ZZZ,ZZ9.99.                        
           05 FILLER                     PIC X(1)  VALUE SPACES.                
           05 L328-REMARKS               PIC X(34) VALUE SPACES.                
                                                                                
       01  L328-HEADER4.                                                        
           05 FILLER                     PIC X(132) VALUE ALL '-'.              
                                                                                
      *------------------------------------------------------------*            
       PROCEDURE DIVISION.                                                      
      *------------------------------------------------------------*            
                                                                                
      *------------------------------------------------------------*            
       1000-MAIN-PROCEDURE.                                                     
      *------------------------------------------------------------*            
                                                                                
           PERFORM 2000-OPEN-FILES           THRU 2000-EXIT.                    
           PERFORM 2100-READ-SY02F001        THRU 2100-EXIT.                    
           PERFORM 2200-READ-BB24F04A        THRU 2200-EXIT.                    
           PERFORM 3000-PROCESS              THRU 3000-EXIT                     
                   UNTIL WS-EOF = 'Y'.                                          
                                                                                
           IF WS-READ-CNT = ZEROES                                              
              PERFORM 6100-PRINT-HDG THRU 6100-EXIT                             
              MOVE SPACES TO L328-DETAIL                                        
              MOVE '************* BB24F04A FILE EMPTY **************'           
                   TO L328-DETAIL                                               
              WRITE   BP13L328-REC   FROM L328-DETAIL AFTER 5                   
           ELSE                                                                 
              MOVE SPACES TO L328-DETAIL                                        
              MOVE '************* END OF FILE **************'                   
                   TO L328-DETAIL                                               
              WRITE   BP13L328-REC   FROM L328-DETAIL AFTER 1                   
           END-IF.                                                              
                                                                                
           PERFORM 9000-CLOSING-ROUTINE      THRU 9000-EXIT.                    
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       2000-OPEN-FILES.                                                         
      *------------------------------------------------------------*            
                                                                                
           OPEN INPUT  BB24F04A                                                 
                       BM06K110                                                 
                       SY02F001                                                 
                I-O    BP13K671                                                 
                OUTPUT BP13L328                                                 
                       BP13F121                                                 
                       BP13F120.                                                
                                                                                
           EVALUATE WS-K110-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 DISPLAY 'OPEN BP13K110 FAIL. STATUS-'                          
                                         WS-K110-STATUS                         
                 MOVE WS-K110-STATUS  TO RETURN-CODE                            
                 PERFORM 9000-CLOSING-ROUTINE   THRU 9000-EXIT                  
           END-EVALUATE.                                                        
                                                                                
           EVALUATE WS-K671-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 DISPLAY 'OPEN BP13K671 FAIL. STATUS-'                          
                                         WS-K671-STATUS                         
                 MOVE WS-K671-STATUS  TO RETURN-CODE                            
                 PERFORM 9000-CLOSING-ROUTINE   THRU 9000-EXIT                  
           END-EVALUATE.                                                        
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       2100-READ-SY02F001.                                                      
      *------------------------------------------------------------*            
                                                                                
           READ SY02F001                                                        
                AT END MOVE 'Y' TO WS-SY02-EOF                                  
                GO TO 2100-EXIT                                                 
           END-READ.                                                            
                                                                                
           MOVE F001-DTE-CURRENT  TO WS-SYSTEM-DATE.                            
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       2200-READ-BB24F04A.                                                      
      *------------------------------------------------------------*            
                                                                                
           READ BB24F04A                                                        
                AT END                                                          
                   MOVE 'Y' TO WS-EOF                                           
                NOT AT END                                                      
                   ADD 1 TO WS-READ-CNT                                         
           END-READ.                                                            
                                                                                
       2200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       3000-PROCESS.                                                            
      *------------------------------------------------------------*            
                                                                                
           INITIALIZE                        WS-PAID-TABLE.                     
           MOVE SPACES                 TO    WS-NUM-REGN                        
                                             WS-NUM-VALUE-DATE                  
                                             WS-REMARKS                         
                                             WS-NUM-CPF                         
                                             WS-SCH-ACCT.                       
                                                                                
           MOVE ZEROES                  TO   WS-F04A-IDP                        
                                             WS-F04A-IDP1                       
                                             WS-F04A-STAMP-LEGAL-FEE            
                                             WS-F04A-STAMP-LEGAL-FEE1           
                                             WS-PRINT-IDP-REQ                   
                                             WS-PRINT-IDP-PD                    
                                             WS-PRINT-TOTAL-FEE                 
                                             WS-LEGAL-FEES-REQ.                 
                                                                                
                                                                                
           MOVE    F04A-DTE-VALUE       TO   WS-NUM-VALUE-DATE.                 
           MOVE    F04A-NUM-CPF         TO   WS-NUM-CPF.                        
           MOVE    F04A-NUM-HDB-REF     TO   WS-SCH-ACCT.                       
                                                                                
           PERFORM 4000-INITIALIZE-BB24 THRU 4000-EXIT.                         
           PERFORM 5000-PROCESS-RECORD  THRU 5000-EXIT.                         
           PERFORM 6000-PRINT-RECORD    THRU 6000-EXIT.                         
                                                                                
           PERFORM 2200-READ-BB24F04A   THRU 2200-EXIT.                         
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       4000-INITIALIZE-BB24.                                                    
      *------------------------------------------------------------*            
                                                                                
           IF F04A-AMT-LUMP-SUM NOT NUMERIC                                     
              MOVE ZEROES                TO  F04A-AMT-LUMP-SUM                  
           END-IF.                                                              
                                                                                
           IF F04A-AMT-STAMP-LEGAL-FEE NOT NUMERIC                              
              MOVE ZEROES                TO  F04A-AMT-STAMP-LEGAL-FEE           
           END-IF.                                                              
                                                                                
           MOVE F04A-AMT-LUMP-SUM        TO WS-F04A-IDP                         
                                            WS-F04A-IDP1.                       
           MOVE F04A-AMT-STAMP-LEGAL-FEE TO WS-F04A-STAMP-LEGAL-FEE             
                                            WS-F04A-STAMP-LEGAL-FEE1.           
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5000-PROCESS-RECORD.                                                     
      *------------------------------------------------------------*            
                                                                                
           PERFORM 5100-READ-BM06K110      THRU 5100-EXIT.                      
                                                                                
           IF WS-FND-K110 = 'Y'                                                 
              PERFORM 5200-READ-BP13K671   THRU 5200-EXIT                       
              IF (WS-FND-K671 = 'Y') AND (K671-NUM-SUBTRF = 'Y')                
                 PERFORM 5300-PROCESS-K671 THRU 5300-EXIT                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5100-READ-BM06K110.                                                      
      *------------------------------------------------------------*            
                                                                                
           MOVE 'N'                            TO WS-FND-K110.                  
           MOVE F04A-NUM-HDB-REF               TO K110-KEY-FLD.                 
                                                                                
           READ BM06K110.                                                       
           EVALUATE WS-K110-STATUS                                              
              WHEN 00                                                           
                 ADD   1                       TO WS-READ-K110                  
                 IF K110-REGN-NO = LOW-VALUES  OR SPACES OR ZEROES              
                    MOVE '* FIS REGN NO = BLANK' TO WS-REMARKS                  
                    MOVE SPACES                  TO K110-REGN-NO                
                 ELSE                                                           
                    MOVE 'Y'                     TO WS-FND-K110                 
                 END-IF                                                         
                 MOVE K110-REGN-NO               TO WS-NUM-REGN                 
              WHEN 23                                                           
                 ADD   1                         TO WS-NOT-FND-K110             
                 DISPLAY 'BM06K110 NOT FOUND KEY : ' K110-KEY-FLD               
                 MOVE    '* SCH ACCT NOT FND IN FIS' TO WS-REMARKS              
              WHEN OTHER                                                        
                 DISPLAY 'ERRROR READING BM06K110, STATUS = '                   
                          WS-K110-STATUS '    KEY = ' K110-KEY-FLD              
                PERFORM 9000-CLOSING-ROUTINE   THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5200-READ-BP13K671.                                                      
      *------------------------------------------------------------*            
                                                                                
           MOVE 'N'                            TO WS-FND-K671.                  
           MOVE K110-REGN-NO                   TO K671-NUM-REGN.                
                                                                                
           READ BP13K671.                                                       
           EVALUATE WS-K671-STATUS                                              
             WHEN  00                                                           
                 ADD   1                       TO WS-READ-K671                  
                 MOVE 'Y'                      TO WS-FND-K671                   
             WHEN  23                                                           
                 ADD   1                       TO WS-NOT-FND-K671               
                 DISPLAY 'REGN BP13K671 NOT FOUND. REGN: ' K671-NUM-REGN        
                         ' SCH: ' WS-SCH-ACCT                                   
                 MOVE    '* REGN NOT FOUND IN BO FILE' TO WS-REMARKS            
             WHEN OTHER                                                         
                 DISPLAY 'ERRROR READING BP13K671, STATUS = '                   
                          WS-K671-STATUS ' KEY = ' K671-NUM-REGN                
                 PERFORM 9000-CLOSING-ROUTINE   THRU 9000-EXIT                  
           END-EVALUATE.                                                        
                                                                                
       5200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5300-PROCESS-K671.                                                       
      *------------------------------------------------------------*            
                                                                                
           PERFORM 5310-INIT-NUMERIC         THRU 5310-EXIT.                    
           PERFORM 5320-MOVE-K671-TABLE      THRU 5320-EXIT.                    
                                                                                
           IF K671-NUM-HBL-TYP NOT = '1'                                        
              MOVE '*HBL FORM WRONG. UPD HBL IN M687.' TO WS-REMARKS            
              GO TO 5300-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE +0  TO WS-TOTAL-LEGAL-FEES.                                     
                                                                                
           EVALUATE F04A-NUM-CPF                                                
              WHEN K671-NUM-CPF1-NO                                             
                   MOVE 1  TO WS-CTR                                            
                   PERFORM 5400-COMPUTE-PAID THRU 5400-EXIT                     
                   PERFORM 5500-PROCESS-CPF1 THRU 5500-EXIT                     
              WHEN K671-NUM-CPF2-NO                                             
                   MOVE 2  TO WS-CTR                                            
                   PERFORM 5400-COMPUTE-PAID THRU 5400-EXIT                     
                   PERFORM 5510-PROCESS-CPF2 THRU 5510-EXIT                     
              WHEN K671-NUM-CPF3-NO                                             
                   MOVE 3  TO WS-CTR                                            
                   PERFORM 5400-COMPUTE-PAID THRU 5400-EXIT                     
                   PERFORM 5520-PROCESS-CPF3 THRU 5520-EXIT                     
              WHEN K671-NUM-CPF4-NO                                             
                   MOVE 4  TO WS-CTR                                            
                   PERFORM 5400-COMPUTE-PAID THRU 5400-EXIT                     
                   PERFORM 5530-PROCESS-CPF4 THRU 5530-EXIT                     
              WHEN OTHER                                                        
                   ADD  1  TO WS-NOT-MTCH-K671                                  
                   DISPLAY 'CPF NO: ' F04A-NUM-CPF ' NO MATCHING K671.'         
                     ' REGN: ' K671-NUM-REGN ' SCH: ' WS-SCH-ACCT               
                   MOVE 'CPF NO. NO MATCHING K671' TO WS-REMARKS                
           END-EVALUATE.                                                        
                                                                                
       5300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5310-INIT-NUMERIC.                                                       
      *------------------------------------------------------------*            
                                                                                
      *IDP VARIABLES                                                            
           IF K671-AMT-SOC-CPF1        NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF1                    
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF2        NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF2                    
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF3        NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF3                    
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF4        NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF4                    
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF1-PAID   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF1-PAID               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF2-PAID   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF2-PAID               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF3-PAID   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF3-PAID               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOC-CPF4-PAID   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SOC-CPF4-PAID               
           END-IF.                                                              
                                                                                
      *LUMP SUM                                                                 
           IF K671-AMT-LUMPSUM-CPF1    NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF1                
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF2    NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF2                
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF3    NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF3                
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF4    NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF4                
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF1-PAID   NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF1-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF2-PAID   NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF2-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF3-PAID   NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF3-PAID           
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF4-PAID   NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF4-PAID           
           END-IF.                                                              
                                                                                
      *LUMP SUM RETIRE                                                          
           IF K671-AMT-LUMPSUM-CPF1-RETIRE NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF1-RETIRE         
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF2-RETIRE NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF2-RETIRE         
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF3-RETIRE NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF3-RETIRE         
           END-IF.                                                              
                                                                                
           IF K671-AMT-LUMPSUM-CPF4-RETIRE NOT NUMERIC                          
              MOVE ZEROES              TO  K671-AMT-LUMPSUM-CPF4-RETIRE         
           END-IF.                                                              
                                                                                
      *LEASE STAMP FEE                                                          
           IF K671-AMT-LSE-STMP-CPF1   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-STMP-CPF1               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF2   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-STMP-CPF2               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF3   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-STMP-CPF3               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF4   NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-LSE-STMP-CPF4               
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF1-PAID NOT NUMERIC                           
              MOVE ZEROES                 TO K671-AMT-LSE-STMP-CPF1-PAID        
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF2-PAID NOT NUMERIC                           
              MOVE ZEROES                 TO K671-AMT-LSE-STMP-CPF2-PAID        
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF3-PAID NOT NUMERIC                           
              MOVE ZEROES                 TO K671-AMT-LSE-STMP-CPF3-PAID        
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF4-PAID NOT NUMERIC                           
              MOVE ZEROES                 TO K671-AMT-LSE-STMP-CPF4-PAID        
           END-IF.                                                              
                                                                                
      *CAVEAT REGN FEE                                                          
           IF K671-AMT-CAVEAT-REGN-CPF1 NOT NUMERIC                             
              MOVE ZEROES               TO  K671-AMT-CAVEAT-REGN-CPF1           
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF2 NOT NUMERIC                             
              MOVE ZEROES               TO  K671-AMT-CAVEAT-REGN-CPF2           
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF3 NOT NUMERIC                             
              MOVE ZEROES               TO  K671-AMT-CAVEAT-REGN-CPF3           
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF4 NOT NUMERIC                             
              MOVE ZEROES               TO  K671-AMT-CAVEAT-REGN-CPF4           
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF1-PAID NOT NUMERIC                        
              MOVE ZEROES            TO K671-AMT-CAVEAT-REGN-CPF1-PAID          
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF2-PAID NOT NUMERIC                        
              MOVE ZEROES            TO K671-AMT-CAVEAT-REGN-CPF2-PAID          
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF3-PAID NOT NUMERIC                        
              MOVE ZEROES            TO K671-AMT-CAVEAT-REGN-CPF3-PAID          
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF4-PAID NOT NUMERIC                        
              MOVE ZEROES            TO K671-AMT-CAVEAT-REGN-CPF4-PAID          
           END-IF.                                                              
                                                                                
      *SALE CONVEY FEE                                                          
           IF K671-AMT-SALE-CONVY-CPF1 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SALE-CONVY-CPF1             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF2 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SALE-CONVY-CPF2             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF3 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SALE-CONVY-CPF3             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF4 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-SALE-CONVY-CPF4             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF1-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-SALE-CONVY-CPF1-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF2-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-SALE-CONVY-CPF2-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF3-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-SALE-CONVY-CPF3-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF4-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-SALE-CONVY-CPF4-PAID         
           END-IF.                                                              
                                                                                
      *MORT CONVEY FEE                                                          
           IF K671-AMT-MORT-CONVY-CPF1 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-MORT-CONVY-CPF1             
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF2 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-MORT-CONVY-CPF2             
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF3 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-MORT-CONVY-CPF3             
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF4 NOT NUMERIC                              
              MOVE ZEROES              TO  K671-AMT-MORT-CONVY-CPF4             
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF1-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-MORT-CONVY-CPF1-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF2-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-MORT-CONVY-CPF2-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF3-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-MORT-CONVY-CPF3-PAID         
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF4-PAID NOT NUMERIC                         
              MOVE ZEROES              TO K671-AMT-MORT-CONVY-CPF4-PAID         
           END-IF.                                                              
                                                                                
      *SOLICITOR BILL                                                           
           IF K671-AMT-SOLICIT-CPF1 NOT NUMERIC                                 
              MOVE ZEROES               TO  K671-AMT-SOLICIT-CPF1               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF2 NOT NUMERIC                                 
              MOVE ZEROES               TO  K671-AMT-SOLICIT-CPF2               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF3 NOT NUMERIC                                 
              MOVE ZEROES               TO  K671-AMT-SOLICIT-CPF3               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF4 NOT NUMERIC                                 
              MOVE ZEROES               TO  K671-AMT-SOLICIT-CPF4               
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF1-PAID NOT NUMERIC                            
              MOVE ZEROES            TO K671-AMT-SOLICIT-CPF1-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF2-PAID NOT NUMERIC                            
              MOVE ZEROES            TO K671-AMT-SOLICIT-CPF2-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF3-PAID NOT NUMERIC                            
              MOVE ZEROES            TO K671-AMT-SOLICIT-CPF3-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SOLICIT-CPF4-PAID NOT NUMERIC                            
              MOVE ZEROES            TO K671-AMT-SOLICIT-CPF4-PAID              
           END-IF.                                                              
                                                                                
      *LEASE IN ESCROW                                                          
           IF K671-AMT-LSE-ESCR-CPF1 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-LSE-ESCR-CPF1              
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF2 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-LSE-ESCR-CPF2              
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF3 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-LSE-ESCR-CPF3              
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF4 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-LSE-ESCR-CPF4              
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF1-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-LSE-ESCR-CPF1-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF2-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-LSE-ESCR-CPF2-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF3-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-LSE-ESCR-CPF3-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-ESCR-CPF4-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-LSE-ESCR-CPF4-PAID             
           END-IF.                                                              
                                                                                
      *LEASE REGN FEE                                                           
           IF K671-AMT-LSE-REGN-CPF1 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-LSE-REGN-CPF1              
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF2 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-LSE-REGN-CPF2              
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF3 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-LSE-REGN-CPF3              
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF4 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-LSE-REGN-CPF4              
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF1-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-LSE-REGN-CPF1-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF2-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-LSE-REGN-CPF2-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF3-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-LSE-REGN-CPF3-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-REGN-CPF4-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-LSE-REGN-CPF4-PAID             
           END-IF.                                                              
                                                                                
      *SRVY-FEE FEE                                                             
           IF K671-AMT-SRVY-FEE-CPF1 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-SRVY-FEE-CPF1              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF2 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-SRVY-FEE-CPF2              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF3 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-SRVY-FEE-CPF3              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF4 NOT NUMERIC                                
              MOVE ZEROES               TO  K671-AMT-SRVY-FEE-CPF4              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF1-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-SRVY-FEE-CPF1-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF2-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-SRVY-FEE-CPF2-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF3-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-SRVY-FEE-CPF3-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-SRVY-FEE-CPF4-PAID NOT NUMERIC                           
              MOVE ZEROES            TO K671-AMT-SRVY-FEE-CPF4-PAID             
           END-IF.                                                              
                                                                                
      *FRESH CAVEAT FEE                                                         
           IF K671-AMT-FRESH-CAVEAT-CPF1  NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-FRESH-CAVEAT-CPF1              
           END-IF.                                                              
                                                                                
           IF K671-AMT-FRESH-CAVEAT-CPF2  NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-FRESH-CAVEAT-CPF2              
           END-IF.                                                              
                                                                                
           IF K671-AMT-FRESH-CAVEAT-CPF3  NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-FRESH-CAVEAT-CPF3              
           END-IF.                                                              
                                                                                
           IF K671-AMT-FRESH-CAVEAT-CPF4  NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-FRESH-CAVEAT-CPF4              
           END-IF.                                                              
                                                                                
           IF K671-AMT-FRESH-CAV-CPF1-PAID NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-FRESH-CAV-CPF1-PAID            
           END-IF.                                                              
                                                                                
           IF K671-AMT-FRESH-CAV-CPF2-PAID NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-FRESH-CAV-CPF2-PAID            
           END-IF.                                                              
                                                                                
           IF K671-AMT-FRESH-CAV-CPF3-PAID NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-FRESH-CAV-CPF3-PAID            
           END-IF.                                                              
                                                                                
           IF K671-AMT-FRESH-CAV-CPF4-PAID NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-FRESH-CAV-CPF4-PAID            
           END-IF.                                                              
                                                                                
      *SUB-TRAN STAMP FEE                                                       
           IF K671-AMT-SBTR-SF-CPF1 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF1                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF2 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF2                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF3 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF3                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF4 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF4                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF1-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF1-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF2-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF2-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF3-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF3-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-SF-CPF4-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-SF-CPF4-PAID              
           END-IF.                                                              
                                                                                
      *SUB-TRAN CONVEY FEE                                                      
           IF K671-AMT-SBTR-CF-CPF1 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF1                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF2 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF2                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF3 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF3                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF4 NOT NUMERIC                                 
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF4                   
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF1-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF1-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF2-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF2-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF3-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF3-PAID              
           END-IF.                                                              
                                                                                
           IF K671-AMT-SBTR-CF-CPF4-PAID NOT NUMERIC                            
              MOVE ZEROS             TO K671-AMT-SBTR-CF-CPF4-PAID              
           END-IF.                                                              
                                                                                
      *BUYERS WCV                                                               
           IF K671-AMT-BUYER-WCV-CPF1 NOT NUMERIC                               
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF1                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-BUYER-WCV-CPF2 NOT NUMERIC                               
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF2                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-BUYER-WCV-CPF3 NOT NUMERIC                               
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF3                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-BUYER-WCV-CPF4 NOT NUMERIC                               
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF4                 
           END-IF.                                                              
                                                                                
           IF K671-AMT-BUYER-WCV-CPF1-PAID NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF1-PAID            
           END-IF.                                                              
                                                                                
           IF K671-AMT-BUYER-WCV-CPF2-PAID NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF2-PAID            
           END-IF.                                                              
                                                                                
           IF K671-AMT-BUYER-WCV-CPF3-PAID NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF3-PAID            
           END-IF.                                                              
                                                                                
           IF K671-AMT-BUYER-WCV-CPF4-PAID NOT NUMERIC                          
              MOVE ZEROS             TO K671-AMT-BUYER-WCV-CPF4-PAID            
           END-IF.                                                              
                                                                                
      *BANKS WCV                                                                
           IF K671-AMT-BANK-WCV-CPF1 NOT NUMERIC                                
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF1                  
           END-IF.                                                              
                                                                                
           IF K671-AMT-BANK-WCV-CPF2 NOT NUMERIC                                
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF2                  
           END-IF.                                                              
                                                                                
           IF K671-AMT-BANK-WCV-CPF3 NOT NUMERIC                                
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF3                  
           END-IF.                                                              
                                                                                
           IF K671-AMT-BANK-WCV-CPF4 NOT NUMERIC                                
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF4                  
           END-IF.                                                              
                                                                                
           IF K671-AMT-BANK-WCV-CPF1-PAID NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF1-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-BANK-WCV-CPF2-PAID NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF2-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-BANK-WCV-CPF3-PAID NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF3-PAID             
           END-IF.                                                              
                                                                                
           IF K671-AMT-BANK-WCV-CPF4-PAID NOT NUMERIC                           
              MOVE ZEROS             TO K671-AMT-BANK-WCV-CPF4-PAID             
           END-IF.                                                              
                                                                                
       5310-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5320-MOVE-K671-TABLE.                                                    
      *------------------------------------------------------------*            
                                                                                
      * IDP REQ                                                                 
           COMPUTE WS-IDP-REQ(1) = (K671-AMT-SOC-CPF1  +                        
                                    K671-AMT-SOC-CPF1-RETIRE) -                 
                                    K671-AMT-SOC-CPF1-PAID.                     
                                                                                
           COMPUTE WS-IDP-REQ(2) = (K671-AMT-SOC-CPF2  +                        
                                    K671-AMT-SOC-CPF2-RETIRE) -                 
                                    K671-AMT-SOC-CPF2-PAID.                     
                                                                                
           COMPUTE WS-IDP-REQ(3) = (K671-AMT-SOC-CPF3  +                        
                                    K671-AMT-SOC-CPF3-RETIRE) -                 
                                    K671-AMT-SOC-CPF3-PAID.                     
                                                                                
           COMPUTE WS-IDP-REQ(4) = (K671-AMT-SOC-CPF4  +                        
                                    K671-AMT-SOC-CPF4-RETIRE) -                 
                                    K671-AMT-SOC-CPF4-PAID.                     
                                                                                
           IF K110-DTE-KEY-AVAIL > ZEROES                                       
              PERFORM 5330-MOVE-K671-KEYAVAIL THRU 5330-EXIT                    
           END-IF.                                                              
                                                                                
      *SOLICITOR BILL                                                           
           COMPUTE  WS-SOLICIT-REQ(1) = K671-AMT-SOLICIT-CPF1 -                 
                                        K671-AMT-SOLICIT-CPF1-PAID.             
                                                                                
           COMPUTE  WS-SOLICIT-REQ(2) = K671-AMT-SOLICIT-CPF2 -                 
                                        K671-AMT-SOLICIT-CPF2-PAID.             
                                                                                
           COMPUTE  WS-SOLICIT-REQ(3) = K671-AMT-SOLICIT-CPF3 -                 
                                        K671-AMT-SOLICIT-CPF3-PAID.             
                                                                                
           COMPUTE  WS-SOLICIT-REQ(4) = K671-AMT-SOLICIT-CPF4 -                 
                                        K671-AMT-SOLICIT-CPF4-PAID.             
                                                                                
      *LEASE STAMP FEE                                                          
           COMPUTE WS-LEASE-SF-REQ(1) = K671-AMT-LSE-STMP-CPF1 -                
                                        K671-AMT-LSE-STMP-CPF1-PAID.            
                                                                                
           COMPUTE WS-LEASE-SF-REQ(2) = K671-AMT-LSE-STMP-CPF2 -                
                                        K671-AMT-LSE-STMP-CPF2-PAID.            
                                                                                
           COMPUTE WS-LEASE-SF-REQ(3) = K671-AMT-LSE-STMP-CPF3 -                
                                        K671-AMT-LSE-STMP-CPF3-PAID.            
                                                                                
           COMPUTE WS-LEASE-SF-REQ(4) = K671-AMT-LSE-STMP-CPF4 -                
                                        K671-AMT-LSE-STMP-CPF4-PAID.            
                                                                                
      *CAVEAT REGN FEE                                                          
           COMPUTE WS-CAVEAT-REQ(1)   = K671-AMT-CAVEAT-REGN-CPF1 -             
                                        K671-AMT-CAVEAT-REGN-CPF1-PAID.         
                                                                                
           COMPUTE WS-CAVEAT-REQ(2)   = K671-AMT-CAVEAT-REGN-CPF2 -             
                                        K671-AMT-CAVEAT-REGN-CPF2-PAID.         
                                                                                
           COMPUTE WS-CAVEAT-REQ(3)   = K671-AMT-CAVEAT-REGN-CPF3 -             
                                        K671-AMT-CAVEAT-REGN-CPF3-PAID.         
                                                                                
           COMPUTE WS-CAVEAT-REQ(4)   = K671-AMT-CAVEAT-REGN-CPF4 -             
                                        K671-AMT-CAVEAT-REGN-CPF4-PAID.         
                                                                                
      *SALE CONVEY FEE                                                          
           COMPUTE WS-SALE-CF-REQ(1)  = K671-AMT-SALE-CONVY-CPF1  -             
                                        K671-AMT-SALE-CONVY-CPF1-PAID.          
                                                                                
           COMPUTE WS-SALE-CF-REQ(2)  = K671-AMT-SALE-CONVY-CPF2  -             
                                        K671-AMT-SALE-CONVY-CPF2-PAID.          
                                                                                
           COMPUTE WS-SALE-CF-REQ(3)  = K671-AMT-SALE-CONVY-CPF3  -             
                                        K671-AMT-SALE-CONVY-CPF3-PAID.          
                                                                                
           COMPUTE WS-SALE-CF-REQ(4)  = K671-AMT-SALE-CONVY-CPF4  -             
                                        K671-AMT-SALE-CONVY-CPF4-PAID.          
                                                                                
      *MORT CONVEY FEE                                                          
           COMPUTE WS-MORT-CF-REQ(1)  = K671-AMT-MORT-CONVY-CPF1  -             
                                        K671-AMT-MORT-CONVY-CPF1-PAID.          
                                                                                
           COMPUTE WS-MORT-CF-REQ(2)  = K671-AMT-MORT-CONVY-CPF2  -             
                                        K671-AMT-MORT-CONVY-CPF2-PAID.          
                                                                                
           COMPUTE WS-MORT-CF-REQ(3)  = K671-AMT-MORT-CONVY-CPF3  -             
                                        K671-AMT-MORT-CONVY-CPF3-PAID.          
                                                                                
           COMPUTE WS-MORT-CF-REQ(4)  = K671-AMT-MORT-CONVY-CPF4  -             
                                        K671-AMT-MORT-CONVY-CPF4-PAID.          
                                                                                
      *FRESH CAVEAT FEE                                                         
           COMPUTE WS-FRESH-CV-REQ(1) = K671-AMT-FRESH-CAVEAT-CPF1 -            
                                        K671-AMT-FRESH-CAV-CPF1-PAID.           
                                                                                
           COMPUTE WS-FRESH-CV-REQ(2) = K671-AMT-FRESH-CAVEAT-CPF2 -            
                                        K671-AMT-FRESH-CAV-CPF2-PAID.           
                                                                                
           COMPUTE WS-FRESH-CV-REQ(3) = K671-AMT-FRESH-CAVEAT-CPF2 -            
                                        K671-AMT-FRESH-CAV-CPF2-PAID.           
                                                                                
           COMPUTE WS-FRESH-CV-REQ(4) = K671-AMT-FRESH-CAVEAT-CPF2 -            
                                        K671-AMT-FRESH-CAV-CPF2-PAID.           
                                                                                
      *SUB-TRAN SURVEY FEE                                                      
           COMPUTE WS-SUBTR-SF-REQ(1) = K671-AMT-SBTR-SF-CPF1      -            
                                        K671-AMT-SBTR-SF-CPF1-PAID.             
                                                                                
           COMPUTE WS-SUBTR-SF-REQ(2) = K671-AMT-SBTR-SF-CPF2      -            
                                        K671-AMT-SBTR-SF-CPF2-PAID.             
                                                                                
           COMPUTE WS-SUBTR-SF-REQ(3) = K671-AMT-SBTR-SF-CPF3      -            
                                        K671-AMT-SBTR-SF-CPF3-PAID.             
                                                                                
           COMPUTE WS-SUBTR-SF-REQ(4) = K671-AMT-SBTR-SF-CPF4      -            
                                        K671-AMT-SBTR-SF-CPF4-PAID.             
                                                                                
      *SUB-TRAN CONVEY FEE                                                      
           COMPUTE WS-SUBTR-CF-REQ(1) = K671-AMT-SBTR-CF-CPF1      -            
                                        K671-AMT-SBTR-CF-CPF1-PAID.             
                                                                                
           COMPUTE WS-SUBTR-CF-REQ(2) = K671-AMT-SBTR-CF-CPF2      -            
                                        K671-AMT-SBTR-CF-CPF2-PAID.             
                                                                                
           COMPUTE WS-SUBTR-CF-REQ(3) = K671-AMT-SBTR-CF-CPF3      -            
                                        K671-AMT-SBTR-CF-CPF3-PAID.             
                                                                                
           COMPUTE WS-SUBTR-CF-REQ(4) = K671-AMT-SBTR-CF-CPF4      -            
                                        K671-AMT-SBTR-CF-CPF4-PAID.             
                                                                                
      *BUYERS WCV                                                               
           COMPUTE WS-BUYER-WCV-REQ(1) = K671-AMT-BUYER-WCV-CPF1    -           
                                         K671-AMT-BUYER-WCV-CPF1-PAID.          
                                                                                
           COMPUTE WS-BUYER-WCV-REQ(2) = K671-AMT-BUYER-WCV-CPF2    -           
                                         K671-AMT-BUYER-WCV-CPF2-PAID.          
                                                                                
           COMPUTE WS-BUYER-WCV-REQ(3) = K671-AMT-BUYER-WCV-CPF3    -           
                                         K671-AMT-BUYER-WCV-CPF3-PAID.          
                                                                                
           COMPUTE WS-BUYER-WCV-REQ(4) = K671-AMT-BUYER-WCV-CPF4    -           
                                         K671-AMT-BUYER-WCV-CPF4-PAID.          
                                                                                
      *BANKERS WCV                                                              
           COMPUTE WS-BANK-WCV-REQ(1)  = K671-AMT-BANK-WCV-CPF1     -           
                                         K671-AMT-BANK-WCV-CPF1-PAID.           
                                                                                
           COMPUTE WS-BANK-WCV-REQ(2)  = K671-AMT-BANK-WCV-CPF2     -           
                                         K671-AMT-BANK-WCV-CPF2-PAID.           
                                                                                
           COMPUTE WS-BANK-WCV-REQ(3)  = K671-AMT-BANK-WCV-CPF3     -           
                                         K671-AMT-BANK-WCV-CPF3-PAID.           
                                                                                
           COMPUTE WS-BANK-WCV-REQ(4)  = K671-AMT-BANK-WCV-CPF4     -           
                                         K671-AMT-BANK-WCV-CPF4-PAID.           
                                                                                
       5320-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5330-MOVE-K671-KEYAVAIL.                                                 
      *------------------------------------------------------------*            
                                                                                
      * LUMPSUM REQ                                                             
           COMPUTE WS-LUMPSUM-REQ(1) = (K671-AMT-LUMPSUM-CPF1  +                
                                        K671-AMT-LUMPSUM-CPF1-RETIRE) -         
                                        K671-AMT-LUMPSUM-CPF1-PAID.             
                                                                                
           COMPUTE WS-LUMPSUM-REQ(2) = (K671-AMT-LUMPSUM-CPF2  +                
                                        K671-AMT-LUMPSUM-CPF2-RETIRE) -         
                                        K671-AMT-LUMPSUM-CPF2-PAID.             
                                                                                
           COMPUTE WS-LUMPSUM-REQ(3) = (K671-AMT-LUMPSUM-CPF3  +                
                                        K671-AMT-LUMPSUM-CPF3-RETIRE) -         
                                        K671-AMT-LUMPSUM-CPF3-PAID.             
                                                                                
           COMPUTE WS-LUMPSUM-REQ(4) = (K671-AMT-LUMPSUM-CPF4  +                
                                        K671-AMT-LUMPSUM-CPF4-RETIRE) -         
                                        K671-AMT-LUMPSUM-CPF4-PAID.             
                                                                                
      *LEASE IN ESCROW                                                          
           COMPUTE WS-LSE-ESCR-REQ(1)  = K671-AMT-LSE-ESCR-CPF1     -           
                                         K671-AMT-LSE-ESCR-CPF1-PAID.           
                                                                                
           COMPUTE WS-LSE-ESCR-REQ(2)  = K671-AMT-LSE-ESCR-CPF2     -           
                                         K671-AMT-LSE-ESCR-CPF2-PAID.           
                                                                                
           COMPUTE WS-LSE-ESCR-REQ(3)  = K671-AMT-LSE-ESCR-CPF3     -           
                                         K671-AMT-LSE-ESCR-CPF3-PAID.           
                                                                                
           COMPUTE WS-LSE-ESCR-REQ(4)  = K671-AMT-LSE-ESCR-CPF4     -           
                                         K671-AMT-LSE-ESCR-CPF4-PAID.           
                                                                                
      *LEASE REGN FEE                                                           
           COMPUTE WS-LSE-REGN-REQ(1)  = K671-AMT-LSE-REGN-CPF1     -           
                                         K671-AMT-LSE-REGN-CPF1-PAID.           
                                                                                
           COMPUTE WS-LSE-REGN-REQ(2)  = K671-AMT-LSE-REGN-CPF2     -           
                                         K671-AMT-LSE-REGN-CPF2-PAID.           
                                                                                
           COMPUTE WS-LSE-REGN-REQ(3)  = K671-AMT-LSE-REGN-CPF3     -           
                                         K671-AMT-LSE-REGN-CPF3-PAID.           
                                                                                
           COMPUTE WS-LSE-REGN-REQ(4)  = K671-AMT-LSE-REGN-CPF4     -           
                                         K671-AMT-LSE-REGN-CPF4-PAID.           
                                                                                
      *LEASE REGN FEE                                                           
           COMPUTE WS-SRVY-FEE-REQ(1)  = K671-AMT-SRVY-FEE-CPF1     -           
                                         K671-AMT-SRVY-FEE-CPF1-PAID.           
                                                                                
           COMPUTE WS-SRVY-FEE-REQ(2)  = K671-AMT-SRVY-FEE-CPF2     -           
                                         K671-AMT-SRVY-FEE-CPF2-PAID.           
                                                                                
           COMPUTE WS-SRVY-FEE-REQ(3)  = K671-AMT-SRVY-FEE-CPF3     -           
                                         K671-AMT-SRVY-FEE-CPF3-PAID.           
                                                                                
           COMPUTE WS-SRVY-FEE-REQ(4)  = K671-AMT-SRVY-FEE-CPF4     -           
                                         K671-AMT-SRVY-FEE-CPF4-PAID.           
                                                                                
       5330-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5400-COMPUTE-PAID.                                                       
      *------------------------------------------------------------*            
                                                                                
           IF K110-DTE-KEY-AVAIL = SPACES OR LOW-VALUES OR ZEROES               
              PERFORM 5410-COMPUTE-PAID-KEY-NO-AVAIL THRU 5410-EXIT             
           ELSE                                                                 
              PERFORM 5420-COMPUTE-PAID-KEY-AVAIL    THRU 5420-EXIT             
           END-IF.                                                              
                                                                                
       5400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5410-COMPUTE-PAID-KEY-NO-AVAIL.                                          
      *------------------------------------------------------------*            
                                                                                
           COMPUTE WS-TOTAL-LUMP-IDP-REQ(WS-CTR) =                              
                   WS-LUMPSUM-REQ(WS-CTR).                                      
                                                                                
      */// IDP                                                                  
                                                                                
           IF WS-F04A-IDP >= WS-TOTAL-LUMP-IDP-REQ(WS-CTR)                      
              MOVE WS-IDP-REQ(WS-CTR)   TO WS-IDP-PD(WS-CTR)                    
              COMPUTE WS-F04A-IDP = WS-F04A-IDP -                               
                                    WS-IDP-PD   (WS-CTR)                        
           ELSE                                                                 
              MOVE WS-F04A-IDP      TO WS-IDP-PD(WS-CTR)                        
              MOVE +0 TO WS-F04A-IDP                                            
           END-IF.                                                              
                                                                                
           MOVE WS-IDP-PD(WS-CTR)             TO WS-PRINT-IDP-PD.               
           MOVE WS-TOTAL-LUMP-IDP-REQ(WS-CTR) TO WS-PRINT-IDP-REQ.              
                                                                                
      */// LEGAL FEES                                                           
                                                                                
           PERFORM 5415-LEGAL-FEES       THRU 5415-EXIT.                        
                                                                                
       5410-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5415-LEGAL-FEES.                                                         
      *------------------------------------------------------------*            
                                                                                
           COMPUTE WS-LEGAL-FEES-REQ =                                          
                       WS-CAVEAT-REQ   (WS-CTR) +                               
                       WS-LEASE-SF-REQ (WS-CTR) +                               
                       WS-SALE-CF-REQ  (WS-CTR) +                               
                       WS-MORT-CF-REQ  (WS-CTR) +                               
                       WS-SOLICIT-REQ  (WS-CTR) +                               
                       WS-FRESH-CV-REQ (WS-CTR) +                               
                       WS-SUBTR-SF-REQ (WS-CTR) +                               
                       WS-SUBTR-CF-REQ (WS-CTR) +                               
                       WS-BUYER-WCV-REQ(WS-CTR) +                               
                       WS-BANK-WCV-REQ (WS-CTR).                                
                                                                                
           MOVE WS-F04A-STAMP-LEGAL-FEE TO WS-TOTAL-LEGAL-FEES.                 
                                                                                
           IF WS-F04A-STAMP-LEGAL-FEE = 0                                       
              MOVE +0 TO  WS-CAVEAT-REQ      (WS-CTR)                           
                          WS-LEASE-SF-REQ    (WS-CTR)                           
                          WS-SALE-CF-REQ     (WS-CTR)                           
                          WS-MORT-CF-REQ     (WS-CTR)                           
                          WS-SOLICIT-REQ     (WS-CTR)                           
                          WS-FRESH-CV-REQ    (WS-CTR)                           
                          WS-SUBTR-SF-REQ    (WS-CTR)                           
                          WS-SUBTR-CF-REQ    (WS-CTR)                           
                          WS-BUYER-WCV-REQ   (WS-CTR)                           
                          WS-BANK-WCV-REQ    (WS-CTR)                           
           ELSE                                                                 
              IF WS-F04A-STAMP-LEGAL-FEE   >= WS-LEGAL-FEES-REQ                 
                 IF WS-F04A-STAMP-LEGAL-FEE = WS-LEGAL-FEES-REQ                 
                    MOVE WS-F04A-STAMP-LEGAL-FEE TO WS-PRINT-TOTAL-FEE          
                 ELSE                                                           
                    MOVE WS-LEGAL-FEES-REQ       TO WS-PRINT-TOTAL-FEE          
                 END-IF                                                         
                 MOVE WS-CAVEAT-REQ       (WS-CTR)   TO                         
                      WS-CAVEAT-PD        (WS-CTR)                              
                 MOVE WS-LEASE-SF-REQ     (WS-CTR)   TO                         
                      WS-LEASE-SF-PD      (WS-CTR)                              
                 MOVE WS-SALE-CF-REQ      (WS-CTR)   TO                         
                      WS-SALE-CF-PD       (WS-CTR)                              
                 MOVE WS-MORT-CF-REQ      (WS-CTR)   TO                         
                      WS-MORT-CF-PD       (WS-CTR)                              
                 MOVE WS-SOLICIT-REQ      (WS-CTR)   TO                         
                      WS-SOLICIT-REQ      (WS-CTR)                              
                 MOVE WS-FRESH-CV-REQ     (WS-CTR)   TO                         
                      WS-FRESH-CV-PD      (WS-CTR)                              
                 MOVE WS-SUBTR-SF-REQ     (WS-CTR)   TO                         
                      WS-SUBTR-SF-PD      (WS-CTR)                              
                 MOVE WS-SUBTR-CF-REQ     (WS-CTR)   TO                         
                      WS-SUBTR-CF-PD      (WS-CTR)                              
                 MOVE WS-BUYER-WCV-REQ    (WS-CTR)   TO                         
                      WS-BUYER-WCV-PD     (WS-CTR)                              
                 MOVE WS-BANK-WCV-REQ     (WS-CTR)   TO                         
                      WS-BANK-WCV-PD      (WS-CTR)                              
              ELSE                                                              
                 MOVE WS-F04A-STAMP-LEGAL-FEE TO WS-PRINT-TOTAL-FEE             
                                                                                
      */// CAVEAT                                                               
                                                                                
                 MOVE WS-CAVEAT-REQ(WS-CTR)   TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES    THRU 5450-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-CAVEAT-PD(WS-CTR)           
                                                                                
      */// LEASE STAMP                                                          
                                                                                
                 MOVE WS-LEASE-SF-REQ(WS-CTR) TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES    THRU 5450-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-LEASE-SF-PD(WS-CTR)         
                                                                                
      */// SALE CONVEY                                                          
                                                                                
                 MOVE WS-SALE-CF-REQ (WS-CTR) TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES    THRU 5450-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-SALE-CF-PD(WS-CTR)          
                                                                                
      */// MORT CONVEY                                                          
                                                                                
                 MOVE WS-MORT-CF-REQ (WS-CTR) TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES    THRU 5450-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-MORT-CF-PD(WS-CTR)          
                                                                                
      */// SOLICITOR                                                            
                                                                                
                 MOVE WS-SOLICIT-REQ (WS-CTR) TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES    THRU 5450-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-SOLICIT-PD(WS-CTR)          
                                                                                
      */// FRESH CAVEAT                                                         
                                                                                
                 MOVE WS-FRESH-CV-REQ(WS-CTR) TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES    THRU 5450-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-FRESH-CV-PD(WS-CTR)         
                                                                                
      */// SUB-TRANSFER SF                                                      
                                                                                
                 MOVE WS-SUBTR-SF-REQ(WS-CTR) TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES    THRU 5450-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-SUBTR-SF-PD(WS-CTR)         
                                                                                
      */// SUB-TRANSFER CF                                                      
                                                                                
                 MOVE WS-SUBTR-CF-REQ(WS-CTR) TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES    THRU 5450-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-SUBTR-CF-PD(WS-CTR)         
                                                                                
      */// BUYERS WCV                                                           
                                                                                
                 MOVE WS-BUYER-WCV-REQ(WS-CTR) TO WS-AMT-REQUIRED               
                 PERFORM 5450-COMPUTE-FEES   THRU 5450-EXIT                     
                 MOVE WS-AMT-PAID            TO WS-BUYER-WCV-PD(WS-CTR)         
                                                                                
      */// BANKS WCV                                                            
                                                                                
                 MOVE WS-BANK-WCV-REQ(WS-CTR) TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES   THRU 5450-EXIT                     
                 MOVE WS-AMT-PAID            TO WS-BANK-WCV-PD(WS-CTR)          
                                                                                
           END-IF.                                                              
                                                                                
       5415-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5420-COMPUTE-PAID-KEY-AVAIL.                                             
      *------------------------------------------------------------*            
                                                                                
           COMPUTE WS-TOTAL-LUMP-IDP-REQ(WS-CTR) =                              
                   WS-IDP-REQ(WS-CTR) + WS-LUMPSUM-REQ(WS-CTR).                 
                                                                                
      */// IDP & LUMPSUM                                                        
                                                                                
           IF WS-F04A-IDP >= WS-TOTAL-LUMP-IDP-REQ(WS-CTR)                      
              MOVE WS-LUMPSUM-REQ (WS-CTR) TO WS-LUMPSUM-PD(WS-CTR)             
              MOVE WS-IDP-REQ     (WS-CTR) TO WS-IDP-PD(WS-CTR)                 
              COMPUTE WS-F04A-IDP = WS-F04A-IDP -                               
                                    (WS-IDP-PD    (WS-CTR) +                    
                                     WS-LUMPSUM-PD(WS-CTR))                     
           ELSE                                                                 
              IF WS-F04A-IDP >= WS-IDP-REQ(WS-CTR)                              
                 MOVE WS-IDP-REQ(WS-CTR)   TO WS-IDP-PD(WS-CTR)                 
                 COMPUTE WS-F04A-IDP = WS-F04A-IDP -                            
                                       WS-IDP-PD   (WS-CTR)                     
                 MOVE WS-F04A-IDP      TO WS-LUMPSUM-PD (WS-CTR)                
              ELSE                                                              
                 MOVE WS-F04A-IDP      TO WS-IDP-PD(WS-CTR)                     
                 MOVE +0 TO WS-F04A-IDP WS-LUMPSUM-PD (WS-CTR)                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
           COMPUTE WS-TOTAL-LUMP-IDP-PD(WS-CTR) =                               
                                                WS-IDP-PD (WS-CTR) +            
                                                WS-LUMPSUM-PD (WS-CTR).         
           MOVE WS-TOTAL-LUMP-IDP-PD(WS-CTR)  TO WS-PRINT-IDP-PD.               
           MOVE WS-TOTAL-LUMP-IDP-REQ(WS-CTR) TO WS-PRINT-IDP-REQ.              
                                                                                
      */// LEGAL FEES                                                           
                                                                                
           PERFORM 5425-LEGAL-FEES       THRU 5425-EXIT.                        
                                                                                
       5420-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5425-LEGAL-FEES.                                                         
      *------------------------------------------------------------*            
                                                                                
           COMPUTE WS-LEGAL-FEES-REQ =                                          
                       WS-CAVEAT-REQ   (WS-CTR) +                               
                       WS-LEASE-SF-REQ (WS-CTR) +                               
                       WS-SALE-CF-REQ  (WS-CTR) +                               
                       WS-MORT-CF-REQ  (WS-CTR) +                               
                       WS-LSE-REGN-REQ (WS-CTR) +                               
                       WS-LSE-ESCR-REQ (WS-CTR) +                               
                       WS-SRVY-FEE-REQ (WS-CTR) +                               
                       WS-SOLICIT-REQ  (WS-CTR) +                               
                       WS-FRESH-CV-REQ (WS-CTR) +                               
                       WS-SUBTR-SF-REQ (WS-CTR) +                               
                       WS-SUBTR-CF-REQ (WS-CTR) +                               
                       WS-BUYER-WCV-REQ(WS-CTR) +                               
                       WS-BANK-WCV-REQ (WS-CTR).                                
                                                                                
           MOVE WS-F04A-STAMP-LEGAL-FEE TO WS-TOTAL-LEGAL-FEES.                 
                                                                                
           IF WS-F04A-STAMP-LEGAL-FEE = 0                                       
              MOVE +0 TO  WS-CAVEAT-REQ      (WS-CTR)                           
                          WS-LEASE-SF-REQ    (WS-CTR)                           
                          WS-SALE-CF-REQ     (WS-CTR)                           
                          WS-MORT-CF-REQ     (WS-CTR)                           
                          WS-LSE-REGN-REQ    (WS-CTR)                           
                          WS-LSE-ESCR-REQ    (WS-CTR)                           
                          WS-SRVY-FEE-REQ    (WS-CTR)                           
                          WS-SOLICIT-REQ     (WS-CTR)                           
                          WS-FRESH-CV-REQ    (WS-CTR)                           
                          WS-SUBTR-SF-REQ    (WS-CTR)                           
                          WS-SUBTR-CF-REQ    (WS-CTR)                           
                          WS-BUYER-WCV-REQ   (WS-CTR)                           
                          WS-BANK-WCV-REQ    (WS-CTR)                           
           ELSE                                                                 
              IF WS-F04A-STAMP-LEGAL-FEE   >= WS-LEGAL-FEES-REQ                 
                 IF WS-F04A-STAMP-LEGAL-FEE = WS-LEGAL-FEES-REQ                 
                    MOVE WS-F04A-STAMP-LEGAL-FEE TO WS-PRINT-TOTAL-FEE          
                 ELSE                                                           
                    MOVE WS-LEGAL-FEES-REQ       TO WS-PRINT-TOTAL-FEE          
                 END-IF                                                         
                 MOVE WS-CAVEAT-REQ       (WS-CTR)   TO                         
                      WS-CAVEAT-PD        (WS-CTR)                              
                 MOVE WS-LEASE-SF-REQ     (WS-CTR)   TO                         
                      WS-LEASE-SF-PD      (WS-CTR)                              
                 MOVE WS-SALE-CF-REQ      (WS-CTR)   TO                         
                      WS-SALE-CF-PD       (WS-CTR)                              
                 MOVE WS-MORT-CF-REQ      (WS-CTR)   TO                         
                      WS-MORT-CF-PD       (WS-CTR)                              
                 MOVE WS-LSE-REGN-REQ     (WS-CTR)   TO                         
                      WS-LSE-REGN-PD      (WS-CTR)                              
                 MOVE WS-LSE-ESCR-REQ     (WS-CTR)   TO                         
                      WS-LSE-ESCR-PD      (WS-CTR)                              
                 MOVE WS-SRVY-FEE-REQ     (WS-CTR)   TO                         
                      WS-SRVY-FEE-PD      (WS-CTR)                              
                 MOVE WS-SOLICIT-REQ      (WS-CTR)   TO                         
                      WS-SOLICIT-REQ      (WS-CTR)                              
                 MOVE WS-FRESH-CV-REQ     (WS-CTR)   TO                         
                      WS-FRESH-CV-PD      (WS-CTR)                              
                 MOVE WS-SUBTR-SF-REQ     (WS-CTR)   TO                         
                      WS-SUBTR-SF-PD      (WS-CTR)                              
                 MOVE WS-SUBTR-CF-REQ     (WS-CTR)   TO                         
                      WS-SUBTR-CF-PD      (WS-CTR)                              
                 MOVE WS-BUYER-WCV-REQ    (WS-CTR)   TO                         
                      WS-BUYER-WCV-PD     (WS-CTR)                              
                 MOVE WS-BANK-WCV-REQ     (WS-CTR)   TO                         
                      WS-BANK-WCV-PD      (WS-CTR)                              
              ELSE                                                              
                 MOVE WS-F04A-STAMP-LEGAL-FEE TO   WS-PRINT-TOTAL-FEE           
                                                                                
      */// CAVEAT                                                               
                                                                                
                 MOVE WS-CAVEAT-REQ(WS-CTR)   TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES    THRU 5450-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-CAVEAT-PD(WS-CTR)           
                                                                                
      */// LEASE STAMP                                                          
                                                                                
                 MOVE WS-LEASE-SF-REQ(WS-CTR) TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES    THRU 5450-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-LEASE-SF-PD(WS-CTR)         
                                                                                
      */// SALE CONVEY                                                          
                                                                                
                 MOVE WS-SALE-CF-REQ (WS-CTR) TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES    THRU 5450-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-SALE-CF-PD(WS-CTR)          
                                                                                
      */// MORT CONVEY                                                          
                                                                                
                 MOVE WS-MORT-CF-REQ (WS-CTR) TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES    THRU 5450-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-MORT-CF-PD(WS-CTR)          
                                                                                
      */// LEASE REGN FEE                                                       
                                                                                
                 MOVE WS-LSE-REGN-REQ(WS-CTR) TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES    THRU 5450-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-LSE-REGN-PD(WS-CTR)         
                                                                                
      */// LEASE IN ESCROW                                                      
                                                                                
                 MOVE WS-LSE-ESCR-REQ(WS-CTR) TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES    THRU 5450-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-LSE-ESCR-PD(WS-CTR)         
                                                                                
      */// SURVEY FEE                                                           
                                                                                
                 MOVE WS-SRVY-FEE-REQ(WS-CTR) TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES    THRU 5450-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-SRVY-FEE-PD(WS-CTR)         
                                                                                
      */// SOLICITOR                                                            
                                                                                
                 MOVE WS-SOLICIT-REQ (WS-CTR) TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES    THRU 5450-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-SOLICIT-PD(WS-CTR)          
                                                                                
      */// FRESH CAVEAT                                                         
                                                                                
                 MOVE WS-FRESH-CV-REQ(WS-CTR) TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES    THRU 5450-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-FRESH-CV-PD(WS-CTR)         
                                                                                
      */// SUB-TRANSFER SF                                                      
                                                                                
                 MOVE WS-SUBTR-SF-REQ(WS-CTR) TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES    THRU 5450-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-SUBTR-SF-PD(WS-CTR)         
                                                                                
      */// SUB-TRANSFER CF                                                      
                                                                                
                 MOVE WS-SUBTR-CF-REQ(WS-CTR) TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES    THRU 5450-EXIT                    
                 MOVE WS-AMT-PAID             TO WS-SUBTR-CF-PD(WS-CTR)         
                                                                                
      */// BUYERS WCV                                                           
                                                                                
                 MOVE WS-BUYER-WCV-REQ(WS-CTR) TO WS-AMT-REQUIRED               
                 PERFORM 5450-COMPUTE-FEES   THRU 5450-EXIT                     
                 MOVE WS-AMT-PAID            TO WS-BUYER-WCV-PD(WS-CTR)         
                                                                                
      */// BANKS WCV                                                            
                                                                                
                 MOVE WS-BANK-WCV-REQ(WS-CTR) TO WS-AMT-REQUIRED                
                 PERFORM 5450-COMPUTE-FEES   THRU 5450-EXIT                     
                 MOVE WS-AMT-PAID            TO WS-BANK-WCV-PD(WS-CTR)          
                                                                                
           END-IF.                                                              
                                                                                
       5425-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------*                                                      
       5450-COMPUTE-FEES.                                                       
      *------------------*                                                      
                                                                                
           IF WS-TOTAL-LEGAL-FEES >= WS-AMT-REQUIRED                            
              MOVE WS-AMT-REQUIRED   TO WS-AMT-PAID                             
              COMPUTE WS-TOTAL-LEGAL-FEES = WS-TOTAL-LEGAL-FEES -               
                                            WS-AMT-REQUIRED                     
           ELSE                                                                 
              MOVE WS-TOTAL-LEGAL-FEES TO WS-AMT-PAID                           
              MOVE +0                  TO WS-TOTAL-LEGAL-FEES                   
           END-IF.                                                              
                                                                                
       5450-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5500-PROCESS-CPF1.                                                       
      *------------------------------------------------------------*            
                                                                                
           MOVE WS-NUM-VALUE-DATE               TO K671-DTE-VALUE-CPF1.         
                                                                                
           IF K110-DTE-KEY-AVAIL NOT = SPACES AND LOW-VALUES AND ZEROES         
              ADD  WS-LUMPSUM-PD(WS-CTR) TO                                     
                   K671-AMT-LUMPSUM-CPF1-PAID                                   
              ADD  WS-LSE-ESCR-PD  (WS-CTR)     TO                              
                   K671-AMT-LSE-ESCR-CPF1-PAID                                  
              ADD  WS-LSE-REGN-PD  (WS-CTR)     TO                              
                   K671-AMT-LSE-REGN-CPF1-PAID                                  
              ADD  WS-SRVY-FEE-PD  (WS-CTR)     TO                              
                   K671-AMT-SRVY-FEE-CPF1-PAID                                  
           END-IF.                                                              
                                                                                
           ADD  WS-IDP-PD          (WS-CTR)     TO                              
                K671-AMT-SOC-CPF1-PAID                                          
           ADD  WS-SOLICIT-PD      (WS-CTR)     TO                              
                K671-AMT-SOLICIT-CPF1-PAID.                                     
           ADD  WS-LEASE-SF-PD     (WS-CTR)     TO                              
                K671-AMT-LSE-STMP-CPF1-PAID.                                    
           ADD  WS-SALE-CF-PD      (WS-CTR)     TO                              
                K671-AMT-SALE-CONVY-CPF1-PAID.                                  
           ADD  WS-MORT-CF-PD      (WS-CTR)     TO                              
                K671-AMT-MORT-CONVY-CPF1-PAID.                                  
           ADD  WS-CAVEAT-PD       (WS-CTR)     TO                              
                K671-AMT-CAVEAT-REGN-CPF1-PAID.                                 
           ADD  WS-FRESH-CV-PD     (WS-CTR)     TO                              
                K671-AMT-FRESH-CAV-CPF1-PAID.                                   
           ADD  WS-SUBTR-SF-PD     (WS-CTR)     TO                              
                K671-AMT-SBTR-SF-CPF1-PAID.                                     
           ADD  WS-SUBTR-CF-PD     (WS-CTR)     TO                              
                K671-AMT-SBTR-CF-CPF1-PAID.                                     
           ADD  WS-BUYER-WCV-PD    (WS-CTR)     TO                              
                K671-AMT-BUYER-WCV-CPF1-PAID.                                   
           ADD  WS-BANK-WCV-PD     (WS-CTR)     TO                              
                K671-AMT-BANK-WCV-CPF1-PAID.                                    
                                                                                
           PERFORM 5900-REWRITE-BP13K671 THRU 5900-EXIT.                        
           PERFORM 6500-CHECK-CPF1       THRU 6500-EXIT.                        
                                                                                
       5500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5510-PROCESS-CPF2.                                                       
      *------------------------------------------------------------*            
                                                                                
           MOVE WS-NUM-VALUE-DATE               TO K671-DTE-VALUE-CPF2.         
                                                                                
           IF K110-DTE-KEY-AVAIL NOT = SPACES AND LOW-VALUES AND ZEROES         
              ADD  WS-LUMPSUM-PD(WS-CTR)        TO                              
                   K671-AMT-LUMPSUM-CPF2-PAID                                   
              ADD  WS-LSE-ESCR-PD  (WS-CTR)     TO                              
                   K671-AMT-LSE-ESCR-CPF2-PAID                                  
              ADD  WS-LSE-REGN-PD  (WS-CTR)     TO                              
                   K671-AMT-LSE-REGN-CPF2-PAID                                  
              ADD  WS-SRVY-FEE-PD  (WS-CTR)     TO                              
                   K671-AMT-SRVY-FEE-CPF2-PAID                                  
           END-IF.                                                              
                                                                                
           ADD  WS-IDP-PD         (WS-CTR)      TO                              
                K671-AMT-SOC-CPF2-PAID                                          
           ADD  WS-SOLICIT-PD     (WS-CTR)      TO                              
                K671-AMT-SOLICIT-CPF2-PAID.                                     
           ADD  WS-LEASE-SF-PD     (WS-CTR)     TO                              
                K671-AMT-LSE-STMP-CPF2-PAID.                                    
           ADD  WS-SALE-CF-PD      (WS-CTR)     TO                              
                K671-AMT-SALE-CONVY-CPF2-PAID.                                  
           ADD  WS-MORT-CF-PD      (WS-CTR)     TO                              
                K671-AMT-MORT-CONVY-CPF2-PAID.                                  
           ADD  WS-CAVEAT-PD       (WS-CTR)     TO                              
                K671-AMT-CAVEAT-REGN-CPF2-PAID.                                 
           ADD  WS-FRESH-CV-PD     (WS-CTR)     TO                              
                K671-AMT-FRESH-CAV-CPF2-PAID.                                   
           ADD  WS-SUBTR-SF-PD     (WS-CTR)     TO                              
                K671-AMT-SBTR-SF-CPF2-PAID.                                     
           ADD  WS-SUBTR-CF-PD     (WS-CTR)     TO                              
                K671-AMT-SBTR-CF-CPF2-PAID.                                     
           ADD  WS-BUYER-WCV-PD    (WS-CTR)     TO                              
                K671-AMT-BUYER-WCV-CPF2-PAID.                                   
           ADD  WS-BANK-WCV-PD     (WS-CTR)     TO                              
                K671-AMT-BANK-WCV-CPF2-PAID.                                    
                                                                                
           PERFORM 5900-REWRITE-BP13K671 THRU 5900-EXIT.                        
           PERFORM 6550-CHECK-CPF2       THRU 6550-EXIT.                        
                                                                                
       5510-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5520-PROCESS-CPF3.                                                       
      *------------------------------------------------------------*            
                                                                                
           MOVE WS-NUM-VALUE-DATE               TO K671-DTE-VALUE-CPF3.         
                                                                                
           IF K110-DTE-KEY-AVAIL NOT = SPACES AND LOW-VALUES AND ZEROES         
              ADD  WS-LUMPSUM-PD(WS-CTR)        TO                              
                   K671-AMT-LUMPSUM-CPF3-PAID                                   
              ADD  WS-LSE-ESCR-PD  (WS-CTR)     TO                              
                   K671-AMT-LSE-ESCR-CPF3-PAID                                  
              ADD  WS-LSE-REGN-PD  (WS-CTR)     TO                              
                   K671-AMT-LSE-REGN-CPF3-PAID                                  
              ADD  WS-SRVY-FEE-PD  (WS-CTR)     TO                              
                   K671-AMT-SRVY-FEE-CPF3-PAID                                  
           END-IF.                                                              
                                                                                
           ADD  WS-IDP-PD          (WS-CTR)     TO                              
                K671-AMT-SOC-CPF3-PAID                                          
           ADD  WS-SOLICIT-PD      (WS-CTR)     TO                              
                K671-AMT-SOLICIT-CPF3-PAID                                      
           ADD  WS-LEASE-SF-PD     (WS-CTR)     TO                              
                K671-AMT-LSE-STMP-CPF3-PAID.                                    
           ADD  WS-SALE-CF-PD      (WS-CTR)     TO                              
                K671-AMT-SALE-CONVY-CPF3-PAID.                                  
           ADD  WS-MORT-CF-PD      (WS-CTR)     TO                              
                K671-AMT-MORT-CONVY-CPF3-PAID.                                  
           ADD  WS-CAVEAT-PD       (WS-CTR)     TO                              
                K671-AMT-CAVEAT-REGN-CPF3-PAID.                                 
           ADD  WS-FRESH-CV-PD     (WS-CTR)     TO                              
                K671-AMT-FRESH-CAV-CPF3-PAID.                                   
           ADD  WS-SUBTR-SF-PD     (WS-CTR)     TO                              
                K671-AMT-SBTR-SF-CPF3-PAID.                                     
           ADD  WS-SUBTR-CF-PD     (WS-CTR)     TO                              
                K671-AMT-SBTR-CF-CPF3-PAID.                                     
           ADD  WS-BUYER-WCV-PD    (WS-CTR)     TO                              
                K671-AMT-BUYER-WCV-CPF3-PAID.                                   
           ADD  WS-BANK-WCV-PD     (WS-CTR)     TO                              
                K671-AMT-BANK-WCV-CPF3-PAID.                                    
                                                                                
           PERFORM 5900-REWRITE-BP13K671 THRU 5900-EXIT.                        
           PERFORM 6600-CHECK-CPF3       THRU 6600-EXIT.                        
                                                                                
       5520-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5530-PROCESS-CPF4.                                                       
      *------------------------------------------------------------*            
                                                                                
           MOVE WS-NUM-VALUE-DATE               TO K671-DTE-VALUE-CPF4.         
                                                                                
           IF K110-DTE-KEY-AVAIL NOT = SPACES AND LOW-VALUES AND ZEROES         
              ADD  WS-LUMPSUM-PD(WS-CTR)        TO                              
                   K671-AMT-LUMPSUM-CPF4-PAID                                   
                                                                                
              ADD  WS-LSE-ESCR-PD  (WS-CTR)     TO                              
                   K671-AMT-LSE-ESCR-CPF4-PAID                                  
              ADD  WS-LSE-REGN-PD  (WS-CTR)     TO                              
                   K671-AMT-LSE-REGN-CPF4-PAID                                  
              ADD  WS-SRVY-FEE-PD  (WS-CTR)     TO                              
                   K671-AMT-SRVY-FEE-CPF4-PAID                                  
           END-IF.                                                              
                                                                                
           ADD  WS-IDP-PD          (WS-CTR)     TO                              
                K671-AMT-SOC-CPF4-PAID.                                         
           ADD  WS-SOLICIT-PD      (WS-CTR)     TO                              
                K671-AMT-SOLICIT-CPF4-PAID.                                     
           ADD  WS-LEASE-SF-PD     (WS-CTR)     TO                              
                K671-AMT-LSE-STMP-CPF4-PAID.                                    
           ADD  WS-SALE-CF-PD      (WS-CTR)     TO                              
                K671-AMT-SALE-CONVY-CPF4-PAID.                                  
           ADD  WS-MORT-CF-PD      (WS-CTR)     TO                              
                K671-AMT-MORT-CONVY-CPF4-PAID.                                  
           ADD  WS-CAVEAT-PD       (WS-CTR)     TO                              
                K671-AMT-CAVEAT-REGN-CPF4-PAID.                                 
           ADD  WS-FRESH-CV-PD     (WS-CTR)     TO                              
                K671-AMT-FRESH-CAV-CPF4-PAID.                                   
           ADD  WS-SUBTR-SF-PD     (WS-CTR)     TO                              
                K671-AMT-SBTR-SF-CPF4-PAID.                                     
           ADD  WS-SUBTR-CF-PD     (WS-CTR)     TO                              
                K671-AMT-SBTR-CF-CPF4-PAID.                                     
           ADD  WS-BUYER-WCV-PD    (WS-CTR)     TO                              
                K671-AMT-BUYER-WCV-CPF4-PAID.                                   
           ADD  WS-BANK-WCV-PD     (WS-CTR)     TO                              
                K671-AMT-BANK-WCV-CPF4-PAID.                                    
                                                                                
           PERFORM 5900-REWRITE-BP13K671 THRU 5900-EXIT.                        
           PERFORM 6650-CHECK-CPF4       THRU 6650-EXIT.                        
                                                                                
       5530-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       5900-REWRITE-BP13K671.                                                   
      *------------------------------------------------------------*            
                                                                                
           MOVE 'BP13C328'   TO K671-NUM-USERID.                                
           REWRITE BP13K671-REC.                                                
                                                                                
           IF WS-K671-STATUS = ZEROES                                           
              ADD 1          TO WS-PROCESS-CNT                                  
              IF WS-F04A-STAMP-LEGAL-FEE1 >= WS-LEGAL-FEES-REQ AND              
                 WS-F04A-IDP1 >= WS-TOTAL-LUMP-IDP-REQ(WS-CTR)                  
                 MOVE 'AMT SUFFICIENT.'             TO WS-REMARKS               
              ELSE                                                              
                 IF WS-F04A-IDP1 < WS-TOTAL-LUMP-IDP-REQ(WS-CTR) AND            
                    WS-F04A-STAMP-LEGAL-FEE1 < WS-LEGAL-FEES-REQ                
                    MOVE '*LUMPSUM/IDP/SF PD INSUFFICIENT' TO WS-REMARKS        
                 ELSE                                                           
                    IF WS-F04A-STAMP-LEGAL-FEE1 < WS-LEGAL-FEES-REQ             
                       MOVE '*SF PAID INSUFFICIENT' TO WS-REMARKS               
                    ELSE                                                        
                       IF WS-F04A-IDP1 < WS-TOTAL-LUMP-IDP-REQ(WS-CTR)          
                          MOVE '*LUMPSUM/IDP PD INSUFFICIENT'                   
                               TO WS-REMARKS                                    
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              DISPLAY 'ERROR REWRITING BP13K671, STATUS : '                     
                       WS-K671-STATUS                                           
              PERFORM 9000-CLOSING-ROUTINE THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
       5900-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       6000-PRINT-RECORD.                                                       
      *------------------------------------------------------------*            
                                                                                
           IF WS-LINE-CTR > 54                                                  
              PERFORM 6100-PRINT-HDG THRU 6100-EXIT                             
           END-IF.                                                              
                                                                                
           PERFORM 6200-PRINT-DETAIL THRU 6200-EXIT.                            
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       6100-PRINT-HDG.                                                          
      *------------------------------------------------------------*            
                                                                                
           MOVE FUNCTION CURRENT-DATE TO WS-DATE.                               
           STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)                
              DELIMITED BY SIZE INTO L328-DATE.                                 
                                                                                
           ADD   1            TO    WS-PAGE-CTR.                                
           MOVE  WS-PAGE-CTR  TO    L328-PAGE.                                  
           WRITE BP13L328-REC FROM L328-HEADER1 AFTER PAGE.                     
           WRITE BP13L328-REC FROM L328-HEADER2 AFTER 2.                        
           WRITE BP13L328-REC FROM L328-HEADER3 AFTER 2.                        
           WRITE BP13L328-REC FROM L328-HEADER4 AFTER 1.                        
           MOVE  6            TO    WS-LINE-CTR.                                
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       6200-PRINT-DETAIL.                                                       
      *------------------------------------------------------------*            
                                                                                
           MOVE SPACES                   TO   L328-NUM-REGN                     
                                              L328-NUM-SCH-ACCT                 
                                              L328-NUM-VALUE-DATE.              
                                                                                
           MOVE ZEROES                   TO   L328-AMT-IDP-PD                   
                                              L328-AMT-IDP-REQ                  
                                              L328-AMT-STAMP-FEE-PD             
                                              L328-AMT-STAMP-FEE-REQ.           
                                                                                
           MOVE WS-NUM-REGN              TO   L328-NUM-REGN.                    
                                                                                
           ADD 1                         TO   WS-PRINT-CNT.                     
           MOVE WS-PRINT-CNT             TO   L328-SNO.                         
                                                                                
           MOVE WS-NUM-CPF               TO   L328-NUM-CPF.                     
                                                                                
           STRING WS-SCH-ACCT(1:4) '-'                                          
                  WS-SCH-ACCT(5:4) '-'                                          
                  WS-SCH-ACCT(9:1) '-'                                          
                  WS-SCH-ACCT(10:2)                                             
                  DELIMITED BY SIZE      INTO L328-NUM-SCH-ACCT.                
                                                                                
           MOVE WS-PRINT-IDP-PD          TO   L328-AMT-IDP-PD.                  
           MOVE WS-PRINT-IDP-REQ         TO   L328-AMT-IDP-REQ.                 
           MOVE WS-PRINT-TOTAL-FEE       TO   L328-AMT-STAMP-FEE-PD.            
           MOVE WS-LEGAL-FEES-REQ        TO   L328-AMT-STAMP-FEE-REQ.           
                                                                                
           STRING WS-NUM-VALUE-DATE(7:2) '/'                                    
                  WS-NUM-VALUE-DATE(5:2) '/'                                    
                  WS-NUM-VALUE-DATE(1:4)                                        
                  DELIMITED BY SIZE INTO   L328-NUM-VALUE-DATE.                 
                                                                                
           MOVE WS-REMARKS               TO   L328-REMARKS.                     
                                                                                
           WRITE BP13L328-REC FROM L328-DETAIL AFTER 1.                         
           MOVE SPACES                   TO L328-DETAIL.                        
           WRITE BP13L328-REC FROM L328-DETAIL AFTER 1.                         
           ADD 2                         TO   WS-LINE-CTR.                      
                                                                                
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
      *   AMOUNT         PAYMENT TYPE                             *            
      *------------------------------------------------------------*            
      *1. SOC           - SAP                                                   
      *2. LUMPSUM       - LSM                                                   
      *3. LSE STMP      - LSP                                                   
      *3. SALE CONVY    - SCN                                                   
      *5. MORT CONVY    - MCN                                                   
      *6. SRVY FEE      - SRF                                                   
      *7. LSE ESCR      - LES                                                   
      *8. LSE REGN      - LRG                                                   
      *9. CAVT REGN     - CRG                                                   
      *10.SOLICIT       - SLP                                                   
      *11.FRESH CAVEAT  - FCV                                                   
      *12.SUBTRAN SF    - SSF                                                   
      *13.SUBTRAN CF    - SCF                                                   
      *14.BUYERS WCV    - BYW                                                   
      *15.BANKS WCV     - BNW                                                   
      *------------------------------------------------------------*            
                                                                                
      *------------------------------------------------------------*            
       6500-CHECK-CPF1.                                                         
      *------------------------------------------------------------*            
                                                                                
           IF (K671-DTE-VALUE-CPF1 NOT = SPACES AND LOW-VALUES                  
                                               AND ALL '0')                     
              MOVE K671-DTE-VALUE-CPF1 TO WS-DTE-CPF                            
           ELSE                                                                 
              MOVE WS-SYSTEM-DATE      TO WS-DTE-CPF                            
           END-IF.                                                              
                                                                                
           MOVE K671-NUM-CPF1-NO       TO WS-NRIC.                              
           MOVE 1                      TO WS-CDE-APPLT-CPF                      
                                          WS-POS.                               
           PERFORM 6700-CHECK-FOR-F121 THRU 6700-EXIT.                          
                                                                                
       6500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       6550-CHECK-CPF2.                                                         
      *------------------------------------------------------------*            
                                                                                
           IF (K671-DTE-VALUE-CPF2 NOT = SPACES AND LOW-VALUES                  
                                               AND ALL '0')                     
              MOVE K671-DTE-VALUE-CPF2 TO WS-DTE-CPF                            
           ELSE                                                                 
              MOVE WS-SYSTEM-DATE      TO WS-DTE-CPF                            
           END-IF.                                                              
                                                                                
           MOVE K671-NUM-CPF2-NO       TO WS-NRIC.                              
           MOVE 2                      TO WS-CDE-APPLT-CPF                      
                                          WS-POS.                               
           PERFORM 6700-CHECK-FOR-F121 THRU 6700-EXIT.                          
                                                                                
       6550-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       6600-CHECK-CPF3.                                                         
      *------------------------------------------------------------*            
                                                                                
           IF (K671-DTE-VALUE-CPF3 NOT = SPACES AND LOW-VALUES                  
                                               AND ALL '0')                     
              MOVE K671-DTE-VALUE-CPF3 TO WS-DTE-CPF                            
           ELSE                                                                 
              MOVE WS-SYSTEM-DATE      TO WS-DTE-CPF                            
           END-IF.                                                              
                                                                                
           MOVE K671-NUM-CPF3-NO       TO WS-NRIC.                              
           MOVE 3                      TO WS-CDE-APPLT-CPF                      
                                          WS-POS.                               
           PERFORM 6700-CHECK-FOR-F121 THRU 6700-EXIT.                          
                                                                                
       6600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       6650-CHECK-CPF4.                                                         
      *------------------------------------------------------------*            
                                                                                
           IF (K671-DTE-VALUE-CPF4 NOT = SPACES AND LOW-VALUES                  
                                               AND ALL '0')                     
              MOVE K671-DTE-VALUE-CPF4 TO WS-DTE-CPF                            
           ELSE                                                                 
              MOVE WS-SYSTEM-DATE      TO WS-DTE-CPF                            
           END-IF.                                                              
                                                                                
           MOVE K671-NUM-CPF4-NO       TO WS-NRIC.                              
           MOVE 4                      TO WS-CDE-APPLT-CPF                      
                                          WS-POS.                               
           PERFORM 6700-CHECK-FOR-F121 THRU 6700-EXIT.                          
                                                                                
       6650-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       6700-CHECK-FOR-F121.                                                     
      *------------------------------------------------------------*            
                                                                                
           IF WS-IDP-PD(WS-POS) > 0                                             
              MOVE 'SAP'                         TO WS-PAY-TYPE                 
              MOVE WS-IDP-PD(WS-POS)             TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF WS-LUMPSUM-PD(WS-POS) > 0                                         
              MOVE 'LSM'                         TO WS-PAY-TYPE                 
              MOVE WS-LUMPSUM-PD(WS-POS)         TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF WS-LEASE-SF-PD(WS-POS) > 0                                        
              MOVE 'LSP'                         TO WS-PAY-TYPE                 
              MOVE WS-LEASE-SF-PD(WS-POS)        TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF WS-SALE-CF-PD(WS-POS) > 0                                         
              MOVE 'SCN'                         TO WS-PAY-TYPE                 
              MOVE WS-SALE-CF-PD(WS-POS)         TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF WS-MORT-CF-PD(WS-POS) > 0                                         
              MOVE 'MCN'                         TO WS-PAY-TYPE                 
              MOVE WS-MORT-CF-PD(WS-POS)         TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF WS-SRVY-FEE-PD(WS-POS) > 0                                        
              MOVE 'SRF'                         TO WS-PAY-TYPE                 
              MOVE WS-SRVY-FEE-PD(WS-POS)        TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF WS-LSE-ESCR-PD(WS-POS) > 0                                        
              MOVE 'LES'                         TO WS-PAY-TYPE                 
              MOVE WS-LSE-ESCR-PD(WS-POS)        TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF WS-LSE-REGN-PD(WS-POS) > 0                                        
              MOVE 'LRG'                         TO WS-PAY-TYPE                 
              MOVE WS-LSE-REGN-PD(WS-POS)        TO WS-AMOUNT                   
              PERFORM 6900-WRITE-F121            THRU 6900-EXIT                 
           END-IF.                                                              
                                                                                
           IF WS-CAVEAT-PD(WS-POS) > 0                                          
              MOVE 'CRG'                          TO WS-PAY-TYPE                
              MOVE WS-CAVEAT-PD(WS-POS)           TO WS-AMOUNT                  
              PERFORM 6900-WRITE-F121             THRU 6900-EXIT                
           END-IF.                                                              
                                                                                
           IF WS-SOLICIT-PD(WS-POS) > 0                                         
              MOVE 'SLP'                          TO WS-PAY-TYPE                
              MOVE WS-SOLICIT-PD(WS-POS)          TO WS-AMOUNT                  
              PERFORM 6900-WRITE-F121             THRU 6900-EXIT                
           END-IF.                                                              
                                                                                
           IF WS-FRESH-CV-PD(WS-POS) > 0                                        
              MOVE 'FCV'                          TO WS-PAY-TYPE                
              MOVE WS-FRESH-CV-PD(WS-POS)         TO WS-AMOUNT                  
              PERFORM 6900-WRITE-F121             THRU 6900-EXIT                
           END-IF.                                                              
                                                                                
           IF WS-SUBTR-SF-PD(WS-POS) > 0                                        
              MOVE 'SSF'                          TO WS-PAY-TYPE                
              MOVE WS-SUBTR-SF-PD(WS-POS)         TO WS-AMOUNT                  
              PERFORM 6900-WRITE-F121             THRU 6900-EXIT                
           END-IF.                                                              
                                                                                
           IF WS-SUBTR-CF-PD(WS-POS) > 0                                        
              MOVE 'SCF'                          TO WS-PAY-TYPE                
              MOVE WS-SUBTR-CF-PD(WS-POS)         TO WS-AMOUNT                  
              PERFORM 6900-WRITE-F121             THRU 6900-EXIT                
           END-IF.                                                              
                                                                                
           IF WS-BUYER-WCV-PD(WS-POS) > 0                                       
              MOVE 'BYW'                          TO WS-PAY-TYPE                
              MOVE WS-BUYER-WCV-PD(WS-POS)        TO WS-AMOUNT                  
              PERFORM 6900-WRITE-F121             THRU 6900-EXIT                
           END-IF.                                                              
                                                                                
           IF WS-BANK-WCV-PD(WS-POS) > 0                                        
              MOVE 'BNW'                          TO WS-PAY-TYPE                
              MOVE WS-BANK-WCV-PD(WS-POS)         TO WS-AMOUNT                  
              PERFORM 6900-WRITE-F121             THRU 6900-EXIT                
           END-IF.                                                              
                                                                                
       6700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       6900-WRITE-F121.                                                         
      *------------------------------------------------------------*            
                                                                                
           MOVE SPACES                TO BP13F121-CPFTRAN                       
                                         BP13F120-CASHTRAN.                     
                                                                                
           INITIALIZE                    BP13F121-CPFTRAN                       
                                         BP13F120-CASHTRAN.                     
                                                                                
           MOVE K671-NUM-REGN         TO F121-NUM-REGN.                         
           MOVE WS-DTE-CPF            TO F121-DTE-POST.                         
           MOVE WS-SYSTEM-DATE        TO F121-DTE-TRANS.                        
           MOVE ZEROS                 TO F121-COUNT-HISTORY.                    
           MOVE WS-AMOUNT             TO F121-AMT-RECIEPT.                      
           MOVE K671-NUM-SCH-ACC      TO F121-NUM-SCH-ACCT.                     
           MOVE 'BANKCPF 404151'      TO F121-NUM-RECPT-JRNO.                   
           MOVE '40'                  TO F121-CDE-TRANS-TYPE.                   
           MOVE WS-PAY-TYPE           TO F121-CDE-PAYMENT-TYPE.                 
           MOVE WS-NRIC               TO F121-NUM-NRIC.                         
           MOVE WS-CDE-APPLT-CPF      TO F121-CDE-APPLT-CPF.                    
                                                                                
           IF WS-SYS-MM = WS-CPF-MM                                             
              WRITE BP13F121-CPFTRAN                                            
              ADD 1 TO WS-WRITE-F121                                            
           ELSE                                                                 
              WRITE BP13F120-CASHTRAN FROM BP13F121-CPFTRAN                     
              ADD 1 TO WS-WRITE-F120                                            
           END-IF.                                                              
                                                                                
       6900-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------------------------------------------*            
       9000-CLOSING-ROUTINE.                                                    
      *------------------------------------------------------------*            
                                                                                
           CLOSE BB24F04A                                                       
                 BP13K671                                                       
                 BP13F121                                                       
                 BP13F120                                                       
                 SY02F001                                                       
                 BM06K110                                                       
                 BP13L328.                                                      
                                                                                
           DISPLAY '*-------------- BP13C328 -------------*'.                   
           DISPLAY 'BB24F04A RECORDS READ            : ' WS-READ-CNT.           
           DISPLAY 'BM06K110 RECORDS READ            : ' WS-READ-K110.          
           DISPLAY 'BM06K110 RECORDS NOT FOUND       : '                        
                    WS-NOT-FND-K110.                                            
           DISPLAY 'BP13K671 RECORDS READ            : ' WS-READ-K671.          
           DISPLAY 'BP13K671 RECORDS NOT FOUND       : '                        
                    WS-NOT-FND-K671.                                            
           DISPLAY 'BB24F04A CPF NOT MATCHING K671   :'                         
                    WS-NOT-MTCH-K671.                                           
           DISPLAY 'BP13K671 RECORDS UPDATED         : ' WS-PROCESS-CNT.        
           DISPLAY 'BP13F120 RECORDS WRITE           : ' WS-WRITE-F120.         
           DISPLAY 'BP13F121 RECORDS WRITE           : ' WS-WRITE-F121.         
           DISPLAY 'BP13L328 RECORDS PRINTED         : ' WS-PRINT-CNT.          
           DISPLAY '*---------------------------------------'.                  
                                                                                
           EVALUATE WS-K110-STATUS                                              
              WHEN 00                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 DISPLAY 'CLOSE BP13K110 FAIL. STATUS-'                         
                                         WS-K110-STATUS                         
                 MOVE WS-K110-STATUS  TO RETURN-CODE                            
           END-EVALUATE.                                                        
                                                                                
           EVALUATE WS-K671-STATUS                                              
              WHEN 00                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 DISPLAY 'CLOSE BP13K671 FAIL. STATUS-'                         
                                         WS-K671-STATUS                         
                 MOVE WS-K671-STATUS  TO RETURN-CODE                            
           END-EVALUATE.                                                        
                                                                                
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
