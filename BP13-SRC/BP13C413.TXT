      *------------------------*                                                
       IDENTIFICATION DIVISION.                                                 
      *------------------------*                                                
       PROGRAM-ID.    BP13C413.                                                 
      *AUTHOR.        TMK.                                                      
      *DATE-WRITTEN.  11/10/89.                                                 
                                                                                
      ************************************************************              
      *                                                          *              
      *    SYSTEM NAME : SYSTEM OF COMMITMENT                    *              
      *    SYSTEM ID   : BP13                                    *              
      *                                                          *              
      *    OBJECTIVE  :                                          *              
      *        1.  TO PRINT FROM THE FILE BP13F310 ALL THE       *              
      *            APPLICATIONS WHICH HAVE RAISED SALES ORDER    *              
      *            AND ARE READY TO BE SENT TO BRANCH OFFICES.   *              
      *                                                          *              
      *     INPUT FILES:                                         *              
      *           1. BP13F310 (SOC TRANSACTION FILE)             *              
      *           2. BM06K110 (FLAT INVENTORY)                   *              
      *                                                          *              
      *     LISTING:                                             *              
      *           1. P13L413A(FILE SENT TO BO  FOR               *              
      *                       SALES TYPE 01,02, 03 AND 10)       *              
      *           2. P13L413B(SALES ORDER FOR                    *              
      *                       SALES TYPE 01,02, 03 AND 10)       *              
      *                                                          *              
      *                                                          *              
      *C9204F5 LSB 920521 - CHG THE TEXT                         *              
      *SOC-PH8 RML 920521 - EXPAND REGN, NRIC                    *              
      *SOC-PH8 RML 930720 - RETRIEVE ADDRESS FROM BP13F310       *              
      *C9404G4 LJL 940528 - TO AMEND THE 'DUPLICATE' DEED OF     *              
      *                     ASSIGNMENT AND SUPPLEMENTAL          *              
      *                     AGREEMENT TO 'ORIGINAL'.             *              
      *C9404E6 LJL 940614 - TO CATER FOR SALE OF SITTING TENANT  *              
      *                     FLATS (TYPE 2B).                     *              
      *BP130020  SSS 951018  REPOSITION RPT-ID AND PAGE-NO       *              
      *BP130037  EG1 950925 - TO CATER FOR OPTION OF INCLUDING OR*              
      *                       NOT INCLUDING SUPPLEMENTAL AGRM.   *              
      *BP130418  SIA 980804 - CHGE BM06K211 TO BM06K110          *              
      *BP130883  CLT 301000 - REMOVE READING OF BC14K060         *              
      *BP130998  CLT 030501 - CATER FOR SA FLAT SALES TYPE 13    *              
      ************************************************************              
                                                                                
      *------------------------*                                                
       ENVIRONMENT DIVISION.                                                    
      *------------------------*                                                
       CONFIGURATION SECTION.                                                   
      *------------------------*                                                
                                                                                
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
                                                                                
       FILE-CONTROL.                                                            
           SELECT BP13F310   ASSIGN TO BP13F310.                                
           SELECT BM06K110   ASSIGN TO BM06K110                                 
                  ORGANIZATION IS INDEXED                                       
                  ACCESS MODE IS RANDOM                                         
                  RECORD KEY IS K110-KEY-FLD                                    
                  FILE STATUS IS BM06K110-STATUS.                               
           SELECT P13L413A  ASSIGN TO P13L413A.                                 
                                                                                
                                                                                
      *------------------------*                                                
       DATA DIVISION.                                                           
      *------------------------*                                                
       FILE SECTION.                                                            
                                                                                
       FD   BP13F310                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 150 CHARACTERS                                      
            LABEL RECORD IS STANDARD.                                           
       COPY BP13F310.                                                           
                                                                                
       FD   BM06K110                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 500 CHARACTERS                                      
            LABEL RECORD IS STANDARD.                                           
       COPY BM06K110.                                                           
                                                                                
       FD  P13L413A                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED.                                           
       01  L413A-PRINT-REC                 PIC X(132).                          
                                                                                
                                                                                
      *------------------------*                                                
       WORKING-STORAGE SECTION.                                                 
      *------------------------*                                                
                                                                                
       01  FILE-STATUS.                                                         
           03  BM06K110-STATUS     PIC 99           VALUE 0.                    
                                                                                
       01  WS1-DATE-VARIABLES.                                                  
           03  WS1-KEY-ISSUE-DATE.                                              
               05  WS1-KEY-CC      PIC 9(2).                                    
               05  WS1-KEY-YY      PIC 9(2).                                    
               05  WS1-KEY-MM      PIC 9(2).                                    
               05  WS1-KEY-DD      PIC 9(2).                                    
           03  WS1-CURR-CCYYMMDD.                                               
               05  WS1-CURR-CC     PIC 9(2).                                    
               05  WS1-CURR-YY     PIC 9(2).                                    
               05  WS1-CURR-MM     PIC 9(2).                                    
               05  WS1-CURR-DD     PIC 9(2).                                    
           03  WS1-EDITED-DATE.                                                 
               05  WS1-EDIT-DD     PIC 99.                                      
               05  FILLER          PIC X       VALUE '/'.                       
               05  WS1-EDIT-MM     PIC 99.                                      
               05  FILLER          PIC X       VALUE '/'.                       
               05  WS1-EDIT-CC     PIC 99.                                      
               05  WS1-EDIT-YY     PIC 99.                                      
                                                                                
      * COUNTERS ****                                                           
       01  WS2-REPORT-VARIABLES.                                                
           03  WS2-NUM-VARIABLES.                                               
               05  WS2-NUM-STYPE-01    PIC 9(4)          VALUE 0.               
               05  WS2-NUM-STYPE-02    PIC 9(4)          VALUE 0.               
               05  WS2-NUM-STYPE-03    PIC 9(4)          VALUE 0.               
               05  WS2-NUM-STYPE-3A    PIC 9(4)          VALUE 0.               
               05  WS2-NUM-STYPE-5B    PIC 9(4)          VALUE 0.               
               05  WS2-NUM-STYPE-5C    PIC 9(4)          VALUE 0.               
               05  WS2-NUM-STYPE-10    PIC 9(4)          VALUE 0.               
               05  WS2-NUM-STYPE-13    PIC 9(4)          VALUE 0.               
                                                                                
      * COUNTERS FOR REPORT (FILE SENT)  *                                      
               05  WS2-CNT-PAGE-FS     PIC 9(5)  COMP-3  VALUE 0.               
               05  WS2-SERIAL-NO-FS    PIC 9(3)  COMP-3  VALUE 0.               
               05  WS2-CNT-LINES-FS    PIC 9(3)  COMP-3  VALUE 0.               
                                                                                
      * COUNTERS FOR REPORT (SALES ORDER) *                                     
               05  WS2-CNT-PAGE-SO     PIC 9(5)  COMP-3  VALUE 0.               
               05  WS2-SERIAL-NO-SO    PIC 9(3)  COMP-3  VALUE 0.               
               05  WS2-CNT-LINES-SO    PIC 9(3)  COMP-3  VALUE 0.               
               05  WS2-CNT-SET-SO      PIC 9(3)  COMP-3  VALUE 0.               
               05  WS2-CNT-REC-ACK     PIC 9(4)  COMP-3  VALUE 0.               
                                                                                
       01  WS3-COUNTERS.                                                        
           03  WS3-CNT-F310-READ   PIC  9(5)  VALUE  0.                         
                                                                                
       01  WS4-SWITCHES-INDICATORS.                                             
           03  WS4-EOF-IND            PIC X(01)   VALUE 'N'.                    
               88  WS4-EOF            VALUE 'Y'.                                
                                                                                
           03  WS4-CALLED-FROM-IND    PIC X(02)  VALUE SPACES.                  
               88  WS4-CALLED-FROM-FS VALUE 'FS'.                               
                                                                                
           03  WS4-CHANGE-BO-IND      PIC X(01)  VALUE SPACES.                  
               88  WS4-CHANGE-BO      VALUE 'Y'.                                
                                                                                
      ** TO INDICATE THAT A PARTICULAR SALES TYPE WAS READ/PRINTED **           
           03  WS4-READ-STYPE-01-IND  PIC X      VALUE SPACE.                   
               88  WS4-READ-STYPE-01  VALUE 'Y'.                                
                                                                                
           03  WS4-READ-STYPE-02-IND  PIC X      VALUE SPACE.                   
               88  WS4-READ-STYPE-02  VALUE 'Y'.                                
                                                                                
           03  WS4-READ-STYPE-03-IND  PIC X      VALUE SPACE.                   
               88  WS4-READ-STYPE-03  VALUE 'Y'.                                
                                                                                
           03  WS4-READ-STYPE-3A-IND  PIC X      VALUE SPACE.                   
               88  WS4-READ-STYPE-3A  VALUE 'Y'.                                
                                                                                
           03  WS4-READ-STYPE-5B-IND  PIC X      VALUE SPACE.                   
               88  WS4-READ-STYPE-5B  VALUE 'Y'.                                
                                                                                
           03  WS4-READ-STYPE-5C-IND  PIC X      VALUE SPACE.                   
               88  WS4-READ-STYPE-5C  VALUE 'Y'.                                
                                                                                
           03  WS4-READ-STYPE-10-IND  PIC X      VALUE SPACE.                   
               88  WS4-READ-STYPE-10  VALUE 'Y'.                                
                                                                                
           03  WS4-READ-STYPE-13-IND  PIC X      VALUE SPACE.                   
               88  WS4-READ-STYPE-13  VALUE 'Y'.                                
                                                                                
           03  WS4-PRTED-ACK-IND      PIC X      VALUE SPACE.                   
                                                                                
       01  WS5-DEFAULT-VALUES.                                                  
           03  WS5-MAX-LINE-FS   PIC 9(2)   VALUE 21.                           
           03  WS5-MAX-LINE-SO   PIC 9(2)   VALUE 50.                           
                                                                                
      **** DEFAULT HEADINGS FOR THE VARIOUS LISTINGS *****                      
           03  WS5-HD2B-DESC-FS   PIC X(50)   VALUE                             
               'LIST  OF  FILES  SENT  TO  BRANCH OFFICE'.                      
                                                                                
           03  WS5-ACK-TEXT-1  PIC X(37)   VALUE                                
               '        ACKNOWLEDGED BY _____________'.                         
           03  WS5-ACK-TEXT-2  PIC X(54)   VALUE                                
               '        NAME OF RECIPIENT : __________________________'.        
                                                                                
                                                                                
       01  WS6-MSIC.                                                            
           03  WS6-SCH-ACC.                                                     
               05  WS6-SCH         PIC X(04).                                   
               05  WS6-ACC         PIC X(05).                                   
               05  WS6-ACC-TYPE    PIC X(02).                                   
           03  WS6-TEMP            PIC 9(3)   VALUE 0.                          
                                                                                
      * VARIABLES FOR CHECKING CONTROL IN PAGE BREAK *                          
           03  WS6-PREV-BO         PIC X(02) VALUE SPACES.                      
           03  WS6-PREV-SCHD-NO    PIC X(10) VALUE SPACES.                      
           03  WS6-PREV-BLK-NO     PIC X(05) VALUE SPACES.                      
           03  WS6-PREV-SALES-TYPE PIC X(02) VALUE SPACES.                      
           03  WS6-PREV-CDE-PREM   PIC X(01) VALUE SPACES.                      
                                                                                
      *---------------------------------------------------------------*         
      *                                                               *         
      *        C O M M O N      L A Y - O U T  (HEADINGS) FOR :       *         
      *          LIST OF FILES SENT TO BRANCH OFFICE                  *         
      *    &     LIST OF SALES ORDERS SENT TO BRANCH OFFICE           *         
      *                                                               *         
      *---------------------------------------------------------------*         
                                                                                
       01  L413-HDG-1.                                                          
           03  FILLER             PIC X(08)   VALUE 'BP13L413'.                 
           03  FILLER             PIC X(37)   VALUE SPACES.                     
           03  FILLER             PIC X(39)   VALUE                             
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           03  FILLER             PIC X(16)   VALUE SPACES.                     
           03  FILLER             PIC X(09)   VALUE SPACES.                     
                                                                                
       01  L413-HDG-2A.                                                         
           03  FILLER             PIC X(55)   VALUE SPACES.                     
           03  FILLER             PIC X(30)   VALUE                             
              'AGREEMENT TEAM (SALES)'.                                         
                                                                                
       01  L413-HDG-2B.                                                         
           03  FILLER             PIC X(2)    VALUE SPACES.                     
           03  FILLER             PIC X(7)    VALUE 'PAGE : '.                  
           03  L413-HD2B-PAGE-NO  PIC ZZZZ9.                                    
           03  FILLER             PIC X(30)   VALUE SPACES.                     
           03  L413-HD2B-DESC     PIC X(50)   VALUE SPACES.                     
           03  FILLER             PIC X(09)   VALUE SPACES.                     
           03  FILLER             PIC X(10)   VALUE 'DATE    : '.               
           03  L413-HD2B-DATE     PIC X(10).                                    
           03  FILLER             PIC X(09)   VALUE SPACES.                     
                                                                                
       01  L413-HDG-3.                                                          
           03  FILLER             PIC X(33)   VALUE SPACES.                     
           03  FILLER             PIC X(57)   VALUE                             
           'SALES ORDER RAISED FOR ADV. ALLOCATION FLAT - SALES TYPE '.         
           03  L413-HD3-SALES-TYPE PIC X(02)  VALUE SPACES.                     
           03  FILLER             PIC X(10)   VALUE SPACES.                     
                                                                                
       01  L413-HDG-3A.                                                         
           03  FILLER             PIC X(40)   VALUE SPACES.                     
           03  FILLER             PIC X(57)   VALUE                             
           'SALES ORDER RAISED FOR SOC FLAT - SALES TYPE 10'.                   
           03  FILLER             PIC X(12)   VALUE SPACES.                     
                                                                                
       01  L413-HDG-4.                                                          
           03  FILLER             PIC X(3)    VALUE SPACES.                     
           03  FILLER             PIC X(05)   VALUE                             
               'BO : '.                                                         
           03  L413-HD4-BO        PIC X(40).                                    
           03  FILLER             PIC X(1)    VALUE SPACES.                     
           03  FILLER             PIC X(14)   VALUE                             
               'SCHEDULE-NO : '.                                                
           03  L413-HD4-SCHD-NO PIC X(10).                                      
           03  FILLER             PIC X(58)   VALUE SPACES.                     
                                                                                
      *---------------------------------------------------------------*         
      *                                                               *         
      *          REPORT LAY-OUT   FOR                                 *         
      *          LISTING OF FILES SENT TO AREA OFFICE                 *         
      *                                                               *         
      *---------------------------------------------------------------*         
                                                                                
       01  L413-FS-HDG-5.                                                       
           03  FILLER          PIC X.                                           
           03  FILLER          PIC X(20)   VALUE                                
               'SER NO   SCH-ACCT-NO'.                                          
           03  FILLER          PIC X(4)    VALUE SPACES.                        
           03  FILLER          PIC X(50)   VALUE                                
               'BLOCK UNIT-NO     STREET-NAME  '.                               
           03  FILLER          PIC X(32) VALUE                                  
               'REGN-NO   KEY-ISSUE DATE'.                                      
                                                                                
       01  L413-FS-HDG-7.                                                       
           03  FILLER          PIC X(52)   VALUE SPACES.                        
           03  FILLER          PIC X(16)   VALUE                                
               'CONTROL LIST FOR'.                                              
           03  FILLER          PIC X(64)   VALUE SPACES.                        
                                                                                
      **** DETAIL LINE FOR REPORT FORMAT (LIST OF FILES SENT) ****              
       01  L413-FS-DETAIL-1.                                                    
           03  FILLER                PIC XX      VALUE SPACE.                   
           03  L413-FS-SERIAL-NO     PIC ZZ9.                                   
           03  FILLER                PIC X(3)    VALUE SPACE.                   
           03  L413-FS-SCHEME        PIC 9(4).                                  
           03  FILLER                PIC X       VALUE '-'.                     
           03  L413-FS-ACC           PIC 9(5).                                  
           03  FILLER                PIC X       VALUE '-'.                     
           03  L413-FS-ACC-TYPE      PIC 99.                                    
           03  FILLER                PIC XX      VALUE SPACE.                   
           03  L413-FS-BLK-NO        PIC X(5)    VALUE SPACE.                   
           03  FILLER                PIC XX      VALUE SPACE.                   
           03  L413-FS-LEVEL-NO      PIC X(2).                                  
           03  FILLER                PIC X       VALUE '-'.                     
           03  L413-FS-MAIN-UNIT     PIC X(5).                                  
           03  FILLER                PIC XX      VALUE SPACE.                   
           03  L413-FS-ST-NAME       PIC X(30).                                 
           03  FILLER                PIC X(4)    VALUE SPACE.                   
           03  L413-FS-CUR-REGN-NO   PIC X(8).                                  
           03  FILLER                PIC X(5)  VALUE SPACE.                     
           03  L413-FS-KEY-ISSUE-DATE PIC X(10).                                
                                                                                
       01  L413-FS-DETAIL-LINE-2.                                               
           03  FILLER            PIC X(33)      VALUE SPACES.                   
           03  FILLER            PIC X(33)      VALUE                           
               'NO. OF SALES ORDER READ       = '.                              
           03  L413-FS-CNT-READ  PIC ZZ9.                                       
           03  FILLER            PIC X(63)      VALUE SPACES.                   
                                                                                
       01  L413-FS-DETAIL-LINE-3.                                               
           03  FILLER            PIC X(33)      VALUE SPACES.                   
           03  FILLER            PIC X(33)      VALUE                           
               'NO. OF FILES SENT BRANCH OFF  =  '.                             
           03  L413-FS-COUNT     PIC ZZ9.                                       
           03  FILLER            PIC X(66)      VALUE SPACES.                   
                                                                                
                                                                                
      *---------------------------------------------------------------*         
      *       REPORT LAY-OUT FOR ACKNOWLEDGEMENT DETAILS              *         
      *---------------------------------------------------------------*         
       01  L413-SO-DETAIL-2.                                                    
           03  FILLER          PIC X(20)   VALUE SPACES.                        
           03  FILLER          PIC X(16)   VALUE 'TO: SEO/EEO/EO ('.            
           03  L413-SO-BO      PIC X(2)    VALUE SPACES.                        
           03  FILLER          PIC X       VALUE ')'.                           
                                                                                
       01  L413-SO-DETAIL-3.                                                    
           03  FILLER          PIC X(20)   VALUE SPACES.                        
           03  FILLER          PIC X(8)    VALUE '1)'.                          
           03  FILLER          PIC X(17)                                        
               VALUE 'THE ABOVE LISTED '.                                       
           03  L413-SO-SET1    PIC ZZ9     VALUE ZEROES.                        
           03  FILLER          PIC X(39)                                        
               VALUE ' SALES FILES ENCLOSING THE SALES ORDER '.                 
                                                                                
       01  L413-SO-DETAIL-3A.                                                   
           03  FILLER          PIC X(20)   VALUE SPACES.                        
           03  FILLER          PIC X(8)    VALUE '1)'.                          
           03  FILLER          PIC X(17)                                        
               VALUE 'THE ABOVE LISTED '.                                       
           03  L413-SO-SET2    PIC ZZ9     VALUE ZEROES.                        
           03  FILLER          PIC X(37)                                        
               VALUE ' SALES FILES ENCLOSING THE DUPLICATE '.                   
           03  FILLER          PIC X(40)                                        
               VALUE 'AGREEMENT FOR LEASE, THE                '.                
                                                                                
       01  L413-SO-DETAIL-3B.                                                   
           03  FILLER          PIC X(20)   VALUE SPACES.                        
           03  FILLER          PIC X(46)                                        
               VALUE 'SALES ORDER, ORIGINAL  DEED OF ASSIGNMENT AND '.          
           03  FILLER          PIC X(40)                                        
               VALUE 'ORIGINAL  SUPPLEMENTARY AGREEMENT'.                       
                                                                                
       01  L413-SO-DETAIL-3B-WO-SA.                                             
           03  FILLER          PIC X(20)   VALUE SPACES.                        
           03  FILLER          PIC X(46)                                        
               VALUE 'SALES ORDER, AND ORIGINAL  DEED OF ASSIGNMENT '.          
           03  FILLER          PIC X(40)                                        
               VALUE 'ARE FORWARDED FOR YOUR FOLLOW-UP ACTION.'.                
                                                                                
       01  L413-SO-DETAIL-4.                                                    
           03  FILLER          PIC X(20)   VALUE SPACES.                        
           03  FILLER          PIC X(40)                                        
               VALUE 'ARE FORWARDED FOR YOUR FOLLOW-UP ACTION.'.                
                                                                                
       01  L413-SO-DETAIL-5.                                                    
           03  FILLER          PIC X(20)   VALUE SPACES.                        
           03  L413-SO-ACK-TEXT PIC X(54)  VALUE SPACES.                        
                                                                                
       01  L413-SO-DETAIL-6.                                                    
           03  FILLER          PIC X(20)   VALUE SPACES.                        
           03  FILLER          PIC X(21)   VALUE                                
               '        SIGNATURE   :'.                                         
           03  FILLER          PIC X(15)   VALUE ALL '_'.                       
           03  FILLER          PIC X(09)   VALUE '   DATE: '.                   
           03  FILLER          PIC X(18)   VALUE ALL '_'.                       
                                                                                
       01  L413-SO-DETAIL-7.                                                    
           03  FILLER          PIC X(20)   VALUE SPACES.                        
           03  FILLER          PIC X(8)    VALUE '2)'.                          
           03  FILLER          PIC X(37)                                        
               VALUE 'KINDLY ACKNOWLEDGE RECEIPT OF THE'.                       
                                                                                
       01  L413-SO-DETAIL-8.                                                    
           03  FILLER          PIC X(20)   VALUE SPACES.                        
           03  FILLER          PIC X(25)   VALUE                                
           'FILES WITHIN 3 DAYS FROM '.                                         
           03  DATE8           PIC X(8)   VALUE SPACES.                         
           03  FILLER          PIC X(17)   VALUE                                
           ' BY RETURNING THE'.                                                 
                                                                                
       01  L413-SO-DETAIL-9.                                                    
           03  FILLER          PIC X(20)   VALUE SPACES.                        
           03  FILLER          PIC X(50)   VALUE                                
           'DUPLICATE COPY TO SALES UNIT, AGREEMENT TEAM'.                      
      *=======================================================*                 
      *    LINKAGE VARIABLES                                  *                 
      *=======================================================*                 
       01   WS-LINK-REC.                                                        
            05 WS-LINK-NUM-OFFICE         PIC X(8).                             
            05 WS-LINK-NUM-TYPE-OFFICE    PIC X(15).                            
            05 WS-LINK-NUM-SQNC           PIC X(2).                             
                                                                                
       01   WS-SQL-CODE                   PIC 9(4).                             
                                                                                
       COPY P13COMM4.                                                           
                                                                                
                                                                                
      ************************************************************              
       PROCEDURE DIVISION.                                                      
      ************************************************************              
      *============*                                                            
       MAIN SECTION.                                                            
      *============*                                                            
           PERFORM 0010-INITIALIZATION   THRU 0010-EXIT.                        
           PERFORM 0020-PROCESS-INPUT    THRU 0020-EXIT                         
                   UNTIL WS4-EOF.                                               
           PERFORM 0030-FINAL-PRT-ACKNOW THRU 0030-EXIT.                        
           PERFORM 9999-CLOSE-ROUTINE    THRU 9999-EXIT.                        
                                                                                
                                                                                
      *===================*                                                     
       0010-INITIALIZATION.                                                     
      *===================*                                                     
           OPEN INPUT BP13F310  BM06K110                                        
                OUTPUT P13L413A.                                                
                                                                                
           IF BM06K110-STATUS NOT = 0 AND NOT = 97                              
              DISPLAY 'OPENING ERROR, K110-STATUS ' BM06K110-STATUS             
              MOVE BM06K110-STATUS TO RETURN-CODE                               
              PERFORM 9999-CLOSE-ROUTINE.                                       
                                                                                
       0010-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *==================*                                                      
       0020-PROCESS-INPUT.                                                      
      *==================*                                                      
           READ BP13F310 AT END                                                 
                MOVE 'Y' TO WS4-EOF-IND                                         
                GO TO 0020-EXIT.                                                
                                                                                
           IF F310-CDE-TRANS NOT = 'FS'                                         
              GO TO 0020-EXIT.                                                  
                                                                                
           IF F310-CDE-SALES-TYPE = '01' OR '02' OR '03' OR '5B' OR             
                                    '5C' OR '10' OR '2B' OR '3A' OR             
                                    '13'                                        
              NEXT SENTENCE                                                     
           ELSE                                                                 
              GO TO 0020-EXIT.                                                  
                                                                                
      *-------------------------------------------------------*                 
      *  ACCUMULATE NUMBER OF SALES TYPE AND SET INDICATORS   *                 
      *-------------------------------------------------------*                 
           ADD  1      TO  WS3-CNT-F310-READ.                                   
                                                                                
           IF F310-CDE-SALES-TYPE = '01'                                        
              ADD  1   TO WS2-NUM-STYPE-01                                      
              MOVE 'Y' TO WS4-READ-STYPE-01-IND.                                
                                                                                
           IF F310-CDE-SALES-TYPE = '02' OR '2B'                                
              ADD  1   TO WS2-NUM-STYPE-02                                      
              MOVE 'Y' TO WS4-READ-STYPE-02-IND.                                
                                                                                
           IF F310-CDE-SALES-TYPE = '03'                                        
              ADD  1   TO WS2-NUM-STYPE-03                                      
              MOVE 'Y' TO WS4-READ-STYPE-03-IND.                                
                                                                                
           IF F310-CDE-SALES-TYPE = '3A'                                        
              ADD  1   TO WS2-NUM-STYPE-3A                                      
              MOVE 'Y' TO WS4-READ-STYPE-3A-IND.                                
                                                                                
           IF F310-CDE-SALES-TYPE = '5B'                                        
              ADD  1   TO WS2-NUM-STYPE-5B                                      
              MOVE 'Y' TO WS4-READ-STYPE-5B-IND.                                
                                                                                
           IF F310-CDE-SALES-TYPE = '5C'                                        
              ADD  1   TO WS2-NUM-STYPE-5C                                      
              MOVE 'Y' TO WS4-READ-STYPE-5C-IND.                                
                                                                                
           IF F310-CDE-SALES-TYPE = '10'                                        
              ADD  1   TO WS2-NUM-STYPE-10                                      
              MOVE 'Y' TO WS4-READ-STYPE-10-IND.                                
                                                                                
           IF F310-CDE-SALES-TYPE = '13'                                        
              ADD  1   TO WS2-NUM-STYPE-13                                      
              MOVE 'Y' TO WS4-READ-STYPE-13-IND.                                
                                                                                
           PERFORM 0100-PROCESS-RPT  THRU  0100-EXIT.                           
                                                                                
       0020-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *=====================*                                                   
       0030-FINAL-PRT-ACKNOW.                                                   
      *=====================*                                                   
      ***---------------------------------------------------***                 
      *  IF THE LAST RECORD(SALES TYPE) READ BEFORE END OF    *                 
      *      FILE  DOES NOT HAVE ACKNOWLEDGEMENT PRINTED      *                 
      *      -  PRINT ACKNOWLEDGEMENT                         *                 
      ***---------------------------------------------------***                 
            IF WS4-READ-STYPE-01 AND                                            
               WS4-PRTED-ACK-IND = SPACE                                        
                  PERFORM 2100-PRINT-ACKNOW THRU 2100-EXIT                      
            ELSE                                                                
            IF WS4-READ-STYPE-02 AND                                            
               WS4-PRTED-ACK-IND = SPACE                                        
                  PERFORM 2100-PRINT-ACKNOW THRU 2100-EXIT                      
            ELSE                                                                
            IF WS4-READ-STYPE-03 AND                                            
                  WS4-PRTED-ACK-IND = SPACE                                     
                  PERFORM 2100-PRINT-ACKNOW THRU 2100-EXIT                      
            ELSE                                                                
            IF WS4-READ-STYPE-3A AND                                            
                  WS4-PRTED-ACK-IND = SPACE                                     
                  PERFORM 2100-PRINT-ACKNOW THRU 2100-EXIT                      
            ELSE                                                                
            IF WS4-READ-STYPE-5B AND                                            
                  WS4-PRTED-ACK-IND = SPACE                                     
                  PERFORM 2100-PRINT-ACKNOW THRU 2100-EXIT                      
            ELSE                                                                
            IF WS4-READ-STYPE-5C AND                                            
                  WS4-PRTED-ACK-IND = SPACE                                     
                  PERFORM 2100-PRINT-ACKNOW THRU 2100-EXIT                      
            ELSE                                                                
            IF WS4-READ-STYPE-10 AND                                            
                  WS4-PRTED-ACK-IND = SPACE                                     
                  PERFORM 2100-PRINT-ACKNOW THRU 2100-EXIT                      
            ELSE                                                                
            IF WS4-READ-STYPE-13 AND                                            
                  WS4-PRTED-ACK-IND = SPACE                                     
                  PERFORM 2100-PRINT-ACKNOW THRU 2100-EXIT.                     
                                                                                
       0030-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      **************************************************************            
      *    CONTROL ROUTINE FOR PRINTING REPORT WITH 2 FORMATS      *            
      *        FOR EACH SALES TYPE (01, 02, 03 & 10)               *            
      **************************************************************            
      *================*                                                        
       0100-PROCESS-RPT.                                                        
      *================*                                                        
      ***---------------------------------------------------***                 
      *  AT START OF PROGRAM (WS2-CNT-LINE-FS = 0)            *                 
      *  -  PRINT HEADING OF FILE SENT & SALES ORDER          *                 
      *  -  SET VARIABLES FOR CONTROLLING PAGE-THROW          *                 
      ***---------------------------------------------------***                 
           IF WS2-CNT-LINES-FS = 0                                              
              PERFORM 1000-PRT-L413-FS-HEADING THRU 1000-EXIT                   
              MOVE F310-CDE-SALES-TYPE  TO WS6-PREV-SALES-TYPE                  
              MOVE F310-CDE-BO          TO WS6-PREV-BO                          
              MOVE F310-NUM-SCHEDULE    TO WS6-PREV-SCHD-NO                     
              MOVE F310-CDE-PREMIUM     TO WS6-PREV-CDE-PREM                    
           ELSE                                                                 
      ***---------------------------------------------------***                 
      *  CHANGE OF SALES TYPE                                 *                 
      ***---------------------------------------------------***                 
           IF F310-CDE-SALES-TYPE NOT = WS6-PREV-SALES-TYPE                     
              PERFORM 0200-PRINT-ACKNOW-HDG THRU 0200-EXIT                      
           ELSE                                                                 
      ***---------------------------------------------------***                 
      *  CHANGE OF BRANCH OFFICE                              *                 
      ***---------------------------------------------------***                 
           IF F310-CDE-BO  NOT = WS6-PREV-BO                                    
              PERFORM 0200-PRINT-ACKNOW-HDG THRU 0200-EXIT                      
           ELSE                                                                 
      ***---------------------------------------------------***                 
      * CHANGE OF SCHEDULE NO. (PRINT HEADINGS FOR FILE SENT) *                 
      ***---------------------------------------------------***                 
           IF F310-NUM-SCHEDULE  NOT = WS6-PREV-SCHD-NO                         
              PERFORM 0200-PRINT-ACKNOW-HDG THRU 0200-EXIT                      
              MOVE F310-NUM-SCHEDULE TO WS6-PREV-SCHD-NO.                       
                                                                                
      ***---------------------------------------------------***                 
      *       GET ADDRESS FROM BP13F310, THEN PRINT LISTINGS  *                 
      ***---------------------------------------------------***                 
           MOVE  F310-SCH-ACC TO K110-KEY-FLD.                                  
                                                                                
           READ  BM06K110.                                                      
                                                                                
           PERFORM 1200-MOVE-F310-ADDR    THRU 1200-EXIT.                       
           PERFORM 1300-LIST-FILE-SENT    THRU 1300-EXIT.                       
                                                                                
       0100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *********************************************************                 
      *  AT CHANGE OF SALES/BRANCH OFFICE                     *                 
      *  -  PRINT ACKNOWLEDGEMENT FOR PREVIOUS SALES TYPE     *                 
      *  -  PRINT HEADINGS FOR CURRENT SALES TYPE             *                 
      *********************************************************                 
      *=====================*                                                   
       0200-PRINT-ACKNOW-HDG.                                                   
      *=====================*                                                   
              PERFORM 2100-PRINT-ACKNOW    THRU 2100-EXIT.                      
              MOVE    F310-CDE-SALES-TYPE  TO  WS6-PREV-SALES-TYPE.             
              MOVE    F310-CDE-BO          TO  WS6-PREV-BO.                     
              MOVE    F310-NUM-SCHEDULE    TO  WS6-PREV-SCHD-NO.                
              MOVE    F310-CDE-PREMIUM     TO  WS6-PREV-CDE-PREM.               
              MOVE    ZEROES               TO  WS2-SERIAL-NO-FS                 
                                               WS2-SERIAL-NO-SO                 
                                               WS2-CNT-PAGE-FS                  
                                               WS2-CNT-PAGE-SO.                 
              PERFORM 1000-PRT-L413-FS-HEADING THRU 1000-EXIT.                  
                                                                                
       0200-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ****************************************************                      
      *                                                  *                      
      *  PRINT HEADINGS FOR LIST OF FILES SENT           *                      
      *                                                  *                      
      ****************************************************                      
      *========================*                                                
       1000-PRT-L413-FS-HEADING.                                                
      *========================*                                                
           MOVE 'FS'  TO WS4-CALLED-FROM-IND.                                   
           PERFORM 3200-GET-AREA-DESCR THRU 3200-EXIT.                          
                                                                                
           ADD 1      TO WS2-CNT-PAGE-FS.                                       
           MOVE 1     TO WS2-CNT-LINES-FS.                                      
                                                                                
           MOVE WS5-HD2B-DESC-FS    TO L413-HD2B-DESC.                          
           MOVE WS2-CNT-PAGE-FS     TO L413-HD2B-PAGE-NO.                       
           PERFORM 3100-FORMAT-DATE THRU 3100-EXIT.                             
                                                                                
           MOVE F310-NUM-SCHEDULE   TO L413-HD4-SCHD-NO.                        
                                                                                
           MOVE F310-CDE-SALES-TYPE TO L413-HD3-SALES-TYPE.                     
                                                                                
           WRITE L413A-PRINT-REC  FROM  L413-HDG-1 AFTER PAGE.                  
           WRITE L413A-PRINT-REC  FROM  L413-HDG-2A                             
                                  AFTER ADVANCING 2.                            
           WRITE L413A-PRINT-REC  FROM  L413-HDG-2B                             
                                  AFTER ADVANCING 2.                            
                                                                                
           IF F310-CDE-SALES-TYPE = '10'                                        
              WRITE L413A-PRINT-REC FROM L413-HDG-3A AFTER ADVANCING 1          
           ELSE                                                                 
              WRITE L413A-PRINT-REC  FROM  L413-HDG-3                           
                                     AFTER ADVANCING 1.                         
                                                                                
           WRITE L413A-PRINT-REC  FROM  L413-HDG-4                              
                                  AFTER ADVANCING 2.                            
           WRITE L413A-PRINT-REC  FROM  L413-FS-HDG-5                           
                                  AFTER ADVANCING 3.                            
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ****************************************************                      
      *                                                  *                      
      *     RETRIEVE ADDRESS FROM F310 FILE              *                      
      *                                                  *                      
      ****************************************************                      
      *====================*                                                    
       1200-MOVE-F310-ADDR.                                                     
      *====================*                                                    
           IF BM06K110-STATUS = 00                                              
              IF  K110-DTE-KEY-ISSUED = ZEROES OR SPACES OR LOW-VALUES          
                  MOVE SPACES              TO L413-FS-KEY-ISSUE-DATE            
              ELSE                                                              
                 MOVE K110-DTE-KEY-ISSUED  TO WS1-KEY-ISSUE-DATE                
                 MOVE WS1-KEY-DD           TO WS1-EDIT-DD                       
                 MOVE WS1-KEY-MM           TO WS1-EDIT-MM                       
                 MOVE WS1-KEY-CC           TO WS1-EDIT-CC                       
                 MOVE WS1-KEY-YY           TO WS1-EDIT-YY                       
                 MOVE WS1-EDITED-DATE      TO L413-FS-KEY-ISSUE-DATE            
              END-IF                                                            
           ELSE                                                                 
              IF BM06K110-STATUS = 23                                           
                 MOVE SPACES               TO L413-FS-KEY-ISSUE-DATE            
                 DISPLAY 'RECORD NOT FOUND IN K110 ' F310-SCH-ACC               
              ELSE                                                              
                 DISPLAY 'ERROR READING K110, K110-STATUS '                     
                        BM06K110-STATUS                                         
                 MOVE BM06K110-STATUS TO RETURN-CODE                            
                 PERFORM 9999-CLOSE-ROUTINE                                     
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE F310-NUM-LEVEL       TO L413-FS-LEVEL-NO.                       
           MOVE F310-NUM-MAIN        TO L413-FS-MAIN-UNIT.                      
           MOVE F310-NUM-BLK         TO L413-FS-BLK-NO.                         
           MOVE F310-NME-STREET      TO L413-FS-ST-NAME.                        
           MOVE F310-REGN-NO         TO L413-FS-CUR-REGN-NO.                    
                                                                                
       1200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ***********************************************************               
      *                                                         *               
      *   PRINT DETAILS  OF FILES SENT TO AREA OFFICE           *               
      *     FOR SALES TYPE '01','02','03','5B', '5C' & '10'*                    
      *                                                         *               
      ***********************************************************               
      *====================*                                                    
       1300-LIST-FILE-SENT.                                                     
      *====================*                                                    
             ADD 1 TO WS2-SERIAL-NO-FS                                          
                      WS2-CNT-LINES-FS.                                         
                                                                                
             IF WS2-CNT-LINES-FS > WS5-MAX-LINE-FS                              
                PERFORM 0200-PRINT-ACKNOW-HDG THRU 0200-EXIT                    
                MOVE 0     TO WS2-CNT-LINES-FS.                                 
                                                                                
             MOVE WS2-SERIAL-NO-FS TO L413-FS-SERIAL-NO.                        
             MOVE F310-SCH-ACC     TO WS6-SCH-ACC.                              
             MOVE WS6-SCH          TO L413-FS-SCHEME.                           
             MOVE WS6-ACC          TO L413-FS-ACC.                              
             MOVE WS6-ACC-TYPE     TO L413-FS-ACC-TYPE.                         
                                                                                
             WRITE L413A-PRINT-REC FROM L413-FS-DETAIL-1                        
                   AFTER ADVANCING 1.                                           
                                                                                
       1300-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ****************************************************                      
      *  PRINT ACKNOWLEDGEMENT LINE AT END OF EACH PAGE  *                      
      ****************************************************                      
      *==================*                                                      
       2100-PRINT-ACKNOW.                                                       
      *==================*                                                      
           MOVE WS6-PREV-BO            TO L413-SO-BO.                           
                                                                                
           MOVE  SPACES                TO DATE8.                                
           SUBTRACT 1                  FROM WS2-CNT-LINES-FS.                   
           MOVE WS2-CNT-LINES-FS       TO L413-SO-SET1 L413-SO-SET2.            
           MOVE WS6-PREV-BO            TO L413-SO-BO.                           
           MOVE WS5-ACK-TEXT-2         TO L413-SO-ACK-TEXT.                     
           MOVE SPACE                  TO WS4-PRTED-ACK-IND.                    
                                                                                
           WRITE L413A-PRINT-REC FROM L413-SO-DETAIL-2 AFTER 3.                 
                                                                                
           IF WS6-PREV-SALES-TYPE = '10'                                        
              WRITE L413A-PRINT-REC FROM L413-SO-DETAIL-3A AFTER 2              
                                                                                
              IF WS6-PREV-CDE-PREM = 'Y'                                        
                 WRITE L413A-PRINT-REC FROM L413-SO-DETAIL-3B AFTER 1           
                 WRITE L413A-PRINT-REC FROM L413-SO-DETAIL-4  AFTER 1           
              ELSE                                                              
                 WRITE L413A-PRINT-REC FROM L413-SO-DETAIL-3B-WO-SA             
                       AFTER 1                                                  
              END-IF                                                            
           ELSE                                                                 
              WRITE L413A-PRINT-REC FROM L413-SO-DETAIL-3A AFTER 2              
              WRITE L413A-PRINT-REC FROM L413-SO-DETAIL-3B-WO-SA                
                        AFTER 1.                                                
                                                                                
           WRITE L413A-PRINT-REC FROM L413-SO-DETAIL-7 AFTER 2.                 
           WRITE L413A-PRINT-REC FROM L413-SO-DETAIL-8 AFTER 1.                 
           WRITE L413A-PRINT-REC FROM L413-SO-DETAIL-9 AFTER 1.                 
           WRITE L413A-PRINT-REC FROM L413-SO-DETAIL-5 AFTER 2.                 
           WRITE L413A-PRINT-REC FROM L413-SO-DETAIL-6 AFTER 2.                 
           MOVE SPACES TO L413A-PRINT-REC.                                      
           WRITE          L413A-PRINT-REC.                                      
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ***********************************************************               
      *   COMMON FUNCTIONS CALLED BY THE ABOVE ROUTINES.        *               
      ***********************************************************               
      *=================*                                                       
       3100-FORMAT-DATE.                                                        
      *=================*                                                       
            MOVE FUNCTION CURRENT-DATE   TO  WS1-CURR-CCYYMMDD.                 
                                                                                
            MOVE   WS1-CURR-DD          TO WS1-EDIT-DD.                         
            MOVE   WS1-CURR-MM          TO WS1-EDIT-MM.                         
            MOVE   WS1-CURR-YY          TO WS1-EDIT-YY.                         
            MOVE   WS1-CURR-CC          TO WS1-EDIT-CC.                         
            MOVE   WS1-EDITED-DATE      TO L413-HD2B-DATE.                      
                                                                                
       3100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *====================*                                                    
       3200-GET-AREA-DESCR.                                                     
      *====================*                                                    
           MOVE SPACES       TO BP13COMM4-REC.                                  
           INITIALIZE           BP13COMM4-REC.                                  
                                                                                
           MOVE F310-CDE-BO  TO WS-LINK-NUM-OFFICE.                             
           MOVE 'BO'         TO WS-LINK-NUM-TYPE-OFFICE.                        
           MOVE '00'         TO WS-LINK-NUM-SQNC.                               
                                                                                
           CALL 'BP13C902' USING                                                
                 WS-LINK-REC, BP13COMM4-REC                                     
           END-CALL.                                                            
                                                                                
           IF COMM4-CDE-SYSERR NOT = 0                                          
              MOVE COMM4-CDE-SYSERR TO WS-SQL-CODE                              
              MOVE SPACES           TO L413-HD4-BO                              
              IF COMM4-CDE-SYSERR = 100                                         
                 DISPLAY 'OFFICE NOT FND = ' WS-LINK-REC                        
                 DISPLAY 'SQL ERROR CODE = ' WS-SQL-CODE                        
              ELSE                                                              
                 DISPLAY 'ERROR IN READING OFFICE TABLE' WS-SQL-CODE            
              END-IF                                                            
           ELSE                                                                 
              MOVE COMM4-NME-OFFICE-BO(1) TO L413-HD4-BO                        
           END-IF.                                                              
                                                                                
       3200-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *==================*                                                      
       9999-CLOSE-ROUTINE.                                                      
      *==================*                                                      
            DISPLAY ' *-----------------'.                                      
            DISPLAY ' **   BP13C413   **'.                                      
            DISPLAY ' *-----------------'.                                      
            DISPLAY ' NO. OF RECORDS READ FROM (BP13F310) : '                   
                    WS3-CNT-F310-READ.                                          
            DISPLAY ' NO. OF SALES TYPE 01 PRINTED        : '                   
                    WS2-NUM-STYPE-01.                                           
            DISPLAY ' NO. OF SALES TYPE 02 PRINTED        : '                   
                    WS2-NUM-STYPE-02.                                           
            DISPLAY ' NO. OF SALES TYPE 03 PRINTED        : '                   
                    WS2-NUM-STYPE-03.                                           
            DISPLAY ' NO. OF SALES TYPE 3A PRINTED        : '                   
                    WS2-NUM-STYPE-3A.                                           
            DISPLAY ' NO. OF SALES TYPE 5B PRINTED        : '                   
                    WS2-NUM-STYPE-5B.                                           
            DISPLAY ' NO. OF SALES TYPE 5C PRINTED        : '                   
                    WS2-NUM-STYPE-5C.                                           
            DISPLAY ' NO. OF SALES TYPE 10 PRINTED        : '                   
                    WS2-NUM-STYPE-10.                                           
            DISPLAY ' NO. OF SALES TYPE 13 PRINTED        : '                   
                    WS2-NUM-STYPE-13.                                           
                                                                                
            CLOSE BP13F310  BM06K110                                            
                  P13L413A.                                                     
                                                                                
            IF BM06K110-STATUS NOT = 0                                          
               DISPLAY ' CLOSING ERROR, K110-STATUS ' BM06K110-STATUS.          
                                                                                
            STOP RUN.                                                           
                                                                                
       9999-EXIT.                                                               
            EXIT.                                                               
