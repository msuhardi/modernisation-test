       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CF98.                                                 
      *AUTHOR.        ZARITA DANE SARMIENTO.                                    
      *DATE-WRITTEN.  30/10/2013.                                               
      * ========================================================== *            
      * SYSTEM OF COMMITMENT (BP13)                                *            
      * ========================================================== *            
      *  OBJECTIVE :                                               *            
      *                                                            *            
      *    INFORM CSM WITH THE APPROVED AND REJECTED VOUCHER       *            
      *                                                            *            
      *  INPUT     :  1. BP13F633                                  *            
      *               2. SY02F001                                  *            
      *  OUTPUT    :  1. BP13MAIL                                  *            
      *                                                            *            
      * ---------------------------------------------------------- *            
      * CHG REF  DATE     BY    DESCRIPTION                        *            
      * -------- -------- ----- -----------                        *            
      * BP135031 20131030 ZDD1  NEW PROGRAM                        *            
      * BP135210 20130325 PCL4  ADD NEW FIELDS SUBMISSION STATUS/DATE           
      * BP135537 20150410 RJB1  CHANGE THE EMAIL RECIPIENT FROM    *            
      *                         NICKNAME INTO COMPLETE NAME        *            
      * BP136040 20160303 ZDD1  CHANGE THE EMAIL RECIPIENT FROM    *            
      *                         SHELLEN TO SIA                     *            
      * BP136148 20160421 MRN1  CATER FOR DIFFERENT SUBJ WHEN ASG  *            
      * BP136964 20170817 MRN1  REMOVE SURYANTI SULIME NAME        *            
      *                         AND REPLACE WITH SOH KIM KEE       *            
      * BP137562 20181031 PP11  SENDING EXCEPTION REPORT FOR       *            
      *                         APPORVED CASE WHEN SUBMISSION      *            
      *                         STATUS NON ACC                     *            
      * BP137976 20190909 PP11  ADDED TWO NEW RECIPIENT FOR NON    *            
      *                         ACC CASES                          *            
      * BP138026 20191106 PP11  ADDED TWO NEW RECIPIENT FOR NON    *            
      *                         ACC CASES & MODIFIED ONE RECIPIENT *            
      *                         ACC CASES                          *            
      * BP138101 20191203 PP11  CHANGED THE RECIPIENT FOR NON ACC  *            
      *                                                            *            
      * BP138100 20200409 PP11  INCLUDED THE RECIPIENT FOR ACC     *            
      *                                                            *            
      * BP138572 20210121 PP11  CHANGED THE RECIPIENT FOR NON ACC  *            
      *                                                            *            
      * BP138733 20210107 PP11  REMOVED THE RECIPIENT FOR NON ACC  *            
      *                                                            *            
      * BP138852 20211028 PP11  INCLUDED THE RECIPIENT FOR NON ACC *            
      *                         SOH KIM KEE                        *            
      *                                                            *            
      * BP139572 20230509 PP11  INCLUDED THE RECIPIENT FOR ACC AND *            
      *                         REMOVED SOH KIM, SIA PEI.                       
      * BP139640 20230718 MRR5  FOR RECIPIENTS OF NON ACC:         *            
      *                         REMOVED MAZLINA AND BEE FONG       *            
      *                         REPLACED WITH FRANCIS WM CHEE AND  *            
      *                         CHIN CHAINN HUEY                   *            
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
      *-------------------------------------------------------------            
           SELECT BP13F633 ASSIGN       TO BP13F633.                            
                                                                                
           SELECT BP13MAIL ASSIGN       TO BP13MAIL.                            
           SELECT SY02F001 ASSIGN       TO SY02F001.                            
                                                                                
           SELECT BP13K800 ASSIGN TO BP13K800                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K800-NUM-REGN                              
                  FILE STATUS     IS BP13K800-STATUS.                           
                                                                                
           SELECT BP13KB00 ASSIGN TO BP13KB00                                   
                  ACCESS MODE     IS RANDOM                                     
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS KB00-NUM-REGN                              
                  FILE STATUS     IS BP13KB00-STATUS.                           
                                                                                
           SELECT BP13EACC ASSIGN       TO BP13EACC.                            
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       FD   BP13F633                                                            
            RECORDING MODE IS F                                                 
            RECORD CONTAINS 450 CHARACTERS.                                     
       COPY BP13F633.                                                           
                                                                                
       FD  BP13MAIL                                                             
           RECORD CONTAINS 80 CHARACTERS                                        
           RECORDING  MODE  IS F.                                               
       01  MAIL-PRTREC                       PIC X(80).                         
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13KB00                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13KB00.                                                           
                                                                                
       FD  BP13EACC                                                             
           RECORD CONTAINS 80 CHARACTERS                                        
           RECORDING  MODE  IS F.                                               
       01  MAIL-EACCREC                       PIC X(80).                        
                                                                                
       COPY SY02F001.                                                           
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
                                                                                
       01  WS-VARIABLES.                                                        
           05  CNT-F633-READ        PIC 9(05)  VALUE ZEROES.                    
           05  CNT-201307           PIC 9(05)  VALUE ZEROES.                    
           05  CNT-APVL-VR          PIC 9(05)  VALUE ZEROES.                    
           05  CNT-APVL-NACC        PIC 9(05)  VALUE ZEROES.                    
           05  CNT-APVL-ACC         PIC 9(05)  VALUE ZEROES.                    
           05  CNT-APVL-VRACC       PIC 9(05)  VALUE ZEROES.                    
           05  WS-NUM-OIC           PIC X(05)  VALUE ZEROES.                    
           05  BP13K800-STATUS      PIC X(02)  VALUE ZEROES.                    
           05  BP13KB00-STATUS      PIC X(02)  VALUE ZEROES.                    
           05  WS-F633-EOF          PIC X(01)  VALUE SPACES.                    
               88  F633-EOF                    VALUE 'Y'.                       
                                                                                
       01  WS-CURRENT-DATE.                                                     
           05  WS-DATE              PIC X(8)   VALUE SPACES.                    
                                                                                
      *-------------------------------------------------------------            
      * LAYOUT BP13MAIL  -  DATASET FOR EMAIL                                   
      *-------------------------------------------------------------            
       01  MAIL-HDR1.                                                           
           05  FILLER          PIC X(12)  VALUE 'HELO SGPHDB1'.                 
           05  FILLER          PIC X(68)  VALUE SPACES.                         
                                                                                
       01  MAIL-HDR2.                                                           
           05  FILLER          PIC X(11)  VALUE 'MAIL FROM:<'.                  
           05  MAIL-SENDID     PIC X(04)  VALUE 'OPCP'.                         
           05  FILLER          PIC X(09)  VALUE '@SGPHDB1>'.                    
           05  FILLER          PIC X(56)  VALUE SPACES.                         
                                                                                
      *  for testing purpose -------                                            
      *01  MAIL-HDR1.                                                           
      *    05  FILLER          PIC X(12)  VALUE 'HELO SGPHDB3'.                 
      *    05  FILLER          PIC X(68)  VALUE SPACES.                         
      *                                                                         
      *01  MAIL-HDR2.                                                           
      *    05  FILLER          PIC X(11)  VALUE 'MAIL FROM:<'.                  
      *    05  MAIL-SENDID     PIC X(07)  VALUE 'CS25015'.                      
      *    05  FILLER          PIC X(09)  VALUE '@SGPHDB3>'.                    
      *    05  FILLER          PIC X(53)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1A.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'TAY_TEE_HONG@HDB.GOV.SG>'.                                      
           05  FILLER          PIC X(11)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1B.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'ZURAIDAH_ABD_RAHIM@HDB.GOV.SG>'.                                
           05  FILLER          PIC X(11)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1C.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'NUR_ZAKIRAH_MOHD_ZILLI@HDB.GOV.SG>'.                            
           05  FILLER          PIC X(11)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1D.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'LING_HWEE_PING@HDB.GOV.SG>'.                                    
           05  FILLER          PIC X(11)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1E.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'HALIMATUS_S_MOHAMED@HDB.GOV.SG>'.                               
           05  FILLER          PIC X(11)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1F.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'DARYL_JC_NEO@HDB.GOV.SG>'.                                      
           05  FILLER          PIC X(11)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1G.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'HEE_LOO_CHIN@HDB.GOV.SG>'.                                      
           05  FILLER          PIC X(11)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1H.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'NEO_CHAI_HOON@HDB.GOV.SG>'.                                     
           05  FILLER          PIC X(11)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1I.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'FRANCIS_WM_CHEE@HDB.GOV.SG>'.                                   
           05  FILLER          PIC X(11)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1J.                                                          
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'JOCELYN_WY_TOO@HDB.GOV.SG>'.                                    
           05  FILLER          PIC X(11)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL3.                                                           
           05  FILLER          PIC X(04)  VALUE 'DATA'.                         
           05  FILLER          PIC X(76)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL4.                                                           
           05  FILLER          PIC X(05)  VALUE 'FROM:'.                        
           05  MAIL-SENDMAILID PIC X(26)  VALUE                                 
               'SOC System - Email Alert'.                                      
           05  FILLER          PIC X(49)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL5A.                                                          
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'TAY_TEE_HONG@HDB.GOV.SG>'.                                      
           05  FILLER          PIC X(16)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL5B.                                                          
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'ZURAIDAH_ABD_RAHIM@HDB.GOV.SG>'.                                
           05  FILLER          PIC X(16)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL5C.                                                          
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'NUR_ZAKIRAH_MOHD_ZILLI@HDB.GOV.SG>'.                            
           05  FILLER          PIC X(16)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL5D.                                                          
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'LING_HWEE_PING@HDB.GOV.SG>'.                                    
           05  FILLER          PIC X(16)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL5E.                                                          
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'HALIMATUS_S_MOHAMED@HDB.GOV.SG>'.                               
           05  FILLER          PIC X(16)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL5F.                                                          
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'DARYL_JC_NEO@HDB.GOV.SG>'.                                      
           05  FILLER          PIC X(16)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL5G.                                                          
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'HEE_LOO_CHIN@HDB.GOV.SG>'.                                      
           05  FILLER          PIC X(16)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL5H.                                                          
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'NEO_CHAI_HOON@HDB.GOV.SG>'.                                     
           05  FILLER          PIC X(16)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL5I.                                                          
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'FRANCIS_WM_CHEE@HDB.GOV.SG>'.                                   
           05  FILLER          PIC X(16)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL5J.                                                          
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'JOCELYN_WY_TOO@HDB.GOV.SG>'.                                    
           05  FILLER          PIC X(16)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL7.                                                           
           05  FILLER          PIC X(10)  VALUE 'SUBJECT : '.                   
           05  FILLER          PIC X(09)  VALUE 'Approved '.                    
           05  FILLER          PIC X(16)  VALUE 'payment voucher '.             
           05  FILLER          PIC X(12)  VALUE 'released on '.                 
           05  MAIL-DUE-DTE    PIC X(10)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL7A.                                                          
           05  FILLER          PIC X(10)  VALUE 'SUBJECT : '.                   
           05  FILLER          PIC X(14)  VALUE '(EAPG Portal) '.               
           05  FILLER          PIC X(09)  VALUE 'Approved '.                    
           05  FILLER          PIC X(16)  VALUE 'payment voucher '.             
           05  FILLER          PIC X(12)  VALUE 'released on '.                 
           05  MAIL-DUE-DTE2   PIC X(10)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL8.                                                           
           05 FILLER                   PIC X(6)   VALUE 'DATE: '.               
           05 MAIL-DATE                PIC X(10)  VALUE SPACES.                 
                                                                                
       01  MAIL-BODYA1.                                                         
           05 FILLER                   PIC X(80)  VALUE                         
              'Payment/Journal vouchers have been approved by DD(SO)/DD(        
      -       'SS)/Ag DD(SO)/Ag DD(SS)'.                                        
                                                                                
       01  MAIL-BODYA2.                                                         
           05 FILLER                   PIC X(80)  VALUE                         
              'Pls proceed to print approval letter and tag debarment.'.        
                                                                                
       01  MAIL-BODYA7.                                                         
           05 FILLER                   PIC X(28)  VALUE                         
              '    Voucher No      Regn'.                                       
           05 FILLER                   PIC X(40)  VALUE                         
              '    Sub Status    Sub Last/Update Date'.                         
                                                                                
       01  MAIL-BODYA8.                                                         
           05 FILLER                   PIC X(28)  VALUE                         
              '    =============   ========'.                                   
           05 FILLER                   PIC X(40)  VALUE                         
              '    ==========    ===================='.                         
                                                                                
       01  MAIL-BODYA9.                                                         
           05 FILLER                   PIC X(04)  VALUE SPACES.                 
           05 MAIL-VR-NO               PIC X(13)  VALUE SPACES.                 
           05 FILLER                   PIC X(03)  VALUE SPACES.                 
           05 MAIL-REGN-NO             PIC X(08)  VALUE SPACES.                 
           05 FILLER                   PIC X(07)  VALUE SPACES.                 
           05 MAIL-STATUS              PIC X(03)  VALUE SPACES.                 
           05 FILLER                   PIC X(13)  VALUE SPACES.                 
           05 MAIL-SUB-DATE            PIC X(10)  VALUE SPACES.                 
                                                                                
       01  MAIL-END.                                                            
           05 FILLER                   PIC X      VALUE '.'.                    
                                                                                
       01  MAIL-SPACES.                                                         
           05 FILLER                   PIC X(80)  VALUE SPACES.                 
                                                                                
       01  MAIL-EACC-DTL1A.                                                     
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'FRANCIS_WM_CHEE@HDB.GOV.SG>'.                                   
           05  FILLER          PIC X(11)  VALUE SPACES.                         
                                                                                
       01  MAIL-EACC-DTL1B.                                                     
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'CHIN_CHAINN_HUEY@HDB.GOV.SG>'.                                  
           05  FILLER          PIC X(11)  VALUE SPACES.                         
                                                                                
       01  MAIL-EACC-DTL1C.                                                     
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'TAY_TEE_HONG@HDB.GOV.SG>'.                                      
           05  FILLER          PIC X(11)  VALUE SPACES.                         
                                                                                
       01  MAIL-EACC-DTL1D.                                                     
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'ZURAIDAH_ABD_RAHIM@HDB.GOV.SG>'.                                
           05  FILLER          PIC X(11)  VALUE SPACES.                         
                                                                                
       01  MAIL-EACC-DTL1E.                                                     
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'HALIMATUS_S_MOHAMED@HDB.GOV.SG>'.                               
           05  FILLER          PIC X(11)  VALUE SPACES.                         
                                                                                
       01  MAIL-EACC-DTL1F.                                                     
           05  FILLER          PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  FILLER          PIC X(60)  VALUE                                 
               'SOH_KIM_KEE@HDB.GOV.SG>'.                                       
           05  FILLER          PIC X(11)  VALUE SPACES.                         
                                                                                
       01  MAIL-EACC-DTL5A.                                                     
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'FRANCIS_WM_CHEE@HDB.GOV.SG>'.                                   
           05  FILLER          PIC X(16)  VALUE SPACES.                         
                                                                                
       01  MAIL-EACC-DTL5B.                                                     
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'CHIN_CHAINN_HUEY@HDB.GOV.SG>'.                                  
           05  FILLER          PIC X(16)  VALUE SPACES.                         
                                                                                
       01  MAIL-EACC-DTL5C.                                                     
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'TAY_TEE_HONG@HDB.GOV.SG>'.                                      
           05  FILLER          PIC X(16)  VALUE SPACES.                         
                                                                                
       01  MAIL-EACC-DTL5D.                                                     
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'ZURAIDAH_ABD_RAHIM@HDB.GOV.SG>'.                                
           05  FILLER          PIC X(16)  VALUE SPACES.                         
                                                                                
       01  MAIL-EACC-DTL5E.                                                     
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'HALIMATUS_S_MOHAMED@HDB.GOV.SG>'.                               
           05  FILLER          PIC X(16)  VALUE SPACES.                         
                                                                                
       01  MAIL-EACC-DTL5F.                                                     
           05  FILLER          PIC X(4)   VALUE 'TO:<'.                         
           05  FILLER          PIC X(60)  VALUE                                 
               'SOH_KIM_KEE@HDB.GOV.SG>'.                                       
           05  FILLER          PIC X(16)  VALUE SPACES.                         
                                                                                
       01  MAIL-EACC-DTL2A.                                                     
           05  FILLER          PIC X(10)  VALUE 'SUBJECT : '.                   
           05  FILLER          PIC X(56)  VALUE                                 
           'Exception report with approved payment voucher released '.          
           05  FILLER          PIC X(10)  VALUE 'but grant '.                   
           05  FILLER          PIC X(04)  VALUE SPACES.                         
                                                                                
       01  MAIL-EACC-DTL2B.                                                     
           05  FILLER          PIC X(10)  VALUE SPACES.                         
           05  FILLER          PIC X(29)  VALUE                                 
           'submission status not ACC on '.                                     
           05  MAIL-DUE-DTE3   PIC X(10)  VALUE SPACES.                         
           05  FILLER          PIC X(31)  VALUE SPACES.                         
                                                                                
       01  MAIL-EACC-BODYA2.                                                    
           05 FILLER                   PIC X(80)  VALUE                         
              'Pls check on grant submission status.'.                          
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
      *-------------------------------------------------------------            
       0000-MAIN-ROUTINE.                                                       
      *-------------------------------------------------------------            
            PERFORM 1000-OPEN-ROUTINE         THRU 1000-EXIT.                   
            PERFORM 2000-READ-BP13F633        THRU 2000-EXIT.                   
                                                                                
            PERFORM 3000-PROCESS-DETAIL       THRU 3000-EXIT                    
              UNTIL F633-EOF.                                                   
                                                                                
            IF CNT-APVL-VR  > 0                                                 
               WRITE MAIL-PRTREC FROM MAIL-END                                  
            END-IF.                                                             
                                                                                
            IF CNT-APVL-NACC > 0                                                
               WRITE MAIL-EACCREC FROM MAIL-END                                 
            END-IF.                                                             
                                                                                
            PERFORM 9000-CLOSE-ROUTINE        THRU  9000-EXIT.                  
                                                                                
       0000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       1000-OPEN-ROUTINE.                                                       
      *-------------------------------------------------------------            
            OPEN INPUT  BP13F633                                                
                        SY02F001                                                
                        BP13K800                                                
                        BP13KB00                                                
                 OUTPUT BP13MAIL                                                
                        BP13EACC.                                               
                                                                                
           IF BP13K800-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR OPENING - BP13K800 : ' BP13K800-STATUS             
              MOVE BP13K800-STATUS TO RETURN-CODE                               
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF BP13KB00-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR OPENING - BP13KB00 : ' BP13KB00-STATUS             
              MOVE BP13KB00-STATUS TO RETURN-CODE                               
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
                                                                                
           READ SY02F001.                                                       
           MOVE F001-DTE-CURRENT   TO WS-CURRENT-DATE.                          
           STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)                
                   DELIMITED BY SIZE INTO MAIL-DATE.                            
           MOVE MAIL-DATE          TO MAIL-DUE-DTE                              
                                      MAIL-DUE-DTE2                             
                                      MAIL-DUE-DTE3.                            
                                                                                
       1000-EXIT.                                                               
            EXIT.                                                               
                                                                                
       2000-READ-BP13F633.                                                      
      *-------------------------------------------------------------            
           READ BP13F633                                                        
                AT END MOVE 'Y'         TO WS-F633-EOF                          
                GO TO  2000-EXIT.                                               
                                                                                
           ADD 1 TO CNT-F633-READ.                                              
                                                                                
       2000-EXIT.                                                               
            EXIT.                                                               
                                                                                
       2100-READ-BP13K800.                                                      
      *-------------------------------------------------------------            
                                                                                
           MOVE SPACES      TO BP13K800-MASTER                                  
           MOVE F633-NUM-REGN TO K800-NUM-REGN                                  
                                                                                
           READ BP13K800                                                        
                                                                                
           EVALUATE BP13K800-STATUS                                             
             WHEN 00                                                            
                CONTINUE                                                        
             WHEN 23                                                            
                MOVE SPACES   TO BP13K800-MASTER                                
             WHEN OTHER                                                         
              DISPLAY 'ERROR READING - BP13K800 : ' BP13K800-STATUS             
              MOVE BP13K800-STATUS TO RETURN-CODE                               
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-EVALUATE.                                                        
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       2200-READ-BP13KB00.                                                      
      *-------------------------------------------------------------            
                                                                                
           MOVE SPACES        TO BP13KB00-REC.                                  
           INITIALIZE            BP13KB00-REC.                                  
                                                                                
           MOVE F633-NUM-REGN TO KB00-NUM-REGN.                                 
                                                                                
           READ BP13KB00                                                        
                                                                                
           EVALUATE BP13KB00-STATUS                                             
             WHEN 00                                                            
                CONTINUE                                                        
             WHEN 23                                                            
                MOVE SPACES   TO BP13KB00-REC                                   
             WHEN OTHER                                                         
              DISPLAY 'ERROR READING - BP13KB00 : ' BP13KB00-STATUS             
              MOVE BP13KB00-STATUS TO RETURN-CODE                               
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-EVALUATE.                                                        
                                                                                
       2200-EXIT.                                                               
           EXIT.                                                                
                                                                                
       3000-PROCESS-DETAIL.                                                     
      *-------------------------------------------------------------            
                                                                                
                                                                                
           PERFORM 2200-READ-BP13KB00               THRU 2200-EXIT.             
                                                                                
           IF KB00-NUM-PREE-STATUS = 'ACC'                                      
              ADD 1                                    TO CNT-APVL-VR           
              IF CNT-APVL-VR  = 1                                               
                PERFORM 3100-CREATE-APPROVAL-HEADER    THRU 3100-EXIT           
                PERFORM 3200-WRITE-VR-HEADER           THRU 3200-EXIT           
              END-IF                                                            
           ELSE                                                                 
              ADD 1                                  TO CNT-APVL-NACC           
              IF CNT-APVL-NACC = 1                                              
                PERFORM 3150-CRATE-APRVL-NONACC-HDR    THRU 3150-EXIT           
                PERFORM 3250-WRITE-VR-HEADER           THRU 3250-EXIT           
             END-IF                                                             
           END-IF                                                               
                                                                                
           PERFORM 2100-READ-BP13K800               THRU 2100-EXIT.             
                                                                                
           IF K800-DTE-BALLOT >= '201307'                                       
             PERFORM 3300-WRITE-APPROVED-VOUCHER    THRU 3300-EXIT              
           ELSE                                                                 
                ADD 1 TO CNT-201307                                             
           END-IF.                                                              
                                                                                
           PERFORM 2000-READ-BP13F633                THRU 2000-EXIT.            
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
       3100-CREATE-APPROVAL-HEADER.                                             
      *-------------------------------------------------------------            
                                                                                
           WRITE MAIL-PRTREC FROM MAIL-HDR1                                     
           WRITE MAIL-PRTREC FROM MAIL-HDR2                                     
           WRITE MAIL-PRTREC FROM MAIL-DTL1A                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL1B                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL1C                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL1D                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL1E                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL1F                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL1G                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL1H                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL1I                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL1J                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL3                                     
           WRITE MAIL-PRTREC FROM MAIL-DTL4                                     
           WRITE MAIL-PRTREC FROM MAIL-DTL5A                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL5B                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL5C                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL5D                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL5E                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL5F                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL5G                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL5H                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL5I                                    
           WRITE MAIL-PRTREC FROM MAIL-DTL5J                                    
                                                                                
           IF BP13F633-REC(328:3) = 'ASG'                                       
              WRITE MAIL-PRTREC FROM MAIL-DTL7A                                 
           ELSE                                                                 
              WRITE MAIL-PRTREC FROM MAIL-DTL7                                  
           END-IF                                                               
           WRITE MAIL-PRTREC FROM MAIL-DTL8                                     
                                                                                
           WRITE MAIL-PRTREC FROM MAIL-SPACES.                                  
           WRITE MAIL-PRTREC FROM MAIL-BODYA1.                                  
           WRITE MAIL-PRTREC FROM MAIL-BODYA2.                                  
                                                                                
           WRITE MAIL-PRTREC FROM MAIL-SPACES.                                  
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
       3150-CRATE-APRVL-NONACC-HDR.                                             
      *-------------------------------------------------------------            
                                                                                
           WRITE MAIL-EACCREC FROM MAIL-HDR1                                    
           WRITE MAIL-EACCREC FROM MAIL-HDR2                                    
           WRITE MAIL-EACCREC FROM MAIL-EACC-DTL1A                              
           WRITE MAIL-EACCREC FROM MAIL-EACC-DTL1B                              
           WRITE MAIL-EACCREC FROM MAIL-EACC-DTL1C                              
           WRITE MAIL-EACCREC FROM MAIL-EACC-DTL1D                              
           WRITE MAIL-EACCREC FROM MAIL-EACC-DTL1E                              
           WRITE MAIL-EACCREC FROM MAIL-EACC-DTL1F                              
           WRITE MAIL-EACCREC FROM MAIL-DTL3                                    
           WRITE MAIL-EACCREC FROM MAIL-DTL4                                    
                                                                                
           WRITE MAIL-EACCREC FROM MAIL-EACC-DTL5A                              
           WRITE MAIL-EACCREC FROM MAIL-EACC-DTL5B                              
           WRITE MAIL-EACCREC FROM MAIL-EACC-DTL5C                              
           WRITE MAIL-EACCREC FROM MAIL-EACC-DTL5D                              
           WRITE MAIL-EACCREC FROM MAIL-EACC-DTL5E                              
           WRITE MAIL-EACCREC FROM MAIL-EACC-DTL5F                              
                                                                                
           WRITE MAIL-EACCREC FROM MAIL-EACC-DTL2A                              
           WRITE MAIL-EACCREC FROM MAIL-EACC-DTL2B                              
           WRITE MAIL-EACCREC FROM MAIL-DTL8                                    
                                                                                
           WRITE MAIL-EACCREC FROM MAIL-SPACES.                                 
           WRITE MAIL-EACCREC FROM MAIL-BODYA1.                                 
           WRITE MAIL-EACCREC FROM MAIL-EACC-BODYA2.                            
                                                                                
           WRITE MAIL-EACCREC FROM MAIL-SPACES.                                 
                                                                                
       3150-EXIT.                                                               
           EXIT.                                                                
                                                                                
       3200-WRITE-VR-HEADER.                                                    
      *-------------------------------------------------------------            
                                                                                
           WRITE MAIL-PRTREC FROM MAIL-SPACES.                                  
           WRITE MAIL-PRTREC FROM MAIL-SPACES.                                  
           WRITE MAIL-PRTREC FROM MAIL-BODYA7.                                  
           WRITE MAIL-PRTREC FROM MAIL-BODYA8.                                  
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
       3250-WRITE-VR-HEADER.                                                    
      *-------------------------------------------------------------            
                                                                                
           WRITE MAIL-EACCREC FROM MAIL-SPACES.                                 
           WRITE MAIL-EACCREC FROM MAIL-SPACES.                                 
           WRITE MAIL-EACCREC FROM MAIL-BODYA7.                                 
           WRITE MAIL-EACCREC FROM MAIL-BODYA8.                                 
                                                                                
       3250-EXIT.                                                               
           EXIT.                                                                
                                                                                
       3300-WRITE-APPROVED-VOUCHER.                                             
      *-------------------------------------------------------------            
                                                                                
           STRING F633-NUM-DDD      '-'                                         
                  F633-NUM-FIN-YEAR '-'                                         
                  F633-NUM-VR-SERIAL                                            
                  DELIMITED BY SIZE INTO MAIL-VR-NO.                            
                                                                                
           MOVE F633-NUM-REGN             TO MAIL-REGN-NO.                      
           MOVE KB00-NUM-PREE-STATUS      TO MAIL-STATUS.                       
                                                                                
           IF KB00-DTE-UPDATE NOT = SPACES AND LOW-VALUES AND ZEROES            
              STRING KB00-DTE-UPDATE(7:2) '/'                                   
                     KB00-DTE-UPDATE(5:2) '/'                                   
                     KB00-DTE-UPDATE(1:4)                                       
                   DELIMITED BY SIZE INTO MAIL-SUB-DATE                         
           END-IF.                                                              
                                                                                
           IF KB00-NUM-PREE-STATUS = 'ACC'                                      
              WRITE MAIL-PRTREC FROM MAIL-BODYA9                                
              ADD  1     TO  CNT-APVL-ACC                                       
           ELSE                                                                 
              WRITE MAIL-EACCREC FROM MAIL-BODYA9                               
              ADD  1     TO  CNT-APVL-VRACC                                     
           END-IF.                                                              
                                                                                
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
       9000-CLOSE-ROUTINE.                                                      
      *-------------------------------------------------------------            
                                                                                
            DISPLAY ' '.                                                        
            DISPLAY ' - BP13CF98 CONTROL TOTALS -----'.                         
            DISPLAY ' '.                                                        
            DISPLAY '  NO. OF BP13F633 RECS READ     = ' CNT-F633-READ.         
            DISPLAY '  NO. OF APPROVED VOUCHER       = ' CNT-APVL-ACC.          
            DISPLAY '  NO. OF APPROVED VOUCHER NONACC= ' CNT-APVL-VRACC.        
            DISPLAY '  NO. OF < 201307 CASES         = ' CNT-201307.            
            DISPLAY ' '.                                                        
                                                                                
            CLOSE BP13F633                                                      
                  SY02F001                                                      
                  BP13K800                                                      
                  BP13KB00                                                      
                  BP13MAIL                                                      
                  BP13EACC.                                                     
                                                                                
            STOP RUN.                                                           
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
