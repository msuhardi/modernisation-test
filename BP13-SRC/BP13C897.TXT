       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C897.                                                 
      *AUTHOR.        CHETANA.                                                  
      *DATE-WRITTEN.  27 SEP 2019.                                              
      * ========================================================= *             
      *  SYSTEM OF COMMITMENT (BP13)                              *             
      * ========================================================= *             
      *  OBJECTIVE  :  PRINTING OF LETTERS FOR ELDERLY CASES      *             
      *                                                           *             
      *  PRINTING OF LETTERS IN BP13.BATCH.COPYCOB                *             
      *                                                           *             
      *  INPUT      :  1.  BP13F740 - BP13.F740.MATUREBA          *             
      *                2.  BP13K060 - BP13.K060.CODETAB           *             
      *                3.  BP13K096 - BP13.K096.SECURITY          *             
      *                4.  BP13K757 - BP13.K757.BTO               *             
      *                5.  BP13K800 - BP13.K800.APPLN             *             
      *                6.  BP13K820 - BP13.K820.SOCOCCP           *             
      *                7.  BP13K830 - BP13.K830.ADDR              *             
      *                8.  BP13K200 - BP13.K200.BKAPPMT           *             
      *                9.  BP13K062 - BP13.K062.CODETBL           *             
      *  OUTPUT     :  1.  P13P89DA - INVITATION LETTER           *             
      *                                                           *             
      * ========================================================= *             
      *  CHG REF  OIC   DATE        DESCRIPTION                   *             
      *  -------- ----  ----------  ----------------------------  *             
      *  BP137989 CC37  27/09/2019  NEW PROGRAM                   *             
      *  BP137989 CC37  22/10/2019  EHG CHANGES                   *             
      *  BP138018 CC37  11/12/2019  MGPS AND GRO CHANGES          *             
      *  BP138345 MRR5  11/06/2020  COVID-19 CHANGES              *             
      *  BP138345 MRR5  26/06/2020  CATER FOR PRINTING BLANK PAGE *             
      *                             IF FINAL PAGE COUNT IS ODD NUM*             
      *  BP138201 MRR5  15/07/2020  SUBTRACT 14 INSTEAD OF 31 FROM*             
      *                             WS-NUM-DTE-LETTER             *             
      *  BP138345 MRR5  23/07/2020  COVID-19 CHANGES FOR SPS      *             
      *  BP138460 MRR5  22/09/2020  BYPASS PRINTING WHEN FND IN K76D            
      *  BP138460 MRR5  24/11/2020  FIX PRINT OF LIST OF ELDERLY CASES          
      *  BP138553 MRR5  23/12/2020  EHG CHANGES                   *             
      *  BP138553 MRR5  07/01/2020  FIX FEE ALIGNMENT FOR BP1350,BP1353         
      *  BP138553 MRR5  19/01/2021  FIX SPOUSE/FIANCE TAGGING AND *             
      *                             ADD 'SAP' FOR WS-C398-ESS-MBRS*             
      *  BP138553 MRR5  10/02/2021  FIX TRUNCATION ISSUE FOR FLAT TYPE          
      *  BP138641 MRR5  30/03/2021  NEW CCA FORMS BP13A7          *             
      *                             AND JOINT BAL BP13A8          *             
      *                             PAGE 2 IMPT NOTES: BP13A9     *             
      *                        BSP: BP13C1, BP13C2, BP13C3, BP13C4*             
      *                             BP13C5, BP13C6, BP13C7, BP13C8*             
      *  BP138950 MRR5  09/11/2021  USE BP13HC ONLY FOR ANNEX1    *             
      *  BP139074 MRR5  11/02/2022  REMOVE EHG WRITEUP BP13B7/B8/B9             
      *  BP139083 MRR5  28/02/2022  NEW EHG FORMS ON OR AFTER NOV 2021          
      *  BP139251 MRR5  28/07/2022  REMOVE * AFTER Identity Card  *             
      *  BP139344 MRR5  23/11/2022  FIX BLANK PAGE ISSUE BEFORE EHG FRMS        
      *  BP139452 MRR5  30/01/2023  new CCA BSP FORMS BP13ZR, BP13ZD,           
      *                             BP13ZE, BP13ZF, BP13ZH, BP13ZI,             
      *                             BP13ZJ, BP13ZC, BP13Z0, BP13J9              
      *  BP139452 MRR5  01/02/2023  FIX PAGE COUNT FOR CCA BSP FORMS            
      *  BP139436 MRR5  27/02/2023  FIX BLANK PAGE ISSUE BEFORE EHG FRMS        
      *  BP139694 MRR5  04/07/2023  HFE CHANGES, REMOVE COVID-19 TEXT           
      *  BP139280 EAA2  07/11/2023  EXPAND BP13K757 FROM 3000 TO 4000           
      *  BP139906 MRR5  16/02/2024  BYPASS BSP FORMS FOR CCA DEC 2023           
      *  BP139889 MRR5  19/02/2024  ADDITIONAL TEXT AT THE END OF ANNEX1        
      *  BP139777 MRR5  25/03/2024  REMOVAL OF AHG/SHG RELATED FORMIDS          
      * ========================================================= *             
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
           SELECT BP13F200     ASSIGN       TO BP13F200.                        
           SELECT BP13F205     ASSIGN       TO BP13F205.                        
                                                                                
           SELECT BP13K060     ASSIGN       TO BP13K060                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS RANDOM                           
                               RECORD KEY   IS K060-KEY-FLD                     
                               FILE STATUS  IS WS-K060-STATUS.                  
                                                                                
           SELECT BP13K062     ASSIGN       TO BP13K062                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS RANDOM                           
                               RECORD KEY   IS K062-KEY-FLD                     
                               FILE STATUS  IS WS-K062-STATUS.                  
                                                                                
           SELECT BP13K757     ASSIGN       TO BP13K757                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS RANDOM                           
                               RECORD KEY   IS K757-KEY-FLD                     
                               FILE STATUS  IS WS-K757-STATUS.                  
                                                                                
           SELECT BP13K813     ASSIGN       TO BP13K813                         
                               ACCESS MODE  IS RANDOM                           
                               ORGANIZATION IS INDEXED                          
                               RECORD KEY   IS K813-KEY-FLD                     
                               FILE STATUS  IS WS-K813-STATUS.                  
                                                                                
           SELECT BP13K800     ASSIGN       TO BP13K800                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS RANDOM                           
                               RECORD KEY   IS K800-NUM-REGN                    
                               FILE STATUS  IS WS-K800-STATUS.                  
                                                                                
           SELECT BP13K820     ASSIGN       TO BP13K820                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS DYNAMIC                          
                               RECORD KEY   IS K820-KEY-FLD                     
                               FILE STATUS  IS WS-K820-STATUS.                  
                                                                                
           SELECT BP13K830     ASSIGN       TO BP13K830                         
                               ACCESS MODE  IS RANDOM                           
                               ORGANIZATION IS INDEXED                          
                               RECORD KEY   IS K830-KEY-FLD                     
                               ALTERNATE RECORD KEY IS  K830-NUM-REGN           
                               FILE STATUS  IS WS-K830-STATUS.                  
                                                                                
           SELECT BP13K246     ASSIGN       TO BP13K246                         
                               ACCESS MODE  IS RANDOM                           
                               ORGANIZATION IS INDEXED                          
                               RECORD KEY   IS K246-KEY-FLD                     
                               FILE STATUS  IS WS-K246-STATUS.                  
                                                                                
           SELECT BP13K76D     ASSIGN       TO BP13K76D                         
                               ACCESS MODE  IS RANDOM                           
                               ORGANIZATION IS INDEXED                          
                               RECORD KEY   IS K76D-KEY-FLD                     
                               FILE STATUS  IS WS-K76D-STATUS.                  
                                                                                
           SELECT BP13K734     ASSIGN       TO BP13K734                         
                               ACCESS MODE  IS RANDOM                           
                               ORGANIZATION IS INDEXED                          
                               RECORD KEY   IS K734-KEY-FLD                     
                               FILE STATUS  IS WS-K734-STATUS.                  
                                                                                
           SELECT BP13K200     ASSIGN       TO BP13K200                         
                               ACCESS MODE  IS RANDOM                           
                               ORGANIZATION IS INDEXED                          
                               ALTERNATE KEY IS K200-NUM-REGN                   
                               RECORD KEY   IS K200-KEY-FLD                     
                               FILE STATUS  IS WS-K200-STATUS.                  
                                                                                
           SELECT BP04K010     ASSIGN       TO BP04K010                         
                               ACCESS MODE  IS DYNAMIC                          
                               ORGANIZATION IS INDEXED                          
                               RECORD KEY   IS K010-PRIME-KEY                   
                               FILE STATUS  IS WS-K010-STATUS.                  
                                                                                
           SELECT P13P89DA     ASSIGN       TO P13P89DA.                        
                                                                                
           SELECT P13L89DA     ASSIGN       TO P13L89DA.                        
                                                                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD   BP13F200 IS GLOBAL                                                  
            RECORD CONTAINS 300 CHARACTERS                                      
            LABEL RECORDS IS STANDARD                                           
            RECORDING MODE IS F.                                                
       COPY BP13F200.                                                           
                                                                                
       FD   BP13F205 IS GLOBAL                                                  
            RECORD CONTAINS 80 CHARACTERS                                       
            LABEL RECORDS IS STANDARD                                           
            RECORDING MODE IS F.                                                
       COPY BP13F205.                                                           
                                                                                
       FD   BP13K060 IS GLOBAL                                                  
            RECORD CONTAINS 25 CHARACTERS.                                      
       COPY BP13K060.                                                           
                                                                                
       FD   BP13K062 IS GLOBAL                                                  
            RECORD CONTAINS 150 CHARACTERS.                                     
       COPY BP13K062.                                                           
                                                                                
       FD   BP13K813 IS GLOBAL                                                  
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BP13K813.                                                           
                                                                                
       FD   BP13K757 IS GLOBAL                                                  
            RECORD CONTAINS 4000 CHARACTERS.                                    
       COPY BP13K757.                                                           
                                                                                
       FD   BP13K800 IS GLOBAL                                                  
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K820 IS GLOBAL                                                  
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD   BP13K830 IS GLOBAL                                                  
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD   BP13K246 IS GLOBAL                                                  
            RECORD CONTAINS 80 CHARACTERS.                                      
       COPY BP13K246.                                                           
                                                                                
       FD   BP13K76D IS GLOBAL                                                  
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K76D.                                                           
                                                                                
       FD   BP13K734 IS GLOBAL                                                  
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13K734.                                                           
                                                                                
       FD   BP13K200 IS GLOBAL                                                  
            RECORD CONTAINS 300 CHARACTERS.                                     
       COPY BP13K200.                                                           
                                                                                
       FD   BP04K010 IS GLOBAL                                                  
            RECORD CONTAINS 300 CHARACTERS.                                     
       COPY P04K010.                                                            
                                                                                
       FD   P13P89DA IS GLOBAL                                                  
            RECORD CONTAINS 120 CHARACTERS                                      
            LABEL RECORDS IS STANDARD                                           
            RECORDING MODE IS  F.                                               
       01   P13P89DA-REC    PIC X(120) GLOBAL.                                  
                                                                                
       FD   P13L89DA IS GLOBAL                                                  
            RECORD CONTAINS 100 CHARACTERS                                      
            LABEL RECORDS IS STANDARD                                           
            RECORDING MODE IS  F.                                               
       01   P13L89DA-REC    PIC X(100) GLOBAL.                                  
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       COPY BE01W812.                                                           
       COPY BE01W902.                                                           
                                                                                
       01  WS-FILE-SWITCHES.                                                    
           05  WS-F200-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-F205-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K800-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K820-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K010-EOF               PIC X(01)  VALUE 'N'.                  
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-F200-READ-CNT          PIC 9(06)  VALUE ZEROES.               
           05  WS-K820-READ-CNT          PIC 9(06)  VALUE ZEROES.               
           05  WS-K757-FND-CNT           PIC 9(06)  VALUE ZEROES.               
           05  WS-K757-NFND-CNT          PIC 9(06)  VALUE ZEROES.               
           05  WS-K800-FND-CNT           PIC 9(06)  VALUE ZEROES.               
           05  WS-K800-NFND-CNT          PIC 9(06)  VALUE ZEROES.               
           05  WS-K76D-FND-CNT           PIC 9(06)  VALUE ZEROES.               
           05  WS-K76D-NFND-CNT          PIC 9(06)  VALUE ZEROES.               
           05  WS-ELDERLY-CNT            PIC 9(06)  VALUE ZEROES.               
           05  WS-IDX1                   PIC 9(02)  VALUE ZEROES.               
           05  WS-IDX2                   PIC 9(02)  VALUE ZEROES.               
           05  WS-IDX3                   PIC 9(02)  VALUE ZEROES.               
           05  WS-K800-FND               PIC X(01)  VALUE 'N'.                  
           05  WS-K820-FND               PIC X(01)  VALUE 'N'.                  
           05  WS-K76D-FND               PIC X(01)  VALUE 'N'.                  
           05  WS-K734-FND               PIC X(01)  VALUE 'N'.                  
           05  WS-MRG-TBL-FND            PIC X(01)  VALUE 'N'.                  
           05  WS-MRG-CHK-SKIP           PIC X(01)  VALUE 'N'.                  
           05  WS-HA1-WSP-STAT           PIC X(01)  VALUE 'N'.                  
           05  WS-OC1-GT21               PIC X(01)  VALUE 'N'.                  
           05  WS-BLANK-PRINTED          PIC X(01)  VALUE 'N'.                  
           05  WS-HFE-DEFER              PIC X(01)  VALUE 'N'.                  
           05  WS-AGE-GT55               PIC X(01)  VALUE 'N'.                  
           05  WS-EMP-STATUS             PIC X(01)  VALUE SPACE.                
           05  WS-DTE-INCOME1            PIC X(06)  VALUE SPACE.                
           05  WS-DTE-INCOME2            PIC X(06)  VALUE SPACE.                
           05  WS-NUM-INCOME1            PIC X(05)  VALUE SPACE.                
           05  WS-NUM-INCOME2            PIC X(05)  VALUE SPACE.                
           05  WS-NUM-INCOME3            PIC X(05)  VALUE SPACE.                
           05  WS-IDNTY-TYPE             PIC X(03)  VALUE SPACES.               
           05  WS-BE01-UNSUCC            PIC 9(06)  VALUE ZEROES.               
           05  WS-BE01-SUCC              PIC 9(06)  VALUE ZEROES.               
                                                                                
       01  WS-AGE                        PIC 9(08) VALUE ZEROES.                
       01  WS-NUM-AGE  REDEFINES WS-AGE.                                        
           05 WS-AGE-CMPLTD              PIC 9(04).                             
           05 WS-NUM-REMNG               PIC 9(04).                             
                                                                                
       01  WS-AGE2                       PIC 9(08) VALUE ZEROES.                
       01  WS-NUM-AGE2 REDEFINES WS-AGE2.                                       
           05 WS-AGE-CMPLTD2             PIC 9(04).                             
           05 WS-NUM-REMNG2              PIC 9(04).                             
                                                                                
       01  WS-DTE-LETTER                 PIC 9(08) VALUE ZEROES.                
       01  WS-DTE-LETTER-2               PIC 9(08) VALUE ZEROES.                
       01  WS-NUM-DTE-LETTER             PIC 9(07) VALUE ZEROES.                
       01  WS-PAIRED-REGN                PIC X(08) VALUE SPACES.                
       01  WS-NUM-REGN                   PIC X(08) VALUE SPACES.                
                                                                                
       01  WS-ARRAY-VARIABLES.                                                  
           05  WS-ARRAY-VARS OCCURS 12 TIMES.                                   
               10  WS-NUM-CSTMR          PIC X(09)  VALUE SPACES.               
               10  WS-NUM-NRIC-WIFE      PIC X(09)  VALUE SPACES.               
               10  WS-NUM-NRIC-HSBND     PIC X(09)  VALUE SPACES.               
                                                                                
       01 WS-AHG-SHG-DET GLOBAL.                                                
          05 WS-AHG-APPLN                  PIC X      VALUE 'N'.                
          05 WS-AHG-APPLN-F120             PIC X      VALUE 'N'.                
          05 WS-AHG-SHG-SINGLES            PIC X      VALUE 'N'.                
          05 WS-AHG-SHG-COUPLES            PIC X      VALUE 'N'.                
          05 WS-AHG-SHG-FAMILY             PIC X      VALUE 'N'.                
          05 WS-AHG-COUPLES                PIC X      VALUE 'N'.                
          05 WS-AHG-FAMILY                 PIC X      VALUE 'N'.                
          05 WS-AHG-DOC-DUE                PIC 9(08) VALUE ZEROES.              
          05 WS-DTE-DOC-DUE                PIC 9(08) VALUE ZEROES.              
          05 WS-DTE-DUE                    PIC 9(08) VALUE ZEROES.              
          05 WS-DTE-BK-APPT                PIC 9(08) VALUE ZEROES.              
                                                                                
       01  WS-FILE-STATUS-G GLOBAL.                                             
           05  WS-K060-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K062-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K096-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K757-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K800-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K820-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K830-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K555-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K813-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K246-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K76D-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K734-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K200-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K010-STATUS            PIC 9(02)  VALUE ZEROES.               
                                                                                
       01  WS-VARIABLES-G GLOBAL.                                               
           05  WS-CURRENT-DATE           PIC X(08)  VALUE SPACES.               
           05  WS-DATE                   PIC 9(08)  VALUE ZEROES.               
           05  WS-DTE-APPLN              PIC 9(08)  VALUE ZEROES.               
           05  WS-BIRTH-DATE             PIC 9(08)  VALUE ZEROES.               
           05  WS-TOT-PAGE-CNT           PIC 9(06)  VALUE ZEROES.               
           05  WS-CASE-PAGE-CNT          PIC 9(03)  VALUE ZEROES.               
           05  WS-CNT-WRITE-L89DA        PIC 9(08)  VALUE ZEROES.               
           05  WS-CNT-WRITE-L89DB        PIC 9(08)  VALUE ZEROES.               
           05  WS-REC-SKIPPED            PIC 9(08)  VALUE ZEROES.               
           05  WS-TOT-LET-PRINT          PIC 9(08)  VALUE ZEROES.               
           05  WS-CNT-LINE-ON-PAGE-A     PIC 9(08)  VALUE ZEROES.               
           05  WS-CNT-LINE-ON-PAGE-B     PIC 9(08)  VALUE ZEROES.               
           05  WS-CNT-PRINT-L89DA        PIC 9(08)  VALUE 1.                    
           05  WS-CNT-PRINT-L89DB        PIC 9(08)  VALUE 1.                    
           05  WS-NO-OF-PAGE-A           PIC 9(08)  VALUE ZEROES.               
           05  WS-NO-OF-PAGE-B           PIC 9(08)  VALUE ZEROES.               
           05  WS-CURR-DATE              PIC X(10)  VALUE SPACES.               
           05  WS-FORM-PRTED             PIC 9(06)  VALUE ZEROES.               
           05  WS-HH                     PIC X(01)  VALUE SPACES.               
           05  WS-FT                     PIC X(01)  VALUE SPACES.               
           05  WS-CTR                    PIC 9(02)  VALUE ZEROES.               
           05  WS-CTR2                   PIC 9(02)  VALUE ZEROES.               
           05  WS-INC-CTR                PIC 9(02)  VALUE ZEROES.               
           05  WS-INC-CTR2               PIC 9(02)  VALUE ZEROES.               
           05  CTR                       PIC 9(02)  VALUE ZEROES.               
           05  WS-NRIC-CNT               PIC 9(02)  VALUE ZEROES.               
           05  WS-APPL-CNT               PIC 9(02)  VALUE ZEROES.               
           05  WS-OCCP-CNT               PIC 9(02)  VALUE ZEROES.               
           05  WS-DOC-CNT                PIC 9(03)  VALUE ZEROES.               
           05  WS-HFE                    PIC X(01)  VALUE SPACES.               
                                                                                
      * PARAMETERS FOR INVITATION AND UNDERTAKING LETTERS                       
      * SIMILAR FROM BP13C245                                                   
                                                                                
       01  WS-C245-PARAMETERS GLOBAL.                                           
      *    05  WS-C245-LETTER-TYPE        PIC X(01).                            
           05  WS-C245-NUM-ALLO-SCHEME    PIC X(03).                            
           05  WS-C245-ROOM               PIC X(02).                            
           05  WS-C245-REGN-NO            PIC X(08).                            
           05  WS-C245-ALLOC-SCH          PIC X(07).                            
      *    05  WS-C245-HT                 PIC X(01).                            
           05  WS-C245-Q-NO               PIC X(05).                            
           05  WS-C245-ALLOC-DATE         PIC X(10).                            
           05  WS-C245-SELECT-ROOM        PIC X(09).                            
           05  WS-C245-ZONE               PIC X(10).                            
           05  WS-C245-NT-ZONE-NAME       PIC X(20).                            
           05  WS-C245-BALLOT-QTR         PIC X(03).                            
           05  WS-C245-BALLOT-YR          PIC X(04).                            
           05  WS-C245-BALLOT-MNT-YR      PIC X(14).                            
           05  WS-C245-APPMT-DATE         PIC X(10).                            
           05  WS-C245-APPMT-TIME.                                              
               10  WS-C245-APPMT-HR       PIC X(02).                            
               10  WS-C245-APPMT-SEP      PIC X(01).                            
               10  WS-C245-APPMT-MIN      PIC X(02).                            
               10  FILLER                 PIC X(01).                            
               10  WS-C245-APPMT-AM-PM    PIC X(02).                            
           05  WS-C245-BOOKFEE            PIC X(07).                            
           05  WS-C245-PERCENT-DESC       PIC X(07).                            
           05  WS-C245-PERCENT            PIC 9(02).                            
           05  WS-C245-REMAINDER          PIC X(04).                            
           05  WS-C245-TITLE              PIC X(12).                            
           05  WS-C245-APPLN-NAME         PIC X(66).                            
           05  WS-C245-COAPPLN-NAME       PIC X(66).                            
           05  WS-C245-COAPPLN2-NAME      PIC X(66).                            
           05  WS-C245-COAPPLN3-NAME      PIC X(66).                            
           05  WS-C245-APPLN-NRIC         PIC X(09).                            
           05  WS-C245-COAPPLN-NRIC       PIC X(09).                            
           05  WS-C245-COAPPLN2-NRIC      PIC X(09).                            
           05  WS-C245-COAPPLN3-NRIC      PIC X(09).                            
           05  WS-C245-ADDRESS1.                                                
               10  FILLER                 PIC X(10).                            
               10  WS-C245-BLK-NO         PIC X(10).                            
               10  FILLER                 PIC X(2).                             
               10  WS-C245-NUM-FLAT.                                            
                   15  WS-C245-CHAR       PIC X(01).                            
                   15  WS-C245-LEVEL      PIC X(02).                            
                   15  WS-C245-DASH       PIC X(01).                            
                   15  WS-C245-HSE-MAIN   PIC X(04).                            
                   15  WS-C245-HSE-SUB    PIC X(03).                            
           05  WS-C245-ADDRESS2.                                                
               10  WS-C245-STREET-NAME    PIC X(65).                            
           05  WS-C245-CODE               PIC X(16).                            
           05  WS-C245-CC                 PIC X(22).                            
      *    05  WS-C245-BO                 PIC X(02).                            
           05  WS-C245-NME-OIC            PIC X(40).                            
      *    05  WS-C245-OIC-DESIG          PIC X(40).                            
           05  WS-C245-SHOW-FLAT          PIC X(35).                            
           05  WS-C245-BTO-REOPT          PIC X(01).                            
           05  WS-C245-NUM-JB-MTF         PIC X(01).                            
           05  WS-C245-NUM-LOW-FLOOR      PIC X(01).                            
           05  WS-C245-NUM-LOAN-TAG       PIC X(01).                            
           05  FILLER                     PIC X(96).                            
                                                                                
      * PARAMETERS FOR DOCUMENT LETTERS                                         
                                                                                
       01 WS-C398-PARAMETERS GLOBAL.                                            
          02 WS-C398-LTR-VARS.                                                  
             05 WS-C398-NUM-REGN                   PIC X(08).                   
             05 WS-C398-NUM-REGN-PAIRED            PIC X(08).                   
             05 WS-C398-PRT-DATE                   PIC X(10).                   
             05 WS-C398-ESS-MBRS                   PIC X(01).                   
             05 WS-C398-ORPHANS-DECL               PIC X(01).                   
             05 WS-C398-MCPS-FRM                   PIC X(01).                   
             05 WS-C398-APPLN-FRM                  PIC X(01).                   
             05 WS-C398-MGLS-FRM                   PIC X(01).                   
             05 WS-C398-APPS-CERTF                 PIC X(01).                   
             05 WS-C398-OCCUPIERS  OCCURS 12 TIMES.                             
                10 WS-C398-NRIC                    PIC X(09).                   
                10 WS-C398-CDE-OCCUPIER            PIC X(01).                   
                10 WS-C398-NME-OCCUPIER            PIC X(66).                   
                10 WS-C398-AGE-OCCUPIER            PIC 9(03).                   
                10 WS-C398-DEB-OCCUPIER            PIC X(02).                   
                10 WS-C398-GENDER                  PIC X(01).                   
                10 WS-C398-CITIZENSHIP             PIC X(02).                   
                10 WS-C398-DOB                     PIC X(08).                   
                10 WS-C398-DOC-REQD.                                            
                   20 WS-C398-ID-CARD              PIC X(01).                   
                   20 WS-C398-PASS-PERMIT          PIC X(01).                   
                   20 WS-C398-BIRTH-CERTF          PIC X(01).                   
                   20 WS-C398-MARRIAGE-CERTF       PIC X(01).                   
                   20 WS-C398-PAY-SLIP             PIC X(01).                   
                   20 WS-C398-UNEMPLYMNT-DECL      PIC X(01).                   
                   20 WS-C398-STUDENT-PASS         PIC X(01).                   
                   20 WS-C398-DEATH-CERTF          PIC X(01).                   
                   20 WS-C398-NRIC-DTH-CERTF       PIC X(09).                   
                   20 WS-C398-NME-DTH-CERTF        PIC X(66).                   
                   20 WS-C398-DIVORCE-CERTF        PIC X(01).                   
                   20 WS-C398-PHOTOGRAPH           PIC X(01).                   
                   20 WS-C398-MARRIAGE-CONSENT     PIC X(01).                   
                   20 WS-C398-RELATIONSHIP         PIC X(02).                   
                   20 WS-C398-SP-FI                PIC X(01).                   
                   20 WS-C398-DIVORCE-FNLJDGMT     PIC X(01).                   
             05 FILLER                             PIC X(38).                   
          02 WS-C398-LETTER-CNT                    PIC 9(02).                   
                                                                                
       01 WS-C398-INCOME-PARAMETERS GLOBAL.                                     
          02 WS-C398-LTR-VARS2.                                                 
             05 WS-C398-INC  OCCURS 12 TIMES.                                   
                10 WS-C398-AGE2-OCCUPIER            PIC 9(03).                  
                10 WS-C398-INC-REQD.                                            
                   20 WS-C398-EMP-STAT             PIC X(01).                   
                   20 WS-C398-DTE-INCOME1          PIC X(06).                   
                   20 WS-C398-DTE-INCOME2          PIC X(06).                   
                   20 WS-C398-NUM-INCOME1          PIC X(05).                   
                   20 WS-C398-NUM-INCOME2          PIC X(05).                   
                   20 WS-C398-NUM-INCOME3          PIC X(05).                   
                10 WS-C398-PPS-ELIG                PIC X(01).                   
                10 WS-C398-NS-LT12MTH              PIC X(01).                   
                10 WS-C398-EDN-LT12MTH             PIC X(01).                   
          02 FILLER                                PIC X(27).                   
                                                                                
       01 WS-LINE-CTR                      PIC 9(02)  VALUE ZEROES.             
       01 WS-REPORT-CTR                    PIC 9(02)  VALUE ZEROES.             
       01 WS-SN-CTR                        PIC 9(04)  VALUE ZEROES.             
       01 WS-HEADING-CTR                   PIC 9(02)  VALUE ZEROES.             
       01 WS-I                             PIC 9(02)  VALUE ZEROES.             
       01 WS-SLNO                          PIC 9(02)  VALUE ZEROES.             
       01 IDX                              PIC 9(02)  VALUE ZEROES.             
       01 WS-CHAR-UNDERLINE                PIC X(32)  VALUE ALL '_'.            
       01 WS-BALLOT-MONTH                  PIC X(03)  VALUE SPACES.             
       01 WS-BALLOT-MONTH1                 PIC X(03)  VALUE SPACES.             
       01 WS-BALLOT-MONTH2                 PIC X(03)  VALUE SPACES.             
       01 WS-DTE-APPLY                     PIC X(03)  VALUE SPACES.             
       01 WS-DTE-APPLY2                    PIC X(03)  VALUE SPACES.             
       01 WS-DTE-INC1                      PIC X(06)  VALUE SPACES.             
       01 WS-DTE-INC2                      PIC X(06)  VALUE SPACES.             
       01 WS-DTE-REGN                      PIC X(06)  VALUE SPACES.             
       01 WS-NUM-DTE-REGN REDEFINES WS-DTE-REGN.                                
          05  WS-DTE-REGN-CCYY             PIC 9(4).                            
          05  WS-DTE-REGN-MM               PIC 9(2).                            
       01 WS-DTE-REGN2                     PIC X(06)  VALUE SPACES.             
       01 WS-NUM-DTE-REGN2 REDEFINES WS-DTE-REGN2.                              
          05  WS-DTE-REGN-CCYY2            PIC 9(4).                            
          05  WS-DTE-REGN-MM2              PIC 9(2).                            
       01 WS-INCOME-FLAG                   PIC X      VALUE 'Y'.                
       01 WS-FIRST-FLAG                    PIC X      VALUE 'Y'.                
       01 WS-COMPLETED-HDR-PRINTED         PIC X      VALUE 'N'.                
       01 WS-CONSENT                       PIC X      VALUE 'N'.                
       01 WS-ODD-JOB-TAG                   PIC X      VALUE 'N'.                
       01 WS-DTE-APPLICATION               PIC X(08)  VALUE SPACES.             
       01 WS-DTE-DOC-DUE-EDT               PIC X(10) VALUE ZEROES.              
       01 WS-NUM-QUEUE                     PIC X(05)  VALUE SPACES.             
       01 WS-NUM-RANGE                     PIC 9(05)  VALUE ZEROES.             
       01 WS-NUM-UNIT-OFFER                PIC 9(05)  VALUE ZEROES.             
       01 WS-NUM-QUEUE-PERCENT             PIC 9(03)  VALUE ZEROES.             
       01 WS-REGN-PAGE-CNT                 PIC 9(03)  VALUE ZEROES.             
                                                                                
      *01  WS-RELATIONSHIP.                                                     
      *    05  WS-APPL-REL OCCURS 8 TIMES.                                      
      *        10  WS-REL               PIC X(20).                              
                                                                                
       01  WS-MONTH                          PIC X(02)  VALUE SPACES.           
       01  WS-MONTH-DESC                     PIC X(03)  VALUE SPACES.           
       01  WS-K757-FND                       PIC X      VALUE 'N'.              
       01  WS-STREET-NAME                    PIC X(65)  VALUE SPACES.           
       01  WS-BLK-NO                         PIC X(10)  VALUE SPACES.           
       01  WS-SP-FI-CTR                      PIC 9(2)   VALUE ZEROES.           
       01  WS-INCOME-CEILING                 PIC ZZ,ZZZ VALUE ZEROES.           
       01  WS-NUM-OFFER                      PIC ZZZ9.                          
                                                                                
       01  WS-EDITED-DATE.                                                      
           05  WS-EDITED-DD                  PIC 99     VALUE 00.               
           05  FILLER                        PIC X      VALUE '/'.              
           05  WS-EDITED-MM                  PIC 99     VALUE 00.               
           05  FILLER                        PIC X      VALUE '/'.              
           05  WS-EDITED-CCYY                PIC 9999   VALUE 00.               
                                                                                
       01  WS-COMP-DATE.                                                        
           05  WS-COMP-CCYY                  PIC 9999   VALUE 00.               
           05  WS-COMP-MM                    PIC 99     VALUE 00.               
           05  WS-COMP-DD                    PIC 99     VALUE 00.               
                                                                                
       01  WS-APPMT-TIME.                                                       
           05  WS-APPMT-HR                   PIC 9(2)   VALUE 00.               
           05  WS-APPMT-MIN                  PIC 9(2)   VALUE 00.               
                                                                                
       01  WS-PARSING.                                                          
           05 WS-STRING-TO-PARSE            PIC X(77).                          
           05 WS-PARSED-STRING              PIC X(77).                          
           05 WS-STRING-LENGTH              PIC 9(03).                          
           05 WS-CUR-POS-SP                 PIC 9(03).                          
           05 WS-CUR-POS-PS                 PIC 9(03).                          
           05 WS-SPACE-FLAG                 PIC X    VALUE 'N'.                 
           05 WS-INSERT-SPACE-FLAG          PIC X    VALUE 'N'.                 
                                                                                
       01  WS-C908-PARAMETERS.                                                  
           05  WS-INPUT-PARAMETERS.                                             
               10  WS-C908-TXT-IN-SIZE       PIC 9(2).                          
               10  WS-C908-TXT-INPUT         PIC X(30).                         
           05  WS-OUTPUT-PARAMETERS.                                            
               10  WS-C908-TXT-OUT-SIZE      PIC 9(2).                          
               10  WS-C908-TXT-OUTPUT        PIC X(40).                         
           05  WS-C908-RETCODE               PIC S9(04)  COMP.                  
                                                                                
       01  WS-RELATIONSHIP.                                                     
           05  WS-APPL-REL OCCURS 12 TIMES.                                     
               10  WS-REL               PIC X(20).                              
                                                                                
       01  WS-APPMT-TIMEB.                                                      
           05  WS-APPMT-HRB                  PIC 9(2)   VALUE 00.               
           05  WS-APPMT-MINB                 PIC 9(2)   VALUE 00.               
                                                                                
       01  WS-OTHER-DATA.                                                       
           05  WS-MCPS1-APPL-ADDR       PIC X(75)  VALUE SPACES.                
           05  WS-SPACES-CNT            PIC 9(02)  VALUE ZEROES.                
           05  WS-FLD-OK                PIC X(71) VALUE SPACES.                 
           05  WS-STOP                  PIC X(01) VALUE SPACES.                 
                                                                                
      *---------------------------------------------------------------*         
      *PRINT 1ST PAGE DETAILS                                                   
      *---------------------------------------------------------------*         
       01  LR48-LINE-BARCODE.                                                   
           05  FILLER                   PIC X(66)  VALUE SPACES.                
           05  LR48-BARCODE-REGN        PIC X(13)  VALUE SPACES.                
                                                                                
       01  LR48-LINE-BARCODE1.                                                  
           05  FILLER                   PIC X(75)  VALUE SPACES.                
           05  LR48-BARCODE1-PREFIX     PIC X(2)   VALUE SPACES.                
           05  LR48-BARCODE1-REGN       PIC X(8)   VALUE SPACES.                
                                                                                
       01  WS-LR48-PRT-VARS.                                                    
                                                                                
           05  LR48-PRT-HDG-A.                                                  
               10  FILLER               PIC X(115)  VALUE SPACES.               
               10  LR48-BROCHURE        PIC X       VALUE SPACES.               
                                                                                
           05  LR48-PRT-HDG-1.                                                  
               10  FILLER               PIC X(73)  VALUE SPACES.                
               10  LR48-MODE-SALE       PIC X(30)  VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-1B.                                                 
               10  FILLER               PIC X(73)  VALUE SPACES.                
               10  LR48-MODE-SALE2      PIC X(30)  VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-1A.                                                 
               10  FILLER               PIC X(73)  VALUE SPACES.                
               10  LR48-DTE-BALLOT      PIC X(08)  VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-2.                                                  
               10  FILLER               PIC X(73)  VALUE SPACES.                
               10  LR48-REGN-NO         PIC X(8)   VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-3.                                                  
               10  FILLER                    PIC X(73)  VALUE SPACES.           
               10  LR48-FLAT-TYPE4B          PIC X(21)  VALUE SPACES.           
                                                                                
           05  LR48-PRT-HDG-3A.                                                 
               10  FILLER                    PIC X(73)  VALUE SPACES.           
               10  LR48-INC-CEILING          PIC X(22)  VALUE SPACES.           
                                                                                
           05  LR48-PRT-HDG-4.                                                  
               10  FILLER                    PIC X(73)  VALUE SPACES.           
               10  LR48-ZONE4D               PIC X(20)  VALUE SPACES.           
                                                                                
           05  LR48-PRT-HDG-5.                                                  
               10  FILLER               PIC X(73)  VALUE SPACES.                
               10  LR48-Q-NO            PIC X(5)   VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-6.                                                  
               10  FILLER                    PIC X(73)  VALUE SPACES.           
               10  LR48-APPMT-DATE           PIC X(11)  VALUE SPACES.           
                                                                                
           05  LR48-PRT-HDG-7.                                                  
               10  FILLER                    PIC X(73)  VALUE SPACES.           
               10  LR48-APPMT-HR             PIC Z9.                            
               10  LR48-APPMT-HR-R       REDEFINES LR48-APPMT-HR                
                                             PIC X(2).                          
               10  LR48-COLON1               PIC X      VALUE SPACES.           
               10  LR48-APPMT-MIN            PIC X(2)   VALUE SPACES.           
               10  FILLER                    PIC X      VALUE SPACES.           
               10  LR48-APPMT-AM-PM          PIC X(2)   VALUE SPACES.           
               10  FILLER                    PIC X(31)  VALUE SPACES.           
                                                                                
           05  LR48-PRT-HDG-7A.                                                 
               10  FILLER               PIC X(73)  VALUE SPACES.                
               10  LR48-REGN-NO-PA      PIC X(8)   VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-8.                                                  
               10  FILLER               PIC X(73)  VALUE SPACES.                
               10  LR48-Q-NO-PA         PIC X(5)   VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-9.                                                  
               10  FILLER                    PIC X(73)  VALUE SPACES.           
               10  LR48-APPMT-DATE-PA        PIC X(11)  VALUE SPACES.           
                                                                                
           05  LR48-PRT-HDG-10.                                                 
               10  FILLER                    PIC X(73)  VALUE SPACES.           
               10  LR48-APPMT-HR-A           PIC Z9.                            
               10  LR48-APPMT-HR-R-A     REDEFINES LR48-APPMT-HR-A              
                                             PIC X(2).                          
               10  LR48-COLON                PIC X      VALUE SPACES.           
               10  LR48-APPMT-MIN-A          PIC X(2)   VALUE SPACES.           
               10  FILLER                    PIC X      VALUE SPACES.           
               10  LR48-APPMT-AM-PM-A        PIC X(2)   VALUE SPACES.           
               10  FILLER                    PIC X(31)  VALUE SPACES.           
                                                                                
           05  LR48-PRT-HDG-6B.                                                 
               10  FILLER               PIC X(30)  VALUE SPACES.                
               10  LR48-Q-NO2           PIC X(5)   VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-6C.                                                 
               10  FILLER               PIC X(38)  VALUE SPACES.                
               10  LR48-Q-NO3           PIC X(5)   VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-11.                                                 
               10  FILLER               PIC X(53)  VALUE SPACES.                
               10  LR48-UNIT-OFFER      PIC X(04)  VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-11A.                                                
               10  FILLER               PIC X(14)  VALUE SPACES.                
               10  LR48-UNIT-OFFER-A    PIC X(04)  VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-JT.                                                 
               10  FILLER               PIC X(11)  VALUE SPACES.                
               10  LR48-REGN-JOINT      PIC X(8)   VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-12.                                                 
               10  FILLER               PIC X(48)  VALUE SPACES.                
               10  LR48-BK-FEE          PIC X(6)   VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-12A.                                                
               10  FILLER               PIC X(06)  VALUE SPACES.                
               10  LR48-BK-FEE-A        PIC X(6)   VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-12B.                                                
               10  FILLER               PIC X(44)  VALUE SPACES.                
               10  LR48-BK-FEE-B        PIC X(6)   VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-8A.                                                 
               10  FILLER               PIC X(38)  VALUE SPACES.                
               10  LR48-PERCENT         PIC X(3)   VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-9A.                                                 
               10  FILLER               PIC X(05)  VALUE SPACES.                
               10  LR48-APPLN-NAME      PIC X(66)  VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-9B.                                                 
               10  FILLER               PIC X(05)  VALUE SPACES.                
               10  LR48-COAPPLN-NAME    PIC X(66)  VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-10A.                                                
               10  FILLER               PIC X(05)  VALUE SPACES.                
               10  LR48-BLK-NO          PIC X(77)  VALUE SPACES.                
               10  FILLER               PIC X(2)   VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-10B.                                                
               10  FILLER               PIC X(05)  VALUE SPACES.                
               10  LR48-NUM-FLAT.                                               
                   15  LR48-CHAR        PIC X      VALUE SPACE.                 
                   15  LR48-LEVEL       PIC X(2)   VALUE SPACES.                
                   15  LR48-DASH        PIC X      VALUE SPACE.                 
                   15  LR48-HSE-MAIN    PIC X(4)   VALUE SPACES.                
                   15  LR48-HSE-SUB     PIC X(3)   VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-10C.                                                
               10  FILLER               PIC X(05)  VALUE SPACES.                
               10  LR48-CODE            PIC X(16)  VALUE SPACES.                
                                                                                
           05  LR48-PRT-HDG-10D.                                                
               10  FILLER               PIC X(05)  VALUE SPACES.                
               10  LR48-DATE            PIC X(11)  VALUE SPACES.                
                                                                                
      *-------------------------------------------------------------            
       01 WS-LR5B-DOC-MAIN-VARS.                                                
      *-------------------------------------------------------------            
          05 LR5B-DOC1-LN-1.                                                    
             10 FILLER                     PIC X(82)  VALUE SPACES.             
             10 LR5B-DOC1-REGN             PIC X(08)  VALUE SPACES.             
                                                                                
          05 LR5B-DOC1-LN-2.                                                    
             10 FILLER                     PIC X(82)  VALUE SPACES.             
             10 LR5B-DOC1-DATE             PIC X(10)  VALUE SPACES.             
                                                                                
          05 LR5B-DOC1-LN-3.                                                    
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 LR5B-DOC1-NME-APPLN1       PIC X(50)  VALUE SPACES.             
             10 FILLER                     PIC X(09)  VALUE SPACES.             
             10 LR5B-DOC1-NRIC1            PIC X(09)  VALUE SPACES.             
                                                                                
          05 LR5B-DOC1-LN-4.                                                    
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 LR5B-DOC1-NME-APPLN2       PIC X(50)  VALUE SPACES.             
             10 FILLER                     PIC X(09)  VALUE SPACES.             
             10 LR5B-DOC1-NRIC2            PIC X(09)  VALUE SPACES.             
                                                                                
          05 LR5B-DOC1-LN-5.                                                    
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 LR5B-DOC1-NME-APPLN3       PIC X(50)  VALUE SPACES.             
             10 FILLER                     PIC X(09)  VALUE SPACES.             
             10 LR5B-DOC1-NRIC3            PIC X(09)  VALUE SPACES.             
                                                                                
          05 LR5B-DOC1-LN-6.                                                    
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 LR5B-DOC1-NME-APPLN4       PIC X(50)  VALUE SPACES.             
             10 FILLER                     PIC X(09)  VALUE SPACES.             
             10 LR5B-DOC1-NRIC4            PIC X(09)  VALUE SPACES.             
                                                                                
          05 LR5B-DOC1-LN-7.                                                    
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 FILLER                     PIC X(13) VALUE                      
                                           'SIGNATURE OF '.                     
             10 LR5B-DOC1-NME-APPLN1A      PIC X(66)  VALUE SPACES.             
                                                                                
          05 LR5B-DOC1-LN-8.                                                    
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 FILLER                     PIC X(13) VALUE                      
                                           'SIGNATURE OF '.                     
             10 LR5B-DOC1-NME-APPLN2A      PIC X(66)  VALUE SPACES.             
                                                                                
          05 LR5B-DOC1-LN-9.                                                    
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 FILLER                     PIC X(13) VALUE                      
                                           'SIGNATURE OF '.                     
             10 LR5B-DOC1-NME-APPLN3A      PIC X(66)  VALUE SPACES.             
                                                                                
          05 LR5B-DOC1-LN-10.                                                   
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 FILLER                     PIC X(13) VALUE                      
                                           'SIGNATURE OF '.                     
             10 LR5B-DOC1-NME-APPLN4A      PIC X(66)  VALUE SPACES.             
                                                                                
          05 LR5B-DOC1-LN-11.                                                   
             10 FILLER                     PIC X(14)  VALUE SPACES.             
             10 FILLER                     PIC X(42)  VALUE ALL '_'.            
                                                                                
          05 LR5B-DOC1-LN-12.                                                   
             10 FILLER                     PIC X(77)  VALUE SPACES.             
             10 LR5B-DOC1-DOC-DUE          PIC X(10)  VALUE SPACES.             
             10 FILLER                     PIC X(01)  VALUE '.'.                
                                                                                
          05 LR5B-DOC1-LN-12A.                                                  
             10 FILLER                     PIC X(79)  VALUE SPACES.             
             10 LR5B-DOC1-DOC-DUE2         PIC X(10)  VALUE SPACES.             
             10 FILLER                     PIC X(01)  VALUE '.'.                
                                                                                
          05 LR5B-DOC1-LN-12B.                                                  
             10 FILLER                     PIC X(26)  VALUE SPACES.             
             10 LR5B-DOC1-DOC-DUE3         PIC X(10)  VALUE SPACES.             
             10 FILLER                     PIC X(01)  VALUE '.'.                
                                                                                
          05 LR5B-DOC1-LN-12C.                                                  
             10 FILLER                     PIC X(11)  VALUE SPACES.             
             10 LR5B-DOC1-DOC-DUE4         PIC X(10)  VALUE SPACES.             
             10 FILLER                     PIC X(01)  VALUE '.'.                
                                                                                
          05 LR5B-EHG-DUE-DATE.                                                 
             10 FILLER                     PIC X(11)  VALUE SPACES.             
             10 LR5B-EHG-DATE              PIC X(10)  VALUE SPACES.             
                                                                                
       01 WS-LR5B-DOC-SUB-VARS.                                                 
      *-------------------------------------------------------------            
          05 LR5B-DOC2-LN-3.                                                    
             10 FILLER                     PIC X(11)  VALUE SPACES.             
             10 LR5B-DOC2-NME-OCCP         PIC X(80)  VALUE SPACES.             
          05 LR5B-DOC2-LN-3A.                                                   
             10 FILLER                     PIC X(11)  VALUE SPACES.             
             10 FILLER                     PIC X(24)  VALUE                     
                   'For AHG/SHG application '.                                  
             10 FILLER                     PIC X(38)  value                     
                   '(All applicants and working occupiers)'.                    
          05 LR5B-DOC2-LN-3B.                                                   
             10 FILLER                     PIC X(11)  VALUE SPACES.             
             10 FILLER                     PIC X(81)  VALUE                     
                                'Completed and Signed Enclosed Forms'.          
          05 LR5B-DOC2-LN-3C.                                                   
             10 FILLER                     PIC X(11)  VALUE SPACES.             
             10 LR5B-SCH-TEXT              PIC X(81)  VALUE SPACES.             
          05 LR5B-DOC2-LN-3D.                                                   
             10 FILLER                     PIC X(11)  VALUE SPACES.             
             10 FILLER                     PIC X(20)  VALUE                     
                   'For EHG application '.                                      
             10 FILLER                     PIC X(38)  value                     
                   '(All applicants and working occupiers)'.                    
                                                                                
          05 LR5B-DOC2-LN-3E.                                                   
             10 FILLER                     PIC X(11)  VALUE SPACES.             
             10 LR5B-HFE-DEFER             PIC X(85)  VALUE SPACES.             
                                                                                
          05 LR5B-DOC2-LN-4.                                                    
             10 FILLER                     PIC X(15)  VALUE SPACES.             
             10 LR5B-DOC2-DOCUMENT         PIC X(81)  VALUE SPACES.             
          05 LR5B-DOC2-LN-4A.                                                   
             10 FILLER                     PIC X(13)  VALUE SPACES.             
             10 LR5B-DOC2-INC-START        PIC X(08)  VALUE SPACES.             
             10 FILLER                     PIC X(09)  VALUE SPACES.             
             10 LR5B-DOC2-INC-END          PIC X(08)  VALUE SPACES.             
             10 FILLER                     PIC X(51)  VALUE SPACES.             
          05 LR5B-DOC2-LN-5.                                                    
             10 FILLER                     PIC X(12)  VALUE SPACES.             
             10 LR5B-DOC2-BLANK-LINE       PIC X(77)  VALUE ALL '_'.            
          05 LR5B-DOC2-COPY.                                                    
             10 FILLER                     PIC X(78)  VALUE SPACES.             
             10 FILLER                     PIC X(07)  VALUE                     
                                           'C O P Y'.                           
                                                                                
      *--------------------------------------------------------------*          
      *DECLARATION FORM VARS                                                    
      *--------------------------------------------------------------*          
       01  P89DA-LINE7B.                                                        
           05  FILLER                    PIC X(11)  VALUE SPACES.               
           05  P89DA-NAME1A              PIC X(36)  VALUE SPACES.               
           05  FILLER                    PIC X(05)  VALUE SPACES.               
           05  P89DA-NAME1B              PIC X(36)  VALUE SPACES.               
           05  FILLER                    PIC X(03)  VALUE SPACES.               
                                                                                
       01  P89DA-LINE7C.                                                        
           05  FILLER                    PIC X(11)  VALUE SPACES.               
           05  P89DA-NAME1C              PIC X(36)  VALUE SPACES.               
           05  FILLER                    PIC X(05)  VALUE SPACES.               
           05  P89DA-NAME1D              PIC X(36)  VALUE SPACES.               
                                                                                
      *------------------------------------------------------------*            
      *  1ST PAGE OF THE LETTER                                    *            
      *------------------------------------------------------------*            
                                                                                
        01  DJDE-LINE-PAGE1                PIC X(80)  VALUE                     
            '$DJDE$ JDE=13C24U,FORMS=BP13GA,COPIES=1,COLLATE=YES,JDL=BP1        
      -     '3,END;'.                                                           
                                                                                
        01  DJDE-LINE-PAGE1-CCA            PIC X(80)  VALUE                     
            '$DJDE$ JDE=13C24U,FORMS=BP13A7,COPIES=1,COLLATE=YES,JDL=BP1        
      -     '3,END;'.                                                           
                                                                                
        01  DJDE-LINE-PAGE1-CCA-JT         PIC X(80)  VALUE                     
            '$DJDE$ JDE=13C24U,FORMS=BP13A8,COPIES=1,COLLATE=YES,JDL=BP1        
      -     '3,END;'.                                                           
                                                                                
        01  DJDE-LINE-BTO-S2D-NEW          PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP135K,END;'.                                         
                                                                                
        01  DJDE-LINE-BTO-S2E-NEW          PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP13H9,END;'.                                         
                                                                                
        01  DJDE-LINE-BTO-S2F-NEW          PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP135K,END;'.                                         
                                                                                
        01  DJDE-BLANKF                    PIC X(80)   VALUE                    
           '$DJDE$ PMODE=PORTRAIT,FORMS=BLANKF,SHIFT=(0,0),END;'.               
                                                                                
        01  DJDE-LINE-COVID                PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP1309,END;'.                                         
                                                                                
      *------------------------------------------------------------*            
      *  REPORT LAYOUT                                             *            
      *------------------------------------------------------------*            
       01  L89DA-HEADER.                                                        
           05  FILLER                     PIC X(06) VALUE SPACES.               
           05  FILLER                     PIC X(36) VALUE                       
               'LIST OF ELDERLY APPLICANTS INVITED. '.                          
           05  FILLER                     PIC X(10) VALUE SPACES.               
           05  L89DA-DATE                 PIC X(10) VALUE SPACES.               
                                                                                
       01  L89DA-HEADER1.                                                       
           05  FILLER                     PIC X(06) VALUE SPACES.               
           05  FILLER                     PIC X(80) VALUE                       
               'S/NO   REGISTRATION NO.   QUEUE NO(PA/GRO)  QUEUE NO(MGP        
      -         'S)'.                                                           
       01  L89DA-HEADER2.                                                       
           05  FILLER                     PIC X(06) VALUE SPACES.               
           05  FILLER                     PIC X(80) VALUE                       
               '                          (GRO/PA).   (MGPS)'.                  
                                                                                
       01  L89DA-UNDERLINE.                                                     
           05  FILLER                     PIC X(06) VALUE SPACES.               
           05  FILLER                     PIC X(80) VALUE                       
               '--------------------------------------------------------        
      -        '-----------'.                                                   
                                                                                
       01  L89DA-DATA.                                                          
           05  FILLER                     PIC X(6)  VALUE SPACES.               
           05  L89DA-SN                   PIC ZZZ9.                             
           05  FILLER                     PIC X(3)  VALUE ')  '.                
           05  FILLER                     PIC X(3)  VALUE SPACES.               
           05  L89DA-REGN-NO              PIC X(8).                             
           05  FILLER                     PIC X(14) VALUE SPACES.               
           05  L89DA-NUM-QUEUE            PIC X(05).                            
           05  FILLER                     PIC X(15) VALUE SPACES.               
           05  L89DA-NUM-QUEUE-MGPS       PIC X(05).                            
           05  FILLER                     PIC X(20) VALUE SPACES.               
                                                                                
      *------------------------------------------------------------*            
      *  SEND DJDE LINE FOR LETTERS                                *            
      *------------------------------------------------------------*            
       01  DJDE-DOC-SUB-FORM              PIC X(130) VALUE                      
           '$DJDE$ FORMS=BP13HC,FONT=(R7TICP,R7TICP,R7TICP,RB12BP),BEGIN        
      -    '=(0.50,0.00),BOF=68,END;'.                                          
                                                                                
       01  DJDE-DOC-SUB-FORM2             PIC X(130) VALUE                      
           '$DJDE$ FORMS=BP130M,FONT=(R7TICP,R7TICP,R7TICP,RB12BP),BEGIN        
      -    '=(0.50,0.00),BOF=68,END;'.                                          
                                                                                
       01  DJDE-DOC-SUB-FORM3             PIC X(130) VALUE                      
           '$DJDE$ FORMS=BP13HD,FONT=(R7TICP,R7TICP,R7TICP,RB12BP),BEGIN        
      -    '=(0.50,0.00),BOF=68,END;'.                                          
                                                                                
      *01  DJDE-DOC-SUB-FORM10            PIC X(130) VALUE                      
      *    '$DJDE$ FORMS=BP13BY,FONT=(R7TICP,R7TICP,R7TICP,RB12BP),BEGIN        
      *    '=(0.50,0.00),BOF=68,END;'.                                          
                                                                                
       01  DJDE-DOC-SUB-FORM16            PIC X(130) VALUE                      
           '$DJDE$ FORMS=BP13B7,FONT=(R7TICP,R7TICP,R7TICP,RB12BP),BEGIN        
      -    '=(0.50,0.00),BOF=68,END;'.                                          
                                                                                
       01  DJDE-DOC-SUB-FORM17            PIC X(130) VALUE                      
           '$DJDE$ FORMS=BP13B8,FONT=(R7TICP,R7TICP,R7TICP,RB12BP),BEGIN        
      -    '=(0.50,0.00),BOF=68,END;'.                                          
                                                                                
       01  DJDE-DOC-SUB-FORM18            PIC X(130) VALUE                      
           '$DJDE$ FORMS=BP13B9,FONT=(R7TICP,R7TICP,R7TICP,RB12BP),BEGIN        
      -    '=(0.50,0.00),BOF=68,END;'.                                          
                                                                                
      * 01  DJDE-BLANKF                   PIC X(80)   VALUE                     
      *    '$DJDE$ FORMS=BLANKF,SHIFT=(0,0),END;'.                              
                                                                                
      *------------------------------------------------------*                  
      *    DECLARATION AND CPF AUTHORISATION                 *                  
      *------------------------------------------------------*                  
       01  DJDE-BP130U                   PIC X(130) VALUE                       
           '$DJDE$ FORMS=BP130U,FONT=(R7TICP,R7TICP,R7TICP,RB12BP),BEGIN        
      -    '=(0.90,0.00),END;'.                                                 
                                                                                
       01  DJDE-BP130V                   PIC X(130) VALUE                       
           '$DJDE$ FORMS=BP130V,FONT=(R7TICP,R7TICP,R7TICP,RB12BP),BEGIN        
      -    '=(0.90,0.00),END;'.                                                 
                                                                                
       01  DJDE-BP130W                   PIC X(130) VALUE                       
           '$DJDE$ FORMS=BP130W,FONT=(R7TICP,R7TICP,R7TICP,RB12BP),BEGIN        
      -    '=(0.90,0.00),END;'.                                                 
                                                                                
      *                                                                         
        01  DJDE-LINE-BTO-S2C              PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP135D,END;'.                                         
                                                                                
        01  DJDE-LINE-SBF-SA               PIC X(80)  VALUE                     
            '$DJDE$ JDE=13C24U,FORMS=BP134B,COPIES=1,COLLATE=YES,JDL=BP1        
      -     '3,END;'.                                                           
                                                                                
        01  DJDE-LINE-SBF-NSA              PIC X(80)  VALUE                     
            '$DJDE$ JDE=13C24U,FORMS=BP134C,COPIES=1,COLLATE=YES,JDL=BP1        
      -     '3,END;'.                                                           
                                                                                
        01  DJDE-LINE-BTO-S2-NEW           PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP13G8,END;'.                                         
                                                                                
        01  DJDE-LINE-BTO-S2B-NEW          PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP13GY,END;'.                                         
                                                                                
        01  DJDE-LINE-BTO-S2-CCA           PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP13A9,END;'.                                         
                                                                                
        01  DJDE-LINE-BTO-S2-CCA2         PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13J9,END;'.                                         
                                                                                
        01  DJDE-LINE-BTO-S2C-NEW          PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP13GZ,END;'.                                         
                                                                                
        01  DJDE-LINE-SBF-S2D              PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP134D,END;'.                                         
                                                                                
        01  DJDE-LINE-BTO-S2               PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP13ZU,END;'.                                         
                                                                                
        01  DJDE-LINE-BTO-S2B              PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP133V,END;'.                                         
                                                                                
        01  DJDE-LINE-GRO-SA-NEW           PIC X(80)  VALUE                     
            '$DJDE$ JDE=13C24U,FORMS=BP1351,COPIES=1,COLLATE=YES,JDL=BP1        
      -     '3,END;'.                                                           
                                                                                
        01  DJDE-LINE-GRO-SB-NEW           PIC X(80)  VALUE                     
            '$DJDE$ JDE=13C24U,FORMS=BP1353,COPIES=1,COLLATE=YES,JDL=BP1        
      -     '3,END;'.                                                           
                                                                                
        01  DJDE-LINE-GRO-SC-NEW           PIC X(80)  VALUE                     
            '$DJDE$ JDE=13C24U,FORMS=BP1354,COPIES=1,COLLATE=YES,JDL=BP1        
      -     '3,END;'.                                                           
                                                                                
        01  DJDE-LINE-GRO-SD-NEW           PIC X(80)  VALUE                     
            '$DJDE$ JDE=13C24U,FORMS=BP1358,COPIES=1,COLLATE=YES,JDL=BP1        
      -     '3,END;'.                                                           
                                                                                
        01  DJDE-LINE-MGP-SA-NEW           PIC X(80)  VALUE                     
            '$DJDE$ JDE=13C24U,FORMS=BP1350,COPIES=1,COLLATE=YES,JDL=BP1        
      -     '3,END;'.                                                           
                                                                                
        01  DJDE-LINE-MGP-SB-NEW           PIC X(80)  VALUE                     
            '$DJDE$ JDE=13C24U,FORMS=BP1352,COPIES=1,COLLATE=YES,JDL=BP1        
      -     '3,END;'.                                                           
                                                                                
        01  DJDE-LINE-MGP-SC-NEW           PIC X(80)  VALUE                     
            '$DJDE$ JDE=13C24U,FORMS=BP135O,COPIES=1,COLLATE=YES,JDL=BP1        
      -     '3,END;'.                                                           
                                                                                
        01  DJDE-LINE-MGP-SD-NEW           PIC X(80)  VALUE                     
            '$DJDE$ JDE=13C24U,FORMS=BP1357,COPIES=1,COLLATE=YES,JDL=BP1        
      -     '3,END;'.                                                           
                                                                                
        01  DJDE-LINE-MGP-S2-NEW           PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP13G7,END;'.                                         
                                                                                
        01  DJDE-LINE-MGP-S2B-NEW          PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP13G5,END;'.                                         
                                                                                
        01  DJDE-LINE-MGP-S2C-NEW          PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP13G6,END;'.                                         
                                                                                
        01  DJDE-LINE-MGP-S2D              PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP13G6,END;'.                                         
                                                                                
        01  DJDE-LINE-GRO-S2B-NEW          PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP13GI,END;'.                                         
                                                                                
        01  DJDE-LINE-GRO-S2C-NEW          PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP133Y,END;'.                                         
                                                                                
        01  DJDE-LINE-GRO-S2F-NEW          PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP13VR,END;'.                                         
                                                                                
        01  DJDE-LINE-GRO-S2D              PIC X(80)  VALUE                     
            '$DJDE$ FORMS=BP133Y,END;'.                                         
                                                                                
       01  DJDE-EHG-FORM1                 PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP1366,END;'.                                         
                                                                                
       01  DJDE-EHG-FORM2                 PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP1367,END;'.                                         
                                                                                
       01  DJDE-EHG-FORM3                 PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP1369,END;'.                                         
                                                                                
       01  DJDE-EHG-FORM4                 PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP136B,END;'.                                         
                                                                                
       01  DJDE-EHG-FORM5                 PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP136C,END;'.                                         
                                                                                
       01  DJDE-EHG-FORM6                 PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP136J,END;'.                                         
                                                                                
       01  DJDE-EHG-FORM7                 PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP136P,END;'.                                         
                                                                                
       01  DJDE-EHG-FORM8                 PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP136Q,END;'.                                         
                                                                                
       01  DJDE-EHG-FORM9                 PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP135X,END;'.                                         
                                                                                
       01  DJDE-EHG-FORM6-NEW             PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13J1,END;'.                                         
                                                                                
       01  DJDE-EHG-FORM7-NEW             PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13J2,END;'.                                         
                                                                                
       01  DJDE-EHG-FORM8-NEW             PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13J3,END;'.                                         
                                                                                
       01  DJDE-EHG-FORM9-NEW             PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13J4,END;'.                                         
                                                                                
       01  DJDE-EHG-FORM10                PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13J5,END;'.                                         
                                                                                
       01  DJDE-CCA-BSP1                  PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13C1,END;'.                                         
                                                                                
       01  DJDE-CCA-BSP2                  PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13C2,END;'.                                         
                                                                                
       01  DJDE-CCA-BSP3                  PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13C3,END;'.                                         
                                                                                
       01  DJDE-CCA-BSP4                  PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13C4,END;'.                                         
                                                                                
       01  DJDE-CCA-BSP5                  PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13C5,END;'.                                         
                                                                                
       01  DJDE-CCA-BSP6                  PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13C6,END;'.                                         
                                                                                
       01  DJDE-CCA-BSP7                  PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13C7,END;'.                                         
                                                                                
       01  DJDE-CCA-BSP8                  PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13C8,END;'.                                         
                                                                                
       01  DJDE-CCA-BSP9                  PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13ZR,END;'.                                         
                                                                                
       01  DJDE-CCA-BSP10                 PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13ZD,END;'.                                         
                                                                                
       01  DJDE-CCA-BSP11                 PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13ZE,END;'.                                         
                                                                                
       01  DJDE-CCA-BSP12                 PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13ZF,END;'.                                         
                                                                                
       01  DJDE-CCA-BSP13                 PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13ZH,END;'.                                         
                                                                                
       01  DJDE-CCA-BSP14                 PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13ZI,END;'.                                         
                                                                                
       01  DJDE-CCA-BSP15                 PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13ZJ,END;'.                                         
                                                                                
       01  DJDE-CCA-BSP16                 PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13ZC,END;'.                                         
                                                                                
       01  DJDE-CCA-BSP17                 PIC X(80)  VALUE                      
            '$DJDE$ FORMS=BP13Z0,END;'.                                         
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
      ************************************************************              
       0000-MAIN.                                                               
      ************************************************************              
           PERFORM 1000-OPEN-ROUTINE   THRU 1000-EXIT.                          
           PERFORM 2000-READ-BP13F200  THRU 2000-EXIT.                          
           PERFORM 2500-READ-BP13F205  THRU 2500-EXIT.                          
           PERFORM 3000-PROCESS-RECORD THRU 3000-EXIT                           
             UNTIL WS-F200-EOF = 'Y'.                                           
           IF WS-BLANK-PRINTED NOT = 'Y'                                        
              MOVE  SPACES         TO    P13P89DA-REC                           
              WRITE P13P89DA-REC FROM DJDE-BLANKF AFTER PAGE                    
              WRITE P13P89DA-REC AFTER 5                                        
           END-IF.                                                              
           PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT.                           
                                                                                
       0000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ************************************************************              
       1000-OPEN-ROUTINE.                                                       
      ************************************************************              
           OPEN INPUT  BP13F200                                                 
                       BP13F205                                                 
                       BP13K060                                                 
                       BP13K062                                                 
                       BP13K813                                                 
                       BP13K757                                                 
                       BP13K800                                                 
                       BP13K820                                                 
                       BP13K830                                                 
                       BP13K246                                                 
                       BP13K76D                                                 
                       BP13K734                                                 
                       BP13K200                                                 
                       BP04K010                                                 
                OUTPUT P13P89DA                                                 
                       P13L89DA.                                                
                                                                                
           IF WS-K060-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K060 OPEN ERROR, STATUS ' WS-K060-STATUS             
              MOVE WS-K060-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K062-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K062 OPEN ERROR, STATUS ' WS-K062-STATUS             
              MOVE WS-K062-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K813-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K813 OPEN ERROR, STATUS ' WS-K813-STATUS             
              MOVE WS-K813-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K757-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K757 OPEN ERROR, STATUS ' WS-K757-STATUS             
              MOVE WS-K757-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K800 OPEN ERROR, STATUS ' WS-K800-STATUS             
              MOVE WS-K800-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K820-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K820 OPEN ERROR, STATUS ' WS-K820-STATUS             
              MOVE WS-K820-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K830-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K830 OPEN ERROR, STATUS ' WS-K830-STATUS             
              MOVE WS-K830-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K246-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K246 OPEN ERROR, STATUS ' WS-K246-STATUS             
              MOVE WS-K246-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K76D-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K76D OPEN ERROR, STATUS ' WS-K76D-STATUS             
              MOVE WS-K76D-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K734-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K76D OPEN ERROR, STATUS ' WS-K76D-STATUS             
              MOVE WS-K76D-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K200-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K200 OPEN ERROR, STATUS ' WS-K200-STATUS             
              MOVE WS-K200-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K010-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP04K010 OPEN ERROR, STATUS ' WS-K010-STATUS             
              MOVE WS-K010-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           MOVE SPACES                     TO BE01W812-INPUT-INFO.              
           MOVE 'OPENS'                    TO BE01W812-IN-RTN-FXN.              
           CALL 'BE01C812' USING BE01W812-COMMAREA.                             
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-CURRENT-DATE.                  
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-DATE.                          
                                                                                
           STRING WS-CURRENT-DATE(7:2) '/'                                      
                  WS-CURRENT-DATE(5:2) '/'                                      
                  WS-CURRENT-DATE(1:4)                                          
                  DELIMITED BY SIZE                                             
             INTO WS-CURR-DATE.                                                 
                                                                                
           MOVE SPACES  TO P13P89DA-REC.                                        
           WRITE    P13P89DA-REC AFTER PAGE.                                    
           MOVE SPACES  TO P13L89DA-REC.                                        
      *    WRITE    P13L89DA-REC AFTER PAGE.                                    
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ************************************************************              
       2000-READ-BP13F200.                                                      
      ************************************************************              
           READ BP13F200                                                        
             AT END                                                             
                MOVE 'Y'                 TO WS-F200-EOF                         
            NOT AT END                                                          
                ADD 1                    TO WS-F200-READ-CNT                    
           END-READ.                                                            
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ************************************************************              
       2500-READ-BP13F205.                                                      
      ************************************************************              
                                                                                
           READ BP13F205                                                        
             AT END                                                             
                MOVE 'Y'                 TO WS-F205-EOF                         
           END-READ.                                                            
                                                                                
       2500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       3000-PROCESS-RECORD.                                                     
      ************************************************************              
           PERFORM 3100-INITIALIZE     THRU 3100-EXIT.                          
                                                                                
           MOVE F200-NUM-REGN TO K800-NUM-REGN.                                 
           PERFORM 3200-READ-BP13K800  THRU 3200-EXIT.                          
           IF WS-K800-FND = 'N'                                                 
              DISPLAY 'NOT FOUND K800-NUM-REGN: ' K800-NUM-REGN                 
              ADD 1 TO WS-K800-NFND-CNT                                         
              PERFORM 2000-READ-BP13F200 THRU 2000-EXIT                         
              GO TO 3000-EXIT                                                   
           ELSE                                                                 
              IF (K800-NUM-ALLO-CAT NOT = 'ROF') AND                            
                 (K800-NUM-FLAT-TYPE = '2F' OR '1F') AND                        
                 (K800-DTE-BALLOT >= '201909') AND                              
                 (K800-NUM-ELDERLY = 'S' OR 'F')                                
                 ADD 1 TO WS-ELDERLY-CNT                                        
                 MOVE K800-NUM-ALLO-CAT      TO K76D-NUM-SALES-MODE             
                 MOVE K800-DTE-BALLOT        TO K76D-NUM-DTE-BALLOT             
                 MOVE K800-NUM-REGN          TO K76D-NUM-REGN                   
                 PERFORM 3150-READ-BP13K76D  THRU 3150-EXIT                     
                 IF WS-K76D-FND = 'Y'                                           
                    DISPLAY 'REC FOUND K76D-KEY-FLD: ' K76D-KEY-FLD             
                    ADD 1 TO WS-K76D-FND-CNT                                    
                    PERFORM 2000-READ-BP13F200 THRU 2000-EXIT                   
                    GO TO 3000-EXIT                                             
                 ELSE                                                           
                    DISPLAY 'NOT FOUND K76D-KEY-FLD: ' K76D-KEY-FLD             
                    ADD 1 TO WS-K76D-NFND-CNT                                   
                 END-IF                                                         
                 DISPLAY 'FOUND K800-NUM-REGN: ' K800-NUM-REGN                  
                 ADD 1 TO WS-K800-FND-CNT                                       
                                                                                
                 IF (K800-DTE-BALLOT >= '202305') AND                           
                    (K800-NUM-ALLO-CAT NOT = 'SER') AND                         
                    (K800-NUM-PORT-ELIG-TAG NOT = 'P' AND 'Y')                  
                     MOVE 'Y' TO WS-HFE                                         
                 ELSE                                                           
                     MOVE 'N' TO WS-HFE                                         
                 END-IF                                                         
                                                                                
                 MOVE F200-NUM-REGN            TO WS-C398-NUM-REGN              
                 PERFORM 3300-GET-LETTER-DATE       THRU 3300-EXIT              
                 MOVE 'N'             TO WS-K820-FND                            
                 MOVE ZEROES          TO WS-C398-LETTER-CNT                     
                                                                                
                 IF K800-NUM-ALLO-CAT = 'ROF' OR 'OBF'                          
                    MOVE SPACES       TO WS-AHG-APPLN                           
                 ELSE                                                           
                    IF K800-NUM-ALLO-SCHEME = 'FTS' AND                         
                      (K800-NUM-ELIG-SCHEME = 'SSC' OR 'JSS' OR 'NCS')          
                      AND                                                       
                      (K800-NUM-FLAT-TYPE = '2 ' OR '2F')                       
                      MOVE 'Y'          TO WS-AHG-APPLN                         
                    END-IF                                                      
                                                                                
                    IF K800-NUM-FT2T = 'Y'                                      
                      IF K800-NUM-FLAT-TYPE = '2 ' OR '3 ' OR '4 ' OR   P'      
                                      '3P' OR '2F' OR '5 ' OR 'E '              
                         MOVE 'Y'          TO WS-AHG-APPLN                      
                      END-IF                                                    
                    END-IF                                                      
                                                                                
                    IF (K800-NUM-HOUSEHOLD = 'H') AND                           
                       (K800-NUM-ALLO-SCHEME NOT = 'FTS') AND                   
                       (K800-NUM-ELIG-SCHEME = 'PA ' OR 'FS ' OR 'SI '          
                                               OR 'TCP')                        
                      IF K800-NUM-FLAT-TYPE = '2 ' OR '3 ' OR '4 ' OR           
                                      '3P' OR '2F' OR '5 ' OR 'E '              
                         MOVE 'Y'    TO WS-AHG-APPLN                            
                      END-IF                                                    
                    END-IF                                                      
                 END-IF                                                         
                                                                                
                 IF K800-NUM-MGPS = 'P' OR 'C'                                  
                    IF F200-DTE-BKAPPMT-DATE-MGPS NOT = SPACES AND              
                                                        LOW-VALUES              
                       MOVE F200-DTE-BKAPPMT-DATE-MGPS                          
                                             TO  WS-DTE-BK-APPT                 
                    ELSE                                                        
                       MOVE K800-DTE-BK-APPT-MGPS TO  WS-DTE-BK-APPT            
                    END-IF                                                      
                 ELSE                                                           
                    IF F200-DTE-BKAPPMT-DATE NOT = SPACES AND LOW-VALUES        
                       MOVE F200-DTE-BKAPPMT-DATE                               
                                            TO  WS-DTE-BK-APPT                  
                    ELSE                                                        
                       MOVE K800-DTE-BK-APPT   TO  WS-DTE-BK-APPT               
                    END-IF                                                      
                 END-IF                                                         
                                                                                
                 IF WS-DTE-BK-APPT IS NUMERIC                                   
                    COMPUTE WS-DTE-DUE =                                        
                            FUNCTION INTEGER-OF-DATE (WS-DTE-BK-APPT)           
                    COMPUTE WS-DTE-DUE = WS-DTE-DUE - 7                         
                                                                                
                    COMPUTE WS-DTE-DOC-DUE =                                    
                            FUNCTION DATE-OF-INTEGER (WS-DTE-DUE)               
                                                                                
                    MOVE WS-DTE-DOC-DUE     TO WS-AHG-DOC-DUE                   
                 ELSE                                                           
                    MOVE ZEROES             TO WS-AHG-DOC-DUE                   
                 END-IF                                                         
                                                                                
                 MOVE SPACES          TO WS-ARRAY-VARIABLES                     
                 MOVE ZEROES          TO WS-NRIC-CNT                            
                                         WS-IDX2                                
                                         WS-IDX3                                
                 MOVE LOW-VALUES      TO K820-KEY-FLD                           
                 MOVE K800-NUM-REGN   TO K820-NUM-REGN                          
                                         WS-NUM-REGN                            
                 PERFORM 3400-PROCESS-BP13K820      THRU 3400-EXIT              
                 PERFORM 4100-WRITE-REPORT          THRU 4100-EXIT              
                 MOVE SPACES                   TO BP13K757-REC                  
                 INITIALIZE                       BP13K757-REC                  
                 MOVE F200-NUM-REGN            TO K757-NUM-REGN                 
      *          PERFORM 4000-APPLN-HSELOAN-LET  THRU 4000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 2000-READ-BP13F200 THRU 2000-EXIT.                           
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ************************************************************              
       3100-INITIALIZE.                                                         
      ************************************************************              
           MOVE  ZEROS      TO WS-APPL-CNT                                      
                               WS-REGN-PAGE-CNT.                                
           MOVE   4         TO WS-OCCP-CNT.                                     
           MOVE   'N'       TO WS-K820-EOF                                      
                               WS-HFE-DEFER                                     
                               WS-AGE-GT55.                                     
           MOVE  SPACES     TO WS-C398-LTR-VARS.                                
           INITIALIZE          WS-C398-LTR-VARS.                                
           MOVE  SPACES     TO WS-C398-LTR-VARS2.                               
           INITIALIZE          WS-C398-LTR-VARS2.                               
           MOVE  1          TO L89DA-SN.                                        
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       3150-READ-BP13K76D.                                                      
      ************************************************************              
           READ BP13K76D.                                                       
           EVALUATE WS-K76D-STATUS                                              
             WHEN   00                                                          
                    MOVE 'Y'      TO WS-K76D-FND                                
             WHEN   23                                                          
                    MOVE 'N'      TO WS-K76D-FND                                
             WHEN   OTHER                                                       
                    DISPLAY 'READ BP13K76D ERROR ' K76D-NUM-REGN                
                    DISPLAY 'STATUS ' WS-K800-STATUS                            
                    MOVE WS-K76D-STATUS TO RETURN-CODE                          
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
                                                                                
           END-EVALUATE.                                                        
                                                                                
       3150-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       3200-READ-BP13K800.                                                      
      ************************************************************              
           READ BP13K800.                                                       
           EVALUATE WS-K800-STATUS                                              
             WHEN   00                                                          
                    IF K800-NUM-STATUS = 'C'                                    
                       MOVE 'N'      TO WS-K800-FND                             
                       MOVE SPACES   TO WS-PAIRED-REGN                          
                                        WS-C398-NUM-REGN-PAIRED                 
                    ELSE                                                        
                       MOVE 'Y'      TO WS-K800-FND                             
                       MOVE K800-NUM-JT-BALLOT-REGN   TO WS-PAIRED-REGN         
                                        WS-C398-NUM-REGN-PAIRED                 
                    END-IF                                                      
             WHEN   23                                                          
                    MOVE 'N'         TO WS-K800-FND                             
                    MOVE SPACES      TO WS-PAIRED-REGN                          
                                        WS-C398-NUM-REGN-PAIRED                 
             WHEN   OTHER                                                       
                    DISPLAY 'READ BP13K800 ERROR ' K800-NUM-REGN                
                    DISPLAY 'STATUS ' WS-K800-STATUS                            
                    MOVE WS-K800-STATUS TO RETURN-CODE                          
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
                                                                                
           END-EVALUATE.                                                        
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       3300-GET-LETTER-DATE.                                                    
      ************************************************************              
                                                                                
           MOVE F200-DTE-ALLOC      TO   WS-DTE-LETTER.                         
                                                                                
           IF WS-DTE-LETTER = ZEROES                                            
              MOVE  SPACES          TO   WS-C398-PRT-DATE                       
           ELSE                                                                 
              MOVE F205-DTE-REQUEST       TO WS-DTE-LETTER                      
              IF K800-NUM-MGPS = 'P' OR 'C'                                     
                 IF F200-DTE-BKAPPMT-DATE-MGPS NOT = SPACES AND                 
                                                     LOW-VALUES                 
                    MOVE F200-DTE-BKAPPMT-DATE-MGPS                             
                                          TO  WS-DTE-LETTER-2                   
                 ELSE                                                           
                    MOVE K800-DTE-BK-APPT-MGPS TO WS-DTE-LETTER-2               
                 END-IF                                                         
              ELSE                                                              
                 IF F200-DTE-BKAPPMT-DATE NOT = SPACES AND LOW-VALUES           
                    MOVE F200-DTE-BKAPPMT-DATE                                  
                                         TO  WS-DTE-LETTER-2                    
                 ELSE                                                           
                    MOVE K800-DTE-BK-APPT   TO  WS-DTE-LETTER-2                 
                 END-IF                                                         
              END-IF                                                            
                                                                                
              IF WS-DTE-LETTER-2 IS NUMERIC                                     
                 COMPUTE WS-NUM-DTE-LETTER =                                    
                         FUNCTION INTEGER-OF-DATE(WS-DTE-LETTER-2)              
                 SUBTRACT 14         FROM   WS-NUM-DTE-LETTER                   
                 COMPUTE WS-DTE-LETTER-2 =                                      
                         FUNCTION DATE-OF-INTEGER(WS-NUM-DTE-LETTER)            
                 IF WS-DTE-LETTER-2 > F205-DTE-REQUEST                          
                    STRING WS-DTE-LETTER-2(7:2) '/'                             
                           WS-DTE-LETTER-2(5:2) '/'                             
                           WS-DTE-LETTER-2(1:4)                                 
                           DELIMITED BY SIZE INTO WS-C398-PRT-DATE              
                 ELSE                                                           
                    STRING F205-DTE-REQUEST(7:2) '/'                            
                           F205-DTE-REQUEST(5:2) '/'                            
                           F205-DTE-REQUEST(1:4)                                
                           DELIMITED BY SIZE INTO WS-C398-PRT-DATE              
                 END-IF                                                         
              ELSE                                                              
                 MOVE SPACES      TO WS-C398-PRT-DATE                           
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       3400-PROCESS-BP13K820.                                                   
      ************************************************************              
                                                                                
           PERFORM 3410-START-BP13K820    THRU 3410-EXIT.                       
                                                                                
           IF WS-K820-FND = 'Y'                                                 
              IF K800-NUM-ALLO-SCHEME =  'MCP'                                  
                 MOVE   'Y'     TO WS-C398-MCPS-FRM                             
              END-IF                                                            
                                                                                
              IF (K800-NUM-ALLO-SCHEME =  'SAP'  AND                            
                 (K800-CDE-MCPS = 'M' OR 'C' OR 'P' OR 'B'))                    
                 MOVE   'S'     TO WS-C398-MCPS-FRM                             
              END-IF                                                            
                                                                                
              IF K800-NUM-FLAT-TYPE = '4P' OR '5P' OR 'SP'                      
                 MOVE   'Y'     TO WS-C398-MGLS-FRM                             
              END-IF                                                            
                                                                                
              IF K800-NUM-APPS NOT = SPACES AND LOW-VALUES                      
                 IF K800-NUM-APPS-ELIG-TAG NOT = 'P' AND 'H'                    
                     MOVE   'Y'       TO                                        
                             WS-C398-APPS-CERTF                                 
                 END-IF                                                         
              END-IF                                                            
                                                                                
              MOVE SPACES   TO  WS-HA1-WSP-STAT                                 
              IF K800-NUM-NRIC2 = SPACES OR LOW-VALUES                          
                 IF (WS-C398-DEATH-CERTF(1) = 'Y' OR                            
                    (WS-C398-DIVORCE-CERTF(1) = 'Y' OR 'S'))                    
                    MOVE 'Y'    TO  WS-HA1-WSP-STAT                             
                 END-IF                                                         
              END-IF                                                            
                                                                                
              MOVE SPACES   TO  WS-OC1-GT21                                     
              IF WS-C398-NRIC(6) = SPACES OR LOW-VALUES                         
                 IF WS-C398-AGE-OCCUPIER(5) >= 21                               
                     MOVE 'Y'  TO WS-OC1-GT21                                   
                 END-IF                                                         
              END-IF                                                            
                                                                                
              MOVE   '1'    TO  WS-C398-ESS-MBRS                                
                                                                                
              IF F200-DTE-BALLOT >= '201808'                                    
                 IF K800-NUM-ALLO-SCHEME = 'PA '                                
                    IF WS-HA1-WSP-STAT = 'Y' AND                                
                       WS-OC1-GT21     = 'Y'                                    
                       MOVE '2'    TO WS-C398-ESS-MBRS                          
                    ELSE                                                        
                       MOVE '1'    TO WS-C398-ESS-MBRS                          
                    END-IF                                                      
                 ELSE                                                           
                    IF K800-NUM-ALLO-SCHEME = 'FSH'                             
                       IF WS-HA1-WSP-STAT = 'Y' AND                             
                          WS-OC1-GT21     = 'Y'                                 
                          MOVE '4' TO WS-C398-ESS-MBRS                          
                       ELSE                                                     
                          MOVE '3' TO WS-C398-ESS-MBRS                          
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
                 IF K800-NUM-ALLO-SCHEME = 'FTS' OR 'STS' OR 'SAP'              
                    IF K800-NUM-ELIG-SCHEME = 'SSC' OR 'SSE' OR                 
                                              'NCS' OR 'NSC'                    
                       MOVE SPACES TO WS-C398-ESS-MBRS                          
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
                                                                                
              IF K800-NUM-ELIG-SCHEME = 'OR '                                   
                 MOVE  'Y'  TO  WS-C398-ORPHANS-DECL                            
              END-IF                                                            
                                                                                
              IF K800-NUM-APPLN-TYPE = 'I'                                      
                 MOVE  'Y'  TO  WS-C398-APPLN-FRM                               
              END-IF                                                            
                                                                                
              IF WS-C398-LETTER-CNT < 2                                         
                ADD  1      TO  WS-C398-LETTER-CNT                              
              END-IF                                                            
                                                                                
              MOVE SPACES               TO  BP13K813-REC                        
                                                                                
              IF K800-NUM-ALLO-CAT = 'BTO'                                      
                 MOVE K800-NUM-BTO-ZONE TO  K813-NUM-ZONE                       
              ELSE                                                              
                 MOVE K800-NUM-NEW-TOWN TO  K813-NUM-ZONE                       
              END-IF                                                            
              MOVE K800-NUM-FLAT-TYPE   TO  K813-NUM-FLAT-TYPE                  
              MOVE K800-DTE-BALLOT      TO  K813-DTE-BALLOT                     
                                                                                
              PERFORM 3405-READ-K813 THRU 3405-EXIT                             
                                                                                
              PERFORM 5000-PRINT-1ST-PAGE THRU 5000-EXIT                        
                                                                                
              PERFORM 6000-PRINT-ANNEX1   THRU 6000-EXIT                        
                                                                                
           END-IF.                                                              
                                                                                
       3400-EXIT.                                                               
           EXIT.                                                                
                                                                                
       3405-READ-K813.                                                          
           READ BP13K813.                                                       
           IF WS-K813-STATUS = ZERO                                             
              MOVE K813-NME-SITE TO WS-C245-NT-ZONE-NAME                        
              MOVE K813-NUM-UNIT-OFFER   TO WS-NUM-OFFER                        
              MOVE WS-NUM-OFFER          TO LR48-UNIT-OFFER                     
                                            LR48-UNIT-OFFER-A                   
           ELSE                                                                 
              MOVE SPACES        TO WS-C245-NT-ZONE-NAME                        
           END-IF.                                                              
                                                                                
       3405-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ** PRINT APPLICATION FORMS AND LOAN LETTER                                
      *-------------------------------------------------------------            
       3410-START-BP13K820.                                                     
      *-------------------------------------------------------------            
                                                                                
           START BP13K820 KEY >= K820-KEY-FLD.                                  
                                                                                
           EVALUATE WS-K820-STATUS                                              
             WHEN   00                                                          
                    PERFORM 3420-READNEXT-BP13K820 THRU 3420-EXIT               
                       UNTIL K820-NUM-REGN NOT = WS-NUM-REGN                    
                        OR   WS-K820-EOF = 'Y'                                  
             WHEN   23                                                          
                    MOVE 'N' TO WS-K820-FND                                     
             WHEN   46                                                          
                    MOVE 'Y' TO WS-K820-EOF                                     
             WHEN   OTHER                                                       
                    DISPLAY 'ERROR BROWSE BP13K820, STAT = '                    
                           K820-KEY-FLD ' ' WS-K820-STATUS                      
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3410-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       3420-READNEXT-BP13K820.                                                  
      *---------------------------------------------------------------*         
           READ BP13K820 NEXT                                                   
                         AT END MOVE 'Y' TO WS-K820-EOF                         
                         GO TO 3420-EXIT.                                       
                                                                                
           EVALUATE WS-K820-STATUS                                              
             WHEN 00                                                            
                  IF K820-NUM-REGN = WS-NUM-REGN                                
                     ADD    1   TO WS-NRIC-CNT                                  
                     PERFORM 3430-MOVE-K820-FLDS   THRU 3430-EXIT               
                     ADD    1   TO WS-K820-READ-CNT                             
                     MOVE 'Y'   TO WS-K820-FND                                  
                END-IF                                                          
             WHEN 23                                                            
                  MOVE 'Y'   TO WS-K820-FND                                     
             WHEN 46                                                            
                  MOVE 'Y'   TO WS-K820-EOF                                     
             WHEN OTHER                                                         
                DISPLAY 'BP18K820 - READNXT ERROR, STATUS: '                    
                                                     WS-K820-STATUS             
                MOVE     WS-K820-STATUS    TO RETURN-CODE                       
                PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                       
           END-EVALUATE.                                                        
                                                                                
       3420-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       3430-MOVE-K820-FLDS.                                                     
      *---------------------------------------------------------------*         
      *-----------------------------------------*                               
      * CALCULATE COMPLETED AGE FROM BIRTH DATE *                               
      *-----------------------------------------*                               
           IF K820-DTE-BIRTH IS NOT NUMERIC                                     
              MOVE ZEROES                TO K820-DTE-BIRTH                      
           END-IF.                                                              
                                                                                
           MOVE K820-DTE-BIRTH        TO WS-BIRTH-DATE.                         
           COMPUTE WS-AGE  =  WS-DATE  -  WS-BIRTH-DATE.                        
                                                                                
           MOVE K800-DTE-REGN         TO WS-DTE-APPLN.                          
           COMPUTE WS-AGE2 =  WS-DTE-APPLN - WS-BIRTH-DATE.                     
      *---------------------------------------------------*                     
      * IF NRIC FOUND IN BP13K800, PERFORM APPLICANT PARA *                     
      * ELSE PERFORM OCCUPIER PARA                        *                     
      *---------------------------------------------------*                     
           IF  (K820-NUM-NRIC  =  K800-NUM-NRIC1)  OR                           
               (K820-NUM-NRIC  =  K800-NUM-NRIC2)  OR                           
               (K820-NUM-NRIC  =  K800-NUM-NRIC3)  OR                           
               (K820-NUM-NRIC  =  K800-NUM-NRIC4)                               
               PERFORM 7000-READ-BP13K734         THRU 7000-EXIT                
               PERFORM 3440-PROCESS-APPLICANT     THRU 3440-EXIT                
           ELSE                                                                 
               PERFORM 7000-READ-BP13K734         THRU 7000-EXIT                
               PERFORM 3450-PROCESS-OCCUPIER      THRU 3450-EXIT                
           END-IF.                                                              
                                                                                
       3430-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       3440-PROCESS-APPLICANT.                                                  
      *---------------------------------------------------------------*         
           IF  (K820-NUM-NRIC = K800-NUM-NRIC1)                                 
                MOVE  1     TO WS-APPL-CNT                                      
           END-IF.                                                              
                                                                                
           IF  (K820-NUM-NRIC = K800-NUM-NRIC2)                                 
                MOVE  2     TO WS-APPL-CNT                                      
           END-IF.                                                              
                                                                                
           IF  (K820-NUM-NRIC = K800-NUM-NRIC3)                                 
                MOVE  3     TO WS-APPL-CNT                                      
           END-IF.                                                              
                                                                                
           IF  (K820-NUM-NRIC = K800-NUM-NRIC4)                                 
                MOVE  4     TO WS-APPL-CNT                                      
           END-IF.                                                              
                                                                                
      *------------------------------------*                                    
      * NRIC, NAME, AGE AND OCCUPIER CODE  *                                    
      *------------------------------------*                                    
           MOVE K820-NUM-NRIC     TO                                            
                             WS-C398-NRIC(WS-APPL-CNT).                         
           MOVE   'A'             TO                                            
                             WS-C398-CDE-OCCUPIER(WS-APPL-CNT).                 
           MOVE   K820-NME-OCCP   TO                                            
                             WS-C398-NME-OCCUPIER(WS-APPL-CNT).                 
           MOVE   K820-NUM-SEX    TO  WS-C398-GENDER(WS-APPL-CNT).              
           MOVE   WS-AGE-CMPLTD   TO                                            
                             WS-C398-AGE-OCCUPIER(WS-APPL-CNT).                 
           MOVE   WS-AGE-CMPLTD2  TO                                            
                             WS-C398-AGE2-OCCUPIER(WS-APPL-CNT).                
           IF K800-NUM-PPS-ELIG = 'E'                                           
              MOVE   K820-NUM-PPS-PREGNANT                                      
                                  TO WS-C398-PPS-ELIG(WS-APPL-CNT)              
           ELSE                                                                 
              MOVE SPACES         TO WS-C398-PPS-ELIG(WS-APPL-CNT)              
           END-IF.                                                              
                                                                                
           IF K800-NUM-DEFER-INCOME-ASSESS = 'Y' AND                            
              K820-NUM-NS-LT12MTH = 'Y'                                         
              MOVE 'Y'            TO WS-C398-NS-LT12MTH(WS-APPL-CNT)            
           ELSE                                                                 
              MOVE SPACES         TO WS-C398-NS-LT12MTH(WS-APPL-CNT)            
           END-IF.                                                              
                                                                                
           IF K800-NUM-DEFER-INCOME-ASSESS = 'Y' AND                            
              K820-NUM-EDN-LT12MTH = 'Y'                                        
              MOVE 'Y'            TO WS-C398-EDN-LT12MTH(WS-APPL-CNT)           
           ELSE                                                                 
              MOVE SPACES         TO WS-C398-EDN-LT12MTH(WS-APPL-CNT)           
           END-IF.                                                              
                                                                                
           PERFORM 7100-CHECK-BP04K010    THRU 7100-EXIT.                       
                                                                                
      *-------------------------------*                                         
      * IDENTITY CARD                 *                                         
      *-------------------------------*                                         
           MOVE   'Y'             TO                                            
                             WS-C398-ID-CARD(WS-APPL-CNT).                      
                                                                                
      *-------------------------------*                                         
      * RELATIONSHIP                  *                                         
      *-------------------------------*                                         
           MOVE K820-NUM-RELATIONSHIP TO                                        
                             WS-C398-RELATIONSHIP(WS-APPL-CNT).                 
                                                                                
      *-------------------------------*                                         
      * CITIZENSHIP                   *                                         
      *-------------------------------*                                         
           MOVE K820-NUM-CITIZENSHIP TO                                         
                             WS-C398-CITIZENSHIP(WS-APPL-CNT).                  
                                                                                
      *-------------------------------*                                         
      * DATE OF BIRTH                 *                                         
      *-------------------------------*                                         
           MOVE K820-DTE-BIRTH       TO                                         
                             WS-C398-DOB(WS-APPL-CNT).                          
                                                                                
      *------------------------------------*                                    
      * CHECK FOR SPOUSE OR FIANCE/FIANCEE                                      
      *------------------------------------*                                    
           IF K820-NUM-RELATIONSHIP = '09'                                      
              MOVE 'Y'            TO WS-C398-SP-FI(WS-APPL-CNT)                 
           ELSE                                                                 
              IF K820-NUM-NRIC-SPOUSE NOT = SPACES AND LOW-VALUES               
                 IF K820-NUM-NRIC-SPOUSE = K800-NUM-NRIC1 OR                    
                                           K800-NUM-NRIC2 OR                    
                                           K800-NUM-NRIC3 OR                    
                                           K800-NUM-NRIC4                       
                    MOVE 'Y'            TO WS-C398-SP-FI(WS-APPL-CNT)           
                 ELSE                                                           
                    MOVE SPACES         TO WS-C398-SP-FI(WS-APPL-CNT)           
                 END-IF                                                         
              ELSE                                                              
                 MOVE SPACES         TO WS-C398-SP-FI(WS-APPL-CNT)              
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *-------------------------------*                                         
      * BIRTH CERTIFICATE             *                                         
      *-------------------------------*                                         
           IF K820-NUM-RELATIONSHIP = '41' OR '39' OR '06'                      
               MOVE   'Y'         TO                                            
                             WS-C398-BIRTH-CERTF(WS-APPL-CNT)                   
           END-IF.                                                              
                                                                                
           IF K820-NUM-RELATIONSHIP = '02' OR '12' OR '38'                      
               MOVE   'Y'         TO                                            
                             WS-C398-BIRTH-CERTF(1)                             
           END-IF.                                                              
                                                                                
           IF K800-NUM-ELIG-SCHEME = 'OR '                                      
               MOVE   'Y'         TO                                            
                             WS-C398-BIRTH-CERTF(WS-APPL-CNT)                   
           END-IF.                                                              
                                                                                
           IF K800-NUM-ALLO-SCHEME =  'MTF'                                     
              IF K820-NUM-RELATIONSHIP = '02' OR '12' OR '01' OR                
                                         '43' OR '45'                           
                 MOVE   'Y'       TO                                            
                             WS-C398-BIRTH-CERTF(WS-APPL-CNT)                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *-------------------------------*                                         
      * MARRIAGE CERTIFICATE          *                                         
      *-------------------------------*                                         
           IF K820-NUM-MARITAL-STATUS  =  '2' OR 'M'                            
              MOVE 'N'           TO WS-MRG-CHK-SKIP                             
                                    WS-MRG-TBL-FND                              
              PERFORM VARYING WS-IDX3 FROM 1 BY 1 UNTIL                         
                WS-IDX3 > 12  OR                                                
                WS-NUM-CSTMR(WS-IDX3) = SPACES OR LOW-VALUES                    
                IF K820-NUM-NRIC = WS-NUM-NRIC-WIFE(WS-IDX3) OR                 
                   K820-NUM-NRIC = WS-NUM-NRIC-HSBND(WS-IDX3)                   
                   MOVE 'Y'      TO WS-MRG-CHK-SKIP                             
                   MOVE 13       TO WS-IDX3                                     
                END-IF                                                          
              END-PERFORM                                                       
              IF WS-MRG-CHK-SKIP = 'Y'                                          
                 MOVE   'N'  TO  WS-C398-MARRIAGE-CERTF(WS-APPL-CNT)            
                 MOVE   'Y'  TO  WS-MRG-TBL-FND                                 
              ELSE                                                              
                 PERFORM 7300-LINK-BE01C812 THRU 7300-EXIT                      
                 IF WS-MRG-TBL-FND = 'Y'                                        
                    MOVE   'N'  TO  WS-C398-MARRIAGE-CERTF(WS-APPL-CNT)         
                 ELSE                                                           
                    MOVE   'Y'  TO  WS-C398-MARRIAGE-CERTF(WS-APPL-CNT)         
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *----------------------------------*                                      
      * PAYSLIP/UNEMPLOYMENT DECLARATION *                                      
      *----------------------------------*                                      
           IF K820-AMT-INCOME  >  0                                             
               MOVE   'Y'         TO                                            
                             WS-C398-PAY-SLIP(WS-APPL-CNT)                      
           ELSE                                                                 
               IF (WS-AGE-CMPLTD >= 31)  AND (WS-AGE-CMPLTD <= 55)              
                  MOVE   'Y'      TO                                            
                             WS-C398-UNEMPLYMNT-DECL(WS-APPL-CNT)               
               ELSE                                                             
                  IF (WS-AGE-CMPLTD >= 18)  AND (WS-AGE-CMPLTD <= 30)           
                     MOVE   'Y'      TO                                         
                             WS-C398-UNEMPLYMNT-DECL(WS-APPL-CNT)               
                             WS-C398-STUDENT-PASS(WS-APPL-CNT)                  
                  END-IF                                                        
               END-IF                                                           
           END-IF.                                                              
                                                                                
           MOVE WS-EMP-STATUS       TO WS-C398-EMP-STAT(WS-APPL-CNT)            
           MOVE WS-DTE-INCOME1      TO WS-C398-DTE-INCOME1(WS-APPL-CNT).        
           MOVE WS-DTE-INCOME2      TO WS-C398-DTE-INCOME2(WS-APPL-CNT).        
           MOVE WS-NUM-INCOME1      TO WS-C398-NUM-INCOME1(WS-APPL-CNT).        
           MOVE WS-NUM-INCOME2      TO WS-C398-NUM-INCOME2(WS-APPL-CNT).        
           MOVE WS-NUM-INCOME3      TO WS-C398-NUM-INCOME3(WS-APPL-CNT).        
                                                                                
      *-------------------------------*                                         
      * DEATH CERTIFICATE             *                                         
      *-------------------------------*                                         
           IF K820-NUM-MARITAL-STATUS  =  '3' OR 'W'                            
               MOVE   'Y'         TO                                            
                             WS-C398-DEATH-CERTF(WS-APPL-CNT)                   
               MOVE K820-NUM-NRIC-SPOUSE   TO                                   
                             WS-C398-NRIC-DTH-CERTF(WS-APPL-CNT)                
               MOVE K820-NME-SPOUSE        TO                                   
                             WS-C398-NME-DTH-CERTF(WS-APPL-CNT)                 
           END-IF.                                                              
                                                                                
      *-------------------------------*                                         
      * DIVORCE CERTIFICATE           *                                         
      *-------------------------------*                                         
           IF K820-NUM-MARITAL-STATUS  =  '4' OR 'D'                            
               MOVE   'Y'         TO                                            
                             WS-C398-DIVORCE-CERTF(WS-APPL-CNT)                 
           END-IF.                                                              
                                                                                
           MOVE K820-NUM-DIVORCE-FNLJDGMT TO                                    
                             WS-C398-DIVORCE-FNLJDGMT(WS-APPL-CNT)              
                                                                                
      *-------------------------------*                                         
      * DEED OF SEPATION              *                                         
      *-------------------------------*                                         
           IF K820-NUM-MARITAL-STATUS  =  '5' OR 'P'                            
               MOVE   'S'         TO                                            
                             WS-C398-DIVORCE-CERTF(WS-APPL-CNT)                 
           END-IF.                                                              
                                                                                
      *-------------------------------*                                         
      * PHOTOGRAPH                    *                                         
      *-------------------------------*                                         
           MOVE   'Y'             TO                                            
                             WS-C398-PHOTOGRAPH(WS-APPL-CNT).                   
                                                                                
       3440-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       3450-PROCESS-OCCUPIER.                                                   
      *---------------------------------------------------------------*         
           ADD   1     TO WS-OCCP-CNT.                                          
      *------------------------------------*                                    
      * NRIC, NAME, AGE AND OCCUPIER CODE  *                                    
      *------------------------------------*                                    
           MOVE K820-NUM-NRIC     TO                                            
                             WS-C398-NRIC(WS-OCCP-CNT).                         
           MOVE   'O'             TO                                            
                             WS-C398-CDE-OCCUPIER(WS-OCCP-CNT).                 
           MOVE   K820-NME-OCCP   TO                                            
                             WS-C398-NME-OCCUPIER(WS-OCCP-CNT).                 
           MOVE   K820-NUM-SEX    TO  WS-C398-GENDER(WS-OCCP-CNT).              
           MOVE   WS-AGE-CMPLTD   TO                                            
                             WS-C398-AGE-OCCUPIER(WS-OCCP-CNT).                 
           MOVE   WS-AGE-CMPLTD2  TO                                            
                             WS-C398-AGE2-OCCUPIER(WS-OCCP-CNT).                
           MOVE   SPACES                                                        
                                  TO WS-C398-PPS-ELIG(WS-OCCP-CNT)              
                                     WS-C398-DEB-OCCUPIER(WS-OCCP-CNT).         
                                                                                
                                                                                
           IF K800-NUM-PPS-ELIG = 'E'                                           
              MOVE   K820-NUM-PPS-PREGNANT                                      
                                  TO WS-C398-PPS-ELIG(WS-OCCP-CNT)              
           END-IF.                                                              
                                                                                
           MOVE SPACES            TO WS-C398-EDN-LT12MTH(WS-OCCP-CNT)           
                                     WS-C398-NS-LT12MTH(WS-OCCP-CNT).           
                                                                                
      *-------------------------------*                                         
      * IDENTITY CARD                 *                                         
      *-------------------------------*                                         
           IF (K820-NUM-CITIZENSHIP = '10' OR '20')  AND                        
              (WS-AGE-CMPLTD >= 15)                                             
              MOVE   'Y'          TO                                            
                             WS-C398-ID-CARD(WS-OCCP-CNT)                       
           END-IF.                                                              
                                                                                
      *-------------------------------*                                         
      * RELATIONSHIP                  *                                         
      *-------------------------------*                                         
           MOVE K820-NUM-RELATIONSHIP TO                                        
                             WS-C398-RELATIONSHIP(WS-OCCP-CNT).                 
                                                                                
      *-------------------------------*                                         
      * CITIZENSHIP                   *                                         
      *-------------------------------*                                         
           MOVE K820-NUM-CITIZENSHIP TO                                         
                             WS-C398-CITIZENSHIP(WS-OCCP-CNT).                  
                                                                                
      *-------------------------------*                                         
      * DATE OF BIRTH                 *                                         
      *-------------------------------*                                         
           MOVE K820-DTE-BIRTH       TO                                         
                             WS-C398-DOB(WS-OCCP-CNT).                          
                                                                                
      *------------------------------------*                                    
      * CHECK FOR SPOUSE OR FIANCE/FIANCEE                                      
      *------------------------------------*                                    
           IF K820-NUM-RELATIONSHIP = '09'                                      
              MOVE 'Y'            TO WS-C398-SP-FI(WS-OCCP-CNT)                 
           ELSE                                                                 
              IF K820-NUM-NRIC-SPOUSE NOT = SPACES AND LOW-VALUES               
                 IF K820-NUM-NRIC-SPOUSE = K800-NUM-NRIC1 OR                    
                                           K800-NUM-NRIC2 OR                    
                                           K800-NUM-NRIC3 OR                    
                                           K800-NUM-NRIC4                       
                    MOVE 'Y'            TO WS-C398-SP-FI(WS-OCCP-CNT)           
                 ELSE                                                           
                    MOVE SPACES         TO WS-C398-SP-FI(WS-OCCP-CNT)           
                 END-IF                                                         
              ELSE                                                              
                 MOVE SPACES         TO WS-C398-SP-FI(WS-OCCP-CNT)              
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *-------------------------------*                                         
      * EMPLOYMENT PASS/WORK PERMIT   *                                         
      *-------------------------------*                                         
           IF (K820-NUM-CITIZENSHIP  NOT =  '10')                               
              MOVE   'Y'          TO                                            
                             WS-C398-PASS-PERMIT(WS-OCCP-CNT)                   
           END-IF.                                                              
                                                                                
      *-------------------------------*                                         
      * BIRTH CERTIFICATE             *                                         
      *-------------------------------*                                         
           IF K820-NUM-RELATIONSHIP = '41' OR '39' OR '06'                      
               MOVE   'Y'         TO                                            
                             WS-C398-BIRTH-CERTF(WS-OCCP-CNT)                   
           END-IF.                                                              
                                                                                
           IF K820-NUM-RELATIONSHIP = '02' OR '12' OR '38'                      
               MOVE   'Y'         TO                                            
                             WS-C398-BIRTH-CERTF(1)                             
           END-IF.                                                              
                                                                                
           IF K800-NUM-ELIG-SCHEME = 'OR '                                      
               MOVE   'Y'         TO                                            
                             WS-C398-BIRTH-CERTF(WS-OCCP-CNT)                   
           END-IF.                                                              
                                                                                
           IF K800-NUM-ALLO-SCHEME =  'MTF'                                     
              IF K820-NUM-RELATIONSHIP = '02' OR '12' OR '01' OR                
                                         '43' OR '45'                           
                 MOVE   'Y'       TO                                            
                             WS-C398-BIRTH-CERTF(WS-OCCP-CNT)                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *-------------------------------*                                         
      * MARRIAGE CERTIFICATE          *                                         
      *-------------------------------*                                         
           IF K820-NUM-MARITAL-STATUS  =  '2' OR 'M'                            
              MOVE 'N'           TO WS-MRG-CHK-SKIP                             
                                    WS-MRG-TBL-FND                              
              PERFORM VARYING WS-IDX3 FROM 1 BY 1 UNTIL                         
                WS-IDX3 > 12  OR                                                
                WS-NUM-CSTMR(WS-IDX3) = SPACES OR LOW-VALUES                    
                IF K820-NUM-NRIC = WS-NUM-NRIC-WIFE(WS-IDX3) OR                 
                   K820-NUM-NRIC = WS-NUM-NRIC-HSBND(WS-IDX3)                   
                   MOVE 'Y'      TO WS-MRG-CHK-SKIP                             
                   MOVE 13       TO WS-IDX3                                     
                END-IF                                                          
              END-PERFORM                                                       
              IF WS-MRG-CHK-SKIP = 'Y'                                          
                 MOVE   'N'  TO  WS-C398-MARRIAGE-CERTF(WS-OCCP-CNT)            
                 MOVE   'Y'  TO  WS-MRG-TBL-FND                                 
              ELSE                                                              
                 PERFORM 7300-LINK-BE01C812 THRU 7300-EXIT                      
                 IF WS-MRG-TBL-FND = 'Y'                                        
                    MOVE   'N'  TO  WS-C398-MARRIAGE-CERTF(WS-OCCP-CNT)         
                 ELSE                                                           
                    MOVE   'Y'  TO  WS-C398-MARRIAGE-CERTF(WS-OCCP-CNT)         
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *----------------------------------*                                      
      * PAYSLIP/UNEMPLOYMENT DECLARATION *                                      
      *----------------------------------*                                      
           IF K820-AMT-INCOME  >  0                                             
               MOVE   'Y'         TO                                            
                             WS-C398-PAY-SLIP(WS-OCCP-CNT)                      
           ELSE                                                                 
               IF (WS-AGE-CMPLTD >= 31)  AND (WS-AGE-CMPLTD <= 55)              
                  MOVE   'Y'      TO                                            
                             WS-C398-UNEMPLYMNT-DECL(WS-OCCP-CNT)               
               ELSE                                                             
                  IF (WS-AGE-CMPLTD >= 18)  AND (WS-AGE-CMPLTD <= 30)           
                     MOVE   'Y'   TO                                            
                             WS-C398-UNEMPLYMNT-DECL(WS-OCCP-CNT)               
                             WS-C398-STUDENT-PASS(WS-OCCP-CNT)                  
                  END-IF                                                        
               END-IF                                                           
           END-IF.                                                              
                                                                                
           MOVE WS-EMP-STATUS       TO WS-C398-EMP-STAT(WS-OCCP-CNT).           
           MOVE WS-DTE-INCOME1      TO WS-C398-DTE-INCOME1(WS-OCCP-CNT).        
           MOVE WS-DTE-INCOME2      TO WS-C398-DTE-INCOME2(WS-OCCP-CNT).        
           MOVE WS-NUM-INCOME1      TO WS-C398-NUM-INCOME1(WS-OCCP-CNT).        
           MOVE WS-NUM-INCOME2      TO WS-C398-NUM-INCOME2(WS-OCCP-CNT).        
           MOVE WS-NUM-INCOME3      TO WS-C398-NUM-INCOME3(WS-OCCP-CNT).        
                                                                                
      *-------------------------------*                                         
      * DEATH CERTIFICATE             *                                         
      *-------------------------------*                                         
           IF K820-NUM-MARITAL-STATUS  =  '3' OR 'W'                            
               MOVE   'Y'         TO                                            
                             WS-C398-DEATH-CERTF(WS-OCCP-CNT)                   
               MOVE K820-NUM-NRIC-SPOUSE   TO                                   
                             WS-C398-NRIC-DTH-CERTF(WS-OCCP-CNT)                
               MOVE K820-NME-SPOUSE        TO                                   
                             WS-C398-NME-DTH-CERTF(WS-OCCP-CNT)                 
           END-IF.                                                              
                                                                                
      *-------------------------------*                                         
      * DIVORCE CERTIFICATE           *                                         
      *-------------------------------*                                         
           IF K820-NUM-MARITAL-STATUS  =  '4' OR 'D'                            
               MOVE   'Y'         TO                                            
                             WS-C398-DIVORCE-CERTF(WS-OCCP-CNT)                 
           END-IF.                                                              
                                                                                
           IF K820-NUM-MARITAL-STATUS  =  '5' OR 'P'                            
               MOVE   'S'         TO                                            
                             WS-C398-DIVORCE-CERTF(WS-OCCP-CNT)                 
           END-IF.                                                              
                                                                                
           MOVE K820-NUM-DIVORCE-FNLJDGMT TO                                    
                             WS-C398-DIVORCE-FNLJDGMT(WS-OCCP-CNT)              
                                                                                
      *-------------------------------*                                         
      * MARRIAGE CONSENT OF MINOR     *                                         
      *-------------------------------*                                         
           IF (K820-NUM-RELATIONSHIP  =  '09')  AND                             
              (WS-AGE-CMPLTD >= 18  AND  WS-AGE-CMPLTD < 21)                    
               MOVE   'Y'         TO                                            
                             WS-C398-MARRIAGE-CONSENT(WS-OCCP-CNT)              
           END-IF.                                                              
                                                                                
       3450-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       4000-APPLN-HSELOAN-LET.                                                  
      ************************************************************              
                                                                                
           READ BP13K757.                                                       
                                                                                
           EVALUATE WS-K757-STATUS                                              
               WHEN 00                                                          
                    ADD 1                TO WS-K757-FND-CNT                     
                    IF K800-NUM-ALLO-CAT NOT = 'NPL'                            
                       PERFORM 8000-PRINT-DECLARATION THRU 8000-EXIT            
                    END-IF                                                      
               WHEN 10                                                          
               WHEN 23                                                          
                    ADD 1                TO WS-K757-NFND-CNT                    
                    DISPLAY 'REGN NO. NOT FOUND IN BP13K757. REGN = '           
                            K757-NUM-REGN                                       
               WHEN OTHER                                                       
                    DISPLAY 'READ ERROR BP13K757, STATUS '                      
                            WS-K757-STATUS                                      
                    MOVE WS-K757-STATUS  TO RETURN-CODE                         
                                                                                
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       4100-WRITE-REPORT.                                                       
      ************************************************************              
           IF WS-ELDERLY-CNT = 1 OR WS-REPORT-CTR > 30                          
              MOVE ZEROES           TO WS-REPORT-CTR                            
              MOVE WS-CURR-DATE     TO L89DA-DATE                               
              WRITE  P13L89DA-REC FROM L89DA-HEADER    AFTER PAGE               
              WRITE  P13L89DA-REC FROM L89DA-HEADER1   AFTER 2                  
      *       WRITE  P13L89DA-REC FROM L89DA-HEADER2   AFTER 1                  
              WRITE  P13L89DA-REC FROM L89DA-UNDERLINE                          
              ADD 3 TO WS-REPORT-CTR                                            
           END-IF.                                                              
                                                                                
           ADD  1                   TO WS-SN-CTR.                               
           MOVE WS-SN-CTR           TO L89DA-SN.                                
           MOVE LR48-REGN-NO        TO L89DA-REGN-NO.                           
           MOVE SPACES              TO L89DA-NUM-QUEUE                          
                                       L89DA-NUM-QUEUE-MGPS                     
           IF K800-NUM-MGPS = 'P' OR 'C'                                        
              MOVE LR48-Q-NO        TO L89DA-NUM-QUEUE-MGPS                     
           ELSE                                                                 
              MOVE LR48-Q-NO        TO L89DA-NUM-QUEUE                          
           END-IF.                                                              
           WRITE P13L89DA-REC       FROM L89DA-DATA AFTER 1.                    
           ADD 1 TO WS-REPORT-CTR.                                              
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       5000-PRINT-1ST-PAGE.                                                     
      ************************************************************              
           PERFORM 5100-MOVE-DETAILS         THRU  5100-EXIT.                   
           PERFORM 5200-GET-NAME-ADDR        THRU  5200-EXIT.                   
                                                                                
           PERFORM 5400-PRINT-PAGE1          THRU  5400-EXIT.                   
                                                                                
           WRITE P13P89DA-REC FROM LR48-PRT-HDG-A.                              
           WRITE P13P89DA-REC FROM LR48-LINE-BARCODE AFTER 4.                   
           WRITE P13P89DA-REC FROM LR48-LINE-BARCODE1 AFTER 1.                  
                                                                                
      *----------------------------------------------------------*              
      *     PRINT NAME OF APPLICANT AND ADDRESS                  *              
      *----------------------------------------------------------*              
           MOVE  SPACES             TO    P13P89DA-REC.                         
           WRITE P13P89DA-REC FROM LR48-PRT-HDG-9A.                             
           WRITE P13P89DA-REC FROM LR48-PRT-HDG-9B AFTER 1.                     
                                                                                
           MOVE  SPACES             TO    P13P89DA-REC.                         
           WRITE P13P89DA-REC FROM LR48-PRT-HDG-10A AFTER 1.                    
           WRITE P13P89DA-REC FROM LR48-PRT-HDG-10B AFTER 1.                    
           WRITE P13P89DA-REC FROM LR48-PRT-HDG-10C AFTER 1.                    
                                                                                
           MOVE  SPACES             TO    P13P89DA-REC.                         
           WRITE P13P89DA-REC FROM LR48-PRT-HDG-10D AFTER 1.                    
                                                                                
           MOVE  SPACES             TO    P13P89DA-REC.                         
           WRITE P13P89DA-REC FROM LR48-PRT-HDG-1    AFTER 4.                   
                                                                                
           MOVE  SPACES             TO    P13P89DA-REC                          
           WRITE P13P89DA-REC FROM LR48-PRT-HDG-1A.                             
                                                                                
           IF K800-NUM-ALLO-SCHEME NOT = 'GRO'                                  
              MOVE  SPACES             TO    P13P89DA-REC                       
              WRITE P13P89DA-REC FROM LR48-PRT-HDG-2                            
           END-IF.                                                              
                                                                                
           IF K800-NUM-ALLO-CAT = 'ROF'                                         
              CONTINUE                                                          
           ELSE                                                                 
              MOVE  SPACES             TO    P13P89DA-REC                       
              WRITE P13P89DA-REC FROM LR48-PRT-HDG-3                            
                                                                                
              IF ((K800-NUM-BALLOT-STATUS = 'K') AND                            
                  (K800-NUM-GEN3 = 'Y'))                                        
                 MOVE  SPACES             TO    P13P89DA-REC                    
                 WRITE P13P89DA-REC FROM LR48-PRT-HDG-4 AFTER 2                 
              ELSE                                                              
                 IF (F200-DTE-BALLOT >= '201502')                               
                    MOVE  SPACES             TO    P13P89DA-REC                 
                    WRITE P13P89DA-REC FROM LR48-PRT-HDG-3A                     
                 END-IF                                                         
                 MOVE  SPACES             TO    P13P89DA-REC                    
                 WRITE P13P89DA-REC FROM LR48-PRT-HDG-4                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE  SPACES             TO    P13P89DA-REC.                         
           IF K800-NUM-MGPS = 'P' OR 'C'                                        
              WRITE P13P89DA-REC FROM LR48-PRT-HDG-5 AFTER 2                    
           ELSE                                                                 
              IF K800-NUM-ALLO-SCHEME = 'GRO'                                   
                 WRITE P13P89DA-REC FROM LR48-PRT-HDG-2 AFTER 2                 
                 MOVE  SPACES             TO    P13P89DA-REC                    
                 WRITE P13P89DA-REC FROM LR48-PRT-HDG-5                         
              ELSE                                                              
                 WRITE P13P89DA-REC FROM LR48-PRT-HDG-5                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE  SPACES             TO    P13P89DA-REC.                         
           WRITE P13P89DA-REC FROM LR48-PRT-HDG-6.                              
                                                                                
           MOVE  SPACES         TO    P13P89DA-REC.                             
                                                                                
           IF ((K800-NUM-BALLOT-STATUS = 'K') AND                               
               (K800-NUM-GEN3 = 'Y'))                                           
              PERFORM 5300-PRINT-3GEN-LETTER   THRU 5300-EXIT                   
              GO TO  5000-EXIT                                                  
           END-IF.                                                              
                                                                                
           WRITE P13P89DA-REC FROM LR48-PRT-HDG-7                               
                                                                                
           IF K800-NUM-MGPS = 'P' OR 'C' OR                                     
              K800-NUM-ALLO-SCHEME = 'GRO'                                      
              IF WS-NUM-QUEUE = SPACES OR LOW-VALUES                            
                 MOVE SPACES       TO    LR48-PRT-HDG-7A                        
                                         LR48-PRT-HDG-8                         
                                         LR48-PRT-HDG-9                         
                                         LR48-PRT-HDG-10                        
              END-IF                                                            
                                                                                
              IF K800-NUM-ALLO-SCHEME = 'GRO'                                   
                 MOVE  SPACES             TO    P13P89DA-REC                    
                 WRITE P13P89DA-REC FROM LR48-PRT-HDG-7A AFTER 2                
                 MOVE  SPACES         TO    P13P89DA-REC                        
                 WRITE P13P89DA-REC FROM LR48-PRT-HDG-8                         
              ELSE                                                              
                 MOVE  SPACES         TO    P13P89DA-REC                        
                 WRITE P13P89DA-REC FROM LR48-PRT-HDG-8 AFTER 2                 
              END-IF                                                            
                                                                                
              MOVE  SPACES         TO    P13P89DA-REC                           
              IF WS-NUM-QUEUE > K813-NUM-QUEUE-END                         ND   
                 MOVE SPACES         TO  LR48-PRT-HDG-9                         
                                         LR48-PRT-HDG-10                        
              END-IF                                                            
              WRITE P13P89DA-REC FROM LR48-PRT-HDG-9                            
              WRITE P13P89DA-REC FROM LR48-PRT-HDG-10                           
           END-IF.                                                              
                                                                                
      *    WRITE P13P89DA-REC FROM LR48-PRT-HDG-12  AFTER 13                    
                                                                                
           IF K800-NUM-MGPS = 'P' OR 'C'                                        
              IF WS-NUM-QUEUE = SPACES OR LOW-VALUES                            
                    WRITE P13P89DA-REC FROM LR48-PRT-HDG-12B AFTER 5            
              ELSE                                                              
                 IF (WS-NUM-QUEUE <= K813-NUM-QUEUE-MID)                        
                      WRITE P13P89DA-REC FROM LR48-PRT-HDG-12B AFTER 12         
                 ELSE                                                           
                    IF ((WS-NUM-QUEUE > K813-NUM-QUEUE-MID)             ND      
                                 AND                                            
                        (WS-NUM-QUEUE <= K813-NUM-QUEUE-END))                   
                       WRITE P13P89DA-REC FROM LR48-PRT-HDG-12B AFTER 15        
                    ELSE                                                        
                      IF (WS-NUM-QUEUE > K813-NUM-QUEUE-END)                    
                        WRITE P13P89DA-REC FROM LR48-PRT-HDG-11 AFTER 6         
                        WRITE P13P89DA-REC FROM LR48-PRT-HDG-12B AFTER 7        
                      END-IF                                                    
                   END-IF                                                       
              END-IF                                                            
           ELSE                                                                 
              IF K800-NUM-ALLO-SCHEME = 'GRO'                                   
                 IF WS-NUM-QUEUE = SPACES OR LOW-VALUES                         
                    WRITE P13P89DA-REC FROM LR48-PRT-HDG-12A AFTER 4            
                 ELSE                                                           
                    IF (WS-NUM-QUEUE <= K813-NUM-QUEUE-MID)                     
                       WRITE P13P89DA-REC FROM LR48-PRT-HDG-12 AFTER 12         
                    ELSE                                                        
                       IF ((WS-NUM-QUEUE > K813-NUM-QUEUE-MID)                  
                                 AND                                            
                           (WS-NUM-QUEUE <= K813-NUM-QUEUE-END))                
                          WRITE P13P89DA-REC FROM LR48-PRT-HDG-12B              
                                                               AFTER 15         
                       ELSE                                                     
                          IF (WS-NUM-QUEUE > K813-NUM-QUEUE-END)                
                             WRITE P13P89DA-REC FROM LR48-PRT-HDG-11A           
                                                               AFTER 6          
                             WRITE P13P89DA-REC FROM LR48-PRT-HDG-12            
                                                               AFTER 6          
                      END-IF                                                    
                    END-IF                                                      
                 END-IF                                                         
              ELSE                                                              
                 IF K800-NUM-FLAT-TYPE = '1F'                                   
                    IF K800-NUM-JT-BALLOT-REGN NOT = SPACES AND                 
                                                     LOW-VALUES                 
                       WRITE P13P89DA-REC FROM LR48-PRT-HDG-JT AFTER 12         
                       WRITE P13P89DA-REC FROM LR48-PRT-HDG-12 AFTER 10         
                    ELSE                                                        
                       WRITE P13P89DA-REC FROM LR48-PRT-HDG-12  AFTER 19        
                    END-IF                                                      
                 ELSE                                                           
                    WRITE P13P89DA-REC FROM LR48-PRT-HDG-12  AFTER 13           
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 5500-PRINT-PAGE2            THRU 5500-EXIT.                  
           IF K800-NUM-FLAT-TYPE = '1F'                                         
              IF F200-DTE-BALLOT = '202211' AND                                 
                 K813-CDE-NT = 'QT' AND                                         
                 K813-NUM-SALES-MODE = 'BTO' AND                                
                 K813-NUM-EST = '946'                                           
                 PERFORM 6360-PRINT-BASIC-SVC-PCKGE2 THRU 6360-EXIT             
              ELSE                                                              
                 IF F200-DTE-BALLOT = '202312'                                  
                    CONTINUE                                                    
                 ELSE                                                           
                    PERFORM 6355-PRINT-BASIC-SVC-PCKGE1 THRU 6355-EXIT          
                 END-IF                                                         
           END-IF.                                                              
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       5100-MOVE-DETAILS.                                                       
      *-------------------------------------------------------------            
           MOVE 'Y'                      TO WS-FIRST-FLAG.                      
                                                                                
           PERFORM 5110-GET-REGN-CHKDIGIT  THRU  5110-EXIT.                     
                                                                                
           MOVE K800-NUM-REGN        TO LR48-BARCODE1-REGN.                     
           MOVE 'SL'                 TO LR48-BARCODE1-PREFIX.                   
                                                                                
           IF K800-NUM-ALLO-CAT = 'BTO'                                         
              IF K800-NUM-SALE-BROCHURE-SCPY = 'H'                              
                 MOVE K800-NUM-SALE-BROCHURE-SCPY                               
                                     TO LR48-BROCHURE                           
              ELSE                                                              
                 MOVE SPACES         TO LR48-BROCHURE                           
              END-IF                                                            
           ELSE                                                                 
              MOVE SPACES            TO LR48-BROCHURE                           
           END-IF.                                                              
                                                                                
           MOVE K800-NUM-REGN        TO LR48-REGN-NO                            
           MOVE F200-NUM-GROPA-REGN  TO LR48-REGN-NO-PA                         
      *--  QUEUE NO                                                             
           IF K800-NUM-MGPS = 'P' OR 'C'                                        
              MOVE F200-NUM-MGPS-QUEUE-SERIAL TO LR48-Q-NO                      
              IF F200-NUM-HHTY-QUEUE-SERIAL NOT = SPACES AND LOW-VALUES         
                                                  AND ZEROES                    
                 MOVE F200-NUM-HHTY-QUEUE-SERIAL TO LR48-Q-NO-PA                
                                                    WS-NUM-QUEUE                
              ELSE                                                              
                 MOVE K800-NUM-NT-FT-QUEUE       TO LR48-Q-NO-PA                
                                                    WS-NUM-QUEUE                
              END-IF                                                            
              MOVE SPACES                       TO WS-MONTH-DESC                
              MOVE F200-DTE-BKAPPMT-DATE-MGPS(5:2)   TO WS-MONTH                
              PERFORM 5120-DECODE-MONTH    THRU 5120-EXIT                       
              STRING F200-DTE-BKAPPMT-DATE-MGPS(7:2) ' '                        
                     WS-MONTH-DESC ' ' F200-DTE-BKAPPMT-DATE-MGPS(1:4)          
                     DELIMITED BY SIZE INTO LR48-APPMT-DATE                     
              END-STRING                                                        
              MOVE    F200-TME-BKAPPMT-MGPS  TO  WS-APPMT-TIME                  
                                                                                
              MOVE F200-DTE-BKAPPMT-DATE(5:2)   TO WS-MONTH                     
              PERFORM 5120-DECODE-MONTH    THRU 5120-EXIT                       
              STRING F200-DTE-BKAPPMT-DATE(7:2) ' '                             
                     WS-MONTH-DESC ' ' F200-DTE-BKAPPMT-DATE(1:4)               
                     DELIMITED BY SIZE INTO LR48-APPMT-DATE-PA                  
              END-STRING                                                        
              MOVE    F200-TME-BKAPPMT       TO  WS-APPMT-TIMEB                 
           ELSE                                                                 
              IF K800-NUM-ALLO-SCHEME = 'GRO'                                   
                 IF F200-NUM-HHTY-QUEUE-SERIAL NOT = SPACES AND                 
                                           LOW-VALUES AND ZEROES                
                    MOVE F200-NUM-HHTY-QUEUE-SERIAL TO LR48-Q-NO                
                 ELSE                                                           
                    MOVE K800-NUM-NT-FT-QUEUE       TO LR48-Q-NO                
                 END-IF                                                         
                 PERFORM 5105-READ-BP13K200   THRU 5105-EXIT                    
                 MOVE K200-NUM-HHTY-QUEUE-SERIAL TO LR48-Q-NO-PA                
                                                    WS-NUM-QUEUE                
                 MOVE SPACES                       TO WS-MONTH-DESC             
                 MOVE F200-DTE-BKAPPMT-DATE(5:2)   TO WS-MONTH                  
                 PERFORM 5120-DECODE-MONTH    THRU 5120-EXIT                    
                 STRING F200-DTE-BKAPPMT-DATE(7:2) ' '                          
                        WS-MONTH-DESC ' ' F200-DTE-BKAPPMT-DATE(1:4)            
                        DELIMITED BY SIZE INTO LR48-APPMT-DATE                  
                 END-STRING                                                     
                 MOVE    F200-TME-BKAPPMT       TO  WS-APPMT-TIME               
                                                                                
                 MOVE SPACES                  TO WS-MONTH-DESC                  
                 MOVE K200-DTE-BKAPPMT-DATE(5:2)   TO WS-MONTH                  
                 PERFORM 5120-DECODE-MONTH    THRU 5120-EXIT                    
                 STRING K200-DTE-BKAPPMT-DATE(7:2) ' '                          
                        WS-MONTH-DESC ' ' K200-DTE-BKAPPMT-DATE(1:4)            
                        DELIMITED BY SIZE INTO LR48-APPMT-DATE-PA               
                 END-STRING                                                     
                 MOVE    K200-TME-BKAPPMT       TO  WS-APPMT-TIMEB              
              ELSE                                                              
                 IF F200-NUM-HHTY-QUEUE-SERIAL NOT = SPACES AND                 
                                          LOW-VALUES AND ZEROES                 
                    MOVE F200-NUM-HHTY-QUEUE-SERIAL TO LR48-Q-NO                
                                                       WS-NUM-QUEUE             
                 ELSE                                                           
                    MOVE K800-NUM-NT-FT-QUEUE       TO LR48-Q-NO                
                                                       WS-NUM-QUEUE             
                 END-IF                                                         
                                                                                
                 MOVE SPACES                       TO WS-MONTH-DESC             
                 MOVE F200-DTE-BKAPPMT-DATE(5:2)   TO WS-MONTH                  
                 PERFORM 5120-DECODE-MONTH    THRU 5120-EXIT                    
                 STRING F200-DTE-BKAPPMT-DATE(7:2) ' '                          
                        WS-MONTH-DESC ' ' F200-DTE-BKAPPMT-DATE(1:4)            
                        DELIMITED BY SIZE INTO LR48-APPMT-DATE                  
                 END-STRING                                                     
                 MOVE    F200-TME-BKAPPMT       TO  WS-APPMT-TIME               
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-NUM-QUEUE NOT = SPACES AND LOW-VALUES AND ZEROES               
              IF WS-NUM-QUEUE(1:1) NOT NUMERIC                                  
                 MOVE ZEROES      TO  WS-NUM-QUEUE(1:1)                         
              END-IF                                                            
                                                                                
              IF WS-NUM-QUEUE(2:1) NOT NUMERIC                                  
                 MOVE ZEROES      TO  WS-NUM-QUEUE(2:1)                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *--  APPMT DATE/TIME                                                      
                                                                                
      *    MOVE SPACES                       TO WS-MONTH-DESC.                  
      *    MOVE F200-DTE-BKAPPMT-DATE(5:2)   TO WS-MONTH.                       
      *    PERFORM 5120-DECODE-MONTH    THRU 5120-EXIT.                         
      *    STRING F200-DTE-BKAPPMT-DATE(7:2) ' '                                
      *           WS-MONTH-DESC ' ' F200-DTE-BKAPPMT-DATE(1:4)                  
      *           DELIMITED BY SIZE INTO LR48-APPMT-DATE                        
      *    END-STRING.                                                          
                                                                                
      *    MOVE    F200-TME-BKAPPMT       TO  WS-APPMT-TIME.                    
                                                                                
           IF WS-APPMT-TIME NOT = SPACES                                        
              IF WS-APPMT-HR > 11                                               
                 MOVE 'PM'  TO LR48-APPMT-AM-PM                                 
              ELSE                                                              
                 MOVE 'AM'  TO LR48-APPMT-AM-PM                                 
           ELSE                                                                 
              MOVE SPACES   TO LR48-APPMT-AM-PM                                 
           END-IF.                                                              
                                                                                
           IF WS-APPMT-TIME NOT = SPACES                                        
              MOVE ':' TO LR48-COLON1                                           
              IF WS-APPMT-HR > 12                                               
                 COMPUTE WS-APPMT-HR = WS-APPMT-HR - 12                         
                 MOVE WS-APPMT-HR TO   LR48-APPMT-HR                            
              ELSE                                                              
                 MOVE WS-APPMT-HR TO   LR48-APPMT-HR                            
           ELSE                                                                 
              MOVE    SPACES      TO   LR48-APPMT-HR-R                          
                                       LR48-COLON1                              
           END-IF.                                                              
                                                                                
           MOVE  WS-APPMT-MIN     TO   LR48-APPMT-MIN.                          
                                                                                
      *--  PA APPMT DATE/TIME                                                   
                                                                                
      *    MOVE F200-DTE-BKAPPMT-DATE(5:2)   TO WS-MONTH.                       
      *    PERFORM 5120-DECODE-MONTH    THRU 5120-EXIT.                         
      *    STRING F200-DTE-BKAPPMT-DATE(7:2) ' '                                
      *           WS-MONTH-DESC ' ' F200-DTE-BKAPPMT-DATE(1:4)                  
      *           DELIMITED BY SIZE INTO LR48-APPMT-DATE-PA                     
      *    END-STRING.                                                          
      *    MOVE    F200-TME-BKAPPMT       TO  WS-APPMT-TIMEB.                   
      *                                                                         
           IF WS-APPMT-TIMEB NOT = SPACES                                       
              IF WS-APPMT-HRB > 11                                              
                 MOVE 'PM'  TO LR48-APPMT-AM-PM-A                               
              ELSE                                                              
                 MOVE 'AM'  TO LR48-APPMT-AM-PM-A                               
              END-IF                                                            
           ELSE                                                                 
              MOVE SPACES   TO LR48-APPMT-AM-PM-A                               
           END-IF.                                                              
                                                                                
           IF WS-APPMT-TIMEB NOT = SPACES                                       
              MOVE ':'             TO   LR48-COLON                              
              IF WS-APPMT-HRB > 12                                              
                 COMPUTE WS-APPMT-HRB = WS-APPMT-HRB - 12                       
                 MOVE WS-APPMT-HRB TO   LR48-APPMT-HR-A                         
              ELSE                                                              
                 MOVE WS-APPMT-HRB TO   LR48-APPMT-HR-A                         
              END-IF                                                            
           ELSE                                                                 
              MOVE    SPACES       TO   LR48-APPMT-HR-R-A                       
                                        LR48-COLON                              
           END-IF.                                                              
                                                                                
           MOVE  WS-APPMT-MINB    TO    LR48-APPMT-MIN-A.                       
      *--  LETTER PRINT DATE                                                    
           MOVE SPACES                  TO WS-MONTH-DESC.                       
           MOVE WS-C398-PRT-DATE(4:2)   TO WS-MONTH.                            
           PERFORM 5120-DECODE-MONTH    THRU 5120-EXIT.                         
           STRING WS-C398-PRT-DATE(1:2) ' '  WS-MONTH-DESC ' '                  
                  WS-C398-PRT-DATE(7:4) DELIMITED BY SIZE                       
                  INTO LR48-DATE                                                
           END-STRING.                                                          
                                                                                
           MOVE SPACES                   TO K060-KEY-FLD.                       
           MOVE 91                       TO K060-SERIAL-NO.                     
           IF K800-NUM-ALLO-CAT = 'BTO'                                         
              MOVE K800-NUM-BTO-ZONE        TO K060-CODE                        
           ELSE                                                                 
              MOVE K800-NUM-NEW-TOWN        TO K060-CODE                        
           END-IF                                                               
           PERFORM 5130-READ-BP13K060    THRU 5130-EXIT.                        
                                                                                
           IF K800-NUM-ALLO-CAT = 'BTO'                                         
              IF K060-DESC(1:8) = 'BIDADARI' AND                                
                 K800-DTE-BALLOT >= '201511'                                    
                 MOVE 'TOA PAYOH(BIDADARI)' TO LR48-ZONE4D                      
              ELSE                                                              
                 MOVE K060-DESC             TO LR48-ZONE4D                      
              END-IF                                                            
           ELSE                                                                 
              MOVE K060-DESC                TO LR48-ZONE4D                      
           END-IF.                                                              
                                                                                
           IF (K800-NUM-FLAT-TYPE = '1F') AND                                   
              (K800-NUM-JT-BALLOT-REGN NOT = SPACES AND LOW-VALUES)             
              MOVE K800-NUM-JT-BALLOT-REGN to LR48-REGN-JOINT                   
           END-IF.                                                              
                                                                                
           MOVE SPACES                       TO LR48-BK-FEE                     
                                                LR48-BK-FEE-A                   
                                                LR48-BK-FEE-B.                  
                                                                                
           EVALUATE K800-NUM-FLAT-TYPE                                          
               WHEN '1A'                                                        
               WHEN '2A'                                                        
                    MOVE 'STUDIO APARTMENT'  TO LR48-FLAT-TYPE4B                
                    MOVE '$250   '           TO LR48-BK-FEE                     
                                                LR48-BK-FEE-A                   
                                                LR48-BK-FEE-B                   
               WHEN '2 '                                                        
                    MOVE '2-ROOM FLAT'  TO LR48-FLAT-TYPE4B                     
                    MOVE '$500   '           TO LR48-BK-FEE                     
                                                LR48-BK-FEE-A                   
                                                LR48-BK-FEE-B                   
               WHEN '2F'                                                        
                    MOVE '2-ROOM FLEXI FLAT' TO LR48-FLAT-TYPE4B                
                    MOVE '$500   '           TO LR48-BK-FEE                     
                                                LR48-BK-FEE-A                   
                                                LR48-BK-FEE-B                   
               WHEN '1F'                                                        
                    MOVE 'COMMUNITY CARE APT' TO LR48-FLAT-TYPE4B               
                    MOVE '$500   '           TO LR48-BK-FEE                     
                                                LR48-BK-FEE-A                   
                                                LR48-BK-FEE-B                   
               WHEN '3 '                                                        
               WHEN '3P'                                                        
                    MOVE '3-ROOM FLAT'  TO LR48-FLAT-TYPE4B                     
                    MOVE '$1,000 '           TO LR48-BK-FEE                     
                                                LR48-BK-FEE-A                   
                                                LR48-BK-FEE-B                   
               WHEN '4 '                                                        
                    MOVE '4-ROOM FLAT'  TO LR48-FLAT-TYPE4B                     
                    MOVE '$2,000 '           TO LR48-BK-FEE                     
                                                LR48-BK-FEE-A                   
                                                LR48-BK-FEE-B                   
               WHEN '5 '                                                        
                    MOVE '5-ROOM FLAT'  TO LR48-FLAT-TYPE4B                     
                    MOVE '$2,000 '           TO LR48-BK-FEE                     
                                                LR48-BK-FEE-A                   
                                                LR48-BK-FEE-B                   
               WHEN 'E '                                                        
                    MOVE 'EXECUTIVE FLAT'  TO LR48-FLAT-TYPE4B                  
                    MOVE '$2,000 '           TO LR48-BK-FEE                     
                                                LR48-BK-FEE-A                   
                                                LR48-BK-FEE-B                   
           END-EVALUATE.                                                        
                                                                                
           IF K800-NUM-GEN3 = 'Y'                                               
              MOVE '5-ROOM/3GEN FLAT'  TO LR48-FLAT-TYPE4B                      
           END-IF.                                                              
                                                                                
           IF K800-NUM-ALLO-CAT = 'SBF'                                         
              MOVE SPACES           TO K246-KEY-FLD                             
              MOVE K800-DTE-BALLOT  TO K246-DTE-BALLOT                          
              MOVE K060-DESC        TO K246-NUM-NEW-TOWN                        
              EVALUATE K800-NUM-FLAT-TYPE                                       
                WHEN '1A'                                                       
                WHEN '2A'                                                       
                  MOVE 'SA    '     TO K246-NUM-FLAT-TYPE                       
                WHEN '2 '                                                       
                WHEN '2F'                                                       
                  MOVE '2-ROOM'     TO K246-NUM-FLAT-TYPE                       
                WHEN '3 '                                                       
                  MOVE '3-ROOM'     TO K246-NUM-FLAT-TYPE                       
                WHEN '3P'                                                       
                  MOVE '3P-ROOM'    TO K246-NUM-FLAT-TYPE                       
                WHEN '4 '                                                       
                  MOVE '4-ROOM'     TO K246-NUM-FLAT-TYPE                       
                WHEN '5 '                                                       
                  MOVE '5-ROOM'     TO K246-NUM-FLAT-TYPE                       
                WHEN 'E '                                                       
                  MOVE 'EXECUTIVE'  TO K246-NUM-FLAT-TYPE                       
              END-EVALUATE                                                      
              PERFORM 5140-READ-BP13K246 THRU 5140-EXIT                         
           END-IF.                                                              
                                                                                
           MOVE  SPACES               TO LR48-INC-CEILING.                      
                                                                                
           IF F200-DTE-BALLOT >= '201511'                                       
              IF K813-NUM-MATURE-EST-TAG = 'N'                                  
                 IF K800-NUM-FLAT-TYPE = '3 ' OR '3P'                           
                    MOVE K813-AMT-INCOME-CEILING TO WS-INCOME-CEILING           
                    STRING 'INCOME CEILING $'                                   
                           WS-INCOME-CEILING DELIMITED BY SIZE                  
                           INTO LR48-INC-CEILING                                
                    END-STRING                                                  
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              IF F200-DTE-BALLOT >= '201502'                                    
                 IF K813-NUM-MATURE-EST-TAG = 'N'                               
                    IF K800-NUM-FLAT-TYPE = '3 '                                
                       MOVE 'INCOME CEILING $5,000'                             
                                      TO LR48-INC-CEILING                       
                    END-IF                                                      
                    IF K800-NUM-FLAT-TYPE = '3P'                                
                       MOVE 'INCOME CEILING $10,000'                            
                                      TO LR48-INC-CEILING                       
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *--  BALLOT DATE                                                          
           MOVE SPACES                  TO WS-MONTH-DESC.                       
           MOVE F200-DTE-BALLOT(5:2)    TO WS-MONTH.                            
           PERFORM 5120-DECODE-MONTH    THRU 5120-EXIT.                         
                                                                                
           STRING WS-MONTH-DESC ' ' F200-DTE-BALLOT(1:4) ' '                    
                  DELIMITED BY SIZE                                             
                  INTO LR48-DTE-BALLOT                                          
           END-STRING.                                                          
                                                                                
           MOVE SPACES                      TO LR48-MODE-SALE                   
                                               LR48-MODE-SALE2.                 
                                                                                
           IF K800-NUM-ALLO-CAT = 'BTO'                                         
              MOVE 'BUILD-TO-ORDER'         TO LR48-MODE-SALE                   
           ELSE                                                                 
              IF K800-NUM-ALLO-CAT = 'ROF'                                      
                 MOVE 'RE-OFFER OF              ' TO LR48-MODE-SALE             
                 MOVE 'BALANCE FLATS            ' TO LR48-MODE-SALE2            
              ELSE                                                              
                 MOVE 'SALE OF BALANCE FLATS'     TO LR48-MODE-SALE             
              END-IF                                                            
           END-IF.                                                              
                                                                                
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       5105-READ-BP13K200.                                                      
      ************************************************************              
           MOVE F200-NUM-GROPA-REGN      TO K200-NUM-REGN.                      
                                                                                
           READ BP13K200 KEY IS K200-NUM-REGN.                                  
                                                                                
           EVALUATE WS-K200-STATUS                                              
               WHEN 00                                                          
                    CONTINUE                                                    
               WHEN 10                                                          
               WHEN 23                                                          
      *             ADD 1                TO WS-K200-NFND-CNT                    
                    MOVE SPACES          TO BP13K200-REC                        
                    DISPLAY 'REGN NO. NOT FOUND IN BP13K200. REGN = '           
                            F200-NUM-GROPA-REGN                                 
               WHEN OTHER                                                       
                    DISPLAY 'READ ERROR BP13K200, STATUS '                      
                            WS-K200-STATUS ' ' F200-NUM-GROPA-REGN              
                    MOVE WS-K200-STATUS  TO RETURN-CODE                         
                    EXIT PROGRAM                                                
           END-EVALUATE.                                                        
                                                                                
       5105-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       5110-GET-REGN-CHKDIGIT.                                                  
      *-------------------------------------------------------------            
                                                                                
           STRING 'SL' F200-NUM-REGN DELIMITED BY SIZE                          
             INTO  WS-C908-TXT-INPUT.                                           
                                                                                
           MOVE SPACES               TO WS-C908-TXT-OUTPUT.                     
           MOVE 10                   TO WS-C908-TXT-IN-SIZE.                    
           MOVE ZEROS                TO WS-C908-RETCODE                         
                                        WS-C908-TXT-OUT-SIZE.                   
                                                                                
           CALL 'BP13C908'    USING WS-C908-PARAMETERS.                         
                                                                                
           IF WS-C908-RETCODE = ZEROS                                           
              MOVE WS-C908-TXT-OUTPUT(1:WS-C908-TXT-OUT-SIZE) TO                
                   LR48-BARCODE-REGN                                            
           ELSE                                                                 
              DISPLAY 'ERROR IN BP13C908-REGN: ' WS-C908-TXT-INPUT              
              MOVE SPACES                 TO  LR48-BARCODE-REGN.                
                                                                                
       5110-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------*              
       5120-DECODE-MONTH.                                                       
      *----------------------------------------------------------*              
           EVALUATE WS-MONTH                                                    
               WHEN '01'                                                        
                  MOVE 'JAN'        TO WS-MONTH-DESC                            
               WHEN '02'                                                        
                  MOVE 'FEB'        TO WS-MONTH-DESC                            
               WHEN '03'                                                        
                  MOVE 'MAR'        TO WS-MONTH-DESC                            
               WHEN '04'                                                        
                  MOVE 'APR'        TO WS-MONTH-DESC                            
               WHEN '05'                                                        
                  MOVE 'MAY'        TO WS-MONTH-DESC                            
               WHEN '06'                                                        
                  MOVE 'JUN'        TO WS-MONTH-DESC                            
               WHEN '07'                                                        
                  MOVE 'JUL'        TO WS-MONTH-DESC                            
               WHEN '08'                                                        
                  MOVE 'AUG'        TO WS-MONTH-DESC                            
               WHEN '09'                                                        
                  MOVE 'SEP'        TO WS-MONTH-DESC                            
               WHEN '10'                                                        
                  MOVE 'OCT'        TO WS-MONTH-DESC                            
               WHEN '11'                                                        
                  MOVE 'NOV'        TO WS-MONTH-DESC                            
               WHEN '12'                                                        
                  MOVE 'DEC'        TO WS-MONTH-DESC                            
           END-EVALUATE.                                                        
                                                                                
       5120-EXIT.                                                               
            EXIT.                                                               
                                                                                
      **************************************************************            
       5130-READ-BP13K060.                                                      
      **************************************************************            
           READ BP13K060.                                                       
                                                                                
           EVALUATE WS-K060-STATUS                                              
               WHEN 00                                                          
                    CONTINUE                                                    
               WHEN 23                                                          
                    MOVE SPACES     TO K060-DESC                                
                    DISPLAY 'BP13K060 RECORD NOT FOUND : ' K060-KEY-FLD         
               WHEN OTHER                                                       
                    DISPLAY 'BP13K060 READ FILE ERROR : ' WS-K060-STATUS        
                    MOVE WS-K060-STATUS  TO RETURN-CODE                         
                    EXIT PROGRAM                                                
           END-EVALUATE.                                                        
                                                                                
       5130-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       5140-READ-BP13K246.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13K246.                                                       
                                                                                
           EVALUATE WS-K246-STATUS                                              
               WHEN 00                                                          
                 IF K246-COMBINED-FT = 'EXECUTIVE'                              
                    MOVE 'EXEC' TO K246-COMBINED-FT                             
                 END-IF                                                         
                 IF K246-NUM-FLAT-TYPE = 'EXECUTIVE'                            
                    MOVE 'EXEC' TO K246-NUM-FLAT-TYPE                           
                 END-IF                                                         
                 IF K800-NUM-NEW-TOWN = 'CT'                                    
                    IF K800-NUM-FLAT-TYPE = '4 '                                
                       MOVE 'S1 APT   '     TO K246-NUM-FLAT-TYPE               
                    ELSE                                                        
                       IF K800-NUM-FLAT-TYPE = '5 '                             
                          MOVE 'S2 APT   '     TO K246-NUM-FLAT-TYPE            
                       END-IF                                                   
                    END-IF                                                      
                    IF K246-COMBINED-FT NOT = SPACES AND LOW-VALUES             
                          MOVE SPACES       TO WS-STRING-TO-PARSE               
                          STRING K246-COMBINED-FT(1:9) '/'                      
                                 K246-NUM-FLAT-TYPE(1:9)                        
                              DELIMITED BY SIZE INTO WS-STRING-TO-PARSE         
                          MOVE LENGTH OF WS-STRING-TO-PARSE                     
                                         TO WS-STRING-LENGTH                    
                          MOVE 'Y'       TO WS-INSERT-SPACE-FLAG                
                          PERFORM 5150-PARSE-STRING    THRU 5150-EXIT           
                          MOVE WS-PARSED-STRING TO  LR48-FLAT-TYPE4B            
                    END-IF                                                      
                 ELSE                                                           
                    IF K246-COMBINED-FT NOT = SPACES AND LOW-VALUES             
                       IF K246-NUM-FT-TAG = 'N'                                 
                          MOVE SPACES       TO WS-STRING-TO-PARSE               
                          STRING K246-COMBINED-FT(1:1) '/'                      
                                 K246-NUM-FLAT-TYPE(1:9) ' FLAT'                
                              DELIMITED BY SIZE INTO WS-STRING-TO-PARSE         
                          MOVE LENGTH OF WS-STRING-TO-PARSE                     
                                         TO WS-STRING-LENGTH                    
                          MOVE 'Y'          TO WS-INSERT-SPACE-FLAG             
                          PERFORM 5150-PARSE-STRING    THRU 5150-EXIT           
                          MOVE WS-PARSED-STRING TO  LR48-FLAT-TYPE4B            
                          IF LR48-FLAT-TYPE4B = '5/EXEC FLAT'                   
                             MOVE '5-ROOM/EXEC' TO LR48-FLAT-TYPE4B             
                          END-IF                                                
                       ELSE                                                     
                          MOVE SPACES       TO WS-STRING-TO-PARSE               
                          STRING K246-NUM-FLAT-TYPE(1:9) '/'                    
                              K246-COMBINED-FT(1:9) ' FLAT'                     
                              DELIMITED BY SIZE INTO WS-STRING-TO-PARSE         
                          MOVE LENGTH OF WS-STRING-TO-PARSE                     
                                          TO WS-STRING-LENGTH                   
                          MOVE 'Y'        TO WS-INSERT-SPACE-FLAG               
                          PERFORM 5150-PARSE-STRING    THRU 5150-EXIT           
                          MOVE WS-PARSED-STRING TO  LR48-FLAT-TYPE4B            
      *                   IF LR48-FLAT-TYPE4B = '5-ROOM/EXEC FLAT' AND          
                          IF K800-NUM-GEN3 = 'Y'                                
                             MOVE '5-ROOM/3GEN/EXEC FLAT'                       
                                                TO  LR48-FLAT-TYPE4B            
                          END-IF                                                
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
                 IF K246-COMBINED-NT NOT = SPACES AND LOW-VALUES                
                    IF K246-NUM-NT-TAG = 'Y'                                    
                       IF K246-COMBINED-NT = 'JURONG WEST         '             
                          MOVE 'WEST'   TO K246-COMBINED-NT                     
                       END-IF                                                   
                       MOVE SPACES       TO WS-STRING-TO-PARSE                  
                       STRING K246-NUM-NEW-TOWN '/ '                            
                              K246-COMBINED-NT                                  
                              DELIMITED BY SIZE INTO WS-STRING-TO-PARSE         
                       END-STRING                                               
                       MOVE LENGTH OF WS-STRING-TO-PARSE                        
                                         TO WS-STRING-LENGTH                    
                       MOVE 'Y'          TO WS-INSERT-SPACE-FLAG                
                       PERFORM 5150-PARSE-STRING    THRU 5150-EXIT              
                       MOVE WS-PARSED-STRING   TO  LR48-ZONE4D                  
                    ELSE                                                        
                       IF K246-NUM-NEW-TOWN = 'JURONG WEST         '            
                          MOVE 'WEST'   TO K246-NUM-NEW-TOWN                    
                       END-IF                                                   
                       MOVE SPACES       TO WS-STRING-TO-PARSE                  
                       STRING K246-COMBINED-NT '/ '                             
                              K246-NUM-NEW-TOWN                                 
                              DELIMITED BY SIZE INTO WS-STRING-TO-PARSE         
                       END-STRING                                               
                       MOVE LENGTH OF WS-STRING-TO-PARSE                        
                                         TO WS-STRING-LENGTH                    
                       MOVE 'Y'          TO WS-INSERT-SPACE-FLAG                
                       PERFORM 5150-PARSE-STRING    THRU 5150-EXIT              
                       MOVE WS-PARSED-STRING   TO  LR48-ZONE4D                  
                    END-IF                                                      
                 END-IF                                                         
                 IF K246-COMBINED-FT NOT = SPACES AND LOW-VALUES                
                    IF K800-NUM-FLAT-TYPE = '4 '                                
                       MOVE ' 1,000/$ 2,000'      TO LR48-BK-FEE                
                                                     LR48-BK-FEE-A              
                                                     LR48-BK-FEE-B              
                    END-IF                                                      
                 END-IF                                                         
               WHEN 23                                                          
                    DISPLAY 'BP13K246 RECORD NOT FOUND : ' K246-KEY-FLD         
               WHEN OTHER                                                       
                    DISPLAY 'BP13K246 READ FILE ERROR : ' WS-K246-STATUS        
                    MOVE WS-K246-STATUS  TO RETURN-CODE                         
                    EXIT PROGRAM                                                
           END-EVALUATE.                                                        
                                                                                
       5140-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------------           
       5150-PARSE-STRING.                                                       
      *--------------------------------------------------------------           
           MOVE SPACES                    TO   WS-PARSED-STRING.                
           MOVE 1                         TO   WS-CUR-POS-PS.                   
           ADD  1                         TO   WS-STRING-LENGTH.                
           PERFORM 5160-GET-CHAR          THRU 5160-EXIT                        
              VARYING WS-CUR-POS-SP FROM 1 BY 1                                 
              UNTIL WS-CUR-POS-SP = WS-STRING-LENGTH.                           
                                                                                
       5150-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *---------------------------------------------------------------          
       5160-GET-CHAR.                                                           
      *---------------------------------------------------------------          
           IF WS-STRING-TO-PARSE(WS-CUR-POS-SP:1) NOT = SPACES                  
              IF WS-SPACE-FLAG = 'Y' AND                                        
                 WS-INSERT-SPACE-FLAG = 'Y' AND                                 
                 WS-PARSED-STRING NOT = SPACES                                  
                 MOVE ' ' TO WS-PARSED-STRING(WS-CUR-POS-PS:1)                  
                 ADD 1           TO  WS-CUR-POS-PS                              
              END-IF                                                            
              MOVE WS-STRING-TO-PARSE(WS-CUR-POS-SP:1)                          
                              TO  WS-PARSED-STRING(WS-CUR-POS-PS:1)             
              ADD 1           TO  WS-CUR-POS-PS                                 
              MOVE    'N'      TO WS-SPACE-FLAG                                 
           ELSE                                                                 
              MOVE 'Y'     TO WS-SPACE-FLAG                                     
           END-IF.                                                              
                                                                                
       5160-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------------            
       5200-GET-NAME-ADDR.                                                      
      *-------------------------------------------------------------            
           PERFORM 5210-DECODE-RELATIONSHIP THRU 5210-EXIT.                     
                                                                                
           MOVE WS-C398-NME-OCCUPIER(1)     TO LR48-APPLN-NAME                  
           IF WS-C398-NRIC(2) NOT = SPACES AND LOW-VALUES                       
              MOVE WS-C398-NME-OCCUPIER(2)  TO LR48-COAPPLN-NAME                
           ELSE                                                                 
              MOVE SPACES                   TO LR48-COAPPLN-NAME                
           END-IF.                                                              
           PERFORM 5220-GET-ADDR THRU 5220-EXIT.                                
                                                                                
       5200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       5210-DECODE-RELATIONSHIP.                                                
      *-------------------------------------------------------------            
           PERFORM VARYING IDX FROM 1 BY 1 UNTIL                                
               IDX > 12                                                         
               IF (WS-C398-NRIC(IDX) NOT = SPACES AND LOW-VALUES) AND           
                 (WS-C398-RELATIONSHIP(IDX) NOT = SPACES AND LOW-VALUES)        
                  MOVE SPACES                     TO K060-KEY-FLD               
                  MOVE '35'                       TO K060-SERIAL-NO             
                  MOVE WS-C398-RELATIONSHIP(IDX)  TO K060-CODE                  
                  PERFORM 5130-READ-BP13K060    THRU 5130-EXIT                  
                  MOVE K060-DESC                  TO WS-REL(IDX)                
               END-IF                                                           
                                                                                
           END-PERFORM.                                                         
                                                                                
       5210-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       5220-GET-ADDR.                                                           
      *-------------------------------------------------------------            
           MOVE SPACES                TO LR48-BLK-NO                            
                                         LR48-NUM-FLAT                          
                                         LR48-CODE                              
                                         WS-STREET-NAME                         
                                         WS-BLK-NO.                             
                                                                                
           MOVE K800-NUM-REGN TO K830-NUM-REGN.                                 
           READ BP13K830 KEY IS K830-NUM-REGN.                                  
                                                                                
           EVALUATE WS-K830-STATUS                                              
              WHEN  00                                                          
              WHEN  02                                                          
                    IF (K830-NUM-MAIL-ADDR  = SPACES OR LOW-VALUES) OR          
                       ((K830-NUM-MAIL-LVL-CHAR = '#') AND                      
                       (K830-NUM-MAIL-LVL-NUM = SPACES OR LOW-VALUES))          
                       IF K830-NUM-ADDR-TYPE  = 'H'                             
                          MOVE K830-NUM-BLK       TO WS-BLK-NO                  
                          MOVE K830-NME-STREET    TO WS-STREET-NAME             
                          MOVE K830-NUM-LVL-CHAR  TO LR48-CHAR                  
                          MOVE K830-NUM-LVL-NUM   TO LR48-LEVEL                 
                          MOVE K830-NUM-LVL-DASH  TO LR48-DASH                  
                          MOVE K830-NUM-HSEMAIN   TO LR48-HSE-MAIN              
                          MOVE K830-NUM-HSESUB    TO LR48-HSE-SUB               
                          PERFORM 5221-GET-STREET-NAME  THRU 5221-EXIT          
                          STRING 'SINGAPORE ' K830-NUM-POSTAL                   
                                  DELIMITED BY SIZE INTO LR48-CODE              
                       ELSE                                                     
                          MOVE K830-NUM-BLK         TO WS-BLK-NO                
                          MOVE K830-NUM-FLAT        TO LR48-NUM-FLAT            
                          MOVE K830-NME-STREET-BLDG TO WS-STREET-NAME           
                          PERFORM 5221-GET-STREET-NAME  THRU 5221-EXIT          
                          IF K830-NUM-POSTAL = SPACES OR LOW-VALUES OR          
                                               ZEROES                           
                             MOVE SPACES TO LR48-CODE                           
                          ELSE                                                  
                             STRING 'SINGAPORE ' K830-NUM-POSTAL                
                                     DELIMITED BY SIZE INTO LR48-CODE           
                          END-IF                                                
                       END-IF                                                   
                    ELSE                                                        
                       IF K830-NUM-MAIL-ADDR-TYPE =  'H'                        
                          MOVE K830-NUM-MAIL-BLK      TO WS-BLK-NO              
                          MOVE K830-NME-MAIL-STREET                             
                                     TO WS-STREET-NAME                          
                          MOVE K830-NUM-MAIL-LVL-CHAR TO LR48-CHAR              
                          MOVE K830-NUM-MAIL-LVL-NUM  TO LR48-LEVEL             
                          MOVE K830-NUM-MAIL-LVL-DASH TO LR48-DASH              
                          MOVE K830-NUM-MAIL-HSEMAIN  TO LR48-HSE-MAIN          
                          MOVE K830-NUM-MAIL-HSESUB   TO LR48-HSE-SUB           
                          PERFORM 5221-GET-STREET-NAME   THRU 5221-EXIT         
                          STRING 'SINGAPORE '   K830-NUM-MAIL-POSTAL            
                                  DELIMITED BY SIZE INTO LR48-CODE              
                       ELSE                                                     
                          MOVE K830-NUM-MAIL-BLK      TO WS-BLK-NO              
                          MOVE K830-NME-MAIL-STR-BLDG                           
                                            TO WS-STREET-NAME                   
                          MOVE K830-NUM-MAIL-FLAT TO LR48-NUM-FLAT              
                          PERFORM 5221-GET-STREET-NAME  THRU 5221-EXIT          
                          IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES        
                                            OR ZEROES                           
                             MOVE SPACES TO LR48-CODE                           
                          ELSE                                                  
                             STRING 'SINGAPORE '   K830-NUM-MAIL-POSTAL         
                                   DELIMITED BY SIZE INTO LR48-CODE             
                          END-IF                                                
                       END-IF                                                   
                   END-IF                                                       
              WHEN 23                                                           
                   MOVE SPACES  TO LR48-NUM-FLAT                                
                                   LR48-BLK-NO                                  
                                   LR48-CODE                                    
              WHEN OTHER                                                        
                   DISPLAY 'ERROR READING BP13K830 = ' WS-K830-STATUS           
                   DISPLAY '      K830-NUM-REGN    = ' K830-NUM-REGN            
                   EXIT PROGRAM                                                 
           END-EVALUATE.                                                        
                                                                                
       5220-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       5221-GET-STREET-NAME.                                                    
      *-------------------------------------------------------------            
           MOVE SPACES       TO WS-STRING-TO-PARSE.                             
           STRING WS-BLK-NO ' ' WS-STREET-NAME                                  
                  DELIMITED BY SIZE INTO WS-STRING-TO-PARSE                     
           END-STRING.                                                          
           MOVE LENGTH OF WS-STRING-TO-PARSE                                    
                             TO WS-STRING-LENGTH                                
           MOVE 'Y'          TO WS-INSERT-SPACE-FLAG                            
           PERFORM 5150-PARSE-STRING    THRU 5150-EXIT                          
           MOVE WS-PARSED-STRING   TO  LR48-BLK-NO.                             
                                                                                
       5221-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       5300-PRINT-3GEN-LETTER.                                                  
      *-------------------------------------------------------------            
            WRITE P13P89DA-REC FROM LR48-PRT-HDG-7.                             
            WRITE P13P89DA-REC FROM LR48-PRT-HDG-12  AFTER 13.                  
                                                                                
            IF K800-DTE-BALLOT < '201505' AND                                   
               K800-NUM-ALLO-CAT = 'SBF'                                        
               WRITE P13P89DA-REC FROM DJDE-LINE-BTO-S2E-NEW                    
                                                   AFTER PAGE                   
               ADD 1 TO WS-REGN-PAGE-CNT                                        
               WRITE P13P89DA-REC AFTER 5                                       
               WRITE P13P89DA-REC FROM DJDE-LINE-COVID AFTER PAGE               
               ADD 1 TO WS-REGN-PAGE-CNT                                        
            ELSE                                                                
               IF K800-NUM-ALLO-CAT = 'BTO'                                     
                  WRITE P13P89DA-REC FROM DJDE-LINE-BTO-S2F-NEW                 
                                                   AFTER PAGE                   
                  ADD 1 TO WS-REGN-PAGE-CNT                                     
                  WRITE P13P89DA-REC AFTER 5                                    
                  WRITE P13P89DA-REC FROM DJDE-LINE-COVID AFTER PAGE            
                  ADD 1 TO WS-REGN-PAGE-CNT                                     
               ELSE                                                             
                  WRITE P13P89DA-REC FROM DJDE-LINE-BTO-S2D-NEW                 
                                                   AFTER PAGE                   
                  ADD 1 TO WS-REGN-PAGE-CNT                                     
                  WRITE P13P89DA-REC AFTER 5                                    
                  WRITE P13P89DA-REC FROM DJDE-LINE-COVID AFTER PAGE            
                  ADD 1 TO WS-REGN-PAGE-CNT                                     
               END-IF                                                           
            END-IF.                                                             
                                                                                
            WRITE P13P89DA-REC AFTER 5.                                         
                                                                                
       5300-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------------            
       5400-PRINT-PAGE1.                                                        
      *-------------------------------------------------------------            
           MOVE SPACES        TO P13P89DA-REC.                                  
                                                                                
                                                                                
           IF K800-NUM-MGPS = 'P' OR 'C'                                        
              IF WS-NUM-QUEUE = SPACES OR LOW-VALUES                            
                  WRITE P13P89DA-REC FROM DJDE-LINE-MGP-SD-NEW                  
                                                            AFTER PAGE          
              ELSE                                                              
                 IF (WS-NUM-QUEUE <= K813-NUM-QUEUE-MID)                        
                    WRITE P13P89DA-REC FROM DJDE-LINE-MGP-SA-NEW                
                                                             AFTER PAGE         
                 ELSE                                                           
                    IF ((WS-NUM-QUEUE > K813-NUM-QUEUE-MID)             ND      
                                 AND                                            
                        (WS-NUM-QUEUE <= K813-NUM-QUEUE-END))                   
                           WRITE P13P89DA-REC FROM DJDE-LINE-MGP-SB-NEW         
                                                             AFTER PAGE         
                    ELSE                                                        
                        IF (WS-NUM-QUEUE > K813-NUM-QUEUE-END)                  
                            WRITE P13P89DA-REC FROM DJDE-LINE-MGP-SC-NEW        
                                                             AFTER PAGE         
                        END-IF                                                  
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              IF K800-NUM-ALLO-SCHEME = 'GRO'                                   
                 IF WS-NUM-QUEUE = SPACES OR LOW-VALUES                         
                    WRITE P13P89DA-REC FROM DJDE-LINE-GRO-SD-NEW                
                                                            AFTER PAGE          
                 ELSE                                                           
                    IF (WS-NUM-QUEUE <= K813-NUM-QUEUE-MID)                     
                       WRITE P13P89DA-REC FROM DJDE-LINE-GRO-SA-NEW             
                                                             AFTER PAGE         
                    ELSE                                                        
                       IF ((WS-NUM-QUEUE > K813-NUM-QUEUE-MID)          ND      
                                    AND                                         
                           (WS-NUM-QUEUE <= K813-NUM-QUEUE-END))                
                           WRITE P13P89DA-REC FROM DJDE-LINE-GRO-SB-NEW         
                                                             AFTER PAGE         
                       ELSE                                                     
                           IF (WS-NUM-QUEUE > K813-NUM-QUEUE-END)               
                           WRITE P13P89DA-REC FROM DJDE-LINE-GRO-SC-NEW         
                                                             AFTER PAGE         
                           END-IF                                               
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              ELSE                                                              
                 IF K800-NUM-FLAT-TYPE = '1F'                                   
                    IF K800-NUM-JT-BALLOT-REGN = SPACES OR LOW-VALUES           
                       WRITE P13P89DA-REC FROM DJDE-LINE-PAGE1-CCA              
                                                            AFTER PAGE          
                    ELSE                                                        
                       WRITE P13P89DA-REC FROM DJDE-LINE-PAGE1-CCA-JT           
                                                            AFTER PAGE          
                    END-IF                                                      
                 ELSE                                                           
                    MOVE SPACES       TO   P13P89DA-REC                         
                    WRITE P13P89DA-REC FROM DJDE-LINE-PAGE1 AFTER PAGE          
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
           ADD 1 TO WS-REGN-PAGE-CNT.                                           
                                                                                
       5400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       5500-PRINT-PAGE2.                                                        
      *-------------------------------------------------------------            
           IF K800-NUM-MGPS = 'P' OR 'C'                                        
             IF K800-NUM-FLAT-TYPE NOT = '1A' AND '2A'                          
              IF (WS-NUM-QUEUE = SPACES OR LOW-VALUES)                          
                  MOVE  SPACES         TO    P13P89DA-REC                       
                  WRITE P13P89DA-REC FROM DJDE-LINE-MGP-S2B-NEW                 
                                                            AFTER PAGE          
                  ADD 1 TO WS-REGN-PAGE-CNT                                     
                  WRITE P13P89DA-REC AFTER 5                                    
                  WRITE P13P89DA-REC FROM DJDE-LINE-COVID AFTER PAGE            
                  WRITE P13P89DA-REC AFTER 5                                    
                  ADD 1 TO WS-REGN-PAGE-CNT                                     
              ELSE                                                              
                 IF (WS-NUM-QUEUE <= K813-NUM-QUEUE-MID)                        
                   WRITE P13P89DA-REC FROM DJDE-LINE-MGP-S2-NEW                 
                                                             AFTER PAGE         
                   ADD 1 TO WS-REGN-PAGE-CNT                                    
                   WRITE P13P89DA-REC AFTER 5                                   
                   WRITE P13P89DA-REC FROM DJDE-LINE-COVID AFTER PAGE           
                   WRITE P13P89DA-REC AFTER 5                                   
                   ADD 1 TO WS-REGN-PAGE-CNT                                    
                 ELSE                                                           
                    IF ((WS-NUM-QUEUE > K813-NUM-QUEUE-MID)             ND      
                                 AND                                            
                        (WS-NUM-QUEUE <= K813-NUM-QUEUE-END))                   
                        WRITE P13P89DA-REC FROM DJDE-LINE-MGP-S2C-NEW           
                                                             AFTER PAGE         
                        ADD 1 TO WS-REGN-PAGE-CNT                               
                        WRITE P13P89DA-REC AFTER 5                              
                        WRITE P13P89DA-REC FROM DJDE-LINE-COVID                 
                                                             AFTER PAGE         
                        WRITE P13P89DA-REC AFTER 5                              
                        ADD 1 TO WS-REGN-PAGE-CNT                               
                    ELSE                                                        
                      IF (WS-NUM-QUEUE > K813-NUM-QUEUE-END)                    
                         MOVE  SPACES         TO    P13P89DA-REC                
                         WRITE P13P89DA-REC FROM DJDE-LINE-MGP-S2D              
                                       AFTER PAGE                               
                         ADD 1 TO WS-REGN-PAGE-CNT                              
                         WRITE P13P89DA-REC AFTER 5                             
                         WRITE P13P89DA-REC FROM DJDE-LINE-COVID                
                                       AFTER PAGE                               
                         WRITE P13P89DA-REC AFTER 5                             
                         ADD 1 TO WS-REGN-PAGE-CNT                              
                      END-IF                                                    
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           GO TO 5500-EXIT                                                      
           END-IF.                                                              
                                                                                
           IF K800-NUM-ALLO-SCHEME = 'GRO'                                      
              IF (WS-NUM-QUEUE = SPACES OR LOW-VALUES)                          
                  MOVE  SPACES         TO    P13P89DA-REC                       
                  WRITE P13P89DA-REC FROM DJDE-LINE-GRO-S2F-NEW                 
                                                             AFTER PAGE         
                  ADD 1 TO WS-REGN-PAGE-CNT                                     
                  WRITE P13P89DA-REC AFTER 5                                    
                  WRITE P13P89DA-REC FROM DJDE-LINE-COVID AFTER PAGE            
                  WRITE P13P89DA-REC AFTER 5                                    
                  ADD 1 TO WS-REGN-PAGE-CNT                                     
              ELSE                                                              
                 IF (WS-NUM-QUEUE <= K813-NUM-QUEUE-MID)                        
                   WRITE P13P89DA-REC FROM DJDE-LINE-GRO-S2B-NEW                
                                                              AFTER PAGE        
                   ADD 1 TO WS-REGN-PAGE-CNT                                    
                   WRITE P13P89DA-REC AFTER 5                                   
                   WRITE P13P89DA-REC FROM DJDE-LINE-COVID AFTER PAGE           
                   WRITE P13P89DA-REC AFTER 5                                   
                   ADD 1 TO WS-REGN-PAGE-CNT                                    
                 ELSE                                                           
                    IF ((WS-NUM-QUEUE > K813-NUM-QUEUE-MID)             ND      
                                 AND                                            
                        (WS-NUM-QUEUE <= K813-NUM-QUEUE-END))                   
                          WRITE P13P89DA-REC FROM DJDE-LINE-GRO-S2C-NEW         
                                                             AFTER PAGE         
                          ADD 1 TO WS-REGN-PAGE-CNT                             
                        WRITE P13P89DA-REC AFTER 5                              
                    ELSE                                                        
                      IF (WS-NUM-QUEUE > K813-NUM-QUEUE-END)                    
                         MOVE  SPACES         TO    P13P89DA-REC                
                         WRITE P13P89DA-REC FROM DJDE-LINE-GRO-S2D              
                                       AFTER PAGE                               
                         ADD 1 TO WS-REGN-PAGE-CNT                              
                         WRITE P13P89DA-REC AFTER 5                             
                      END-IF                                                    
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           GO TO 5500-EXIT                                                      
           END-IF.                                                              
                                                                                
           IF K800-NUM-ALLO-CAT = 'SBF'                                         
              MOVE  SPACES         TO    P13P89DA-REC                           
              WRITE P13P89DA-REC FROM DJDE-LINE-SBF-S2D AFTER PAGE              
              ADD 1 TO WS-REGN-PAGE-CNT                                         
              WRITE P13P89DA-REC AFTER 5                                        
              WRITE P13P89DA-REC FROM DJDE-LINE-COVID AFTER PAGE                
              WRITE P13P89DA-REC AFTER 5                                        
              ADD 1 TO WS-REGN-PAGE-CNT                                         
              GO TO 5500-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE  SPACES         TO    P13P89DA-REC                              
           IF K800-NUM-FLAT-TYPE NOT = '1A' AND '2A'                            
              IF (WS-NUM-QUEUE <= K813-NUM-QUEUE-MID)                           
                IF ((F205-CAT1-EIP-TAG = 'Y' AND K800-NUM-CAT = '1') OR         
                    (F205-CAT2-EIP-TAG = 'Y' AND K800-NUM-CAT = '2') OR         
                    (F205-CAT3-EIP-TAG = 'Y' AND                                
                    (K800-NUM-CAT = '3' OR '4')))                               
                    MOVE  SPACES         TO    P13P89DA-REC                     
                    WRITE P13P89DA-REC FROM DJDE-LINE-BTO-S2B-NEW               
                                                              AFTER PAGE        
                    ADD 1 TO WS-REGN-PAGE-CNT                                   
                    IF K800-NUM-FLAT-TYPE = '1F'                                
                       IF F200-DTE-BALLOT = '202211' AND                        
                          K813-CDE-NT = 'QT' AND                                
                          K813-NUM-SALES-MODE = 'BTO' AND                       
                          K813-NUM-EST = '946'                                  
                          WRITE P13P89DA-REC AFTER 5                            
                          WRITE P13P89DA-REC FROM DJDE-LINE-BTO-S2-CCA2         
                                                              AFTER PAGE        
                          ADD 1 TO WS-REGN-PAGE-CNT                             
                       ELSE                                                     
                          WRITE P13P89DA-REC AFTER 5                            
                          WRITE P13P89DA-REC FROM DJDE-LINE-BTO-S2-CCA          
                                                              AFTER PAGE        
                          ADD 1 TO WS-REGN-PAGE-CNT                             
                       END-IF                                                   
                    END-IF                                                      
                    WRITE P13P89DA-REC AFTER 5                                  
                    WRITE P13P89DA-REC FROM DJDE-LINE-COVID AFTER PAGE          
                    WRITE P13P89DA-REC AFTER 5                                  
                    ADD 1 TO WS-REGN-PAGE-CNT                                   
                ELSE                                                            
                    MOVE  SPACES         TO    P13P89DA-REC                     
                    WRITE P13P89DA-REC FROM DJDE-LINE-BTO-S2-NEW                
                                                              AFTER PAGE        
                    ADD 1 TO WS-REGN-PAGE-CNT                                   
                    IF K800-NUM-FLAT-TYPE = '1F'                                
                       IF F200-DTE-BALLOT = '202211' AND                        
                          K813-CDE-NT = 'QT' AND                                
                          K813-NUM-SALES-MODE = 'BTO' AND                       
                          K813-NUM-EST = '946'                                  
                          WRITE P13P89DA-REC AFTER 5                            
                          WRITE P13P89DA-REC FROM DJDE-LINE-BTO-S2-CCA2         
                                                              AFTER PAGE        
                          ADD 1 TO WS-REGN-PAGE-CNT                             
                       ELSE                                                     
                          WRITE P13P89DA-REC AFTER 5                            
                          WRITE P13P89DA-REC FROM DJDE-LINE-BTO-S2-CCA          
                                                              AFTER PAGE        
                          ADD 1 TO WS-REGN-PAGE-CNT                             
                       END-IF                                                   
                    END-IF                                                      
                    WRITE P13P89DA-REC AFTER 5                                  
                    WRITE P13P89DA-REC FROM DJDE-LINE-COVID AFTER PAGE          
                    WRITE P13P89DA-REC AFTER 5                                  
                    ADD 1 TO WS-REGN-PAGE-CNT                                   
                END-IF                                                          
              ELSE                                                              
                MOVE  SPACES         TO    P13P89DA-REC                         
                WRITE P13P89DA-REC FROM DJDE-LINE-BTO-S2B-NEW AFTER PAGE        
                ADD 1 TO WS-REGN-PAGE-CNT                                       
                IF K800-NUM-FLAT-TYPE = '1F'                                    
                   WRITE P13P89DA-REC AFTER 5                                   
                   WRITE P13P89DA-REC FROM DJDE-LINE-BTO-S2-CCA                 
                                                        AFTER PAGE              
                   ADD 1 TO WS-REGN-PAGE-CNT                                    
                END-IF                                                          
                WRITE P13P89DA-REC AFTER 5                                      
                WRITE P13P89DA-REC FROM DJDE-LINE-COVID AFTER PAGE              
                WRITE P13P89DA-REC AFTER 5                                      
                ADD 1 TO WS-REGN-PAGE-CNT                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       5500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6000-PRINT-ANNEX1.                                                       
      *-------------------------------------------------------------            
      * PRINT PRODUCE DOCUMENTS - ANNEX I FORM (BP13HC)      *                  
      *------------------------------------------------------*                  
           MOVE 'N'        TO WS-COMPLETED-HDR-PRINTED                          
                              WS-AHG-APPLN                                      
                              WS-AHG-SHG-SINGLES                                
                              WS-AHG-SHG-COUPLES                                
                              WS-AHG-SHG-FAMILY                                 
                              WS-AHG-COUPLES                                    
                              WS-AHG-FAMILY                                     
                              WS-AHG-APPLN-F120.                                
           MOVE WS-C398-NUM-REGN         TO LR5B-DOC1-REGN.                     
           MOVE WS-C398-PRT-DATE         TO LR5B-DOC1-DATE.                     
                                                                                
           MOVE  41        TO WS-LINE-CTR.                                      
           INITIALIZE         WS-HEADING-CTR.                                   
           MOVE WS-REGN-PAGE-CNT TO WS-HEADING-CTR.                             
           MOVE 'N'        TO WS-BLANK-PRINTED.                                 
                                                                                
           IF K800-NUM-ALLO-CAT = 'ROF'                                         
              CONTINUE                                                          
           ELSE                                                                 
              PERFORM 6400-CHECK-AHG-APPLN  THRU 6400-EXIT                      
           END-IF.                                                              
           PERFORM 6100-ANNEX-I             THRU 6100-EXIT                      
                VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 12.                   
           PERFORM 6200-OTHER-DOCUMENTS     THRU 6200-EXIT.                     
                                                                                
           IF K800-DTE-BALLOT >= '201909' AND                                   
              (WS-AHG-SHG-FAMILY = 'Y' OR WS-AHG-FAMILY = 'Y' OR                
               WS-AHG-SHG-COUPLES = 'Y' OR WS-AHG-COUPLES = 'Y' OR              
               WS-AHG-SHG-SINGLES = 'Y') AND WS-HFE NOT = 'Y'                   
               PERFORM 6350-PRINT-EHG-APPL-FORMS THRU 6350-EXIT                 
           END-IF.                                                              
                                                                                
           IF WS-HEADING-CTR NOT = 00 AND 02 AND 04 AND 06 AND 08 AND           
                                   10 AND 12 AND 14 AND 16 AND 18 AND           
                                   20 AND 22 AND 24 AND 26 AND 28 AND           
                                   30 AND 32 AND 34 AND 36 AND 38 AND           
                                   40 AND 42 AND 44 AND 46 AND 48               
              MOVE  SPACES         TO    P13P89DA-REC                           
              WRITE P13P89DA-REC FROM DJDE-BLANKF AFTER PAGE                    
              WRITE P13P89DA-REC AFTER 5                                        
              MOVE 'Y' TO WS-BLANK-PRINTED                                      
           END-IF.                                                              
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6100-ANNEX-I.                                                            
      *-------------------------------------------------------------            
           IF WS-C398-NRIC(WS-CTR)  NOT = SPACES AND LOW-VALUES                 
              IF WS-LINE-CTR > 29                                               
                MOVE  41    TO WS-LINE-CTR                                      
              END-IF                                                            
              PERFORM 6110-CHK-REGN-LINE-CTR       THRU 6110-EXIT               
                                                                                
              MOVE K800-DTE-REGN     TO WS-DTE-APPLICATION                      
                                                                                
              IF WS-C398-NUM-INCOME1(WS-CTR) = ZEROES AND                       
                 WS-C398-NUM-INCOME2(WS-CTR) = ZEROES AND                       
                 WS-C398-NUM-INCOME3(WS-CTR) = ZEROES                           
                 MOVE 'N'           TO WS-INCOME-FLAG                           
              END-IF                                                            
                                                                                
              MOVE WS-C398-DTE-INCOME1(WS-CTR) TO WS-DTE-INC1                   
              MOVE WS-DTE-INC1(5:2) TO WS-MONTH                                 
              PERFORM 5120-DECODE-MONTH THRU 5120-EXIT                          
              MOVE WS-MONTH-DESC TO WS-BALLOT-MONTH1                            
              MOVE WS-C398-DTE-INCOME2(WS-CTR) TO WS-DTE-INC2                   
              MOVE WS-DTE-INC2(5:2) TO WS-MONTH                                 
              PERFORM 5120-DECODE-MONTH THRU 5120-EXIT                          
              MOVE WS-MONTH-DESC TO WS-BALLOT-MONTH2                            
              MOVE WS-DTE-APPLICATION(1:6)  TO WS-DTE-REGN2                     
              SUBTRACT 1          FROM WS-DTE-REGN-MM2                          
              IF WS-DTE-REGN2(5:2) = 0                                          
                 MOVE 12            TO WS-DTE-REGN-MM2                          
                 SUBTRACT 1       FROM WS-DTE-REGN-CCYY2                        
              END-IF                                                            
              MOVE WS-DTE-REGN-MM2  TO WS-MONTH                                 
              PERFORM 5120-DECODE-MONTH THRU 5120-EXIT                          
              MOVE WS-MONTH-DESC TO WS-DTE-APPLY2                               
              IF WS-C398-EMP-STAT(WS-CTR) = '1'                                 
                 IF WS-INCOME-FLAG = 'Y' AND                                    
                    WS-C398-AGE2-OCCUPIER(WS-CTR) >= 18                         
                    PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT            
                    MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT               
                    IF WS-C398-NUM-INCOME1(WS-CTR) > ZEROES AND                 
                       WS-C398-NUM-INCOME2(WS-CTR) > ZEROES                     
                       STRING '( ) Income documents for  '                      
                       WS-BALLOT-MONTH1 ' '  WS-DTE-INC1(1:4)                   
                      ' and ' WS-BALLOT-MONTH2 ' '  WS-DTE-INC2(1:4)            
                        DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT               
                    ELSE                                                        
                       IF WS-C398-NUM-INCOME1(WS-CTR) > ZEROES                  
                          STRING '( ) Income documents for  '                   
                          WS-BALLOT-MONTH1 ' '  WS-DTE-INC1(1:4)                
                          DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT             
                       ELSE                                                     
                          IF WS-C398-NUM-INCOME2(WS-CTR) > ZEROES               
                             STRING '( ) Income documents for  '                
                             WS-BALLOT-MONTH2 ' '  WS-DTE-INC2(1:4)             
                             DELIMITED BY SIZE                                  
                             INTO LR5B-DOC2-DOCUMENT                            
                          END-IF                                                
                       END-IF                                                   
                    END-IF                                                      
                    WRITE P13P89DA-REC FROM LR5B-DOC2-LN-4 AFTER 2              
                    PERFORM 6120-CHK-NRIC-LINE-CTR THRU 6120-EXIT               
                    MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT               
                    STRING  '    (If you are employed in any of'                
                            ' the months)' DELIMITED BY SIZE                    
                            INTO LR5B-DOC2-DOCUMENT                             
                    WRITE P13P89DA-REC FROM LR5B-DOC2-LN-4 AFTER 1              
                    PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT            
                    MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT               
                                                                                
                    IF WS-C398-AGE2-OCCUPIER(WS-CTR) >= 18 AND                  
                       WS-C398-AGE2-OCCUPIER(WS-CTR) <= 61                      
                       STRING '( ) Undertaking confirming the period '          
                           'of unemployment'                                    
                           DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT            
                       WRITE P13P89DA-REC FROM LR5B-DOC2-LN-4 AFTER 1           
                    END-IF                                                      
                    PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT            
                    IF WS-C398-GENDER(WS-CTR) = '1' AND                         
                       WS-C398-AGE2-OCCUPIER(WS-CTR) >= 18 AND                  
                       WS-C398-AGE2-OCCUPIER(WS-CTR) <= 25                      
                       MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT            
                       STRING '( ) NS enlistment letter (for'                   
                              ' full-time National Serviceman)'                 
                           DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT            
                       WRITE P13P89DA-REC FROM LR5B-DOC2-LN-4 AFTER 2           
                    END-IF                                                      
                    MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT               
                    STRING '( ) Student pass/Student tran'                      
                           'script (for student)'                               
                        DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT               
                    WRITE P13P89DA-REC FROM LR5B-DOC2-LN-4 AFTER 2              
                    MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT               
                    STRING '( ) Letter from education ins'                      
                           'titute and Scholarship contract / Stipend'          
                        DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT               
                    WRITE P13P89DA-REC FROM LR5B-DOC2-LN-4 AFTER 2              
                    MOVE    SPACES     TO   LR5B-DOC2-DOCUMENT                  
                    STRING '    contract'                                       
                           ' (for student who are on scholarship)'              
                         DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT              
                    WRITE P13P89DA-REC FROM LR5B-DOC2-LN-4 AFTER 1              
                    ADD  15    TO WS-LINE-CTR                                   
                 ELSE                                                           
                    IF WS-INCOME-FLAG = 'N' AND                                 
                       WS-C398-AGE2-OCCUPIER(WS-CTR) >= 18 AND                  
                       WS-C398-AGE2-OCCUPIER(WS-CTR) <= 61                      
                       PERFORM 6120-CHK-NRIC-LINE-CTR THRU 6120-EXIT            
                       MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT            
                       STRING '( ) Undertaking confirming the period'           
                              ' of unemployment'                                
                       DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                
                       WRITE P13P89DA-REC FROM LR5B-DOC2-LN-4 AFTER 1           
                       ADD   5    TO WS-LINE-CTR                                
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
              IF WS-C398-EMP-STAT(WS-CTR) = '2'                                 
                 PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT               
                 MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT                  
                 STRING '( ) Payslip/gross income letter'                       
                       ' from previous employer stating the monthly'            
                   DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                    
                 WRITE P13P89DA-REC   FROM LR5B-DOC2-LN-4 AFTER 2               
                 MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT                  
                 STRING '    pension received from '                            
                   WS-BALLOT-MONTH1 ' '                                         
                   WS-DTE-INC1(1:4) ' to ' WS-DTE-APPLY2 ' '                    
                   WS-DTE-REGN-CCYY2                                            
                   DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                    
                 WRITE P13P89DA-REC   FROM LR5B-DOC2-LN-4 AFTER 1               
                 ADD   3    TO WS-LINE-CTR                                      
              END-IF                                                            
              IF (WS-C398-EMP-STAT(WS-CTR) = '3' OR '4') AND                    
                 (WS-HFE NOT = 'Y')                                             
                 PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT               
                 MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT                  
                 STRING '( ) Payslip/gross income letter'                       
                   ' from employer from ' WS-BALLOT-MONTH1 ' '                  
                   WS-DTE-INC1(1:4) ' to ' WS-DTE-APPLY2 ' '                    
                   WS-DTE-REGN-CCYY2                                            
                   DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                    
                 WRITE P13P89DA-REC   FROM LR5B-DOC2-LN-4 AFTER 2               
                 ADD   2    TO WS-LINE-CTR                                      
              END-IF                                                            
              IF WS-C398-EMP-STAT(WS-CTR) = '5'                                 
                 MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT                  
                 STRING '( ) Accounting & Corporate Regulatory '                
                        'Authority (ACRA) Computer Information '                
                        DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT               
                 WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4 AFTER 2                
                 MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT                  
                 STRING '    (Business Profile)/valid license of '              
                        'business/trade (if applicable)'                        
                        DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT               
                 WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4  AFTER 1               
                 PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT               
                 MOVE   SPACES         TO   LR5B-DOC2-DOCUMENT                  
                 STRING '( ) Latest Notice of Assessment and F'                 
                        'orm B from IRAS'                                       
                        DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT               
                 WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4  AFTER 2               
                 PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT               
                 MOVE   SPACES         TO   LR5B-DOC2-DOCUMENT                  
                 STRING '( ) Commission statement from '                        
                     WS-BALLOT-MONTH1 ' ' WS-DTE-INC1(1:4) ' to '               
                  WS-DTE-APPLY2 ' ' WS-DTE-REGN-CCYY2                           
                      ' (if applicable)'                                        
                        DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT               
                 WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4  AFTER 2               
                 ADD   6    TO WS-LINE-CTR                                      
              END-IF                                                            
              IF WS-C398-EMP-STAT(WS-CTR) = '7' AND WS-HFE NOT = 'Y'            
                 PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT               
                 MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT                  
                 STRING '( ) Payslip/gross income letter'                       
                   ' from employer from ' WS-BALLOT-MONTH1 ' '                  
                   WS-DTE-INC1(1:4) ' to ' WS-DTE-APPLY2 ' '                    
                   K800-DTE-REGN(1:4)                                           
                   DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                    
                 WRITE P13P89DA-REC   FROM LR5B-DOC2-LN-4 AFTER 2               
                 PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT               
                 MOVE   SPACES         TO   LR5B-DOC2-DOCUMENT                  
                 MOVE   '( ) Commission statement/letter'                       
                                       TO LR5B-DOC2-DOCUMENT                    
                 WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4  AFTER 2               
                 MOVE   SPACES         TO   LR5B-DOC2-DOCUMENT                  
                 STRING '( ) Latest Notice of Assessment and F'                 
                        'orm B from IRAS'                                       
                        DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT               
                 WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4  AFTER 2               
                 ADD   6    TO WS-LINE-CTR                                      
              END-IF                                                            
              IF WS-C398-EMP-STAT(WS-CTR) = '9' AND WS-HFE NOT = 'Y'            
                 PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT               
                 MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT                  
                 STRING '( ) Payslip/gross income letter'                       
                   '  from employer from ' WS-BALLOT-MONTH1 ' '                 
                   WS-DTE-INC1(1:4) ' to ' WS-DTE-APPLY2 ' '                    
                   WS-DTE-REGN-CCYY2                                            
                   DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                    
                 WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4 AFTER 2                
                 MOVE   SPACES         TO   LR5B-DOC2-DOCUMENT                  
                 STRING '( ) Latest Notice of Assessment and F'                 
                        'orm B from IRAS'                                       
                        DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT               
                 WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4  AFTER 2               
                 ADD   4    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF WS-HFE = 'Y' AND K800-NUM-DEFER-INCOME-ASSESS = 'Y' AND        
               (K800-DTE-REGN = '20230530' OR '20230531' OR '20230601')         
                 CONTINUE                                                       
              ELSE                                                              
                 IF WS-C398-EMP-STAT(WS-CTR) = 'A' AND                          
                    K800-NUM-DEFER-INCOME-ASSESS = 'Y'                          
                    PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT            
                    MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT               
                    MOVE '( ) Document from Educational Institution'            
                                            TO LR5B-DOC2-DOCUMENT               
                    WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4 AFTER 2             
                    ADD   2    TO WS-LINE-CTR                                   
                 END-IF                                                         
                 IF WS-C398-EMP-STAT(WS-CTR) = 'B'  AND                         
                    K800-NUM-DEFER-INCOME-ASSESS = 'Y'                          
                    PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT            
                    MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT               
                    MOVE '( ) National Service ID card'                         
                                            TO LR5B-DOC2-DOCUMENT               
                    WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4 AFTER 2             
                    ADD   2    TO WS-LINE-CTR                                   
                 END-IF                                                         
                 IF WS-C398-EDN-LT12MTH(WS-CTR) = 'Y' AND                       
                    K800-NUM-DEFER-INCOME-ASSESS = 'Y'                          
                    PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT            
                    MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT               
                    MOVE '( ) Graduation Certificate'                           
                                            TO LR5B-DOC2-DOCUMENT               
                    WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4 AFTER 2             
                    ADD   2    TO WS-LINE-CTR                                   
                 END-IF                                                         
                 IF WS-C398-NS-LT12MTH(WS-CTR) = 'Y' AND                        
                    K800-NUM-DEFER-INCOME-ASSESS = 'Y'                          
                    PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT            
                    MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT               
                    MOVE '( ) National Service ORD Certificate'                 
                                            TO LR5B-DOC2-DOCUMENT               
                    WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4 AFTER 2             
                    ADD   2    TO WS-LINE-CTR                                   
                 END-IF                                                         
              END-IF                                                            
                                                                                
              IF WS-C398-ID-CARD(WS-CTR)  =  'Y'                                
                 PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT               
                 MOVE  SPACES             TO   LR5B-DOC2-DOCUMENT               
                 MOVE '( ) Identity Card'  TO   LR5B-DOC2-DOCUMENT              
                 WRITE P13P89DA-REC     FROM LR5B-DOC2-LN-4 AFTER 2             
                 ADD   2    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF (K800-NUM-ALLO-SCHEME = 'GRO') AND                             
                 (WS-C398-NRIC(WS-CTR) = K800-NUM-NRIC1 OR                      
                                         K800-NUM-NRIC2 OR                      
                                         K800-NUM-NRIC3 OR                      
                                         K800-NUM-NRIC4)                        
                 PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT               
                 MOVE  SPACES             TO   LR5B-DOC2-DOCUMENT               
                 STRING '( ) GRO Identity Card (if applicable)'                 
                        DELIMITED BY SIZE  INTO LR5B-DOC2-DOCUMENT              
                 END-STRING                                                     
                 WRITE P13P89DA-REC     FROM LR5B-DOC2-LN-4 AFTER 2             
                 ADD   2    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF WS-C398-PASS-PERMIT(WS-CTR)  =  'Y'                            
                 PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT               
                 MOVE  SPACES             TO   LR5B-DOC2-DOCUMENT               
                 STRING '( ) Passport/Entry or  Re-entry Permit/'               
                        'Work  Permit/Employment  Pass/'                        
                        'Social'                                                
                        DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT               
                 WRITE P13P89DA-REC   FROM LR5B-DOC2-LN-4    AFTER 2            
                 MOVE  SPACES             TO   LR5B-DOC2-DOCUMENT               
                 MOVE   '    Visit Pass'  TO   LR5B-DOC2-DOCUMENT               
                 WRITE P13P89DA-REC   FROM LR5B-DOC2-LN-4    AFTER 1            
                 ADD   3    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF WS-C398-MARRIAGE-CERTF(WS-CTR)  =  'Y'                         
                 PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT               
                 MOVE   SPACES            TO   LR5B-DOC2-DOCUMENT               
                 MOVE '( ) Marriage Certificate'  TO LR5B-DOC2-DOCUMENT         
                 WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-4   AFTER 2            
                 ADD   2    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF WS-C398-DEATH-CERTF(WS-CTR)  =  'Y'                            
                 PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT               
                 MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT               
                 STRING '( ) Death certificate of spouse '                      
                        '(if applicable)'                                       
                        DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT               
                 WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-4   AFTER 2            
                 ADD   2    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF WS-C398-DIVORCE-CERTF(WS-CTR)  =  'Y'                          
                 PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT               
                 MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT               
                 IF WS-C398-DIVORCE-FNLJDGMT(WS-CTR) = 'N'                      
                    STRING '( ) Divorce documents (i.e. interim '               
                           'judgement, with ancillary matters '                 
                           DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT            
                    WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-4   AFTER 2         
                    MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT            
                    STRING '    on matrimonial flat and custody, '              
                           'care and control of children '                      
                           DELIMITED BY SIZE INTO   LR5B-DOC2-DOCUMENT          
                    WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-4   AFTER 1         
                    MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT            
                    STRING '    (where applicable) settled) '                   
                           DELIMITED BY SIZE INTO   LR5B-DOC2-DOCUMENT          
                    WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-4   AFTER 1         
                 ELSE                                                           
                    STRING '( ) Divorce documents (i.e. interim '               
                           'judgement & interim judgement final '               
                           DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT            
                    WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-4   AFTER 2         
                    MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT            
                    STRING '    with order of court on the custody, '           
                           'care and control of the children '                  
                           DELIMITED BY SIZE INTO   LR5B-DOC2-DOCUMENT          
                    WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-4   AFTER 1         
                    MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT            
                    STRING '    (where applicable) or divorce '                 
                           'certificate)'                                       
                           DELIMITED BY SIZE INTO   LR5B-DOC2-DOCUMENT          
                    WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-4   AFTER 1         
                 END-IF                                                         
                 ADD   4    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF WS-C398-DIVORCE-CERTF(WS-CTR)  =  'S'                          
                 PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT               
                 MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT               
                 MOVE   '( ) Deed of separation' TO LR5B-DOC2-DOCUMENT          
                 WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-4   AFTER 2            
                 ADD   2    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF WS-C398-BIRTH-CERTF(WS-CTR)  =  'Y'                            
                 PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT               
                 MOVE  SPACES             TO   LR5B-DOC2-DOCUMENT               
                 MOVE '( ) Birth Certificate'  TO LR5B-DOC2-DOCUMENT            
                 WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-4   AFTER 2            
                 ADD   2    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF WS-C398-PPS-ELIG(WS-CTR)  =  'Y'                               
                 PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT               
                 MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT               
                 STRING '( ) Doctor certification of the pregnancy'             
                        '/birth certificate of the citizen child'               
                        DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT               
                 WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-4   AFTER 2            
                 MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT               
                 STRING '    (if child is delivered before your flat'           
                        ' selection appointment)'                               
                        DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT               
                 WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-4   AFTER 1            
                 ADD   3    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              IF WS-CTR = 1                                                     
                 IF WS-C398-ORPHANS-DECL  =  'Y'                                
                   PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT             
                   MOVE    SPACES         TO   LR5B-DOC2-DOCUMENT               
                   MOVE '( ) Death certificate of deceased parents'             
                                           TO   LR5B-DOC2-DOCUMENT              
                   WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4   AFTER 2            
                   ADD     2    TO   WS-LINE-CTR                                
                 END-IF                                                         
              END-IF                                                            
                                                                                
              IF WS-C398-STUDENT-PASS(WS-CTR)  =  'Y'                           
                 PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT               
                 MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT               
                 STRING '( ) Student pass/letter from '                         
                        'institute of learning (if applicable)'                 
                        DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT               
                 WRITE P13P89DA-REC     FROM LR5B-DOC2-LN-4 AFTER 2             
                 ADD   2    TO WS-LINE-CTR                                      
              END-IF                                                            
                                                                                
              MOVE 'N'          TO WS-CONSENT                                   
              IF WS-C398-MARRIAGE-CONSENT(WS-CTR)  =  'Y'                       
                 MOVE 'Y'       TO WS-CONSENT                                   
              END-IF                                                            
                                                                                
              IF WS-CTR = 1                                                     
                 IF WS-C398-APPS-CERTF =  'Y'                                   
                    PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT            
                    MOVE    SPACES         TO   LR5B-DOC2-DOCUMENT              
                    STRING '( ) Property tax statement of the private '         
                           'property currently owned (if any)'                  
                            DELIMITED BY SIZE                                   
                            INTO LR5B-DOC2-DOCUMENT                             
                    END-STRING                                                  
                    WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-4  AFTER 2          
                    ADD   2    TO WS-LINE-CTR                                   
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF ((WS-C398-DEB-OCCUPIER(WS-CTR) = 'BK') AND                        
               (K800-NUM-FLAT-TYPE NOT = '1A' AND '2A' AND '2F') AND            
               (K800-DTE-BALLOT >= '201602'))                                   
              PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT                  
              MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT                  
              STRING '( ) Consent letter from official assignee'                
                     ' if you intend to buy a flat bigger'                      
                     DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                  
              WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-4   AFTER 2               
              MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT                  
              STRING '    than a 5-ROOM or 3GEN flat or a flat with '           
                     'selling price of  $500,000 and '                          
                     DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                  
              WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-4   AFTER 1               
              MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT                  
              STRING '    above  including  resale levy  and  optional'         
                     '  component  scheme  options'                             
                     DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                  
              WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-4   AFTER 1               
              MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT                  
              MOVE   '    (where applicable).'                                  
                                       TO LR5B-DOC2-DOCUMENT                    
              WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-4   AFTER 1               
              ADD   5    TO WS-LINE-CTR                                         
           END-IF.                                                              
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6200-OTHER-DOCUMENTS.                                                    
      *-------------------------------------------------------------            
           IF WS-LINE-CTR > 30                                                  
              MOVE   41      TO WS-LINE-CTR                                     
           END-IF.                                                              
                                                                                
           PERFORM 6120-CHK-NRIC-LINE-CTR      THRU 6120-EXIT.                  
           MOVE    SPACES    TO   P13P89DA-REC.                                 
                                                                                
           MOVE  'N'     TO  WS-ODD-JOB-TAG.                                    
           PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 12                 
              IF WS-C398-EMP-STAT(WS-CTR) = '9'                                 
                 MOVE 'Y'     TO  WS-ODD-JOB-TAG                                
                 MOVE 13      TO  WS-CTR                                        
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
           IF WS-HFE = 'Y' AND K800-NUM-DEFER-INCOME-ASSESS = 'Y' AND           
            (K800-DTE-REGN = '20230530' OR '20230531' OR '20230601')            
              MOVE 'Y' TO WS-HFE-DEFER                                          
              PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT                  
              MOVE    SPACES        TO   LR5B-HFE-DEFER                         
              STRING  'You may qualify for the Deferred Income '                
                      'Assessment, if you and your spouse/fiance(e) '           
                         DELIMITED BY SIZE INTO LR5B-HFE-DEFER                  
              WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-3E AFTER 2                  
              MOVE    SPACES        TO   LR5B-HFE-DEFER                         
              STRING  'meet one of the following categories from '              
                      'May 2022 to Jun 2023.'                                   
                         DELIMITED BY SIZE INTO LR5B-HFE-DEFER                  
              WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-3E AFTER 1                  
              MOVE    SPACES        TO   LR5B-HFE-DEFER                         
              STRING  'Please bring the required documents for '                
                    'our verification of your eligibility, or'                  
                         DELIMITED BY SIZE INTO LR5B-HFE-DEFER                  
              WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-3E AFTER 1                  
              MOVE    SPACES        TO   LR5B-HFE-DEFER                         
              STRING  'submit softcopy of the documents via our '               
                     'e-Service MyDoc@HDB prior to your selection'              
                         DELIMITED BY SIZE INTO LR5B-HFE-DEFER                  
              WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-3E AFTER 1                  
              MOVE    SPACES        TO   LR5B-HFE-DEFER                         
              STRING  'appointment:'                                            
                         DELIMITED BY SIZE INTO LR5B-HFE-DEFER                  
              WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-3E AFTER 1                  
              ADD   6    TO WS-LINE-CTR                                         
              PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT                  
              MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT                     
              STRING '( ) Full-time student - documents from an '               
                   'education institution confirming'                           
                         DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT              
              WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4 AFTER 2                   
              MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT                     
              MOVE '    enrolment in a full-time programme'                     
                                      TO LR5B-DOC2-DOCUMENT                     
              WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4 AFTER 1                   
              ADD   3    TO WS-LINE-CTR                                         
              PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT                  
              MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT                     
              STRING '( ) Completed studies within the past 12 '                
                   'months preceding the flat '                                 
                         DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT              
              WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4 AFTER 2                   
              MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT                     
              MOVE '    HFE application  graduation certificate'                
                                      TO LR5B-DOC2-DOCUMENT                     
              WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4 AFTER 1                   
              ADD   3    TO WS-LINE-CTR                                         
              PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT                  
              MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT                     
              STRING '( ) Full-time National Serviceman  National '             
                   'Service ID card or a letter from'                           
                         DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT              
              WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4 AFTER 2                   
              MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT                     
              MOVE '    relevant Ministry'                                      
                                      TO LR5B-DOC2-DOCUMENT                     
              WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4 AFTER 1                   
              ADD   3    TO WS-LINE-CTR                                         
              PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT                  
              MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT                     
              STRING '( ) Completed National Service within the past'           
                   ' 12 months preceding the flat / '                           
                         DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT              
              WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4 AFTER 2                   
              MOVE    SPACES        TO   LR5B-DOC2-DOCUMENT                     
              MOVE '    HFE application - ORD Certificate of Service'           
                                      TO LR5B-DOC2-DOCUMENT                     
              WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4 AFTER 1                   
              ADD   3    TO WS-LINE-CTR                                         
           END-IF.                                                              
                                                                                
           IF (WS-AHG-APPLN = 'Y') AND (WS-HFE NOT = 'Y')                       
             IF WS-LINE-CTR > 21                                                
                MOVE   41      TO WS-LINE-CTR                                   
             END-IF                                                             
             PERFORM 6120-CHK-NRIC-LINE-CTR   THRU 6120-EXIT                    
             IF K800-DTE-BALLOT >= '201909'                                     
                WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-3D AFTER 2              
             ELSE                                                               
                WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-3A AFTER 2              
             END-IF                                                             
             MOVE WS-DTE-APPLICATION(1:6)   TO WS-DTE-REGN                      
             ADD     -1                     TO WS-DTE-REGN-CCYY                 
             MOVE WS-DTE-APPLICATION(5:2)   TO WS-MONTH                         
             PERFORM 5120-DECODE-MONTH      THRU 5120-EXIT                      
             MOVE WS-MONTH-DESC             TO WS-DTE-APPLY                     
             MOVE WS-DTE-APPLICATION(1:6)  TO WS-DTE-REGN2                      
             SUBTRACT 1          FROM WS-DTE-REGN-MM2                           
             IF WS-DTE-REGN2(5:2) = 0                                           
                MOVE 12            TO WS-DTE-REGN-MM2                           
                SUBTRACT 1       FROM WS-DTE-REGN-CCYY2                         
             END-IF                                                             
             MOVE WS-DTE-REGN-MM2  TO WS-MONTH                                  
             PERFORM 5120-DECODE-MONTH THRU 5120-EXIT                           
             MOVE WS-MONTH-DESC TO WS-DTE-APPLY2                                
             MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT                   
             IF WS-ODD-JOB-TAG = 'N'                                            
                STRING '( ) Past 12 months income documents from '              
                       WS-DTE-APPLY ' ' WS-DTE-REGN-CCYY ' to '                 
                       WS-DTE-APPLY2 ' ' WS-DTE-REGN-CCYY2                      
                       DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                
                WRITE  P13P89DA-REC   FROM LR5B-DOC2-LN-4    AFTER 2            
             ELSE                                                               
                STRING '( ) Past 12 months income documents from '              
                       WS-DTE-APPLY ' ' WS-DTE-REGN-CCYY ' to '                 
                       WS-DTE-APPLY2 ' ' WS-DTE-REGN-CCYY2                      
                       ' (or Annex 1A'                                          
                       DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                
                WRITE  P13P89DA-REC   FROM LR5B-DOC2-LN-4    AFTER 2            
                MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT                
                MOVE   '    if part-time/odd-job)'                              
                                         TO   LR5B-DOC2-DOCUMENT                
                WRITE  P13P89DA-REC   FROM LR5B-DOC2-LN-4    AFTER 1            
             END-IF                                                             
             MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT                   
             STRING '( ) Last year CPF Yearly  Statement of Account '           
                    'and latest  15  months  CPF '                              
                     DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                  
             END-STRING                                                         
             WRITE  P13P89DA-REC   FROM LR5B-DOC2-LN-4    AFTER 2               
             MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT                   
             STRING '    Contribution History Statement (for all '              
                    'employed and unemployed'                                   
                     DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                  
             WRITE  P13P89DA-REC   FROM LR5B-DOC2-LN-4    AFTER 1               
             MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT                   
             MOVE   '    persons listed)'                                       
                                      TO   LR5B-DOC2-DOCUMENT                   
             WRITE  P13P89DA-REC   FROM LR5B-DOC2-LN-4    AFTER 1               
      *      MOVE   '    Contribution History Statement'                        
      *                               TO   LR5B-DOC2-DOCUMENT                   
      *      WRITE  P13P89DA-REC   FROM LR5B-DOC2-LN-4    AFTER 1               
             MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT                   
             IF K800-DTE-BALLOT >= '201909'                                     
                STRING '( ) Completed and signed enclosed EHG Appli'            
                       'cation form'                                            
                       DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                
                WRITE  P13P89DA-REC   FROM LR5B-DOC2-LN-4    AFTER 2            
                ADD    16      TO   WS-LINE-CTR                                 
             ELSE                                                               
                STRING '( ) The completed AHG/SHG   Application   form '        
                       ' (available  for  download'                             
                       DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                
                WRITE  P13P89DA-REC   FROM LR5B-DOC2-LN-4    AFTER 2            
                MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT                
                STRING '    at www.hdb.gov.sg.)'                                
                       DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                
                WRITE  P13P89DA-REC   FROM LR5B-DOC2-LN-4    AFTER 2            
                ADD    14      TO   WS-LINE-CTR                                 
             END-IF                                                             
           END-IF.                                                              
                                                                                
      *------------------------------*                                          
      * UNDERTAKING FOR MCPS CASES   *                                          
      *------------------------------*                                          
                                                                                
           IF WS-C398-MCPS-FRM  =  'Y' OR 'S'                                   
             MOVE 41   TO   WS-LINE-CTR                                         
                                                                                
             PERFORM 6120-CHK-NRIC-LINE-CTR   THRU 6120-EXIT                    
                                                                                
             MOVE   SPACES          TO   LR5B-DOC2-DOCUMENT                     
             IF WS-C398-MCPS-FRM  =  'Y'                                        
                MOVE 'Applications under Married Child Priority Scheme'         
                                       TO LR5B-SCH-TEXT                         
                WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-3C  AFTER 2             
                MOVE    SPACES         TO   LR5B-DOC2-LN-3C                     
                STRING 'We will conduct a video call with your parents/'        
                       ' married child to explain the'                          
                      DELIMITED BY SIZE INTO LR5B-SCH-TEXT                      
                WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-3C  AFTER 1               
                MOVE    SPACES         TO   LR5B-DOC2-LN-3C                     
                STRING 'MCPS conditions to them.  Your parents/ '               
                       'married child must have a smartphone for'               
                      DELIMITED BY SIZE INTO LR5B-SCH-TEXT                      
                WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-3C   AFTER 1              
                MOVE    SPACES         TO   LR5B-DOC2-LN-3C                     
                STRING 'us to video call them and have their NRICs '            
                       'with them for our Customer Service'                     
                      DELIMITED BY SIZE INTO LR5B-SCH-TEXT                      
                WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-3C   AFTER 1              
                MOVE    SPACES         TO   LR5B-DOC2-LN-3C                     
                STRING 'Executives to verify the identity and '                 
                       'relationship.  Please let your parents/'                
                      DELIMITED BY SIZE INTO LR5B-SCH-TEXT                      
                WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-3C   AFTER 1              
                MOVE    SPACES         TO   LR5B-DOC2-LN-3C                     
                STRING 'married child sign the MCPS undertaking before '        
                       'your selection appointment and'                         
                      DELIMITED BY SIZE INTO LR5B-SCH-TEXT                      
                WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-3C   AFTER 1              
                MOVE    SPACES         TO   LR5B-DOC2-LN-3C                     
                STRING 'bring along with the following documents:'              
                      DELIMITED BY SIZE INTO LR5B-SCH-TEXT                      
                WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-3C   AFTER 1              
                MOVE    SPACES         TO   LR5B-DOC2-LN-3C                     
             ELSE                                                               
                IF K800-DTE-BALLOT >= '201511'                                  
                   MOVE 'Applications under Senior Priority Scheme'             
                                       TO LR5B-SCH-TEXT                         
                   WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-3C  AFTER 2          
                   MOVE    SPACES         TO   LR5B-DOC2-DOCUMENT               
                   STRING 'We will conduct a video call with your paren'        
                       'ts/ married child to explain the'                       
                         DELIMITED BY SIZE INTO LR5B-SCH-TEXT                   
                   WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-3C  AFTER 1            
                   MOVE    SPACES         TO   LR5B-DOC2-LN-3C                  
                   STRING 'SPS conditions to them.  Your parents/ '             
                       'married child must have a smartphone for'               
                         DELIMITED BY SIZE INTO LR5B-SCH-TEXT                   
                   WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-3C  AFTER 1            
                   MOVE    SPACES         TO   LR5B-DOC2-LN-3C                  
                   STRING 'us to video call them and have their NRICs'          
                       ' with them for our Customer Service'                    
                         DELIMITED BY SIZE INTO LR5B-SCH-TEXT                   
                   WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-3C  AFTER 1            
                   MOVE    SPACES         TO   LR5B-DOC2-LN-3C                  
                   STRING 'Executives to verify the identity and '              
                       'relationship.  Please let your parents/'                
                         DELIMITED BY SIZE INTO LR5B-SCH-TEXT                   
                   WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-3C  AFTER 1            
                   MOVE    SPACES         TO   LR5B-DOC2-LN-3C                  
                   STRING 'married child sign the SPS undertaking '             
                       'before your selection appointment and'                  
                         DELIMITED BY SIZE INTO LR5B-SCH-TEXT                   
                   WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-3C  AFTER 1            
                   MOVE    SPACES         TO   LR5B-DOC2-LN-3C                  
                   STRING 'bring along with the following documents:'           
                         DELIMITED BY SIZE INTO LR5B-SCH-TEXT                   
                   WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-3C  AFTER 1            
                ELSE                                                            
                   STRING '( ) Undertaking by parents/ married child '          
                       'of applicants under Studio Apartment'                   
                         DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT              
                   WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4   AFTER 2            
                   MOVE    SPACES         TO   LR5B-DOC2-DOCUMENT               
                   MOVE   '    Priority Scheme (SAPS)'                          
                                       TO   LR5B-DOC2-DOCUMENT                  
                   WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4    AFTER 1           
                END-IF                                                          
             END-IF                                                             
             MOVE    SPACES         TO   LR5B-DOC2-DOCUMENT                     
             STRING '( ) If  your  parents/ married  child  '                   
                    'reside in a private residential'                           
                      DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                 
             WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4   AFTER 2                  
             MOVE    SPACES         TO   LR5B-DOC2-DOCUMENT                     
             STRING '    property, you  will  have to submit  '                 
                    'a copy of their property tax    '                          
                      DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                 
             WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4   AFTER 1                  
             MOVE    SPACES         TO   LR5B-DOC2-DOCUMENT                     
             STRING '    statement; and                      '                  
                      DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                 
             WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4    AFTER 1                 
             MOVE    SPACES         TO   LR5B-DOC2-DOCUMENT                     
             MOVE   '( ) Birth certificate of the married child; and'           
                                    TO   LR5B-DOC2-DOCUMENT                     
             WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4    AFTER 2                 
             MOVE    SPACES         TO   LR5B-DOC2-DOCUMENT                     
             STRING '( ) Marriage certificate , deed of separation,'            
                    ' divorce  documents  (i.e.'                                
                      DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                 
             WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4   AFTER 2                  
             MOVE    SPACES         TO   LR5B-DOC2-DOCUMENT                     
             STRING '    interim  judgement & interim  judgement '              
                    ' final  with order of court'                               
                      DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                 
             WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4   AFTER 1                  
             MOVE    SPACES         TO   LR5B-DOC2-DOCUMENT                     
             STRING '    or  divorce  certificate)  or  death '                 
                    ' certificate  (whichever   is '                            
                      DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                 
             WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4   AFTER 1                  
             MOVE    SPACES         TO   LR5B-DOC2-DOCUMENT                     
             STRING '    applicable) of your parents/ married'                  
                    ' child'                                                    
                      DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                 
             WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4   AFTER 1                  
             ADD   19     TO   WS-LINE-CTR                                      
           END-IF.                                                              
                                                                                
           IF K800-NUM-GEN3 = 'Y'                                               
             MOVE 41   TO   WS-LINE-CTR                                         
             PERFORM 6120-CHK-NRIC-LINE-CTR   THRU 6120-EXIT                    
             MOVE    SPACES         TO   LR5B-DOC2-LN-3C                        
             MOVE 'Applicants who intend to book a 3Gen flat'                   
                                    TO LR5B-SCH-TEXT                            
             WRITE P13P89DA-REC    FROM LR5B-DOC2-LN-3C  AFTER 2                
             MOVE    SPACES         TO   LR5B-DOC2-DOCUMENT                     
             STRING 'We will conduct a video call with your '                   
                    'parents/ married child to explain the'                     
                     DELIMITED BY SIZE INTO LR5B-SCH-TEXT                       
             WRITE P13P89DA-REC FROM LR5B-DOC2-LN-3C AFTER 1                    
             MOVE    SPACES         TO   LR5B-DOC2-LN-3C                        
             STRING '3Gen conditions to them.  Your parents/ '                  
                    'married child must have a smartphone'                      
                     DELIMITED BY SIZE INTO LR5B-SCH-TEXT                       
             WRITE P13P89DA-REC FROM LR5B-DOC2-LN-3C AFTER 1                    
             MOVE    SPACES         TO   LR5B-DOC2-LN-3C                        
             STRING 'for us to video call them and have their '                 
                    'NRICs with them for our Customer'                          
                     DELIMITED BY SIZE INTO LR5B-SCH-TEXT                       
             WRITE P13P89DA-REC FROM LR5B-DOC2-LN-3C AFTER 1                    
             MOVE    SPACES         TO   LR5B-DOC2-LN-3C                        
             STRING 'Service Executives to verify the identity '                
                    'and relationship.  Please let your'                        
                     DELIMITED BY SIZE INTO LR5B-SCH-TEXT                       
             WRITE P13P89DA-REC FROM LR5B-DOC2-LN-3C AFTER 1                    
             MOVE    SPACES         TO   LR5B-DOC2-LN-3C                        
             STRING 'parents/ married child sign the 3Gen '                     
                    'undertaking before your selection'                         
                     DELIMITED BY SIZE INTO LR5B-SCH-TEXT                       
             WRITE P13P89DA-REC FROM LR5B-DOC2-LN-3C AFTER 1                    
             MOVE    SPACES         TO   LR5B-DOC2-LN-3C                        
             STRING 'appointment and bring along with '                         
                    'the following documents:'                                  
                     DELIMITED BY SIZE INTO LR5B-SCH-TEXT                       
             WRITE P13P89DA-REC FROM LR5B-DOC2-LN-3C AFTER 1                    
                                                                                
             MOVE    SPACES         TO   LR5B-DOC2-DOCUMENT                     
             STRING '( ) Birth certificate of the married'                      
                    ' child; and'                                               
                     DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                  
             WRITE  P13P89DA-REC   FROM LR5B-DOC2-LN-4    AFTER 2               
             MOVE    SPACES           TO   LR5B-DOC2-DOCUMENT                   
             STRING '( ) Marriage certificate , deed of separation,'            
                    ' divorce  documents  (i.e.'                                
                      DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                 
             WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4   AFTER 2                  
             MOVE    SPACES         TO   LR5B-DOC2-DOCUMENT                     
             STRING '    interim  judgement & interim  judgement '              
                    ' final  with order of court'                               
                      DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                 
             WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4   AFTER 1                  
             MOVE    SPACES         TO   LR5B-DOC2-DOCUMENT                     
             STRING '    or  divorce  certificate)  or  death '                 
                    ' certificate  (whichever   is '                            
                      DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                 
             WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4   AFTER 1                  
             MOVE    SPACES         TO   LR5B-DOC2-DOCUMENT                     
             STRING '    applicable) of your parents/ married'                  
                    ' child'                                                    
                      DELIMITED BY SIZE INTO LR5B-DOC2-DOCUMENT                 
             WRITE P13P89DA-REC  FROM LR5B-DOC2-LN-4   AFTER 1                  
             ADD    15    TO   WS-LINE-CTR                                      
           END-IF.                                                              
                                                                                
           IF WS-AGE-GT55 = 'Y'                                                 
              PERFORM 6120-CHK-NRIC-LINE-CTR    THRU 6120-EXIT                  
              MOVE    SPACES           TO   LR5B-SCH-TEXT                       
              STRING '*If you are using your CPF savings to finance '           
                     'the flat, do check on the amount '                        
                     DELIMITED BY SIZE INTO LR5B-SCH-TEXT                       
              WRITE P13P89DA-REC     FROM LR5B-DOC2-LN-3C AFTER 2               
              MOVE    SPACES           TO   LR5B-SCH-TEXT                       
              STRING 'you can use from your CPF savings. Please bring '         
                     'along the approval letter from '                          
                     DELIMITED BY SIZE INTO LR5B-SCH-TEXT                       
              WRITE P13P89DA-REC     FROM LR5B-DOC2-LN-3C AFTER 1               
              MOVE    SPACES           TO   LR5B-SCH-TEXT                       
              STRING 'CPF Board, if any.'                                       
                     DELIMITED BY SIZE INTO LR5B-SCH-TEXT                       
              WRITE P13P89DA-REC     FROM LR5B-DOC2-LN-3C AFTER 1               
              ADD   4    TO WS-LINE-CTR                                         
           END-IF.                                                              
                                                                                
           IF WS-LINE-CTR > 32                                                  
              MOVE 41    TO WS-LINE-CTR                                         
           END-IF.                                                              
                                                                                
      *    PERFORM 3280-CHK-BLANK-CTR    THRU 3280-EXIT.                        
                                                                                
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6350-PRINT-EHG-APPL-FORMS.                                               
      *-------------------------------------------------------------            
      * print blank page if page counter is odd                                 
           IF WS-HEADING-CTR NOT = 00 AND 02 AND 04 AND 06 AND 08 AND           
                                   10 AND 12 AND 14 AND 16 AND 18 AND           
                                   20 AND 22 AND 24 AND 26 AND 28 AND           
                                   30 AND 32 AND 34 AND 36 AND 38 AND           
                                   40 AND 42 AND 44 AND 46 AND 48               
              MOVE  SPACES         TO P13P89DA-REC                              
              WRITE P13P89DA-REC FROM DJDE-BLANKF AFTER PAGE                    
              WRITE P13P89DA-REC AFTER 5                                        
              ADD 1 TO   WS-HEADING-CTR                                         
           END-IF.                                                              
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-EHG-FORM1 AFTER PAGE.                   
           WRITE P13P89DA-REC AFTER 5.                                          
           ADD 1 TO   WS-HEADING-CTR.                                           
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-EHG-FORM2 AFTER PAGE.                   
           WRITE P13P89DA-REC AFTER 5.                                          
           ADD 1 TO   WS-HEADING-CTR.                                           
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-EHG-FORM3 AFTER PAGE.                   
           WRITE P13P89DA-REC AFTER 5.                                          
           ADD 1 TO   WS-HEADING-CTR.                                           
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-EHG-FORM4 AFTER PAGE.                   
           WRITE P13P89DA-REC AFTER 5.                                          
           ADD 1 TO   WS-HEADING-CTR.                                           
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-EHG-FORM5 AFTER PAGE.                   
           WRITE P13P89DA-REC AFTER 5.                                          
           ADD 1 TO   WS-HEADING-CTR.                                           
                                                                                
           IF K800-DTE-BALLOT >= '202111'                                       
              MOVE  SPACES         TO P13P89DA-REC                              
              WRITE P13P89DA-REC FROM DJDE-EHG-FORM6-NEW AFTER PAGE             
              WRITE P13P89DA-REC AFTER 5                                        
              ADD 1 TO   WS-HEADING-CTR                                         
                                                                                
              MOVE  SPACES         TO P13P89DA-REC                              
              WRITE P13P89DA-REC FROM DJDE-EHG-FORM7-NEW AFTER PAGE             
              WRITE P13P89DA-REC AFTER 5                                        
              ADD 1 TO   WS-HEADING-CTR                                         
                                                                                
              MOVE  SPACES         TO P13P89DA-REC                              
              WRITE P13P89DA-REC FROM DJDE-EHG-FORM8-NEW AFTER PAGE             
              WRITE P13P89DA-REC AFTER 5                                        
              ADD 1 TO   WS-HEADING-CTR                                         
                                                                                
              MOVE  SPACES         TO P13P89DA-REC                              
              WRITE P13P89DA-REC FROM DJDE-EHG-FORM9-NEW AFTER PAGE             
              WRITE P13P89DA-REC AFTER 5                                        
              ADD 1 TO   WS-HEADING-CTR                                         
                                                                                
              MOVE  SPACES         TO P13P89DA-REC                              
              WRITE P13P89DA-REC FROM DJDE-EHG-FORM10    AFTER PAGE             
              WRITE P13P89DA-REC AFTER 5                                        
              ADD 1 TO   WS-HEADING-CTR                                         
           ELSE                                                                 
              MOVE  SPACES         TO P13P89DA-REC                              
              WRITE P13P89DA-REC FROM DJDE-EHG-FORM6 AFTER PAGE                 
              WRITE P13P89DA-REC AFTER 5                                        
              ADD 1 TO   WS-HEADING-CTR                                         
                                                                                
              MOVE  SPACES         TO P13P89DA-REC                              
              WRITE P13P89DA-REC FROM DJDE-EHG-FORM7 AFTER PAGE                 
              WRITE P13P89DA-REC AFTER 5                                        
              ADD 1 TO   WS-HEADING-CTR                                         
                                                                                
              MOVE  SPACES         TO P13P89DA-REC                              
              WRITE P13P89DA-REC FROM DJDE-EHG-FORM8 AFTER PAGE                 
              WRITE P13P89DA-REC AFTER 5                                        
              ADD 1 TO   WS-HEADING-CTR                                         
                                                                                
              MOVE  SPACES         TO P13P89DA-REC                              
              WRITE P13P89DA-REC FROM DJDE-EHG-FORM9 AFTER PAGE                 
              WRITE P13P89DA-REC AFTER 5                                        
              ADD 1 TO   WS-HEADING-CTR                                         
           END-IF.                                                              
                                                                                
       6350-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6355-PRINT-BASIC-SVC-PCKGE1.                                             
      *-------------------------------------------------------------            
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-CCA-BSP1 AFTER PAGE.                    
           WRITE P13P89DA-REC AFTER 5.                                          
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-CCA-BSP2 AFTER PAGE.                    
           WRITE P13P89DA-REC AFTER 5.                                          
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-CCA-BSP3 AFTER PAGE.                    
           WRITE P13P89DA-REC AFTER 5.                                          
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-CCA-BSP4 AFTER PAGE.                    
           WRITE P13P89DA-REC AFTER 5.                                          
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-CCA-BSP5 AFTER PAGE.                    
           WRITE P13P89DA-REC AFTER 5.                                          
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-CCA-BSP6 AFTER PAGE.                    
           WRITE P13P89DA-REC AFTER 5.                                          
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-CCA-BSP7 AFTER PAGE.                    
           WRITE P13P89DA-REC AFTER 5.                                          
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-CCA-BSP8 AFTER PAGE.                    
           WRITE P13P89DA-REC AFTER 5.                                          
                                                                                
           ADD   8              TO   WS-REGN-PAGE-CNT.                          
                                                                                
       6355-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6360-PRINT-BASIC-SVC-PCKGE2.                                             
      *-------------------------------------------------------------            
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-CCA-BSP9 AFTER PAGE.                    
           WRITE P13P89DA-REC AFTER 5.                                          
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-CCA-BSP10 AFTER PAGE.                   
           WRITE P13P89DA-REC AFTER 5.                                          
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-CCA-BSP11 AFTER PAGE.                   
           WRITE P13P89DA-REC AFTER 5.                                          
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-CCA-BSP12 AFTER PAGE.                   
           WRITE P13P89DA-REC AFTER 5.                                          
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-CCA-BSP13 AFTER PAGE.                   
           WRITE P13P89DA-REC AFTER 5.                                          
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-CCA-BSP14 AFTER PAGE.                   
           WRITE P13P89DA-REC AFTER 5.                                          
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-CCA-BSP15 AFTER PAGE.                   
           WRITE P13P89DA-REC AFTER 5.                                          
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-CCA-BSP16 AFTER PAGE.                   
           WRITE P13P89DA-REC AFTER 5.                                          
                                                                                
           MOVE  SPACES         TO P13P89DA-REC.                                
           WRITE P13P89DA-REC FROM DJDE-CCA-BSP17 AFTER PAGE.                   
           WRITE P13P89DA-REC AFTER 5.                                          
                                                                                
           ADD   9              TO   WS-REGN-PAGE-CNT.                          
                                                                                
       6360-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6400-CHECK-AHG-APPLN.                                                    
      *-------------------------------------------------------------            
           MOVE SPACES           TO  WS-DTE-DOC-DUE-EDT.                        
                                                                                
           IF WS-DTE-BK-APPT IS NUMERIC                                         
              COMPUTE WS-DTE-DUE =                                              
                      FUNCTION INTEGER-OF-DATE (WS-DTE-BK-APPT)                 
              COMPUTE WS-DTE-DUE = WS-DTE-DUE - 7                               
                                                                                
              COMPUTE WS-DTE-DOC-DUE =                                          
                      FUNCTION DATE-OF-INTEGER (WS-DTE-DUE)                     
              STRING WS-DTE-DOC-DUE(7:2) '/' WS-DTE-DOC-DUE(5:2) '/'            
                     WS-DTE-DOC-DUE(1:4) DELIMITED BY SIZE                      
                     INTO WS-DTE-DOC-DUE-EDT                                    
           END-IF.                                                              
                                                                                
           IF K800-NUM-ALLO-SCHEME = 'FTS' AND                                  
             (K800-NUM-ELIG-SCHEME = 'SSC' OR 'JSS' OR 'NCS') AND               
             (K800-NUM-FLAT-TYPE = '2 ' OR '2F')                                
              IF K813-NUM-MATURE-EST-TAG NOT = 'Y'                              
                 MOVE 'Y'          TO WS-AHG-SHG-SINGLES                        
                                      WS-AHG-APPLN                              
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K800-NUM-FT2T = 'Y'                                               
              IF K800-NUM-FLAT-TYPE = '2 ' OR '3 ' OR '4 ' OR '3P'              
                                   OR '2F'                                      
                 IF K813-NUM-MATURE-EST-TAG NOT = 'Y'                           
                    MOVE 'Y'    TO WS-AHG-SHG-COUPLES                           
                                   WS-AHG-APPLN                                 
                 ELSE                                                           
                    MOVE 'Y'    TO WS-AHG-COUPLES                               
                                   WS-AHG-APPLN                                 
                 END-IF                                                         
              ELSE                                                              
                 IF K800-NUM-FLAT-TYPE = '5 ' OR 'E '                           
                    MOVE 'Y'    TO WS-AHG-COUPLES                               
                                   WS-AHG-APPLN                                 
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
           IF (K800-NUM-HOUSEHOLD = 'H') AND                                    
              (K800-NUM-ALLO-SCHEME NOT = 'FTS') AND                            
              (K800-NUM-ELIG-SCHEME = 'PA ' OR 'FS ' OR 'SI ' OR 'TCP')         
              IF K800-NUM-FLAT-TYPE = '2 ' OR '3 ' OR '4 ' OR '3P'              
                                   OR '2F'                                      
                 IF K813-NUM-MATURE-EST-TAG NOT = 'Y'                           
                    MOVE 'Y'    TO WS-AHG-SHG-FAMILY                            
                                   WS-AHG-APPLN                                 
                 ELSE                                                           
                    MOVE 'Y'    TO WS-AHG-FAMILY                                
                                   WS-AHG-APPLN                                 
                 END-IF                                                         
              ELSE                                                              
                 IF K800-NUM-FLAT-TYPE = '5 ' OR 'E '                           
                    MOVE 'Y'    TO WS-AHG-FAMILY                                
                                   WS-AHG-APPLN                                 
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       6400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6110-CHK-REGN-LINE-CTR.                                                  
      *-------------------------------------------------------------            
           MOVE    SPACES           TO   LR5B-DOC2-NME-OCCP.                    
           IF WS-C398-AGE-OCCUPIER(WS-CTR) > 55                                 
              MOVE 'Y' TO WS-AGE-GT55                                           
              STRING WS-C398-NME-OCCUPIER(WS-CTR) DELIMITED BY '  '             
                  '   '                                                         
                  WS-C398-NRIC(WS-CTR)(1:1) DELIMITED BY SIZE                   
                  'XXXX'                                                        
                  WS-C398-NRIC(WS-CTR)(6:4) DELIMITED BY SIZE                   
                  '*' DELIMITED BY SIZE                                         
                                    INTO LR5B-DOC2-NME-OCCP                     
           ELSE                                                                 
              STRING WS-C398-NME-OCCUPIER(WS-CTR) DELIMITED BY '  '             
                  '   '                                                         
                  WS-C398-NRIC(WS-CTR)(1:1) DELIMITED BY SIZE                   
                  'XXXX'                                                        
                  WS-C398-NRIC(WS-CTR)(6:4) DELIMITED BY SIZE                   
                                    INTO LR5B-DOC2-NME-OCCP                     
           END-IF.                                                              
                                                                                
           IF WS-LINE-CTR  >  32                                                
              IF WS-FIRST-FLAG = 'Y'                                            
      *          IF WS-AHG-APPLN NOT = 'Y'                                      
                  MOVE  'N'            TO WS-FIRST-FLAG                         
                  MOVE  SPACES         TO P13P89DA-REC                          
                  WRITE P13P89DA-REC FROM DJDE-DOC-SUB-FORM  AFTER PAGE         
      *          ELSE                                                           
      *           MOVE  'N'            TO WS-FIRST-FLAG                         
      *           MOVE  SPACES         TO P13P89DA-REC                          
      *           WRITE P13P89DA-REC FROM DJDE-DOC-SUB-FORM2 AFTER PAGE         
      *          END-IF                                                         
                 MOVE  SPACES         TO   P13P89DA-REC                         
                 WRITE P13P89DA-REC   AFTER PAGE                                
                                                                                
                 ADD   1              TO   WS-HEADING-CTR                       
                 WRITE P13P89DA-REC   FROM LR5B-DOC1-LN-1     AFTER 1           
                 WRITE P13P89DA-REC   FROM LR5B-DOC1-LN-2     AFTER 1           
                 WRITE P13P89DA-REC   FROM LR5B-DOC2-LN-3     AFTER 20          
                 MOVE   1    TO   WS-LINE-CTR                                   
              ELSE                                                              
                 MOVE  SPACES         TO P13P89DA-REC                           
                 WRITE P13P89DA-REC FROM DJDE-DOC-SUB-FORM3 AFTER PAGE          
                                                                                
                 MOVE  SPACES         TO   P13P89DA-REC                         
                 WRITE P13P89DA-REC   AFTER PAGE                                
                                                                                
                 ADD   1              TO   WS-HEADING-CTR                       
                 WRITE P13P89DA-REC   FROM LR5B-DOC1-LN-1     AFTER 1           
                 WRITE P13P89DA-REC   FROM LR5B-DOC1-LN-2     AFTER 1           
                 WRITE P13P89DA-REC   FROM LR5B-DOC2-LN-3     AFTER 4           
                 MOVE   1    TO   WS-LINE-CTR                                   
              END-IF                                                            
           ELSE                                                                 
              WRITE P13P89DA-REC FROM LR5B-DOC2-LN-3     AFTER 2                
              ADD    2    TO   WS-LINE-CTR                                      
           END-IF.                                                              
                                                                                
       6110-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6120-CHK-NRIC-LINE-CTR.                                                  
      *-------------------------------------------------------------            
                                                                                
           IF WS-LINE-CTR  >  31                                                
              IF WS-FIRST-FLAG = 'Y'                                            
      *          IF WS-AHG-APPLN NOT = 'Y'                                      
                    MOVE 'N'           TO WS-FIRST-FLAG                         
                    MOVE  SPACES       TO P13P89DA-REC                          
                    WRITE P13P89DA-REC FROM DJDE-DOC-SUB-FORM                   
                                      AFTER PAGE                                
      *          ELSE                                                           
      *             MOVE 'N'           TO WS-FIRST-FLAG                         
      *             MOVE  SPACES       TO P13P89DA-REC                          
      *             WRITE P13P89DA-REC FROM DJDE-DOC-SUB-FORM2                  
      *                                AFTER PAGE                               
      *          END-IF                                                         
              ELSE                                                              
                 MOVE  SPACES       TO   P13P89DA-REC                           
                 WRITE P13P89DA-REC FROM DJDE-DOC-SUB-FORM3 AFTER PAGE          
              END-IF                                                            
                                                                                
              MOVE  SPACES       TO   P13P89DA-REC                              
              WRITE P13P89DA-REC AFTER PAGE                                     
                                                                                
              ADD   1            TO   WS-HEADING-CTR                            
              WRITE P13P89DA-REC    FROM LR5B-DOC1-LN-1 AFTER 1                 
              WRITE P13P89DA-REC    FROM LR5B-DOC1-LN-2 AFTER 1                 
              MOVE   ZEROES         TO   WS-LINE-CTR                            
              MOVE    SPACES        TO   P13P89DA-REC                           
              WRITE P13P89DA-REC    AFTER 2                                     
           END-IF.                                                              
                                                                                
       6120-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3280-CHK-BLANK-CTR.                                                      
      *-------------------------------------------------------------            
                                                                                
           IF WS-LINE-CTR  >  33                                                
              IF WS-FIRST-FLAG = 'Y'                                            
      *         IF WS-AHG-APPLN NOT = 'Y'                                       
                   MOVE  'N'          TO   WS-FIRST-FLAG                        
                   MOVE  SPACES       TO   P13P89DA-REC                         
                   WRITE P13P89DA-REC FROM DJDE-DOC-SUB-FORM                    
                                           AFTER PAGE                           
      *         ELSE                                                            
      *            MOVE  'N'          TO   WS-FIRST-FLAG                        
      *            MOVE  SPACES       TO   P13P89DA-REC                         
      *            WRITE P13P89DA-REC FROM DJDE-DOC-SUB-FORM2                   
      *                                    AFTER PAGE                           
      *         END-IF                                                          
              ELSE                                                              
                MOVE  SPACES       TO   P13P89DA-REC                            
                WRITE P13P89DA-REC FROM DJDE-DOC-SUB-FORM3 AFTER PAGE           
              END-IF                                                            
                                                                                
              MOVE  SPACES       TO   P13P89DA-REC                              
              WRITE P13P89DA-REC AFTER PAGE                                     
                                                                                
              ADD   1            TO   WS-HEADING-CTR                            
              WRITE P13P89DA-REC    FROM LR5B-DOC1-LN-1 AFTER 1                 
              WRITE P13P89DA-REC    FROM LR5B-DOC1-LN-2 AFTER 1                 
              MOVE   ZEROES         TO   WS-LINE-CTR                            
              MOVE    SPACES        TO   P13P89DA-REC                           
              WRITE P13P89DA-REC    AFTER 2                                     
           END-IF.                                                              
                                                                                
       3280-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       7000-READ-BP13K734.                                                      
      ************************************************************              
                                                                                
           MOVE K820-KEY-FLD             TO K734-KEY-FLD.                       
                                                                                
           READ BP13K734.                                                       
                                                                                
           EVALUATE WS-K734-STATUS                                              
               WHEN 00                                                          
                    MOVE K734-NUM-EMPLY-STATUS TO WS-EMP-STATUS                 
                    MOVE K734-DTE-INCOME(1)    TO WS-DTE-INCOME1                
                    MOVE K734-DTE-INCOME(2)    TO WS-DTE-INCOME2                
                    MOVE K734-NUM-INCOME(1)    TO WS-NUM-INCOME1                
                    MOVE K734-NUM-INCOME(2)    TO WS-NUM-INCOME2                
                    MOVE K734-NUM-INCOME(3)    TO WS-NUM-INCOME3                
               WHEN 10                                                          
               WHEN 23                                                          
                    MOVE 'N'                   TO WS-EMP-STATUS                 
               WHEN OTHER                                                       
                    DISPLAY 'READ ERROR BP13K734, STATUS '                      
                            WS-K734-STATUS                                      
                    MOVE WS-K734-STATUS  TO RETURN-CODE                         
                                                                                
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       7100-CHECK-BP04K010.                                                     
      ************************************************************              
                                                                                
           MOVE SPACES           TO P04K010-REC                                 
                                    WS-C398-DEB-OCCUPIER(WS-APPL-CNT).          
                                                                                
           MOVE 'N'                       TO WS-K010-EOF.                       
                                                                                
           MOVE WS-C398-NRIC(WS-APPL-CNT) TO K010-NUM-UINFIN.                   
                                                                                
           START BP04K010 KEY >= K010-PRIME-KEY.                                
           EVALUATE WS-K010-STATUS                                              
               WHEN 00                                                          
                   PERFORM 7200-READNEXT-BP04K010  THRU 7200-EXIT               
                           UNTIL WS-K010-EOF = 'Y'                              
               WHEN 10                                                          
               WHEN 23                                                          
                   CONTINUE                                                     
               WHEN OTHER                                                       
                    DISPLAY 'START BP04K010 ERROR ' K010-NUM-UINFIN             
                    DISPLAY 'STATUS ' WS-K010-STATUS                            
                    MOVE WS-K010-STATUS TO RETURN-CODE                          
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       7100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       7200-READNEXT-BP04K010.                                                  
      ************************************************************              
                                                                                
           READ BP04K010 NEXT                                                   
              AT END MOVE 'Y'  TO WS-K010-EOF.                                  
                                                                                
           EVALUATE WS-K010-STATUS                                              
               WHEN 00                                                          
                   IF K010-NUM-UINFIN = WS-C398-NRIC(WS-APPL-CNT)               
                      IF K010-REASON-CODE = 'BK'                                
                         MOVE K010-REASON-CODE TO                               
                         WS-C398-DEB-OCCUPIER(WS-APPL-CNT)                      
                      END-IF                                                    
                   ELSE                                                         
                      MOVE 'Y'           TO WS-K010-EOF                         
                   END-IF                                                       
               WHEN 10                                                          
               WHEN 23                                                          
                   MOVE 'Y'           TO WS-K010-EOF                            
               WHEN OTHER                                                       
                    DISPLAY 'READNEXT BP04K010 ERROR ' K010-NUM-UINFIN          
                    DISPLAY 'STATUS ' WS-K010-STATUS                            
                    MOVE WS-K010-STATUS TO RETURN-CODE                          
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       7200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       7300-LINK-BE01C812.                                                      
      ************************************************************              
                                                                                
           MOVE SPACES                 TO BE01W812-COMMAREA.                    
           INITIALIZE                     BE01W812-COMMAREA.                    
                                                                                
           MOVE 'ENQRY'                TO BE01W812-IN-RTN-FXN.                  
           MOVE 'BP13'                 TO BE01W812-IN-NUM-UPDATE-SOURCE.        
           MOVE 'ALL'                  TO BE01W812-IN-ENQRY-TYPE.               
           MOVE 'EXT'                  TO BE01W812-IN-ENQRY-SOURCE.             
                                                                                
           IF K820-NUM-CSTMR-SOURCE = SPACES OR LOW-VALUES                      
              PERFORM 7310-LINK-BE01C902  THRU 7310-EXIT                        
              IF WS-IDNTY-TYPE NOT = 'UIN' AND 'FIN'                            
                 MOVE K820-NME-OCCP       TO BE01W812-IN-NME-PERSON             
              END-IF                                                            
              MOVE K820-NUM-NRIC          TO BE01W812-IN-IDNTY-NO               
              MOVE WS-IDNTY-TYPE          TO BE01W812-IN-IDNTY-NO-TYPE          
           ELSE                                                                 
              MOVE K820-NUM-CSTMR-SOURCE  TO BE01W812-IN-CSTMR-SRC              
           END-IF.                                                              
                                                                                
           CALL 'BE01C812' USING BE01W812-COMMAREA.                             
                                                                                
           MOVE ZEROES            TO WS-IDX2.                                   
           MOVE 'N'               TO WS-MRG-TBL-FND.                            
           MOVE 1                 TO WS-CTR.                                    
                                                                                
           EVALUATE BE01W812-OUT-OUTPUT-TAG                                     
           WHEN 'F'                                                             
                ADD 1                  TO WS-BE01-SUCC                          
                PERFORM 7320-PROCESS-PERSONS THRU 7320-EXIT                     
                   UNTIL WS-CTR > BE01W812-OUT-MRG-REC-CNT                      
                IF BE01W812-OUT-MRG-REC-CNT > ZEROES                            
                   MOVE 'Y'            TO WS-MRG-TBL-FND                        
                END-IF                                                          
           WHEN 'N'                                                             
                DISPLAY 'CUSTOMER NOT FOUND / NO MRG INFO FOUND - '             
                         K820-KEY-FLD                                           
                ADD 1                  TO WS-BE01-UNSUCC                        
                                          WS-IDX2                               
                MOVE K820-NUM-CSTMR-SOURCE                                      
                                       TO WS-NUM-CSTMR(WS-IDX2)                 
                IF K820-NUM-SEX = 'F'                                           
                   MOVE K820-NUM-NRIC                                           
                                       TO WS-NUM-NRIC-WIFE(WS-IDX2)             
                   MOVE K820-NUM-NRIC-SPOUSE                                    
                                       TO WS-NUM-NRIC-HSBND(WS-IDX2)            
                ELSE                                                            
                   MOVE K820-NUM-NRIC                                           
                                       TO WS-NUM-NRIC-HSBND(WS-IDX2)            
                   MOVE K820-NUM-NRIC-SPOUSE                                    
                                       TO WS-NUM-NRIC-WIFE(WS-IDX2)             
                END-IF                                                          
           WHEN 'I'                                                             
                DISPLAY 'INPUT REQUIRED - ' K820-KEY-FLD                        
                ADD 1                  TO WS-BE01-UNSUCC                        
           WHEN 'V'                                                             
                DISPLAY 'INPUT INVALID - ' K820-KEY-FLD                         
                ADD 1                  TO WS-BE01-UNSUCC                        
           WHEN 'M'                                                             
                DISPLAY 'MRG INFO FOUND & EXCEEDED MAX INFO TO '                
                        'RETURN - ' K820-KEY-FLD                                
                ADD 1                  TO WS-BE01-UNSUCC                        
           WHEN OTHER                                                           
                MOVE BE01W812-OUT-RTN-STATCDE TO RETURN-CODE                    
                DISPLAY BE01W812-OUT-RTN-PGMID ' ERROR : '                      
                        BE01W812-OUT-RTN-ACTION                                 
                        BE01W812-OUT-RTN-MSGNO ' / '                            
                        BE01W812-OUT-RTN-STATCDE                                
                PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                       
           END-EVALUATE.                                                        
                                                                                
       7300-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ************************************************************              
       7310-LINK-BE01C902.                                                      
      ************************************************************              
                                                                                
           MOVE SPACES                     TO BE01W902-COMMAREA.                
           INITIALIZE                         BE01W902-COMMAREA.                
                                                                                
           MOVE K820-NUM-NRIC              TO BE01W902-IN-NUM-IDNTY-NO.         
                                                                                
           CALL 'BE01C902' USING BE01W902-COMMAREA.                             
           IF BE01W902-OUT-RTN-MSGNO = SPACES OR LOW-VALUES                     
              MOVE BE01W902-OUT-NUM-IDNTY-NO-TYPE                               
                                           TO WS-IDNTY-TYPE                     
           ELSE                                                                 
              IF BE01W902-OUT-RTN-MSGNO = '0127'                                
                 MOVE 'XIN'                TO WS-IDNTY-TYPE                     
              ELSE                                                              
                 DISPLAY 'ERROR IN BE01C902 NRIC : ' K820-NUM-NRIC              
                         ' / ' BE01W902-OUT-RTN-MSGNO                           
                 PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                      
              END-IF                                                            
           END-IF.                                                              
                                                                                
       7310-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ************************************************************              
       7320-PROCESS-PERSONS.                                                    
      ************************************************************              
                                                                                
           IF K820-NUM-NRIC = BE01W812-OUT-MRG-ID-NO-HSBND(WS-CTR)              
              IF BE01W812-OUT-MRG-ID-NO-WIFE(WS-CTR) =                          
                 K820-NUM-NRIC-SPOUSE                                           
                 ADD  1            TO WS-IDX2                                   
                 MOVE 'Y'          TO  WS-MRG-TBL-FND                           
                 MOVE BE01W812-OUT-MRG-CSTMRID-WIFE(WS-CTR)                     
                                   TO  WS-NUM-CSTMR(WS-IDX2)                    
                 MOVE BE01W812-OUT-MRG-ID-NO-WIFE(WS-CTR)                       
                                   TO  WS-NUM-NRIC-WIFE(WS-IDX2)                
                 MOVE BE01W812-OUT-MRG-ID-NO-HSBND(WS-CTR)                      
                                   TO  WS-NUM-NRIC-HSBND(WS-IDX2)               
              END-IF                                                            
           ELSE                                                                 
              IF K820-NUM-NRIC = BE01W812-OUT-MRG-ID-NO-WIFE(WS-CTR)            
                 IF BE01W812-OUT-MRG-ID-NO-HSBND(WS-CTR) =                      
                    K820-NUM-NRIC-SPOUSE                                        
                    ADD  1            TO WS-IDX2                                
                    MOVE 'Y'          TO  WS-MRG-TBL-FND                        
                    MOVE BE01W812-OUT-MRG-CSTMRID-HSBND(WS-CTR)                 
                                      TO  WS-NUM-CSTMR(WS-IDX2)                 
                    MOVE BE01W812-OUT-MRG-ID-NO-HSBND(WS-CTR)                   
                                      TO  WS-NUM-NRIC-HSBND(WS-IDX2)            
                    MOVE BE01W812-OUT-MRG-ID-NO-WIFE(WS-CTR)                    
                                      TO  WS-NUM-NRIC-WIFE(WS-IDX2)             
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           ADD 1                           TO WS-CTR.                           
                                                                                
       7320-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ************************************************************              
       8000-PRINT-DECLARATION.                                                  
      ************************************************************              
                                                                                
           MOVE SPACES                  TO P89DA-LINE7B.                        
           MOVE K757-NME-APPLT1         TO P89DA-NAME1A.                        
           MOVE K757-NME-APPLT2         TO P89DA-NAME1B.                        
           MOVE K757-NME-APPLT3         TO P89DA-NAME1C.                        
           MOVE K757-NME-APPLT4         TO P89DA-NAME1D.                        
                                                                                
              IF K757-NUM-SALES-MODE NOT = 'BTO'                                
                 IF (K757-NUM-FLAT-TYPE NOT = '1A' AND '2A') AND                
                     K757-NUM-PORT-ELIG-TAG NOT = 'P'                           
                       MOVE  SPACES        TO    P13P89DA-REC                   
                       WRITE P13P89DA-REC FROM   DJDE-BP130U AFTER PAGE         
                       MOVE  SPACES        TO    P13P89DA-REC                   
                       WRITE P13P89DA-REC AFTER PAGE                            
                       WRITE P13P89DA-REC  FROM P89DA-LINE7B AFTER 52           
                       WRITE P13P89DA-REC  FROM P89DA-LINE7C AFTER 6            
                 END-IF                                                         
                                                                                
                 IF (K757-NUM-FLAT-TYPE NOT = '1A' AND '2A') AND                
                     K757-NUM-PORT-ELIG-TAG = 'P'                               
                       MOVE  SPACES        TO    P13P89DA-REC                   
                       WRITE P13P89DA-REC FROM   DJDE-BP130W AFTER PAGE         
                       MOVE  SPACES        TO    P13P89DA-REC                   
                       WRITE P13P89DA-REC AFTER PAGE                            
                       WRITE P13P89DA-REC   FROM P89DA-LINE7B AFTER 52          
                       WRITE P13P89DA-REC   FROM P89DA-LINE7C AFTER 6           
                 END-IF                                                         
              ELSE                                                              
                    MOVE  SPACES        TO    P13P89DA-REC                      
                    WRITE P13P89DA-REC FROM   DJDE-BP130V AFTER PAGE            
                    MOVE  SPACES        TO    P13P89DA-REC                      
                    WRITE P13P89DA-REC AFTER PAGE                               
                    WRITE P13P89DA-REC   FROM P89DA-LINE7B AFTER 52             
                    WRITE P13P89DA-REC   FROM P89DA-LINE7C AFTER 6              
              END-IF.                                                           
                                                                                
      *    PERFORM 4001-INITIALIZE-PRT-REC   THRU 4001-EXIT.                    
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       9000-CLOSE-ROUTINE.                                                      
      ************************************************************              
           DISPLAY ' '.                                                         
           DISPLAY '- BP13C897 CONTROL TOTAL --------------'.                   
           DISPLAY '                RUN DATE : ' WS-CURR-DATE.                  
           DISPLAY '---------------------------------------'.                   
           DISPLAY ' NO OF RECS READ        (F200): ' WS-F200-READ-CNT.         
           DISPLAY ' NO OF RECS FOUND       (K800): ' WS-K800-FND-CNT.          
           DISPLAY ' NO OF RECS NFND/CANCEL (K800): ' WS-K800-NFND-CNT.         
           DISPLAY ' '.                                                         
           DISPLAY ' NO OF ELDERLY CASES          : ' WS-ELDERLY-CNT.           
           DISPLAY ' '.                                                         
                                                                                
           CLOSE BP13F200                                                       
                 BP13F205                                                       
                 BP13K060                                                       
                 BP13K062                                                       
                 BP13K757                                                       
                 BP13K813                                                       
                 BP13K800                                                       
                 BP13K820                                                       
                 BP13K830                                                       
                 BP13K246                                                       
                 BP13K76D                                                       
                 BP13K734                                                       
                 BP13K200                                                       
                 BP04K010                                                       
                 P13P89DA                                                       
                 P13L89DA.                                                      
                                                                                
           IF WS-K060-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K060, STATUS ' WS-K060-STATUS            
              MOVE WS-K060-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K062-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K062, STATUS ' WS-K062-STATUS            
              MOVE WS-K062-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K757-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K757, STATUS ' WS-K757-STATUS            
              MOVE WS-K757-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K813-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K813, STATUS ' WS-K813-STATUS            
              MOVE WS-K813-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K800, STATUS ' WS-K800-STATUS            
              MOVE WS-K800-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K820-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K820, STATUS ' WS-K820-STATUS            
              MOVE WS-K820-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K830-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K830, STATUS ' WS-K830-STATUS            
              MOVE WS-K830-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K246-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K246, STATUS ' WS-K246-STATUS            
              MOVE WS-K246-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K76D-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K76D, STATUS ' WS-K76D-STATUS            
              MOVE WS-K76D-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K734-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K734, STATUS ' WS-K734-STATUS            
              MOVE WS-K734-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K200-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K200, STATUS ' WS-K200-STATUS            
              MOVE WS-K200-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K010-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP04K010, STATUS ' WS-K010-STATUS            
              MOVE WS-K010-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           MOVE SPACES                     TO BE01W812-INPUT-INFO.              
           MOVE 'CLOSE'                    TO BE01W812-IN-RTN-FXN.              
           CALL 'BE01C812' USING BE01W812-COMMAREA.                             
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
                                                                                
       END PROGRAM BP13C897.                                                    
