       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C24D.                                                 
       AUTHOR.        ELAINE S ARGA.                                            
      *DATE-WRITTEN.  01 APR 2010.                                              
      ***************************************************************           
      * SYSTEM OF COMMITMENT (BP13)                                 *           
      ***************************************************************           
      * OBJECTIVE: PRINT REPORT ON UPDATED FLEXI LAYOUT DUE DATE    *           
      *-------------------------------------------------------------*           
      * INPUT FILES: BM06F190                                       *           
      *              BM06K100                                       *           
      *              BM06K510                                       *           
      *              BB14K500                                       *           
      *              BP13K276                                       *           
      *                                                             *           
      * OUTPUT FILE: BP13L24D (REPORT)                              *           
      *              P13L24DA (REPORT)                              *           
      *-------------------------------------------------------------*           
      * CHG REF  OIC  DATE    DESCRIPTION                           *           
      *--------- ---  ------  --------------------------------------*           
      * BP133854 ESA1 010410  NEW PROGRAM(MODELLED AFTER BP13C22N)  *           
      * BP134411 AB9  211211  INCREASE LENGTH OF BP13K276 TO 400    *           
      ***************************************************************           
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.  IBM-3090.                                              
       OBJECT-COMPUTER.  IBM-3090.                                              
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13K276  ASSIGN       TO BP13K276                            
                            ORGANIZATION IS INDEXED                             
                            ACCESS MODE  IS RANDOM                              
                            RECORD KEY   IS K276-KEY-FLD                        
                            FILE STATUS  IS WS-K276-STATUS.                     
                                                                                
           SELECT BM06K100  ASSIGN       TO BM06K100                            
                            ORGANIZATION IS INDEXED                             
                            ACCESS MODE  IS RANDOM                              
                            RECORD KEY   IS K100-KEY-FLD                        
                            FILE STATUS  IS WS-K100-STATUS.                     
                                                                                
           SELECT BM06K510  ASSIGN       TO BM06K510                            
                            ORGANIZATION IS INDEXED                             
                            ACCESS MODE  IS RANDOM                              
                            RECORD KEY   IS K510-ESTCDE                         
                            FILE STATUS  IS WS-K510-STATUS.                     
                                                                                
           SELECT BB14K500  ASSIGN       TO BB14K500                            
                            ORGANIZATION IS INDEXED                             
                            ACCESS MODE  IS RANDOM                              
                            RECORD KEY   IS K500-CDE-BLK                        
                            FILE STATUS  IS WS-K500-STATUS.                     
                                                                                
           SELECT BM06F190  ASSIGN TO BM06F190.                                 
                                                                                
           SELECT BP13L24D  ASSIGN TO BP13L24D.                                 
                                                                                
           SELECT P13L24DA  ASSIGN TO P13L24DA.                                 
                                                                                
       DATA DIVISION.                                                           
      *--------------------------------------------------------------           
       FILE SECTION.                                                            
      *--------------------------------------------------------------           
                                                                                
       FD  BP13K276                                                             
           RECORD CONTAINS 400 CHARACTERS.                                      
       COPY BP13K276.                                                           
                                                                                
       FD  BM06K100                                                             
           RECORD CONTAINS 500 CHARACTERS.                                      
       COPY BM06K100.                                                           
                                                                                
       FD  BM06K510                                                             
           RECORD CONTAINS 60  CHARACTERS.                                      
       COPY BM06K510.                                                           
                                                                                
       FD  BB14K500                                                             
           RECORD CONTAINS 400 CHARACTERS.                                      
       COPY BB14K500.                                                           
                                                                                
       FD  BM06F190                                                             
           RECORD CONTAINS 650 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       COPY BM06F190.                                                           
                                                                                
       FD  BP13L24D                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS OMITTED                                                
           RECORDING MODE IS F.                                                 
       01  BP13L24D-REC                   PIC X(132).                           
                                                                                
       FD  P13L24DA                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS OMITTED                                                
           RECORDING MODE IS F.                                                 
       01  P13L24DA-REC                   PIC X(132).                           
                                                                                
      *--------------------------------------------------------------           
       WORKING-STORAGE SECTION.                                                 
      *--------------------------------------------------------------           
       01  WS-WORK-VAR.                                                         
           05  WS-SYSTEM-DATE.                                                  
               10  WS-SYS-DATE            PIC X(08) VALUE SPACES.               
               10  FILLER              PIC X(13) VALUE SPACES.                  
           05  WS-DISP-DATE.                                                    
               10  WS-DISP-DD          PIC X(02) VALUE SPACES.                  
               10  FILLER              PIC X(01) VALUE '/'.                     
               10  WS-DISP-MM          PIC X(02) VALUE SPACES.                  
               10  FILLER              PIC X(01) VALUE '/'.                     
               10  WS-DISP-CCYY        PIC X(04) VALUE SPACES.                  
           05  WS-RETCODE              PIC -ZZZZ.                               
           05  WS-TOTAL-COST           PIC 9(08) VALUE ZEROES.                  
                                                                                
       01  WS-FILE-STATUS.                                                      
           05  WS-K276-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K100-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K510-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K500-STATUS          PIC 9(02) VALUE ZEROES.                  
                                                                                
       01  WS-SWITCHES.                                                         
           05  WS-END-OF-F190-SW       PIC X(01) VALUE SPACES.                  
               88  C-END-OF-F190       VALUE 'Y'.                               
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-F190-READ-CTR        PIC 9(06) VALUE ZEROES.                  
           05  WS-LINE-CTR             PIC 9(02) VALUE ZEROES.                  
           05  WS-PAGE-CTR             PIC 9(04) VALUE ZEROES.                  
           05  WS-LINE-CTR2            PIC 9(02) VALUE ZEROES.                  
           05  WS-PAGE-CTR2            PIC 9(04) VALUE ZEROES.                  
           05  WS-PRT-CTR              PIC 9(04) VALUE ZEROES.                  
                                                                                
      *--------------------------------------------------------------           
      *   REPORT LAYOUT                                                         
      *--------------------------------------------------------------           
       01 L24D-HEADER-1.                                                        
          05 FILLER              PIC X(08)  VALUE 'BP13L24D'.                   
          05 FILLER              PIC X(05)  VALUE SPACES .                      
          05 FILLER              PIC X(08)  VALUE 'HDBCAT3'.                    
          05 FILLER              PIC X(22)  VALUE SPACES.                       
          05 FILLER              PIC X(40)  VALUE                               
             'S Y S T E M   O F   C O M M I T M E N T'.                         
          05 FILLER              PIC X(28)  VALUE SPACES.                       
          05 FILLER              PIC X(07)  VALUE 'DATE :'.                     
          05 L24D-DATE           PIC X(10)  VALUE SPACES.                       
                                                                                
       01 L24D-HEADER-2.                                                        
          05 FILLER              PIC X(45)  VALUE SPACES .                      
          05 FILLER              PIC X(50)  VALUE                               
             'REPORT ON UPDATED POD/POF DUE DATE'.                              
          05 FILLER              PIC X(16)  VALUE SPACES .                      
          05 FILLER              PIC X(07)  VALUE 'PAGE : '.                    
          05 L24D-PAGE           PIC ZZZ9 .                                     
                                                                                
       01 L24D-HEADER-2A.                                                       
          05 FILLER              PIC X(45)  VALUE SPACES .                      
          05 FILLER              PIC X(50)  VALUE                               
             'REPORT ON UPDATED FLEXI LAYOUT DUE DATE'.                         
          05 FILLER              PIC X(16)  VALUE SPACES .                      
          05 FILLER              PIC X(07)  VALUE 'PAGE : '.                    
          05 L24D-PAGE2          PIC ZZZ9 .                                     
                                                                                
       01 L24D-HEADER-3.                                                        
          05 FILLER              PIC X(55)  VALUE                               
             'ESTATE                NEIGH/CONT  BLK NO  ECD         P'.         
          05 FILLER              PIC X(55)  VALUE                               
             'OD         POF         FLAT     NUM    COST OF     COST'.         
          05 FILLER              PIC X(24)  VALUE                               
             ' OF          TOTAL'.                                              
                                                                                
       01 L24D-HEADER-3A.                                                       
          05 FILLER              PIC X(55)  VALUE                               
             'ESTATE                NEIGH/CONT  BLK NO  ECD         F'.         
          05 FILLER              PIC X(55)  VALUE                               
             'LEXI LAYOUT   FLAT       COST OF         COST OF       '.         
          05 FILLER              PIC X(30)  VALUE                               
             '  COST OF              '.                                         
                                                                                
       01 L24D-HEADER-4.                                                        
          05 FILLER              PIC X(55)  VALUE                               
             '                                                      D'.         
          05 FILLER              PIC X(55)  VALUE                               
             'UE DATE    DUE DATE    TYPE   DOORS  DOORS       FLOOR '.         
          05 FILLER              PIC X(22)  VALUE                               
             'FINISHES   COST'.                                                 
                                                                                
       01 L24D-HEADER-4A.                                                       
          05 FILLER              PIC X(55)  VALUE                               
             '                                                      D'.         
          05 FILLER              PIC X(55)  VALUE                               
             'UE DATE       TYPE       OPTION A        OPTION B      '.         
          05 FILLER              PIC X(20)  VALUE                               
             '  OPTION C'.                                                      
                                                                                
       01 L24D-DETAIL.                                                          
          05 L24D-NME-ESTATE     PIC X(20)  VALUE SPACES.                       
          05 FILLER              PIC X(02)  VALUE SPACES.                       
          05 L24D-NEIGH-CONT     PIC X(09)  VALUE SPACES.                       
          05 FILLER              PIC X(03)  VALUE SPACES.                       
          05 L24D-NUM-BLK        PIC X(05)  VALUE SPACES.                       
          05 FILLER              PIC X(03)  VALUE SPACES.                       
          05 L24D-ECD            PIC X(10)  VALUE SPACES.                       
          05 FILLER              PIC X(02)  VALUE SPACES.                       
          05 L24D-DTE-POD-DUE    PIC X(10)  VALUE SPACES.                       
          05 FILLER              PIC X(02)  VALUE SPACES.                       
          05 L24D-DTE-POF-DUE    PIC X(10)  VALUE SPACES.                       
          05 FILLER              PIC X(02)  VALUE SPACES.                       
          05 L24D-FLAT-TYPE      PIC X(07)  VALUE SPACES.                       
          05 FILLER              PIC X(02)  VALUE SPACES.                       
          05 L24D-NUM-DOOR       PIC X(02)  VALUE SPACES.                       
          05 FILLER              PIC X(05)  VALUE SPACES.                       
          05 L24D-AMT-POD        PIC ZZ,ZZZ,ZZ9 VALUE ZEROES.                   
          05 FILLER              PIC X(02)  VALUE SPACES.                       
          05 L24D-AMT-POF        PIC ZZ,ZZZ,ZZ9 VALUE ZEROES.                   
          05 FILLER              PIC X(05)  VALUE SPACES.                       
          05 L24D-TOTAL-COST     PIC ZZ,ZZZ,ZZ9 VALUE ZEROES.                   
                                                                                
       01 L24D-DETAILA.                                                         
          05 L24D-NME-ESTATE2    PIC X(20)  VALUE SPACES.                       
          05 FILLER              PIC X(02)  VALUE SPACES.                       
          05 L24D-NEIGH-CONT2    PIC X(09)  VALUE SPACES.                       
          05 FILLER              PIC X(03)  VALUE SPACES.                       
          05 L24D-NUM-BLK2       PIC X(05)  VALUE SPACES.                       
          05 FILLER              PIC X(03)  VALUE SPACES.                       
          05 L24D-ECD2           PIC X(10)  VALUE SPACES.                       
          05 FILLER              PIC X(02)  VALUE SPACES.                       
          05 L24D-DTE-FLEXI-DUE  PIC X(10)  VALUE SPACES.                       
          05 FILLER              PIC X(05)  VALUE SPACES.                       
          05 L24D-FLAT-TYPE2     PIC X(04)  VALUE SPACES.                       
          05 FILLER              PIC X(07)  VALUE SPACES.                       
          05 L24D-COST-OPTA      PIC ---,---,--9 VALUE ZEROES.                  
          05 FILLER              PIC X(05)  VALUE SPACES.                       
          05 L24D-COST-OPTB      PIC ---,---,--9 VALUE ZEROES.                  
          05 FILLER              PIC X(05)  VALUE SPACES.                       
          05 L24D-COST-OPTC      PIC ---,---,--9 VALUE ZEROES.                  
                                                                                
       01 L24D-FOOTER-1.                                                        
          05 FILLER              PIC X(40)  VALUE SPACES .                      
          05 FILLER              PIC X(35)  VALUE                               
             'ECD AND OCS DUE DATE               '.                             
          05 FILLER              PIC X(10)  VALUE SPACES .                      
          05 FILLER              PIC X(35)  VALUE                               
             'OCS COST                           '.                             
                                                                                
       01 L24D-FOOTER-2.                                                        
          05 FILLER              PIC X(40)  VALUE SPACES .                      
          05 FILLER              PIC X(35)  VALUE                               
             'UPDATED BY: _______________________'.                             
          05 FILLER              PIC X(10)  VALUE SPACES .                      
          05 FILLER              PIC X(35)  VALUE                               
             'UPDATED BY: _______________________'.                             
                                                                                
       01 L24D-FOOTER-3.                                                        
          05 FILLER              PIC X(40)  VALUE SPACES .                      
          05 FILLER              PIC X(35)  VALUE                               
             'CHECKED BY: _______________________'.                             
          05 FILLER              PIC X(10)  VALUE SPACES .                      
          05 FILLER              PIC X(35)  VALUE                               
             'CHECKED BY                         '.                             
                                                                                
       01 L24D-FOOTER-4.                                                        
          05 FILLER              PIC X(40)  VALUE SPACES .                      
          05 FILLER              PIC X(35)  VALUE SPACES.                       
          05 FILLER              PIC X(10)  VALUE SPACES .                      
          05 FILLER              PIC X(35)  VALUE                               
             'TEAM HEAD: ________________________'.                             
                                                                                
       01 L24D-FOOTER-5.                                                        
          05 FILLER              PIC X(40)  VALUE SPACES .                      
          05 FILLER              PIC X(35)  VALUE SPACES.                       
          05 FILLER              PIC X(03)  VALUE SPACES .                      
          05 FILLER              PIC X(45)  VALUE                               
             'NOTE : COPY OF THE SALES BROCHURES'.                              
                                                                                
       01 L24D-FOOTER-6.                                                        
          05 FILLER              PIC X(40)  VALUE SPACES .                      
          05 FILLER              PIC X(35)  VALUE SPACES.                       
          05 FILLER              PIC X(10)  VALUE SPACES .                      
          05 FILLER              PIC X(35)  VALUE                               
             'SPECIFICATION ATTACHED'.                                          
                                                                                
       01  L24D-LINE             PIC X(132)    VALUE ALL '-'.                   
                                                                                
      *--------------------------------------------------------------           
       PROCEDURE DIVISION.                                                      
      *--------------------------------------------------------------           
                                                                                
      *--------------------------------*                                        
       0000-MAIN-ROUTINE.                                                       
      *--------------------------------*                                        
                                                                                
           PERFORM 1000-INITIALIZATION    THRU 1000-EXIT.                       
           PERFORM 2000-PROCESS-RECORDS   THRU 2000-EXIT                        
             UNTIL C-END-OF-F190.                                               
           PERFORM 4000-PRINT-FOOTER      THRU 4000-EXIT.                       
           PERFORM 9000-CLOSE-FILES       THRU 9000-EXIT.                       
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------*                                        
       1000-INITIALIZATION.                                                     
      *--------------------------------*                                        
                                                                                
           OPEN INPUT    BM06F190                                               
                         BP13K276                                               
                         BM06K510                                               
                         BM06K100                                               
                         BB14K500                                               
                OUTPUT   BP13L24D                                               
                         P13L24DA.                                              
                                                                                
           IF WS-K100-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPEN ERROR-BM06K100-STATUS ' WS-K100-STATUS              
              MOVE WS-K100-STATUS      TO RETURN-CODE                           
              PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K276-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPEN ERROR-BP13K276-STATUS ' WS-K276-STATUS              
              MOVE WS-K276-STATUS      TO RETURN-CODE                           
              PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K510-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPEN ERROR-BM06K510-STATUS ' WS-K510-STATUS              
              MOVE WS-K510-STATUS      TO RETURN-CODE                           
              PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K500-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPEN ERROR-BB14K500-STATUS ' WS-K500-STATUS              
              MOVE WS-K500-STATUS      TO RETURN-CODE                           
              PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE  TO WS-SYSTEM-DATE.                       
           MOVE WS-SYS-DATE(1:4)       TO WS-DISP-CCYY.                         
           MOVE WS-SYS-DATE(5:2)       TO WS-DISP-MM.                           
           MOVE WS-SYS-DATE(7:2)       TO WS-DISP-DD.                           
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------*                                        
       2000-PROCESS-RECORDS.                                                    
      *--------------------------------*                                        
                                                                                
           READ BM06F190 AT END                                                 
                MOVE 'Y'     TO WS-END-OF-F190-SW                               
                GO TO 2000-EXIT.                                                
                                                                                
           ADD 1   TO WS-F190-READ-CTR.                                         
                                                                                
           PERFORM 2100-READ-BM06K100              THRU 2100-EXIT.              
           IF K100-KEY-FLD = SPACES OR LOW-VALUES                               
              GO TO 2000-EXIT                                                   
           END-IF.                                                              
                                                                                
           PERFORM 2200-READ-BM06K510              THRU 2200-EXIT.              
           PERFORM 2300-READ-BB14K500              THRU 2300-EXIT.              
           PERFORM 2500-READ-BP13K276              THRU 2500-EXIT.              
                                                                                
           PERFORM 3000-PRINT-REPORT               THRU 3000-EXIT.              
           ADD 1   TO WS-PRT-CTR.                                               
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------*                                        
       2100-READ-BM06K100.                                                      
      *--------------------------------*                                        
                                                                                
           MOVE F190-2-ESTATE           TO K100-ESTATE.                         
           MOVE F190-2-NEIGHBOURHOOD    TO K100-NEIGHBOURHOOD.                  
           MOVE F190-2-CONTRACT-NO      TO K100-CONTRACT-NO.                    
           MOVE F190-2-BLK-NO           TO K100-BLK-NO.                         
           READ BM06K100.                                                       
                                                                                
           EVALUATE WS-K100-STATUS                                              
              WHEN 00                                                           
                   CONTINUE                                                     
              WHEN 23                                                           
                   DISPLAY 'RECORD NOT FOUND IN BM06K100: ' K100-KEY-FLD        
                   MOVE SPACES     TO K100-REC                                  
              WHEN OTHER                                                        
                   DISPLAY 'READ ERROR BM06K100,STATUS ' WS-K100-STATUS         
                   MOVE WS-K100-STATUS        TO RETURN-CODE                    
                   PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------*                                        
       2200-READ-BM06K510.                                                      
      *--------------------------------*                                        
                                                                                
           MOVE K100-ESTATE           TO K510-ESTCDE.                           
           READ BM06K510.                                                       
                                                                                
           EVALUATE WS-K510-STATUS                                              
              WHEN 00                                                           
                   CONTINUE                                                     
              WHEN 23                                                           
                   DISPLAY 'RECORD NOT FOUND IN BM06K510: ' K510-ESTCDE         
                   MOVE SPACES     TO K510-REC                                  
              WHEN OTHER                                                        
                   DISPLAY 'READ ERROR BM06K510,STATUS ' WS-K510-STATUS         
                   MOVE WS-K510-STATUS        TO RETURN-CODE                    
                   PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       2200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------*                                        
       2300-READ-BB14K500.                                                      
      *--------------------------------*                                        
                                                                                
           MOVE K100-CDE-BLK          TO K500-CDE-BLK.                          
           READ BB14K500.                                                       
                                                                                
           EVALUATE WS-K500-STATUS                                              
              WHEN 00                                                           
                   CONTINUE                                                     
              WHEN 23                                                           
                   DISPLAY 'RECORD NOT FOUND IN BB14K500, KEY: '                
                            K500-CDE-BLK                                        
                   MOVE SPACES         TO BB14K500-REC                          
              WHEN OTHER                                                        
                   DISPLAY 'READ ERROR BB14K500,STATUS ' WS-K500-STATUS         
                   MOVE WS-K500-STATUS        TO RETURN-CODE                    
                   PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       2300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------*                                        
       2500-READ-BP13K276.                                                      
      *--------------------------------*                                        
                                                                                
           MOVE K100-KEY-FLD       TO K276-KEY-FLD                              
           READ BP13K276.                                                       
                                                                                
           EVALUATE WS-K276-STATUS                                              
              WHEN 00                                                           
                   CONTINUE                                                     
              WHEN 23                                                           
                   DISPLAY 'RECORD NOT FOUND IN BP13K276, KEY: '                
                            K276-KEY-FLD                                        
                   MOVE SPACES        TO BP13K276-REC                           
              WHEN OTHER                                                        
                   DISPLAY 'READ ERROR BP13K276,STATUS ' WS-K276-STATUS         
                   MOVE WS-K276-STATUS        TO RETURN-CODE                    
                   PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       2500-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------*                                        
       3000-PRINT-REPORT.                                                       
      *--------------------------------*                                        
                                                                                
           PERFORM 3100-CHECK-LINE-CTR        THRU 3100-EXIT.                   
           PERFORM 3200-MOVE-ESTATE-DETAILS   THRU 3200-EXIT.                   
           PERFORM 3300-MOVE-POD-POF-COST     THRU 3300-EXIT.                   
           PERFORM 3400-MOVE-OPTION-COST      THRU 3400-EXIT.                   
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------*                                        
       3100-CHECK-LINE-CTR.                                                     
      *--------------------------------*                                        
                                                                                
           IF WS-LINE-CTR > 56  OR                                              
              WS-LINE-CTR = 0                                                   
              PERFORM 3110-PRINT-PAGE-BREAK   THRU 3110-EXIT                    
           END-IF.                                                              
                                                                                
           IF WS-LINE-CTR2 > 56  OR                                             
              WS-LINE-CTR2 = 0                                                  
              PERFORM 3115-PRINT-PAGE-BREAK   THRU 3115-EXIT                    
           END-IF.                                                              
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------*                                        
       3110-PRINT-PAGE-BREAK.                                                   
      *--------------------------------*                                        
                                                                                
           ADD   1   TO WS-PAGE-CTR.                                            
           MOVE WS-PAGE-CTR    TO L24D-PAGE.                                    
           MOVE WS-DISP-DATE   TO L24D-DATE.                                    
           WRITE BP13L24D-REC  FROM L24D-HEADER-1 AFTER PAGE.                   
           WRITE BP13L24D-REC  FROM L24D-HEADER-2.                              
           WRITE BP13L24D-REC  FROM L24D-LINE     AFTER 2.                      
           WRITE BP13L24D-REC  FROM L24D-HEADER-3.                              
           WRITE BP13L24D-REC  FROM L24D-HEADER-4.                              
           WRITE BP13L24D-REC  FROM L24D-LINE.                                  
           MOVE SPACES           TO BP13L24D-REC.                               
           WRITE BP13L24D-REC.                                                  
           MOVE 8                TO WS-LINE-CTR.                                
                                                                                
       3110-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------*                                        
       3115-PRINT-PAGE-BREAK.                                                   
      *--------------------------------*                                        
                                                                                
           ADD   1   TO WS-PAGE-CTR2.                                           
           MOVE WS-PAGE-CTR2   TO L24D-PAGE2.                                   
           MOVE WS-DISP-DATE   TO L24D-DATE.                                    
           WRITE P13L24DA-REC  FROM L24D-HEADER-1 AFTER PAGE.                   
           WRITE P13L24DA-REC  FROM L24D-HEADER-2A.                             
           WRITE P13L24DA-REC  FROM L24D-LINE     AFTER 2.                      
           WRITE P13L24DA-REC  FROM L24D-HEADER-3A.                             
           WRITE P13L24DA-REC  FROM L24D-HEADER-4A.                             
           WRITE P13L24DA-REC  FROM L24D-LINE.                                  
           MOVE SPACES           TO P13L24DA-REC.                               
           WRITE P13L24DA-REC.                                                  
           MOVE 8                TO WS-LINE-CTR2.                               
                                                                                
       3115-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------*                                        
       3200-MOVE-ESTATE-DETAILS.                                                
      *--------------------------------*                                        
                                                                                
           MOVE SPACES                  TO L24D-DETAIL                          
                                           L24D-DETAILA.                        
                                                                                
           MOVE K510-ESTATE-NAME        TO L24D-NME-ESTATE                      
                                           L24D-NME-ESTATE2.                    
           STRING K100-NEIGHBOURHOOD '/' K100-CONTRACT-NO                       
                  DELIMITED BY SIZE   INTO L24D-NEIGH-CONT.                     
           MOVE L24D-NEIGH-CONT         TO L24D-NEIGH-CONT2.                    
           MOVE K100-BLK-NO             TO L24D-NUM-BLK                         
                                           L24D-NUM-BLK2.                       
                                                                                
           STRING K500-DTE-BLDG-COMPLETE (7:2) '/'                              
                  K500-DTE-BLDG-COMPLETE (5:2) '/'                              
                  K500-DTE-BLDG-COMPLETE (1:4)                                  
                  DELIMITED BY SIZE   INTO L24D-ECD.                            
           MOVE   L24D-ECD              TO L24D-ECD2.                           
                                                                                
           STRING K100-DTE-POD-DUE (7:2) '/'                                    
                  K100-DTE-POD-DUE (5:2) '/'                                    
                  K100-DTE-POD-DUE (1:4)                                        
                  DELIMITED BY SIZE   INTO L24D-DTE-POD-DUE.                    
                                                                                
           STRING K100-DTE-POF-DUE (7:2) '/'                                    
                  K100-DTE-POF-DUE (5:2) '/'                                    
                  K100-DTE-POF-DUE (1:4)                                        
                  DELIMITED BY SIZE   INTO L24D-DTE-POF-DUE.                    
                                                                                
           STRING K100-DTE-FLEXI-DUE(7:2) '/'                                   
                  K100-DTE-FLEXI-DUE(5:2) '/'                                   
                  K100-DTE-FLEXI-DUE(1:4)                                       
                  DELIMITED BY SIZE   INTO L24D-DTE-FLEXI-DUE.                  
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------*                                        
       3300-MOVE-POD-POF-COST.                                                  
      *--------------------------------*                                        
                                                                                
           IF K276-NUM-POD-3RM(1) NOT = SPACES AND LOW-VALUES                   
                                        AND ZEROES                              
              PERFORM 3100-CHECK-LINE-CTR         THRU 3100-EXIT                
              MOVE '3-RM-A'               TO L24D-FLAT-TYPE                     
              MOVE K276-NUM-POD-3RM(1)    TO L24D-NUM-DOOR                      
              MOVE K276-AMT-POD-3RM(1)    TO L24D-AMT-POD                       
              MOVE K276-AMT-POF-3RM(1)    TO L24D-AMT-POF                       
              IF K276-AMT-POD-3RM(1) NOT NUMERIC                                
                 MOVE ZEROES              TO K276-AMT-POD-3RM(1)                
              END-IF                                                            
              IF K276-AMT-POF-3RM(1) NOT NUMERIC                                
                 MOVE ZEROES              TO K276-AMT-POF-3RM(1)                
              END-IF                                                            
              COMPUTE WS-TOTAL-COST = K276-AMT-POD-3RM(1) +                     
                                      K276-AMT-POF-3RM(1)                       
              MOVE WS-TOTAL-COST          TO L24D-TOTAL-COST                    
              WRITE BP13L24D-REC        FROM L24D-DETAIL                        
              ADD 1                       TO WS-LINE-CTR                        
              MOVE SPACES                 TO L24D-DETAIL                        
           END-IF.                                                              
                                                                                
           IF K276-NUM-POD-3RM(2) NOT = SPACES AND LOW-VALUES                   
                                        AND ZEROES                              
              PERFORM 3100-CHECK-LINE-CTR         THRU 3100-EXIT                
              MOVE '3-RM-B'               TO L24D-FLAT-TYPE                     
              MOVE K276-NUM-POD-3RM(2)    TO L24D-NUM-DOOR                      
              MOVE K276-AMT-POD-3RM(2)    TO L24D-AMT-POD                       
              MOVE K276-AMT-POF-3RM(2)    TO L24D-AMT-POF                       
              IF K276-AMT-POD-3RM(2) NOT NUMERIC                                
                 MOVE ZEROES              TO K276-AMT-POD-3RM(2)                
              END-IF                                                            
              IF K276-AMT-POF-3RM(2) NOT NUMERIC                                
                 MOVE ZEROES              TO K276-AMT-POF-3RM(2)                
              END-IF                                                            
              COMPUTE WS-TOTAL-COST = K276-AMT-POD-3RM(2) +                     
                                      K276-AMT-POF-3RM(2)                       
              MOVE WS-TOTAL-COST          TO L24D-TOTAL-COST                    
              WRITE BP13L24D-REC        FROM L24D-DETAIL                        
              ADD 1                       TO WS-LINE-CTR                        
              MOVE SPACES                 TO L24D-DETAIL                        
           END-IF.                                                              
                                                                                
           IF K276-NUM-POD-3RM(3) NOT = SPACES AND LOW-VALUES                   
                                        AND ZEROES                              
              PERFORM 3100-CHECK-LINE-CTR         THRU 3100-EXIT                
              MOVE '3-RM-C'               TO L24D-FLAT-TYPE                     
              MOVE K276-NUM-POD-3RM(3)    TO L24D-NUM-DOOR                      
              MOVE K276-AMT-POD-3RM(3)    TO L24D-AMT-POD                       
              MOVE K276-AMT-POF-3RM(3)    TO L24D-AMT-POF                       
              IF K276-AMT-POD-3RM(3) NOT NUMERIC                                
                 MOVE ZEROES              TO K276-AMT-POD-3RM(3)                
              END-IF                                                            
              IF K276-AMT-POF-3RM(3) NOT NUMERIC                                
                 MOVE ZEROES              TO K276-AMT-POF-3RM(3)                
              END-IF                                                            
              COMPUTE WS-TOTAL-COST = K276-AMT-POD-3RM(3) +                     
                                      K276-AMT-POF-3RM(3)                       
              MOVE WS-TOTAL-COST          TO L24D-TOTAL-COST                    
              WRITE BP13L24D-REC        FROM L24D-DETAIL                        
              ADD 1                       TO WS-LINE-CTR                        
              MOVE SPACES                 TO L24D-DETAIL                        
           END-IF.                                                              
                                                                                
           IF K276-NUM-POD-4RM(1) NOT = SPACES AND LOW-VALUES                   
                                        AND ZEROES                              
              PERFORM 3100-CHECK-LINE-CTR         THRU 3100-EXIT                
              MOVE '4-RM-A'               TO L24D-FLAT-TYPE                     
              MOVE K276-NUM-POD-4RM(1)    TO L24D-NUM-DOOR                      
              MOVE K276-AMT-POD-4RM(1)    TO L24D-AMT-POD                       
              MOVE K276-AMT-POF-4RM(1)    TO L24D-AMT-POF                       
              IF K276-AMT-POD-4RM(1) NOT NUMERIC                                
                 MOVE ZEROES              TO K276-AMT-POD-4RM(1)                
              END-IF                                                            
              IF K276-AMT-POF-4RM(1) NOT NUMERIC                                
                 MOVE ZEROES              TO K276-AMT-POF-4RM(1)                
              END-IF                                                            
              COMPUTE WS-TOTAL-COST = K276-AMT-POD-4RM(1) +                     
                                      K276-AMT-POF-4RM(1)                       
              MOVE WS-TOTAL-COST          TO L24D-TOTAL-COST                    
              WRITE BP13L24D-REC        FROM L24D-DETAIL                        
              ADD 1                       TO WS-LINE-CTR                        
              MOVE SPACES                 TO L24D-DETAIL                        
           END-IF.                                                              
                                                                                
           IF K276-NUM-POD-4RM(2) NOT = SPACES AND LOW-VALUES                   
                                        AND ZEROES                              
              PERFORM 3100-CHECK-LINE-CTR         THRU 3100-EXIT                
              MOVE '4-RM-B'               TO L24D-FLAT-TYPE                     
              MOVE K276-NUM-POD-4RM(2)    TO L24D-NUM-DOOR                      
              MOVE K276-AMT-POD-4RM(2)    TO L24D-AMT-POD                       
              MOVE K276-AMT-POF-4RM(2)    TO L24D-AMT-POF                       
              IF K276-AMT-POD-4RM(2) NOT NUMERIC                                
                 MOVE ZEROES              TO K276-AMT-POD-4RM(2)                
              END-IF                                                            
              IF K276-AMT-POF-4RM(2) NOT NUMERIC                                
                 MOVE ZEROES              TO K276-AMT-POF-4RM(2)                
              END-IF                                                            
              COMPUTE WS-TOTAL-COST = K276-AMT-POD-4RM(2) +                     
                                      K276-AMT-POF-4RM(2)                       
              MOVE WS-TOTAL-COST          TO L24D-TOTAL-COST                    
              WRITE BP13L24D-REC        FROM L24D-DETAIL                        
              ADD 1                       TO WS-LINE-CTR                        
              MOVE SPACES                 TO L24D-DETAIL                        
           END-IF.                                                              
                                                                                
           IF K276-NUM-POD-4RM(3) NOT = SPACES AND LOW-VALUES                   
                                        AND ZEROES                              
              PERFORM 3100-CHECK-LINE-CTR         THRU 3100-EXIT                
              MOVE '4-RM-C'               TO L24D-FLAT-TYPE                     
              MOVE K276-NUM-POD-4RM(3)    TO L24D-NUM-DOOR                      
              MOVE K276-AMT-POD-4RM(3)    TO L24D-AMT-POD                       
              MOVE K276-AMT-POF-4RM(3)    TO L24D-AMT-POF                       
              IF K276-AMT-POD-4RM(3) NOT NUMERIC                                
                 MOVE ZEROES              TO K276-AMT-POD-4RM(3)                
              END-IF                                                            
              IF K276-AMT-POF-4RM(3) NOT NUMERIC                                
                 MOVE ZEROES              TO K276-AMT-POF-4RM(3)                
              END-IF                                                            
              COMPUTE WS-TOTAL-COST = K276-AMT-POD-4RM(3) +                     
                                      K276-AMT-POF-4RM(3)                       
              MOVE WS-TOTAL-COST          TO L24D-TOTAL-COST                    
              WRITE BP13L24D-REC        FROM L24D-DETAIL                        
              ADD 1                       TO WS-LINE-CTR                        
              MOVE SPACES                 TO L24D-DETAIL                        
           END-IF.                                                              
                                                                                
           IF K276-NUM-POD-5RM(1) NOT = SPACES AND LOW-VALUES                   
                                        AND ZEROES                              
              PERFORM 3100-CHECK-LINE-CTR         THRU 3100-EXIT                
              MOVE '5-RM-A'               TO L24D-FLAT-TYPE                     
              MOVE K276-NUM-POD-5RM(1)    TO L24D-NUM-DOOR                      
              MOVE K276-AMT-POD-5RM(1)    TO L24D-AMT-POD                       
              MOVE K276-AMT-POF-5RM(1)    TO L24D-AMT-POF                       
              IF K276-AMT-POD-5RM(1) NOT NUMERIC                                
                 MOVE ZEROES              TO K276-AMT-POD-5RM(1)                
              END-IF                                                            
              IF K276-AMT-POF-5RM(1) NOT NUMERIC                                
                 MOVE ZEROES              TO K276-AMT-POF-5RM(1)                
              END-IF                                                            
              COMPUTE WS-TOTAL-COST = K276-AMT-POD-5RM(1) +                     
                                      K276-AMT-POF-5RM(1)                       
              MOVE WS-TOTAL-COST          TO L24D-TOTAL-COST                    
              WRITE BP13L24D-REC        FROM L24D-DETAIL                        
              ADD 1                       TO WS-LINE-CTR                        
              MOVE SPACES                 TO L24D-DETAIL                        
           END-IF.                                                              
                                                                                
           IF K276-NUM-POD-5RM(2) NOT = SPACES AND LOW-VALUES                   
                                        AND ZEROES                              
              PERFORM 3100-CHECK-LINE-CTR         THRU 3100-EXIT                
              MOVE '5-RM-B'               TO L24D-FLAT-TYPE                     
              MOVE K276-NUM-POD-5RM(2)    TO L24D-NUM-DOOR                      
              MOVE K276-AMT-POD-5RM(2)    TO L24D-AMT-POD                       
              MOVE K276-AMT-POF-5RM(2)    TO L24D-AMT-POF                       
              IF K276-AMT-POD-5RM(2) NOT NUMERIC                                
                 MOVE ZEROES              TO K276-AMT-POD-5RM(2)                
              END-IF                                                            
              IF K276-AMT-POF-5RM(2) NOT NUMERIC                                
                 MOVE ZEROES              TO K276-AMT-POF-5RM(2)                
              END-IF                                                            
              COMPUTE WS-TOTAL-COST = K276-AMT-POD-5RM(2) +                     
                                      K276-AMT-POF-5RM(2)                       
              MOVE WS-TOTAL-COST          TO L24D-TOTAL-COST                    
              WRITE BP13L24D-REC        FROM L24D-DETAIL                        
              ADD 1                       TO WS-LINE-CTR                        
              MOVE SPACES                 TO L24D-DETAIL                        
           END-IF.                                                              
                                                                                
           IF K276-NUM-POD-5RM(3) NOT = SPACES AND LOW-VALUES                   
                                        AND ZEROES                              
              PERFORM 3100-CHECK-LINE-CTR         THRU 3100-EXIT                
              MOVE '5-RM-C'               TO L24D-FLAT-TYPE                     
              MOVE K276-NUM-POD-5RM(3)    TO L24D-NUM-DOOR                      
              MOVE K276-AMT-POD-5RM(3)    TO L24D-AMT-POD                       
              MOVE K276-AMT-POF-5RM(3)    TO L24D-AMT-POF                       
              IF K276-AMT-POD-5RM(3) NOT NUMERIC                                
                 MOVE ZEROES              TO K276-AMT-POD-5RM(3)                
              END-IF                                                            
              IF K276-AMT-POF-5RM(3) NOT NUMERIC                                
                 MOVE ZEROES              TO K276-AMT-POF-5RM(3)                
              END-IF                                                            
              COMPUTE WS-TOTAL-COST = K276-AMT-POD-5RM(3) +                     
                                      K276-AMT-POF-5RM(3)                       
              MOVE WS-TOTAL-COST          TO L24D-TOTAL-COST                    
              WRITE BP13L24D-REC        FROM L24D-DETAIL                        
              ADD 1                       TO WS-LINE-CTR                        
              MOVE SPACES                 TO L24D-DETAIL                        
           END-IF.                                                              
                                                                                
       3300-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *--------------------------------*                                        
       3400-MOVE-OPTION-COST.                                                   
      *--------------------------------*                                        
           IF K276-AMT-OPTION-3RM(1) NOT = SPACES AND LOW-VALUES OR             
              K276-AMT-OPTION-3RM(2) NOT = SPACES AND LOW-VALUES OR             
              K276-AMT-OPTION-3RM(3) NOT = SPACES AND LOW-VALUES                
              PERFORM 3100-CHECK-LINE-CTR   THRU 3100-EXIT                      
              MOVE '3-RM'                   TO L24D-FLAT-TYPE2                  
              MOVE K276-AMT-OPTION-3RM(1)   TO L24D-COST-OPTA                   
              MOVE K276-AMT-OPTION-3RM(2)   TO L24D-COST-OPTB                   
              MOVE K276-AMT-OPTION-3RM(3)   TO L24D-COST-OPTC                   
              WRITE P13L24DA-REC            FROM L24D-DETAILA                   
              ADD 1                         TO WS-LINE-CTR2                     
              MOVE SPACES                   TO L24D-DETAILA                     
           END-IF.                                                              
                                                                                
           IF K276-AMT-OPTION-4RM(1) NOT = SPACES AND LOW-VALUES OR             
              K276-AMT-OPTION-4RM(2) NOT = SPACES AND LOW-VALUES OR             
              K276-AMT-OPTION-4RM(3) NOT = SPACES AND LOW-VALUES                
              PERFORM 3100-CHECK-LINE-CTR   THRU 3100-EXIT                      
              MOVE '4-RM'                   TO L24D-FLAT-TYPE2                  
              MOVE K276-AMT-OPTION-4RM(1)   TO L24D-COST-OPTA                   
              MOVE K276-AMT-OPTION-4RM(2)   TO L24D-COST-OPTB                   
              MOVE K276-AMT-OPTION-4RM(3)   TO L24D-COST-OPTC                   
              WRITE P13L24DA-REC            FROM L24D-DETAILA                   
              ADD 1                         TO WS-LINE-CTR2                     
              MOVE SPACES                   TO L24D-DETAILA                     
           END-IF.                                                              
                                                                                
           IF K276-AMT-OPTION-5RM(1) NOT = SPACES AND LOW-VALUES OR             
              K276-AMT-OPTION-5RM(2) NOT = SPACES AND LOW-VALUES OR             
              K276-AMT-OPTION-5RM(3) NOT = SPACES AND LOW-VALUES                
              PERFORM 3100-CHECK-LINE-CTR   THRU 3100-EXIT                      
              MOVE '5-RM'                   TO L24D-FLAT-TYPE2                  
              MOVE K276-AMT-OPTION-5RM(1)   TO L24D-COST-OPTA                   
              MOVE K276-AMT-OPTION-5RM(2)   TO L24D-COST-OPTB                   
              MOVE K276-AMT-OPTION-5RM(3)   TO L24D-COST-OPTC                   
              WRITE P13L24DA-REC            FROM L24D-DETAILA                   
              ADD 1                         TO WS-LINE-CTR2                     
              MOVE SPACES                   TO L24D-DETAILA                     
           END-IF.                                                              
                                                                                
       3400-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *--------------------------------*                                        
       4000-PRINT-FOOTER.                                                       
      *--------------------------------*                                        
                                                                                
           IF WS-LINE-CTR > 38                                                  
              WRITE BP13L24D-REC  FROM L24D-FOOTER-1 AFTER PAGE                 
           ELSE                                                                 
              WRITE BP13L24D-REC  FROM L24D-FOOTER-1 AFTER 10                   
           END-IF.                                                              
                                                                                
           WRITE BP13L24D-REC     FROM L24D-FOOTER-2.                           
           WRITE BP13L24D-REC     FROM L24D-FOOTER-3 AFTER 2.                   
           WRITE BP13L24D-REC     FROM L24D-FOOTER-4.                           
           WRITE BP13L24D-REC     FROM L24D-FOOTER-5 AFTER 3.                   
           WRITE BP13L24D-REC     FROM L24D-FOOTER-6.                           
                                                                                
           IF WS-LINE-CTR2 > 38                                                 
              WRITE P13L24DA-REC  FROM L24D-FOOTER-1 AFTER PAGE                 
           ELSE                                                                 
              WRITE P13L24DA-REC  FROM L24D-FOOTER-1 AFTER 10                   
           END-IF.                                                              
                                                                                
           WRITE P13L24DA-REC     FROM L24D-FOOTER-2.                           
           WRITE P13L24DA-REC     FROM L24D-FOOTER-3 AFTER 2.                   
           WRITE P13L24DA-REC     FROM L24D-FOOTER-4.                           
           WRITE P13L24DA-REC     FROM L24D-FOOTER-5 AFTER 3.                   
           WRITE P13L24DA-REC     FROM L24D-FOOTER-6.                           
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------*                                        
       9000-CLOSE-FILES.                                                        
      *--------------------------------*                                        
                                                                                
           DISPLAY 'PROGRAM ID   : BP13C24D'.                                   
           DISPLAY 'CURRENT DATE : ' WS-DISP-DATE.                              
           DISPLAY SPACES.                                                      
           DISPLAY '*=============== COUNTERS ===============*'.                
           DISPLAY 'BM06F190 RECORDS READ       : ' WS-F190-READ-CTR.           
           DISPLAY 'NO. OF RECORDS PRINTED      : ' WS-PRT-CTR.                 
                                                                                
           CLOSE BM06K100                                                       
                 BM06K510                                                       
                 BB14K500                                                       
                 BM06F190                                                       
                 BP13L24D                                                       
                 P13L24DA.                                                      
                                                                                
            IF WS-K100-STATUS NOT = 00                                          
               DISPLAY 'CLOSE ERROR-BM06K100-STATUS ' WS-K100-STATUS            
            END-IF.                                                             
                                                                                
            IF WS-K510-STATUS NOT = 00                                          
               DISPLAY 'CLOSE ERROR-BM06K510-STATUS ' WS-K510-STATUS            
            END-IF.                                                             
                                                                                
            IF WS-K500-STATUS NOT = 00                                          
               DISPLAY 'CLOSE ERROR-BB14K500-STATUS ' WS-K500-STATUS            
            END-IF.                                                             
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
