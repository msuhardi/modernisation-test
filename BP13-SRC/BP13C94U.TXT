       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C94U.                                                 
       AUTHOR.        GURU..                                                    
      *DATE-WRITTEN.  23/02/2022.                                               
                                                                                
      *===============================================================*         
      *===         HDB SYSTEM OF COMMITMENT (BP13)                 ===*         
      *===============================================================*         
      *                                                               *         
      *  OBJECTIVES : TO WRITE BP13/BM06 CODE TABLE DETAILS.          *         
      *                                                               *         
      *===============================================================*         
      * MODIFICATIONS :                                               *         
      *===============================================================*         
      * CHGE-REQ   DATE        AUTHOR  REMARKS                        *         
      * --------------------------------------------------------------*         
      * BP138923   23/02/2022  KR13    NEW PROGRAM.                   *         
      * BP139003   01/04/2022  KR13    FIX HEADER RECORD.             *         
      * BP139497   14/02/2023  EAA2    ADDED THE FOLLOWING            *         
      *                                 - BP13_CITIZENSHIP            *         
      *                                 - BP13_RACE                   *         
      *                                CORRECTED THE FOLLOWING        *         
      *                                 - BP13_CZNSHP_HSHLD           *         
      *                                 - BP13_HSHLD_TYPE             *         
      * BP139506   10/03/2023  EAA2    GET HDR DATE FROM SY02F001     *         
      * BP138916   31/03/2023  EAA2    CHANGE NUM-CODE TO 2-BYTES CODE*         
      *                                FOR BP13_APPL_STATUS           *         
      *****************************************************************         
                                                                                
      *--------------------*                                                    
       ENVIRONMENT DIVISION.                                                    
      *--------------------*                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13K060  ASSIGN        TO BP13K060                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K060-KEY-FLD                       
                            FILE STATUS   IS BP13K060-STATUS.                   
                                                                                
           SELECT BP13FW3P  ASSIGN        TO BP13FW3P.                          
                                                                                
           SELECT BM06F956  ASSIGN        TO BM06F956.                          
           SELECT SY02F001  ASSIGN        TO SY02F001.                          
                                                                                
      *--------------*                                                          
       DATA DIVISION.                                                           
      *--------------*                                                          
       FILE SECTION.                                                            
                                                                                
       FD   BP13K060                                                            
            RECORD CONTAINS 25 CHARACTERS.                                      
       COPY BP13K060.                                                           
                                                                                
       FD   BP13FW3P                                                            
            RECORD CONTAINS 100 CHARACTERS                                      
            BLOCK CONTAINS 0 RECORDS                                            
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13FW3P.                                                           
                                                                                
       FD   BM06F956                                                            
            RECORD CONTAINS 100 CHARACTERS                                      
            BLOCK CONTAINS 0 RECORDS                                            
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BM06F956.                                                           
                                                                                
       COPY SY02F001.                                                           
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       COPY RPCODE.                                                             
                                                                                
       01  WS-SYSTEM-DATE.                                                      
           05  WS-SYS-DATE                 PIC X(08) VALUE SPACES.              
           05  FILLER                      PIC X(13) VALUE SPACES.              
       01 WS-REC-CNTR.                                                          
          05 WS-FW3P-WRITE                 PIC 9(08) VALUE ZERO.                
          05 WS-F956-WRITE                 PIC 9(08) VALUE ZERO.                
          05 WS-SERIAL-NO                  PIC 9(2)  VALUE ZEROS.               
          05 WS-SERIAL-NO-SUB              PIC 9(2)  VALUE ZEROS.               
          05 WS-CNT                        PIC 9(4)  VALUE ZEROS.               
          05 WS-CNT1                       PIC 9(4)  VALUE ZEROS.               
          05 BP13K060-STATUS               PIC 9(02).                           
             88 BP13K060-OK                VALUE 00.                            
             88 BP13K060-02                VALUE 02.                            
             88 BP13K060-04                VALUE 04.                            
             88 BP13K060-EOF               VALUE 10.                            
             88 BP13K060-NFND              VALUE 23.                            
                                                                                
        01  WS-HEADER-REC.                                                      
            05  WS-HEADER-FLD              PIC X(2) VALUE 'H|'.                 
            05  WS-DTE-HDB-SEND            PIC X(10).                           
            05  WS-FILLER1                 PIC X(88).                           
                                                                                
        01  WS-CONTROL-REC.                                                     
            05  WS-CONTROL-FLD             PIC X(2) VALUE 'T|'.                 
            05  WS-NUM-TOTAL-RECS          PIC 9(9).                            
            05  WS-FILLER2                 PIC X(89).                           
                                                                                
      *==================*                                                      
       PROCEDURE DIVISION.                                                      
      *==================*                                                      
                                                                                
      *----------*                                                              
       0000-MAIN.                                                               
      *----------*                                                              
                                                                                
           PERFORM 1000-INITIALIZE          THRU 1000-EXIT.                     
                                                                                
           PERFORM 2000-PROCESS-BP13        THRU 2000-EXIT.                     
                                                                                
           PERFORM 3000-PROCESS-BM06        THRU 3000-EXIT.                     
                                                                                
           PERFORM 9000-CLOSE-FILES         THRU 9000-EXIT.                     
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------*                                                        
       1000-INITIALIZE.                                                         
      *----------------*                                                        
                                                                                
           OPEN  INPUT BP13K060                                                 
                       SY02F001                                                 
                OUTPUT BP13FW3P                                                 
                       BM06F956.                                                
                                                                                
           IF BP13K060-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'OPEN ERROR OCCURED FOR BP13K060'                         
              DISPLAY 'FILE STATUS :' BP13K060-STATUS                           
              MOVE BP13K060-STATUS         TO RETURN-CODE                       
              PERFORM 9900-ABNORMAL-END    THRU 9900-EXIT                       
           END-IF.                                                              
                                                                                
           READ SY02F001.                                                       
                                                                                
           MOVE FUNCTION CURRENT-DATE       TO WS-SYSTEM-DATE.                  
           MOVE SPACES                      TO WS-FILLER1 WS-FILLER2.           
                                                                                
           STRING F001-DTE-CURRENT(1:4) '-' F001-DTE-CURRENT(5:2) '-'           
                  F001-DTE-CURRENT(7:2)                                         
               DELIMITED BY SIZE INTO WS-DTE-HDB-SEND.                          
                                                                                
           WRITE BP13FW3P-REC FROM WS-HEADER-REC.                               
           WRITE BM06F956-REC FROM WS-HEADER-REC.                               
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------*                                                
       2000-PROCESS-BP13.                                                       
      *------------------------*                                                
                                                                                
      ***Allocation Tag                                                         
           MOVE 26                          TO WS-SERIAL-NO                     
           PERFORM 2100-START-K060          THRU 2100-EXIT.                     
      ***Allocation Scheme                                                      
           MOVE 05                          TO WS-SERIAL-NO                     
           PERFORM 2100-START-K060          THRU 2100-EXIT.                     
      ***Application Status                                                     
           PERFORM 2200-APPL-STATUS         THRU 2200-EXIT.                     
      ***Applicant / Occupier                                                   
           PERFORM 2700-APPL-OCCUP          THRU 2700-EXIT.                     
      ***Ballot Household                                                       
           PERFORM 2400-BALLOT-HSEHLD       THRU 2400-EXIT.                     
      ***BTO Zone                                                               
           MOVE 91                          TO WS-SERIAL-NO                     
           PERFORM 2100-START-K060          THRU 2100-EXIT.                     
      ***Cancel Reason                                                          
           MOVE 54                          TO WS-SERIAL-NO                     
           PERFORM 2100-START-K060          THRU 2100-EXIT.                     
      ***Citizenship                                                            
           MOVE 25                          TO WS-SERIAL-NO                     
           PERFORM 2100-START-K060          THRU 2100-EXIT.                     
      ***Citizenship Household                                                  
           PERFORM 2800-CZNSHP_HSHLD        THRU 2800-EXIT.                     
      ***Did Not Come-DNC Reason                                                
           MOVE 58                          TO WS-SERIAL-NO                     
           PERFORM 2100-START-K060          THRU 2100-EXIT.                     
      ***Education Level                                                        
           MOVE 52                          TO WS-SERIAL-NO                     
           PERFORM 2100-START-K060          THRU 2100-EXIT.                     
      ***Eligibility Scheme                                                     
           MOVE 06                          TO WS-SERIAL-NO                     
           PERFORM 2100-START-K060          THRU 2100-EXIT.                     
      ***Employment Status                                                      
           PERFORM 2500-EMPLOYMENT-STATUS   THRU 2500-EXIT.                     
      ***Ethnic Group                                                           
           MOVE 31                          TO WS-SERIAL-NO                     
           MOVE 01                          TO WS-SERIAL-NO-SUB                 
           PERFORM 2100-START-K060          THRU 2100-EXIT.                     
      ***Gender                                                                 
           MOVE 22                          TO WS-SERIAL-NO                     
           PERFORM 2100-START-K060          THRU 2100-EXIT.                     
      ***Holding Type                                                           
           PERFORM 2600-HOLDING-TYPE        THRU 2600-EXIT.                     
      ***Household Type                                                         
           PERFORM 2900-HSHLD_TYPE          THRU 2900-EXIT.                     
      ***Loan Tag                                                               
           PERFORM 2300-LOAN-TAG            THRU 2300-EXIT.                     
      ***Marital Status                                                         
           MOVE 21                          TO WS-SERIAL-NO                     
           PERFORM 2100-START-K060          THRU 2100-EXIT.                     
      ***Race Group                                                             
           MOVE 31                          TO WS-SERIAL-NO                     
           MOVE 02                          TO WS-SERIAL-NO-SUB                 
           PERFORM 2100-START-K060          THRU 2100-EXIT.                     
      ***Relationship                                                           
           MOVE 35                          TO WS-SERIAL-NO                     
           PERFORM 2100-START-K060          THRU 2100-EXIT.                     
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *------------------------*                                                
       3000-PROCESS-BM06.                                                       
      *------------------------*                                                
                                                                                
      ***Allocation Tag                                                         
           MOVE 57                          TO WS-SERIAL-NO                     
           PERFORM 2100-START-K060          THRU 2100-EXIT.                     
      ***Repossessed code      - COPYCOB(RPCODE)                                
           PERFORM 3800-REPOSSESS-CODE      THRU 3800-EXIT.                     
      ***Allocation Status    A, I (accept) R (reject)                          
           PERFORM 3700-ALLOCATION-STATUS   THRU 3700-EXIT.                     
      ***Flat Status                                                            
           PERFORM 3600-FLAT-STATUS         THRU 3600-EXIT.                     
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------*                                                         
       2100-START-K060.                                                         
      *---------------*                                                         
           INITIALIZE  BP13K060-REC                                             
                                                                                
           MOVE SPACES                     TO K060-KEY-FLD                      
           MOVE WS-SERIAL-NO               TO K060-SERIAL-NO                    
                                                                                
           START BP13K060 KEY >= K060-KEY-FLD                                   
                                                                                
           EVALUATE TRUE                                                        
               WHEN BP13K060-OK                                                 
               WHEN BP13K060-02                                                 
                    PERFORM 2150-READ-BP13K060 THRU 2150-EXIT                   
                      UNTIL BP13K060-EOF                                        
               WHEN BP13K060-NFND                                               
                    DISPLAY 'KEY NOT FOUND IN BP13K060!'                        
                    DISPLAY 'KEY : ' K060-KEY-FLD                               
                    SET BP13K060-EOF       TO TRUE                              
               WHEN OTHER                                                       
                    DISPLAY 'ERROR LOCATING KEY IN BP13K060!'                   
                    DISPLAY 'KEY : ' K060-KEY-FLD                               
                    DISPLAY 'FILE STATUS :' BP13K060-STATUS                     
                    MOVE BP13K060-STATUS   TO RETURN-CODE                       
                    PERFORM 9900-ABNORMAL-END THRU 9900-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------*                                                         
       2150-READ-BP13K060.                                                      
      *---------------*                                                         
                                                                                
           READ BP13K060 NEXT                                                   
           AT END                                                               
              SET BP13K060-EOF             TO TRUE                              
           END-READ                                                             
                                                                                
           EVALUATE TRUE                                                        
               WHEN BP13K060-OK                                                 
                 IF WS-SERIAL-NO = K060-SERIAL-NO                               
                    IF K060-CODE = 999                                          
                       GO TO 2150-EXIT                                          
                    END-IF                                                      
                    MOVE SPACES                    TO BP13FW3P-REC              
                    MOVE K060-CODE                 TO FW3P-NUM-CODE             
                    MOVE K060-DESC                 TO FW3P-NUM-DESC             
                    MOVE '~'                       TO BP13FW3P-REC(26:1)        
                                                      BP13FW3P-REC(30:1)        
                                                      BP13FW3P-REC(81:1)        
                    EVALUATE WS-SERIAL-NO                                       
                        WHEN 25                                                 
                             MOVE 'BP13_CITIZENSHIP'   TO FW3P-NUM-TYPE         
                        WHEN 26                                                 
                             MOVE 'BP13_ALLOC_TAG'     TO FW3P-NUM-TYPE         
                        WHEN 91                                                 
                             MOVE 'BP13_BTO_ZONE'      TO FW3P-NUM-TYPE         
                        WHEN 54                                                 
                             MOVE 'BP13_CANCEL_REASON' TO FW3P-NUM-TYPE         
                        WHEN 58                                                 
                             MOVE 'BP13_DNC_REASON'    TO FW3P-NUM-TYPE         
                        WHEN 05                                                 
                             MOVE 'BP13_ALLOCN_SCH'    TO FW3P-NUM-TYPE         
                        WHEN 06                                                 
                             MOVE 'BP13_ELIG_SCH'      TO FW3P-NUM-TYPE         
                        WHEN 31                                                 
                             IF WS-SERIAL-NO-SUB = 01                           
                                MOVE 'BP13_ETHNIC'     TO FW3P-NUM-TYPE         
                             ELSE                                               
                                IF WS-SERIAL-NO-SUB = 02                        
                                   MOVE 'BP13_RACE'    TO FW3P-NUM-TYPE         
                                END-IF                                          
                             END-IF                                             
                        WHEN 35                                                 
                             MOVE 'BP13_RLTNSP'        TO FW3P-NUM-TYPE         
                        WHEN 22                                                 
                             MOVE 'BP13_GENDER'        TO FW3P-NUM-TYPE         
                        WHEN 21                                                 
                             MOVE 'BP13_MARITAL_STATUS' TO FW3P-NUM-TYPE        
                        WHEN 52                                                 
                             MOVE 'BP13_EDU_LEVEL'     TO FW3P-NUM-TYPE         
                        WHEN 57                                                 
                             MOVE 'BM06_ALLOCN_TAG'    TO FW3P-NUM-TYPE         
                    END-EVALUATE                                                
                                                                                
                    IF WS-SERIAL-NO = 57                                        
                       WRITE BM06F956-REC FROM BP13FW3P-REC                     
                       ADD 1 TO WS-F956-WRITE                                   
                    ELSE                                                        
                       WRITE BP13FW3P-REC                                       
                       ADD 1 TO WS-FW3P-WRITE                                   
                    END-IF                                                      
                 ELSE                                                           
                    SET BP13K060-EOF       TO TRUE                              
                 END-IF                                                         
               WHEN BP13K060-04                                                 
                    DISPLAY 'INVALID RECORD LENGTH!'                            
                    DISPLAY 'K060-KEY-FLD :' K060-KEY-FLD                       
                    DISPLAY 'FILE STATUS : ' BP13K060-STATUS                    
               WHEN BP13K060-EOF                                                
                    DISPLAY 'END OF FILE REACHED FOR K060!'                     
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13K060!'                           
                    DISPLAY 'K060-KEY-FLD :' K060-KEY-FLD                       
                    DISPLAY 'FILE STATUS : ' BP13K060-STATUS                    
                    MOVE BP13K060-STATUS   TO RETURN-CODE                       
                    PERFORM 9900-ABNORMAL-END  THRU 9900-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       2150-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       2200-APPL-STATUS.                                                        
      *--------------------*                                                    
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'AP'                        TO FW3P-NUM-CODE                    
           MOVE 'NEW APPLICATION'           TO FW3P-NUM-DESC                    
           MOVE 'BP13_APPL_STATUS'          TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'BK'                        TO FW3P-NUM-CODE                    
           MOVE 'BOOKED FLAT'               TO FW3P-NUM-DESC                    
           MOVE 'BP13_APPL_STATUS'          TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'CA'                        TO FW3P-NUM-CODE                    
           MOVE 'CANCELLED'                 TO FW3P-NUM-DESC                    
           MOVE 'BP13_APPL_STATUS'          TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'SA'                        TO FW3P-NUM-CODE                    
           MOVE 'SIGNED AGREEMENT'          TO FW3P-NUM-DESC                    
           MOVE 'BP13_APPL_STATUS'          TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'TP'                        TO FW3P-NUM-CODE                    
           MOVE 'TAKEN PROCESSION'          TO FW3P-NUM-DESC                    
           MOVE 'BP13_APPL_STATUS'          TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
       2200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       2300-LOAN-TAG.                                                           
      *--------------------*                                                    
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'H'                         TO FW3P-NUM-CODE                    
           MOVE 'HDB LOAN'                  TO FW3P-NUM-DESC                    
           MOVE 'BP13_LOAN_TAG'             TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'B'                         TO FW3P-NUM-CODE                    
           MOVE 'BANK'                      TO FW3P-NUM-DESC                    
           MOVE 'BP13_LOAN_TAG'             TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'P'                         TO FW3P-NUM-CODE                    
           MOVE 'PENDING'                   TO FW3P-NUM-DESC                    
           MOVE 'BP13_LOAN_TAG'             TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'A'                         TO FW3P-NUM-CODE                    
           MOVE 'MARKET RATE'               TO FW3P-NUM-DESC                    
           MOVE 'BP13_LOAN_TAG'             TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
       2300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       2400-BALLOT-HSEHLD.                                                      
      *--------------------*                                                    
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'H'                         TO FW3P-NUM-CODE                    
           MOVE 'FIRST TIMER'               TO FW3P-NUM-DESC                    
           MOVE 'BP13_HSEHOLD_TYPE'         TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'G'                         TO FW3P-NUM-CODE                    
           MOVE 'SECOND TIMER'               TO FW3P-NUM-DESC                   
           MOVE 'BP13_HSEHOLD_TYPE'         TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'T'                         TO FW3P-NUM-CODE                    
           MOVE 'TENANT'                    TO FW3P-NUM-DESC                    
           MOVE 'BP13_HSEHOLD_TYPE'         TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'F'                         TO FW3P-NUM-CODE                    
           MOVE 'FIRST TIMER/SECOND TIMER COUPLE'                               
                                            TO FW3P-NUM-DESC                    
           MOVE 'BP13_HSEHOLD_TYPE'         TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
       2400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       2700-APPL-OCCUP.                                                         
      *--------------------*                                                    
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'H1'                        TO FW3P-NUM-CODE                    
           MOVE 'APPLICANT 1'               TO FW3P-NUM-DESC                    
           MOVE 'BP13_APPL_OCCUP'           TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'H2'                        TO FW3P-NUM-CODE                    
           MOVE 'APPLICANT 2'               TO FW3P-NUM-DESC                    
           MOVE 'BP13_APPL_OCCUP'           TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'H3'                        TO FW3P-NUM-CODE                    
           MOVE 'APPLICANT 3'               TO FW3P-NUM-DESC                    
           MOVE 'BP13_APPL_OCCUP'           TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'H4'                        TO FW3P-NUM-CODE                    
           MOVE 'APPLICANT 4'               TO FW3P-NUM-DESC                    
           MOVE 'BP13_APPL_OCCUP'           TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'O'                        TO FW3P-NUM-CODE                     
           MOVE 'OCCUPIER'               TO FW3P-NUM-DESC                       
           MOVE 'BP13_APPL_OCCUP'           TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
       2700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       3800-REPOSSESS-CODE.                                                     
      *--------------------*                                                    
                                                                                
           COMPUTE WS-CNT = LENGTH OF WS-REPOSS-TABLE /                         
                            LENGTH OF WS-REPOSS-ENTRY.                          
                                                                                
           PERFORM VARYING WS-CNT1 FROM 1 BY 1 UNTIL WS-CNT1 > WS-CNT           
               MOVE SPACES               TO BM06F956-REC                        
               MOVE WS-REPOSS-CDE(WS-CNT1) TO F956-NUM-CODE                     
               MOVE WS-REPOSS-TEXT(WS-CNT1)TO F956-NUM-DESC                     
               MOVE 'BM06_REPOSSESSED_CODE'  TO F956-NUM-TYPE                   
               MOVE '~'                    TO BM06F956-REC(26:1)                
                           BM06F956-REC(30:1) BM06F956-REC(81:1)                
               WRITE BM06F956-REC                                               
               ADD 1 TO WS-F956-WRITE                                           
           END-PERFORM.                                                         
       3800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-----------------------*                                                 
       3700-ALLOCATION-STATUS.                                                  
      *-----------------------*                                                 
      *** A,I - ACCEPT / R - REJECT                                             
           MOVE SPACES                      TO BM06F956-REC                     
           MOVE 'A'                         TO F956-NUM-CODE                    
           MOVE 'ACCEPT'                    TO F956-NUM-DESC                    
           MOVE 'BM06_ALLOCN_STATUS'        TO F956-NUM-TYPE                    
           MOVE '~'                         TO BM06F956-REC(26:1)               
                            BM06F956-REC(30:1) BM06F956-REC(81:1)               
           WRITE BM06F956-REC.                                                  
           ADD 1 TO WS-F956-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BM06F956-REC                     
           MOVE 'I'                         TO F956-NUM-CODE                    
           MOVE 'ACCEPT'                    TO F956-NUM-DESC                    
           MOVE 'BM06_ALLOCN_STATUS'        TO F956-NUM-TYPE                    
           MOVE '~'                         TO BM06F956-REC(26:1)               
                            BM06F956-REC(30:1) BM06F956-REC(81:1)               
           WRITE BM06F956-REC.                                                  
           ADD 1 TO WS-F956-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BM06F956-REC                     
           MOVE 'R'                         TO F956-NUM-CODE                    
           MOVE 'REJECT'                    TO F956-NUM-DESC                    
           MOVE 'BM06_ALLOCN_STATUS'        TO F956-NUM-TYPE                    
           MOVE '~'                         TO BM06F956-REC(26:1)               
                            BM06F956-REC(30:1) BM06F956-REC(81:1)               
           WRITE BM06F956-REC.                                                  
           ADD 1 TO WS-F956-WRITE.                                              
                                                                                
       3700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-----------------------*                                                 
       3600-FLAT-STATUS.                                                        
      *-----------------------*                                                 
                                                                                
           MOVE SPACES                      TO BM06F956-REC                     
           MOVE 'NW'                        TO F956-NUM-CODE                    
           MOVE 'NEW FLAT'                  TO F956-NUM-DESC                    
           MOVE 'BM06_FLAT_STATUS'          TO F956-NUM-TYPE                    
           MOVE '~'                         TO BM06F956-REC(26:1)               
                            BM06F956-REC(30:1) BM06F956-REC(81:1)               
           WRITE BM06F956-REC.                                                  
           ADD 1 TO WS-F956-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BM06F956-REC                     
           MOVE 'RP'                        TO F956-NUM-CODE                    
           MOVE 'REPURCHASED FLAT'          TO F956-NUM-DESC                    
           MOVE 'BM06_FLAT_STATUS'          TO F956-NUM-TYPE                    
           MOVE '~'                         TO BM06F956-REC(26:1)               
                            BM06F956-REC(30:1) BM06F956-REC(81:1)               
           WRITE BM06F956-REC.                                                  
           ADD 1 TO WS-F956-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BM06F956-REC                     
           MOVE 'RR'                        TO F956-NUM-CODE                    
           MOVE 'REPOSSESSED FLAT'          TO F956-NUM-DESC                    
           MOVE 'BM06_FLAT_STATUS'          TO F956-NUM-TYPE                    
           MOVE '~'                         TO BM06F956-REC(26:1)               
                            BM06F956-REC(30:1) BM06F956-REC(81:1)               
           WRITE BM06F956-REC.                                                  
           ADD 1 TO WS-F956-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BM06F956-REC                     
           MOVE 'RJ'                        TO F956-NUM-CODE                    
           MOVE 'REJECTED FLAT'             TO F956-NUM-DESC                    
           MOVE 'BM06_FLAT_STATUS'          TO F956-NUM-TYPE                    
           MOVE '~'                         TO BM06F956-REC(26:1)               
                            BM06F956-REC(30:1) BM06F956-REC(81:1)               
           WRITE BM06F956-REC.                                                  
           ADD 1 TO WS-F956-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BM06F956-REC                     
           MOVE 'ST'                        TO F956-NUM-CODE                    
           MOVE 'SITTING TENANT FLAT'       TO F956-NUM-DESC                    
           MOVE 'BM06_FLAT_STATUS'          TO F956-NUM-TYPE                    
           MOVE '~'                         TO BM06F956-REC(26:1)               
                            BM06F956-REC(30:1) BM06F956-REC(81:1)               
           WRITE BM06F956-REC.                                                  
           ADD 1 TO WS-F956-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BM06F956-REC                     
           MOVE 'SD'                        TO F956-NUM-CODE                    
           MOVE 'SITTING TENANT FLAT'       TO F956-NUM-DESC                    
           MOVE 'BM06_FLAT_STATUS'          TO F956-NUM-TYPE                    
           MOVE '~'                         TO BM06F956-REC(26:1)               
                            BM06F956-REC(30:1) BM06F956-REC(81:1)               
           WRITE BM06F956-REC.                                                  
           ADD 1 TO WS-F956-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BM06F956-REC                     
           MOVE 'CV'                        TO F956-NUM-CODE                    
           MOVE 'CONVERTED FLAT'            TO F956-NUM-DESC                    
           MOVE 'BM06_FLAT_STATUS'          TO F956-NUM-TYPE                    
           MOVE '~'                         TO BM06F956-REC(26:1)               
                            BM06F956-REC(30:1) BM06F956-REC(81:1)               
           WRITE BM06F956-REC.                                                  
           ADD 1 TO WS-F956-WRITE.                                              
                                                                                
       3600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-----------------------*                                                 
       2500-EMPLOYMENT-STATUS.                                                  
      *-----------------------*                                                 
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE '1'                         TO FW3P-NUM-CODE                    
           MOVE 'UNEMPLOYED'                TO FW3P-NUM-DESC                    
           MOVE 'BP13_EMPLOYMENT_STATUS'    TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE '2'                         TO FW3P-NUM-CODE                    
           MOVE 'RETIRED WITH PENSION'      TO FW3P-NUM-DESC                    
           MOVE 'BP13_EMPLOYMENT_STATUS'    TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE '3'                         TO FW3P-NUM-CODE                    
           MOVE 'EMPLOYED WITH MONTHLY CPF CONTRIBUTIONS'                       
                                            TO FW3P-NUM-DESC                    
           MOVE 'BP13_EMPLOYMENT_STATUS'    TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE '4'                         TO FW3P-NUM-CODE                    
           MOVE 'EMPLOYED WITHOUT MONTHLY CPF CONTRIBUTIONS'                    
                                            TO FW3P-NUM-DESC                    
           MOVE 'BP13_EMPLOYMENT_STATUS'    TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE '5'                         TO FW3P-NUM-CODE                    
           MOVE 'SELF-EMPLOYED'             TO FW3P-NUM-DESC                    
           MOVE 'BP13_EMPLOYMENT_STATUS'    TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE '7'                         TO FW3P-NUM-CODE                    
           MOVE 'EMPLOYED(COMMISSION / INCENTIVE-BASED)'                        
                                            TO FW3P-NUM-DESC                    
           MOVE 'BP13_EMPLOYMENT_STATUS'    TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE '9'                         TO FW3P-NUM-CODE                    
           MOVE 'ODD JOB WORKER / PART-TIME WORKER' TO FW3P-NUM-DESC            
           MOVE 'BP13_EMPLOYMENT_STATUS'    TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'A'                         TO FW3P-NUM-CODE                    
           MOVE 'UNEMPLOYED (FULL-TIME STUDENT)' TO FW3P-NUM-DESC               
           MOVE 'BP13_EMPLOYMENT_STATUS'    TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'B'                         TO FW3P-NUM-CODE                    
           MOVE 'UNEMPLOYED (FULL-TIME NATIONAL SERVICEMAN)'                    
                                            TO FW3P-NUM-DESC                    
           MOVE 'BP13_EMPLOYMENT_STATUS'    TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
       2500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-----------------------*                                                 
       2600-HOLDING-TYPE.                                                       
      *-----------------------*                                                 
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'TC'                        TO FW3P-NUM-CODE                    
           MOVE 'TENANT IN COMMON'          TO FW3P-NUM-DESC                    
           MOVE 'BP13_HOLDING_TYPE'         TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'JT'                        TO FW3P-NUM-CODE                    
           MOVE 'JOINT TENANCY'             TO FW3P-NUM-DESC                    
           MOVE 'BP13_HOLDING_TYPE'         TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'SO'                        TO FW3P-NUM-CODE                    
           MOVE 'SINGLE OCCUPIER'           TO FW3P-NUM-DESC                    
           MOVE 'BP13_HOLDING_TYPE'         TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
       2600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       2800-CZNSHP_HSHLD.                                                       
      *--------------------*                                                    
                                                                                
           MOVE SPACES                         TO BP13FW3P-REC                  
           MOVE 'SCH'                          TO FW3P-NUM-CODE                 
           MOVE 'SINGAPOREAN HOUSEHOLD'        TO FW3P-NUM-DESC                 
           MOVE 'BP13_CZNSHP_HSHLD'            TO FW3P-NUM-TYPE                 
           MOVE '~'                            TO BP13FW3P-REC(26:1)            
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                         TO BP13FW3P-REC                  
           MOVE 'SCP'                          TO FW3P-NUM-CODE                 
           MOVE 'SINGAPORE PERMANENT RESIDENT' TO FW3P-NUM-DESC                 
           MOVE 'BP13_CZNSHP_HSHLD'            TO FW3P-NUM-TYPE                 
           MOVE '~'                            TO BP13FW3P-REC(26:1)            
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
       2800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------*                                                    
       2900-HSHLD_TYPE.                                                         
      *--------------------*                                                    
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'H'                         TO FW3P-NUM-CODE                    
           MOVE 'FIRST TIMER HOUSEHOLD'     TO FW3P-NUM-DESC                    
           MOVE 'BP13_HSHLD_TYPE'           TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
           MOVE SPACES                      TO BP13FW3P-REC                     
           MOVE 'G'                         TO FW3P-NUM-CODE                    
           MOVE 'SECOND TIMER HOUSEHOLD'    TO FW3P-NUM-DESC                    
           MOVE 'BP13_HSHLD_TYPE'           TO FW3P-NUM-TYPE                    
           MOVE '~'                         TO BP13FW3P-REC(26:1)               
                            BP13FW3P-REC(30:1) BP13FW3P-REC(81:1)               
           WRITE BP13FW3P-REC.                                                  
           ADD 1 TO WS-FW3P-WRITE.                                              
                                                                                
       2900-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-----------------*                                                       
       9000-CLOSE-FILES.                                                        
      *-----------------*                                                       
                                                                                
           MOVE WS-FW3P-WRITE          TO WS-NUM-TOTAL-RECS.                    
           WRITE BP13FW3P-REC FROM WS-CONTROL-REC.                              
                                                                                
           MOVE WS-F956-WRITE          TO WS-NUM-TOTAL-RECS.                    
           WRITE BM06F956-REC FROM WS-CONTROL-REC.                              
                                                                                
           CLOSE BP13FW3P                                                       
                 BM06F956.                                                      
                                                                                
           CLOSE BP13K060                                                       
           IF BP13K060-OK                                                       
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'ERROR CLOSING FILE : BP13K060!'                          
              DISPLAY 'FILE-STATUS :' BP13K060-STATUS                           
           END-IF                                                               
                                                                                
           PERFORM 9100-DISPLAY-STATISTICS  THRU 9100-EXIT                      
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-----------------*                                                       
       9900-ABNORMAL-END.                                                       
      *-----------------*                                                       
           DISPLAY ' THE PROGRAM TERMINATES NOW!!!'                             
           PERFORM 9100-DISPLAY-STATISTICS  THRU 9100-EXIT                      
           STOP RUN                                                             
           .                                                                    
      *----------*                                                              
       9900-EXIT.                                                               
      *----------*                                                              
           EXIT.                                                                
                                                                                
      *-----------------------*                                                 
       9100-DISPLAY-STATISTICS.                                                 
      *-----------------------*                                                 
           DISPLAY '*================================================*'         
           DISPLAY '*== PROGRAM STATISTICS - BP13C94U    ============*'         
           DISPLAY '*================================================*'         
           DISPLAY '*NUMBER OF FW3P RECS WRITE    :' WS-FW3P-WRITE              
           DISPLAY '*NUMBER OF F956 RECS WRITE    :' WS-F956-WRITE              
                                                                                
           DISPLAY '*================================================*'         
           .                                                                    
       9100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********  E N D   O F   P R O G R A M   B P 1 3 C 9 4 U *********        
