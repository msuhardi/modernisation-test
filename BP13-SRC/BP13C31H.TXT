      *-----------------------*                                         00010000
       IDENTIFICATION DIVISION.                                         00020000
      *-----------------------*                                         00030000
       PROGRAM-ID.    BP13C31H.                                         00040000
      *AUTHOR.        JGO1.                                             00050000
      *DATE-WRITTEN.  15/01/14.                                         00060000
                                                                        00070000
      * =========================================================== *   00080000
      *                SYSTEM OF COMMITMENT (BP13)                  *   00090000
      * =========================================================== *   00100000
      *    OBJECTIVE :                                              *   00110000
      *      1.  THIS IS A PROGRAM TO PRINT A LIST OF PAYMENT       *   00120000
      *          FOR STAMPING OF SUA/TOL                            *   00130000
      *          (FINAL PINK VOUCHER)                               *   00140000
      *                                                             *   00150000
      *    INPUT FILES :                                            *   00160000
      *      1.  BP13F315 - TRANSACTION FILE                        *   00170000
      *      2.  BP13K800 - SOC MASTER APPLN FILE                   *   00180000
      *      3.  BP13K330 - SOC AGREEMENT ORDER FILE                *   00190000
      *                                                             *   00200000
      *    OUTPUT FILE :                                            *   00210000
      *      1.  BP13K625 - STAMP FEE MASTER FILE                   *   00220000
      *      2.  AG07F225 - VOUCHER FILE FOR STAMPFEE               *   00230000
      *                                                             *   00240000
      *    LISTING     :   1.  BP13L31H - CONTROL LISTING           *   00250000
      *                                                             *   00260000
      * ----------------------------------------------------------- *   00270000
      * CHG REF  BY   DATE   DESCRIPTION                            *   00280000
      * -------- ---- ------ -----------                            *   00290000
      * BP135017 JGO1 140115 NEW PROGRAM FOR SUA/TOL STAMPING       *   00300000
      * BP135193 JGO1 140319 ADD READING K462 FOR TOL CASES         *   00310000
      * BP135017 JGO1 280414 PASS F315-USERID TO F225 STAFF-ID-PREP *   00320000
      * BP135247 JGO1 300414 PASS F315-USERID IF ID NOT = BP13P001  *   00330000
      * BP135602 JGO1 260115 READ K893 IF NOT FOUND IN K800         *   00340000
      * BP135832 JGO1 190515 UPDATE VALUE PASSED TO F225 BANK       *   00350000
      * BP137140 PCL4 191217 TO REDEFINE AG07 FILE ERROR CODE       *   00360000
      * BP137782 DN8  240419 TO BYPASS CHECK FOR 3588708C IN K330   *   00370000
      * BP138339 KR13 070820 REMOVED P13L31HA - IOM8 CONVERSION.    *   00380000
      * BP138399 KV5  170920 TO BYPASS CHECK FOR 2924243G IN K330   *   00390000
      * BP138580 ZDD  270421 TO BYPASS CHECK FOR 3741034I IN K330   *   00400000
      *                      TO BYPASS CHECK FOR 3514793D IN K330   *   00410000
      * BP138849 ZDD  150921 TO BYPASS CHECK FOR 3492561E IN K330   *   00420000
      * BP139164 KV8  040522 INCLUDED ADDRESS AND COMMENTED STREET  *   00421001
      * =========================================================== *   00430000
                                                                        00440000
      ************************                                          00450000
       ENVIRONMENT DIVISION.                                            00460000
      ************************                                          00470000
       CONFIGURATION SECTION.                                           00480000
       SOURCE-COMPUTER. IBM-3090.                                       00490000
       OBJECT-COMPUTER. IBM-3090.                                       00500000
                                                                        00510000
       INPUT-OUTPUT SECTION.                                            00520000
       FILE-CONTROL.                                                    00530000
                                                                        00540000
           SELECT BP13F315  ASSIGN       TO BP13F315.                   00550000
           SELECT BP13K800  ASSIGN       TO BP13K800                    00560000
                            ACCESS MODE  IS RANDOM                      00570000
                            ORGANIZATION IS INDEXED                     00580000
                            RECORD KEY   IS K800-NUM-REGN               00590000
                            FILE STATUS  IS BP13K800-STATUS.            00600000
                                                                        00610000
           SELECT BP13K893  ASSIGN       TO BP13K893                    00620000
                            ACCESS MODE  IS DYNAMIC                     00630000
                            ORGANIZATION IS INDEXED                     00640000
                            RECORD KEY   IS K893-KEY-FLD                00650000
                            FILE STATUS  IS BP13K893-STATUS.            00660000
                                                                        00670000
           SELECT BP13K330  ASSIGN       TO BP13K330                    00680000
                            ACCESS MODE  IS RANDOM                      00690000
                            ORGANIZATION IS INDEXED                     00700000
                            RECORD KEY   IS K330-KEY-FLD                00710000
                            FILE STATUS  IS BP13K330-STATUS.            00720000
                                                                        00730000
           SELECT BP13K625  ASSIGN       TO BP13K625                    00740000
                            ACCESS MODE  IS DYNAMIC                     00750000
                            ORGANIZATION IS INDEXED                     00760000
                            RECORD KEY   IS K625-KEY-FLD                00770000
                            FILE STATUS  IS BP13K625-STATUS.            00780000
                                                                        00790000
           SELECT BP13K462  ASSIGN       TO BP13K462                    00800000
                            ACCESS MODE  IS DYNAMIC                     00810000
                            ORGANIZATION IS INDEXED                     00820000
                            RECORD KEY   IS K462-KEY-FLD                00830000
                            ALTERNATE KEY IS K462-NUM-REGN              00840000
                            FILE STATUS  IS BP13K462-STATUS.            00850000
                                                                        00860000
           SELECT AG07F225  ASSIGN       TO AG07F225.                   00870000
           SELECT BP13L31H  ASSIGN       TO BP13L31H.                   00880000
           SELECT P13L31HB  ASSIGN       TO P13L31HB.                   00890000
                                                                        00900000
      *****************                                                 00910000
       DATA DIVISION.                                                   00920000
      *****************                                                 00930000
       FILE SECTION.                                                    00940000
      *-------------*                                                   00950000
                                                                        00960000
       FD   BP13F315                                                    00970000
            RECORD CONTAINS 500 CHARACTERS                              00980000
            RECORDING MODE  IS  F.                                      00990000
       COPY BP13F315.                                                   01000000
                                                                        01010000
       FD   BP13K800                                                    01020000
            RECORD CONTAINS 2000 CHARACTERS.                            01030000
       COPY BP13K800.                                                   01040000
                                                                        01050000
       FD   BP13K893                                                    01060000
            RECORD CONTAINS 2050 CHARACTERS.                            01070000
       COPY BP13K893.                                                   01080000
                                                                        01090000
       FD   BP13K330                                                    01100000
            RECORD CONTAINS 2000 CHARACTERS.                            01110000
       COPY BP13K330.                                                   01120000
                                                                        01130000
       FD   BP13K462                                                    01140000
            RECORD CONTAINS 1000 CHARACTERS.                            01150000
       COPY BP13K462.                                                   01160000
                                                                        01170000
       FD   BP13L31H                                                    01180000
            RECORD CONTAINS 132 CHARACTERS                              01190000
            RECORDING MODE  IS  F.                                      01200000
       01   L31H-PRINT-REC                    PIC X(132).               01210000
                                                                        01220000
       FD   P13L31HB                                                    01230000
            RECORD CONTAINS 132 CHARACTERS                              01240000
            RECORDING MODE  IS  F.                                      01250000
       01   L31HB-PRINT-REC                   PIC X(132).               01260000
                                                                        01270000
       FD   BP13K625                                                    01280000
            RECORD CONTAINS 500 CHARACTERS.                             01290000
       COPY BP13K625.                                                   01300000
                                                                        01310000
       FD   AG07F225                                                    01320000
            RECORDING MODE  IS  F                                       01330000
            RECORD CONTAINS 600 CHARACTERS.                             01340000
       COPY AG07F225.                                                   01350000
                                                                        01360000
      *=======================*                                         01370000
       WORKING-STORAGE SECTION.                                         01380000
      *=======================*                                         01390000
       01  WS1-FILE-ACCESS-STATUS.                                      01400000
           05  BP13K800-STATUS         PIC 9(2)      VALUE ZEROS.       01410000
           05  BP13K893-STATUS         PIC 9(2)      VALUE ZEROS.       01420000
           05  BP13K330-STATUS         PIC 9(2)      VALUE ZEROS.       01430000
           05  BP13K625-STATUS         PIC 9(2)      VALUE ZEROS.       01440000
           05  BP13K462-STATUS         PIC 9(2)      VALUE ZEROS.       01450000
           05  WS-AG07-STATUS          PIC 9(2)      VALUE ZEROS.       01460000
           05  WS-AG07-STAT-X REDEFINES WS-AG07-STATUS PIC X(2).        01470000
       01  WS-COUNTERS.                                                 01480000
           05  WS-CNT-F315-READ        PIC 9(3)      VALUE ZEROS.       01490000
           05  WS-CNT-K800-READ        PIC 9(3)      VALUE ZEROS.       01500000
           05  WS-CNT-K893-READ        PIC 9(3)      VALUE ZEROS.       01510000
           05  WS-BP13K893-FND         PIC X(01)     VALUE SPACES.      01520000
           05  WS-BP13K893-EOF         PIC X(01)     VALUE SPACES.      01530000
           05  WS-CNT-K330-READ        PIC 9(3)      VALUE ZEROS.       01540000
           05  WS-CNT-K625-WRITE       PIC 9(3)      VALUE ZEROS.       01550000
           05  WS-CNT-F225-WRITE       PIC 9(3)      VALUE ZEROS.       01560000
           05  WS-CNT-L31H-WRITE       PIC 9(3)      VALUE ZEROS.       01570000
           05  WS-CNT-L31H-DETLS       PIC 9(4)      VALUE ZEROS.       01580000
                                                                        01590000
           05  WS-L31HB-PRINT-CNT      PIC 9(4)      VALUE ZEROS.       01600000
           05  WS-L31HB-PAGE-CNT       PIC 9(5)      VALUE ZEROS.       01610000
           05  WS-L31HB-REC-ON-PAGE-CNT  PIC 9(2)    VALUE 66.          01620000
                                                                        01630000
       01  WS-ACCUM-VARIABLES.                                          01640000
           05  WS-NO-OF-PAGE           PIC 9(5)      VALUE ZEROS.       01650000
           05  WS-TOTAL-ACTUAL-LEASE   PIC S9(6)V99  VALUE ZEROS.       01660000
           05  WS-TOTAL-DUP-LEASE      PIC S9(3)V99  VALUE ZEROS.       01670000
           05  WS-TOTAL-LEASE          PIC S9(7)V99  VALUE ZEROS.       01680000
           05  WS-COMP-TOT-LEASE       PIC S9(7)V99  VALUE ZEROS.       01690000
                                                                        01700000
       01  WS-SWITCHES.                                                 01710000
           05  WS-F315-EOF-IND         PIC X(1)      VALUE 'N'.         01720000
               88 WS-F315-EOF                        VALUE 'Y'.         01730000
           05  WS-NEW-VOUCHER-NO       PIC X(1)      VALUE 'Y'.         01740000
           05  WS-NEW-VOUCHER-F225     PIC X(1)      VALUE 'Y'.         01750000
           05  WS-NEW-BATCH-NO         PIC X(1)      VALUE 'Y'.         01760000
           05  WS-NEW-HEADER           PIC X(1)      VALUE 'Y'.         01770000
           05  WS-K625-EOF             PIC X(1)      VALUE 'N'.         01780000
                                                                        01790000
       01  WS-DATES-VARIABLES.                                          01800000
           05  WS-AO-DATE.                                              01810000
               10  WS-AO-YEAR          PIC 9(4)      VALUE 0.           01820000
               10  WS-AO-MM            PIC 99        VALUE 0.           01830000
               10  WS-AO-DD            PIC 99        VALUE 0.           01840000
           05  WS-DATE.                                                 01850000
               10 WS-DD                PIC 99        VALUE 00.          01860000
               10 FILLER               PIC X         VALUE '/'.         01870000
               10 WS-MM                PIC 99        VALUE 00.          01880000
               10 FILLER               PIC X         VALUE '/'.         01890000
               10 WS-YEAR              PIC 9(4)      VALUE 00.          01900000
           05  WS-PR-CUR-DATE.                                          01910000
               10 WS-PC-DD             PIC 99        VALUE 00.          01920000
               10 FILLER               PIC X         VALUE '/'.         01930000
               10 WS-PC-MM             PIC 99        VALUE 00.          01940000
               10 FILLER               PIC X         VALUE '/'.         01950000
               10 WS-PC-CCYY           PIC 9999      VALUE ZERO.        01960000
           05  WS-CURRENT-CCYYMMDD.                                     01970000
                   15 WS-CUR-CCYY      PIC 9999      VALUE ZERO.        01980000
                   15 WS-CUR-MM        PIC 99        VALUE 00.          01990000
                   15 WS-CUR-DD        PIC 99        VALUE 00.          02000000
                                                                        02010000
       01  WS-DEFAULT-VALUES.                                           02020000
           05  WS-DEF-DUP-LEASE        PIC 9(2)V99   VALUE  0.          02030000
           05  WS-DUP-LEASE            PIC 9(2)V99   VALUE  0.          02040000
           05  WS-MAX-LINES            PIC 9(2)      VALUE  2.          02050000
                                                                        02060000
       01  WS-SCH-ACC.                                                  02070000
           05  WS-SCH-1-4              PIC X(4)      VALUE SPACES.      02080000
           05  WS-SCH-5-8              PIC X(4)      VALUE SPACES.      02090000
           05  WS-SCH-9-9              PIC X(1)      VALUE SPACE.       02100000
           05  WS-SCH-10-11            PIC X(2)      VALUE SPACES.      02110000
                                                                        02120000
                                                                        02130000
       01  WS-NUM-VOUCHER              PIC X(11)     VALUE SPACES.      02140000
       01  WS-NUM-VOUCHER-F225         PIC X(11)     VALUE SPACES.      02150000
       01  WS-NUM-GL-ACCT              PIC X(13)     VALUE SPACES.      02160000
       01  WS-ANNUAL-RENT              PIC 9(7)V99   VALUE ZEROES.      02170000
       01  WS-NUM-BATCH-TYPE           PIC X(4)      VALUE SPACES.      02180000
       01  WS-NUM-FIN-YEAR             PIC 9(4)      VALUE ZEROES.      02190000
       01  WS-NUM-BATCH-SERIAL         PIC 9(5)      VALUE ZEROES.      02200000
       01  WS-SEQ-NO-F225              PIC 9(2)      VALUE ZEROES.      02210000
       01  WS-NUM-HDB-REF              PIC X(11)     VALUE SPACES.      02220000
       01  WS-NUM-DOC                  PIC X(3)      VALUE SPACES.      02230000
       01  WS-NUM-DOC-TYP              PIC X(1)      VALUE SPACES.      02240000
       01  WS-NUM-DOC-CNT              PIC 9(1)      VALUE ZEROES.      02250000
       01  WS-NET-AMT-F225             PIC 9(7)V99   VALUE ZEROS.       02260000
                                                                        02270000
       01  WS-AMT-EARMARK              PIC 9(10)V99  VALUE ZEROES.      02280000
       01  WS-OTHER-VARIABLES.                                          02290000
           05  WS-NUM-UNIT.                                             02300000
               10  WS-HSE-MAIN            PIC X(4)   VALUE SPACES.      02310000
               10  WS-HSE-SUB             PIC X(3)   VALUE SPACES.      02320000
           05  WS-NUM-BLK-HSE.                                          02330000
               10  WS-BLK-HSE-DESC        PIC X(4)   VALUE 'BLK '.      02340000
               10  WS-BLK-HSE-NO          PIC X(6)   VALUE SPACES.      02350000
           05  WS-STAFF-START             PIC X(9)   VALUE '29586H   '. 02360000
                                                                        02370000
      *----------------------------------------------------------*      02380000
      *    WS LINKAGE VARIABLES PASSED TO "AG07C907"             *      02390000
      *----------------------------------------------------------*      02400000
       COPY AG7C907C.                                                   02410000
      *----------------------------------------------------------*      02420000
      *    WS LINKAGE VARIABLES PASSED TO "BP13C906"             *      02430000
      *----------------------------------------------------------*      02440000
       COPY P13C906C.                                                   02450000
      *----------------------------------------------------------*      02460000
      *    WS LINKAGE VARIABLES PASSED TO "AB05C902"             *      02470000
      *----------------------------------------------------------*      02480000
       COPY AB05902C.                                                   02490000
                                                                        02500000
      *----------------------------------------------------------*      02510000
      *        WS FOR LIST OF PAYMENT  FOR STAMPING              *      02520000
      *----------------------------------------------------------*      02530000
       01  L31H-PR-HDG-01.                                              02540000
           05  FILLER              PIC X(8)    VALUE 'BP13L31H'.        02550000
           05  FILLER              PIC X(10)   VALUE '      HDB3'.      02560000
           05  FILLER              PIC X(28)   VALUE SPACES.            02570000
           05  FILLER              PIC X(39)   VALUE                    02580000
               'S Y S T E M   O F   C O M M I T M E N T'.               02590000
           05  FILLER              PIC X(12)   VALUE SPACES.            02600000
           05  FILLER              PIC X(7)    VALUE 'DATE : '.         02610000
           05  L31H-CURRENT-DATE   PIC X(10)   VALUE SPACES.            02620000
           05  FILLER              PIC X(6)    VALUE SPACES.            02630000
           05  FILLER              PIC X(7)    VALUE 'PAGE : '.         02640000
           05  L31H-PAGE           PIC ZZZZ9.                           02650000
                                                                        02660000
       01  L31H-PR-HDG-02.                                              02670000
           05  FILLER              PIC X(30)   VALUE                    02680000
               'HOUSING AND DEVELOPMENT BOARD'.                         02690000
           05  FILLER              PIC X(21)   VALUE SPACES.            02700000
           05  FILLER              PIC X(30)   VALUE                    02710000
               'P A Y M E N T    V O U C H E R'.                        02720000
           05  FILLER              PIC X(25)   VALUE SPACES.            02730000
           05  L31H-COPY-NAME      PIC X(20)   VALUE SPACES.            02740000
                                                                        02750000
       01  L31H-PR-HDG-03.                                              02760000
           05  FILLER              PIC X(46)   VALUE SPACES.            02770000
           05  FILLER              PIC X(85)   VALUE ALL '-'.           02780000
                                                                        02790000
       01  L31H-PR-HDG-04.                                              02800000
           05  FILLER              PIC X(46)   VALUE                    02810000
               'SALES UNIT (AGREEMENT TEAM)'.                           02820000
           05  FILLER              PIC X(1)    VALUE '¦'.               02830000
           05  FILLER              PIC X(27)   VALUE                    02840000
               ' FOR FINANCE DEPARTMENT USE'.                           02850000
           05  FILLER              PIC X(21)   VALUE SPACES.            02860000
           05  FILLER              PIC X(17)   VALUE                    02870000
               '¦  BATCH NO    : '.                                     02880000
           05  L31H-BATCH-NO       PIC X(14)   VALUE SPACES.            02890000
           05  FILLER              PIC X(4)    VALUE SPACES.            02900000
           05  FILLER              PIC X(1)    VALUE '¦'.               02910000
                                                                        02920000
       01  L31H-PR-HDG-05.                                              02930000
           05  FILLER              PIC X(46)   VALUE SPACES.            02940000
           05  FILLER              PIC X(1)    VALUE '¦'.               02950000
           05  FILLER              PIC X(48)   VALUE SPACES.            02960000
           05  FILLER              PIC X(1)    VALUE '¦'.               02970000
           05  FILLER              PIC X(34)   VALUE SPACES.            02980000
           05  FILLER              PIC X(1)    VALUE '¦'.               02990000
                                                                        03000000
       01  L31H-PR-HDG-06.                                              03010000
           05  FILLER              PIC X(46)   VALUE 'SYSTEM CODE : 04'.03020000
           05  FILLER              PIC X(14)   VALUE '¦ CHECKED BY :'.  03030000
           05  FILLER              PIC X(35)   VALUE SPACES.            03040000
           05  FILLER              PIC X(17)   VALUE '¦  VOUCHER NO  :'.03050000
           05  L31H-VOUCHER-NO     PIC X(11)   VALUE SPACES.            03060000
           05  FILLER              PIC X(7)    VALUE SPACES.            03070000
           05  FILLER              PIC X(1)    VALUE '¦'.               03080000
                                                                        03090000
       01  L31H-PR-HDG-07.                                              03100000
           05  FILLER              PIC X(46)   VALUE                    03110000
              'GL CODE     : 0000000104250'.                            03120000
           05  FILLER              PIC X(85)   VALUE ALL '-'.           03130000
                                                                        03140000
       01  L31H-PR-HDG-08.                                              03150000
           05  FILLER              PIC X(46)   VALUE                    03160000
              'DESCRIPTION : STAMP FEES'.                               03170000
                                                                        03180000
       01  L31H-PR-HDG-09.                                              03190000
           05  FILLER              PIC X(53)   VALUE                    03200000
              'PAYABLE TO  : COMMISSIONER OF STAMP DUTIES         '.    03210000
           05  FILLER              PIC X(13)   VALUE  SPACES.           03220000
           05  FILLER              PIC X(20)   VALUE                    03230000
              'BANK   : DBS        '.                                   03240000
           05  FILLER              PIC X(11)   VALUE  SPACES.           03250000
           05  FILLER              PIC X(25)   VALUE                    03260000
              'BANK CODE   : DBSSSGSGXXX'.                              03270000
                                                                        03280000
       01  L31H-PR-HDG-09A.                                             03290000
           05  FILLER              PIC X(24)   VALUE                    03300000
              'A/C NO      : 0010468600'.                               03310000
           05  FILLER              PIC X(42)   VALUE  SPACES.           03320000
                                                                        03330000
       01  L31H-PR-HDG-10.                                              03340000
           05  FILLER              PIC X(11)   VALUE                    03350000
               'REMITTANCE '.                                           03360000
           05  FILLER              PIC X(55)   VALUE                    03370000
              'ADVICE  DESPATCH TO :  C/O SC(STAMPING) OF SALES UNIT'.  03380000
                                                                        03390000
       01  L31H-PR-HDG-11.                                              03400000
           05  FILLER              PIC X(3)    VALUE 'NO.'.             03410000
           05  FILLER              PIC X(4)    VALUE SPACES.            03420000
           05  FILLER              PIC X(11)   VALUE                    03430000
               'SCH-ACCT-NO'.                                           03440000
           05  FILLER              PIC X(5)    VALUE SPACES.            03450000
           05  FILLER              PIC X(7)    VALUE 'REGN NO'.         03460000
           05  FILLER              PIC X(3)    VALUE SPACES.            03470000
           05  FILLER              PIC X(3)    VALUE 'BLK'.             03480000
           05  FILLER              PIC X(4)    VALUE SPACES.            03490000
           05  FILLER              PIC X(24)   VALUE                    03500000
               'FLAT ADDRESS/STREET NAME'.                              03510000
           05  FILLER              PIC X(3)    VALUE SPACES.            03520000
           05  FILLER              PIC X(7)    VALUE 'FLAT NO'.         03530000
           05  FILLER              PIC X(5)    VALUE SPACES.            03540000
           05  FILLER              PIC X(8)    VALUE ' DATE OF'.        03550000
           05  FILLER              PIC X(7)    VALUE SPACES.            03560000
           05  FILLER              PIC X(12)   VALUE '   STAMP FEE'.    03570000
           05  FILLER              PIC X(8)    VALUE SPACES.            03580000
           05  FILLER              PIC X(3)    VALUE 'DOC'.             03590000
           05  FILLER              PIC X(10)   VALUE SPACES.            03600000
           05  FILLER              PIC X(10)   VALUE 'TOTAL'.           03610000
                                                                        03620000
       01  L31H-PR-HDG-12.                                              03630000
           05  FILLER              PIC X(79)   VALUE SPACES.            03640000
           05  FILLER              PIC X(9)    VALUE ' SUA/TOL '.       03650000
           05  FILLER              PIC X(8)    VALUE SPACES.            03660000
           05  FILLER              PIC X(9)    VALUE '         '.       03670000
           05  FILLER              PIC X(8)    VALUE SPACES.            03680000
           05  FILLER              PIC X(5)    VALUE 'TYPE '.           03690000
                                                                        03700000
       01  L31H-PR-DETAIL.                                              03710000
           05  L31H-NO             PIC ZZZ9.                            03720000
           05  FILLER              PIC X(2)    VALUE SPACES.            03730000
           05  L31H-SCH-ACC.                                            03740000
               10 L31H-SCH-1-4     PIC X(4)    VALUE SPACES.            03750000
               10 FILLER           PIC X(1)    VALUE '-'.               03760000
               10 L31H-SCH-5-8     PIC X(4)    VALUE SPACES.            03770000
               10 FILLER           PIC X(1)    VALUE '-'.               03780000
               10 L31H-SCH-9-9     PIC X(1)    VALUE SPACE.             03790000
               10 FILLER           PIC X(1)    VALUE '-'.               03800000
               10 L31H-SCH-10-11   PIC X(2)    VALUE SPACES.            03810000
           05  FILLER              PIC X(2)    VALUE SPACES.            03820000
           05  L31H-REGN-NO        PIC X(8)    VALUE SPACES.            03830000
           05  FILLER              PIC X(2)    VALUE SPACES.            03840000
           05  L31H-BLK-NO         PIC X(5)    VALUE SPACES.            03850000
           05  FILLER              PIC X(3)    VALUE SPACES.            03860000
           05  L31H-STREET         PIC X(23)   VALUE SPACES.            03870000
           05  FILLER              PIC X(4)    VALUE SPACES.            03880000
           05  L31H-FLAT-NO.                                            03890000
               10  FILLER          PIC X(1)    VALUE '#'.               03900000
               10  L31H-LEVEL-NO   PIC X(2)    VALUE SPACES.            03910000
               10  FILLER          PIC X(1)    VALUE '-'.               03920000
               10  L31H-UNIT-NO    PIC X(4)    VALUE SPACES.            03930000
           05  FILLER              PIC X(4)    VALUE SPACES.            03940000
           05  L31H-AGR-ORDER-DATE PIC X(12)   VALUE SPACES.            03950000
           05  FILLER              PIC X(4)    VALUE SPACES.            03960000
           05  L31H-LEASE          PIC -$$$,$$9.99.                     03970000
           05  FILLER              PIC X(7)    VALUE SPACES.            03980000
           05  L31H-DOC-TYPE       PIC X(3)    VALUE SPACES.            03990000
           05  FILLER              PIC X(4)    VALUE SPACES.            04000000
           05  L31H-DETL-TOTAL     PIC -$$$$,$$9.99.                    04010000
                                                                        04020000
       01  L31H-PR-TOTAL-LINE.                                          04030000
           05  FILLER              PIC X(39)   VALUE SPACES.            04040000
           05  FILLER              PIC X(13)   VALUE '(SERIAL NO : '.   04050000
           05  L31H-VR-NO-LOW      PIC X(4)    VALUE '0001'.            04060000
           05  FILLER              PIC X(4)    VALUE ' TO '.            04070000
           05  L31H-VR-NO-HIGH     PIC X(4)    VALUE '0010'.            04080000
           05  FILLER              PIC X(1)    VALUE ')'.               04090000
           05  FILLER              PIC X(13)   VALUE SPACES.            04100000
           05  FILLER              PIC X(16)   VALUE 'TOTAL : '.        04110000
           05  L31H-TOTAL-ACTUAL   PIC -$$$$,$$9.99.                    04120000
           05  FILLER              PIC X(11)   VALUE SPACES.            04130000
           05  L31H-TOTAL-LEASE    PIC -$$,$$$,$$9.99.                  04140000
                                                                        04150000
       01  L31H-PR-DASH-LINE.                                           04160000
           05  FILLER              PIC X(94)   VALUE SPACES.            04170000
           05  FILLER              PIC X(38)   VALUE ALL '-'.           04180000
                                                                        04190000
       01  L31H-PR-FTG-01.                                              04200000
           05  FILLER              PIC X(15)   VALUE 'NET PAYABLE  : '. 04210000
           05  L31H-AMT-WORDS.                                          04220000
               10  L31H-AMT-DESC1  PIC X(60)   VALUE SPACES.            04230000
               10  L31H-AMT-DESC2  PIC X(60)   VALUE SPACES.            04240000
                                                                        04250000
       01  L31H-PR-FTG-02.                                              04260000
           05  FILLER              PIC X(39)   VALUE SPACES.            04270000
           05  FILLER              PIC X(14)   VALUE 'CHECKED BY : '.   04280000
           05  FILLER              PIC X(21)   VALUE ALL '_'.           04290000
           05  FILLER              PIC X(4)    VALUE SPACES.            04300000
           05  FILLER              PIC X(16)   VALUE 'CERTIFIED BY : '. 04310000
           05  FILLER              PIC X(21)   VALUE ALL '_'.           04320000
                                                                        04330000
      *-----------------------------------------------------------*     04340000
      *    DEFINE P13L31HB REPORT LINES                           *     04350000
      *-----------------------------------------------------------*     04360000
       01  L31HB-HEADER1.                                               04370000
           05  FILLER              PIC X(8)    VALUE 'P13L31HB'.        04380000
           05  FILLER              PIC X(10)   VALUE '      HDB3'.      04390000
           05  FILLER              PIC X(28)   VALUE SPACES.            04400000
           05  FILLER              PIC X(39)   VALUE                    04410000
               'S Y S T E M   O F   C O M M I T M E N T'.               04420000
           05  FILLER              PIC X(12)   VALUE SPACES.            04430000
           05  FILLER              PIC X(7)    VALUE 'DATE : '.         04440000
           05  L31HB-DATE          PIC X(10)   VALUE SPACES.            04450000
           05  FILLER              PIC X(6)    VALUE SPACES.            04460000
           05  FILLER              PIC X(7)    VALUE 'PAGE : '.         04470000
           05  L31HB-PAGE          PIC ZZZZ9.                           04480000
                                                                        04490000
       01  L31HB-HEADER2.                                               04500000
           05  FILLER                    PIC X(47) VALUE SPACES.        04510000
           05  FILLER                    PIC X(35)  VALUE               04520000
               'REPORT ON CASES WITH EARMARK ERROR'.                    04530000
                                                                        04540000
       01  L31HB-HEADER3.                                               04550000
           05  FILLER               PIC X(4)  VALUE 'S/NO'.             04560000
           05  FILLER               PIC X(3)  VALUE SPACE.              04570000
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.       04580000
           05  FILLER               PIC X(9)  VALUE SPACES.             04590000
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.          04600000
           05  FILLER               PIC X(5)  VALUE SPACE.              04610000
           05  FILLER               PIC X(13) VALUE 'JR VOUCHER NO'.    04620000
           05  FILLER               PIC X(5)  VALUE SPACES.             04630000
           05  FILLER               PIC X(12) VALUE 'TOTAL AMOUNT'.     04640000
           05  FILLER               PIC X(4)  VALUE SPACES.             04650000
           05  FILLER               PIC X(17) VALUE 'ERROR DESCRIPTION'.04660000
                                                                        04670000
       01  L31HB-REC-DETAIL.                                            04680000
           05  L31HB-SERIAL-NO              PIC ZZZ9.                   04690000
           05  FILLER                       PIC X(3)  VALUE SPACE.      04700000
           05  L31HB-SCH-ACC                PIC X(14) VALUE SPACES.     04710000
           05  FILLER                       PIC X(5)  VALUE SPACE.      04720000
           05  L31HB-REGN-NO                PIC X(8)  VALUE SPACES.     04730000
           05  FILLER                       PIC X(5)  VALUE SPACE.      04740000
           05  L31HB-JR-VCHR-NO             PIC X(13) VALUE SPACES.     04750000
           05  FILLER                       PIC X(5)  VALUE SPACES.     04760000
           05  L31HB-AMT-TOTAL              PIC $$$$,$$9.99.            04770000
           05  FILLER                       PIC X(5)  VALUE SPACES.     04780000
           05  L31HB-ERROR-DESC             PIC X(30).                  04790000
                                                                        04800000
       01  L31HB-UNDERLINE                  PIC X(132) VALUE ALL '-'.   04810000
                                                                        04820000
      *----------------------------------------------------------*      04830000
      *    WS VARIABLES FOR CONVERTING AMOUNT TO WORDS           *      04840000
      *----------------------------------------------------------*      04850000
       01  WS-SUBSCRIPTS.                                               04860000
           05  WA-SUB              PIC 999   VALUE 0.                   04870000
           05  WF-SUB              PIC 999   VALUE 0.                   04880000
           05  WL-SUB              PIC 999   VALUE 0.                   04890000
           05  WS-SUB              PIC 999   VALUE 0.                   04900000
           05  WS-FIRST-SUB        PIC 999   VALUE 0.                   04910000
                                                                        04920000
       01  WA-NAMES.                                                    04930000
           05  FILLER              PIC X(10) VALUE '3ONE      '.        04940000
           05  FILLER              PIC X(10) VALUE '3TWO      '.        04950000
           05  FILLER              PIC X(10) VALUE '5THREE    '.        04960000
           05  FILLER              PIC X(10) VALUE '4FOUR     '.        04970000
           05  FILLER              PIC X(10) VALUE '4FIVE     '.        04980000
           05  FILLER              PIC X(10) VALUE '3SIX      '.        04990000
           05  FILLER              PIC X(10) VALUE '5SEVEN    '.        05000000
           05  FILLER              PIC X(10) VALUE '5EIGHT    '.        05010000
           05  FILLER              PIC X(10) VALUE '4NINE     '.        05020000
           05  FILLER              PIC X(10) VALUE '3TEN      '.        05030000
           05  FILLER              PIC X(10) VALUE '6ELEVEN   '.        05040000
           05  FILLER              PIC X(10) VALUE '6TWELVE   '.        05050000
           05  FILLER              PIC X(10) VALUE '8THIRTEEN '.        05060000
           05  FILLER              PIC X(10) VALUE '8FOURTEEN '.        05070000
           05  FILLER              PIC X(10) VALUE '7FIFTEEN  '.        05080000
           05  FILLER              PIC X(10) VALUE '7SIXTEEN  '.        05090000
           05  FILLER              PIC X(10) VALUE '9SEVENTEEN'.        05100000
           05  FILLER              PIC X(10) VALUE '8EIGHTEEN '.        05110000
           05  FILLER              PIC X(10) VALUE '8NINETEEN '.        05120000
           05  FILLER              PIC X(10) VALUE '6TWENTY   '.        05130000
           05  FILLER              PIC X(10) VALUE '6THIRTY   '.        05140000
           05  FILLER              PIC X(10) VALUE '5FORTY    '.        05150000
           05  FILLER              PIC X(10) VALUE '5FIFTY    '.        05160000
           05  FILLER              PIC X(10) VALUE '5SIXTY    '.        05170000
           05  FILLER              PIC X(10) VALUE '7SEVENTY  '.        05180000
           05  FILLER              PIC X(10) VALUE '6EIGHTY   '.        05190000
           05  FILLER              PIC X(10) VALUE '6NINETY   '.        05200000
       01  WA-NAMER REDEFINES WA-NAMES.                                 05210000
           05  WA-NAME             PIC X(10) OCCURS 27 TIMES.           05220000
                                                                        05230000
       01  WS-LITERALS.                                                 05240000
           05  L-CENT              PIC X(5)  VALUE '4CENT'.             05250000
           05  L-AND               PIC X(4)  VALUE '3AND'.              05260000
           05  L-X                 PIC X     VALUE '%'.                 05270000
           05  L-MILLION           PIC X(8)  VALUE '7MILLION'.          05280000
           05  L-THOUSAND          PIC X(9)  VALUE '8THOUSAND'.         05290000
           05  L-DOLLARS           PIC X(8)  VALUE '7DOLLARS'.          05300000
           05  L-CENTS             PIC X(6)  VALUE '6CENTS'.            05310000
           05  L-ONLY              PIC X(6)  VALUE '5ONLY '.            05320000
           05  L-HUNDRED           PIC X(8)  VALUE '7HUNDRED'.          05330000
           05  L-DOLLAR            PIC X(7)  VALUE '6DOLLAR'.           05340000
                                                                        05350000
       01  SWITCHES.                                                    05360000
           05  WS-SWITCH           PIC 9     VALUE 0.                   05370000
           05  WS-THO-SW           PIC 9     VALUE 0.                   05380000
           05  WS-CNT-SW           PIC 9     VALUE 0.                   05390000
           05  WS-LIT-SW           PIC 9     VALUE 0.                   05400000
           05  WS-TEN-SW           PIC 9     VALUE 0.                   05410000
           05  WS-AND-SW           PIC 9     VALUE 0.                   05420000
                                                                        05430000
       01  WS-PLACE-COUNTER        PIC 999   VALUE 0.                   05440000
       01  WL-AREA-SAVE            PIC X(12) VALUE SPACES.              05450000
       01  WS-RESULT               PIC 999   VALUE 0.                   05460000
       01  WL-AREA.                                                     05470000
           05  WL-ITEM1            PIC 9     VALUE 0.                   05480000
           05  FILLER              PIC X(11) VALUE SPACE.               05490000
       01  WL-ITM REDEFINES WL-AREA.                                    05500000
           05  WL-ITEM             PIC X     OCCURS 12 TIMES.           05510000
                                                                        05520000
       01  WS-CHEQUE-DETAILS.                                           05530000
           05  WS-AMT              PIC 9(7)V99 VALUE 0.                 05540000
           05  WS-DIGIT REDEFINES  WS-AMT OCCURS 9 TIMES PIC 9.         05550000
           05  WF-DETAILS.                                              05560000
               10  WF-LINE-1       PIC X(60).                           05570000
               10  WF-LINE-2       PIC X(60).                           05580000
           05  WF-ITEM REDEFINES WF-DETAILS OCCURS 120 PIC X.           05590000
           05  WP-ITEM REDEFINES WF-DETAILS OCCURS 2 PIC X(60).         05600000
                                                                        05610000
      *----------------------------------------------------------*      05620000
      *      CONTROL FEILDS FOR HDB ASSESSMENT DATA FILE         *      05630000
      *----------------------------------------------------------*      05640000
       77  WS-LEASE                   PIC 9(13)V99 VALUE ZEROES.        05650000
                                                                        05660000
                                                                        05670000
      *------------------*                                              05680000
       PROCEDURE DIVISION.                                              05690000
      *------------------*                                              05700000
                                                                        05710000
      ******************************************************************05720000
       000-MAIN-ROUTINE.                                                05730000
      ******************************************************************05740000
                                                                        05750000
           PERFORM  100-OPEN-FILES     THRU  100-EXIT.                  05760000
           PERFORM  200-READ-BP13F315  THRU  200-EXIT.                  05770000
           PERFORM  300-MAIN-ROUTINE   THRU  300-EXIT UNTIL WS-F315-EOF.05780000
           IF WS-SEQ-NO-F225 NOT = ZEROES                               05790000
              PERFORM  770-WRITE-TRAILER-F225 THRU 770-EXIT             05800000
           END-IF.                                                      05810000
           PERFORM  900-CLOSE-FILES    THRU  900-EXIT.                  05820000
                                                                        05830000
       000-MAIN-EXIT.                                                   05840000
           EXIT.                                                        05850000
                                                                        05860000
                                                                        05870000
      ******************************************************************05880000
       100-OPEN-FILES.                                                  05890000
      ******************************************************************05900000
           OPEN INPUT  BP13F315                                         05910000
                       BP13K800                                         05920000
                       BP13K893                                         05930000
                       BP13K330                                         05940000
                       BP13K462                                         05950000
                I-O    BP13K625                                         05960000
                OUTPUT AG07F225                                         05970000
                       BP13L31H                                         05980000
                       P13L31HB.                                        05990000
                                                                        06000000
           IF BP13K800-STATUS NOT = 00 AND NOT = 97                     06010000
              DISPLAY 'OPENING ERROR, BP13K800-STATUS ' BP13K800-STATUS 06020000
              MOVE     BP13K800-STATUS    TO   RETURN-CODE              06030000
              PERFORM  900-CLOSE-FILES    THRU 900-EXIT                 06040000
           END-IF.                                                      06050000
                                                                        06060000
           IF BP13K893-STATUS NOT = 00 AND NOT = 97                     06070000
              DISPLAY 'OPENING ERROR, BP13K893-STATUS ' BP13K893-STATUS 06080000
              MOVE     BP13K893-STATUS    TO   RETURN-CODE              06090000
              PERFORM  900-CLOSE-FILES    THRU 900-EXIT                 06100000
           END-IF.                                                      06110000
                                                                        06120000
           IF BP13K330-STATUS NOT = 00 AND NOT = 97                     06130000
              DISPLAY 'OPENING ERROR, BP13K330-STATUS ' BP13K330-STATUS 06140000
              MOVE     BP13K330-STATUS    TO   RETURN-CODE              06150000
              PERFORM  900-CLOSE-FILES    THRU 900-EXIT                 06160000
           END-IF.                                                      06170000
                                                                        06180000
           IF BP13K462-STATUS NOT = 00 AND NOT = 97                     06190000
              DISPLAY 'OPENING ERROR, BP13K462-STATUS ' BP13K462-STATUS 06200000
              MOVE     BP13K462-STATUS    TO   RETURN-CODE              06210000
              PERFORM  900-CLOSE-FILES    THRU 900-EXIT                 06220000
           END-IF.                                                      06230000
                                                                        06240000
           IF BP13K625-STATUS NOT = 00 AND NOT = 97                     06250000
              DISPLAY 'OPENING ERROR, BP13K625-STATUS ' BP13K625-STATUS 06260000
              MOVE     BP13K625-STATUS    TO   RETURN-CODE              06270000
              PERFORM  900-CLOSE-FILES    THRU 900-EXIT                 06280000
           END-IF.                                                      06290000
                                                                        06300000
      * VOUCHER NUMBER                                                  06310000
           MOVE       'AG07K960'          TO   C907-NUM-FILENME.        06320000
                                                                        06330000
           CALL 'K960OPEN' USING AG07C907-AREA.                         06340000
                                                                        06350000
           IF C907-NUM-FILE-STATUS NOT = ('00' AND '97')                06360000
              DISPLAY 'ERROR OPENING AG07K960 = ' C907-NUM-FILE-STATUS  06370000
              MOVE     C907-NUM-FILE-STATUS  TO   WS-AG07-STAT-X        06380000
              MOVE     WS-AG07-STATUS        TO   RETURN-CODE           06390000
              PERFORM  900-CLOSE-FILES       THRU 900-EXIT              06400000
           END-IF.                                                      06410000
                                                                        06420000
      * BATCH NUMBER (14/07/1999-ROMAR)                                 06430000
           MOVE       'BP13K620'          TO   C906-NUM-FILENME.        06440000
                                                                        06450000
           CALL 'K620OPEN' USING BP13C906-AREA.                         06460000
                                                                        06470000
           IF C906-NUM-FILE-STATUS NOT = ('00' AND '97')                06480000
              DISPLAY 'ERROR OPENING BP13K620 = ' C906-NUM-FILE-STATUS  06490000
              MOVE     C906-NUM-FILE-STATUS  TO   RETURN-CODE           06500000
              PERFORM  900-CLOSE-FILES       THRU 900-EXIT              06510000
           END-IF.                                                      06520000
                                                                        06530000
      **CALL AB05C902 TO OPEN B05K006 AND AB05K009 FILES(CODE='O')      06540000
           MOVE SPACES              TO   WS-B902-AREA.                  06550000
           INITIALIZE                    WS-B902-AREA.                  06560000
           MOVE 'O'                 TO   B902-CDE-TYPE.                 06570000
           CALL 'AB05C902'  USING WS-B902-AREA.                         06580000
                                                                        06590000
           IF B902-CDE-ERROR NOT = ZEROES                               06600000
              MOVE B902-CDE-SYSERR  TO   RETURN-CODE                    06610000
              DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'             06620000
              PERFORM  900-CLOSE-FILES  THRU 900-EXIT                   06630000
           END-IF.                                                      06640000
                                                                        06650000
       100-EXIT.                                                        06660000
           EXIT.                                                        06670000
                                                                        06680000
                                                                        06690000
      ******************************************************************06700000
       200-READ-BP13F315.                                               06710000
      ******************************************************************06720000
                                                                        06730000
           READ BP13F315                                                06740000
                AT END MOVE 'Y' TO WS-F315-EOF-IND                      06750000
                GO TO  200-EXIT.                                        06760000
                                                                        06770000
           ADD 1 TO WS-CNT-F315-READ.                                   06780000
                                                                        06790000
       200-EXIT.                                                        06800000
           EXIT.                                                        06810000
                                                                        06820000
                                                                        06830000
      ******************************************************************06840000
       300-MAIN-ROUTINE.                                                06850000
      ******************************************************************06860000
      *------------------------------------------------------------*    06870000
      *    1. READ FILE BP13F315.                                  *    06880000
      *    2. RETRIEVE FLAT'S DETAIL FROM BP13F315.                *    06890000
      *    3. READ K800 SOC MASTER TO RETRIEVE K800-AMT-LEASE-FEE. *    06900000
      *    4. PRINT LIST OF PAYMENT FOR STAMPING.                  *    06910000
      *------------------------------------------------------------*    06920000
                                                                        06930000
           MOVE    F315-REGN-NO       TO    K800-NUM-REGN.              06940000
           PERFORM 400-READ-BP13K800  THRU  400-EXIT.                   06950000
           MOVE    F315-SCH-ACC       TO    WS-SCH-ACC.                 06960000
           MOVE    F315-NUM-BLK       TO    L31H-BLK-NO.                06970000
           MOVE    F315-NME-STREET    TO    L31H-STREET.                06980000
           MOVE    F315-NUM-MAIN      TO    L31H-UNIT-NO.               06990000
           MOVE    F315-NUM-LEVEL     TO    L31H-LEVEL-NO.              07000000
           MOVE    F315-REGN-NO       TO    L31H-REGN-NO.               07010000
                                                                        07020000
           MOVE    WS-SCH-1-4         TO    L31H-SCH-1-4.               07030000
           MOVE    WS-SCH-5-8         TO    L31H-SCH-5-8.               07040000
           MOVE    WS-SCH-9-9         TO    L31H-SCH-9-9.               07050000
           MOVE    WS-SCH-10-11       TO    L31H-SCH-10-11.             07060000
           MOVE    F315-CDE-SUBTRANSFER-DOC                             07070000
                                      TO    L31H-DOC-TYPE.              07080000
                                                                        07090000
      ******** 14/07/1999 - ROMAR                                       07100000
                                                                        07110000
           IF WS-NEW-BATCH-NO = 'Y'                                     07120000
              MOVE  'SA  '      TO C906-NUM-BATCH-TYPE                  07130000
              MOVE  'BP13K620'  TO C906-NUM-FILENME                     07140000
                                                                        07150000
              CALL  'BP13C906'  USING BP13C906-AREA                     07160000
                                                                        07170000
              IF C906-NUM-FILE-STATUS =  '00'                           07180000
                 MOVE C906-NUM-BATCH-TYPE      TO  WS-NUM-BATCH-TYPE    07190000
                 MOVE C906-NUM-FIN-YEAR        TO  WS-NUM-FIN-YEAR      07200000
                 MOVE C906-NUM-BATCH-SERIAL    TO  WS-NUM-BATCH-SERIAL  07210000
                 MOVE       'N'                TO  WS-NEW-BATCH-NO      07220000
              ELSE                                                      07230000
                 DISPLAY 'ERROR CALLING BP13C906, '                     07240000
                         'FILE STATUS = '    C906-NUM-FILE-STATUS       07250000
                 MOVE     C906-NUM-FILE-STATUS TO RETURN-CODE           07260000
                 PERFORM  900-CLOSE-FILES                               07270000
              END-IF                                                    07280000
           END-IF.                                                      07290000
                                                                        07300000
           IF WS-NEW-VOUCHER-F225 = 'Y'                                 07310000
      *          MOVE  'SU '      TO C907-NUM-DDD                       07320000
                 MOVE  'SS '      TO C907-NUM-DDD                       07330000
                 MOVE  'AG07K960' TO C907-NUM-FILENME                   07340000
                                                                        07350000
                 CALL 'AG07C907'  USING AG07C907-AREA                   07360000
                                                                        07370000
                 IF C907-NUM-FILE-STATUS =  '00'                        07380000
                    PERFORM  750-WRITE-HEADER-F225 THRU 750-EXIT        07390000
                    MOVE 'N'           TO   WS-NEW-VOUCHER-F225         07400000
                 ELSE                                                   07410000
                    DISPLAY 'ERROR CALLING AG07C907, '                  07420000
                            'FILE STATUS = '    C907-NUM-FILE-STATUS    07430000
                    MOVE     C907-NUM-FILE-STATUS TO WS-AG07-STAT-X     07440000
                    MOVE     WS-AG07-STATUS       TO RETURN-CODE        07450000
                    PERFORM  900-CLOSE-FILES                            07460000
                 END-IF                                                 07470000
           END-IF.                                                      07480000
                                                                        07490000
           PERFORM  450-EARMARK-ACCOUNT      THRU 450-EXIT.             07500000
           IF B902-CDE-SYSERR NOT = ZEROES                              07510000
              DISPLAY 'ERROR CALLING AB05C902, STATUS = '               07520000
                       B902-CDE-SYSERR                                  07530000
              MOVE     '99'                 TO RETURN-CODE              07540000
              PERFORM  900-CLOSE-FILES                                  07550000
           END-IF.                                                      07560000
                                                                        07570000
           IF B902-CDE-ERROR-ACCT(1) = SPACES                           07580000
                                                                        07590000
              PERFORM 650-WRITE-STAMPING-FILE  THRU  650-EXIT           07600000
              PERFORM 760-WRITE-F225-DETAIL THRU 760-EXIT               07610000
                                                                        07620000
              IF WS-SEQ-NO-F225 = 25                                    07630000
                PERFORM 770-WRITE-TRAILER-F225 THRU 770-EXIT            07640000
                MOVE   'Y'                  TO    WS-NEW-VOUCHER-F225   07650000
                MOVE    ZEROES              TO    WS-SEQ-NO-F225        07660000
                MOVE    ZEROES              TO    WS-NET-AMT-F225       07670000
              END-IF                                                    07680000
           END-IF.                                                      07690000
                                                                        07700000
           PERFORM  200-READ-BP13F315        THRU  200-EXIT.            07710000
                                                                        07720000
       300-EXIT.                                                        07730000
           EXIT.                                                        07740000
                                                                        07750000
                                                                        07760000
      ******************************************************************07770000
       400-READ-BP13K800.                                               07780000
      ******************************************************************07790000
      *------------------------------------------------------------*    07800000
      *    READ APPLICATION MASTER TO GET ACTUAL LEASE STAMP FEE   *    07810000
      *------------------------------------------------------------*    07820000
           READ BP13K800.                                               07830000
                                                                        07840000
           IF BP13K800-STATUS = 00                                      07850000
                IF F315-CDE-SUBTRANSFER-DOC = 'SUA'                     07860000
                   PERFORM 660-READ-BP13K330  THRU  660-EXIT            07870000
                ELSE                                                    07880000
                  IF F315-CDE-SUBTRANSFER-DOC = 'TOL'                   07890000
                   PERFORM 700-READ-BP13K462  THRU  700-EXIT            07900000
                  END-IF                                                07910000
                END-IF                                                  07920000
                   PERFORM 665-MOVE-DUPLICATE THRU  665-EXIT            07930000
              ADD  1                     TO   WS-CNT-K800-READ          07940000
              MOVE F315-DTE-PROC         TO   WS-AO-DATE                07950000
              MOVE WS-AO-DD              TO   WS-DD                     07960000
              MOVE WS-AO-MM              TO   WS-MM                     07970000
              MOVE WS-AO-YEAR            TO   WS-YEAR                   07980000
              MOVE WS-DATE               TO   L31H-AGR-ORDER-DATE       07990000
                                                                        08000000
              IF F315-AMT-LEASE-FEE NOT NUMERIC                         08010000
                 MOVE ZEROES TO F315-AMT-LEASE-FEE                      08020000
              END-IF                                                    08030000
                                                                        08040000
              IF F315-AMT-LEASE-FEE-DUP NOT NUMERIC                     08050000
                 MOVE ZEROES TO F315-AMT-LEASE-FEE-DUP                  08060000
              END-IF                                                    08070000
                                                                        08080000
                 COMPUTE WS-COMP-TOT-LEASE = F315-AMT-STAMP-DUTIES      08090000
                 MOVE WS-COMP-TOT-LEASE      TO   L31H-LEASE            08100000
                 ADD  WS-COMP-TOT-LEASE      TO   WS-TOTAL-ACTUAL-LEASE 08110000
                 COMPUTE WS-DUP-LEASE  = F315-AMT-LEASE-FEE-DUP         08120000
                 COMPUTE L31H-DETL-TOTAL = F315-AMT-STAMP-DUTIES +      08130000
                                           F315-AMT-LEASE-FEE-DUP       08140000
                 ADD  F315-AMT-STAMP-DUTIES  TO   WS-TOTAL-LEASE        08150000
                 ADD  F315-AMT-LEASE-FEE-DUP TO   WS-TOTAL-LEASE        08160000
                                                                        08170000
           ELSE                                                         08180000
              IF BP13K800-STATUS = 23                                   08190000
                 PERFORM 410-READ-BP13K893 THRU 410-EXIT                08200000
              ELSE                                                      08210000
                 DISPLAY 'ERROR READING, BP13K800 ' BP13K800-STATUS     08220000
                 MOVE     BP13K800-STATUS    TO     RETURN-CODE         08230000
                 PERFORM  900-CLOSE-FILES    THRU   900-EXIT.           08240000
                                                                        08250000
       400-EXIT.                                                        08260000
           EXIT.                                                        08270000
                                                                        08280000
      ******************************************************************08290000
       410-READ-BP13K893.                                               08300000
      ******************************************************************08310000
      *------------------------------------------------------------*    08320000
      *    READ APPLICATION HISTORY                                *    08330000
      *------------------------------------------------------------*    08340000
           MOVE SPACES                 TO BP13K893-MASTER.              08350000
           INITIALIZE                     BP13K893-MASTER.              08360000
           MOVE F315-REGN-NO           TO K893-NUM-REGN-HIST.           08370000
           MOVE 'N'                    TO WS-BP13K893-EOF               08380000
                                                                        08390000
           START BP13K893 KEY >= K893-KEY-FLD.                          08400000
                                                                        08410000
           EVALUATE BP13K893-STATUS                                     08420000
           WHEN 00                                                      08430000
             WHEN 00                                                    08440000
                PERFORM 411-NEXT-BP13K893    THRU 411-EXIT              08450000
                  UNTIL K893-NUM-REGN-HIST NOT = F315-REGN-NO           08460000
                     OR WS-BP13K893-FND = 'Y'                           08470000
           WHEN 23                                                      08480000
                 DISPLAY 'K893 RECORD NOT FOUND. REGN NO = '            08490000
                          F315-REGN-NO                                  08500000
                 MOVE     BP13K893-STATUS    TO     RETURN-CODE         08510000
                 PERFORM  900-CLOSE-FILES    THRU   900-EXIT            08520000
           WHEN OTHER                                                   08530000
                 DISPLAY 'ERROR IN STARTBR K893' BP13K893-STATUS        08540000
                 MOVE     BP13K893-STATUS    TO     RETURN-CODE         08550000
                 PERFORM 900-CLOSE-FILES  THRU 900-EXIT                 08560000
           END-EVALUATE.                                                08570000
                                                                        08580000
           IF WS-BP13K893-FND = 'Y'                                     08590000
             MOVE BP13K893-MASTER(1:2000)   TO BP13K800-MASTER          08600000
              ADD  1                         TO  WS-CNT-K893-READ       08610000
              DISPLAY 'CNT-K893 = ' WS-CNT-K893-READ                    08620000
                IF F315-CDE-SUBTRANSFER-DOC = 'SUA'                     08630000
                   PERFORM 660-READ-BP13K330  THRU  660-EXIT            08640000
                ELSE                                                    08650000
                  IF F315-CDE-SUBTRANSFER-DOC = 'TOL'                   08660000
                   PERFORM 700-READ-BP13K462  THRU  700-EXIT            08670000
                  END-IF                                                08680000
                END-IF                                                  08690000
                   PERFORM 665-MOVE-DUPLICATE THRU  665-EXIT            08700000
              ADD  1                     TO   WS-CNT-K800-READ          08710000
              MOVE F315-DTE-PROC         TO   WS-AO-DATE                08720000
              MOVE WS-AO-DD              TO   WS-DD                     08730000
              MOVE WS-AO-MM              TO   WS-MM                     08740000
              MOVE WS-AO-YEAR            TO   WS-YEAR                   08750000
              MOVE WS-DATE               TO   L31H-AGR-ORDER-DATE       08760000
                                                                        08770000
              IF F315-AMT-LEASE-FEE NOT NUMERIC                         08780000
                 MOVE ZEROES TO F315-AMT-LEASE-FEE                      08790000
              END-IF                                                    08800000
                                                                        08810000
              IF F315-AMT-LEASE-FEE-DUP NOT NUMERIC                     08820000
                 MOVE ZEROES TO F315-AMT-LEASE-FEE-DUP                  08830000
              END-IF                                                    08840000
                                                                        08850000
                 COMPUTE WS-COMP-TOT-LEASE = F315-AMT-STAMP-DUTIES      08860000
                 MOVE WS-COMP-TOT-LEASE      TO   L31H-LEASE            08870000
                 ADD  WS-COMP-TOT-LEASE      TO   WS-TOTAL-ACTUAL-LEASE 08880000
                 COMPUTE WS-DUP-LEASE  = F315-AMT-LEASE-FEE-DUP         08890000
                 COMPUTE L31H-DETL-TOTAL = F315-AMT-STAMP-DUTIES +      08900000
                                           F315-AMT-LEASE-FEE-DUP       08910000
                 ADD  F315-AMT-STAMP-DUTIES  TO   WS-TOTAL-LEASE        08920000
                 ADD  F315-AMT-LEASE-FEE-DUP TO   WS-TOTAL-LEASE        08930000
           END-IF.                                                      08940000
                                                                        08950000
                                                                        08960000
       410-EXIT.                                                        08970000
           EXIT.                                                        08980000
                                                                        08990000
                                                                        09000000
      ******************************************************************09010000
       411-NEXT-BP13K893.                                               09020000
      ******************************************************************09030000
                                                                        09040000
           READ BP13K893 NEXT RECORD                                    09050000
             AT END                                                     09060000
                MOVE 'Y'                  TO WS-BP13K893-EOF            09070000
           END-READ.                                                    09080000
                                                                        09090000
           EVALUATE BP13K893-STATUS                                     09100000
              WHEN 00                                                   09110000
              WHEN 02                                                   09120000
                 IF K893-NUM-REGN-HIST = F315-REGN-NO                   09130000
                    MOVE 'Y'            TO  WS-BP13K893-EOF             09140000
                    MOVE 'Y'            TO  WS-BP13K893-FND             09150000
                 END-IF                                                 09160000
              WHEN 10                                                   09170000
              WHEN 23                                                   09180000
                 DISPLAY 'K893 RECORD NOT FOUND. REGN NO = '            09190000
                          F315-REGN-NO                                  09200000
                 MOVE     BP13K893-STATUS    TO     RETURN-CODE         09210000
                 PERFORM  900-CLOSE-FILES    THRU   900-EXIT            09220000
              WHEN OTHER                                                09230000
                 DISPLAY 'ERROR IN STARTBR K893' BP13K893-STATUS        09240000
                 MOVE     BP13K893-STATUS    TO     RETURN-CODE         09250000
                 PERFORM 900-CLOSE-FILES  THRU 900-EXIT                 09260000
           END-EVALUATE.                                                09270000
                                                                        09280000
                                                                        09290000
       411-EXIT.                                                        09300000
           EXIT.                                                        09310000
                                                                        09320000
                                                                        09330000
      ******************************************************************09340000
       450-EARMARK-ACCOUNT.                                             09350000
      ******************************************************************09360000
      **CALL AB05C902 TO EARMARK ACCOUNT(CODE='E')                      09370000
           MOVE SPACES              TO   WS-B902-AREA.                  09380000
           INITIALIZE                    WS-B902-AREA.                  09390000
                                                                        09400000
           STRING C907-NUM-DDD  C907-NUM-FIN-YR                         09410000
                  C907-NUM-VR-SERIAL                                    09420000
                  DELIMITED BY SIZE INTO B902-VR-NO                     09430000
           END-STRING.                                                  09440000
                                                                        09450000
           MOVE 'E'                     TO   B902-CDE-TYPE.             09460000
           MOVE 'BP13'                  TO   B902-CDE-SYSTEMID.         09470000
           MOVE FUNCTION CURRENT-DATE   TO   B902-DTE-TRANS.            09480000
           MOVE 'P13C31H'               TO   B902-NUM-USERID-UPDATE.    09490000
           MOVE 'CV'                    TO   B902-CDE-EARMARK-REASON.   09500000
           MOVE 01                      TO   B902-NUM-HDB-REF-CNT.      09510000
           MOVE F315-SCH-ACC            TO   B902-NUM-HDB-REF(1).       09520000
           MOVE ZEROES                  TO   WS-AMT-EARMARK.            09530000
                                                                        09540000
           COMPUTE WS-AMT-EARMARK = F315-AMT-STAMP-DUTIES +             09550000
                                      F315-AMT-LEASE-FEE-DUP            09560000
                                                                        09570000
           MOVE WS-AMT-EARMARK          TO   B902-AMT-EARMARK(1).       09580000
                                                                        09590000
           DISPLAY '----------------'.                                  09600000
           DISPLAY 'B902-VR-NO       = ' B902-VR-NO.                    09610000
           DISPLAY 'B902-CDE-TYPE    = ' B902-CDE-TYPE.                 09620000
           DISPLAY 'CDE-SYSTEMID     = ' B902-CDE-SYSTEMID.             09630000
           DISPLAY 'B902-DTE-TRANS   = ' B902-DTE-TRANS.                09640000
           DISPLAY 'NUM-USERID       = ' B902-NUM-USERID-UPDATE.        09650000
           DISPLAY 'HDB-REF-CNT      = ' B902-NUM-HDB-REF-CNT.          09660000
           DISPLAY 'NUM-HDB-REF      = ' B902-NUM-HDB-REF(1).           09670000
           DISPLAY 'B902-AMT-EARMARK = ' B902-AMT-EARMARK(1).           09680000
                                                                        09690000
           CALL 'AB05C902'  USING WS-B902-AREA.                         09700000
                                                                        09710000
           DISPLAY 'CDE-ERROR-ACCT   = ' B902-CDE-ERROR-ACCT(1).        09720000
                                                                        09730000
           EVALUATE B902-CDE-ERROR-ACCT(1)                              09740000
              WHEN SPACES                                               09750000
                 CONTINUE                                               09760000
              WHEN OTHER                                                09770000
                 COMPUTE WS-TOTAL-LEASE = WS-TOTAL-LEASE -              09780000
                                          WS-AMT-EARMARK                09790000
                 COMPUTE WS-TOTAL-ACTUAL-LEASE =                        09800000
                         WS-TOTAL-ACTUAL-LEASE - WS-AMT-EARMARK         09810000
                 PERFORM 850-PRINT-L31HB-REPORT     THRU 850-EXIT       09820000
           END-EVALUATE.                                                09830000
                                                                        09840000
       450-EXIT.                                                        09850000
           EXIT.                                                        09860000
                                                                        09870000
                                                                        09880000
      ******************************************************************09890000
       520-PRINT-HEADING.                                               09900000
      ******************************************************************09910000
      *------------------------------------------------------------*    09920000
      *    PRINT HEADING LINE                                      *    09930000
      *------------------------------------------------------------*    09940000
           MOVE   SPACES            TO    L31H-PRINT-REC.               09950000
           ADD    1                 TO    WS-NO-OF-PAGE.                09960000
           MOVE   WS-NO-OF-PAGE     TO    L31H-PAGE.                    09970000
           MOVE   FUNCTION CURRENT-DATE(1:8)                            09980000
                                    TO    WS-CURRENT-CCYYMMDD.          09990000
           MOVE   WS-CUR-DD         TO    WS-PC-DD.                     10000000
           MOVE   WS-CUR-MM         TO    WS-PC-MM.                     10010000
           MOVE   WS-CUR-CCYY       TO    WS-PC-CCYY.                   10020000
           MOVE   WS-PR-CUR-DATE    TO    L31H-CURRENT-DATE.            10030000
                                                                        10040000
           STRING WS-NUM-BATCH-TYPE   DELIMITED BY SPACE                10050000
                  WS-NUM-FIN-YEAR     DELIMITED BY SPACE                10060000
                  '-'                 DELIMITED BY SIZE                 10070000
                  WS-NUM-BATCH-SERIAL DELIMITED BY SPACE                10080000
                  INTO L31H-BATCH-NO                                    10090000
           END-STRING.                                                  10100000
                                                                        10110000
           MOVE   WS-NUM-VOUCHER-F225 TO    L31H-VOUCHER-NO.            10120000
                                                                        10130000
           WRITE  L31H-PRINT-REC  FROM L31H-PR-HDG-01 AFTER PAGE.       10140000
                                                                        10150000
           MOVE "FINANCE'S COPY" TO L31H-COPY-NAME                      10160000
           WRITE  L31H-PRINT-REC  FROM L31H-PR-HDG-02 AFTER 2.          10170000
           WRITE  L31H-PRINT-REC  FROM L31H-PR-HDG-03 AFTER 2.          10180000
           WRITE  L31H-PRINT-REC  FROM L31H-PR-HDG-04 AFTER 1.          10190000
           WRITE  L31H-PRINT-REC  FROM L31H-PR-HDG-05 AFTER 1.          10200000
           WRITE  L31H-PRINT-REC  FROM L31H-PR-HDG-05 AFTER 1.          10210000
           WRITE  L31H-PRINT-REC  FROM L31H-PR-HDG-06 AFTER 1.          10220000
           WRITE  L31H-PRINT-REC  FROM L31H-PR-HDG-07 AFTER 1.          10230000
           WRITE  L31H-PRINT-REC  FROM L31H-PR-HDG-08 AFTER 1.          10240000
           WRITE  L31H-PRINT-REC  FROM L31H-PR-HDG-09 AFTER 1.          10250000
           WRITE  L31H-PRINT-REC  FROM L31H-PR-HDG-09A AFTER 1.         10260000
           WRITE  L31H-PRINT-REC  FROM L31H-PR-HDG-10 AFTER 1.          10270000
           WRITE  L31H-PRINT-REC  FROM L31H-PR-HDG-11 AFTER 2.          10280000
           WRITE  L31H-PRINT-REC  FROM L31H-PR-HDG-12 AFTER 1.          10290000
                                                                        10300000
           MOVE   SPACES TO  L31H-PRINT-REC.                            10310000
                                                                        10320000
           WRITE L31H-PRINT-REC  AFTER 1.                               10330000
                                                                        10340000
       520-EXIT.                                                        10350000
           EXIT.                                                        10360000
                                                                        10370000
      ******************************************************************10380000
       620-PRINT-DETAIL.                                                10390000
      ******************************************************************10400000
      *------------------------------------------------------------*    10410000
      *    PRINT LIST OF PAYMENT FOR STAMPING                      *    10420000
      *------------------------------------------------------------*    10430000
                                                                        10440000
           ADD   1                   TO    WS-CNT-L31H-WRITE.           10450000
           MOVE  WS-CNT-L31H-DETLS   TO    L31H-NO.                     10460000
           WRITE L31H-PRINT-REC      FROM  L31H-PR-DETAIL AFTER 1.      10470000
                                                                        10480000
           MOVE  SPACES              TO    L31H-PRINT-REC.              10490000
                                                                        10500000
       620-EXIT.                                                        10510000
           EXIT.                                                        10520000
                                                                        10530000
                                                                        10540000
                                                                        10550000
      ******************************************************************10560000
       650-WRITE-STAMPING-FILE.                                         10570000
      ******************************************************************10580000
            DISPLAY '650-WRITE-STAMPING-FILE' F315-SCH-ACC.             10590000
            INITIALIZE BP13K625-REC.                                    10600000
            MOVE SPACES                 TO BP13K625-REC.                10610000
                                                                        10620000
            MOVE F315-SCH-ACC              TO WS-NUM-HDB-REF.           10630000
            MOVE F315-CDE-SUBTRANSFER-DOC  TO WS-NUM-DOC.               10640000
                                                                        10650000
      ****  WRITE DETAIL PART FOR ORIGINAL AGREEMENT LEASE*******       10660000
            MOVE 'O'                    TO WS-NUM-DOC-TYP.              10670000
                                                                        10680000
            DISPLAY 'DOC-TYPE = ' WS-NUM-DOC-TYP.                       10690000
            PERFORM 670-CHK-EXSTNG-BP13K625  THRU 670-EXIT.             10700000
            PERFORM 690-MAIN-DETAILS-TO-K625 THRU 690-EXIT.             10710000
                                                                        10720000
            COMPUTE WS-LEASE          = F315-AMT-STAMP-DUTIES.          10730000
                                                                        10740000
            MOVE WS-LEASE               TO K625-AMT-STAMP-DUTY.         10750000
            MOVE ZEROES                 TO K625-AMT-STAMP-DUTY-DUP.     10760000
            DISPLAY 'DOC-TYPE = ' K625-NUM-DOC-TYP.                     10770000
            DISPLAY 'AMT      = ' K625-AMT-STAMP-DUTY.                  10780000
            ADD 1                       TO WS-CNT-K625-WRITE.           10790000
            WRITE BP13K625-REC.                                         10800000
                                                                        10810000
      ****  WRITE DETAIL PART FOR DUPLICATE AGREEMENT LEASE*******      10820000
      *     MOVE 'D'                    TO WS-NUM-DOC-TYP.              10830000
      *                                                                 10840000
      *     DISPLAY 'DOC-TYPE = ' WS-NUM-DOC-TYP.                       10850000
      *     PERFORM 670-CHK-EXSTNG-BP13K625  THRU 670-EXIT.             10860000
      *     PERFORM 690-MAIN-DETAILS-TO-K625 THRU 690-EXIT.             10870000
      *     COMPUTE K625-AMT-STAMP-DUTY-DUP = F315-AMT-LEASE-FEE-DUP    10880000
      *                                                                 10890000
      *     MOVE ZEROES                 TO K625-AMT-STAMP-DUTY.         10900000
      *                                                                 10910000
      *     DISPLAY 'DOC-TYPE = ' K625-NUM-DOC-TYP.                     10920000
      *     DISPLAY 'AMT      = ' K625-AMT-STAMP-DUTY.                  10930000
      *     ADD 1                       TO WS-CNT-K625-WRITE.           10940000
      *     WRITE BP13K625-REC.                                         10950000
                                                                        10960000
       650-EXIT.                                                        10970000
           EXIT.                                                        10980000
                                                                        10990000
                                                                        11000000
      ******************************************************************11010000
       660-READ-BP13K330.                                               11020000
      ******************************************************************11030000
      *------------------------------------------------------------*    11040000
      *    READ ACCUM SO MASTER TO GET ANNUAL RENT, PURCHASE PRICE,*    11050000
      *    AMT LOAN.                                               *    11060000
      *------------------------------------------------------------*    11070000
           MOVE K800-NUM-REGN          TO K330-CURR-REG.                11080000
           MOVE '1'                    TO K330-SEQ-NO.                  11090000
           READ BP13K330.                                               11100000
                                                                        11110000
           IF BP13K330-STATUS = 00                                      11120000
              ADD  1           TO  WS-CNT-K330-READ                     11130000
              IF K330-AMT-SC-CC1-NET NOT NUMERIC                        11140000
                MOVE ZEROES TO WS-ANNUAL-RENT                           11150000
              ELSE                                                      11160000
                COMPUTE WS-ANNUAL-RENT = (K330-AMT-SC-CC1-NET * 12) + 1 11170000
              END-IF                                                    11180000
           ELSE                                                         11190000
              IF BP13K330-STATUS = 23                                   11200000
               IF F315-REGN-NO = '3492561E' OR '3741034I'               11210000
                  CONTINUE                                              11220000
                ELSE                                                    11230000
                 DISPLAY 'K330 RECORD NOT FOUND. REGN NO = '            11240000
                          K330-CURR-REG                                 11250000
                 MOVE     BP13K330-STATUS    TO     RETURN-CODE         11260000
                 PERFORM  900-CLOSE-FILES    THRU   900-EXIT            11270000
               END-IF                                                   11280000
              ELSE                                                      11290000
                 DISPLAY 'ERROR READING, BP13K330 ' BP13K330-STATUS     11300000
                 MOVE     BP13K330-STATUS    TO     RETURN-CODE         11310000
                 PERFORM  900-CLOSE-FILES    THRU   900-EXIT.           11320000
                                                                        11330000
       660-EXIT.                                                        11340000
           EXIT.                                                        11350000
                                                                        11360000
                                                                        11370000
      ******************************************************************11380000
       665-MOVE-DUPLICATE.                                              11390000
      ******************************************************************11400000
           IF K800-DTE-RAISE-AO <= '20110218'                           11410000
              IF K330-NUM-SF-DISC = 'N'                                 11420000
                 MOVE 2.00 TO WS-DEF-DUP-LEASE                          11430000
                              WS-DUP-LEASE                              11440000
              ELSE                                                      11450000
                 MOVE 1.40 TO WS-DEF-DUP-LEASE                          11460000
                              WS-DUP-LEASE                              11470000
              END-IF                                                    11480000
           ELSE                                                         11490000
              MOVE 0.00    TO WS-DEF-DUP-LEASE                          11500000
                              WS-DUP-LEASE                              11510000
           END-IF.                                                      11520000
                                                                        11530000
       665-EXIT.                                                        11540000
           EXIT.                                                        11550000
                                                                        11560000
                                                                        11570000
      ******************************************************************11580000
       670-CHK-EXSTNG-BP13K625.                                         11590000
      ******************************************************************11600000
           MOVE WS-NUM-HDB-REF          TO K625-NUM-HDB-REF.            11610000
           MOVE WS-NUM-DOC              TO K625-NUM-DOC.                11620000
           MOVE WS-NUM-DOC-TYP          TO K625-NUM-DOC-TYP.            11630000
           MOVE 1                       TO K625-NUM-DOC-CNT.            11640000
           MOVE 'N'                     TO WS-K625-EOF.                 11650000
                                                                        11660000
           START BP13K625 KEY = K625-KEY-FLD.                           11670000
                                                                        11680000
           EVALUATE BP13K625-STATUS                                     11690000
              WHEN '00'                                                 11700000
                    PERFORM 680-READNEXT-BP13K625 THRU 680-EXIT         11710000
                            UNTIL WS-K625-EOF = 'Y'                     11720000
                    ADD  1              TO WS-NUM-DOC-CNT               11730000
              WHEN '10'                                                 11740000
              WHEN '23'                                                 11750000
                    MOVE 1              TO WS-NUM-DOC-CNT               11760000
              WHEN OTHER                                                11770000
                    DISPLAY 'ERROR WHILE STARTING BROWSE-BP13K625 '     11780000
                    MOVE BP13K625-STATUS TO RETURN-CODE                 11790000
                    PERFORM 900-CLOSE-FILES THRU 900-EXIT               11800000
           END-EVALUATE.                                                11810000
                                                                        11820000
       670-EXIT.                                                        11830000
           EXIT.                                                        11840000
                                                                        11850000
                                                                        11860000
      ******************************************************************11870000
       680-READNEXT-BP13K625.                                           11880000
      ******************************************************************11890000
           READ BP13K625 NEXT AT END MOVE 'Y' TO WS-K625-EOF            11900000
              GO TO 680-EXIT.                                           11910000
                                                                        11920000
           IF (K625-NUM-HDB-REF NOT = WS-NUM-HDB-REF) OR                11930000
              (K625-NUM-DOC     NOT = WS-NUM-DOC)     OR                11940000
              (K625-NUM-DOC-TYP NOT = WS-NUM-DOC-TYP)                   11950000
              MOVE 'Y'                   TO WS-K625-EOF                 11960000
              GO TO 680-EXIT                                            11970000
           END-IF.                                                      11980000
                                                                        11990000
           MOVE K625-NUM-DOC-CNT         TO WS-NUM-DOC-CNT.             12000000
                                                                        12010000
       680-EXIT.                                                        12020000
           EXIT.                                                        12030000
                                                                        12040000
                                                                        12050000
      ******************************************************************12060000
       690-MAIN-DETAILS-TO-K625.                                        12070000
      ******************************************************************12080000
            MOVE  SPACES                TO BP13K625-REC.                12090000
            INITIALIZE                     BP13K625-REC.                12100000
                                                                        12110000
            MOVE  F315-SCH-ACC          TO K625-NUM-HDB-REF.            12120000
            MOVE  F315-CDE-SUBTRANSFER-DOC TO  K625-NUM-DOC.            12130000
            MOVE  WS-NUM-DOC-TYP        TO K625-NUM-DOC-TYP.            12140000
            MOVE  WS-NUM-DOC-CNT        TO K625-NUM-DOC-CNT.            12150000
            MOVE  C907-NUM-DDD          TO K625-NUM-DDD.                12160000
            MOVE  C907-NUM-FIN-YR       TO K625-NUM-FIN-YEAR.           12170000
            MOVE  C907-NUM-VR-SERIAL    TO K625-NUM-VR-SERIAL.          12180000
            MOVE  C906-NUM-BATCH-TYPE   TO K625-NUM-BATCH-TYPE.         12190000
            MOVE  C906-NUM-FIN-YEAR     TO K625-NUM-CAL-YEAR.           12200000
            MOVE  C906-NUM-BATCH-SERIAL TO K625-NUM-BATCH-SERIAL.       12210000
            MOVE  K800-NUM-REGN         TO K625-NUM-REGN.               12220000
            MOVE  F315-DTE-PROC         TO K625-DTE-DOC-PREPARE.        12230000
            IF K330-AMT-CURR-SELLPR IS NUMERIC                          12240000
              MOVE  K330-AMT-CURR-SELLPR  TO K625-AMT-PURCHASE-PRICE    12250000
            ELSE                                                        12260000
              MOVE  ZEROES                TO K625-AMT-PURCHASE-PRICE    12270000
            END-IF.                                                     12280000
            MOVE  WS-ANNUAL-RENT        TO K625-AMT-ANNUAL-RENT.        12290000
            MOVE  SPACES                TO K625-NUM-INCREASE-SCCC.      12300000
            MOVE  ZEROES                TO K625-AMT-LOAN.               12310000
            MOVE  'BP13C31H'            TO K625-NUM-SYSTEM.             12320000
            MOVE  WS-CURRENT-CCYYMMDD   TO K625-DTE-UPDATE.             12330000
                                                                        12340000
            IF K800-NUM-FLAT-TYPE = SPACES OR LOW-VALUES                12350000
               MOVE  ZEROES             TO K625-NUM-LEASE-TERM          12360000
            ELSE                                                        12370000
               IF K800-NUM-FLAT-TYPE = '1A' OR '2A'                     12380000
                  COMPUTE K625-NUM-LEASE-TERM = 30 * 12                 12390000
               ELSE                                                     12400000
                  COMPUTE K625-NUM-LEASE-TERM = 99 * 12                 12410000
               END-IF                                                   12420000
            END-IF.                                                     12430000
                                                                        12440000
       690-EXIT.                                                        12450000
           EXIT.                                                        12460000
                                                                        12470000
      ******************************************************************12480000
       700-READ-BP13K462.                                               12490000
      ******************************************************************12500000
           MOVE K800-NUM-REGN          TO K462-NUM-REGN.                12510000
                                                                        12520000
           READ BP13K462 KEY IS K462-NUM-REGN.                          12530000
                                                                        12540000
           IF BP13K462-STATUS = 00                                      12550000
              IF K462-ANNUAL-RENT    NOT NUMERIC                        12560000
                MOVE ZEROES TO WS-ANNUAL-RENT                           12570000
              ELSE                                                      12580000
                MOVE K462-ANNUAL-RENT TO WS-ANNUAL-RENT                 12590000
              END-IF                                                    12600000
           ELSE                                                         12610000
              IF BP13K462-STATUS = 23                                   12620000
                 DISPLAY 'K462 RECORD NOT FOUND. REGN NO = '            12630000
                          K462-NUM-REGN                                 12640000
                 MOVE     BP13K462-STATUS    TO     RETURN-CODE         12650000
                 PERFORM  900-CLOSE-FILES    THRU   900-EXIT            12660000
              ELSE                                                      12670000
                 DISPLAY 'ERROR READING, BP13K462 ' BP13K462-STATUS     12680000
                 MOVE     BP13K462-STATUS    TO     RETURN-CODE         12690000
                 PERFORM  900-CLOSE-FILES    THRU   900-EXIT.           12700000
                                                                        12710000
       700-EXIT.                                                        12720000
           EXIT.                                                        12730000
                                                                        12740000
                                                                        12750000
                                                                        12760000
      ******************************************************************12770000
       720-PRINT-TOTAL-LINE.                                            12780000
      ******************************************************************12790000
      *------------------------------------------------------------*    12800000
      *    PRINT TOTAL LEASE LINE                                  *    12810000
      *------------------------------------------------------------*    12820000
           IF WS-CNT-F315-READ = 0                                      12830000
              GO TO 720-EXIT                                            12840000
           END-IF.                                                      12850000
                                                                        12860000
           WRITE L31H-PRINT-REC        FROM  L31H-PR-DASH-LINE AFTER 3. 12870000
                                                                        12880000
           MOVE  SPACES                TO    L31H-PRINT-REC.            12890000
           MOVE  WS-CNT-L31H-DETLS     TO    L31H-VR-NO-HIGH.           12900000
           MOVE  WS-TOTAL-ACTUAL-LEASE TO    L31H-TOTAL-ACTUAL.         12910000
           MOVE  WS-TOTAL-LEASE        TO    L31H-TOTAL-LEASE.          12920000
                                                                        12930000
           WRITE L31H-PRINT-REC       FROM   L31H-PR-TOTAL-LINE AFTER 1.12940000
                                                                        12950000
           MOVE  SPACES                TO    L31H-PRINT-REC.            12960000
           WRITE L31H-PRINT-REC       FROM   L31H-PR-DASH-LINE AFTER 1. 12970000
                                                                        12980000
       720-EXIT.                                                        12990000
           EXIT.                                                        13000000
                                                                        13010000
                                                                        13020000
      ******************************************************************13030000
       750-WRITE-HEADER-F225.                                           13040000
      ******************************************************************13050000
           INITIALIZE    AG07F225-HEADER.                               13060000
           MOVE SPACES                    TO AG07F225-HEADER.           13070000
           MOVE C907-NUM-DDD              TO F225-NUM-DDD               13080000
           MOVE C907-NUM-FIN-YR           TO F225-NUM-FIN-YEAR          13090000
           MOVE C907-NUM-VR-SERIAL        TO F225-NUM-VR-SERIAL         13100000
           MOVE F225-NUM-VR               TO WS-NUM-VOUCHER-F225        13110000
           MOVE 00                        TO F225-NUM-REC-TYP.          13120000
           MOVE 'PV'                      TO F225-NUM-VR-TYP.           13130000
           MOVE 'TL'                      TO F225-NUM-VR-SUB-TYP.       13140000
           MOVE 'SOC     '                TO F225-NUM-TRANS-TYP.        13150000
           MOVE SPACES                    TO F225-NUM-ROOT-ACCT.        13160000
           MOVE  FUNCTION CURRENT-DATE(1:8) TO                          13170000
                                             WS-CURRENT-CCYYMMDD.       13180000
           MOVE WS-CURRENT-CCYYMMDD       TO F225-DTE-VR-CREATE         13190000
                                             F225-DTE-VR-PRT-FINAL      13200000
           MOVE 'BP13C31H'                TO F225-NUM-VR-CREATE-USERID  13210000
                                          F225-NUM-VR-PRT-FINAL-USERID  13220000
           MOVE 'DBSSSGSGXXX'             TO F225-NUM-PAYEE-BANK        13230000
           MOVE SPACES                    TO F225-NUM-PAYEE-BANK-BRNCH  13240000
           MOVE '0010468600'              TO F225-NUM-PAYEE-IBG-ACCT.   13250000
           MOVE 'STPFEE  '                TO F225-NUM-DDD-FILE-REF.     13260000
           MOVE 'COMMISSIONER OF STAMP DUTIES'                          13270000
                                          TO F225-NME-PAYEE1.           13280000
           MOVE SPACES                    TO F225-NUM-PAYEE-UIN1.       13290000
           MOVE SPACES                    TO F225-NME-PAYEE2.           13300000
           MOVE SPACES                    TO F225-NUM-PAYEE-UIN2.       13310000
           MOVE SPACES                    TO F225-NUM-PAYEE-TAX-REGN.   13320000
           MOVE '55'                      TO F225-NUM-BLK-HSE.          13321001
           MOVE 'NEWTON ROAD'             TO F225-NME-STREET.           13322001
           MOVE 'REVENUE HOUSE'           TO F225-NME-BLDNG.            13323001
           MOVE '307987'                  TO F225-NUM-POSTAL.           13324001
      *    MOVE 'C/O SC(STAMPING) OF SALES UNIT'                        13330001
      *                                   TO F225-NME-STREET            13340001
           MOVE FUNCTION CURRENT-DATE(1:8) TO                           13350000
                                             WS-CURRENT-CCYYMMDD.       13360000
           MOVE 'SALES AGREEMENT TEAM'    TO F225-NME-COLL-OFFCR.       13370000
           MOVE '64903783'                TO F225-NUM-COLL-OFFCR-PHONE. 13380000
           MOVE 'SALES AGREEMENT TEAM'    TO F225-NME-CONTACT-OFFCR.    13390000
           MOVE '64903783'                TO F225-NUM-CONTACT-PHONE.    13400000
           MOVE SPACES                    TO F225-TXT-REJECT-HDR.       13410000
           MOVE 'STPFEE  '                TO F225-NUM-INTRFC-FR-HDR.    13420000
           MOVE 'CV'                      TO F225-NUM-ACTION-TYP.       13430000
           MOVE SPACES                    TO F225-NUM-PRCS-TERM.        13440000
           MOVE SPACES                    TO F225-NUM-ROUTE-FLAG.       13450000
           MOVE 'Y'                   TO F225-CDE-EARMARK-STAMP-FEE.    13460000
           IF F315-USERID   = 'BP13P001'                                13470000
              MOVE WS-STAFF-START         TO F225-NUM-STAFF-ID-PREP     13480000
                                             F225-NUM-USERID-START      13490000
           ELSE                                                         13500000
              MOVE F315-USERID            TO F225-NUM-STAFF-ID-PREP     13510000
                                             F225-NUM-USERID-START      13520000
           END-IF.                                                      13530000
           MOVE 'PREP'                    TO F225-NUM-VCHR-STATE-START. 13540000
           MOVE SPACES                    TO F225-DTE-PYMNT-DUE.        13550000
                                                                        13560000
           WRITE AG07F225-HEADER.                                       13570000
           ADD      1                     TO WS-CNT-F225-WRITE.         13580000
           PERFORM  520-PRINT-HEADING   THRU   520-EXIT.                13590000
                                                                        13600000
       750-EXIT.                                                        13610000
           EXIT.                                                        13620000
                                                                        13630000
      ******************************************************************13640000
       760-WRITE-F225-DETAIL.                                           13650000
      ******************************************************************13660000
           INITIALIZE  AG07F225-TRANS.                                  13670000
           MOVE        SPACES               TO AG07F225-TRANS.          13680000
           ADD         1                    TO WS-SEQ-NO-F225.          13690000
           ADD         1                    TO WS-CNT-L31H-DETLS.       13700000
           MOVE        WS-NUM-VOUCHER-F225  TO F225-NUM-VR-T.           13710000
           MOVE        WS-SEQ-NO-F225       TO F225-NUM-TRANS-SERIAL.   13720000
           MOVE        '04'                 TO F225-NUM-SYS.            13730000
           MOVE        F315-SCH-ACC         TO F225-NUM-HDB-REF         13740000
           MOVE '0000000104250'             TO F225-NUM-GL-ACCT.        13750000
           MOVE SPACES                      TO F225-NUM-TAX-CDE.        13760000
                                                                        13770000
           MOVE F315-AMT-STAMP-DUTIES       TO F225-AMT-TRANS           13780000
           IF F225-AMT-TRANS NOT NUMERIC                                13790000
              DISPLAY 'F225-AMT-TRANS NOT NUMERIC:' F225-AMT-TRANS      13800000
              MOVE ZEROES TO F225-AMT-TRANS                             13810000
           END-IF.                                                      13820000
                                                                        13830000
           COMPUTE WS-NET-AMT-F225 = F225-AMT-TRANS + WS-NET-AMT-F225.  13840000
           MOVE        'D'                 TO  F225-NUM-TRANS-DR-CR.    13850000
           MOVE        ZEROS               TO  F225-AMT-TRANS-GST.      13860000
           MOVE        F315-REGN-NO        TO  F225-TXT-INFO.           13870000
           MOVE        SPACES              TO  F225-NUM-CPF.            13880000
           MOVE        SPACES              TO  F225-TXT-REJECT-DTL.     13890000
           MOVE        'STPFEE  '          TO  F225-NUM-INTRFC-FR-T.    13900000
           WRITE       AG07F225-TRANS.                                  13910000
                                                                        13920000
           ADD         1                   TO WS-CNT-F225-WRITE.        13930000
           PERFORM 620-PRINT-DETAIL   THRU  620-EXIT.                   13940000
                                                                        13950000
       760-EXIT.                                                        13960000
           EXIT.                                                        13970000
                                                                        13980000
      ******************************************************************13990000
       770-WRITE-TRAILER-F225.                                          14000000
      ******************************************************************14010000
                                                                        14020000
           IF WS-SEQ-NO-F225  = ZEROES                                  14030000
              GO TO 770-EXIT                                            14040000
           END-IF.                                                      14050000
                                                                        14060000
           INITIALIZE AG07F225-TRAILER.                                 14070000
           MOVE       SPACES              TO  AG07F225-TRAILER.         14080000
                                                                        14090000
           MOVE  WS-NUM-VOUCHER-F225      TO  F225-NUM-VR-R.            14100000
           MOVE       99                  TO  F225-NUM-TRAILER-SERIAL.  14110000
           MOVE 'PAYMENT FOR LEASE/MORTGAGE STAMP FEES'                 14120000
                                    TO  F225-TXT-VOUCHER-NARRATION      14130000
           MOVE       WS-SEQ-NO-F225      TO  F225-QTY-VR-TRANS.        14140000
           MOVE       WS-NET-AMT-F225     TO  F225-AMT-VR-DR-TOTAL.     14150000
           MOVE       ZEROES              TO  F225-AMT-VR-CR-TOTAL.     14160000
           MOVE       SPACES              TO  F225-TXT-REJECT-TLR.      14170000
           MOVE       'STPFEE  '          TO  F225-NUM-INTRFC-FR.       14180000
                                                                        14190000
           WRITE      AG07F225-TRAILER.                                 14200000
                                                                        14210000
           ADD        1                   TO       WS-CNT-F225-WRITE.   14220000
           MOVE      'Y'                  TO       WS-NEW-VOUCHER-F225. 14230000
           PERFORM  720-PRINT-TOTAL-LINE  THRU   720-EXIT.              14240000
           PERFORM  800-PRINT-FOOTING     THRU   800-EXIT.              14250000
           MOVE     0   TO WS-CNT-L31H-DETLS                            14260000
                           WS-TOTAL-ACTUAL-LEASE                        14270000
                           WS-TOTAL-DUP-LEASE                           14280000
                           WS-TOTAL-LEASE.                              14290000
           MOVE    'Y'  TO WS-NEW-VOUCHER-F225                          14300000
                           WS-NEW-BATCH-NO                              14310000
                           WS-NEW-HEADER.                               14320000
                                                                        14330000
       770-EXIT.                                                        14340000
           EXIT.                                                        14350000
                                                                        14360000
      ******************************************************************14370000
       800-PRINT-FOOTING.                                               14380000
      ******************************************************************14390000
           MOVE    WS-TOTAL-LEASE       TO    WS-AMT.                   14400000
           PERFORM 9000-CONVT-AMT-WORD  THRU  9000-EXIT.                14410000
           MOVE    WP-ITEM (1)          TO    L31H-AMT-DESC1.           14420000
           MOVE    WP-ITEM (2)          TO    L31H-AMT-DESC2.           14430000
                                                                        14440000
           WRITE  L31H-PRINT-REC        FROM  L31H-PR-FTG-01   AFTER 2. 14450000
           WRITE  L31H-PRINT-REC        FROM  L31H-PR-FTG-02   AFTER 5. 14460000
                                                                        14470000
       800-EXIT.                                                        14480000
           EXIT.                                                        14490000
                                                                        14500000
                                                                        14510000
      ******************************************************************14520000
       850-PRINT-L31HB-REPORT.                                          14530000
      ******************************************************************14540000
           IF WS-L31HB-REC-ON-PAGE-CNT > 65                             14550000
              PERFORM 851-PRINT-L416-HEADER     THRU 851-EXIT           14560000
           END-IF.                                                      14570000
                                                                        14580000
           MOVE SPACES                TO L31HB-REC-DETAIL.              14590000
           INITIALIZE                    L31HB-REC-DETAIL.              14600000
           ADD  1                     TO WS-L31HB-PRINT-CNT.            14610000
           MOVE WS-L31HB-PRINT-CNT    TO L31HB-SERIAL-NO.               14620000
                                                                        14630000
           STRING F315-SCH-ACC(1:4) '-'                                 14640000
                  F315-SCH-ACC(5:4) '-'                                 14650000
                  F315-SCH-ACC(9:1) '-'                                 14660000
                  F315-SCH-ACC(10:2)                                    14670000
                  DELIMITED BY SIZE INTO L31HB-SCH-ACC                  14680000
           END-STRING.                                                  14690000
                                                                        14700000
           MOVE F315-REGN-NO      TO L31HB-REGN-NO.                     14710000
           STRING C907-NUM-DDD    '-'                                   14720000
                  C907-NUM-FIN-YR   '-'                                 14730000
                  C907-NUM-VR-SERIAL                                    14740000
                  DELIMITED BY SIZE INTO L31HB-JR-VCHR-NO               14750000
           END-STRING.                                                  14760000
           MOVE WS-AMT-EARMARK    TO L31HB-AMT-TOTAL.                   14770000
                                                                        14780000
           EVALUATE B902-CDE-ERROR-ACCT(1)                              14790000
              WHEN 'S0045'                                              14800000
                 MOVE 'B05K006 FILE ERROR'         TO L31HB-ERROR-DESC  14810000
              WHEN 'S0052'                                              14820000
                 MOVE 'INVALID INPUT      '        TO L31HB-ERROR-DESC  14830000
              WHEN 'S0053'                                              14840000
                 MOVE 'AB05K009 FILE ERROR'        TO L31HB-ERROR-DESC  14850000
              WHEN 'S0054'                                              14860000
                 MOVE 'B05K006 REC NOT FND'        TO L31HB-ERROR-DESC  14870000
              WHEN 'S0055'                                              14880000
                 MOVE 'DOESN''T HAVE ENOUGH BALANCE'                    14890000
                                                   TO L31HB-ERROR-DESC  14900000
              WHEN OTHER                                                14910000
                 MOVE 'AB05C902 SUBROUTINE ERROR'  TO L31HB-ERROR-DESC  14920000
           END-EVALUATE.                                                14930000
                                                                        14940000
           WRITE L31HB-PRINT-REC  FROM L31HB-REC-DETAIL  AFTER 1.       14950000
                                                                        14960000
           ADD   1     TO  WS-L31HB-REC-ON-PAGE-CNT.                    14970000
                                                                        14980000
       850-EXIT.                                                        14990000
           EXIT.                                                        15000000
                                                                        15010000
                                                                        15020000
      ******************************************************************15030000
       851-PRINT-L416-HEADER.                                           15040000
      ******************************************************************15050000
           MOVE   FUNCTION CURRENT-DATE(1:8)                            15060000
                                    TO    WS-CURRENT-CCYYMMDD.          15070000
           MOVE   WS-CUR-DD         TO    WS-PC-DD.                     15080000
           MOVE   WS-CUR-MM         TO    WS-PC-MM.                     15090000
           MOVE   WS-CUR-CCYY       TO    WS-PC-CCYY.                   15100000
           MOVE   WS-PR-CUR-DATE    TO    L31HB-DATE.                   15110000
                                                                        15120000
           ADD  1      TO WS-L31HB-PAGE-CNT.                            15130000
           MOVE WS-L31HB-PAGE-CNT    TO  L31HB-PAGE.                    15140000
           WRITE L31HB-PRINT-REC  FROM L31HB-HEADER1     AFTER PAGE.    15150000
           WRITE L31HB-PRINT-REC  FROM L31HB-HEADER2     AFTER 2.       15160000
           WRITE L31HB-PRINT-REC  FROM L31HB-HEADER3     AFTER 2.       15170000
           WRITE L31HB-PRINT-REC  FROM L31HB-UNDERLINE   AFTER 1.       15180000
           MOVE  6     TO  WS-L31HB-REC-ON-PAGE-CNT.                    15190000
                                                                        15200000
       851-EXIT.                                                        15210000
           EXIT.                                                        15220000
                                                                        15230000
                                                                        15240000
      ******************************************************************15250000
       900-CLOSE-FILES.                                                 15260000
      ******************************************************************15270000
      *------------------------------------------------------------*    15280000
      *    CLOSE FILES AND END PROCESSING                          *    15290000
      *------------------------------------------------------------*    15300000
           CLOSE BP13F315                                               15310000
                 BP13K800                                               15320000
                 BP13K893                                               15330000
                 BP13K330                                               15340000
                 BP13K462                                               15350000
                 BP13K625                                               15360000
                 AG07F225                                               15370000
                 BP13L31H                                               15380000
                 P13L31HB.                                              15390000
                                                                        15400000
           IF BP13K800-STATUS NOT = 00                                  15410000
              DISPLAY 'CLOSING ERROR, BP13K800-STATUS ' BP13K800-STATUS 15420000
              MOVE     BP13K800-STATUS TO RETURN-CODE                   15430000
           END-IF.                                                      15440000
                                                                        15450000
           IF BP13K893-STATUS NOT = 00                                  15460000
              DISPLAY 'CLOSING ERROR, BP13K893-STATUS ' BP13K893-STATUS 15470000
              MOVE     BP13K893-STATUS TO RETURN-CODE                   15480000
           END-IF.                                                      15490000
                                                                        15500000
           IF BP13K330-STATUS NOT = 00                                  15510000
              DISPLAY 'CLOSING ERROR, BP13K330-STATUS ' BP13K330-STATUS 15520000
              MOVE     BP13K330-STATUS TO RETURN-CODE                   15530000
           END-IF.                                                      15540000
                                                                        15550000
           IF BP13K462-STATUS NOT = 00                                  15560000
              DISPLAY 'CLOSING ERROR, BP13K462-STATUS ' BP13K462-STATUS 15570000
              MOVE     BP13K462-STATUS TO RETURN-CODE                   15580000
           END-IF.                                                      15590000
                                                                        15600000
           IF BP13K625-STATUS NOT = 00                                  15610000
              DISPLAY 'CLOSING ERROR, BP13K625-STATUS ' BP13K625-STATUS 15620000
              MOVE     BP13K625-STATUS TO RETURN-CODE                   15630000
           END-IF.                                                      15640000
                                                                        15650000
           MOVE 'AG07K960' TO C907-NUM-FILENME.                         15660000
                                                                        15670000
           CALL 'K960CLSE' USING AG07C907-AREA.                         15680000
                                                                        15690000
           IF C907-NUM-FILE-STATUS NOT = ('00' AND '97')                15700000
              DISPLAY 'ERROR CLOSING AG07K960 = ' C907-NUM-FILE-STATUS  15710000
              MOVE     C907-NUM-FILE-STATUS TO WS-AG07-STAT-X           15720000
              MOVE     WS-AG07-STATUS       TO RETURN-CODE              15730000
           END-IF.                                                      15740000
                                                                        15750000
           MOVE 'BP13K620' TO C906-NUM-FILENME.                         15760000
                                                                        15770000
           CALL 'K620MCLS' USING BP13C906-AREA.                         15780000
                                                                        15790000
           IF C906-NUM-FILE-STATUS NOT = ('00' AND '97')                15800000
              DISPLAY 'ERROR CLOSING BP13K620 = ' C906-NUM-FILE-STATUS  15810000
              MOVE     C906-NUM-FILE-STATUS TO RETURN-CODE              15820000
           END-IF.                                                      15830000
                                                                        15840000
      **CALL AB05C902 TO CLOSE B05K006 AND AB05K009 FILES(CODE='C')     15850000
           MOVE SPACES              TO   WS-B902-AREA.                  15860000
           INITIALIZE                    WS-B902-AREA.                  15870000
           MOVE 'C'                 TO   B902-CDE-TYPE.                 15880000
           CALL 'AB05C902'  USING WS-B902-AREA.                         15890000
                                                                        15900000
           IF B902-CDE-ERROR NOT = ZEROES                               15910000
              MOVE B902-CDE-SYSERR  TO   RETURN-CODE                    15920000
              DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'             15930000
           END-IF.                                                      15940000
                                                                        15950000
                                                                        15960000
           DISPLAY '                                   '.               15970000
           DISPLAY '******   BP13C31H CONTROL TOTALS   ******'.         15980000
           DISPLAY '                                   '.               15990000
           DISPLAY 'NO OF RECORDS READ FROM DAILY TRANS (BP13F315)  = ' 16000000
                    WS-CNT-F315-READ.                                   16010000
           DISPLAY 'NO OF RECORDS READ FROM RFF MASTER  (BP13K800)  = ' 16020000
                    WS-CNT-K800-READ.                                   16030000
           DISPLAY 'NO OF RECORDS READ FROM RFF HISTORY (BP13K893)  = ' 16040000
                    WS-CNT-K893-READ.                                   16050000
           DISPLAY 'NO OF RECORDS READ FROM ACCUMSO FILE(BP13K330)  = ' 16060000
                    WS-CNT-K330-READ.                                   16070000
           DISPLAY 'NO OF RECORDS WRITTEN  (BP13K625)               = ' 16080000
                    WS-CNT-K625-WRITE.                                  16090000
           DISPLAY 'NO OF PAYMENTS WRITTEN (BP13L31H)               = ' 16100000
                    WS-CNT-L31H-WRITE.                                  16110000
           DISPLAY 'NO OF PAYMENTS WRITTEN (AG07F225)               = ' 16120000
                    WS-CNT-F225-WRITE.                                  16130000
           DISPLAY 'NO OF RECS WITH ERROR IN EARMARK                = ' 16140000
                    WS-L31HB-PRINT-CNT.                                 16150000
                                                                        16160000
           STOP RUN.                                                    16170000
                                                                        16180000
       900-EXIT.                                                        16190000
           EXIT.                                                        16200000
                                                                        16210000
                                                                        16220000
      ******************************************************************16230000
       9000-CONVT-AMT-WORD.                                             16240000
      ******************************************************************16250000
      *------------------------------------------------------------*    16260000
      *     OBJECTIVE  :  CONVERSION FROM AMOUNT IN DIGITS         *    16270000
      *                              INTO AMOUNT IN WORDS          *    16280000
      *------------------------------------------------------------*    16290000
            MOVE SPACES TO WF-DETAILS.                                  16300000
            MOVE ZERO   TO WS-SWITCH                                    16310000
                           WS-THO-SW                                    16320000
                           WS-CNT-SW                                    16330000
                           WS-LIT-SW                                    16340000
                           WS-TEN-SW                                    16350000
                           WS-AND-SW.                                   16360000
            MOVE 60     TO WS-PLACE-COUNTER.                            16370000
            MOVE 1      TO WF-SUB.                                      16380000
                                                                        16390000
            PERFORM B000-ROUTINE THRU B990-EXIT                         16400000
                         VARYING WS-SUB FROM 1 BY 1 UNTIL WS-SUB = 10.  16410000
                                                                        16420000
       9000-EXIT.                                                       16430000
            EXIT.                                                       16440000
                                                                        16450000
                                                                        16460000
      ******************************************************************16470000
       B000-ROUTINE SECTION.                                            16480000
      ******************************************************************16490000
       B000-GO.                                                         16500000
            IF WS-DIGIT (WS-SUB) = ZERO                                 16510000
                 IF WS-TEN-SW = ZERO                                    16520000
                    GO TO B800-MOVE-TYPE                                16530000
                 ELSE                                                   16540000
                    GO TO B010-PROCESS.                                 16550000
                                                                        16560000
            IF WS-FIRST-SUB = ZERO                                      16570000
               MOVE WS-SUB TO WS-FIRST-SUB.                             16580000
                                                                        16590000
            IF WS-SWITCH = ZERO                                         16600000
               MOVE 1 TO WS-SWITCH.                                     16610000
                                                                        16620000
       B010-PROCESS.                                                    16630000
            IF WS-SUB = 8                                               16640000
               MOVE 9 TO WS-CNT-SW.                                     16650000
                                                                        16660000
            IF WS-SUB = 9                                               16670000
               IF WS-CNT-SW = ZERO                                      16680000
                  MOVE WS-DIGIT (WS-SUB) TO WS-CNT-SW.                  16690000
                                                                        16700000
            IF WS-SUB = 2 OR 3 OR 4                                     16710000
               MOVE 1 TO WS-THO-SW.                                     16720000
                                                                        16730000
            MOVE WS-DIGIT (WS-SUB) TO WA-SUB.                           16740000
            IF WS-SUB = 3 OR 6 OR 8                                     16750000
               IF WS-DIGIT (WS-SUB) = 1                                 16760000
                  MOVE 1 TO WS-TEN-SW                                   16770000
                  GO TO B990-EXIT                                       16780000
               ELSE                                                     16790000
                  ADD 18 TO WA-SUB                                      16800000
            ELSE                                                        16810000
            IF WS-SUB = 1 OR 4 OR 7 OR 9                                16820000
               IF WS-TEN-SW = 1                                         16830000
                  MOVE 0 TO WS-TEN-SW                                   16840000
                  ADD 10 TO WA-SUB.                                     16850000
            MOVE WA-NAME (WA-SUB) TO WL-AREA.                           16860000
            PERFORM R000-LOAD-IN.                                       16870000
                                                                        16880000
       B300-TENS.                                                       16890000
            IF WS-SUB = 3 OR 6 OR 8                                     16900000
               GO TO B990-EXIT.                                         16910000
                                                                        16920000
       B400-MOVE-HUNDRED.                                               16930000
            IF WS-SUB = 2 OR 5                                          16940000
               MOVE L-HUNDRED TO WL-AREA                                16950000
               MOVE 1 TO WS-LIT-SW                                      16960000
               PERFORM R000-LOAD-IN                                     16970000
               MOVE 1 TO WS-AND-SW                                      16980000
               GO TO B990-EXIT.                                         16990000
                                                                        17000000
       B800-MOVE-TYPE.                                                  17010000
            IF WS-SWITCH = ZERO                                         17020000
               GO TO B990-EXIT.                                         17030000
                                                                        17040000
            IF WS-SUB = 1                                               17050000
               MOVE  L-MILLION TO WL-AREA                               17060000
               MOVE  1         TO WS-LIT-SW                             17070000
               MOVE  1         TO WS-AND-SW                             17080000
               GO TO B880-LOAD-IN.                                      17090000
                                                                        17100000
            IF WS-SUB = 7                                               17110000
               MOVE 1 TO WS-LIT-SW WS-AND-SW                            17120000
               IF WS-FIRST-SUB = 7  AND                                 17130000
                  WS-DIGIT (WS-SUB) = 1                                 17140000
                  MOVE L-DOLLAR TO WL-AREA                              17150000
                  GO TO B880-LOAD-IN                                    17160000
               ELSE                                                     17170000
                  MOVE L-DOLLARS TO WL-AREA                             17180000
                  GO TO B880-LOAD-IN.                                   17190000
                                                                        17200000
            IF WS-SUB = 4 AND WS-THO-SW = 1                             17210000
               MOVE 1 TO WS-AND-SW WS-LIT-SW                            17220000
               MOVE L-THOUSAND TO WL-AREA                               17230000
               GO TO B880-LOAD-IN.                                      17240000
                                                                        17250000
            IF WS-SUB = 9                                               17260000
               MOVE 1 TO WS-LIT-SW                                      17270000
               IF WS-CNT-SW = ZERO                                      17280000
                  MOVE L-ONLY TO WL-AREA                                17290000
                  GO TO B880-LOAD-IN                                    17300000
               ELSE                                                     17310000
               IF WS-CNT-SW = 1                                         17320000
                  MOVE L-CENT TO WL-AREA                                17330000
                  PERFORM R000-LOAD-IN                                  17340000
                  MOVE L-ONLY TO WL-AREA                                17350000
                  GO TO B880-LOAD-IN                                    17360000
               ELSE                                                     17370000
                  MOVE L-CENTS TO WL-AREA                               17380000
                  PERFORM R000-LOAD-IN                                  17390000
                  MOVE L-ONLY TO WL-AREA                                17400000
                  GO TO B880-LOAD-IN.                                   17410000
            GO TO B990-EXIT.                                            17420000
                                                                        17430000
       B880-LOAD-IN.                                                    17440000
            PERFORM R000-LOAD-IN.                                       17450000
                                                                        17460000
       B990-EXIT.                                                       17470000
            EXIT.                                                       17480000
                                                                        17490000
      ******************************************************************17500000
       R000-LOAD-IN SECTION.                                            17510000
      ******************************************************************17520000
      *------------------------------------------------------------*    17530000
      *     THIS SECTION LOADS THE WORDS INTO THE THREE LINES      *    17540000
      *     AND JUST KEEPS INCREMENTING A SUBSCRIPT.               *    17550000
      *------------------------------------------------------------*    17560000
                                                                        17570000
       R001-GO.                                                         17580000
            IF WS-LIT-SW = 1                                            17590000
               MOVE ZERO TO WS-LIT-SW                                   17600000
               GO TO R050-CONT.                                         17610000
                                                                        17620000
            IF WS-SUB = 2 OR 5                                          17630000
               GO TO R050-CONT.                                         17640000
                                                                        17650000
       R025-ADD-TEST.                                                   17660000
            IF WS-AND-SW NOT = 1                                        17670000
               GO TO R050-CONT.                                         17680000
                                                                        17690000
            MOVE ZERO TO WS-AND-SW.                                     17700000
            MOVE WL-AREA TO WL-AREA-SAVE.                               17710000
            MOVE L-AND TO WL-AREA.                                      17720000
            PERFORM R200-LOADUP.                                        17730000
            MOVE WL-AREA-SAVE TO WL-AREA.                               17740000
                                                                        17750000
       R050-CONT.                                                       17760000
            PERFORM R200-LOADUP.                                        17770000
                                                                        17780000
       R099-EXIT.                                                       17790000
            EXIT.                                                       17800000
                                                                        17810000
      ******************************************************************17820000
       R200-LOADUP SECTION.                                             17830000
      ******************************************************************17840000
       R201-GO.                                                         17850000
            ADD WL-ITEM1 WF-SUB GIVING WS-RESULT.                       17860000
            IF  WS-RESULT > WS-PLACE-COUNTER                            17870000
                ADD 1 WS-PLACE-COUNTER GIVING WF-SUB                    17880000
                ADD 60 TO WS-PLACE-COUNTER.                             17890000
                                                                        17900000
            PERFORM R500-LOAD VARYING WL-SUB FROM 2 BY 1 UNTIL          17910000
                    WL-ITEM (WL-SUB) = L-X.                             17920000
                                                                        17930000
       R490-EXIT.                                                       17940000
           EXIT.                                                        17950000
                                                                        17960000
      ******************************************************************17970000
       R500-LOAD SECTION.                                               17980000
      ******************************************************************17990000
       R501-GO.                                                         18000000
                                                                        18010000
            MOVE WL-ITEM (WL-SUB) TO WF-ITEM (WF-SUB).                  18020000
            ADD  1                TO WF-SUB.                            18030000
            IF WL-ITEM (WL-SUB) = SPACE                                 18040000
               ADD   1     TO     WL-SUB                                18050000
               MOVE  L-X   TO     WL-ITEM (WL-SUB)                      18060000
               SUBTRACT 1  FROM   WL-SUB.                               18070000
                                                                        18080000
       R990-EXIT.                                                       18090000
            EXIT.                                                       18100000
