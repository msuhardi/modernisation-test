      *-----------------------*                                         00010001
       IDENTIFICATION DIVISION.                                         00020001
      *-----------------------*                                         00030001
       PROGRAM-ID.    BP13C43D.                                         00040001
      *AUTHOR.        DEEPIKA NALLAM.                                   00050001
      *DATE-WRITTEN.  15/03/19.                                         00060001
                                                                        00070001
      * =============================================================*  00080001
      * SYSTEM OF COMMITMENT  (BP13)                                 *  00090001
      * =============================================================*  00100001
      *    OBJECTIVE :                                               *  00110001
      *      1. TO PRINT PAYMENT SCHEDULE FOR STAMPING OF            *  00120001
      *         DEED OF ASSIGNMENT (BP13L436J) FOR DBSS              *  00130001
      *                                                              *  00140001
      *    I/O FILES :                                               *  00150001
      *       INPUT  :  BP13F315 - TRANSACTION FILE (SEQ)            *  00160001
      *                 BP13K410                                     *  00170001
      *                 B05K006                                      *  00180001
      *      OUTPUT  :  BP13K625 - STAMP FEE MASTER (SEQ)            *  00190001
      *                 AG07F225 - STAMPING FILE    (SEQ)            *  00200001
      *                 BP13436J - STAMPING DOA FOR SOC FLAT         *  00210001
      * -------------------------------------------------------------*  00220001
      * CHG REF  DATE   BY   DESCRIPTIONS                            *  00230001
      * -------- ------ ---  ------------                            *  00240001
      * BP137668 150319 DN8  CLONE OF BP13C436 FOR STAMPING 5042686F *  00250001
      * BP138339 080820 KR13 REMOVED P13436J1 - IOM8 CONVERSION.     *  00260001
      * BP139164 040522 KV8  INCLUDED ADDRESS AND COMMENTED STREET   *  00261001
      * BP139499 130223 KAL  TO CATER FOR STAMPING 5042562B          *  00262001
      * =============================================================*  00270001
                                                                        00280001
      *----------------------*                                          00290001
       ENVIRONMENT DIVISION.                                            00300001
      *----------------------*                                          00310001
       CONFIGURATION SECTION.                                           00320001
       SOURCE-COMPUTER.   IBM-3090.                                     00330001
       OBJECT-COMPUTER.   IBM-3090.                                     00340001
                                                                        00350001
       INPUT-OUTPUT SECTION.                                            00360001
       FILE-CONTROL.                                                    00370001
                                                                        00380001
           SELECT B05K006   ASSIGN       TO B05K006                     00390001
                            ACCESS MODE  IS RANDOM                      00400001
                            ORGANIZATION IS INDEXED                     00410001
                            RECORD KEY   IS K006-HDB-REF-SF             00420001
                            FILE STATUS  IS WS-K006-STATUS.             00430001
                                                                        00440001
           SELECT BP13K410  ASSIGN       TO BP13K410                    00450001
                            ACCESS MODE  IS RANDOM                      00460001
                            ORGANIZATION IS INDEXED                     00470001
                            RECORD KEY   IS K410-KEY-FLD                00480001
                            FILE STATUS  IS WS-K410-STATUS.             00490001
                                                                        00500001
           SELECT BP13K625  ASSIGN       TO BP13K625                    00510001
                            ACCESS MODE  IS DYNAMIC                     00520001
                            ORGANIZATION IS INDEXED                     00530001
                            RECORD KEY   IS K625-KEY-FLD                00540001
                            FILE STATUS  IS WS-K625-STATUS.             00550001
                                                                        00560001
           SELECT BP13F315  ASSIGN       TO BP13F315.                   00570001
           SELECT AG07F225  ASSIGN       TO AG07F225.                   00580001
                                                                        00590001
           SELECT BP13436J  ASSIGN       TO BP13436J.                   00600001
           SELECT BP13436K  ASSIGN       TO BP13436K.                   00610001
           SELECT BP13436L  ASSIGN       TO BP13436L.                   00620001
                                                                        00630001
      *---------------*                                                 00640001
       DATA DIVISION.                                                   00650001
      *---------------*                                                 00660001
       FILE SECTION.                                                    00670001
      *---------------*                                                 00680001
                                                                        00690001
       FD   B05K006.                                                    00700001
       COPY B05K006.                                                    00710001
                                                                        00720001
       FD   BP13K410                                                    00730001
            RECORD CONTAINS 2000 CHARACTERS.                            00740001
       COPY BP13K410.                                                   00750001
                                                                        00760001
       FD   BP13K625                                                    00770001
            RECORD CONTAINS 500  CHARACTERS.                            00780001
       COPY BP13K625.                                                   00790001
                                                                        00800001
       FD   BP13F315                                                    00810001
            BLOCK  CONTAINS 0    RECORDS                                00820001
            RECORD CONTAINS 500  CHARACTERS                             00830001
            LABEL  RECORDS  ARE  STANDARD                               00840001
            RECORDING MODE  IS   F.                                     00850001
       COPY BP13F315.                                                   00860001
                                                                        00870001
       FD   AG07F225                                                    00880001
            RECORDING MODE  IS  F                                       00890001
            RECORD CONTAINS 600 CHARACTERS.                             00900001
       COPY AG07F225.                                                   00910001
                                                                        00920001
      *---------------------------------------                          00930001
      * LISTING FOR STAMPING DOA FOR SOC FLAT                           00940001
      *---------------------------------------                          00950001
       FD   BP13436J                                                    00960001
            RECORD CONTAINS 132 CHARACTERS                              00970001
            LABEL  RECORDS  ARE OMITTED                                 00980001
            RECORDING MODE  IS  F.                                      00990001
       01   L436J-PRINT-REC          PIC X(132).                        01000001
                                                                        01010001
       FD   BP13436K                                                    01020001
            RECORD CONTAINS 132 CHARACTERS                              01030001
            LABEL  RECORDS  ARE OMITTED                                 01040001
            RECORDING MODE  IS  F.                                      01050001
       01   L436K-PRINT-REC          PIC X(132).                        01060001
                                                                        01070001
       FD   BP13436L                                                    01080001
            RECORD CONTAINS 132 CHARACTERS                              01090001
            LABEL  RECORDS  ARE OMITTED                                 01100001
            RECORDING MODE  IS  F.                                      01110001
       01   L436L-PRINT-REC          PIC X(132).                        01120001
                                                                        01130001
      *------------------------*                                        01140001
       WORKING-STORAGE SECTION.                                         01150001
      *------------------------*                                        01160001
      *-----------------------------------------------------------*     01170001
      *    DEFINE HEADING LINES                                   *     01180001
      *-----------------------------------------------------------*     01190001
       01  PRT-L436-HDG-1.                                              01200001
           05  L436-REPORT-ID       PIC X(8)  VALUE SPACES.             01210001
           05  FILLER               PIC X(10) VALUE '      HDB3'.       01220001
           05  FILLER               PIC X(27) VALUE SPACES.             01230001
           05  FILLER               PIC X(39) VALUE                     01240001
               'S Y S T E M   O F   C O M M I T M E N T'.               01250001
           05  FILLER               PIC X(14) VALUE SPACES.             01260001
           05  FILLER               PIC X(7)  VALUE 'DATE : '.          01270001
           05  L436-CURRENT-DATE    PIC X(10) VALUE SPACES.             01280001
           05  FILLER               PIC X(4)  VALUE SPACES.             01290001
           05  FILLER               PIC X(7)  VALUE 'PAGE : '.          01300001
           05  L436-PAGE            PIC ZZZZ9.                          01310001
                                                                        01320001
       01  PRT-L436-HDG-2.                                              01330001
           05  FILLER               PIC X(30) VALUE                     01340001
               'HOUSING AND DEVELOPMENT BOARD'.                         01350001
           05  FILLER               PIC X(20) VALUE SPACES.             01360001
           05  FILLER               PIC X(30) VALUE                     01370001
               'P A Y M E N T    V O U C H E R'.                        01380001
           05  FILLER               PIC X(25) VALUE SPACES.             01390001
           05  L436-COPY-NAME       PIC X(20) VALUE SPACES.             01400001
                                                                        01410001
       01  PRT-L436-HDG-3.                                              01420001
           05  L436-REPORT-ID-DESC  PIC X(132).                         01430001
                                                                        01440001
       01  PRT-L436L-HDG-3.                                             01450001
           05  L436L-REPORT-ID-DESC  PIC X(132).                        01460001
                                                                        01470001
       01  PRT-L436-HDG-4.                                              01480001
           05  FILLER               PIC X(46) VALUE SPACES.             01490001
           05  FILLER               PIC X(85) VALUE ALL '-'.            01500001
                                                                        01510001
       01  PRT-L436-HDG-5.                                              01520001
           05  FILLER               PIC X(46) VALUE                     01530001
               'SALES UNIT (AGREEMENT TEAM)'.                           01540001
           05  FILLER               PIC X(1)  VALUE '¦'.                01550001
           05  FILLER               PIC X(27) VALUE                     01560001
               ' FOR FINANCE DEPARTMENT USE'.                           01570001
           05  FILLER               PIC X(21) VALUE SPACES.             01580001
           05  FILLER               PIC X(17) VALUE                     01590001
               '¦  BATCH NO    : '.                                     01600001
           05  L436-BATCH-NO        PIC X(14) VALUE SPACES.             01610001
           05  FILLER               PIC X(4)  VALUE SPACES.             01620001
           05  FILLER               PIC X(1)  VALUE '¦'.                01630001
                                                                        01640001
       01  PRT-L436-HDG-6.                                              01650001
           05  FILLER               PIC X(46) VALUE SPACES.             01660001
           05  FILLER               PIC X(1)  VALUE '¦'.                01670001
           05  FILLER               PIC X(48) VALUE SPACES.             01680001
           05  FILLER               PIC X(1)  VALUE '¦'.                01690001
           05  FILLER               PIC X(34) VALUE SPACES.             01700001
           05  FILLER               PIC X(1)  VALUE '¦'.                01710001
                                                                        01720001
       01  PRT-L436-HDG-7.                                              01730001
           05  FILLER               PIC X(46) VALUE 'SYSTEM CODE : 04'. 01740001
           05  FILLER               PIC X(14) VALUE '¦ CHECKED BY :'.   01750001
           05  FILLER               PIC X(35) VALUE SPACES.             01760001
           05  FILLER               PIC X(17) VALUE '¦  VOUCHER NO  :'. 01770001
           05  L436-VOUCHER-NO      PIC X(14) VALUE SPACES.             01780001
           05  FILLER               PIC X(4)  VALUE SPACES.             01790001
           05  FILLER               PIC X(1)  VALUE '¦'.                01800001
                                                                        01810001
       01  PRT-L436-HDG-8.                                              01820001
           05  FILLER               PIC X(46) VALUE                     01830001
              'GL CODE     : 0000000104250'.                            01840001
           05  FILLER               PIC X(85) VALUE ALL '-'.            01850001
                                                                        01860001
       01  PRT-L436-HDG-9.                                              01870001
           05  FILLER               PIC X(46) VALUE                     01880001
              'DESCRIPTION : STAMP FEES'.                               01890001
                                                                        01900001
       01  PRT-L436L-HDG-9.                                             01910001
           05  FILLER               PIC X(46) VALUE                     01920001
              'DESCRIPTION : LEASE PREPARATION FEES'.                   01930001
                                                                        01940001
       01  PRT-L436-HDG-10.                                             01950001
           05  FILLER               PIC X(53)   VALUE                   01960001
              'PAYABLE TO  : COMMISSIONER OF STAMP DUTIES         '.    01970001
           05  FILLER               PIC X(13)   VALUE  SPACES.          01980001
           05  FILLER               PIC X(20)   VALUE                   01990001
              'BANK   : DBS        '.                                   02000001
           05  FILLER               PIC X(11)   VALUE  SPACES.          02010001
           05  FILLER               PIC X(25)   VALUE                   02020001
              'BANK CODE   : DBSSSGSGXXX'.                              02030001
                                                                        02040001
       01  PRT-L436L-HDG-10.                                            02050001
           05  FILLER               PIC X(14)   VALUE  'PAYABLE TO  : '.02060001
           05  PRT-SOL-NAME         PIC X(66)   VALUE  SPACES.          02070001
           05  FILLER               PIC X(52)   VALUE  SPACES.          02080001
                                                                        02090001
       01  PRT-L436-HDG-10A.                                            02100001
           05  FILLER               PIC X(24)   VALUE                   02110001
              'A/C NO      : 0010468600'.                               02120001
           05  FILLER               PIC X(42)   VALUE  SPACES.          02130001
                                                                        02140001
       01  PRT-L436-HDG-11.                                             02150001
           05  FILLER               PIC X(11)   VALUE                   02160001
               'REMITTANCE '.                                           02170001
           05  FILLER               PIC X(55)   VALUE                   02180001
              'ADVICE  DESPATCH TO :  C/O SC(STAMPING) OF SALES UNIT'.  02190001
                                                                        02200001
       01  PRT-L436L-HDG-11.                                            02210001
           05  FILLER               PIC X(7)   VALUE                    02220001
               'CHEQUE '.                                               02230001
           05  FILLER               PIC X(55)   VALUE                   02240001
              'DESPATCH TO :  C/O MR BALA(STAMPING) OF SALES OPERATION'.02250001
           05  FILLER               PIC X(55)   VALUE SPACES.           02260001
           05  FILLER               PIC X(15)   VALUE 'TEL : 64903781'. 02270001
                                                                        02280001
      *-----------------------------------------------------------*     02290001
      *    DEFINE BP13L436A & BP13L436D SUB-HEADING LINES         *     02300001
      *-----------------------------------------------------------*     02310001
       01  PRT-L436-SUBHDG-1.                                           02320001
           05  FILLER               PIC X(69) VALUE SPACES.             02330001
           05  FILLER               PIC X(19) VALUE                     02340001
               'DATE OF    MORTGAGE'.                                   02350001
           05  FILLER               PIC X(4)  VALUE SPACES.             02360001
           05  FILLER               PIC X(7)  VALUE 'DUP'.              02370001
           05  L436-SUP-LEASE-DESC  PIC X(10) VALUE SPACES.             02380001
           05  FILLER               PIC X(2)  VALUE SPACES.             02390001
                                                                        02400001
       01  PRT-L436L-SUBHDG-1.                                          02410001
           05  FILLER               PIC X(89) VALUE SPACES.             02420001
           05  FILLER               PIC X(23) VALUE                     02430001
               'DATE OF        LEASE   '.                               02440001
                                                                        02450001
       01  PRT-L436L-SUBHDG-1A.                                         02460001
           05  FILLER               PIC X(22) VALUE SPACES.             02470001
           05  FILLER               PIC X(17) VALUE 'ATRIUM 4TH STOREY'.02480001
           05  FILLER               PIC X(17) VALUE ' SINGAPORE 310480'.02490001
                                                                        02500001
       01  PRT-L436-SUBHDG-2.                                           02510001
           05  FILLER               PIC X(4)  VALUE 'S/NO'.             02520001
           05  FILLER               PIC X     VALUE SPACE.              02530001
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.       02540001
           05  FILLER               PIC X(5)  VALUE SPACES.             02550001
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.          02560001
           05  FILLER               PIC X     VALUE SPACE.              02570001
           05  FILLER               PIC X(5)  VALUE 'BLOCK'.            02580001
           05  FILLER               PIC X     VALUE SPACE.              02590001
           05  FILLER               PIC X(25) VALUE                     02600001
               'FLAT ADDRESS/STREET NAME'.                              02610001
           05  FILLER               PIC X(1)  VALUE SPACE.              02620001
           05  FILLER               PIC X(8)  VALUE 'FLAT NO'.          02630001
           05  FILLER               PIC X(9)  VALUE '  S&P    '.        02640001
           05  FILLER               PIC X(2)  VALUE SPACES.             02650001
           05  FILLER               PIC X(9)  VALUE 'STAMP FEE'.        02660001
           05  FILLER               PIC X(3)  VALUE SPACES.             02670001
           05  FILLER               PIC X(3)  VALUE 'DOA'.              02680001
           05  FILLER               PIC X(4)  VALUE SPACES.             02690001
           05  FILLER               PIC X(9)  VALUE 'STAMP FEE'.        02700001
           05  FILLER               PIC X(5)  VALUE SPACES.             02710001
           05  L436-TAG-DESC        PIC X(3)  VALUE '   '.              02720001
           05  FILLER               PIC X(6)  VALUE SPACES.             02730001
           05  FILLER               PIC X(5)  VALUE 'TOTAL'.            02740001
                                                                        02750001
       01  PRT-L436L-SUBHDG-2.                                          02760001
           05  FILLER               PIC X(4)  VALUE 'S/NO'.             02770001
           05  FILLER               PIC X(5)  VALUE SPACE.              02780001
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.       02790001
           05  FILLER               PIC X(9)  VALUE SPACES.             02800001
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.          02810001
           05  FILLER               PIC X(4)  VALUE SPACE.              02820001
           05  FILLER               PIC X(5)  VALUE 'BLOCK'.            02830001
           05  FILLER               PIC X(3)  VALUE SPACE.              02840001
           05  FILLER               PIC X(25) VALUE                     02850001
               'FLAT ADDRESS/STREET NAME'.                              02860001
           05  FILLER               PIC X(5)  VALUE SPACE.              02870001
           05  FILLER               PIC X(8)  VALUE 'FLAT NO'.          02880001
           05  FILLER               PIC X(12) VALUE '     S&P    '.     02890001
           05  FILLER               PIC X(6)  VALUE SPACES.             02900001
           05  FILLER               PIC X(9)  VALUE 'STAMP FEE'.        02910001
           05  FILLER               PIC X(13) VALUE SPACES.             02920001
           05  FILLER               PIC X(5)  VALUE 'TOTAL'.            02930001
                                                                        02940001
       01  PRT-L436-SUBHDG-3.                                           02950001
           05  FILLER               PIC X(4)  VALUE ALL '-'.            02960001
           05  FILLER               PIC X     VALUE SPACES.             02970001
           05  FILLER               PIC X(14) VALUE ALL '-'.            02980001
           05  FILLER               PIC X     VALUE SPACES.             02990001
           05  FILLER               PIC X(8)  VALUE ALL '-'.            03000001
           05  FILLER               PIC X     VALUE SPACES.             03010001
           05  FILLER               PIC X(5)  VALUE ALL '-'.            03020001
           05  FILLER               PIC X     VALUE SPACES.             03030001
           05  FILLER               PIC X(25) VALUE ALL '-'.            03040001
           05  FILLER               PIC X(1)  VALUE SPACES.             03050001
           05  FILLER               PIC X(7)  VALUE ALL '-'.            03060001
           05  FILLER               PIC X(1)  VALUE SPACES.             03070001
           05  FILLER               PIC X(9)  VALUE ALL '-'.            03080001
           05  FILLER               PIC X(2)  VALUE SPACES.             03090001
           05  FILLER               PIC X(10) VALUE ALL '-'.            03100001
           05  FILLER               PIC X(2)  VALUE SPACES.             03110001
           05  FILLER               PIC X(5)  VALUE ALL '-'.            03120001
           05  FILLER               PIC X(2)  VALUE SPACES.             03130001
           05  FILLER               PIC X(10) VALUE ALL '-'.            03140001
           05  FILLER               PIC X(2)  VALUE SPACES.             03150001
           05  FILLER               PIC X(2)  VALUE SPACES.             03160001
           05  FILLER               PIC X(14) VALUE ALL '-'.            03170001
                                                                        03180001
       01  PRT-L436L-SUBHDG-3.                                          03190001
           05  FILLER               PIC X(4)  VALUE ALL '-'.            03200001
           05  FILLER               PIC X(4)  VALUE SPACES.             03210001
           05  FILLER               PIC X(14) VALUE ALL '-'.            03220001
           05  FILLER               PIC X(6)  VALUE SPACES.             03230001
           05  FILLER               PIC X(8)  VALUE ALL '-'.            03240001
           05  FILLER               PIC X(4)  VALUE SPACES.             03250001
           05  FILLER               PIC X(5)  VALUE ALL '-'.            03260001
           05  FILLER               PIC X(3)  VALUE SPACES.             03270001
           05  FILLER               PIC X(25) VALUE ALL '-'.            03280001
           05  FILLER               PIC X(5)  VALUE SPACES.             03290001
           05  FILLER               PIC X(7)  VALUE ALL '-'.            03300001
           05  FILLER               PIC X(3)  VALUE SPACES.             03310001
           05  FILLER               PIC X(9)  VALUE ALL '-'.            03320001
           05  FILLER               PIC X(7)  VALUE SPACES.             03330001
           05  FILLER               PIC X(10) VALUE ALL '-'.            03340001
           05  FILLER               PIC X(3)  VALUE SPACES.             03350001
           05  FILLER               PIC X(14) VALUE ALL '-'.            03360001
                                                                        03370001
      *-----------------------------------------------------------*     03380001
      *    DEFINE BP13L436A & BP13L436D DETAIL LINES              *     03390001
      *-----------------------------------------------------------*     03400001
       01  L436-REC-DETAIL.                                             03410001
           05  L436-SERIAL-NO               PIC ZZZ9.                   03420001
           05  FILLER                       PIC X     VALUE SPACE.      03430001
           05  L436-SCH-ACC                 PIC X(14) VALUE SPACES.     03440001
           05  FILLER                       PIC X     VALUE SPACE.      03450001
           05  L436-REGN-NO                 PIC X(8)  VALUE SPACES.     03460001
           05  FILLER                       PIC X     VALUE SPACE.      03470001
           05  L436-BLKNO                   PIC X(5)  VALUE SPACES.     03480001
           05  FILLER                       PIC X     VALUE SPACE.      03490001
           05  L436-STREET                  PIC X(25) VALUE SPACES.     03500001
           05  FILLER                       PIC X     VALUE SPACE.      03510001
           05  L436-FLATNO                  PIC X(7)  VALUE SPACES.     03520001
           05  FILLER                       PIC X     VALUE SPACE.      03530001
           05  L436-SALE-DD                 PIC X(2)  VALUE SPACES.     03540001
           05  L436-DASH1                   PIC X     VALUE SPACE.      03550001
           05  L436-SALE-MM                 PIC X(2)  VALUE SPACES.     03560001
           05  L436-DASH2                   PIC X     VALUE SPACE.      03570001
           05  L436-SALE-CC                 PIC X(2)  VALUE SPACES.     03580001
           05  L436-SALE-YY                 PIC X(2)  VALUE SPACES.     03590001
           05  FILLER                       PIC X(1)  VALUE SPACES.     03600001
           05  L436-MORT-SF                 PIC $$$,$$9.99.             03610001
           05  FILLER                       PIC X(2)  VALUE SPACES.     03620001
           05  L436-DUP-DOA                 PIC $9.99.                  03630001
           05  FILLER                       PIC X(2)  VALUE SPACES.     03640001
           05  L436-SUP-LEASE-STAMP         PIC $$$,$$9.99.             03650001
           05  FILLER                       PIC X(2)  VALUE SPACES.     03660001
           05  FILLER                       PIC X(2)  VALUE SPACES.     03670001
           05  L436-TAG                     PIC X.                      03680001
           05  FILLER                       PIC X(2)  VALUE SPACES.     03690001
           05  L436-DETL-AMT-TOTAL          PIC $$$$,$$9.99.            03700001
                                                                        03710001
       01  L436L-REC-DETAIL.                                            03720001
           05  L436L-SERIAL-NO               PIC ZZZ9.                  03730001
           05  FILLER                        PIC X(4)  VALUE SPACE.     03740001
           05  L436L-SCH-ACC                 PIC X(14) VALUE SPACES.    03750001
           05  FILLER                        PIC X(6)  VALUE SPACE.     03760001
           05  L436L-REGN-NO                 PIC X(8)  VALUE SPACES.    03770001
           05  FILLER                        PIC X(4)  VALUE SPACE.     03780001
           05  L436L-BLKNO                   PIC X(5)  VALUE SPACES.    03790001
           05  FILLER                        PIC X(3)  VALUE SPACE.     03800001
           05  L436L-STREET                  PIC X(25) VALUE SPACES.    03810001
           05  FILLER                        PIC X(5)  VALUE SPACE.     03820001
           05  L436L-FLATNO                  PIC X(7)  VALUE SPACES.    03830001
           05  FILLER                        PIC X(3)  VALUE SPACE.     03840001
           05  L436L-SALE-DD                 PIC X(2)  VALUE SPACES.    03850001
           05  L436L-DASH1                   PIC X     VALUE SPACE.     03860001
           05  L436L-SALE-MM                 PIC X(2)  VALUE SPACES.    03870001
           05  L436L-DASH2                   PIC X     VALUE SPACE.     03880001
           05  L436L-SALE-CC                 PIC X(2)  VALUE SPACES.    03890001
           05  L436L-SALE-YY                 PIC X(2)  VALUE SPACES.    03900001
           05  FILLER                        PIC X(3)  VALUE SPACES.    03910001
           05  L436L-LEASE-STAMP             PIC $$$,$$9.99.            03920001
           05  FILLER                        PIC X(6)  VALUE SPACES.    03930001
           05  FILLER                        PIC X(3)  VALUE SPACES.    03940001
           05  L436L-DETL-AMT-TOTAL          PIC $$$$,$$9.99.           03950001
                                                                        03960001
      *-----------------------------------------------------------*     03970001
      *    DEFINE BP13L436A & BP13L436D TOTAL LINES               *     03980001
      *-----------------------------------------------------------*     03990001
       01  PRT-L436-DASH-LINE.                                          04000001
           05  FILLER                       PIC X(78)   VALUE SPACES.   04010001
           05  FILLER                       PIC X(54)   VALUE ALL '='.  04020001
                                                                        04030001
       01  PRT-L436-TOTAL-LINE.                                         04040001
           05  FILLER                       PIC X(35) VALUE SPACES.     04050001
           05  FILLER                       PIC X(13) VALUE             04060001
               'SERIAL NO : ('.                                         04070001
           05  L436-VR-NO-LOW               PIC X(4)  VALUE '0001'.     04080001
           05  FILLER                       PIC X(4)  VALUE ' TO '.     04090001
           05  L436-VR-NO-HIGH              PIC X(4)  VALUE '0025'.     04100001
           05  FILLER                       PIC X(4)  VALUE ')'.        04110001
           05  FILLER                       PIC X(14) VALUE 'TOTAL :'.  04120001
           05  L436-TOTAL-MORT-SF           PIC $,$$$,$$9.99.           04130001
           05  FILLER                       PIC X(1)  VALUE SPACES.     04140001
           05  L436-TOTAL-DUP-DOA           PIC $$9.99.                 04150001
           05  L436-TOTAL-SUP-LEASE-SF      PIC $,$$$,$$9.99.           04160001
           05  FILLER                       PIC X(2)  VALUE SPACES.     04170001
           05  FILLER                       PIC X(4)  VALUE SPACES.     04180001
           05  L436-TOTAL-AMT               PIC $,$$$,$$9.99.           04190001
                                                                        04200001
       01  PRT-L436L-TOTAL-LINE.                                        04210001
           05  FILLER                       PIC X(35) VALUE SPACES.     04220001
           05  FILLER                       PIC X(13) VALUE             04230001
               'SERIAL NO : ('.                                         04240001
           05  L436L-VR-NO-LOW               PIC X(4)  VALUE '0001'.    04250001
           05  FILLER                       PIC X(4)  VALUE ' TO '.     04260001
           05  L436L-VR-NO-HIGH              PIC X(4)  VALUE '0025'.    04270001
           05  FILLER                       PIC X(4)  VALUE ')'.        04280001
           05  FILLER                       PIC X(14) VALUE 'TOTAL :'.  04290001
           05  FILLER                       PIC X(21) VALUE SPACES.     04300001
           05  L436L-TOTAL-SUP-LEASE-SF      PIC $,$$$,$$9.99.          04310001
           05  FILLER                       PIC X(4)  VALUE SPACES.     04320001
           05  FILLER                       PIC X(4)  VALUE SPACES.     04330001
           05  L436L-TOTAL-AMT              PIC $,$$$,$$9.99.           04340001
                                                                        04350001
      *-----------------------------------------------------------*     04360001
      *    DEFINE FOOTING LINES                                   *     04370001
      *-----------------------------------------------------------*     04380001
       01  PRT-L436-FTG-1.                                              04390001
           05  FILLER              PIC X(15)   VALUE 'NET PAYABLE  : '. 04400001
           05  L436-AMT-WORDS.                                          04410001
               10  L436-AMT-DESC1  PIC X(60)   VALUE SPACES.            04420001
               10  L436-AMT-DESC2  PIC X(60)   VALUE SPACES.            04430001
                                                                        04440001
       01  PRT-L436-FTG-2.                                              04450001
           05  FILLER              PIC X(35)   VALUE SPACES.            04460001
           05  FILLER              PIC X(14)   VALUE 'CHECKED BY :'.    04470001
           05  FILLER              PIC X(15)   VALUE ALL '_'.           04480001
           05  FILLER              PIC X(10)   VALUE SPACES.            04490001
           05  FILLER              PIC X(16)   VALUE 'CERTIFIED BY :'.  04500001
           05  FILLER              PIC X(15)   VALUE ALL '_'.           04510001
                                                                        04520001
      *-----------------------------------------------------------*     04530001
      *    DEFINE BP13L436  HEADING LINES                         *     04540001
      *-----------------------------------------------------------*     04550001
       01  MAIN-HEADER.                                                 04560001
           05  HEADER-LISTID             PIC X(8)  VALUE SPACES.        04570001
           05  FILLER                    PIC X(16) VALUE SPACES.        04580001
           05  FILLER                    PIC X(4)  VALUE 'HDB3'.        04590001
           05  FILLER                    PIC X(16) VALUE SPACES.        04600001
           05  FILLER                    PIC X(39) VALUE                04610001
               'S Y S T E M   O F   C O M M I T M E N T'.               04620001
           05  FILLER                    PIC X(16) VALUE SPACES.        04630001
           05  FILLER                    PIC X(7)  VALUE 'DATE : '.     04640001
           05  HEADER-DATE               PIC X(10).                     04650001
           05  FILLER                    PIC X(4)  VALUE SPACES.        04660001
           05  FILLER                    PIC X(7)  VALUE 'PAGE : '.     04670001
           05  HEADER-PAGE               PIC ZZZZ9.                     04680001
                                                                        04690001
      *-----------------------------------------------------------*     04700001
      *    DEFINE BP13436K REPORT LINES                           *     04710001
      *-----------------------------------------------------------*     04720001
       01  L436K-HEADER2.                                               04730001
           05  FILLER                    PIC X(47) VALUE SPACES.        04740001
           05  FILLER                    PIC X(35)  VALUE               04750001
               'REPORT ON CASES WITH EARMARK ERROR'.                    04760001
                                                                        04770001
       01  L436K-HEADER3.                                               04780001
           05  FILLER               PIC X(4)  VALUE 'S/NO'.             04790001
           05  FILLER               PIC X(3)  VALUE SPACE.              04800001
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.       04810001
           05  FILLER               PIC X(9)  VALUE SPACES.             04820001
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.          04830001
           05  FILLER               PIC X(5)  VALUE SPACE.              04840001
           05  FILLER               PIC X(13) VALUE 'JR VOUCHER NO'.    04850001
           05  FILLER               PIC X(5)  VALUE SPACES.             04860001
           05  FILLER               PIC X(12) VALUE 'TOTAL AMOUNT'.     04870001
           05  FILLER               PIC X(4)  VALUE SPACES.             04880001
           05  FILLER               PIC X(17) VALUE 'ERROR DESCRIPTION'.04890001
                                                                        04900001
       01  L436K-REC-DETAIL.                                            04910001
           05  L436K-SERIAL-NO              PIC ZZZ9.                   04920001
           05  FILLER                       PIC X(3)  VALUE SPACE.      04930001
           05  L436K-SCH-ACC                PIC X(14) VALUE SPACES.     04940001
           05  FILLER                       PIC X(5)  VALUE SPACE.      04950001
           05  L436K-REGN-NO                PIC X(8)  VALUE SPACES.     04960001
           05  FILLER                       PIC X(5)  VALUE SPACE.      04970001
           05  L436K-JR-VCHR-NO             PIC X(13) VALUE SPACES.     04980001
           05  FILLER                       PIC X(5)  VALUE SPACES.     04990001
           05  L436K-AMT-TOTAL              PIC $$$$,$$9.99.            05000001
           05  FILLER                       PIC X(5)  VALUE SPACES.     05010001
           05  L436K-ERROR-DESC             PIC X(30).                  05020001
                                                                        05030001
       01  L436K-UNDERLINE                  PIC X(132) VALUE ALL '-'.   05040001
                                                                        05050001
      *-----------------------------------------------------------*     05060001
      *    DEFINE ERROR MESSAGE FORMAT                            *     05070001
      *-----------------------------------------------------------*     05080001
       01  WS-ERRMSG-HEADER.                                            05090001
           05  FILLER                       PIC X(46) VALUE             05100001
               ' *************   ERROR MESSAGE   *************'.        05110001
                                                                        05120001
       01  WS-ERROR.                                                    05130001
           05  FILLER                       PIC X(24) VALUE             05140001
               ' ERROR ENCOUNTERED WHEN '.                              05150001
           05  WS-CUR-PROC                  PIC X(21).                  05160001
                                                                        05170001
       01  WS-FILE-STATUS.                                              05180001
           05  FILLER                       PIC X(15) VALUE             05190001
               ' STATUS CODE = '.                                       05200001
           05  WS-CUR-STATUS                PIC X(2).                   05210001
                                                                        05220001
      *-----------------------------------------------------------*     05230001
      *    DEFINE SUMMARY FORMAT                                  *     05240001
      *-----------------------------------------------------------*     05250001
       01  WS-SUMMARY-HEADER.                                           05260001
           05  FILLER                       PIC X     VALUE SPACES.     05270001
           05  FILLER                       PIC X(16) VALUE ALL '*'.    05280001
           05  FILLER                       PIC X(20) VALUE             05290001
               'BP13C436 SUMMARY RPT'.                                  05300001
           05  FILLER                       PIC X(19) VALUE ALL '*'.    05310001
                                                                        05320001
       01  WS-READ-CASES.                                               05330001
           05  FILLER                       PIC X(52) VALUE             05340001
               ' NO OF RECORDS READ FROM TRANS FILE  (BP13F315) = '.    05350001
           05  WS-EDIT-BP13F315-READ        PIC ZZZ9.                   05360001
                                                                        05370001
       01  WS-DOA-PAYMENT-PRINTED.                                      05380001
           05  FILLER                       PIC X(52) VALUE             05390001
               ' NO OF DOA PAYMENTS   (BP13L436A)               = '.    05400001
           05  WS-EDIT-L436A-PRINT          PIC ZZZ9.                   05410001
                                                                        05420001
       01  WS-L436J-PRINTED.                                            05430001
           05  FILLER                       PIC X(52) VALUE             05440001
               ' NO OF                (BP13L436J)               = '.    05450001
           05  WS-EDIT-L436J-PRINT          PIC ZZZ9.                   05460001
                                                                        05470001
       01  WS-STAMP-FEES-REC-WRITTEN.                                   05480001
           05  FILLER                       PIC X(52) VALUE             05490001
               ' NO OF RECORDS WRITTEN TO STAMP FILE (AG07F225) = '.    05500001
           05  WS-EDIT-AG07F225-WRITE       PIC ZZZ9.                   05510001
                                                                        05520001
       01  WS-SUMMARY-TRAILER.                                          05530001
           05  FILLER                       PIC X     VALUE SPACES.     05540001
           05  FILLER                       PIC X(55) VALUE ALL '*'.    05550001
                                                                        05560001
      *-----------------------------------------------------------*     05570001
      *    CONSTANTS LIST                                         *     05580001
      *-----------------------------------------------------------*     05590001
       01  WS-ERROR-PROCEDURE-NAMES.                                    05600001
           05  CLOSE-K006                   PIC X(21) VALUE             05610001
                   'CLOSING FILE  B05K006'.                             05620001
           05  CLOSE-K625                   PIC X(21) VALUE             05630001
                   'CLOSING FILE BP13K625'.                             05640001
           05  NOTFND-IN-FIS                PIC X(23) VALUE             05650001
                   'REC NOT FOUND IN K315'.                             05660001
           05  NOTFND-IN-MST                PIC X(23) VALUE             05670001
                   'REC NOT FOUND IN K006'.                             05680001
           05  OPEN-K006                    PIC X(21) VALUE             05690001
                   'OPENING FILE  B05K006'.                             05700001
           05  OPEN-K410                    PIC X(21) VALUE             05710001
                   'OPENING FILE BP13K410'.                             05720001
           05  OPEN-K625                    PIC X(21) VALUE             05730001
                   'OPENING FILE BP13K625'.                             05740001
           05  READ-F315                    PIC X(21) VALUE             05750001
                   'READING FILE BP13F315'.                             05760001
           05  WRITE-K625                   PIC X(21) VALUE             05770001
                   'WRITING FILE BP13K625'.                             05780001
           05  READ-K006                    PIC X(21) VALUE             05790001
                   'READING FILE  B05K006'.                             05800001
           05  READ-K625                    PIC X(21) VALUE             05810001
                   'READING FILE BP13K625'.                             05820001
                                                                        05830001
       01  DUP-DOA-AMT                      PIC 9V99  VALUE 0.          05840001
       01  DUP-SA-AMT                       PIC 9V99  VALUE 0.          05850001
       01  HYPHEN                           PIC X     VALUE '-'.        05860001
       01  MAX-REC-PER-PAGE                 PIC 9(2)  VALUE 39.         05870001
       01  MAX-DETLS-PER-PAGE               PIC 9(3)  VALUE 25.         05880001
                                                                        05890001
      *-----------------------------------------------------------*     05900001
      *    LEVEL-88 VARIABLES                                     *     05910001
      *-----------------------------------------------------------*     05920001
       01  WS-EOF                           PIC X     VALUE 'N'.        05930001
           88  END-OF-BP13F315                        VALUE 'Y'.        05940001
       01  WS-REPORT-ID-SW                  PIC X(1)  VALUE SPACE.      05950001
       01  WS-PREV-REPORT-ID                PIC X(1)  VALUE SPACE.      05960001
           88  REPORT-L436J                           VALUE 'J'.        05970001
                                                                        05980001
      *-----------------------------------------------------------*     05990001
      *    OTHER VARIABLES                                        *     06000001
      *-----------------------------------------------------------*     06010001
       01  WS-COUNTERS.                                                 06020001
           05  WS-AG07-STATUS               PIC 9(2)    VALUE ZEROS.    06030001
           05  WS-AG07-STAT-X REDEFINES WS-AG07-STATUS PIC X(2).        06040001
           05  WS-BP13F315-READ-CNT         PIC 9(4)    VALUE ZEROS.    06050001
           05  WS-BP13K625-WRITE-CNT        PIC 9(4)    VALUE ZEROES.   06060001
           05  WS-AG07F225-WRITE-CNT        PIC 9(4)    VALUE ZEROES.   06070001
      *    -----------------------                                      06080001
      *    FOR L436J -     LISTING                                      06090001
      *    -----------------------                                      06100001
           05  WS-L436J-PRINT-CNT           PIC 9(4)    VALUE ZEROS.    06110001
           05  WS-L436J-PAGE-CNT            PIC 9(5)    VALUE ZEROS.    06120001
           05  WS-L436J-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.       06130001
           05  WS-L436J-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.    06140001
           05  WS-L436J-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.    06150001
           05  WS-L436J-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.    06160001
           05  WS-L436J-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.    06170001
                                                                        06180001
      *    -----------------------                                      06190001
      *    FOR L436L -     LISTING                                      06200001
      *    -----------------------                                      06210001
           05  WS-L436L-PRINT-CNT           PIC 9(4)    VALUE ZEROS.    06220001
           05  WS-L436L-PAGE-CNT            PIC 9(5)    VALUE ZEROS.    06230001
           05  WS-L436L-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.       06240001
           05  WS-L436L-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.    06250001
           05  WS-L436L-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.    06260001
                                                                        06270001
      *    --------------------------                                   06280001
      *    FOR L436K - ERROR LISTING                                    06290001
      *    --------------------------                                   06300001
           05  WS-L436K-PRINT-CNT           PIC 9(4)    VALUE ZEROS.    06310001
           05  WS-L436K-PAGE-CNT            PIC 9(5)    VALUE ZEROS.    06320001
           05  WS-L436K-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.       06330001
                                                                        06340001
       01  WS-FLATNO.                                                   06350001
           05  WS-NUM-LEVEL                 PIC X(2).                   06360001
           05  FILLER                       PIC X       VALUE '-'.      06370001
           05  WS-NUM-MAIN                  PIC X(5).                   06380001
                                                                        06390001
       01  WS-SCH-ACC.                                                  06400001
           05  WS-SCH                       PIC X(4).                   06410001
           05  WS-SCH-SEP1                  PIC X.                      06420001
           05  WS-ACC                       PIC X(4).                   06430001
           05  WS-SCH-SEP2                  PIC X.                      06440001
           05  WS-CHK                       PIC X.                      06450001
           05  WS-SCH-SEP3                  PIC X.                      06460001
           05  WS-LESCDE                    PIC X(2).                   06470001
                                                                        06480001
       01  WS-F315-ACC-CHK.                                             06490001
           05  WS-F315-ACC                  PIC X(4).                   06500001
           05  WS-F315-CHK                  PIC X(1).                   06510001
                                                                        06520001
       01  WS-AO-DATE.                                                  06530001
           05  WS-AO-CC                     PIC X(2).                   06540001
           05  WS-AO-YY                     PIC X(2).                   06550001
           05  WS-AO-MM                     PIC X(2).                   06560001
           05  WS-AO-DD                     PIC X(2).                   06570001
                                                                        06580001
       01  WS-SALE-DATE.                                                06590001
           05  WS-SALE-CC                   PIC X(2).                   06600001
           05  WS-SALE-YY                   PIC X(2).                   06610001
           05  WS-SALE-MM                   PIC X(2).                   06620001
           05  WS-SALE-DD                   PIC X(2).                   06630001
                                                                        06640001
       01  WS-TEMPORARY-BUFFER.                                         06650001
           05  WS-TEMP-TOTAL                PIC 9(7)V99.                06660001
           05  WS-TEMP-DIFF                 PIC 9(7)V99.                06670001
                                                                        06680001
       01  WS-BLANK-LINE                    PIC X     VALUE SPACES.     06690001
       01  WS-F315-STATUS                   PIC 9(2)  VALUE ZEROS.      06700001
       01  WS-K006-STATUS                   PIC 9(2)  VALUE ZEROS.      06710001
       01  WS-K410-STATUS                   PIC 9(2)  VALUE ZEROS.      06720001
       01  WS-KD00-STATUS                   PIC 9(2)  VALUE ZEROS.      06730001
       01  WS-K625-STATUS                   PIC 9(2)  VALUE ZEROS.      06740001
       01  WS-K625-EOF                      PIC X(1)  VALUE 'N'.        06750001
       01  WS-LEASE-SF                      PIC S9(5)V99.               06760001
       01  WS-LEASE-STAMP                   PIC S9(5)V99 VALUE ZEROS.   06770001
       01  WS-MORT-SF                       PIC S9(5)V99.               06780001
       01  WS-MORT-SF2                      PIC S9(5)V99.               06790001
       01  WS-SUP-SF                        PIC S9(5)V99.               06800001
       01  WS-DUP-DOA                       PIC 9(2)V99.                06810001
       01  WS-ANNUAL-RENT                   PIC 9(7)V99.                06820001
       01  WS-LOAN-GRANTED                  PIC 9(7)V99.                06830001
       01  WS-SELL-PRICE                    PIC 9(8)  VALUE ZEROES.     06840001
       01  WS-LEASE-AMT                     PIC 9(10)V99 VALUE ZEROES.  06850001
       01  WS-NUM-HDB-REF                   PIC X(11) VALUE SPACES.     06860001
       01  WS-NUM-DOC                       PIC X(3)  VALUE SPACES.     06870001
       01  WS-NUM-DOC-TYP                   PIC X(1)  VALUE SPACES.     06880001
       01  WS-NUM-DOC-CNT                   PIC 9(1)  VALUE ZEROES.     06890001
       01  WS-AMT-STAMP-DUTY                PIC 9(13)V99 VALUE ZEROES.  06900001
       01  WS-AMT-STAMP-DUTY-DUP            PIC 9(13)V99 VALUE ZEROES.  06910001
       01  WS-AMT-EARMARK                   PIC 9(10)V99 VALUE ZEROES.  06920001
       01  WS-EM-LEASE-STAMP                PIC S9(5)V99 VALUE ZEROS.   06930001
       01  WS-EM-MORT-SF                    PIC S9(5)V99 VALUE ZEROS.   06940001
       01  WS-EM-SUP-SF                     PIC S9(5)V99 VALUE ZEROS.   06950001
       01  WS-EM-DUP-DOA                    PIC 9(2)V99  VALUE ZEROS.   06960001
       01  WS-STAFF-START                   PIC X(9) VALUE '29586H   '. 06970001
                                                                        06980001
      *----------------------------------------------------------*      06990001
      *    WS VARIABLES USED BY F220                             *      07000001
      *----------------------------------------------------------*      07010001
       01  WS-NEW-VOUCHER                   PIC X      VALUE 'Y'.       07020001
       01  WS-NEW-BATCH                     PIC X      VALUE 'Y'.       07030001
       01  WS-NEW-HEADER                    PIC X      VALUE 'Y'.       07040001
       01  WS-DTE-SALE-AGRM                 PIC X(08)  VALUE SPACES.    07050001
       01  WS-NUM-VOUCHER                   PIC X(11)  VALUE SPACES.    07060001
       01  WS-NUM-BATCH-TYPE                PIC X(4)   VALUE SPACES.    07070001
       01  WS-NUM-FIN-YEAR                  PIC 9(4)   VALUE ZEROES.    07080001
       01  WS-NUM-BATCH-SERIAL              PIC 9(5)   VALUE ZEROES.    07090001
       01  WS-SCH-ACCT-NO                   PIC X(11)  VALUE SPACES.    07100001
       01  WS-SCH-ACCT-NO2                  PIC X(11)  VALUE SPACES.    07110001
       01  WS-TXT-INFO                      PIC X(50)  VALUE SPACES.    07120001
       01  WS-NME-FIN-SOLICITOR             PIC X(50)  VALUE SPACES.    07130001
       01  WS-CNT-DETAILS                   PIC 9(4)   VALUE ZEROES.    07140001
       01  WS-AMT-TRANS                     PIC 9(7)V99 VALUE ZEROES.   07150001
       01  WS-AMT-TOTAL                     PIC 9(7)V99 VALUE ZEROES.   07160001
       01  WS-PREV-SA-TP-TAG                PIC X(1)   VALUE SPACE.     07170001
       01  WS-PREV-PROJ-CODE                PIC X(3)   VALUE SPACE.     07180001
       01  WS-EDITED-VOUCHER-NO.                                        07190001
           05  WS-EDITED-NUM-DDD            PIC X(3)   VALUE SPACES.    07200001
           05  FILLER                       PIC X(1)   VALUE '-'.       07210001
           05  WS-EDITED-NUM-FIN-YEAR       PIC X(2)   VALUE SPACES.    07220001
           05  FILLER                       PIC X(1)   VALUE '-'.       07230001
           05  WS-EDITED-NUM-VR-SERIAL      PIC X(6)   VALUE SPACES.    07240001
       01  WS-L436J-DESC.                                               07250001
           05  FILLER                       PIC X(38)  VALUE SPACES.    07260001
           05  FILLER                       PIC X(42)  VALUE            07270001
              'S&P AGREEMENT AND DEED OF ASSIGNMENT (DBSS'.             07280001
           05  FILLER                       PIC X(17)  VALUE            07290001
              ')                '.                                      07300001
       01  WS-L436JL-DESC.                                              07310001
           05  FILLER                       PIC X(47)  VALUE SPACES.    07320001
           05  FILLER                       PIC X(42)  VALUE            07330001
              'LEASE PREPARATION FEES TO SOLICITOR       '.             07340001
                                                                        07350001
      *----------------------------------------------------------*      07360001
      *    WS VARIABLES PASSED FROM SUB-PROGRAM "AG07C907"       *      07370001
      *----------------------------------------------------------*      07380001
       COPY AG7C907C.                                                   07390001
                                                                        07400001
      *----------------------------------------------------------*      07410001
      *    WS VARIABLES PASSED FROM SUB-PROGRAM "BP13C906"       *      07420001
      *----------------------------------------------------------*      07430001
       COPY P13C906C.                                                   07440001
                                                                        07450001
      *----------------------------------------------------------*      07460001
      *    WS VARIABLES PASSED FROM SUB-PROGRAM "AB05C902"       *      07470001
      *----------------------------------------------------------*      07480001
       COPY AB05902C.                                                   07490001
                                                                        07500001
      *----------------------------------------------------------*      07510001
      *    WS VARIABLES FOR CONVERTING AMOUNT TO WORDS           *      07520001
      *----------------------------------------------------------*      07530001
       01  WS-SUBSCRIPTS.                                               07540001
           05  WA-SUB              PIC 999   VALUE 0.                   07550001
           05  WF-SUB              PIC 999   VALUE 0.                   07560001
           05  WL-SUB              PIC 999   VALUE 0.                   07570001
           05  WS-SUB              PIC 999   VALUE 0.                   07580001
           05  WS-FIRST-SUB        PIC 999   VALUE 0.                   07590001
                                                                        07600001
       01  WA-NAMES.                                                    07610001
           05  FILLER              PIC X(10) VALUE '3ONE      '.        07620001
           05  FILLER              PIC X(10) VALUE '3TWO      '.        07630001
           05  FILLER              PIC X(10) VALUE '5THREE    '.        07640001
           05  FILLER              PIC X(10) VALUE '4FOUR     '.        07650001
           05  FILLER              PIC X(10) VALUE '4FIVE     '.        07660001
           05  FILLER              PIC X(10) VALUE '3SIX      '.        07670001
           05  FILLER              PIC X(10) VALUE '5SEVEN    '.        07680001
           05  FILLER              PIC X(10) VALUE '5EIGHT    '.        07690001
           05  FILLER              PIC X(10) VALUE '4NINE     '.        07700001
           05  FILLER              PIC X(10) VALUE '3TEN      '.        07710001
           05  FILLER              PIC X(10) VALUE '6ELEVEN   '.        07720001
           05  FILLER              PIC X(10) VALUE '6TWELVE   '.        07730001
           05  FILLER              PIC X(10) VALUE '8THIRTEEN '.        07740001
           05  FILLER              PIC X(10) VALUE '8FOURTEEN '.        07750001
           05  FILLER              PIC X(10) VALUE '7FIFTEEN  '.        07760001
           05  FILLER              PIC X(10) VALUE '7SIXTEEN  '.        07770001
           05  FILLER              PIC X(10) VALUE '9SEVENTEEN'.        07780001
           05  FILLER              PIC X(10) VALUE '8EIGHTEEN '.        07790001
           05  FILLER              PIC X(10) VALUE '8NINETEEN '.        07800001
           05  FILLER              PIC X(10) VALUE '6TWENTY   '.        07810001
           05  FILLER              PIC X(10) VALUE '6THIRTY   '.        07820001
           05  FILLER              PIC X(10) VALUE '5FORTY    '.        07830001
           05  FILLER              PIC X(10) VALUE '5FIFTY    '.        07840001
           05  FILLER              PIC X(10) VALUE '5SIXTY    '.        07850001
           05  FILLER              PIC X(10) VALUE '7SEVENTY  '.        07860001
           05  FILLER              PIC X(10) VALUE '6EIGHTY   '.        07870001
           05  FILLER              PIC X(10) VALUE '6NINETY   '.        07880001
       01  WA-NAMER REDEFINES WA-NAMES.                                 07890001
           05  WA-NAME             PIC X(10) OCCURS 27 TIMES.           07900001
                                                                        07910001
       01  WS-LITERALS.                                                 07920001
           05  L-CENT              PIC X(5)  VALUE '4CENT'.             07930001
           05  L-AND               PIC X(4)  VALUE '3AND'.              07940001
           05  L-X                 PIC X     VALUE '%'.                 07950001
           05  L-MILLION           PIC X(8)  VALUE '7MILLION'.          07960001
           05  L-THOUSAND          PIC X(9)  VALUE '8THOUSAND'.         07970001
           05  L-DOLLARS           PIC X(8)  VALUE '7DOLLARS'.          07980001
           05  L-CENTS             PIC X(6)  VALUE '6CENTS'.            07990001
           05  L-ONLY              PIC X(6)  VALUE '5ONLY '.            08000001
           05  L-HUNDRED           PIC X(8)  VALUE '7HUNDRED'.          08010001
           05  L-DOLLAR            PIC X(7)  VALUE '6DOLLAR'.           08020001
                                                                        08030001
       01  SWITCHES.                                                    08040001
           05  WS-SWITCH           PIC 9     VALUE 0.                   08050001
           05  WS-THO-SW           PIC 9     VALUE 0.                   08060001
           05  WS-CNT-SW           PIC 9     VALUE 0.                   08070001
           05  WS-LIT-SW           PIC 9     VALUE 0.                   08080001
           05  WS-TEN-SW           PIC 9     VALUE 0.                   08090001
           05  WS-AND-SW           PIC 9     VALUE 0.                   08100001
                                                                        08110001
       01  WS-PLACE-COUNTER        PIC 999   VALUE 0.                   08120001
       01  WL-AREA-SAVE            PIC X(12) VALUE SPACES.              08130001
       01  WS-RESULT               PIC 999   VALUE 0.                   08140001
       01  WL-AREA.                                                     08150001
           05  WL-ITEM1            PIC 9     VALUE 0.                   08160001
           05  FILLER              PIC X(11) VALUE SPACE.               08170001
       01  WL-ITM REDEFINES WL-AREA.                                    08180001
           05  WL-ITEM             PIC X     OCCURS 12 TIMES.           08190001
                                                                        08200001
       01  WS-CHEQUE-DETAILS.                                           08210001
           05  WS-AMT              PIC 9(7)V99 VALUE 0.                 08220001
           05  WS-DIGIT REDEFINES  WS-AMT OCCURS 9 TIMES PIC 9.         08230001
           05  WF-DETAILS.                                              08240001
               10  WF-LINE-1       PIC X(60).                           08250001
               10  WF-LINE-2       PIC X(60).                           08260001
           05  WF-ITEM REDEFINES WF-DETAILS OCCURS 120 PIC X.           08270001
           05  WP-ITEM REDEFINES WF-DETAILS OCCURS 2 PIC X(60).         08280001
                                                                        08290001
                                                                        08300001
      *------------------*                                              08310001
       PROCEDURE DIVISION.                                              08320001
      *------------------*                                              08330001
                                                                        08340001
      ******************************************************************08350001
       0000-CONTROL.                                                    08360001
      ******************************************************************08370001
            PERFORM  0100-SET-DATE               THRU  0100-EXIT.       08380001
            PERFORM  0200-OPEN-FILES             THRU  0200-EXIT.       08390001
            PERFORM  1100-READ-BP13F315          THRU  1100-EXIT.       08400001
            PERFORM  0900-CHECK-SALES-TYPE       THRU  0900-EXIT.       08410001
                                                                        08420001
            MOVE     WS-REPORT-ID-SW             TO    WS-PREV-REPORT-ID08430001
            MOVE     F315-CDE-SA-TP-TAG          TO    WS-PREV-SA-TP-TAG08440001
            MOVE     F315-CDE-PROJECT            TO    WS-PREV-PROJ-CODE08450001
            PERFORM  1000-READ-AND-PRINT-LOOP    THRU  1000-EXIT        08460001
                          UNTIL END-OF-BP13F315.                        08470001
                                                                        08480001
            PERFORM  8000-DISPLAY-STATISTICS     THRU  8000-EXIT.       08490001
            PERFORM  9000-CLOSE-FILES            THRU  9000-EXIT.       08500001
                                                                        08510001
       0000-EXIT.                                                       08520001
            EXIT.                                                       08530001
                                                                        08540001
                                                                        08550001
      ******************************************************************08560001
       0100-SET-DATE.                                                   08570001
      ******************************************************************08580001
            STRING  FUNCTION CURRENT-DATE(7:2) '/'                      08590001
                    FUNCTION CURRENT-DATE(5:2) '/'                      08600001
                    FUNCTION CURRENT-DATE(1:4)                          08610001
            DELIMITED BY SIZE INTO HEADER-DATE.                         08620001
                                                                        08630001
            MOVE HEADER-DATE           TO   L436-CURRENT-DATE.          08640001
                                                                        08650001
       0100-EXIT.                                                       08660001
            EXIT.                                                       08670001
                                                                        08680001
                                                                        08690001
      ******************************************************************08700001
       0200-OPEN-FILES.                                                 08710001
      ******************************************************************08720001
            OPEN INPUT  BP13F315                                        08730001
                        B05K006                                         08740001
                        BP13K410                                        08750001
                 I-O    BP13K625                                        08760001
                 OUTPUT AG07F225                                        08770001
                        BP13436J                                        08780001
                        BP13436L                                        08790001
                        BP13436K.                                       08800001
                                                                        08810001
            IF WS-K006-STATUS NOT = 00 AND 97                           08820001
               MOVE    OPEN-K006                  TO   WS-CUR-PROC      08830001
               MOVE    WS-K006-STATUS             TO   WS-CUR-STATUS    08840001
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT        08850001
               PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT.       08860001
                                                                        08870001
            IF WS-K410-STATUS NOT = 00 AND 97                           08880001
               MOVE    OPEN-K410                  TO    WS-CUR-PROC     08890001
               MOVE    WS-K410-STATUS             TO    WS-CUR-STATUS   08900001
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT       08910001
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.      08920001
                                                                        08930001
            IF WS-K625-STATUS NOT = 00 AND 97                           08940001
               MOVE    OPEN-K625                TO    WS-CUR-PROC       08950001
               MOVE    WS-K625-STATUS           TO    WS-CUR-STATUS     08960001
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT       08970001
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.      08980001
                                                                        08990001
      * VOUCHER NUMBER                                                  09000001
            MOVE 'AG07K960' TO    C907-NUM-FILENME.                     09010001
            CALL 'K960OPEN' USING AG07C907-AREA.                        09020001
                                                                        09030001
            IF C907-NUM-FILE-STATUS NOT = ('00' AND '97')               09040001
               DISPLAY 'ERROR OPENING AG07K960, STATUS = '              09050001
                        C907-NUM-FILE-STATUS                            09060001
               MOVE     C907-NUM-FILE-STATUS    TO  WS-AG07-STAT-X      09070001
               MOVE     WS-AG07-STATUS          TO     RETURN-CODE      09080001
               PERFORM  9000-CLOSE-FILES        THRU   9000-EXIT        09090001
            END-IF.                                                     09100001
                                                                        09110001
      * BATCH NUMBER (17/07/1999 - ROMAR)                               09120001
            MOVE 'BP13K620' TO    C906-NUM-FILENME.                     09130001
            CALL 'K620OPEN' USING BP13C906-AREA.                        09140001
                                                                        09150001
            IF C906-NUM-FILE-STATUS NOT = ('00' AND '97')               09160001
               DISPLAY 'ERROR OPENING BP13K620, STATUS = '              09170001
                        C906-NUM-FILE-STATUS                            09180001
               MOVE     C906-NUM-FILE-STATUS    TO     RETURN-CODE      09190001
               PERFORM  9000-CLOSE-FILES        THRU   9000-EXIT        09200001
            END-IF.                                                     09210001
                                                                        09220001
      **CALL AB05C902 TO OPEN B05K006 AND AB05K009 FILES(CODE='O')      09230001
            MOVE SPACES              TO   WS-B902-AREA.                 09240001
            INITIALIZE                    WS-B902-AREA.                 09250001
            MOVE 'O'                 TO   B902-CDE-TYPE.                09260001
            CALL 'AB05C902'  USING WS-B902-AREA.                        09270001
                                                                        09280001
            IF B902-CDE-ERROR NOT = ZEROES                              09290001
               MOVE B902-CDE-SYSERR  TO   RETURN-CODE                   09300001
               DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'            09310001
               PERFORM  9000-CLOSE-FILES  THRU 9000-EXIT                09320001
            END-IF.                                                     09330001
                                                                        09340001
       0200-EXIT.                                                       09350001
            EXIT.                                                       09360001
                                                                        09370001
      ******************************************************************09380001
       0900-CHECK-SALES-TYPE.                                           09390001
      ******************************************************************09400001
            MOVE  'J'           TO     WS-REPORT-ID-SW.                 09410001
            MOVE  'DBSS'        TO     WS-NUM-BATCH-TYPE.               09420001
            IF  F315-CDE-TRANS   =   'DS'                               09430001
                MOVE  'DBDS'        TO     WS-NUM-BATCH-TYPE            09440001
            END-IF.                                                     09450001
                                                                        09460001
       0900-EXIT.                                                       09470001
            EXIT.                                                       09480001
                                                                        09490001
      ******************************************************************09500001
       1000-READ-AND-PRINT-LOOP.                                        09510001
      ******************************************************************09520001
            IF F315-CDE-TRANS = 'DB'  OR  'DS'                          09530001
               IF (WS-REPORT-ID-SW    NOT = WS-PREV-REPORT-ID) OR       09540001
                  (F315-CDE-SA-TP-TAG NOT = WS-PREV-SA-TP-TAG) OR       09550001
                  (F315-CDE-PROJECT   NOT = WS-PREV-PROJ-CODE)          09560001
                                                                        09570001
                   PERFORM  5000-WRITE-TRAILER-F225                     09580001
                      THRU  5000-TRAILER-EXIT                           09590001
                   MOVE     ZEROES               TO  WS-CNT-DETAILS     09600001
                   MOVE     ZEROES               TO  WS-TEMP-TOTAL      09610001
                   MOVE     'Y'                  TO  WS-NEW-BATCH       09620001
                                                     WS-NEW-VOUCHER     09630001
                                                     WS-NEW-HEADER      09640001
                   MOVE     WS-REPORT-ID-SW      TO  WS-PREV-REPORT-ID  09650001
                   MOVE     F315-CDE-SA-TP-TAG   TO  WS-PREV-SA-TP-TAG  09660001
                   MOVE     F315-CDE-PROJECT     TO  WS-PREV-PROJ-CODE  09670001
               END-IF                                                   09680001
                                                                        09690001
               PERFORM  1050-PROCESS-RECORD      THRU 1050-EXIT         09700001
               PERFORM  1055-EARMARK-ACCOUNT     THRU 1055-EXIT         09710001
                                                                        09720001
               IF B902-CDE-SYSERR NOT = ZEROES                          09730001
                  DISPLAY 'ERROR CALLING AB05C902, STATUS = '           09740001
                           B902-CDE-SYSERR                              09750001
                  MOVE     '99'                 TO RETURN-CODE          09760001
                  PERFORM  9000-CLOSE-FILES                             09770001
               END-IF                                                   09780001
                                                                        09790001
               IF B902-CDE-ERROR-ACCT(1) = SPACES                       09800001
                  IF WS-NEW-HEADER = 'Y'                                09810001
                     PERFORM  5000-WRITE-HEADER-F225                    09820001
                              THRU 5000-HEADER-EXIT                     09830001
                     MOVE  'N'             TO   WS-NEW-HEADER           09840001
                  END-IF                                                09850001
                  PERFORM  1060-PRINT-RECORD        THRU 1060-EXIT      09860001
                  MOVE F315-CDE-SA-TP-TAG  TO   WS-PREV-SA-TP-TAG       09870001
                  MOVE F315-CDE-PROJECT    TO   WS-PREV-PROJ-CODE       09880001
                  PERFORM  6000-WRITE-STAMPING-FILE THRU 6000-EXIT      09890001
               END-IF                                                   09900001
                                                                        09910001
            END-IF.                                                     09920001
                                                                        09930001
            PERFORM 1100-READ-BP13F315       THRU 1100-EXIT.            09940001
                                                                        09950001
            IF NOT END-OF-BP13F315                                      09960001
               PERFORM 0900-CHECK-SALES-TYPE THRU 0900-EXIT             09970001
            END-IF.                                                     09980001
                                                                        09990001
       1000-EXIT.                                                       10000001
            EXIT.                                                       10010001
                                                                        10020001
                                                                        10030001
      ******************************************************************10040001
       1050-PROCESS-RECORD.                                             10050001
      ******************************************************************10060001
            PERFORM 1300-READ-BP13K410 THRU 1300-EXIT.                  10070001
                                                                        10080001
            MOVE 0.00                    TO   DUP-DOA-AMT               10090001
                                              DUP-SA-AMT                10100001
            MOVE  ZEROES                 TO   WS-LEASE-SF               10110001
            MOVE  ZEROES                 TO   WS-MORT-SF                10120001
                                              WS-MORT-SF2               10130001
            MOVE  008400000              TO   WS-LOAN-GRANTED           10140001
            MOVE  ZEROES                 TO   WS-SCH-ACCT-NO2           10150001
            MOVE  K410-AMT-SELLING-PRICE TO   WS-SELL-PRICE             10160001
                                                                        10170001
            IF WS-LEASE-SF                NOT NUMERIC                   10180001
               MOVE ZEROES TO WS-LEASE-SF.                              10190001
                                                                        10200001
            IF WS-LOAN-GRANTED            NOT NUMERIC                   10210001
               MOVE ZEROS  TO WS-LOAN-GRANTED.                          10220001
                                                                        10230001
      * GENERATE BATCH NUMBER.                                          10240001
            IF WS-NEW-BATCH = 'Y'                                       10250001
               MOVE WS-NUM-BATCH-TYPE TO C906-NUM-BATCH-TYPE            10260001
               MOVE  'BP13K620'       TO C906-NUM-FILENME               10270001
                                                                        10280001
               CALL 'BP13C906'  USING BP13C906-AREA                     10290001
                                                                        10300001
               IF C906-NUM-FILE-STATUS =  '00'                          10310001
                  MOVE C906-NUM-BATCH-TYPE      TO  WS-NUM-BATCH-TYPE   10320001
                  MOVE C906-NUM-FIN-YEAR        TO  WS-NUM-FIN-YEAR     10330001
                  MOVE C906-NUM-BATCH-SERIAL    TO  WS-NUM-BATCH-SERIAL 10340001
                  MOVE    'N'                   TO  WS-NEW-BATCH        10350001
               ELSE                                                     10360001
                  DISPLAY 'ERROR CALLING BP13C906, FILE STATUS = '      10370001
                           C906-NUM-FILE-STATUS                         10380001
                  MOVE     C906-NUM-FILE-STATUS TO RETURN-CODE          10390001
                  PERFORM  9000-CLOSE-FILES                             10400001
            END-IF.                                                     10410001
                                                                        10420001
      * GENERATE VOUCHER NUMBER.                                        10430001
            IF WS-NEW-VOUCHER = 'Y'                                     10440001
               MOVE  'SS '      TO C907-NUM-DDD                         10450001
               MOVE  'AG07K960' TO C907-NUM-FILENME                     10460001
                                                                        10470001
               CALL 'AG07C907'  USING AG07C907-AREA                     10480001
                                                                        10490001
               IF C907-NUM-FILE-STATUS =  '00'                          10500001
                  MOVE    'N'   TO    WS-NEW-VOUCHER                    10510001
               ELSE                                                     10520001
                  DISPLAY 'ERROR CALLING AG07C907, FILE STATUS = '      10530001
                           C907-NUM-FILE-STATUS                         10540001
                  MOVE     C907-NUM-FILE-STATUS TO WS-AG07-STAT-X       10550001
                  MOVE     WS-AG07-STATUS       TO RETURN-CODE          10560001
                  PERFORM  9000-CLOSE-FILES                             10570001
            END-IF.                                                     10580001
                                                                        10590001
       1050-EXIT.                                                       10600001
            EXIT.                                                       10610001
                                                                        10620001
                                                                        10630001
      ******************************************************************10640001
       1055-EARMARK-ACCOUNT.                                            10650001
      ******************************************************************10660001
      **CALL AB05C902 TO EARMARK ACCOUNT(CODE='E')                      10670001
            MOVE SPACES              TO   WS-B902-AREA.                 10680001
            INITIALIZE                    WS-B902-AREA.                 10690001
                                                                        10700001
            STRING C907-NUM-DDD  C907-NUM-FIN-YR                        10710001
                   C907-NUM-VR-SERIAL                                   10720001
                   DELIMITED BY SIZE INTO B902-VR-NO                    10730001
            END-STRING.                                                 10740001
                                                                        10750001
            MOVE 'E'                     TO   B902-CDE-TYPE.            10760001
            MOVE 'BP13'                  TO   B902-CDE-SYSTEMID.        10770001
            MOVE FUNCTION CURRENT-DATE   TO   B902-DTE-TRANS.           10780001
            MOVE 'P13C436'               TO   B902-NUM-USERID-UPDATE.   10790001
            MOVE 'CV'                    TO   B902-CDE-EARMARK-REASON.  10800001
            MOVE 01                      TO   B902-NUM-HDB-REF-CNT.     10810001
            MOVE F315-SCH-ACC            TO   B902-NUM-HDB-REF(1).      10820001
            MOVE ZEROES                  TO   WS-AMT-EARMARK.           10830001
                                                                        10840001
            PERFORM 1057-COMP-TRANS-AMT  THRU 1057-EXIT.                10850001
            MOVE WS-AMT-EARMARK          TO   B902-AMT-EARMARK(1).      10860001
                                                                        10870001
            DISPLAY '----------------'.                                 10880001
            DISPLAY 'B902-VR-NO       = ' B902-VR-NO.                   10890001
            DISPLAY 'B902-CDE-TYPE    = ' B902-CDE-TYPE.                10900001
            DISPLAY 'CDE-SYSTEMID     = ' B902-CDE-SYSTEMID.            10910001
            DISPLAY 'B902-DTE-TRANS   = ' B902-DTE-TRANS.               10920001
            DISPLAY 'NUM-USERID       = ' B902-NUM-USERID-UPDATE.       10930001
            DISPLAY 'HDB-REF-CNT      = ' B902-NUM-HDB-REF-CNT.         10940001
            DISPLAY 'NUM-HDB-REF      = ' B902-NUM-HDB-REF(1).          10950001
            DISPLAY 'B902-AMT-EARMARK = ' B902-AMT-EARMARK(1).          10960001
                                                                        10970001
            CALL 'AB05C902'  USING WS-B902-AREA.                        10980001
                                                                        10990001
            DISPLAY 'CDE-ERROR-ACCT   = ' B902-CDE-ERROR-ACCT(1).       11000001
            DISPLAY '----------------'.                                 11010001
                                                                        11020001
            EVALUATE B902-CDE-ERROR-ACCT(1)                             11030001
               WHEN SPACES                                              11040001
                  CONTINUE                                              11050001
               WHEN OTHER                                               11060001
                  PERFORM 6500-PRINT-L436K-REPORT     THRU 6500-EXIT    11070001
            END-EVALUATE.                                               11080001
                                                                        11090001
       1055-EXIT.                                                       11100001
            EXIT.                                                       11110001
                                                                        11120001
                                                                        11130001
      ******************************************************************11140001
       1057-COMP-TRANS-AMT.                                             11150001
      ******************************************************************11160001
            IF WS-MORT-SF2 = ZEROS                                      11170001
               MOVE     ZEROES            TO   WS-EM-MORT-SF            11180001
               MOVE     ZEROES            TO   WS-EM-DUP-DOA            11190001
            ELSE                                                        11200001
               MOVE     WS-MORT-SF2       TO   WS-EM-MORT-SF            11210001
               SUBTRACT DUP-DOA-AMT       FROM WS-EM-MORT-SF            11220001
               MOVE     DUP-DOA-AMT       TO   WS-EM-DUP-DOA            11230001
            END-IF.                                                     11240001
                                                                        11250001
      *     IF F315-REGN-NO = '5042686F'                                11260001
            IF F315-REGN-NO = '5042562B'                                11261001
               MOVE F315-AMT-STAMP-DUTIES TO    WS-MORT-SF              11270001
               MOVE F315-AMT-STAMP-DUTIES TO    WS-EM-MORT-SF           11280001
            END-IF.                                                     11290001
                                                                        11300001
            IF WS-LEASE-SF = ZEROES                                     11310001
               INITIALIZE   WS-EM-LEASE-STAMP                           11320001
            ELSE                                                        11330001
               COMPUTE WS-EM-LEASE-STAMP = WS-LEASE-SF                  11340001
            END-IF.                                                     11350001
                                                                        11360001
            DISPLAY 'NUM-REGN            = ' F315-REGN-NO.              11370001
            DISPLAY 'WS-EM-MORT-SF       = ' WS-EM-MORT-SF.             11380001
            DISPLAY 'WS-EM-LEASE-STAMP   = ' WS-EM-LEASE-STAMP.         11390001
            DISPLAY 'WS-LEASE-SF= ' WS-LEASE-SF.                        11400001
                                                                        11410001
            COMPUTE WS-AMT-EARMARK = (WS-EM-MORT-SF + WS-EM-DUP-DOA +   11420001
                                     WS-EM-LEASE-STAMP).                11430001
            DISPLAY 'WS-AMT-EARMARK     = ' WS-AMT-EARMARK.             11440001
            IF F315-CDE-TRANS  =  'DS'                                  11450001
               COMPUTE WS-AMT-EARMARK = WS-EM-LEASE-STAMP               11460001
            END-IF.                                                     11470001
                                                                        11480001
       1057-EXIT.                                                       11490001
           EXIT.                                                        11500001
                                                                        11510001
                                                                        11520001
      ******************************************************************11530001
       1060-PRINT-RECORD.                                               11540001
      ******************************************************************11550001
            PERFORM 2150-HANDLE-SER  THRU  2150-EXIT.                   11560001
                                                                        11570001
       1060-EXIT.                                                       11580001
            EXIT.                                                       11590001
                                                                        11600001
                                                                        11610001
      ******************************************************************11620001
       1100-READ-BP13F315.                                              11630001
      ******************************************************************11640001
            READ BP13F315                                               11650001
              AT END                                                    11660001
                 MOVE    'Y'  TO WS-EOF                                 11670001
                 PERFORM 4200-PRINT-LAST-LINES THRU 4200-EXIT           11680001
                 GO TO   1100-EXIT.                                     11690001
                                                                        11700001
            IF F315-CDE-TRANS = 'DB'  OR  'DS'                          11710001
               ADD  1                 TO  WS-BP13F315-READ-CNT          11720001
                                                                        11730001
            MOVE    F315-SCH          TO  WS-SCH.                       11740001
            MOVE    F315-ACC          TO  WS-F315-ACC-CHK.              11750001
            MOVE    WS-F315-ACC       TO  WS-ACC.                       11760001
            MOVE    WS-F315-CHK       TO  WS-CHK.                       11770001
            MOVE    F315-LESSEE-CODE  TO  WS-LESCDE.                    11780001
            MOVE    HYPHEN            TO  WS-SCH-SEP1.                  11790001
            MOVE    HYPHEN            TO  WS-SCH-SEP2.                  11800001
            MOVE    HYPHEN            TO  WS-SCH-SEP3.                  11810001
            MOVE    F315-NUM-LEVEL    TO  WS-NUM-LEVEL.                 11820001
            MOVE    F315-NUM-MAIN     TO  WS-NUM-MAIN.                  11830001
                                                                        11840001
            IF F315-CDE-SA-TP-TAG  =  LOW-VALUE                         11850001
               MOVE SPACE             TO  F315-CDE-SA-TP-TAG            11860001
            END-IF.                                                     11870001
                                                                        11880001
       1100-EXIT.                                                       11890001
            EXIT.                                                       11900001
                                                                        11910001
                                                                        11920001
      ******************************************************************11930001
       1300-READ-BP13K410.                                              11940001
      ******************************************************************11950001
            DISPLAY '1300'.                                             11960001
      *---------------------------------------------------------------* 11970001
      *     USE F315-REGN-NO TO ACCESS BP13K410                       * 11980001
      *---------------------------------------------------------------* 11990001
            MOVE SPACES                      TO   BP13K410-REC.         12000001
            INITIALIZE                            BP13K410-REC.         12010001
                                                                        12020001
            MOVE F315-REGN-NO                TO   K410-NUM-REGN.        12030001
                                                                        12040001
            DISPLAY 'F315-REGN-NO   = ' F315-REGN-NO.                   12050001
                                                                        12060001
            READ BP13K410.                                              12070001
                                                                        12080001
            DISPLAY 'WS-K410-STATUS = ' WS-K410-STATUS.                 12090001
                                                                        12100001
            IF WS-K410-STATUS = 00                                      12110001
               MOVE  K410-DTE-TP-VR-PREP     TO   WS-DTE-SALE-AGRM      12120001
            ELSE                                                        12130001
               MOVE  SPACES                  TO   WS-DTE-SALE-AGRM      12140001
            END-IF.                                                     12150001
                                                                        12160001
       1300-EXIT.                                                       12170001
            EXIT.                                                       12180001
                                                                        12190001
      ******************************************************************12200001
       1800-READ-B05K006.                                               12210001
      ******************************************************************12220001
            MOVE  ' '                TO L436-TAG.                       12230001
            MOVE  SPACES             TO K006-HDB-REF-SF.                12240001
            MOVE  WS-SCH-ACCT-NO2    TO K006-HDB-REF-SF.                12250001
                                                                        12260001
            READ  B05K006.                                              12270001
                                                                        12280001
            IF WS-K006-STATUS = 00                                      12290001
               PERFORM 1810-CHECK-ADHOC-BLANK-CASES THRU 1810-EXIT      12300001
            END-IF.                                                     12310001
                                                                        12320001
       1800-EXIT.                                                       12330001
            EXIT.                                                       12340001
                                                                        12350001
                                                                        12360001
      ******************************************************************12370001
       1810-CHECK-ADHOC-BLANK-CASES.                                    12380001
      ******************************************************************12390001
           INITIALIZE             WS-LEASE-AMT.                         12400001
           COMPUTE WS-LEASE-AMT = WS-LEASE-SF + WS-MORT-SF              12410001
           IF F315-CDE-TRANS   = 'DS'                                   12420001
              MOVE WS-LEASE-SF  TO  WS-LEASE-AMT                        12430001
           END-IF.                                                      12440001
           IF (K006-BALANCES > WS-LEASE-AMT) OR                         12450001
              (K006-BALANCES = WS-LEASE-AMT)                            12460001
               NEXT SENTENCE                                            12470001
           ELSE                                                         12480001
               MOVE '*'          TO L436-TAG                            12490001
           END-IF.                                                      12500001
                                                                        12510001
       1810-EXIT.                                                       12520001
            EXIT.                                                       12530001
                                                                        12540001
                                                                        12550001
      ******************************************************************12560001
       2000-DISPLAY-ERROR-MESSAGE.                                      12570001
      ******************************************************************12580001
            DISPLAY ' *************   ERROR MESSAGE   *************'.   12590001
            DISPLAY 'ERROR ENCOUNTERED WHEN ' WS-CUR-PROC.              12600001
            DISPLAY 'STATUS CODE = ' WS-CUR-STATUS.                     12610001
                                                                        12620001
       2000-EXIT.                                                       12630001
            EXIT.                                                       12640001
                                                                        12650001
                                                                        12660001
      ******************************************************************12670001
       2150-HANDLE-SER.                                                 12680001
      ******************************************************************12690001
      *--------------------------------*                                12700001
      *     PRINT  L436J-RECORD (DOA)  *                                12710001
      *--------------------------------*                                12720001
            ADD    1                      TO  WS-CNT-DETAILS.           12730001
                                                                        12740001
      *     -----------------------                                     12750001
      *     SET UP L436J-REC-DETAIL                                     12760001
      *     -----------------------                                     12770001
            MOVE   WS-CNT-DETAILS         TO  L436-SERIAL-NO            12780001
                                              L436L-SERIAL-NO           12790001
            MOVE   WS-SCH-ACC             TO  L436-SCH-ACC              12800001
                                              L436L-SCH-ACC             12810001
            MOVE   F315-REGN-NO           TO  L436-REGN-NO              12820001
                                              L436L-REGN-NO             12830001
            MOVE   F315-NUM-BLK           TO  L436-BLKNO                12840001
                                              L436L-BLKNO               12850001
            MOVE   F315-NME-STREET        TO  L436-STREET               12860001
                                              L436L-STREET              12870001
            MOVE   WS-DTE-SALE-AGRM       TO  WS-SALE-DATE              12880001
            MOVE   WS-SALE-CC             TO  L436-SALE-CC              12890001
                                              L436L-SALE-CC             12900001
            MOVE   WS-SALE-YY             TO  L436-SALE-YY              12910001
                                              L436L-SALE-YY             12920001
            MOVE   WS-SALE-MM             TO  L436-SALE-MM              12930001
                                              L436L-SALE-MM             12940001
            MOVE   WS-SALE-DD             TO  L436-SALE-DD              12950001
                                              L436L-SALE-DD             12960001
            MOVE   '/'                    TO  L436-DASH1  L436-DASH2    12970001
                                              L436L-DASH1  L436L-DASH2  12980001
            MOVE   WS-FLATNO              TO  L436-FLATNO               12990001
                                              L436L-FLATNO              13000001
                                                                        13010001
            IF WS-LOAN-GRANTED = ZEROS                                  13020001
               MOVE     ZEROES            TO  L436-MORT-SF              13030001
               MOVE     ZEROES            TO  L436-TOTAL-MORT-SF        13040001
               MOVE     ZEROES            TO  L436-DUP-DOA              13050001
               MOVE     ZEROES            TO  WS-MORT-SF                13060001
               MOVE     ZEROES            TO  WS-DUP-DOA                13070001
            ELSE                                                        13080001
               SUBTRACT DUP-DOA-AMT       FROM  WS-MORT-SF              13090001
               MOVE     WS-MORT-SF        TO    L436-MORT-SF            13100001
               MOVE     DUP-DOA-AMT       TO    WS-DUP-DOA              13110001
               MOVE     DUP-DOA-AMT       TO    L436-DUP-DOA            13120001
            END-IF.                                                     13130001
                                                                        13140001
      *     IF F315-REGN-NO = '5042686F'                                13150002
            IF F315-REGN-NO = '5042562B'                                13151002
               MOVE F315-AMT-STAMP-DUTIES TO    L436-TOTAL-MORT-SF      13160001
               MOVE F315-AMT-STAMP-DUTIES TO    L436-MORT-SF            13170001
               MOVE F315-AMT-STAMP-DUTIES TO    WS-MORT-SF              13180001
               MOVE F315-AMT-STAMP-DUTIES TO    WS-EM-MORT-SF           13190001
            END-IF.                                                     13200001
                                                                        13210001
            IF WS-LEASE-SF NOT = ZEROES                                 13220001
               PERFORM  1800-READ-B05K006 THRU 1800-EXIT                13230001
                                                                        13240001
               COMPUTE WS-LEASE-STAMP = WS-LEASE-SF                     13250001
                                                                        13260001
               MOVE    WS-LEASE-STAMP   TO  L436-SUP-LEASE-STAMP        13270001
                                            L436L-LEASE-STAMP           13280001
            ELSE                                                        13290001
               MOVE    0                TO  L436-SUP-LEASE-STAMP        13300001
                                            L436L-LEASE-STAMP           13310001
            END-IF.                                                     13320001
                                                                        13330001
            COMPUTE WS-TEMP-TOTAL = (WS-MORT-SF     + WS-DUP-DOA +      13340001
                                     WS-LEASE-STAMP).                   13350001
            IF F315-CDE-TRANS  = 'DS'                                   13360001
               COMPUTE WS-TEMP-TOTAL = WS-LEASE-STAMP                   13370001
            END-IF.                                                     13380001
                                                                        13390001
            MOVE    WS-TEMP-TOTAL         TO  L436-DETL-AMT-TOTAL       13400001
                                              L436L-DETL-AMT-TOTAL.     13410001
                                                                        13420001
            MOVE    F315-SCH-ACC          TO  WS-SCH-ACCT-NO.           13430001
            MOVE    WS-TEMP-TOTAL         TO  WS-AMT-TRANS.             13440001
            ADD     1                     TO  WS-L436J-PRINT-CNT.       13450001
            ADD     WS-MORT-SF            TO  WS-L436J-MORT-CNT.        13460001
            ADD     WS-DUP-DOA            TO  WS-L436J-DUP-DOA-CNT.     13470001
            ADD     WS-LEASE-STAMP        TO  WS-L436J-LEASE-CNT.       13480001
            ADD     WS-TEMP-TOTAL         TO  WS-L436J-IND-TOT-CNT.     13490001
            MOVE    WS-L436J-IND-TOT-CNT  TO  WS-AMT-TOTAL.             13500001
            IF F315-CDE-TRANS = 'DB'                                    13510001
               WRITE   L436J-PRINT-REC  FROM  L436-REC-DETAIL AFTER 1   13520001
            ELSE                                                        13530001
               IF F315-CDE-TRANS = 'DS'                                 13540001
                  WRITE L436L-PRINT-REC FROM L436L-REC-DETAIL AFTER 1   13550001
               END-IF                                                   13560001
            END-IF.                                                     13570001
                                                                        13580001
            MOVE    'J'                   TO  WS-PREV-REPORT-ID.        13590001
            MOVE   'NS PAYMENT FOR LEASE/MORTGAGE STAMP FEES'           13600001
                                          TO  WS-TXT-INFO.              13610001
            IF  F315-CDE-TRANS  = 'DS'                                  13620001
                MOVE   'NS PAYMENT FOR LEASE PREPARATION FEES'          13630001
                                          TO  WS-TXT-INFO               13640001
            END-IF.                                                     13650001
                                                                        13660001
            PERFORM 5000-WRITE-TRANS-DETAIL-F225 THRU  5000-DETAIL-EXIT.13670001
                                                                        13680001
            IF (WS-CNT-DETAILS = MAX-DETLS-PER-PAGE)                    13690001
                PERFORM 5000-WRITE-TRAILER-F225  THRU 5000-TRAILER-EXIT 13700001
                MOVE    ZEROES                   TO   WS-CNT-DETAILS    13710001
                MOVE    'Y'                      TO   WS-NEW-BATCH      13720001
                                                      WS-NEW-VOUCHER    13730001
                                                      WS-NEW-HEADER     13740001
            END-IF.                                                     13750001
                                                                        13760001
       2150-EXIT.                                                       13770001
            EXIT.                                                       13780001
                                                                        13790001
                                                                        13800001
      ******************************************************************13810001
       4200-PRINT-LAST-LINES.                                           13820001
      ******************************************************************13830001
            PERFORM 5000-WRITE-TRAILER-F225                             13840001
               THRU 5000-TRAILER-EXIT.                                  13850001
                                                                        13860001
       4200-EXIT.                                                       13870001
            EXIT.                                                       13880001
                                                                        13890001
                                                                        13900001
      ******************************************************************13910001
       4295-PRINT-L436J-GRAND-TOTAL.                                    13920001
      ******************************************************************13930001
            IF WS-CNT-DETAILS = ZEROES                                  13940001
               GO TO 4295-EXIT                                          13950001
            END-IF.                                                     13960001
                                                                        13970001
            MOVE  WS-CNT-DETAILS        TO L436-VR-NO-HIGH              13980001
                                           L436L-VR-NO-HIGH             13990001
            MOVE  WS-L436J-MORT-CNT     TO L436-TOTAL-MORT-SF.          14000001
            MOVE  WS-L436J-DUP-DOA-CNT  TO L436-TOTAL-DUP-DOA.          14010001
            MOVE  WS-L436J-LEASE-CNT    TO L436-TOTAL-SUP-LEASE-SF      14020001
                                           L436L-TOTAL-SUP-LEASE-SF.    14030001
            MOVE  WS-L436J-IND-TOT-CNT  TO L436-TOTAL-AMT               14040001
                                           L436L-TOTAL-AMT.             14050001
            IF  F315-CDE-TRANS  = 'DB'                                  14060001
                WRITE L436J-PRINT-REC  FROM PRT-L436-DASH-LINE  AFTER 2 14070001
                WRITE L436J-PRINT-REC  FROM PRT-L436-TOTAL-LINE AFTER 1 14080001
                WRITE L436J-PRINT-REC  FROM PRT-L436-DASH-LINE  AFTER 1 14090001
            ELSE                                                        14100001
              IF F315-CDE-TRANS  = 'DS'                                 14110001
                WRITE L436L-PRINT-REC  FROM PRT-L436-DASH-LINE  AFTER 2 14120001
                WRITE L436L-PRINT-REC FROM PRT-L436L-TOTAL-LINE AFTER 1 14130001
                WRITE L436L-PRINT-REC FROM PRT-L436-DASH-LINE  AFTER 1  14140001
              END-IF                                                    14150001
            END-IF.                                                     14160001
            MOVE     WS-L436J-IND-TOT-CNT  TO   WS-AMT.                 14170001
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.              14180001
            MOVE     WP-ITEM (1)           TO   L436-AMT-DESC1.         14190001
            MOVE     WP-ITEM (2)           TO   L436-AMT-DESC2.         14200001
                                                                        14210001
            WRITE    L436J-PRINT-REC       FROM PRT-L436-FTG-1 AFTER 3. 14220001
            WRITE    L436L-PRINT-REC       FROM PRT-L436-FTG-1 AFTER 3. 14230001
            WRITE    L436J-PRINT-REC       FROM PRT-L436-FTG-2 AFTER 6. 14240001
            MOVE     SPACES                TO L436L-PRINT-REC.          14250001
            WRITE    L436L-PRINT-REC                                    14260001
            WRITE    L436L-PRINT-REC       FROM PRT-L436-FTG-2 AFTER 6. 14270001
                                                                        14280001
            MOVE     ZEROES                TO   WS-L436J-MORT-CNT       14290001
                                                WS-L436J-DUP-DOA-CNT    14300001
                                                WS-L436J-LEASE-CNT      14310001
                                                WS-L436J-IND-TOT-CNT.   14320001
       4295-EXIT.                                                       14330001
            EXIT.                                                       14340001
                                                                        14350001
                                                                        14360001
      ******************************************************************14370001
       4770-PRINT-L436J-HEADER.                                         14380001
      ******************************************************************14390001
            IF F315-CDE-TRANS = 'DB'                                    14400001
               MOVE 'P13L436J'          TO L436-REPORT-ID               14410001
            ELSE                                                        14420001
               IF F315-CDE-TRANS = 'DS'                                 14430001
                  MOVE 'P13L436L'          TO L436-REPORT-ID            14440001
               END-IF                                                   14450001
            END-IF                                                      14460001
                                                                        14470001
            MOVE  WS-L436J-DESC      TO L436-REPORT-ID-DESC.            14480001
            MOVE  WS-L436JL-DESC     TO L436L-REPORT-ID-DESC.           14490001
            MOVE 'LEASE     '        TO L436-SUP-LEASE-DESC.            14500001
            MOVE '   '               TO L436-TAG-DESC.                  14510001
            ADD   1                  TO WS-L436J-PAGE-CNT.              14520001
            MOVE  WS-L436J-PAGE-CNT  TO L436-PAGE.                      14530001
                                                                        14540001
            MOVE "FINANCE'S COPY"          TO L436-COPY-NAME.           14550001
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-1    AFTER PAGE.   14560001
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-2    AFTER 2.      14570001
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-3    AFTER 1.      14580001
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-4    AFTER 2.      14590001
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-5    AFTER 1.      14600001
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-6    AFTER 1.      14610001
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-7    AFTER 1.      14620001
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-8    AFTER 1.      14630001
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-9    AFTER 1.      14640001
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-10   AFTER 1.      14650001
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-10A  AFTER 1.      14660001
            WRITE L436J-PRINT-REC  FROM PRT-L436-HDG-11   AFTER 1.      14670001
            WRITE L436J-PRINT-REC  FROM PRT-L436-SUBHDG-1 AFTER 3.      14680001
            WRITE L436J-PRINT-REC  FROM PRT-L436-SUBHDG-2 AFTER 1.      14690001
            WRITE L436J-PRINT-REC  FROM PRT-L436-SUBHDG-3 AFTER 1.      14700001
            MOVE  SPACES             TO L436J-PRINT-REC.                14710001
            WRITE L436J-PRINT-REC AFTER 1.                              14720001
                                                                        14730001
            WRITE L436L-PRINT-REC  FROM PRT-L436-HDG-1    AFTER PAGE.   14740001
            WRITE L436L-PRINT-REC  FROM PRT-L436-HDG-2    AFTER 2.      14750001
            WRITE L436L-PRINT-REC  FROM PRT-L436L-HDG-3    AFTER 1.     14760001
            WRITE L436L-PRINT-REC  FROM PRT-L436-HDG-4    AFTER 2.      14770001
            WRITE L436L-PRINT-REC  FROM PRT-L436-HDG-5    AFTER 1.      14780001
            WRITE L436L-PRINT-REC  FROM PRT-L436-HDG-6    AFTER 1.      14790001
            WRITE L436L-PRINT-REC  FROM PRT-L436-HDG-7    AFTER 1.      14800001
            WRITE L436L-PRINT-REC  FROM PRT-L436-HDG-8    AFTER 1.      14810001
            WRITE L436L-PRINT-REC  FROM PRT-L436L-HDG-9    AFTER 1.     14820001
            WRITE L436L-PRINT-REC  FROM PRT-L436L-HDG-10   AFTER 1.     14830001
            WRITE L436L-PRINT-REC  FROM PRT-L436L-HDG-11   AFTER 1.     14840001
            WRITE L436L-PRINT-REC  FROM PRT-L436L-SUBHDG-1A AFTER 1.    14850001
            MOVE SPACES TO L436L-PRINT-REC.                             14860001
            WRITE L436L-PRINT-REC.                                      14870001
            WRITE L436L-PRINT-REC  FROM PRT-L436L-SUBHDG-1 AFTER 3.     14880001
            WRITE L436L-PRINT-REC  FROM PRT-L436L-SUBHDG-2 AFTER 1.     14890001
            WRITE L436L-PRINT-REC  FROM PRT-L436L-SUBHDG-3 AFTER 1.     14900001
            MOVE  SPACES             TO L436L-PRINT-REC.                14910001
            WRITE L436L-PRINT-REC AFTER 1.                              14920001
                                                                        14930001
       4770-EXIT.                                                       14940001
            EXIT.                                                       14950001
                                                                        14960001
                                                                        14970001
      ******************************************************************14980001
       5000-WRITE-HEADER-F225.                                          14990001
      ******************************************************************15000001
            INITIALIZE                         AG07F225-HEADER.         15010001
            MOVE    SPACES                TO   AG07F225-HEADER.         15020001
                                                                        15030001
            MOVE    C907-NUM-DDD          TO   F225-NUM-DDD.            15040001
            MOVE    C907-NUM-FIN-YR       TO   F225-NUM-FIN-YEAR.       15050001
            MOVE    C907-NUM-VR-SERIAL    TO   F225-NUM-VR-SERIAL.      15060001
            MOVE    F225-NUM-VR           TO   WS-NUM-VOUCHER.          15070001
            MOVE    00                    TO   F225-NUM-REC-TYP.        15080001
            MOVE   'PV'                   TO   F225-NUM-VR-TYP.         15090001
            MOVE   'TL'                   TO   F225-NUM-VR-SUB-TYP.     15100001
            MOVE   'SOC'                  TO   F225-NUM-TRANS-TYP.      15110001
            MOVE  FUNCTION CURRENT-DATE   TO   F225-DTE-VR-CREATE       15120001
                                               F225-DTE-VR-PRT-FINAL.   15130001
            MOVE   'BP13C436'      TO   F225-NUM-VR-CREATE-USERID       15140001
                                        F225-NUM-VR-PRT-FINAL-USERID.   15150001
            MOVE   'STPFEE  '      TO   F225-NUM-DDD-FILE-REF.          15160001
            MOVE   'COMMISSIONER OF STAMP DUTIES'   TO  F225-NME-PAYEE1.15170001
      *     MOVE   'C/O SC(STAMPING) OF SALES UNIT' TO  F225-NME-STREET.15180001
            MOVE   'SALES AGREEMENT TEAM' TO   F225-NME-COLL-OFFCR.     15190001
            MOVE   '64903781'           TO   F225-NUM-COLL-OFFCR-PHONE. 15200001
            MOVE   'SALES AGREEMENT TEAM' TO F225-NME-CONTACT-OFFCR.    15210001
            MOVE   '64903781'           TO  F225-NUM-CONTACT-PHONE.     15220001
            MOVE   'DBSSSGSGXXX'        TO  F225-NUM-PAYEE-BANK.        15230001
            MOVE   SPACES               TO  F225-NUM-PAYEE-BANK-BRNCH.  15240001
            MOVE   '0010468600'         TO  F225-NUM-PAYEE-IBG-ACCT.    15250001
            MOVE   SPACES               TO  F225-NUM-ROOT-ACCT.         15260001
            MOVE   SPACES               TO  F225-NUM-PAYEE-UIN1.        15270001
            MOVE   SPACES               TO  F225-NME-PAYEE2.            15280001
            MOVE   SPACES               TO  F225-NUM-PAYEE-UIN2.        15290001
            MOVE   SPACES               TO  F225-NUM-PAYEE-TAX-REGN.    15300001
            MOVE   '55'                 TO  F225-NUM-BLK-HSE.           15301001
            MOVE   'NEWTON ROAD'        TO  F225-NME-STREET.            15302001
            MOVE   'REVENUE HOUSE'      TO  F225-NME-BLDNG.             15303001
            MOVE   '307987'             TO  F225-NUM-POSTAL.            15304001
            MOVE   SPACES               TO  F225-TXT-REJECT-HDR.        15310001
            MOVE   'STPFEE  '           TO  F225-NUM-INTRFC-FR-HDR.     15320001
            MOVE   'CV'                 TO  F225-NUM-ACTION-TYP.        15330001
            MOVE   SPACES               TO  F225-NUM-PRCS-TERM.         15340001
            MOVE   SPACES               TO  F225-NUM-ROUTE-FLAG.        15350001
            IF F315-USERID   = 'BP13P001'                               15360001
              MOVE WS-STAFF-START         TO F225-NUM-STAFF-ID-PREP     15370001
                                             F225-NUM-USERID-START      15380001
            ELSE                                                        15390001
              MOVE F315-USERID            TO F225-NUM-STAFF-ID-PREP     15400001
                                             F225-NUM-USERID-START      15410001
            END-IF.                                                     15420001
            MOVE   'PREP'               TO   F225-NUM-VCHR-STATE-START. 15430001
            MOVE   SPACES               TO   F225-DTE-PYMNT-DUE.        15440001
                                                                        15450001
            IF F315-CDE-TRANS = 'DS'                                    15460001
               MOVE WS-NME-FIN-SOLICITOR    TO   F225-NME-PAYEE1        15470001
               MOVE  'C/O MR BALA OF SALES OPERATION'  TO               15480001
                                                 F225-NME-STREET        15490001
               MOVE   'MR BALA       '     TO   F225-NME-COLL-OFFCR     15500001
               MOVE   SPACES            TO F225-NUM-PAYEE-BANK          15510001
                                           F225-NUM-PAYEE-BANK-BRNCH    15520001
                                           F225-NUM-PAYEE-IBG-ACCT      15530001
            END-IF.                                                     15540001
                                                                        15550001
            WRITE AG07F225-HEADER.                                      15560001
                                                                        15570001
            ADD     1                     TO   WS-AG07F225-WRITE-CNT.   15580001
            MOVE    C907-NUM-DDD          TO   WS-EDITED-NUM-DDD.       15590001
            MOVE    C907-NUM-FIN-YR       TO   WS-EDITED-NUM-FIN-YEAR.  15600001
            MOVE    C907-NUM-VR-SERIAL    TO   WS-EDITED-NUM-VR-SERIAL. 15610001
            MOVE    WS-EDITED-VOUCHER-NO  TO   L436-VOUCHER-NO.         15620001
                                                                        15630001
            MOVE    SPACES                TO   L436-BATCH-NO.           15640001
                                                                        15650001
            STRING WS-NUM-BATCH-TYPE   DELIMITED BY SPACE               15660001
                   WS-NUM-FIN-YEAR     DELIMITED BY SPACE               15670001
                   '-'                 DELIMITED BY SIZE                15680001
                   WS-NUM-BATCH-SERIAL DELIMITED BY SPACE               15690001
                   INTO L436-BATCH-NO                                   15700001
            END-STRING.                                                 15710001
                                                                        15720001
            EVALUATE TRUE                                               15730001
            WHEN     REPORT-L436J                                       15740001
               PERFORM 4770-PRINT-L436J-HEADER   THRU 4770-EXIT         15750001
            END-EVALUATE.                                               15760001
                                                                        15770001
       5000-HEADER-EXIT.                                                15780001
            EXIT.                                                       15790001
                                                                        15800001
                                                                        15810001
      ******************************************************************15820001
       5000-WRITE-TRANS-DETAIL-F225.                                    15830001
      ******************************************************************15840001
            INITIALIZE AG07F225-TRANS.                                  15850001
            MOVE    SPACES             TO    AG07F225-TRANS.            15860001
            MOVE    WS-NUM-VOUCHER     TO    F225-NUM-VR-T.             15870001
            MOVE    WS-CNT-DETAILS     TO    F225-NUM-TRANS-SERIAL.     15880001
            MOVE   '04'                TO    F225-NUM-SYS.              15890001
            MOVE    WS-SCH-ACCT-NO     TO    F225-NUM-HDB-REF.          15900001
            MOVE   '0000000104250'     TO    F225-NUM-GL-ACCT.          15910001
            MOVE    WS-AMT-TRANS       TO    F225-AMT-TRANS.            15920001
            MOVE   'D'                 TO    F225-NUM-TRANS-DR-CR       15930001
            MOVE    ZEROES             TO    F225-AMT-TRANS-GST.        15940001
            MOVE    WS-TXT-INFO        TO    F225-TXT-INFO.             15950001
            MOVE    SPACES             TO    F225-NUM-TAX-CDE.          15960001
            MOVE    SPACES             TO    F225-NUM-CPF.              15970001
            MOVE    SPACES             TO    F225-TXT-REJECT-DTL.       15980001
            MOVE    'STPFEE  '          TO  F225-NUM-INTRFC-FR-T.       15990001
                                                                        16000001
            WRITE   AG07F225-TRANS.                                     16010001
                                                                        16020001
            ADD     1                  TO    WS-AG07F225-WRITE-CNT.     16030001
                                                                        16040001
       5000-DETAIL-EXIT.                                                16050001
            EXIT.                                                       16060001
                                                                        16070001
                                                                        16080001
      ******************************************************************16090001
       5000-WRITE-TRAILER-F225.                                         16100001
      ******************************************************************16110001
            IF WS-CNT-DETAILS = ZEROES                                  16120001
               GO TO 5000-TRAILER-EXIT                                  16130001
            END-IF.                                                     16140001
                                                                        16150001
            EVALUATE TRUE                                               16160001
            WHEN REPORT-L436J                                           16170001
               PERFORM 4295-PRINT-L436J-GRAND-TOTAL THRU 4295-EXIT      16180001
               MOVE    WS-AMT             TO  WS-AMT-TOTAL              16190001
            END-EVALUATE.                                               16200001
                                                                        16210001
            INITIALIZE AG07F225-TRAILER.                                16220001
            MOVE       SPACES             TO  AG07F225-TRAILER.         16230001
            MOVE       WS-NUM-VOUCHER     TO  F225-NUM-VR-R.            16240001
            MOVE       99                 TO  F225-NUM-TRAILER-SERIAL.  16250001
            MOVE       'PAYMENT FOR LEASE/MORTGAGE STAMP FEES'          16260001
                                          TO  F225-TXT-VOUCHER-NARRATION16270001
            IF  F315-CDE-TRANS  = 'DS'                                  16280001
                MOVE       'PAYMENT FOR LEASE PREPARATION FEES'         16290001
                                         TO  F225-TXT-VOUCHER-NARRATION 16300001
            END-IF.                                                     16310001
                                                                        16320001
            MOVE       WS-CNT-DETAILS     TO  F225-QTY-VR-TRANS.        16330001
            MOVE       WS-AMT-TOTAL       TO  F225-AMT-VR-DR-TOTAL.     16340001
            MOVE       ZEROES             TO  F225-AMT-VR-CR-TOTAL.     16350001
            MOVE       SPACES             TO  F225-TXT-REJECT-TLR.      16360001
            MOVE       'STPFEE  '         TO  F225-NUM-INTRFC-FR.       16370001
                                                                        16380001
            WRITE      AG07F225-TRAILER.                                16390001
                                                                        16400001
            ADD        1                  TO    WS-AG07F225-WRITE-CNT.  16410001
                                                                        16420001
       5000-TRAILER-EXIT.                                               16430001
            EXIT.                                                       16440001
                                                                        16450001
                                                                        16460001
      ******************************************************************16470001
       6000-WRITE-STAMPING-FILE.                                        16480001
      ******************************************************************16490001
            DISPLAY '6000-WRITE-STAMPING-FILE'.                         16500001
            INITIALIZE BP13K625-REC.                                    16510001
            MOVE  SPACES                TO BP13K625-REC.                16520001
                                                                        16530001
            MOVE F315-SCH-ACC           TO WS-NUM-HDB-REF.              16540001
            MOVE 'DAS'                  TO WS-NUM-DOC.                  16550001
                                                                        16560001
      ****  WRITE DETAIL PART FOR ORIGINAL MORTGAGE STAMP FEE*******    16570001
            MOVE  'O'                   TO WS-NUM-DOC-TYP.              16580001
                                                                        16590001
            IF WS-MORT-SF > 0                                           16600001
               COMPUTE WS-MORT-SF = WS-MORT-SF - DUP-DOA-AMT            16610001
            END-IF.                                                     16620001
                                                                        16630001
            MOVE  WS-MORT-SF             TO WS-AMT-STAMP-DUTY.          16640001
            MOVE  ZEROES                 TO WS-AMT-STAMP-DUTY-DUP.      16650001
                                                                        16660001
            IF WS-AMT-STAMP-DUTY > 0                                    16670001
               PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT        16680001
               PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT        16690001
               MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY        16700001
               MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP    16710001
               WRITE BP13K625-REC                                       16720001
               ADD   1   TO  WS-BP13K625-WRITE-CNT                      16730001
            ELSE                                                        16740001
               NEXT SENTENCE                                            16750001
            END-IF.                                                     16760001
                                                                        16770001
      ****  WRITE DETAIL PART FOR DUPLICATE MORTGAGE STAMP FEE*******   16780001
            MOVE  'D'                    TO WS-NUM-DOC-TYP.             16790001
            MOVE  ZEROES                 TO WS-AMT-STAMP-DUTY.          16800001
            MOVE  WS-DUP-DOA             TO WS-AMT-STAMP-DUTY-DUP.      16810001
                                                                        16820001
            IF WS-AMT-STAMP-DUTY-DUP > 0                                16830001
               PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT        16840001
               PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT        16850001
               MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY        16860001
               MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP    16870001
               WRITE BP13K625-REC                                       16880001
               ADD   1   TO  WS-BP13K625-WRITE-CNT                      16890001
            ELSE                                                        16900001
               NEXT SENTENCE                                            16910001
            END-IF.                                                     16920001
                                                                        16930001
      ****  WRITE DETAIL PART FOR ORIGINAL S&P FEE   *******            16940001
            MOVE  'ALE'               TO WS-NUM-DOC.                    16950001
            MOVE  'O'                 TO WS-NUM-DOC-TYP.                16960001
            PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT.          16970001
            PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT.          16980001
            MOVE  WS-LEASE-STAMP      TO K625-AMT-STAMP-DUTY.           16990001
            MOVE  ZEROES              TO K625-AMT-STAMP-DUTY-DUP.       17000001
            WRITE BP13K625-REC.                                         17010001
            ADD   1                   TO WS-BP13K625-WRITE-CNT.         17020001
                                                                        17030001
      ****  WRITE DETAIL PART FOR DUPLICATE S&P FEE   *******           17040001
            MOVE  'D'                 TO WS-NUM-DOC-TYP.                17050001
            PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT.          17060001
            PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT.          17070001
            MOVE  ZEROES              TO K625-AMT-STAMP-DUTY.           17080001
            MOVE  DUP-SA-AMT          TO K625-AMT-STAMP-DUTY-DUP.       17090001
            WRITE BP13K625-REC.                                         17100001
            ADD   1                   TO WS-BP13K625-WRITE-CNT.         17110001
                                                                        17120001
       6000-EXIT.                                                       17130001
           EXIT.                                                        17140001
                                                                        17150001
                                                                        17160001
      ******************************************************************17170001
       6100-CHK-EXISTING-BP13K625.                                      17180001
      ******************************************************************17190001
           MOVE WS-NUM-HDB-REF          TO K625-NUM-HDB-REF.            17200001
           MOVE WS-NUM-DOC              TO K625-NUM-DOC.                17210001
           MOVE WS-NUM-DOC-TYP          TO K625-NUM-DOC-TYP.            17220001
           MOVE 1                       TO K625-NUM-DOC-CNT.            17230001
           MOVE 'N'                     TO WS-K625-EOF.                 17240001
                                                                        17250001
           START BP13K625 KEY = K625-KEY-FLD.                           17260001
                                                                        17270001
           EVALUATE  WS-K625-STATUS                                     17280001
              WHEN '00'                                                 17290001
                    PERFORM 6200-READNEXT-BP13K625 THRU 6200-EXIT       17300001
                            UNTIL WS-K625-EOF = 'Y'                     17310001
                    ADD  1              TO WS-NUM-DOC-CNT               17320001
              WHEN '10'                                                 17330001
              WHEN '23'                                                 17340001
                    MOVE 1              TO WS-NUM-DOC-CNT               17350001
              WHEN OTHER                                                17360001
                    DISPLAY 'ERROR WHILE STARTING BROWSE-BP13K625 '     17370001
                    MOVE WS-K625-STATUS TO RETURN-CODE                  17380001
                    PERFORM 9000-CLOSE-FILES THRU 9000-EXIT             17390001
           END-EVALUATE.                                                17400001
                                                                        17410001
       6100-EXIT.                                                       17420001
           EXIT.                                                        17430001
                                                                        17440001
                                                                        17450001
      ******************************************************************17460001
       6200-READNEXT-BP13K625.                                          17470001
      ******************************************************************17480001
           READ BP13K625 NEXT AT END MOVE 'Y' TO WS-K625-EOF            17490001
              GO TO 6200-EXIT.                                          17500001
                                                                        17510001
           IF (K625-NUM-HDB-REF NOT = WS-NUM-HDB-REF) OR                17520001
              (K625-NUM-DOC     NOT = WS-NUM-DOC)     OR                17530001
              (K625-NUM-DOC-TYP NOT = WS-NUM-DOC-TYP)                   17540001
              MOVE 'Y'                  TO WS-K625-EOF                  17550001
              GO TO 6200-EXIT                                           17560001
           END-IF.                                                      17570001
                                                                        17580001
           MOVE K625-NUM-DOC-CNT        TO WS-NUM-DOC-CNT.              17590001
                                                                        17600001
       6200-EXIT.                                                       17610001
           EXIT.                                                        17620001
                                                                        17630001
                                                                        17640001
      ******************************************************************17650001
       6300-MAIN-DETAILS-TO-K625.                                       17660001
      ******************************************************************17670001
            MOVE  SPACES                 TO BP13K625-REC.               17680001
            INITIALIZE                      BP13K625-REC.               17690001
            COMPUTE  WS-ANNUAL-RENT = 0                                 17700001
                                                                        17710001
            MOVE  F315-SCH-ACC           TO K625-NUM-HDB-REF.           17720001
            MOVE  WS-NUM-DOC             TO K625-NUM-DOC.               17730001
            MOVE  WS-NUM-DOC-TYP         TO K625-NUM-DOC-TYP.           17740001
            MOVE  WS-NUM-DOC-CNT         TO K625-NUM-DOC-CNT.           17750001
            MOVE  C907-NUM-DDD           TO K625-NUM-DDD.               17760001
            MOVE  C907-NUM-FIN-YR        TO K625-NUM-FIN-YEAR.          17770001
            MOVE  C907-NUM-VR-SERIAL     TO K625-NUM-VR-SERIAL.         17780001
            MOVE  C906-NUM-BATCH-TYPE    TO K625-NUM-BATCH-TYPE.        17790001
            MOVE  C906-NUM-FIN-YEAR      TO K625-NUM-CAL-YEAR.          17800001
            MOVE  C906-NUM-BATCH-SERIAL  TO K625-NUM-BATCH-SERIAL.      17810001
            MOVE  F315-REGN-NO           TO K625-NUM-REGN.              17820001
            MOVE  WS-DTE-SALE-AGRM       TO K625-DTE-DOC-PREPARE.       17830001
            MOVE  WS-SELL-PRICE          TO K625-AMT-PURCHASE-PRICE.    17840001
            MOVE  WS-ANNUAL-RENT         TO K625-AMT-ANNUAL-RENT.       17850001
            MOVE  SPACES                 TO K625-NUM-INCREASE-SCCC.     17860001
            MOVE  WS-LOAN-GRANTED        TO K625-AMT-LOAN.              17870001
            MOVE  'BP13C43D'             TO K625-NUM-SYSTEM.            17880001
            MOVE  FUNCTION CURRENT-DATE  TO K625-DTE-UPDATE.            17890001
            COMPUTE K625-NUM-LEASE-TERM = 99 * 12.                      17900001
                                                                        17910001
       6300-EXIT.                                                       17920001
           EXIT.                                                        17930001
                                                                        17940001
                                                                        17950001
      ******************************************************************17960001
       6500-PRINT-L436K-REPORT.                                         17970001
      ******************************************************************17980001
           IF WS-L436K-REC-ON-PAGE-CNT > 65                             17990001
              PERFORM 6510-PRINT-L436-HEADER     THRU 6510-EXIT         18000001
           END-IF.                                                      18010001
                                                                        18020001
           MOVE SPACES                TO L436K-REC-DETAIL.              18030001
           INITIALIZE                    L436K-REC-DETAIL.              18040001
                                                                        18050001
           ADD  1                     TO WS-L436K-PRINT-CNT.            18060001
           MOVE WS-L436K-PRINT-CNT    TO L436K-SERIAL-NO.               18070001
           MOVE F315-REGN-NO          TO L436K-REGN-NO.                 18080001
                                                                        18090001
           STRING F315-SCH-ACC(1:4) '-'                                 18100001
                  F315-SCH-ACC(5:4) '-'                                 18110001
                  F315-SCH-ACC(9:1) '-'                                 18120001
                  F315-SCH-ACC(10:2)                                    18130001
                  DELIMITED BY SIZE INTO L436K-SCH-ACC                  18140001
           END-STRING.                                                  18150001
                                                                        18160001
           STRING C907-NUM-DDD    '-'                                   18170001
                  C907-NUM-FIN-YR '-'                                   18180001
                  C907-NUM-VR-SERIAL                                    18190001
                  DELIMITED BY SIZE INTO L436K-JR-VCHR-NO               18200001
           END-STRING.                                                  18210001
                                                                        18220001
           MOVE WS-AMT-EARMARK    TO L436K-AMT-TOTAL.                   18230001
                                                                        18240001
           EVALUATE B902-CDE-ERROR-ACCT(1)                              18250001
              WHEN 'S0045'                                              18260001
                 MOVE 'B05K006 FILE ERROR'         TO L436K-ERROR-DESC  18270001
              WHEN 'S0052'                                              18280001
                 MOVE 'INVALID INPUT      '        TO L436K-ERROR-DESC  18290001
              WHEN 'S0053'                                              18300001
                 MOVE 'AB05K009 FILE ERROR'        TO L436K-ERROR-DESC  18310001
              WHEN 'S0054'                                              18320001
                 MOVE 'B05K006 REC NOT FND'        TO L436K-ERROR-DESC  18330001
              WHEN 'S0055'                                              18340001
                 MOVE 'NOT ENOUGH BALANCE'         TO L436K-ERROR-DESC  18350001
              WHEN OTHER                                                18360001
                 MOVE 'AB05C902 SUBROUTINE ERROR'  TO L436K-ERROR-DESC  18370001
           END-EVALUATE.                                                18380001
                                                                        18390001
           WRITE L436K-PRINT-REC  FROM L436K-REC-DETAIL  AFTER 1.       18400001
                                                                        18410001
           ADD   1     TO  WS-L436K-REC-ON-PAGE-CNT.                    18420001
                                                                        18430001
       6500-EXIT.                                                       18440001
           EXIT.                                                        18450001
                                                                        18460001
                                                                        18470001
      ******************************************************************18480001
       6510-PRINT-L436-HEADER.                                          18490001
      ******************************************************************18500001
           ADD  1                 TO   WS-L436K-PAGE-CNT.               18510001
           MOVE WS-L436K-PAGE-CNT TO   L436-PAGE.                       18520001
           MOVE 'P13L436K'        TO   L436-REPORT-ID.                  18530001
           WRITE L436K-PRINT-REC  FROM PRT-L436-HDG-1    AFTER PAGE.    18540001
           WRITE L436K-PRINT-REC  FROM L436K-HEADER2     AFTER 2.       18550001
           WRITE L436K-PRINT-REC  FROM L436K-HEADER3     AFTER 2.       18560001
           WRITE L436K-PRINT-REC  FROM L436K-UNDERLINE   AFTER 1.       18570001
           MOVE  6                TO   WS-L436K-REC-ON-PAGE-CNT.        18580001
                                                                        18590001
       6510-EXIT.                                                       18600001
           EXIT.                                                        18610001
                                                                        18620001
                                                                        18630001
      ******************************************************************18640001
       8000-DISPLAY-STATISTICS.                                         18650001
      ******************************************************************18660001
            MOVE    WS-BP13F315-READ-CNT  TO  WS-EDIT-BP13F315-READ.    18670001
            MOVE    WS-L436J-PRINT-CNT    TO  WS-EDIT-L436J-PRINT.      18680001
            MOVE    WS-AG07F225-WRITE-CNT TO  WS-EDIT-AG07F225-WRITE.   18690001
                                                                        18700001
            DISPLAY WS-BLANK-LINE.                                      18710001
            DISPLAY WS-SUMMARY-HEADER.                                  18720001
            DISPLAY WS-BLANK-LINE.                                      18730001
            DISPLAY WS-READ-CASES.                                      18740001
            DISPLAY WS-DOA-PAYMENT-PRINTED.                             18750001
            DISPLAY WS-L436J-PRINTED.                                   18760001
            DISPLAY WS-STAMP-FEES-REC-WRITTEN.                          18770001
            DISPLAY WS-BLANK-LINE.                                      18780001
            DISPLAY WS-SUMMARY-TRAILER.                                 18790001
            DISPLAY 'NO OF RECORDS WRITTEN TO             (BP13K625) = '18800001
                    WS-BP13K625-WRITE-CNT.                              18810001
            DISPLAY 'NO OF RECS WITH ERROR IN EARMARK                = '18820001
                    WS-L436K-PRINT-CNT.                                 18830001
                                                                        18840001
       8000-EXIT.                                                       18850001
            EXIT.                                                       18860001
                                                                        18870001
                                                                        18880001
      ******************************************************************18890001
       9000-CLOSE-FILES.                                                18900001
      ******************************************************************18910001
            CLOSE  B05K006                                              18920001
                   BP13F315                                             18930001
                   AG07F225                                             18940001
                   BP13K410                                             18950001
                   BP13436J                                             18960001
                   BP13436L                                             18970001
                   BP13436K                                             18980001
                   BP13K625.                                            18990001
                                                                        19000001
            IF WS-K006-STATUS NOT = 00 AND 97                           19010001
               DISPLAY 'ERROR CLOSING B05K006, STAT = ' WS-K006-STATUS  19020001
               MOVE     WS-K006-STATUS     TO  RETURN-CODE              19030001
            END-IF.                                                     19040001
                                                                        19050001
            IF WS-K410-STATUS NOT = 00 AND 97                           19060001
               DISPLAY 'ERROR CLOSING BP13K410, STAT = ' WS-K410-STATUS 19070001
               MOVE     WS-K410-STATUS      TO  RETURN-CODE             19080001
            END-IF.                                                     19090001
                                                                        19100001
            IF WS-KD00-STATUS NOT = 00 AND 97                           19110001
               DISPLAY 'ERROR CLOSING BP13KD00, STAT = ' WS-KD00-STATUS 19120001
               MOVE     WS-KD00-STATUS      TO  RETURN-CODE             19130001
            END-IF.                                                     19140001
                                                                        19150001
            IF WS-K625-STATUS NOT = 00 AND 97                           19160001
              DISPLAY 'ERROR CLOSING BP13K625, STAT = ' WS-K625-STATUS  19170001
              MOVE     WS-K625-STATUS      TO  RETURN-CODE              19180001
            END-IF.                                                     19190001
                                                                        19200001
            MOVE 'AG07K960'  TO     C907-NUM-FILENME.                   19210001
            CALL 'K960CLSE'  USING  AG07C907-AREA.                      19220001
                                                                        19230001
            IF C907-NUM-FILE-STATUS NOT = ('00' AND '97')               19240001
               DISPLAY 'ERROR CLOSING AG07K960, STATUS = '              19250001
                        C907-NUM-FILE-STATUS                            19260001
               MOVE     C907-NUM-FILE-STATUS    TO  WS-AG07-STAT-X      19270001
               MOVE     WS-AG07-STATUS          TO     RETURN-CODE      19280001
            END-IF.                                                     19290001
                                                                        19300001
            MOVE 'BP13K620'  TO     C906-NUM-FILENME.                   19310001
            CALL 'K620MCLS'  USING  BP13C906-AREA.                      19320001
                                                                        19330001
            IF C906-NUM-FILE-STATUS NOT = ('00' AND '97')               19340001
               DISPLAY 'ERROR CLOSING BP13K620, STATUS = '              19350001
                        C906-NUM-FILE-STATUS                            19360001
               MOVE     C906-NUM-FILE-STATUS    TO  WS-AG07-STAT-X      19370001
               MOVE     WS-AG07-STATUS          TO     RETURN-CODE      19380001
            END-IF.                                                     19390001
                                                                        19400001
      **CALL AB05C902 TO CLOSE B05K006 AND AB05K009 FILES(CODE='C')     19410001
            MOVE SPACES              TO   WS-B902-AREA.                 19420001
            INITIALIZE                    WS-B902-AREA.                 19430001
            MOVE 'C'                 TO   B902-CDE-TYPE.                19440001
            CALL 'AB05C902'  USING WS-B902-AREA.                        19450001
                                                                        19460001
            IF B902-CDE-ERROR NOT = ZEROES                              19470001
               MOVE B902-CDE-SYSERR  TO   RETURN-CODE                   19480001
               DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'            19490001
            END-IF.                                                     19500001
                                                                        19510001
            STOP RUN.                                                   19520001
                                                                        19530001
       9000-EXIT.                                                       19540001
            EXIT.                                                       19550001
                                                                        19560001
                                                                        19570001
      ******************************************************************19580001
       9500-CONVT-AMT-WORD.                                             19590001
      ******************************************************************19600001
      *------------------------------------------------------------*    19610001
      *                                                            *    19620001
      *     OBJECTIVE  :  CONVERSION FROM AMOUNT IN DIGITS         *    19630001
      *                              INTO AMOUNT IN WORDS          *    19640001
      *                                                            *    19650001
      *------------------------------------------------------------*    19660001
            MOVE SPACES TO WF-DETAILS.                                  19670001
            MOVE ZERO   TO WS-SWITCH                                    19680001
                           WS-THO-SW                                    19690001
                           WS-CNT-SW                                    19700001
                           WS-LIT-SW                                    19710001
                           WS-TEN-SW                                    19720001
                           WS-AND-SW.                                   19730001
            MOVE 60     TO WS-PLACE-COUNTER.                            19740001
            MOVE 1      TO WF-SUB.                                      19750001
                                                                        19760001
            PERFORM B000-ROUTINE THRU B990-EXIT                         19770001
                         VARYING WS-SUB FROM 1 BY 1 UNTIL WS-SUB = 10.  19780001
                                                                        19790001
       9500-EXIT.                                                       19800001
            EXIT.                                                       19810001
                                                                        19820001
                                                                        19830001
      ******************************************************************19840001
       B000-ROUTINE SECTION.                                            19850001
      ******************************************************************19860001
       B000-GO.                                                         19870001
            IF WS-DIGIT (WS-SUB) = ZERO                                 19880001
                 IF WS-TEN-SW = ZERO                                    19890001
                    GO TO B800-MOVE-TYPE                                19900001
                 ELSE                                                   19910001
                    GO TO B010-PROCESS.                                 19920001
                                                                        19930001
            IF WS-FIRST-SUB = ZERO                                      19940001
               MOVE WS-SUB TO WS-FIRST-SUB.                             19950001
                                                                        19960001
            IF WS-SWITCH = ZERO                                         19970001
               MOVE 1 TO WS-SWITCH.                                     19980001
                                                                        19990001
       B010-PROCESS.                                                    20000001
            IF WS-SUB = 8                                               20010001
               MOVE 9 TO WS-CNT-SW.                                     20020001
                                                                        20030001
            IF WS-SUB = 9                                               20040001
               IF WS-CNT-SW = ZERO                                      20050001
                  MOVE WS-DIGIT (WS-SUB) TO WS-CNT-SW.                  20060001
                                                                        20070001
            IF WS-SUB = 2 OR 3 OR 4                                     20080001
               MOVE 1 TO WS-THO-SW.                                     20090001
                                                                        20100001
            MOVE WS-DIGIT (WS-SUB) TO WA-SUB.                           20110001
            IF WS-SUB = 3 OR 6 OR 8                                     20120001
               IF WS-DIGIT (WS-SUB) = 1                                 20130001
                  MOVE 1 TO WS-TEN-SW                                   20140001
                  GO TO B990-EXIT                                       20150001
               ELSE                                                     20160001
                  ADD 18 TO WA-SUB                                      20170001
            ELSE                                                        20180001
            IF WS-SUB = 1 OR 4 OR 7 OR 9                                20190001
               IF WS-TEN-SW = 1                                         20200001
                  MOVE 0 TO WS-TEN-SW                                   20210001
                  ADD 10 TO WA-SUB.                                     20220001
            MOVE WA-NAME (WA-SUB) TO WL-AREA.                           20230001
            PERFORM R000-LOAD-IN.                                       20240001
                                                                        20250001
       B300-TENS.                                                       20260001
            IF WS-SUB = 3 OR 6 OR 8                                     20270001
               GO TO B990-EXIT.                                         20280001
                                                                        20290001
       B400-MOVE-HUNDRED.                                               20300001
            IF WS-SUB = 2 OR 5                                          20310001
               MOVE L-HUNDRED TO WL-AREA                                20320001
               MOVE 1 TO WS-LIT-SW                                      20330001
               PERFORM R000-LOAD-IN                                     20340001
               MOVE 1 TO WS-AND-SW                                      20350001
               GO TO B990-EXIT.                                         20360001
                                                                        20370001
       B800-MOVE-TYPE.                                                  20380001
            IF WS-SWITCH = ZERO                                         20390001
               GO TO B990-EXIT.                                         20400001
                                                                        20410001
            IF WS-SUB = 1                                               20420001
               MOVE  L-MILLION TO WL-AREA                               20430001
               MOVE  1         TO WS-LIT-SW                             20440001
               MOVE  1         TO WS-AND-SW                             20450001
               GO TO B880-LOAD-IN.                                      20460001
                                                                        20470001
            IF WS-SUB = 7                                               20480001
               MOVE 1 TO WS-LIT-SW WS-AND-SW                            20490001
               IF WS-FIRST-SUB = 7  AND                                 20500001
                  WS-DIGIT (WS-SUB) = 1                                 20510001
                  MOVE L-DOLLAR TO WL-AREA                              20520001
                  GO TO B880-LOAD-IN                                    20530001
               ELSE                                                     20540001
                  MOVE L-DOLLARS TO WL-AREA                             20550001
                  GO TO B880-LOAD-IN.                                   20560001
                                                                        20570001
            IF WS-SUB = 4 AND WS-THO-SW = 1                             20580001
               MOVE 1 TO WS-AND-SW WS-LIT-SW                            20590001
               MOVE L-THOUSAND TO WL-AREA                               20600001
               GO TO B880-LOAD-IN.                                      20610001
                                                                        20620001
            IF WS-SUB = 9                                               20630001
               MOVE 1 TO WS-LIT-SW                                      20640001
               IF WS-CNT-SW = ZERO                                      20650001
                  MOVE L-ONLY TO WL-AREA                                20660001
                  GO TO B880-LOAD-IN                                    20670001
               ELSE                                                     20680001
               IF WS-CNT-SW = 1                                         20690001
                  MOVE L-CENT TO WL-AREA                                20700001
                  PERFORM R000-LOAD-IN                                  20710001
                  MOVE L-ONLY TO WL-AREA                                20720001
                  GO TO B880-LOAD-IN                                    20730001
               ELSE                                                     20740001
                  MOVE L-CENTS TO WL-AREA                               20750001
                  PERFORM R000-LOAD-IN                                  20760001
                  MOVE L-ONLY TO WL-AREA                                20770001
                  GO TO B880-LOAD-IN.                                   20780001
            GO TO B990-EXIT.                                            20790001
                                                                        20800001
       B880-LOAD-IN.                                                    20810001
            PERFORM R000-LOAD-IN.                                       20820001
                                                                        20830001
       B990-EXIT.                                                       20840001
            EXIT.                                                       20850001
                                                                        20860001
                                                                        20870001
      ******************************************************************20880001
       R000-LOAD-IN SECTION.                                            20890001
      ******************************************************************20900001
      *------------------------------------------------------------*    20910001
      *                                                            *    20920001
      *     THIS SECTION LOADS THE WORDS INTO THE THREE LINES      *    20930001
      *     AND JUST KEEPS INCREMENTING A SUBSCRIPT.               *    20940001
      *                                                            *    20950001
      *------------------------------------------------------------*    20960001
                                                                        20970001
       R001-GO.                                                         20980001
            IF WS-LIT-SW = 1                                            20990001
               MOVE ZERO TO WS-LIT-SW                                   21000001
               GO TO R050-CONT.                                         21010001
                                                                        21020001
            IF WS-SUB = 2 OR 5                                          21030001
               GO TO R050-CONT.                                         21040001
                                                                        21050001
       R025-ADD-TEST.                                                   21060001
            IF WS-AND-SW NOT = 1                                        21070001
               GO TO R050-CONT.                                         21080001
                                                                        21090001
            MOVE ZERO TO WS-AND-SW.                                     21100001
            MOVE WL-AREA TO WL-AREA-SAVE.                               21110001
            MOVE L-AND TO WL-AREA.                                      21120001
            PERFORM R200-LOADUP.                                        21130001
            MOVE WL-AREA-SAVE TO WL-AREA.                               21140001
                                                                        21150001
       R050-CONT.                                                       21160001
            PERFORM R200-LOADUP.                                        21170001
                                                                        21180001
       R099-EXIT.                                                       21190001
            EXIT.                                                       21200001
                                                                        21210001
                                                                        21220001
      ******************************************************************21230001
       R200-LOADUP SECTION.                                             21240001
      ******************************************************************21250001
       R201-GO.                                                         21260001
            ADD WL-ITEM1 WF-SUB GIVING WS-RESULT.                       21270001
            IF  WS-RESULT > WS-PLACE-COUNTER                            21280001
                ADD 1 WS-PLACE-COUNTER GIVING WF-SUB                    21290001
                ADD 60 TO WS-PLACE-COUNTER.                             21300001
                                                                        21310001
            PERFORM R500-LOAD VARYING WL-SUB FROM 2 BY 1 UNTIL          21320001
                    WL-ITEM (WL-SUB) = L-X.                             21330001
                                                                        21340001
       R490-EXIT.                                                       21350001
           EXIT.                                                        21360001
                                                                        21370001
                                                                        21380001
      ******************************************************************21390001
       R500-LOAD SECTION.                                               21400001
      ******************************************************************21410001
       R501-GO.                                                         21420001
                                                                        21430001
            MOVE WL-ITEM (WL-SUB) TO WF-ITEM (WF-SUB).                  21440001
            ADD  1                TO WF-SUB.                            21450001
            IF WL-ITEM (WL-SUB) = SPACE                                 21460001
               ADD   1     TO     WL-SUB                                21470001
               MOVE  L-X   TO     WL-ITEM (WL-SUB)                      21480001
               SUBTRACT 1  FROM   WL-SUB.                               21490001
                                                                        21500001
       R990-EXIT.                                                       21510001
            EXIT.                                                       21520001
