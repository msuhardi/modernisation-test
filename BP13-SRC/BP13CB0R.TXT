      **************************                                        00010000
       IDENTIFICATION DIVISION.                                         00020000
      **************************                                        00030000
       PROGRAM-ID.    BP13CB0R.                                         00040000
      *AUTHOR.        PRAKASH.                                          00050013
      *DATE-WRITTEN.  15/05/2020.                                       00060013
                                                                        00070000
      * =========================================================== *   00080000
      * SYSTEM OF COMMITMENT (BP13)                                 *   00090000
      * =========================================================== *   00100000
      *   OBJECTIVE   : THIS PROGRAM CREATES REPORTS FOR AHG/SHG/SUG*   00110000
      *                 BASED ON BP13REPT                           *   00120000
      *                                                             *   00130000
      *   INPUT FILES :                                             *   00140000
      *   1.  BP13REPT -- BP13F136 WITH GRANT AMT FROM GRANT_RCVRY  *   00150000
      *                                                             *   00160000
      *                                                             *   00170000
      *   OUTPUT FILE (CONTENT OF REPORT):                          *   00180000
      *   REPORT 1  - DISBURSEMENTS OF GRANT FOR THE MONTH          *   00190000
      *   REPORT 2  - RECOVERIES OF GRANTS FOR THE MONTH            *   00200000
      *   REPORT 3  - KEY ISSUED CASES FOR THE MONTH                *   00210000
      *   REPORT 5A - MONTH END BALANCE FOR ALL GRANT RECOVERIES    *   00220000
      *             -> FOR CANCELLED CASES                          *   00230000
      *   REPORT 5B - MONTH END BALANCE FOR ALL GRANT RECOVERIES    *   00240000
      *             -> NOT CANCELLED CASES                          *   00250000
      *                                                             *   00260000
      * CHQ REQ     DATE     BY  DESCRIPTIONS                       *   00270000
      * -------- ---------- ---- ---------------------------------- *   00280000
      * BP138252 15/05/2020 PP11 NEW PROGRAM FOR REPT 1, 2, 3, 5A, 5B   00290013
      * =========================================================== *   00300000
                                                                        00310000
       ENVIRONMENT DIVISION.                                            00320000
                                                                        00330000
       CONFIGURATION SECTION.                                           00340000
                                                                        00350000
       SOURCE-COMPUTER. IBM-3090.                                       00360000
       OBJECT-COMPUTER. IBM-3090.                                       00370000
                                                                        00380000
       INPUT-OUTPUT SECTION.                                            00390000
                                                                        00400000
       FILE-CONTROL.                                                    00410000
                                                                        00420000
           SELECT BP13REPT   ASSIGN       TO BP13REPT.                  00430000
                                                                        00440000
           SELECT BP13OUTP   ASSIGN       TO BP13OUTP.                  00450000
                                                                        00460000
       DATA DIVISION.                                                   00470000
                                                                        00480000
       FILE SECTION.                                                    00490000
                                                                        00500000
       FD   BP13REPT                                                    00510000
            BLOCK CONTAINS 0 RECORDS                                    00520000
            RECORD CONTAINS 200 CHARACTERS                              00530000
            LABEL RECORDS ARE STANDARD                                  00540000
            RECORDING MODE IS F.                                        00550000
       01  WS-BP13REPT-REC.                                             00560000
           05  WS-REPT-TYPE         PIC X(02).                          00570000
           05  FILLER               PIC X(01).                          00580000
           05  WS-REPT-REGN-NO      PIC X(08).                          00590000
           05  WS-REPT-NRIC         PIC X(09).                          00600000
           05  WS-REPT-GRANT-TYPE   PIC X(03).                          00610000
           05  WS-REPT-RECEIPT      PIC X(14).                          00620000
           05  WS-REPT-SCHACCT      PIC X(11).                          00630000
           05  WS-REPT-DTE-KEYISSUE PIC X(08).                          00640000
           05  WS-REPT-GRANT-AMT    PIC S9(7)V99.                       00650000
           05  WS-REPT-RCVRY-AMT    PIC S9(7)V99.                       00660000
           05  WS-REPT-DTE-POST     PIC X(08).                          00670000
           05  WS-REPT-DTE-TRANS    PIC X(08).                          00680000
           05  WS-REPT-MTH-BAL      PIC S9(8)V99.                       00690000
           05  WS-REPT-DTE-CANCEL   PIC X(08).                          00700000
           05  WS-REPT-ROOM-TYPE    PIC X(02).                          00710000
           05  FILLER               PIC X(90).                          00720000
                                                                        00730000
       FD   BP13OUTP                                                    00740000
            RECORD CONTAINS   300 CHARACTERS                            00750000
            LABEL RECORDS ARE OMITTED                                   00760000
            RECORDING MODE IS F.                                        00770000
       01   BP13OUTP-REC          PIC X(300).                           00780000
                                                                        00790000
      ************************                                          00800000
       WORKING-STORAGE SECTION.                                         00810000
      ************************                                          00820000
                                                                        00830000
       01  CNT-REPT-READ            PIC 9(05) VALUE ZEROES.             00840000
       01  WS-RPT1-SNO              PIC 9(05) VALUE ZEROES.             00850000
       01  WS-RPT2-SNO              PIC 9(05) VALUE ZEROES.             00860000
       01  WS-RPT3-SNO              PIC 9(05) VALUE ZEROES.             00870000
       01  WS-RPT5A-SNO             PIC 9(05) VALUE ZEROES.             00880000
       01  WS-RPT5B-SNO             PIC 9(05) VALUE ZEROES.             00890000
       01  WS-RPT1-CNT              PIC 9(05) VALUE ZEROES.             00900000
       01  WS-RPT2-CNT              PIC 9(05) VALUE ZEROES.             00910000
       01  WS-RPT3-CNT              PIC 9(05) VALUE ZEROES.             00920000
       01  WS-RPT5A-CNT             PIC 9(05) VALUE ZEROES.             00930000
       01  WS-RPT5B-CNT             PIC 9(05) VALUE ZEROES.             00940000
       01  WS-CTR                   PIC 9(02) VALUE ZEROES.             00950000
       01  WS-REPT-EOF              PIC X(01) VALUE 'N'.                00960000
       01  WS-HDR1-PRINT            PIC X(01) VALUE 'N'.                00970000
       01  WS-HDR2-PRINT            PIC X(01) VALUE 'N'.                00980000
       01  WS-HDR3-PRINT            PIC X(01) VALUE 'N'.                00990000
       01  WS-HDR5A-PRINT           PIC X(01) VALUE 'N'.                01000000
       01  WS-HDR5B-PRINT           PIC X(01) VALUE 'N'.                01010000
       01  WS-DATE                  PIC X(08) VALUE SPACES.             01020000
       01  WS-TME-SYSTEM            PIC X(08).                          01030000
       01  WS-TOT-RPT1              PIC S9(10)V99 VALUE ZEROES.         01040000
       01  WS-TOT-RPT2              PIC S9(10)V99 VALUE ZEROES.         01050000
       01  WS-TOT-RPT3              PIC S9(10)V99 VALUE ZEROES.         01060000
       01  WS-TOT-RPT5A-G           PIC S9(10)V99 VALUE ZEROES.         01070000
       01  WS-TOT-RPT5A-R           PIC S9(10)V99 VALUE ZEROES.         01080000
       01  WS-TOT-RPT5A             PIC S9(10)V99 VALUE ZEROES.         01090000
       01  WS-TOT-RPT5B-G           PIC S9(10)V99 VALUE ZEROES.         01100000
       01  WS-TOT-RPT5B-R           PIC S9(10)V99 VALUE ZEROES.         01110000
       01  WS-TOT-RPT5B             PIC S9(10)V99 VALUE ZEROES.         01120000
       01  WS-MTH-END-BAL           PIC S9(10)V99 VALUE ZEROES.         01130000
       01  WS-EDIT-AMT              PIC -$$$$$$$$$$9.99 VALUE ZEROES.   01140000
       01  WS-PREV-GL-ACCT          PIC X(13).                          01150000
       01  WS-PREV-REPT-TYPE        PIC X(2).                           01160000
       01  WS-DTE-CCYYMMDD.                                             01170000
           05 WS-DTE-CCYY           PIC X(04) VALUE SPACES.             01180000
           05 WS-DTE-MM             PIC X(02) VALUE SPACES.             01190000
           05 WS-DTE-DD             PIC X(02) VALUE SPACES.             01200000
       01  WS-TIME-HHMMSS.                                              01210000
           05 WS-TIME-HH            PIC X(02) VALUE SPACES.             01220000
           05 WS-TIME-MM            PIC X(02) VALUE SPACES.             01230000
           05 WS-TIME-SS            PIC X(02) VALUE SPACES.             01240000
           05 WS-TIME-MS            PIC X(02) VALUE SPACES.             01250000
                                                                        01260000
       01  LB0R-PR-HEAD.                                                01270000
           05  FILLER             PIC X(08) VALUE 'BP13LB0R'.           01280000
           05  FILLER             PIC X(05) VALUE SPACES.               01290000
           05  FILLER             PIC X(08) VALUE SPACES.               01300000
           05  FILLER             PIC X(24) VALUE SPACES.               01310000
           05  FILLER             PIC X(39) VALUE                       01320000
               'S Y S T E M   O F   C O M M I T M E N T'.               01330000
           05  FILLER             PIC X(17) VALUE SPACES.               01340000
           05  FILLER             PIC X(06) VALUE 'DATE: '.             01350000
           05  LB0R-DATE          PIC X(08).                            01360000
           05  FILLER             PIC X(05) VALUE SPACES.               01370000
                                                                        01380000
       01  LB0R-RPT1-HEAD-01.                                           01390000
           05  FILLER             PIC X(40) VALUE SPACES.               01400000
           05  FILLER             PIC X(44) VALUE                       01410000
               '   DISBURSEMENTS OF GRANT FOR THE MONTH     '.          01420000
           05  FILLER             PIC X(48) VALUE SPACES.               01430000
                                                                        01440000
       01  LB0R-RPT2-HEAD-01.                                           01450000
           05  FILLER             PIC X(40) VALUE SPACES.               01460000
           05  FILLER             PIC X(44) VALUE                       01470000
               'RECOVERIES OF GRANTS FOR THE MONTH          '.          01480000
           05  FILLER             PIC X(48) VALUE SPACES.               01490000
                                                                        01500000
       01  LB0R-RPT3-HEAD-01.                                           01510000
           05  FILLER             PIC X(40) VALUE SPACES.               01520000
           05  FILLER             PIC X(33) VALUE                       01530000
               ' KEY ISSUED CASES FOR THE MONTH  '.                     01540000
           05  FILLER             PIC X(59) VALUE SPACES.               01550000
                                                                        01560000
       01  LB0R-RPT5A-HEAD-01.                                          01570000
           05  FILLER             PIC X(40) VALUE SPACES.               01580000
           05  FILLER             PIC X(33) VALUE                       01590000
               '        CANCELLED CASES          '.                     01600000
           05  FILLER             PIC X(59) VALUE SPACES.               01610000
                                                                        01620000
       01  LB0R-RPT5B-HEAD-01.                                          01630000
           05  FILLER             PIC X(40) VALUE SPACES.               01640000
           05  FILLER             PIC X(33) VALUE                       01650000
               '      NON-CANCELLED CASES        '.                     01660000
           05  FILLER             PIC X(59) VALUE SPACES.               01670000
                                                                        01680000
                                                                        01690000
       01  LB0R-RPT1-HEAD-02.                                           01700000
           05  FILLER             PIC X(50) VALUE                       01710000
                'S/NO ;GRANT TYPE;REGNO   ;SCHACCT    ;TRANS DATE;R'.   01720000
           05  FILLER             PIC X(50) VALUE                       01730000
                'ECEIPT/DOC NO;DTE POST;NRIC NUM ;ROOM TYPE;GRANT A'.   01740000
           05  FILLER             PIC X(50) VALUE                       01750000
                'MOUNT                                             '.   01760000
                                                                        01770000
       01  LB0R-RPT2-HEAD-02.                                           01780000
           05  FILLER             PIC X(50) VALUE                       01790000
                'S/NO ;GRANT TYPE;REGNO   ;SCHACCT    ;TRANS DATE;R'.   01800000
           05  FILLER             PIC X(50) VALUE                       01810000
                'ECEIPT/DOC NO;DTE POST;NRIC NUM ;ROOM TYPE;AMT REC'.   01820000
           05  FILLER             PIC X(50) VALUE                       01830000
                'OVERED                                            '.   01840000
                                                                        01850000
       01  LB0R-RPT3-HEAD-02.                                           01860000
           05  FILLER             PIC X(50) VALUE                       01870000
                'S/NO ;GRANT TYPE;REGNO   ;SCHACCT    ;KI DATE ;ROO'.   01880000
           05  FILLER             PIC X(50) VALUE                       01890000
                'M TYPE;GRANT AMOUNT                               '.   01900000
                                                                        01910000
       01  LB0R-RPT5A-HEAD-02.                                          01920000
           05  FILLER             PIC X(50) VALUE                       01930000
                'S/NO ;GRANT TYPE;REGNO   ;SCHACCT    ;CANCEL DATE;'.   01940000
           05  FILLER             PIC X(50) VALUE                       01961000
                'ROOM TYPE;GRANT AMOUNT   ;AMT RECOVERED   ;AMT OUT'.   01962000
           05  FILLER             PIC X(50) VALUE                       01970000
                'STANDING                                          '.   01980000
                                                                        01990000
       01  LB0R-RPT5B-HEAD-02.                                          02000000
           05  FILLER             PIC X(50) VALUE                       02010000
                'S/NO ;GRANT TYPE;REGNO   ;SCHACCT    ;TRANS DATE;D'.   02020000
           05  FILLER             PIC X(50) VALUE                       02041000
                'TE POST;ROOM TYPE;GRANT AMOUNT   ;AMT RECOVERED   '.   02042000
           05  FILLER             PIC X(50) VALUE                       02050000
                ';AMT OUTSTANDING                                  '.   02060000
                                                                        02070000
       01  LB0R-RPT1-DETAILS.                                           02080000
           05  LB0R-SNO-RPT1            PIC ZZZZ9.                      02090000
           05  FILLER                   PIC X(01) VALUE ';'.            02100000
           05  FILLER                   PIC X(03) VALUE SPACES.         02110000
           05  LB0R-GRANT-TYPE-RPT1     PIC X(03).                      02120000
           05  FILLER                   PIC X(04) VALUE SPACES.         02130000
           05  FILLER                   PIC X(01) VALUE ';'.            02140000
           05  LB0R-REGN-NO-RPT1        PIC X(08).                      02150000
           05  FILLER                   PIC X(01) VALUE ';'.            02160000
           05  LB0R-SCHACCT-RPT1        PIC X(11).                      02170000
           05  FILLER                   PIC X(01) VALUE ';'.            02180000
           05  FILLER                   PIC X(01) VALUE SPACES.         02190000
           05  LB0R-DTE-TRANS-RPT1      PIC X(08).                      02200000
           05  FILLER                   PIC X(01) VALUE SPACES.         02210000
           05  FILLER                   PIC X(01) VALUE ';'.            02220000
           05  LB0R-RECEIPT-RPT1        PIC X(14).                      02230000
           05  FILLER                   PIC X(01) VALUE ';'.            02240000
           05  LB0R-DTE-POST-RPT1       PIC X(08).                      02250000
           05  FILLER                   PIC X(01) VALUE ';'.            02260000
           05  LB0R-NRIC-RPT1           PIC X(09).                      02270000
           05  FILLER                   PIC X(01) VALUE ';'.            02280000
           05  FILLER                   PIC X(03) VALUE SPACES.         02290000
           05  LB0R-ROOM-TYPE-RPT1      PIC X(02).                      02300000
           05  FILLER                   PIC X(04) VALUE SPACES.         02310000
           05  FILLER                   PIC X(01) VALUE ';'.            02320000
           05  LB0R-AMT-GRANT-RPT1      PIC X(15).                      02330000
                                                                        02340000
       01  LB0R-RPT2-DETAILS.                                           02350000
           05  LB0R-SNO-RPT2            PIC ZZZZ9.                      02360000
           05  FILLER                   PIC X(01) VALUE ';'.            02370000
           05  FILLER                   PIC X(03) VALUE SPACES.         02380000
           05  LB0R-GRANT-TYPE-RPT2     PIC X(03).                      02390000
           05  FILLER                   PIC X(04) VALUE SPACES.         02400000
           05  FILLER                   PIC X(01) VALUE ';'.            02410000
           05  LB0R-REGN-NO-RPT2        PIC X(08).                      02420000
           05  FILLER                   PIC X(01) VALUE ';'.            02430000
           05  LB0R-SCHACCT-RPT2        PIC X(11).                      02440000
           05  FILLER                   PIC X(01) VALUE ';'.            02450000
           05  FILLER                   PIC X(01) VALUE SPACES.         02460000
           05  LB0R-DTE-TRANS-RPT2      PIC X(08).                      02470000
           05  FILLER                   PIC X(01) VALUE SPACES.         02480000
           05  FILLER                   PIC X(01) VALUE ';'.            02490000
           05  LB0R-RECEIPT-RPT2        PIC X(14).                      02500000
           05  FILLER                   PIC X(01) VALUE ';'.            02510000
           05  LB0R-DTE-POST-RPT2       PIC X(08).                      02520000
           05  FILLER                   PIC X(01) VALUE ';'.            02530000
           05  LB0R-NRIC-RPT2           PIC X(09).                      02540000
           05  FILLER                   PIC X(01) VALUE ';'.            02550000
           05  FILLER                   PIC X(03) VALUE SPACES.         02560000
           05  LB0R-ROOM-TYPE-RPT2      PIC X(02).                      02570000
           05  FILLER                   PIC X(04) VALUE SPACES.         02580000
           05  FILLER                   PIC X(01) VALUE ';'.            02590000
           05  LB0R-AMT-RECOVER-RPT2    PIC X(15).                      02600000
                                                                        02610000
       01  LB0R-RPT3-DETAILS.                                           02620000
           05  LB0R-SNO-RPT3            PIC ZZZZ9.                      02630000
           05  FILLER                   PIC X(01) VALUE ';'.            02640000
           05  FILLER                   PIC X(03) VALUE SPACES.         02650000
           05  LB0R-GRANT-TYPE-RPT3     PIC X(03).                      02660000
           05  FILLER                   PIC X(04) VALUE SPACES.         02670000
           05  FILLER                   PIC X(01) VALUE ';'.            02680000
           05  LB0R-REGN-NO-RPT3        PIC X(08).                      02690000
           05  FILLER                   PIC X(01) VALUE ';'.            02700000
           05  LB0R-SCHACCT-RPT3        PIC X(11).                      02710000
           05  FILLER                   PIC X(01) VALUE ';'.            02720000
           05  LB0R-DTE-KEY-ISSUE-RPT3  PIC X(08).                      02730000
           05  FILLER                   PIC X(01) VALUE ';'.            02740000
           05  FILLER                   PIC X(03) VALUE SPACES.         02750000
           05  LB0R-ROOM-TYPE-RPT3      PIC X(02).                      02760000
           05  FILLER                   PIC X(04) VALUE SPACES.         02770000
           05  FILLER                   PIC X(01) VALUE ';'.            02780000
           05  LB0R-AMT-GRANT-RPT3      PIC X(15).                      02790000
                                                                        02800000
       01  LB0R-RPT5A-DETAILS.                                          02810000
           05  LB0R-SNO-RPT5A           PIC ZZZZ9.                      02820000
           05  FILLER                   PIC X(01) VALUE ';'.            02830000
           05  FILLER                   PIC X(03) VALUE SPACES.         02840000
           05  LB0R-GRANT-TYPE-RPT5A    PIC X(03).                      02850000
           05  FILLER                   PIC X(04) VALUE SPACES.         02860000
           05  FILLER                   PIC X(01) VALUE ';'.            02870000
           05  LB0R-REGN-NO-RPT5A       PIC X(08).                      02880000
           05  FILLER                   PIC X(01) VALUE ';'.            02890000
           05  LB0R-SCHACCT-RPT5A       PIC X(11).                      02900000
           05  FILLER                   PIC X(01) VALUE ';'.            02910000
           05  FILLER                   PIC X(01) VALUE SPACES.         02920000
           05  LB0R-DTE-CANCEL-RPT5A    PIC X(08).                      02930000
           05  FILLER                   PIC X(02) VALUE SPACES.         02940000
           05  FILLER                   PIC X(01) VALUE ';'.            02950000
           05  FILLER                   PIC X(03) VALUE SPACES.         02960000
           05  LB0R-ROOM-TYPE-RPT5A     PIC X(02).                      02970000
           05  FILLER                   PIC X(04) VALUE SPACES.         02980000
           05  FILLER                   PIC X(01) VALUE ';'.            02990000
           05  LB0R-AMT-GRANT-RPT5A     PIC X(15).                      03000000
           05  FILLER                   PIC X(01) VALUE ';'.            03010000
           05  FILLER                   PIC X(01) VALUE SPACES.         03020000
           05  LB0R-AMT-RECOVER-RPT5A   PIC X(15).                      03030000
           05  FILLER                   PIC X(01) VALUE ';'.            03040000
           05  FILLER                   PIC X(02) VALUE SPACES.         03050000
           05  LB0R-AMT-OUTST-RPT5A     PIC X(15).                      03060000
                                                                        03070000
       01  LB0R-RPT5B-DETAILS.                                          03080000
           05  LB0R-SNO-RPT5B           PIC ZZZZ9.                      03090000
           05  FILLER                   PIC X(01) VALUE ';'.            03100000
           05  FILLER                   PIC X(03) VALUE SPACES.         03110000
           05  LB0R-GRANT-TYPE-RPT5B    PIC X(03).                      03120000
           05  FILLER                   PIC X(04) VALUE SPACES.         03130000
           05  FILLER                   PIC X(01) VALUE ';'.            03140000
           05  LB0R-REGN-NO-RPT5B       PIC X(08).                      03150000
           05  FILLER                   PIC X(01) VALUE ';'.            03160000
           05  LB0R-SCHACCT-RPT5B       PIC X(11).                      03170000
           05  FILLER                   PIC X(01) VALUE ';'.            03180000
           05  FILLER                   PIC X(01) VALUE SPACES.         03190000
           05  LB0R-DTE-TRANS-RPT5B     PIC X(08).                      03200000
           05  FILLER                   PIC X(01) VALUE SPACES.         03210000
           05  FILLER                   PIC X(01) VALUE ';'.            03220000
           05  LB0R-DTE-POST-RPT5B      PIC X(08).                      03230000
           05  FILLER                   PIC X(01) VALUE ';'.            03240000
           05  FILLER                   PIC X(03) VALUE SPACES.         03250000
           05  LB0R-ROOM-TYPE-RPT5B     PIC X(02).                      03260000
           05  FILLER                   PIC X(04) VALUE SPACES.         03270000
           05  FILLER                   PIC X(01) VALUE ';'.            03280000
           05  LB0R-AMT-GRANT-RPT5B     PIC X(15).                      03290000
           05  FILLER                   PIC X(01) VALUE ';'.            03300000
           05  FILLER                   PIC X(01) VALUE SPACES.         03310000
           05  LB0R-AMT-RECOVER-RPT5B   PIC X(15).                      03320000
           05  FILLER                   PIC X(01) VALUE ';'.            03330000
           05  FILLER                   PIC X(02) VALUE SPACES.         03340000
           05  LB0R-AMT-OUTST-RPT5B     PIC X(15).                      03350000
                                                                        03360000
       01  LB0R-RPT1-TOTAL.                                             03370000
           05  FILLER                   PIC X(05) VALUE SPACES.         03380000
           05  FILLER                   PIC X(01) VALUE ';'.            03390000
           05  FILLER                   PIC X(03) VALUE SPACES.         03400000
           05  FILLER                   PIC X(03) VALUE SPACES.         03410000
           05  FILLER                   PIC X(04) VALUE SPACES.         03420000
           05  FILLER                   PIC X(01) VALUE ';'.            03430000
           05  FILLER                   PIC X(08) VALUE SPACES.         03440000
           05  FILLER                   PIC X(01) VALUE ';'.            03450000
           05  FILLER                   PIC X(11) VALUE SPACES.         03460000
           05  FILLER                   PIC X(01) VALUE ';'.            03470000
           05  FILLER                   PIC X(01) VALUE SPACES.         03480000
           05  FILLER                   PIC X(08) VALUE SPACES.         03490000
           05  FILLER                   PIC X(01) VALUE SPACES.         03500000
           05  FILLER                   PIC X(01) VALUE ';'.            03510000
           05  FILLER                   PIC X(14) VALUE SPACES.         03520000
           05  FILLER                   PIC X(01) VALUE ';'.            03530000
           05  FILLER                   PIC X(08) VALUE SPACES.         03540000
           05  FILLER                   PIC X(01) VALUE ';'.            03550000
           05  FILLER                   PIC X(09) VALUE SPACES.         03560000
           05  FILLER                   PIC X(01) VALUE ';'.            03570000
           05  FILLER                   PIC X(03) VALUE SPACES.         03580000
           05  FILLER                   PIC X(06) VALUE 'TOTAL:'.       03590000
           05  FILLER                   PIC X(01) VALUE ';'.            03600000
           05  LB0R-TOT-GRANT-RPT1      PIC X(15).                      03610000
                                                                        03620000
       01  LB0R-RPT2-TOTAL.                                             03630000
           05  FILLER                   PIC X(05) VALUE SPACES.         03640000
           05  FILLER                   PIC X(01) VALUE ';'.            03650000
           05  FILLER                   PIC X(03) VALUE SPACES.         03660000
           05  FILLER                   PIC X(03) VALUE SPACES.         03670000
           05  FILLER                   PIC X(04) VALUE SPACES.         03680000
           05  FILLER                   PIC X(01) VALUE ';'.            03690000
           05  FILLER                   PIC X(08) VALUE SPACES.         03700000
           05  FILLER                   PIC X(01) VALUE ';'.            03710000
           05  FILLER                   PIC X(11) VALUE SPACES.         03720000
           05  FILLER                   PIC X(01) VALUE ';'.            03730000
           05  FILLER                   PIC X(01) VALUE SPACES.         03740000
           05  FILLER                   PIC X(08) VALUE SPACES.         03750000
           05  FILLER                   PIC X(01) VALUE SPACES.         03760000
           05  FILLER                   PIC X(01) VALUE ';'.            03770000
           05  FILLER                   PIC X(14) VALUE SPACES.         03780000
           05  FILLER                   PIC X(01) VALUE ';'.            03790000
           05  FILLER                   PIC X(08) VALUE SPACES.         03800000
           05  FILLER                   PIC X(01) VALUE ';'.            03810000
           05  FILLER                   PIC X(09) VALUE SPACES.         03820000
           05  FILLER                   PIC X(01) VALUE ';'.            03830000
           05  FILLER                   PIC X(03) VALUE SPACES.         03840000
           05  FILLER                   PIC X(06) VALUE 'TOTAL:'.       03850000
           05  FILLER                   PIC X(01) VALUE ';'.            03860000
           05  LB0R-TOT-RECOVER-RPT2    PIC X(15).                      03870000
                                                                        03880000
       01  LB0R-RPT3-TOTAL.                                             03890000
           05  FILLER                   PIC X(05) VALUE SPACES.         03900000
           05  FILLER                   PIC X(01) VALUE ';'.            03910000
           05  FILLER                   PIC X(03) VALUE SPACES.         03920000
           05  FILLER                   PIC X(03) VALUE SPACES.         03930000
           05  FILLER                   PIC X(04) VALUE SPACES.         03940000
           05  FILLER                   PIC X(01) VALUE ';'.            03950000
           05  FILLER                   PIC X(08) VALUE SPACES.         03960000
           05  FILLER                   PIC X(01) VALUE ';'.            03970000
           05  FILLER                   PIC X(11) VALUE SPACES.         03980000
           05  FILLER                   PIC X(01) VALUE ';'.            03990000
           05  FILLER                   PIC X(08) VALUE SPACES.         04000000
           05  FILLER                   PIC X(01) VALUE ';'.            04010000
           05  FILLER                   PIC X(03) VALUE SPACES.         04020000
           05  FILLER                   PIC X(06) VALUE 'TOTAL:'.       04030000
           05  FILLER                   PIC X(01) VALUE ';'.            04040000
           05  LB0R-TOT-GRANT-RPT3      PIC X(15).                      04050000
                                                                        04060000
       01  LB0R-RPT5A-TOTAL.                                            04070000
           05  FILLER                   PIC X(05) VALUE SPACES.         04080000
           05  FILLER                   PIC X(01) VALUE ';'.            04090000
           05  FILLER                   PIC X(03) VALUE SPACES.         04100000
           05  FILLER                   PIC X(03) VALUE SPACES.         04110000
           05  FILLER                   PIC X(04) VALUE SPACES.         04120000
           05  FILLER                   PIC X(01) VALUE ';'.            04130000
           05  FILLER                   PIC X(08) VALUE SPACES.         04140000
           05  FILLER                   PIC X(01) VALUE ';'.            04150000
           05  FILLER                   PIC X(11) VALUE SPACES.         04160000
           05  FILLER                   PIC X(01) VALUE ';'.            04170000
           05  FILLER                   PIC X(01) VALUE SPACES.         04180000
           05  FILLER                   PIC X(08) VALUE SPACES.         04190000
           05  FILLER                   PIC X(02) VALUE SPACES.         04200000
           05  FILLER                   PIC X(01) VALUE ';'.            04210000
           05  FILLER                   PIC X(03) VALUE SPACES.         04220000
           05  FILLER                   PIC X(06) VALUE 'TOTAL:'.       04230000
           05  FILLER                   PIC X(01) VALUE ';'.            04240000
           05  LB0R-TOT-GRANT-RPT5A     PIC X(15).                      04250000
           05  FILLER                   PIC X(01) VALUE ';'.            04260000
           05  FILLER                   PIC X(01) VALUE SPACES.         04270000
           05  LB0R-TOT-RECOVER-RPT5A   PIC X(15).                      04280000
           05  FILLER                   PIC X(01) VALUE ';'.            04290000
           05  FILLER                   PIC X(02) VALUE SPACES.         04300000
           05  LB0R-TOT-OUTST-RPT5A     PIC X(15).                      04310000
                                                                        04320000
       01  LB0R-RPT5B-TOTAL.                                            04330000
           05  FILLER                   PIC X(05) VALUE SPACES.         04340000
           05  FILLER                   PIC X(01) VALUE ';'.            04350000
           05  FILLER                   PIC X(03) VALUE SPACES.         04360000
           05  FILLER                   PIC X(03) VALUE SPACES.         04370000
           05  FILLER                   PIC X(04) VALUE SPACES.         04380000
           05  FILLER                   PIC X(01) VALUE ';'.            04390000
           05  FILLER                   PIC X(08) VALUE SPACES.         04400000
           05  FILLER                   PIC X(01) VALUE ';'.            04410000
           05  FILLER                   PIC X(11) VALUE SPACES.         04420000
           05  FILLER                   PIC X(01) VALUE ';'.            04430000
           05  FILLER                   PIC X(01) VALUE SPACES.         04440000
           05  FILLER                   PIC X(08) VALUE SPACES.         04450000
           05  FILLER                   PIC X(01) VALUE SPACES.         04460000
           05  FILLER                   PIC X(01) VALUE ';'.            04470000
           05  FILLER                   PIC X(08) VALUE SPACES.         04480000
           05  FILLER                   PIC X(01) VALUE ';'.            04490000
           05  FILLER                   PIC X(03) VALUE SPACES.         04500000
           05  FILLER                   PIC X(06) VALUE 'TOTAL:'.       04510000
           05  FILLER                   PIC X(01) VALUE ';'.            04520000
           05  LB0R-TOT-GRANT-RPT5B     PIC X(15).                      04530000
           05  FILLER                   PIC X(01) VALUE ';'.            04540000
           05  FILLER                   PIC X(01) VALUE SPACES.         04550000
           05  LB0R-TOT-RECOVER-RPT5B   PIC X(15).                      04560000
           05  FILLER                   PIC X(01) VALUE ';'.            04570000
           05  FILLER                   PIC X(02) VALUE SPACES.         04580000
           05  LB0R-TOT-OUTST-RPT5B     PIC X(15).                      04590000
                                                                        04600000
                                                                        04610000
      ********************                                              04620000
       PROCEDURE DIVISION.                                              04630000
      ********************                                              04640000
                                                                        04650000
      *----------*                                                      04660000
       0000-MAIN.                                                       04670000
      *----------*                                                      04680000
                                                                        04690000
           PERFORM 1000-OPEN-FILES   THRU 1000-EXIT.                    04700000
           PERFORM 2000-READ-REPT    THRU 2000-EXIT.                    04710000
           PERFORM 3000-PROCESS-REC  THRU 3000-EXIT                     04720000
                   UNTIL WS-REPT-EOF = 'Y'.                             04730000
           PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT.                    04740000
                                                                        04750000
       0000-EXIT.                                                       04760000
           EXIT.                                                        04770000
                                                                        04780000
      *----------------*                                                04790000
       1000-OPEN-FILES.                                                 04800000
      *----------------*                                                04810000
                                                                        04820000
           OPEN INPUT  BP13REPT                                         04830000
                OUTPUT BP13OUTP.                                        04840000
                                                                        04850000
           MOVE FUNCTION CURRENT-DATE TO WS-DATE.                       04860000
                                                                        04870000
           ACCEPT WS-DTE-CCYYMMDD   FROM   DATE YYYYMMDD.               04880000
           ACCEPT WS-TIME-HHMMSS    FROM   TIME.                        04890000
                                                                        04900000
           MOVE WS-DTE-CCYYMMDD     TO LB0R-DATE.                       04910000
                                                                        04920000
           WRITE BP13OUTP-REC       FROM LB0R-PR-HEAD.                  04930000
           MOVE 'N'    TO WS-HDR1-PRINT                                 04940000
                          WS-HDR2-PRINT                                 04950000
                          WS-HDR3-PRINT                                 04960000
                          WS-HDR5A-PRINT                                04970000
                          WS-HDR5B-PRINT                                04980000
           MOVE ZEROES TO WS-TOT-RPT1                                   04990000
                          WS-TOT-RPT2                                   05000000
                          WS-TOT-RPT3                                   05010000
                          WS-TOT-RPT5A-G                                05020000
                          WS-TOT-RPT5A-R                                05030000
                          WS-TOT-RPT5A                                  05040000
                          WS-TOT-RPT5B-G                                05050000
                          WS-TOT-RPT5B-R                                05060000
                          WS-TOT-RPT5B                                  05070000
                          WS-RPT1-SNO                                   05080000
                          WS-RPT2-SNO                                   05090000
                          WS-RPT3-SNO                                   05100000
                          WS-RPT5A-SNO                                  05110000
                          WS-RPT5B-SNO.                                 05120000
                                                                        05130000
       1000-EXIT.                                                       05140000
           EXIT.                                                        05150000
                                                                        05160000
      *---------------*                                                 05170000
       2000-READ-REPT.                                                  05180000
      *---------------*                                                 05190000
                                                                        05200000
           READ BP13REPT AT END                                         05210000
                PERFORM 7000-PRINT-TOTAL THRU 7000-EXIT                 05220000
                MOVE HIGH-VALUES TO WS-BP13REPT-REC                     05230000
                MOVE 'Y' TO WS-REPT-EOF                                 05240000
                GO TO 2000-EXIT.                                        05250000
                                                                        05260000
           ADD 1 TO CNT-REPT-READ.                                      05270000
                                                                        05280000
       2000-EXIT.                                                       05290000
           EXIT.                                                        05300000
                                                                        05310000
      *-----------------*                                               05320000
       3000-PROCESS-REC.                                                05330000
      *-----------------*                                               05340000
           IF WS-REPT-TYPE NOT = WS-PREV-REPT-TYPE                      05350000
              PERFORM 7000-PRINT-TOTAL THRU 7000-EXIT                   05360000
           END-IF.                                                      05370000
                                                                        05380000
           IF WS-REPT-TYPE = '1 '                                       05390000
              IF WS-HDR1-PRINT = 'N'                                    05400000
                 MOVE SPACES TO BP13OUTP-REC                            05410000
                 WRITE BP13OUTP-REC                                     05420000
                 WRITE BP13OUTP-REC      FROM LB0R-RPT1-HEAD-01         05430000
                 WRITE BP13OUTP-REC      FROM LB0R-RPT1-HEAD-02         05440000
                 MOVE 'Y' TO WS-HDR1-PRINT                              05450000
              END-IF                                                    05460000
              PERFORM 6100-CREATE-REPORT1 THRU 6100-EXIT                05470000
           END-IF.                                                      05480000
                                                                        05490000
           IF WS-REPT-TYPE = '2 '                                       05500000
              IF WS-HDR2-PRINT = 'N'                                    05510000
                 MOVE SPACES TO BP13OUTP-REC                            05520000
                 WRITE BP13OUTP-REC                                     05530000
                 WRITE BP13OUTP-REC      FROM LB0R-RPT2-HEAD-01         05540000
                 WRITE BP13OUTP-REC      FROM LB0R-RPT2-HEAD-02         05550000
                 MOVE 'Y' TO WS-HDR2-PRINT                              05560000
              END-IF                                                    05570000
              PERFORM 6200-CREATE-REPORT2 THRU 6200-EXIT                05580000
           END-IF.                                                      05590000
                                                                        05600000
           IF WS-REPT-TYPE = '3 '                                       05610000
              IF WS-HDR3-PRINT = 'N'                                    05620000
                 WRITE BP13OUTP-REC      FROM LB0R-RPT3-HEAD-01         05630000
                 WRITE BP13OUTP-REC      FROM LB0R-RPT3-HEAD-02         05640000
                 MOVE 'Y' TO WS-HDR3-PRINT                              05650000
              END-IF                                                    05660000
              PERFORM 6300-CREATE-REPORT3 THRU 6300-EXIT                05670000
           END-IF.                                                      05680000
                                                                        05690000
           IF WS-REPT-TYPE = '5A'                                       05700000
              PERFORM 6500-CREATE-REPORT5A THRU 6500-EXIT               05710000
           END-IF.                                                      05720000
                                                                        05730000
           IF WS-REPT-TYPE = '5B'                                       05740000
              PERFORM 6550-CREATE-REPORT5B THRU 6550-EXIT               05750000
           END-IF.                                                      05760000
                                                                        05770000
           MOVE WS-REPT-TYPE    TO WS-PREV-REPT-TYPE.                   05780000
           PERFORM 2000-READ-REPT THRU 2000-EXIT.                       05790000
                                                                        05800000
       3000-EXIT.                                                       05810000
           EXIT.                                                        05820000
                                                                        05830000
      ***************************************************************** 05840000
       6100-CREATE-REPORT1.                                             05850000
      ***************************************************************** 05860000
           INITIALIZE     LB0R-RPT1-DETAILS.                            05870000
           ADD 1 TO WS-RPT1-SNO.                                        05880000
                                                                        05890000
           MOVE WS-RPT1-SNO                    TO LB0R-SNO-RPT1.        05900000
           MOVE WS-REPT-GRANT-TYPE             TO LB0R-GRANT-TYPE-RPT1. 05910000
           MOVE WS-REPT-REGN-NO                TO LB0R-REGN-NO-RPT1.    05920000
           MOVE WS-REPT-SCHACCT                TO LB0R-SCHACCT-RPT1.    05930000
           MOVE WS-REPT-DTE-TRANS              TO LB0R-DTE-TRANS-RPT1.  05940000
           MOVE WS-REPT-RECEIPT                TO LB0R-RECEIPT-RPT1.    05950000
           MOVE WS-REPT-DTE-POST               TO LB0R-DTE-POST-RPT1.   05960000
           MOVE WS-REPT-NRIC                   TO LB0R-NRIC-RPT1.       05970000
           MOVE WS-REPT-ROOM-TYPE              TO LB0R-ROOM-TYPE-RPT1.  05980000
           MOVE WS-REPT-GRANT-AMT              TO WS-EDIT-AMT.          05990000
           MOVE WS-EDIT-AMT                    TO LB0R-AMT-GRANT-RPT1.  06000000
           ADD  WS-REPT-GRANT-AMT              TO WS-TOT-RPT1.          06010000
                                                                        06020000
           WRITE BP13OUTP-REC      FROM LB0R-RPT1-DETAILS.              06030000
           ADD 1 TO WS-RPT1-CNT.                                        06040000
                                                                        06050000
       6100-EXIT.                                                       06060000
            EXIT.                                                       06070000
                                                                        06080000
      ***************************************************************** 06090000
       6200-CREATE-REPORT2.                                             06100000
      ***************************************************************** 06110000
           INITIALIZE     LB0R-RPT2-DETAILS.                            06120000
           ADD 1 TO WS-RPT2-SNO.                                        06130000
                                                                        06140000
           MOVE WS-RPT2-SNO                    TO LB0R-SNO-RPT2.        06150000
           MOVE WS-REPT-GRANT-TYPE             TO LB0R-GRANT-TYPE-RPT2. 06160000
           MOVE WS-REPT-REGN-NO                TO LB0R-REGN-NO-RPT2.    06170000
           MOVE WS-REPT-SCHACCT                TO LB0R-SCHACCT-RPT2.    06180000
           MOVE WS-REPT-DTE-TRANS              TO LB0R-DTE-TRANS-RPT2.  06190000
           MOVE WS-REPT-RECEIPT                TO LB0R-RECEIPT-RPT2.    06200000
           MOVE WS-REPT-DTE-POST               TO LB0R-DTE-POST-RPT2.   06210000
           MOVE WS-REPT-NRIC                   TO LB0R-NRIC-RPT2.       06220000
           MOVE WS-REPT-ROOM-TYPE              TO LB0R-ROOM-TYPE-RPT2.  06230000
           IF WS-REPT-RCVRY-AMT < ZEROES                                06240000
              COMPUTE WS-REPT-RCVRY-AMT = WS-REPT-RCVRY-AMT * -1        06250000
           END-IF.                                                      06260000
           MOVE WS-REPT-RCVRY-AMT              TO WS-EDIT-AMT.          06270000
           MOVE WS-EDIT-AMT                    TO LB0R-AMT-RECOVER-RPT2.06280000
           ADD  WS-REPT-RCVRY-AMT              TO WS-TOT-RPT2.          06290000
                                                                        06300000
           WRITE BP13OUTP-REC      FROM LB0R-RPT2-DETAILS.              06310000
           ADD 1 TO WS-RPT2-CNT.                                        06320000
                                                                        06330000
       6200-EXIT.                                                       06340000
            EXIT.                                                       06350000
                                                                        06360000
      ***************************************************************** 06370000
       6300-CREATE-REPORT3.                                             06380000
      ***************************************************************** 06390000
           INITIALIZE LB0R-RPT3-DETAILS.                                06400000
           ADD 1 TO WS-RPT3-SNO.                                        06410000
                                                                        06420000
           MOVE WS-RPT3-SNO                    TO LB0R-SNO-RPT3.        06430000
           MOVE WS-REPT-GRANT-TYPE             TO LB0R-GRANT-TYPE-RPT3. 06440000
           MOVE WS-REPT-REGN-NO                TO LB0R-REGN-NO-RPT3.    06450000
           MOVE WS-REPT-SCHACCT                TO LB0R-SCHACCT-RPT3.    06460000
           MOVE WS-REPT-DTE-KEYISSUE        TO LB0R-DTE-KEY-ISSUE-RPT3. 06470000
           MOVE WS-REPT-ROOM-TYPE              TO LB0R-ROOM-TYPE-RPT3.  06480000
           MOVE WS-REPT-GRANT-AMT              TO WS-EDIT-AMT.          06490000
           MOVE WS-EDIT-AMT                    TO LB0R-AMT-GRANT-RPT3.  06500000
           ADD  WS-REPT-GRANT-AMT              TO WS-TOT-RPT3.          06510000
                                                                        06520000
           WRITE BP13OUTP-REC       FROM LB0R-RPT3-DETAILS.             06530000
           ADD 1 TO WS-RPT3-CNT.                                        06540000
                                                                        06550000
       6300-EXIT.                                                       06560000
            EXIT.                                                       06570000
                                                                        06580000
      ***************************************************************** 06590000
       6500-CREATE-REPORT5A.                                            06600000
      ***************************************************************** 06610000
           INITIALIZE     LB0R-RPT5A-DETAILS.                           06620000
           IF WS-REPT-RCVRY-AMT < 1                                     06630000
              COMPUTE WS-REPT-RCVRY-AMT = WS-REPT-RCVRY-AMT * -1        06640000
           END-IF.                                                      06650000
           COMPUTE WS-MTH-END-BAL =                                     06660000
                                 WS-REPT-GRANT-AMT - WS-REPT-RCVRY-AMT. 06670000
           IF WS-MTH-END-BAL NOT = ZEROES                               06680000
              IF WS-HDR5A-PRINT = 'N'                                   06690000
                 WRITE BP13OUTP-REC      FROM LB0R-RPT5A-HEAD-01        06700000
                 WRITE BP13OUTP-REC      FROM LB0R-RPT5A-HEAD-02        06710000
                 MOVE 'Y' TO WS-HDR5A-PRINT                             06720000
              END-IF                                                    06730000
              ADD 1 TO WS-RPT5A-SNO                                     06740000
              MOVE WS-RPT5A-SNO                TO LB0R-SNO-RPT5A        06750000
              MOVE WS-REPT-GRANT-TYPE          TO LB0R-GRANT-TYPE-RPT5A 06760000
              MOVE WS-REPT-REGN-NO             TO LB0R-REGN-NO-RPT5A    06770000
              MOVE WS-REPT-SCHACCT             TO LB0R-SCHACCT-RPT5A    06780000
              MOVE WS-REPT-DTE-CANCEL          TO LB0R-DTE-CANCEL-RPT5A 06790000
              MOVE WS-REPT-ROOM-TYPE           TO LB0R-ROOM-TYPE-RPT5A  06800000
              MOVE WS-REPT-GRANT-AMT           TO WS-EDIT-AMT           06810000
              MOVE WS-EDIT-AMT                 TO LB0R-AMT-GRANT-RPT5A  06820000
              ADD  WS-REPT-GRANT-AMT           TO WS-TOT-RPT5A-G        06830000
              MOVE WS-REPT-RCVRY-AMT           TO WS-EDIT-AMT           06840000
              MOVE WS-EDIT-AMT                 TO LB0R-AMT-RECOVER-RPT5A06850000
              ADD  WS-REPT-RCVRY-AMT           TO WS-TOT-RPT5A-R        06860000
              MOVE WS-MTH-END-BAL              TO WS-EDIT-AMT           06870000
              MOVE WS-EDIT-AMT                 TO LB0R-AMT-OUTST-RPT5A  06880000
              ADD  WS-MTH-END-BAL              TO WS-TOT-RPT5A          06890000
              WRITE BP13OUTP-REC      FROM LB0R-RPT5A-DETAILS           06900000
              ADD 1 TO WS-RPT5A-CNT                                     06910000
           END-IF.                                                      06920000
                                                                        06930000
       6500-EXIT.                                                       06940000
            EXIT.                                                       06950000
                                                                        06960000
      ***************************************************************** 06970000
       6550-CREATE-REPORT5B.                                            06980000
      ***************************************************************** 06990000
           INITIALIZE     LB0R-RPT5B-DETAILS.                           07000000
           IF WS-REPT-RCVRY-AMT < 1                                     07010000
              COMPUTE WS-REPT-RCVRY-AMT = WS-REPT-RCVRY-AMT * -1        07020000
           END-IF.                                                      07030000
           COMPUTE WS-MTH-END-BAL =                                     07040000
                                 WS-REPT-GRANT-AMT - WS-REPT-RCVRY-AMT. 07050000
           IF WS-MTH-END-BAL NOT = ZEROES                               07060000
              IF WS-HDR5B-PRINT = 'N'                                   07070000
                 WRITE BP13OUTP-REC      FROM LB0R-RPT5B-HEAD-01        07080000
                 WRITE BP13OUTP-REC      FROM LB0R-RPT5B-HEAD-02        07090000
                 MOVE 'Y' TO WS-HDR5B-PRINT                             07100000
              END-IF                                                    07110000
              ADD 1 TO WS-RPT5B-SNO                                     07120000
              MOVE WS-RPT5B-SNO                TO LB0R-SNO-RPT5B        07130000
              MOVE WS-REPT-GRANT-TYPE          TO LB0R-GRANT-TYPE-RPT5B 07140000
              MOVE WS-REPT-REGN-NO             TO LB0R-REGN-NO-RPT5B    07150000
              MOVE WS-REPT-SCHACCT             TO LB0R-SCHACCT-RPT5B    07160000
              MOVE WS-REPT-DTE-TRANS           TO LB0R-DTE-TRANS-RPT5B  07170000
              MOVE WS-REPT-DTE-POST            TO LB0R-DTE-POST-RPT5B   07180000
              MOVE WS-REPT-ROOM-TYPE           TO LB0R-ROOM-TYPE-RPT5B  07190000
              MOVE WS-REPT-GRANT-AMT           TO WS-EDIT-AMT           07200000
              MOVE WS-EDIT-AMT                 TO LB0R-AMT-GRANT-RPT5B  07210000
              ADD  WS-REPT-GRANT-AMT           TO WS-TOT-RPT5B-G        07220000
              MOVE WS-REPT-RCVRY-AMT           TO WS-EDIT-AMT           07230000
              MOVE WS-EDIT-AMT                TO LB0R-AMT-RECOVER-RPT5B 07240000
              ADD  WS-REPT-RCVRY-AMT           TO WS-TOT-RPT5B-R        07250000
              MOVE WS-MTH-END-BAL              TO WS-EDIT-AMT           07260000
              MOVE WS-EDIT-AMT                 TO LB0R-AMT-OUTST-RPT5B  07270000
              ADD  WS-MTH-END-BAL              TO WS-TOT-RPT5B          07280000
              WRITE BP13OUTP-REC      FROM LB0R-RPT5B-DETAILS           07290000
              ADD 1 TO WS-RPT5B-CNT                                     07300000
           END-IF.                                                      07310000
                                                                        07320000
       6550-EXIT.                                                       07330000
            EXIT.                                                       07340000
                                                                        07350000
      *-----------------*                                               07360000
       7000-PRINT-TOTAL.                                                07370000
      *-----------------*                                               07380000
                                                                        07390000
            EVALUATE WS-PREV-REPT-TYPE                                  07400000
            WHEN '1 '                                                   07410000
               IF WS-RPT1-CNT > ZEROES                                  07420000
                  INITIALIZE LB0R-RPT1-TOTAL                            07430000
                  MOVE WS-TOT-RPT1 TO WS-EDIT-AMT                       07440000
                  MOVE WS-EDIT-AMT      TO LB0R-TOT-GRANT-RPT1          07450000
                  WRITE BP13OUTP-REC       FROM LB0R-RPT1-TOTAL         07460000
                  MOVE SPACES TO BP13OUTP-REC                           07470000
                  WRITE BP13OUTP-REC                                    07480000
               END-IF                                                   07490000
            WHEN '2 '                                                   07500000
               IF WS-RPT2-CNT > ZEROES                                  07510000
                  INITIALIZE LB0R-RPT2-TOTAL                            07520000
                  MOVE WS-TOT-RPT2   TO WS-EDIT-AMT                     07530000
                  MOVE WS-EDIT-AMT       TO LB0R-TOT-RECOVER-RPT2       07540000
                  WRITE BP13OUTP-REC       FROM LB0R-RPT2-TOTAL         07550000
                  MOVE SPACES TO BP13OUTP-REC                           07560000
                  WRITE BP13OUTP-REC                                    07570000
               END-IF                                                   07580000
            WHEN '3 '                                                   07590000
               IF WS-RPT3-CNT > ZEROES                                  07600000
                  INITIALIZE LB0R-RPT3-TOTAL                            07610000
                  MOVE WS-TOT-RPT3 TO WS-EDIT-AMT                       07620000
                  MOVE WS-EDIT-AMT      TO LB0R-TOT-GRANT-RPT3          07630000
                  WRITE BP13OUTP-REC       FROM LB0R-RPT3-TOTAL         07640000
                  MOVE SPACES TO BP13OUTP-REC                           07650000
                  WRITE BP13OUTP-REC                                    07660000
               END-IF                                                   07670000
            WHEN '5A'                                                   07680000
               IF WS-RPT5A-CNT > ZEROES                                 07690000
                  INITIALIZE LB0R-RPT5A-TOTAL                           07700000
                  MOVE WS-TOT-RPT5A-G      TO WS-EDIT-AMT               07710000
                  MOVE WS-EDIT-AMT         TO LB0R-TOT-GRANT-RPT5A      07720000
                  MOVE WS-TOT-RPT5A-R      TO WS-EDIT-AMT               07730000
                  MOVE WS-EDIT-AMT         TO LB0R-TOT-RECOVER-RPT5A    07740000
                  MOVE WS-TOT-RPT5A        TO WS-EDIT-AMT               07750000
                  MOVE WS-EDIT-AMT         TO LB0R-TOT-OUTST-RPT5A      07760000
                  WRITE BP13OUTP-REC       FROM LB0R-RPT5A-TOTAL        07770000
                  MOVE SPACES TO BP13OUTP-REC                           07780000
                  WRITE BP13OUTP-REC                                    07790000
               END-IF                                                   07800000
            WHEN '5B'                                                   07810000
               IF WS-RPT5B-CNT > ZEROES                                 07820000
                  INITIALIZE LB0R-RPT5B-TOTAL                           07830000
                  MOVE WS-TOT-RPT5B-G     TO WS-EDIT-AMT                07840000
                  MOVE WS-EDIT-AMT         TO LB0R-TOT-GRANT-RPT5B      07850000
                  MOVE WS-TOT-RPT5B-R     TO WS-EDIT-AMT                07860000
                  MOVE WS-EDIT-AMT         TO LB0R-TOT-RECOVER-RPT5B    07870000
                  MOVE WS-TOT-RPT5B        TO WS-EDIT-AMT               07880000
                  MOVE WS-EDIT-AMT         TO LB0R-TOT-OUTST-RPT5B      07890000
                  WRITE BP13OUTP-REC       FROM LB0R-RPT5B-TOTAL        07900000
                  MOVE SPACES TO BP13OUTP-REC                           07910000
                  WRITE BP13OUTP-REC                                    07920000
               END-IF                                                   07930000
            END-EVALUATE.                                               07940000
                                                                        07950000
       7000-EXIT.                                                       07960000
            EXIT.                                                       07970000
                                                                        07980000
      *-----------------*                                               07990000
       9000-CLOSE-FILES.                                                08000000
      *-----------------*                                               08010000
                                                                        08020000
           DISPLAY '******  BP13CB0R *************'.                    08030000
           DISPLAY 'NO OF RECS READ FROM  BP13REPT  : ' CNT-REPT-READ.  08040000
           DISPLAY 'NO OF RECS WRITTEN TO REPORT 1  : ' WS-RPT1-CNT.    08050000
           DISPLAY 'NO OF RECS WRITTEN TO REPORT 2  : ' WS-RPT2-CNT.    08060000
           DISPLAY 'NO OF RECS WRITTEN TO REPORT 3  : ' WS-RPT3-CNT.    08070000
           DISPLAY 'NO OF RECS WRITTEN TO REPORT 5A : ' WS-RPT5A-CNT.   08080000
           DISPLAY 'NO OF RECS WRITTEN TO REPORT 5B : ' WS-RPT5B-CNT.   08090000
                                                                        08100000
           CLOSE BP13REPT                                               08110000
                 BP13OUTP.                                              08120000
                                                                        08130000
           STOP RUN.                                                    08140000
                                                                        08150000
       9000-EXIT.                                                       08160000
            EXIT.                                                       08170000
                                                                        08180000
