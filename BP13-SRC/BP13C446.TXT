      ***************************                                               
       IDENTIFICATION DIVISION.                                                 
      ***************************                                               
       PROGRAM-ID.    BP13C446.                                                 
       AUTHOR.        EG1.                                                      
      *DATE-WRITTEN.  19/06/95.                                                 
                                                                                
      *================================================================*        
      *   SYSTEM NAME :  SYSTEM OF COMMITMENT   (SOC)                  *        
      *   SYSTEM ID   :  BP13                                          *        
      *================================================================*        
      *                                                                *        
      *   OBJECTIVE   :  1.  TO PRINT LIST FOR STAMPING OF SUPPLEMENTARY        
      *                      AGREEMENT. (PREMIUM CASES)                *        
      *                                                                *        
      *   LISTINGS    :  1.  BP13L446  -  LISTING FOR STAMPING OF      *        
      *                      SUPPLEMENTARY AGREEMENT.                  *        
      *                                                                *        
      * CHGE-NO  DATE     BY   DESCRIPTION                             *        
      * -------- -------- ---- --------------------------------------- *        
      * BP130186 04/06/97 LJL  TO CATER FOR THE CAPTURE OF DTE OF      *        
      *                        PRINCIPAL SAGES AGREEMENT.              *        
      * BP130418 09/06/98 RHB  Y2K                                     *        
      * BP130696 01/08/99 CLT  IMPLEMENTATION OF E-STAMPING            *        
      * BP130998 15/05/01 CLT  CATER FOR SA FLAT SALES TYPE 13         *        
      * BP132037 16/10/01 MCC  BUDGET DISCOUNT 30%                     *        
      *                        (UPDATE DUP SF FROM $2 TO $1.40)        *        
      * BP132270 30/12/02 MALC CATER FOR STAMP-FEE DISC AND NO DISC    *        
      * BP132660 31/01/05 JF4  CHG K330-AMT-FLEXI-SELLPR TO            *        
      *                        K330-AMT-CURR-SELLPR                    *        
      * BP134218 11/05/11 JB8  TO CATER FOR REMOVAL OF NOMINAL DUTIES  *        
      * BP134779 13/06/13 PCL4 TO CONVERT THE REPORT TO SENDMAIL       *        
      * BP135537 23/02/15 RJB1 CHANGE THE EMAIL RECIPIENT FROM NICKNAME*        
      *                        INTO COMPLETE NAME                      *        
      * BP136159 09/03/16 KSJ3 CATER FOR SALES TYPE 18                 *        
      * BP136477 18/10/16 RJB1 TO REPLACE KIM HUAT TO YEE MIEN         *        
      * BP137087 17/11/17 PCL4 TO UPDATE EMAIL RECIPIENTS              *        
      * BP137155 08/01/18 PCL4 TO UPDATE EMAIL RECIPIENTS              *        
      * BP138757 23/07/21 KV8  TO REPLACE KATHIJAH TO SUZANNE          *        
      * BP139030 07/01/22 ZAR7 REPLACE CHUA YEE MIEN TO LIM KOK CHUN            
      * BP139159 13/06/22 KAC1 REMOVED Normala_BUANG@hdb.gov.sg        *        
      * BP139159 28/06/22 KAC1 REMOVED Afiqah                          *        
      * BP139276 05/04/24 KAC1 REPLACE LIM KOK CHUN BY                 *        
      *                                KATHIJAH_BEE_ALI_MOHAMED        *        
      *================================================================*        
                                                                                
                                                                                
      ************************                                                  
       ENVIRONMENT DIVISION.                                                    
      ************************                                                  
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F315  ASSIGN        TO BP13F315.                          
           SELECT BP13K330  ASSIGN        TO BP13K330                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K330-KEY-FLD                       
                            FILE STATUS   IS K330-STATUS.                       
           SELECT BP13K410  ASSIGN        TO BP13K410                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K410-KEY-FLD                       
                            FILE STATUS   IS K410-STATUS.                       
           SELECT BP13L446  ASSIGN        TO BP13L446.                          
                                                                                
                                                                                
      *****************                                                         
       DATA DIVISION.                                                           
      *****************                                                         
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD   BP13F315                                                            
            RECORD CONTAINS 500 CHARACTERS                                      
            RECORDING MODE IS F.                                                
       COPY BP13F315.                                                           
                                                                                
       FD   BP13K330                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K330.                                                           
                                                                                
       FD   BP13K410                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K410.                                                           
                                                                                
       FD   BP13L446                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   PRINT-REC-1                        PIC X(132).                      
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-EMAIL-RPT-VARIABLES.                                              
           05  WS-DATE-RPT-DTL.                                                 
               10 FILLER                PIC X(6)  VALUE 'DATE: '.               
               10 WS-DATE-RPT           PIC X(10) VALUE SPACES.                 
           05  WS-MAIL-RPT1             PIC X(12) VALUE 'HELO SGPHDB1'.         
           05  WS-MAIL-RPT2             PIC X(27)                               
               VALUE 'MAIL FROM:<OPCP@SGPHDB1>'.                                
           05  WS-MAIL-RPT3             PIC X(60)                               
               VALUE 'RCPT TO:<BALASUBRAMANIAM_ARUNASALAM@HDB.GOV.SG>'.         
           05  WS-MAIL-RPT4             PIC X(60) VALUE                         
              'RCPT TO:<NOORJAHAN_SHAIK_MOHAMED_GULEMKADER@HDB.GOV.SG>'.        
           05  WS-MAIL-RPT5             PIC X(60)                               
               VALUE 'RCPT TO:<MUHAMMED_SHARIFF_SAHROM@HDB.GOV.SG>'.            
           05  WS-MAIL-RPT7             PIC X(60)                               
      *        VALUE 'RCPT TO:<KATHIJAH_BEE_ALI_MOHAMED@HDB.GOV.SG>'.           
               VALUE 'RCPT TO:<SUZANNE_SC_HENG@HDB.GOV.SG>'.                    
           05  WS-MAIL-RPT7B            PIC X(40)                               
               VALUE 'RCPT TO:<PHNG_BEE_LUAN@HDB.GOV.SG>'.                      
           05  WS-MAIL-RPT7C            PIC X(45)                               
               VALUE 'RCPT TO:<KATHIJAH_BEE_ALI_MOHAMED@hdb.gov.sg>'.           
           05  WS-MAIL-RPT8             PIC X(4)                                
               VALUE 'DATA'.                                                    
           05  WS-MAIL-RPT9             PIC X(40)                               
               VALUE 'FROM:Soc System - Email Alert'.                           
           05  WS-MAIL-RPT10            PIC X(60)                               
               VALUE 'TO:<BALASUBRAMANIAM_ARUNASALAM@HDB.GOV.SG>'.              
           05  WS-MAIL-RPT11            PIC X(60) VALUE                         
              'TO:<NOORJAHAN_SHAIK_MOHAMED_GULEMKADER@HDB.GOV.SG>'.             
           05  WS-MAIL-RPT12            PIC X(60)                               
               VALUE 'TO:<MUHAMMED_SHARIFF_SAHROM@HDB.GOV.SG>'.                 
           05  WS-MAIL-RPT13B           PIC X(60)                               
      *        VALUE 'TO:<KATHIJAH_BEE_ALI_MOHAMED@HDB.GOV.SG>'.                
               VALUE 'TO:<SUZANNE_SC_HENG@HDB.GOV.SG>'.                         
           05  WS-MAIL-RPT13D           PIC X(40)                               
               VALUE 'TO:<PHNG_BEE_LUAN@HDB.GOV.SG>'.                           
           05  WS-MAIL-RPT13E           PIC X(40)                               
               VALUE 'CC:<KATHIJAH_BEE_ALI_MOHAMED@hdb.gov.sg>'.                
           05  WS-MAIL-RPT15            PIC X(100) VALUE                        
               'SUBJECT : SUMMARY LIST OF TP/SATP/SOCA/PREMIUM CASES'.          
                                                                                
      *----------------------------------------------------------------*        
      *   F315 TRANSLATION RECORD FOR VOUCHER EXTRACTION.              *        
      *----------------------------------------------------------------*        
       01  WS-F316-REV-REC.                                                     
           05  FILLER                         PIC X(468).                       
           05  WS-F316-VOUCHER-NO             PIC X(12).                        
           05  WS-F316-SERIAL-NO              PIC 9(04).                        
           05  FILLER                         PIC X(16).                        
                                                                                
      *----------------------------------------------------------------*        
      *   MISCELLANEOUS VARIABLES FOR PROCESSING                       *        
      *----------------------------------------------------------------*        
                                                                                
       01  WS-FILE-STATUS.                                                      
           05  K330-STATUS                    PIC XX    VALUE '00'.             
           05  K410-STATUS                    PIC XX    VALUE '00'.             
       01  WS-FILE-EOF-FL.                                                      
           05  WS-EOF-F315                    PIC X     VALUE 'N'.              
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-PAGE                        PIC 9(4)  VALUE ZEROES.           
           05  WS-REC-CNT                     PIC 99    VALUE ZEROES.           
           05  WS-SEQ-CNT                     PIC 9(6)  VALUE ZEROES.           
           05  WS-ERR-CNT                     PIC 9(6)  VALUE ZEROES.           
           05  WS-CNT-INV-F315                PIC 9(6)  VALUE ZEROES.           
           05  WS-CNT-READ-F315               PIC 9(6)  VALUE ZEROES.           
                                                                                
       01  WS-SWITCHES.                                                         
           05  WS-INC-FL                      PIC X(01) VALUE 'N'.              
                                                                                
       01  WS-CURR-DATE.                                                        
           05  WS-CURR-CC                     PIC 99    VALUE 00.               
           05  WS-CURR-YY                     PIC 99    VALUE 00.               
           05  WS-CURR-MM                     PIC 99    VALUE 00.               
           05  WS-CURR-DD                     PIC 99    VALUE 00.               
                                                                                
       01  WS-EDIT-DATE.                                                        
           05  WS-EDIT-DD                     PIC 99    VALUE 00.               
           05  FILLER                         PIC X     VALUE '/'.              
           05  WS-EDIT-MM                     PIC 99    VALUE 00.               
           05  FILLER                         PIC X     VALUE '/'.              
           05  WS-EDIT-CC                     PIC 99    VALUE 00.               
           05  WS-EDIT-YY                     PIC 99    VALUE 00.               
                                                                                
       01  WS-K330-AMT-LEASE-STAMP            PIC 9(6)V99.                      
                                                                                
       01  WS-UNIT-NO.                                                          
           05  WS-LEVEL                       PIC X(2)  VALUE SPACES.           
           05  FILLER                         PIC X     VALUE '-'.              
           05  WS-MAIN-UNIT                   PIC X(4)  VALUE SPACES.           
           05  WS-SLASH1                      PIC X     VALUE '-'.              
           05  WS-SUB-UNIT                    PIC X(3)  VALUE SPACES.           
                                                                                
       01  WS-VOUCHER-NO.                                                       
           05  WS-V-P1                        PIC X(4)  VALUE SPACES.           
           05  FILLER                         PIC X     VALUE '-'.              
           05  WS-V-P2                        PIC X(9)  VALUE SPACE.            
                                                                                
       01  WS-SAVE-VOUCHER-NO                 PIC X(12).                        
       01  WS-LITERALS.                                                         
           05  LT-SUCCESSFUL                  PIC X(2)  VALUE '00'.             
           05  LT-97                          PIC X(2)  VALUE '97'.             
                                                                                
      *----------------------------------------------------------------*        
      *   COMMON HEADER USE FOR BOTH REPORTS                           *        
      *----------------------------------------------------------------*        
       01  L446-HDG1.                                                           
           05  PRT-REPORT-TITLE          PIC X(9)  VALUE 'BP13L446'.            
           05  FILLER                    PIC X(30) VALUE SPACES.                
           05  FILLER                    PIC X(65) VALUE                        
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                    PIC X(7)  VALUE 'DATE :'.              
           05  PRT-DATE                  PIC X(10).                             
                                                                                
       01  L446-HDG2.                                                           
           05  FILLER                    PIC X(15) VALUE 'VOUCHER NO'.          
           05  FILLER                    PIC X(02) VALUE ': '.                  
           05  PRT-VOUCHER-NO            PIC 9(13).                             
           05  FILLER                    PIC X(74) VALUE SPACES.                
           05  FILLER                    PIC X(7)  VALUE 'PAGE : '.             
           05  PRT-PAGE                  PIC ZZZ9.                              
                                                                                
       01  L446-HDG3.                                                           
           05  FILLER                    PIC X(36) VALUE SPACES.                
           05  FILLER                    PIC X(44) VALUE                        
               'LIST FOR STAMPING OF SUPPLEMENTARY AGREEMENT'.                  
           05  FILLER                    PIC X(24) VALUE SPACES.                
           05  FILLER                    PIC X(07) VALUE 'USER : '.             
           05  FILLER                    PIC X(20)                              
               VALUE 'AGREEMENT TEAM'.                                          
                                                                                
       01  L446-HDG4.                                                           
           05  FILLER                    PIC X(36) VALUE SPACES.                
           05  FILLER                    PIC X(44) VALUE                        
               '             ( PREMIUM  CASES )             '.                  
           05  FILLER                    PIC X(52) VALUE SPACES.                
                                                                                
       01  L446-HDG5.                                                           
           05  FILLER                    PIC X(15) VALUE 'TO'.                  
           05  FILLER                    PIC X(02) VALUE ': '.                  
           05  FILLER                    PIC X(15)                              
                                               VALUE 'THE  ASSESSOR  '.         
           05  FILLER                    PIC X(100) VALUE SPACES.               
                                                                                
       01  L446-HDG6.                                                           
           05  FILLER                    PIC X(15) VALUE SPACES.                
           05  FILLER                    PIC X(02) VALUE SPACES.                
           05  FILLER                    PIC X(28)                              
                      VALUE 'COMMISSIONER OF STAMP DUTIES'.                     
           05  FILLER                    PIC X(87) VALUE SPACES.                
                                                                                
       01  L446-HDG7.                                                           
           05  FILLER                    PIC X(40)                              
           VALUE 'THE FOLLOWING INFORMATION GIVEN IS TO FA'.                    
           05  FILLER                    PIC X(40)                              
           VALUE 'CILITATE THE STAMPING OF THE SUPPLEMENTA'.                    
           05  FILLER                    PIC X(40)                              
           VALUE 'RY AGREEMENT (PREMIUM CASES)            '.                    
           05  FILLER                    PIC X(20) VALUE SPACES.                
                                                                                
      *================================================================*        
      *          FORMAT OF DETAIL LINE 1                                        
      *================================================================*        
      *         1         2         3         4         5                       
      *----+----+----+----+----+----+----+----+----+----*                       
      * VOUCHER NO.    REGN NO.                       FLA                       
      * XXXXXXXXXXX    XXXXXXXX    XXXXXXXXXXXXXXXXXXXXXX                       
      *         6         7         8         9         0                       
      *----+----+----+----+----+----+----+----+----+----*                       
      *T ADDRESS                      SELLING PRICE    SF                       
      *XXXXXXXXXXXXXXXXXXXXXXXXXXXX     999,999.99                              
      *         1         2         3                                           
      *----+----+----+----+----+----+-*                                         
      * PAID ON ORIG SA                                                         
      *  999,999.99                                                             
      *================================================================*        
      *           END OF FORMAT OF DETAIL LINE 1                                
      *================================================================*        
                                                                                
      *================================================================*        
      *          FORMAT OF DETAIL LINE 2                                        
      *================================================================*        
      *         1         2         3         4         5                       
      *----+----+----+----+----+----+----+----+----+----*                       
      *                NAMEX:   XXXXXXXXXXXXXXXXXXXXXXXXX                       
      *         6         7         8         9         0                       
      *----+----+----+----+----+----+----+----+----+----*                       
      *XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX   NRICX:                       
      *         1         2         3                                           
      *----+----+----+----+----+----+-*                                         
      *  XXXXXXXXX                                                              
      *================================================================*        
      *           END OF FORMAT OF DETAIL LINE 2                                
      *================================================================*        
                                                                                
       01  L446-HDG8.                                                           
           05  FILLER                   PIC X(01) VALUE SPACES.                 
           05  FILLER                   PIC X(11) VALUE 'SERIAL  NO.'.          
           05  FILLER                   PIC X(04) VALUE SPACES.                 
           05  FILLER                   PIC X(08) VALUE 'REGN NO.'.             
           05  FILLER                   PIC X(24) VALUE SPACES.                 
           05  FILLER                   PIC X(13) VALUE 'FLAT  ADDRESS'.        
           05  FILLER                   PIC X(22) VALUE SPACES.                 
           05  FILLER                   PIC X(13) VALUE 'SELLING PRICE'.        
           05  FILLER                   PIC X(04) VALUE SPACES.                 
           05  FILLER                   PIC X(18)                               
                                        VALUE 'SF PAID ON ORIG SA'.             
           05  FILLER                   PIC X(15) VALUE SPACES.                 
                                                                                
       01  L446-HDG9.                                                           
           05  FILLER                   PIC X(01) VALUE SPACES.                 
           05  FILLER                   PIC X(11) VALUE '==========='.          
           05  FILLER                   PIC X(04) VALUE SPACES.                 
           05  FILLER                   PIC X(08) VALUE '========'.             
           05  FILLER                   PIC X(04) VALUE SPACES.                 
           05  FILLER                   PIC X(50) VALUE ALL '='.                
           05  FILLER                   PIC X(04) VALUE SPACES.                 
           05  FILLER                   PIC X(13) VALUE '============='.        
           05  FILLER                   PIC X(04) VALUE SPACES.                 
           05  FILLER                   PIC X(18)                               
                                        VALUE '=================='.             
           05  FILLER                   PIC X(15) VALUE SPACES.                 
                                                                                
       01  L446-TRAILER.                                                        
           05  FILLER                   PIC X(15) VALUE 'CHECKED BY'.           
           05  FILLER                   PIC X(02) VALUE ': '.                   
           05  FILLER                   PIC X(50) VALUE SPACES.                 
           05  FILLER                   PIC X(15) VALUE 'CERTIFIED BY'.         
           05  FILLER                   PIC X(02) VALUE ': '.                   
           05  FILLER                   PIC X(48) VALUE SPACES.                 
                                                                                
      *----------------------------------------------------------------*        
      *   DETAIL RECORD FOR KEY NOT AVAILABLE/KEY AVAILABLE CASES      *        
      *----------------------------------------------------------------*        
       01  L446-DTL1.                                                           
           05  FILLER                   PIC X(05) VALUE SPACES.                 
           05  PRT-SERIAL-NO            PIC ZZZ9.                               
           05  FILLER                   PIC X(07) VALUE SPACES.                 
           05  PRT-REGN-NO              PIC X(08).                              
           05  FILLER                   PIC X(04) VALUE SPACES.                 
           05  PRT-ADDRESS              PIC X(50).                              
           05  FILLER                   PIC X(06) VALUE SPACES.                 
           05  PRT-SELLING-PRICE        PIC ZZZ,ZZ9.99.                         
           05  FILLER                   PIC X(09) VALUE SPACES.                 
           05  PRT-SF-PD-ON-ORIG-SA     PIC ZZZ,ZZ9.99.                         
           05  FILLER                   PIC X(20) VALUE SPACES.                 
                                                                                
       01  L446-DTL2.                                                           
           05  FILLER                   PIC X(16) VALUE SPACES.                 
           05  PRT-NRIC-NO              PIC X(09).                              
           05  FILLER                   PIC X(03) VALUE SPACES.                 
           05  PRT-NAME                 PIC X(66).                              
           05  FILLER                   PIC X(27) VALUE SPACES.                 
                                                                                
                                                                                
      **********************                                                    
       PROCEDURE DIVISION.                                                      
      **********************                                                    
                                                                                
      ******************************************************************        
       0000-MAIN.                                                               
      ******************************************************************        
           PERFORM   1000-INITIALIZATION   THRU   1000-EXIT.                    
           PERFORM   2000-PROCESS-ROUTINE  THRU   2000-EXIT                     
                         UNTIL WS-EOF-F315 = 'Y'.                               
           PERFORM   7000-WRAP-UP          THRU   7000-EXIT.                    
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       1000-INITIALIZATION.                                                     
      ******************************************************************        
           OPEN INPUT BP13F315                                                  
                      BP13K330                                                  
                      BP13K410                                                  
               OUTPUT BP13L446.                                                 
                                                                                
           PERFORM 8110-CHECK-K330-STATUS  THRU 8110-EXIT.                      
           PERFORM 8120-CHECK-K410-STATUS  THRU 8120-EXIT.                      
                                                                                
           INITIALIZE                          WS-COUNTERS.                     
           MOVE 50                         TO  WS-REC-CNT.                      
           MOVE  FUNCTION CURRENT-DATE TO WS-CURR-DATE.                         
                                                                                
           MOVE WS-CURR-CC                 TO  WS-EDIT-CC.                      
           MOVE WS-CURR-YY                 TO  WS-EDIT-YY.                      
           MOVE WS-CURR-MM                 TO  WS-EDIT-MM.                      
           MOVE WS-CURR-DD                 TO  WS-EDIT-DD.                      
           MOVE WS-EDIT-DATE               TO  PRT-DATE.                        
                                                                                
           PERFORM 5000-HEADER-EMAIL       THRU 5000-EXIT.                      
                                                                                
           PERFORM 8100-READ-F315          THRU 8100-EXIT.                      
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       2000-PROCESS-ROUTINE.                                                    
      ******************************************************************        
           IF  F315-CDE-SALES-TYPE = '10' OR '13' OR '18'                       
               IF  WS-INC-FL NOT = 'Y'                                          
                   PERFORM 2100-PRINT-REC      THRU 2100-EXIT                   
               ELSE                                                             
                   ADD 1                   TO WS-CNT-INV-F315                   
               END-IF                                                           
           ELSE                                                                 
               ADD 1                       TO WS-CNT-INV-F315                   
           END-IF.                                                              
                                                                                
           PERFORM 8100-READ-F315          THRU 8100-EXIT.                      
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       2100-PRINT-REC.                                                          
      ******************************************************************        
           PERFORM 3000-PRINT-ROUTINE     THRU 3000-EXIT.                       
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       3000-PRINT-ROUTINE.                                                      
      ******************************************************************        
           MOVE   BP13F315-TRANS-REC       TO   WS-F316-REV-REC.                
                                                                                
           STRING WS-F316-VOUCHER-NO(1:3) DELIMITED BY SIZE                     
                  '-'                     DELIMITED BY SIZE                     
                  WS-F316-VOUCHER-NO(4:2) DELIMITED BY SIZE                     
                  '-'                     DELIMITED BY SIZE                     
                  WS-F316-VOUCHER-NO(6:6) DELIMITED BY SIZE                     
                                          INTO  PRT-VOUCHER-NO.                 
                                                                                
           MOVE   WS-F316-SERIAL-NO        TO   PRT-SERIAL-NO.                  
                                                                                
           IF  WS-REC-CNT > 38 OR                                               
               WS-F316-VOUCHER-NO NOT = WS-SAVE-VOUCHER-NO                      
               MOVE WS-F316-VOUCHER-NO     TO   WS-SAVE-VOUCHER-NO              
               IF WS-SEQ-CNT > 0                                                
                  PERFORM 3200-PRINT-TRAILER  THRU 3200-EXIT                    
               END-IF                                                           
               PERFORM 3100-PRINT-HEADING  THRU 3100-EXIT                       
           END-IF.                                                              
                                                                                
           MOVE   SPACES                   TO   PRINT-REC-1.                    
           ADD    1                        TO   WS-SEQ-CNT.                     
           MOVE   K330-AMT-LEASE-STAMP     TO   WS-K330-AMT-LEASE-STAMP.        
           IF K330-DTE-AGRM-ORDER <= '20110218'                                 
              IF K330-NUM-SF-DISC = 'N'                                         
                 SUBTRACT 2.00 FROM WS-K330-AMT-LEASE-STAMP                     
              ELSE                                                              
                 SUBTRACT 1.40 FROM WS-K330-AMT-LEASE-STAMP                     
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE   WS-K330-AMT-LEASE-STAMP  TO   PRT-SF-PD-ON-ORIG-SA.           
           MOVE   K330-AMT-CURR-SELLPR     TO   PRT-SELLING-PRICE.              
           MOVE   F315-REGN-NO             TO   PRT-REGN-NO.                    
           MOVE   SPACES                   TO   PRT-ADDRESS.                    
           STRING 'BLK'           DELIMITED BY SIZE                             
                  F315-NUM-BLK    DELIMITED BY SIZE                             
                  ' '             DELIMITED BY SIZE                             
                  F315-NME-STREET DELIMITED BY SIZE                             
                  ' '             DELIMITED BY SIZE                             
                  '#'             DELIMITED BY SIZE                             
                  F315-NUM-LEVEL  DELIMITED BY SIZE                             
                  ' - '           DELIMITED BY SIZE                             
                  F315-NUM-MAIN   DELIMITED BY SIZE                             
                  ' '             DELIMITED BY SIZE                             
                  F315-NUM-POSTAL DELIMITED BY SIZE                             
                  INTO PRT-ADDRESS.                                             
                                                                                
           WRITE  PRINT-REC-1              FROM L446-DTL1 AFTER 2.              
           ADD    2                        TO   WS-REC-CNT.                     
                                                                                
           IF K410-NAME1 NOT = SPACES AND LOW-VALUES                            
              MOVE K410-NAME1              TO   PRT-NAME                        
              MOVE K410-NRIC1              TO   PRT-NRIC-NO                     
              WRITE  PRINT-REC-1           FROM L446-DTL2 AFTER 1               
              ADD    1                     TO   WS-REC-CNT                      
           END-IF.                                                              
                                                                                
           IF K410-NAME2 NOT = SPACES AND LOW-VALUES                            
              MOVE K410-NAME2              TO   PRT-NAME                        
              MOVE K410-NRIC2              TO   PRT-NRIC-NO                     
              WRITE  PRINT-REC-1           FROM L446-DTL2 AFTER 1               
              ADD    1                     TO   WS-REC-CNT                      
           END-IF.                                                              
                                                                                
           IF K410-NAME3 NOT = SPACES AND LOW-VALUES                            
              MOVE K410-NAME3              TO   PRT-NAME                        
              MOVE K410-NRIC3              TO   PRT-NRIC-NO                     
              WRITE  PRINT-REC-1           FROM L446-DTL2 AFTER 1               
              ADD    1                     TO   WS-REC-CNT                      
           END-IF.                                                              
                                                                                
           IF K410-NAME4 NOT = SPACES AND LOW-VALUES                            
              MOVE K410-NAME4              TO   PRT-NAME                        
              MOVE K410-NRIC4              TO   PRT-NRIC-NO                     
              WRITE  PRINT-REC-1           FROM L446-DTL2 AFTER 1               
              ADD    1                     TO   WS-REC-CNT                      
           END-IF.                                                              
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       3100-PRINT-HEADING.                                                      
      ******************************************************************        
           ADD    1              TO    WS-PAGE.                                 
           MOVE   WS-PAGE        TO    PRT-PAGE.                                
           MOVE   WS-EDIT-DATE   TO    PRT-DATE.                                
                                                                                
           MOVE   SPACES      TO   PRINT-REC-1.                                 
           WRITE  PRINT-REC-1 FROM L446-HDG1   AFTER PAGE.                      
           MOVE   SPACES      TO   PRINT-REC-1.                                 
           WRITE  PRINT-REC-1 FROM L446-HDG2 AFTER 1.                           
           MOVE   SPACES      TO   PRINT-REC-1.                                 
           WRITE  PRINT-REC-1 FROM L446-HDG3   AFTER 1.                         
           MOVE   SPACES      TO   PRINT-REC-1.                                 
           WRITE  PRINT-REC-1 FROM L446-HDG4   AFTER 1.                         
           MOVE   SPACES      TO   PRINT-REC-1.                                 
           WRITE  PRINT-REC-1 FROM L446-HDG5   AFTER 2.                         
           MOVE   SPACES      TO   PRINT-REC-1.                                 
           WRITE  PRINT-REC-1 FROM L446-HDG6   AFTER 1.                         
           MOVE   SPACES      TO   PRINT-REC-1.                                 
           WRITE  PRINT-REC-1 FROM L446-HDG7   AFTER 2.                         
           MOVE   SPACES      TO   PRINT-REC-1.                                 
           WRITE  PRINT-REC-1 FROM L446-HDG8   AFTER 2.                         
           MOVE   SPACES      TO   PRINT-REC-1.                                 
           WRITE  PRINT-REC-1 FROM L446-HDG9   AFTER 1.                         
           MOVE   SPACES      TO   PRINT-REC-1.                                 
           WRITE  PRINT-REC-1.                                                  
           MOVE   ZEROES      TO   WS-REC-CNT.                                  
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       3200-PRINT-TRAILER.                                                      
      ******************************************************************        
           MOVE   SPACES         TO PRINT-REC-1.                                
           WRITE  PRINT-REC-1    AFTER 1.                                       
                                                                                
           MOVE   SPACES         TO PRINT-REC-1.                                
           WRITE  PRINT-REC-1    FROM L446-TRAILER AFTER 3.                     
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *================================================================*        
       5000-HEADER-EMAIL.                                                       
      *================================================================*        
                                                                                
            WRITE PRINT-REC-1 FROM WS-MAIL-RPT1.                                
            WRITE PRINT-REC-1 FROM WS-MAIL-RPT2.                                
            WRITE PRINT-REC-1 FROM WS-MAIL-RPT3.                                
            WRITE PRINT-REC-1 FROM WS-MAIL-RPT4.                                
            WRITE PRINT-REC-1 FROM WS-MAIL-RPT5.                                
                                                                                
            WRITE PRINT-REC-1 FROM WS-MAIL-RPT7.                                
            WRITE PRINT-REC-1 FROM WS-MAIL-RPT7B.                               
            WRITE PRINT-REC-1 FROM WS-MAIL-RPT7C.                               
            WRITE PRINT-REC-1 FROM WS-MAIL-RPT8.                                
            WRITE PRINT-REC-1 FROM WS-MAIL-RPT9.                                
            WRITE PRINT-REC-1 FROM WS-MAIL-RPT10.                               
            WRITE PRINT-REC-1 FROM WS-MAIL-RPT11.                               
            WRITE PRINT-REC-1 FROM WS-MAIL-RPT12.                               
                                                                                
            WRITE PRINT-REC-1 FROM WS-MAIL-RPT13B.                              
            WRITE PRINT-REC-1 FROM WS-MAIL-RPT13D.                              
            WRITE PRINT-REC-1 FROM WS-MAIL-RPT13E.                              
            WRITE PRINT-REC-1 FROM WS-MAIL-RPT15.                               
                                                                                
            STRING  FUNCTION CURRENT-DATE(7:2) '/'                              
                    FUNCTION CURRENT-DATE(5:2) '/'                              
                    FUNCTION CURRENT-DATE(1:4)                                  
            DELIMITED BY SIZE INTO WS-DATE-RPT.                                 
                                                                                
            WRITE PRINT-REC-1 FROM WS-DATE-RPT-DTL.                             
                                                                                
            MOVE SPACES TO  PRINT-REC-1.                                        
            WRITE   PRINT-REC-1.                                                
                                                                                
       5000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
                                                                                
                                                                                
      ******************************************************************        
       7000-WRAP-UP.                                                            
      ******************************************************************        
           IF WS-SEQ-CNT > 0                                                    
              PERFORM 3200-PRINT-TRAILER  THRU 3200-EXIT                        
           END-IF.                                                              
                                                                                
           CLOSE BP13F315                                                       
                 BP13K330                                                       
                 BP13K410                                                       
                 BP13L446.                                                      
                                                                                
           DISPLAY '************************************'                       
           DISPLAY '*         (BP13C446)               *'                       
           DISPLAY '************************************'                       
           DISPLAY '* NO. OF F315 RECS READ    ' WS-CNT-READ-F315 '  *'         
           DISPLAY '* NO. OF INV  F315 RECS    ' WS-CNT-INV-F315  '  *'         
           DISPLAY '************************************'                       
                                                                                
           STOP RUN.                                                            
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       8100-READ-F315.                                                          
      ******************************************************************        
            READ BP13F315                                                       
                AT END MOVE 'Y'      TO WS-EOF-F315                             
                       GO            TO 8100-EXIT                               
            END-READ.                                                           
                                                                                
            IF  F315-CDE-SALES-TYPE = '10' OR '13' OR '18'                      
                ADD 1                    TO WS-CNT-READ-F315                    
                MOVE F315-REGN-NO        TO K410-NUM-REGN                       
                PERFORM 8200-READ-K410   THRU 8200-EXIT                         
                                                                                
                MOVE    SPACES           TO   K330-KEY-FLD                      
                MOVE    F315-REGN-NO     TO   K330-CURR-REG                     
                MOVE    '1'              TO   K330-SEQ-NO                       
                PERFORM 8300-READ-K330   THRU 8300-EXIT                         
            END-IF.                                                             
                                                                                
       8100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       8110-CHECK-K330-STATUS.                                                  
      ******************************************************************        
            IF  K330-STATUS NOT = LT-SUCCESSFUL AND LT-97                       
                DISPLAY 'K330-IO-ERROR, K330-STATUS = ' K330-STATUS             
                PERFORM  9900-HANDLE-ABEND     THRU 9900-EXIT                   
            END-IF.                                                             
                                                                                
       8110-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       8120-CHECK-K410-STATUS.                                                  
      ******************************************************************        
            IF  K410-STATUS NOT = LT-SUCCESSFUL AND LT-97                       
                DISPLAY 'K410 IO-ERROR, K410-STATUS = ' K410-STATUS             
                PERFORM  9900-HANDLE-ABEND     THRU 9900-EXIT                   
            END-IF.                                                             
                                                                                
       8120-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       8200-READ-K410.                                                          
      ******************************************************************        
            MOVE 'N'                       TO WS-INC-FL.                        
            READ BP13K410 KEY K410-KEY-FLD                                      
            INVALID KEY DISPLAY 'MISSING BP13K410: ' K410-NUM-REGN              
                        MOVE 'Y'                     TO WS-INC-FL               
                        MOVE '00'                    TO K410-STATUS             
            END-READ.                                                           
                                                                                
            PERFORM 8120-CHECK-K410-STATUS THRU 8120-EXIT.                      
                                                                                
       8200-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       8300-READ-K330.                                                          
      ******************************************************************        
            READ BP13K330  KEY K330-KEY-FLD                                     
            INVALID KEY DISPLAY 'MISSING BP13K330: ' F315-REGN-NO               
                        MOVE 'Y'                     TO WS-INC-FL               
                        MOVE '00'                    TO K330-STATUS             
            END-READ.                                                           
                                                                                
            PERFORM 8110-CHECK-K330-STATUS THRU 8110-EXIT.                      
                                                                                
       8300-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       9900-HANDLE-ABEND.                                                       
      ******************************************************************        
           CLOSE BP13F315                                                       
                 BP13K330                                                       
                 BP13K410                                                       
                 BP13L446.                                                      
                                                                                
           STOP RUN.                                                            
                                                                                
       9900-EXIT.                                                               
           EXIT.                                                                
      ************************************************************              
      *                 END OF BP13C446                          *              
      ************************************************************              
