*====================================================================           
*                       PROGRAM PROFILE                                         
*====================================================================           
* APPLICATION     : BP13                                                        
* CHGE REQ NO     : BP137378                                                    
* PROGRAM ID      : BP13S558                                                    
*                                                                               
* PURPOSE OF PGM  : GENERATE EXCEPTION REPORTS                                  
*--------------------------------------------------------------------           
* FILES PROCESSED :                                                             
*    INPUTS - BP13F730                                                          
*             BP13F825                                                          
*    OUTPUT - BP13L558                                                          
*                                                                               
* EXCEPTION REPORTS                                                             
*    P13L558A - MGPS APPLICATION W/O PARENT/CHILD                               
*    P13L558B - HOUSEHOLD = G AND PPS = P OR Y OR E                             
*    P13L558C - HOUSEHOLD = H OR F AND AST = P OR Y                             
*    P13L558D - ALL MGPS APPLICATIONS                                           
*    P13L558E - 3GEN=P/AST=P/PPS=P/FT2T=P                                       
*    P13L558F - ALLOC SCHEME = FTS AND HH = G OR F                              
*    P13L558G - ALLOC SCHEME = FTS AND PPS = P OR Y                             
*    P13L558H - ELIGIBLE FOR MCPS (M) AND 3GEN = N                              
*    P13L558I - ELIG SCHEME = PAS OR PAA OR SMP                                 
*    P13L558J - ELIG SCH = FS AND PPS = E OR Y                                  
*               AND HA1 AND FIANCE = SINGLE                                     
*    P13L558K - PORT CASES                                                      
*    P13L558L - CASE TAG FTS AND APPS                                           
*    P13L558M - APPS ELIG = BLANK                                               
*    P13L558N - 2F FTS/STS/NTIMER/PPO WITH AST=Y                                
*    P13L558O - HH INCOME > 6K 2F NON-ELDERLY                                   
*    P13L558P - ELDRLY N TMER ALLOC SCHEME NOT STS OR PA                        
*    P13L558Q - 2F NON-ELDERLY WITH PPO/NTIMER                                  
*    P13L558R - ELDERLY WITH AST OR PPS                                         
*    P13L558S - NON-ELDERLY FTS APPLYING FOR MATURE EST                         
*    P13L558T - INVALID EMAIL ADDRESS                                           
*    P13L558U - 2RM & ELDERLY = F OR S & MCP = B                                
*    P13L558V - FTS OR STS WITH MCPS AND HA1 = SINGLE                           
*    P13L558W - HA1 SINGLE MCP = Y EXCLUDE ELIG SCH = FS                        
*                                                                               
*--------------------------------------------------------------------           
* MODIFICATION LOG:                                                             
*                                                                               
* CHGE REQ   MODIFIED ON  AUTHOR DESCRIPTION                                    
* ---------- -----------  ------ -----------------------------------            
* BP137378   13/11/2017   SMR2   NEW PROGRAM                                    
* BP137378   13/07/2018   AM25   TO PRODUCE REPORT WITH EMPTY INPUTS            
* BP137378   28/09/2018   AM25   REPORT UPDATES                                 
* BP137920   09/10/2019   IL5    ADD NEW ELIG SCH 'PAC' IN TITLE                
* BP138038   07/11/2019   IL5    CHANGE OF COL HEADING '6K' TO '7K'             
* BP138301   01/07/2020   AM25   REMOVE 'NEW' IN PROC PRINTTO                   
* BP139057   07/02/2022   AM25   NEW COLS UNDER ELIG=PAS/PAA/SMP/PAC            
*====================================================================;          
                                                                                
DATA BP13F73A;                                                                  
     INFILE BP13F73A;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @118  MCP        $CHAR1.                                            
            @253  MCP_ELG    $CHAR1.                                            
            @433  PORT       $CHAR1.                                            
            @406  SERIAL     $CHAR5.                                            
            @376  MODE       $CHAR3.                                            
            @446  LOAN       $CHAR1.                                            
            @261  DREQ       $CHAR8.                                            
            @469  PPS        $CHAR1.                                            
            @475  FT2T       $CHAR1.                                            
            @467  AGE_SC     $CHAR2.                                            
            @473  AGE_NSC    $CHAR2.                                            
            @246  GEN3       $CHAR1.;                                           
                                                                                
DATA P13L558A;                                                                  
     IF EOF THEN OUTPUT P13L558A;                                               
     SET BP13F73A END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558A;                                               
     PROC PRINT DATA=BP13F73A;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 'MGPS - RECORD WITH NO PARENT/CHILD    ';                                
                                                                                
     PROC PRINTTO PRINT=P13L558A;                                               
     PROC REPORT DATA=P13L558A NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 'MGPS - RECORD WITH NO PARENT/CHILD    ';                                
TITLE2 'NO CASES                              ';                                
                                                                                
                                                                                
DATA BP13F73B;                                                                  
     INFILE BP13F73B;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @118  MCP        $CHAR1.                                            
            @253  MCP_ELG    $CHAR1.                                            
            @433  PORT       $CHAR1.                                            
            @406  SERIAL     $CHAR5.                                            
            @376  MODE       $CHAR3.                                            
            @446  LOAN       $CHAR1.                                            
            @261  DREQ       $CHAR8.                                            
            @469  PPS        $CHAR1.                                            
            @475  FT2T       $CHAR1.                                            
            @467  AGE_SC     $CHAR2.                                            
            @473  AGE_NSC    $CHAR2.                                            
            @246  GEN3       $CHAR1.;                                           
                                                                                
DATA P13L558B;                                                                  
     IF EOF THEN OUTPUT P13L558B;                                               
     SET BP13F73B END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558B;                                               
     PROC PRINT DATA=BP13F73B;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 'HOUSEHOLD = G AND PPS = P OR Y OR E   ';                                
                                                                                
     PROC PRINTTO PRINT=P13L558B;                                               
     PROC REPORT DATA=P13L558B NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 'HOUSEHOLD = G AND PPS = P OR Y OR E   ';                                
TITLE2 'NO CASES                              ';                                
                                                                                
                                                                                
DATA BP13F73C;                                                                  
     INFILE BP13F73C;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @118  MCP        $CHAR1.                                            
            @253  MCP_ELG    $CHAR1.                                            
            @433  PORT       $CHAR1.                                            
            @406  SERIAL     $CHAR5.                                            
            @376  MODE       $CHAR3.                                            
            @446  LOAN       $CHAR1.                                            
            @261  DREQ       $CHAR8.                                            
            @469  PPS        $CHAR1.                                            
            @475  FT2T       $CHAR1.                                            
            @467  AGE_SC     $CHAR2.                                            
            @473  AGE_NSC    $CHAR2.                                            
            @246  GEN3       $CHAR1.                                            
            @471  AST        $CHAR1.;                                           
                                                                                
DATA P13L558C;                                                                  
     IF EOF THEN OUTPUT P13L558C;                                               
     SET BP13F73C END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558C;                                               
     PROC PRINT DATA=BP13F73C;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 'HOUSEHOLD = H OR F AND AST = P OR Y   ';                                
                                                                                
     PROC PRINTTO PRINT=P13L558C;                                               
     PROC REPORT DATA=P13L558C NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 'HOUSEHOLD = H OR F AND AST = P OR Y   ';                                
TITLE2 'NO CASES                              ';                                
                                                                                
                                                                                
DATA BP13F73D;                                                                  
     INFILE BP13F73D;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @177  PAIR_REGN  $CHAR8.                                            
            @245  MGP        $CHAR1.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @118  MCP        $CHAR1.                                            
            @253  MCP_ELG    $CHAR1.;                                           
                                                                                
DATA P13L558D;                                                                  
     IF EOF THEN OUTPUT P13L558D;                                               
     SET BP13F73D END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558D;                                               
     PROC PRINT DATA=BP13F73D;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 'MGPS';                                                                  
                                                                                
     PROC PRINTTO PRINT=P13L558D;                                               
     PROC REPORT DATA=P13L558D NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 'MGPS';                                                                  
TITLE2 'NO CASES';                                                              
                                                                                
                                                                                
DATA BP13F73E;                                                                  
     INFILE BP13F73E;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @118  MCP        $CHAR1.                                            
            @253  MCP_ELG    $CHAR1.                                            
            @433  PORT       $CHAR1.                                            
            @406  SERIAL     $CHAR5.                                            
            @376  MODE       $CHAR3.                                            
            @446  LOAN       $CHAR1.                                            
            @261  DREQ       $CHAR8.                                            
            @469  PPS        $CHAR1.                                            
            @475  FT2T       $CHAR1.                                            
            @467  AGE_SC     $CHAR2.                                            
            @473  AGE_NSC    $CHAR2.                                            
            @246  GEN3       $CHAR1.                                            
            @471  AST        $CHAR1.;                                           
                                                                                
DATA P13L558E;                                                                  
     IF EOF THEN OUTPUT P13L558E;                                               
     SET BP13F73E END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558E;                                               
     PROC PRINT DATA=BP13F73E;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 '3GEN=P/AST=P/PPS=P/FT2T=P             ';                                
                                                                                
     PROC PRINTTO PRINT=P13L558E;                                               
     PROC REPORT DATA=P13L558E NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 '3GEN=P/AST=P/PPS=P/FT2T=P             ';                                
TITLE2 'NO CASES                              ';                                
                                                                                
                                                                                
DATA BP13F73F;                                                                  
     INFILE BP13F73F;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @210  ELDERLY    $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @118  MCP        $CHAR1.                                            
            @253  MCP_ELG    $CHAR1.                                            
            @433  PORT       $CHAR1.                                            
            @406  SERIAL     $CHAR5.                                            
            @376  MODE       $CHAR3.                                            
            @446  LOAN       $CHAR1.                                            
            @261  DREQ       $CHAR8.                                            
            @469  PPS        $CHAR1.                                            
            @475  FT2T       $CHAR1.                                            
            @467  AGE_SC     $CHAR2.                                            
            @473  AGE_NSC    $CHAR2.                                            
            @246  GEN3       $CHAR1.;                                           
                                                                                
DATA P13L558F;                                                                  
     IF EOF THEN OUTPUT P13L558F;                                               
     SET BP13F73F END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558F;                                               
     PROC PRINT DATA=BP13F73F;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 'ALLOCATION SCHEME = FTS AND HOUSEHOLD = G OR F';                        
                                                                                
     PROC PRINTTO PRINT=P13L558F;                                               
     PROC REPORT DATA=P13L558F NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 'ALLOCATION SCHEME = FTS AND HOUSEHOLD = G OR F';                        
TITLE2 'NO CASES                                      ';                        
                                                                                
                                                                                
DATA BP13F73G;                                                                  
     INFILE BP13F73G;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @118  MCP        $CHAR1.                                            
            @253  MCP_ELG    $CHAR1.                                            
            @433  PORT       $CHAR1.                                            
            @406  SERIAL     $CHAR5.                                            
            @376  MODE       $CHAR3.                                            
            @446  LOAN       $CHAR1.                                            
            @261  DREQ       $CHAR8.                                            
            @469  PPS        $CHAR1.                                            
            @475  FT2T       $CHAR1.                                            
            @467  AGE_SC     $CHAR2.                                            
            @473  AGE_NSC    $CHAR2.                                            
            @246  GEN3       $CHAR1.;                                           
                                                                                
DATA P13L558G;                                                                  
     IF EOF THEN OUTPUT P13L558G;                                               
     SET BP13F73G END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558G;                                               
     PROC PRINT DATA=BP13F73G;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 'ALLOCATION SCHEME = FTS AND PPS = P OR Y';                              
                                                                                
     PROC PRINTTO PRINT=P13L558G;                                               
     PROC REPORT DATA=P13L558G NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 'ALLOCATION SCHEME = FTS AND PPS = P OR Y';                              
TITLE2 'NO CASES                                ';                              
                                                                                
                                                                                
DATA BP13F73H;                                                                  
     INFILE BP13F73H;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @118  MCP        $CHAR1.                                            
            @253  MCP_ELG    $CHAR1.                                            
            @433  PORT       $CHAR1.                                            
            @406  SERIAL     $CHAR5.                                            
            @376  MODE       $CHAR3.                                            
            @446  LOAN       $CHAR1.                                            
            @261  DREQ       $CHAR8.                                            
            @469  PPS        $CHAR1.                                            
            @475  FT2T       $CHAR1.                                            
            @467  AGE_SC     $CHAR2.                                            
            @473  AGE_NSC    $CHAR2.                                            
            @246  GEN3       $CHAR1.                                            
            @31   REL        $CHAR2.                                            
            @476  REL_NRIC   $CHAR9.;                                           
                                                                                
DATA P13L558H;                                                                  
     IF EOF THEN OUTPUT P13L558H;                                               
     SET BP13F73H END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558H;                                               
     PROC PRINT DATA=BP13F73H;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 'MULTI-TIER STRUCTURE, 3GEN NOT "Y"';                                    
                                                                                
     PROC PRINTTO PRINT=P13L558H;                                               
     PROC REPORT DATA=P13L558H NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 'MULTI-TIER STRUCTURE, 3GEN NOT "Y"';                                    
TITLE2 'NO CASES                          ';                                    
                                                                                
                                                                                
DATA BP13F73I;                                                                  
     INFILE BP13F73I;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @177  PAIR_REGN  $CHAR8.                                            
            @245  MGP        $CHAR1.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @118  MCP        $CHAR1.                                            
            @253  MCP_ELG    $CHAR1.                                            
            @471  AST        $CHAR1.                                            
            @469  PPS        $CHAR1.;                                           
                                                                                
DATA P13L558I;                                                                  
     IF EOF THEN OUTPUT P13L558I;                                               
     SET BP13F73I END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558I;                                               
     PROC PRINT DATA=BP13F73I;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 'ELIG SCH = PAS OR PAA OR SMP OR PAC';                                   
                                                                                
     PROC PRINTTO PRINT=P13L558I;                                               
     PROC REPORT DATA=P13L558I NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 'ELIG SCH = PAS OR PAA OR SMP OR PAC';                                   
TITLE2 'NO CASES                    ';                                          
                                                                                
                                                                                
PROC FORMAT;                                                                    
     VALUE $MS '1'='SINGLE   '                                                  
               '2'='MARRIED  '                                                  
               '3'='WIDOWED  '                                                  
               '4'='DIVORCED '                                                  
               '5'='SEPARATED';                                                 
                                                                                
DATA BP13F73J;                                                                  
     INFILE BP13F73J;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @118  MCP        $CHAR1.                                            
            @253  MCP_ELG    $CHAR1.                                            
            @469  PPS        $CHAR1.;                                           
     PROC SORT; BY REGN NRIC1;                                                  
                                                                                
DATA BP13K825;                                                                  
     INFILE BP13K825;                                                           
     INPUT  @1    REGN       $CHAR8.                                            
            @9    NRIC1      $CHAR9.                                            
            @96   NRIC1_MS   $CHAR1.                                            
            @107  REL1       $CHAR2.                                            
            @96   MS1        $CHAR1.;                                           
     IF REL1 = '00' AND MS1 = '1';                                              
     PROC SORT; BY REGN;                                                        
                                                                                
DATA F73JK825;                                                                  
     MERGE BP13F73J(IN=A) BP13K825(IN=B);                                       
     BY REGN;                                                                   
     IF A AND B;                                                                
     FORMAT NRIC1_MS $MS.;                                                      
                                                                                
DATA F73JK825;                                                                  
     SET F73JK825;                                                              
     PROC SORT; BY REGN;                                                        
                                                                                
DATA BP13K825;                                                                  
     INFILE BP13K825;                                                           
     INPUT  @1    REGN       $CHAR8.                                            
            @9    NRIC2      $CHAR9.                                            
            @96   NRIC2_MS   $CHAR1.                                            
            @107  REL2       $CHAR2.                                            
            @96   MS2        $CHAR1.;                                           
     IF REL2 = '09' AND MS2 = '1';                                              
     PROC SORT; BY REGN;                                                        
                                                                                
DATA FINAL;                                                                     
     MERGE F73JK825(IN=A) BP13K825(IN=B);                                       
     BY REGN;                                                                   
     IF A AND B;                                                                
                                                                                
DATA P13L558J;                                                                  
     IF EOF THEN OUTPUT P13L558J;                                               
     SET FINAL END=EOF;                                                         
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558J;                                               
     PROC PRINT DATA=FINAL;                                                     
     FORMAT NRIC2_MS $MS.;                                                      
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 'ELIGIBILITY SCHEME = FS AND PPS = E OR Y AND HA1 '                      
       'AND FIANCE = SINGLE';                                                   
                                                                                
     PROC PRINTTO PRINT=P13L558J;                                               
     PROC REPORT DATA=P13L558J NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 'ELIGIBILITY SCHEME = FS AND PPS = E OR Y AND HA1 '                      
       'AND FIANCE = SINGLE';                                                   
TITLE2 'NO CASES                                         ';                     
                                                                                
                                                                                
DATA BP13F73K;                                                                  
     INFILE BP13F73K;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @210  ELDERLY    $CHAR1.                                            
            @204  INCOME     $CHAR5.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @461  BHH        $CHAR1.                                            
            @433  PORT       $CHAR1.                                            
            @475  FT2T       $CHAR1.;                                           
                                                                                
DATA P13L558K;                                                                  
     IF EOF THEN OUTPUT P13L558K;                                               
     SET BP13F73K END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558K;                                               
     PROC PRINT DATA=BP13F73K;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 'PORT CASE';                                                             
                                                                                
     PROC PRINTTO PRINT=P13L558K;                                               
     PROC REPORT DATA=P13L558K NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 'PORT CASE';                                                             
TITLE2 'NO CASES ';                                                             
                                                                                
                                                                                
DATA BP13F73L;                                                                  
     INFILE BP13F73L;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @177  PAIR_REGN  $CHAR8.                                            
            @245  MGP        $CHAR1.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @243  APPS       $CHAR1.;                                           
                                                                                
DATA P13L558L;                                                                  
     IF EOF THEN OUTPUT P13L558L;                                               
     SET BP13F73L END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558L;                                               
     PROC PRINT DATA=BP13F73L;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 'CASE TAG FTS AND APPS';                                                 
                                                                                
     PROC PRINTTO PRINT=P13L558L;                                               
     PROC REPORT DATA=P13L558L NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 'CASE TAG FTS AND APPS';                                                 
TITLE2 'NO CASES             ';                                                 
                                                                                
                                                                                
DATA BP13F73M;                                                                  
     INFILE BP13F73M;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @177  PAIR_REGN  $CHAR8.                                            
            @245  MGP        $CHAR1.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @243  APPS       $CHAR1.;                                           
                                                                                
DATA P13L558M;                                                                  
     IF EOF THEN OUTPUT P13L558M;                                               
     SET BP13F73M END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558M;                                               
     PROC PRINT DATA=BP13F73M;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 'APPS ELIG = BLANK';                                                     
                                                                                
     PROC PRINTTO PRINT=P13L558M;                                               
     PROC REPORT DATA=P13L558M NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 'APPS ELIG = BLANK';                                                     
TITLE2 'NO CASES         ';                                                     
                                                                                
                                                                                
DATA BP13F73N;                                                                  
     INFILE BP13F73N;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @210  ELDERLY    $CHAR1.                                            
            @209  NTIMER     $CHAR1.                                            
            @347  PPO        $CHAR1.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @461  BHH        $CHAR1.                                            
            @471  AST        $CHAR1.                                            
            @475  FT2T       $CHAR1.;                                           
                                                                                
DATA P13L558N;                                                                  
     IF EOF THEN OUTPUT P13L558N;                                               
     SET BP13F73N END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558N;                                               
     PROC PRINT DATA=BP13F73N;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 '2F FTS / STS / NTIMER(Y) / PPO(A/B/C) WITH AST(Y)';                     
                                                                                
     PROC PRINTTO PRINT=P13L558N;                                               
     PROC REPORT DATA=P13L558N NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 '2F FTS / STS / NTIMER(Y) / PPO(A/B/C) WITH AST(Y)';                     
TITLE2 'NO CASES                                         ';                     
                                                                                
                                                                                
DATA BP13F73O;                                                                  
     INFILE BP13F73O;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @210  ELDERLY    $CHAR1.                                            
            @204  INCOME     $CHAR5.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @461  BHH        $CHAR1.                                            
            @475  FT2T       $CHAR1.;                                           
                                                                                
DATA P13L558O;                                                                  
     IF EOF THEN OUTPUT P13L558O;                                               
     SET BP13F73O END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558O;                                               
     PROC PRINT DATA=BP13F73O;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 '2F NON-ELDERLY INCOME>7K';                                              
                                                                                
     PROC PRINTTO PRINT=P13L558O;                                               
     PROC REPORT DATA=P13L558O NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 '2F NON-ELDERLY INCOME>7K';                                              
TITLE2 'NO CASES                ';                                              
                                                                                
                                                                                
DATA BP13F73P;                                                                  
     INFILE BP13F73P;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @210  ELDERLY    $CHAR1.                                            
            @204  INCOME     $CHAR5.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @461  BHH        $CHAR1.                                            
            @475  FT2T       $CHAR1.;                                           
                                                                                
DATA P13L558P;                                                                  
     IF EOF THEN OUTPUT P13L558P;                                               
     SET BP13F73P END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558P;                                               
     PROC PRINT DATA=BP13F73P;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 'ELDERLY N TIMER ALLOCATION SCHEME WITH PRIORITY';                       
                                                                                
     PROC PRINTTO PRINT=P13L558P;                                               
     PROC REPORT DATA=P13L558P NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 'ELDERLY N TIMER ALLOCATION SCHEME WITH PRIORITY';                       
TITLE2 'NO CASES                                       ';                       
                                                                                
                                                                                
DATA BP13F73Q;                                                                  
     INFILE BP13F73Q;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @210  ELDERLY    $CHAR1.                                            
            @204  INCOME     $CHAR5.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @461  BHH        $CHAR1.                                            
            @347  PPO        $CHAR1.                                            
            @209  NTIMER     $CHAR1.                                            
            @475  FT2T       $CHAR1.;                                           
                                                                                
DATA P13L558Q;                                                                  
     IF EOF THEN OUTPUT P13L558Q;                                               
     SET BP13F73Q END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558Q;                                               
     PROC PRINT DATA=BP13F73Q;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 'NON-ELDERLY WITH PPO/NTIMER';                                           
                                                                                
     PROC PRINTTO PRINT=P13L558Q;                                               
     PROC REPORT DATA=P13L558Q NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 'NON-ELDERLY WITH PPO/NTIMER';                                           
TITLE2 'NO CASES                   ';                                           
                                                                                
                                                                                
DATA BP13F73R;                                                                  
     INFILE BP13F73R;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @210  ELDERLY    $CHAR1.                                            
            @204  INCOME     $CHAR5.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @461  BHH        $CHAR1.                                            
            @209  NTIMER     $CHAR1.                                            
            @469  PPS        $CHAR1.                                            
            @471  AST        $CHAR1.                                            
            @475  FT2T       $CHAR1.;                                           
                                                                                
DATA P13L558R;                                                                  
     IF EOF THEN OUTPUT P13L558R;                                               
     SET BP13F73R END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558R;                                               
     PROC PRINT DATA=BP13F73R;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 'ELDERLY WITH AST OR PPS';                                               
                                                                                
     PROC PRINTTO PRINT=P13L558R;                                               
     PROC REPORT DATA=P13L558R NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 'ELDERLY WITH AST OR PPS';                                               
TITLE2 'NO CASES               ';                                               
                                                                                
                                                                                
DATA BP13F73S;                                                                  
     INFILE BP13F73S;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @210  ELDERLY    $CHAR1.                                            
            @204  INCOME     $CHAR5.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @461  BHH        $CHAR1.                                            
            @209  NTIMER     $CHAR1.                                            
            @475  FT2T       $CHAR1.                                            
            @118  MCPS       $CHAR1.                                            
            @253  MCPS_ELIG  $CHAR1.;                                           
                                                                                
DATA P13L558S;                                                                  
     IF EOF THEN OUTPUT P13L558S;                                               
     SET BP13F73S END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558S;                                               
     PROC PRINT DATA=BP13F73S;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 'NON-ELDERLY FTS APPLYING FOR MATURE EST';                               
                                                                                
     PROC PRINTTO PRINT=P13L558S;                                               
     PROC REPORT DATA=P13L558S NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 'NON-ELDERLY FTS APPLYING FOR MATURE EST';                               
TITLE2 'NO CASES                               ';                               
                                                                                
                                                                                
DATA BP13F73T;                                                                  
     INFILE BP13F73T;                                                           
     INPUT  @1    REGN       $CHAR8.                                            
            @9    EMAIL      $CHAR50.;                                          
                                                                                
DATA P13L558T;                                                                  
     IF EOF THEN OUTPUT P13L558T;                                               
     SET BP13F73T END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558T;                                               
     PROC PRINT DATA=BP13F73T;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 'INVALID EMAIL ADDRESS';                                                 
                                                                                
     PROC PRINTTO PRINT=P13L558T;                                               
     PROC REPORT DATA=P13L558T NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 'INVALID EMAIL ADDRESS';                                                 
TITLE2 'NO CASES             ';                                                 
                                                                                
                                                                                
DATA BP13F73U;                                                                  
     INFILE BP13F73U;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @210  ELDERLY    $CHAR1.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @461  BHH        $CHAR1.                                            
            @475  FT2T       $CHAR1.;                                           
                                                                                
DATA P13L558U;                                                                  
     IF EOF THEN OUTPUT P13L558U;                                               
     SET BP13F73U END=EOF;                                                      
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558U;                                               
     PROC PRINT DATA=BP13F73U;                                                  
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 '2F ELDERLY WITH MCPS=B';                                                
                                                                                
     PROC PRINTTO PRINT=P13L558U;                                               
     PROC REPORT DATA=P13L558U NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 '2F ELDERLY WITH MCPS=B';                                                
TITLE2 'NO CASES              ';                                                
                                                                                
                                                                                
PROC FORMAT;                                                                    
     VALUE $MS '1'='SINGLE   '                                                  
               '2'='MARRIED  '                                                  
               '3'='WIDOWED  '                                                  
               '4'='DIVORCED '                                                  
               '5'='SEPARATED';                                                 
                                                                                
DATA BP13F73V;                                                                  
     INFILE BP13F73V;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @210  ELDERLY    $CHAR1.                                            
            @204  INCOME     $CHAR5.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @461  BHH        $CHAR1.                                            
            @209  NTIMER     $CHAR1.                                            
            @475  FT2T       $CHAR1.                                            
            @118  MCPS       $CHAR1.                                            
            @253  MCPS_ELIG  $CHAR1.;                                           
     PROC SORT; BY REGN NRIC1;                                                  
                                                                                
DATA BP13K825;                                                                  
     INFILE BP13K825;                                                           
     INPUT  @1    REGN       $CHAR8.                                            
            @9    NRIC1      $CHAR9.                                            
            @96   NRIC1_MS   $CHAR1.                                            
            @107  REL        $CHAR2.                                            
            @96   MS         $CHAR1.;                                           
     IF REL = '00' AND MS = '1';                                                
     PROC SORT; BY REGN;                                                        
                                                                                
DATA FINAL;                                                                     
     MERGE BP13F73V(IN=A) BP13K825(IN=B);                                       
     BY REGN;                                                                   
     IF A AND B;                                                                
                                                                                
DATA P13L558V;                                                                  
     IF EOF THEN OUTPUT P13L558V;                                               
     SET FINAL END=EOF;                                                         
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558V;                                               
     PROC PRINT DATA=FINAL;                                                     
     FORMAT NRIC1_MS $MS.;                                                      
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 'FTS OR STS WITH MCPS AND HA1 = SINGLE';                                 
                                                                                
     PROC PRINTTO PRINT=P13L558V;                                               
     PROC REPORT DATA=P13L558V NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 'FTS OR STS WITH MCPS AND HA1 = SINGLE';                                 
TITLE2 'NO CASES                             ';                                 
                                                                                
                                                                                
PROC FORMAT;                                                                    
     VALUE $MS '1'='SINGLE   '                                                  
               '2'='MARRIED  '                                                  
               '3'='WIDOWED  '                                                  
               '4'='DIVORCED '                                                  
               '5'='SEPARATED';                                                 
                                                                                
DATA BP13F73W;                                                                  
     INFILE BP13F73W;                                                           
     INPUT  @123  REGN       $CHAR8.                                            
            @210  ELDERLY    $CHAR1.                                            
            @204  INCOME     $CHAR5.                                            
            @41   NRIC1      $CHAR9.                                            
            @187  NT1        $CHAR3.                                            
            @211  FT         $CHAR2.                                            
            @225  CAT        $CHAR1.                                            
            @116  HH         $CHAR1.                                            
            @213  ALLO       $CHAR3.                                            
            @248  ELIG       $CHAR3.                                            
            @175  FIVEYR     $CHAR1.                                            
            @68   MTHMET     $CHAR3.                                            
            @461  BHH        $CHAR1.                                            
            @209  NTIMER     $CHAR1.                                            
            @475  FT2T       $CHAR1.                                            
            @118  MCPS       $CHAR1.                                            
            @253  MCPS_ELIG  $CHAR1.;                                           
     PROC SORT; BY REGN NRIC1;                                                  
                                                                                
DATA BP13K825;                                                                  
     INFILE BP13K825;                                                           
     INPUT  @1    REGN       $CHAR8.                                            
            @9    NRIC1      $CHAR9.                                            
            @96   NRIC1_MS   $CHAR1.                                            
            @107  REL        $CHAR2.                                            
            @96   MS         $CHAR1.;                                           
     IF REL = '00' AND MS = '1';                                                
     PROC SORT; BY REGN;                                                        
                                                                                
DATA FINAL;                                                                     
     MERGE BP13F73W(IN=A) BP13K825(IN=B);                                       
     BY REGN;                                                                   
     IF A AND B;                                                                
                                                                                
DATA P13L558W;                                                                  
     IF EOF THEN OUTPUT P13L558W;                                               
     SET FINAL END=EOF;                                                         
     STOP;                                                                      
                                                                                
     PROC PRINTTO PRINT=P13L558W;                                               
     PROC PRINT DATA=FINAL;                                                     
     FORMAT NRIC1_MS $MS.;                                                      
     OPTIONS PAGESIZE=MAX MISSING=. NOCENTER;                                   
TITLE1 'HA1 SINGLE MCP = Y EXCLUDING ELIG SCH = FS';                            
                                                                                
     PROC PRINTTO PRINT=P13L558W;                                               
     PROC REPORT DATA=P13L558W NOHEADER;                                        
     OPTIONS PAGESIZE=MAX MISSING='' NOCENTER;                                  
TITLE1 'HA1 SINGLE MCP = Y EXCLUDING ELIG SCH = FS';                            
TITLE2 'NO CASES                                  ';                            
