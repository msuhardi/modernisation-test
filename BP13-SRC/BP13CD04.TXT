      *-----------------------*                                                 
       IDENTIFICATION DIVISION.                                                 
      *-----------------------*                                                 
       PROGRAM-ID.    BP13CD04.                                                 
       AUTHOR.        TEREZA SALONGA.                                           
      *-----------------------------------------------------------*             
                                                                                
      *===========================================================*             
      *        SOC - S Y S T E M  O F  C O M M I T M E N T        *             
      *===========================================================*             
      *  OBJECTIVES :                                             *             
      *                                                           *             
      *    1.  TO TRANSFER DATA FROM BP13F740, BP13K825, BP13K830 *             
      *        TO BP13KB20.                                       *             
      *                                                           *             
      *    INPUT FILES : BP13F740 - BALLOT FILE FOR MATURE NT     *             
      *                  BP13K200 - BOOKING APPMT FILE            *             
      *                  BP13K740 - BALLOT VSAM FOR MATURE NT     *             
      *                  BP13K825 - REQUEST OCCUPIER FILE         *             
      *                  BP13K830 - CORR ADDRESS FILE             *             
      *                                                           *             
      *    INPUT-OUTPUT: BP13KB20 - DBS REQUEST FILE              *             
      *                                                           *             
      *    OUTPUT FILE : BP13LD04 - LIST OF APPLICANTS W/O        *             
      *                             REGISTRATION NUMBER           *             
      *                                                           *             
      *    SUBROUTINES :                                          *             
      *                                                           *             
      *---------------------------------------------------------- *             
      *===========================================================*             
      *  REVISION HISTORY :                                       *             
      *  CHG-REQ#  BY    DATE        DESCRIPTION                  *             
      *  --------  ----  ----------  ---------------------------- *             
      *  BP132875  TRS   05/09/06    NEW PROGRAM                  *             
      *  BP133244  LSB   28/01/08    RERN-NO 8 BYTES              *             
      *  BP133244  RB12  01/02/08    WRITE ANOTHER KB20 RECORD FOR*             
      *                              GRO CASES                    *             
      *  BP133256  RB12  12/02/08    REMOVE OVERRIDE OF ALLOC SCH *             
      *  BP134674  SMR2  09/10/2012  TO MOVE HHTYPE-DECLARE AND   *             
      *                              AGENT-CDE FROM KB78 TO KB20  *             
      *  BP135505  SMR2  20/10/2014  MOVE FT2T FROM F740 TO KB20  *             
      *************************************************************             
                                                                                
      *-----------------------*                                                 
       ENVIRONMENT DIVISION.                                                    
      *-----------------------*                                                 
       CONFIGURATION SECTION.                                                   
      *-----------------------*                                                 
                                                                                
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
      *-----------------------*                                                 
       INPUT-OUTPUT SECTION.                                                    
      *-----------------------*                                                 
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F740 ASSIGN TO BP13F740.                                  
                                                                                
           SELECT BP13K200 ASSIGN TO BP13K200                                   
                           ORGANIZATION  IS INDEXED                             
                           ACCESS MODE   IS RANDOM                              
                           RECORD KEY    IS K200-KEY-FLD                        
                           ALTERNATE KEY IS K200-NUM-REGN                       
                           FILE STATUS   IS K200-FILE-STATUS.                   
                                                                                
           SELECT BP13K740 ASSIGN TO BP13K740                                   
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS RANDOM                               
                           RECORD KEY   IS K740-KEY-FLD                         
                           FILE STATUS  IS K740-FILE-STATUS.                    
                                                                                
           SELECT BP13K800 ASSIGN TO BP13K800                                   
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS RANDOM                               
                           RECORD KEY   IS K800-NUM-REGN                        
                           FILE STATUS  IS K800-FILE-STATUS.                    
                                                                                
           SELECT BP13K825 ASSIGN TO BP13K825                                   
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS DYNAMIC                              
                           RECORD KEY   IS K825-KEY-FLD                         
                           FILE STATUS  IS K825-FILE-STATUS.                    
                                                                                
           SELECT BP13K830 ASSIGN TO BP13K830                                   
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS DYNAMIC                              
                           RECORD KEY   IS K830-KEY-FLD                         
                           FILE STATUS  IS K830-FILE-STATUS.                    
                                                                                
           SELECT BP13KB20 ASSIGN TO BP13KB20                                   
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS DYNAMIC                              
                           RECORD KEY   IS KB20-KEY-FLD                         
                           FILE STATUS  IS KB20-FILE-STATUS.                    
                                                                                
           SELECT BP13KB78 ASSIGN TO BP13KB78                                   
                           ORGANIZATION IS INDEXED                              
                           ACCESS MODE  IS DYNAMIC                              
                           RECORD KEY   IS KB78-KEY-FLD                         
                           FILE STATUS  IS KB78-FILE-STATUS.                    
                                                                                
           SELECT BP13LD04 ASSIGN    TO BP13LD04.                               
                                                                                
      *-----------------------*                                                 
       DATA DIVISION.                                                           
      *-----------------------*                                                 
       FILE SECTION.                                                            
      *-----------------------*                                                 
                                                                                
       FD  BP13F740    BLOCK  CONTAINS 0 RECORDS                                
                       RECORD CONTAINS 500 CHARACTERS                           
                       LABEL RECORD IS STANDARD                                 
                       RECORDING MODE IS F.                                     
       COPY BP13F740.                                                           
                                                                                
       FD   BP13K200                                                            
            RECORD     CONTAINS 300 CHARACTERS.                                 
       COPY BP13K200.                                                           
                                                                                
       FD   BP13K740                                                            
            RECORD     CONTAINS 500 CHARACTERS.                                 
       COPY BP13K740.                                                           
                                                                                
       FD   BP13K800                                                            
            RECORD     CONTAINS 2000 CHARACTERS.                                
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K825                                                            
            RECORD     CONTAINS 200 CHARACTERS.                                 
       COPY BP13K825.                                                           
                                                                                
       FD   BP13K830                                                            
            RECORD     CONTAINS 250 CHARACTERS.                                 
       COPY BP13K830.                                                           
                                                                                
       FD   BP13KB20                                                            
            RECORD     CONTAINS 3300 CHARACTERS.                                
       COPY BP13KB20.                                                           
                                                                                
       FD   BP13KB78                                                            
            RECORD     CONTAINS 3300 CHARACTERS.                                
       COPY BP13KB78.                                                           
                                                                                
       FD   BP13LD04                                                            
            BLOCK     CONTAINS 0   RECORDS                                      
            RECORD    CONTAINS 132 CHARACTERS                                   
            LABEL     RECORDS  ARE OMITTED                                      
            RECORDING MODE     IS  F.                                           
       01   BP13LD04-REC       PIC X(132).                                      
                                                                                
      *-----------------------*                                                 
       WORKING-STORAGE SECTION.                                                 
      *-----------------------*                                                 
                                                                                
       01  WS-FILE-CONTROLS.                                                    
           05  K200-FILE-STATUS           PIC 9(2)    VALUE  0.                 
           05  K740-FILE-STATUS           PIC 9(2)    VALUE  0.                 
           05  K800-FILE-STATUS           PIC 9(2)    VALUE  0.                 
           05  K825-FILE-STATUS           PIC 9(2)    VALUE  0.                 
           05  K830-FILE-STATUS           PIC 9(2)    VALUE  0.                 
           05  KB20-FILE-STATUS           PIC 9(2)    VALUE  0.                 
           05  KB78-FILE-STATUS           PIC 9(2)    VALUE  0.                 
           05  WS-F740-EOF-SW             PIC X(1)    VALUE 'N'.                
           05  WS-END-OF-K825             PIC X(1)    VALUE 'N'.                
                                                                                
       01  WS-LD04-CONTROLS.                                                    
           05  WS-LD04-LINECTR            PIC 9(2)    VALUE 25.                 
           05  WS-LD04-PAGECTR            PIC 9(4)    VALUE 0.                  
           05  WS-LD04-S-NO               PIC 9(5)    VALUE 0.                  
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-F740-READ-CTR           PIC 9(4)    VALUE  0.                 
           05  WS-F740-SKIP-CTR           PIC 9(4)    VALUE  0.                 
           05  WS-K200-FND-CTR            PIC 9(4)    VALUE  0.                 
           05  WS-K740-FND-CTR            PIC 9(4)    VALUE  0.                 
           05  WS-K800-FND-CTR            PIC 9(4)    VALUE  0.                 
           05  WS-K200-NOTFND-CTR         PIC 9(4)    VALUE  0.                 
           05  WS-K740-NOTFND-CTR         PIC 9(4)    VALUE  0.                 
           05  WS-K800-NOTFND-CTR         PIC 9(4)    VALUE  0.                 
           05  WS-KB20-WRITE-CTR          PIC 9(4)    VALUE  0.                 
           05  WS-KB20-DUP-CTR            PIC 9(4)    VALUE  0.                 
           05  WS-KB20-ERR-CTR            PIC 9(4)    VALUE  0.                 
           05  WS-CTR                     PIC 9(2)    VALUE  0.                 
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-SYSTEM-DATE             PIC X(8)    VALUE SPACES.             
           05  WS-TEMP-MSTATUS            PIC X(1).                             
           05  WS-TEMP-RACE               PIC X(1).                             
           05  WS-TEMP-SEX                PIC X(1).                             
           05  WS-TMP-EDN                 PIC 9(1)    VALUE ZEROES.             
           05  WS-K740-FND                PIC X(1)    VALUE SPACE.              
                                                                                
       01  WS-APPMT-TIME.                                                       
           05  WS-APPMT-HR                PIC 9(2)    VALUE 00.                 
           05  WS-APPMT-MM                PIC 9(2)    VALUE 00.                 
                                                                                
       01  WS-ARRIV-TIME.                                                       
           05  WS-ARRIV-HR                PIC 9(2)    VALUE 00.                 
           05  WS-ARRIV-MM                PIC 9(2)    VALUE 00.                 
                                                                                
       01  WS-ALLOCSCH-TYPE               PIC X(3)    VALUE SPACES.             
       COPY PRIOSCH.                                                            
                                                                                
       01  WS-CONSTANT-TEXTS.                                                   
           05  WS-ERROR-MESSAGES.                                               
               10  K-F740-BLANK           PIC X(40)   VALUE                     
                   'F740-NUM-REGN IS BLANK      '.                              
               10  K-K200-NOTFND          PIC X(40)   VALUE                     
                   'RECORD NOT FOUND IN BP13K200'.                              
               10  K-K825-NOTFND          PIC X(40)   VALUE                     
                   'RECORD NOT FOUND IN BP13K825'.                              
               10  K-K800-NOTFND          PIC X(40)   VALUE                     
                   'RECORD NOT FOUND IN BP13K800'.                              
               10  K-K830-NOTFND          PIC X(40)   VALUE                     
                   'RECORD NOT FOUND IN BP13K830'.                              
               10  K-KB20-DUPLICATE       PIC X(40)   VALUE                     
                   'DUPLICATE RECORD IN BP13KB20'.                              
               10  K-KB20-ERROR           PIC X(40)   VALUE                     
                   'ERROR WRITING TO BP13KB20'.                                 
           05  WS-TOTAL-DESC.                                                   
               10  K-F740-RECORDS-READ    PIC X(50)   VALUE                     
                      'TOTAL RECORDS READ IN BP13F740            : '.           
               10  K-F740-RECORDS-SKIP    PIC X(50)   VALUE                     
                      'TOTAL RECORDS SKIPPED IN BP13F740         : '.           
               10  K-K200-RECORDS-FOUND   PIC X(50)   VALUE                     
                      'TOTAL RECORDS FOUND IN BP13K200           : '.           
               10  K-K740-RECORDS-FOUND   PIC X(50)   VALUE                     
                      'TOTAL RECORDS FOUND IN BP13K740           : '.           
               10  K-K800-RECORDS-FOUND   PIC X(50)   VALUE                     
                      'TOTAL RECORDS FOUND IN BP13K800           : '.           
               10  K-K200-RECORDS-NFOUND  PIC X(50)   VALUE                     
                      'TOTAL RECORDS NOT FOUND IN BP13K200       : '.           
               10  K-K740-RECORDS-NFOUND  PIC X(50)   VALUE                     
                      'TOTAL RECORDS NOT FOUND IN BP13K740       : '.           
               10  K-K800-RECORDS-NFOUND  PIC X(50)   VALUE                     
                      'TOTAL RECORDS NOT FOUND IN BP13K800       : '.           
               10  K-KB20-RECORDS-WRITE   PIC X(50)   VALUE                     
                      'TOTAL RECORDS WRITE TO BP13KB20           : '.           
               10  K-KB20-RECORDS-DUP     PIC X(50)   VALUE                     
                      'TOTAL DUPLICATES ENCOUNTERED IN BP13KB20  : '.           
               10  K-KB20-UNSUCC-WRITE    PIC X(50)   VALUE                     
                      'TOTAL UNSUCCESSFUL WRITES TO BP13KB20     : '.           
                                                                                
      **************************************************************            
      *       BP13LD04 -  R E P O R T   L A Y O U T                *            
      **************************************************************            
       01  LD04-HEADING-01.                                                     
           05  FILLER              PIC X(08)     VALUE 'BP13LD04'.              
           05  FILLER              PIC X(06)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE 'HDB3'.                  
           05  FILLER              PIC X(24)     VALUE SPACES.                  
           05  FILLER              PIC X(39)     VALUE                          
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER              PIC X(13)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE :'.                
           05  LD04-RUN-DATE       PIC X(10).                                   
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LD04-PAGE-NO        PIC ZZZZ9 .                                  
                                                                                
       01  LD04-HEADING-02.                                                     
           05  FILLER              PIC X(50)     VALUE SPACES.                  
           05  FILLER              PIC X(32)     VALUE                          
               'SALES UNIT (ALLOCATION TEAM)'.                                  
                                                                                
       01  LD04-HEADING-03.                                                     
           05  FILLER              PIC X(26)     VALUE SPACES.                  
           05  FILLER              PIC X(78)     VALUE                          
               'ERRORS ENCOUNTERED FOR INTERNET APPLICATION'.                   
                                                                                
       01  LD04-HEADING-04.                                                     
           05  FILLER              PIC X(08)     VALUE SPACES.                  
           05  FILLER              PIC X(05)     VALUE ' S/N'.                  
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(06)     VALUE 'REG NO'.                
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(09)     VALUE '  NRIC'.                
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE 'FT2T'.                  
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(11)     VALUE 'ERROR NRIC'.            
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(40)     VALUE 'REMARKS'.               
                                                                                
       01  LD04-HEADING-05.                                                     
           05  FILLER              PIC X(132)    VALUE ALL '_'.                 
                                                                                
       01  LD04-DETAIL-01.                                                      
           05  FILLER              PIC X(08)     VALUE SPACES.                  
           05  LD04-S-NO           PIC X(05).                                   
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  LD04-REG-NO         PIC X(08).                                   
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  LD04-NRIC           PIC X(09).                                   
           05  FILLER              PIC X(06)     VALUE SPACES.                  
           05  LD04-FT2T           PIC X(01).                                   
           05  FILLER              PIC X(07)     VALUE SPACES.                  
           05  LD04-ERROR-NRIC     PIC X(09).                                   
           05  FILLER              PIC X(07)     VALUE SPACES.                  
           05  LD04-REMARKS        PIC X(40).                                   
                                                                                
       01  LD04-TOTALS             REDEFINES     LD04-DETAIL-01.                
           05  FILLER              PIC X(39).                                   
           05  LD04-TOTAL-DESC     PIC X(50).                                   
           05  LD04-TOTAL-VALUE    PIC X(05).                                   
                                                                                
      *-----------------------*                                                 
       PROCEDURE DIVISION.                                                      
      *-----------------------*                                                 
                                                                                
      *-------------*                                                           
       0000-CONTROL.                                                            
      *-------------*                                                           
            PERFORM 1000-OPEN-FILES       THRU 1000-EXIT.                       
            PERFORM 4000-PROCESS-F740-REC THRU 4000-EXIT                        
               UNTIL WS-F740-EOF-SW = 'Y'.                                      
            PERFORM 8000-PRINT-REPORT     THRU 8000-EXIT.                       
            PERFORM 9000-CLOSE-FILES      THRU 9000-EXIT.                       
                                                                                
       0000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *----------------*                                                        
       1000-OPEN-FILES.                                                         
      *----------------*                                                        
           OPEN INPUT  BP13F740                                                 
                       BP13K200                                                 
                       BP13K740                                                 
                       BP13K800                                                 
                       BP13K825                                                 
                       BP13K830                                                 
                       BP13KB78                                                 
                I-O    BP13KB20                                                 
                OUTPUT BP13LD04.                                                
                                                                                
           IF K200-FILE-STATUS NOT = 00 AND 97                                  
              DISPLAY 'OPENING BP13K200 ERROR ' K200-FILE-STATUS                
              MOVE     K200-FILE-STATUS    TO   RETURN-CODE                     
              PERFORM  9000-CLOSE-FILES    THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF K740-FILE-STATUS NOT = 00 AND 97                                  
              DISPLAY 'OPENING BP13K740 ERROR ' K740-FILE-STATUS                
              MOVE     K740-FILE-STATUS    TO   RETURN-CODE                     
              PERFORM  9000-CLOSE-FILES    THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF K800-FILE-STATUS NOT = 00 AND 97                                  
              DISPLAY 'OPENING BP13K800 ERROR ' K800-FILE-STATUS                
              MOVE     K800-FILE-STATUS    TO   RETURN-CODE                     
              PERFORM  9000-CLOSE-FILES    THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF K825-FILE-STATUS NOT = 00 AND 97                                  
              DISPLAY 'OPENING BP13K825 ERROR ' K825-FILE-STATUS                
              MOVE     K825-FILE-STATUS    TO   RETURN-CODE                     
              PERFORM  9000-CLOSE-FILES    THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF K830-FILE-STATUS NOT = 00 AND 97                                  
              DISPLAY 'OPENING BP13K830 ERROR ' K830-FILE-STATUS                
              MOVE     K830-FILE-STATUS    TO   RETURN-CODE                     
              PERFORM  9000-CLOSE-FILES    THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF KB20-FILE-STATUS NOT = 00 AND 97                                  
              DISPLAY 'OPENING BP13KB20 ERROR ' KB20-FILE-STATUS                
              MOVE     KB20-FILE-STATUS    TO   RETURN-CODE                     
              PERFORM  9000-CLOSE-FILES    THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF KB78-FILE-STATUS NOT = 00 AND 97                                  
              DISPLAY 'OPENING BP13KB78 ERROR ' KB78-FILE-STATUS                
              MOVE     KB78-FILE-STATUS    TO   RETURN-CODE                     
              PERFORM  9000-CLOSE-FILES    THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-SYSTEM-DATE.                   
           STRING WS-SYSTEM-DATE(7:2) '/'                                       
                  WS-SYSTEM-DATE(5:2) '/'                                       
                  WS-SYSTEM-DATE(1:4)                                           
              DELIMITED BY SIZE INTO LD04-RUN-DATE.                             
                                                                                
           PERFORM  3000-READ-F740 THRU 3000-EXIT.                              
                                                                                
       1000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *---------------*                                                         
       3000-READ-F740.                                                          
      *---------------*                                                         
           READ BP13F740                                                        
              AT END MOVE 'Y' TO WS-F740-EOF-SW                                 
              GO TO 3000-EXIT                                                   
           END-READ.                                                            
                                                                                
           ADD +1             TO WS-F740-READ-CTR.                              
                                                                                
       3000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *----------------------*                                                  
       4000-PROCESS-F740-REC.                                                   
      *----------------------*                                                  
           IF F740-NUM-REGN NOT = SPACES AND LOW-VALUES                         
              PERFORM 4300-READ-BP13KB78   THRU 4300-EXIT                       
              PERFORM 4400-FORMAT-BP13KB20 THRU 4400-EXIT                       
              PERFORM 4500-BP13KB20-WRITE  THRU 4500-EXIT                       
              PERFORM 5000-CHECK-GRO       THRU 5000-EXIT                       
           ELSE                                                                 
              ADD  1                       TO   WS-F740-SKIP-CTR                
              MOVE K-F740-BLANK            TO   LD04-REMARKS                    
              PERFORM 7000-PRINT-ERROR     THRU 7000-EXIT                       
           END-IF.                                                              
                                                                                
           PERFORM 3000-READ-F740          THRU 3000-EXIT.                      
                                                                                
       4000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-----------------------*                                                 
       4300-READ-BP13KB78.                                                      
      *-----------------------*                                                 
           MOVE SPACES TO BP13KB78-REC                                          
           INITIALIZE     BP13KB78-REC.                                         
                                                                                
           MOVE F740-NUM-REGN TO KB78-KEY-FLD.                                  
                                                                                
           READ BP13KB78.                                                       
                                                                                
           IF KB78-FILE-STATUS = 00 OR 02                                       
              PERFORM 4310-MOVE-DATA      THRU 4310-EXIT                        
           ELSE                                                                 
           IF KB78-FILE-STATUS = 23                                             
              DISPLAY 'NOT FOUND IN BP13KB78 : ' F740-NUM-REGN                  
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13KB78 FOR REC ' K830-NUM-REGN           
              MOVE     KB78-FILE-STATUS   TO   RETURN-CODE                      
              PERFORM  9000-CLOSE-FILES   THRU 9000-EXIT                        
           END-IF.                                                              
                                                                                
       4300-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *----------------------*                                                  
       4310-MOVE-DATA.                                                          
      *----------------------*                                                  
           MOVE SPACES TO BP13KB20-REC                                          
           INITIALIZE     BP13KB20-REC.                                         
                                                                                
           MOVE KB78-NUM-PROJECT            TO KB20-NUM-PROJECT                 
                                               KB20-NUM-PROJECT-SUCC.           
           MOVE KB78-NUM-PHASE              TO KB20-NUM-PHASE.                  
           MOVE KB78-NUM-FLAT-INHERIT       TO KB20-NUM-FLAT-INHERIT.           
           MOVE KB78-NME-PRSN1-INHERIT      TO KB20-NME-PRSN1-INHERIT.          
           MOVE KB78-NUM-PRSN1-UIN-INHERIT  TO                                  
                                       KB20-NUM-PRSN1-UIN-INHERIT.              
           MOVE KB78-TXT-PRSN1-ADDR-INHERIT TO                                  
                                       KB20-TXT-PRSN1-ADDR-INHERIT.             
           MOVE KB78-NME-PRSN2-INHERIT      TO KB20-NME-PRSN2-INHERIT.          
           MOVE KB78-NUM-PRSN2-UIN-INHERIT  TO                                  
                                       KB20-NUM-PRSN2-UIN-INHERIT.              
           MOVE KB78-TXT-PRSN2-ADDR-INHERIT TO                                  
                                       KB20-TXT-PRSN2-ADDR-INHERIT              
           MOVE KB78-NUM-OTHER-APPLN        TO KB20-NUM-OTHER-APPLN.            
           MOVE KB78-NME-PRSN1-OTHER-APPLN  TO                                  
                                       KB20-NME-PRSN1-OTHER-APPLN.              
           MOVE KB78-NUM-PRSN1-UIN-OTHER-APPLN TO                               
                                       KB20-NUM-PRSN1-UIN-OTHER-APPLN.          
           MOVE KB78-NUM-PRSN2-REGN-NO     TO KB20-NUM-PRSN2-REGN-NO.           
           MOVE KB78-NUM-RNTL-APPLN        TO KB20-NUM-RNTL-APPLN.              
           MOVE KB78-NME-PRSN1-RNTL-APPLN  TO KB20-NME-PRSN1-RNTL-APPLN.        
           MOVE KB78-NUM-PRSN1-UIN-RNTL-APPLN TO                                
                                       KB20-NUM-PRSN1-UIN-RNTL-APPLN.           
           MOVE KB78-NUM-PRSN1-REF-NO      TO KB20-NUM-PRSN1-REF-NO.            
           MOVE KB78-NME-PRSN2-RNTL-APPLN  TO KB20-NME-PRSN2-RNTL-APPLN.        
           MOVE KB78-NUM-PRSN2-UIN-RNTL-APPLN TO                                
                                       KB20-NUM-PRSN2-UIN-RNTL-APPLN            
           MOVE KB78-NUM-PRSN2-REF-NO      TO KB20-NUM-PRSN2-REF-NO.            
           MOVE KB78-NUM-OWN-PTE-PRTY      TO KB20-NUM-OWN-PTE-PRTY.            
           MOVE KB78-NUM-DISPOSED-PTE-PRTY TO                                   
                                       KB20-NUM-DISPOSED-PTE-PRTY.              
           MOVE KB78-NME-CHILD1-PARENT     TO                                   
                                       KB20-NME-CHILD1-PARENT.                  
           MOVE KB78-NUM-CHILD1-PARENT-UIN   TO                                 
                                       KB20-NUM-CHILD1-PARENT-UIN.              
           MOVE KB78-NUM-CHILD1-PARENT-MARSTAT TO                               
                                       KB20-NUM-CHILD1-PARENT-MARSTAT.          
           MOVE KB78-NUM-CHILD1-PARENT-RLTNSP  TO                               
                                       KB20-NUM-CHILD1-PARENT-RLTNSP.           
           MOVE KB78-NME-CHILD2-PARENT     TO                                   
                                       KB20-NME-CHILD2-PARENT.                  
           MOVE KB78-NUM-CHILD2-PARENT-UIN TO                                   
                                       KB20-NUM-CHILD2-PARENT-UIN.              
           MOVE KB78-NUM-CHILD2-PARENT-MARSTAT TO                               
                                       KB20-NUM-CHILD2-PARENT-MARSTAT.          
           MOVE KB78-NUM-CHILD2-PARENT-RLTNSP  TO                               
                                       KB20-NUM-CHILD2-PARENT-RLTNSP.           
           MOVE KB78-TXT-CHILD-PARENT-ADDR TO                                   
                                       KB20-TXT-CHILD-PARENT-ADDR.              
           MOVE KB78-NUM-HDB-LOAN          TO KB20-NUM-HDB-LOAN.                
           MOVE KB78-NUM-LN1-BLK           TO KB20-NUM-LN1-BLK.                 
           MOVE KB78-LN1-NUM-FLAT          TO KB20-LN1-NUM-FLAT.                
           MOVE KB78-NME-LN1-STREET        TO KB20-NME-LN1-STREET.              
           MOVE KB78-NUM-LN1-POSTAL        TO KB20-NUM-LN1-POSTAL.              
           MOVE KB78-NUM-LN2-BLK           TO KB20-NUM-LN2-BLK.                 
           MOVE KB78-LN2-NUM-FLAT          TO KB20-LN2-NUM-FLAT.                
           MOVE KB78-NME-LN2-STREET        TO KB20-NME-LN2-STREET.              
           MOVE KB78-NUM-LN2-POSTAL        TO KB20-NUM-LN2-POSTAL.              
           MOVE KB78-NUM-OWN-FLAT          TO KB20-NUM-OWN-FLAT.                
           MOVE KB78-NUM-OWN-FLAT-TYPE     TO KB20-NUM-OWN-FLAT-TYPE.           
           MOVE KB78-NUM-OWN-PRVTE-PRPRTY  TO KB20-NUM-OWN-PRVTE-PRPRTY.        
           MOVE KB78-NUM-PRVTE-PRPRTY-TYPE TO                                   
                                       KB20-NUM-PRVTE-PRPRTY-TYPE.              
           MOVE KB78-OTHR-PRVTE-PRPRTY     TO KB20-OTHR-PRVTE-PRPRTY.           
           MOVE KB78-NUM-TCP-REQ           TO KB20-NUM-TCP-REQ.                 
           MOVE KB78-DTE-CHILD-BIRTH       TO KB20-DTE-CHILD-BIRTH.             
           MOVE KB78-NUM-AHG-REQ           TO KB20-NUM-AHG-REQ.                 
           MOVE KB78-NUM-CPFHG-REQ         TO KB20-NUM-CPFHG-REQ.               
           MOVE KB78-NUM-APPL-LOAN-REQ     TO KB20-NUM-APPL-LOAN-REQ.           
           MOVE KB78-NUM-EMAIL             TO KB20-NUM-EMAIL.                   
           MOVE KB78-NUM-HHTYPE-DECLARE    TO KB20-NUM-HHTYPE-DECLARE.          
           MOVE KB78-NUM-AGENT-CDE         TO KB20-NUM-AGENT-CDE.               
           MOVE KB78-DTE-UPDATE            TO KB20-DTE-UPDATE.                  
           MOVE KB78-TME-UPDATE            TO KB20-TME-UPDATE.                  
           MOVE KB78-DTE-REQUESTED         TO KB20-DTE-REQUESTED.               
           MOVE KB78-TME-REQUESTED         TO KB20-TME-REQUESTED.               
                                                                                
       4310-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *----------------------*                                                  
       4400-FORMAT-BP13KB20.                                                    
      *----------------------*                                                  
      *    MOVE SPACES TO BP13KB20-REC                                          
      *    INITIALIZE     BP13KB20-REC.                                         
                                                                                
      *    MOVE 'D01'                      TO KB20-NUM-PROJECT                  
      *                                       KB20-NUM-PROJECT-SUCC.            
           MOVE 'NRQ'                      TO KB20-NUM-STATUS.                  
           MOVE F740-NUM-NT-FT-QUEUE       TO KB20-NUM-QUEUE.                   
           MOVE F740-CDE-NT1               TO KB20-NUM-NEW-TOWN.                
           MOVE F740-CDE-ELIG-SCH          TO KB20-CDE-ELIG-SCH.                
           MOVE F740-CDE-REQUEST-STATUS    TO KB20-CDE-SUCC-STATUS.             
           MOVE F740-NUM-FT2T              TO KB20-NUM-FT2T.                    
                                                                                
      *    MOVE F740-CDE-CATEGORY          TO KB20-NUM-RACE.                    
           EVALUATE F740-CDE-CATEGORY                                           
              WHEN '1'                                                          
                   MOVE 'M'                TO KB20-NUM-RACE                     
              WHEN '2'                                                          
                   MOVE 'C'                TO KB20-NUM-RACE                     
              WHEN '3'                                                          
                   MOVE 'I'                TO KB20-NUM-RACE                     
              WHEN '4'                                                          
                   MOVE 'O'                TO KB20-NUM-RACE                     
           END-EVALUATE.                                                        
                                                                                
           MOVE F740-NUM-REGN              TO KB20-NUM-REGN.                    
           MOVE F740-CDE-FLAT-TYPE         TO KB20-NUM-FLAT-TYPE.               
           MOVE F740-CDE-ALLOC-SCH         TO KB20-CDE-ALLOC-SCH.               
      *    MOVE F740-NUM-OWN-PTE-PRTY      TO KB20-NUM-OWN-PTE-PRTY.            
      *    MOVE F740-NUM-DISPOSED-PTE-PRTY TO KB20-NUM-DISPOSED-PTE-PRTY        
      *    MOVE F740-NUM-LOAN-TAG          TO KB20-NUM-LOAN-TAG.                
           MOVE F740-NUM-MCPS-POSTAL       TO KB20-NUM-CP-POST.                 
                                                                                
      *    MOVE F740-CDE-HOUSEHOLD         TO KB20-NUM-HH.                      
                                                                                
           IF F740-CDE-HOUSEHOLD = 'T'                                          
              MOVE 'H'                     TO KB20-NUM-HH                       
           ELSE                                                                 
              MOVE F740-CDE-HOUSEHOLD      TO KB20-NUM-HH                       
           END-IF.                                                              
                                                                                
           MOVE F740-NUM-5YR-OCCUPN        TO KB20-NUM-5YR.                     
           IF KB20-NUM-TCP-REQ = 'Y'                                            
              IF F740-CDE-ALLOC-SCH = 'TCP'                                     
                 MOVE 'Y'                  TO KB20-NUM-TCP-ELIG                 
              ELSE                                                              
                 MOVE 'N'                  TO KB20-NUM-TCP-ELIG                 
              END-IF                                                            
           END-IF.                                                              
           IF F740-NUM-MCPS NOT = SPACES                                        
              MOVE 'Y'                     TO KB20-NUM-MCP-REQ                  
              MOVE F740-NUM-MCPS           TO KB20-NUM-MCP-PRIORITY             
              IF F740-CDE-RESIDENT-HA1 = '1' OR 'A' OR 'T'                      
                 MOVE 'Y'                  TO KB20-NUM-MCP-ELIG                 
              ELSE                                                              
                 MOVE 'N'                  TO KB20-NUM-MCP-ELIG                 
              END-IF                                                            
           ELSE                                                                 
              MOVE SPACES                  TO KB20-NUM-MCP-REQ                  
              MOVE SPACES                  TO KB20-NUM-MCP-PRIORITY             
              MOVE SPACES                  TO KB20-NUM-MCP-ELIG                 
           END-IF.                                                              
                                                                                
           SET WS-ALLOC-PTR TO 1.                                               
                                                                                
           SEARCH WS-ALLOC-SCH                                                  
              AT END MOVE 'XXX' TO WS-ALLOCSCH-TYPE                             
              WHEN F740-CDE-ALLOC-SCH =                                         
                                WS-ALLOC-SCH-DESP(WS-ALLOC-PTR)                 
              MOVE WS-MAIN-SCH-CD(WS-ALLOC-PTR) TO                              
                                      WS-ALLOCSCH-TYPE.                         
                                                                                
           IF WS-ALLOCSCH-TYPE = 'CCC'                                          
              MOVE 'GRO'                   TO KB20-CDE-ALLOC-SCH                
           END-IF.                                                              
                                                                                
           PERFORM 4410-GET-BP13K825-INFO THRU 4410-EXIT.                       
           PERFORM 4430-GET-BP13K830-INFO THRU 4430-EXIT.                       
           PERFORM 4440-GET-BP13K800-INFO THRU 4440-EXIT.                       
           PERFORM 4600-READ-BP13K200     THRU 4600-EXIT.                       
                                                                                
       4400-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-----------------------*                                                 
       4410-GET-BP13K825-INFO.                                                  
      *-----------------------*                                                 
           MOVE SPACES TO BP13K825-REC                                          
           INITIALIZE     BP13K825-REC                                          
                          WS-CTR.                                               
                                                                                
           MOVE F740-NUM-REGN TO K825-NUM-REGN.                                 
           MOVE 'N'           TO WS-END-OF-K825.                                
                                                                                
           START BP13K825 KEY IS >= K825-KEY-FLD END-START.                     
                                                                                
           PERFORM 4420-READNXT-BP13K825 THRU 4420-EXIT                         
              UNTIL WS-END-OF-K825 = 'Y'.                                       
                                                                                
       4410-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-----------------------*                                                 
       4420-READNXT-BP13K825.                                                   
      *-----------------------*                                                 
           READ BP13K825 NEXT RECORD AT END                                     
              MOVE 'Y' TO WS-END-OF-K825                                        
              GO TO 4420-EXIT.                                                  
                                                                                
           IF K825-FILE-STATUS = 00 OR 02                                       
              IF K825-NUM-REGN = F740-NUM-REGN                                  
                 EVALUATE TRUE                                                  
                 WHEN K825-NUM-NRIC = F740-NUM-NRIC1                            
                      PERFORM 4420A-POPULATE-APPL1 THRU 4420A-EXIT              
                 WHEN K825-NUM-NRIC = F740-NUM-NRIC2                            
                      PERFORM 4420B-POPULATE-APPL2 THRU 4420B-EXIT              
                 WHEN K825-NUM-NRIC = F740-NUM-NRIC3                            
                      PERFORM 4420C-POPULATE-APPL3 THRU 4420C-EXIT              
                 WHEN K825-NUM-NRIC = F740-NUM-NRIC4                            
                      PERFORM 4420D-POPULATE-APPL4 THRU 4420D-EXIT              
                 WHEN OTHER                                                     
                      ADD 1 TO WS-CTR                                           
                      EVALUATE WS-CTR                                           
                      WHEN 1                                                    
                           PERFORM 4420E-POPULATE-OCCP1 THRU 4420E-EXIT         
                      WHEN 2                                                    
                           PERFORM 4420F-POPULATE-OCCP2 THRU 4420F-EXIT         
                      WHEN 3                                                    
                          PERFORM 4420G-POPULATE-OCCP3 THRU 4420G-EXIT          
                      WHEN 4                                                    
                           PERFORM 4420H-POPULATE-OCCP4 THRU 4420H-EXIT         
                      WHEN 5                                                    
                           PERFORM 4420I-POPULATE-OCCP5 THRU 4420I-EXIT         
                      WHEN 6                                                    
                           PERFORM 4420J-POPULATE-OCCP6 THRU 4420J-EXIT         
                      WHEN 7                                                    
                           PERFORM 4420K-POPULATE-OCCP7 THRU 4420K-EXIT         
                      WHEN 8                                                    
                           PERFORM 4420L-POPULATE-OCCP8 THRU 4420L-EXIT         
                      WHEN OTHER                                                
                           CONTINUE                                             
                      END-EVALUATE                                              
                 END-EVALUATE                                                   
              ELSE                                                              
                 MOVE 'Y' TO WS-END-OF-K825                                     
              END-IF                                                            
           ELSE                                                                 
              MOVE 'Y' TO WS-END-OF-K825                                        
           END-IF.                                                              
                                                                                
       4420-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-----------------------*                                                 
       4420A-POPULATE-APPL1.                                                    
      *-----------------------*                                                 
           MOVE ZEROES TO WS-TMP-EDN.                                           
           MOVE K825-NUM-NRIC           TO KB20-NUM-APPLT1-UIN                  
           MOVE K825-NME-OCCP           TO KB20-NME-APPLT1                      
           MOVE K825-DTE-BIRTH          TO KB20-DTE-APPLT1-BIRTH                
           MOVE K825-NUM-NRIC-SPOUSE    TO KB20-NUM-APPLT1-SPOUSE-UIN           
           MOVE K825-AMT-INCOME         TO KB20-AMT-APPLT1-INCOME               
           MOVE SPACES                  TO KB20-NUM-APPLT1-EMPLY-STATUS         
           MOVE SPACES                  TO KB20-NME-APPLT1-OCCUPATION           
           MOVE K825-NUM-PHONE          TO KB20-NUM-APPLT1-PHONE                
           MOVE K825-NUM-HP-PGR         TO KB20-NUM-APPLT1-HP-PAGER             
      *    MOVE K825-NUM-EDUCATION      TO KB20-NUM-APPLT1-EDN-LVL.             
           MOVE K825-NUM-EDUCATION      TO WS-TMP-EDN.                          
           SUBTRACT 1 FROM  WS-TMP-EDN.                                         
           MOVE WS-TMP-EDN              TO KB20-NUM-APPLT1-EDN-LVL.             
                                                                                
           MOVE SPACES                  TO WS-TEMP-SEX                          
                                           WS-TEMP-RACE.                        
           PERFORM 4425-CONVERT-SEX-RACE-MSTATUS THRU 4425-EXIT.                
           MOVE WS-TEMP-SEX             TO KB20-NUM-APPLT1-SEX                  
           MOVE WS-TEMP-RACE            TO KB20-NUM-APPLT1-RACE                 
           MOVE WS-TEMP-MSTATUS         TO                                      
                KB20-NUM-APPLT1-MARITAL-STATUS.                                 
                                                                                
       4420A-EXIT.                                                              
            EXIT.                                                               
                                                                                
      *-----------------------*                                                 
       4420B-POPULATE-APPL2.                                                    
      *-----------------------*                                                 
           MOVE ZEROES TO WS-TMP-EDN.                                           
           MOVE K825-NUM-NRIC           TO KB20-NUM-APPLT2-UIN                  
           MOVE K825-NME-OCCP           TO KB20-NME-APPLT2                      
           MOVE K825-NUM-CITIZENSHIP    TO KB20-NUM-APPLT2-CITIZENSHIP          
           MOVE K825-DTE-BIRTH          TO KB20-DTE-APPLT2-BIRTH                
           MOVE K825-NUM-NRIC-SPOUSE    TO KB20-NUM-APPLT2-SPOUSE-UIN           
           MOVE K825-NUM-RELATIONSHIP   TO KB20-NUM-APPLT2-RLTNSP-APPLT1        
           MOVE K825-AMT-INCOME         TO KB20-AMT-APPLT2-INCOME               
           MOVE SPACES                  TO KB20-NUM-APPLT2-EMPLY-STATUS         
           MOVE SPACES                  TO KB20-NME-APPLT2-OCCUPATION           
           MOVE K825-NUM-PHONE          TO KB20-NUM-APPLT2-PHONE                
           MOVE K825-NUM-HP-PGR         TO KB20-NUM-APPLT2-HP-PAGER             
      *    MOVE K825-NUM-EDUCATION      TO KB20-NUM-APPLT2-EDN-LVL.             
           MOVE K825-NUM-EDUCATION      TO WS-TMP-EDN.                          
           SUBTRACT 1 FROM  WS-TMP-EDN.                                         
           MOVE WS-TMP-EDN              TO KB20-NUM-APPLT2-EDN-LVL.             
                                                                                
                                                                                
           MOVE SPACES                  TO WS-TEMP-SEX                          
                                           WS-TEMP-RACE                         
                                           WS-TEMP-MSTATUS.                     
           PERFORM 4425-CONVERT-SEX-RACE-MSTATUS THRU 4425-EXIT.                
           MOVE WS-TEMP-SEX             TO KB20-NUM-APPLT2-SEX                  
           MOVE WS-TEMP-RACE            TO KB20-NUM-APPLT2-RACE                 
           MOVE WS-TEMP-MSTATUS         TO                                      
                KB20-NUM-APPLT2-MARITAL-STATUS.                                 
                                                                                
       4420B-EXIT.                                                              
            EXIT.                                                               
                                                                                
      *-----------------------*                                                 
       4420C-POPULATE-APPL3.                                                    
      *-----------------------*                                                 
           MOVE ZEROES TO WS-TMP-EDN.                                           
           MOVE K825-NUM-NRIC           TO KB20-NUM-APPLT3-UIN                  
           MOVE K825-NME-OCCP           TO KB20-NME-APPLT3                      
           MOVE K825-NUM-CITIZENSHIP    TO KB20-NUM-APPLT3-CITIZENSHIP          
           MOVE K825-DTE-BIRTH          TO KB20-DTE-APPLT3-BIRTH                
           MOVE K825-NUM-NRIC-SPOUSE    TO KB20-NUM-APPLT3-SPOUSE-UIN           
           MOVE K825-NUM-RELATIONSHIP   TO KB20-NUM-APPLT3-RLTNSP-APPLT1        
           MOVE K825-AMT-INCOME         TO KB20-AMT-APPLT3-INCOME               
           MOVE SPACES                  TO KB20-NUM-APPLT3-EMPLY-STATUS         
           MOVE SPACES                  TO KB20-NME-APPLT3-OCCUPATION           
           MOVE K825-NUM-PHONE          TO KB20-NUM-APPLT3-PHONE                
           MOVE K825-NUM-HP-PGR         TO KB20-NUM-APPLT3-HP-PAGER             
      *    MOVE K825-NUM-EDUCATION      TO KB20-NUM-APPLT3-EDN-LVL.             
           MOVE K825-NUM-EDUCATION      TO WS-TMP-EDN.                          
           SUBTRACT 1 FROM  WS-TMP-EDN.                                         
           MOVE WS-TMP-EDN              TO KB20-NUM-APPLT3-EDN-LVL.             
                                                                                
           MOVE SPACES                  TO WS-TEMP-SEX                          
                                           WS-TEMP-RACE                         
                                           WS-TEMP-MSTATUS.                     
           PERFORM 4425-CONVERT-SEX-RACE-MSTATUS THRU 4425-EXIT.                
           MOVE WS-TEMP-SEX             TO KB20-NUM-APPLT3-SEX                  
           MOVE WS-TEMP-RACE            TO KB20-NUM-APPLT3-RACE                 
           MOVE WS-TEMP-MSTATUS         TO                                      
                KB20-NUM-APPLT3-MARITAL-STATUS.                                 
                                                                                
       4420C-EXIT.                                                              
            EXIT.                                                               
                                                                                
      *-----------------------*                                                 
       4420D-POPULATE-APPL4.                                                    
      *-----------------------*                                                 
           MOVE ZEROES TO WS-TMP-EDN.                                           
           MOVE K825-NUM-NRIC           TO KB20-NUM-APPLT4-UIN                  
           MOVE K825-NME-OCCP           TO KB20-NME-APPLT4                      
           MOVE K825-NUM-CITIZENSHIP    TO KB20-NUM-APPLT4-CITIZENSHIP          
           MOVE K825-DTE-BIRTH          TO KB20-DTE-APPLT4-BIRTH                
           MOVE K825-NUM-NRIC-SPOUSE    TO KB20-NUM-APPLT4-SPOUSE-UIN           
           MOVE K825-NUM-RELATIONSHIP   TO KB20-NUM-APPLT4-RLTNSP-APPLT1        
           MOVE K825-AMT-INCOME         TO KB20-AMT-APPLT4-INCOME               
           MOVE SPACES                  TO KB20-NUM-APPLT4-EMPLY-STATUS         
           MOVE SPACES                  TO KB20-NME-APPLT4-OCCUPATION           
           MOVE K825-NUM-PHONE          TO KB20-NUM-APPLT4-PHONE                
           MOVE K825-NUM-HP-PGR         TO KB20-NUM-APPLT4-HP-PAGER             
      *    MOVE K825-NUM-EDUCATION      TO KB20-NUM-APPLT4-EDN-LVL.             
           MOVE K825-NUM-EDUCATION      TO WS-TMP-EDN.                          
           SUBTRACT 1 FROM  WS-TMP-EDN.                                         
           MOVE WS-TMP-EDN              TO KB20-NUM-APPLT4-EDN-LVL.             
                                                                                
           MOVE SPACES                  TO WS-TEMP-SEX                          
                                           WS-TEMP-RACE                         
                                           WS-TEMP-MSTATUS.                     
           PERFORM 4425-CONVERT-SEX-RACE-MSTATUS THRU 4425-EXIT.                
           MOVE WS-TEMP-SEX             TO KB20-NUM-APPLT4-SEX                  
           MOVE WS-TEMP-RACE            TO KB20-NUM-APPLT4-RACE                 
           MOVE WS-TEMP-MSTATUS         TO                                      
                KB20-NUM-APPLT4-MARITAL-STATUS.                                 
                                                                                
       4420D-EXIT.                                                              
            EXIT.                                                               
                                                                                
      *-----------------------*                                                 
       4420E-POPULATE-OCCP1.                                                    
      *-----------------------*                                                 
           MOVE ZEROES TO WS-TMP-EDN.                                           
           MOVE K825-NUM-NRIC           TO KB20-NUM-OCCUP1-UIN                  
           MOVE K825-NME-OCCP           TO KB20-NME-OCCUP1                      
           MOVE K825-NUM-CITIZENSHIP    TO KB20-NUM-OCCUP1-CITIZENSHIP          
           MOVE K825-DTE-BIRTH          TO KB20-DTE-OCCUP1-BIRTH                
           MOVE K825-NUM-NRIC-SPOUSE    TO KB20-NUM-OCCUP1-SPOUSE-UIN           
           MOVE K825-NUM-RELATIONSHIP   TO KB20-NUM-OCCUP1-RLTNSP-APPLT1        
           MOVE K825-AMT-INCOME         TO KB20-AMT-OCCUP1-INCOME               
           MOVE SPACES                  TO KB20-NUM-OCCUP1-EMPLY-STATUS         
           MOVE SPACES                  TO KB20-NME-OCCUP1-OCCUPATION           
           MOVE K825-NUM-PHONE          TO KB20-NUM-OCCUP1-PHONE                
           MOVE K825-NUM-HP-PGR         TO KB20-NUM-OCCUP1-HP-PAGER             
      *    MOVE K825-NUM-EDUCATION      TO KB20-NUM-OCCUP1-EDN-LVL.             
           MOVE K825-NUM-EDUCATION      TO WS-TMP-EDN.                          
           SUBTRACT 1 FROM  WS-TMP-EDN.                                         
           MOVE WS-TMP-EDN              TO KB20-NUM-OCCUP1-EDN-LVL.             
                                                                                
           MOVE SPACES                  TO WS-TEMP-SEX                          
                                           WS-TEMP-RACE                         
                                           WS-TEMP-MSTATUS.                     
           PERFORM 4425-CONVERT-SEX-RACE-MSTATUS THRU 4425-EXIT.                
           MOVE WS-TEMP-SEX             TO KB20-NUM-OCCUP1-SEX                  
           MOVE WS-TEMP-RACE            TO KB20-NUM-OCCUP1-RACE                 
           MOVE WS-TEMP-MSTATUS         TO                                      
                KB20-NUM-OCCUP1-MARITAL-STATUS.                                 
                                                                                
       4420E-EXIT.                                                              
            EXIT.                                                               
                                                                                
      *-----------------------*                                                 
       4420F-POPULATE-OCCP2.                                                    
      *-----------------------*                                                 
           MOVE ZEROES TO WS-TMP-EDN.                                           
           MOVE K825-NUM-NRIC           TO KB20-NUM-OCCUP2-UIN                  
           MOVE K825-NME-OCCP           TO KB20-NME-OCCUP2                      
           MOVE K825-NUM-CITIZENSHIP    TO KB20-NUM-OCCUP2-CITIZENSHIP          
           MOVE K825-DTE-BIRTH          TO KB20-DTE-OCCUP2-BIRTH                
           MOVE K825-NUM-NRIC-SPOUSE    TO KB20-NUM-OCCUP2-SPOUSE-UIN           
           MOVE K825-NUM-RELATIONSHIP   TO KB20-NUM-OCCUP2-RLTNSP-APPLT1        
           MOVE K825-AMT-INCOME         TO KB20-AMT-OCCUP2-INCOME               
           MOVE SPACES                  TO KB20-NUM-OCCUP2-EMPLY-STATUS         
           MOVE SPACES                  TO KB20-NME-OCCUP2-OCCUPATION           
           MOVE K825-NUM-PHONE          TO KB20-NUM-OCCUP2-PHONE                
           MOVE K825-NUM-HP-PGR         TO KB20-NUM-OCCUP2-HP-PAGER             
      *    MOVE K825-NUM-EDUCATION      TO KB20-NUM-OCCUP2-EDN-LVL.             
           MOVE K825-NUM-EDUCATION      TO WS-TMP-EDN.                          
           SUBTRACT 1 FROM  WS-TMP-EDN.                                         
           MOVE WS-TMP-EDN              TO KB20-NUM-OCCUP2-EDN-LVL.             
                                                                                
           MOVE SPACES                  TO WS-TEMP-SEX                          
                                           WS-TEMP-RACE                         
                                           WS-TEMP-MSTATUS.                     
           PERFORM 4425-CONVERT-SEX-RACE-MSTATUS THRU 4425-EXIT.                
           MOVE WS-TEMP-SEX             TO KB20-NUM-OCCUP2-SEX                  
           MOVE WS-TEMP-RACE            TO KB20-NUM-OCCUP2-RACE                 
           MOVE WS-TEMP-MSTATUS         TO                                      
                KB20-NUM-OCCUP2-MARITAL-STATUS.                                 
                                                                                
       4420F-EXIT.                                                              
            EXIT.                                                               
                                                                                
      *-----------------------*                                                 
       4420G-POPULATE-OCCP3.                                                    
      *-----------------------*                                                 
           MOVE ZEROES TO WS-TMP-EDN.                                           
           MOVE K825-NUM-NRIC           TO KB20-NUM-OCCUP3-UIN                  
           MOVE K825-NME-OCCP           TO KB20-NME-OCCUP3                      
           MOVE K825-NUM-CITIZENSHIP    TO KB20-NUM-OCCUP3-CITIZENSHIP          
           MOVE K825-DTE-BIRTH          TO KB20-DTE-OCCUP3-BIRTH                
           MOVE K825-NUM-NRIC-SPOUSE    TO KB20-NUM-OCCUP3-SPOUSE-UIN           
           MOVE K825-NUM-RELATIONSHIP   TO KB20-NUM-OCCUP3-RLTNSP-APPLT1        
           MOVE K825-AMT-INCOME         TO KB20-AMT-OCCUP3-INCOME               
           MOVE SPACES                  TO KB20-NUM-OCCUP3-EMPLY-STATUS         
           MOVE SPACES                  TO KB20-NME-OCCUP3-OCCUPATION           
           MOVE K825-NUM-PHONE          TO KB20-NUM-OCCUP3-PHONE                
           MOVE K825-NUM-HP-PGR         TO KB20-NUM-OCCUP3-HP-PAGER             
      *    MOVE K825-NUM-EDUCATION      TO KB20-NUM-OCCUP3-EDN-LVL.             
           MOVE K825-NUM-EDUCATION      TO WS-TMP-EDN.                          
           SUBTRACT 1 FROM  WS-TMP-EDN.                                         
           MOVE WS-TMP-EDN              TO KB20-NUM-OCCUP3-EDN-LVL.             
                                                                                
           MOVE SPACES                  TO WS-TEMP-SEX                          
                                           WS-TEMP-RACE                         
                                           WS-TEMP-MSTATUS.                     
           PERFORM 4425-CONVERT-SEX-RACE-MSTATUS THRU 4425-EXIT.                
           MOVE WS-TEMP-SEX             TO KB20-NUM-OCCUP3-SEX                  
           MOVE WS-TEMP-RACE            TO KB20-NUM-OCCUP3-RACE                 
           MOVE WS-TEMP-MSTATUS         TO                                      
                KB20-NUM-OCCUP3-MARITAL-STATUS.                                 
                                                                                
       4420G-EXIT.                                                              
            EXIT.                                                               
                                                                                
      *-----------------------*                                                 
       4420H-POPULATE-OCCP4.                                                    
      *-----------------------*                                                 
           MOVE ZEROES TO WS-TMP-EDN.                                           
           MOVE K825-NUM-NRIC           TO KB20-NUM-OCCUP4-UIN                  
           MOVE K825-NME-OCCP           TO KB20-NME-OCCUP4                      
           MOVE K825-NUM-CITIZENSHIP    TO KB20-NUM-OCCUP4-CITIZENSHIP          
           MOVE K825-DTE-BIRTH          TO KB20-DTE-OCCUP4-BIRTH                
           MOVE K825-NUM-NRIC-SPOUSE    TO KB20-NUM-OCCUP4-SPOUSE-UIN           
           MOVE K825-NUM-RELATIONSHIP   TO KB20-NUM-OCCUP4-RLTNSP-APPLT1        
           MOVE K825-AMT-INCOME         TO KB20-AMT-OCCUP4-INCOME               
           MOVE SPACES                  TO KB20-NUM-OCCUP4-EMPLY-STATUS         
           MOVE SPACES                  TO KB20-NME-OCCUP4-OCCUPATION           
           MOVE K825-NUM-PHONE          TO KB20-NUM-OCCUP4-PHONE                
           MOVE K825-NUM-HP-PGR         TO KB20-NUM-OCCUP4-HP-PAGER             
      *    MOVE K825-NUM-EDUCATION      TO KB20-NUM-OCCUP4-EDN-LVL.             
           MOVE K825-NUM-EDUCATION      TO WS-TMP-EDN.                          
           SUBTRACT 1 FROM  WS-TMP-EDN.                                         
           MOVE WS-TMP-EDN              TO KB20-NUM-OCCUP4-EDN-LVL.             
                                                                                
           MOVE SPACES                  TO WS-TEMP-SEX                          
                                           WS-TEMP-RACE                         
                                           WS-TEMP-MSTATUS.                     
           PERFORM 4425-CONVERT-SEX-RACE-MSTATUS THRU 4425-EXIT.                
           MOVE WS-TEMP-SEX             TO KB20-NUM-OCCUP4-SEX                  
           MOVE WS-TEMP-RACE            TO KB20-NUM-OCCUP4-RACE                 
           MOVE WS-TEMP-MSTATUS         TO                                      
                KB20-NUM-OCCUP4-MARITAL-STATUS.                                 
                                                                                
       4420H-EXIT.                                                              
            EXIT.                                                               
                                                                                
      *-----------------------*                                                 
       4420I-POPULATE-OCCP5.                                                    
      *-----------------------*                                                 
           MOVE ZEROES TO WS-TMP-EDN.                                           
           MOVE K825-NUM-NRIC           TO KB20-NUM-OCCUP5-UIN                  
           MOVE K825-NME-OCCP           TO KB20-NME-OCCUP5                      
           MOVE K825-NUM-CITIZENSHIP    TO KB20-NUM-OCCUP5-CITIZENSHIP          
           MOVE K825-DTE-BIRTH          TO KB20-DTE-OCCUP5-BIRTH                
           MOVE K825-NUM-NRIC-SPOUSE    TO KB20-NUM-OCCUP5-SPOUSE-UIN           
           MOVE K825-NUM-RELATIONSHIP   TO KB20-NUM-OCCUP5-RLTNSP-APPLT1        
           MOVE K825-AMT-INCOME         TO KB20-AMT-OCCUP5-INCOME               
           MOVE SPACES                  TO KB20-NUM-OCCUP5-EMPLY-STATUS         
           MOVE SPACES                  TO KB20-NME-OCCUP5-OCCUPATION           
           MOVE K825-NUM-PHONE          TO KB20-NUM-OCCUP5-PHONE                
           MOVE K825-NUM-HP-PGR         TO KB20-NUM-OCCUP5-HP-PAGER             
      *    MOVE K825-NUM-EDUCATION      TO KB20-NUM-OCCUP5-EDN-LVL.             
           MOVE K825-NUM-EDUCATION      TO WS-TMP-EDN.                          
           SUBTRACT 1 FROM  WS-TMP-EDN.                                         
           MOVE WS-TMP-EDN              TO KB20-NUM-OCCUP5-EDN-LVL.             
                                                                                
           MOVE SPACES                  TO WS-TEMP-SEX                          
                                           WS-TEMP-RACE                         
                                           WS-TEMP-MSTATUS.                     
           PERFORM 4425-CONVERT-SEX-RACE-MSTATUS THRU 4425-EXIT.                
           MOVE WS-TEMP-SEX             TO KB20-NUM-OCCUP5-SEX                  
           MOVE WS-TEMP-RACE            TO KB20-NUM-OCCUP5-RACE                 
           MOVE WS-TEMP-MSTATUS         TO                                      
                KB20-NUM-OCCUP5-MARITAL-STATUS.                                 
                                                                                
       4420I-EXIT.                                                              
            EXIT.                                                               
                                                                                
      *-----------------------*                                                 
       4420J-POPULATE-OCCP6.                                                    
      *-----------------------*                                                 
           MOVE ZEROES TO WS-TMP-EDN.                                           
           MOVE K825-NUM-NRIC           TO KB20-NUM-OCCUP6-UIN                  
           MOVE K825-NME-OCCP           TO KB20-NME-OCCUP6                      
           MOVE K825-NUM-CITIZENSHIP    TO KB20-NUM-OCCUP6-CITIZENSHIP          
           MOVE K825-DTE-BIRTH          TO KB20-DTE-OCCUP6-BIRTH                
           MOVE K825-NUM-NRIC-SPOUSE    TO KB20-NUM-OCCUP6-SPOUSE-UIN           
           MOVE K825-NUM-RELATIONSHIP   TO KB20-NUM-OCCUP6-RLTNSP-APPLT1        
           MOVE K825-AMT-INCOME         TO KB20-AMT-OCCUP6-INCOME               
           MOVE SPACES                  TO KB20-NUM-OCCUP6-EMPLY-STATUS         
           MOVE SPACES                  TO KB20-NME-OCCUP6-OCCUPATION           
           MOVE K825-NUM-PHONE          TO KB20-NUM-OCCUP6-PHONE                
           MOVE K825-NUM-HP-PGR         TO KB20-NUM-OCCUP6-HP-PAGER             
      *    MOVE K825-NUM-EDUCATION      TO KB20-NUM-OCCUP6-EDN-LVL.             
           MOVE K825-NUM-EDUCATION      TO WS-TMP-EDN.                          
           SUBTRACT 1 FROM  WS-TMP-EDN.                                         
           MOVE WS-TMP-EDN              TO KB20-NUM-OCCUP6-EDN-LVL.             
                                                                                
           MOVE SPACES                  TO WS-TEMP-SEX                          
                                           WS-TEMP-RACE                         
                                           WS-TEMP-MSTATUS.                     
           PERFORM 4425-CONVERT-SEX-RACE-MSTATUS THRU 4425-EXIT.                
           MOVE WS-TEMP-SEX             TO KB20-NUM-OCCUP6-SEX                  
           MOVE WS-TEMP-RACE            TO KB20-NUM-OCCUP6-RACE                 
           MOVE WS-TEMP-MSTATUS         TO                                      
                KB20-NUM-OCCUP6-MARITAL-STATUS.                                 
                                                                                
       4420J-EXIT.                                                              
            EXIT.                                                               
                                                                                
      *-----------------------*                                                 
       4420K-POPULATE-OCCP7.                                                    
      *-----------------------*                                                 
           MOVE ZEROES TO WS-TMP-EDN.                                           
           MOVE K825-NUM-NRIC           TO KB20-NUM-OCCUP7-UIN                  
           MOVE K825-NME-OCCP           TO KB20-NME-OCCUP7                      
           MOVE K825-NUM-CITIZENSHIP    TO KB20-NUM-OCCUP7-CITIZENSHIP          
           MOVE K825-DTE-BIRTH          TO KB20-DTE-OCCUP7-BIRTH                
           MOVE K825-NUM-NRIC-SPOUSE    TO KB20-NUM-OCCUP7-SPOUSE-UIN           
           MOVE K825-NUM-RELATIONSHIP   TO KB20-NUM-OCCUP7-RLTNSP-APPLT1        
           MOVE K825-AMT-INCOME         TO KB20-AMT-OCCUP7-INCOME               
           MOVE SPACES                  TO KB20-NUM-OCCUP7-EMPLY-STATUS         
           MOVE SPACES                  TO KB20-NME-OCCUP7-OCCUPATION           
           MOVE K825-NUM-PHONE          TO KB20-NUM-OCCUP7-PHONE                
           MOVE K825-NUM-HP-PGR         TO KB20-NUM-OCCUP7-HP-PAGER             
      *    MOVE K825-NUM-EDUCATION      TO KB20-NUM-OCCUP7-EDN-LVL.             
           MOVE K825-NUM-EDUCATION      TO WS-TMP-EDN.                          
           SUBTRACT 1 FROM  WS-TMP-EDN.                                         
           MOVE WS-TMP-EDN              TO KB20-NUM-OCCUP7-EDN-LVL.             
                                                                                
           MOVE SPACES                  TO WS-TEMP-SEX                          
                                           WS-TEMP-RACE                         
                                           WS-TEMP-MSTATUS.                     
           PERFORM 4425-CONVERT-SEX-RACE-MSTATUS THRU 4425-EXIT.                
           MOVE WS-TEMP-SEX             TO KB20-NUM-OCCUP7-SEX                  
           MOVE WS-TEMP-RACE            TO KB20-NUM-OCCUP7-RACE                 
           MOVE WS-TEMP-MSTATUS         TO                                      
                KB20-NUM-OCCUP7-MARITAL-STATUS.                                 
                                                                                
       4420K-EXIT.                                                              
            EXIT.                                                               
                                                                                
      *-----------------------*                                                 
       4420L-POPULATE-OCCP8.                                                    
      *-----------------------*                                                 
           MOVE ZEROES TO WS-TMP-EDN.                                           
           MOVE K825-NUM-NRIC           TO KB20-NUM-OCCUP8-UIN                  
           MOVE K825-NME-OCCP           TO KB20-NME-OCCUP8                      
           MOVE K825-NUM-CITIZENSHIP    TO KB20-NUM-OCCUP8-CITIZENSHIP          
           MOVE K825-DTE-BIRTH          TO KB20-DTE-OCCUP8-BIRTH                
           MOVE K825-NUM-NRIC-SPOUSE    TO KB20-NUM-OCCUP8-SPOUSE-UIN           
           MOVE K825-NUM-RELATIONSHIP   TO KB20-NUM-OCCUP8-RLTNSP-APPLT1        
           MOVE K825-AMT-INCOME         TO KB20-AMT-OCCUP8-INCOME               
           MOVE SPACES                  TO KB20-NUM-OCCUP8-EMPLY-STATUS         
           MOVE SPACES                  TO KB20-NME-OCCUP8-OCCUPATION           
           MOVE K825-NUM-PHONE          TO KB20-NUM-OCCUP8-PHONE                
           MOVE K825-NUM-HP-PGR         TO KB20-NUM-OCCUP8-HP-PAGER             
      *    MOVE K825-NUM-EDUCATION      TO KB20-NUM-OCCUP8-EDN-LVL.             
           MOVE K825-NUM-EDUCATION      TO WS-TMP-EDN.                          
           SUBTRACT 1 FROM  WS-TMP-EDN.                                         
           MOVE WS-TMP-EDN              TO KB20-NUM-OCCUP8-EDN-LVL.             
                                                                                
           MOVE SPACES                  TO WS-TEMP-SEX                          
                                           WS-TEMP-RACE                         
                                           WS-TEMP-MSTATUS.                     
           PERFORM 4425-CONVERT-SEX-RACE-MSTATUS THRU 4425-EXIT.                
           MOVE WS-TEMP-SEX             TO KB20-NUM-OCCUP8-SEX                  
           MOVE WS-TEMP-RACE            TO KB20-NUM-OCCUP8-RACE                 
           MOVE WS-TEMP-MSTATUS         TO                                      
                KB20-NUM-OCCUP8-MARITAL-STATUS.                                 
                                                                                
       4420L-EXIT.                                                              
            EXIT.                                                               
                                                                                
      *------------------------------*                                          
       4425-CONVERT-SEX-RACE-MSTATUS.                                           
      *------------------------------*                                          
           IF K825-NUM-SEX = '1'                                                
              MOVE 'M' TO WS-TEMP-SEX                                           
           ELSE                                                                 
           IF K825-NUM-SEX = '2'                                                
              MOVE 'F' TO WS-TEMP-SEX                                           
           END-IF.                                                              
                                                                                
           IF K825-NUM-MARITAL-STATUS = '1'                                     
              MOVE 'S' TO WS-TEMP-MSTATUS                                       
           ELSE                                                                 
           IF K825-NUM-MARITAL-STATUS = '2'                                     
              MOVE 'M' TO WS-TEMP-MSTATUS                                       
           ELSE                                                                 
           IF K825-NUM-MARITAL-STATUS = '3'                                     
              MOVE 'W' TO WS-TEMP-MSTATUS                                       
           ELSE                                                                 
           IF K825-NUM-MARITAL-STATUS = '4'                                     
              MOVE 'D' TO WS-TEMP-MSTATUS                                       
           ELSE                                                                 
           IF K825-NUM-MARITAL-STATUS = '5'                                     
              MOVE 'P' TO WS-TEMP-MSTATUS                                       
           END-IF.                                                              
                                                                                
           IF K825-NUM-ETHNIC = '0'                                             
              MOVE 'C' TO WS-TEMP-RACE                                          
           ELSE                                                                 
           IF K825-NUM-ETHNIC = '5'                                             
              MOVE 'M' TO WS-TEMP-RACE                                          
           ELSE                                                                 
           IF K825-NUM-ETHNIC = '6'                                             
              MOVE 'I' TO WS-TEMP-RACE                                          
           ELSE                                                                 
           IF K825-NUM-ETHNIC = '7'                                             
              MOVE 'O' TO WS-TEMP-RACE                                          
           END-IF.                                                              
                                                                                
       4425-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-----------------------*                                                 
       4430-GET-BP13K830-INFO.                                                  
      *-----------------------*                                                 
           MOVE SPACES TO BP13K830-REC                                          
           INITIALIZE     BP13K830-REC.                                         
                                                                                
           MOVE F740-NUM-REGN TO K830-KEY-FLD.                                  
                                                                                
           READ BP13K830.                                                       
                                                                                
           IF K830-FILE-STATUS = 00 OR 02                                       
              PERFORM 4431-MOVE-ADDRESS   THRU 4431-EXIT                        
           ELSE                                                                 
           IF K830-FILE-STATUS = 23                                             
              MOVE K-K830-NOTFND          TO   LD04-REMARKS                     
              PERFORM 7000-PRINT-ERROR    THRU 7000-EXIT                        
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K830 FOR REC ' K830-NUM-REGN           
              MOVE     K830-FILE-STATUS   TO   RETURN-CODE                      
              PERFORM  9000-CLOSE-FILES   THRU 9000-EXIT                        
           END-IF.                                                              
                                                                                
       4430-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *--------------------*                                                    
       4431-MOVE-ADDRESS.                                                       
      *--------------------*                                                    
           IF K830-NUM-MAIL-BLK NOT = SPACES AND LOW-VALUES                     
              MOVE K830-NUM-MAIL-MAIN-BLK   TO KB20-NUM-MAIN-BLK                
              MOVE K830-NUM-MAIL-SUB-BLK    TO KB20-NUM-SUB-BLK                 
                                                                                
              MOVE K830-NUM-MAIL-LVL-NUM    TO KB20-NUM-LEVEL                   
                                                                                
              MOVE K830-NUM-MAIL-HSEMAIN    TO KB20-NUM-MAIN-UNIT               
              MOVE K830-NUM-MAIL-HSESUB     TO KB20-NUM-SUB-UNIT                
                                                                                
              MOVE K830-NME-MAIL-STR-BLDG(1:32) TO                              
                                               KB20-NUM-CORRESP-STREET          
              MOVE K830-NUM-MAIL-POSTAL     TO KB20-CDE-CORRESP-POST            
           ELSE                                                                 
              DISPLAY 'NO MAILING ADDRESS : ' KB20-NUM-REGN                     
              MOVE K830-NUM-MAIN-BLK        TO KB20-NUM-MAIN-BLK                
              MOVE K830-NUM-SUB-BLK         TO KB20-NUM-SUB-BLK                 
                                                                                
              MOVE K830-NUM-LVL-NUM         TO KB20-NUM-LEVEL                   
                                                                                
              MOVE K830-NUM-HSEMAIN         TO KB20-NUM-MAIN-UNIT               
              MOVE K830-NUM-HSESUB          TO KB20-NUM-SUB-UNIT                
                                                                                
              MOVE K830-NME-STREET          TO KB20-NUM-CORRESP-STREET          
              MOVE K830-NUM-POSTAL          TO KB20-CDE-CORRESP-POST            
           END-IF.                                                              
                                                                                
       4431-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-----------------------*                                                 
       4440-GET-BP13K800-INFO.                                                  
      *-----------------------*                                                 
                                                                                
           MOVE SPACES TO BP13K800-MASTER.                                      
           INITIALIZE     BP13K800-MASTER.                                      
                                                                                
           MOVE F740-NUM-REGN TO K800-NUM-REGN.                                 
                                                                                
           READ BP13K800.                                                       
                                                                                
           IF K800-FILE-STATUS = 00                                             
              MOVE K800-NUM-LOAN-TAG      TO KB20-NUM-LOAN-TAG                  
              MOVE K800-NUM-ORIG-LOAN-TAG TO KB20-NUM-ORIG-LOAN-TAG             
              ADD 1                       TO WS-K800-FND-CTR                    
           ELSE                                                                 
           IF K800-FILE-STATUS = 23                                             
              MOVE SPACES                 TO   KB20-NUM-LOAN-TAG                
              MOVE SPACES                 TO   KB20-NUM-ORIG-LOAN-TAG           
              IF F740-CDE-REQUEST-STATUS NOT = 'W'                              
                 MOVE K-K800-NOTFND       TO   LD04-REMARKS                     
                 ADD 1                    TO   WS-K800-NOTFND-CTR               
                 PERFORM 7000-PRINT-ERROR THRU 7000-EXIT                        
              END-IF                                                            
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K800 FOR REC ' K800-NUM-REGN           
              MOVE     K800-FILE-STATUS   TO   RETURN-CODE                      
              PERFORM  9000-CLOSE-FILES   THRU 9000-EXIT                        
           END-IF.                                                              
                                                                                
       4440-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *--------------------*                                                    
       4500-BP13KB20-WRITE.                                                     
      *--------------------*                                                    
           MOVE FUNCTION CURRENT-DATE(1:8) TO KB20-DTE-UPDATE.                  
           MOVE FUNCTION CURRENT-DATE(9:8) TO KB20-TME-UPDATE.                  
                                                                                
           WRITE BP13KB20-REC.                                                  
                                                                                
           IF KB20-FILE-STATUS = 00 OR 02                                       
              ADD 1 TO WS-KB20-WRITE-CTR                                        
           ELSE                                                                 
           IF KB20-FILE-STATUS = 22                                             
              ADD 1 TO WS-KB20-DUP-CTR                                          
              MOVE K-KB20-DUPLICATE       TO   LD04-REMARKS                     
              PERFORM 7000-PRINT-ERROR    THRU 7000-EXIT                        
           ELSE                                                                 
              MOVE     KB20-FILE-STATUS   TO   RETURN-CODE                      
              ADD 1 TO WS-KB20-ERR-CTR                                          
              MOVE K-KB20-ERROR           TO   LD04-REMARKS                     
              PERFORM 7000-PRINT-ERROR    THRU 7000-EXIT                        
           END-IF.                                                              
                                                                                
       4500-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-----------------------*                                                 
       4600-READ-BP13K200.                                                      
      *-----------------------*                                                 
           MOVE SPACES TO BP13K200-REC                                          
           INITIALIZE     BP13K200-REC.                                         
                                                                                
           MOVE F740-NUM-REGN TO K200-NUM-REGN.                                 
                                                                                
           READ BP13K200 KEY IS K200-NUM-REGN.                                  
                                                                                
           IF K200-FILE-STATUS = 00 OR 02                                       
              PERFORM 4650-MOVE-DATA      THRU 4650-EXIT                        
              ADD 1                       TO   WS-K200-FND-CTR                  
           ELSE                                                                 
           IF K200-FILE-STATUS = 23                                             
              MOVE SPACES                 TO   KB20-DTE-BKAPPMT                 
              MOVE SPACES                 TO   KB20-TME-BKAPPMT                 
              MOVE SPACES                 TO   KB20-TME-BKAPPMT-ARRIVAL         
              IF F740-CDE-REQUEST-STATUS NOT = 'W'                              
                 MOVE K-K200-NOTFND       TO   LD04-REMARKS                     
                 ADD 1                    TO   WS-K200-NOTFND-CTR               
                 PERFORM 7000-PRINT-ERROR THRU 7000-EXIT                        
              END-IF                                                            
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K200 FOR REC ' F740-NUM-REGN           
              MOVE     K200-FILE-STATUS   TO   RETURN-CODE                      
              PERFORM  9000-CLOSE-FILES   THRU 9000-EXIT                        
           END-IF.                                                              
                                                                                
       4600-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-----------------*                                                       
       4650-MOVE-DATA.                                                          
      *-----------------*                                                       
                                                                                
            MOVE K200-DTE-BKAPPMT-DATE TO KB20-DTE-BKAPPMT.                     
            MOVE K200-TME-BKAPPMT      TO KB20-TME-BKAPPMT                      
                                          WS-ARRIV-TIME.                        
                                                                                
           COMPUTE WS-ARRIV-HR = WS-ARRIV-HR - 1.                               
                                                                                
           STRING WS-ARRIV-HR WS-ARRIV-MM                                       
              DELIMITED BY SIZE      INTO KB20-TME-BKAPPMT-ARRIVAL.             
                                                                                
       4650-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-----------------*                                                       
       5000-CHECK-GRO.                                                          
      *-----------------*                                                       
                                                                                
           IF WS-ALLOCSCH-TYPE = 'CCC'                                          
              PERFORM 5100-READ-BP13K740      THRU 5100-EXIT                    
              IF WS-K740-FND = 'Y'                                              
                 MOVE BP13K740-REC            TO   BP13F740-REC                 
                 PERFORM 4310-MOVE-DATA       THRU 4310-EXIT                    
                 PERFORM 4400-FORMAT-BP13KB20 THRU 4400-EXIT                    
                 PERFORM 4500-BP13KB20-WRITE  THRU 4500-EXIT                    
              END-IF                                                            
           END-IF.                                                              
                                                                                
       5000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-----------------------*                                                 
       5100-READ-BP13K740.                                                      
      *-----------------------*                                                 
           MOVE SPACES TO BP13K740-REC                                          
           INITIALIZE     BP13K740-REC.                                         
           MOVE 'N'    TO WS-K740-FND.                                          
                                                                                
           MOVE F740-KEY-FLD  TO K740-KEY-FLD.                                  
           MOVE 'P'           TO K740-KEY-FLD(28:1).                            
                                                                                
           READ BP13K740.                                                       
                                                                                
           IF K740-FILE-STATUS = 00                                             
              MOVE 'Y'                    TO   WS-K740-FND                      
              ADD 1                       TO   WS-K740-FND-CTR                  
           ELSE                                                                 
           IF K740-FILE-STATUS = 23                                             
              DISPLAY 'NOT FOUND IN BP13K740 : ' K740-KEY-FLD                   
              ADD 1                       TO   WS-K740-NOTFND-CTR               
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K740 FOR REC ' K740-KEY-FLD            
              MOVE     K740-FILE-STATUS   TO   RETURN-CODE                      
              PERFORM  9000-CLOSE-FILES   THRU 9000-EXIT                        
           END-IF.                                                              
                                                                                
       5100-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-----------------*                                                       
       7000-PRINT-ERROR.                                                        
      *-----------------*                                                       
           IF WS-LD04-LINECTR > 24                                              
              PERFORM 7100-PRINT-HEADING THRU 7100-EXIT                         
           END-IF.                                                              
                                                                                
           ADD  1                        TO   WS-LD04-S-NO.                     
           MOVE WS-LD04-S-NO             TO   LD04-S-NO.                        
                                                                                
           MOVE F740-NUM-REGN            TO   LD04-REG-NO.                      
           MOVE F740-NUM-NRIC1           TO   LD04-NRIC.                        
           MOVE KB20-NUM-FT2T            TO   LD04-FT2T.                        
                                                                                
           WRITE BP13LD04-REC          FROM   LD04-DETAIL-01                    
                                      AFTER   ADVANCING 2 LINES.                
                                                                                
           ADD  +1                       TO   WS-LD04-LINECTR.                  
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------*                                                     
       7100-PRINT-HEADING.                                                      
      *-------------------*                                                     
           ADD   +1               TO WS-LD04-PAGECTR.                           
           MOVE WS-LD04-PAGECTR   TO LD04-PAGE-NO.                              
                                                                                
           WRITE BP13LD04-REC   FROM LD04-HEADING-01                            
                               AFTER ADVANCING PAGE.                            
                                                                                
           WRITE BP13LD04-REC   FROM LD04-HEADING-02                            
                               AFTER ADVANCING 1 LINE.                          
                                                                                
           WRITE BP13LD04-REC   FROM LD04-HEADING-03                            
                               AFTER ADVANCING 1 LINE.                          
                                                                                
           WRITE BP13LD04-REC   FROM LD04-HEADING-04                            
                               AFTER ADVANCING 2 LINES.                         
                                                                                
           WRITE BP13LD04-REC   FROM LD04-HEADING-05                            
                               AFTER ADVANCING 1 LINES.                         
                                                                                
           MOVE ZEROS             TO WS-LD04-LINECTR.                           
                                                                                
       7100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------*                                                     
       8000-PRINT-REPORT.                                                       
      *-------------------*                                                     
      *** PRINT FILE STATISTICS ON NEW PAGE                                     
                                                                                
           ADD   +1               TO WS-LD04-PAGECTR.                           
           MOVE WS-LD04-PAGECTR   TO LD04-PAGE-NO.                              
                                                                                
           WRITE BP13LD04-REC   FROM LD04-HEADING-01                            
                               AFTER ADVANCING PAGE.                            
                                                                                
           WRITE BP13LD04-REC   FROM LD04-HEADING-02                            
                               AFTER ADVANCING 1 LINE.                          
                                                                                
           MOVE SPACES            TO LD04-TOTALS.                               
                                                                                
      ***  BP13F740 STATISTICS                                                  
                                                                                
           MOVE  K-F740-RECORDS-READ        TO   LD04-TOTAL-DESC.               
           MOVE  WS-F740-READ-CTR           TO   LD04-TOTAL-VALUE.              
           WRITE BP13LD04-REC             FROM   LD04-TOTALS                    
                                         AFTER   ADVANCING 2 LINES.             
                                                                                
      ***  BP13K200 STATISTICS                                                  
                                                                                
           MOVE  K-K200-RECORDS-FOUND       TO   LD04-TOTAL-DESC.               
           MOVE  WS-K200-FND-CTR            TO   LD04-TOTAL-VALUE.              
           WRITE BP13LD04-REC             FROM   LD04-TOTALS                    
                                         AFTER   ADVANCING 2 LINES.             
                                                                                
           MOVE  K-K200-RECORDS-NFOUND      TO   LD04-TOTAL-DESC.               
           MOVE  WS-K200-NOTFND-CTR         TO   LD04-TOTAL-VALUE.              
           WRITE BP13LD04-REC             FROM   LD04-TOTALS                    
                                         AFTER   ADVANCING 2 LINES.             
                                                                                
      ***  BP13K740 STATISTICS                                                  
                                                                                
           MOVE  K-K740-RECORDS-FOUND       TO   LD04-TOTAL-DESC.               
           MOVE  WS-K740-FND-CTR            TO   LD04-TOTAL-VALUE.              
           WRITE BP13LD04-REC             FROM   LD04-TOTALS                    
                                         AFTER   ADVANCING 2 LINES.             
                                                                                
           MOVE  K-K740-RECORDS-NFOUND      TO   LD04-TOTAL-DESC.               
           MOVE  WS-K740-NOTFND-CTR         TO   LD04-TOTAL-VALUE.              
           WRITE BP13LD04-REC             FROM   LD04-TOTALS                    
                                         AFTER   ADVANCING 2 LINES.             
                                                                                
      ***  BP13K800 STATISTICS                                                  
                                                                                
           MOVE  K-K800-RECORDS-FOUND       TO   LD04-TOTAL-DESC.               
           MOVE  WS-K800-FND-CTR            TO   LD04-TOTAL-VALUE.              
           WRITE BP13LD04-REC             FROM   LD04-TOTALS                    
                                         AFTER   ADVANCING 2 LINES.             
                                                                                
           MOVE  K-K800-RECORDS-NFOUND      TO   LD04-TOTAL-DESC.               
           MOVE  WS-K800-NOTFND-CTR         TO   LD04-TOTAL-VALUE.              
           WRITE BP13LD04-REC             FROM   LD04-TOTALS                    
                                         AFTER   ADVANCING 2 LINES.             
                                                                                
      ***  BP13KB20 STATISTICS                                                  
                                                                                
           MOVE  K-KB20-RECORDS-WRITE       TO   LD04-TOTAL-DESC.               
           MOVE  WS-KB20-WRITE-CTR          TO   LD04-TOTAL-VALUE.              
           WRITE BP13LD04-REC             FROM   LD04-TOTALS                    
                                         AFTER   ADVANCING 2 LINES.             
                                                                                
           MOVE  K-KB20-RECORDS-DUP         TO   LD04-TOTAL-DESC.               
           MOVE  WS-KB20-DUP-CTR            TO   LD04-TOTAL-VALUE.              
           WRITE BP13LD04-REC             FROM   LD04-TOTALS                    
                                         AFTER   ADVANCING 1 LINES.             
                                                                                
           MOVE  K-KB20-UNSUCC-WRITE        TO   LD04-TOTAL-DESC.               
           MOVE  WS-KB20-ERR-CTR            TO   LD04-TOTAL-VALUE.              
           WRITE BP13LD04-REC             FROM   LD04-TOTALS                    
                                         AFTER   ADVANCING 1 LINES.             
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-----------------*                                                       
       9000-CLOSE-FILES.                                                        
      *-----------------*                                                       
           CLOSE BP13F740                                                       
                 BP13K200                                                       
                 BP13K740                                                       
                 BP13K800                                                       
                 BP13K825                                                       
                 BP13K830                                                       
                 BP13KB78                                                       
                 BP13KB20.                                                      
                                                                                
           IF K200-FILE-STATUS NOT = 00                                         
              DISPLAY 'BP13K200 CLOSE ERROR,STATUS IS ' K200-FILE-STATUS        
              MOVE K200-FILE-STATUS TO RETURN-CODE                              
           END-IF.                                                              
                                                                                
           IF K740-FILE-STATUS NOT = 00                                         
              DISPLAY 'BP13K740 CLOSE ERROR,STATUS IS ' K740-FILE-STATUS        
              MOVE K740-FILE-STATUS TO RETURN-CODE                              
           END-IF.                                                              
                                                                                
           IF K800-FILE-STATUS NOT = 00                                         
              DISPLAY 'BP13K800 CLOSE ERROR,STATUS IS ' K800-FILE-STATUS        
              MOVE K800-FILE-STATUS TO RETURN-CODE                              
           END-IF.                                                              
                                                                                
           IF K825-FILE-STATUS NOT = 00                                         
              DISPLAY 'BP13K825 CLOSE ERROR,STATUS IS ' K825-FILE-STATUS        
              MOVE K825-FILE-STATUS TO RETURN-CODE                              
           END-IF.                                                              
                                                                                
           IF K830-FILE-STATUS NOT = 00                                         
              DISPLAY 'BP13K830 CLOSE ERROR,STATUS IS ' K830-FILE-STATUS        
              MOVE K830-FILE-STATUS TO RETURN-CODE                              
           END-IF.                                                              
                                                                                
           IF KB20-FILE-STATUS NOT = 00                                         
              DISPLAY 'BP13KB20 CLOSE ERROR,STATUS IS ' KB20-FILE-STATUS        
              MOVE KB20-FILE-STATUS TO RETURN-CODE                              
           END-IF.                                                              
                                                                                
           IF KB78-FILE-STATUS NOT = 00                                         
              DISPLAY 'BP13KB78 CLOSE ERROR,STATUS IS ' KB78-FILE-STATUS        
              MOVE KB78-FILE-STATUS TO RETURN-CODE                              
           END-IF.                                                              
                                                                                
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
