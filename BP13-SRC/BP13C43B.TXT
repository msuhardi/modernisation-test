      *------------------------*                                        00010000
       IDENTIFICATION DIVISION.                                         00020000
      *------------------------*                                        00030000
       PROGRAM-ID.    BP13C43B.                                         00040000
      *AUTHOR.        KSJ3.                                             00050000
      *DATE-WRITTEN.  12/07/2016.                                       00060000
      *============================================================*    00070000
      * SYSTEM OF COMMITMENT (BP13)                                *    00080000
      *============================================================*    00090000
      * OBJECTIVE : TO PRINT PAYMENT SCHEDULE FOR ADHOC STAMPING   *    00100000
      *             OF DEED OF ASSIGNMENT (BP13L43BJ) FOR DBSS     *    00110000
      *                                                            *    00120000
      * I/O FILES                                                  *    00130000
      *   INPUT   : BP13F315 - TRANSACTION FILE (SEQ)              *    00140000
      *             BP13K410 - SALES ORDER FILE (VSAM)             *    00150000
      *             BP13KD03 - DBSS MASTER HISTORY (VSAM)          *    00160000
      *             BP13KD45 - PROGRESS PAYMENT HISTORY (VSAM)     *    00170000
      *             B05K006  - SF MASTER FILE (VSAM)               *    00180000
      *   OUTPUT  : BP13K625 - STAMP FEE MASTER (SEQ)              *    00190000
      *             AG07F225 - EWPC STAMPING FILE (SEQ)            *    00200000
      *             BP1343BJ - STAMPING DOA FOR SOC (RPT)          *    00210000
      *                                                            *    00220000
      *============================================================*    00230000
      * MODIFICATION HISTORY:                                      *    00240000
      *                                                            *    00250000
      * CHG-NO    BY    DATE        DESCRIPTION                    *    00260000
      * --------  ----  ------      ------------------------------ *    00270000
      * BP136306  KSJ3  12/07/2016  NEW PROGRAM                    *    00280000
      * BP137140  PCL4  19/12/17    TO REDEFINE AG07 FILE ERROR CODE    00290000
      * BP138339  KR13  07/08/20    REMOVED P1343BJ1 - IOM8 CONVRSN*    00300000
      * BP139164  KV8   04/05/22    INCLUDED ADDRESS AND COMMENTED *    00301001
      *                             STREET                         *    00302001
      *============================================================*    00310000
                                                                        00320000
      *----------------------*                                          00330000
       ENVIRONMENT DIVISION.                                            00340000
      *----------------------*                                          00350000
       CONFIGURATION SECTION.                                           00360000
       SOURCE-COMPUTER.   IBM-3090.                                     00370000
       OBJECT-COMPUTER.   IBM-3090.                                     00380000
                                                                        00390000
       INPUT-OUTPUT SECTION.                                            00400000
       FILE-CONTROL.                                                    00410000
                                                                        00420000
           SELECT B05K006   ASSIGN       TO B05K006                     00430000
                            ACCESS MODE  IS RANDOM                      00440000
                            ORGANIZATION IS INDEXED                     00450000
                            RECORD KEY   IS K006-HDB-REF-SF             00460000
                            FILE STATUS  IS WS-K006-STATUS.             00470000
                                                                        00480000
           SELECT BP13K410  ASSIGN       TO BP13K410                    00490000
                            ACCESS MODE  IS RANDOM                      00500000
                            ORGANIZATION IS INDEXED                     00510000
                            RECORD KEY   IS K410-NUM-REGN               00520000
                            FILE STATUS  IS WS-K410-STATUS.             00530000
                                                                        00540000
           SELECT BP13KD03  ASSIGN       TO BP13KD03                    00550000
                            ACCESS MODE  IS RANDOM                      00560000
                            ORGANIZATION IS INDEXED                     00570000
                            RECORD KEY   IS KD03-NUM-REGN               00580000
                            FILE STATUS  IS WS-KD03-STATUS.             00590000
                                                                        00600000
           SELECT BP13KA10  ASSIGN       TO BP13KA10                    00610000
                            ACCESS MODE  IS RANDOM                      00620000
                            ORGANIZATION IS INDEXED                     00630000
                            RECORD KEY   IS KA10-NUM-PRJCT              00640000
                            FILE STATUS  IS WS-KA10-STATUS.             00650000
                                                                        00660000
           SELECT BP13KD45  ASSIGN       TO BP13KD45                    00670000
                            ORGANIZATION IS INDEXED                     00680000
                            ACCESS MODE  IS DYNAMIC                     00690000
                            RECORD KEY   IS KD45-KEY-FLD                00700000
                            FILE STATUS  IS WS-KD45-STATUS.             00710000
                                                                        00720000
           SELECT BP13K625  ASSIGN       TO BP13K625                    00730000
                            ACCESS MODE  IS DYNAMIC                     00740000
                            ORGANIZATION IS INDEXED                     00750000
                            RECORD KEY   IS K625-KEY-FLD                00760000
                            FILE STATUS  IS WS-K625-STATUS.             00770000
                                                                        00780000
           SELECT BP13F315  ASSIGN       TO BP13F315.                   00790000
           SELECT AG07F225  ASSIGN       TO AG07F225.                   00800000
                                                                        00810000
           SELECT BP1343BJ  ASSIGN       TO BP1343BJ.                   00820000
           SELECT BP1343BK  ASSIGN       TO BP1343BK.                   00830000
           SELECT BP1343BL  ASSIGN       TO BP1343BL.                   00840000
                                                                        00850000
      *---------------*                                                 00860000
       DATA DIVISION.                                                   00870000
      *---------------*                                                 00880000
       FILE SECTION.                                                    00890000
      *---------------*                                                 00900000
                                                                        00910000
       FD   B05K006.                                                    00920000
       COPY B05K006.                                                    00930000
                                                                        00940000
       FD   BP13K410                                                    00950000
            RECORD CONTAINS 2000 CHARACTERS.                            00960000
       COPY BP13K410.                                                   00970000
                                                                        00980000
       FD   BP13KD03                                                    00990000
            RECORD CONTAINS 1600 CHARACTERS.                            01000000
       COPY BP13KD03.                                                   01010000
                                                                        01020000
       FD   BP13KA10                                                    01030000
            RECORD CONTAINS  800 CHARACTERS.                            01040000
       COPY BP13KA10.                                                   01050000
                                                                        01060000
       FD   BP13KD45                                                    01070000
            RECORD CONTAINS 1550 CHARACTERS.                            01080000
       COPY BP13KD45.                                                   01090000
                                                                        01100000
       FD   BP13K625                                                    01110000
            RECORD CONTAINS 500  CHARACTERS.                            01120000
       COPY BP13K625.                                                   01130000
                                                                        01140000
       FD   BP13F315                                                    01150000
            BLOCK  CONTAINS 0    RECORDS                                01160000
            RECORD CONTAINS 500  CHARACTERS                             01170000
            LABEL  RECORDS  ARE  STANDARD                               01180000
            RECORDING MODE  IS   F.                                     01190000
       COPY BP13F315.                                                   01200000
                                                                        01210000
       FD   AG07F225                                                    01220000
            RECORDING MODE  IS  F                                       01230000
            RECORD CONTAINS 600 CHARACTERS.                             01240000
       COPY AG07F225.                                                   01250000
                                                                        01260000
      *---------------------------------------                          01270000
      * LISTING FOR STAMPING DOA FOR SOC FLAT                           01280000
      *---------------------------------------                          01290000
       FD   BP1343BJ                                                    01300000
            RECORD CONTAINS 132 CHARACTERS                              01310000
            LABEL  RECORDS  ARE OMITTED                                 01320000
            RECORDING MODE  IS  F.                                      01330000
       01   L43BJ-PRINT-REC          PIC X(132).                        01340000
                                                                        01350000
       FD   BP1343BK                                                    01360000
            RECORD CONTAINS 132 CHARACTERS                              01370000
            LABEL  RECORDS  ARE OMITTED                                 01380000
            RECORDING MODE  IS  F.                                      01390000
       01   L43BK-PRINT-REC          PIC X(132).                        01400000
                                                                        01410000
       FD   BP1343BL                                                    01420000
            RECORD CONTAINS 132 CHARACTERS                              01430000
            LABEL  RECORDS  ARE OMITTED                                 01440000
            RECORDING MODE  IS  F.                                      01450000
       01   L43BL-PRINT-REC          PIC X(132).                        01460000
                                                                        01470000
      *------------------------*                                        01480000
       WORKING-STORAGE SECTION.                                         01490000
      *------------------------*                                        01500000
      *-----------------------------------------------------------*     01510000
      *    DEFINE HEADING LINES                                   *     01520000
      *-----------------------------------------------------------*     01530000
       01  PRT-L43B-HDG-1.                                              01540000
           05  L43B-REPORT-ID       PIC X(8)  VALUE SPACES.             01550000
           05  FILLER               PIC X(10) VALUE '      HDB3'.       01560000
           05  FILLER               PIC X(27) VALUE SPACES.             01570000
           05  FILLER               PIC X(39) VALUE                     01580000
               'S Y S T E M   O F   C O M M I T M E N T'.               01590000
           05  FILLER               PIC X(14) VALUE SPACES.             01600000
           05  FILLER               PIC X(7)  VALUE 'DATE : '.          01610000
           05  L43B-CURRENT-DATE    PIC X(10) VALUE SPACES.             01620000
           05  FILLER               PIC X(4)  VALUE SPACES.             01630000
           05  FILLER               PIC X(7)  VALUE 'PAGE : '.          01640000
           05  L43B-PAGE            PIC ZZZZ9.                          01650000
                                                                        01660000
       01  PRT-L43B-HDG-2.                                              01670000
           05  FILLER               PIC X(30) VALUE                     01680000
               'HOUSING AND DEVELOPMENT BOARD'.                         01690000
           05  FILLER               PIC X(20) VALUE SPACES.             01700000
           05  FILLER               PIC X(30) VALUE                     01710000
               'P A Y M E N T    V O U C H E R'.                        01720000
           05  FILLER               PIC X(25) VALUE SPACES.             01730000
           05  L43B-COPY-NAME       PIC X(20) VALUE SPACES.             01740000
                                                                        01750000
       01  PRT-L43B-HDG-3.                                              01760000
           05  L43B-REPORT-ID-DESC  PIC X(132).                         01770000
                                                                        01780000
       01  PRT-L43BL-HDG-3.                                             01790000
           05  L43BL-REPORT-ID-DESC  PIC X(132).                        01800000
                                                                        01810000
       01  PRT-L43B-HDG-4.                                              01820000
           05  FILLER               PIC X(46) VALUE SPACES.             01830000
           05  FILLER               PIC X(85) VALUE ALL '-'.            01840000
                                                                        01850000
       01  PRT-L43B-HDG-5.                                              01860000
           05  FILLER               PIC X(46) VALUE                     01870000
               'SALES UNIT (AGREEMENT TEAM)'.                           01880000
           05  FILLER               PIC X(1)  VALUE '¦'.                01890000
           05  FILLER               PIC X(27) VALUE                     01900000
               ' FOR FINANCE DEPARTMENT USE'.                           01910000
           05  FILLER               PIC X(21) VALUE SPACES.             01920000
           05  FILLER               PIC X(17) VALUE                     01930000
               '¦  BATCH NO    : '.                                     01940000
           05  L43B-BATCH-NO        PIC X(14) VALUE SPACES.             01950000
           05  FILLER               PIC X(4)  VALUE SPACES.             01960000
           05  FILLER               PIC X(1)  VALUE '¦'.                01970000
                                                                        01980000
       01  PRT-L43B-HDG-6.                                              01990000
           05  FILLER               PIC X(46) VALUE SPACES.             02000000
           05  FILLER               PIC X(1)  VALUE '¦'.                02010000
           05  FILLER               PIC X(48) VALUE SPACES.             02020000
           05  FILLER               PIC X(1)  VALUE '¦'.                02030000
           05  FILLER               PIC X(34) VALUE SPACES.             02040000
           05  FILLER               PIC X(1)  VALUE '¦'.                02050000
                                                                        02060000
       01  PRT-L43B-HDG-7.                                              02070000
           05  FILLER               PIC X(46) VALUE 'SYSTEM CODE : 04'. 02080000
           05  FILLER               PIC X(14) VALUE '¦ CHECKED BY :'.   02090000
           05  FILLER               PIC X(35) VALUE SPACES.             02100000
           05  FILLER               PIC X(17) VALUE '¦  VOUCHER NO  :'. 02110000
           05  L43B-VOUCHER-NO      PIC X(14) VALUE SPACES.             02120000
           05  FILLER               PIC X(4)  VALUE SPACES.             02130000
           05  FILLER               PIC X(1)  VALUE '¦'.                02140000
                                                                        02150000
       01  PRT-L43B-HDG-8.                                              02160000
           05  FILLER               PIC X(46) VALUE                     02170000
              'GL CODE     : 0000000104250'.                            02180000
           05  FILLER               PIC X(85) VALUE ALL '-'.            02190000
                                                                        02200000
       01  PRT-L43B-HDG-9.                                              02210000
           05  FILLER               PIC X(46) VALUE                     02220000
              'DESCRIPTION : STAMP FEES'.                               02230000
                                                                        02240000
       01  PRT-L43BL-HDG-9.                                             02250000
           05  FILLER               PIC X(46) VALUE                     02260000
              'DESCRIPTION : LEASE PREPARATION FEES'.                   02270000
                                                                        02280000
       01  PRT-L43B-HDG-10.                                             02290000
           05  FILLER               PIC X(53)   VALUE                   02300000
              'PAYABLE TO  : COMMISSIONER OF STAMP DUTIES         '.    02310000
           05  FILLER               PIC X(13)   VALUE  SPACES.          02320000
           05  FILLER               PIC X(20)   VALUE                   02330000
              'BANK   : DBS        '.                                   02340000
           05  FILLER               PIC X(11)   VALUE  SPACES.          02350000
           05  FILLER               PIC X(25)   VALUE                   02360000
              'BANK CODE   : DBSSSGSGXXX'.                              02370000
                                                                        02380000
       01  PRT-L43BL-HDG-10.                                            02390000
           05  FILLER               PIC X(14)   VALUE  'PAYABLE TO  : '.02400000
           05  PRT-SOL-NAME         PIC X(66)   VALUE  SPACES.          02410000
           05  FILLER               PIC X(52)   VALUE  SPACES.          02420000
                                                                        02430000
       01  PRT-L43B-HDG-10A.                                            02440000
           05  FILLER               PIC X(24)   VALUE                   02450000
              'A/C NO      : 0010468600'.                               02460000
           05  FILLER               PIC X(42)   VALUE  SPACES.          02470000
                                                                        02480000
       01  PRT-L43B-HDG-11.                                             02490000
           05  FILLER               PIC X(11)   VALUE                   02500000
               'REMITTANCE '.                                           02510000
           05  FILLER               PIC X(55)   VALUE                   02520000
              'ADVICE  DESPATCH TO :  C/O SC(STAMPING) OF SALES UNIT'.  02530000
                                                                        02540000
       01  PRT-L43BL-HDG-11.                                            02550000
           05  FILLER               PIC X(7)   VALUE                    02560000
               'CHEQUE '.                                               02570000
           05  FILLER               PIC X(55)   VALUE                   02580000
              'DESPATCH TO :  C/O MR BALA(STAMPING) OF SALES OPERATION'.02590000
           05  FILLER               PIC X(55)   VALUE SPACES.           02600000
           05  FILLER               PIC X(15)   VALUE 'TEL : 64903781'. 02610000
                                                                        02620000
      *-----------------------------------------------------------*     02630000
      *    DEFINE BP13L43BA & BP13L43BD SUB-HEADING LINES         *     02640000
      *-----------------------------------------------------------*     02650000
       01  PRT-L43B-SUBHDG-1.                                           02660000
           05  FILLER               PIC X(69) VALUE SPACES.             02670000
           05  FILLER               PIC X(19) VALUE                     02680000
               'DATE OF    MORTGAGE'.                                   02690000
           05  FILLER               PIC X(4)  VALUE SPACES.             02700000
           05  FILLER               PIC X(7)  VALUE 'DUP'.              02710000
           05  L43B-SUP-LEASE-DESC  PIC X(10) VALUE SPACES.             02720000
           05  FILLER               PIC X(2)  VALUE SPACES.             02730000
                                                                        02740000
       01  PRT-L43BL-SUBHDG-1.                                          02750000
           05  FILLER               PIC X(89) VALUE SPACES.             02760000
           05  FILLER               PIC X(23) VALUE                     02770000
               'DATE OF        LEASE   '.                               02780000
                                                                        02790000
       01  PRT-L43BL-SUBHDG-1A.                                         02800000
           05  FILLER               PIC X(22) VALUE SPACES.             02810000
           05  FILLER               PIC X(17) VALUE 'ATRIUM 4TH STOREY'.02820000
           05  FILLER               PIC X(17) VALUE ' SINGAPORE 310480'.02830000
                                                                        02840000
       01  PRT-L43B-SUBHDG-2.                                           02850000
           05  FILLER               PIC X(4)  VALUE 'S/NO'.             02860000
           05  FILLER               PIC X     VALUE SPACE.              02870000
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.       02880000
           05  FILLER               PIC X(5)  VALUE SPACES.             02890000
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.          02900000
           05  FILLER               PIC X     VALUE SPACE.              02910000
           05  FILLER               PIC X(5)  VALUE 'BLOCK'.            02920000
           05  FILLER               PIC X     VALUE SPACE.              02930000
           05  FILLER               PIC X(25) VALUE                     02940000
               'FLAT ADDRESS/STREET NAME'.                              02950000
           05  FILLER               PIC X(1)  VALUE SPACE.              02960000
           05  FILLER               PIC X(8)  VALUE 'FLAT NO'.          02970000
           05  FILLER               PIC X(9)  VALUE '  S&P    '.        02980000
           05  FILLER               PIC X(2)  VALUE SPACES.             02990000
           05  FILLER               PIC X(9)  VALUE 'STAMP FEE'.        03000000
           05  FILLER               PIC X(3)  VALUE SPACES.             03010000
           05  FILLER               PIC X(3)  VALUE 'DOA'.              03020000
           05  FILLER               PIC X(4)  VALUE SPACES.             03030000
           05  FILLER               PIC X(9)  VALUE 'STAMP FEE'.        03040000
           05  FILLER               PIC X(5)  VALUE SPACES.             03050000
           05  L43B-TAG-DESC        PIC X(3)  VALUE '   '.              03060000
           05  FILLER               PIC X(6)  VALUE SPACES.             03070000
           05  FILLER               PIC X(5)  VALUE 'TOTAL'.            03080000
                                                                        03090000
       01  PRT-L43BL-SUBHDG-2.                                          03100000
           05  FILLER               PIC X(4)  VALUE 'S/NO'.             03110000
           05  FILLER               PIC X(5)  VALUE SPACE.              03120000
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.       03130000
           05  FILLER               PIC X(9)  VALUE SPACES.             03140000
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.          03150000
           05  FILLER               PIC X(4)  VALUE SPACE.              03160000
           05  FILLER               PIC X(5)  VALUE 'BLOCK'.            03170000
           05  FILLER               PIC X(3)  VALUE SPACE.              03180000
           05  FILLER               PIC X(25) VALUE                     03190000
               'FLAT ADDRESS/STREET NAME'.                              03200000
           05  FILLER               PIC X(5)  VALUE SPACE.              03210000
           05  FILLER               PIC X(8)  VALUE 'FLAT NO'.          03220000
           05  FILLER               PIC X(12) VALUE '     S&P    '.     03230000
           05  FILLER               PIC X(6)  VALUE SPACES.             03240000
           05  FILLER               PIC X(9)  VALUE 'STAMP FEE'.        03250000
           05  FILLER               PIC X(13) VALUE SPACES.             03260000
           05  FILLER               PIC X(5)  VALUE 'TOTAL'.            03270000
                                                                        03280000
       01  PRT-L43B-SUBHDG-3.                                           03290000
           05  FILLER               PIC X(4)  VALUE ALL '-'.            03300000
           05  FILLER               PIC X     VALUE SPACES.             03310000
           05  FILLER               PIC X(14) VALUE ALL '-'.            03320000
           05  FILLER               PIC X     VALUE SPACES.             03330000
           05  FILLER               PIC X(8)  VALUE ALL '-'.            03340000
           05  FILLER               PIC X     VALUE SPACES.             03350000
           05  FILLER               PIC X(5)  VALUE ALL '-'.            03360000
           05  FILLER               PIC X     VALUE SPACES.             03370000
           05  FILLER               PIC X(25) VALUE ALL '-'.            03380000
           05  FILLER               PIC X(1)  VALUE SPACES.             03390000
           05  FILLER               PIC X(7)  VALUE ALL '-'.            03400000
           05  FILLER               PIC X(1)  VALUE SPACES.             03410000
           05  FILLER               PIC X(9)  VALUE ALL '-'.            03420000
           05  FILLER               PIC X(2)  VALUE SPACES.             03430000
           05  FILLER               PIC X(10) VALUE ALL '-'.            03440000
           05  FILLER               PIC X(2)  VALUE SPACES.             03450000
           05  FILLER               PIC X(5)  VALUE ALL '-'.            03460000
           05  FILLER               PIC X(2)  VALUE SPACES.             03470000
           05  FILLER               PIC X(10) VALUE ALL '-'.            03480000
           05  FILLER               PIC X(2)  VALUE SPACES.             03490000
           05  FILLER               PIC X(2)  VALUE SPACES.             03500000
           05  FILLER               PIC X(14) VALUE ALL '-'.            03510000
                                                                        03520000
       01  PRT-L43BL-SUBHDG-3.                                          03530000
           05  FILLER               PIC X(4)  VALUE ALL '-'.            03540000
           05  FILLER               PIC X(4)  VALUE SPACES.             03550000
           05  FILLER               PIC X(14) VALUE ALL '-'.            03560000
           05  FILLER               PIC X(6)  VALUE SPACES.             03570000
           05  FILLER               PIC X(8)  VALUE ALL '-'.            03580000
           05  FILLER               PIC X(4)  VALUE SPACES.             03590000
           05  FILLER               PIC X(5)  VALUE ALL '-'.            03600000
           05  FILLER               PIC X(3)  VALUE SPACES.             03610000
           05  FILLER               PIC X(25) VALUE ALL '-'.            03620000
           05  FILLER               PIC X(5)  VALUE SPACES.             03630000
           05  FILLER               PIC X(7)  VALUE ALL '-'.            03640000
           05  FILLER               PIC X(3)  VALUE SPACES.             03650000
           05  FILLER               PIC X(9)  VALUE ALL '-'.            03660000
           05  FILLER               PIC X(7)  VALUE SPACES.             03670000
           05  FILLER               PIC X(10) VALUE ALL '-'.            03680000
           05  FILLER               PIC X(3)  VALUE SPACES.             03690000
           05  FILLER               PIC X(14) VALUE ALL '-'.            03700000
                                                                        03710000
      *-----------------------------------------------------------*     03720000
      *    DEFINE BP13L43BA & BP13L43BD DETAIL LINES              *     03730000
      *-----------------------------------------------------------*     03740000
       01  L43B-REC-DETAIL.                                             03750000
           05  L43B-SERIAL-NO               PIC ZZZ9.                   03760000
           05  FILLER                       PIC X     VALUE SPACE.      03770000
           05  L43B-SCH-ACC                 PIC X(14) VALUE SPACES.     03780000
           05  FILLER                       PIC X     VALUE SPACE.      03790000
           05  L43B-REGN-NO                 PIC X(8)  VALUE SPACES.     03800000
           05  FILLER                       PIC X     VALUE SPACE.      03810000
           05  L43B-BLKNO                   PIC X(5)  VALUE SPACES.     03820000
           05  FILLER                       PIC X     VALUE SPACE.      03830000
           05  L43B-STREET                  PIC X(25) VALUE SPACES.     03840000
           05  FILLER                       PIC X     VALUE SPACE.      03850000
           05  L43B-FLATNO                  PIC X(7)  VALUE SPACES.     03860000
           05  FILLER                       PIC X     VALUE SPACE.      03870000
           05  L43B-SALE-DD                 PIC X(2)  VALUE SPACES.     03880000
           05  L43B-DASH1                   PIC X     VALUE SPACE.      03890000
           05  L43B-SALE-MM                 PIC X(2)  VALUE SPACES.     03900000
           05  L43B-DASH2                   PIC X     VALUE SPACE.      03910000
           05  L43B-SALE-CC                 PIC X(2)  VALUE SPACES.     03920000
           05  L43B-SALE-YY                 PIC X(2)  VALUE SPACES.     03930000
           05  FILLER                       PIC X(1)  VALUE SPACES.     03940000
           05  L43B-MORT-SF                 PIC $$$,$$9.99.             03950000
           05  FILLER                       PIC X(2)  VALUE SPACES.     03960000
           05  L43B-DUP-DOA                 PIC $9.99.                  03970000
           05  FILLER                       PIC X(2)  VALUE SPACES.     03980000
           05  L43B-SUP-LEASE-STAMP         PIC $$$,$$9.99.             03990000
           05  FILLER                       PIC X(2)  VALUE SPACES.     04000000
           05  FILLER                       PIC X(2)  VALUE SPACES.     04010000
           05  L43B-TAG                     PIC X.                      04020000
           05  FILLER                       PIC X(2)  VALUE SPACES.     04030000
           05  L43B-DETL-AMT-TOTAL          PIC $$$$,$$9.99.            04040000
                                                                        04050000
       01  L43BL-REC-DETAIL.                                            04060000
           05  L43BL-SERIAL-NO               PIC ZZZ9.                  04070000
           05  FILLER                        PIC X(4)  VALUE SPACE.     04080000
           05  L43BL-SCH-ACC                 PIC X(14) VALUE SPACES.    04090000
           05  FILLER                        PIC X(6)  VALUE SPACE.     04100000
           05  L43BL-REGN-NO                 PIC X(8)  VALUE SPACES.    04110000
           05  FILLER                        PIC X(4)  VALUE SPACE.     04120000
           05  L43BL-BLKNO                   PIC X(5)  VALUE SPACES.    04130000
           05  FILLER                        PIC X(3)  VALUE SPACE.     04140000
           05  L43BL-STREET                  PIC X(25) VALUE SPACES.    04150000
           05  FILLER                        PIC X(5)  VALUE SPACE.     04160000
           05  L43BL-FLATNO                  PIC X(7)  VALUE SPACES.    04170000
           05  FILLER                        PIC X(3)  VALUE SPACE.     04180000
           05  L43BL-SALE-DD                 PIC X(2)  VALUE SPACES.    04190000
           05  L43BL-DASH1                   PIC X     VALUE SPACE.     04200000
           05  L43BL-SALE-MM                 PIC X(2)  VALUE SPACES.    04210000
           05  L43BL-DASH2                   PIC X     VALUE SPACE.     04220000
           05  L43BL-SALE-CC                 PIC X(2)  VALUE SPACES.    04230000
           05  L43BL-SALE-YY                 PIC X(2)  VALUE SPACES.    04240000
           05  FILLER                        PIC X(3)  VALUE SPACES.    04250000
           05  L43BL-LEASE-STAMP             PIC $$$,$$9.99.            04260000
           05  FILLER                        PIC X(6)  VALUE SPACES.    04270000
           05  FILLER                        PIC X(3)  VALUE SPACES.    04280000
           05  L43BL-DETL-AMT-TOTAL          PIC $$$$,$$9.99.           04290000
                                                                        04300000
      *-----------------------------------------------------------*     04310000
      *    DEFINE BP13L43BA & BP13L43BD TOTAL LINES               *     04320000
      *-----------------------------------------------------------*     04330000
       01  PRT-L43B-DASH-LINE.                                          04340000
           05  FILLER                       PIC X(78)   VALUE SPACES.   04350000
           05  FILLER                       PIC X(54)   VALUE ALL '='.  04360000
                                                                        04370000
       01  PRT-L43B-TOTAL-LINE.                                         04380000
           05  FILLER                       PIC X(35) VALUE SPACES.     04390000
           05  FILLER                       PIC X(13) VALUE             04400000
               'SERIAL NO : ('.                                         04410000
           05  L43B-VR-NO-LOW               PIC X(4)  VALUE '0001'.     04420000
           05  FILLER                       PIC X(4)  VALUE ' TO '.     04430000
           05  L43B-VR-NO-HIGH              PIC X(4)  VALUE '0025'.     04440000
           05  FILLER                       PIC X(4)  VALUE ')'.        04450000
           05  FILLER                       PIC X(14) VALUE 'TOTAL :'.  04460000
           05  L43B-TOTAL-MORT-SF           PIC $,$$$,$$9.99.           04470000
           05  FILLER                       PIC X(1)  VALUE SPACES.     04480000
           05  L43B-TOTAL-DUP-DOA           PIC $$9.99.                 04490000
           05  L43B-TOTAL-SUP-LEASE-SF      PIC $,$$$,$$9.99.           04500000
           05  FILLER                       PIC X(2)  VALUE SPACES.     04510000
           05  FILLER                       PIC X(4)  VALUE SPACES.     04520000
           05  L43B-TOTAL-AMT               PIC $,$$$,$$9.99.           04530000
                                                                        04540000
       01  PRT-L43BL-TOTAL-LINE.                                        04550000
           05  FILLER                       PIC X(35) VALUE SPACES.     04560000
           05  FILLER                       PIC X(13) VALUE             04570000
               'SERIAL NO : ('.                                         04580000
           05  L43BL-VR-NO-LOW               PIC X(4)  VALUE '0001'.    04590000
           05  FILLER                       PIC X(4)  VALUE ' TO '.     04600000
           05  L43BL-VR-NO-HIGH              PIC X(4)  VALUE '0025'.    04610000
           05  FILLER                       PIC X(4)  VALUE ')'.        04620000
           05  FILLER                       PIC X(14) VALUE 'TOTAL :'.  04630000
           05  FILLER                       PIC X(21) VALUE SPACES.     04640000
           05  L43BL-TOTAL-SUP-LEASE-SF      PIC $,$$$,$$9.99.          04650000
           05  FILLER                       PIC X(4)  VALUE SPACES.     04660000
           05  FILLER                       PIC X(4)  VALUE SPACES.     04670000
           05  L43BL-TOTAL-AMT              PIC $,$$$,$$9.99.           04680000
                                                                        04690000
      *-----------------------------------------------------------*     04700000
      *    DEFINE FOOTING LINES                                   *     04710000
      *-----------------------------------------------------------*     04720000
       01  PRT-L43B-FTG-1.                                              04730000
           05  FILLER              PIC X(15)   VALUE 'NET PAYABLE  : '. 04740000
           05  L43B-AMT-WORDS.                                          04750000
               10  L43B-AMT-DESC1  PIC X(60)   VALUE SPACES.            04760000
               10  L43B-AMT-DESC2  PIC X(60)   VALUE SPACES.            04770000
                                                                        04780000
       01  PRT-L43B-FTG-2.                                              04790000
           05  FILLER              PIC X(35)   VALUE SPACES.            04800000
           05  FILLER              PIC X(14)   VALUE 'CHECKED BY :'.    04810000
           05  FILLER              PIC X(15)   VALUE ALL '_'.           04820000
           05  FILLER              PIC X(10)   VALUE SPACES.            04830000
           05  FILLER              PIC X(16)   VALUE 'CERTIFIED BY :'.  04840000
           05  FILLER              PIC X(15)   VALUE ALL '_'.           04850000
                                                                        04860000
      *-----------------------------------------------------------*     04870000
      *    DEFINE BP13L43B  HEADING LINES                         *     04880000
      *-----------------------------------------------------------*     04890000
       01  MAIN-HEADER.                                                 04900000
           05  HEADER-LISTID             PIC X(8)  VALUE SPACES.        04910000
           05  FILLER                    PIC X(16) VALUE SPACES.        04920000
           05  FILLER                    PIC X(4)  VALUE 'HDB3'.        04930000
           05  FILLER                    PIC X(16) VALUE SPACES.        04940000
           05  FILLER                    PIC X(39) VALUE                04950000
               'S Y S T E M   O F   C O M M I T M E N T'.               04960000
           05  FILLER                    PIC X(16) VALUE SPACES.        04970000
           05  FILLER                    PIC X(7)  VALUE 'DATE : '.     04980000
           05  HEADER-DATE               PIC X(10).                     04990000
           05  FILLER                    PIC X(4)  VALUE SPACES.        05000000
           05  FILLER                    PIC X(7)  VALUE 'PAGE : '.     05010000
           05  HEADER-PAGE               PIC ZZZZ9.                     05020000
                                                                        05030000
      *-----------------------------------------------------------*     05040000
      *    DEFINE BP1343BK REPORT LINES                           *     05050000
      *-----------------------------------------------------------*     05060000
       01  L43BK-HEADER2.                                               05070000
           05  FILLER                    PIC X(47) VALUE SPACES.        05080000
           05  FILLER                    PIC X(35)  VALUE               05090000
               'REPORT ON CASES WITH EARMARK ERROR'.                    05100000
                                                                        05110000
       01  L43BK-HEADER3.                                               05120000
           05  FILLER               PIC X(4)  VALUE 'S/NO'.             05130000
           05  FILLER               PIC X(3)  VALUE SPACE.              05140000
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.       05150000
           05  FILLER               PIC X(9)  VALUE SPACES.             05160000
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.          05170000
           05  FILLER               PIC X(5)  VALUE SPACE.              05180000
           05  FILLER               PIC X(13) VALUE 'JR VOUCHER NO'.    05190000
           05  FILLER               PIC X(5)  VALUE SPACES.             05200000
           05  FILLER               PIC X(12) VALUE 'TOTAL AMOUNT'.     05210000
           05  FILLER               PIC X(4)  VALUE SPACES.             05220000
           05  FILLER               PIC X(17) VALUE 'ERROR DESCRIPTION'.05230000
                                                                        05240000
       01  L43BK-REC-DETAIL.                                            05250000
           05  L43BK-SERIAL-NO              PIC ZZZ9.                   05260000
           05  FILLER                       PIC X(3)  VALUE SPACE.      05270000
           05  L43BK-SCH-ACC                PIC X(14) VALUE SPACES.     05280000
           05  FILLER                       PIC X(5)  VALUE SPACE.      05290000
           05  L43BK-REGN-NO                PIC X(8)  VALUE SPACES.     05300000
           05  FILLER                       PIC X(5)  VALUE SPACE.      05310000
           05  L43BK-JR-VCHR-NO             PIC X(13) VALUE SPACES.     05320000
           05  FILLER                       PIC X(5)  VALUE SPACES.     05330000
           05  L43BK-AMT-TOTAL              PIC $$$$,$$9.99.            05340000
           05  FILLER                       PIC X(5)  VALUE SPACES.     05350000
           05  L43BK-ERROR-DESC             PIC X(30).                  05360000
                                                                        05370000
       01  L43BK-UNDERLINE                  PIC X(132) VALUE ALL '-'.   05380000
                                                                        05390000
      *-----------------------------------------------------------*     05400000
      *    DEFINE ERROR MESSAGE FORMAT                            *     05410000
      *-----------------------------------------------------------*     05420000
       01  WS-ERRMSG-HEADER.                                            05430000
           05  FILLER                       PIC X(46) VALUE             05440000
               ' *************   ERROR MESSAGE   *************'.        05450000
                                                                        05460000
       01  WS-ERROR.                                                    05470000
           05  FILLER                       PIC X(24) VALUE             05480000
               ' ERROR ENCOUNTERED WHEN '.                              05490000
           05  WS-CUR-PROC                  PIC X(21).                  05500000
                                                                        05510000
       01  WS-FILE-STATUS.                                              05520000
           05  FILLER                       PIC X(15) VALUE             05530000
               ' STATUS CODE = '.                                       05540000
           05  WS-CUR-STATUS                PIC X(2).                   05550000
                                                                        05560000
      *-----------------------------------------------------------*     05570000
      *    DEFINE SUMMARY FORMAT                                  *     05580000
      *-----------------------------------------------------------*     05590000
       01  WS-SUMMARY-HEADER.                                           05600000
           05  FILLER                       PIC X     VALUE SPACES.     05610000
           05  FILLER                       PIC X(16) VALUE ALL '*'.    05620000
           05  FILLER                       PIC X(20) VALUE             05630000
               'BP13C43B SUMMARY RPT'.                                  05640000
           05  FILLER                       PIC X(19) VALUE ALL '*'.    05650000
                                                                        05660000
       01  WS-READ-CASES.                                               05670000
           05  FILLER                       PIC X(52) VALUE             05680000
               ' NO OF RECORDS READ FROM TRANS FILE  (BP13F315) = '.    05690000
           05  WS-EDIT-BP13F315-READ        PIC ZZZ9.                   05700000
                                                                        05710000
       01  WS-DOA-PAYMENT-PRINTED.                                      05720000
           05  FILLER                       PIC X(52) VALUE             05730000
               ' NO OF DOA PAYMENTS   (BP13L43BA)               = '.    05740000
           05  WS-EDIT-L43BA-PRINT          PIC ZZZ9.                   05750000
                                                                        05760000
       01  WS-L43BJ-PRINTED.                                            05770000
           05  FILLER                       PIC X(52) VALUE             05780000
               ' NO OF                (BP13L43BJ)               = '.    05790000
           05  WS-EDIT-L43BJ-PRINT          PIC ZZZ9.                   05800000
                                                                        05810000
       01  WS-STAMP-FEES-REC-WRITTEN.                                   05820000
           05  FILLER                       PIC X(52) VALUE             05830000
               ' NO OF RECORDS WRITTEN TO STAMP FILE (AG07F225) = '.    05840000
           05  WS-EDIT-AG07F225-WRITE       PIC ZZZ9.                   05850000
                                                                        05860000
       01  WS-SUMMARY-TRAILER.                                          05870000
           05  FILLER                       PIC X     VALUE SPACES.     05880000
           05  FILLER                       PIC X(55) VALUE ALL '*'.    05890000
                                                                        05900000
      *-----------------------------------------------------------*     05910000
      *    CONSTANTS LIST                                         *     05920000
      *-----------------------------------------------------------*     05930000
       01  WS-ERROR-PROCEDURE-NAMES.                                    05940000
           05  CLOSE-K006                   PIC X(21) VALUE             05950000
                   'CLOSING FILE  B05K006'.                             05960000
           05  CLOSE-KD45                   PIC X(21) VALUE             05970000
                   'CLOSING FILE BP13KD45'.                             05980000
           05  CLOSE-K625                   PIC X(21) VALUE             05990000
                   'CLOSING FILE BP13K625'.                             06000000
           05  NOTFND-IN-FIS                PIC X(23) VALUE             06010000
                   'REC NOT FOUND IN K315'.                             06020000
           05  NOTFND-IN-MST                PIC X(23) VALUE             06030000
                   'REC NOT FOUND IN K006'.                             06040000
           05  OPEN-K006                    PIC X(21) VALUE             06050000
                   'OPENING FILE  B05K006'.                             06060000
           05  OPEN-K410                    PIC X(21) VALUE             06070000
                   'OPENING FILE BP13K410'.                             06080000
           05  OPEN-KD03                    PIC X(21) VALUE             06090000
                   'OPENING FILE BP13KD03'.                             06100000
           05  OPEN-KA10                    PIC X(21) VALUE             06110000
                   'OPENING FILE BP13KA10'.                             06120000
           05  OPEN-KD45                    PIC X(21) VALUE             06130000
                   'OPENING FILE BP13KD45'.                             06140000
           05  OPEN-K625                    PIC X(21) VALUE             06150000
                   'OPENING FILE BP13K625'.                             06160000
           05  READ-F315                    PIC X(21) VALUE             06170000
                   'READING FILE BP13F315'.                             06180000
           05  WRITE-K625                   PIC X(21) VALUE             06190000
                   'WRITING FILE BP13K625'.                             06200000
           05  READ-K006                    PIC X(21) VALUE             06210000
                   'READING FILE  B05K006'.                             06220000
           05  READ-KD45                    PIC X(21) VALUE             06230000
                   'READING FILE BP13KD45'.                             06240000
           05  READ-K625                    PIC X(21) VALUE             06250000
                   'READING FILE BP13K625'.                             06260000
           05  START-KD45                   PIC X(21) VALUE             06270000
                   'STARTBR FILE BP13KD45'.                             06280000
                                                                        06290000
       01  DUP-DOA-AMT                      PIC 9V99  VALUE 0.          06300000
       01  DUP-SA-AMT                       PIC 9V99  VALUE 0.          06310000
       01  HYPHEN                           PIC X     VALUE '-'.        06320000
       01  MAX-REC-PER-PAGE                 PIC 9(2)  VALUE 39.         06330000
       01  MAX-DETLS-PER-PAGE               PIC 9(3)  VALUE 25.         06340000
                                                                        06350000
      *-----------------------------------------------------------*     06360000
      *    LEVEL-88 VARIABLES                                     *     06370000
      *-----------------------------------------------------------*     06380000
       01  WS-EOF                           PIC X     VALUE 'N'.        06390000
           88  END-OF-BP13F315                        VALUE 'Y'.        06400000
       01  WS-REPORT-ID-SW                  PIC X(1)  VALUE SPACE.      06410000
       01  WS-PREV-REPORT-ID                PIC X(1)  VALUE SPACE.      06420000
           88  REPORT-L43BJ                           VALUE 'J'.        06430000
                                                                        06440000
      *-----------------------------------------------------------*     06450000
      *    OTHER VARIABLES                                        *     06460000
      *-----------------------------------------------------------*     06470000
       01  WS-COUNTERS.                                                 06480000
           05  WS-AG07-STATUS               PIC 9(2)    VALUE ZEROS.    06490000
           05  WS-AG07-STAT-X REDEFINES WS-AG07-STATUS PIC X(2).        06500000
           05  WS-BP13F315-READ-CNT         PIC 9(4)    VALUE ZEROS.    06510000
           05  WS-BP13K625-WRITE-CNT        PIC 9(4)    VALUE ZEROES.   06520000
           05  WS-AG07F225-WRITE-CNT        PIC 9(4)    VALUE ZEROES.   06530000
      *    -----------------------                                      06540000
      *    FOR L43BJ -     LISTING                                      06550000
      *    -----------------------                                      06560000
           05  WS-L43BJ-PRINT-CNT           PIC 9(4)    VALUE ZEROS.    06570000
           05  WS-L43BJ-PAGE-CNT            PIC 9(5)    VALUE ZEROS.    06580000
           05  WS-L43BJ-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.       06590000
           05  WS-L43BJ-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.    06600000
           05  WS-L43BJ-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.    06610000
           05  WS-L43BJ-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.    06620000
           05  WS-L43BJ-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.    06630000
                                                                        06640000
      *    -----------------------                                      06650000
      *    FOR L43BL -     LISTING                                      06660000
      *    -----------------------                                      06670000
           05  WS-L43BL-PRINT-CNT           PIC 9(4)    VALUE ZEROS.    06680000
           05  WS-L43BL-PAGE-CNT            PIC 9(5)    VALUE ZEROS.    06690000
           05  WS-L43BL-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.       06700000
           05  WS-L43BL-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.    06710000
           05  WS-L43BL-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.    06720000
                                                                        06730000
      *    --------------------------                                   06740000
      *    FOR L43BK - ERROR LISTING                                    06750000
      *    --------------------------                                   06760000
           05  WS-L43BK-PRINT-CNT           PIC 9(4)    VALUE ZEROS.    06770000
           05  WS-L43BK-PAGE-CNT            PIC 9(5)    VALUE ZEROS.    06780000
           05  WS-L43BK-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.       06790000
                                                                        06800000
       01  WS-FLATNO.                                                   06810000
           05  WS-NUM-LEVEL                 PIC X(2).                   06820000
           05  FILLER                       PIC X       VALUE '-'.      06830000
           05  WS-NUM-MAIN                  PIC X(5).                   06840000
                                                                        06850000
       01  WS-SCH-ACC.                                                  06860000
           05  WS-SCH                       PIC X(4).                   06870000
           05  WS-SCH-SEP1                  PIC X.                      06880000
           05  WS-ACC                       PIC X(4).                   06890000
           05  WS-SCH-SEP2                  PIC X.                      06900000
           05  WS-CHK                       PIC X.                      06910000
           05  WS-SCH-SEP3                  PIC X.                      06920000
           05  WS-LESCDE                    PIC X(2).                   06930000
                                                                        06940000
       01  WS-F315-ACC-CHK.                                             06950000
           05  WS-F315-ACC                  PIC X(4).                   06960000
           05  WS-F315-CHK                  PIC X(1).                   06970000
                                                                        06980000
       01  WS-AO-DATE.                                                  06990000
           05  WS-AO-CC                     PIC X(2).                   07000000
           05  WS-AO-YY                     PIC X(2).                   07010000
           05  WS-AO-MM                     PIC X(2).                   07020000
           05  WS-AO-DD                     PIC X(2).                   07030000
                                                                        07040000
       01  WS-SALE-DATE.                                                07050000
           05  WS-SALE-CC                   PIC X(2).                   07060000
           05  WS-SALE-YY                   PIC X(2).                   07070000
           05  WS-SALE-MM                   PIC X(2).                   07080000
           05  WS-SALE-DD                   PIC X(2).                   07090000
                                                                        07100000
       01  WS-TEMPORARY-BUFFER.                                         07110000
           05  WS-TEMP-TOTAL                PIC 9(7)V99.                07120000
           05  WS-TEMP-DIFF                 PIC 9(7)V99.                07130000
                                                                        07140000
       01  WS-BLANK-LINE                    PIC X     VALUE SPACES.     07150000
       01  WS-F315-STATUS                   PIC 9(2)  VALUE ZEROS.      07160000
       01  WS-K006-STATUS                   PIC 9(2)  VALUE ZEROS.      07170000
       01  WS-K410-STATUS                   PIC 9(2)  VALUE ZEROS.      07180000
       01  WS-KD03-STATUS                   PIC 9(2)  VALUE ZEROS.      07190000
       01  WS-KA10-STATUS                   PIC 9(2)  VALUE ZEROS.      07200000
       01  WS-KD45-STATUS                   PIC 9(2)  VALUE ZEROS.      07210000
       01  WS-K625-STATUS                   PIC 9(2)  VALUE ZEROS.      07220000
       01  WS-K625-EOF                      PIC X(1)  VALUE 'N'.        07230000
       01  WS-KD45-EOF                      PIC X(1)  VALUE 'N'.        07240000
       01  WS-LEASE-SF                      PIC S9(5)V99.               07250000
       01  WS-LEASE-STAMP                   PIC S9(5)V99 VALUE ZEROS.   07260000
       01  WS-MORT-SF                       PIC S9(5)V99.               07270000
       01  WS-MORT-SF2                      PIC S9(5)V99 VALUE ZEROES.  07280000
       01  WS-SUP-SF                        PIC S9(5)V99.               07290000
       01  WS-DUP-DOA                       PIC 9(2)V99.                07300000
       01  WS-ANNUAL-RENT                   PIC 9(7)V99.                07310000
       01  WS-LOAN-GRANTED                  PIC 9(7)V99.                07320000
       01  WS-SELL-PRICE                    PIC 9(8)  VALUE ZEROES.     07330000
       01  WS-LEASE-AMT                     PIC 9(10)V99 VALUE ZEROES.  07340000
       01  WS-NUM-HDB-REF                   PIC X(11) VALUE SPACES.     07350000
       01  WS-NUM-DOC                       PIC X(3)  VALUE SPACES.     07360000
       01  WS-NUM-DOC-TYP                   PIC X(1)  VALUE SPACES.     07370000
       01  WS-NUM-DOC-CNT                   PIC 9(1)  VALUE ZEROES.     07380000
       01  WS-AMT-STAMP-DUTY                PIC 9(13)V99 VALUE ZEROES.  07390000
       01  WS-AMT-STAMP-DUTY-DUP            PIC 9(13)V99 VALUE ZEROES.  07400000
       01  WS-AMT-EARMARK                   PIC 9(10)V99 VALUE ZEROES.  07410000
       01  WS-EM-LEASE-STAMP                PIC S9(5)V99 VALUE ZEROS.   07420000
       01  WS-EM-MORT-SF                    PIC S9(5)V99 VALUE ZEROS.   07430000
       01  WS-EM-SUP-SF                     PIC S9(5)V99 VALUE ZEROS.   07440000
       01  WS-EM-DUP-DOA                    PIC 9(2)V99  VALUE ZEROS.   07450000
       01  WS-STAFF-START                   PIC X(9) VALUE '29586H   '. 07460000
                                                                        07470000
      *----------------------------------------------------------*      07480000
      *    WS VARIABLES USED BY F220                             *      07490000
      *----------------------------------------------------------*      07500000
       01  WS-NEW-VOUCHER                   PIC X      VALUE 'Y'.       07510000
       01  WS-NEW-BATCH                     PIC X      VALUE 'Y'.       07520000
       01  WS-NEW-HEADER                    PIC X      VALUE 'Y'.       07530000
       01  WS-DTE-SALE-AGRM                 PIC X(08)  VALUE SPACES.    07540000
       01  WS-NUM-VOUCHER                   PIC X(11)  VALUE SPACES.    07550000
       01  WS-NUM-BATCH-TYPE                PIC X(4)   VALUE SPACES.    07560000
       01  WS-NUM-FIN-YEAR                  PIC 9(4)   VALUE ZEROES.    07570000
       01  WS-NUM-BATCH-SERIAL              PIC 9(5)   VALUE ZEROES.    07580000
       01  WS-SCH-ACCT-NO                   PIC X(11)  VALUE SPACES.    07590000
       01  WS-SCH-ACCT-NO2                  PIC X(11)  VALUE SPACES.    07600000
       01  WS-TXT-INFO                      PIC X(50)  VALUE SPACES.    07610000
       01  WS-NME-FIN-SOLICITOR             PIC X(50)  VALUE SPACES.    07620000
       01  WS-CNT-DETAILS                   PIC 9(4)   VALUE ZEROES.    07630000
       01  WS-AMT-TRANS                     PIC 9(7)V99 VALUE ZEROES.   07640000
       01  WS-AMT-TOTAL                     PIC 9(7)V99 VALUE ZEROES.   07650000
       01  WS-PREV-SA-TP-TAG                PIC X(1)   VALUE SPACE.     07660000
       01  WS-PREV-PROJ-CODE                PIC X(3)   VALUE SPACE.     07670000
       01  WS-EDITED-VOUCHER-NO.                                        07680000
           05  WS-EDITED-NUM-DDD            PIC X(3)   VALUE SPACES.    07690000
           05  FILLER                       PIC X(1)   VALUE '-'.       07700000
           05  WS-EDITED-NUM-FIN-YEAR       PIC X(2)   VALUE SPACES.    07710000
           05  FILLER                       PIC X(1)   VALUE '-'.       07720000
           05  WS-EDITED-NUM-VR-SERIAL      PIC X(6)   VALUE SPACES.    07730000
       01  WS-L43BJ-DESC.                                               07740000
           05  FILLER                       PIC X(38)  VALUE SPACES.    07750000
           05  FILLER                       PIC X(42)  VALUE            07760000
              'S&P AGREEMENT AND DEED OF ASSIGNMENT (DBSS'.             07770000
           05  FILLER                       PIC X(17)  VALUE            07780000
              ')                '.                                      07790000
       01  WS-L43BJL-DESC.                                              07800000
           05  FILLER                       PIC X(47)  VALUE SPACES.    07810000
           05  FILLER                       PIC X(42)  VALUE            07820000
              'LEASE PREPARATION FEES TO SOLICITOR       '.             07830000
                                                                        07840000
      *----------------------------------------------------------*      07850000
      *    WS VARIABLES PASSED FROM SUB-PROGRAM "AG07C907"       *      07860000
      *----------------------------------------------------------*      07870000
       COPY AG7C907C.                                                   07880000
                                                                        07890000
      *----------------------------------------------------------*      07900000
      *    WS VARIABLES PASSED FROM SUB-PROGRAM "BP13C906"       *      07910000
      *----------------------------------------------------------*      07920000
       COPY P13C906C.                                                   07930000
                                                                        07940000
      *----------------------------------------------------------*      07950000
      *    WS VARIABLES PASSED FROM SUB-PROGRAM "AB05C902"       *      07960000
      *----------------------------------------------------------*      07970000
       COPY AB05902C.                                                   07980000
                                                                        07990000
      *----------------------------------------------------------*      08000000
      *    WS VARIABLES FOR CONVERTING AMOUNT TO WORDS           *      08010000
      *----------------------------------------------------------*      08020000
       01  WS-SUBSCRIPTS.                                               08030000
           05  WA-SUB              PIC 999   VALUE 0.                   08040000
           05  WF-SUB              PIC 999   VALUE 0.                   08050000
           05  WL-SUB              PIC 999   VALUE 0.                   08060000
           05  WS-SUB              PIC 999   VALUE 0.                   08070000
           05  WS-FIRST-SUB        PIC 999   VALUE 0.                   08080000
                                                                        08090000
       01  WA-NAMES.                                                    08100000
           05  FILLER              PIC X(10) VALUE '3ONE      '.        08110000
           05  FILLER              PIC X(10) VALUE '3TWO      '.        08120000
           05  FILLER              PIC X(10) VALUE '5THREE    '.        08130000
           05  FILLER              PIC X(10) VALUE '4FOUR     '.        08140000
           05  FILLER              PIC X(10) VALUE '4FIVE     '.        08150000
           05  FILLER              PIC X(10) VALUE '3SIX      '.        08160000
           05  FILLER              PIC X(10) VALUE '5SEVEN    '.        08170000
           05  FILLER              PIC X(10) VALUE '5EIGHT    '.        08180000
           05  FILLER              PIC X(10) VALUE '4NINE     '.        08190000
           05  FILLER              PIC X(10) VALUE '3TEN      '.        08200000
           05  FILLER              PIC X(10) VALUE '6ELEVEN   '.        08210000
           05  FILLER              PIC X(10) VALUE '6TWELVE   '.        08220000
           05  FILLER              PIC X(10) VALUE '8THIRTEEN '.        08230000
           05  FILLER              PIC X(10) VALUE '8FOURTEEN '.        08240000
           05  FILLER              PIC X(10) VALUE '7FIFTEEN  '.        08250000
           05  FILLER              PIC X(10) VALUE '7SIXTEEN  '.        08260000
           05  FILLER              PIC X(10) VALUE '9SEVENTEEN'.        08270000
           05  FILLER              PIC X(10) VALUE '8EIGHTEEN '.        08280000
           05  FILLER              PIC X(10) VALUE '8NINETEEN '.        08290000
           05  FILLER              PIC X(10) VALUE '6TWENTY   '.        08300000
           05  FILLER              PIC X(10) VALUE '6THIRTY   '.        08310000
           05  FILLER              PIC X(10) VALUE '5FORTY    '.        08320000
           05  FILLER              PIC X(10) VALUE '5FIFTY    '.        08330000
           05  FILLER              PIC X(10) VALUE '5SIXTY    '.        08340000
           05  FILLER              PIC X(10) VALUE '7SEVENTY  '.        08350000
           05  FILLER              PIC X(10) VALUE '6EIGHTY   '.        08360000
           05  FILLER              PIC X(10) VALUE '6NINETY   '.        08370000
       01  WA-NAMER REDEFINES WA-NAMES.                                 08380000
           05  WA-NAME             PIC X(10) OCCURS 27 TIMES.           08390000
                                                                        08400000
       01  WS-LITERALS.                                                 08410000
           05  L-CENT              PIC X(5)  VALUE '4CENT'.             08420000
           05  L-AND               PIC X(4)  VALUE '3AND'.              08430000
           05  L-X                 PIC X     VALUE '%'.                 08440000
           05  L-MILLION           PIC X(8)  VALUE '7MILLION'.          08450000
           05  L-THOUSAND          PIC X(9)  VALUE '8THOUSAND'.         08460000
           05  L-DOLLARS           PIC X(8)  VALUE '7DOLLARS'.          08470000
           05  L-CENTS             PIC X(6)  VALUE '6CENTS'.            08480000
           05  L-ONLY              PIC X(6)  VALUE '5ONLY '.            08490000
           05  L-HUNDRED           PIC X(8)  VALUE '7HUNDRED'.          08500000
           05  L-DOLLAR            PIC X(7)  VALUE '6DOLLAR'.           08510000
                                                                        08520000
       01  SWITCHES.                                                    08530000
           05  WS-SWITCH           PIC 9     VALUE 0.                   08540000
           05  WS-THO-SW           PIC 9     VALUE 0.                   08550000
           05  WS-CNT-SW           PIC 9     VALUE 0.                   08560000
           05  WS-LIT-SW           PIC 9     VALUE 0.                   08570000
           05  WS-TEN-SW           PIC 9     VALUE 0.                   08580000
           05  WS-AND-SW           PIC 9     VALUE 0.                   08590000
                                                                        08600000
       01  WS-PLACE-COUNTER        PIC 999   VALUE 0.                   08610000
       01  WL-AREA-SAVE            PIC X(12) VALUE SPACES.              08620000
       01  WS-RESULT               PIC 999   VALUE 0.                   08630000
       01  WL-AREA.                                                     08640000
           05  WL-ITEM1            PIC 9     VALUE 0.                   08650000
           05  FILLER              PIC X(11) VALUE SPACE.               08660000
       01  WL-ITM REDEFINES WL-AREA.                                    08670000
           05  WL-ITEM             PIC X     OCCURS 12 TIMES.           08680000
                                                                        08690000
       01  WS-CHEQUE-DETAILS.                                           08700000
           05  WS-AMT              PIC 9(7)V99 VALUE 0.                 08710000
           05  WS-DIGIT REDEFINES  WS-AMT OCCURS 9 TIMES PIC 9.         08720000
           05  WF-DETAILS.                                              08730000
               10  WF-LINE-1       PIC X(60).                           08740000
               10  WF-LINE-2       PIC X(60).                           08750000
           05  WF-ITEM REDEFINES WF-DETAILS OCCURS 120 PIC X.           08760000
           05  WP-ITEM REDEFINES WF-DETAILS OCCURS 2 PIC X(60).         08770000
                                                                        08780000
                                                                        08790000
      *------------------*                                              08800000
       PROCEDURE DIVISION.                                              08810000
      *------------------*                                              08820000
                                                                        08830000
      ******************************************************************08840000
       0000-CONTROL.                                                    08850000
      ******************************************************************08860000
            PERFORM  0100-SET-DATE               THRU  0100-EXIT.       08870000
            PERFORM  0200-OPEN-FILES             THRU  0200-EXIT.       08880000
            PERFORM  1100-READ-BP13F315          THRU  1100-EXIT.       08890000
            PERFORM  0900-CHECK-SALES-TYPE       THRU  0900-EXIT.       08900000
                                                                        08910000
            MOVE     WS-REPORT-ID-SW             TO    WS-PREV-REPORT-ID08920000
            MOVE     F315-CDE-SA-TP-TAG          TO    WS-PREV-SA-TP-TAG08930000
            MOVE     F315-CDE-PROJECT            TO    WS-PREV-PROJ-CODE08940000
            PERFORM  1000-READ-AND-PRINT-LOOP    THRU  1000-EXIT        08950000
                          UNTIL END-OF-BP13F315.                        08960000
                                                                        08970000
            PERFORM  8000-DISPLAY-STATISTICS     THRU  8000-EXIT.       08980000
            PERFORM  9000-CLOSE-FILES            THRU  9000-EXIT.       08990000
                                                                        09000000
       0000-EXIT.                                                       09010000
            EXIT.                                                       09020000
                                                                        09030000
                                                                        09040000
      ******************************************************************09050000
       0100-SET-DATE.                                                   09060000
      ******************************************************************09070000
            STRING  FUNCTION CURRENT-DATE(7:2) '/'                      09080000
                    FUNCTION CURRENT-DATE(5:2) '/'                      09090000
                    FUNCTION CURRENT-DATE(1:4)                          09100000
            DELIMITED BY SIZE INTO HEADER-DATE.                         09110000
                                                                        09120000
            MOVE HEADER-DATE           TO   L43B-CURRENT-DATE.          09130000
                                                                        09140000
       0100-EXIT.                                                       09150000
            EXIT.                                                       09160000
                                                                        09170000
                                                                        09180000
      ******************************************************************09190000
       0200-OPEN-FILES.                                                 09200000
      ******************************************************************09210000
            OPEN INPUT  BP13F315                                        09220000
                        B05K006                                         09230000
                        BP13K410                                        09240000
                        BP13KD03                                        09250000
                        BP13KA10                                        09260000
                        BP13KD45                                        09270000
                 I-O    BP13K625                                        09280000
                 OUTPUT AG07F225                                        09290000
                        BP1343BJ                                        09300000
                        BP1343BL                                        09310000
                        BP1343BK.                                       09320000
                                                                        09330000
            IF WS-K006-STATUS NOT = 00 AND 97                           09340000
               MOVE    OPEN-K006                  TO   WS-CUR-PROC      09350000
               MOVE    WS-K006-STATUS             TO   WS-CUR-STATUS    09360000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT        09370000
               PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT.       09380000
                                                                        09390000
            IF WS-K410-STATUS NOT = 00 AND 97                           09400000
               MOVE    OPEN-K410                  TO    WS-CUR-PROC     09410000
               MOVE    WS-K410-STATUS             TO    WS-CUR-STATUS   09420000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT       09430000
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.      09440000
                                                                        09450000
            IF WS-KD03-STATUS NOT = 00 AND 97                           09460000
               MOVE    OPEN-KD03                  TO    WS-CUR-PROC     09470000
               MOVE    WS-KD03-STATUS             TO    WS-CUR-STATUS   09480000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT       09490000
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.      09500000
                                                                        09510000
            IF WS-KA10-STATUS NOT = 00 AND 97                           09520000
               MOVE    OPEN-KA10                  TO    WS-CUR-PROC     09530000
               MOVE    WS-KA10-STATUS             TO    WS-CUR-STATUS   09540000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT       09550000
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.      09560000
                                                                        09570000
            IF WS-KD45-STATUS NOT = 00 AND 97                           09580000
               MOVE    OPEN-KD45                  TO    WS-CUR-PROC     09590000
               MOVE    WS-KD45-STATUS             TO    WS-CUR-STATUS   09600000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT       09610000
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.      09620000
                                                                        09630000
            IF WS-K625-STATUS NOT = 00 AND 97                           09640000
               MOVE    OPEN-K625                TO    WS-CUR-PROC       09650000
               MOVE    WS-K625-STATUS           TO    WS-CUR-STATUS     09660000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT       09670000
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.      09680000
                                                                        09690000
      * VOUCHER NUMBER                                                  09700000
            MOVE 'AG07K960' TO    C907-NUM-FILENME.                     09710000
            CALL 'K960OPEN' USING AG07C907-AREA.                        09720000
                                                                        09730000
            IF C907-NUM-FILE-STATUS NOT = ('00' AND '97')               09740000
               DISPLAY 'ERROR OPENING AG07K960, STATUS = '              09750000
                        C907-NUM-FILE-STATUS                            09760000
               MOVE     C907-NUM-FILE-STATUS    TO     WS-AG07-STAT-X   09770000
               MOVE     WS-AG07-STATUS          TO     RETURN-CODE      09780000
               PERFORM  9000-CLOSE-FILES        THRU   9000-EXIT        09790000
            END-IF.                                                     09800000
                                                                        09810000
      * BATCH NUMBER (17/07/1999 - ROMAR)                               09820000
            MOVE 'BP13K620' TO    C906-NUM-FILENME.                     09830000
            CALL 'K620OPEN' USING BP13C906-AREA.                        09840000
                                                                        09850000
            IF C906-NUM-FILE-STATUS NOT = ('00' AND '97')               09860000
               DISPLAY 'ERROR OPENING BP13K620, STATUS = '              09870000
                        C906-NUM-FILE-STATUS                            09880000
               MOVE     C906-NUM-FILE-STATUS    TO     RETURN-CODE      09890000
               PERFORM  9000-CLOSE-FILES        THRU   9000-EXIT        09900000
            END-IF.                                                     09910000
                                                                        09920000
      **CALL AB05C902 TO OPEN B05K006 AND AB05K009 FILES(CODE='O')      09930000
            MOVE SPACES              TO   WS-B902-AREA.                 09940000
            INITIALIZE                    WS-B902-AREA.                 09950000
            MOVE 'O'                 TO   B902-CDE-TYPE.                09960000
            CALL 'AB05C902'  USING WS-B902-AREA.                        09970000
                                                                        09980000
            IF B902-CDE-ERROR NOT = ZEROES                              09990000
               MOVE B902-CDE-SYSERR  TO   RETURN-CODE                   10000000
               DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'            10010000
               PERFORM  9000-CLOSE-FILES  THRU 9000-EXIT                10020000
            END-IF.                                                     10030000
                                                                        10040000
       0200-EXIT.                                                       10050000
            EXIT.                                                       10060000
                                                                        10070000
                                                                        10080000
      ******************************************************************10090000
       0900-CHECK-SALES-TYPE.                                           10100000
      ******************************************************************10110000
            MOVE  'J'           TO     WS-REPORT-ID-SW.                 10120000
            MOVE  'DBSS'        TO     WS-NUM-BATCH-TYPE.               10130000
            IF  F315-CDE-TRANS   =   'DS'                               10140000
                MOVE  'DBDS'        TO     WS-NUM-BATCH-TYPE            10150000
            END-IF.                                                     10160000
                                                                        10170000
       0900-EXIT.                                                       10180000
            EXIT.                                                       10190000
                                                                        10200000
                                                                        10210000
      ******************************************************************10220000
       1000-READ-AND-PRINT-LOOP.                                        10230000
      ******************************************************************10240000
            IF F315-CDE-TRANS = 'DB'  OR  'DS'                          10250000
               IF (WS-REPORT-ID-SW    NOT = WS-PREV-REPORT-ID) OR       10260000
                  (F315-CDE-SA-TP-TAG NOT = WS-PREV-SA-TP-TAG) OR       10270000
                  (F315-CDE-PROJECT   NOT = WS-PREV-PROJ-CODE)          10280000
                                                                        10290000
                   PERFORM  5000-WRITE-TRAILER-F225                     10300000
                      THRU  5000-TRAILER-EXIT                           10310000
                   MOVE     ZEROES               TO  WS-CNT-DETAILS     10320000
                   MOVE     ZEROES               TO  WS-TEMP-TOTAL      10330000
                   MOVE     'Y'                  TO  WS-NEW-BATCH       10340000
                                                     WS-NEW-VOUCHER     10350000
                                                     WS-NEW-HEADER      10360000
                   MOVE     WS-REPORT-ID-SW      TO  WS-PREV-REPORT-ID  10370000
                   MOVE     F315-CDE-SA-TP-TAG   TO  WS-PREV-SA-TP-TAG  10380000
                   MOVE     F315-CDE-PROJECT     TO  WS-PREV-PROJ-CODE  10390000
                   INITIALIZE BP13KA10-REC                              10400000
                   MOVE  F315-CDE-PROJECT        TO   KA10-NUM-PRJCT    10410000
                   MOVE     SPACES              TO WS-NME-FIN-SOLICITOR 10420000
                   PERFORM 1315-READ-BP13KA10    THRU 1315-EXIT         10430000
               END-IF                                                   10440000
                                                                        10450000
               PERFORM  1050-PROCESS-RECORD      THRU 1050-EXIT         10460000
               PERFORM  1055-EARMARK-ACCOUNT     THRU 1055-EXIT         10470000
                                                                        10480000
               IF B902-CDE-SYSERR NOT = ZEROES                          10490000
                  DISPLAY 'ERROR CALLING AB05C902, STATUS = '           10500000
                           B902-CDE-SYSERR                              10510000
                  MOVE     '99'                 TO RETURN-CODE          10520000
                  PERFORM  9000-CLOSE-FILES                             10530000
               END-IF                                                   10540000
                                                                        10550000
               IF B902-CDE-ERROR-ACCT(1) = SPACES                       10560000
                  IF WS-NEW-HEADER = 'Y'                                10570000
                     PERFORM  5000-WRITE-HEADER-F225                    10580000
                              THRU 5000-HEADER-EXIT                     10590000
                     MOVE  'N'             TO   WS-NEW-HEADER           10600000
                  END-IF                                                10610000
                  PERFORM  1060-PRINT-RECORD        THRU 1060-EXIT      10620000
                  MOVE F315-CDE-SA-TP-TAG  TO   WS-PREV-SA-TP-TAG       10630000
                  MOVE F315-CDE-PROJECT    TO   WS-PREV-PROJ-CODE       10640000
                  PERFORM  6000-WRITE-STAMPING-FILE THRU 6000-EXIT      10650000
               END-IF                                                   10660000
                                                                        10670000
            END-IF.                                                     10680000
                                                                        10690000
            PERFORM 1100-READ-BP13F315       THRU 1100-EXIT.            10700000
                                                                        10710000
            IF NOT END-OF-BP13F315                                      10720000
               PERFORM 0900-CHECK-SALES-TYPE THRU 0900-EXIT             10730000
            END-IF.                                                     10740000
                                                                        10750000
       1000-EXIT.                                                       10760000
            EXIT.                                                       10770000
                                                                        10780000
                                                                        10790000
      ******************************************************************10800000
       1050-PROCESS-RECORD.                                             10810000
      ******************************************************************10820000
            PERFORM 1300-READ-BP13K410 THRU 1300-EXIT.                  10830000
                                                                        10840000
            IF WS-NME-FIN-SOLICITOR = SPACES OR LOW-VALUES              10850000
               PERFORM 1310-READ-BP13KD03 THRU 1310-EXIT                10860000
            END-IF.                                                     10870000
                                                                        10880000
            PERFORM 1500-READ-BP13KD45 THRU 1500-EXIT.                  10890000
                                                                        10900000
            IF WS-LEASE-SF                NOT NUMERIC                   10910000
               MOVE ZEROES TO WS-LEASE-SF.                              10920000
                                                                        10930000
            IF WS-LOAN-GRANTED            NOT NUMERIC                   10940000
               MOVE ZEROS  TO WS-LOAN-GRANTED.                          10950000
                                                                        10960000
      * GENERATE BATCH NUMBER.                                          10970000
            IF WS-NEW-BATCH = 'Y'                                       10980000
               MOVE WS-NUM-BATCH-TYPE TO C906-NUM-BATCH-TYPE            10990000
               MOVE  'BP13K620'       TO C906-NUM-FILENME               11000000
                                                                        11010000
               CALL 'BP13C906'  USING BP13C906-AREA                     11020000
                                                                        11030000
               IF C906-NUM-FILE-STATUS =  '00'                          11040000
                  MOVE C906-NUM-BATCH-TYPE      TO  WS-NUM-BATCH-TYPE   11050000
                  MOVE C906-NUM-FIN-YEAR        TO  WS-NUM-FIN-YEAR     11060000
                  MOVE C906-NUM-BATCH-SERIAL    TO  WS-NUM-BATCH-SERIAL 11070000
                  MOVE    'N'                   TO  WS-NEW-BATCH        11080000
               ELSE                                                     11090000
                  DISPLAY 'ERROR CALLING BP13C906, FILE STATUS = '      11100000
                           C906-NUM-FILE-STATUS                         11110000
                  MOVE     C906-NUM-FILE-STATUS TO RETURN-CODE          11120000
                  PERFORM  9000-CLOSE-FILES                             11130000
            END-IF.                                                     11140000
                                                                        11150000
      * GENERATE VOUCHER NUMBER.                                        11160000
            IF WS-NEW-VOUCHER = 'Y'                                     11170000
      *        MOVE  'SU '      TO C907-NUM-DDD                         11180000
               MOVE  'SS '      TO C907-NUM-DDD                         11190000
               MOVE  'AG07K960' TO C907-NUM-FILENME                     11200000
                                                                        11210000
               CALL 'AG07C907'  USING AG07C907-AREA                     11220000
                                                                        11230000
               IF C907-NUM-FILE-STATUS =  '00'                          11240000
                  MOVE    'N'   TO    WS-NEW-VOUCHER                    11250000
               ELSE                                                     11260000
                  DISPLAY 'ERROR CALLING AG07C907, FILE STATUS = '      11270000
                           C907-NUM-FILE-STATUS                         11280000
                  MOVE     C907-NUM-FILE-STATUS TO WS-AG07-STAT-X       11290000
                  MOVE     WS-AG07-STATUS       TO RETURN-CODE          11300000
                  PERFORM  9000-CLOSE-FILES                             11310000
            END-IF.                                                     11320000
                                                                        11330000
       1050-EXIT.                                                       11340000
            EXIT.                                                       11350000
                                                                        11360000
                                                                        11370000
      ******************************************************************11380000
       1055-EARMARK-ACCOUNT.                                            11390000
      ******************************************************************11400000
      **CALL AB05C902 TO EARMARK ACCOUNT(CODE='E')                      11410000
            MOVE SPACES              TO   WS-B902-AREA.                 11420000
            INITIALIZE                    WS-B902-AREA.                 11430000
                                                                        11440000
            STRING C907-NUM-DDD  C907-NUM-FIN-YR                        11450000
                   C907-NUM-VR-SERIAL                                   11460000
                   DELIMITED BY SIZE INTO B902-VR-NO                    11470000
            END-STRING.                                                 11480000
                                                                        11490000
            MOVE 'E'                     TO   B902-CDE-TYPE.            11500000
            MOVE 'BP13'                  TO   B902-CDE-SYSTEMID.        11510000
            MOVE FUNCTION CURRENT-DATE   TO   B902-DTE-TRANS.           11520000
            MOVE 'P13C43B'               TO   B902-NUM-USERID-UPDATE.   11530000
            MOVE 'CV'                    TO   B902-CDE-EARMARK-REASON.  11540000
            MOVE 01                      TO   B902-NUM-HDB-REF-CNT.     11550000
            MOVE F315-SCH-ACC            TO   B902-NUM-HDB-REF(1).      11560000
            MOVE ZEROES                  TO   WS-AMT-EARMARK.           11570000
                                                                        11580000
            PERFORM 1057-COMP-TRANS-AMT  THRU 1057-EXIT.                11590000
            MOVE WS-AMT-EARMARK          TO   B902-AMT-EARMARK(1).      11600000
                                                                        11610000
            DISPLAY '----------------'.                                 11620000
            DISPLAY 'B902-VR-NO       = ' B902-VR-NO.                   11630000
            DISPLAY 'B902-CDE-TYPE    = ' B902-CDE-TYPE.                11640000
            DISPLAY 'CDE-SYSTEMID     = ' B902-CDE-SYSTEMID.            11650000
            DISPLAY 'B902-DTE-TRANS   = ' B902-DTE-TRANS.               11660000
            DISPLAY 'NUM-USERID       = ' B902-NUM-USERID-UPDATE.       11670000
            DISPLAY 'HDB-REF-CNT      = ' B902-NUM-HDB-REF-CNT.         11680000
            DISPLAY 'NUM-HDB-REF      = ' B902-NUM-HDB-REF(1).          11690000
            DISPLAY 'B902-AMT-EARMARK = ' B902-AMT-EARMARK(1).          11700000
                                                                        11710000
            CALL 'AB05C902'  USING WS-B902-AREA.                        11720000
                                                                        11730000
            DISPLAY 'CDE-ERROR-ACCT   = ' B902-CDE-ERROR-ACCT(1).       11740000
            DISPLAY '----------------'.                                 11750000
                                                                        11760000
            EVALUATE B902-CDE-ERROR-ACCT(1)                             11770000
               WHEN SPACES                                              11780000
                  CONTINUE                                              11790000
      *        WHEN OTHER                                               11800000
      *           PERFORM 6500-PRINT-L43BK-REPORT     THRU 6500-EXIT    11810000
            END-EVALUATE.                                               11820000
                                                                        11830000
       1055-EXIT.                                                       11840000
            EXIT.                                                       11850000
                                                                        11860000
                                                                        11870000
      ******************************************************************11880000
       1057-COMP-TRANS-AMT.                                             11890000
      ******************************************************************11900000
            IF WS-MORT-SF2 = ZEROS                                      11910000
               MOVE     ZEROES            TO   WS-EM-MORT-SF            11920000
               MOVE     ZEROES            TO   WS-EM-DUP-DOA            11930000
            ELSE                                                        11940000
               MOVE     WS-MORT-SF2       TO   WS-EM-MORT-SF            11950000
               SUBTRACT DUP-DOA-AMT       FROM WS-EM-MORT-SF            11960000
               MOVE     DUP-DOA-AMT       TO   WS-EM-DUP-DOA            11970000
            END-IF.                                                     11980000
                                                                        11990000
            IF WS-LEASE-SF = ZEROES                                     12000000
               INITIALIZE   WS-EM-LEASE-STAMP                           12010000
            ELSE                                                        12020000
               COMPUTE WS-EM-LEASE-STAMP = WS-LEASE-SF                  12030000
            END-IF.                                                     12040000
                                                                        12050000
            DISPLAY 'NUM-REGN            = ' F315-REGN-NO.              12060000
            DISPLAY 'WS-EM-MORT-SF       = ' WS-EM-MORT-SF.             12070000
            DISPLAY 'WS-EM-LEASE-STAMP   = ' WS-EM-LEASE-STAMP.         12080000
            DISPLAY 'WS-LEASE-SF= ' WS-LEASE-SF.                        12090000
                                                                        12100000
            COMPUTE WS-AMT-EARMARK = (WS-EM-MORT-SF + WS-EM-DUP-DOA +   12110000
                                     WS-EM-LEASE-STAMP).                12120000
            DISPLAY 'WS-AMT-EARMARK     = ' WS-AMT-EARMARK.             12130000
            IF F315-CDE-TRANS  =  'DS'                                  12140000
               COMPUTE WS-AMT-EARMARK = WS-EM-LEASE-STAMP               12150000
            END-IF.                                                     12160000
                                                                        12170000
       1057-EXIT.                                                       12180000
           EXIT.                                                        12190000
                                                                        12200000
                                                                        12210000
      ******************************************************************12220000
       1060-PRINT-RECORD.                                               12230000
      ******************************************************************12240000
            PERFORM 2150-HANDLE-SER  THRU  2150-EXIT.                   12250000
                                                                        12260000
       1060-EXIT.                                                       12270000
            EXIT.                                                       12280000
                                                                        12290000
                                                                        12300000
      ******************************************************************12310000
       1100-READ-BP13F315.                                              12320000
      ******************************************************************12330000
            READ BP13F315                                               12340000
              AT END                                                    12350000
                 MOVE    'Y'  TO WS-EOF                                 12360000
                 PERFORM 4200-PRINT-LAST-LINES THRU 4200-EXIT           12370000
                 GO TO   1100-EXIT.                                     12380000
                                                                        12390000
            IF F315-CDE-TRANS = 'DB'  OR  'DS'                          12400000
               ADD  1                 TO  WS-BP13F315-READ-CNT          12410000
                                                                        12420000
            MOVE    F315-SCH          TO  WS-SCH.                       12430000
            MOVE    F315-ACC          TO  WS-F315-ACC-CHK.              12440000
            MOVE    WS-F315-ACC       TO  WS-ACC.                       12450000
            MOVE    WS-F315-CHK       TO  WS-CHK.                       12460000
            MOVE    F315-LESSEE-CODE  TO  WS-LESCDE.                    12470000
            MOVE    HYPHEN            TO  WS-SCH-SEP1.                  12480000
            MOVE    HYPHEN            TO  WS-SCH-SEP2.                  12490000
            MOVE    HYPHEN            TO  WS-SCH-SEP3.                  12500000
            MOVE    F315-NUM-LEVEL    TO  WS-NUM-LEVEL.                 12510000
            MOVE    F315-NUM-MAIN     TO  WS-NUM-MAIN.                  12520000
                                                                        12530000
            IF F315-CDE-SA-TP-TAG  =  LOW-VALUE                         12540000
               MOVE SPACE             TO  F315-CDE-SA-TP-TAG            12550000
            END-IF.                                                     12560000
                                                                        12570000
       1100-EXIT.                                                       12580000
            EXIT.                                                       12590000
                                                                        12600000
                                                                        12610000
      ******************************************************************12620000
       1300-READ-BP13K410.                                              12630000
      ******************************************************************12640000
            DISPLAY '1300'.                                             12650000
      *---------------------------------------------------------------* 12660000
      *     USE F315-REGN-NO TO ACCESS BP13K410                       * 12670000
      *---------------------------------------------------------------* 12680000
            MOVE SPACES                      TO   BP13K410-REC.         12690000
            INITIALIZE                            BP13K410-REC.         12700000
                                                                        12710000
            MOVE F315-REGN-NO                TO   K410-NUM-REGN.        12720000
                                                                        12730000
            DISPLAY 'F315-REGN-NO   = ' F315-REGN-NO.                   12740000
                                                                        12750000
            READ BP13K410.                                              12760000
                                                                        12770000
            DISPLAY 'WS-K410-STATUS = ' WS-K410-STATUS.                 12780000
                                                                        12790000
            IF WS-K410-STATUS = 00                                      12800000
               MOVE  K410-DTE-SO-EFFECTIVE   TO   WS-DTE-SALE-AGRM      12810000
            ELSE                                                        12820000
               MOVE  SPACES                  TO   WS-DTE-SALE-AGRM      12830000
            END-IF.                                                     12840000
                                                                        12850000
       1300-EXIT.                                                       12860000
            EXIT.                                                       12870000
                                                                        12880000
                                                                        12890000
      ******************************************************************12900000
       1310-READ-BP13KD03.                                              12910000
      ******************************************************************12920000
            DISPLAY '1310'.                                             12930000
      *---------------------------------------------------------------* 12940000
      *     USE F315-REGN-NO TO ACCESS BP13KD03                       * 12950000
      *---------------------------------------------------------------* 12960000
            MOVE SPACES                      TO   BP13KD03-REC.         12970000
            INITIALIZE                            BP13KD03-REC.         12980000
                                                                        12990000
            MOVE F315-REGN-NO                TO   KD03-NUM-REGN.        13000000
                                                                        13010000
            DISPLAY 'F315-REGN-NO   = ' F315-REGN-NO.                   13020000
                                                                        13030000
            READ BP13KD03.                                              13040000
                                                                        13050000
            IF WS-KD03-STATUS = 00                                      13060000
               INITIALIZE BP13KA10-REC                                  13070000
               MOVE  KD03-NUM-PROJECT        TO   KA10-NUM-PRJCT        13080000
               PERFORM 1315-READ-BP13KA10    THRU 1315-EXIT             13090000
            ELSE                                                        13100000
               MOVE  SPACES                  TO   WS-NME-FIN-SOLICITOR  13110000
            END-IF.                                                     13120000
                                                                        13130000
       1310-EXIT.                                                       13140000
            EXIT.                                                       13150000
      ******************************************************************13160000
       1315-READ-BP13KA10.                                              13170000
      ******************************************************************13180000
            READ BP13KA10.                                              13190000
                                                                        13200000
            IF WS-KA10-STATUS = 00                                      13210000
               STRING 'M/S ' KA10-NME-SOLICITOR DELIMITED BY SIZE       13220000
                                              INTO WS-NME-FIN-SOLICITOR 13230000
               MOVE  WS-NME-FIN-SOLICITOR    TO   PRT-SOL-NAME          13240000
            ELSE                                                        13250000
               MOVE  SPACES                  TO   WS-NME-FIN-SOLICITOR  13260000
            END-IF.                                                     13270000
                                                                        13280000
       1315-EXIT.                                                       13290000
            EXIT.                                                       13300000
                                                                        13310000
                                                                        13320000
      ******************************************************************13330000
       1500-READ-BP13KD45.                                              13340000
      ******************************************************************13350000
           DISPLAY '1500'.                                              13360000
           MOVE SPACES                     TO BP13KD45-REC.             13370000
           INITIALIZE                         BP13KD45-REC.             13380000
                                                                        13390000
           MOVE 'N'                        TO WS-KD45-EOF.              13400000
                                                                        13410000
           MOVE F315-REGN-NO               TO KD45-NUM-REGN-HIST.       13420000
           MOVE SPACES                     TO KD45-DTE-UPDATE-HIST      13430000
                                              KD45-TME-UPDATE-HIST.     13440000
                                                                        13450000
           START BP13KD45 KEY >= KD45-KEY-FLD.                          13460000
                                                                        13470000
           EVALUATE WS-KD45-STATUS                                      13480000
           WHEN 00                                                      13490000
              PERFORM 1510-READNXT-BP13KD45 THRU 1510-EXIT              13500000
           WHEN 10                                                      13510000
           WHEN 23                                                      13520000
              MOVE    ZEROES                     TO   WS-LEASE-SF       13530000
              MOVE    ZEROES                     TO   WS-MORT-SF        13540000
              MOVE    ZEROES                     TO   WS-MORT-SF2       13550000
              MOVE    ZEROES                     TO   WS-SUP-SF         13560000
              MOVE    ZEROES                     TO   WS-DUP-DOA        13570000
              MOVE    SPACES                     TO   WS-AO-DATE        13580000
              MOVE    WS-KD45-STATUS             TO   WS-CUR-STATUS     13590000
              MOVE    START-KD45                 TO   WS-CUR-PROC       13600000
              PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT         13610000
              PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT         13620000
           WHEN OTHER                                                   13630000
              MOVE    START-KD45                 TO WS-CUR-PROC         13640000
              MOVE    WS-KD45-STATUS             TO WS-CUR-STATUS       13650000
              PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT         13660000
              PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT         13670000
           END-EVALUATE.                                                13680000
                                                                        13690000
       1500-EXIT.                                                       13700000
            EXIT.                                                       13710000
                                                                        13720000
                                                                        13730000
      ******************************************************************13740000
       1510-READNXT-BP13KD45.                                           13750000
      ******************************************************************13760000
            DISPLAY '1510'.                                             13770000
           READ BP13KD45 NEXT RECORD.                                   13780000
                                                                        13790000
           EVALUATE WS-KD45-STATUS                                      13800000
           WHEN 00                                                      13810000
              IF KD45-NUM-REGN-HIST = F315-REGN-NO                      13820000
                 IF KD45-NUM-PP-SCHDL = '01'                            13830000
      *             IF F315-NUM-ADHOC-SF = SPACES                       13840000
                       IF K410-DTE-SO-EXECUTION <= '20110218'           13850000
                          MOVE 2.00                TO  DUP-DOA-AMT      13860000
                                                       DUP-SA-AMT       13870000
                       ELSE                                             13880000
                          MOVE 0.00                TO  DUP-DOA-AMT      13890000
                                                       DUP-SA-AMT       13900000
                       END-IF                                           13910000
                       MOVE KD45-AMT-SNP-STAMP     TO  WS-LEASE-SF      13920000
                       MOVE KD45-AMT-MORT-STAMP    TO  WS-MORT-SF       13930000
                                                       WS-MORT-SF2      13940000
                       MOVE KD45-AMT-LOAN-GRANTED  TO  WS-LOAN-GRANTED  13950000
                       MOVE WS-DTE-SALE-AGRM       TO  WS-AO-DATE       13960000
                       MOVE KD45-NUM-SCH-ACC       TO  WS-SCH-ACCT-NO2  13970000
                       MOVE KD45-AMT-CURR-SELLPR   TO  WS-SELL-PRICE    13980000
                       MOVE    'Y'                 TO  WS-KD45-EOF      13990000
                       COMPUTE WS-ANNUAL-RENT = 0                       14000000
                       IF KD45-AMT-SOLICITOR-BILL NOT NUMERIC           14010000
                          MOVE ZEROES TO KD45-AMT-SOLICITOR-BILL        14020000
                       END-IF                                           14030000
                       IF  F315-CDE-TRANS  = 'DS'                       14040000
                           MOVE KD45-AMT-SOLICITOR-BILL TO  WS-LEASE-SF 14050000
                       END-IF                                           14060000
                    END-IF                                              14070000
      *          END-IF                                                 14080000
              ELSE                                                      14090000
                 MOVE    'Y'                        TO   WS-KD45-EOF    14100000
                 MOVE    ZEROES                     TO   WS-LEASE-SF    14110000
                 MOVE    ZEROES                     TO   WS-MORT-SF     14120000
                                                         WS-MORT-SF2    14130000
                 MOVE    ZEROES                     TO   WS-SUP-SF      14140000
                 MOVE    ZEROES                     TO   WS-DUP-DOA     14150000
                 MOVE    SPACES                     TO   WS-AO-DATE     14160000
              END-IF                                                    14170000
           WHEN 10                                                      14180000
           WHEN 23                                                      14190000
              MOVE    'Y'                        TO   WS-KD45-EOF       14200000
              MOVE    ZEROES                     TO   WS-LEASE-SF       14210000
              MOVE    ZEROES                     TO   WS-MORT-SF        14220000
              MOVE    ZEROES                     TO   WS-SUP-SF         14230000
              MOVE    ZEROES                     TO   WS-DUP-DOA        14240000
              MOVE    SPACES                     TO   WS-AO-DATE        14250000
              MOVE    WS-KD45-STATUS             TO   WS-CUR-STATUS     14260000
              MOVE    READ-KD45                  TO   WS-CUR-PROC       14270000
              PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT         14280000
              PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT         14290000
           WHEN OTHER                                                   14300000
              MOVE    READ-KD45                  TO   WS-CUR-PROC       14310000
              MOVE    WS-KD45-STATUS             TO   WS-CUR-STATUS     14320000
              PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT         14330000
              PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT         14340000
           END-EVALUATE.                                                14350000
                                                                        14360000
       1510-EXIT.                                                       14370000
            EXIT.                                                       14380000
                                                                        14390000
                                                                        14400000
      ******************************************************************14410000
       1800-READ-B05K006.                                               14420000
      ******************************************************************14430000
            MOVE  ' '                TO L43B-TAG.                       14440000
            MOVE  SPACES             TO K006-HDB-REF-SF.                14450000
            MOVE  WS-SCH-ACCT-NO2    TO K006-HDB-REF-SF.                14460000
                                                                        14470000
            READ  B05K006.                                              14480000
                                                                        14490000
            IF WS-K006-STATUS = 00                                      14500000
               PERFORM 1810-CHECK-ADHOC-BLANK-CASES THRU 1810-EXIT      14510000
            END-IF.                                                     14520000
                                                                        14530000
       1800-EXIT.                                                       14540000
            EXIT.                                                       14550000
                                                                        14560000
                                                                        14570000
      ******************************************************************14580000
       1810-CHECK-ADHOC-BLANK-CASES.                                    14590000
      ******************************************************************14600000
           INITIALIZE             WS-LEASE-AMT.                         14610000
           COMPUTE WS-LEASE-AMT = WS-LEASE-SF + WS-MORT-SF              14620000
           IF F315-CDE-TRANS   = 'DS'                                   14630000
              MOVE WS-LEASE-SF  TO  WS-LEASE-AMT                        14640000
           END-IF.                                                      14650000
           IF (K006-BALANCES > WS-LEASE-AMT) OR                         14660000
              (K006-BALANCES = WS-LEASE-AMT)                            14670000
               NEXT SENTENCE                                            14680000
           ELSE                                                         14690000
               MOVE '*'          TO L43B-TAG                            14700000
           END-IF.                                                      14710000
                                                                        14720000
       1810-EXIT.                                                       14730000
            EXIT.                                                       14740000
                                                                        14750000
                                                                        14760000
      ******************************************************************14770000
       2000-DISPLAY-ERROR-MESSAGE.                                      14780000
      ******************************************************************14790000
            DISPLAY ' *************   ERROR MESSAGE   *************'.   14800000
            DISPLAY 'ERROR ENCOUNTERED WHEN ' WS-CUR-PROC.              14810000
            DISPLAY 'STATUS CODE = ' WS-CUR-STATUS.                     14820000
                                                                        14830000
       2000-EXIT.                                                       14840000
            EXIT.                                                       14850000
                                                                        14860000
                                                                        14870000
      ******************************************************************14880000
       2150-HANDLE-SER.                                                 14890000
      ******************************************************************14900000
      *--------------------------------*                                14910000
      *     PRINT  L43BJ-RECORD (DOA)  *                                14920000
      *--------------------------------*                                14930000
            ADD    1                      TO  WS-CNT-DETAILS.           14940000
                                                                        14950000
      *     -----------------------                                     14960000
      *     SET UP L43BJ-REC-DETAIL                                     14970000
      *     -----------------------                                     14980000
            MOVE   WS-CNT-DETAILS         TO  L43B-SERIAL-NO            14990000
                                              L43BL-SERIAL-NO           15000000
            MOVE   WS-SCH-ACC             TO  L43B-SCH-ACC              15010000
                                              L43BL-SCH-ACC             15020000
            MOVE   F315-REGN-NO           TO  L43B-REGN-NO              15030000
                                              L43BL-REGN-NO             15040000
            MOVE   F315-NUM-BLK           TO  L43B-BLKNO                15050000
                                              L43BL-BLKNO               15060000
            MOVE   F315-NME-STREET        TO  L43B-STREET               15070000
                                              L43BL-STREET              15080000
            MOVE   WS-DTE-SALE-AGRM       TO  WS-SALE-DATE              15090000
            MOVE   WS-SALE-CC             TO  L43B-SALE-CC              15100000
                                              L43BL-SALE-CC             15110000
            MOVE   WS-SALE-YY             TO  L43B-SALE-YY              15120000
                                              L43BL-SALE-YY             15130000
            MOVE   WS-SALE-MM             TO  L43B-SALE-MM              15140000
                                              L43BL-SALE-MM             15150000
            MOVE   WS-SALE-DD             TO  L43B-SALE-DD              15160000
                                              L43BL-SALE-DD             15170000
            MOVE   '/'                    TO  L43B-DASH1  L43B-DASH2    15180000
                                              L43BL-DASH1  L43BL-DASH2  15190000
            MOVE   WS-FLATNO              TO  L43B-FLATNO               15200000
                                              L43BL-FLATNO              15210000
                                                                        15220000
            IF WS-LOAN-GRANTED = ZEROS                                  15230000
               MOVE     ZEROES            TO  L43B-MORT-SF              15240000
               MOVE     ZEROES            TO  L43B-TOTAL-MORT-SF        15250000
               MOVE     ZEROES            TO  L43B-DUP-DOA              15260000
               MOVE     ZEROES            TO  WS-MORT-SF                15270000
               MOVE     ZEROES            TO  WS-DUP-DOA                15280000
            ELSE                                                        15290000
               SUBTRACT DUP-DOA-AMT       FROM  WS-MORT-SF              15300000
               MOVE     WS-MORT-SF        TO    L43B-MORT-SF            15310000
               MOVE     DUP-DOA-AMT       TO    WS-DUP-DOA              15320000
               MOVE     DUP-DOA-AMT       TO    L43B-DUP-DOA            15330000
            END-IF.                                                     15340000
                                                                        15350000
            IF F315-REGN-NO = '5042672F'                                15360000
               MOVE     500               TO    WS-MORT-SF              15370000
               MOVE     500               TO    L43B-TOTAL-MORT-SF      15380000
               MOVE     500               TO    L43B-MORT-SF            15390000
            END-IF.                                                     15400000
                                                                        15410000
            IF WS-LEASE-SF NOT = ZEROES                                 15420000
               PERFORM  1800-READ-B05K006 THRU 1800-EXIT                15430000
                                                                        15440000
               COMPUTE WS-LEASE-STAMP = WS-LEASE-SF                     15450000
                                                                        15460000
               MOVE    WS-LEASE-STAMP   TO  L43B-SUP-LEASE-STAMP        15470000
                                            L43BL-LEASE-STAMP           15480000
            ELSE                                                        15490000
               MOVE    0                TO  L43B-SUP-LEASE-STAMP        15500000
                                            L43BL-LEASE-STAMP           15510000
            END-IF.                                                     15520000
                                                                        15530000
            COMPUTE WS-TEMP-TOTAL = (WS-MORT-SF     + WS-DUP-DOA +      15540000
                                     WS-LEASE-STAMP).                   15550000
            IF F315-CDE-TRANS  = 'DS'                                   15560000
               COMPUTE WS-TEMP-TOTAL = WS-LEASE-STAMP                   15570000
            END-IF.                                                     15580000
                                                                        15590000
            MOVE    WS-TEMP-TOTAL         TO  L43B-DETL-AMT-TOTAL       15600000
                                              L43BL-DETL-AMT-TOTAL.     15610000
                                                                        15620000
            MOVE    F315-SCH-ACC          TO  WS-SCH-ACCT-NO.           15630000
            MOVE    WS-TEMP-TOTAL         TO  WS-AMT-TRANS.             15640000
            ADD     1                     TO  WS-L43BJ-PRINT-CNT.       15650000
            ADD     WS-MORT-SF            TO  WS-L43BJ-MORT-CNT.        15660000
            ADD     WS-DUP-DOA            TO  WS-L43BJ-DUP-DOA-CNT.     15670000
            ADD     WS-LEASE-STAMP        TO  WS-L43BJ-LEASE-CNT.       15680000
            ADD     WS-TEMP-TOTAL         TO  WS-L43BJ-IND-TOT-CNT.     15690000
            MOVE    WS-L43BJ-IND-TOT-CNT  TO  WS-AMT-TOTAL.             15700000
            IF F315-CDE-TRANS = 'DB'                                    15710000
               WRITE   L43BJ-PRINT-REC  FROM  L43B-REC-DETAIL AFTER 1   15720000
            ELSE                                                        15730000
               IF F315-CDE-TRANS = 'DS'                                 15740000
                  WRITE L43BL-PRINT-REC FROM L43BL-REC-DETAIL AFTER 1   15750000
               END-IF                                                   15760000
            END-IF.                                                     15770000
                                                                        15780000
            MOVE    'J'                   TO  WS-PREV-REPORT-ID.        15790000
            MOVE   'NS PAYMENT FOR LEASE/MORTGAGE STAMP FEES'           15800000
                                          TO  WS-TXT-INFO.              15810000
            IF  F315-CDE-TRANS  = 'DS'                                  15820000
                MOVE   'NS PAYMENT FOR LEASE PREPARATION FEES'          15830000
                                          TO  WS-TXT-INFO               15840000
            END-IF.                                                     15850000
                                                                        15860000
            PERFORM 5000-WRITE-TRANS-DETAIL-F225 THRU  5000-DETAIL-EXIT.15870000
                                                                        15880000
            IF (WS-CNT-DETAILS = MAX-DETLS-PER-PAGE)                    15890000
                PERFORM 5000-WRITE-TRAILER-F225  THRU 5000-TRAILER-EXIT 15900000
                MOVE    ZEROES                   TO   WS-CNT-DETAILS    15910000
                MOVE    'Y'                      TO   WS-NEW-BATCH      15920000
                                                      WS-NEW-VOUCHER    15930000
                                                      WS-NEW-HEADER     15940000
            END-IF.                                                     15950000
                                                                        15960000
       2150-EXIT.                                                       15970000
            EXIT.                                                       15980000
                                                                        15990000
                                                                        16000000
      ******************************************************************16010000
       4200-PRINT-LAST-LINES.                                           16020000
      ******************************************************************16030000
            PERFORM 5000-WRITE-TRAILER-F225                             16040000
               THRU 5000-TRAILER-EXIT.                                  16050000
                                                                        16060000
       4200-EXIT.                                                       16070000
            EXIT.                                                       16080000
                                                                        16090000
                                                                        16100000
      ******************************************************************16110000
       4295-PRINT-L43BJ-GRAND-TOTAL.                                    16120000
      ******************************************************************16130000
            IF WS-CNT-DETAILS = ZEROES                                  16140000
               GO TO 4295-EXIT                                          16150000
            END-IF.                                                     16160000
                                                                        16170000
            MOVE  WS-CNT-DETAILS        TO L43B-VR-NO-HIGH              16180000
                                           L43BL-VR-NO-HIGH             16190000
            MOVE  WS-L43BJ-MORT-CNT     TO L43B-TOTAL-MORT-SF.          16200000
            MOVE  WS-L43BJ-DUP-DOA-CNT  TO L43B-TOTAL-DUP-DOA.          16210000
            MOVE  WS-L43BJ-LEASE-CNT    TO L43B-TOTAL-SUP-LEASE-SF      16220000
                                           L43BL-TOTAL-SUP-LEASE-SF.    16230000
            MOVE  WS-L43BJ-IND-TOT-CNT  TO L43B-TOTAL-AMT               16240000
                                           L43BL-TOTAL-AMT.             16250000
            IF  F315-CDE-TRANS  = 'DB'                                  16260000
                WRITE L43BJ-PRINT-REC  FROM PRT-L43B-DASH-LINE  AFTER 2 16270000
                WRITE L43BJ-PRINT-REC  FROM PRT-L43B-TOTAL-LINE AFTER 1 16280000
                WRITE L43BJ-PRINT-REC  FROM PRT-L43B-DASH-LINE  AFTER 1 16290000
            ELSE                                                        16300000
              IF F315-CDE-TRANS  = 'DS'                                 16310000
                WRITE L43BL-PRINT-REC  FROM PRT-L43B-DASH-LINE  AFTER 2 16320000
                WRITE L43BL-PRINT-REC FROM PRT-L43BL-TOTAL-LINE AFTER 1 16330000
                WRITE L43BL-PRINT-REC FROM PRT-L43B-DASH-LINE  AFTER 1  16340000
              END-IF                                                    16350000
            END-IF.                                                     16360000
            MOVE     WS-L43BJ-IND-TOT-CNT  TO   WS-AMT.                 16370000
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.              16380000
            MOVE     WP-ITEM (1)           TO   L43B-AMT-DESC1.         16390000
            MOVE     WP-ITEM (2)           TO   L43B-AMT-DESC2.         16400000
                                                                        16410000
            WRITE    L43BJ-PRINT-REC       FROM PRT-L43B-FTG-1 AFTER 3. 16420000
            WRITE    L43BL-PRINT-REC       FROM PRT-L43B-FTG-1 AFTER 3. 16430000
            WRITE    L43BJ-PRINT-REC       FROM PRT-L43B-FTG-2 AFTER 6. 16440000
            MOVE     SPACES                TO L43BL-PRINT-REC.          16450000
            WRITE    L43BL-PRINT-REC                                    16460000
            WRITE    L43BL-PRINT-REC       FROM PRT-L43B-FTG-2 AFTER 6. 16470000
                                                                        16480000
            MOVE     ZEROES                TO   WS-L43BJ-MORT-CNT       16490000
                                                WS-L43BJ-DUP-DOA-CNT    16500000
                                                WS-L43BJ-LEASE-CNT      16510000
                                                WS-L43BJ-IND-TOT-CNT.   16520000
       4295-EXIT.                                                       16530000
            EXIT.                                                       16540000
                                                                        16550000
                                                                        16560000
      ******************************************************************16570000
       4770-PRINT-L43BJ-HEADER.                                         16580000
      ******************************************************************16590000
            IF F315-CDE-TRANS = 'DB'                                    16600000
               MOVE 'P13L43BJ'          TO L43B-REPORT-ID               16610000
            ELSE                                                        16620000
               IF F315-CDE-TRANS = 'DS'                                 16630000
                  MOVE 'P13L43BL'          TO L43B-REPORT-ID            16640000
               END-IF                                                   16650000
            END-IF                                                      16660000
                                                                        16670000
            MOVE  WS-L43BJ-DESC      TO L43B-REPORT-ID-DESC.            16680000
            MOVE  WS-L43BJL-DESC     TO L43BL-REPORT-ID-DESC.           16690000
            MOVE 'LEASE     '        TO L43B-SUP-LEASE-DESC.            16700000
            MOVE '   '               TO L43B-TAG-DESC.                  16710000
            ADD   1                  TO WS-L43BJ-PAGE-CNT.              16720000
            MOVE  WS-L43BJ-PAGE-CNT  TO L43B-PAGE.                      16730000
                                                                        16740000
            MOVE "FINANCE'S COPY"          TO L43B-COPY-NAME.           16750000
            WRITE L43BJ-PRINT-REC  FROM PRT-L43B-HDG-1    AFTER PAGE.   16760000
            WRITE L43BJ-PRINT-REC  FROM PRT-L43B-HDG-2    AFTER 2.      16770000
            WRITE L43BJ-PRINT-REC  FROM PRT-L43B-HDG-3    AFTER 1.      16780000
            WRITE L43BJ-PRINT-REC  FROM PRT-L43B-HDG-4    AFTER 2.      16790000
            WRITE L43BJ-PRINT-REC  FROM PRT-L43B-HDG-5    AFTER 1.      16800000
            WRITE L43BJ-PRINT-REC  FROM PRT-L43B-HDG-6    AFTER 1.      16810000
            WRITE L43BJ-PRINT-REC  FROM PRT-L43B-HDG-7    AFTER 1.      16820000
            WRITE L43BJ-PRINT-REC  FROM PRT-L43B-HDG-8    AFTER 1.      16830000
            WRITE L43BJ-PRINT-REC  FROM PRT-L43B-HDG-9    AFTER 1.      16840000
            WRITE L43BJ-PRINT-REC  FROM PRT-L43B-HDG-10   AFTER 1.      16850000
            WRITE L43BJ-PRINT-REC  FROM PRT-L43B-HDG-10A  AFTER 1.      16860000
            WRITE L43BJ-PRINT-REC  FROM PRT-L43B-HDG-11   AFTER 1.      16870000
            WRITE L43BJ-PRINT-REC  FROM PRT-L43B-SUBHDG-1 AFTER 3.      16880000
            WRITE L43BJ-PRINT-REC  FROM PRT-L43B-SUBHDG-2 AFTER 1.      16890000
            WRITE L43BJ-PRINT-REC  FROM PRT-L43B-SUBHDG-3 AFTER 1.      16900000
            MOVE  SPACES             TO L43BJ-PRINT-REC.                16910000
            WRITE L43BJ-PRINT-REC AFTER 1.                              16920000
                                                                        16930000
            WRITE L43BL-PRINT-REC  FROM PRT-L43B-HDG-1    AFTER PAGE.   16940000
            WRITE L43BL-PRINT-REC  FROM PRT-L43B-HDG-2    AFTER 2.      16950000
            WRITE L43BL-PRINT-REC  FROM PRT-L43BL-HDG-3    AFTER 1.     16960000
            WRITE L43BL-PRINT-REC  FROM PRT-L43B-HDG-4    AFTER 2.      16970000
            WRITE L43BL-PRINT-REC  FROM PRT-L43B-HDG-5    AFTER 1.      16980000
            WRITE L43BL-PRINT-REC  FROM PRT-L43B-HDG-6    AFTER 1.      16990000
            WRITE L43BL-PRINT-REC  FROM PRT-L43B-HDG-7    AFTER 1.      17000000
            WRITE L43BL-PRINT-REC  FROM PRT-L43B-HDG-8    AFTER 1.      17010000
            WRITE L43BL-PRINT-REC  FROM PRT-L43BL-HDG-9    AFTER 1.     17020000
            WRITE L43BL-PRINT-REC  FROM PRT-L43BL-HDG-10   AFTER 1.     17030000
            WRITE L43BL-PRINT-REC  FROM PRT-L43BL-HDG-11   AFTER 1.     17040000
            WRITE L43BL-PRINT-REC  FROM PRT-L43BL-SUBHDG-1A AFTER 1.    17050000
            MOVE SPACES TO L43BL-PRINT-REC.                             17060000
            WRITE L43BL-PRINT-REC.                                      17070000
            WRITE L43BL-PRINT-REC  FROM PRT-L43BL-SUBHDG-1 AFTER 3.     17080000
            WRITE L43BL-PRINT-REC  FROM PRT-L43BL-SUBHDG-2 AFTER 1.     17090000
            WRITE L43BL-PRINT-REC  FROM PRT-L43BL-SUBHDG-3 AFTER 1.     17100000
            MOVE  SPACES             TO L43BL-PRINT-REC.                17110000
            WRITE L43BL-PRINT-REC AFTER 1.                              17120000
                                                                        17130000
       4770-EXIT.                                                       17140000
            EXIT.                                                       17150000
                                                                        17160000
                                                                        17170000
      ******************************************************************17180000
       5000-WRITE-HEADER-F225.                                          17190000
      ******************************************************************17200000
            INITIALIZE                         AG07F225-HEADER.         17210000
            MOVE    SPACES                TO   AG07F225-HEADER.         17220000
                                                                        17230000
            MOVE    C907-NUM-DDD          TO   F225-NUM-DDD.            17240000
            MOVE    C907-NUM-FIN-YR       TO   F225-NUM-FIN-YEAR.       17250000
            MOVE    C907-NUM-VR-SERIAL    TO   F225-NUM-VR-SERIAL.      17260000
            MOVE    F225-NUM-VR           TO   WS-NUM-VOUCHER.          17270000
            MOVE    00                    TO   F225-NUM-REC-TYP.        17280000
            MOVE   'PV'                   TO   F225-NUM-VR-TYP.         17290000
            MOVE   'TL'                   TO   F225-NUM-VR-SUB-TYP.     17300000
            MOVE   'SOC'                  TO   F225-NUM-TRANS-TYP.      17310000
            MOVE  FUNCTION CURRENT-DATE   TO   F225-DTE-VR-CREATE       17320000
                                               F225-DTE-VR-PRT-FINAL.   17330000
            MOVE   'BP13C43B'      TO   F225-NUM-VR-CREATE-USERID       17340000
                                        F225-NUM-VR-PRT-FINAL-USERID.   17350000
            MOVE   'STPFEE  '      TO   F225-NUM-DDD-FILE-REF.          17360000
            MOVE   'COMMISSIONER OF STAMP DUTIES'   TO  F225-NME-PAYEE1.17370000
      *     MOVE   'C/O SC(STAMPING) OF SALES UNIT' TO  F225-NME-STREET.17380001
            MOVE   'SALES AGREEMENT TEAM' TO   F225-NME-COLL-OFFCR.     17390000
            MOVE   '64903781'           TO   F225-NUM-COLL-OFFCR-PHONE. 17400000
            MOVE   'SALES AGREEMENT TEAM' TO F225-NME-CONTACT-OFFCR.    17410000
            MOVE   '64903781'           TO  F225-NUM-CONTACT-PHONE.     17420000
            MOVE   'DBSSSGSGXXX'        TO  F225-NUM-PAYEE-BANK.        17430000
            MOVE   SPACES               TO  F225-NUM-PAYEE-BANK-BRNCH.  17440000
            MOVE   '0010468600'         TO  F225-NUM-PAYEE-IBG-ACCT.    17450000
            MOVE   SPACES               TO  F225-NUM-ROOT-ACCT.         17460000
            MOVE   SPACES               TO  F225-NUM-PAYEE-UIN1.        17470000
            MOVE   SPACES               TO  F225-NME-PAYEE2.            17480000
            MOVE   SPACES               TO  F225-NUM-PAYEE-UIN2.        17490000
            MOVE   SPACES               TO  F225-NUM-PAYEE-TAX-REGN.    17500000
            MOVE   '55'                 TO  F225-NUM-BLK-HSE.           17501001
            MOVE   'NEWTON ROAD'        TO  F225-NME-STREET.            17502001
            MOVE   'REVENUE HOUSE'      TO  F225-NME-BLDNG.             17503001
            MOVE   '307987'             TO  F225-NUM-POSTAL.            17504001
            MOVE   SPACES               TO  F225-TXT-REJECT-HDR.        17510000
            MOVE   'STPFEE  '           TO  F225-NUM-INTRFC-FR-HDR.     17520000
            MOVE   'CV'                 TO  F225-NUM-ACTION-TYP.        17530000
            MOVE   SPACES               TO  F225-NUM-PRCS-TERM.         17540000
            MOVE   SPACES               TO  F225-NUM-ROUTE-FLAG.        17550000
            IF F315-USERID   = 'BP13P001'                               17560000
              MOVE WS-STAFF-START         TO F225-NUM-STAFF-ID-PREP     17570000
                                             F225-NUM-USERID-START      17580000
            ELSE                                                        17590000
              MOVE F315-USERID            TO F225-NUM-STAFF-ID-PREP     17600000
                                             F225-NUM-USERID-START      17610000
            END-IF.                                                     17620000
            MOVE   'PREP'               TO   F225-NUM-VCHR-STATE-START. 17630000
            MOVE   SPACES               TO   F225-DTE-PYMNT-DUE.        17640000
                                                                        17650000
            IF F315-CDE-TRANS = 'DS'                                    17660000
               MOVE WS-NME-FIN-SOLICITOR    TO   F225-NME-PAYEE1        17670000
               MOVE  'C/O MR BALA OF SALES OPERATION'  TO               17680000
                                                 F225-NME-STREET        17690000
               MOVE   'MR BALA       '     TO   F225-NME-COLL-OFFCR     17700000
               MOVE   SPACES            TO F225-NUM-PAYEE-BANK          17710000
                                           F225-NUM-PAYEE-BANK-BRNCH    17720000
                                           F225-NUM-PAYEE-IBG-ACCT      17730000
            END-IF.                                                     17740000
                                                                        17750000
            WRITE AG07F225-HEADER.                                      17760000
                                                                        17770000
            ADD     1                     TO   WS-AG07F225-WRITE-CNT.   17780000
            MOVE    C907-NUM-DDD          TO   WS-EDITED-NUM-DDD.       17790000
            MOVE    C907-NUM-FIN-YR       TO   WS-EDITED-NUM-FIN-YEAR.  17800000
            MOVE    C907-NUM-VR-SERIAL    TO   WS-EDITED-NUM-VR-SERIAL. 17810000
            MOVE    WS-EDITED-VOUCHER-NO  TO   L43B-VOUCHER-NO.         17820000
                                                                        17830000
            MOVE    SPACES                TO   L43B-BATCH-NO.           17840000
                                                                        17850000
            STRING WS-NUM-BATCH-TYPE   DELIMITED BY SPACE               17860000
                   WS-NUM-FIN-YEAR     DELIMITED BY SPACE               17870000
                   '-'                 DELIMITED BY SIZE                17880000
                   WS-NUM-BATCH-SERIAL DELIMITED BY SPACE               17890000
                   INTO L43B-BATCH-NO                                   17900000
            END-STRING.                                                 17910000
                                                                        17920000
            EVALUATE TRUE                                               17930000
            WHEN     REPORT-L43BJ                                       17940000
               PERFORM 4770-PRINT-L43BJ-HEADER   THRU 4770-EXIT         17950000
            END-EVALUATE.                                               17960000
                                                                        17970000
       5000-HEADER-EXIT.                                                17980000
            EXIT.                                                       17990000
                                                                        18000000
                                                                        18010000
      ******************************************************************18020000
       5000-WRITE-TRANS-DETAIL-F225.                                    18030000
      ******************************************************************18040000
            INITIALIZE AG07F225-TRANS.                                  18050000
            MOVE    SPACES             TO    AG07F225-TRANS.            18060000
            MOVE    WS-NUM-VOUCHER     TO    F225-NUM-VR-T.             18070000
            MOVE    WS-CNT-DETAILS     TO    F225-NUM-TRANS-SERIAL.     18080000
            MOVE   '04'                TO    F225-NUM-SYS.              18090000
            MOVE    WS-SCH-ACCT-NO     TO    F225-NUM-HDB-REF.          18100000
            MOVE   '0000000104250'     TO    F225-NUM-GL-ACCT.          18110000
            MOVE    WS-AMT-TRANS       TO    F225-AMT-TRANS.            18120000
            MOVE   'D'                 TO    F225-NUM-TRANS-DR-CR       18130000
            MOVE    ZEROES             TO    F225-AMT-TRANS-GST.        18140000
            MOVE    WS-TXT-INFO        TO    F225-TXT-INFO.             18150000
            MOVE    SPACES             TO    F225-NUM-TAX-CDE.          18160000
            MOVE    SPACES             TO    F225-NUM-CPF.              18170000
            MOVE    SPACES             TO    F225-TXT-REJECT-DTL.       18180000
            MOVE    'STPFEE  '          TO  F225-NUM-INTRFC-FR-T.       18190000
                                                                        18200000
            WRITE   AG07F225-TRANS.                                     18210000
                                                                        18220000
            ADD     1                  TO    WS-AG07F225-WRITE-CNT.     18230000
                                                                        18240000
       5000-DETAIL-EXIT.                                                18250000
            EXIT.                                                       18260000
                                                                        18270000
                                                                        18280000
      ******************************************************************18290000
       5000-WRITE-TRAILER-F225.                                         18300000
      ******************************************************************18310000
            IF WS-CNT-DETAILS = ZEROES                                  18320000
               GO TO 5000-TRAILER-EXIT                                  18330000
            END-IF.                                                     18340000
                                                                        18350000
            EVALUATE TRUE                                               18360000
            WHEN REPORT-L43BJ                                           18370000
               PERFORM 4295-PRINT-L43BJ-GRAND-TOTAL THRU 4295-EXIT      18380000
               MOVE    WS-AMT             TO  WS-AMT-TOTAL              18390000
            END-EVALUATE.                                               18400000
                                                                        18410000
            INITIALIZE AG07F225-TRAILER.                                18420000
            MOVE       SPACES             TO  AG07F225-TRAILER.         18430000
            MOVE       WS-NUM-VOUCHER     TO  F225-NUM-VR-R.            18440000
            MOVE       99                 TO  F225-NUM-TRAILER-SERIAL.  18450000
            MOVE       'PAYMENT FOR LEASE/MORTGAGE STAMP FEES'          18460000
                                          TO  F225-TXT-VOUCHER-NARRATION18470000
            IF  F315-CDE-TRANS  = 'DS'                                  18480000
                MOVE       'PAYMENT FOR LEASE PREPARATION FEES'         18490000
                                         TO  F225-TXT-VOUCHER-NARRATION 18500000
            END-IF.                                                     18510000
                                                                        18520000
            MOVE       WS-CNT-DETAILS     TO  F225-QTY-VR-TRANS.        18530000
            MOVE       WS-AMT-TOTAL       TO  F225-AMT-VR-DR-TOTAL.     18540000
            MOVE       ZEROES             TO  F225-AMT-VR-CR-TOTAL.     18550000
            MOVE       SPACES             TO  F225-TXT-REJECT-TLR.      18560000
            MOVE       'STPFEE  '         TO  F225-NUM-INTRFC-FR.       18570000
                                                                        18580000
            WRITE      AG07F225-TRAILER.                                18590000
                                                                        18600000
            ADD        1                  TO    WS-AG07F225-WRITE-CNT.  18610000
                                                                        18620000
       5000-TRAILER-EXIT.                                               18630000
            EXIT.                                                       18640000
                                                                        18650000
                                                                        18660000
      ******************************************************************18670000
       6000-WRITE-STAMPING-FILE.                                        18680000
      ******************************************************************18690000
            DISPLAY '6000-WRITE-STAMPING-FILE'.                         18700000
            INITIALIZE BP13K625-REC.                                    18710000
            MOVE  SPACES                TO BP13K625-REC.                18720000
                                                                        18730000
            PERFORM 1500-READ-BP13KD45  THRU 1500-EXIT.                 18740000
                                                                        18750000
            MOVE F315-SCH-ACC           TO WS-NUM-HDB-REF.              18760000
            MOVE 'DAS'                  TO WS-NUM-DOC.                  18770000
                                                                        18780000
      ****  WRITE DETAIL PART FOR ORIGINAL MORTGAGE STAMP FEE*******    18790000
            MOVE  'O'                   TO WS-NUM-DOC-TYP.              18800000
                                                                        18810000
            IF WS-MORT-SF > 0                                           18820000
               COMPUTE WS-MORT-SF = WS-MORT-SF - DUP-DOA-AMT            18830000
            END-IF.                                                     18840000
                                                                        18850000
            MOVE  WS-MORT-SF             TO WS-AMT-STAMP-DUTY.          18860000
            MOVE  ZEROES                 TO WS-AMT-STAMP-DUTY-DUP.      18870000
                                                                        18880000
            IF WS-AMT-STAMP-DUTY > 0                                    18890000
               PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT        18900000
               PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT        18910000
               MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY        18920000
               MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP    18930000
               WRITE BP13K625-REC                                       18940000
               ADD   1   TO  WS-BP13K625-WRITE-CNT                      18950000
            ELSE                                                        18960000
               NEXT SENTENCE                                            18970000
            END-IF.                                                     18980000
                                                                        18990000
      ****  WRITE DETAIL PART FOR DUPLICATE MORTGAGE STAMP FEE*******   19000000
            MOVE  'D'                    TO WS-NUM-DOC-TYP.             19010000
            MOVE  ZEROES                 TO WS-AMT-STAMP-DUTY.          19020000
            MOVE  WS-DUP-DOA             TO WS-AMT-STAMP-DUTY-DUP.      19030000
                                                                        19040000
            IF WS-AMT-STAMP-DUTY-DUP > 0                                19050000
               PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT        19060000
               PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT        19070000
               MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY        19080000
               MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP    19090000
               WRITE BP13K625-REC                                       19100000
               ADD   1   TO  WS-BP13K625-WRITE-CNT                      19110000
            ELSE                                                        19120000
               NEXT SENTENCE                                            19130000
            END-IF.                                                     19140000
                                                                        19150000
      ****  WRITE DETAIL PART FOR ORIGINAL S&P FEE   *******            19160000
            MOVE  'ALE'               TO WS-NUM-DOC.                    19170000
            MOVE  'O'                 TO WS-NUM-DOC-TYP.                19180000
            PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT.          19190000
            PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT.          19200000
            MOVE  WS-LEASE-STAMP      TO K625-AMT-STAMP-DUTY.           19210000
            MOVE  ZEROES              TO K625-AMT-STAMP-DUTY-DUP.       19220000
            WRITE BP13K625-REC.                                         19230000
            ADD   1                   TO WS-BP13K625-WRITE-CNT.         19240000
                                                                        19250000
      ****  WRITE DETAIL PART FOR DUPLICATE S&P FEE   *******           19260000
            MOVE  'D'                 TO WS-NUM-DOC-TYP.                19270000
            PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT.          19280000
            PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT.          19290000
            MOVE  ZEROES              TO K625-AMT-STAMP-DUTY.           19300000
            MOVE  DUP-SA-AMT          TO K625-AMT-STAMP-DUTY-DUP.       19310000
            WRITE BP13K625-REC.                                         19320000
            ADD   1                   TO WS-BP13K625-WRITE-CNT.         19330000
                                                                        19340000
       6000-EXIT.                                                       19350000
           EXIT.                                                        19360000
                                                                        19370000
                                                                        19380000
      ******************************************************************19390000
       6100-CHK-EXISTING-BP13K625.                                      19400000
      ******************************************************************19410000
           MOVE WS-NUM-HDB-REF          TO K625-NUM-HDB-REF.            19420000
           MOVE WS-NUM-DOC              TO K625-NUM-DOC.                19430000
           MOVE WS-NUM-DOC-TYP          TO K625-NUM-DOC-TYP.            19440000
           MOVE 1                       TO K625-NUM-DOC-CNT.            19450000
           MOVE 'N'                     TO WS-K625-EOF.                 19460000
                                                                        19470000
           START BP13K625 KEY = K625-KEY-FLD.                           19480000
                                                                        19490000
           EVALUATE  WS-K625-STATUS                                     19500000
              WHEN '00'                                                 19510000
                    PERFORM 6200-READNEXT-BP13K625 THRU 6200-EXIT       19520000
                            UNTIL WS-K625-EOF = 'Y'                     19530000
                    ADD  1              TO WS-NUM-DOC-CNT               19540000
              WHEN '10'                                                 19550000
              WHEN '23'                                                 19560000
                    MOVE 1              TO WS-NUM-DOC-CNT               19570000
              WHEN OTHER                                                19580000
                    DISPLAY 'ERROR WHILE STARTING BROWSE-BP13K625 '     19590000
                    MOVE WS-K625-STATUS TO RETURN-CODE                  19600000
                    PERFORM 9000-CLOSE-FILES THRU 9000-EXIT             19610000
           END-EVALUATE.                                                19620000
                                                                        19630000
       6100-EXIT.                                                       19640000
           EXIT.                                                        19650000
                                                                        19660000
                                                                        19670000
      ******************************************************************19680000
       6200-READNEXT-BP13K625.                                          19690000
      ******************************************************************19700000
           READ BP13K625 NEXT AT END MOVE 'Y' TO WS-K625-EOF            19710000
              GO TO 6200-EXIT.                                          19720000
                                                                        19730000
           IF (K625-NUM-HDB-REF NOT = WS-NUM-HDB-REF) OR                19740000
              (K625-NUM-DOC     NOT = WS-NUM-DOC)     OR                19750000
              (K625-NUM-DOC-TYP NOT = WS-NUM-DOC-TYP)                   19760000
              MOVE 'Y'                  TO WS-K625-EOF                  19770000
              GO TO 6200-EXIT                                           19780000
           END-IF.                                                      19790000
                                                                        19800000
           MOVE K625-NUM-DOC-CNT        TO WS-NUM-DOC-CNT.              19810000
                                                                        19820000
       6200-EXIT.                                                       19830000
           EXIT.                                                        19840000
                                                                        19850000
                                                                        19860000
      ******************************************************************19870000
       6300-MAIN-DETAILS-TO-K625.                                       19880000
      ******************************************************************19890000
            MOVE  SPACES                 TO BP13K625-REC.               19900000
            INITIALIZE                      BP13K625-REC.               19910000
                                                                        19920000
            MOVE  F315-SCH-ACC           TO K625-NUM-HDB-REF.           19930000
            MOVE  WS-NUM-DOC             TO K625-NUM-DOC.               19940000
            MOVE  WS-NUM-DOC-TYP         TO K625-NUM-DOC-TYP.           19950000
            MOVE  WS-NUM-DOC-CNT         TO K625-NUM-DOC-CNT.           19960000
            MOVE  C907-NUM-DDD           TO K625-NUM-DDD.               19970000
            MOVE  C907-NUM-FIN-YR        TO K625-NUM-FIN-YEAR.          19980000
            MOVE  C907-NUM-VR-SERIAL     TO K625-NUM-VR-SERIAL.         19990000
            MOVE  C906-NUM-BATCH-TYPE    TO K625-NUM-BATCH-TYPE.        20000000
            MOVE  C906-NUM-FIN-YEAR      TO K625-NUM-CAL-YEAR.          20010000
            MOVE  C906-NUM-BATCH-SERIAL  TO K625-NUM-BATCH-SERIAL.      20020000
            MOVE  F315-REGN-NO           TO K625-NUM-REGN.              20030000
            MOVE  WS-DTE-SALE-AGRM       TO K625-DTE-DOC-PREPARE.       20040000
            MOVE  WS-SELL-PRICE          TO K625-AMT-PURCHASE-PRICE.    20050000
            MOVE  WS-ANNUAL-RENT         TO K625-AMT-ANNUAL-RENT.       20060000
            MOVE  SPACES                 TO K625-NUM-INCREASE-SCCC.     20070000
            MOVE  WS-LOAN-GRANTED        TO K625-AMT-LOAN.              20080000
            MOVE  'BP13C43B'             TO K625-NUM-SYSTEM.            20090000
            MOVE  FUNCTION CURRENT-DATE  TO K625-DTE-UPDATE.            20100000
            COMPUTE K625-NUM-LEASE-TERM = 99 * 12.                      20110000
                                                                        20120000
       6300-EXIT.                                                       20130000
           EXIT.                                                        20140000
                                                                        20150000
                                                                        20160000
      ******************************************************************20170000
       6500-PRINT-L43BK-REPORT.                                         20180000
      ******************************************************************20190000
           IF WS-L43BK-REC-ON-PAGE-CNT > 65                             20200000
              PERFORM 6510-PRINT-L43B-HEADER     THRU 6510-EXIT         20210000
           END-IF.                                                      20220000
                                                                        20230000
           MOVE SPACES                TO L43BK-REC-DETAIL.              20240000
           INITIALIZE                    L43BK-REC-DETAIL.              20250000
                                                                        20260000
           ADD  1                     TO WS-L43BK-PRINT-CNT.            20270000
           MOVE WS-L43BK-PRINT-CNT    TO L43BK-SERIAL-NO.               20280000
           MOVE F315-REGN-NO          TO L43BK-REGN-NO.                 20290000
                                                                        20300000
           STRING F315-SCH-ACC(1:4) '-'                                 20310000
                  F315-SCH-ACC(5:4) '-'                                 20320000
                  F315-SCH-ACC(9:1) '-'                                 20330000
                  F315-SCH-ACC(10:2)                                    20340000
                  DELIMITED BY SIZE INTO L43BK-SCH-ACC                  20350000
           END-STRING.                                                  20360000
                                                                        20370000
           STRING C907-NUM-DDD    '-'                                   20380000
                  C907-NUM-FIN-YR '-'                                   20390000
                  C907-NUM-VR-SERIAL                                    20400000
                  DELIMITED BY SIZE INTO L43BK-JR-VCHR-NO               20410000
           END-STRING.                                                  20420000
                                                                        20430000
           MOVE WS-AMT-EARMARK    TO L43BK-AMT-TOTAL.                   20440000
                                                                        20450000
           EVALUATE B902-CDE-ERROR-ACCT(1)                              20460000
              WHEN 'S0045'                                              20470000
                 MOVE 'B05K006 FILE ERROR'         TO L43BK-ERROR-DESC  20480000
              WHEN 'S0052'                                              20490000
                 MOVE 'INVALID INPUT      '        TO L43BK-ERROR-DESC  20500000
              WHEN 'S0053'                                              20510000
                 MOVE 'AB05K009 FILE ERROR'        TO L43BK-ERROR-DESC  20520000
              WHEN 'S0054'                                              20530000
                 MOVE 'B05K006 REC NOT FND'        TO L43BK-ERROR-DESC  20540000
              WHEN 'S0055'                                              20550000
                 MOVE 'NOT ENOUGH BALANCE'         TO L43BK-ERROR-DESC  20560000
              WHEN OTHER                                                20570000
                 MOVE 'AB05C902 SUBROUTINE ERROR'  TO L43BK-ERROR-DESC  20580000
           END-EVALUATE.                                                20590000
                                                                        20600000
           WRITE L43BK-PRINT-REC  FROM L43BK-REC-DETAIL  AFTER 1.       20610000
                                                                        20620000
           ADD   1     TO  WS-L43BK-REC-ON-PAGE-CNT.                    20630000
                                                                        20640000
       6500-EXIT.                                                       20650000
           EXIT.                                                        20660000
                                                                        20670000
                                                                        20680000
      ******************************************************************20690000
       6510-PRINT-L43B-HEADER.                                          20700000
      ******************************************************************20710000
           ADD  1                 TO   WS-L43BK-PAGE-CNT.               20720000
           MOVE WS-L43BK-PAGE-CNT TO   L43B-PAGE.                       20730000
           MOVE 'P13L43BK'        TO   L43B-REPORT-ID.                  20740000
           WRITE L43BK-PRINT-REC  FROM PRT-L43B-HDG-1    AFTER PAGE.    20750000
           WRITE L43BK-PRINT-REC  FROM L43BK-HEADER2     AFTER 2.       20760000
           WRITE L43BK-PRINT-REC  FROM L43BK-HEADER3     AFTER 2.       20770000
           WRITE L43BK-PRINT-REC  FROM L43BK-UNDERLINE   AFTER 1.       20780000
           MOVE  6                TO   WS-L43BK-REC-ON-PAGE-CNT.        20790000
                                                                        20800000
       6510-EXIT.                                                       20810000
           EXIT.                                                        20820000
                                                                        20830000
                                                                        20840000
      ******************************************************************20850000
       8000-DISPLAY-STATISTICS.                                         20860000
      ******************************************************************20870000
            MOVE    WS-BP13F315-READ-CNT  TO  WS-EDIT-BP13F315-READ.    20880000
            MOVE    WS-L43BJ-PRINT-CNT    TO  WS-EDIT-L43BJ-PRINT.      20890000
            MOVE    WS-AG07F225-WRITE-CNT TO  WS-EDIT-AG07F225-WRITE.   20900000
                                                                        20910000
            DISPLAY WS-BLANK-LINE.                                      20920000
            DISPLAY WS-SUMMARY-HEADER.                                  20930000
            DISPLAY WS-BLANK-LINE.                                      20940000
            DISPLAY WS-READ-CASES.                                      20950000
            DISPLAY WS-DOA-PAYMENT-PRINTED.                             20960000
            DISPLAY WS-L43BJ-PRINTED.                                   20970000
            DISPLAY WS-STAMP-FEES-REC-WRITTEN.                          20980000
            DISPLAY WS-BLANK-LINE.                                      20990000
            DISPLAY WS-SUMMARY-TRAILER.                                 21000000
            DISPLAY 'NO OF RECORDS WRITTEN TO             (BP13K625) = '21010000
                    WS-BP13K625-WRITE-CNT.                              21020000
            DISPLAY 'NO OF RECS WITH ERROR IN EARMARK                = '21030000
                    WS-L43BK-PRINT-CNT.                                 21040000
                                                                        21050000
       8000-EXIT.                                                       21060000
            EXIT.                                                       21070000
                                                                        21080000
                                                                        21090000
      ******************************************************************21100000
       9000-CLOSE-FILES.                                                21110000
      ******************************************************************21120000
      *     CLOSE  B05K006                                              21130000
            CLOSE  BP13F315                                             21140000
                   AG07F225                                             21150000
                   BP13K410                                             21160000
                   BP13KD03                                             21170000
                   BP13KA10                                             21180000
                   BP13KD45                                             21190000
                                                                        21200000
                   BP1343BJ                                             21210000
                   BP1343BL                                             21220000
                                                                        21230000
                   BP1343BK                                             21240000
                                                                        21250000
                   BP13K625.                                            21260000
                                                                        21270000
            IF WS-K006-STATUS NOT = 00 AND 97                           21280000
               DISPLAY 'ERROR CLOSING B05K006, STAT = ' WS-K006-STATUS  21290000
               MOVE     WS-K006-STATUS     TO  RETURN-CODE              21300000
            END-IF.                                                     21310000
                                                                        21320000
            IF WS-K410-STATUS NOT = 00 AND 97                           21330000
               DISPLAY 'ERROR CLOSING BP13K410, STAT = ' WS-K410-STATUS 21340000
               MOVE     WS-K410-STATUS      TO  RETURN-CODE             21350000
            END-IF.                                                     21360000
                                                                        21370000
            IF WS-KD03-STATUS NOT = 00 AND 97                           21380000
               DISPLAY 'ERROR CLOSING BP13KD03, STAT = ' WS-KD03-STATUS 21390000
               MOVE     WS-KD03-STATUS      TO  RETURN-CODE             21400000
            END-IF.                                                     21410000
                                                                        21420000
            IF WS-KA10-STATUS NOT = 00 AND 97                           21430000
               DISPLAY 'ERROR CLOSING BP13KA10, STAT = ' WS-KA10-STATUS 21440000
               MOVE     WS-KA10-STATUS      TO  RETURN-CODE             21450000
            END-IF.                                                     21460000
                                                                        21470000
            IF WS-KD45-STATUS NOT = 00 AND 97                           21480000
               DISPLAY 'ERROR CLOSING BP13KD45, STAT = ' WS-KD45-STATUS 21490000
               MOVE     WS-KD45-STATUS      TO  RETURN-CODE             21500000
            END-IF.                                                     21510000
                                                                        21520000
            IF WS-K625-STATUS NOT = 00 AND 97                           21530000
              DISPLAY 'ERROR CLOSING BP13K625, STAT = ' WS-K625-STATUS  21540000
              MOVE     WS-K625-STATUS      TO  RETURN-CODE              21550000
            END-IF.                                                     21560000
                                                                        21570000
            MOVE 'AG07K960'  TO     C907-NUM-FILENME.                   21580000
            CALL 'K960CLSE'  USING  AG07C907-AREA.                      21590000
                                                                        21600000
            IF C907-NUM-FILE-STATUS NOT = ('00' AND '97')               21610000
               DISPLAY 'ERROR CLOSING AG07K960, STATUS = '              21620000
                        C907-NUM-FILE-STATUS                            21630000
               MOVE     C907-NUM-FILE-STATUS    TO  WS-AG07-STAT-X      21640000
               MOVE     WS-AG07-STATUS          TO  RETURN-CODE         21650000
            END-IF.                                                     21660000
                                                                        21670000
            MOVE 'BP13K620'  TO     C906-NUM-FILENME.                   21680000
            CALL 'K620MCLS'  USING  BP13C906-AREA.                      21690000
                                                                        21700000
            IF C906-NUM-FILE-STATUS NOT = ('00' AND '97')               21710000
               DISPLAY 'ERROR CLOSING BP13K620, STATUS = '              21720000
                        C906-NUM-FILE-STATUS                            21730000
               MOVE     C906-NUM-FILE-STATUS    TO  WS-AG07-STAT-X      21740000
               MOVE     WS-AG07-STATUS          TO  RETURN-CODE         21750000
            END-IF.                                                     21760000
                                                                        21770000
      **CALL AB05C902 TO CLOSE B05K006 AND AB05K009 FILES(CODE='C')     21780000
            MOVE SPACES              TO   WS-B902-AREA.                 21790000
            INITIALIZE                    WS-B902-AREA.                 21800000
            MOVE 'C'                 TO   B902-CDE-TYPE.                21810000
            CALL 'AB05C902'  USING WS-B902-AREA.                        21820000
                                                                        21830000
            IF B902-CDE-ERROR NOT = ZEROES                              21840000
               MOVE B902-CDE-SYSERR  TO   RETURN-CODE                   21850000
               DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'            21860000
            END-IF.                                                     21870000
                                                                        21880000
            STOP RUN.                                                   21890000
                                                                        21900000
       9000-EXIT.                                                       21910000
            EXIT.                                                       21920000
                                                                        21930000
                                                                        21940000
      ******************************************************************21950000
       9500-CONVT-AMT-WORD.                                             21960000
      ******************************************************************21970000
      *------------------------------------------------------------*    21980000
      *                                                            *    21990000
      *     OBJECTIVE  :  CONVERSION FROM AMOUNT IN DIGITS         *    22000000
      *                              INTO AMOUNT IN WORDS          *    22010000
      *                                                            *    22020000
      *------------------------------------------------------------*    22030000
            MOVE SPACES TO WF-DETAILS.                                  22040000
            MOVE ZERO   TO WS-SWITCH                                    22050000
                           WS-THO-SW                                    22060000
                           WS-CNT-SW                                    22070000
                           WS-LIT-SW                                    22080000
                           WS-TEN-SW                                    22090000
                           WS-AND-SW.                                   22100000
            MOVE 60     TO WS-PLACE-COUNTER.                            22110000
            MOVE 1      TO WF-SUB.                                      22120000
                                                                        22130000
            PERFORM B000-ROUTINE THRU B990-EXIT                         22140000
                         VARYING WS-SUB FROM 1 BY 1 UNTIL WS-SUB = 10.  22150000
                                                                        22160000
       9500-EXIT.                                                       22170000
            EXIT.                                                       22180000
                                                                        22190000
                                                                        22200000
      ******************************************************************22210000
       B000-ROUTINE SECTION.                                            22220000
      ******************************************************************22230000
       B000-GO.                                                         22240000
            IF WS-DIGIT (WS-SUB) = ZERO                                 22250000
                 IF WS-TEN-SW = ZERO                                    22260000
                    GO TO B800-MOVE-TYPE                                22270000
                 ELSE                                                   22280000
                    GO TO B010-PROCESS.                                 22290000
                                                                        22300000
            IF WS-FIRST-SUB = ZERO                                      22310000
               MOVE WS-SUB TO WS-FIRST-SUB.                             22320000
                                                                        22330000
            IF WS-SWITCH = ZERO                                         22340000
               MOVE 1 TO WS-SWITCH.                                     22350000
                                                                        22360000
       B010-PROCESS.                                                    22370000
            IF WS-SUB = 8                                               22380000
               MOVE 9 TO WS-CNT-SW.                                     22390000
                                                                        22400000
            IF WS-SUB = 9                                               22410000
               IF WS-CNT-SW = ZERO                                      22420000
                  MOVE WS-DIGIT (WS-SUB) TO WS-CNT-SW.                  22430000
                                                                        22440000
            IF WS-SUB = 2 OR 3 OR 4                                     22450000
               MOVE 1 TO WS-THO-SW.                                     22460000
                                                                        22470000
            MOVE WS-DIGIT (WS-SUB) TO WA-SUB.                           22480000
            IF WS-SUB = 3 OR 6 OR 8                                     22490000
               IF WS-DIGIT (WS-SUB) = 1                                 22500000
                  MOVE 1 TO WS-TEN-SW                                   22510000
                  GO TO B990-EXIT                                       22520000
               ELSE                                                     22530000
                  ADD 18 TO WA-SUB                                      22540000
            ELSE                                                        22550000
            IF WS-SUB = 1 OR 4 OR 7 OR 9                                22560000
               IF WS-TEN-SW = 1                                         22570000
                  MOVE 0 TO WS-TEN-SW                                   22580000
                  ADD 10 TO WA-SUB.                                     22590000
            MOVE WA-NAME (WA-SUB) TO WL-AREA.                           22600000
            PERFORM R000-LOAD-IN.                                       22610000
                                                                        22620000
       B300-TENS.                                                       22630000
            IF WS-SUB = 3 OR 6 OR 8                                     22640000
               GO TO B990-EXIT.                                         22650000
                                                                        22660000
       B400-MOVE-HUNDRED.                                               22670000
            IF WS-SUB = 2 OR 5                                          22680000
               MOVE L-HUNDRED TO WL-AREA                                22690000
               MOVE 1 TO WS-LIT-SW                                      22700000
               PERFORM R000-LOAD-IN                                     22710000
               MOVE 1 TO WS-AND-SW                                      22720000
               GO TO B990-EXIT.                                         22730000
                                                                        22740000
       B800-MOVE-TYPE.                                                  22750000
            IF WS-SWITCH = ZERO                                         22760000
               GO TO B990-EXIT.                                         22770000
                                                                        22780000
            IF WS-SUB = 1                                               22790000
               MOVE  L-MILLION TO WL-AREA                               22800000
               MOVE  1         TO WS-LIT-SW                             22810000
               MOVE  1         TO WS-AND-SW                             22820000
               GO TO B880-LOAD-IN.                                      22830000
                                                                        22840000
            IF WS-SUB = 7                                               22850000
               MOVE 1 TO WS-LIT-SW WS-AND-SW                            22860000
               IF WS-FIRST-SUB = 7  AND                                 22870000
                  WS-DIGIT (WS-SUB) = 1                                 22880000
                  MOVE L-DOLLAR TO WL-AREA                              22890000
                  GO TO B880-LOAD-IN                                    22900000
               ELSE                                                     22910000
                  MOVE L-DOLLARS TO WL-AREA                             22920000
                  GO TO B880-LOAD-IN.                                   22930000
                                                                        22940000
            IF WS-SUB = 4 AND WS-THO-SW = 1                             22950000
               MOVE 1 TO WS-AND-SW WS-LIT-SW                            22960000
               MOVE L-THOUSAND TO WL-AREA                               22970000
               GO TO B880-LOAD-IN.                                      22980000
                                                                        22990000
            IF WS-SUB = 9                                               23000000
               MOVE 1 TO WS-LIT-SW                                      23010000
               IF WS-CNT-SW = ZERO                                      23020000
                  MOVE L-ONLY TO WL-AREA                                23030000
                  GO TO B880-LOAD-IN                                    23040000
               ELSE                                                     23050000
               IF WS-CNT-SW = 1                                         23060000
                  MOVE L-CENT TO WL-AREA                                23070000
                  PERFORM R000-LOAD-IN                                  23080000
                  MOVE L-ONLY TO WL-AREA                                23090000
                  GO TO B880-LOAD-IN                                    23100000
               ELSE                                                     23110000
                  MOVE L-CENTS TO WL-AREA                               23120000
                  PERFORM R000-LOAD-IN                                  23130000
                  MOVE L-ONLY TO WL-AREA                                23140000
                  GO TO B880-LOAD-IN.                                   23150000
            GO TO B990-EXIT.                                            23160000
                                                                        23170000
       B880-LOAD-IN.                                                    23180000
            PERFORM R000-LOAD-IN.                                       23190000
                                                                        23200000
       B990-EXIT.                                                       23210000
            EXIT.                                                       23220000
                                                                        23230000
                                                                        23240000
      ******************************************************************23250000
       R000-LOAD-IN SECTION.                                            23260000
      ******************************************************************23270000
      *------------------------------------------------------------*    23280000
      *                                                            *    23290000
      *     THIS SECTION LOADS THE WORDS INTO THE THREE LINES      *    23300000
      *     AND JUST KEEPS INCREMENTING A SUBSCRIPT.               *    23310000
      *                                                            *    23320000
      *------------------------------------------------------------*    23330000
                                                                        23340000
       R001-GO.                                                         23350000
            IF WS-LIT-SW = 1                                            23360000
               MOVE ZERO TO WS-LIT-SW                                   23370000
               GO TO R050-CONT.                                         23380000
                                                                        23390000
            IF WS-SUB = 2 OR 5                                          23400000
               GO TO R050-CONT.                                         23410000
                                                                        23420000
       R025-ADD-TEST.                                                   23430000
            IF WS-AND-SW NOT = 1                                        23440000
               GO TO R050-CONT.                                         23450000
                                                                        23460000
            MOVE ZERO TO WS-AND-SW.                                     23470000
            MOVE WL-AREA TO WL-AREA-SAVE.                               23480000
            MOVE L-AND TO WL-AREA.                                      23490000
            PERFORM R200-LOADUP.                                        23500000
            MOVE WL-AREA-SAVE TO WL-AREA.                               23510000
                                                                        23520000
       R050-CONT.                                                       23530000
            PERFORM R200-LOADUP.                                        23540000
                                                                        23550000
       R099-EXIT.                                                       23560000
            EXIT.                                                       23570000
                                                                        23580000
                                                                        23590000
      ******************************************************************23600000
       R200-LOADUP SECTION.                                             23610000
      ******************************************************************23620000
       R201-GO.                                                         23630000
            ADD WL-ITEM1 WF-SUB GIVING WS-RESULT.                       23640000
            IF  WS-RESULT > WS-PLACE-COUNTER                            23650000
                ADD 1 WS-PLACE-COUNTER GIVING WF-SUB                    23660000
                ADD 60 TO WS-PLACE-COUNTER.                             23670000
                                                                        23680000
            PERFORM R500-LOAD VARYING WL-SUB FROM 2 BY 1 UNTIL          23690000
                    WL-ITEM (WL-SUB) = L-X.                             23700000
                                                                        23710000
       R490-EXIT.                                                       23720000
           EXIT.                                                        23730000
                                                                        23740000
                                                                        23750000
      ******************************************************************23760000
       R500-LOAD SECTION.                                               23770000
      ******************************************************************23780000
       R501-GO.                                                         23790000
                                                                        23800000
            MOVE WL-ITEM (WL-SUB) TO WF-ITEM (WF-SUB).                  23810000
            ADD  1                TO WF-SUB.                            23820000
            IF WL-ITEM (WL-SUB) = SPACE                                 23830000
               ADD   1     TO     WL-SUB                                23840000
               MOVE  L-X   TO     WL-ITEM (WL-SUB)                      23850000
               SUBTRACT 1  FROM   WL-SUB.                               23860000
                                                                        23870000
       R990-EXIT.                                                       23880000
            EXIT.                                                       23890000
