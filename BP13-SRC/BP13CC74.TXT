      *----------------------------------------------------------------*        
       IDENTIFICATION DIVISION.                                                 
      *----------------------------------------------------------------*        
       PROGRAM-ID.    BP13CC74.                                                 
       AUTHOR.        ARIEL HERNANDEZ.                                          
       DATE-WRITTEN.  11/04/2007.                                               
                                                                                
      ******************************************************************        
      *                                                                *        
      *   SYSTEM NAME :  SYSTEM OF COMMITMENT  (SOC)                   *        
      *                                                                *        
      *   SYSTEM ID   :  BP13                                          *        
      *                                                                *        
      *   OBJECTIVE   :  TO CREATE INTEREST REBATE FOR LUMP SUM PAYMENT*        
      *                                                                *        
      *   INPUT FILES  : 1.  BP13F125                                  *        
      *                  2.  SY02F001                                  *        
      *   I-O FILES    : 1.  BP13KD92                                  *        
      *                  2.  BP13KD94                                  *        
      *                  3.  BP13KD00                                  *        
      *                  4.  BP13KD99                                  *        
      *                                                                *        
      *   OUTPUT FILES : 1.  BP13FD92 - PAID LUMPSUM AMOUNT            *        
      *                  2.  P13F125A - INTEREST REBATE                *        
      *   REPORT OUTPUT: 1.  BP13LC74 - INTEREST REBATE                *        
      *----------------------------------------------------------------*        
      *                                                                *        
      *   CHGE-NO   BY    DATE      DESCRIPTION                        *        
      *   --------  ---  ---------- -----------                        *        
      *   BP133033  BA3  11/04/2007 NEW PROGRAM                        *        
      *   BP133051  BA3  11/05/2007 COMPUTE INTEREST REBATE PER REGN.  *        
      *   BP133173  BA3  22/10/2007 - ADD NUM-LOAN-SCH                 *        
      *                             - USE CODE LOAN SCHEME TO GET      *        
      *                               INTEREST RATE                    *        
      *                             - UPDATE KD00-AMT-ARR-INTR         *        
      *   BP133171  ED1  02/11/2007 - REMOVE UPD OF KD92/KD94          *        
      *                               DTE&TME-UPDATE FIELDS            *        
      *   BP133091  RB12 16/11/2007 - EXPAND KD00 LNGTH FR 1200 TO 1600*        
      *   BP133091  LMS1 15/12/2007 - EXPAND KD99 LNGTH FR 1250 TO 1650*        
      *   BP133209  ED1  31/01/2008   INITIALIZE KD00-AMT-ARR-INTR     *        
      *   BP133360  ED1  25/07/2008   ADD F125A AMT-INTEREST & LOAN-SCH*        
      *   BP133535  JB8  11/02/2009 - READ/UPD KD03 IF KD00 NOT FOUND  *        
      *   BP133545  JB8  05/03/2009 - TO OUTPUT ALL 'LS' RECORDS       *        
      *   BP133662  JB8  11/01/2009 - USE INPUT DATE AS TRANS DATE     *        
      *   BP133876  PCL3 13/05/2010 - ADD CHECK ON START AND END DATE  *        
      *   BP134089  JB8  26/01/2011 - TO CATER FOR 'LCPF'              *        
      *   BP134154  JB8  15/04/2011 - TO CATER FOR 'LCPF' & 'LUMP'     *        
      *   BP134029  JB8  11/08/2011 - TO CATER FOR LOAN DEDUCTION      *        
      *   BP134029  JB8  12/09/2011 - TO BYPASS CASES AFTER CONVERSION *        
      *   BP134493  IMC1 20/03/2012 - CHANGED MIN LUMPSUM $500 TO $5000*        
      *   BP134500  IMC1 20/04/2012 - CHANGE TO NOT PRINT IF TOT AMT =0*        
      *   BP134673  IMC1 19/09/2012 - FIXED ISSUE WITH OVERLAPPING     *        
      *                               OUTPUT FIELDS WITH PREV RECORD   *        
      ******************************************************************        
                                                                                
      *----------------------------------------------------------------*        
       ENVIRONMENT DIVISION.                                                    
      *----------------------------------------------------------------*        
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F125  ASSIGN        TO BP13F125.                          
           SELECT SY02F001  ASSIGN        TO SY02F001.                          
                                                                                
           SELECT BP13KD92  ASSIGN        TO BP13KD92                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS KD92-KEY-FLD                       
                            FILE STATUS   IS WS-KD92-STATUS.                    
                                                                                
           SELECT BP13KD94  ASSIGN        TO BP13KD94                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS KD94-KEY-FLD                       
                            FILE STATUS   IS WS-KD94-STATUS.                    
                                                                                
           SELECT BP13KD00  ASSIGN        TO BP13KD00                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS KD00-KEY-FLD                       
                            FILE STATUS   IS WS-KD00-STATUS.                    
                                                                                
           SELECT BP13KD03  ASSIGN        TO BP13KD03                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS KD03-KEY-FLD                       
                            FILE STATUS   IS WS-KD03-STATUS.                    
                                                                                
           SELECT BP13KD99  ASSIGN        TO BP13KD99                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS KD99-KEY-FLD                       
                            FILE STATUS   IS WS-KD99-STATUS.                    
                                                                                
           SELECT BP13K482  ASSIGN        TO BP13K482                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K482-KEY-FLD                       
                            FILE STATUS   IS WS-K482-STATUS.                    
                                                                                
           SELECT BP13K800  ASSIGN        TO BP13K800                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K800-NUM-REGN                      
                            FILE STATUS   IS WS-K800-STATUS.                    
                                                                                
           SELECT BP13FD92  ASSIGN        TO BP13FD92.                          
           SELECT P13F125A  ASSIGN        TO P13F125A.                          
           SELECT BP13LC74  ASSIGN        TO BP13LC74.                          
                                                                                
      *----------------------------------------------------------------*        
       DATA DIVISION.                                                           
      *----------------------------------------------------------------*        
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD  BP13F125                                                             
           BLOCK  CONTAINS 0 RECORDS                                            
           RECORD CONTAINS 150 CHARACTERS                                       
           LABEL RECORDS ARE STANDARD.                                          
                                                                                
       COPY BP13F125.                                                           
                                                                                
       COPY SY02F001.                                                           
                                                                                
       FD  BP13KD92                                                             
           RECORD CONTAINS 1000 CHARACTERS.                                     
                                                                                
       COPY BP13KD92.                                                           
                                                                                
       FD  BP13KD94                                                             
           RECORD CONTAINS 1000 CHARACTERS.                                     
                                                                                
       COPY BP13KD94.                                                           
                                                                                
       FD  BP13KD00                                                             
           RECORD CONTAINS 1600 CHARACTERS.                                     
       COPY BP13KD00.                                                           
                                                                                
       FD  BP13KD03                                                             
           RECORD CONTAINS 1600 CHARACTERS.                                     
       COPY BP13KD03.                                                           
                                                                                
       FD  BP13KD99                                                             
           RECORD CONTAINS 1650 CHARACTERS.                                     
       COPY BP13KD99.                                                           
                                                                                
       FD  BP13K482                                                             
           RECORD CONTAINS 1000 CHARACTERS.                                     
       COPY BP13K482.                                                           
                                                                                
       FD  BP13K800                                                             
           RECORD CONTAINS 2000 CHARACTERS.                                     
       COPY BP13K800.                                                           
                                                                                
       FD  BP13FD92                                                             
           BLOCK  CONTAINS 0 RECORDS                                            
           RECORD CONTAINS 1000 CHARACTERS                                      
           LABEL RECORDS ARE STANDARD.                                          
                                                                                
       COPY BP13FD92.                                                           
                                                                                
       FD  P13F125A                                                             
           BLOCK  CONTAINS 0 RECORDS                                            
           RECORD CONTAINS 150 CHARACTERS                                       
           LABEL RECORDS ARE STANDARD.                                          
                                                                                
       01  P13F125A-CASHTRAN.                                                   
           05  F125A-CDE-TRANS-TYPE           PIC XX.                           
           05  FILLER                         PIC XX.                           
           05  F125A-KEY-FLD.                                                   
               10  F125A-NUM-REGN             PIC X(8).                         
               10  F125A-DTE-POST             PIC X(8).                         
               10  F125A-COUNT-HISTORY        PIC 9(3).                         
           05  F125A-NUM-LOAN-SCH             PIC X(1).                         
           05  FILLER                         PIC X(32).                        
           05  F125A-NUM-LOAN-INTR            PIC X(01).                        
           05  F125A-AMT-INTEREST             PIC 9(6)V99.                      
           05  F125A-NUM-RECPT-JRNO           PIC X(14).                        
           05  FILLER                         PIC X.                            
           05  F125A-AMT-RECEIPT              PIC S9(7)V99.                     
           05  F125A-CDE-CRDR                 PIC X.                            
           05  F125A-DTE-TRANS                PIC X(8).                         
           05  F125A-CDE-PAYMENT-TYPE         PIC X(3).                         
           05  F125A-NUM-SCH-ACCT             PIC X(11).                        
           05  FILLER                         PIC X(38).                        
                                                                                
       FD  BP13LC74                                                             
           BLOCK  CONTAINS    0 RECORDS                                         
           RECORD CONTAINS  132 CHARACTERS                                      
           LABEL  RECORD   IS   STANDARD                                        
           RECORDING MODE  IS   F.                                              
                                                                                
       01  BP13LC74-REC      PIC X(132).                                        
                                                                                
      *----------------------------------------------------------------*        
       WORKING-STORAGE SECTION.                                                 
      *----------------------------------------------------------------*        
                                                                                
       COPY WSTABLES.                                                           
                                                                                
       01  BP13F125-CASHTRAN-PREV.                                              
           05  F125-CDE-TRANS-TYPE-PREV      PIC XX.                            
           05  FILLER                        PIC XX.                            
           05  F125-KEY-FLD-PREV.                                               
               10  F125-NUM-REGN-PREV        PIC X(8).                          
               10  F125-DTE-POST-PREV        PIC X(8).                          
               10  F125-COUNT-HISTORY-PREV   PIC 9(3).                          
           05  FILLER                        PIC X(01).                         
           05  F125-NUM-NRIC-PREV            PIC X(09).                         
           05  FILLER                        PIC X(32).                         
           05  F125-NUM-RECPT-JRNO-PREV      PIC X(14).                         
           05  F125-CDE-APPLT-CPF-PREV       PIC X.                             
           05  F125-AMT-RECEIPT-PREV         PIC S9(7)V99.                      
           05  F125-CDE-CRDR-PREV            PIC X.                             
           05  F125-DTE-TRANS-PREV           PIC X(8).                          
           05  F125-CDE-PAYMENT-TYPE-PREV    PIC X(3).                          
           05  F125-NUM-SCH-ACCT-PREV        PIC X(11).                         
           05  FILLER                        PIC X(38).                         
                                                                                
       01 WS-MONTH-NAME.                                                        
          05 WS-STRING PIC X(24) VALUE                                          
                '010203040506070809101112'.                                     
          05 WS-MONTH  REDEFINES WS-STRING OCCURS 12 TIMES PIC XX.              
                                                                                
       01  WS-NUM-2ND-CONC              PIC  X(1)         VALUE SPACES.         
       01  WS-AMT-LON-OS-BF             PIC S9(7)V99      VALUE ZEROES.         
       01  WS-AMT-LON-OS-AF             PIC S9(7)V99      VALUE ZEROES.         
       01  WS-AMT-REBATE-TOT            PIC 9(5)V99 VALUE ZEROES.               
       01  WS-AMT-REBATE-6DEC           PIC 9(5)V9(6)     VALUE ZEROES.         
       01  WS-AMT-REBATE                PIC 9(5)V99 VALUE ZEROES.               
      *01  REDEFINES WS-AMT-REBATE.                                             
      *    05  WS-WHOLE-NUM             PIC 9(5).                               
      *    05  WS-1ST-DEC-DIGIT         PIC 9(1).                               
      *    05  WS-2ST-DEC-DIGIT         PIC 9(1).                               
                                                                                
       01  WS-MORE-RECS                 PIC    X    VALUE SPACES.               
       01  WS-NUM-DAYS                  PIC 9(03)   VALUE ZERO.                 
       01  WS-QUOTIENT                  PIC 9(04)   VALUE ZERO.                 
       01  WS-REMAINDER                 PIC 9(04)   VALUE ZERO.                 
       01  WS-NUM-PERIOD                PIC 9(01)V9(15)   VALUE ZERO.           
                                                                                
       01  WS-KD92-FND                  PIC X(01)   VALUE SPACES.               
           88  KD92-FND                 VALUE 'Y'.                              
       01  WS-KD00-FND                  PIC X(01)   VALUE SPACES.               
           88  KD00-FND                 VALUE 'Y'.                              
       01  WS-KD03-FND                  PIC X(01)   VALUE SPACES.               
           88  KD03-FND                 VALUE 'Y'.                              
       01  WS-K482-FND                  PIC X(01)   VALUE SPACES.               
           88  K482-FND                 VALUE 'Y'.                              
       01  WS-EOF-F125                  PIC X(01)   VALUE SPACES.               
       01  CNT-F125-READ                PIC 9(05)   VALUE ZEROES.               
       01  CNT-FD92-WRITE               PIC 9(05)   VALUE ZEROES.               
       01  WS-KD92-STATUS               PIC 9(2)    VALUE ZEROES.               
       01  WS-KD94-STATUS               PIC 9(2)    VALUE ZEROES.               
       01  WS-KD00-STATUS               PIC 9(2)    VALUE ZEROES.               
       01  WS-KD03-STATUS               PIC 9(2)    VALUE ZEROES.               
       01  WS-KD99-STATUS               PIC 9(2)    VALUE ZERO.                 
       01  WS-K482-STATUS               PIC 9(2)    VALUE ZERO.                 
       01  WS-K800-STATUS               PIC 9(2)    VALUE ZERO.                 
       01  CNT-K482-UPDATE              PIC 9(8)    VALUE ZEROES.               
       01  CNT-KD92-READ                PIC 9(8)    VALUE ZEROES.               
       01  CNT-KD00-READ                PIC 9(8)    VALUE ZEROES.               
       01  CNT-KD92-DELETE              PIC 9(8)    VALUE ZEROES.               
       01  CNT-KD92-UPDATE              PIC 9(8)    VALUE ZEROES.               
       01  CNT-KD92-NOTFOUND            PIC 9(8)    VALUE ZEROES.               
       01  CNT-KD00-NOTFOUND            PIC 9(8)    VALUE ZEROES.               
       01  CNT-KD00-UPDATE              PIC 9(8)    VALUE ZEROES.               
       01  CNT-KD03-UPDATE              PIC 9(8)    VALUE ZEROES.               
       01  CNT-F125-WRITE               PIC 9(8)    VALUE ZEROES.               
       01  CNT-KD99-WRITE               PIC 9(8)    VALUE ZEROES.               
       01  CNT-KD94-WRITE               PIC 9(8)    VALUE ZEROES.               
       01  WS-INTEREST-RATE             PIC S9(2)V9(8)    VALUE ZERO.           
       01  WS-AMT-RECEIPT-TOT           PIC S9(7)V99      VALUE ZEROES.         
       01  WS-PAGE                      PIC 9(5)    VALUE ZEROES.               
       01  WS-SNO                       PIC 9(5)    VALUE ZEROES.               
       01  WS-LINE                      PIC 9(2)    VALUE 60.                   
       01  WS-TMP-INTRATE               PIC 99V99         VALUE ZEROES.         
       01  WS-INT-FORM REDEFINES WS-TMP-INTRATE.                                
           05 WS-PCT1                   PIC X.                                  
           05 WS-PCT2                   PIC X.                                  
           05 WS-PCT3                   PIC X(2).                               
       01  WS-END-DATE-ALPHA            PIC X(8)    VALUE SPACES.               
       01  REDEFINES WS-END-DATE-ALPHA.                                         
           05  WS-END-DATE-CCYY         PIC 9(4).                               
           05  REDEFINES WS-END-DATE-CCYY.                                      
               10  WS-END-DATE-CC       PIC 9(2).                               
               10  WS-END-DATE-YY       PIC 9(2).                               
           05  WS-END-DATE-MM           PIC 9(2).                               
           05  WS-END-DATE-DD           PIC 9(2).                               
       01  WS-START-DATE-ALPHA          PIC X(8)    VALUE SPACES.               
       01  REDEFINES WS-START-DATE-ALPHA.                                       
           05  WS-START-DATE-CCYYMM     PIC 9(6).                               
           05  WS-START-DATE-DD         PIC 9(2).                               
       01  WS-START-DATE-PLUS1-ALPHA    PIC X(8)    VALUE SPACES.               
       01  REDEFINES WS-START-DATE-PLUS1-ALPHA.                                 
           05  WS-START-DATE-P1-CCYYMM  PIC 9(6).                               
           05  WS-START-DATE-P1-DD      PIC 9(2).                               
                                                                                
       01  WS-I                         PIC 9(02)   VALUE ZEROES.               
       01  WS-CPF-TAG                   PIC X(01)   VALUE SPACES.               
       01  WS-INT-REBATE                PIC X(01)   VALUE 'N'.                  
       01  WS-AMT-FIELDS.                                                       
           05  WS-AMT-CASH              PIC S9(07)V99.                          
           05  FILLER OCCURS 4 TIMES.                                           
               10  WS-NUM-CPF           PIC  X(09).                             
               10  WS-AMT-CPF           PIC S9(07)V99.                          
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED  TO SUB-PROGRAM "BP13C950"         *             
      *-----------------------------------------------------------*             
       01  C950-FIELD.                                                          
           05  C950-PROCESS-DATE       PIC X(08).                               
           05  C950-PROCESS-DATE-NUM REDEFINES C950-PROCESS-DATE.               
               10  C950-PROCESS-CC     PIC 99.                                  
               10  C950-PROCESS-YY     PIC 99.                                  
               10  C950-PROCESS-MM     PIC 99.                                  
               10  C950-PROCESS-DD     PIC 99.                                  
           05  C950-INTREST-RATE       PIC 9(02)V9(4).                          
           05  C950-FACT               PIC 9(02).                               
           05  C950-REPYMT-PERIOD      PIC 9(02).                               
           05  C950-CDE-LOAN-SCH       PIC X(01).                               
                                                                                
      *--------------------------------------------------------------           
      *   REPORT LAYOUT                                                         
      *--------------------------------------------------------------           
       01  LC74-PR-HEAD-01.                                                     
           05  LC74-RPTNAME        PIC X(8)      VALUE 'BP13LC74'.              
           05  FILLER              PIC X(5)      VALUE SPACES .                 
           05  FILLER              PIC X(8)      VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(24)     VALUE SPACES.                  
           05  FILLER              PIC X(39)     VALUE                          
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER              PIC X(17)     VALUE SPACES.                  
           05  FILLER              PIC X(7)      VALUE 'DATE :'.                
           05  LC74-DATE           PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(2)      VALUE SPACES.                  
           05  FILLER              PIC X(7)      VALUE 'PAGE : '.               
           05  LC74-PRT-PAGE       PIC ZZZZ9     VALUE ZEROES.                  
                                                                                
       01  LC74-PR-HEAD-02.                                                     
           05  FILLER              PIC X(41)     VALUE SPACES .                 
           05  FILLER              PIC X(46)     VALUE                          
               '     REPORT ON UPDATING OF LUMPSUM PAYMENT    '.                
                                                                                
       01  LC74-PR-HEAD-03.                                                     
           05  FILLER              PIC X(05)     VALUE                          
               ' SNO '.                                                         
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE                          
               'REGN NO'.                                                       
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(11)     VALUE                          
               'SCHEME-ACCT'.                                                   
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(10)     VALUE                          
               'LUMPSUM-RQ'.                                                    
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(10)     VALUE                          
               ' AMOUNT-PD'.                                                    
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(09)     VALUE                          
               'IT-REBATE'.                                                     
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(10)     VALUE                          
               'START-DATE'.                                                    
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(10)     VALUE                          
               ' END-DATE '.                                                    
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(12)     VALUE                          
               ' O/S LOAN BF'.                                                  
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(12)     VALUE                          
               ' O/S LOAN AF'.                                                  
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE                          
               '2ND CONC'.                                                      
                                                                                
       01  LC74-PR-HEAD-04.                                                     
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(04)     VALUE ALL '-'.                 
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE ALL '-'.                 
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(11)     VALUE ALL '-'.                 
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(10)     VALUE ALL '-'.                 
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(10)     VALUE ALL '-'.                 
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(09)     VALUE ALL '-'.                 
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(10)     VALUE ALL '-'.                 
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(10)     VALUE ALL '-'.                 
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(12)     VALUE ALL '-'.                 
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(12)     VALUE ALL '-'.                 
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE ALL '-'.                 
                                                                                
       01  LC74-PR-DTL.                                                         
           05  LC74-PRT-SNO        PIC ZZZZ9     VALUE ZEROES.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  LC74-REGN-NO        PIC X(08)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  LC74-SCH            PIC X(11)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  LC74-AMOUNT-RQ      PIC ZZZ,ZZ9.99      VALUE ZEROES.            
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  LC74-AMOUNT-PD      PIC ZZZ,ZZ9.99      VALUE ZEROES.            
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  LC74-IT-REBATE      PIC ZZ,ZZ9.99 VALUE ZEROES.                  
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  LC74-START-DATE     PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  LC74-END-DATE       PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  LC74-AMT-LON-OS-BF  PIC Z,ZZZ,ZZ9.99    VALUE ZEROES.            
           05  LC74-AMT-BF-SIGN    PIC X         VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  LC74-AMT-LON-OS-AF  PIC Z,ZZZ,ZZ9.99    VALUE ZEROES.            
           05  LC74-AMT-AF-SIGN    PIC X         VALUE SPACES.                  
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  LC74-NUM-2ND-CONC   PIC X         VALUE 'Y'.                     
                                                                                
      *----------------------------------------------------------------*        
       PROCEDURE DIVISION.                                                      
      *----------------------------------------------------------------*        
                                                                                
      *----------------------------------------------------------------*        
       0000-MAIN-ROUTINE.                                                       
      *----------------------------------------------------------------*        
                                                                                
           PERFORM 1000-OPEN-FILES         THRU 1000-EXIT.                      
           PERFORM 2000-READ-BP13F125      THRU 2000-EXIT.                      
           PERFORM 3000-PROCESS            THRU 3000-EXIT                       
             UNTIL WS-EOF-F125 = 'Y'.                                           
           PERFORM 4000-PROCESS-INTEREST   THRU 4000-EXIT                       
           PERFORM 9000-CLOSE-ROUTINE      THRU 9000-EXIT.                      
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       1000-OPEN-FILES.                                                         
      *----------------------------------------------------------------*        
                                                                                
           OPEN INPUT  BP13F125                                                 
                       SY02F001                                                 
                       BP13K800                                                 
                I-O    BP13KD92                                                 
                       BP13KD94                                                 
                       BP13KD00                                                 
                       BP13KD03                                                 
                       BP13KD99                                                 
                       BP13K482                                                 
                OUTPUT BP13FD92                                                 
                       P13F125A                                                 
                       BP13LC74.                                                
                                                                                
           IF WS-KD92-STATUS NOT = 00 AND 97                                    
               DISPLAY 'OPENING ERROR, BP13KD92-STATUS ' WS-KD92-STATUS         
               MOVE     WS-KD92-STATUS     TO RETURN-CODE                       
               PERFORM  9000-CLOSE-ROUTINE THRU 9000-EXIT                       
           END-IF.                                                              
           IF WS-KD94-STATUS NOT = 00 AND 97                                    
               DISPLAY 'OPENING ERROR, BP13KD94-STATUS ' WS-KD94-STATUS         
               MOVE     WS-KD94-STATUS     TO RETURN-CODE                       
               PERFORM  9000-CLOSE-ROUTINE THRU 9000-EXIT                       
           END-IF.                                                              
           IF WS-KD00-STATUS NOT = 00 AND 97                                    
               DISPLAY 'OPENING ERROR, BP13KD00-STATUS ' WS-KD00-STATUS         
               MOVE     WS-KD00-STATUS     TO RETURN-CODE                       
               PERFORM  9000-CLOSE-ROUTINE THRU 9000-EXIT                       
           END-IF.                                                              
           IF WS-KD03-STATUS NOT = 00 AND 97                                    
               DISPLAY 'OPENING ERROR, BP13KD03-STATUS ' WS-KD03-STATUS         
               MOVE     WS-KD03-STATUS     TO RETURN-CODE                       
               PERFORM  9000-CLOSE-ROUTINE THRU 9000-EXIT                       
           END-IF.                                                              
           IF WS-KD99-STATUS NOT = 00 AND 97                                    
               DISPLAY 'OPENING ERROR, BP13KD99-STATUS ' WS-KD99-STATUS         
               MOVE     WS-KD99-STATUS     TO RETURN-CODE                       
               PERFORM  9000-CLOSE-ROUTINE THRU 9000-EXIT                       
           END-IF.                                                              
           IF WS-K482-STATUS NOT = 00 AND 97                                    
               DISPLAY 'OPENING ERROR, BP13K482-STATUS ' WS-K482-STATUS         
               MOVE     WS-K482-STATUS     TO RETURN-CODE                       
               PERFORM  9000-CLOSE-ROUTINE THRU 9000-EXIT                       
           END-IF.                                                              
           IF WS-K800-STATUS NOT = 00 AND 97                                    
               DISPLAY 'OPENING ERROR, BP13K800-STATUS ' WS-K800-STATUS         
               MOVE     WS-K800-STATUS     TO RETURN-CODE                       
               PERFORM  9000-CLOSE-ROUTINE THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           PERFORM 1500-READ-SY02F001   THRU 1500-EXIT.                         
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       1500-READ-SY02F001.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ SY02F001.                                                       
                                                                                
           STRING F001-DTE-CURRENT(7:2) '/'                                     
                  F001-DTE-CURRENT(5:2) '/'                                     
                  F001-DTE-CURRENT(1:4)                                         
                  DELIMITED BY SIZE INTO LC74-DATE.                             
                                                                                
       1500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       2000-READ-BP13F125.                                                      
      *----------------------------------------------------------------*        
                                                                                
           READ BP13F125 AT END MOVE 'Y' TO WS-EOF-F125                         
                                MOVE HIGH-VALUES TO BP13F125-CASHTRAN           
                                GO TO 2000-EXIT                                 
           END-READ.                                                            
                                                                                
           ADD 1                         TO CNT-F125-READ.                      
      **                                                                        
      ** OUTPUT 'LS' RECORDS                                                    
           MOVE BP13F125-CASHTRAN        TO P13F125A-CASHTRAN.                  
           WRITE P13F125A-CASHTRAN.                                             
           ADD 1 TO CNT-F125-WRITE.                                             
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       3000-PROCESS.                                                            
      *----------------------------------------------------------------*        
                                                                                
           IF F125-NUM-REGN NOT = F125-NUM-REGN-PREV                            
              IF F125-NUM-REGN-PREV NOT = SPACES AND LOW-VALUES                 
                 PERFORM 4000-PROCESS-INTEREST THRU 4000-EXIT                   
              END-IF                                                            
              MOVE BP13F125-CASHTRAN           TO BP13F125-CASHTRAN-PREV        
              COMPUTE WS-AMT-RECEIPT-TOT = F125-AMT-RECEIPT                     
              MOVE SPACES                      TO WS-AMT-FIELDS                 
              INITIALIZE                          WS-AMT-FIELDS                 
              PERFORM 3002-SAVE-CASH-CPF       THRU 3002-EXIT                   
           ELSE                                                                 
              IF F125-CDE-TRANS-TYPE NOT = F125-CDE-TRANS-TYPE-PREV             
                 PERFORM 4000-PROCESS-INTEREST THRU 4000-EXIT                   
                 MOVE BP13F125-CASHTRAN        TO BP13F125-CASHTRAN-PREV        
                 COMPUTE WS-AMT-RECEIPT-TOT = F125-AMT-RECEIPT                  
                 MOVE SPACES                   TO WS-AMT-FIELDS                 
                 INITIALIZE                       WS-AMT-FIELDS                 
                 PERFORM 3002-SAVE-CASH-CPF    THRU 3002-EXIT                   
              ELSE                                                              
                 COMPUTE WS-AMT-RECEIPT-TOT = WS-AMT-RECEIPT-TOT                
                                            + F125-AMT-RECEIPT                  
                 PERFORM 3002-SAVE-CASH-CPF    THRU 3002-EXIT                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 2000-READ-BP13F125          THRU 2000-EXIT.                  
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       3002-SAVE-CASH-CPF.                                                      
      *----------------------------------------------------------------*        
                                                                                
           IF F125-CDE-TRANS-TYPE = '11'                                        
              COMPUTE WS-AMT-CASH = WS-AMT-CASH + F125-AMT-RECEIPT              
           ELSE                                                                 
              IF F125-CDE-TRANS-TYPE = '12'                                     
                 MOVE 'N'                     TO WS-CPF-TAG                     
                 PERFORM VARYING WS-I FROM 1 BY 1                               
                         UNTIL WS-I > 4 OR WS-CPF-TAG = 'Y'                     
                    IF WS-NUM-CPF(WS-I) NOT = SPACES AND LOW-VALUES             
                       IF F125-NUM-NRIC = WS-NUM-CPF(WS-I)                      
                          COMPUTE WS-AMT-CPF(WS-I) = WS-AMT-CPF(WS-I)           
                                                   + F125-AMT-RECEIPT           
                       END-IF                                                   
                    ELSE                                                        
                       MOVE F125-NUM-NRIC     TO WS-NUM-CPF(WS-I)               
                       MOVE F125-AMT-RECEIPT  TO WS-AMT-CPF(WS-I)               
                       MOVE 'Y'               TO WS-CPF-TAG                     
                    END-IF                                                      
                 END-PERFORM                                                    
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3002-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4000-PROCESS-INTEREST.                                                   
      *----------------------------------------------------------------*        
                                                                                
           MOVE ZEROES       TO WS-NUM-DAYS         WS-AMT-REBATE               
                                WS-NUM-PERIOD       WS-AMT-REBATE-6DEC          
                                WS-AMT-LON-OS-BF    WS-AMT-LON-OS-AF.           
           MOVE SPACES       TO WS-START-DATE-ALPHA WS-END-DATE-ALPHA           
                                WS-START-DATE-PLUS1-ALPHA.                      
                                                                                
           PERFORM 8002-READ-BP13KD00            THRU 8002-EXIT                 
                                                                                
           IF KD00-FND                                                          
              MOVE KD00-AMT-LOAN-BAL               TO WS-AMT-LON-OS-BF          
                                                      WS-AMT-LON-OS-AF          
           ELSE                                                                 
              GO TO 4000-EXIT                                                   
           END-IF.                                                              
                                                                                
           PERFORM 8001-READ-BP13KD92            THRU 8001-EXIT                 
                                                                                
           IF KD92-FND                                                          
              PERFORM 4100-CALC-IT-REBATE        THRU 4100-EXIT                 
           ELSE                                                                 
              IF (KD00-DTE-REPUDIATE NOT = SPACES AND ZEROS) OR                 
                 (KD00-DTE-EFF-TRANSFER NOT = SPACES AND ZEROS) OR              
                 (KD00-DTE-REFINANCE NOT = SPACES AND ZEROS)                    
                 PERFORM 4105-PRINT-REPORT       THRU 4105-EXIT                 
                 PERFORM 4108-BKUP-BP13KD00      THRU 4108-EXIT                 
                 PERFORM 4109-UPDATE-BP13KD00    THRU 4109-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4100-CALC-IT-REBATE.                                                     
      *----------------------------------------------------------------*        
                                                                                
           PERFORM 4101-GET-DATES           THRU 4101-EXIT.                     
                                                                                
           IF WS-START-DATE-ALPHA = WS-END-DATE-ALPHA                           
              MOVE 'N'         TO WS-INT-REBATE                                 
           ELSE                                                                 
              IF KD00-DTE-LOAN-COMM  < '20120401'                               
                 IF KD92-AMT-LUMPSUM < 500.00                                   
                    MOVE 'N'         TO WS-INT-REBATE                           
                 ELSE                                                           
                    MOVE 'Y'         TO WS-INT-REBATE                           
                 END-IF                                                         
              ELSE                                                              
                 IF KD92-AMT-LUMPSUM < 5000.00                                  
                    MOVE 'N'         TO WS-INT-REBATE                           
                 ELSE                                                           
                    MOVE 'Y'         TO WS-INT-REBATE                           
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-INT-REBATE = 'Y'                                               
              PERFORM 4102-GET-INT-RATE     THRU 4102-EXIT                      
              PERFORM 4103-COMPUTE-REBATE   THRU 4103-EXIT                      
              IF WS-AMT-REBATE > 0                                              
                 PERFORM 4104-OUTPUT-IT     THRU 4104-EXIT                      
              END-IF                                                            
           END-IF                                                               
                                                                                
           PERFORM 4110-UPDATE-BP13K482     THRU 4110-EXIT.                     
                                                                                
           PERFORM 4105-PRINT-REPORT        THRU 4105-EXIT                      
                                                                                
           PERFORM 4106-UPDATE-BP13KD92     THRU 4106-EXIT                      
           IF KD92-AMT-LUMPSUM-PAID = KD92-AMT-LUMPSUM                          
              PERFORM 4107-DROP-BP13KD92    THRU 4107-EXIT                      
           END-IF                                                               
                                                                                
           PERFORM 4108-BKUP-BP13KD00       THRU 4108-EXIT                      
           PERFORM 4109-UPDATE-BP13KD00     THRU 4109-EXIT.                     
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4101-GET-DATES.                                                          
      *----------------------------------------------------------------*        
                                                                                
           MOVE F125-DTE-TRANS-PREV TO WS-START-DATE-ALPHA                      
                                       WS-END-DATE-ALPHA                        
                                       WS-START-DATE-PLUS1-ALPHA.               
      *----------------------------------------------------------------*        
      *    GET LAST DAY OF THE MONTH. CHECK FOR LEAP YEAR FOR THE MONTH         
      *    OF FEBRUARY.                                                         
      *-----------------------------------------------------------------        
           SET  WS-MTH-IND                  TO WS-END-DATE-MM.                  
           MOVE WS-DTE-LAST-DAY(WS-MTH-IND) TO WS-END-DATE-DD.                  
                                                                                
           IF WS-END-DATE-MM = 2                                                
              IF WS-END-DATE-YY = 0                                             
                 DIVIDE WS-END-DATE-CCYY BY 400 GIVING WS-QUOTIENT              
                                             REMAINDER WS-REMAINDER             
              ELSE                                                              
                 DIVIDE WS-END-DATE-CCYY BY   4 GIVING WS-QUOTIENT              
                                             REMAINDER WS-REMAINDER             
              END-IF                                                            
              IF WS-REMAINDER = 0                                               
                 MOVE 29 TO WS-END-DATE-DD                                      
              END-IF                                                            
           END-IF.                                                              
                                                                                
           EVALUATE WS-MONTH(WS-END-DATE-MM)                                    
               WHEN 01                                                          
               WHEN 03                                                          
               WHEN 05                                                          
               WHEN 07                                                          
               WHEN 08                                                          
               WHEN 10                                                          
               WHEN 12                                                          
                    IF WS-START-DATE-P1-DD <= 30                                
                       ADD  1                    TO WS-START-DATE-P1-DD         
                    END-IF                                                      
                                                                                
               WHEN 04                                                          
               WHEN 06                                                          
               WHEN 09                                                          
               WHEN 11                                                          
                    IF WS-START-DATE-P1-DD <= 29                                
                       ADD  1                    TO WS-START-DATE-P1-DD         
                    END-IF                                                      
                                                                                
               WHEN 02                                                          
                    IF WS-REMAINDER = 0                                         
                       IF WS-START-DATE-P1-DD <= 28                             
                          ADD  1                 TO WS-START-DATE-P1-DD         
                       END-IF                                                   
                    ELSE                                                        
                       IF WS-START-DATE-P1-DD <= 27                             
                          ADD  1                 TO WS-START-DATE-P1-DD         
                       END-IF                                                   
                    END-IF                                                      
           END-EVALUATE.                                                        
                                                                                
           COMPUTE WS-NUM-DAYS = WS-END-DATE-DD - WS-START-DATE-DD.             
                                                                                
           COMPUTE WS-NUM-PERIOD = WS-NUM-DAYS / WS-END-DATE-DD.                
                                                                                
       4101-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4102-GET-INT-RATE.                                                       
      *----------------------------------------------------------------*        
                                                                                
      *___ CALL C950 TO GET INTEREST RATE                                       
                                                                                
           MOVE F125-DTE-TRANS-PREV      TO C950-PROCESS-DATE.                  
           MOVE KD00-NUM-LOAN-REPYMT-PERIOD                                     
                                         TO C950-REPYMT-PERIOD.                 
           MOVE KD00-CDE-LOAN-SCH        TO C950-CDE-LOAN-SCH.                  
                                                                                
           CALL 'BP13C950' USING C950-FIELD.                                    
                                                                                
           MOVE C950-INTREST-RATE    TO WS-INTEREST-RATE.                       
           COMPUTE WS-TMP-INTRATE = C950-INTREST-RATE * 100.                    
                                                                                
       4102-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4103-COMPUTE-REBATE.                                                     
      *----------------------------------------------------------------*        
                                                                                
           COMPUTE WS-AMT-REBATE-6DEC =                                         
           (WS-AMT-RECEIPT-TOT * WS-INTEREST-RATE * WS-NUM-PERIOD) / 12.        
                                                                                
      ***  ROUND DOWN TO TWO DECIMAL PLACES                                     
           COMPUTE WS-AMT-REBATE ROUNDED = WS-AMT-REBATE-6DEC.                  
                                                                                
       4103-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4104-OUTPUT-IT.                                                          
      *----------------------------------------------------------------*        
                                                                                
           MOVE SPACES              TO P13F125A-CASHTRAN.                       
           INITIALIZE                  P13F125A-CASHTRAN.                       
           MOVE BP13F125-CASHTRAN-PREV                                          
                                    TO P13F125A-CASHTRAN.                       
                                                                                
           MOVE '68'                TO F125A-CDE-TRANS-TYPE.                    
           MOVE 'IT'                TO F125A-CDE-PAYMENT-TYPE.                  
           MOVE F001-DTE-CURRENT    TO F125A-DTE-POST                           
           MOVE ZEROES              TO F125A-COUNT-HISTORY.                     
           MOVE SPACES              TO F125A-NUM-RECPT-JRNO                     
                                                                                
           IF  WS-PCT1 = 0                                                      
               STRING 'I'               DELIMITED BY SIZE                       
                      KD00-CDE-LOAN-SCH DELIMITED BY SIZE                       
                      '-'               DELIMITED BY SIZE                       
                      WS-PCT2           DELIMITED BY SIZE                       
                      '.'               DELIMITED BY SIZE                       
                      WS-PCT3           DELIMITED BY SIZE                       
                      INTO              F125A-NUM-RECPT-JRNO                    
           ELSE                                                                 
               STRING 'I'               DELIMITED BY SIZE                       
                      KD00-CDE-LOAN-SCH DELIMITED BY SIZE                       
                      '-'               DELIMITED BY SIZE                       
                      WS-PCT1           DELIMITED BY SIZE                       
                      WS-PCT2           DELIMITED BY SIZE                       
                      '.'               DELIMITED BY SIZE                       
                      WS-PCT3           DELIMITED BY SIZE                       
                      INTO              F125A-NUM-RECPT-JRNO                    
           END-IF.                                                              
                                                                                
           MOVE WS-AMT-REBATE           TO F125A-AMT-RECEIPT                    
                                           F125A-AMT-INTEREST.                  
           MOVE 'C'                     TO F125A-CDE-CRDR.                      
           MOVE KD00-CDE-LOAN-SCH       TO F125A-NUM-LOAN-SCH.                  
                                                                                
           WRITE P13F125A-CASHTRAN.                                             
           ADD 1 TO CNT-F125-WRITE.                                             
                                                                                
       4104-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4105-PRINT-REPORT.                                                       
      *----------------------------------------------------------------*        
                                                                                
           IF WS-LINE > 50                                                      
              MOVE  SPACES                 TO BP13LC74-REC                      
              WRITE BP13LC74-REC        AFTER PAGE                              
              ADD   1                      TO WS-PAGE                           
              MOVE  WS-PAGE                TO LC74-PRT-PAGE                     
              WRITE BP13LC74-REC FROM LC74-PR-HEAD-01  AFTER 3                  
              WRITE BP13LC74-REC FROM LC74-PR-HEAD-02  AFTER 2                  
              WRITE BP13LC74-REC FROM LC74-PR-HEAD-03  AFTER 2                  
              WRITE BP13LC74-REC FROM LC74-PR-HEAD-04                           
              MOVE  SPACES                 TO BP13LC74-REC                      
              WRITE BP13LC74-REC                                                
              MOVE  10                     TO WS-LINE                           
           END-IF.                                                              
                                                                                
           ADD 1                             TO WS-SNO.                         
                                                                                
           MOVE SPACES                       TO LC74-PR-DTL.                    
           MOVE WS-SNO                       TO LC74-PRT-SNO.                   
           MOVE F125-NUM-REGN-PREV           TO LC74-REGN-NO.                   
           MOVE F125-NUM-SCH-ACCT-PREV       TO LC74-SCH.                       
           MOVE KD92-AMT-LUMPSUM             TO LC74-AMOUNT-RQ.                 
           MOVE WS-AMT-RECEIPT-TOT           TO LC74-AMOUNT-PD.                 
           MOVE WS-AMT-REBATE                TO LC74-IT-REBATE.                 
           STRING WS-START-DATE-PLUS1-ALPHA(7:2) '/'                            
                  WS-START-DATE-PLUS1-ALPHA(5:2) '/'                            
                  WS-START-DATE-PLUS1-ALPHA(1:4)                                
                  DELIMITED BY SIZE INTO        LC74-START-DATE.                
           IF WS-END-DATE-ALPHA         NOT = SPACES AND '00000000'             
              STRING WS-END-DATE-ALPHA(7:2) '/'                                 
                     WS-END-DATE-ALPHA(5:2) '/'                                 
                     WS-END-DATE-ALPHA(1:4)                                     
                     DELIMITED BY SIZE INTO     LC74-END-DATE                   
           END-IF.                                                              
                                                                                
           COMPUTE WS-AMT-LON-OS-AF =                                           
                   WS-AMT-LON-OS-AF - WS-AMT-REBATE.                            
           COMPUTE WS-AMT-LON-OS-AF =                                           
                   WS-AMT-LON-OS-AF - WS-AMT-RECEIPT-TOT.                       
                                                                                
           MOVE WS-AMT-LON-OS-BF             TO LC74-AMT-LON-OS-BF.             
           MOVE WS-AMT-LON-OS-AF             TO LC74-AMT-LON-OS-AF.             
                                                                                
           IF WS-AMT-LON-OS-BF < 0                                              
              MOVE '-'                       TO LC74-AMT-BF-SIGN                
           END-IF                                                               
           IF WS-AMT-LON-OS-AF < 0                                              
              MOVE '-'                       TO LC74-AMT-AF-SIGN                
           END-IF                                                               
           MOVE WS-NUM-2ND-CONC              TO LC74-NUM-2ND-CONC.              
                                                                                
           WRITE BP13LC74-REC          FROM LC74-PR-DTL AFTER 2.                
           ADD 2                             TO WS-LINE.                        
                                                                                
       4105-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4106-UPDATE-BP13KD92.                                                    
      *----------------------------------------------------------------*        
                                                                                
           MOVE 'BP13CC74'                 TO KD00-NUM-USERID.                  
                                                                                
           ADD  WS-AMT-RECEIPT-TOT         TO KD92-AMT-LUMPSUM-PAID.            
           MOVE F125-DTE-TRANS-PREV        TO KD92-DTE-LUMPSUM-PAID.            
           ADD  WS-AMT-REBATE              TO KD92-AMT-LUMPSUM-REBATE.          
                                                                                
           PERFORM 8004-REWRITE-BP13KD92 THRU 8004-EXIT.                        
                                                                                
       4106-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4107-DROP-BP13KD92.                                                      
      *----------------------------------------------------------------*        
      *1) WRITE BP13FD92                                                        
           MOVE BP13KD92-REC                TO BP13FD92-REC.                    
           WRITE BP13FD92-REC.                                                  
           ADD 1                            TO CNT-FD92-WRITE.                  
                                                                                
      *2) WRITE BP13KD94                                                        
           MOVE SPACES                      TO BP13KD94-REC.                    
           INITIALIZE                          BP13KD94-REC.                    
           MOVE BP13KD92-REC                TO BP13KD94-REC.                    
           MOVE KD92-NUM-REGN               TO KD94-NUM-REGN-LOG.               
           MOVE KD92-NUM-TRANS              TO KD94-NUM-TRANS-LOG.              
           MOVE 'BP13CC74'                  TO KD94-NUM-USERID.                 
                                                                                
           PERFORM 8005-WRITE-BP13KD94    THRU 8005-EXIT.                       
                                                                                
      *3) WRITE BP13KD94                                                        
           PERFORM 8006-DELETE-BP13KD92   THRU 8006-EXIT.                       
                                                                                
       4107-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4108-BKUP-BP13KD00.                                                      
      *----------------------------------------------------------------*        
                                                                                
           MOVE BP13KD00-REC               TO BP13KD99-REC.                     
           MOVE KD00-NUM-REGN              TO KD99-NUM-REGN-LOG.                
           MOVE F001-DTE-CURRENT           TO KD99-DTE-UPDATE-LOG.              
           MOVE FUNCTION CURRENT-DATE(9:8) TO KD99-TME-UPDATE-LOG.              
                                                                                
           PERFORM 8007-WRITE-BP13KD99   THRU 8007-EXIT.                        
                                                                                
       4108-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4109-UPDATE-BP13KD00.                                                    
      *----------------------------------------------------------------*        
                                                                                
           MOVE F001-DTE-CURRENT           TO KD00-DTE-UPDATE.                  
           MOVE FUNCTION CURRENT-DATE(9:8) TO KD00-TME-UPDATE.                  
           MOVE 'BP13CC74'                 TO KD00-NUM-USERID.                  
                                                                                
      ***  DEDUCT INTEREST REBATE                                               
           COMPUTE KD00-AMT-LOAN-BAL =                                          
                   KD00-AMT-LOAN-BAL - WS-AMT-REBATE.                           
                                                                                
      ***  TOTAL LUMPSUM ADD/SUBTRACT                                           
           COMPUTE KD00-AMT-LOAN-BAL =                                          
                   KD00-AMT-LOAN-BAL - WS-AMT-RECEIPT-TOT.                      
                                                                                
           COMPUTE KD00-AMT-TOTL-PYMT-TODTE =                                   
                   KD00-AMT-TOTL-PYMT-TODTE + WS-AMT-RECEIPT-TOT.               
                                                                                
           COMPUTE KD00-AMT-LOAN-PAID =                                         
                   KD00-AMT-LOAN-PAID + WS-AMT-RECEIPT-TOT.                     
                                                                                
      *** COMPUTATION OF ARR-INTR (INTEREST REBATE)                             
           COMPUTE KD00-AMT-ARR-INTR =                                          
                   KD00-AMT-ARR-INTR - WS-AMT-REBATE.                           
                                                                                
           MOVE F001-DTE-CURRENT(1:6)      TO KD00-DTE-LATEST-PYMT-LOAN.        
                                                                                
           ADD WS-AMT-RECEIPT-TOT          TO KD00-AMT-CAPITAL-PAYMT.           
                                                                                
           IF KD03-FND                                                          
              MOVE BP13KD00-REC                TO BP13KD03-REC                  
              PERFORM 8008-REWRITE-BP13KD03  THRU 8008-EXIT                     
           ELSE                                                                 
              PERFORM 8009-REWRITE-BP13KD00  THRU 8009-EXIT                     
           END-IF.                                                              
                                                                                
       4109-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4110-UPDATE-BP13K482.                                                    
      *----------------------------------------------------------------*        
                                                                                
           MOVE F125-NUM-REGN-PREV          TO K800-NUM-REGN                    
           PERFORM 8012-READ-BP13K800     THRU 8012-EXIT                        
           IF K800-NUM-BUY-SELL-TAG = 'B'                                       
              CONTINUE                                                          
           ELSE                                                                 
              GO TO 4110-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE 'N'                         TO WS-NUM-2ND-CONC                  
                                                                                
           MOVE F125-NUM-SCH-ACCT-PREV      TO K482-NUM-HDBREF-NEW              
           MOVE KD92-NUM-HDBREF-DISPOSAL    TO K482-NUM-HDBREF-DISPOSAL         
           PERFORM 8010-READ-BP13K482       THRU 8010-EXIT                      
                                                                                
           IF K482-FND                                                          
              IF WS-AMT-CASH > ZEROES                                           
                 COMPUTE K482-AMT-TOTL-CASH-PAID =                              
                         K482-AMT-TOTL-CASH-PAID + WS-AMT-CASH                  
              END-IF                                                            
                                                                                
              PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > 4                   
                 IF WS-AMT-CPF(WS-I) > ZEROES                                   
                    EVALUATE WS-NUM-CPF(WS-I)                                   
                    WHEN K482-NUM-NRIC1-NEW                                     
                         COMPUTE K482-AMT-TOTL-CPF1-PAID =                      
                             K482-AMT-TOTL-CPF1-PAID + WS-AMT-CPF(WS-I)         
                    WHEN K482-NUM-NRIC2-NEW                                     
                         COMPUTE K482-AMT-TOTL-CPF2-PAID =                      
                             K482-AMT-TOTL-CPF2-PAID + WS-AMT-CPF(WS-I)         
                    WHEN K482-NUM-NRIC3-NEW                                     
                         COMPUTE K482-AMT-TOTL-CPF3-PAID =                      
                             K482-AMT-TOTL-CPF3-PAID + WS-AMT-CPF(WS-I)         
                    WHEN K482-NUM-NRIC4-NEW                                     
                         COMPUTE K482-AMT-TOTL-CPF4-PAID =                      
                             K482-AMT-TOTL-CPF4-PAID + WS-AMT-CPF(WS-I)         
                    END-EVALUATE                                                
                 END-IF                                                         
              END-PERFORM                                                       
                                                                                
              PERFORM 8011-REWRITE-BP13K482 THRU 8011-EXIT                      
              MOVE 'Y'                        TO WS-NUM-2ND-CONC                
           END-IF.                                                              
                                                                                
       4110-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       8001-READ-BP13KD92.                                                      
      *----------------------------------------------------------------*        
                                                                                
           IF F125-CDE-TRANS-TYPE-PREV = '12'                                   
              MOVE 'LCPF'                     TO KD92-NUM-TRANS                 
           ELSE                                                                 
              MOVE 'LUMP'                     TO KD92-NUM-TRANS                 
           END-IF.                                                              
           MOVE F125-NUM-REGN-PREV            TO KD92-NUM-REGN                  
                                                                                
           READ BP13KD92.                                                       
                                                                                
           IF WS-KD92-STATUS = 00 OR 02                                         
              MOVE 'Y'                        TO WS-KD92-FND                    
           ELSE                                                                 
              IF WS-KD92-STATUS = 23                                            
                 MOVE 'N'                     TO WS-KD92-FND                    
              ELSE                                                              
                 DISPLAY 'BP13KD92 - READ ERROR (' WS-KD92-STATUS ')'           
                 MOVE WS-KD92-STATUS          TO RETURN-CODE                    
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8001-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       8002-READ-BP13KD00.                                                      
      *----------------------------------------------------------------*        
                                                                                
           MOVE F125-NUM-REGN-PREV            TO KD00-NUM-REGN                  
                                                                                
           READ BP13KD00.                                                       
                                                                                
           IF WS-KD00-STATUS = 00 OR 02                                         
              MOVE 'Y'                        TO WS-KD00-FND                    
              ADD 1                           TO CNT-KD00-READ                  
           ELSE                                                                 
              IF WS-KD00-STATUS = 23                                            
                 PERFORM 8003-READ-BP13KD03 THRU 8003-EXIT                      
                 IF KD03-FND                                                    
                    MOVE BP13KD03-REC         TO BP13KD00-REC                   
                    MOVE 'Y'                  TO WS-KD00-FND                    
                    ADD 1                     TO CNT-KD00-READ                  
                 ELSE                                                           
                    MOVE 'N'                  TO WS-KD00-FND                    
                    ADD 1                     TO CNT-KD00-NOTFOUND              
                 END-IF                                                         
              ELSE                                                              
                 DISPLAY 'BP13KD00 - READ ERROR (' WS-KD00-STATUS ')'           
                 MOVE WS-KD00-STATUS          TO RETURN-CODE                    
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF KD00-AMT-LOAN-BAL IS NOT NUMERIC                                  
              MOVE ZEROES                TO KD00-AMT-LOAN-BAL                   
           END-IF.                                                              
           IF KD00-AMT-TOTL-PYMT-TODTE IS NOT NUMERIC                           
              MOVE ZEROES                TO KD00-AMT-TOTL-PYMT-TODTE            
           END-IF.                                                              
           IF KD00-AMT-LOAN-PAID IS NOT NUMERIC                                 
              MOVE ZEROES                TO KD00-AMT-LOAN-PAID                  
           END-IF.                                                              
           IF KD00-AMT-CAPITAL-PAYMT IS NOT NUMERIC                             
              MOVE ZEROES                TO KD00-AMT-CAPITAL-PAYMT              
           END-IF.                                                              
           IF KD00-AMT-ARR-INTR      IS NOT NUMERIC                             
              MOVE ZEROES                TO KD00-AMT-ARR-INTR                   
           END-IF.                                                              
                                                                                
       8002-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       8003-READ-BP13KD03.                                                      
      *----------------------------------------------------------------*        
                                                                                
           MOVE F125-NUM-REGN-PREV            TO KD03-NUM-REGN                  
                                                                                
           READ BP13KD03.                                                       
                                                                                
           IF WS-KD03-STATUS = 00 OR 02                                         
              MOVE 'Y'                        TO WS-KD03-FND                    
           ELSE                                                                 
              IF WS-KD00-STATUS = 23                                            
                 MOVE 'N'                     TO WS-KD03-FND                    
              ELSE                                                              
                 DISPLAY 'BP13KD03 - READ ERROR (' WS-KD03-STATUS ')'           
                 MOVE WS-KD03-STATUS          TO RETURN-CODE                    
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8003-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       8004-REWRITE-BP13KD92.                                                   
      *----------------------------------------------------------------*        
                                                                                
           REWRITE BP13KD92-REC.                                                
                                                                                
           EVALUATE WS-KD92-STATUS                                              
              WHEN 00                                                           
                 ADD 1                         TO CNT-KD92-UPDATE               
              WHEN OTHER                                                        
                 DISPLAY 'ERROR IN UPDATING BP13KD92 - STATUS '                 
                             WS-KD92-STATUS                                     
                 MOVE        WS-KD92-STATUS    TO RETURN-CODE                   
                 PERFORM 9000-CLOSE-ROUTINE    THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       8004-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       8005-WRITE-BP13KD94.                                                     
      *----------------------------------------------------------------*        
                                                                                
           WRITE BP13KD94-REC.                                                  
                                                                                
           EVALUATE WS-KD94-STATUS                                              
           WHEN 00                                                              
                ADD 1               TO CNT-KD94-WRITE                           
           WHEN OTHER                                                           
               DISPLAY 'BP13KD94 - ERROR IN WRITE, STATUS: '                    
                        WS-KD94-STATUS ' KEY: ' KD94-KEY-FLD                    
           END-EVALUATE.                                                        
                                                                                
       8005-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       8006-DELETE-BP13KD92.                                                    
      *----------------------------------------------------------------*        
                                                                                
           DELETE BP13KD92.                                                     
                                                                                
           EVALUATE WS-KD92-STATUS                                              
           WHEN 00                                                              
                ADD   1  TO   CNT-KD92-DELETE                                   
           WHEN OTHER                                                           
               DISPLAY 'BP13KD92 - ERROR IN DELETE, STATUS: '                   
                        WS-KD92-STATUS ' KEY ' KD92-KEY-FLD                     
           END-EVALUATE.                                                        
                                                                                
       8006-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       8007-WRITE-BP13KD99.                                                     
      *----------------------------------------------------------------*        
                                                                                
           WRITE BP13KD99-REC.                                                  
                                                                                
           EVALUATE WS-KD99-STATUS                                              
              WHEN 00                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 DISPLAY 'ERROR IN WRITING  BP13KD99 - STATUS '                 
                             WS-KD99-STATUS                                     
                 MOVE        WS-KD99-STATUS    TO RETURN-CODE                   
                 PERFORM 9000-CLOSE-ROUTINE    THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
           ADD 1 TO CNT-KD99-WRITE.                                             
                                                                                
       8007-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       8008-REWRITE-BP13KD03.                                                   
      *----------------------------------------------------------------*        
                                                                                
           REWRITE BP13KD03-REC                                                 
                                                                                
           EVALUATE WS-KD03-STATUS                                              
              WHEN 00                                                           
                 ADD 1                         TO CNT-KD03-UPDATE               
              WHEN OTHER                                                        
                 DISPLAY 'ERROR IN UPDATING BP13KD03 - STATUS '                 
                             WS-KD03-STATUS                                     
                 MOVE        WS-KD03-STATUS    TO RETURN-CODE                   
                 PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                      
           END-EVALUATE.                                                        
                                                                                
       8008-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       8009-REWRITE-BP13KD00.                                                   
      *----------------------------------------------------------------*        
                                                                                
           REWRITE BP13KD00-REC                                                 
                                                                                
           EVALUATE WS-KD00-STATUS                                              
              WHEN 00                                                           
                 ADD 1                         TO CNT-KD00-UPDATE               
              WHEN OTHER                                                        
                 DISPLAY 'ERROR IN UPDATING BP13KD00 - STATUS '                 
                             WS-KD00-STATUS                                     
                 MOVE        WS-KD00-STATUS    TO RETURN-CODE                   
                 PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                      
           END-EVALUATE.                                                        
                                                                                
       8009-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       8010-READ-BP13K482.                                                      
      *----------------------------------------------------------------*        
                                                                                
           READ BP13K482.                                                       
                                                                                
           IF WS-K482-STATUS = 00 OR 02                                         
              MOVE 'Y'                        TO WS-K482-FND                    
           ELSE                                                                 
              IF WS-K482-STATUS = 23                                            
                 MOVE 'N'                     TO WS-K482-FND                    
              ELSE                                                              
                 DISPLAY 'BP13K482 - READ ERROR (' WS-K482-STATUS ')'           
                 MOVE WS-K482-STATUS          TO RETURN-CODE                    
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8010-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       8011-REWRITE-BP13K482.                                                   
      *----------------------------------------------------------------*        
                                                                                
           REWRITE BP13K482-REC                                                 
                                                                                
           EVALUATE WS-K482-STATUS                                              
              WHEN 00                                                           
                 ADD 1                         TO CNT-K482-UPDATE               
              WHEN OTHER                                                        
                 DISPLAY 'ERROR IN UPDATING BP13K482 - STATUS '                 
                             WS-K482-STATUS                                     
                 MOVE        WS-K482-STATUS    TO RETURN-CODE                   
                 PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                      
           END-EVALUATE.                                                        
                                                                                
       8011-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       8012-READ-BP13K800.                                                      
      *----------------------------------------------------------------*        
                                                                                
           READ BP13K800.                                                       
                                                                                
           IF WS-K800-STATUS = 00 OR 02                                         
              CONTINUE                                                          
           ELSE                                                                 
              IF WS-K800-STATUS = 23                                            
                 MOVE SPACES                  TO K800-NUM-BUY-SELL-TAG          
              ELSE                                                              
                 DISPLAY 'BP13K800 - READ ERROR (' WS-K800-STATUS ')'           
                 MOVE WS-K800-STATUS          TO RETURN-CODE                    
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8012-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       9000-CLOSE-ROUTINE.                                                      
      *----------------------------------------------------------------*        
                                                                                
           CLOSE BP13F125                                                       
                 SY02F001                                                       
                 BP13K800                                                       
                 BP13KD92                                                       
                 BP13KD94                                                       
                 BP13KD00                                                       
                 BP13KD99                                                       
                 BP13K482                                                       
                 BP13FD92                                                       
                 P13F125A                                                       
                 BP13LC74.                                                      
                                                                                
           IF WS-KD92-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR, BP13KD92-STATUS ' WS-KD92-STATUS.         
              MOVE WS-KD92-STATUS TO RETURN-CODE.                               
           IF WS-KD94-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR, BP13KD94-STATUS ' WS-KD94-STATUS.         
              MOVE WS-KD94-STATUS TO RETURN-CODE.                               
           IF WS-KD00-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR, BP13KD00-STATUS ' WS-KD00-STATUS.         
              MOVE WS-KD00-STATUS TO RETURN-CODE.                               
           IF WS-KD99-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR, BP13KD99-STATUS ' WS-KD99-STATUS.         
              MOVE WS-KD99-STATUS TO RETURN-CODE.                               
           IF WS-K482-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR, BP13K482-STATUS ' WS-K482-STATUS.         
              MOVE WS-K482-STATUS TO RETURN-CODE.                               
           IF WS-K800-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR, BP13K800-STATUS ' WS-K800-STATUS.         
              MOVE WS-K800-STATUS TO RETURN-CODE.                               
                                                                                
           DISPLAY '                                    '.                      
           DISPLAY '***** BP13CC74 CONTROL TOTALS ***** '.                      
           DISPLAY '                                    '.                      
           DISPLAY 'NO OF RECORDS READ FROM  (BP13F125) = '                     
                    CNT-F125-READ.                                              
           DISPLAY 'NO OF RECORDS FOUND FROM (BP13KD92) = '                     
                    CNT-KD92-READ.                                              
           DISPLAY 'NO OF RECORDS NOT FOUND  (BP13KD92) = '                     
                    CNT-KD92-NOTFOUND.                                          
           DISPLAY 'NO OF RECORDS UDPATED    (BP13KD92) = '                     
                    CNT-KD92-UPDATE.                                            
           DISPLAY 'NO OF RECORDS DELETED    (BP13KD92) = '                     
                    CNT-KD92-DELETE.                                            
           DISPLAY 'NO OF RECORDS WRITTEN    (BP13FD92) = '                     
                    CNT-FD92-WRITE.                                             
           DISPLAY 'NO OF RECORDS WRITTEN    (BP13KD94) = '                     
                    CNT-KD94-WRITE.                                             
           DISPLAY 'NO OF RECORDS FOUND FROM (BP13KD00) = '                     
                    CNT-KD00-READ.                                              
           DISPLAY 'NO OF RECORDS NOT FOUND  (BP13KD00) = '                     
                    CNT-KD00-NOTFOUND.                                          
           DISPLAY 'NO OF RECORDS UPDATED    (BP13KD00) = '                     
                    CNT-KD00-UPDATE.                                            
           DISPLAY 'NO OF RECORDS UPDATED    (BP13KD03) = '                     
                    CNT-KD03-UPDATE.                                            
           DISPLAY 'NO OF RECORDS UPDATED    (BP13K482) = '                     
                    CNT-K482-UPDATE.                                            
           DISPLAY 'NO OF RECORDS WRITTEN    (BP13KD99) = '                     
                    CNT-KD99-WRITE.                                             
           DISPLAY 'NO OF RECORDS WRITTEN    (P13F125A) = '                     
                    CNT-F125-WRITE.                                             
           DISPLAY 'NO OF RECORDS WRITTEN    (BP13LC74) = '                     
                    WS-SNO.                                                     
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
