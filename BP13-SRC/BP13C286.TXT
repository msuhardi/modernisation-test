      *------------------------*                                                
       IDENTIFICATION DIVISION.                                                 
      *------------------------*                                                
       PROGRAM-ID.    BP13C286.                                                 
      *AUTHOR.        ED.                                                       
      *DATE-WRITTEN.  27/04/2001.                                               
                                                                                
      * ====================================================== *                
      *    SYSTEM NAME : SYSTEM OF COMMITMENT                  *                
      *    SYSTEM ID : BP13                                    *                
      *                                                        *                
      *    OBJECTIVE  :                                        *                
      *        1.  TO GENERATE GL TRANSACTION RECORDS FOR      *                
      *            STUDIO APARTMENT CASES.                     *                
      *                                                        *                
      *     INPUT/OUTPUT FILES:                                *                
      *              BP13F400 (SALES ORDER FILE)               *                
      *              BP13K800 (APPLICANT MASTER)               *                
      *              BP13K350 (STUD APT. FILE)                 *                
      *              BP13F120 (SOC HISTORY MASTER)             *                
      *                                                        *                
      * CHG-NO   BY    ON      DESCRIPTION                     *                
      * ------   ---  -------- -----------                     *                
      * BP131016 ED   20010427 NEW PGM                         *                
      * BP131016 MALC 20010610 TO CATER FOR SA/TP              *                
      * BP132031 MCC  20011119 TO CATER FOR SA/TP              *                
      * BP132118 CLT  12032002 HSP SCHEME FOR STDAPT CASE      *                
      * BP132660 JF4  15032005 TO GET PREMIUM FROM BP13F400    *                
      * BP132839 CLT  15042006 TO CATER FOR SA FLAT USING CPF  *                
      * BP132838 LSB  25012007 FEE USING CPF, NO WRITE F120    *                
      * BP133017 SD10 11042007 ADD STAMP FEE > 0 WRITE F120    *                
      * BP133566 DW5  13052009 MOVE K800-NUM-FLAT-TYPE TO      *                
      *                             F120-NUM-FLAT-TYPE-SA      *                
      * BP135297 ESD1 17102014 CATER FOR PARTIAL PAYMENT OF    *                
      *                        CONVEY FEE USING CASH.          *                
      * BP136098 LSB1 29012016 CATER LBS, 2-ROOM FLEXI         *                
      * BP136098 KSJ3 02032016 FOR 2 ROOM FLEXI ONLY, COMPUTE  *                
      *                        F120 RECEIPT AMOUNT BY ADDING   *                
      *                        PREMIUM AMT TO SELLING PRICE    *                
      * BP135903 FNP1 20042016 REMOVE ADDING OF PREMIUM AMT FOR*                
      *                        VRL CASES                       *                
      * BP136098 FNP1 05052016 CHECK PREMIUM AMT INSTEAD OF    *                
      *                        PREMIUM RATE, MOVE LEASE TENURE *                
      *                        FOR 2F CASES                    *                
      * BP136224 KSJ3 02062016 TO TAG CDE-VALID AS 'L' FOR LBS *                
      * BP136803 FNP1 05062017 TO CATER FOR TMP PAYMENT TYPE   *                
      * BP136869 FNP1 05062017 ONLY RAISE PAYMENT TYPE SA, TMP *                
      *                        FOR TEMP LOAN CASE              *                
      * BP137287 PCL4 14052018 TO CATER FOR DDS SCHEME         *                
      * BP137219 FNP1 13032018 CREATE F120 FOR FSH AMORTISATION*                
      *                        NO TEMP LOAN, NO TRF BK FEE     *                
      * BP137181 FNP1 13032018 CREATE F120 FOR MLF FOR TRANS 22*                
      *                        IF AMT-LOAN > ZEROES            *                
      *                        ADD 'MLF LN' TO COL 130 TRANS 29*                
      * BP137484 DN8  11102018 CATER FOR DDS TP CASES.         *                
      *                        CREATE F120 FOR SOC FOR TRANS 20*                
      *                        IF AMT-SOC  > ZEROES            *                
      * BP137678 KV6  05112019 CATER FOR FSH NO LOAN CASE.     *                
      * BP138321 ZDD  26112020 CATER FOR MGL REVISED POLICY.   *                
      * BP138663 FP6  26082021 CATER FOR 1F FLAT TYPE          *                
      * BP138957 ZDD  29102021 CATER FOR SERS CASE (1557169A)  *                
      *                        3RM SHORT LEASE (30 YEARS)      *                
      * BP139008 ZDD  17122021 CATER FOR SERS CASE (1555490H)  *                
      *                        3RM SHORT LEASE (30 YEARS)      *                
      * BP139211 KAC1 04012023 CHANGED BP13C902 TO DYNAMIC CALL*                
      *                        CALL BP13C90D FOR GST RATE      *                
      *                        CATER FOR 8 % GST WEF 20230101  *                
      * BP139485 KAC1 02012024 CALL BP13C90D FOR GST RATE      *                
      *                        CATER FOR 9 % GST WEF 20240101  *                
      * ====================================================== *                
                                                                                
      *------------------------*                                                
       ENVIRONMENT DIVISION.                                                    
      *------------------------*                                                
       CONFIGURATION SECTION.                                                   
      *------------------------*                                                
                                                                                
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
      *------------------------*                                                
       INPUT-OUTPUT SECTION.                                                    
      *------------------------*                                                
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13K800 ASSIGN TO BP13K800                                   
                ORGANIZATION IS INDEXED                                         
                ACCESS MODE  IS DYNAMIC                                         
                RECORD KEY   IS K800-NUM-REGN                                   
                FILE STATUS  IS K800-STATUS.                                    
                                                                                
           SELECT BP13K350 ASSIGN TO BP13K350                                   
                ORGANIZATION IS INDEXED                                         
                ACCESS MODE  IS DYNAMIC                                         
                RECORD KEY   IS K350-NUM-REGN                                   
                FILE STATUS  IS K350-STATUS.                                    
                                                                                
           SELECT BP13F120 ASSIGN TO BP13F120.                                  
                                                                                
           SELECT BP13F400 ASSIGN TO BP13F400.                                  
                                                                                
                                                                                
      *------------------------*                                                
       DATA DIVISION.                                                           
      *------------------------*                                                
       FILE SECTION.                                                            
      *------------------------*                                                
                                                                                
       FD  BP13F400           BLOCK CONTAINS 0 RECORDS                          
                              RECORD CONTAINS 2000 CHARACTERS                   
                              LABEL RECORDS ARE STANDARD                        
                              RECORDING MODE IS F.                              
       COPY BP13F400.                                                           
                                                                                
       FD  BP13K800           RECORD CONTAINS 2000 CHARACTERS.                  
       COPY BP13K800.                                                           
                                                                                
       FD  BP13K350           RECORD CONTAINS 600 CHARACTERS.                   
       COPY BP13K350.                                                           
                                                                                
       FD  BP13F120           BLOCK CONTAINS 0 RECORDS                          
                              RECORD CONTAINS 150 CHARACTERS                    
                              LABEL RECORDS ARE STANDARD                        
                              RECORDING MODE IS F.                              
       COPY BP13F120.                                                           
                                                                                
                                                                                
      *------------------------*                                                
       WORKING-STORAGE SECTION.                                                 
      *------------------------*                                                
                                                                                
       01  WS-FILE-STATUS.                                                      
           05  K800-STATUS           PIC 9(2)    VALUE ZEROS.                   
           05  K350-STATUS           PIC 9(2)    VALUE ZEROS.                   
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-READ-CNT           PIC 9(6)    VALUE ZEROS.                   
           05  WS-WRITE-CNT          PIC 9(6)    VALUE ZEROS.                   
                                                                                
       01  WS-PROGRAM-SWITCHES.                                                 
           05  WS-EOF-F400           PIC X       VALUE SPACES.                  
           05  WS-K800-REC-FND       PIC X       VALUE SPACES.                  
           05  WS-CHECK-CD-AMT       PIC X       VALUE SPACES.                  
           05  WS-K350-FOUND         PIC X       VALUE SPACES.                  
           05  WS-REFUND-SWITCH      PIC X       VALUE SPACES.                  
                                                                                
       01  WS-DATE.                                                             
           05  WS-CC                 PIC X(2).                                  
           05  WS-YY                 PIC X(2).                                  
           05  WS-MM                 PIC X(2).                                  
           05  WS-DD                 PIC X(2).                                  
                                                                                
       01  WS-AMT-CD                 PIC S9(7)V99 VALUE ZEROS.                  
       01  WS-BK                     PIC S9(7)V99 VALUE +0.                     
                                                                                
       01  WS-AMT-SOC-PAID           PIC S9(7)V99 VALUE ZEROS.                  
                                                                                
       01  WS-ADV-COL                PIC S9(8)V99 VALUE ZEROS.                  
       01  WS-LEVY-AMT               PIC S9(7)V99 VALUE ZEROS.                  
       01  WS-REFUND-AMT             PIC S9(7)V99 VALUE ZEROS.                  
       01  WS-BK-TRANSFER            PIC S9(7)V99 VALUE ZEROS.                  
       01  WS-AMT-ICP-TOTAL          PIC 9(6)V99 VALUE ZEROS.                   
       01  WS-CONTRA-CONVY-FEES      PIC 9(5)V99 VALUE ZEROS.                   
       01  WS-TEMP-CONVEY-FEE        PIC 9(5)V99   VALUE ZEROES.                
       01  WS-TEMP-CONVEY-FEE-GST    PIC 9(5)V99   VALUE ZEROES.                
       01  WS-TEMP-CONV-CASH         PIC 9(7)V99   VALUE ZEROES.                
       01  WS-TEMP-CONV-CASH-GST     PIC 9(7)V99   VALUE ZEROES.                
       01  WS-BP13C902               PIC X(08) VALUE 'BP13C902'.                
                                                                                
       01  WS-EDIT-CD-DEBIT          PIC Z,ZZZ,ZZ9.99- VALUE ZEROS.             
                                                                                
       01  WS-NUM-RECEIPT-JRNO.                                                 
           05  WS-RECEIPT-CD         PIC X(2).                                  
           05  WS-RECEIPT-DATE.                                                 
               10  WS-RECEIPT-DD     PIC 9(2).                                  
               10  WS-RECEIPT-MM     PIC 9(2).                                  
               10  WS-SLASH          PIC X.                                     
               10  WS-RECEIPT-YY     PIC 9(2).                                  
           05  WS-NUM-DOC            PIC 9(5)   VALUE ZEROES.                   
                                                                                
       01   WS-NUM-BO                     PIC X(02).                            
       01   WS-LINK-REC.                                                        
            05 WS-LINK-NUM-OFFICE         PIC X(8).                             
            05 WS-LINK-NUM-TYPE-OFFICE    PIC X(15).                            
            05 WS-LINK-NUM-SQNC           PIC X(2).                             
       01   WS-SQL-CODE                   PIC 9(4).                             
                                                                                
       COPY P13COMM4.                                                           
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED TO SUB-PROGRAM "AV02C021"          *             
      *-----------------------------------------------------------*             
       COPY P13GST01.                                                           
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED TO SUB-PROGRAM "BP13C90B"          *             
      *-----------------------------------------------------------*             
       COPY P13GST02.                                                           
                                                                                
                                                                                
      *------------------------*                                                
       PROCEDURE DIVISION.                                                      
      *------------------------*                                                
                                                                                
      *------------------------*                                                
       001-MAIN.                                                                
      *------------------------*                                                
           PERFORM 010-START-PROCESS  THRU 010-EXIT.                            
           PERFORM 020-READ-F400      THRU 020-EXIT.                            
           PERFORM 030-PROCESS-UPDATE THRU 030-EXIT                             
                   UNTIL WS-EOF-F400 = 'Y'.                                     
           PERFORM 040-END-PROCESS    THRU 040-EXIT.                            
                                                                                
       001-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *------------------------*                                                
       010-START-PROCESS.                                                       
      *------------------------*                                                
           OPEN INPUT BP13F400                                                  
                      BP13K350                                                  
                I-O   BP13K800                                                  
               OUTPUT BP13F120.                                                 
                                                                                
           IF K800-STATUS NOT = 0 AND 97                                        
              DISPLAY 'OPENING ERROR K800-STATUS IS ' K800-STATUS               
              PERFORM 040-END-PROCESS THRU 040-EXIT.                            
                                                                                
           IF K350-STATUS NOT = 0 AND 97                                        
              DISPLAY 'OPENING ERROR K350-STATUS IS ' K350-STATUS               
              PERFORM 040-END-PROCESS THRU 040-EXIT.                            
                                                                                
           MOVE FUNCTION CURRENT-DATE TO WS-DATE.                               
           MOVE SPACES                TO WS-PROGRAM-SWITCHES.                   
           MOVE ZEROS                 TO WS-COUNTERS.                           
           MOVE 'N'                   TO WS-EOF-F400.                           
           CALL 'BP13C90D' USING WS-COMM-AREA-GST.                              
                                                                                
       010-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *             INITIAL READING OF BP13F400 FILE                   *        
      ******************************************************************        
      *------------------------*                                                
       020-READ-F400.                                                           
      *------------------------*                                                
           READ BP13F400 AT END                                                 
                         MOVE 'Y' TO WS-EOF-F400                                
                         GO TO 020-EXIT.                                        
                                                                                
           ADD 1 TO WS-READ-CNT.                                                
                                                                                
       020-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *------------------------*                                                
       030-PROCESS-UPDATE.                                                      
      *------------------------*                                                
                                                                                
           PERFORM 100-READ-BP13K800 THRU 100-EXIT.                             
                                                                                
           IF F400-AMT-LOAN                  IS NOT NUMERIC                     
              MOVE ZEROES    TO F400-AMT-LOAN.                                  
                                                                                
           IF (F400-AMT-LOAN > ZEROS) AND                                       
              (F400-CDE-SALES-TYPE NOT = '19')                                  
              PERFORM 320-TEMP-LOAN THRU 320-EXIT                               
              PERFORM 020-READ-F400    THRU 020-EXIT                            
              GO TO 030-EXIT                                                    
           END-IF.                                                              
                                                                                
           IF F400-CDE-SALES-TYPE = '19'                                        
              PERFORM 330-FSH-F120     THRU 330-EXIT                            
              PERFORM 020-READ-F400    THRU 020-EXIT                            
              GO TO 030-EXIT                                                    
           END-IF.                                                              
                                                                                
           IF WS-K800-REC-FND = 'Y'                                             
              IF (F400-CDE-SA-TP = 'Y') OR                                      
                 (K800-NUM-HALF-IDP = 'D'  OR 'F')                              
                 PERFORM 105-CHECK-BK-PAID       THRU 105-EXIT                  
              ELSE                                                              
                 PERFORM 110-CHECK-CD-AMT        THRU 110-EXIT                  
              END-IF                                                            
              PERFORM 120-CHECK-DEBTOR           THRU 120-EXIT                  
              PERFORM 130-CHECK-OTHER-TRANS      THRU 130-EXIT                  
                                                                                
              IF (F400-CDE-SA-TP = 'Y') OR                                      
                 (K800-NUM-HALF-IDP = 'D'  OR 'F')                              
                 PERFORM 133-PROCESS-BK-TRANSFER THRU 133-EXIT                  
              END-IF                                                            
           ELSE                                                                 
              DISPLAY ' REGN NOT-FND' F400-NUM-REGN                             
           END-IF.                                                              
                                                                                
           PERFORM 020-READ-F400    THRU 020-EXIT.                              
                                                                                
       030-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *------------------------*                                                
       040-END-PROCESS.                                                         
      *------------------------*                                                
           CLOSE   BP13F400                                                     
                   BP13K800                                                     
                   BP13K350                                                     
                   BP13F120.                                                    
                                                                                
           IF K800-STATUS NOT = 0 AND 97                                        
              DISPLAY 'CLOSING ERROR, K800-STATUS IS ' K800-STATUS.             
                                                                                
           IF K350-STATUS NOT = 0 AND 97                                        
              DISPLAY 'CLOSING ERROR, K350-STATUS IS ' K350-STATUS.             
                                                                                
           DISPLAY ' =============  BP13C286 ===================='.             
           DISPLAY 'NO OF RECORDS READ FROM BP13F400  = ' WS-READ-CNT.          
           DISPLAY 'NO OF RECORDS WRITTEN TO BP13F120 = ' WS-WRITE-CNT.         
           DISPLAY ' ============================================'.             
                                                                                
           STOP RUN.                                                            
                                                                                
       040-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    USE THE REG  NUMBER IN BP13F400 FILE TO ACCESS THE RECORDS  *        
      *    IN BP13K800 FILE.                                           *        
      ******************************************************************        
      *------------------------*                                                
       100-READ-BP13K800.                                                       
      *------------------------*                                                
           MOVE 'Y'           TO WS-K800-REC-FND.                               
           MOVE F400-NUM-REGN TO K800-NUM-REGN.                                 
                                                                                
           READ BP13K800.                                                       
                                                                                
           IF K800-STATUS = ZEROES                                              
              NEXT SENTENCE                                                     
           ELSE                                                                 
              IF K800-STATUS = 23                                               
                 DISPLAY 'REC NOT FOUND IN BP13K800 '                           
                      F400-NUM-REGN                                             
                 MOVE 'N' TO WS-K800-REC-FND                                    
              ELSE                                                              
                 DISPLAY 'ERROR READING BP13K800, STATUS : '                    
                      K800-STATUS                                               
                 PERFORM 040-END-PROCESS    THRU 040-EXIT.                      
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ***************************************************                       
      *  ZEROLISE BOOKING FEE FOR BOOKING FEE USED AS   *                       
      *  BOOKING FEE IS TRANSFER TO CD TO BE USED AS ICP*                       
      ***************************************************                       
      *------------------------*                                                
       105-CHECK-BK-PAID.                                                       
      *------------------------*                                                
           DISPLAY '105-CHECK-BK-PAID'.                                         
                                                                                
           IF F400-DTE-ARGORDER NOT NUMERIC                                     
              MOVE ZEROES                TO   K800-DTE-SALE-AGMT                
              MOVE ZEROES                TO   K800-DTE-RAISE-AO                 
           ELSE                                                                 
             MOVE F400-DTE-ARGORDER      TO   K800-DTE-SALE-AGMT                
             MOVE F400-DTE-ARGORDER      TO   K800-DTE-RAISE-AO.                
                                                                                
      *-------------------------------------------------*                       
      *  SINCE APPLICANT ALREADY COLLECTED KEYS         *                       
      *  DELIVERY POSSESSION DATE SHOULD BE SO-DATE.    *                       
      *-------------------------------------------------*                       
           IF F400-DTE-DELIVERY-POSSN  NOT NUMERIC                              
              MOVE ZEROES                  TO K800-DTE-DELIVERY-POSSN           
           ELSE                                                                 
              MOVE F400-DTE-DELIVERY-POSSN TO K800-DTE-DELIVERY-POSSN.          
                                                                                
           IF F400-CDE-ASPF = 'Y'                                               
              MOVE F400-CDE-ASPF           TO   K800-NUM-ASPF.                  
                                                                                
           IF F400-AMT-LEASE-STAMP NOT NUMERIC                                  
              MOVE ZEROES                  TO  K800-AMT-LEASE-FEE               
           ELSE                                                                 
              MOVE F400-AMT-LEASE-STAMP    TO  K800-AMT-LEASE-FEE.              
                                                                                
           IF F400-AMT-CONVEY      NOT NUMERIC                                  
              MOVE ZEROES                  TO  F400-AMT-CONVEY                  
           ELSE                                                                 
              MOVE F400-AMT-CONVEY         TO  K800-AMT-CONVEY-FEE              
              MOVE F400-AMT-CONVEY-GST     TO  K800-AMT-CONVEY-FEE-GST.         
                                                                                
           IF F400-AMT-BK-TRANSFER NOT NUMERIC                                  
              MOVE ZEROES                  TO  F400-AMT-BK-TRANSFER             
              MOVE ZEROES                  TO  K800-AMT-BK-TR                   
           ELSE                                                                 
              MOVE F400-AMT-BK-TRANSFER    TO  K800-AMT-BK-TR.                  
                                                                                
           PERFORM 400-REWRITE-BP13K800 THRU 400-EXIT.                          
                                                                                
           DISPLAY '--------------------------------'.                          
           DISPLAY 'NUM-REGN    = ' K800-NUM-REGN.                              
           DISPLAY 'AMT-BK-PAID = ' K800-AMT-BK-PAID.                           
           DISPLAY 'AMT-BK-TRSF = ' F400-AMT-BK-TRANSFER.                       
                                                                                
           IF K800-AMT-BK-PAID NOT NUMERIC                                      
              MOVE ZEROES      TO  K800-AMT-BK-PAID.                            
                                                                                
           IF K800-AMT-BK-PAID > ZEROES                                         
              ADD 1                      TO WS-NUM-DOC                          
              IF F400-AMT-BK-TRANSFER = ZEROES                                  
                 NEXT SENTENCE                                                  
              ELSE                                                              
                IF F400-AMT-BK-TRANSFER > K800-AMT-BK-PAID                      
                   DISPLAY 'F400-NUM-REGN ' F400-NUM-REGN                       
                   DISPLAY 'BK FEE TRANSF > PAID ' F400-AMT-BK-TRANSFER         
                   ' > ' K800-AMT-BK-PAID                                       
                ELSE                                                            
                   ADD  F400-AMT-BK-TRANSFER TO   K800-AMT-SOC-CASH             
                   COMPUTE WS-BK-TRANSFER =  K800-AMT-BK-PAID -                 
                                             F400-AMT-BK-TRANSFER               
                   MOVE WS-BK-TRANSFER       TO   K800-AMT-BK-PAID              
                   MOVE +0                   TO   WS-BK-TRANSFER                
                END-IF                                                          
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 175-PROCESS-SOC-CASH THRU 175-EXIT.                          
                                                                                
       105-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    TO CHECK WHETHER THE K800-AMT-CD IS EQUAL TO ZEROS          *        
      ******************************************************************        
      *------------------------*                                                
       110-CHECK-CD-AMT.                                                        
      *------------------------*                                                
           IF K800-AMT-CD NOT NUMERIC                                           
              MOVE ZEROES    TO K800-AMT-CD.                                    
                                                                                
           IF K800-AMT-CD     = ZEROES                                          
              GO TO 110-EXIT                                                    
           ELSE                                                                 
              ADD 1          TO WS-NUM-DOC.                                     
                                                                                
           PERFORM 200-PROCESS-CD-AMT THRU 200-EXIT.                            
                                                                                
       110-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    TO CHECK FOR SOC DEBTOR                                              
      ******************************************************************        
      *------------------------*                                                
       120-CHECK-DEBTOR.                                                        
      *------------------------*                                                
           IF F400-AMT-ICP-CASH IS NOT NUMERIC                                  
              MOVE ZEROES    TO F400-AMT-ICP-CASH.                              
                                                                                
           IF F400-AMT-ICP-CPF1   IS NOT NUMERIC                                
              MOVE ZEROES TO  F400-AMT-ICP-CPF1.                                
                                                                                
           IF F400-AMT-ICP-CPF2   IS NOT NUMERIC                                
              MOVE ZEROES TO  F400-AMT-ICP-CPF2.                                
                                                                                
           IF F400-AMT-ICP-CPF3   IS NOT NUMERIC                                
              MOVE ZEROES TO  F400-AMT-ICP-CPF3.                                
                                                                                
           IF F400-AMT-ICP-CPF4   IS NOT NUMERIC                                
              MOVE ZEROES TO  F400-AMT-ICP-CPF4.                                
                                                                                
           IF F400-AMT-SER-CONTRA-ICP IS NOT NUMERIC                            
              MOVE ZEROES    TO F400-AMT-SER-CONTRA-ICP.                        
                                                                                
           IF F400-AMT-SER-CONTRA-STAMP-FEES IS NOT NUMERIC                     
              MOVE ZEROES    TO F400-AMT-SER-CONTRA-STAMP-FEES.                 
                                                                                
           IF F400-AMT-SER-CONTRA-CONVY-FEES IS NOT NUMERIC                     
              MOVE ZEROES    TO F400-AMT-SER-CONTRA-CONVY-FEES.                 
                                                                                
           IF F400-AMT-SER-CONTRA-MISC-FEE   IS NOT NUMERIC                     
              MOVE ZEROES    TO F400-AMT-SER-CONTRA-MISC-FEE.                   
                                                                                
           COMPUTE WS-AMT-ICP-TOTAL = F400-AMT-ICP-CASH +                       
                                      F400-AMT-ICP-CPF1 +                       
                                      F400-AMT-ICP-CPF2 +                       
                                      F400-AMT-ICP-CPF3 +                       
                                      F400-AMT-ICP-CPF4 +                       
                                      F400-AMT-SER-CONTRA-ICP +                 
                                      F400-AMT-SER-CONTRA-STAMP-FEES +          
                                      F400-AMT-SER-CONTRA-MISC-FEE   +          
                                      F400-AMT-SER-CONTRA-CONVY-FEES.           
                                                                                
           IF WS-AMT-ICP-TOTAL NOT = ZEROES                                     
              ADD 1          TO WS-NUM-DOC                                      
              PERFORM 310-UPDATE-BP13F120 THRU 310-EXIT                         
                                                                                
              ADD WS-AMT-ICP-TOTAL TO K800-AMT-SOC-DEBTOR                       
                                      K800-AMT-SOC-CASH-REQ                     
              PERFORM 400-REWRITE-BP13K800 THRU 400-EXIT                        
           END-IF.                                                              
                                                                                
       120-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    TO CHECK OTHER TRANSACTIONS                                          
      ******************************************************************        
      *------------------------*                                                
       130-CHECK-OTHER-TRANS.                                                   
      *------------------------*                                                
                                                                                
      *=========================                                                
      *  CREDIT LEASE STAMP FEE                                                 
      *=========================                                                
           IF F400-AMT-LEASE-STAMP-CASH NOT NUMERIC                             
              MOVE  ZERO                 TO F400-AMT-LEASE-STAMP-CASH           
           END-IF.                                                              
                                                                                
           IF F400-AMT-LEASE-STAMP-CASH NOT = 0                                 
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE  F400-AMT-LEASE-STAMP-CASH TO F120-AMT-RECEIPT               
              MOVE  'C'                  TO F120-CDE-CRDR                       
              MOVE  F400-NUM-REGN        TO F120-NUM-REGN                       
              MOVE  F400-NRIC1           TO F120-NUM-NRIC                       
              MOVE  F400-NUM-SCH-ACC     TO F120-NUM-SCH-ACCT                   
              MOVE  WS-DATE              TO F120-DTE-POST                       
              MOVE  WS-DATE              TO F120-DTE-TRANS                      
              MOVE  '23'                 TO F120-CDE-TRANS-TYPE                 
              MOVE  'LSE'                TO F120-CDE-PAYMENT-TYPE               
              MOVE ZEROES                TO F120-COUNT-HISTORY                  
              MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                              
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
              END-IF                                                            
              IF K800-NUM-LEASE-BUY-BACK = 'Y'                                  
                 MOVE 'L'                TO F120-CDE-VALID                      
              END-IF                                                            
              WRITE BP13F120-CASHTRAN                                           
              ADD 1 TO        WS-WRITE-CNT.                                     
                                                                                
      *=========================                                                
      *  CREDIT CONVEYANCE FEE                                                  
      *=========================                                                
           IF F400-AMT-CONVEY-FEE IS NOT NUMERIC                                
              MOVE  ZERO    TO  F400-AMT-CONVEY-FEE.                            
                                                                                
           IF F400-AMT-CONVEY-FEE NOT = 0                                       
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE  F400-NUM-REGN        TO F120-NUM-REGN                       
              MOVE  F400-NRIC1           TO F120-NUM-NRIC                       
              MOVE  F400-NUM-SCH-ACC     TO F120-NUM-SCH-ACCT                   
              MOVE  WS-DATE              TO F120-DTE-POST                       
              MOVE  WS-DATE              TO F120-DTE-TRANS                      
              MOVE '23'                  TO F120-CDE-TRANS-TYPE                 
              MOVE 'CON'                 TO F120-CDE-PAYMENT-TYPE               
              MOVE F400-AMT-CONVEY-FEE   TO F120-AMT-RECEIPT                    
              MOVE 'C'                   TO F120-CDE-CRDR                       
              MOVE ZEROES                TO F120-COUNT-HISTORY                  
              MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                              
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
              END-IF                                                            
              IF K800-NUM-LEASE-BUY-BACK = 'Y'                                  
                 MOVE 'L'                TO F120-CDE-VALID                      
              END-IF                                                            
              WRITE BP13F120-CASHTRAN                                           
              ADD 1 TO        WS-WRITE-CNT.                                     
                                                                                
      *===========================                                              
      *  CREDIT CONVEYANCE-GST FEE                                              
      *===========================                                              
           IF F400-AMT-CONVEY-FEE-GST NOT NUMERIC                               
              MOVE   ZERO                TO F400-AMT-CONVEY-FEE-GST             
           END-IF.                                                              
                                                                                
           IF F400-AMT-CONVEY-FEE-GST NOT = 0                                   
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE  F400-NUM-REGN        TO F120-NUM-REGN                       
              MOVE  F400-NRIC1           TO F120-NUM-NRIC                       
              MOVE  F400-NUM-SCH-ACC     TO F120-NUM-SCH-ACCT                   
              MOVE  WS-DATE              TO F120-DTE-POST                       
              MOVE  WS-DATE              TO F120-DTE-TRANS                      
              MOVE '23'                  TO F120-CDE-TRANS-TYPE                 
              MOVE 'CST'                 TO F120-CDE-PAYMENT-TYPE               
              MOVE F400-AMT-CONVEY-FEE-GST TO F120-AMT-RECEIPT                  
              MOVE 'C'                   TO F120-CDE-CRDR                       
              MOVE ZEROES                TO F120-COUNT-HISTORY                  
              MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                              
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
              END-IF                                                            
              IF K800-NUM-LEASE-BUY-BACK = 'Y'                                  
                 MOVE 'L'                TO F120-CDE-VALID                      
              END-IF                                                            
              IF K800-NUM-REGN = '1557169A' OR '1555490H'                       
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
                MOVE 'L'                TO F120-CDE-VALID                       
              END-IF                                                            
              WRITE BP13F120-CASHTRAN                                           
              ADD 1 TO        WS-WRITE-CNT.                                     
                                                                                
      *===================                                                      
      * CREDIT CONVEY SATP                                                      
      *===================                                                      
           IF F400-CDE-SA-TP = 'Y'                                              
              PERFORM 131-PROCESS-CONVEY-SATP THRU 131-EXIT                     
           END-IF.                                                              
                                                                                
      *===================                                                      
      * DEBIT RESALE LEVY                                                       
      *===================                                                      
           IF F400-AMT-RLEVY-HA1 NOT NUMERIC                                    
              MOVE  ZERO                 TO F400-AMT-RLEVY-HA1                  
           END-IF.                                                              
                                                                                
           IF F400-AMT-RLEVY-HA2 NOT NUMERIC                                    
              MOVE  ZERO                 TO F400-AMT-RLEVY-HA2                  
           END-IF.                                                              
                                                                                
           MOVE 0                        TO WS-LEVY-AMT.                        
                                                                                
           IF (F400-AMT-RLEVY-HA1  NOT = 0)                                     
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              COMPUTE F120-AMT-RECEIPT = F400-AMT-RLEVY-HA1   * -1              
              ADD   F120-AMT-RECEIPT     TO WS-LEVY-AMT                         
              MOVE  'D'                  TO F120-CDE-CRDR                       
              MOVE  F400-NUM-REGN        TO F120-NUM-REGN                       
              MOVE  F400-NRIC1           TO F120-NUM-NRIC                       
              MOVE  F400-NUM-SCH-ACC     TO F120-NUM-SCH-ACCT                   
              MOVE  WS-DATE              TO F120-DTE-POST                       
              MOVE  WS-DATE              TO F120-DTE-TRANS                      
              MOVE  '23'                 TO F120-CDE-TRANS-TYPE                 
              MOVE  'LVL'                TO F120-CDE-PAYMENT-TYPE               
              MOVE ZEROES                TO F120-COUNT-HISTORY                  
              MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                              
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
              END-IF                                                            
              IF K800-NUM-LEASE-BUY-BACK = 'Y'                                  
                 MOVE 'L'                TO F120-CDE-VALID                      
              END-IF                                                            
              IF K800-NUM-REGN = '1557169A' OR '1555490H'                       
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
                MOVE 'L'                TO F120-CDE-VALID                       
              END-IF                                                            
                                                                                
              PERFORM 140-GET-RESALE-FT  THRU 140-EXIT                          
              IF WS-K350-FOUND = 'Y'                                            
                 MOVE K350-NUM-HA1-RSLE-FT TO F120-NUM-FLAT-TYPE-RSL            
                 WRITE BP13F120-CASHTRAN                                        
                 ADD 1 TO        WS-WRITE-CNT                                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF (F400-AMT-RLEVY-HA2  NOT = 0)                                     
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              COMPUTE F120-AMT-RECEIPT = F400-AMT-RLEVY-HA2  * -1               
              ADD   F120-AMT-RECEIPT     TO WS-LEVY-AMT                         
              MOVE  'D'                  TO F120-CDE-CRDR                       
              MOVE  F400-NUM-REGN        TO F120-NUM-REGN                       
              MOVE  F400-NRIC1           TO F120-NUM-NRIC                       
              MOVE  F400-NUM-SCH-ACC     TO F120-NUM-SCH-ACCT                   
              MOVE  WS-DATE              TO F120-DTE-POST                       
              MOVE  WS-DATE              TO F120-DTE-TRANS                      
              MOVE  '23'                 TO F120-CDE-TRANS-TYPE                 
              MOVE  'LVL'                TO F120-CDE-PAYMENT-TYPE               
              MOVE ZEROES                TO F120-COUNT-HISTORY                  
              MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                              
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
              END-IF                                                            
              IF K800-NUM-LEASE-BUY-BACK = 'Y'                                  
                 MOVE 'L'                TO F120-CDE-VALID                      
              END-IF                                                            
              IF K800-NUM-REGN = '1557169A' OR '1555490H'                       
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
                MOVE 'L'                TO F120-CDE-VALID                       
              END-IF                                                            
                                                                                
                                                                                
              PERFORM 140-GET-RESALE-FT  THRU 140-EXIT                          
              IF WS-K350-FOUND = 'Y'                                            
                 MOVE K350-NUM-HA2-RSLE-FT TO F120-NUM-FLAT-TYPE-RSL            
                 WRITE BP13F120-CASHTRAN                                        
                 ADD 1 TO        WS-WRITE-CNT                                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *================================                                         
      * DEBIT PREMIUM ON RESALE OF FLAT                                         
      *================================                                         
           IF F400-NUM-PREMIUM-RATE   NOT NUMERIC                               
              MOVE  ZERO                 TO F400-NUM-PREMIUM-RATE               
           END-IF.                                                              
                                                                                
           IF F400-AMT-PREMIUM-NEW    NOT NUMERIC                               
              MOVE  ZERO                 TO F400-AMT-PREMIUM-NEW                
           END-IF.                                                              
                                                                                
           IF F400-AMT-PREMIUM-NEW > ZEROES                                     
      *    IF F400-NUM-PREMIUM-RATE   NOT = 0                                   
              MOVE  SPACES                TO BP13F120-CASHTRAN                  
              MOVE F400-AMT-PREMIUM-NEW   TO F120-AMT-RECEIPT                   
              MOVE  'C'                   TO F120-CDE-CRDR                      
              MOVE  F400-NUM-REGN         TO F120-NUM-REGN                      
              MOVE  F400-NRIC1            TO F120-NUM-NRIC                      
              MOVE  F400-NUM-SCH-ACC      TO F120-NUM-SCH-ACCT                  
              MOVE  K800-NUM-FLAT-TYPE    TO F120-NUM-FLAT-TYPE-SA              
              MOVE  WS-DATE               TO F120-DTE-POST                      
              MOVE  WS-DATE               TO F120-DTE-TRANS                     
              MOVE  '32'                  TO F120-CDE-TRANS-TYPE                
              MOVE  'PRM'                 TO F120-CDE-PAYMENT-TYPE              
              MOVE ZEROES                 TO F120-COUNT-HISTORY                 
              MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                              
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
              END-IF                                                            
              IF K800-NUM-LEASE-BUY-BACK = 'Y'                                  
                 MOVE 'L'                TO F120-CDE-VALID                      
              END-IF                                                            
              IF K800-NUM-REGN = '1557169A' OR '1555490H'                       
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
                MOVE 'L'                TO F120-CDE-VALID                       
              END-IF                                                            
              WRITE BP13F120-CASHTRAN                                           
              ADD 1 TO        WS-WRITE-CNT.                                     
                                                                                
      *===================                                                      
      * CREDIT SURVEY FEES                                                      
      *===================                                                      
           IF F400-AMT-SURVEY-FEE NOT NUMERIC                                   
              MOVE  ZERO    TO  F400-AMT-SURVEY-FEE.                            
                                                                                
           IF F400-AMT-SURVEY-FEE NOT = 0                                       
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE  F400-NUM-REGN        TO F120-NUM-REGN                       
              MOVE  F400-NRIC1           TO F120-NUM-NRIC                       
              MOVE  F400-NUM-SCH-ACC     TO F120-NUM-SCH-ACCT                   
              PERFORM 135-GET-AREA-DESCR THRU 135-EXIT                          
              MOVE  WS-NUM-BO            TO F120-CDE-BO                         
              MOVE  WS-DATE              TO F120-DTE-POST                       
              MOVE  WS-DATE              TO F120-DTE-TRANS                      
              MOVE '30'                  TO F120-CDE-TRANS-TYPE                 
              MOVE 'SRV'                 TO F120-CDE-PAYMENT-TYPE               
              MOVE F400-AMT-SURVEY-FEE   TO F120-AMT-RECEIPT                    
              MOVE 'C'                   TO F120-CDE-CRDR                       
              MOVE ZEROES                TO F120-COUNT-HISTORY                  
              MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                              
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
              END-IF                                                            
              IF K800-NUM-LEASE-BUY-BACK = 'Y'                                  
                 MOVE 'L'                TO F120-CDE-VALID                      
              END-IF                                                            
              IF K800-NUM-REGN = '1557169A' OR '1555490H'                       
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
                MOVE 'L'                TO F120-CDE-VALID                       
              END-IF                                                            
              WRITE BP13F120-CASHTRAN                                           
              ADD 1 TO        WS-WRITE-CNT.                                     
                                                                                
      *======================                                                   
      * CREDIT SURVEY FEE GST                                                   
      *======================                                                   
           IF F400-AMT-SURVEY-FEE-GST NOT NUMERIC                               
              MOVE   ZERO                TO F400-AMT-SURVEY-FEE-GST             
           END-IF.                                                              
                                                                                
           IF F400-AMT-SURVEY-FEE-GST NOT = 0                                   
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE  F400-NUM-REGN        TO F120-NUM-REGN                       
              MOVE  F400-NRIC1           TO F120-NUM-NRIC                       
              MOVE  F400-NUM-SCH-ACC     TO F120-NUM-SCH-ACCT                   
              MOVE  WS-DATE              TO F120-DTE-POST                       
              MOVE  WS-DATE              TO F120-DTE-TRANS                      
              MOVE '30'                  TO F120-CDE-TRANS-TYPE                 
              MOVE 'SST'                 TO F120-CDE-PAYMENT-TYPE               
              MOVE F400-AMT-SURVEY-FEE-GST TO F120-AMT-RECEIPT                  
              MOVE 'C'                   TO F120-CDE-CRDR                       
              MOVE ZEROES                TO F120-COUNT-HISTORY                  
              MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                              
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
              END-IF                                                            
              IF K800-NUM-LEASE-BUY-BACK = 'Y'                                  
                 MOVE 'L'                TO F120-CDE-VALID                      
              END-IF                                                            
              IF K800-NUM-REGN = '1557169A' OR '1555490H'                       
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
                MOVE 'L'                TO F120-CDE-VALID                       
              END-IF                                                            
              WRITE BP13F120-CASHTRAN                                           
              ADD 1 TO        WS-WRITE-CNT.                                     
                                                                                
      *======================                                                   
      * CREDIT LEASE REGN FEE                                                   
      * CREDIT LEASE ESCROW FEE                                                 
      *======================                                                   
           IF F400-AMT-LEASE-REGN-FEE NOT NUMERIC                               
              MOVE   ZERO                TO F400-AMT-LEASE-REGN-FEE             
           END-IF.                                                              
                                                                                
           IF F400-AMT-LEASE-ESCROW-FEE NOT NUMERIC                             
              MOVE   ZERO           TO F400-AMT-LEASE-ESCROW-FEE                
           END-IF.                                                              
                                                                                
           IF F400-AMT-LEASE-REGN-FEE   NOT = 0  OR                             
              F400-AMT-LEASE-ESCROW-FEE NOT = 0                                 
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE  F400-NUM-REGN        TO F120-NUM-REGN                       
              MOVE  F400-NRIC1           TO F120-NUM-NRIC                       
              MOVE  F400-NUM-SCH-ACC     TO F120-NUM-SCH-ACCT                   
              MOVE  WS-DATE              TO F120-DTE-POST                       
              MOVE  WS-DATE              TO F120-DTE-TRANS                      
              MOVE '31'                  TO F120-CDE-TRANS-TYPE                 
              MOVE 'LRF'                 TO F120-CDE-PAYMENT-TYPE               
              COMPUTE F120-AMT-RECEIPT = F400-AMT-LEASE-REGN-FEE   +            
                                         F400-AMT-LEASE-ESCROW-FEE              
              MOVE 'C'                   TO F120-CDE-CRDR                       
              MOVE ZEROES                TO F120-COUNT-HISTORY                  
              MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                              
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
              END-IF                                                            
              IF K800-NUM-LEASE-BUY-BACK = 'Y'                                  
                 MOVE 'L'                TO F120-CDE-VALID                      
              END-IF                                                            
              IF K800-NUM-REGN = '1557169A' OR '1555490H'                       
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
                MOVE 'L'                TO F120-CDE-VALID                       
              END-IF                                                            
              WRITE BP13F120-CASHTRAN                                           
              ADD 1 TO        WS-WRITE-CNT.                                     
                                                                                
                                                                                
      *=========================                                                
      * CREDIT PREMIUM STAMP FEE                                                
      *=========================                                                
                                                                                
           IF F400-AMT-PREMIUM-STAMP-FEE NOT NUMERIC                            
              MOVE   ZERO           TO F400-AMT-PREMIUM-STAMP-FEE               
           END-IF.                                                              
                                                                                
           IF F400-AMT-PREMIUM-STAMP-FEE NOT = 0                                
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE  F400-NUM-REGN        TO F120-NUM-REGN                       
              MOVE  F400-NRIC1           TO F120-NUM-NRIC                       
              MOVE  F400-NUM-SCH-ACC     TO F120-NUM-SCH-ACCT                   
              MOVE  WS-DATE              TO F120-DTE-POST                       
              MOVE  WS-DATE              TO F120-DTE-TRANS                      
              MOVE '23'                  TO F120-CDE-TRANS-TYPE                 
              MOVE 'LSE'                 TO F120-CDE-PAYMENT-TYPE               
              MOVE F400-AMT-PREMIUM-STAMP-FEE TO F120-AMT-RECEIPT               
              MOVE 'C'                   TO F120-CDE-CRDR                       
              MOVE ZEROES                TO F120-COUNT-HISTORY                  
              MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                              
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
              END-IF                                                            
              IF K800-NUM-LEASE-BUY-BACK = 'Y'                                  
                 MOVE 'L'                TO F120-CDE-VALID                      
              END-IF                                                            
              IF K800-NUM-REGN = '1557169A' OR '1555490H'                       
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
                MOVE 'L'                TO F120-CDE-VALID                       
              END-IF                                                            
              WRITE BP13F120-CASHTRAN                                           
              ADD 1 TO        WS-WRITE-CNT.                                     
                                                                                
      *===================================                                      
      *  DEBIT CONTRA AMT AND LOG AS 'ADV'                                      
      *===================================                                      
                                                                                
           IF F400-CDE-SA-TP = 'Y'                                              
              PERFORM 155-ADV-COLLN-SATP THRU 155-EXIT                          
           ELSE                                                                 
              PERFORM 150-ADV-COLLN-TP   THRU 150-EXIT                          
           END-IF.                                                              
                                                                                
           IF F400-AMT-CONTRA-HA1 NOT NUMERIC                                   
              MOVE  ZERO                 TO F400-AMT-CONTRA-HA1                 
           END-IF.                                                              
                                                                                
           IF F400-AMT-CONTRA-HA2 NOT NUMERIC                                   
              MOVE  ZERO                 TO F400-AMT-CONTRA-HA2                 
           END-IF.                                                              
                                                                                
           IF (F400-AMT-CONTRA-HA1 NOT = 0) OR                                  
              (F400-AMT-CONTRA-HA2 NOT = 0)                                     
              MOVE SPACES                TO BP13F120-CASHTRAN                   
              COMPUTE F120-AMT-RECEIPT = (F400-AMT-CONTRA-HA1 +                 
                                          F400-AMT-CONTRA-HA2) * -1             
              MOVE 'D'                   TO F120-CDE-CRDR                       
              MOVE F400-NUM-REGN         TO F120-NUM-REGN                       
              MOVE F400-NRIC1            TO F120-NUM-NRIC                       
              MOVE F400-NUM-SCH-ACC      TO F120-NUM-SCH-ACCT                   
              MOVE WS-DATE               TO F120-DTE-POST                       
              MOVE WS-DATE               TO F120-DTE-TRANS                      
              MOVE '23'                  TO F120-CDE-TRANS-TYPE                 
              MOVE 'ADV'                 TO F120-CDE-PAYMENT-TYPE               
              MOVE ZEROES                TO F120-COUNT-HISTORY                  
              MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                              
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
              END-IF                                                            
              IF K800-NUM-LEASE-BUY-BACK = 'Y'                                  
                 MOVE 'L'                TO F120-CDE-VALID                      
              END-IF                                                            
              IF K800-NUM-REGN = '1557169A' OR '1555490H'                       
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
                MOVE 'L'                TO F120-CDE-VALID                       
              END-IF                                                            
              WRITE BP13F120-CASHTRAN                                           
              ADD 1 TO        WS-WRITE-CNT                                      
           END-IF.                                                              
                                                                                
       130-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *=================================                                        
      *  CREDIT CONVEYANCE FOR SATP                                             
      *  CREDIT CONVEYANCE-GST FOR SATP                                         
      *=================================                                        
      *------------------------*                                                
       131-PROCESS-CONVEY-SATP.                                                 
      *------------------------*                                                
           IF F400-AMT-CONVEY IS NOT NUMERIC                                    
              MOVE  ZERO    TO  F400-AMT-CONVEY.                                
                                                                                
           IF F400-AMT-CONVEY-GST NOT NUMERIC                                   
              MOVE   ZERO                TO F400-AMT-CONVEY-GST                 
           END-IF.                                                              
                                                                                
           IF F400-AMT-CONV-CASH IS NOT NUMERIC                                 
              MOVE  ZERO    TO  F400-AMT-CONV-CASH.                             
                                                                                
           IF F400-AMT-CONV-CASH NOT = 0                                        
              MOVE    F400-AMT-CONV-CASH   TO   WS-TEMP-CONVEY-FEE              
              PERFORM 500-COMP-GST-AMOUNT  THRU 500-EXIT                        
              COMPUTE WS-TEMP-CONV-CASH = WS-TEMP-CONVEY-FEE -                  
                                          WS-TEMP-CONVEY-FEE-GST                
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE  F400-NUM-REGN        TO F120-NUM-REGN                       
              MOVE  F400-NRIC1           TO F120-NUM-NRIC                       
              MOVE  F400-NUM-SCH-ACC     TO F120-NUM-SCH-ACCT                   
              MOVE  WS-DATE              TO F120-DTE-POST                       
              MOVE  WS-DATE              TO F120-DTE-TRANS                      
              MOVE '23'                  TO F120-CDE-TRANS-TYPE                 
              MOVE 'CON'                 TO F120-CDE-PAYMENT-TYPE               
      *       MOVE F400-AMT-CONVEY       TO F120-AMT-RECEIPT                    
              IF F400-AMT-CONVEY = F400-AMT-CONV-CASH                           
                 MOVE F400-AMT-CONVEY TO F120-AMT-RECEIPT                       
              ELSE                                                              
                 MOVE WS-TEMP-CONV-CASH     TO F120-AMT-RECEIPT                 
              END-IF                                                            
              MOVE 'C'                   TO F120-CDE-CRDR                       
              MOVE ZEROES                TO F120-COUNT-HISTORY                  
              MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                              
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
              END-IF                                                            
              IF K800-NUM-LEASE-BUY-BACK = 'Y'                                  
                 MOVE 'L'                TO F120-CDE-VALID                      
              END-IF                                                            
              IF K800-NUM-REGN = '1557169A' OR '1555490H'                       
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
                MOVE 'L'                TO F120-CDE-VALID                       
              END-IF                                                            
              WRITE BP13F120-CASHTRAN                                           
              ADD 1 TO        WS-WRITE-CNT                                      
                                                                                
              IF WS-TEMP-CONVEY-FEE-GST NOT = 0                                 
                 MOVE  SPACES               TO BP13F120-CASHTRAN                
                 MOVE  F400-NUM-REGN        TO F120-NUM-REGN                    
                 MOVE  F400-NRIC1           TO F120-NUM-NRIC                    
                 MOVE  F400-NUM-SCH-ACC     TO F120-NUM-SCH-ACCT                
                 MOVE  WS-DATE              TO F120-DTE-POST                    
                 MOVE  WS-DATE              TO F120-DTE-TRANS                   
                 MOVE '23'                  TO F120-CDE-TRANS-TYPE              
                 MOVE 'CST'                 TO F120-CDE-PAYMENT-TYPE            
                 IF F400-AMT-CONVEY = F400-AMT-CONV-CASH                        
                    MOVE F400-AMT-CONVEY-GST TO F120-AMT-RECEIPT                
                 ELSE                                                           
                    MOVE WS-TEMP-CONVEY-FEE-GST TO F120-AMT-RECEIPT             
                 END-IF                                                         
                 MOVE 'C'                   TO F120-CDE-CRDR                    
                 MOVE ZEROES                TO F120-COUNT-HISTORY               
                 MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA            
                 IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                           
                    MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE          
                 END-IF                                                         
                 IF K800-NUM-LEASE-BUY-BACK = 'Y'                               
                    MOVE 'L'                TO F120-CDE-VALID                   
                 END-IF                                                         
                 IF K800-NUM-REGN = '1557169A'  OR '1555490H'                   
                    MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE          
                    MOVE 'L'                TO F120-CDE-VALID                   
                 END-IF                                                         
                 WRITE BP13F120-CASHTRAN                                        
                 ADD 1 TO        WS-WRITE-CNT                                   
      *       IF F400-AMT-CONVEY-GST NOT = 0                                    
      *          MOVE  SPACES               TO BP13F120-CASHTRAN                
      *          MOVE  F400-NUM-REGN        TO F120-NUM-REGN                    
      *          MOVE  F400-NRIC1           TO F120-NUM-NRIC                    
      *          MOVE  F400-NUM-SCH-ACC     TO F120-NUM-SCH-ACCT                
      *          MOVE  WS-DATE              TO F120-DTE-POST                    
      *          MOVE  WS-DATE              TO F120-DTE-TRANS                   
      *          MOVE '23'                  TO F120-CDE-TRANS-TYPE              
      *          MOVE 'CST'                 TO F120-CDE-PAYMENT-TYPE            
      *          MOVE F400-AMT-CONVEY-GST   TO F120-AMT-RECEIPT                 
      *          MOVE 'C'                   TO F120-CDE-CRDR                    
      *          MOVE ZEROES                TO F120-COUNT-HISTORY               
      *          MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA            
      *          WRITE BP13F120-CASHTRAN                                        
      *          ADD 1 TO        WS-WRITE-CNT                                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *=========================                                                
      *  CREDIT CONTRA STAMP FEE                                                
      *  CR8321 MGL POLICY , SHARE THE SER CONTRA FIELDS                        
      *  FOR CONVEY FEE, LEASE STAMP FEES                                       
      *=========================                                                
           IF F400-AMT-SER-CONTRA-STAMP-FEES NOT NUMERIC                        
              MOVE  ZERO              TO F400-AMT-SER-CONTRA-STAMP-FEES         
           END-IF.                                                              
                                                                                
           IF F400-AMT-SER-CONTRA-STAMP-FEES NOT = ZEROES                       
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE  F400-AMT-SER-CONTRA-STAMP-FEES TO F120-AMT-RECEIPT          
              MOVE  'C'                  TO F120-CDE-CRDR                       
              MOVE  F400-NUM-REGN        TO F120-NUM-REGN                       
              MOVE  F400-NRIC1           TO F120-NUM-NRIC                       
              MOVE  F400-NUM-SCH-ACC     TO F120-NUM-SCH-ACCT                   
              MOVE  WS-DATE              TO F120-DTE-POST                       
              MOVE  WS-DATE              TO F120-DTE-TRANS                      
              MOVE  '23'                 TO F120-CDE-TRANS-TYPE                 
              MOVE  'LSE'                TO F120-CDE-PAYMENT-TYPE               
              MOVE ZEROES                TO F120-COUNT-HISTORY                  
              MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                              
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
              END-IF                                                            
              IF K800-NUM-LEASE-BUY-BACK = 'Y'                                  
                 MOVE 'L'                TO F120-CDE-VALID                      
              END-IF                                                            
              IF K800-NUM-REGN = '1557169A' OR '1555490H'                       
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
                MOVE 'L'                TO F120-CDE-VALID                       
              END-IF                                                            
              WRITE BP13F120-CASHTRAN                                           
              ADD 1 TO        WS-WRITE-CNT.                                     
                                                                                
      *=========================                                                
      *  CREDIT CONTRA CONVY FEE                                                
      *=========================                                                
           IF F400-AMT-SER-CONTRA-CONVY-FEES NOT NUMERIC                        
              MOVE  ZERO    TO  F400-AMT-SER-CONTRA-CONVY-FEES.                 
                                                                                
           COMPUTE WS-CONTRA-CONVY-FEES =                                       
                   F400-AMT-SER-CONTRA-CONVY-FEES -                             
                   F400-AMT-CONVEY-GST.                                         
                                                                                
           IF F400-AMT-SER-CONTRA-CONVY-FEES NOT = ZEROS                        
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE  F400-NUM-REGN        TO F120-NUM-REGN                       
              MOVE  F400-NRIC1           TO F120-NUM-NRIC                       
              MOVE  F400-NUM-SCH-ACC     TO F120-NUM-SCH-ACCT                   
              MOVE  WS-DATE              TO F120-DTE-POST                       
              MOVE  WS-DATE              TO F120-DTE-TRANS                      
              MOVE '23'                  TO F120-CDE-TRANS-TYPE                 
              MOVE 'CON'                 TO F120-CDE-PAYMENT-TYPE               
              MOVE WS-CONTRA-CONVY-FEES  TO F120-AMT-RECEIPT                    
              MOVE 'C'                   TO F120-CDE-CRDR                       
              MOVE ZEROES                TO F120-COUNT-HISTORY                  
              MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                              
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
              END-IF                                                            
              IF K800-NUM-LEASE-BUY-BACK = 'Y'                                  
                 MOVE 'L'                TO F120-CDE-VALID                      
              END-IF                                                            
              WRITE BP13F120-CASHTRAN                                           
              ADD 1 TO        WS-WRITE-CNT                                      
                                                                                
              IF F400-AMT-CONVEY-GST NOT = 0                                    
                 MOVE  SPACES               TO BP13F120-CASHTRAN                
                 MOVE  F400-NUM-REGN        TO F120-NUM-REGN                    
                 MOVE  F400-NRIC1           TO F120-NUM-NRIC                    
                 MOVE  F400-NUM-SCH-ACC     TO F120-NUM-SCH-ACCT                
                 MOVE  WS-DATE              TO F120-DTE-POST                    
                 MOVE  WS-DATE              TO F120-DTE-TRANS                   
                 MOVE '23'                  TO F120-CDE-TRANS-TYPE              
                 MOVE 'CST'                 TO F120-CDE-PAYMENT-TYPE            
                 MOVE F400-AMT-CONVEY-GST   TO F120-AMT-RECEIPT                 
                 MOVE 'C'                   TO F120-CDE-CRDR                    
                 MOVE ZEROES                TO F120-COUNT-HISTORY               
                 MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA            
                 IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                           
                   MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE           
                 END-IF                                                         
                 IF K800-NUM-LEASE-BUY-BACK = 'Y'                               
                    MOVE 'L'                TO F120-CDE-VALID                   
                 END-IF                                                         
                 IF K800-NUM-REGN = '1557169A' OR '1555490H'                    
                    MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE          
                    MOVE 'L'                TO F120-CDE-VALID                   
                 END-IF                                                         
                 WRITE BP13F120-CASHTRAN                                        
                 ADD 1 TO        WS-WRITE-CNT                                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
       131-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *------------------------*                                                
       133-PROCESS-BK-TRANSFER.                                                 
      *------------------------*                                                
      * FOR SA/TP                                                               
           DISPLAY '133-PROCESS-BK'.                                            
           DISPLAY 'AMT-BK-TRANS  ' F400-AMT-BK-TRANSFER.                       
                                                                                
           IF F400-AMT-BK-TRANSFER NOT NUMERIC                                  
              MOVE   ZERO                TO F400-AMT-BK-TRANSFER                
           END-IF.                                                              
                                                                                
           IF F400-AMT-BK-TRANSFER NOT = 0                                      
              MOVE  SPACES               TO BP13F120-CASHTRAN                   
              MOVE  '19'                 TO F120-CDE-TRANS-TYPE                 
              MOVE  'BK'                 TO F120-CDE-PAYMENT-TYPE               
              COMPUTE  WS-BK-TRANSFER    =   F400-AMT-BK-TRANSFER * -1          
              MOVE  WS-BK-TRANSFER       TO F120-AMT-RECEIPT                    
              MOVE  'D'                  TO F120-CDE-CRDR                       
              MOVE  F400-NUM-REGN        TO F120-NUM-REGN                       
              MOVE  F400-NUM-SCH-ACC     TO F120-NUM-SCH-ACCT                   
              MOVE  WS-DATE              TO F120-DTE-POST                       
              MOVE  WS-DATE              TO F120-DTE-TRANS                      
              MOVE ZEROES                TO F120-COUNT-HISTORY                  
              MOVE F400-NRIC1            TO F120-NUM-NRIC                       
              MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                              
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
              END-IF                                                            
              IF K800-NUM-LEASE-BUY-BACK = 'Y'                                  
                 MOVE 'L'                TO F120-CDE-VALID                      
              END-IF                                                            
              IF K800-NUM-REGN = '1557169A' OR '1555490H'                       
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
                MOVE 'L'                TO F120-CDE-VALID                       
              END-IF                                                            
              WRITE BP13F120-CASHTRAN                                           
              ADD   1                    TO WS-WRITE-CNT                        
           END-IF.                                                              
                                                                                
      *  AS THE FLAT IS PAID IN FULL, THERE IS NO NEED TO CREDIT                
      *  THE BOOKING FEE TRANSFER TO 'CD' ACCT, UNLIKE FOR NORMAL               
      *  SA/TP CASE, 'CD' IS PASSED TO SMS.                                     
                                                                                
      *    IF F400-AMT-BK-TRANSFER NOT = 0                                      
      *       MOVE  SPACES             TO BP13F120-CASHTRAN                     
      *       MOVE F400-NUM-REGN       TO F120-NUM-REGN                         
      *       MOVE F400-NUM-SCH-ACC    TO F120-NUM-SCH-ACCT                     
      *       MOVE  WS-DATE            TO F120-DTE-POST                         
      *       MOVE  WS-DATE            TO F120-DTE-TRANS                        
      *       MOVE '21'                TO F120-CDE-TRANS-TYPE                   
      *       MOVE 'CD'                TO F120-CDE-PAYMENT-TYPE                 
      *       MOVE F400-AMT-BK-TRANSFER TO F120-AMT-RECEIPT                     
      *       MOVE 'C'                 TO F120-CDE-CRDR                         
      *       MOVE ZEROES              TO F120-COUNT-HISTORY                    
      *       MOVE F400-NRIC1          TO F120-NUM-NRIC                         
      *       MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
      *       WRITE BP13F120-CASHTRAN                                           
      *       ADD   1                    TO WS-WRITE-CNT                        
      *    END-IF.                                                              
                                                                                
       133-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *========================*                                                
       135-GET-AREA-DESCR.                                                      
      *========================*                                                
           MOVE SPACES       TO BP13COMM4-REC.                                  
           INITIALIZE           BP13COMM4-REC.                                  
                                                                                
           MOVE F400-CDE-BO  TO WS-LINK-NUM-OFFICE.                             
           MOVE 'BO'         TO WS-LINK-NUM-TYPE-OFFICE.                        
           MOVE '00'         TO WS-LINK-NUM-SQNC.                               
                                                                                
           CALL WS-BP13C902 USING                                               
                 WS-LINK-REC, BP13COMM4-REC                                     
           END-CALL.                                                            
                                                                                
           IF COMM4-CDE-SYSERR NOT = 0                                          
              MOVE COMM4-CDE-SYSERR TO WS-SQL-CODE                              
              MOVE SPACES           TO WS-NUM-BO                                
              IF COMM4-CDE-SYSERR = 100                                         
                 DISPLAY 'OFFICE NOT FND = ' WS-LINK-REC                        
                 DISPLAY 'SQL ERROR CODE = ' WS-SQL-CODE                        
              ELSE                                                              
                 DISPLAY 'ERROR IN READING OFFICE TABLE' WS-SQL-CODE            
              END-IF                                                            
           ELSE                                                                 
              MOVE COMM4-NUM-OFFICE-GL-BO(1)    TO WS-NUM-BO                    
           END-IF.                                                              
                                                                                
       135-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *========================*                                                
       140-GET-RESALE-FT.                                                       
      *========================*                                                
           MOVE 'N'                  TO WS-K350-FOUND.                          
           MOVE F400-NUM-REGN        TO K350-NUM-REGN.                          
                                                                                
           READ BP13K350.                                                       
                                                                                
           IF K350-STATUS = ZEROES                                              
              MOVE 'Y'               TO WS-K350-FOUND                           
           ELSE                                                                 
              IF K350-STATUS = 23                                               
                 DISPLAY 'REC NOT FOUND IN BP13K350 - '   F400-NUM-REGN         
              ELSE                                                              
                 DISPLAY 'ERROR READING BP13K350, STATUS : ' K350-STATUS        
                 PERFORM 040-END-PROCESS    THRU 040-EXIT                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       140-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *========================*                                                
       150-ADV-COLLN-TP.                                                        
      *========================*                                                
           IF F400-AMT-REFUND-CD  NOT NUMERIC                                   
              MOVE  ZERO                 TO F400-AMT-REFUND-CD                  
           END-IF.                                                              
                                                                                
           IF F400-AMT-REFUND-BK  NOT NUMERIC                                   
              MOVE  ZERO                 TO F400-AMT-REFUND-BK                  
           END-IF.                                                              
                                                                                
           IF F400-AMT-REFUND-ADV-COL  NOT NUMERIC                              
              MOVE  ZERO                 TO F400-AMT-REFUND-ADV-COL             
           END-IF.                                                              
                                                                                
           MOVE 'N'                TO WS-REFUND-SWITCH.                         
           IF ((F400-AMT-REFUND-CD      NOT = 0) OR                             
               (F400-AMT-REFUND-BK      NOT = 0) OR                             
               (F400-AMT-REFUND-ADV-COL NOT = 0))                               
               AND (F400-CDE-ALLOC-RENTAL-FLAT  = 'Y')                          
                    COMPUTE WS-REFUND-AMT = F400-AMT-REFUND-CD  +               
                                            F400-AMT-REFUND-BK  +               
                                            F400-AMT-REFUND-ADV-COL             
                    MOVE 'Y'             TO WS-REFUND-SWITCH                    
           END-IF.                                                              
                                                                                
           IF F400-CDE-ALLOC-RENTAL-FLAT = 'Y'                                  
                                                                                
              IF F400-AMT-SELLING-PRICE NOT NUMERIC                             
                 MOVE  ZERO       TO F400-AMT-SELLING-PRICE                     
              END-IF                                                            
                                                                                
              IF F400-AMT-SELLING-PRICE NOT = 0                                 
                 MOVE SPACES             TO BP13F120-CASHTRAN                   
                 IF WS-REFUND-SWITCH = 'Y'                                      
                   COMPUTE F120-AMT-RECEIPT = (F400-AMT-SELLING-PRICE *         
                                               0.95  - WS-REFUND-AMT) *         
                                               -1                               
                 ELSE                                                           
                   COMPUTE F120-AMT-RECEIPT = (F400-AMT-SELLING-PRICE *         
                                               0.95  *  -1)                     
                 END-IF                                                         
                 MOVE 'D'                TO F120-CDE-CRDR                       
                 MOVE F400-NUM-REGN      TO F120-NUM-REGN                       
                 MOVE F400-NRIC1         TO F120-NUM-NRIC                       
                 MOVE F400-NUM-SCH-ACC   TO F120-NUM-SCH-ACCT                   
                 MOVE WS-DATE            TO F120-DTE-POST                       
                 MOVE WS-DATE            TO F120-DTE-TRANS                      
                 MOVE '23'               TO F120-CDE-TRANS-TYPE                 
                 MOVE 'ADV'              TO F120-CDE-PAYMENT-TYPE               
                 MOVE ZEROES             TO F120-COUNT-HISTORY                  
                 MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA            
                 IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                           
                   MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE           
                 END-IF                                                         
                 IF K800-NUM-LEASE-BUY-BACK = 'Y'                               
                    MOVE 'L'                TO F120-CDE-VALID                   
                 END-IF                                                         
                 WRITE BP13F120-CASHTRAN                                        
                 ADD 1                   TO WS-WRITE-CNT                        
              END-IF                                                            
           END-IF.                                                              
                                                                                
       150-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *========================*                                                
       155-ADV-COLLN-SATP.                                                      
      *========================*                                                
           IF F400-AMT-REFUND-CD  NOT NUMERIC                                   
              MOVE  ZERO TO  F400-AMT-REFUND-CD                                 
           END-IF.                                                              
                                                                                
           IF F400-AMT-REFUND-BK  NOT NUMERIC                                   
              MOVE  ZERO TO  F400-AMT-REFUND-BK                                 
           END-IF.                                                              
                                                                                
           IF F400-AMT-REFUND-ADV-COL  NOT NUMERIC                              
              MOVE  ZERO TO  F400-AMT-REFUND-ADV-COL                            
           END-IF.                                                              
                                                                                
           MOVE 'N'                TO WS-REFUND-SWITCH.                         
           IF (F400-AMT-REFUND-CD      NOT = 0    OR                            
               F400-AMT-REFUND-BK      NOT = 0    OR                            
               F400-AMT-REFUND-ADV-COL NOT = 0)                                 
                COMPUTE WS-REFUND-AMT =  F400-AMT-REFUND-CD  +                  
                                         F400-AMT-REFUND-BK  +                  
                                         F400-AMT-REFUND-ADV-COL                
                MOVE 'Y'           TO WS-REFUND-SWITCH                          
           END-IF.                                                              
                                                                                
           IF F400-AMT-SELLING-PRICE NOT NUMERIC                                
              MOVE     ZERO       TO F400-AMT-SELLING-PRICE                     
           END-IF.                                                              
                                                                                
           IF F400-AMT-ADV-COLLECTION NOT NUMERIC                               
              MOVE     ZERO       TO F400-AMT-ADV-COLLECTION                    
           END-IF.                                                              
                                                                                
           IF F400-AMT-ADV-COLLECTION-TOPUP NOT NUMERIC                         
              MOVE     ZERO       TO F400-AMT-ADV-COLLECTION-TOPUP              
           END-IF.                                                              
                                                                                
           COMPUTE WS-ADV-COL = F400-AMT-ADV-COLLECTION-TOPUP +                 
                                F400-AMT-ADV-COLLECTION.                        
                                                                                
      * ONLY CREATE 'ADV' IF PART OF ADV COLLN IS USED FOR PAYMENT OF SP        
           DISPLAY 'WS-ADV-COL = ' WS-ADV-COL                                   
           DISPLAY 'WS-REFUND-AMT = ' WS-REFUND-AMT                             
                                                                                
           IF F400-AMT-SELLING-PRICE NOT = 0 AND WS-ADV-COL > ZEROES            
              MOVE SPACES  TO  BP13F120-CASHTRAN                                
              IF WS-REFUND-SWITCH = 'Y'                                         
                 COMPUTE F120-AMT-RECEIPT = (WS-ADV-COL -                       
                                             WS-REFUND-AMT) * -1                
                 IF F120-AMT-RECEIPT > 0                                        
                    GO TO 155-EXIT                                              
                 END-IF                                                         
              ELSE                                                              
                 COMPUTE F120-AMT-RECEIPT =     WS-ADV-COL * -1                 
              END-IF                                                            
              MOVE 'D'                   TO F120-CDE-CRDR                       
              MOVE F400-NUM-REGN         TO F120-NUM-REGN                       
              MOVE F400-NRIC1            TO F120-NUM-NRIC                       
              MOVE F400-NUM-SCH-ACC      TO F120-NUM-SCH-ACCT                   
              MOVE WS-DATE               TO F120-DTE-POST                       
              MOVE WS-DATE               TO F120-DTE-TRANS                      
              MOVE '23'                  TO F120-CDE-TRANS-TYPE                 
              MOVE 'ADV'                 TO F120-CDE-PAYMENT-TYPE               
              MOVE ZEROES                TO F120-COUNT-HISTORY                  
              MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA               
              IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                              
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
              END-IF                                                            
              IF K800-NUM-LEASE-BUY-BACK = 'Y'                                  
                 MOVE 'L'                TO F120-CDE-VALID                      
              END-IF                                                            
              IF K800-NUM-REGN = '1557169A' OR '1555490H'                       
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
                MOVE 'L'                TO F120-CDE-VALID                       
              END-IF                                                            
              WRITE BP13F120-CASHTRAN                                           
              ADD 1                      TO WS-WRITE-CNT                        
           END-IF.                                                              
                                                                                
       155-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *------------------------*                                                
       175-PROCESS-SOC-CASH.                                                    
      *------------------------*                                                
           DISPLAY '175-PROCESS-SOC-CASH'.                                      
           DISPLAY 'K800-AMT-SOC-CASH = ' K800-AMT-SOC-CASH.                    
                                                                                
           IF (K800-NUM-HALF-IDP = 'D'  OR 'F')                                 
           COMPUTE WS-AMT-SOC-PAID = K800-AMT-SOC-CASH +                        
                                     K800-AMT-CPF1-PAID +                       
                                     K800-AMT-CPF2-PAID +                       
                                     K800-AMT-CPF3-PAID +                       
                                     K800-AMT-CPF4-PAID                         
           ELSE                                                                 
           COMPUTE WS-AMT-SOC-PAID = K800-AMT-SOC-CASH.                         
                                                                                
           IF WS-AMT-SOC-PAID NOT = ZEROES                                      
              PERFORM 305-PROCESS-SOC-PAID THRU 305-EXIT                        
           END-IF.                                                              
                                                                                
           COMPUTE K800-AMT-CD        = ZEROES.                                 
           COMPUTE K800-AMT-SOC-CASH  = ZEROES.                                 
           COMPUTE K800-AMT-CPF1-PAID = ZEROES.                                 
           COMPUTE K800-AMT-CPF2-PAID = ZEROES.                                 
           COMPUTE K800-AMT-CPF3-PAID = ZEROES.                                 
           COMPUTE K800-AMT-CPF4-PAID = ZEROES.                                 
                                                                                
           PERFORM 400-REWRITE-BP13K800 THRU 400-EXIT.                          
                                                                                
       175-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *------------------------*                                                
       200-PROCESS-CD-AMT.                                                      
      *------------------------*                                                
           IF K800-AMT-CD = ZEROES                                              
              NEXT SENTENCE                                                     
           ELSE                                                                 
              PERFORM 300-UPDATE-BP13F120 THRU 300-EXIT                         
           END-IF.                                                              
                                                                                
           COMPUTE WS-AMT-SOC-PAID = K800-AMT-SOC-CASH  +                       
                                     K800-AMT-CPF1-PAID +                       
                                     K800-AMT-CPF2-PAID +                       
                                     K800-AMT-CPF3-PAID +                       
                                     K800-AMT-CPF4-PAID.                        
                                                                                
           IF WS-AMT-SOC-PAID NOT = ZEROES                                      
              PERFORM 305-PROCESS-SOC-PAID THRU 305-EXIT                        
           END-IF.                                                              
                                                                                
           COMPUTE K800-AMT-CD        = ZEROES.                                 
           COMPUTE K800-AMT-SOC-CASH  = ZEROES.                                 
           COMPUTE K800-AMT-CPF1-PAID = ZEROES.                                 
           COMPUTE K800-AMT-CPF2-PAID = ZEROES.                                 
           COMPUTE K800-AMT-CPF3-PAID = ZEROES.                                 
           COMPUTE K800-AMT-CPF4-PAID = ZEROES.                                 
                                                                                
           PERFORM 400-REWRITE-BP13K800 THRU 400-EXIT.                          
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *------------------------*                                                
       300-UPDATE-BP13F120.                                                     
      *------------------------*                                                
           MOVE SPACES                TO BP13F120-CASHTRAN.                     
           MOVE '29'                  TO F120-CDE-TRANS-TYPE.                   
           MOVE K800-NUM-REGN         TO F120-NUM-REGN.                         
           MOVE K800-NUM-NRIC1        TO F120-NUM-NRIC.                         
           MOVE WS-DATE               TO F120-DTE-POST.                         
           MOVE ZEROES                TO F120-COUNT-HISTORY                     
           MOVE SPACES                TO F120-NUM-CPF-APPL.                     
      *    MOVE SPACES                TO F120-NME-NAME.                         
           MOVE 'CD '                 TO F120-CDE-PAYMENT-TYPE.                 
           MOVE WS-DD                 TO WS-RECEIPT-DD.                         
           MOVE WS-MM                 TO WS-RECEIPT-MM.                         
           MOVE WS-YY                 TO WS-RECEIPT-YY.                         
           MOVE 'JR'                  TO WS-RECEIPT-CD.                         
           MOVE '/'                   TO WS-SLASH.                              
           MOVE WS-NUM-RECEIPT-JRNO   TO F120-NUM-RECPT-JRNO.                   
           COMPUTE F120-AMT-RECEIPT = K800-AMT-CD * -1                          
           MOVE 'D'                   TO F120-CDE-CRDR.                         
           MOVE WS-DATE               TO F120-DTE-TRANS.                        
           MOVE F400-NUM-SCH-ACC      TO F120-NUM-SCH-ACCT.                     
           MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA                  
           IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                                 
              MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE                
           END-IF.                                                              
           IF K800-NUM-LEASE-BUY-BACK = 'Y'                                     
              MOVE 'L'                TO F120-CDE-VALID                         
           END-IF.                                                              
              IF K800-NUM-REGN = '1557169A' OR '1555490H'                       
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
                MOVE 'L'                TO F120-CDE-VALID                       
              END-IF.                                                           
                                                                                
           WRITE BP13F120-CASHTRAN.                                             
           ADD  1                        TO WS-WRITE-CNT.                       
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *------------------------*                                                
       305-PROCESS-SOC-PAID.                                                    
      *------------------------*                                                
           MOVE SPACES                TO BP13F120-CASHTRAN.                     
           MOVE '20'                  TO F120-CDE-TRANS-TYPE.                   
           MOVE K800-NUM-REGN         TO F120-NUM-REGN.                         
           MOVE K800-NUM-NRIC1        TO F120-NUM-NRIC.                         
           MOVE WS-DATE               TO F120-DTE-POST.                         
           MOVE ZEROES                TO F120-COUNT-HISTORY                     
           MOVE SPACES                TO F120-NUM-CPF-APPL.                     
      *    MOVE SPACES                TO F120-NME-NAME.                         
           MOVE 'SOC'                 TO F120-CDE-PAYMENT-TYPE.                 
           MOVE WS-DD                 TO WS-RECEIPT-DD.                         
           MOVE WS-MM                 TO WS-RECEIPT-MM.                         
           MOVE WS-YY                 TO WS-RECEIPT-YY.                         
           MOVE 'JR'                  TO WS-RECEIPT-CD.                         
           MOVE '/'                   TO WS-SLASH.                              
           MOVE WS-NUM-RECEIPT-JRNO   TO F120-NUM-RECPT-JRNO.                   
           COMPUTE F120-AMT-RECEIPT = WS-AMT-SOC-PAID * -1                      
           MOVE 'D'                   TO F120-CDE-CRDR.                         
           MOVE WS-DATE               TO F120-DTE-TRANS.                        
           MOVE F400-NUM-SCH-ACC      TO F120-NUM-SCH-ACCT.                     
           MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA                  
           IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                                 
              MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE                
           END-IF.                                                              
           IF K800-NUM-LEASE-BUY-BACK = 'Y'                                     
              MOVE 'L'                TO F120-CDE-VALID                         
           END-IF.                                                              
              IF K800-NUM-REGN = '1557169A'  OR '1555490H'                      
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
                MOVE 'L'                TO F120-CDE-VALID                       
              END-IF.                                                           
                                                                                
           WRITE BP13F120-CASHTRAN.                                             
           ADD  1                     TO WS-WRITE-CNT.                          
                                                                                
       305-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *------------------------*                                                
       310-UPDATE-BP13F120.                                                     
      *------------------------*                                                
      * <<< CREATE F120 REC FOR CREDIT DEF. INC. TO SA >>>                      
           MOVE SPACES                TO BP13F120-CASHTRAN.                     
           MOVE '29'                  TO F120-CDE-TRANS-TYPE.                   
           MOVE K800-NUM-REGN         TO F120-NUM-REGN.                         
           MOVE K800-NUM-NRIC1        TO F120-NUM-NRIC.                         
           MOVE WS-DATE               TO F120-DTE-POST.                         
           MOVE ZEROES                TO F120-COUNT-HISTORY                     
           MOVE SPACES                TO F120-NUM-CPF-APPL.                     
      *    MOVE SPACES                TO F120-NME-NAME.                         
                                                                                
           IF K800-NUM-FLAT-TYPE = '1A' OR '2A'                                 
              MOVE 'SA '              TO F120-CDE-PAYMENT-TYPE                  
              MOVE 'S'                TO F120-CDE-VALID                         
              IF K800-NUM-LEASE-TENURE = SPACES                                 
                MOVE '30'                  TO F120-NUM-PP-SCHEDULE              
              ELSE                                                              
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
              END-IF                                                            
           ELSE                                                                 
             IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                               
                MOVE 'VRL'                 TO F120-CDE-PAYMENT-TYPE             
                MOVE 'F'                   TO F120-CDE-VALID                    
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
             ELSE                                                               
                IF K800-NUM-LEASE-BUY-BACK = 'Y'                                
                   MOVE 'VRL'              TO F120-CDE-PAYMENT-TYPE             
                   MOVE 'L'                TO F120-CDE-VALID                    
                   MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE           
                END-IF                                                          
             END-IF                                                             
           END-IF.                                                              
           IF K800-NUM-REGN = '1557169A'  OR '1555490H'                         
              MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE                
              MOVE 'L'                TO F120-CDE-VALID                         
           END-IF.                                                              
                                                                                
           MOVE WS-DD                 TO WS-RECEIPT-DD.                         
           MOVE WS-MM                 TO WS-RECEIPT-MM.                         
           MOVE WS-YY                 TO WS-RECEIPT-YY.                         
           MOVE 'JR'                  TO WS-RECEIPT-CD.                         
           MOVE '/'                   TO WS-SLASH.                              
           MOVE WS-NUM-RECEIPT-JRNO   TO F120-NUM-RECPT-JRNO.                   
                                                                                
           IF F400-AMT-SELLING-PRICE NOT NUMERIC                                
              MOVE ZEROES             TO F400-AMT-SELLING-PRICE                 
           END-IF.                                                              
                                                                                
           COMPUTE F120-AMT-RECEIPT = F400-AMT-SELLING-PRICE.                   
                                                                                
           MOVE 'D'                   TO F120-CDE-CRDR.                         
           MOVE WS-DATE               TO F120-DTE-TRANS.                        
           MOVE F400-NUM-SCH-ACC      TO F120-NUM-SCH-ACCT.                     
           MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA                  
                                                                                
           WRITE BP13F120-CASHTRAN.                                             
           ADD  1                     TO WS-WRITE-CNT.                          
                                                                                
           MOVE SPACES                TO BP13F120-CASHTRAN.                     
           MOVE '22'                  TO F120-CDE-TRANS-TYPE.                   
           MOVE K800-NUM-REGN         TO F120-NUM-REGN.                         
           MOVE K800-NUM-NRIC1        TO F120-NUM-NRIC.                         
           MOVE WS-DATE               TO F120-DTE-POST.                         
           MOVE ZEROES                TO F120-COUNT-HISTORY                     
           MOVE SPACES                TO F120-NUM-CPF-APPL.                     
      *    MOVE SPACES                TO F120-NME-NAME.                         
           MOVE 'SOC'                 TO F120-CDE-PAYMENT-TYPE.                 
           MOVE WS-DD                 TO WS-RECEIPT-DD.                         
           MOVE WS-MM                 TO WS-RECEIPT-MM.                         
           MOVE WS-YY                 TO WS-RECEIPT-YY.                         
           MOVE 'JR'                  TO WS-RECEIPT-CD.                         
           MOVE '/'                   TO WS-SLASH.                              
           MOVE WS-NUM-RECEIPT-JRNO   TO F120-NUM-RECPT-JRNO.                   
           COMPUTE F120-AMT-RECEIPT =    WS-AMT-ICP-TOTAL.                      
           MOVE 'D'                   TO F120-CDE-CRDR.                         
           MOVE WS-DATE               TO F120-DTE-TRANS.                        
           MOVE F400-NUM-SCH-ACC      TO F120-NUM-SCH-ACCT.                     
           MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA                  
           IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                                 
              MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE                
           END-IF.                                                              
           IF K800-NUM-LEASE-BUY-BACK = 'Y'                                     
              MOVE 'L'                TO F120-CDE-VALID                         
           END-IF.                                                              
           IF K800-NUM-REGN = '1557169A'  OR '1555490H'                         
              MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE                
              MOVE 'L'                TO F120-CDE-VALID                         
           END-IF.                                                              
           WRITE BP13F120-CASHTRAN.                                             
           ADD  1                     TO WS-WRITE-CNT.                          
                                                                                
       310-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ***CREATE A RECORD FOR 'TMP'                                              
      * <<< CREATE F120 REC FOR CREDIT DEF. INC. TO SA >>>                      
       320-TEMP-LOAN.                                                           
                                                                                
           MOVE SPACES                TO BP13F120-CASHTRAN.                     
           MOVE '29'                  TO F120-CDE-TRANS-TYPE.                   
           MOVE K800-NUM-REGN         TO F120-NUM-REGN.                         
           MOVE K800-NUM-NRIC1        TO F120-NUM-NRIC.                         
           MOVE WS-DATE               TO F120-DTE-POST.                         
           MOVE ZEROES                TO F120-COUNT-HISTORY                     
           MOVE SPACES                TO F120-NUM-CPF-APPL.                     
           MOVE 'TMP LN'              TO BP13F120-CASHTRAN(144:6).              
                                                                                
           IF K800-NUM-FLAT-TYPE = '1A' OR '2A'                                 
              MOVE 'SA '              TO F120-CDE-PAYMENT-TYPE                  
              MOVE 'S'                TO F120-CDE-VALID                         
              IF K800-NUM-LEASE-TENURE = SPACES                                 
                MOVE '30'                  TO F120-NUM-PP-SCHEDULE              
              ELSE                                                              
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
              END-IF                                                            
           ELSE                                                                 
             IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                               
                MOVE 'VRL'                 TO F120-CDE-PAYMENT-TYPE             
                MOVE 'F'                   TO F120-CDE-VALID                    
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
             ELSE                                                               
                IF K800-NUM-LEASE-BUY-BACK = 'Y'                                
                   MOVE 'VRL'              TO F120-CDE-PAYMENT-TYPE             
                   MOVE 'L'                TO F120-CDE-VALID                    
                   MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE           
                END-IF                                                          
             END-IF                                                             
           END-IF.                                                              
           IF K800-NUM-REGN = '1557169A'  OR '1555490H'                         
             MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE                 
             MOVE 'L'                TO F120-CDE-VALID                          
           END-IF.                                                              
                                                                                
           MOVE WS-DD                 TO WS-RECEIPT-DD.                         
           MOVE WS-MM                 TO WS-RECEIPT-MM.                         
           MOVE WS-YY                 TO WS-RECEIPT-YY.                         
           MOVE 'JR'                  TO WS-RECEIPT-CD.                         
           MOVE '/'                   TO WS-SLASH.                              
           MOVE WS-NUM-RECEIPT-JRNO   TO F120-NUM-RECPT-JRNO.                   
                                                                                
           IF F400-AMT-SELLING-PRICE NOT NUMERIC                                
              MOVE ZEROES             TO F400-AMT-SELLING-PRICE                 
           END-IF.                                                              
                                                                                
           COMPUTE F120-AMT-RECEIPT = F400-AMT-SELLING-PRICE.                   
                                                                                
           MOVE 'D'                   TO F120-CDE-CRDR.                         
           MOVE WS-DATE               TO F120-DTE-TRANS.                        
           MOVE F400-NUM-SCH-ACC      TO F120-NUM-SCH-ACCT.                     
           MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA                  
                                                                                
           WRITE BP13F120-CASHTRAN.                                             
           ADD  1                     TO WS-WRITE-CNT.                          
                                                                                
           MOVE SPACES                TO BP13F120-CASHTRAN.                     
           MOVE '22'                  TO F120-CDE-TRANS-TYPE.                   
           MOVE K800-NUM-REGN         TO F120-NUM-REGN.                         
           MOVE K800-NUM-NRIC1        TO F120-NUM-NRIC.                         
           MOVE WS-DATE               TO F120-DTE-POST.                         
           MOVE ZEROES                TO F120-COUNT-HISTORY                     
           MOVE SPACES                TO F120-NUM-CPF-APPL.                     
           MOVE 'TMP LN'              TO BP13F120-CASHTRAN(144:6).              
           MOVE 'TMP'                 TO F120-CDE-PAYMENT-TYPE.                 
           MOVE WS-DD                 TO WS-RECEIPT-DD.                         
           MOVE WS-MM                 TO WS-RECEIPT-MM.                         
           MOVE WS-YY                 TO WS-RECEIPT-YY.                         
           MOVE 'JR'                  TO WS-RECEIPT-CD.                         
           MOVE '/'                   TO WS-SLASH.                              
           MOVE WS-NUM-RECEIPT-JRNO   TO F120-NUM-RECPT-JRNO.                   
           COMPUTE F120-AMT-RECEIPT =  0 - F400-AMT-SELLING-PRICE.              
           MOVE 'D'                   TO F120-CDE-CRDR.                         
           MOVE WS-DATE               TO F120-DTE-TRANS.                        
           MOVE F400-NUM-SCH-ACC      TO F120-NUM-SCH-ACCT.                     
           MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA                  
           IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                                 
              MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE                
           END-IF.                                                              
           IF K800-NUM-LEASE-BUY-BACK = 'Y'                                     
              MOVE 'L'                TO F120-CDE-VALID                         
           END-IF.                                                              
           WRITE BP13F120-CASHTRAN.                                             
           ADD  1                     TO WS-WRITE-CNT.                          
                                                                                
       320-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *------------------------*                                                
       330-FSH-F120.                                                            
      *------------------------*                                                
      * <<< CREATE F120 REC FOR CREDIT DEF. INC. TO SA >>>                      
           MOVE SPACES                TO BP13F120-CASHTRAN.                     
           MOVE '29'                  TO F120-CDE-TRANS-TYPE.                   
           MOVE K800-NUM-REGN         TO F120-NUM-REGN.                         
           MOVE K800-NUM-NRIC1        TO F120-NUM-NRIC.                         
           MOVE WS-DATE               TO F120-DTE-POST.                         
           MOVE ZEROES                TO F120-COUNT-HISTORY                     
           MOVE SPACES                TO F120-NUM-CPF-APPL.                     
                                                                                
           IF K800-NUM-ALLO-SCHEME = 'FSH'                                      
              MOVE 'VRL'                 TO F120-CDE-PAYMENT-TYPE               
              MOVE 'MLF LN'              TO BP13F120-CASHTRAN(144:6)            
              MOVE 'H'                   TO F120-CDE-VALID                      
              MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE                
           END-IF.                                                              
                                                                                
           MOVE WS-DD                 TO WS-RECEIPT-DD.                         
           MOVE WS-MM                 TO WS-RECEIPT-MM.                         
           MOVE WS-YY                 TO WS-RECEIPT-YY.                         
           MOVE 'JR'                  TO WS-RECEIPT-CD.                         
           MOVE '/'                   TO WS-SLASH.                              
           MOVE WS-NUM-RECEIPT-JRNO   TO F120-NUM-RECPT-JRNO.                   
                                                                                
           IF F400-AMT-SELLING-PRICE NOT NUMERIC                                
              MOVE ZEROES             TO F400-AMT-SELLING-PRICE                 
           END-IF.                                                              
                                                                                
           COMPUTE F120-AMT-RECEIPT = F400-AMT-SELLING-PRICE.                   
                                                                                
           MOVE 'D'                   TO F120-CDE-CRDR.                         
           MOVE WS-DATE               TO F120-DTE-TRANS.                        
           MOVE F400-NUM-SCH-ACC      TO F120-NUM-SCH-ACCT.                     
           MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA                  
                                                                                
           WRITE BP13F120-CASHTRAN.                                             
           ADD  1                     TO WS-WRITE-CNT.                          
                                                                                
      *** CREATE TRANS-TYPE 22                                                  
           IF F400-AMT-LOAN >= ZEROES                                           
             MOVE SPACES                TO BP13F120-CASHTRAN                    
             MOVE '22'                  TO F120-CDE-TRANS-TYPE                  
             MOVE K800-NUM-REGN         TO F120-NUM-REGN                        
             MOVE K800-NUM-NRIC1        TO F120-NUM-NRIC                        
             MOVE WS-DATE               TO F120-DTE-POST                        
             MOVE ZEROES                TO F120-COUNT-HISTORY                   
             MOVE SPACES                TO F120-NUM-CPF-APPL                    
             MOVE 'MLF LN'              TO BP13F120-CASHTRAN(144:6)             
             MOVE 'MLF'                 TO F120-CDE-PAYMENT-TYPE                
             MOVE WS-DD                 TO WS-RECEIPT-DD                        
             MOVE WS-MM                 TO WS-RECEIPT-MM                        
             MOVE WS-YY                 TO WS-RECEIPT-YY                        
             MOVE 'JR'                  TO WS-RECEIPT-CD                        
             MOVE '/'                   TO WS-SLASH                             
             MOVE WS-NUM-RECEIPT-JRNO   TO F120-NUM-RECPT-JRNO                  
             COMPUTE F120-AMT-RECEIPT =  0 - F400-AMT-SELLING-PRICE             
             MOVE 'D'                   TO F120-CDE-CRDR                        
             MOVE WS-DATE               TO F120-DTE-TRANS                       
             MOVE F400-NUM-SCH-ACC      TO F120-NUM-SCH-ACCT                    
             MOVE  K800-NUM-FLAT-TYPE   TO F120-NUM-FLAT-TYPE-SA                
             IF K800-NUM-FLAT-TYPE = '2F' OR '1F'                               
                MOVE K800-NUM-LEASE-TENURE TO F120-NUM-PP-SCHEDULE              
             END-IF                                                             
             IF K800-NUM-ALLO-SCHEME = 'FSH'                                    
                MOVE 'H'                TO F120-CDE-VALID                       
             END-IF                                                             
             WRITE BP13F120-CASHTRAN                                            
             ADD  1                     TO WS-WRITE-CNT                         
           END-IF.                                                              
                                                                                
       330-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *------------------------*                                                
       400-REWRITE-BP13K800.                                                    
      *------------------------*                                                
           REWRITE BP13K800-MASTER.                                             
                                                                                
           IF K800-STATUS = ZEROES                                              
              CONTINUE                                                          
           ELSE                                                                 
              DISPLAY 'ERROR REWRITING BP13K800, STATUS : '                     
                       K800-STATUS                                              
              PERFORM 040-END-PROCESS    THRU 040-EXIT.                         
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       500-COMP-GST-AMOUNT.                                                     
      *----------------------------------------------------------------*        
      *--------------------------------------------------------*                
      *  CALL AV02B021 SUB-ROUTINE TO GET THE GST AMOUNT       *                
      *--------------------------------------------------------*                
           MOVE WS-TEMP-CONVEY-FEE       TO   WS-AMT-NETT.                      
           CALL 'AV02C021' USING WS-COMM-AREA-GST.                              
           MOVE WS-AMT-GST               TO   WS-TEMP-CONVEY-FEE-GST.           
           DISPLAY  WS-AMT-NETT                                                 
           DISPLAY  WS-AMT-GST.                                                 
                                                                                
       500-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *------------------------------*                                          
      *         END OF PROGRAM       *                                          
      *------------------------------*                                          
