      ***************************                                               
       IDENTIFICATION DIVISION.                                                 
      ***************************                                               
       PROGRAM-ID.    BP13C441.                                                 
       AUTHOR.        MCC.                                                      
      *DATE-WRITTEN.  07/12/2000.                                               
                                                                                
      * ============================================================== *        
      *                  SYSTEM OF COMMITMENT  (BP13)                  *        
      * ============================================================== *        
      *                                                                *        
      *   OBJECTIVE   :  1.  THIS IS A PROGRAM TO UPDATE RESALE HISTORY*        
      *                      FILE AND PRINT A REPORT TO LIST CASES     *        
      *                      WHERE PREMIUM COLLECTED AND RESALE STATUS *        
      *                      UPDATED.                                  *        
      *                                                                *        
      *   INPUT FILES :  1.  BP13F410  -  DAILYSO FILE                 *        
      *                  2.  BB24K500  -  RESALE HISTORY FILE          *        
      *                                                                *        
      *   OUTPUT      :  1.  REPORT OF CASES WHERE PREMIUM COLLECTED   *        
      *                      AND RESALE STATUS UPDATED.                *        
      *                      (BP13L441)                                *        
      *                                                                *        
      *                  2.  REPORT OF CASES WHERE PREMIUM COLLECTED   *        
      *                      AND RESALE IN PROGRESS.                   *        
      *                      (P13L441A)                                *        
      *                                                                *        
      *                  2.  REPORT OF CASES WHERE PREMIUM COLLECTED   *        
      *                      AND RESALE NOT FOUND.                     *        
      *                      (P13L441B)                                *        
      *                                                                *        
      *                  4.  REPORT OF CASES WHERE PREMIUM COLLECTED   *        
      *                      AND RESALE STATUS NOT EQUAL SN,BSN,CN AND *        
      *                      LN (P13L441C).                                     
      *                                                                *        
      *  CHGE-NO   BY    DATE     DESCRIPTION                          *        
      *  --------  ---  --------  -----------                          *        
      *  BP130941  MCC  07122000  NEW PROGRAM.                         *        
      *  BP130998  MCC  01042001  CATEF FOR SA FLAT.                   *        
      *  BP132676  JF4  05042005  CATER FOR ALLOC SCHEME 'SFL' / 'SRL' *        
      *  BP132702  JF4  15082005  ADD P13L441D REPORT FOR SFL/SRL CASE *        
      *                           NOT FOUND IN PREMIUM FILE            *        
      ******************************************************************        
                                                                                
      ***********************                                                   
       ENVIRONMENT DIVISION.                                                    
      ***********************                                                   
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F410  ASSIGN TO BP13F410.                                 
                                                                                
           SELECT BP13K800  ASSIGN TO BP13K800                                  
                  ORGANIZATION     IS INDEXED                                   
                  ACCESS MODE      IS RANDOM                                    
                  RECORD KEY       IS K800-NUM-REGN                             
                  FILE STATUS      IS WS-K800-STATUS.                           
                                                                                
           SELECT BB24K500  ASSIGN TO BB24K500                                  
                  ORGANIZATION     IS INDEXED                                   
                  ACCESS MODE      IS RANDOM                                    
                  RECORD KEY       IS K500-KEY-FLD                              
                  FILE STATUS      IS WS-K500-STATUS.                           
                                                                                
           SELECT BP13K470  ASSIGN TO BP13K470                                  
                  ORGANIZATION     IS INDEXED                                   
                  ACCESS MODE      IS DYNAMIC                                   
                  RECORD KEY       IS K470-KEY-FLD                              
                  FILE STATUS      IS WS-K470-STATUS.                           
                                                                                
           SELECT BP13L441  ASSIGN TO BP13L441.                                 
           SELECT BP13F470  ASSIGN TO BP13F470.                                 
           SELECT P13L441A  ASSIGN TO P13L441A.                                 
           SELECT P13L441B  ASSIGN TO P13L441B.                                 
           SELECT P13L441C  ASSIGN TO P13L441C.                                 
           SELECT P13L441D  ASSIGN TO P13L441D.                                 
                                                                                
                                                                                
      *****************                                                         
       DATA DIVISION.                                                           
      *****************                                                         
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD   BP13F410                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13F410.                                                           
                                                                                
       FD   BP13F470                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13F470.                                                           
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BB24K500                                                            
            RECORD CONTAINS 1700 CHARACTERS.                                    
       COPY BB24K500.                                                           
                                                                                
       FD   BP13K470                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K470.                                                           
                                                                                
       FD  BP13L441                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132  CHARACTERS.                                     
       01  L441-PRT-REC                     PIC X(132).                         
                                                                                
       FD  P13L441A                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132  CHARACTERS.                                     
       01  L441A-PRT-REC                    PIC X(132).                         
                                                                                
       FD  P13L441B                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132  CHARACTERS.                                     
       01  L441B-PRT-REC                    PIC X(132).                         
                                                                                
       FD  P13L441C                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132  CHARACTERS.                                     
       01  L441C-PRT-REC                    PIC X(132).                         
                                                                                
       FD  P13L441D                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132  CHARACTERS.                                     
       01  L441D-PRT-REC                    PIC X(132).                         
                                                                                
                                                                                
      *------------------------*                                                
       WORKING-STORAGE SECTION.                                                 
      *------------------------*                                                
                                                                                
       01  WS-STATUS.                                                           
           05  WS-K500-STATUS               PIC 99    VALUE ZEROES.             
           05  WS-K470-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K800-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-F410-EOF                  PIC X     VALUE 'N'.                
           05  WS-K470-EOF                  PIC X     VALUE 'N'.                
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-NUM-NRIC                  PIC X(09) VALUE ZEROS.              
           05  WS-PREV-RESL-STAT            PIC X(02) VALUE ZEROS.              
           05  WS-RESL-STAT                 PIC X(3)  VALUE SPACES.             
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-CNT-F410                  PIC 9(5)  VALUE ZEROS.              
           05  WS-CNT-K470                  PIC 9(5)  VALUE ZEROS.              
           05  WS-F470-WRITE                PIC 9(5)  VALUE ZEROS.              
           05  WS-CNTR                      PIC 9(5)  VALUE ZEROS.              
           05  WS-PREMIUM                   PIC 9(7)V99 VALUE ZEROS.            
           05  WS-SKIPPED                   PIC 9(5)  VALUE ZEROS.              
           05  WS-PRINTED                   PIC 9(5)  VALUE ZEROS.              
           05  WS-PREM-DEL                  PIC 9(5)  VALUE ZEROS.              
           05  WS-PREM-ACC                  PIC 9(5)  VALUE ZEROS.              
           05  WS-LINE-NO                   PIC 9(2)  VALUE  60.                
           05  WS-PAGE-NO                   PIC 9(5)  VALUE ZEROS.              
           05  WS-L441-SEQ                  PIC 9(5)  VALUE ZEROS.              
           05  WS-STAT-UPDATED              PIC 9(5)  VALUE ZEROS.              
           05  WS-L441A-LINE-NO             PIC 9(2)  VALUE 60.                 
           05  WS-L441A-PAGE-NO             PIC 9(5)  VALUE ZEROS.              
           05  WS-L441A-SEQ                 PIC 9(5)  VALUE ZEROS.              
           05  WS-STAT-PROGRESS             PIC 9(5)  VALUE ZEROS.              
           05  WS-L441C-LINE-NO             PIC 9(5)  VALUE 60.                 
           05  WS-L441C-PAGE-NO             PIC 9(5)  VALUE ZEROS.              
           05  WS-L441C-SEQ                 PIC 9(5)  VALUE ZEROS.              
           05  WS-STAT-UNMTCH               PIC 9(5)  VALUE ZEROS.              
           05  WS-L441B-LINE-NO             PIC 9(2)  VALUE 60.                 
           05  WS-L441B-PAGE-NO             PIC 9(5)  VALUE ZEROS.              
           05  WS-L441B-SEQ                 PIC 9(5)  VALUE ZEROS.              
           05  WS-RESL-NOTFND               PIC 9(5)  VALUE ZEROS.              
           05  WS-K470-NOTFND               PIC 9(5)  VALUE ZEROS.              
           05  WS-L441D-LINE-NO             PIC 9(2)  VALUE 60.                 
           05  WS-L441D-PAGE-NO             PIC 9(5)  VALUE ZEROS.              
           05  WS-L441D-SEQ                 PIC 9(5)  VALUE ZEROS.              
           05  WS-L441D-CNT                 PIC 9(5)  VALUE ZEROS.              
                                                                                
       01  WS-DATE-VARIABLES.                                                   
           05  WS-PRINT-DATE                PIC X(10)   VALUE SPACES.           
           05  WS-DATE.                                                         
               10  WS-CCYY                  PIC 9(4)  VALUE 0000.               
               10  WS-MM                    PIC 99    VALUE 00.                 
               10  WS-DD                    PIC 99    VALUE 00.                 
                                                                                
      *------------------------------------------------------------*            
      *        LAY-OUT FOR CONTROL LISTING                         *            
      *------------------------------------------------------------*            
      *-----------------------------------------------*                         
      **** LAYOUT FOR CASES WHERE RESALE STATUS UPDATED                         
      *-----------------------------------------------*                         
       01  L441-HDG1.                                                           
           05  FILLER                   PIC X(14) VALUE 'BP13L441'.             
           05  FILLER                   PIC X(8)  VALUE 'HDB3'.                 
           05  FILLER                   PIC X(15) VALUE SPACES.                 
           05  FILLER                   PIC X(39) VALUE                         
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                   PIC X(15) VALUE SPACES.                 
           05  FILLER                   PIC X(06) VALUE 'DATE :'.               
           05  L441-PRT-DTE             PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE ' PAGE: '.              
           05  L441-PAGE-NO             PIC ZZZZ9.                              
                                                                                
       01  L441-HDG2.                                                           
           05  FILLER                   PIC X(26) VALUE SPACES.                 
           05  FILLER                   PIC X(63) VALUE                         
              'LIST OF CASES WHERE PREMIUM COLLECTED AND RESALE STATUS U        
      -       'PDATED'.                                                         
           05  FILLER                   PIC X(44) VALUE SPACES.                 
                                                                                
       01  L441-HDG3.                                                           
           05  FILLER               PIC X(45) VALUE SPACES.                     
           05  FILLER               PIC X(28) VALUE                             
               'IN RESALE HISTORY FILE'.                                        
                                                                                
       01  L441-HDG4A.                                                          
           05  FILLER               PIC X(124) VALUE SPACES.                    
           05  FILLER               PIC X(06) VALUE 'RESALE'.                   
                                                                                
       01  L441-HDG4.                                                           
           05  FILLER               PIC X(35) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE '     NEW      '.           
           05  FILLER               PIC X(32) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE '    RESALE    '.           
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE '  RESALE  '.               
           05  FILLER               PIC X(03) VALUE SPACES.                     
           05  FILLER               PIC X(08) VALUE 'PREVIOUS'.                 
           05  FILLER               PIC X(03) VALUE SPACES.                     
           05  FILLER               PIC X(09) VALUE 'STATUS TO'.                
                                                                                
       01  L441-HDG5.                                                           
           05  FILLER               PIC X(35) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE ' FLAT SCHEME  '.           
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE ' PREMIUM  '.               
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE ' FLAT SCHEME  '.           
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE ' APPROVAL '.               
           05  FILLER               PIC X(03) VALUE SPACES.                     
           05  FILLER               PIC X(08) VALUE ' RESALE '.                 
           05  FILLER               PIC X(02) VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE 'BE UPDATED'.               
                                                                                
       01  L441-HDG6.                                                           
           05  FILLER               PIC X(06) VALUE 'S/NO'.                     
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(08) VALUE 'REGN NO '.                 
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(09) VALUE 'HA''S UIN '.               
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE '    A/C NO    '.           
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE 'COLLECTED '.               
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE ' SO DATE  '.               
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE '    A/C NO    '.           
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE '   DATE   '.               
           05  FILLER               PIC X(03) VALUE SPACES.                     
           05  FILLER               PIC X(08) VALUE ' STATUS '.                 
           05  FILLER               PIC X(03) VALUE SPACES.                     
           05  FILLER               PIC X(07) VALUE 'BY RESL'.                  
                                                                                
       01  L441-DETAIL.                                                         
           05  L441-SNO             PIC ZZ,ZZ9.                                 
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441-REGN-NO         PIC X(08).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441-UINFIN          PIC X(09).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441-NEW-SCHACC      PIC X(14).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441-PREMIUM         PIC $$$$$$9.99.                             
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441-SO-DATE         PIC X(10).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441-RESL-SCHACC     PIC X(14).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441-APRV-DATE       PIC X(10).                                  
           05  FILLER               PIC X(05) VALUE SPACES.                     
           05  L441-PREV-STATUS     PIC X(03).                                  
           05  FILLER               PIC X(09) VALUE SPACES.                     
           05  L441-RESL-STATUS     PIC X(03).                                  
                                                                                
      *--------------------------------------------*                            
      **** LAYOUT FOR CASES WHERE RESALE IN PROGRESS                            
      *--------------------------------------------*                            
       01  L441A-HDG1.                                                          
           05  FILLER                   PIC X(14) VALUE 'P13L441A'.             
           05  FILLER                   PIC X(8)  VALUE 'HDB3'.                 
           05  FILLER                   PIC X(15) VALUE SPACES.                 
           05  FILLER                   PIC X(39) VALUE                         
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                   PIC X(15) VALUE SPACES.                 
           05  FILLER                   PIC X(06) VALUE 'DATE :'.               
           05  L441A-PRT-DTE            PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE ' PAGE: '.              
           05  L441A-PAGE-NO            PIC ZZZZ9.                              
                                                                                
       01  L441A-HDG2.                                                          
           05  FILLER                   PIC X(27) VALUE SPACES.                 
           05  FILLER                   PIC X(60) VALUE                         
              'LIST OF CASES WHERE PREMIUM COLLECTED AND RESALE IN PROGR        
      -       'ESS'.                                                            
           05  FILLER                   PIC X(45) VALUE SPACES.                 
                                                                                
       01  L441A-HDG3.                                                          
           05  FILLER               PIC X(45) VALUE SPACES.                     
           05  FILLER               PIC X(19) VALUE                             
               '(CASE NOT APPROVED)'.                                           
                                                                                
       01  L441A-HDG-PARTA-TO.                                                  
           05  FILLER               PIC X(01) VALUE SPACES.                     
           05  FILLER               PIC X(31) VALUE                             
               'TO   : RESALE OPERATIONS UNIT '.                                
                                                                                
       01  L441A-HDG4.                                                          
           05  FILLER               PIC X(35) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE '     NEW      '.           
           05  FILLER               PIC X(32) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE '    RESALE    '.           
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE '  RESALE  '.               
                                                                                
       01  L441A-HDG5.                                                          
           05  FILLER               PIC X(35) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE ' FLAT SCHEME  '.           
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE ' PREMIUM  '.               
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE ' FLAT SCHEME  '.           
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE ' 1ST APPT '.               
                                                                                
       01  L441A-HDG6.                                                          
           05  FILLER               PIC X(06) VALUE 'S/NO'.                     
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(08) VALUE 'REGN NO '.                 
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(09) VALUE 'HA''S UIN '.               
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE '    A/C NO    '.           
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE 'COLLECTED '.               
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE ' SO DATE  '.               
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE '    A/C NO    '.           
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE '   DATE   '.               
                                                                                
       01  L441A-DETAIL.                                                        
           05  L441A-SNO            PIC ZZ,ZZ9.                                 
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441A-REGN-NO        PIC X(08).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441A-UINFIN         PIC X(09).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441A-NEW-SCHACC     PIC X(14).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441A-PREMIUM        PIC $$$$$$9.99.                             
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441A-SO-DATE        PIC X(10).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441A-RESL-SCHACC    PIC X(14).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441A-1ST-APPT-DATE  PIC X(10).                                  
                                                                                
      *------------------------------------------*                              
      **** LAYOUT FOR CASES WHERE RESALE NOT FOUND                              
      *------------------------------------------*                              
       01  L441B-HDG1.                                                          
           05  FILLER                   PIC X(14) VALUE 'P13L441B'.             
           05  FILLER                   PIC X(8)  VALUE 'HDB3'.                 
           05  FILLER                   PIC X(15) VALUE SPACES.                 
           05  FILLER                   PIC X(39) VALUE                         
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                   PIC X(15) VALUE SPACES.                 
           05  FILLER                   PIC X(06) VALUE 'DATE :'.               
           05  L441B-PRT-DTE            PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE ' PAGE: '.              
           05  L441B-PAGE-NO            PIC ZZZZ9.                              
                                                                                
       01  L441B-HDG2.                                                          
           05  FILLER                   PIC X(24) VALUE SPACES.                 
           05  FILLER                   PIC X(65) VALUE                         
              'LIST OF CASES WHERE PREMIUM COLLECTED BUT NO RESALE RECOR        
      -       'DS FOUND'.                                                       
           05  FILLER                   PIC X(43) VALUE SPACES.                 
                                                                                
       01  L441B-HDG3.                                                          
           05  FILLER               PIC X(35) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE '     NEW      '.           
           05  FILLER               PIC X(32) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE '    RESALE    '.           
                                                                                
       01  L441B-HDG4.                                                          
           05  FILLER               PIC X(35) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE ' FLAT SCHEME  '.           
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE ' PREMIUM  '.               
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE ' FLAT SCHEME  '.           
                                                                                
       01  L441B-HDG5.                                                          
           05  FILLER               PIC X(06) VALUE 'S/NO'.                     
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(08) VALUE 'REGN NO '.                 
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(09) VALUE 'HA''S UIN '.               
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE '    A/C NO    '.           
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE 'COLLECTED '.               
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE ' SO DATE  '.               
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE '    A/C NO    '.           
                                                                                
       01  L441B-DETAIL.                                                        
           05  L441B-SNO            PIC ZZ,ZZ9.                                 
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441B-REGN-NO        PIC X(08).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441B-UINFIN         PIC X(09).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441B-NEW-SCHACC     PIC X(14).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441B-PREMIUM        PIC $$$$$$9.99.                             
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441B-SO-DATE        PIC X(10).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441B-RESL-SCHACC    PIC X(14).                                  
                                                                                
      *------------------------------------------*                              
      **** LAYOUT FOR CASES WHERE RESALE NOT MATCH                              
      *------------------------------------------*                              
       01  L441C-HDG1.                                                          
           05  FILLER                   PIC X(14) VALUE 'P13L441C'.             
           05  FILLER                   PIC X(8)  VALUE 'HDB3'.                 
           05  FILLER                   PIC X(15) VALUE SPACES.                 
           05  FILLER                   PIC X(39) VALUE                         
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                   PIC X(15) VALUE SPACES.                 
           05  FILLER                   PIC X(06) VALUE 'DATE :'.               
           05  L441C-PRT-DTE            PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE ' PAGE: '.              
           05  L441C-PAGE-NO            PIC ZZZZ9.                              
                                                                                
       01  L441C-HDG2.                                                          
           05  FILLER                   PIC X(25) VALUE SPACES.                 
           05  FILLER                   PIC X(63) VALUE                         
              'EXCEPTION REPORT WHERE PREMIUM COLLECTED AND RESALE STATU        
      -       'S CODE'.                                                         
           05  FILLER                   PIC X(44) VALUE SPACES.                 
                                                                                
       01  L441C-HDG3.                                                          
           05  FILLER               PIC X(29) VALUE SPACES.                     
           05  FILLER               PIC X(62) VALUE                             
               'IN RESALE HISTORY FILE IS NOT EQUAL TO SN, BSN, CN, LN A        
      -        'ND SAN'.                                                        
                                                                                
       01  L441C-HDG4.                                                          
           05  FILLER               PIC X(38) VALUE SPACES.                     
           05  FILLER               PIC X(08) VALUE 'NEW FLAT'.                 
           05  FILLER               PIC X(07) VALUE SPACES.                     
           05  FILLER               PIC X(11) VALUE 'SALES ORDER'.              
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  FILLER               PIC X(06) VALUE 'RESALE'.                   
                                                                                
       01  L441C-HDG5.                                                          
           05  FILLER               PIC X(01) VALUE SPACES.                     
           05  FILLER               PIC X(04) VALUE 'S/NO'.                     
           05  FILLER               PIC X(05) VALUE SPACES.                     
           05  FILLER               PIC X(07) VALUE 'REGN NO'.                  
           05  FILLER               PIC X(05) VALUE SPACES.                     
           05  FILLER               PIC X(08) VALUE 'HA''S UIN'.                
           05  FILLER               PIC X(05) VALUE SPACES.                     
           05  FILLER               PIC X(13) VALUE 'SCHEME A/C NO'.            
           05  FILLER               PIC X(08) VALUE SPACES.                     
           05  FILLER               PIC X(04) VALUE 'DATE'.                     
           05  FILLER               PIC X(08) VALUE SPACES.                     
           05  FILLER               PIC X(06) VALUE 'STATUS'.                   
                                                                                
       01  L441C-DETAIL.                                                        
           05  L441C-SNO            PIC ZZ,ZZ9.                                 
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441C-REGN-NO        PIC X(08).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441C-UINFIN         PIC X(09).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441C-NEW-SCHACC     PIC X(14).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441C-SO-DATE        PIC X(10).                                  
           05  FILLER               PIC X(07) VALUE SPACES.                     
           05  L441C-RESL-STATUS    PIC X(03).                                  
                                                                                
       01  L441C-HDG-PARTA-TO.                                                  
           05  FILLER               PIC X(01) VALUE SPACES.                     
           05  FILLER               PIC X(33) VALUE                             
               'TO   : SALES UNIT, AGREEMENT TEAM'.                             
                                                                                
      *-------------------------------------------------------*                 
      **** LAYOUT FOR SFL/SRL CASES NOT FOUND IN PREMIUM FILE                   
      *-------------------------------------------------------*                 
       01  L441D-HDG1.                                                          
           05  FILLER                   PIC X(14) VALUE 'P13L441D'.             
           05  FILLER                   PIC X(8)  VALUE 'HDB3'.                 
           05  FILLER                   PIC X(15) VALUE SPACES.                 
           05  FILLER                   PIC X(39) VALUE                         
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                   PIC X(15) VALUE SPACES.                 
           05  FILLER                   PIC X(06) VALUE 'DATE :'.               
           05  L441D-PRT-DTE            PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE ' PAGE: '.              
           05  L441D-PAGE-NO            PIC ZZZZ9.                              
                                                                                
       01  L441D-HDG2.                                                          
           05  FILLER                   PIC X(25) VALUE SPACES.                 
           05  FILLER                   PIC X(63) VALUE                         
              'EXCEPTION REPORT FOR SFL/SRL CASES NOT FOUND IN PREMIUM F        
      -       'ILE'.                                                            
           05  FILLER                   PIC X(44) VALUE SPACES.                 
                                                                                
       01  L441D-HDG3.                                                          
           05  FILLER               PIC X(38) VALUE SPACES.                     
           05  FILLER               PIC X(08) VALUE SPACES.                     
           05  FILLER               PIC X(07) VALUE SPACES.                     
           05  FILLER               PIC X(11) VALUE SPACES.                     
           05  FILLER               PIC X(07) VALUE SPACES.                     
           05  FILLER               PIC X(13) VALUE 'RESALE STATUS'.            
                                                                                
       01  L441D-HDG4.                                                          
           05  FILLER               PIC X(38) VALUE SPACES.                     
           05  FILLER               PIC X(08) VALUE 'NEW FLAT'.                 
           05  FILLER               PIC X(07) VALUE SPACES.                     
           05  FILLER               PIC X(11) VALUE 'SALES ORDER'.              
           05  FILLER               PIC X(08) VALUE SPACES.                     
           05  FILLER               PIC X(13) VALUE 'TO BE UPDATED'.            
                                                                                
       01  L441D-HDG5.                                                          
           05  FILLER               PIC X(01) VALUE SPACES.                     
           05  FILLER               PIC X(04) VALUE 'S/NO'.                     
           05  FILLER               PIC X(05) VALUE SPACES.                     
           05  FILLER               PIC X(07) VALUE 'REGN NO'.                  
           05  FILLER               PIC X(05) VALUE SPACES.                     
           05  FILLER               PIC X(08) VALUE 'HA''S UIN'.                
           05  FILLER               PIC X(05) VALUE SPACES.                     
           05  FILLER               PIC X(13) VALUE 'SCHEME A/C NO'.            
           05  FILLER               PIC X(08) VALUE SPACES.                     
           05  FILLER               PIC X(04) VALUE 'DATE'.                     
           05  FILLER               PIC X(13) VALUE SPACES.                     
           05  FILLER               PIC X(07) VALUE 'BY RESL'.                  
                                                                                
       01  L441D-DETAIL.                                                        
           05  L441D-SNO            PIC ZZ,ZZ9.                                 
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441D-REGN-NO        PIC X(08).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441D-UINFIN         PIC X(09).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441D-NEW-SCHACC     PIC X(14).                                  
           05  FILLER               PIC X(04) VALUE SPACES.                     
           05  L441D-SO-DATE        PIC X(10).                                  
                                                                                
       01  L441D-HDG-PARTA-TO.                                                  
           05  FILLER               PIC X(01) VALUE SPACES.                     
           05  FILLER               PIC X(33) VALUE                             
               'TO   : SALES UNIT, AGREEMENT TEAM'.                             
                                                                                
      ***** PART A *****                                                        
                                                                                
       01  L441-PARTA.                                                          
           05  FILLER               PIC X(01) VALUE SPACES.                     
           05  FILLER               PIC X(06) VALUE                             
               'PART A'.                                                        
                                                                                
       01  L441-HDG-PARTA-TO.                                                   
           05  FILLER               PIC X(01) VALUE SPACES.                     
           05  FILLER               PIC X(29) VALUE                             
               'TO   : RESALE OPERATIONS UNIT'.                                 
                                                                                
       01  L441-HDG-PARTA-FROM.                                                 
           05  FILLER               PIC X(01) VALUE SPACES.                     
           05  FILLER               PIC X(33) VALUE                             
               'FROM : SALES UNIT, AGREEMENT TEAM'.                             
                                                                                
       01  L441-DASH.                                                           
           05  FILLER               PIC X(132) VALUE ALL '-'.                   
                                                                                
       01  L441-FOOTER-ENC.                                                     
           05  FILLER               PIC X(01) VALUE SPACES.                     
           05  FILLER               PIC X(58) VALUE                             
               'ENCLOSED ARE (_________________) PREMIUM PAID UNDERTAKIN        
      -        'GS'.                                                            
                                                                                
       01  L441-DASH2.                                                          
           05  FILLER               PIC X(01) VALUE SPACES.                     
           05  FILLER               PIC X(30) VALUE ALL '-'.                    
                                                                                
       01  L441-FOOTER2.                                                        
           05  FILLER               PIC X(01) VALUE SPACES.                     
           05  FILLER               PIC X(30) VALUE                             
               'EO/EEO (SALES, AGREEMENT TEAM)'.                                
                                                                                
       01  L441-FOOTER3.                                                        
           05  FILLER               PIC X(01) VALUE SPACES.                     
           05  FILLER               PIC X(05) VALUE                             
               'DATE:'.                                                         
                                                                                
      ***** PART B *****                                                        
       01  L441-EMPTY.                                                          
           05  FILLER               PIC X(45) VALUE SPACES.                     
           05  FILLER               PIC X(20) VALUE                             
               '*** EMPTY REPORT ***'.                                          
                                                                                
       01  L441-PARTB.                                                          
           05  FILLER               PIC X(01) VALUE SPACES.                     
           05  FILLER               PIC X(06) VALUE                             
               'PART B'.                                                        
                                                                                
       01  L441-FOOTER4.                                                        
           05  FILLER               PIC X(01) VALUE SPACES.                     
           05  FILLER               PIC X(26) VALUE                             
               'ACKNOWLEDGED RECEIPTING : '.                                    
                                                                                
       01  L441-FOOTER5.                                                        
           05  FILLER               PIC X(01) VALUE SPACES.                     
           05  FILLER               PIC X(29) VALUE                             
               'REVIEWED BY : _______________'.                                 
                                                                                
       01  L441-FOOTER6.                                                        
           05  FILLER               PIC X(01) VALUE SPACES.                     
           05  FILLER               PIC X(29) VALUE                             
               'DESIGNATION : _______________'.                                 
                                                                                
       01  L441-FOOTER7.                                                        
           05  FILLER               PIC X(01) VALUE SPACES.                     
           05  FILLER               PIC X(29) VALUE                             
               'SIGNATURE :   _______________'.                                 
                                                                                
       01  L441-FOOTER8.                                                        
           05  FILLER               PIC X(01) VALUE SPACES.                     
           05  FILLER               PIC X(29) VALUE                             
               'DATE :        _______________'.                                 
                                                                                
                                                                                
      **********************                                                    
       PROCEDURE DIVISION.                                                      
      **********************                                                    
                                                                                
      *******************                                                       
       0000-MAIN-ROUTINE.                                                       
      *******************                                                       
           PERFORM 1000-OPEN-FILES             THRU 1000-EXIT.                  
           PERFORM 2000-READ-BP13F410          THRU 2000-EXIT.                  
           PERFORM 3000-PROCESS-RECORDS        THRU 3000-EXIT                   
                       UNTIL WS-F410-EOF = 'Y'.                                 
           PERFORM 9000-CLOSE-ROUTINE          THRU 9000-EXIT.                  
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       1000-OPEN-FILES.                                                         
      *-------------------------------------------------------------            
           OPEN INPUT BP13F410                                                  
                      BP13K470                                                  
                      BP13K800                                                  
                      BB24K500                                                  
               OUTPUT BP13L441                                                  
                      BP13F470                                                  
                      P13L441A                                                  
                      P13L441B                                                  
                      P13L441C                                                  
                      P13L441D.                                                 
                                                                                
           IF WS-K500-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR WS-K500-STATUS ' WS-K500-STATUS            
              MOVE     WS-K500-STATUS TO RETURN-CODE                            
              PERFORM  9000-CLOSE-ROUTINE.                                      
                                                                                
           IF WS-K470-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR WS-K470-STATUS ' WS-K470-STATUS            
              MOVE     WS-K470-STATUS TO RETURN-CODE                            
              PERFORM  9000-CLOSE-ROUTINE.                                      
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR WS-K800-STATUS ' WS-K800-STATUS            
              MOVE     WS-K800-STATUS TO RETURN-CODE                            
              PERFORM  9000-CLOSE-ROUTINE.                                      
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-DATE.                          
           STRING WS-DD '/'                                                     
                  WS-MM '/'                                                     
                  WS-CCYY DELIMITED BY SIZE                                     
                  INTO WS-PRINT-DATE.                                           
                                                                                
           PERFORM 5100-PRINT-PAGE-HDGS     THRU  5100-EXIT.                    
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       2000-READ-BP13F410.                                                      
      *-------------------------------------------------------------            
           READ BP13F410                                                        
                AT END MOVE 'Y' TO WS-F410-EOF                                  
                       GO TO 2000-EXIT.                                         
                                                                                
           IF (F410-NUM-PREMIUM-RATE = ZEROES OR LOW-VALUES) AND                
              (F410-CDE-ALLOC-SCH NOT = 'SFL' AND 'SRL')                        
              ADD 01 TO WS-SKIPPED                                              
              GO TO 2000-READ-BP13F410.                                         
                                                                                
           ADD  1  TO  WS-CNT-F410.                                             
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       3000-PROCESS-RECORDS.                                                    
      *-------------------------------------------------------------            
           MOVE F410-NUM-REGN            TO K470-NUM-REGN                       
                                            K800-NUM-REGN.                      
           PERFORM 3100-READ-BP13K800    THRU 3100-EXIT.                        
           MOVE 'N'                      TO WS-K470-EOF.                        
           MOVE ZERO                     TO WS-CNTR.                            
           PERFORM 3200-STARTBR-BP13K470 THRU 3200-EXIT.                        
                                                                                
           IF (WS-CNTR < 02) AND                                                
              (F410-CDE-ALLOC-SCH = 'SFL' OR 'SRL')                             
              PERFORM 4950-PRINT-SFL-SRL THRU 4950-EXIT                         
           END-IF.                                                              
                                                                                
           PERFORM 2000-READ-BP13F410    THRU 2000-EXIT.                        
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       3100-READ-BP13K800.                                                      
      *-------------------------------------------------------------            
           READ BP13K800.                                                       
                                                                                
           EVALUATE WS-K800-STATUS                                              
           WHEN 00                                                              
           WHEN 02                                                              
                CONTINUE                                                        
           WHEN 23                                                              
                MOVE SPACE      TO K800-NUM-DEFER-PREMIUM                       
           WHEN OTHER                                                           
                DISPLAY 'READ ERROR, BP13K800-STATUS ' WS-K800-STATUS           
                MOVE     WS-K800-STATUS TO RETURN-CODE                          
                PERFORM  9000-CLOSE-ROUTINE                                     
           END-EVALUATE.                                                        
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       3200-STARTBR-BP13K470.                                                   
      *-------------------------------------------------------------            
           START BP13K470 KEY = K470-NUM-REGN.                                  
                                                                                
           EVALUATE WS-K470-STATUS                                              
           WHEN 00                                                              
           WHEN 02                                                              
                MOVE 01 TO WS-CNTR                                              
                PERFORM 3300-READNEXT-BP13K470 THRU 3300-EXIT                   
                        UNTIL WS-K470-EOF = 'Y' OR  WS-CNTR > 4                 
           WHEN 23                                                              
                ADD 01  TO WS-K470-NOTFND                                       
           WHEN OTHER                                                           
                DISPLAY 'READ ERROR, WS-K470-STATUS ' WS-K470-STATUS            
                MOVE     WS-K470-STATUS TO RETURN-CODE                          
                PERFORM  9000-CLOSE-ROUTINE                                     
           END-EVALUATE.                                                        
                                                                                
           IF WS-CNTR = 01                                                      
              ADD 01  TO WS-K470-NOTFND                                         
           END-IF.                                                              
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       3300-READNEXT-BP13K470.                                                  
      *-------------------------------------------------------------            
           READ BP13K470 NEXT AT END MOVE 'Y' TO WS-K470-EOF                    
                GO TO 3300-EXIT.                                                
                                                                                
           IF K470-NUM-REGN NOT = F410-NUM-REGN                                 
              MOVE 'Y' TO WS-K470-EOF                                           
              GO TO 3300-EXIT.                                                  
                                                                                
           ADD 01 TO WS-CNT-K470.                                               
                                                                                
           IF K470-NUM-SOC-STATUS NOT = 'A'                                     
              ADD  01  TO WS-PREM-DEL                                           
              GO TO 3300-EXIT.                                                  
                                                                                
           PERFORM 4000-READ-BB24K500 THRU 4000-EXIT.                           
                                                                                
           ADD 01 TO WS-PREM-ACC.                                               
           ADD 01 TO WS-CNTR.                                                   
                                                                                
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       4000-READ-BB24K500.                                                      
      *-------------------------------------------------------------            
           MOVE K470-NUM-HDB-REF     TO K500-NUM-HDB-REF.                       
           MOVE K470-DTE-APPROVAL    TO K500-DTE-APPROVAL.                      
                                                                                
           READ BB24K500.                                                       
                                                                                
           EVALUATE WS-K500-STATUS                                              
           WHEN 00                                                              
           WHEN 02                                                              
                PERFORM 4100-CHECK-RESALE-RECORD      THRU 4100-EXIT            
           WHEN 23                                                              
                DISPLAY 'REC NOT FOUND IN BB24K500 '                            
                        K500-NUM-HDB-REF ' ' K500-DTE-APPROVAL                  
                PERFORM 4200-RECORD-NOTFD-RESALE      THRU 4200-EXIT            
           WHEN OTHER                                                           
                DISPLAY 'READ ERROR, BB24K500-STATUS ' WS-K500-STATUS           
                MOVE     WS-K500-STATUS TO RETURN-CODE                          
                PERFORM  9000-CLOSE-ROUTINE                                     
           END-EVALUATE.                                                        
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       4100-CHECK-RESALE-RECORD.                                                
      *-------------------------------------------------------------            
           IF K500-NUM-UIN-SELLER1 = K470-NUM-NRIC                              
              IF K470-NUM-RESALE-STATUS = 'SN' OR 'BSN' OR 'CN' OR              
                                       'LN' OR 'SAN'                            
                 PERFORM 4500-WRITE-BP13F470 THRU 4500-EXIT                     
                 IF K500-DTE-COMPLETION = SPACES OR LOW-VALUES OR               
                                          '00000000'                            
                    PERFORM 4700-PRINT-STATUS-IN-PROGRESS THRU                  
                                           4700-EXIT                            
                 ELSE                                                           
                    PERFORM 4800-PRINT-STATUS-UPDATED THRU 4800-EXIT            
                 END-IF                                                         
              ELSE                                                              
                 IF K500-DTE-COMPLETION = SPACES OR LOW-VALUES OR               
                                          '00000000'                            
                    PERFORM 4700-PRINT-STATUS-IN-PROGRESS THRU                  
                                           4700-EXIT                            
                 END-IF                                                         
                 PERFORM 4600-PRINT-STATUS-NOT-MTCH THRU 4600-EXIT              
              END-IF                                                            
           ELSE                                                                 
              IF K500-NUM-UIN-SELLER2 = K470-NUM-NRIC                           
                 IF K470-NUM-RESALE-STATUS = 'SN' OR 'BSN' OR 'CN' OR           
                                               'LN' OR 'SAN'                    
                    PERFORM 4500-WRITE-BP13F470 THRU 4500-EXIT                  
                    IF K500-DTE-COMPLETION = SPACES OR LOW-VALUES OR            
                                            '00000000'                          
                       PERFORM 4700-PRINT-STATUS-IN-PROGRESS THRU               
                               4700-EXIT                                        
                    ELSE                                                        
                         PERFORM 4800-PRINT-STATUS-UPDATED THRU                 
                                 4800-EXIT                                      
                    END-IF                                                      
                 ELSE                                                           
                    IF K500-DTE-COMPLETION = SPACES OR LOW-VALUES OR            
                                              '00000000'                        
                       PERFORM 4700-PRINT-STATUS-IN-PROGRESS THRU               
                                 4700-EXIT                                      
                    END-IF                                                      
                    PERFORM 4600-PRINT-STATUS-NOT-MTCH THRU 4600-EXIT           
                 END-IF                                                         
              ELSE                                                              
                PERFORM 4600-PRINT-STATUS-NOT-MTCH THRU 4600-EXIT               
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       4200-RECORD-NOTFD-RESALE.                                                
      *-------------------------------------------------------------            
           MOVE SPACES                 TO L441B-PRT-REC.                        
                                                                                
           IF WS-L441B-LINE-NO > 35                                             
              PERFORM 5400-PRINT-L441B-HDG THRU  5400-EXIT                      
           END-IF.                                                              
                                                                                
           ADD  01               TO   WS-L441B-SEQ.                             
           MOVE WS-L441B-SEQ     TO   L441B-SNO.                                
           MOVE F410-NUM-REGN    TO   L441B-REGN-NO.                            
           MOVE K470-NUM-NRIC    TO   L441B-UINFIN.                             
                                                                                
           IF F410-NUM-SCH-ACC NOT = SPACES AND LOW-VALUES AND                  
                                     '00000000'                                 
              STRING F410-SCHEME '-'                                            
                     F410-ACC    '-'                                            
                     F410-CHK    '-'                                            
                     F410-LESSEE-CODE                                           
                     DELIMITED BY SIZE                                          
                     INTO L441B-NEW-SCHACC.                                     
                                                                                
           IF F410-DTE-KEY-ISSUE NOT = SPACES AND LOW-VALUES AND                
                                     '00000000'                                 
              STRING F410-DTE-KEY-ISSUE(7:2) '/'                                
                     F410-DTE-KEY-ISSUE(5:2) '/'                                
                     F410-DTE-KEY-ISSUE(1:4)                                    
                     DELIMITED BY SIZE                                          
                     INTO L441B-SO-DATE.                                        
                                                                                
           MOVE F410-AMT-PREMIUM-NEW TO WS-PREMIUM.                             
           MOVE WS-PREMIUM           TO L441B-PREMIUM.                          
                                                                                
           IF K470-NUM-HDB-REF NOT = SPACES AND LOW-VALUES                      
              STRING K470-NUM-HDB-REF(1:4) '-'                                  
                     K470-NUM-HDB-REF(5:4) '-'                                  
                     K470-NUM-HDB-REF(9:1) '-'                                  
                     K470-NUM-HDB-REF(10:2)                                     
                     DELIMITED BY SIZE                                          
                     INTO L441B-RESL-SCHACC.                                    
                                                                                
           MOVE  SPACES          TO   L441B-PRT-REC.                            
           WRITE L441B-PRT-REC   FROM L441B-DETAIL.                             
           MOVE  SPACES          TO   L441B-PRT-REC.                            
           WRITE L441B-PRT-REC   AFTER 1.                                       
           MOVE  SPACES          TO   L441B-DETAIL.                             
           ADD 02                TO   WS-L441B-LINE-NO.                         
           ADD 01                TO   WS-RESL-NOTFND.                           
           ADD 01                TO   WS-PRINTED.                               
                                                                                
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       4500-WRITE-BP13F470.                                                     
      *-------------------------------------------------------------            
           MOVE SPACES                    TO BP13F470-REC.                      
           INITIALIZE BP13F470-REC.                                             
                                                                                
           IF K800-NUM-DEFER-PREMIUM = 'Y'                                      
              MOVE K800-NUM-DEFER-PREMIUM  TO K470-NUM-DEFER-PREMIUM            
           ELSE                                                                 
              MOVE 'N'                     TO K470-NUM-DEFER-PREMIUM            
           END-IF.                                                              
                                                                                
           WRITE BP13F470-REC FROM BP13K470-REC.                                
           ADD 01 TO WS-F470-WRITE.                                             
                                                                                
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       4600-PRINT-STATUS-NOT-MTCH.                                              
      *-------------------------------------------------------------            
           MOVE SPACES                 TO L441C-PRT-REC.                        
                                                                                
           IF WS-L441C-LINE-NO > 35                                             
              PERFORM 5500-PRINT-L441C-HDG THRU  5500-EXIT                      
           END-IF.                                                              
                                                                                
           ADD  01                     TO  WS-L441C-SEQ.                        
           MOVE WS-L441C-SEQ           TO  L441C-SNO.                           
           MOVE F410-NUM-REGN          TO  L441C-REGN-NO.                       
           MOVE K470-NUM-NRIC          TO  L441C-UINFIN.                        
                                                                                
           IF K470-NUM-NRIC = K500-NUM-UIN-SELLER1                              
              MOVE K500-CDE-RESALE-STATUS     TO  L441C-RESL-STATUS             
           ELSE                                                                 
              IF K470-NUM-NRIC = K500-NUM-UIN-SELLER2                           
                 MOVE K500-CDE-RESALE-STATUS2 TO  L441C-RESL-STATUS             
              ELSE                                                              
                 MOVE SPACES                  TO  L441C-RESL-STATUS             
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F410-NUM-SCH-ACC NOT = SPACES AND LOW-VALUES AND                  
                                     '00000000'                                 
              STRING F410-SCHEME '-'                                            
                     F410-ACC '-'                                               
                     F410-CHK '-'                                               
                     F410-LESSEE-CODE                                           
                     DELIMITED BY SIZE                                          
                     INTO L441C-NEW-SCHACC.                                     
                                                                                
           IF F410-DTE-KEY-ISSUE NOT = SPACES AND LOW-VALUES AND                
                                     '00000000'                                 
              STRING F410-DTE-KEY-ISSUE(7:2) '/'                                
                     F410-DTE-KEY-ISSUE(5:2) '/'                                
                     F410-DTE-KEY-ISSUE(1:4)                                    
                     DELIMITED BY SIZE                                          
                     INTO L441C-SO-DATE.                                        
                                                                                
           MOVE  SPACES           TO   L441C-PRT-REC.                           
           WRITE L441C-PRT-REC    FROM L441C-DETAIL.                            
           MOVE  SPACES           TO   L441C-PRT-REC.                           
           WRITE L441C-PRT-REC    AFTER 1.                                      
           MOVE  SPACES           TO   L441C-DETAIL.                            
           ADD 02                 TO   WS-L441C-LINE-NO.                        
           ADD 01                 TO   WS-STAT-UNMTCH.                          
           ADD 01                 TO   WS-PRINTED.                              
                                                                                
       4600-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       4700-PRINT-STATUS-IN-PROGRESS.                                           
      *-------------------------------------------------------------            
           MOVE SPACES                 TO L441A-PRT-REC.                        
                                                                                
           IF WS-L441A-LINE-NO > 35                                             
              PERFORM 5300-PRINT-L441A-HDG THRU  5300-EXIT                      
           END-IF.                                                              
                                                                                
           ADD  01                     TO  WS-L441A-SEQ.                        
           MOVE WS-L441A-SEQ           TO  L441A-SNO.                           
           MOVE F410-NUM-REGN          TO  L441A-REGN-NO.                       
           MOVE K470-NUM-NRIC          TO  L441A-UINFIN.                        
                                                                                
           IF F410-NUM-SCH-ACC NOT = SPACES AND LOW-VALUES AND                  
                                     '00000000'                                 
              STRING F410-SCHEME '-'                                            
                     F410-ACC '-'                                               
                     F410-CHK '-'                                               
                     F410-LESSEE-CODE                                           
                     DELIMITED BY SIZE                                          
                     INTO L441A-NEW-SCHACC.                                     
                                                                                
           IF F410-DTE-KEY-ISSUE NOT = SPACES AND LOW-VALUES AND                
                                     '00000000'                                 
              STRING F410-DTE-KEY-ISSUE(7:2) '/'                                
                     F410-DTE-KEY-ISSUE(5:2) '/'                                
                     F410-DTE-KEY-ISSUE(1:4)                                    
                     DELIMITED BY SIZE                                          
                     INTO L441A-SO-DATE.                                        
                                                                                
           MOVE F410-AMT-PREMIUM-NEW TO WS-PREMIUM.                             
           MOVE WS-PREMIUM           TO L441A-PREMIUM.                          
                                                                                
           IF K470-NUM-HDB-REF NOT = SPACES AND LOW-VALUES                      
              STRING K470-NUM-HDB-REF(1:4) '-'                                  
                     K470-NUM-HDB-REF(5:4) '-'                                  
                     K470-NUM-HDB-REF(9:1) '-'                                  
                     K470-NUM-HDB-REF(10:2)                                     
                     DELIMITED BY SIZE                                          
                     INTO L441A-RESL-SCHACC.                                    
                                                                                
           IF K500-DTE-FIRST-APPTM NOT = SPACES AND LOW-VALUES AND              
                                     '00000000'                                 
              STRING K500-DTE-FIRST-APPTM(7:2) '/'                              
                     K500-DTE-FIRST-APPTM(5:2) '/'                              
                     K500-DTE-FIRST-APPTM(1:4)                                  
                     DELIMITED BY SIZE                                          
                     INTO L441A-1ST-APPT-DATE.                                  
                                                                                
           MOVE  SPACES           TO   L441A-PRT-REC.                           
           WRITE L441A-PRT-REC    FROM L441A-DETAIL.                            
           MOVE  SPACES           TO   L441A-PRT-REC.                           
           WRITE L441A-PRT-REC    AFTER 1.                                      
           MOVE  SPACES           TO   L441A-DETAIL.                            
           ADD 02                 TO   WS-L441A-LINE-NO.                        
           ADD 01                 TO   WS-STAT-PROGRESS.                        
           ADD 01                 TO   WS-PRINTED.                              
                                                                                
       4700-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       4800-PRINT-STATUS-UPDATED.                                               
      *-------------------------------------------------------------            
           MOVE SPACES TO L441-PRT-REC.                                         
           MOVE SPACES TO WS-RESL-STAT.                                         
                                                                                
           IF WS-LINE-NO > 35                                                   
              PERFORM 5200-PRINT-L441-HDG THRU  5200-EXIT                       
           END-IF.                                                              
                                                                                
           ADD   01                     TO  WS-L441-SEQ.                        
           MOVE  WS-L441-SEQ            TO  L441-SNO.                           
           MOVE  F410-NUM-REGN          TO  L441-REGN-NO.                       
           MOVE  K470-NUM-NRIC          TO  L441-UINFIN.                        
                                                                                
           IF K470-NUM-NRIC = K500-NUM-UIN-SELLER1                              
              MOVE K500-CDE-RESALE-STATUS     TO  L441-PREV-STATUS              
                                                  WS-RESL-STAT                  
           ELSE                                                                 
              IF K470-NUM-NRIC = K500-NUM-UIN-SELLER2                           
                 MOVE K500-CDE-RESALE-STATUS2 TO  L441-PREV-STATUS              
                                                  WS-RESL-STAT                  
              ELSE                                                              
                 MOVE SPACES                  TO  L441-PREV-STATUS              
                                                  WS-RESL-STAT                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 4900-PRINT-STATUS-TOBE-UPDATED THRU 4900-EXIT.               
                                                                                
           IF F410-NUM-SCH-ACC NOT = SPACES AND LOW-VALUES AND                  
                                     '00000000'                                 
              STRING F410-SCHEME '-'                                            
                     F410-ACC '-'                                               
                     F410-CHK '-'                                               
                     F410-LESSEE-CODE                                           
                     DELIMITED BY SIZE                                          
                     INTO L441-NEW-SCHACC.                                      
                                                                                
           IF F410-DTE-KEY-ISSUE NOT = SPACES AND LOW-VALUES AND                
                                     '00000000'                                 
              STRING F410-DTE-KEY-ISSUE(7:2) '/'                                
                     F410-DTE-KEY-ISSUE(5:2) '/'                                
                     F410-DTE-KEY-ISSUE(1:4)                                    
                     DELIMITED BY SIZE                                          
                     INTO L441-SO-DATE.                                         
                                                                                
           MOVE F410-AMT-PREMIUM-NEW TO WS-PREMIUM.                             
           MOVE WS-PREMIUM           TO L441-PREMIUM.                           
                                                                                
           IF K470-NUM-HDB-REF NOT = SPACES AND LOW-VALUES                      
           STRING K470-NUM-HDB-REF(1:4) '-'                                     
                  K470-NUM-HDB-REF(5:4) '-'                                     
                  K470-NUM-HDB-REF(9:1) '-'                                     
                  K470-NUM-HDB-REF(10:2)                                        
                  DELIMITED BY SIZE                                             
                  INTO L441-RESL-SCHACC.                                        
                                                                                
           IF K500-DTE-APPROVAL NOT = SPACES AND LOW-VALUES AND                 
                                     '00000000'                                 
              STRING K500-DTE-APPROVAL(7:2) '/'                                 
                     K500-DTE-APPROVAL(5:2) '/'                                 
                     K500-DTE-APPROVAL(1:4)                                     
                     DELIMITED BY SIZE                                          
                     INTO L441-APRV-DATE.                                       
                                                                                
           MOVE  SPACES           TO   L441-PRT-REC.                            
           WRITE L441-PRT-REC     FROM L441-DETAIL.                             
           MOVE  SPACES           TO   L441-PRT-REC.                            
           WRITE L441-PRT-REC     AFTER 1.                                      
           MOVE  SPACES           TO   L441-DETAIL.                             
           ADD   01               TO   WS-STAT-UPDATED.                         
           ADD   02               TO   WS-LINE-NO.                              
           ADD   01               TO   WS-PRINTED.                              
                                                                                
       4800-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *-------------------------------------------------------------            
       4900-PRINT-STATUS-TOBE-UPDATED.                                          
      *-------------------------------------------------------------            
           IF K800-NUM-ALLO-SCHEME = 'SFL' OR 'SRL'                             
              EVALUATE WS-RESL-STAT                                             
              WHEN 'SN'                                                         
                 MOVE 'ESF'       TO L441-RESL-STATUS                           
              WHEN 'LN'                                                         
                 MOVE 'ELF'       TO L441-RESL-STATUS                           
              WHEN OTHER                                                        
                 MOVE SPACES      TO L441-RESL-STATUS                           
              END-EVALUATE                                                      
           ELSE                                                                 
              IF K800-NUM-DEFER-PREMIUM = 'Y'                                   
                 EVALUATE WS-RESL-STAT                                          
                 WHEN 'SN'                                                      
                 WHEN 'BSN'                                                     
                    MOVE 'ESN'    TO L441-RESL-STATUS                           
                 WHEN 'LN'                                                      
                    MOVE 'ELP'    TO L441-RESL-STATUS                           
                 WHEN OTHER                                                     
                    MOVE SPACES   TO L441-RESL-STATUS                           
                 END-EVALUATE                                                   
              ELSE                                                              
                 EVALUATE WS-RESL-STAT                                          
                 WHEN 'SN'                                                      
                 WHEN 'BSN'                                                     
                    MOVE 'SP'     TO L441-RESL-STATUS                           
                 WHEN 'CN'                                                      
                    MOVE 'CP'     TO L441-RESL-STATUS                           
                 WHEN 'SAN'                                                     
                    MOVE 'SAP'    TO L441-RESL-STATUS                           
                 WHEN OTHER                                                     
                    MOVE SPACES   TO L441-RESL-STATUS                           
                 END-EVALUATE                                                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4900-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *-------------------------------------------------------------            
       4950-PRINT-SFL-SRL.                                                      
      *-------------------------------------------------------------            
           MOVE SPACES                 TO L441D-PRT-REC.                        
                                                                                
           IF WS-L441D-LINE-NO > 35                                             
              PERFORM 5600-PRINT-L441D-HDG THRU  5600-EXIT                      
           END-IF.                                                              
                                                                                
           ADD  01                     TO  WS-L441D-SEQ.                        
           MOVE WS-L441D-SEQ           TO  L441D-SNO.                           
           MOVE F410-NUM-REGN          TO  L441D-REGN-NO.                       
           MOVE F410-NRIC1             TO  L441D-UINFIN.                        
                                                                                
           IF F410-NUM-SCH-ACC NOT = SPACES AND ZEROES AND LOW-VALUES           
              STRING F410-SCHEME '-'                                            
                     F410-ACC    '-'                                            
                     F410-CHK    '-'                                            
                     F410-LESSEE-CODE                                           
                     DELIMITED BY SIZE INTO L441D-NEW-SCHACC                    
              END-STRING                                                        
           ELSE                                                                 
              MOVE SPACES              TO   L441D-NEW-SCHACC                    
           END-IF.                                                              
                                                                                
           IF F410-DTE-KEY-ISSUE NOT = SPACES AND ZEROES AND LOW-VALUES         
              STRING F410-DTE-KEY-ISSUE(7:2) '/'                                
                     F410-DTE-KEY-ISSUE(5:2) '/'                                
                     F410-DTE-KEY-ISSUE(1:4)                                    
                     DELIMITED BY SIZE INTO L441D-SO-DATE                       
              END-STRING                                                        
           ELSE                                                                 
              MOVE SPACES              TO   L441D-SO-DATE                       
           END-IF.                                                              
                                                                                
           MOVE  SPACES           TO   L441D-PRT-REC.                           
           WRITE L441D-PRT-REC    FROM L441D-DETAIL.                            
           MOVE  SPACES           TO   L441D-PRT-REC.                           
           WRITE L441D-PRT-REC    AFTER 1.                                      
           MOVE  SPACES           TO   L441D-DETAIL.                            
           ADD 02                 TO   WS-L441D-LINE-NO.                        
           ADD 01                 TO   WS-L441D-CNT.                            
           ADD 01                 TO   WS-PRINTED.                              
                                                                                
       4950-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       5100-PRINT-PAGE-HDGS.                                                    
      *-------------------------------------------------------------            
           PERFORM 5200-PRINT-L441-HDG  THRU 5200-EXIT.                         
           PERFORM 5300-PRINT-L441A-HDG THRU 5300-EXIT.                         
           PERFORM 5400-PRINT-L441B-HDG THRU 5400-EXIT.                         
           PERFORM 5500-PRINT-L441C-HDG THRU 5500-EXIT.                         
           PERFORM 5600-PRINT-L441D-HDG THRU 5600-EXIT.                         
                                                                                
       5100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *-------------------------------------------------------------            
       5200-PRINT-L441-HDG.                                                     
      *-------------------------------------------------------------            
           MOVE  ZEROES           TO    WS-LINE-NO.                             
           ADD   01               TO    WS-PAGE-NO.                             
           MOVE  WS-PAGE-NO       TO    L441-PAGE-NO.                           
           MOVE  WS-PRINT-DATE    TO    L441-PRT-DTE.                           
           WRITE L441-PRT-REC     FROM  L441-HDG1 AFTER PAGE.                   
           WRITE L441-PRT-REC     FROM  L441-HDG2.                              
           WRITE L441-PRT-REC     FROM  L441-HDG3.                              
           MOVE  SPACES           TO    L441-PRT-REC.                           
           WRITE L441-PRT-REC     AFTER 2.                                      
                                                                                
           WRITE L441-PRT-REC     FROM  L441-PARTA.                             
           MOVE  SPACES           TO    L441-PRT-REC.                           
           WRITE L441-PRT-REC     FROM  L441-HDG-PARTA-TO.                      
           MOVE  SPACES           TO    L441-PRT-REC.                           
           WRITE L441-PRT-REC     FROM  L441-HDG-PARTA-FROM.                    
           MOVE  SPACES           TO    L441-PRT-REC.                           
           WRITE L441-PRT-REC     AFTER 2.                                      
                                                                                
           MOVE  SPACES           TO    L441-PRT-REC.                           
           WRITE L441-PRT-REC     FROM  L441-HDG4A.                             
           MOVE  SPACES           TO    L441-PRT-REC.                           
           WRITE L441-PRT-REC     FROM  L441-HDG4.                              
           MOVE  SPACES           TO    L441-PRT-REC.                           
           WRITE L441-PRT-REC     FROM  L441-HDG5.                              
           MOVE  SPACES           TO    L441-PRT-REC.                           
           WRITE L441-PRT-REC     FROM  L441-HDG6.                              
           MOVE  SPACES           TO    L441-PRT-REC.                           
           WRITE L441-PRT-REC     FROM  L441-DASH.                              
           MOVE  SPACES           TO    L441-PRT-REC.                           
           WRITE L441-PRT-REC     AFTER 2.                                      
                                                                                
           ADD  17               TO     WS-LINE-NO.                             
                                                                                
       5200-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *-------------------------------------------------------------            
       5300-PRINT-L441A-HDG.                                                    
      *-------------------------------------------------------------            
           MOVE  ZEROES           TO    WS-L441A-LINE-NO.                       
           ADD   01               TO    WS-L441A-PAGE-NO.                       
           MOVE  WS-L441A-PAGE-NO TO    L441A-PAGE-NO.                          
           MOVE  WS-PRINT-DATE    TO    L441A-PRT-DTE.                          
           WRITE L441A-PRT-REC    FROM  L441A-HDG1 AFTER PAGE.                  
           WRITE L441A-PRT-REC    FROM  L441A-HDG2.                             
           WRITE L441A-PRT-REC    FROM  L441A-HDG3.                             
           MOVE  SPACES           TO    L441A-PRT-REC.                          
           WRITE L441A-PRT-REC    AFTER 2.                                      
                                                                                
           WRITE L441A-PRT-REC    FROM  L441-PARTA.                             
           MOVE  SPACES           TO    L441A-PRT-REC.                          
           WRITE L441A-PRT-REC    FROM  L441A-HDG-PARTA-TO.                     
           MOVE  SPACES           TO    L441A-PRT-REC.                          
           WRITE L441A-PRT-REC    FROM  L441-HDG-PARTA-FROM.                    
           MOVE  SPACES           TO    L441A-PRT-REC.                          
           WRITE L441A-PRT-REC    AFTER 2.                                      
                                                                                
           WRITE L441A-PRT-REC    FROM  L441A-HDG4.                             
           MOVE  SPACES           TO    L441A-PRT-REC.                          
           WRITE L441A-PRT-REC    FROM  L441A-HDG5.                             
           MOVE  SPACES           TO    L441A-PRT-REC.                          
           WRITE L441A-PRT-REC    FROM  L441A-HDG6.                             
           MOVE  SPACES           TO    L441A-PRT-REC.                          
           WRITE L441A-PRT-REC    FROM  L441-DASH.                              
           MOVE  SPACES           TO    L441A-PRT-REC.                          
           WRITE L441A-PRT-REC    AFTER 2.                                      
                                                                                
           ADD  16                TO    WS-L441A-LINE-NO.                       
                                                                                
       5300-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *-------------------------------------------------------------            
       5400-PRINT-L441B-HDG.                                                    
      *-------------------------------------------------------------            
           MOVE  ZEROES           TO    WS-L441B-LINE-NO.                       
           ADD   01               TO    WS-L441B-PAGE-NO.                       
           MOVE  WS-L441B-PAGE-NO TO    L441B-PAGE-NO.                          
           MOVE  WS-PRINT-DATE    TO    L441B-PRT-DTE.                          
           WRITE L441B-PRT-REC    FROM  L441B-HDG1 AFTER PAGE.                  
           WRITE L441B-PRT-REC    FROM  L441B-HDG2.                             
           MOVE  SPACES           TO    L441B-PRT-REC.                          
           WRITE L441B-PRT-REC    AFTER 2.                                      
                                                                                
           WRITE L441B-PRT-REC    FROM  L441-PARTA.                             
           MOVE  SPACES           TO    L441B-PRT-REC.                          
           WRITE L441B-PRT-REC    FROM  L441A-HDG-PARTA-TO.                     
           MOVE  SPACES           TO    L441B-PRT-REC.                          
           WRITE L441B-PRT-REC    FROM  L441-HDG-PARTA-FROM.                    
           MOVE  SPACES           TO    L441B-PRT-REC.                          
           WRITE L441B-PRT-REC    AFTER 2.                                      
                                                                                
           WRITE L441B-PRT-REC    FROM  L441B-HDG3.                             
           MOVE  SPACES           TO    L441B-PRT-REC.                          
           WRITE L441B-PRT-REC    FROM  L441B-HDG4.                             
           MOVE  SPACES           TO    L441B-PRT-REC.                          
           WRITE L441B-PRT-REC    FROM  L441B-HDG5.                             
           MOVE  SPACES           TO    L441B-PRT-REC.                          
           WRITE L441B-PRT-REC    FROM  L441-DASH.                              
           MOVE  SPACES           TO    L441B-PRT-REC.                          
           WRITE L441B-PRT-REC    AFTER 2.                                      
                                                                                
           ADD  15                TO    WS-L441B-LINE-NO.                       
                                                                                
       5400-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *-------------------------------------------------------------            
       5500-PRINT-L441C-HDG.                                                    
      *-------------------------------------------------------------            
           MOVE  ZEROES           TO    WS-L441C-LINE-NO.                       
           ADD   01               TO    WS-L441C-PAGE-NO.                       
           MOVE  WS-L441C-PAGE-NO TO    L441C-PAGE-NO.                          
           MOVE  WS-PRINT-DATE    TO    L441C-PRT-DTE.                          
           WRITE L441C-PRT-REC    FROM  L441C-HDG1 AFTER PAGE.                  
           WRITE L441C-PRT-REC    FROM  L441C-HDG2.                             
           WRITE L441C-PRT-REC    FROM  L441C-HDG3.                             
           MOVE  SPACES           TO    L441C-PRT-REC.                          
           WRITE L441C-PRT-REC    AFTER 2.                                      
                                                                                
           WRITE L441C-PRT-REC    FROM  L441C-HDG-PARTA-TO.                     
           MOVE  SPACES           TO    L441C-PRT-REC.                          
           WRITE L441C-PRT-REC    AFTER 2.                                      
                                                                                
           WRITE L441C-PRT-REC    FROM  L441C-HDG4.                             
           MOVE  SPACES           TO    L441C-PRT-REC.                          
           WRITE L441C-PRT-REC    FROM  L441C-HDG5.                             
           MOVE  SPACES           TO    L441C-PRT-REC.                          
           WRITE L441C-PRT-REC    FROM  L441-DASH.                              
           MOVE  SPACES           TO    L441C-PRT-REC.                          
           WRITE L441C-PRT-REC    AFTER 2.                                      
                                                                                
           ADD  11                TO    WS-L441C-LINE-NO.                       
                                                                                
       5500-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *-------------------------------------------------------------            
       5600-PRINT-L441D-HDG.                                                    
      *-------------------------------------------------------------            
           MOVE  ZEROES           TO    WS-L441D-LINE-NO.                       
           ADD   01               TO    WS-L441D-PAGE-NO.                       
           MOVE  WS-L441D-PAGE-NO TO    L441D-PAGE-NO.                          
           MOVE  WS-PRINT-DATE    TO    L441D-PRT-DTE.                          
           WRITE L441D-PRT-REC    FROM  L441D-HDG1 AFTER PAGE.                  
           WRITE L441D-PRT-REC    FROM  L441D-HDG2.                             
           MOVE  SPACES           TO    L441D-PRT-REC.                          
           WRITE L441D-PRT-REC    AFTER 2.                                      
                                                                                
           WRITE L441D-PRT-REC    FROM  L441D-HDG-PARTA-TO.                     
           MOVE  SPACES           TO    L441D-PRT-REC.                          
           WRITE L441D-PRT-REC    AFTER 2.                                      
                                                                                
           WRITE L441D-PRT-REC    FROM  L441D-HDG3.                             
           MOVE  SPACES           TO    L441D-PRT-REC.                          
           WRITE L441D-PRT-REC    FROM  L441D-HDG4.                             
           MOVE  SPACES           TO    L441D-PRT-REC.                          
           WRITE L441D-PRT-REC    FROM  L441D-HDG5.                             
           MOVE  SPACES           TO    L441D-PRT-REC.                          
           WRITE L441D-PRT-REC    FROM  L441-DASH.                              
           MOVE  SPACES           TO    L441D-PRT-REC.                          
           WRITE L441D-PRT-REC    AFTER 2.                                      
                                                                                
           ADD  11                TO    WS-L441D-LINE-NO.                       
                                                                                
       5600-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *-------------------------------------------------------------            
       8000-PRINT-CLOSING.                                                      
      *-------------------------------------------------------------            
           IF WS-STAT-UPDATED = ZEROES OR LOW-VALUES                            
              MOVE SPACES            TO    L441-PRT-REC                         
              WRITE L441-PRT-REC     FROM  L441-EMPTY                           
           END-IF.                                                              
                                                                                
           IF WS-STAT-PROGRESS = ZEROES OR LOW-VALUES                           
              MOVE SPACES            TO    L441A-PRT-REC                        
              WRITE L441A-PRT-REC    FROM  L441-EMPTY                           
           END-IF.                                                              
                                                                                
           IF WS-RESL-NOTFND   = ZEROES OR LOW-VALUES                           
              MOVE SPACES            TO    L441B-PRT-REC                        
              WRITE L441B-PRT-REC    FROM  L441-EMPTY                           
           END-IF.                                                              
                                                                                
           IF WS-STAT-UNMTCH   = ZEROES OR LOW-VALUES                           
              MOVE SPACES            TO    L441C-PRT-REC                        
              WRITE L441C-PRT-REC    FROM  L441-EMPTY                           
           END-IF.                                                              
                                                                                
           IF WS-L441D-CNT     = ZEROES OR LOW-VALUES                           
              MOVE SPACES            TO    L441D-PRT-REC                        
              WRITE L441D-PRT-REC    FROM  L441-EMPTY                           
           END-IF.                                                              
                                                                                
           PERFORM 8100-PRINT-L441-FOOTER  THRU 8100-EXIT.                      
           PERFORM 8200-PRINT-L441A-FOOTER THRU 8200-EXIT.                      
           PERFORM 8300-PRINT-L441B-FOOTER THRU 8300-EXIT.                      
                                                                                
       8000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *-------------------------------------------------------------            
       8100-PRINT-L441-FOOTER.                                                  
      *-------------------------------------------------------------            
      *** FOR BP13L441                                                          
           MOVE  SPACES           TO   L441-PRT-REC.                            
           WRITE L441-PRT-REC     FROM L441-DASH       AFTER 2.                 
           MOVE  SPACES           TO   L441-PRT-REC.                            
           WRITE L441-PRT-REC     FROM L441-FOOTER-ENC.                         
           MOVE  SPACES           TO   L441-PRT-REC.                            
           WRITE L441-PRT-REC     FROM L441-DASH2      AFTER 5.                 
           MOVE  SPACES           TO   L441-PRT-REC.                            
           WRITE L441-PRT-REC     FROM L441-FOOTER2.                            
           MOVE  SPACES           TO   L441-PRT-REC.                            
           WRITE L441-PRT-REC     FROM L441-FOOTER3.                            
           MOVE  SPACES           TO   L441-PRT-REC.                            
           WRITE L441-PRT-REC     FROM L441-DASH       AFTER 3.                 
           MOVE  SPACES           TO   L441-PRT-REC.                            
           WRITE L441-PRT-REC     FROM L441-PARTB.                              
           MOVE  SPACES           TO   L441-PRT-REC.                            
           WRITE L441-PRT-REC     FROM L441C-HDG-PARTA-TO.                      
           MOVE  SPACES           TO   L441-PRT-REC.                            
           WRITE L441-PRT-REC     FROM L441-DASH2      AFTER 5.                 
           MOVE  SPACES           TO   L441-PRT-REC.                            
           WRITE L441-PRT-REC     FROM L441-FOOTER4.                            
           MOVE  SPACES           TO   L441-PRT-REC.                            
           WRITE L441-PRT-REC     FROM L441-FOOTER5.                            
           MOVE  SPACES           TO   L441-PRT-REC.                            
           WRITE L441-PRT-REC     FROM L441-FOOTER6.                            
           MOVE  SPACES           TO   L441-PRT-REC.                            
           WRITE L441-PRT-REC     FROM L441-FOOTER7.                            
           MOVE  SPACES           TO   L441-PRT-REC.                            
           WRITE L441-PRT-REC     FROM L441-FOOTER8.                            
                                                                                
       8100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *-------------------------------------------------------------            
       8200-PRINT-L441A-FOOTER.                                                 
      *-------------------------------------------------------------            
      *** FOR P13L441A                                                          
           MOVE  SPACES           TO   L441A-PRT-REC.                           
           WRITE L441A-PRT-REC    FROM L441-DASH       AFTER 2.                 
           MOVE  SPACES           TO   L441A-PRT-REC.                           
           WRITE L441A-PRT-REC    FROM L441-FOOTER-ENC.                         
           MOVE  SPACES           TO   L441A-PRT-REC.                           
           WRITE L441A-PRT-REC    FROM L441-DASH2     AFTER 5.                  
           MOVE  SPACES           TO   L441A-PRT-REC.                           
           WRITE L441A-PRT-REC    FROM L441-FOOTER2.                            
           MOVE  SPACES           TO   L441A-PRT-REC.                           
           WRITE L441A-PRT-REC    FROM L441-FOOTER3.                            
           MOVE  SPACES           TO   L441A-PRT-REC.                           
           WRITE L441A-PRT-REC    FROM L441-DASH       AFTER 3.                 
           MOVE  SPACES           TO   L441A-PRT-REC.                           
           WRITE L441A-PRT-REC    FROM L441-PARTB.                              
           MOVE  SPACES           TO   L441A-PRT-REC.                           
           WRITE L441A-PRT-REC    FROM L441C-HDG-PARTA-TO.                      
           MOVE  SPACES           TO   L441A-PRT-REC.                           
           WRITE L441A-PRT-REC    FROM L441-DASH2      AFTER 5.                 
           MOVE  SPACES           TO   L441A-PRT-REC.                           
           WRITE L441A-PRT-REC    FROM L441-FOOTER4.                            
           MOVE  SPACES           TO   L441A-PRT-REC.                           
           WRITE L441A-PRT-REC    FROM L441-FOOTER6.                            
           MOVE  SPACES           TO   L441A-PRT-REC.                           
           WRITE L441A-PRT-REC    FROM L441-FOOTER7.                            
           MOVE  SPACES           TO   L441A-PRT-REC.                           
           WRITE L441A-PRT-REC    FROM L441-FOOTER8.                            
                                                                                
       8200-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *-------------------------------------------------------------            
       8300-PRINT-L441B-FOOTER.                                                 
      *-------------------------------------------------------------            
      *** FOR BP13L441B                                                         
           MOVE  SPACES           TO   L441-PRT-REC.                            
           WRITE L441B-PRT-REC    FROM L441-DASH       AFTER 2.                 
           MOVE  SPACES           TO   L441B-PRT-REC.                           
           WRITE L441B-PRT-REC    FROM L441-FOOTER-ENC.                         
           MOVE  SPACES           TO   L441B-PRT-REC.                           
           WRITE L441B-PRT-REC    FROM L441-DASH2     AFTER 4.                  
           MOVE  SPACES           TO   L441B-PRT-REC.                           
           WRITE L441B-PRT-REC    FROM L441-FOOTER2.                            
           MOVE  SPACES           TO   L441B-PRT-REC.                           
           WRITE L441B-PRT-REC    FROM L441-FOOTER3.                            
           MOVE  SPACES           TO   L441B-PRT-REC.                           
           WRITE L441B-PRT-REC    FROM L441-DASH       AFTER 3.                 
           MOVE  SPACES           TO   L441B-PRT-REC.                           
           WRITE L441B-PRT-REC    FROM L441-PARTB.                              
           MOVE  SPACES           TO   L441B-PRT-REC.                           
           WRITE L441B-PRT-REC    FROM L441C-HDG-PARTA-TO.                      
           MOVE  SPACES           TO   L441B-PRT-REC.                           
           WRITE L441B-PRT-REC    FROM L441-DASH2      AFTER 4.                 
           MOVE  SPACES           TO   L441B-PRT-REC.                           
           WRITE L441B-PRT-REC    FROM L441-FOOTER4.                            
           MOVE  SPACES           TO   L441B-PRT-REC.                           
           WRITE L441B-PRT-REC    FROM L441-FOOTER6.                            
           MOVE  SPACES           TO   L441B-PRT-REC.                           
           WRITE L441B-PRT-REC    FROM L441-FOOTER7.                            
           MOVE  SPACES           TO   L441B-PRT-REC.                           
           WRITE L441B-PRT-REC    FROM L441-FOOTER8.                            
                                                                                
       8300-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *-------------------------------------------------------------            
       9000-CLOSE-ROUTINE.                                                      
      *-------------------------------------------------------------            
            PERFORM 8000-PRINT-CLOSING  THRU 8000-EXIT.                         
                                                                                
            DISPLAY ' '.                                                        
            DISPLAY ' ***  BP13C441 CONTROL TOTALS  ***'.                       
            DISPLAY ' '.                                                        
            DISPLAY ' NO RECS  READ FROM BP13F410                    : '        
                                                     WS-CNT-F410.               
            DISPLAY ' NO RECS  SKIPPED FROM BP13F410 (PREM RATE = 00): '        
                                                     WS-SKIPPED.                
            DISPLAY ' NO F410  RECS NOTFND IN BP13K470               : '        
                                                     WS-K470-NOTFND             
            DISPLAY ' '.                                                        
            DISPLAY ' NO UINS  FOUND IN BP13K470                     : '        
                                                     WS-CNT-K470.               
            DISPLAY ' NO UINS  WITH PREMIUM TAG ACCEPTED             : '        
                                                     WS-PREM-ACC.               
            DISPLAY ' NO UINS  WITH PREMIUM TAG REMOVED              : '        
                                                     WS-PREM-DEL.               
            DISPLAY ' '.                                                        
            DISPLAY ' NO CASES WITH STATUS UPDATED                   : '        
                                                     WS-STAT-UPDATED.           
            DISPLAY ' NO CASES WITH STATUS IN PROGRESS               : '        
                                                     WS-STAT-PROGRESS.          
            DISPLAY ' NO CASES WITH STATUS NOT SN,BSN,CN AND LN      : '        
                                                     WS-STAT-UNMTCH.            
            DISPLAY ' NO CASES NOT FOUND IN RESALE HISTORY FILE      : '        
                                                     WS-RESL-NOTFND.            
            DISPLAY ' SFL/SRL CASES NOT FOUND IN PREMIUM FILE        : '        
                                                     WS-L441D-CNT.              
            DISPLAY ' NO CASES PRINTED                               : '        
                                                     WS-PRINTED.                
            DISPLAY ' NO CASES WRITTEN TO BP13F470                   : '        
                                                     WS-F470-WRITE.             
                                                                                
            CLOSE BP13F410                                                      
                  BP13K470                                                      
                  BP13K800                                                      
                  BB24K500                                                      
                  BP13L441                                                      
                  BP13F470                                                      
                  P13L441A                                                      
                  P13L441B                                                      
                  P13L441C                                                      
                  P13L441D.                                                     
                                                                                
            IF WS-K470-STATUS NOT = 00                                          
               DISPLAY 'CLOSING ERROR-BP13K470-STAT ' WS-K470-STATUS.           
            IF WS-K500-STATUS NOT = 00                                          
               DISPLAY 'CLOSING ERROR-BB24K500-STAT ' WS-K500-STATUS.           
            IF WS-K800-STATUS NOT = 00                                          
               DISPLAY 'CLOSING ERROR BP13K800-STAT ' WS-K800-STATUS.           
                                                                                
            STOP RUN.                                                           
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
