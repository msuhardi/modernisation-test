       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C23O.                                                 
      *AUTHOR.        ELAINE S ARGA.                                            
      *DATE-WRITTEN.  01 AUGUST 2017.                                           
      * ======================================================== *              
      * SYSTEM OF COMMITMENT (BP13)                              *              
      * ======================================================== *              
      *    OBJECTIVE  :                                          *              
      *      1.  PROGRAM TO WRITE LIST OF UNIT NO'S IN DIFFERENT *              
      *          BLOCKS AND STREETS FOR A GIVEN ZONE OR NEW TOWN.*              
      *                                                          *              
      *     INPUT FILES:                                         *              
      *           1. BP13K240                                    *              
      *           2. BP13K060                                    *              
      *           3. BM06K100                                    *              
      *           4. BB14K500                                    *              
      *           5. BB14K580                                    *              
      *           6. BP13F205                                    *              
      *           7. BM06K110                                    *              
      *           8. BP13K277                                    *              
      *                                                          *              
      *     I-O  FILES:                                          *              
      *           1. BM06F800                                    *              
      *                                                          *              
      *     OUTPUT FILES:                                        *              
      *           1. BP13F999                                    *              
      * -------------------------------------------------------- *              
      *  CHG NO     DATE     BY   DESCRIPTION                    *              
      * -------- ----------  ---- ------------------------------ *              
      * BP136836 01/08/2017  ESA1 NEW PROGRAM                    *              
      * BP137117 21/02/2018  ESA1 TO CATER FOR F999-NUM-FLAT-CODE*              
      *                           'FE' FOR EXPIRED POE-TAG       *              
      * BP137444 02/10/2018  ESA1 TO ADD SERLBSB COPYCOB FOR THE *              
      *                           NEW PRORATION CUT-OFF          *              
      * BP138228 24/03/2020  CC37 TO CATER FOR OBF               *              
      * BP139089 10/03/2022  EL27 READ K100 SHORT LEASE TAG FOR  *              
      *                           FORCING 2F TO SA               *              
      * BP139452 19/01/2023  MRR5 ADD MODL DESGN 75/76 FOR 2F    *              
      * BP139452 25/01/2023  MRR5 FIX PLACEMENT OF 75/76 CONDITION              
      * BP139531 14/03/2023  MRR5 CATER FOR 3-ROOM FSH           *              
      *                      SYNC UP EDPD WITH C224 TO ADD 15/18 MOS            
      * BP139531 20/03/2023  MRR5 DYNAMIC CALLING OF BP13C916    *              
      * BP139531 21/03/2023  MRR5 FIX EDPD DAY AND MONTH         *              
      * BP139531 23/03/2023  MRR5 REMOVE MODL DESGN 75 FOR 2F    *              
      * ======================================================== *              
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
           SELECT BP13K240 ASSIGN TO BP13K240                                   
                ORGANIZATION IS INDEXED                                         
                ACCESS MODE  IS RANDOM                                          
                RECORD KEY   IS K240-KEY-FLD                                    
                FILE STATUS  IS BP13K240-STATUS.                                
                                                                                
           SELECT BP13K060 ASSIGN TO BP13K060                                   
                ORGANIZATION IS INDEXED                                         
                ACCESS MODE  IS RANDOM                                          
                RECORD KEY   IS K060-KEY-FLD                                    
                FILE STATUS  IS BP13K060-STATUS.                                
                                                                                
           SELECT BP13K260 ASSIGN TO BP13K260                                   
                ORGANIZATION IS INDEXED                                         
                ACCESS MODE  IS RANDOM                                          
                RECORD KEY   IS K260-KEY-FLD                                    
                FILE STATUS  IS BP13K260-STATUS.                                
                                                                                
           SELECT BM06K100 ASSIGN TO BM06K100                                   
                ORGANIZATION IS INDEXED                                         
                ACCESS MODE  IS RANDOM                                          
                RECORD KEY   IS K100-KEY-FLD                                    
                FILE STATUS  IS BM06K100-STATUS.                                
                                                                                
           SELECT BM06K150 ASSIGN TO BM06K150                                   
                ORGANIZATION IS INDEXED                                         
                ACCESS MODE  IS RANDOM                                          
                RECORD KEY   IS K150-KEY-FLD                                    
                FILE STATUS  IS BM06K150-STATUS.                                
                                                                                
           SELECT BB14K500 ASSIGN TO BB14K500                                   
                ORGANIZATION IS INDEXED                                         
                ACCESS MODE  IS RANDOM                                          
                RECORD KEY   IS K500-KEY-FLD                                    
                FILE STATUS  IS BB14K500-STATUS.                                
                                                                                
           SELECT BB14K580 ASSIGN TO BB14K580                                   
                ORGANIZATION IS INDEXED                                         
                ACCESS MODE  IS RANDOM                                          
                RECORD KEY   IS K580-KEY-FLD                                    
                FILE STATUS  IS BB14K580-STATUS.                                
                                                                                
           SELECT BB14K990 ASSIGN TO BB14K990                                   
                ORGANIZATION IS INDEXED                                         
                ACCESS MODE  IS RANDOM                                          
                RECORD KEY   IS K990-KEY-FLD                                    
                FILE STATUS  IS BB14K990-STATUS.                                
                                                                                
           SELECT BM06K110 ASSIGN TO BM06K110                                   
                ORGANIZATION  IS INDEXED                                        
                ACCESS MODE   IS DYNAMIC                                        
                RECORD KEY    IS K110-SCH-ACC-NO                                
                ALTERNATE KEY IS K110-AIX1                                      
                FILE STATUS   IS BM06K110-STATUS.                               
                                                                                
           SELECT BP13K277 ASSIGN TO BP13K277                                   
                ORGANIZATION IS INDEXED                                         
                ACCESS MODE  IS RANDOM                                          
                RECORD KEY   IS K277-KEY-FLD                                    
                FILE STATUS  IS BP13K277-STATUS.                                
                                                                                
           SELECT BM06K510 ASSIGN TO BM06K510                                   
                ORGANIZATION IS INDEXED                                         
                ACCESS MODE  IS RANDOM                                          
                RECORD KEY   IS K510-ESTCDE                                     
                FILE STATUS  IS BM06K510-STATUS.                                
                                                                                
           SELECT BP13F205 ASSIGN TO BP13F205.                                  
           SELECT BM06F800 ASSIGN TO BM06F800.                                  
           SELECT BP13F999 ASSIGN TO BP13F999.                                  
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD   BP13K240                 RECORD CONTAINS 450 CHARACTERS.            
       COPY BP13K240.                                                           
                                                                                
       FD   BP13K060                 RECORD CONTAINS 25 CHARACTERS.             
       COPY BP13K060.                                                           
                                                                                
       FD   BP13K260                 RECORD CONTAINS 100 CHARACTERS.            
       COPY BP13K260.                                                           
                                                                                
       FD   BB14K500                 RECORD CONTAINS 400 CHARACTERS.            
       COPY BB14K500.                                                           
                                                                                
       FD   BB14K580                 RECORD CONTAINS 300 CHARACTERS.            
       COPY BB14K580.                                                           
                                                                                
       FD   BB14K990                 RECORD CONTAINS 200 CHARACTERS.            
       COPY BB14K990.                                                           
                                                                                
       FD   BM06K100                 RECORD CONTAINS 500 CHARACTERS.            
       COPY BM06K100.                                                           
                                                                                
       FD   BM06K150                 RECORD CONTAINS 300 CHARACTERS.            
       COPY BM06K150.                                                           
                                                                                
       FD   BM06K110                 RECORD CONTAINS 500 CHARACTERS.            
       COPY BM06K110.                                                           
                                                                                
       FD   BP13K277                 RECORD CONTAINS 500 CHARACTERS.            
       COPY BP13K277.                                                           
                                                                                
       FD   BM06K510                 RECORD CONTAINS 60 CHARACTERS.             
       COPY BM06K510.                                                           
                                                                                
       FD   BP13F205                                                            
            BLOCK  CONTAINS 0   RECORDS                                         
            LABEL  RECORDS  ARE STANDARD                                        
            RECORDING MODE IS F                                                 
            RECORD CONTAINS 80  CHARACTERS.                                     
       COPY BP13F205.                                                           
                                                                                
       FD  BM06F800                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 800 CHARACTERS                                       
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F.                                                 
       COPY BM06F800.                                                           
                                                                                
       FD  BP13F999                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 300 CHARACTERS                                       
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F.                                                 
       COPY BP13F999.                                                           
                                                                                
       WORKING-STORAGE SECTION.                                                 
       01  WS-FILE-STATUS.                                                      
           05  BP13K240-STATUS              PIC 9(02)  VALUE ZEROS.             
           05  BP13K060-STATUS              PIC 9(02)  VALUE ZEROS.             
           05  BP13K260-STATUS              PIC 9(02)  VALUE ZEROS.             
           05  BM06K100-STATUS              PIC 9(02)  VALUE ZEROS.             
           05  BM06K150-STATUS              PIC 9(02)  VALUE ZEROS.             
           05  BM06K510-STATUS              PIC 9(02)  VALUE ZEROS.             
           05  BB14K500-STATUS              PIC 9(02)  VALUE ZEROS.             
           05  BB14K580-STATUS              PIC 9(02)  VALUE ZEROS.             
           05  BB14K990-STATUS              PIC 9(02)  VALUE ZEROS.             
           05  BM06K110-STATUS              PIC 9(02)  VALUE ZEROS.             
           05  BP13K277-STATUS              PIC 9(02)  VALUE ZEROS.             
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-F800-READ                 PIC 9(08)  VALUE ZEROS.             
           05  WS-F205-READ                 PIC 9(08)  VALUE ZEROS.             
           05  WS-K240-READ                 PIC 9(08)  VALUE ZEROS.             
           05  WS-K500-READ                 PIC 9(08)  VALUE ZEROS.             
           05  WS-K580-READ                 PIC 9(08)  VALUE ZEROS.             
           05  WS-K990-READ                 PIC 9(08)  VALUE ZEROS.             
           05  WS-K100-READ                 PIC 9(08)  VALUE ZEROS.             
           05  WS-K110-READ                 PIC 9(08)  VALUE ZEROS.             
           05  WS-BM06K110-READ             PIC 9(08)  VALUE ZEROS.             
           05  WS-K277-READ                 PIC 9(08)  VALUE ZEROS.             
           05  WS-F999-WRITE                PIC 9(08)  VALUE ZEROS.             
           05  WS-F800-WRITE                PIC 9(08)  VALUE ZEROS.             
           05  WS-K100-NFND                 PIC 9(08)  VALUE ZEROS.             
           05  WS-K240-NFND                 PIC 9(08)  VALUE ZEROS.             
           05  WS-K500-NFND                 PIC 9(08)  VALUE ZEROS.             
           05  WS-K580-NFND                 PIC 9(08)  VALUE ZEROS.             
           05  WS-K990-NFND                 PIC 9(08)  VALUE ZEROS.             
           05  WS-K060-NFND                 PIC 9(08)  VALUE ZEROS.             
           05  WS-K260-NFND                 PIC 9(08)  VALUE ZEROS.             
           05  WS-K110-NFND                 PIC 9(08)  VALUE ZEROS.             
           05  WS-BM06K110-NFND             PIC 9(08)  VALUE ZEROS.             
           05  WS-K277-NFND                 PIC 9(08)  VALUE ZEROS.             
                                                                                
       01  WS-FILE-VARIABLES.                                                   
           05 WS-K500-DTE-EST-CMPL          PIC X(08)  VALUE SPACES.            
           05 WS-K500-DTE-LSE-COMM          PIC X(08)  VALUE SPACES.            
           05 WS-K500-LEASE-PERIOD-FLAT     PIC 9(02)  VALUE ZEROES.            
           05 WS-K100-CDE-BLK               PIC X(05)  VALUE SPACES.            
           05 WS-K110-DTE-KEY-AVBL          PIC X(08)  VALUE SPACES.            
           05 WS-K100-DTE-OCS               PIC X(08)  VALUE SPACES.            
           05 WS-K100-DTE-POD-DUE           PIC X(08)  VALUE SPACES.            
           05 WS-K100-DTE-POF-DUE           PIC X(08)  VALUE SPACES.            
           05 WS-K100-DTE-POW-DUE           PIC X(08)  VALUE SPACES.            
           05 WS-K100-DTE-PACD              PIC X(08)  VALUE SPACES.            
                                                                                
       01  WS-VARIABLES.                                                        
           05 WS-FLAT-TYPE                  PIC X(02)  VALUE SPACES.            
           05 WS-NT-ESTATE                  PIC X(27)  VALUE SPACES.            
           05 WS-NOT-MATCHED                PIC 9(08)  VALUE ZEROES.            
           05 WS-MATCH                      PIC X(01)  VALUE SPACES.            
           05 WS-K060-FND                   PIC X(01)  VALUE SPACES.            
           05 WS-CURRENT-DTE                PIC 9(08)  VALUE ZEROES.            
           05 WS-DIFF-LSE-COMM              PIC S9(08) VALUE ZEROES.            
           05 WS-DIFF-OCS                   PIC S9(08) VALUE ZEROES.            
           05 WS-DIFF-POD                   PIC S9(08) VALUE ZEROES.            
           05 WS-TMP-DTE-LSE-COMM           PIC 9(08)  VALUE ZEROES.            
           05 WS-TMP-DTE-OCS                PIC 9(08)  VALUE ZEROES.            
           05 WS-TMP-DTE-POD-DUE            PIC 9(08)  VALUE ZEROES.            
           05 WS-TMP-DATE                   PIC 9(08)  VALUE ZEROES.            
           05 WS-CURR-DATE                  PIC 9(08)  VALUE ZEROES.            
           05 WS-QTR                        PIC X(02)  VALUE SPACES.            
           05 WS-NUM-WARD                   PIC X(03)  VALUE SPACES.            
           05 WS-NUM-FLAT-TYPE              PIC X(02)  VALUE SPACES.            
           05 WS-NT-NAME                    PIC X(20)  VALUE SPACES.            
           05 WS-NUM-MAX-CAT1               PIC 9(03)  VALUE ZEROES.            
           05 WS-NUM-MAX-CAT2               PIC 9(03)  VALUE ZEROES.            
           05 WS-NUM-MAX-CAT3               PIC 9(03)  VALUE ZEROES.            
           05 WS-NUM-MAX-SPR                PIC 9(03)  VALUE ZEROES.            
           05 WS-NUM-MAX-CAT-DEC            PIC 9(03)V99 VALUE ZEROES.          
           05 WS-NUM-MAX-CAT-REDEF REDEFINES WS-NUM-MAX-CAT-DEC.                
              10  WS-NUM-MAX-CAT            PIC 9(03).                          
              10  WS-NUM-MAX-CAT-REM        PIC 9(02).                          
           05 WS-EDT-TMP                    PIC Z(7)9.                          
           05 WS-DEL-POSSN-DATE.                                                
              10  WS-DEL-POSSN-YYYY         PIC X(4).                           
              10  WS-DEL-POSSN-MM           PIC X(2).                           
              10  WS-DEL-POSSN-DD           PIC X(2).                           
           05  WS-8-DATE-CHAR               PIC X(8).                           
           05  WS-8-DATE  REDEFINES WS-8-DATE-CHAR.                             
               10  WS-8-DATE-YYYY           PIC 9(4).                           
               10  WS-8-DATE-MM             PIC 9(2).                           
               10  WS-8-DATE-DD             PIC 9(2).                           
           05  WS-DAY                       PIC X(2).                           
           05  WS-MONTH                     PIC X(2).                           
               88  MTH-END-WITH-30    VALUE '04' '06' '09' '11'.                
               88  MTH-END-WITH-28    VALUE '02'.                               
           05  WS-ROUND-SELLPR              PIC 9(6)     VALUE ZEROS.           
           05  WS-PCT                       PIC 9(2)V999 VALUE ZEROES.          
           05 WS-SELLING-PRICE              PIC 9(06)V99 VALUE ZEROES.          
           05 WS-POW-TAG                    PIC X(01)    VALUE 'N'.             
           05 WS-BP13C916                   PIC X(8) VALUE 'BP13C916'.          
                                                                                
       01  WS-FILE-FLAGS.                                                       
           05  WS-F800-FLAG                 PIC X(01)  VALUE 'N'.               
               88 WS-F800-EOF                          VALUE 'Y'.               
           05  WS-F205-FLAG                 PIC X(01)  VALUE 'N'.               
               88 WS-F205-EOF                          VALUE 'Y'.               
           05  WS-K110-FLAG                 PIC X(01)  VALUE 'N'.               
               88 WS-K110-EOF                          VALUE 'Y'.               
           05  WS-K260-FND                  PIC X(01)  VALUE 'N'.               
                                                                                
       01  WS-EDT-DATE.                                                         
           05  WS-EDT-DD                    PIC 9(02).                          
           05  FILLER                       PIC X      VALUE '/'.               
           05  WS-EDT-MM                    PIC 9(02).                          
           05  FILLER                       PIC X      VALUE '/'.               
           05  WS-EDT-CCYY                  PIC 9(04).                          
                                                                                
       01  WS-CUR-DATE.                                                         
           05  WS-CUR-CCYY                  PIC 9(04).                          
           05  WS-CUR-MM                    PIC 9(02).                          
           05  WS-CUR-DD                    PIC 9(02).                          
                                                                                
       01  WS-LCOMM-DTE.                                                        
           05  WS-LCOMM-YYYY                 PIC 9(4).                          
           05  WS-LCOMM-MM                   PIC 9(2).                          
           05  WS-LCOMM-DD                   PIC 9(2).                          
                                                                                
       01  WS-YEAR-COMM                      PIC 99.                            
       01  WS-MONTH-COMM                     PIC 99.                            
                                                                                
       COPY SERLBS.                                                             
       COPY SERLBSB.                                                            
       COPY M06COM31.                                                           
                                                                                
      *---------------------------------------------------------------*         
      *        LINKAGE FOR BP13C916                                   *         
      *---------------------------------------------------------------*         
       01  WS-LINK-REC.                                                         
           05  WS-LINK-BLDNG-GL             PIC X(5).                           
                                                                                
       01  WS-BP13C916-REC.                                                     
           05  C916-NME-LOCAL-PRCNCT        PIC X(40).                          
           05  C916-CDE-SYSERR              PIC S9(3).                          
           05  C916-CDE-ERROR               PIC X(5).                           
                                                                                
       PROCEDURE DIVISION.                                                      
      *-----------------------------------------------------------              
       000-MAIN-ROUTINE.                                                        
      *-----------------------------------------------------------              
           PERFORM 100-OPEN-FILES  THRU 100-EXIT.                               
           PERFORM 200-READ-CTL    THRU 200-EXIT.                               
           PERFORM 300-PROCESS-REC THRU 300-EXIT                                
                   UNTIL WS-F800-EOF.                                           
                                                                                
           PERFORM 999-CLOSE-ROUTINE THRU 999-EXIT.                             
                                                                                
       000-EXIT.                                                                
           EXIT.                                                                
                                                                                
       100-OPEN-FILES.                                                          
      *-----------------------------------------------------------              
           OPEN INPUT  BP13F205                                                 
                       BP13K240                                                 
                       BP13K060                                                 
                       BP13K260                                                 
                       BM06K100                                                 
                       BM06K150                                                 
                       BM06K510                                                 
                       BB14K500                                                 
                       BB14K580                                                 
                       BB14K990                                                 
                       BM06K110                                                 
                       BP13K277                                                 
                I-O    BM06F800                                                 
                OUTPUT BP13F999.                                                
                                                                                
           IF BP13K240-STATUS NOT = ZEROS AND 97                                
              DISPLAY 'OPEN ERROR, BP13K240 STATUS ' BP13K240-STATUS            
              MOVE BP13K240-STATUS TO RETURN-CODE                               
              PERFORM 999-CLOSE-ROUTINE THRU 999-EXIT                           
           END-IF.                                                              
                                                                                
           IF BP13K060-STATUS NOT = ZEROS AND 97                                
              DISPLAY 'OPEN ERROR, BP13K060 STATUS ' BP13K060-STATUS            
              MOVE BP13K060-STATUS TO RETURN-CODE                               
              PERFORM 999-CLOSE-ROUTINE THRU 999-EXIT                           
           END-IF.                                                              
                                                                                
           IF BP13K260-STATUS NOT = ZEROS AND 97                                
              DISPLAY 'OPEN ERROR, BP13K260 STATUS ' BP13K260-STATUS            
              MOVE BP13K260-STATUS TO RETURN-CODE                               
              PERFORM 999-CLOSE-ROUTINE THRU 999-EXIT                           
           END-IF.                                                              
                                                                                
           IF BM06K100-STATUS NOT = ZEROS AND 97                                
              DISPLAY 'OPEN ERROR, BM06K100 STATUS ' BM06K100-STATUS            
              MOVE BM06K100-STATUS TO RETURN-CODE                               
              PERFORM 999-CLOSE-ROUTINE THRU 999-EXIT                           
           END-IF.                                                              
                                                                                
           IF BM06K150-STATUS NOT = ZEROS AND 97                                
              DISPLAY 'OPEN ERROR, BM06K150 STATUS ' BM06K150-STATUS            
              MOVE BM06K150-STATUS TO RETURN-CODE                               
              PERFORM 999-CLOSE-ROUTINE THRU 999-EXIT                           
           END-IF.                                                              
                                                                                
           IF BM06K510-STATUS NOT = ZEROS AND 97                                
              DISPLAY 'OPEN ERROR, BM06K510 STATUS ' BM06K510-STATUS            
              MOVE BM06K510-STATUS TO RETURN-CODE                               
              PERFORM 999-CLOSE-ROUTINE THRU 999-EXIT                           
           END-IF.                                                              
                                                                                
           IF BB14K500-STATUS NOT = ZEROS AND 97                                
              DISPLAY 'OPEN ERROR, BB14K500 STATUS ' BB14K500-STATUS            
              MOVE BB14K500-STATUS TO RETURN-CODE                               
              PERFORM 999-CLOSE-ROUTINE THRU 999-EXIT                           
           END-IF.                                                              
                                                                                
           IF BB14K580-STATUS NOT = ZEROS AND 97                                
              DISPLAY 'OPEN ERROR, BB14K580 STATUS ' BB14K580-STATUS            
              MOVE BB14K580-STATUS TO RETURN-CODE                               
              PERFORM 999-CLOSE-ROUTINE THRU 999-EXIT                           
           END-IF.                                                              
                                                                                
           IF BB14K990-STATUS NOT = ZEROS AND 97                                
              DISPLAY 'OPEN ERROR, BB14K990 STATUS ' BB14K990-STATUS            
              MOVE BB14K990-STATUS TO RETURN-CODE                               
              PERFORM 999-CLOSE-ROUTINE THRU 999-EXIT                           
           END-IF.                                                              
                                                                                
           IF BM06K110-STATUS NOT = ZEROS AND 97                                
              DISPLAY 'OPEN ERROR, BM06K110 STATUS ' BM06K110-STATUS            
              MOVE BM06K110-STATUS TO RETURN-CODE                               
              PERFORM 999-CLOSE-ROUTINE THRU 999-EXIT                           
           END-IF.                                                              
                                                                                
           IF BP13K277-STATUS NOT = ZEROS AND 97                                
              DISPLAY 'OPEN ERROR, BP13K277 STATUS ' BP13K277-STATUS            
              MOVE BP13K277-STATUS TO RETURN-CODE                               
              PERFORM 999-CLOSE-ROUTINE THRU 999-EXIT                           
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE TO WS-CUR-DATE.                           
           MOVE WS-CUR-CCYY           TO WS-EDT-CCYY.                           
           MOVE WS-CUR-MM             TO WS-EDT-MM.                             
           MOVE WS-CUR-DD             TO WS-EDT-DD.                             
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
       200-READ-CTL.                                                            
      *-----------------------------------------------------------              
           READ BP13F205 AT END                                                 
                MOVE 'Y' TO WS-F205-FLAG                                        
                GO TO 200-EXIT.                                                 
                                                                                
           ADD 1 TO WS-F205-READ.                                               
                                                                                
           IF F205-NUM-FORM-TYPE = 'D' OR 'F' OR 'S'                            
              MOVE 22       TO RETURN-CODE                                      
           END-IF.                                                              
                                                                                
           IF F205-NUM-FORM-TYPE = 'C' AND                                      
              F205-NUM-FLAT-TYPE = '4P' OR '5P'                                 
              MOVE 22       TO RETURN-CODE                                      
           END-IF.                                                              
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
       300-PROCESS-REC.                                                         
      *-----------------------------------------------------------              
                                                                                
           MOVE SPACES                   TO WS-FILE-VARIABLES                   
                                            BP13F999-RECORD.                    
           INITIALIZE                       BP13F999-RECORD.                    
                                                                                
           PERFORM 400-BM06F800-READ     THRU 400-EXIT.                         
           IF WS-F800-EOF                                                       
              GO TO 300-EXIT                                                    
           END-IF.                                                              
                                                                                
           IF (F800-DTE-ACCEPTANCE = ZEROS OR SPACES OR LOW-VALUES) AND         
              (F800-DTE-KEY-ISSUED = ZEROS OR SPACES OR LOW-VALUES)             
              CONTINUE                                                          
           ELSE                                                                 
              ADD  1       TO WS-NOT-MATCHED                                    
              GO TO 300-EXIT                                                    
           END-IF.                                                              
                                                                                
           IF F205-CDE-SINGLES = 'B'                                            
              IF F800-ALLOCN-TAG = 'BFS'                                        
                 CONTINUE                                                       
              ELSE                                                              
                 ADD  1       TO WS-NOT-MATCHED                                 
                 GO TO 300-EXIT                                                 
              END-IF                                                            
           ELSE                                                                 
              IF F205-CDE-SINGLES = 'Y'                                         
                 IF F800-ALLOCN-TAG NOT = 'BFS'                                 
                    CONTINUE                                                    
                 ELSE                                                           
                    ADD  1       TO WS-NOT-MATCHED                              
                    GO TO 300-EXIT                                              
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *** DECODE FLAT TYPE AND VALIDATE ZONE                                    
           PERFORM 440-DECODE-FLAT-TYPE  THRU 440-EXIT.                         
           IF F800-CDE-MODL-DESG  = '96' OR '97' OR '98'                        
              MOVE '2F'               TO F999-NUM-FLAT-TYPE                     
           ELSE                                                                 
              MOVE WS-FLAT-TYPE       TO F999-NUM-FLAT-TYPE                     
           END-IF.                                                              
                                                                                
           IF F205-NUM-GEN3 = 'Y'                                               
              IF (F800-CDE-TYP-ACTUSE = '05') AND                               
                 (F800-CDE-MODL-DESG  = '90' OR '91' OR '95')                   
                 CONTINUE                                                       
              ELSE                                                              
                 ADD  1       TO WS-NOT-MATCHED                                 
                 GO TO 300-EXIT                                                 
              END-IF                                                            
           ELSE                                                                 
              IF F205-NUM-GEN3 = 'N'                                            
                 IF (F800-CDE-TYP-ACTUSE = '05') AND                            
                    (F800-CDE-MODL-DESG  = '90' OR '91' OR '95')                
                    ADD  1       TO WS-NOT-MATCHED                              
                    GO TO 300-EXIT                                              
                 ELSE                                                           
                    CONTINUE                                                    
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 410-PROCESS-F800       THRU 410-EXIT.                        
           PERFORM 450-BM06K100-READ      THRU 450-EXIT.                        
           PERFORM 420-BP13K240-READ      THRU 420-EXIT.                        
           PERFORM 735-BM06K110-START     THRU 735-EXIT.                        
           PERFORM 460-BB14K500-READ      THRU 460-EXIT.                        
           PERFORM 700-REWRITE-BM06F800   THRU 700-EXIT.                        
                                                                                
           IF F205-NUM-FORM-TYPE = 'S'                                          
              PERFORM 860-LINK-BM06CCFL     THRU 860-EXIT                       
              IF COM31-AMT-PRICE-OFFER-45-FSH > ZEROES OR                       
                 COM31-AMT-PRICE-OFFER-50-FSH > ZEROES OR                       
                 COM31-AMT-PRICE-OFFER-55-FSH > ZEROES OR                       
                 COM31-AMT-PRICE-OFFER-60-FSH > ZEROES OR                       
                 COM31-AMT-PRICE-OFFER-65-FSH > ZEROES                          
                 PERFORM 750-WRITE-BP13F999    THRU 750-EXIT                    
              END-IF                                                            
           ELSE                                                                 
              PERFORM 750-WRITE-BP13F999    THRU 750-EXIT                       
           END-IF.                                                              
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
                                                                                
       400-BM06F800-READ.                                                       
      *-----------------------------------------------------------              
           READ BM06F800 AT END                                                 
                MOVE 'Y' TO WS-F800-FLAG                                        
                GO TO 400-EXIT.                                                 
                                                                                
           ADD 1 TO WS-F800-READ.                                               
                                                                                
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
       410-PROCESS-F800.                                                        
      *-----------------------------------------------------------              
           MOVE SPACES                 TO   K060-KEY-FLD                        
                                            WS-NT-ESTATE.                       
           MOVE '02'                   TO   K060-SERIAL-NO.                     
           MOVE F800-CDE-NT            TO   K060-CODE.                          
                                                                                
           PERFORM 600-BP13K060-READ   THRU 600-EXIT.                           
                                                                                
           IF WS-K060-FND = 'Y'                                                 
              MOVE K060-DESC              TO   F999-NME-ESTATE                  
              MOVE F800-CDE-NT            TO   F999-CDE-NT                      
           ELSE                                                                 
              MOVE SPACES                 TO   F999-NME-ESTATE                  
                                               F999-CDE-NT                      
           END-IF.                                                              
                                                                                
           MOVE F800-CDE-ZONE       TO   F999-NUM-ZONE.                         
                                                                                
           IF F205-NUM-NT-ZONE-SW = 'T'                                         
              MOVE SPACES                 TO   F999-NUM-ZONE                    
           END-IF.                                                              
                                                                                
           IF F205-CDE-SINGLES = 'B'                                            
              MOVE F205-CDE-SINGLES TO  F999-NUM-GRO                            
           ELSE                                                                 
              MOVE SPACE            TO  F999-NUM-GRO                            
           END-IF.                                                              
                                                                                
           MOVE F205-NUM-GEN3             TO   F999-NUM-GEN3.                   
           MOVE F800-NUM-SITE             TO   F999-NUM-SITE.                   
           MOVE F800-CDE-MODL-DESG        TO   F999-NUM-MODL-DESG.              
           MOVE F800-DTE-ALLOCN           TO   F999-DTE-ALLOC.                  
           MOVE F800-SCH-ACC-NO           TO   F999-NUM-HDB-REF.                
           MOVE F800-CDE-SELTY            TO   F999-NUM-SELTY.                  
           MOVE F800-NUM-6MTH-OTP         TO   F999-NUM-6MTH-OTP.               
           MOVE F800-DTE-BALLOT           TO   F999-DTE-BALLOT.                 
           MOVE F800-CDE-FLEXI            TO   F999-CDE-FLEXI-TAG.              
           MOVE F800-CDE-POF-TAG          TO   F999-CDE-POF-TAG.                
           MOVE F800-NUM-UPG-STATUS       TO   F999-NUM-UPG-STATUS.             
                                                                                
      ********************************************                              
      * TO HARDCODE 1PA TO CATER FOR EST CODE 943*                              
      ********************************************                              
           IF  (F800-CDE-TYP-ACTUSE = '03') OR                                  
              ((F800-CDE-TYP-ACTUSE = '02') AND                                 
               (F800-CDE-MODL-DESG NOT = '80' AND '89'))                        
              IF (F800-FLAT-STATUS = 'NW' OR 'CV' ) OR                          
                 (F800-DTE-HANDOVER >= '20000101')                              
                 IF F800-CDE-MODL-DESG = '81' OR '82' OR '83' OR '84'           
                                          OR '86' OR '87' OR '88'               
                    MOVE '1PA '          TO F999-CDE-MODL-DESG                  
                                            F999-NUM-CNTRCT-TYP                 
                 ELSE                                                           
                    IF F800-CDE-MODL-DESG = '34' OR '70' OR '71' OR             
                                            '72' OR '73'                        
                       MOVE '2DBP'       TO F999-CDE-MODL-DESG                  
                                            F999-NUM-CNTRCT-TYP                 
                    ELSE                                                        
                       IF F205-NUM-FLAT-TYPE = '4P' OR '5P'                     
                          MOVE '1PA '          TO F999-CDE-MODL-DESG            
                                                  F999-NUM-CNTRCT-TYP           
                       ELSE                                                     
                          IF F800-ESTATE = '943'                                
                             MOVE '1PA '       TO F999-CDE-MODL-DESG            
                                                  F999-NUM-CNTRCT-TYP           
                          ELSE                                                  
                             MOVE '3STD'       TO F999-CDE-MODL-DESG            
                                                  F999-NUM-CNTRCT-TYP           
                          END-IF                                                
                       END-IF                                                   
                   END-IF                                                       
                 END-IF                                                         
              ELSE                                                              
                 IF F800-CDE-TYP-ACTUSE = '02'                                  
                    EVALUATE F800-CDE-MODL-DESG                                 
                       WHEN '03'                                                
                       WHEN '13'                                                
                       WHEN '15'                                                
                       WHEN '21'                                                
                       WHEN '30'                                                
                       WHEN '37'                                                
                          MOVE '1IMP'   TO F999-CDE-MODL-DESG                   
                                           F999-NUM-CNTRCT-TYP                  
                       WHEN '96'                                                
                       WHEN '97'                                                
                       WHEN '98'                                                
                          MOVE '3STD'   TO F999-CDE-MODL-DESG                   
                                           F999-NUM-CNTRCT-TYP                  
                       WHEN OTHER                                               
                          MOVE '1STD'   TO F999-CDE-MODL-DESG                   
                                           F999-NUM-CNTRCT-TYP                  
                    END-EVALUATE                                                
                 END-IF                                                         
                 IF F800-CDE-TYP-ACTUSE = '03'                                  
                    EVALUATE F800-CDE-MODL-DESG                                 
                       WHEN '02'                                                
                       WHEN '20'                                                
                          MOVE '4STD'   TO F999-CDE-MODL-DESG                   
                                           F999-NUM-CNTRCT-TYP                  
                       WHEN '03'                                                
                       WHEN '13'                                                
                       WHEN '15'                                                
                       WHEN '21'                                                
                       WHEN '30'                                                
                       WHEN '37'                                                
                          MOVE '1IMP'   TO F999-CDE-MODL-DESG                   
                                           F999-NUM-CNTRCT-TYP                  
                       WHEN '04'                                                
                       WHEN '16'                                                
                       WHEN '17'                                                
                       WHEN '23'                                                
                          MOVE '3NG'    TO F999-CDE-MODL-DESG                   
                                           F999-NUM-CNTRCT-TYP                  
                       WHEN '05'                                                
                       WHEN '14'                                                
                       WHEN '18'                                                
                       WHEN '24'                                                
                       WHEN '29'                                                
                       WHEN '35'                                                
                          MOVE '2MOA'   TO F999-CDE-MODL-DESG                   
                                           F999-NUM-CNTRCT-TYP                  
                       WHEN '06'                                                
                       WHEN '22'                                                
                          MOVE '4SIM'   TO F999-CDE-MODL-DESG                   
                                           F999-NUM-CNTRCT-TYP                  
                    END-EVALUATE                                                
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       410-EXIT.                                                                
           EXIT.                                                                
                                                                                
       420-BP13K240-READ.                                                       
      *-----------------------------------------------------------              
           PERFORM 421-READ-BM06K510    THRU 421-EXIT.                          
           PERFORM 422-DECODE-FLAT-TYPE THRU 422-EXIT.                          
                                                                                
           MOVE SPACES               TO K240-KEY-FLD.                           
           MOVE '01'                 TO K240-CDE-HEADER.                        
           MOVE F800-DTE-ALLOCN      TO K240-DTE-ALLOC.                         
           MOVE F800-NEIGHBOURHOOD   TO K240-NUM-NEIGH.                         
           MOVE F800-CONTRACT-NO     TO K240-NUM-CNTRCT.                        
           MOVE WS-NT-NAME           TO K240-NUM-NEW-TOWN.                      
           MOVE WS-NUM-FLAT-TYPE     TO K240-NUM-FLAT-TYPE.                     
           MOVE F800-BLK-NO          TO K240-NUM-BLK.                           
                                                                                
           READ BP13K240.                                                       
           EVALUATE BP13K240-STATUS                                             
           WHEN 00                                                              
              ADD   1          TO WS-K240-READ                                  
              IF K240-NUM-MAX-CAT1 > K240-NUM-TOTAL                             
                 MOVE K240-NUM-TOTAL    TO F999-NUM-MAX-CAT1                    
              ELSE                                                              
                 MOVE K240-NUM-MAX-CAT1 TO F999-NUM-MAX-CAT1                    
              END-IF                                                            
              IF K240-NUM-MAX-CAT2 > K240-NUM-TOTAL                             
                 MOVE K240-NUM-TOTAL    TO F999-NUM-MAX-CAT2                    
              ELSE                                                              
                 MOVE K240-NUM-MAX-CAT2 TO F999-NUM-MAX-CAT2                    
              END-IF                                                            
              IF K240-NUM-MAX-CAT3 > K240-NUM-TOTAL                             
                 MOVE K240-NUM-TOTAL    TO F999-NUM-MAX-CAT3                    
              ELSE                                                              
                 MOVE K240-NUM-MAX-CAT3 TO F999-NUM-MAX-CAT3                    
              END-IF                                                            
              IF K240-NUM-MAX-SPR > K240-NUM-TOTAL                              
                 MOVE K240-NUM-TOTAL    TO F999-NUM-MAX-SPR                     
              ELSE                                                              
                 MOVE K240-NUM-MAX-SPR  TO F999-NUM-MAX-SPR                     
              END-IF                                                            
           WHEN 23                                                              
              ADD   1          TO WS-K240-NFND                                  
              MOVE ZEROES      TO F999-NUM-MAX-ALLOWABLE                        
              DISPLAY 'RECORD NOT FOUND BP13K240 : ' K240-KEY-FLD               
           WHEN OTHER                                                           
              DISPLAY 'ERROR READING BP13K240 : ' BP13K240-STATUS               
              MOVE BP13K240-STATUS            TO  RETURN-CODE                   
              PERFORM 999-CLOSE-ROUTINE       THRU 999-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       420-EXIT.                                                                
           EXIT.                                                                
                                                                                
       421-READ-BM06K510.                                                       
      *-------------------------------------------------------------            
           MOVE SPACES                TO WS-NT-NAME.                            
           MOVE F800-ESTATE           TO K510-ESTCDE.                           
                                                                                
           READ BM06K510.                                                       
                                                                                
           EVALUATE BM06K510-STATUS                                             
           WHEN 00                                                              
              MOVE K510-NT-NAME   TO WS-NT-NAME                                 
           WHEN 23                                                              
              MOVE SPACES         TO WS-NT-NAME                                 
              DISPLAY 'READ BM06K510-ERROR ' BM06K510-STATUS ' '                
                                             K510-ESTCDE                        
           WHEN OTHER                                                           
              DISPLAY 'ERROR READING BM06K510 : ' BM06K510-STATUS               
                      '      K510-ESTCDE    =  ' K510-ESTCDE                    
              MOVE BM06K510-STATUS          TO   RETURN-CODE                    
              PERFORM 999-CLOSE-ROUTINE       THRU 999-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       421-EXIT.                                                                
           EXIT.                                                                
                                                                                
       422-DECODE-FLAT-TYPE.                                                    
      *-------------------------------------------------------------            
           MOVE SPACES             TO WS-NUM-FLAT-TYPE.                         
                                                                                
           EVALUATE F800-CDE-TYP-ACTUSE                                         
           WHEN '01'                                                            
             IF F800-NUM-COMBINE-SA = 'Y'                                       
               IF F800-ESTATE = '943'                                           
                  MOVE 'SP'        TO WS-NUM-FLAT-TYPE                          
               ELSE                                                             
                  MOVE 'SA'        TO WS-NUM-FLAT-TYPE                          
               END-IF                                                           
             ELSE                                                               
                IF F800-CDE-MODL-DESG = '80' OR '89' OR '92'                    
                   MOVE '1A'        TO WS-NUM-FLAT-TYPE                         
                ELSE                                                            
                   MOVE '01'        TO WS-NUM-FLAT-TYPE                         
                END-IF                                                          
             END-IF                                                             
           WHEN '02'                                                            
             IF F800-CDE-MODL-DESG  = '97' OR '98'                              
                MOVE 'SA'        TO WS-NUM-FLAT-TYPE                            
                GO TO 422-EXIT                                                  
             END-IF                                                             
             IF K100-NUM-SHORT-LEASE-FT = 'Y'                                   
                MOVE 'SA'        TO WS-NUM-FLAT-TYPE                            
                GO TO 422-EXIT                                                  
             END-IF                                                             
             IF F800-NUM-DESIGN-OFFER = 'F'                                     
                MOVE '02'        TO WS-NUM-FLAT-TYPE                            
                GO TO 422-EXIT                                                  
             END-IF                                                             
             IF F800-NUM-COMBINE-SA = 'Y'                                       
               IF F800-ESTATE = '943'                                           
                  MOVE 'SP'        TO WS-NUM-FLAT-TYPE                          
               ELSE                                                             
                  MOVE 'SA'        TO WS-NUM-FLAT-TYPE                          
               END-IF                                                           
             ELSE                                                               
                IF F800-CDE-MODL-DESG = '80' OR '89' OR '92'                    
                   MOVE '2A'        TO WS-NUM-FLAT-TYPE                         
                ELSE                                                            
                   IF F800-FLAT-STATUS = 'NW' OR 'CV'                           
                      IF F800-CDE-MODL-DESG = '34' OR '70' OR '71' OR           
                                              '72' OR '73'                      
                         MOVE '2D'        TO WS-NUM-FLAT-TYPE                   
                      ELSE                                                      
                         IF F800-CDE-MODL-DESG = '81' OR '82' OR '86' OR        
                                                 '87' OR '88' OR '85'           
                            MOVE '2P'        TO WS-NUM-FLAT-TYPE                
                         ELSE                                                   
                            MOVE '02'        TO WS-NUM-FLAT-TYPE                
                         END-IF                                                 
                      END-IF                                                    
                   ELSE                                                         
                      PERFORM 423-DECODE-FT-2R THRU 423-EXIT                    
                   END-IF                                                       
                END-IF                                                          
             END-IF                                                             
           WHEN '03'                                                            
             IF (F800-FLAT-STATUS = 'NW' OR 'CV') OR                            
                (F800-DTE-HANDOVER >= '20000101')                               
                IF F800-CDE-MODL-DESG = '34' OR '70' OR '71' OR                 
                                        '72' OR '73'                            
                   MOVE '3D'        TO WS-NUM-FLAT-TYPE                         
                ELSE                                                            
                   IF F800-CDE-MODL-DESG = '81' OR '82' OR '86' OR              
                                           '87' OR '88' OR '85'                 
                      MOVE '3P'        TO WS-NUM-FLAT-TYPE                      
                   ELSE                                                         
                       IF F800-NUM-DESIGN-OFFER = 'P'                           
                          MOVE '3P'        TO WS-NUM-FLAT-TYPE                  
                       ELSE                                                     
                          MOVE '03'        TO WS-NUM-FLAT-TYPE                  
                       END-IF                                                   
                   END-IF                                                       
                END-IF                                                          
             ELSE                                                               
                PERFORM 424-DECODE-FT-3R THRU 424-EXIT                          
             END-IF                                                             
           WHEN '04'                                                            
             IF F800-ESTATE = '942'                                             
                MOVE 'S1'        TO WS-NUM-FLAT-TYPE                            
             ELSE                                                               
                IF F800-CDE-MODL-DESG = '34' OR '70' OR '71' OR                 
                                        '72' OR '73'                            
                   MOVE '4D'        TO WS-NUM-FLAT-TYPE                         
                ELSE                                                            
                   IF F800-CDE-MODL-DESG = '81' OR '82' OR '86' OR              
                                           '87' OR '88' OR '85'                 
                      MOVE '4P'        TO WS-NUM-FLAT-TYPE                      
                   ELSE                                                         
                      MOVE '04'        TO WS-NUM-FLAT-TYPE                      
                   END-IF                                                       
                END-IF                                                          
             END-IF                                                             
           WHEN '05'                                                            
             IF F800-ESTATE = '942'                                             
                MOVE 'S2'        TO WS-NUM-FLAT-TYPE                            
             ELSE                                                               
                IF F800-CDE-MODL-DESG = '34' OR '70' OR '71' OR                 
                                        '72' OR '73'                            
                   MOVE '5D'        TO WS-NUM-FLAT-TYPE                         
                ELSE                                                            
                   IF F800-CDE-MODL-DESG = '81' OR '82' OR '86' OR              
                                           '87' OR '88' OR '85'                 
                      MOVE '5P'        TO WS-NUM-FLAT-TYPE                      
                   ELSE                                                         
                      MOVE '05'        TO WS-NUM-FLAT-TYPE                      
                   END-IF                                                       
                END-IF                                                          
             END-IF                                                             
           WHEN '06'                                                            
           WHEN '08'                                                            
             IF F800-CDE-MODL-DESG = '70' OR '71' OR '34' OR                    
                                     '72' OR '73'                               
                MOVE '6D'        TO WS-NUM-FLAT-TYPE                            
             ELSE                                                               
                IF F800-CDE-MODL-DESG = '81' OR '82' OR '86' OR                 
                                        '87' OR '88' OR '85'                    
                   MOVE '6P'        TO WS-NUM-FLAT-TYPE                         
                ELSE                                                            
                   MOVE '06'        TO WS-NUM-FLAT-TYPE                         
                END-IF                                                          
             END-IF                                                             
           WHEN OTHER                                                           
             MOVE F800-CDE-TYP-ACTUSE TO WS-NUM-FLAT-TYPE                       
           END-EVALUATE.                                                        
                                                                                
       422-EXIT.                                                                
           EXIT.                                                                
                                                                                
       423-DECODE-FT-2R.                                                        
      *-------------------------------------------------------------            
           MOVE SPACES       TO WS-NUM-FLAT-TYPE.                               
                                                                                
           EVALUATE F800-CDE-MODL-DESG                                          
              WHEN '03'                                                         
              WHEN '13'                                                         
              WHEN '15'                                                         
              WHEN '21'                                                         
              WHEN '30'                                                         
              WHEN '37'                                                         
                 MOVE '2I'     TO WS-NUM-FLAT-TYPE                              
              WHEN OTHER                                                        
                 MOVE '02'     TO WS-NUM-FLAT-TYPE                              
           END-EVALUATE.                                                        
                                                                                
       423-EXIT.                                                                
           EXIT.                                                                
                                                                                
       424-DECODE-FT-3R.                                                        
      *-------------------------------------------------------------            
           MOVE SPACES       TO WS-NUM-FLAT-TYPE.                               
                                                                                
           EVALUATE F800-CDE-MODL-DESG                                          
              WHEN '02'                                                         
              WHEN '20'                                                         
              WHEN '28'                                                         
                 MOVE '03'     TO WS-NUM-FLAT-TYPE                              
              WHEN '03'                                                         
              WHEN '13'                                                         
              WHEN '15'                                                         
              WHEN '21'                                                         
              WHEN '30'                                                         
              WHEN '37'                                                         
                 MOVE '3I'     TO WS-NUM-FLAT-TYPE                              
              WHEN '04'                                                         
              WHEN '16'                                                         
              WHEN '17'                                                         
              WHEN '23'                                                         
                 MOVE '3N'     TO WS-NUM-FLAT-TYPE                              
              WHEN '05'                                                         
              WHEN '14'                                                         
              WHEN '18'                                                         
              WHEN '24'                                                         
              WHEN '29'                                                         
              WHEN '35'                                                         
                 MOVE '3A'     TO WS-NUM-FLAT-TYPE                              
              WHEN '06'                                                         
              WHEN '22'                                                         
                 MOVE '3S'     TO WS-NUM-FLAT-TYPE                              
           END-EVALUATE.                                                        
                                                                                
       424-EXIT.                                                                
           EXIT.                                                                
                                                                                
       440-DECODE-FLAT-TYPE.                                                    
      *-----------------------------------------------------------              
                                                                                
           EVALUATE F800-CDE-TYP-ACTUSE                                         
           WHEN '01'                                                            
              IF F800-CDE-MODL-DESG = '80' OR '89' OR '92'                      
                 MOVE '1A'      TO WS-FLAT-TYPE                                 
              ELSE                                                              
                 MOVE '1 '      TO WS-FLAT-TYPE                                 
              END-IF                                                            
           WHEN '02'                                                            
              IF F800-CDE-MODL-DESG = '80' OR '89' OR '92'                      
                 MOVE '2A'      TO WS-FLAT-TYPE                                 
              ELSE                                                              
                 IF F800-CDE-MODL-DESG = '76'                                   
                    MOVE '2F'      TO WS-FLAT-TYPE                              
                 ELSE                                                           
                    MOVE '2 '      TO WS-FLAT-TYPE                              
                 END-IF                                                         
              END-IF                                                            
           WHEN '03'                                                            
              MOVE '3 '         TO WS-FLAT-TYPE                                 
           WHEN '04'                                                            
              MOVE '4 '         TO WS-FLAT-TYPE                                 
           WHEN '05'                                                            
              MOVE '5 '         TO WS-FLAT-TYPE                                 
           WHEN '06'                                                            
           WHEN '08'                                                            
              MOVE 'E '         TO WS-FLAT-TYPE                                 
           END-EVALUATE.                                                        
                                                                                
           IF F205-NUM-FLAT-TYPE = '2F' AND                                     
              F800-CDE-TYP-ACTUSE NOT = '03'                                    
               MOVE '2 '      TO WS-FLAT-TYPE                                   
           END-IF.                                                              
                                                                                
      *** DECODE FLAT CODE                                                      
                                                                                
           IF (F800-FLAT-STATUS = 'RP') OR                                      
              (F800-FLAT-STATUS = 'ST' AND F800-REPOSSESSED-CODE = '40')        
                                    OR                                          
              (F800-FLAT-STATUS = 'ST' AND F800-REPOSSESSED-CODE = '20')        
              MOVE 'RP'        TO F999-NUM-FLAT-CODE                            
           ELSE                                                                 
              IF (F800-NUM-FLAT-DESC = SPACES OR LOW-VALUES) AND                
                 (F800-CDE-POF-TAG = 'Z')                                       
                 MOVE 'FF'        TO F999-NUM-FLAT-CODE                         
              ELSE                                                              
                 IF F800-NUM-FLAT-DESC = 'AF' OR 'MF' OR 'RF'                   
                    MOVE 'FF'        TO F999-NUM-FLAT-CODE                      
                 ELSE                                                           
                    MOVE F800-NUM-FLAT-DESC TO F999-NUM-FLAT-CODE               
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F800-CDE-POE-TAG = 'Z'                                            
              MOVE 'FE'     TO F999-NUM-FLAT-CODE                               
           END-IF.                                                              
                                                                                
       440-EXIT.                                                                
           EXIT.                                                                
                                                                                
       450-BM06K100-READ.                                                       
      *-----------------------------------------------------------              
           MOVE LOW-VALUES           TO K100-KEY-FLD.                           
           MOVE F800-ESTATE          TO K100-ESTATE.                            
           MOVE F800-NEIGHBOURHOOD   TO K100-NEIGHBOURHOOD.                     
           MOVE F800-CONTRACT-NO     TO K100-CONTRACT-NO.                       
           MOVE F800-BLK-NO          TO K100-BLK-NO.                            
                                                                                
           READ BM06K100.                                                       
           EVALUATE BM06K100-STATUS                                             
           WHEN 00                                                              
              ADD  1      TO WS-K100-READ                                       
              MOVE K100-CDE-BLK          TO WS-K100-CDE-BLK                     
              MOVE K100-DTE-OCS-DUE      TO WS-K100-DTE-OCS                     
              MOVE K100-DTE-POD-DUE      TO WS-K100-DTE-POD-DUE                 
              MOVE K100-DTE-POF-DUE      TO WS-K100-DTE-POF-DUE                 
              MOVE K100-DTE-POW-DUE      TO WS-K100-DTE-POW-DUE                 
              MOVE K100-DTE-PACD         TO WS-K100-DTE-PACD                    
           WHEN 23                                                              
              MOVE SPACES                TO WS-K100-CDE-BLK                     
              MOVE '00000000'            TO WS-K100-DTE-OCS                     
                                            WS-K100-DTE-POD-DUE                 
                                            WS-K100-DTE-POF-DUE                 
                                            WS-K100-DTE-POW-DUE                 
                                            WS-K100-DTE-PACD                    
              DISPLAY 'RECORD NOT FOUND BM06K100 : ' K100-KEY-FLD               
              ADD   1          TO WS-K100-NFND                                  
           WHEN OTHER                                                           
              DISPLAY 'ERROR READING BM06K100 : ' BM06K100-STATUS               
              MOVE BM06K100-STATUS            TO  RETURN-CODE                   
              PERFORM 999-CLOSE-ROUTINE       THRU 999-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       450-EXIT.                                                                
           EXIT.                                                                
                                                                                
       460-BB14K500-READ.                                                       
      *-----------------------------------------------------------              
           MOVE LOW-VALUES           TO K500-KEY-FLD.                           
           MOVE WS-K100-CDE-BLK      TO K500-CDE-BLK.                           
                                                                                
           READ BB14K500.                                                       
           EVALUATE BB14K500-STATUS                                             
           WHEN 00                                                              
              ADD   1      TO WS-K500-READ                                      
              MOVE K500-DTE-BLDG-COMPLETE   TO WS-K500-DTE-EST-CMPL             
              MOVE K500-NUM-LEASE-PERIOD-FLAT TO                                
                   WS-K500-LEASE-PERIOD-FLAT                                    
              MOVE K500-DTE-LEASE-COMM-FLAT TO WS-K500-DTE-LSE-COMM             
           WHEN 23                                                              
              ADD   1          TO WS-K500-NFND                                  
              DISPLAY 'RECORD NOT FOUND BB14K500 : ' K500-KEY-FLD               
              MOVE SPACES       TO WS-K500-DTE-EST-CMPL                         
              MOVE ZEROES       TO WS-K500-DTE-LSE-COMM                         
           WHEN OTHER                                                           
              DISPLAY 'ERROR READING BB14K500 : ' BB14K500-STATUS               
              MOVE BB14K500-STATUS            TO  RETURN-CODE                   
              PERFORM 999-CLOSE-ROUTINE       THRU 999-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       460-EXIT.                                                                
           EXIT.                                                                
                                                                                
       600-BP13K060-READ.                                                       
      *-----------------------------------------------------------              
                                                                                
           READ BP13K060.                                                       
           EVALUATE BP13K060-STATUS                                             
           WHEN 00                                                              
              MOVE 'Y'       TO WS-K060-FND                                     
           WHEN 23                                                              
              MOVE 'N'       TO WS-K060-FND                                     
              DISPLAY 'RECORD NOT FOUND BP13K060 : ' K060-KEY-FLD               
               ADD  1        TO WS-K060-NFND                                    
           WHEN OTHER                                                           
              DISPLAY 'ERROR READING BP13K060 : ' BP13K060-STATUS               
              MOVE BP13K060-STATUS            TO  RETURN-CODE                   
              PERFORM 999-CLOSE-ROUTINE       THRU 999-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       600-EXIT.                                                                
           EXIT.                                                                
                                                                                
       700-REWRITE-BM06F800.                                                    
      *-----------------------------------------------------------              
                                                                                
           MOVE WS-CUR-DATE             TO WS-CURRENT-DTE.                      
                                                                                
           IF WS-K110-DTE-KEY-AVBL = ZEROES OR SPACES OR LOW-VALUES             
              MOVE WS-K500-DTE-EST-CMPL TO F999-DTE-ECD                         
              MOVE WS-K100-DTE-PACD     TO F999-DTE-PCD                         
              PERFORM 702-GET-DLVRY-POSSN-DATE THRU 702-EXIT                    
              MOVE WS-DEL-POSSN-DATE      TO F999-DTE-DLVRY-POSSESSION          
           ELSE                                                                 
              PERFORM 706-READ-BB14K990    THRU 706-EXIT                        
              IF K990-DTE-REV-LCD NOT = ZEROES AND SPACES AND LOW-VALUES        
                 MOVE K990-DTE-REV-LCD     TO WS-TMP-DTE-LSE-COMM               
              ELSE                                                              
                IF WS-K500-DTE-LSE-COMM = ZEROES OR SPACES OR LOW-VALUES        
                   PERFORM 701-GET-COMM-DATE THRU 701-EXIT                      
                   MOVE WS-K500-DTE-LSE-COMM TO WS-TMP-DTE-LSE-COMM             
                ELSE                                                            
                   MOVE WS-K500-DTE-LSE-COMM TO WS-TMP-DTE-LSE-COMM             
                END-IF                                                          
              END-IF                                                            
              MOVE WS-K500-DTE-LSE-COMM TO F999-DTE-LEASE-COMM                  
              MOVE WS-K500-LEASE-PERIOD-FLAT TO                                 
                   F999-NUM-LEASE-PERIOD-FLAT                                   
              MOVE 'Y'     TO F999-CDE-KEY-AVAIL                                
              PERFORM 705-READ-BB14K580 THRU 705-EXIT                           
              IF K580-DTE-UNIT-DELIVERY = SPACES OR LOW-VALUES OR ZEROES        
                 CONTINUE                                                       
              ELSE                                                              
                 MOVE SPACES TO F999-DTE-DLVRY-POSSESSION                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE F999-DTE-DLVRY-POSSESSION TO F800-DTE-DLVRY-POSSESSION.         
           MOVE WS-K500-DTE-LSE-COMM      TO F800-DTE-LEASE-COMM.               
           MOVE WS-K500-LEASE-PERIOD-FLAT TO F800-NUM-LEASE-PERIOD-FLAT.        
           MOVE WS-K110-DTE-KEY-AVBL      TO F800-DTE-BLK-KEY-AVAIL.            
           MOVE K100-NUM-BTO-NEW-CONTRACT TO F800-NUM-BTO-NEW-CONTRACT.         
           MOVE SPACES                    TO F800-NUM-MGPS.                     
                                                                                
           REWRITE F800-REC.                                                    
           ADD 1     TO WS-F800-WRITE.                                          
                                                                                
       700-EXIT.                                                                
           EXIT.                                                                
                                                                                
       750-WRITE-BP13F999.                                                      
      *-----------------------------------------------------------              
                                                                                
           IF K100-NEI-ORIG NOT = SPACES AND LOW-VALUES                         
              MOVE K100-NEI-ORIG        TO F999-NEIGHBOURHOOD                   
           ELSE                                                                 
              MOVE F800-NEIGHBOURHOOD   TO F999-NEIGHBOURHOOD                   
           END-IF.                                                              
           IF K100-CONT-ORIG NOT = SPACES AND LOW-VALUES                        
              MOVE K100-CONT-ORIG       TO F999-CONTRACT-NO                     
           ELSE                                                                 
              MOVE F800-CONTRACT-NO     TO F999-CONTRACT-NO                     
           END-IF.                                                              
           MOVE K100-NUM-REMAIN-LEASE   TO F999-NUM-REMAIN-LEASE.               
                                                                                
           IF F205-NUM-LEASE-BALANCE > ZEROES                                   
              PERFORM 850-BM06K150-READ THRU 850-EXIT                           
              IF F999-AMT-SELLING-PRICE = ZEROES                                
                 IF F800-DTE-BALLOT >= '201802'                                 
                    PERFORM 810-COMPUTE-LEASE-BALANCE                           
                       THRU 810-EXIT                                            
                 ELSE                                                           
                    PERFORM 800-COMPUTE-LEASE-BALANCE                           
                       THRU 800-EXIT                                            
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              MOVE F800-CURR-SELLING-PRICE TO F999-AMT-SELLING-PRICE            
           END-IF.                                                              
           MOVE F205-NUM-LEASE-BALANCE  TO F999-NUM-LEASE-BALANCE.              
           MOVE SPACES                  TO F999-NUM-PARENT-FT.                  
           MOVE F800-BLK-NO             TO F999-BLOCK-NO.                       
           MOVE F800-LEVEL-NO           TO F999-LEVEL-NO.                       
           MOVE F800-MAIN-UNIT          TO F999-MAIN-UNIT.                      
           MOVE F800-SUB-UNIT           TO F999-SUB-UNIT.                       
           MOVE F800-STREET-NAME        TO F999-NME-STREET.                     
           MOVE F800-QTY-AREA-TOTAL     TO F999-QTY-AREA-TOTAL.                 
           MOVE F800-QTY-AREA-ORGNL     TO F999-QTY-AREA-ORGNL.                 
                                                                                
           MOVE K100-CDE-BLK TO WS-LINK-BLDNG-GL.                               
                                                                                
           CALL WS-BP13C916 USING WS-LINK-REC WS-BP13C916-REC.                  
                                                                                
           MOVE C916-NME-LOCAL-PRCNCT TO F999-NME-LOCAL-PRCNCT.                 
                                                                                
           IF (F800-CDE-TYP-ACTUSE = '01' OR '02') AND                          
              (F800-CDE-MODL-DESG  = '80' OR '89' OR '92')                      
               MOVE SPACES            TO F999-DTE-EXPIRY                        
               MOVE SPACES            TO F999-CDE-OCS-TAG                       
           ELSE                                                                 
              IF (WS-K100-DTE-POD-DUE NOT = ZEROES AND SPACES AND               
                                            LOW-VALUES) OR                      
                 (WS-K100-DTE-POF-DUE NOT = ZEROES AND SPACES AND               
                                            LOW-VALUES)                         
                 PERFORM 720-CHECK-POD-DUE THRU 720-EXIT                        
              ELSE                                                              
                 IF WS-K100-DTE-OCS NOT = ZEROES AND SPACES AND                 
                                          LOW-VALUES                            
                    PERFORM 710-CHECK-OCS-DUE THRU 710-EXIT                     
                 ELSE                                                           
                    MOVE SPACES            TO F999-DTE-EXPIRY                   
                    MOVE 'N'               TO F999-CDE-OCS-TAG                  
                    MOVE '00000000'        TO F999-DTE-POD-DUE                  
                    MOVE SPACES            TO F999-NUM-POD-DUE                  
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
      ********************************************                              
      * TO HARDCODE 1PA TO CATER FOR EST CODE 943*                              
      ********************************************                              
           IF  (F800-CDE-TYP-ACTUSE = '03') OR                                  
              ((F800-CDE-TYP-ACTUSE = '02') AND                                 
               (F800-CDE-MODL-DESG NOT = '80' AND '89' AND '92'))               
              CONTINUE                                                          
           ELSE                                                                 
              IF F800-CDE-TYP-ACTUSE = '04' AND                                 
                                   F800-CDE-MODL-DESG = '36'                    
                 MOVE '3STB'             TO F999-NUM-CNTRCT-TYP                 
              ELSE                                                              
                 IF F800-CDE-MODL-DESG = '81' OR '82' OR '83' OR '84'           
                                        OR '86' OR '87' OR '88' OR '89'         
                                        OR '91'                                 
                    MOVE '1PA '          TO F999-NUM-CNTRCT-TYP                 
                 ELSE                                                           
                    IF F800-CDE-MODL-DESG = '34' OR '70' OR '71' OR             
                                            '72' OR '73'                        
                       MOVE '2DBP'       TO F999-NUM-CNTRCT-TYP                 
                    ELSE                                                        
                       IF F205-NUM-FLAT-TYPE = '4P' OR '5P'                     
                          MOVE '1PA '       TO F999-CDE-MODL-DESG               
                                               F999-NUM-CNTRCT-TYP              
                       ELSE                                                     
                          IF F800-ESTATE = '943'                                
                             MOVE '1PA '       TO F999-NUM-CNTRCT-TYP           
                          ELSE                                                  
                             MOVE '3STD'       TO F999-NUM-CNTRCT-TYP           
                          END-IF                                                
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F800-CDE-SELTY = 'SBF' OR 'ROF' OR 'OBF'                          
              IF (F800-CDE-TYP-ACTUSE = '01' OR '02') AND                       
                 (F800-CDE-MODL-DESG  = '80' OR '89' OR '92')                   
                 CONTINUE                                                       
              ELSE                                                              
                 IF ((K100-DTE-1ST-SALE <= '20111031') AND                      
                     (F999-NUM-CNTRCT-TYP = '1PA'))                             
                    IF F800-FLAT-STATUS NOT = 'RP' AND 'ST'                     
                       MOVE 'FF'     TO F999-NUM-FLAT-CODE                      
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
              IF F999-NUM-FLAT-CODE = 'FF'                                      
                 IF F800-NUM-FEATURE = 'K'                                      
                    MOVE 'KF'     TO F999-NUM-FLAT-CODE                         
                 END-IF                                                         
              ELSE                                                              
                 IF F800-NUM-FEATURE = 'K'                                      
                    MOVE 'K '     TO F999-NUM-FLAT-CODE                         
                 END-IF                                                         
              END-IF                                                            
                                                                                
              IF WS-K100-DTE-POW-DUE NOT EQUAL SPACES AND ZEROES                
                 PERFORM 730-BM06K110-READ THRU 730-EXIT                        
                 PERFORM 740-BP13K277-READ THRU 740-EXIT                        
                 IF (F800-CDE-POW-TAG = ' ') AND (WS-POW-TAG = 'Y')             
                    IF F800-CDE-POF-TAG = 'Z'                                   
                       MOVE 'OF'     TO F999-NUM-FLAT-CODE                      
                    ELSE                                                        
                       MOVE 'OK'     TO F999-NUM-FLAT-CODE                      
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF (K100-DTE-HANDOVER < '20040501') AND                              
              (K100-DTE-HANDOVER NOT EQUAL SPACES AND ZEROES)                   
              MOVE 'Y' TO F999-NUM-HANDOVER-BFMAY04                             
           ELSE                                                                 
              MOVE 'N' TO F999-NUM-HANDOVER-BFMAY04                             
           END-IF.                                                              
                                                                                
           MOVE K100-NUM-BTO-NEW-CONTRACT TO                                    
                F999-NUM-BTO-NEW-CONTRACT.                                      
                                                                                
           WRITE BP13F999-RECORD.                                               
           ADD 1     TO WS-F999-WRITE.                                          
                                                                                
                                                                                
       750-EXIT.                                                                
           EXIT.                                                                
                                                                                
       701-GET-COMM-DATE.                                                       
      *-------------------------------------------------------------            
      **                                                                        
      * CALCULATE K500-DTE-LEASE-COMM-FLAT IF K500-DTE-BLDG-COMPLETE            
      * NOT EQUAL TO ZEROES                                                     
      **                                                                        
           IF K500-DTE-BLDG-COMPLETE = LOW-VALUES OR SPACES OR                  
                                       '00000000'                               
              MOVE SPACES TO F999-CDE-KEY-AVAIL                                 
              GO TO 701-EXIT                                                    
           ELSE                                                                 
              CONTINUE                                                          
           END-IF.                                                              
                                                                                
           MOVE K500-DTE-BLDG-COMPLETE TO WS-LCOMM-DTE.                         
                                                                                
           MOVE K100-KEY-FLD           TO K260-KEY-FLD.                         
                                                                                
           MOVE SPACES                 TO WS-K260-FND.                          
           READ BP13K260.                                                       
                                                                                
           EVALUATE BP13K260-STATUS                                             
           WHEN 00                                                              
                MOVE 'Y'            TO WS-K260-FND                              
           WHEN 23                                                              
                ADD   1             TO WS-K260-NFND                             
                MOVE 'N'            TO WS-K260-FND                              
           WHEN OTHER                                                           
                DISPLAY 'BP13K260 FILE READ ERROR.:' BP13K260-STATUS            
                PERFORM 999-CLOSE-ROUTINE       THRU 999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
           IF WS-K260-FND = 'Y'                                                 
              ADD    13                TO WS-LCOMM-MM                           
           ELSE                                                                 
           IF K100-DTE-1ST-SALE  > '19960610'                                   
              ADD    13                TO WS-LCOMM-MM                           
           ELSE                                                                 
              ADD    10                TO WS-LCOMM-MM.                          
           DIVIDE WS-LCOMM-MM BY 12  GIVING    WS-YEAR-COMM                     
                                 REMAINDER WS-MONTH-COMM.                       
                                                                                
           IF WS-MONTH-COMM = 0                                                 
              MOVE 12                TO WS-LCOMM-MM                             
              ADD  1                 TO WS-LCOMM-YYYY                           
           ELSE                                                                 
              ADD  WS-YEAR-COMM      TO WS-LCOMM-YYYY                           
              MOVE WS-MONTH-COMM     TO WS-LCOMM-MM.                            
                                                                                
           MOVE 01               TO WS-LCOMM-DD.                                
           MOVE WS-LCOMM-DTE     TO WS-K500-DTE-LSE-COMM.                       
           MOVE 99               TO WS-K500-LEASE-PERIOD-FLAT.                  
                                                                                
           IF (F800-CDE-MODL-DESG = '80' OR '89' OR '92') AND                   
              (F800-CDE-TYP-ACTUSE = '01' OR '02')                              
              MOVE ZEROES           TO WS-K500-LEASE-PERIOD-FLAT                
              MOVE SPACES           TO WS-K500-DTE-LSE-COMM                     
           END-IF.                                                              
                                                                                
       701-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
       702-GET-DLVRY-POSSN-DATE.                                                
      *-------------------------------------------------------------            
      *-----------------------------------------------------                    
      * **** COMPUTE DELIVERY POSSESSION DATE ***                               
      *     IF COMPLETION DATE NOT = SPACES                                     
      *        ADD 12 MONTHS TO COMPLETION DATE.                                
      *-----------------------------------------------------                    
           MOVE SPACES      TO WS-DEL-POSSN-DATE.                               
           IF K500-DTE-BLDG-COMPLETE = SPACES OR LOW-VALUES OR                  
                                       '00000000'                               
              MOVE SPACES TO F999-CDE-KEY-AVAIL                                 
              GO TO 702-EXIT                                                    
           END-IF.                                                              
                                                                                
           MOVE K500-DTE-BLDG-COMPLETE TO WS-8-DATE-CHAR                        
           IF K100-DTE-1ST-SALE  >= '20200801'                                  
              IF (K100-ESTATE       = '645' AND                                 
                  K100-NEIGHBOURHOOD = 'N1  ' AND                               
                  K100-CONTRACT-NO   = 'C59 ') OR                               
                 (K100-ESTATE       = '646' AND                                 
                  K100-NEIGHBOURHOOD = 'N5  ' AND                               
                  K100-CONTRACT-NO   = 'C7  ') OR                               
                 (K100-ESTATE       = '646' AND                                 
                  K100-NEIGHBOURHOOD = 'N5  ' AND                               
                  K100-CONTRACT-NO   = 'C8  ') OR                               
                 (K100-ESTATE       = '645' AND                                 
                  K100-NEIGHBOURHOOD = 'N2  ' AND                               
                  K100-CONTRACT-NO   = 'C36 ') OR                               
                 (K100-ESTATE       = '644' AND                                 
                  K100-NEIGHBOURHOOD = 'N4  ' AND                               
                  K100-CONTRACT-NO   = 'C50 ') OR                               
                 (K100-ESTATE       = '720' AND                                 
                  K100-NEIGHBOURHOOD = 'N2  ' AND                               
                  K100-CONTRACT-NO   = 'C11 ')                                  
                 ADD 15         TO WS-8-DATE-MM                                 
              ELSE                                                              
                 ADD 18         TO WS-8-DATE-MM                                 
              END-IF                                                            
           ELSE                                                                 
              ADD 12         TO WS-8-DATE-MM                                    
           END-IF                                                               
           IF WS-8-DATE-MM > 12                                                 
              ADD 1                    TO WS-8-DATE-YYYY                        
              SUBTRACT 12            FROM WS-8-DATE-MM                          
              IF WS-8-DATE-MM > 12                                              
                 ADD 1                    TO WS-8-DATE-YYYY                     
                 SUBTRACT 12            FROM WS-8-DATE-MM                       
              END-IF                                                            
              MOVE WS-8-DATE-MM        TO WS-MONTH                              
              MOVE WS-8-DATE-DD        TO WS-DAY                                
              PERFORM 703-CHECK-DAY       THRU 703-EXIT                         
              MOVE WS-DAY              TO WS-DEL-POSSN-DD                       
              MOVE WS-8-DATE-MM        TO WS-DEL-POSSN-MM                       
              MOVE WS-8-DATE-YYYY      TO WS-DEL-POSSN-YYYY                     
           ELSE                                                                 
              MOVE WS-8-DATE-MM        TO WS-MONTH                              
              MOVE WS-8-DATE-DD        TO WS-DAY                                
              PERFORM 703-CHECK-DAY       THRU 703-EXIT                         
              MOVE WS-DAY               TO WS-DEL-POSSN-DD                      
              MOVE WS-8-DATE-MM         TO WS-DEL-POSSN-MM                      
              MOVE WS-8-DATE-YYYY       TO WS-DEL-POSSN-YYYY                    
           END-IF.                                                              
                                                                                
       702-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
       703-CHECK-DAY.                                                           
      *---------------------------------------------------------------*         
           IF MTH-END-WITH-30                                                   
              MOVE '30'   TO WS-DAY                                             
           ELSE                                                                 
              IF MTH-END-WITH-28                                                
                 MOVE '28'   TO WS-DAY                                          
              ELSE                                                              
                 MOVE '31'   TO WS-DAY                                          
              END-IF                                                            
           END-IF.                                                              
                                                                                
                                                                                
       703-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
       705-READ-BB14K580.                                                       
      *---------------------------------------------------------------*         
           MOVE SPACES               TO K580-KEY-FLD.                           
           MOVE F800-SCH-ACC-NO(1:9) TO K580-KEY-FLD.                           
                                                                                
           READ BB14K580.                                                       
           EVALUATE BB14K580-STATUS                                             
           WHEN 00                                                              
              ADD   1          TO WS-K580-READ                                  
           WHEN 23                                                              
              ADD   1          TO WS-K580-NFND                                  
              DISPLAY 'RECORD NOT FOUND BB14K580 : ' K580-KEY-FLD               
              MOVE  SPACES     TO K580-DTE-UNIT-DELIVERY                        
           WHEN OTHER                                                           
              DISPLAY 'ERROR READING BB14K580 : ' BB14K580-STATUS               
              MOVE BB14K580-STATUS            TO  RETURN-CODE                   
              PERFORM 999-CLOSE-ROUTINE       THRU 999-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       705-EXIT.                                                                
           EXIT.                                                                
                                                                                
       706-READ-BB14K990.                                                       
      *---------------------------------------------------------------*         
           MOVE SPACES               TO K990-KEY-FLD.                           
           MOVE F800-SCH-ACC-NO(1:9) TO K990-NUM-SCH-ACNT.                      
                                                                                
           READ BB14K990.                                                       
           EVALUATE BB14K990-STATUS                                             
           WHEN 00                                                              
              ADD   1          TO WS-K990-READ                                  
           WHEN 23                                                              
              ADD   1          TO WS-K990-NFND                                  
              DISPLAY 'RECORD NOT FOUND BB14K990 : ' K990-KEY-FLD               
              MOVE  SPACES     TO K990-DTE-REV-LCD                              
           WHEN OTHER                                                           
              DISPLAY 'ERROR READING BB14K990 : ' BB14K990-STATUS               
              MOVE BB14K990-STATUS            TO  RETURN-CODE                   
              PERFORM 999-CLOSE-ROUTINE       THRU 999-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       706-EXIT.                                                                
           EXIT.                                                                
                                                                                
       710-CHECK-OCS-DUE.                                                       
      *-----------------------------------------------------------              
                                                                                
           MOVE WS-K100-DTE-OCS   TO WS-TMP-DTE-OCS.                            
           COMPUTE WS-DIFF-OCS  = WS-TMP-DTE-OCS -                              
                                  WS-CURRENT-DTE                                
           IF WS-DIFF-OCS  > 0                                                  
              MOVE WS-K100-DTE-OCS   TO F999-DTE-EXPIRY                         
              MOVE 'Y'               TO F999-CDE-OCS-TAG                        
           ELSE                                                                 
              MOVE SPACES            TO F999-DTE-EXPIRY                         
              MOVE 'N'               TO F999-CDE-OCS-TAG                        
           END-IF.                                                              
                                                                                
       710-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
       720-CHECK-POD-DUE.                                                       
      *-----------------------------------------------------------              
                                                                                
           IF WS-K100-DTE-POD-DUE > ZEROES                                      
              MOVE WS-K100-DTE-POD-DUE TO WS-TMP-DTE-POD-DUE                    
              MOVE WS-K100-DTE-POD-DUE TO F999-DTE-POD-DUE                      
              COMPUTE WS-DIFF-POD  = WS-TMP-DTE-POD-DUE -                       
                                     WS-CURRENT-DTE                             
              IF WS-DIFF-POD  > 0                                               
                 MOVE WS-K100-DTE-POD-DUE TO F999-DTE-EXPIRY                    
                 MOVE 'Y'                 TO F999-CDE-OCS-TAG                   
                 MOVE 'N'                 TO F999-NUM-POD-DUE                   
              ELSE                                                              
                 MOVE SPACES              TO F999-DTE-EXPIRY                    
                 MOVE 'N'                 TO F999-CDE-OCS-TAG                   
                 MOVE 'Y'                 TO F999-NUM-POD-DUE                   
              END-IF                                                            
           ELSE                                                                 
              IF WS-K100-DTE-POF-DUE > ZEROES                                   
                 MOVE WS-K100-DTE-POF-DUE TO WS-TMP-DTE-POD-DUE                 
                 MOVE WS-K100-DTE-POF-DUE TO F999-DTE-POD-DUE                   
                 COMPUTE WS-DIFF-POD  = WS-TMP-DTE-POD-DUE -                    
                                        WS-CURRENT-DTE                          
                 IF WS-DIFF-POD  > 0                                            
                    MOVE WS-K100-DTE-POF-DUE TO F999-DTE-EXPIRY                 
                    MOVE 'Y'                 TO F999-CDE-OCS-TAG                
                    MOVE 'N'                 TO F999-NUM-POD-DUE                
                 ELSE                                                           
                    MOVE SPACES              TO F999-DTE-EXPIRY                 
                    MOVE 'N'                 TO F999-CDE-OCS-TAG                
                    MOVE 'Y'                 TO F999-NUM-POD-DUE                
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       720-EXIT.                                                                
           EXIT.                                                                
                                                                                
       730-BM06K110-READ.                                                       
      *-----------------------------------------------------------              
            MOVE SPACES           TO K110-SCH-ACC-NO.                           
            MOVE F800-SCH-ACC-NO  TO K110-SCH-ACC-NO.                           
            READ BM06K110.                                                      
                                                                                
            EVALUATE BM06K110-STATUS                                            
               WHEN 00                                                          
                    ADD  1 TO WS-BM06K110-READ                                  
               WHEN 23                                                          
                    ADD  1 TO WS-BM06K110-NFND                                  
               WHEN OTHER                                                       
                    DISPLAY 'BM06K110 READ ERROR : ' BM06K110-STATUS            
                    DISPLAY 'BM06K110 KEY-FLD    : ' K110-SCH-ACC-NO            
                    MOVE BM06K110-STATUS         TO   RETURN-CODE               
                    PERFORM 999-CLOSE-ROUTINE       THRU 999-EXIT               
            END-EVALUATE.                                                       
                                                                                
       730-EXIT.                                                                
           EXIT.                                                                
                                                                                
       735-BM06K110-START.                                                      
      *-------------------------------------------------------------            
           PERFORM 730-BM06K110-READ THRU 730-EXIT                              
                                                                                
           IF (K110-DTE-KEY-AVAIL NOT = ZEROS AND SPACES                        
                                            AND LOW-VALUES)                     
              MOVE K110-DTE-KEY-AVAIL TO WS-K110-DTE-KEY-AVBL                   
           ELSE                                                                 
              MOVE LOW-VALUES           TO  K110-AIX1                           
              MOVE K100-KEY-FLD         TO  K110-AIX1                           
              MOVE 'N'                  TO  WS-K110-FLAG                        
                                                                                
              START BM06K110 KEY = K110-AIX1                                    
                                                                                
              IF BM06K110-STATUS = ZEROES                                       
                 PERFORM 736-READNXT-BM06K110    THRU 736-EXIT                  
                                                 UNTIL WS-K110-EOF              
              ELSE                                                              
                 DISPLAY 'BM06K110 READ ERROR : ' BM06K110-STATUS               
                 DISPLAY 'K110-AIX1           : ' K110-AIX1                     
                 MOVE BM06K110-STATUS         TO   RETURN-CODE                  
                 PERFORM 999-CLOSE-ROUTINE       THRU 999-EXIT                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
       735-EXIT.                                                                
           EXIT.                                                                
                                                                                
       736-READNXT-BM06K110.                                                    
      *-------------------------------------------------------------            
           READ BM06K110 NEXT RECORD AT END                                     
              MOVE 'Y'      TO WS-K110-FLAG                                     
           GO TO 736-EXIT.                                                      
                                                                                
           EVALUATE BM06K110-STATUS                                             
              WHEN 00                                                           
              WHEN 02                                                           
                 IF K100-KEY-FLD = K110-AIX1                                    
                    IF (K110-DTE-KEY-AVAIL NOT = ZEROS AND SPACES               
                                                   AND LOW-VALUES)              
                       MOVE K110-DTE-KEY-AVAIL TO WS-K110-DTE-KEY-AVBL          
                       MOVE 'Y'                TO WS-K110-FLAG                  
                    END-IF                                                      
                 ELSE                                                           
                    MOVE '00000000'         TO WS-K110-DTE-KEY-AVBL             
                    MOVE 'Y'                TO WS-K110-FLAG                     
                 END-IF                                                         
              WHEN 23                                                           
                  MOVE '00000000'            TO WS-K110-DTE-KEY-AVBL            
                  ADD  1 TO WS-BM06K110-NFND                                    
              WHEN OTHER                                                        
                  DISPLAY 'BM06K110 READ ERROR : ' BM06K110-STATUS              
                  DISPLAY 'BM06K110 KEY-FLD    : ' K110-SCH-ACC-NO              
                  MOVE BM06K110-STATUS         TO   RETURN-CODE                 
                  PERFORM 999-CLOSE-ROUTINE       THRU 999-EXIT                 
           END-EVALUATE.                                                        
                                                                                
       736-EXIT.                                                                
           EXIT.                                                                
                                                                                
       740-BP13K277-READ.                                                       
      *-----------------------------------------------------------              
           MOVE 'N'                    TO WS-POW-TAG.                           
           MOVE SPACES                 TO K277-KEY-FLD.                         
           MOVE K110-ESTATE            TO K277-NUM-ESTATE.                      
           MOVE K110-NEIGHBOURHOOD     TO K277-NUM-NEIGHBOUR.                   
           MOVE K110-CONTRACT-NO       TO K277-NUM-CONTR.                       
           MOVE K110-BLK-NO            TO K277-NUM-BLK.                         
           MOVE K110-NUM-FEATURE       TO K277-NUM-FEATURE.                     
           MOVE K110-NUM-LAYOUT        TO K277-NUM-LAYOUT.                      
                                                                                
           READ BP13K277.                                                       
                                                                                
           EVALUATE BP13K277-STATUS                                             
              WHEN 00                                                           
                   CONTINUE                                                     
              WHEN 23                                                           
                   DISPLAY 'RECORD NOT FOUND IN BP13K277, KEY: '                
                            K277-KEY-FLD                                        
                   MOVE SPACES     TO BP13K277-REC                              
                   INITIALIZE         BP13K277-REC                              
              WHEN OTHER                                                        
                   DISPLAY 'READ ERROR BP13K277,STATUS ' BP13K277-STATUS        
                   MOVE BP13K277-STATUS        TO RETURN-CODE                   
                   PERFORM 999-CLOSE-ROUTINE   THRU 999-EXIT                    
           END-EVALUATE.                                                        
                                                                                
           EVALUATE F800-CDE-TYP-ACTUSE                                         
                                                                                
           WHEN '02'                                                            
             IF K277-AMT-POW-2RM > ZEROES                                       
                MOVE 'Y'            TO WS-POW-TAG                               
             END-IF                                                             
                                                                                
           WHEN '03'                                                            
             IF K277-AMT-POW-3RM > ZEROES                                       
                MOVE 'Y'            TO WS-POW-TAG                               
             END-IF                                                             
                                                                                
           WHEN '04'                                                            
             IF K277-AMT-POW-4RM > ZEROES                                       
                MOVE 'Y'            TO WS-POW-TAG                               
             END-IF                                                             
                                                                                
           WHEN '05'                                                            
             IF K277-AMT-POW-5RM > ZEROES                                       
                MOVE 'Y'            TO WS-POW-TAG                               
             END-IF                                                             
                                                                                
           END-EVALUATE.                                                        
                                                                                
       740-EXIT.                                                                
           EXIT.                                                                
                                                                                
       800-COMPUTE-LEASE-BALANCE.                                               
      *-------------------------------------------------------------            
      *----------------------------------------------------------------         
      * SEARCH SERLBS TABLE TO CHECK COMPUTATION                                
      *----------------------------------------------------------------         
           SET WS-LBS-PTR TO 1.                                                 
           SEARCH WS-SERS-LBS                                                   
              AT END                                                            
                 MOVE F800-CURR-SELLING-PRICE TO F999-AMT-SELLING-PRICE         
              WHEN WS-LBS-TENURE (WS-LBS-PTR) = F205-NUM-LEASE-BALANCE          
                 COMPUTE WS-PCT = WS-LBS-PCT(WS-LBS-PTR) / 100                  
                 COMPUTE WS-SELLING-PRICE =                                     
                        (F800-CURR-SELLING-PRICE * WS-PCT)                      
                 COMPUTE F999-AMT-SELLING-PRICE =                               
                        (F800-CURR-SELLING-PRICE * WS-PCT)                      
                 COMPUTE WS-ROUND-SELLPR ROUNDED =                              
                         (F999-AMT-SELLING-PRICE / 100)                         
                 COMPUTE F999-AMT-SELLING-PRICE =                               
                         WS-ROUND-SELLPR * 100                                  
           END-SEARCH.                                                          
                                                                                
       800-EXIT.                                                                
           EXIT.                                                                
                                                                                
       810-COMPUTE-LEASE-BALANCE.                                               
      *-------------------------------------------------------------            
      *----------------------------------------------------------------         
      * SEARCH SERLBS TABLE TO CHECK COMPUTATION                                
      *----------------------------------------------------------------         
           SET WS-LBS-PTR-B TO 1.                                               
           SEARCH WS-SERS-LBS-B                                                 
             AT END                                                             
                MOVE F800-CURR-SELLING-PRICE TO F999-AMT-SELLING-PRICE          
             WHEN WS-LBS-TENURE-B(WS-LBS-PTR-B) = F205-NUM-LEASE-BALANCE        
                 COMPUTE WS-PCT = WS-LBS-PCT-B(WS-LBS-PTR-B)                    
                 COMPUTE WS-SELLING-PRICE =                                     
                        (F800-CURR-SELLING-PRICE * WS-PCT / 96 * 8 / 10)        
                 COMPUTE F999-AMT-SELLING-PRICE =                               
                        (F800-CURR-SELLING-PRICE * WS-PCT / 96 * 8 / 10)        
                 COMPUTE WS-ROUND-SELLPR ROUNDED =                              
                         (F999-AMT-SELLING-PRICE / 100)                         
                 COMPUTE F999-AMT-SELLING-PRICE =                               
                         WS-ROUND-SELLPR * 100                                  
           END-SEARCH.                                                          
                                                                                
       810-EXIT.                                                                
           EXIT.                                                                
                                                                                
       850-BM06K150-READ.                                                       
      *-----------------------------------------------------------              
           MOVE SPACES                 TO K150-KEY-FLD.                         
           MOVE F800-SCH-ACC-NO        TO K150-NUM-SCH-ACCNT.                   
           MOVE F205-NUM-LEASE-BALANCE TO K150-NUM-LEASE-TENURE.                
           MOVE F800-ALLOC-SCH         TO K150-NUM-SCHEME.                      
                                                                                
           READ BM06K150.                                                       
                                                                                
           EVALUATE BM06K150-STATUS                                             
              WHEN 00                                                           
                   MOVE K150-AMT-SELL-PRICE-OFFER                               
                                   TO F999-AMT-SELLING-PRICE                    
              WHEN 23                                                           
                   MOVE ZEROES     TO F999-AMT-SELLING-PRICE                    
              WHEN OTHER                                                        
                   DISPLAY 'READ ERROR BM06K150,STATUS ' BM06K150-STATUS        
                   MOVE BM06K150-STATUS        TO RETURN-CODE                   
                   PERFORM 999-CLOSE-ROUTINE   THRU 999-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       850-EXIT.                                                                
           EXIT.                                                                
                                                                                
       860-LINK-BM06CCFL.                                                       
      *-----------------------------------------------------------              
                                                                                
           MOVE F800-SCH-ACC-NO   TO COM31-NUM-SCH-ACCNT.                       
                                                                                
           CALL 'BM06CCFL' USING BM06COM31-REC.                                 
                                                                                
           IF COM31-CDE-RETURN NOT = SPACES AND LOW-VALUES                      
              MOVE ZEROES    TO  COM31-AMT-PRICE-OFFER-45-FSH                   
                                 COM31-AMT-PRICE-OFFER-50-FSH                   
                                 COM31-AMT-PRICE-OFFER-55-FSH                   
                                 COM31-AMT-PRICE-OFFER-60-FSH                   
                                 COM31-AMT-PRICE-OFFER-65-FSH                   
           ELSE                                                                 
              IF COM31-AMT-PRICE-OFFER-45-FSH NOT NUMERIC                       
                 MOVE ZEROES    TO  COM31-AMT-PRICE-OFFER-45-FSH                
              END-IF                                                            
              IF COM31-AMT-PRICE-OFFER-50-FSH NOT NUMERIC                       
                 MOVE ZEROES    TO  COM31-AMT-PRICE-OFFER-50-FSH                
              END-IF                                                            
              IF COM31-AMT-PRICE-OFFER-55-FSH NOT NUMERIC                       
                 MOVE ZEROES    TO  COM31-AMT-PRICE-OFFER-55-FSH                
              END-IF                                                            
              IF COM31-AMT-PRICE-OFFER-60-FSH NOT NUMERIC                       
                 MOVE ZEROES    TO  COM31-AMT-PRICE-OFFER-60-FSH                
              END-IF                                                            
              IF COM31-AMT-PRICE-OFFER-65-FSH NOT NUMERIC                       
                 MOVE ZEROES    TO  COM31-AMT-PRICE-OFFER-65-FSH                
              END-IF                                                            
           END-IF.                                                              
                                                                                
       860-EXIT.                                                                
           EXIT.                                                                
                                                                                
       999-CLOSE-ROUTINE.                                                       
      *-----------------------------------------------------------              
           DISPLAY '*---------------------------------------------*'.           
           DISPLAY '      PROGRAM : BP13C23O       ' WS-EDT-DATE.               
           DISPLAY '*---------------------------------------------*'.           
           DISPLAY ' '.                                                         
           MOVE WS-F205-READ    TO WS-EDT-TMP.                                  
           DISPLAY 'NO OF RECS READ FROM BP13F205 : ' WS-EDT-TMP.               
           MOVE WS-F800-READ    TO WS-EDT-TMP.                                  
           DISPLAY 'NO OF RECS READ FROM BM06F800 : ' WS-EDT-TMP.               
           MOVE WS-K240-READ    TO WS-EDT-TMP.                                  
           DISPLAY 'NO OF RECS READ FROM BP13K240 : ' WS-EDT-TMP.               
           MOVE WS-K100-READ    TO WS-EDT-TMP.                                  
           DISPLAY 'NO OF RECS READ FROM BM06K100 : ' WS-EDT-TMP.               
           MOVE WS-K500-READ    TO WS-EDT-TMP.                                  
           DISPLAY 'NO OF RECS READ FROM BB14K500 : ' WS-EDT-TMP.               
           MOVE WS-K580-READ    TO WS-EDT-TMP.                                  
           DISPLAY 'NO OF RECS READ FROM BB14K580 : ' WS-EDT-TMP.               
           MOVE WS-F999-WRITE   TO WS-EDT-TMP.                                  
           DISPLAY 'NO OF RECS WRITE  TO BP13F999 : ' WS-EDT-TMP.               
           MOVE WS-F800-WRITE   TO WS-EDT-TMP.                                  
           DISPLAY 'NO OF RECS WRITE  TO BM06F800 : ' WS-EDT-TMP.               
           DISPLAY '*---------------------------------------------*'.           
           DISPLAY ' '.                                                         
           MOVE WS-NOT-MATCHED  TO WS-EDT-TMP.                                  
           DISPLAY 'NO OF RECS SKIPPED : '  WS-EDT-TMP.                         
           MOVE WS-K240-NFND    TO WS-EDT-TMP.                                  
           DISPLAY 'NO RECS NOT FOUND IN BP13K240 : '  WS-EDT-TMP.              
           MOVE WS-K060-NFND    TO WS-EDT-TMP.                                  
           DISPLAY 'NO RECS NOT FOUND IN BP13K060 : '  WS-EDT-TMP.              
           MOVE WS-K260-NFND    TO WS-EDT-TMP.                                  
           DISPLAY 'NO RECS NOT FOUND IN BP13K260 : '  WS-EDT-TMP.              
           MOVE WS-K100-NFND    TO WS-EDT-TMP.                                  
           DISPLAY 'NO RECS NOT FOUND IN BM06K100 : '  WS-EDT-TMP.              
           MOVE WS-K500-NFND    TO WS-EDT-TMP.                                  
           DISPLAY 'NO RECS NOT FOUND IN BB14K500 : '  WS-EDT-TMP.              
           MOVE WS-K580-NFND    TO WS-EDT-TMP.                                  
           DISPLAY 'NO RECS NOT FOUND IN BB14K580 : '  WS-EDT-TMP.              
                                                                                
           IF F205-NUM-FORM-TYPE = 'D' OR 'F' OR 'S'                            
              MOVE 22       TO RETURN-CODE                                      
           END-IF.                                                              
                                                                                
           IF F205-NUM-FORM-TYPE = 'C' AND                                      
              F205-NUM-FLAT-TYPE = '4P' OR '5P'                                 
              MOVE 22       TO RETURN-CODE                                      
           END-IF.                                                              
                                                                                
           CLOSE BP13F205                                                       
                 BP13K240                                                       
                 BP13K060                                                       
                 BP13K260                                                       
                 BM06K110                                                       
                 BM06K100                                                       
                 BM06K150                                                       
                 BM06K510                                                       
                 BM06F800                                                       
                 BB14K500                                                       
                 BB14K580                                                       
                 BB14K990                                                       
                 BP13K277                                                       
                 BP13F999.                                                      
                                                                                
           IF BP13K240-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSE ERROR, BP13K240-STATUS ' BP13K240-STATUS           
              MOVE BP13K240-STATUS     TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF BP13K060-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSE ERROR, BP13K060-STATUS ' BP13K060-STATUS           
              MOVE BP13K060-STATUS     TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF BP13K260-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSE ERROR, BP13K260-STATUS ' BP13K260-STATUS           
              MOVE BP13K260-STATUS     TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF BM06K100-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSE ERROR, BM06K100-STATUS ' BM06K100-STATUS           
              MOVE BM06K100-STATUS     TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF BM06K150-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSE ERROR, BM06K150-STATUS ' BM06K150-STATUS           
              MOVE BM06K150-STATUS     TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF BM06K510-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSE ERROR, BM06K510-STATUS ' BM06K510-STATUS           
              MOVE BM06K510-STATUS     TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF BB14K500-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSE ERROR, BB14K500-STATUS ' BB14K500-STATUS           
              MOVE BB14K500-STATUS     TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF BB14K580-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSE ERROR, BB14K580-STATUS ' BB14K580-STATUS           
              MOVE BB14K580-STATUS     TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF BB14K990-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSE ERROR, BB14K990-STATUS ' BB14K990-STATUS           
              MOVE BB14K990-STATUS     TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF BM06K110-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSE ERROR, BM06K110-STATUS ' BM06K110-STATUS           
              MOVE BM06K110-STATUS     TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF BP13K277-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSE ERROR, BP13K277-STATUS ' BP13K277-STATUS           
              MOVE BP13K277-STATUS     TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
       999-EXIT.                                                                
           EXIT.                                                                
