       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CF11.                                                 
      *AUTHOR.        ZARITA DANE SARMIENTO.                                    
      *DATE-WRITTEN.  27/05/10.                                                 
      * ========================================================== *            
      * SYSTEM OF COMMITMENT (SOC)                                 *            
      * ========================================================== *            
      *                                                            *            
      *  OBJECTIVE  :  TO GENERATE FILE FOR CASES WITH EMAIL ADD   *            
      * *                                                                       
      *  INPUT FILE :  1. BP13F740                                 *            
      *  I-O        :  1. BP13K857                                 *            
      *                2. BP13K022                                 *            
      *                3. BP13K820                                 *            
      *  OUTPUT FILE:  1. P13F740A                                 *            
      * ---------------------------------------------------------- *            
      * BP133913 ZDD 20100505   NEW PROGRAM                        *            
      * BP134024 ZDD 20100922   TO INCLUDE CITIZEN HH,LOAN-TAG AND *            
      *                         RESALE STATUS ON THE REPORT        *            
      * BP134036 IL5 20101020   REPLACE RSL-STATUS WITH PREM-CODE  *            
      * BP134536 ZDD 20110425   ADD BP13KB00 FOR PREE-STATUS       *            
      * BP134536 ZDD 20120621   ADD FIELDS TO SHOW MGPS INFO       *            
      * BP134718 SMR 20121214   ADD K800-NUM-SALE-BROCHURE-SCPY    *            
      * BP134782 SMR 20130214   WRITE PPS-ELIG AND PPS-QUOTA       *            
      * BP134914 SMR 20130617   WRITE AST-ELIG AND AST-QUOTA       *            
      * BP135028 IL5 20130821   WRITE FT2T                         *            
      * BP135170 IL5 20140106   WRITE 3GEN TAG                                  
      * BP135369 SMR 20140618   WRITE HARDLUCK TAG AND COUNT       *            
      * BP136096 SMR 20160115   WRITE ELDERLY-EXEMPTION, NTIMER,   *            
      *                         ELDERLY AND ELDERLY-PREMIUM        *            
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-4341.                                               
       OBJECT-COMPUTER. IBM-4341.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
      *-------------------------------------------------------------            
           SELECT BP13F740 ASSIGN TO BP13F740.                                  
           SELECT F740MTCH ASSIGN TO F740MTCH.                                  
                                                                                
           SELECT BP13K857 ASSIGN TO BP13K857                                   
                  ACCESS MODE     IS RANDOM                                     
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K857-KEY-FLD                               
                  FILE STATUS     IS WS-K857-STATUS.                            
                                                                                
           SELECT BP13K820 ASSIGN TO BP13K820                                   
                  ACCESS MODE     IS RANDOM                                     
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K820-KEY-FLD                               
                  FILE STATUS     IS WS-K820-STATUS.                            
                                                                                
           SELECT BP13K022 ASSIGN TO BP13K022                                   
                  ACCESS MODE     IS DYNAMIC                                    
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K022-KEY-FLD                               
                  ALTERNATE KEY   IS K022-NUM-REGN                              
                  FILE STATUS     IS WS-K022-STATUS.                            
                                                                                
           SELECT BP13K800 ASSIGN TO BP13K800                                   
                  ACCESS MODE     IS RANDOM                                     
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K800-NUM-REGN                              
                  FILE STATUS     IS WS-K800-STATUS.                            
                                                                                
           SELECT BP13K830 ASSIGN TO BP13K830                                   
                  ACCESS MODE     IS RANDOM                                     
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K830-KEY-FLD                               
                  ALTERNATE KEY   IS K830-NUM-REGN                              
                  FILE STATUS     IS WS-K830-STATUS.                            
                                                                                
           SELECT BP13KB00 ASSIGN TO BP13KB00                                   
                  ACCESS MODE     IS RANDOM                                     
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS KB00-NUM-REGN                              
                  FILE STATUS     IS WS-KB00-STATUS.                            
                                                                                
           SELECT P13F740A ASSIGN TO P13F740A.                                  
                                                                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       FD  BP13F740                                                             
           RECORD CONTAINS 500 CHARACTERS                                       
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD.                                          
       COPY BP13F740.                                                           
                                                                                
       FD  F740MTCH                                                             
           RECORD CONTAINS 500 CHARACTERS                                       
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD.                                          
       01  F740MTCH-REC.                                                        
           05 FILLER             PIC X(122).                                    
           05 F740-REGN          PIC X(08).                                     
           05 FILLER             PIC X(370).                                    
                                                                                
       FD  P13F740A                                                             
           RECORD CONTAINS 550 CHARACTERS                                       
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD.                                          
       01  P13F740A-REC  PIC X(550).                                            
                                                                                
       FD   BP13K857                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13K857.                                                           
                                                                                
       FD   BP13K830                                                            
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD   BP13K022                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K022.                                                           
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13KB00                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13KB00.                                                           
                                                                                
       WORKING-STORAGE SECTION.                                                 
       01  WS-COUNTERS.                                                         
           05  NO-F740-READ        PIC 9(5)    VALUE ZEROS.                     
           05  NO-F740-MATCH-READ  PIC 9(5)    VALUE ZEROS.                     
           05  WS-WRITTEN          PIC 9(5)    VALUE ZEROS.                     
           05  NO-K022-FND         PIC 9(5)    VALUE ZEROS.                     
           05  NO-K820-FND         PIC 9(5)    VALUE ZEROS.                     
           05  NO-K857-FND         PIC 9(5)    VALUE ZEROS.                     
           05  NO-K800-FND         PIC 9(5)    VALUE ZEROS.                     
           05  NO-KB00-FND         PIC 9(5)    VALUE ZEROS.                     
           05  NO-K830-FND         PIC 9(5)    VALUE ZEROS.                     
           05  NO-K022-NOT-FND     PIC 9(5)    VALUE ZEROS.                     
           05  NO-K820-NOT-FND     PIC 9(5)    VALUE ZEROS.                     
           05  NO-K857-NOT-FND     PIC 9(5)    VALUE ZEROS.                     
           05  NO-K800-NOT-FND     PIC 9(5)    VALUE ZEROS.                     
           05  NO-KB00-NOT-FND     PIC 9(5)    VALUE ZEROS.                     
           05  NO-K830-NOT-FND     PIC 9(5)    VALUE ZEROS.                     
           05  WS-U-STATUS         PIC 9(5)    VALUE ZEROS.                     
           05  WS-EOF              PIC X(1)    VALUE 'N'.                       
           05  WS-EOF-MATCH        PIC X(1)    VALUE 'N'.                       
           05  WS-K857-STATUS      PIC 9(2)    VALUE ZEROS.                     
           05  WS-K820-STATUS      PIC 9(2)    VALUE ZEROS.                     
           05  WS-K022-STATUS      PIC 9(2)    VALUE ZEROS.                     
           05  WS-K800-STATUS      PIC 9(2)    VALUE ZEROS.                     
           05  WS-KB00-STATUS      PIC 9(2)    VALUE ZEROS.                     
           05  WS-K830-STATUS      PIC 9(2)    VALUE ZEROS.                     
           05  WS-K022-FND         PIC X(1)    VALUE 'N'.                       
           05  WS-K857-FND         PIC X(1)    VALUE 'N'.                       
           05  WS-K820-FND         PIC X(1)    VALUE 'N'.                       
           05  WS-K800-FND         PIC X(1)    VALUE 'N'.                       
           05  WS-K830-FND         PIC X(1)    VALUE 'N'.                       
           05  WS-KB00-FND         PIC X(1)    VALUE 'N'.                       
           05  WS-PROCESS          PIC X(1)    VALUE 'N'.                       
                                                                                
       01  WS-DETAILS.                                                          
           05  WS-REF-NUM          PIC X(08)   VALUE SPACES.                    
           05  FILLER1             PIC X(01)   VALUE SPACE.                     
           05  WS-REG-NUM          PIC X(08)   VALUE SPACES.                    
           05  FILLER2             PIC X(01)   VALUE SPACE.                     
           05  WS-NRIC1            PIC X(09)   VALUE SPACES.                    
           05  FILLER3             PIC X(01)   VALUE SPACE.                     
           05  WS-NAME1            PIC X(66)   VALUE SPACES.                    
           05  FILLER4             PIC X(01)   VALUE SPACE.                     
           05  WS-NRIC2            PIC X(09)   VALUE SPACES.                    
           05  FILLER5             PIC X(01)   VALUE SPACE.                     
           05  WS-NAME2            PIC X(66)   VALUE SPACES.                    
           05  FILLER6             PIC X(01)   VALUE SPACE.                     
           05  WS-NRIC3            PIC X(09)   VALUE SPACES.                    
           05  FILLER7             PIC X(01)   VALUE SPACE.                     
           05  WS-NAME3            PIC X(66)   VALUE SPACES.                    
           05  FILLER8             PIC X(01)   VALUE SPACE.                     
           05  WS-NRIC4            PIC X(09)   VALUE SPACES.                    
           05  FILLER9             PIC X(01)   VALUE SPACE.                     
           05  WS-NAME4            PIC X(66)   VALUE SPACES.                    
           05  FILLER10            PIC X(01)   VALUE SPACE.                     
           05  WS-HH               PIC X(01)   VALUE SPACE.                     
           05  FILLER11            PIC X(01)   VALUE SPACE.                     
           05  WS-BAL-HH           PIC X(01)   VALUE SPACE.                     
           05  FILLER12            PIC X(01)   VALUE SPACE.                     
           05  WS-NT1              PIC X(03)   VALUE SPACES.                    
           05  FILLER13            PIC X(01)   VALUE SPACE.                     
           05  WS-FT               PIC X(02)   VALUE SPACES.                    
           05  FILLER14            PIC X(01)   VALUE SPACE.                     
           05  WS-CAT              PIC X(01)   VALUE SPACE.                     
           05  FILLER15            PIC X(01)   VALUE SPACE.                     
           05  WS-ALLO             PIC X(03)   VALUE SPACES.                    
           05  FILLER16            PIC X(01)   VALUE SPACE.                     
           05  WS-ELIG             PIC X(03)   VALUE SPACES.                    
           05  FILLER17            PIC X(01)   VALUE SPACE.                     
           05  WS-QUEUE            PIC X(05)   VALUE SPACES.                    
           05  FILLER18            PIC X(01)   VALUE SPACE.                     
           05  WS-RESULT           PIC X(01)   VALUE SPACES.                    
           05  FILLER19            PIC X(01)   VALUE SPACE.                     
           05  WS-SERIAL           PIC X(05)   VALUE SPACES.                    
           05  FILLER20            PIC X(01)   VALUE SPACE.                     
           05  WS-MCP              PIC X(01)   VALUE SPACE.                     
           05  FILLER21            PIC X(01)   VALUE SPACE.                     
           05  WS-MCP-ELIG         PIC X(01)   VALUE SPACE.                     
           05  FILLER22            PIC X(01)   VALUE SPACE.                     
           05  WS-PORT             PIC X(01)   VALUE SPACE.                     
           05  FILLER23            PIC X(01)   VALUE SPACE.                     
           05  WS-DREQ             PIC X(08)   VALUE SPACES.                    
           05  FILLER24            PIC X(01)   VALUE SPACE.                     
           05  WS-PROV             PIC X(01)   VALUE SPACE.                     
           05  FILLER25            PIC X(01)   VALUE SPACE.                     
           05  WS-PROV-RSN         PIC X(02)   VALUE SPACES.                    
           05  FILLER26            PIC X(01)   VALUE SPACE.                     
           05  WS-OIC              PIC X(05)   VALUE SPACES.                    
           05  FILLER27            PIC X(01)   VALUE SPACE.                     
           05  WS-EMAIL            PIC X(50)   VALUE SPACES.                    
           05  FILLER28            PIC X(01)   VALUE SPACE.                     
           05  WS-CTZEN-HH         PIC X(03)   VALUE SPACE.                     
           05  FILLER29            PIC X(01)   VALUE SPACE.                     
           05  WS-NUM-LOAN-TAG     PIC X(01)   VALUE SPACE.                     
           05  FILLER30            PIC X(01)   VALUE SPACE.                     
           05  WS-PREM-CODE        PIC X(03)   VALUE SPACE.                     
           05  FILLER31            PIC X(01)   VALUE SPACE.                     
           05  WS-PREE-STATUS      PIC X(01)   VALUE SPACE.                     
           05  FILLER32            PIC X(01)   VALUE SPACE.                     
           05  WS-CORR-ADDRESS     PIC X(60)   VALUE SPACE.                     
           05  FILLER33            PIC X(01)   VALUE SPACE.                     
           05  WS-FND-F740         PIC X(01)   VALUE SPACE.                     
           05  FILLER34            PIC X(01)   VALUE SPACE.                     
           05  WS-MGPS-TAG         PIC X(01)   VALUE SPACE.                     
           05  FILLER35            PIC X(01)   VALUE SPACE.                     
           05  WS-MGPS-QUEUE       PIC X(05)   VALUE SPACE.                     
           05  FILLER36            PIC X(01)   VALUE SPACE.                     
           05  WS-MGPS-RESULT      PIC X(01)   VALUE SPACE.                     
           05  FILLER37            PIC X(01)   VALUE SPACE.                     
           05  WS-BROCHURE         PIC X(01)   VALUE SPACE.                     
           05  FILLER38            PIC X(01)   VALUE SPACE.                     
           05  WS-PPS-ELIG         PIC X(01)   VALUE SPACE.                     
           05  FILLER39            PIC X(01)   VALUE SPACE.                     
           05  WS-PPS-QUOTA        PIC X(01)   VALUE SPACE.                     
           05  FILLER40            PIC X(01)   VALUE SPACE.                     
           05  WS-AST-ELIG         PIC X(01)   VALUE SPACE.                     
           05  FILLER41            PIC X(01)   VALUE SPACE.                     
           05  WS-AST-QUOTA        PIC X(01)   VALUE SPACE.                     
           05  FILLER42            PIC X(01)   VALUE SPACE.                     
           05  WS-FT2T             PIC X(01)   VALUE SPACE.                     
           05  FILLER43            PIC X(01)   VALUE SPACE.                     
           05  WS-GEN3             PIC X(01)   VALUE SPACE.                     
           05  FILLER44            PIC X(01)   VALUE SPACE.                     
           05  WS-SAS              PIC X(01)   VALUE SPACE.                     
           05  FILLER45            PIC X(01)   VALUE SPACE.                     
           05  WS-SAS-CNT          PIC X(02)   VALUE SPACE.                     
           05  FILLER46            PIC X(01)   VALUE SPACE.                     
           05  WS-NTIMER           PIC X(01)   VALUE SPACE.                     
           05  FILLER47            PIC X(01)   VALUE SPACE.                     
           05  WS-ELDERLY          PIC X(01)   VALUE SPACE.                     
           05  FILLER48            PIC X(01)   VALUE SPACE.                     
           05  WS-ELD-EXEMPT       PIC X(01)   VALUE SPACE.                     
           05  FILLER49            PIC X(01)   VALUE SPACE.                     
           05  WS-ELD-PREM         PIC X(01)   VALUE SPACE.                     
           05  FILLER50            PIC X(01)   VALUE SPACE.                     
                                                                                
       PROCEDURE DIVISION.                                                      
      *-------------------------------------------------------------            
       0000-MAIN.                                                               
           PERFORM 1000-OPENING-ROUTINE  THRU 1000-EXIT.                        
           PERFORM 2000-READ-F740        THRU 2000-EXIT.                        
           PERFORM 2100-READ-F740MTCH    THRU 2100-EXIT.                        
           PERFORM 4000-PROCESS-FILES    THRU 4000-EXIT                         
                   UNTIL WS-EOF = 'Y'.                                          
           PERFORM 9000-CLOSING-ROUTINE   THRU 9000-EXIT.                       
                                                                                
       0000-EXIT.                                                               
            EXIT.                                                               
                                                                                
       1000-OPENING-ROUTINE.                                                    
      *-------------------------------------------------------------            
           OPEN INPUT  BP13F740                                                 
                       F740MTCH                                                 
                       BP13K830                                                 
                       BP13K857                                                 
                       BP13K022                                                 
                       BP13K820                                                 
                       BP13K800                                                 
                       BP13KB00                                                 
                OUTPUT P13F740A.                                                
                                                                                
           IF WS-K857-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K857 OPEN ERROR, STATUS IS ' WS-K857-STATUS          
              MOVE WS-K857-STATUS              TO RETURN-CODE                   
              PERFORM  9000-CLOSING-ROUTINE  THRU 9000-EXIT                     
           END-IF.                                                              
                                                                                
           IF WS-K830-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K830 OPEN ERROR, STATUS IS ' WS-K830-STATUS          
              MOVE WS-K830-STATUS              TO RETURN-CODE                   
              PERFORM  9000-CLOSING-ROUTINE  THRU 9000-EXIT                     
           END-IF.                                                              
                                                                                
           IF WS-K022-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K022 OPEN ERROR, STATUS IS ' WS-K022-STATUS          
              MOVE WS-K022-STATUS              TO RETURN-CODE                   
              PERFORM  9000-CLOSING-ROUTINE  THRU 9000-EXIT                     
           END-IF.                                                              
                                                                                
           IF WS-K820-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K820 OPEN ERROR, STATUS IS ' WS-K820-STATUS          
              MOVE WS-K820-STATUS              TO RETURN-CODE                   
              PERFORM  9000-CLOSING-ROUTINE  THRU 9000-EXIT                     
           END-IF.                                                              
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K800 OPEN ERROR, STATUS IS ' WS-K800-STATUS          
              MOVE WS-K800-STATUS              TO RETURN-CODE                   
              PERFORM  9000-CLOSING-ROUTINE  THRU 9000-EXIT                     
           END-IF.                                                              
                                                                                
           IF WS-KB00-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13KB00 OPEN ERROR, STATUS IS ' WS-KB00-STATUS          
              MOVE WS-KB00-STATUS              TO RETURN-CODE                   
              PERFORM  9000-CLOSING-ROUTINE  THRU 9000-EXIT                     
           END-IF.                                                              
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
       2000-READ-F740.                                                          
      *-------------------------------------------------------------            
            READ BP13F740 AT END                                                
                 MOVE 'Y' TO WS-EOF                                             
                 GO TO 2000-EXIT.                                               
            ADD 1 TO NO-F740-READ.                                              
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
       2100-READ-F740MTCH.                                                      
      *-------------------------------------------------------------            
            READ F740MTCH AT END                                                
                 MOVE 'Y' TO WS-EOF-MATCH                                       
                 GO TO 2100-EXIT.                                               
            ADD 1 TO NO-F740-MATCH-READ.                                        
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
       2200-PROC-F740MTCH.                                                      
      *-------------------------------------------------------------            
                                                                                
           MOVE ' '                        TO   WS-FND-F740                     
                                                                                
           IF F740-REGN = F740-NUM-REGN                                         
              MOVE 'Y'   TO WS-PROCESS                                          
              MOVE 'Y'   TO WS-FND-F740                                         
              PERFORM 2100-READ-F740MTCH      THRU 2100-EXIT                    
           ELSE                                                                 
              IF F740-REGN < F740-NUM-REGN                                      
                 PERFORM 2100-READ-F740MTCH      THRU 2100-EXIT                 
                 CONTINUE                                                       
              ELSE                                                              
                  MOVE 'Y'   TO WS-PROCESS                                      
                  MOVE ' '   TO WS-FND-F740                                     
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-EOF-MATCH = 'Y'                                                
              GO TO 2200-EXIT                                                   
           END-IF.                                                              
                                                                                
       2200-EXIT.                                                               
           EXIT.                                                                
                                                                                
       4000-PROCESS-FILES.                                                      
      *-------------------------------------------------------------            
           PERFORM 4100-INITIALIZE-REC  THRU 4100-EXIT.                         
           MOVE 'N'                     TO WS-PROCESS.                          
                                                                                
           MOVE F740-NUM-REGN  TO K820-NUM-REGN                                 
                                                                                
           IF F740-NUM-NRIC1 NOT = SPACES  AND LOW-VALUES                       
              MOVE F740-NUM-NRIC1  TO K820-NUM-NRIC                             
              PERFORM 4200-READ-BP13K820   THRU 4200-EXIT                       
              IF WS-K820-FND = 'Y'                                              
                 MOVE F740-NUM-NRIC1  TO WS-NRIC1                               
                 MOVE K820-NME-OCCP   TO WS-NAME1                               
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F740-NUM-NRIC2 NOT = SPACES  AND LOW-VALUES                       
              MOVE F740-NUM-NRIC2  TO K820-NUM-NRIC                             
              PERFORM 4200-READ-BP13K820   THRU 4200-EXIT                       
              IF WS-K820-FND = 'Y'                                              
                 MOVE F740-NUM-NRIC2  TO WS-NRIC2                               
                 MOVE K820-NME-OCCP   TO WS-NAME2                               
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F740-NUM-NRIC3 NOT = SPACES  AND LOW-VALUES                       
              MOVE F740-NUM-NRIC3  TO K820-NUM-NRIC                             
              PERFORM 4200-READ-BP13K820   THRU 4200-EXIT                       
              IF WS-K820-FND = 'Y'                                              
                 MOVE F740-NUM-NRIC3  TO WS-NRIC3                               
                 MOVE K820-NME-OCCP   TO WS-NAME3                               
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F740-NUM-NRIC4 NOT = SPACES  AND LOW-VALUES                       
              MOVE F740-NUM-NRIC4  TO K820-NUM-NRIC                             
              PERFORM 4200-READ-BP13K820   THRU 4200-EXIT                       
              IF WS-K820-FND = 'Y'                                              
                 MOVE F740-NUM-NRIC4  TO WS-NRIC4                               
                 MOVE K820-NME-OCCP   TO WS-NAME4                               
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE F740-NUM-REGN    TO  K022-NUM-REGN                              
           PERFORM 4400-READ-BP13K022  THRU 4400-EXIT.                          
           IF WS-K022-FND = 'Y'                                                 
              MOVE K022-NUM-OIC    TO WS-OIC                                    
           END-IF.                                                              
                                                                                
           MOVE F740-NUM-REGN    TO K857-NUM-REGN                               
           PERFORM 4300-READ-BP13K857  THRU 4300-EXIT.                          
           IF WS-K857-FND = 'Y'                                                 
              MOVE K857-NUM-EMAIL   TO WS-EMAIL                                 
           END-IF.                                                              
                                                                                
           MOVE F740-NUM-REGN    TO K800-NUM-REGN                               
           PERFORM 4500-READ-BP13K800  THRU 4500-EXIT.                          
           IF WS-K800-FND = 'Y'                                                 
              MOVE K800-NUM-SALE-BROCHURE-SCPY    TO WS-BROCHURE                
              MOVE K800-NUM-PPS-ELIG              TO WS-PPS-ELIG                
              MOVE K800-NUM-PPS-QUOTA             TO WS-PPS-QUOTA               
              MOVE K800-NUM-AST-ELIG              TO WS-AST-ELIG                
              MOVE K800-NUM-AST-QUOTA             TO WS-AST-QUOTA               
              MOVE K800-CDE-CITIZENSHIP-HOUSEHOLD TO WS-CTZEN-HH                
              MOVE K800-NUM-FT2T                  TO WS-FT2T                    
              MOVE K800-NUM-GEN3                  TO WS-GEN3                    
              MOVE K800-NUM-LOAN-TAG              TO WS-NUM-LOAN-TAG            
              MOVE K800-NUM-PREM-CODE             TO WS-PREM-CODE               
              MOVE K800-NUM-MGPS                  TO WS-MGPS-TAG                
              MOVE K800-NUM-QUEUE-MGPS            TO WS-MGPS-QUEUE              
              IF K800-NUM-MGPS = 'P' OR 'C'                                     
                 IF K800-NUM-QUEUE-MGPS = SPACES                                
                    MOVE 'U'                      TO WS-MGPS-RESULT             
                 ELSE                                                           
                    MOVE 'S'                      TO WS-MGPS-RESULT             
                 END-IF                                                         
              END-IF                                                            
              MOVE K800-NUM-ELDERLY-EXEMPTION     TO WS-ELD-EXEMPT              
              MOVE K800-NUM-ELDERLY-PREMIUM       TO WS-ELD-PREM                
           END-IF.                                                              
                                                                                
           MOVE F740-NUM-REGN    TO K830-NUM-REGN                               
           PERFORM 4700-READ-BP13K830  THRU 4700-EXIT.                          
           IF WS-K830-FND = 'Y'                                                 
             STRING 'BLK ' K830-NUM-MAIN-BLK ' ' K830-NME-STREET(1:25)          
             '#' K830-NUM-LVL-NUM '-' K830-NUM-HSEMAIN                          
             K830-NUM-HSESUB '  S(' K830-NUM-POSTAL ')'                         
             DELIMITED BY SIZE INTO WS-CORR-ADDRESS                             
                                                                                
           END-IF.                                                              
                                                                                
           IF F740-CDE-REQUEST-STATUS NOT = 'U'                                 
              MOVE SPACES           TO BP13KB00-REC                             
              MOVE F740-NUM-REGN    TO KB00-NUM-REGN                            
              PERFORM 4600-READ-BP13KB00  THRU 4600-EXIT                        
              IF WS-KB00-FND = 'Y'                                              
                 IF KB00-NUM-PREE-STATUS = 'ACC' OR 'REJ'                       
                    MOVE 'Y'     TO WS-PREE-STATUS                              
                 ELSE                                                           
                    MOVE 'N'     TO WS-PREE-STATUS                              
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              ADD  1 TO WS-U-STATUS                                             
           END-IF.                                                              
                                                                                
           MOVE F740-NUM-REF                  TO WS-REF-NUM.                    
           MOVE F740-NUM-REGN                 TO WS-REG-NUM.                    
           MOVE F740-CDE-HOUSEHOLD            TO WS-HH.                         
           MOVE F740-CDE-BALLOT-HOUSEHOLD     TO WS-BAL-HH.                     
           MOVE F740-CDE-NT1                  TO WS-NT1.                        
           MOVE F740-CDE-FLAT-TYPE            TO WS-FT.                         
           MOVE F740-CDE-CATEGORY             TO WS-CAT.                        
           MOVE F740-CDE-ALLOC-SCH            TO WS-ALLO.                       
           MOVE F740-CDE-ELIG-SCH             TO WS-ELIG.                       
           MOVE F740-NUM-NT-FT-QUEUE          TO WS-QUEUE.                      
           MOVE F740-CDE-REQUEST-STATUS       TO WS-RESULT.                     
           MOVE F740-NUM-APPLN-SERIAL         TO WS-SERIAL.                     
           MOVE F740-NUM-MCPS                 TO WS-MCP.                        
           MOVE F740-CDE-RESIDENT-HA1         TO WS-MCP-ELIG.                   
           MOVE F740-NUM-PORT-ELIG-TAG        TO WS-PORT.                       
           MOVE F740-NUM-PROV-TAG             TO WS-PROV.                       
           MOVE F740-NUM-PROV-REASON          TO WS-PROV-RSN.                   
           MOVE F740-DTE-REQUEST              TO WS-DREQ.                       
           MOVE F740-NUM-HARDLUCK             TO WS-SAS.                        
           MOVE F740-NUM-HARDLUCK-COUNT       TO WS-SAS-CNT.                    
           MOVE F740-NUM-NTIMER               TO WS-NTIMER.                     
           MOVE F740-NUM-ELDERLY              TO WS-ELDERLY.                    
                                                                                
           PERFORM 2200-PROC-F740MTCH       THRU 2200-EXIT                      
                 UNTIL WS-PROCESS = 'Y' OR WS-EOF-MATCH = 'Y'.                  
                                                                                
           WRITE P13F740A-REC   FROM WS-DETAILS.                                
           ADD 1 TO WS-WRITTEN.                                                 
                                                                                
           PERFORM 2000-READ-F740 THRU 2000-EXIT.                               
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
       4100-INITIALIZE-REC.                                                     
      *-------------------------------------------------------------            
                                                                                
           MOVE SPACES     TO WS-DETAILS.                                       
           MOVE  ';'       TO FILLER1    FILLER2                                
                              FILLER3    FILLER4                                
                              FILLER5    FILLER6                                
                              FILLER7    FILLER8                                
                              FILLER9    FILLER10                               
                              FILLER11   FILLER12                               
                              FILLER13   FILLER14                               
                              FILLER15   FILLER16                               
                              FILLER17   FILLER18                               
                              FILLER19   FILLER20                               
                              FILLER21   FILLER22                               
                              FILLER23   FILLER24                               
                              FILLER25   FILLER26                               
                              FILLER27   FILLER28                               
                              FILLER29   FILLER30                               
                              FILLER31   FILLER32                               
                              FILLER33   FILLER34                               
                              FILLER35   FILLER36                               
                              FILLER37   FILLER38                               
                              FILLER39   FILLER40                               
                              FILLER41   FILLER42                               
                              FILLER43   FILLER44                               
                              FILLER45   FILLER46                               
                              FILLER47   FILLER48                               
                              FILLER49   FILLER50.                              
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
       4200-READ-BP13K820.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13K820.                                                       
                                                                                
           EVALUATE WS-K820-STATUS                                              
            WHEN 00                                                             
               MOVE 'Y' TO WS-K820-FND                                          
               ADD   1  TO NO-K820-FND                                          
            WHEN 23                                                             
               MOVE 'N' TO WS-K820-FND                                          
               ADD   1  TO NO-K820-NOT-FND                                      
            WHEN OTHER                                                          
              DISPLAY 'ERROR READING OF BP13K820. STATUS IS '                   
                       WS-K820-STATUS                                           
              MOVE WS-K820-STATUS              TO RETURN-CODE                   
              PERFORM  9000-CLOSING-ROUTINE  THRU 9000-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       4300-READ-BP13K857.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13K857.                                                       
                                                                                
           EVALUATE WS-K857-STATUS                                              
            WHEN 00                                                             
               IF K857-NUM-EMAIL NOT = SPACES AND LOW-VALUES                    
                  MOVE 'Y' TO WS-K857-FND                                       
                  ADD   1  TO NO-K857-FND                                       
               ELSE                                                             
                  MOVE 'N' TO WS-K857-FND                                       
                  ADD   1  TO NO-K857-NOT-FND                                   
               END-IF                                                           
            WHEN 23                                                             
               MOVE 'N' TO WS-K857-FND                                          
               ADD   1  TO NO-K857-NOT-FND                                      
            WHEN OTHER                                                          
              DISPLAY 'ERROR READING OF BP13K857. STATUS IS '                   
                       WS-K857-STATUS                                           
              MOVE WS-K857-STATUS              TO RETURN-CODE                   
              PERFORM  9000-CLOSING-ROUTINE  THRU 9000-EXIT                     
           END-EVALUATE.                                                        
       4300-EXIT.                                                               
           EXIT.                                                                
                                                                                
       4400-READ-BP13K022.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13K022  KEY IS K022-NUM-REGN                                  
                                                                                
           EVALUATE WS-K022-STATUS                                              
            WHEN 00                                                             
            WHEN 02                                                             
               MOVE 'Y' TO  WS-K022-FND                                         
               ADD   1  TO  NO-K022-FND                                         
            WHEN 23                                                             
               MOVE 'N' TO WS-K022-FND                                          
               ADD   1  TO NO-K022-NOT-FND                                      
            WHEN OTHER                                                          
              DISPLAY 'ERROR READING OF BP13K022. STATUS IS '                   
                       WS-K022-STATUS                                           
              MOVE WS-K022-STATUS              TO RETURN-CODE                   
              PERFORM  9000-CLOSING-ROUTINE  THRU 9000-EXIT                     
           END-EVALUATE.                                                        
       4400-EXIT.                                                               
           EXIT.                                                                
                                                                                
       4500-READ-BP13K800.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13K800.                                                       
                                                                                
           EVALUATE WS-K800-STATUS                                              
            WHEN 00                                                             
               MOVE 'Y' TO WS-K800-FND                                          
               ADD   1  TO NO-K800-FND                                          
            WHEN 23                                                             
               MOVE 'N' TO WS-K800-FND                                          
               ADD   1  TO NO-K800-NOT-FND                                      
            WHEN OTHER                                                          
              DISPLAY 'ERROR READING OF BP13K800. STATUS IS '                   
                       WS-K800-STATUS                                           
              MOVE WS-K800-STATUS              TO RETURN-CODE                   
              PERFORM  9000-CLOSING-ROUTINE  THRU 9000-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
       4600-READ-BP13KB00.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13KB00.                                                       
                                                                                
           EVALUATE WS-KB00-STATUS                                              
            WHEN 00                                                             
               MOVE 'Y' TO WS-KB00-FND                                          
               ADD   1  TO NO-KB00-FND                                          
            WHEN 23                                                             
               MOVE 'N' TO WS-KB00-FND                                          
               ADD   1  TO NO-KB00-NOT-FND                                      
            WHEN OTHER                                                          
              DISPLAY 'ERROR READING OF BP13KB00. STATUS IS '                   
                       WS-KB00-STATUS                                           
              MOVE WS-KB00-STATUS              TO RETURN-CODE                   
              PERFORM  9000-CLOSING-ROUTINE  THRU 9000-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       4600-EXIT.                                                               
           EXIT.                                                                
                                                                                
       4700-READ-BP13K830.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13K830  KEY IS K830-NUM-REGN.                                 
                                                                                
           EVALUATE WS-K830-STATUS                                              
            WHEN 00                                                             
               MOVE 'Y' TO WS-K830-FND                                          
               ADD   1  TO NO-K830-FND                                          
            WHEN 23                                                             
               MOVE 'N' TO WS-K830-FND                                          
               ADD   1  TO NO-K830-NOT-FND                                      
            WHEN OTHER                                                          
              DISPLAY 'ERROR READING OF BP13K830. STATUS IS '                   
                       WS-K830-STATUS                                           
              MOVE WS-K830-STATUS              TO RETURN-CODE                   
              PERFORM  9000-CLOSING-ROUTINE  THRU 9000-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       4700-EXIT.                                                               
           EXIT.                                                                
                                                                                
       9000-CLOSING-ROUTINE.                                                    
      *-------------------------------------------------------------            
           CLOSE P13F740A                                                       
                 BP13K022                                                       
                 BP13K820                                                       
                 BP13F740                                                       
                 BP13K857                                                       
                 BP13K800                                                       
                 BP13KB00.                                                      
                                                                                
           DISPLAY 'NO. OF F740 REC READ     > ' NO-F740-READ                   
           DISPLAY 'NO. OF K022 REC FOUND    > ' NO-K022-FND                    
           DISPLAY 'NO. OF K022 REC NOT FOUND> ' NO-K022-NOT-FND                
           DISPLAY 'NO. OF K820 REC FOUND    > ' NO-K820-FND                    
           DISPLAY 'NO. OF K820 REC NOT FOUND> ' NO-K820-NOT-FND                
           DISPLAY 'NO. OF K857 REC FOUND    > ' NO-K857-FND                    
           DISPLAY 'NO. OF K857 REC NOT FOUND> ' NO-K857-NOT-FND                
           DISPLAY 'NO. OF K800 REC FOUND    > ' NO-K800-FND                    
           DISPLAY 'NO. OF K800 REC NOT FOUND> ' NO-K800-NOT-FND                
           DISPLAY 'NO. OF KB00 REC FOUND    > ' NO-KB00-FND                    
           DISPLAY 'NO. OF KB00 REC NOT FOUND> ' NO-KB00-NOT-FND                
           DISPLAY 'NO. U REQUEST STATUS     > ' NO-KB00-NOT-FND                
           DISPLAY 'NO. OF CASES WRITTEN     > ' WS-WRITTEN                     
                                                                                
           IF WS-K857-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K857 CLOSE ERROR, STAT IS '  WS-K857-STATUS          
              MOVE WS-K857-STATUS              TO RETURN-CODE                   
           END-IF.                                                              
                                                                                
           IF WS-K022-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K022 CLOSE ERROR, STAT IS '  WS-K022-STATUS          
              MOVE WS-K022-STATUS              TO RETURN-CODE                   
           END-IF.                                                              
                                                                                
           IF WS-K820-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K820 CLOSE ERROR, STAT IS '  WS-K820-STATUS          
              MOVE WS-K820-STATUS              TO RETURN-CODE                   
           END-IF.                                                              
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K800 CLOSE ERROR, STAT IS '  WS-K800-STATUS          
              MOVE WS-K800-STATUS              TO RETURN-CODE                   
           END-IF.                                                              
                                                                                
           IF WS-KB00-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13KB00 CLOSE ERROR, STAT IS '  WS-KB00-STATUS          
              MOVE WS-KB00-STATUS              TO RETURN-CODE                   
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
