      *-----------------------*                                         00010000
       IDENTIFICATION DIVISION.                                         00020000
      *-----------------------*                                         00030000
       PROGRAM-ID.    BP13C02B.                                         00040000
      *AUTHOR.        CECIL.                                            00050000
      *DTE WRITTEN.   12DEC2002.                                        00060000
      **********************************************************        00070000
      *    SYSTEM NAME : SYSTEM OF COMMITMENT                  *        00080000
      *    SYSTEM ID   : BP13                                  *        00090000
      **********************************************************        00100000
      *                                                        *        00110000
      *    OBJECTIVES  :                                       *        00120000
      *                                                        *        00130000
      *    1.  TO CREATE BP13K730 AND BP13K825 RECORDS WITH    *        00140000
      *        THE FILE FROM UPLOADED FROM DBS INTERNET MODULE.*        00150000
      *        (SIMILAR TO BP13C796, BP13C023)                 *        00160000
      *                                                        *        00170000
      *    INPUT FILES : BP13FB78 - DBS FILE                   *        00180000
      *                                                        *        00190000
      *    INPUT-OUTPUT: BP13K730 - MATURE REQUEST FOR REGN    *        00200000
      *                  BP13K830 - CORR ADDRESS FILE          *        00210000
      *                                                        *        00220000
      *    OUTPUT FILE : BP13L02B - LIST OF APPLICANTS W/O     *        00230000
      *                             REGISTRATION NUMBER        *        00240000
      *                  BE01F500 - MHA INTERFACE FILE         *        00250000
      *                                                        *        00260000
      *    SUBROUTINES :                                       *        00270000
      *                                                        *        00280000
      *--------------------------------------------------------*        00290000
      * CHG-NO   BY    DATE   DETAILS                          *        00300000
      * ======= ====  ======  ================================ *        00310000
      * BP132886 LSB  061006  NEW PROGRAM                      *        00320000
      * BP133323 JB8  220708  CATER FOR DIFFERENT PROJ CODE    *        00330000
      * BP133505 IL5  190109  HARDCODE BALLOT DATE FOR D04     *        00340000
      * BP133533 IL5  140409  HARDCODE BALLOT DATE FOR D05     *        00350000
      * BP133541 IL5  140409  HARDCODE BALLOT DATE FOR D06     *        00360000
      * BP134025 IL5  300910  CATER FOR EC                     *        00370000
      * BP134067 IL5  251111  HARDCODE BALLOT DATE FOR D07     *        00380000
      * BP134211 IL5  150611  HARDCODE BALLOT DATE FOR D08     *        00390000
      * BP138971 KR13 211221  CATER FOR NEW FIN SERIES 'M'     *        00391002
      * ====================================================== *        00400000
                                                                        00410000
      *-----------------------*                                         00420000
       ENVIRONMENT DIVISION.                                            00430000
      *-----------------------*                                         00440000
       CONFIGURATION SECTION.                                           00450000
      *-----------------------*                                         00460000
                                                                        00470000
       SOURCE-COMPUTER. IBM-9121.                                       00480000
       OBJECT-COMPUTER. IBM-9121.                                       00490000
                                                                        00500000
      *-----------------------*                                         00510000
       INPUT-OUTPUT SECTION.                                            00520000
      *-----------------------*                                         00530000
       FILE-CONTROL.                                                    00540000
                                                                        00550000
           SELECT BP13FB78 ASSIGN    TO BP13FB78.                       00560000
                                                                        00570000
           SELECT BE01F500 ASSIGN    TO BE01F500.                       00580000
                                                                        00590000
           SELECT BP13K830 ASSIGN    TO BP13K830                        00600000
                ACCESS MODE          IS RANDOM                          00610000
                ORGANIZATION         IS INDEXED                         00620000
                RECORD KEY           IS K830-KEY-FLD                    00630000
                FILE STATUS          IS WS-K830-STATUS.                 00640000
                                                                        00650000
           SELECT BP13K730 ASSIGN    TO BP13K730                        00660000
                ACCESS MODE          IS  RANDOM                         00670000
                ORGANIZATION         IS INDEXED                         00680000
                RECORD KEY           IS K730-KEY-NEW                    00690000
                FILE STATUS          IS WS-K730-STATUS.                 00700000
                                                                        00710000
           SELECT BP13K825 ASSIGN    TO BP13K825                        00720000
                ACCESS MODE          IS RANDOM                          00730000
                ORGANIZATION         IS INDEXED                         00740000
                RECORD KEY           IS K825-KEY-FLD                    00750000
                FILE STATUS          IS WS-K825-STATUS.                 00760000
                                                                        00770000
           SELECT BP13L02B ASSIGN    TO BP13L02B.                       00780000
                                                                        00790000
                                                                        00800000
      *-----------------------*                                         00810000
       DATA DIVISION.                                                   00820000
      *-----------------------*                                         00830000
       FILE SECTION.                                                    00840000
      *-----------------------*                                         00850000
                                                                        00860000
       FD   BP13FB78                                                    00870000
            BLOCK      CONTAINS 0    RECORDS                            00880000
            RECORD     CONTAINS 3300 CHARACTERS                         00890000
            LABEL      RECORDS  ARE  STANDARD                           00900000
            RECORDING  MODE     IS  F.                                  00910000
       COPY BP13FB78.                                                   00920000
                                                                        00930000
       FD   BE01F500                                                    00940000
            BLOCK      CONTAINS 0   RECORDS                             00950000
            RECORD     CONTAINS 50  CHARACTERS                          00960000
            LABEL      RECORDS  ARE STANDARD                            00970000
            RECORDING  MODE     IS  F.                                  00980000
       COPY BE01F500.                                                   00990000
                                                                        01000000
       FD   BP13K830                                                    01010000
            RECORD     CONTAINS 250 CHARACTERS.                         01020000
       COPY BP13K830.                                                   01030000
                                                                        01040000
       FD   BP13K730                                                    01050000
            RECORD     CONTAINS 500 CHARACTERS.                         01060000
       COPY BP13K730.                                                   01070000
                                                                        01080000
       FD   BP13K825                                                    01090000
            RECORD     CONTAINS 200 CHARACTERS.                         01100000
       COPY BP13K825.                                                   01110000
                                                                        01120000
       FD   BP13L02B                                                    01130000
            BLOCK     CONTAINS 0   RECORDS                              01140000
            RECORD    CONTAINS 132 CHARACTERS                           01150000
            LABEL     RECORDS  ARE OMITTED                              01160000
            RECORDING MODE     IS  F.                                   01170000
       01   BP13L02B-REC           PIC X(132).                          01180000
                                                                        01190000
                                                                        01200000
      *-----------------------*                                         01210000
       WORKING-STORAGE SECTION.                                         01220000
      *-----------------------*                                         01230000
                                                                        01240000
       COPY IDPTABLE.                                                   01250000
                                                                        01260000
       01  WS-FILE-CONTROLS.                                            01270000
           05  WS-K830-STATUS             PIC 9(2)    VALUE  0.         01280000
           05  WS-K825-STATUS             PIC 9(2)    VALUE  0.         01290000
           05  WS-K730-STATUS             PIC 9(2)    VALUE  0.         01300000
           05  WS-FB78-EOF-SW             PIC X(1)    VALUE 'N'.        01310000
                                                                        01320000
       01  WS-L02B-CONTROLS.                                            01330000
           05  WS-L02B-LINECTR            PIC 9(2)    VALUE 25.         01340000
           05  WS-L02B-PAGECTR            PIC 9(4)    VALUE 0.          01350000
           05  WS-L02B-S-NO               PIC 9(5)    VALUE 0.          01360000
                                                                        01370000
       01  WS-RECORD-COUNTERS.                                          01380000
           05  WS-FB78-READ-CTR           PIC 9(5)    VALUE 0.          01390000
           05  WS-F500-WRITE-CTR          PIC 9(5)    VALUE 0.          01400000
           05  WS-K830-WRITE-CTR          PIC 9(5)    VALUE 0.          01410000
           05  WS-K830-DUP-CTR            PIC 9(5)    VALUE 0.          01420000
           05  WS-K830-ERROR-CTR          PIC 9(5)    VALUE 0.          01430000
           05  WS-K825-WRITE-CTR          PIC 9(5)    VALUE 0.          01440000
           05  WS-K825-DUP-CTR            PIC 9(5)    VALUE 0.          01450000
           05  WS-K825-ERROR-CTR          PIC 9(5)    VALUE 0.          01460000
           05  WS-K730-WRITE-CTR          PIC 9(5)    VALUE 0.          01470000
           05  WS-K730-DUP-CTR            PIC 9(5)    VALUE 0.          01480000
           05  WS-K730-ERROR-CTR          PIC 9(5)    VALUE 0.          01490000
                                                                        01500000
       01  WS-DATES.                                                    01510000
           05  WS-EDITED-DATE.                                          01520000
               10  WS-EDITED-DD           PIC 9(2).                     01530000
               10  FILLER                 PIC X(1)    VALUE '/'.        01540000
               10  WS-EDITED-MM           PIC 9(2).                     01550000
               10  FILLER                 PIC X(1)    VALUE '/'.        01560000
               10  WS-EDITED-YY           PIC 9(4).                     01570000
           05  WS-CURRENT-DATE.                                         01580000
               10  WS-CURR-CCYY.                                        01590000
                   15  WS-CURR-YY         PIC 9(4).                     01600000
               10  WS-CURR-MM             PIC 9(2).                     01610000
               10  WS-CURR-DD             PIC 9(2).                     01620000
                                                                        01630000
       01  WS-SYSTEM-DATE.                                              01640000
           05  WS-SYS-YY                  PIC 9(4).                     01650000
           05  WS-SYS-MM                  PIC 9(2).                     01660000
           05  WS-SYS-DD                  PIC 9(2).                     01670000
                                                                        01680000
       01  WS-TEMPORARY-FIELDS.                                         01690000
           05  WS-TEMP-NAME               PIC X(66).                    01700000
           05  WS-TEMP-DTE-BIRTH          PIC X(10).                    01710000
           05  WS-TEMP-REGN               PIC X(8).                     01720000
           05  WS-TEMP-NRIC               PIC X(9).                     01730000
           05  WS-TEMP-MSTATUS            PIC X(1).                     01740000
           05  WS-TEMP-INCOME             PIC X(5).                     01750000
           05  WS-TEMP-CITIZENSHIP        PIC X(2).                     01760000
           05  WS-TEMP-RELATIONSHIP       PIC X(2).                     01770000
           05  WS-TEMP-LESSEE             PIC X(1).                     01780000
           05  WS-TEMP-RACE               PIC X(1).                     01790000
           05  WS-TEMP-SEX                PIC X(1).                     01800000
           05  WS-TEMP-NRIC-SPOUSE        PIC X(9).                     01810000
           05  WS-TEMP-EDN-LVL            PIC X(1).                     01820000
           05  WS-TEMP-PHONE              PIC X(8).                     01830000
           05  WS-TEMP-HP-PAGER           PIC X(8).                     01840000
                                                                        01850000
       01  WS-OTHERS.                                                   01860000
           05  WS-OCC-REL                 PIC X(2).                     01870000
           05  WS-TMP-REL                 PIC X(2).                     01880000
           05  WS-TMP-EDN                 PIC 9(1).                     01890000
           05  WS-FOUND-SW                PIC X(1)    VALUE 'N'.        01900000
           05  WS-DESC                    PIC X(3)    VALUE SPACES.     01910000
                                                                        01920000
       01  WS-CONSTANT-TEXTS.                                           01930000
           05  WS-ERROR-MESSAGES.                                       01940000
               10  K-K730-DUPLICATE       PIC X(40)   VALUE             01950000
                   'DUPLICATE RECORD IN BP13K730'.                      01960000
               10  K-K730-ERROR           PIC X(40)   VALUE             01970000
                   'ERROR WRITING TO BP13K730'.                         01980000
               10  K-K825-DUPLICATE       PIC X(40)   VALUE             01990000
                   'DUPLICATE RECORD IN BP13K825'.                      02000000
               10  K-K825-ERROR           PIC X(40)   VALUE             02010000
                   'ERROR WRITING TO BP13K825'.                         02020000
               10  K-K830-DUPLICATE       PIC X(40)   VALUE             02030000
                   'DUPLICATE RECORD IN BP13K830'.                      02040000
               10  K-K830-ERROR           PIC X(40)   VALUE             02050000
                   'ERROR WRITING TO BP13K830'.                         02060000
           05  WS-TOTAL-DESC.                                           02070000
               10  K-FB78-RECORDS-READ    PIC X(50)   VALUE             02080000
                      'TOTAL RECORDS READ IN BP13FB78            : '.   02090000
               10  K-F500-RECORDS-WRITE   PIC X(50)   VALUE             02100000
                      'TOTAL RECORDS WRITE TO BE01F500           : '.   02110000
               10  K-K830-RECORDS-WRITE   PIC X(50)   VALUE             02120000
                      'TOTAL RECORDS WRITE TO BP13K830           : '.   02130000
               10  K-K830-RECORDS-DUP     PIC X(50)   VALUE             02140000
                      'TOTAL DUPLICATES ENCOUNTERED IN BP13K830  : '.   02150000
               10  K-K830-UNSUCC-WRITE    PIC X(50)   VALUE             02160000
                      'TOTAL UNSUCCESSFUL WRITES TO BP13K830     : '.   02170000
               10  K-K825-RECORDS-WRITE   PIC X(50)   VALUE             02180000
                      'TOTAL RECORDS WRITE TO BP13K825           : '.   02190000
               10  K-K825-RECORDS-DUP     PIC X(50)   VALUE             02200000
                      'TOTAL DUPLICATES ENCOUNTERED IN BP13K825  : '.   02210000
               10  K-K825-UNSUCC-WRITE    PIC X(50)   VALUE             02220000
                      'TOTAL UNSUCCESSFUL WRITES TO BP13K825     : '.   02230000
               10  K-K730-RECORDS-WRITE   PIC X(50)   VALUE             02240000
                      'TOTAL RECORDS WRITE TO BP13K730           : '.   02250000
               10  K-K730-RECORDS-DUP     PIC X(50)   VALUE             02260000
                      'TOTAL DUPLICATES ENCOUNTERED IN BP13K730  : '.   02270000
               10  K-K730-UNSUCC-WRITE    PIC X(50)   VALUE             02280000
                      'TOTAL UNSUCCESSFUL WRITES TO BP13K730     : '.   02290000
                                                                        02300000
      **************************************************************    02310000
      *       BP13L02B -  R E P O R T   L A Y O U T                *    02320000
      **************************************************************    02330000
       01  L02B-HEADING-01.                                             02340000
           05  FILLER              PIC X(08)     VALUE 'BP13L02B'.      02350000
           05  FILLER              PIC X(06)     VALUE SPACES.          02360000
           05  FILLER              PIC X(08)     VALUE 'HDB3'.          02370000
           05  FILLER              PIC X(24)     VALUE SPACES.          02380000
           05  FILLER              PIC X(39)     VALUE                  02390000
               'S Y S T E M   O F   C O M M I T M E N T'.               02400000
           05  FILLER              PIC X(13)     VALUE SPACES.          02410000
           05  FILLER              PIC X(07)     VALUE 'DATE :'.        02420000
           05  L02B-RUN-DATE       PIC X(10).                           02430000
           05  FILLER              PIC X(04)     VALUE SPACES.          02440000
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.       02450000
           05  L02B-PAGE-NO        PIC ZZZZ9 .                          02460000
                                                                        02470000
       01  L02B-HEADING-02.                                             02480000
           05  FILLER              PIC X(100)    VALUE SPACES.          02490000
           05  FILLER              PIC X(33)     VALUE                  02500000
               'SALES UNIT (APPLICATION TEAM)'.                         02510000
                                                                        02520000
       01  L02B-HEADING-03.                                             02530000
           05  FILLER              PIC X(26)     VALUE SPACES.          02540000
           05  FILLER              PIC X(78)     VALUE                  02550000
               'ERRORS ENCOUNTERED FOR INTERNET APPLICATION'.           02560000
                                                                        02570000
       01  L02B-HEADING-04.                                             02580000
           05  FILLER              PIC X(08)     VALUE SPACES.          02590000
           05  FILLER              PIC X(05)     VALUE ' S/N'.          02600000
           05  FILLER              PIC X(05)     VALUE SPACES.          02610000
           05  FILLER              PIC X(06)     VALUE 'REGN  '.        02620000
           05  FILLER              PIC X(05)     VALUE SPACES.          02630000
           05  FILLER              PIC X(09)     VALUE '  NRIC'.        02640000
           05  FILLER              PIC X(07)     VALUE SPACES.          02650000
           05  FILLER              PIC X(11)     VALUE 'ERROR NRIC'.    02660000
           05  FILLER              PIC X(05)     VALUE SPACES.          02670000
           05  FILLER              PIC X(40)     VALUE 'REMARKS'.       02680000
                                                                        02690000
       01  L02B-HEADING-05.                                             02700000
           05  FILLER              PIC X(132)    VALUE ALL '_'.         02710000
                                                                        02720000
       01  L02B-DETAIL-01.                                              02730000
           05  FILLER              PIC X(08)     VALUE SPACES.          02740000
           05  L02B-S-NO           PIC X(05).                           02750000
           05  FILLER              PIC X(05)     VALUE SPACES.          02760000
           05  L02B-REGN           PIC X(08).                           02770000
           05  FILLER              PIC X(03)     VALUE SPACES.          02780000
           05  L02B-NRIC           PIC X(09).                           02790000
           05  FILLER              PIC X(07)     VALUE SPACES.          02800000
           05  L02B-ERROR-NRIC     PIC X(09).                           02810000
           05  FILLER              PIC X(07)     VALUE SPACES.          02820000
           05  L02B-REMARKS        PIC X(40).                           02830000
           05  FILLER              PIC X(49)     VALUE SPACES.          02840000
                                                                        02850000
       01  L02B-TOTALS             REDEFINES     L02B-DETAIL-01.        02860000
           05  FILLER              PIC X(39).                           02870000
           05  L02B-TOTAL-DESC     PIC X(50).                           02880000
           05  L02B-TOTAL-VALUE    PIC X(05).                           02890000
                                                                        02900000
                                                                        02910000
      *-----------------------*                                         02920000
       PROCEDURE DIVISION.                                              02930000
      *-----------------------*                                         02940000
                                                                        02950000
      ******************************************************************02960000
       0000-MAIN.                                                       02970000
      ******************************************************************02980000
           PERFORM  1000-OPEN-FILES         THRU 1000-EXIT.             02990000
           PERFORM  2000-MAIN-ROUTINE       THRU 2000-EXIT.             03000000
           PERFORM  8000-PRINT-REPORT       THRU 8000-EXIT.             03010000
           PERFORM  9000-CLOSE-FILES        THRU 9000-EXIT.             03020000
                                                                        03030000
       0000-EXIT.                                                       03040000
           EXIT.                                                        03050000
                                                                        03060000
                                                                        03070000
      ******************************************************************03080000
       1000-OPEN-FILES.                                                 03090000
      ******************************************************************03100000
           OPEN INPUT  BP13FB78                                         03110000
                I-O    BP13K730                                         03120000
                       BP13K830                                         03130000
                       BP13K825                                         03140000
                OUTPUT BP13L02B                                         03150000
                       BE01F500.                                        03160000
                                                                        03170000
           IF WS-K730-STATUS NOT = '00' AND NOT = '97'                  03180000
              DISPLAY 'BP13K730 OPEN ERROR, STATUS IS ' WS-K730-STATUS  03190000
              MOVE     WS-K730-STATUS       TO RETURN-CODE              03200000
              PERFORM  9000-CLOSE-FILES   THRU 9000-EXIT                03210000
           END-IF.                                                      03220000
                                                                        03230000
           IF WS-K825-STATUS NOT = '00' AND NOT = '97'                  03240000
              DISPLAY 'BP13K825 OPEN ERROR, STATUS IS ' WS-K825-STATUS  03250000
              MOVE     WS-K825-STATUS       TO RETURN-CODE              03260000
              PERFORM  9000-CLOSE-FILES   THRU 9000-EXIT                03270000
           END-IF.                                                      03280000
                                                                        03290000
           IF WS-K830-STATUS NOT = '00' AND NOT = '97'                  03300000
              DISPLAY 'BP13K830 OPEN ERROR, STATUS IS ' WS-K830-STATUS  03310000
              MOVE     WS-K830-STATUS       TO RETURN-CODE              03320000
              PERFORM  9000-CLOSE-FILES   THRU 9000-EXIT                03330000
           END-IF.                                                      03340000
                                                                        03350000
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-SYSTEM-DATE.           03360000
                                                                        03370000
           MOVE   WS-SYS-YY                TO    WS-EDITED-YY           03380000
                                                 WS-CURR-YY.            03390000
           MOVE   WS-SYS-MM                TO    WS-EDITED-MM           03400000
                                                 WS-CURR-MM.            03410000
           MOVE   WS-SYS-DD                TO    WS-EDITED-DD           03420000
                                                 WS-CURR-DD.            03430000
           MOVE   WS-EDITED-DATE           TO    L02B-RUN-DATE.         03440000
                                                                        03450000
       1000-EXIT.                                                       03460000
           EXIT.                                                        03470000
                                                                        03480000
                                                                        03490000
      ******************************************************************03500000
       2000-MAIN-ROUTINE.                                               03510000
      ******************************************************************03520000
           PERFORM  3000-BP13FB78-READ     THRU 3000-EXIT.              03530000
                                                                        03540000
           PERFORM  4000-PROCESS-FB78-REC  THRU 4000-EXIT               03550000
              UNTIL WS-FB78-EOF-SW = 'Y'.                               03560000
                                                                        03570000
       2000-EXIT.                                                       03580000
           EXIT.                                                        03590000
                                                                        03600000
                                                                        03610000
      ******************************************************************03620000
       3000-BP13FB78-READ.                                              03630000
      ******************************************************************03640000
           READ BP13FB78                                                03650000
              AT END MOVE 'Y'     TO WS-FB78-EOF-SW                     03660000
              GO TO  3000-EXIT                                          03670000
           END-READ.                                                    03680000
                                                                        03690000
           ADD +1                 TO WS-FB78-READ-CTR.                  03700000
                                                                        03710000
           PERFORM 3100-EDIT-NUMERIC-FIELDS    THRU 3100-EXIT.          03720000
                                                                        03730000
       3000-EXIT.                                                       03740000
           EXIT.                                                        03750000
                                                                        03760000
                                                                        03770000
      **********************************************************        03780000
       3100-EDIT-NUMERIC-FIELDS.                                        03790000
      **********************************************************        03800000
           INSPECT FB78-AMT-APPLT1-INCOME                               03810000
              REPLACING LEADING SPACES BY ZEROS                         03820000
                                                                        03830000
           INSPECT FB78-AMT-APPLT2-INCOME                               03840000
              REPLACING LEADING SPACES BY ZEROS                         03850000
                                                                        03860000
           INSPECT FB78-AMT-APPLT3-INCOME                               03870000
              REPLACING LEADING SPACES BY ZEROS                         03880000
                                                                        03890000
           INSPECT FB78-AMT-APPLT4-INCOME                               03900000
              REPLACING LEADING SPACES BY ZEROS                         03910000
                                                                        03920000
           INSPECT FB78-AMT-OCCUP1-INCOME                               03930000
              REPLACING LEADING SPACES BY ZEROS                         03940000
                                                                        03950000
           INSPECT FB78-AMT-OCCUP2-INCOME                               03960000
              REPLACING LEADING SPACES BY ZEROS                         03970000
                                                                        03980000
           INSPECT FB78-AMT-OCCUP3-INCOME                               03990000
              REPLACING LEADING SPACES BY ZEROS                         04000000
                                                                        04010000
           INSPECT FB78-AMT-OCCUP4-INCOME                               04020000
              REPLACING LEADING SPACES BY ZEROS                         04030000
                                                                        04040000
           INSPECT FB78-AMT-OCCUP5-INCOME                               04050000
              REPLACING LEADING SPACES BY ZEROS                         04060000
                                                                        04070000
           INSPECT FB78-AMT-OCCUP6-INCOME                               04080000
              REPLACING LEADING SPACES BY ZEROS.                        04090000
                                                                        04100000
           INSPECT FB78-AMT-OCCUP7-INCOME                               04110000
              REPLACING LEADING SPACES BY ZEROS.                        04120000
                                                                        04130000
           INSPECT FB78-AMT-OCCUP8-INCOME                               04140000
              REPLACING LEADING SPACES BY ZEROS.                        04150000
                                                                        04160000
       3100-EXIT.                                                       04170000
           EXIT.                                                        04180000
                                                                        04190000
                                                                        04200000
      **********************************************************        04210000
       4000-PROCESS-FB78-REC.                                           04220000
      **********************************************************        04230000
           MOVE SPACES TO WS-TEMP-SEX                                   04240000
                          WS-TEMP-RACE                                  04250000
                          WS-TEMP-MSTATUS.                              04260000
                                                                        04270000
           IF FB78-NUM-REGN      = SPACE OR LOW-VALUES                  04280000
              PERFORM 3000-BP13FB78-READ THRU 3000-EXIT                 04290000
              GO TO 4000-EXIT.                                          04300000
                                                                        04310000
           PERFORM 4300-BP13K730-WRITE  THRU 4300-EXIT.                 04320000
                                                                        04330000
           IF WS-K730-STATUS = ZEROS OR 02                              04340000
              PERFORM 4050-WRITE-MHA-INFO  THRU 4050-EXIT               04350000
              MOVE FB78-NUM-REGN           TO WS-TEMP-REGN              04360000
              MOVE FB78-NME-APPLT1         TO WS-TEMP-NAME              04370000
              MOVE FB78-DTE-APPLT1-BIRTH   TO WS-TEMP-DTE-BIRTH         04380000
              MOVE FB78-NUM-APPLT1-UIN     TO WS-TEMP-NRIC              04390000
              MOVE FB78-NUM-APPLT1-MARITAL-STATUS TO                    04400000
                                              WS-TEMP-MSTATUS           04410000
              MOVE FB78-AMT-APPLT1-INCOME  TO WS-TEMP-INCOME            04420000
              MOVE '10'                    TO WS-TEMP-CITIZENSHIP       04430000
              MOVE '00'                    TO WS-TEMP-RELATIONSHIP      04440000
                                              WS-OCC-REL                04450000
              MOVE 'Y'                     TO WS-TEMP-LESSEE            04460000
              MOVE FB78-NUM-APPLT1-RACE    TO WS-TEMP-RACE              04470000
              MOVE FB78-NUM-APPLT1-SEX     TO WS-TEMP-SEX               04480000
              MOVE FB78-NUM-APPLT1-EDN-LVL TO WS-TEMP-EDN-LVL           04490000
              MOVE FB78-NUM-APPLT1-PHONE   TO WS-TEMP-PHONE             04500000
              MOVE FB78-NUM-APPLT1-HP-PAGER TO WS-TEMP-HP-PAGER         04510000
              PERFORM 4150-MOVE-SPOU-NRIC  THRU 4150-EXIT               04520000
              PERFORM 4200-BP13K825-WRITE  THRU 4200-EXIT               04530000
              PERFORM 4250-WRITE-CO-APPL   THRU 4250-EXIT               04540000
              PERFORM 4260-WRITE-OCCUP     THRU 4260-EXIT               04550000
              PERFORM 4400-BP13K830-WRITE  THRU 4400-EXIT               04560000
           END-IF.                                                      04570000
                                                                        04580000
           PERFORM 3000-BP13FB78-READ      THRU 3000-EXIT.              04590000
                                                                        04600000
       4000-EXIT.                                                       04610000
           EXIT.                                                        04620000
                                                                        04630000
                                                                        04640000
      **********************************************************        04650000
       4050-WRITE-MHA-INFO.                                             04660000
      **********************************************************        04670000
      *-----------------------> WRITE APPLICANT    1                    04680000
           MOVE SPACES                        TO   BE01F500-REC.        04690000
           MOVE FB78-NUM-APPLT1-UIN           TO   BE01F500-IDNO.       04700000
           PERFORM 4051-BE01F500-WRITE        THRU 4051-EXIT.           04710000
                                                                        04720000
      *-----------------------> WRITE CO-APPLICANT 1                    04730000
           IF FB78-NUM-APPLT2-UIN   NOT = SPACES                        04740000
              MOVE SPACES                     TO   BE01F500-REC         04750000
              MOVE FB78-NUM-APPLT2-UIN        TO   BE01F500-IDNO        04760000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            04770000
           END-IF.                                                      04780000
                                                                        04790000
      *-----------------------> WRITE CO-APPLICANT 2                    04800000
           IF FB78-NUM-APPLT3-UIN  NOT = SPACES                         04810000
              MOVE SPACES                     TO   BE01F500-REC         04820000
              MOVE FB78-NUM-APPLT3-UIN        TO   BE01F500-IDNO        04830000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            04840000
           END-IF.                                                      04850000
                                                                        04860000
      *-----------------------> WRITE CO-APPLICANT 3                    04870000
           IF FB78-NUM-APPLT4-UIN   NOT = SPACES                        04880000
              MOVE SPACES                     TO   BE01F500-REC         04890000
              MOVE FB78-NUM-APPLT4-UIN        TO   BE01F500-IDNO        04900000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            04910000
           END-IF.                                                      04920000
                                                                        04930000
      *-----------------------> WRITE OCCUPIER     1                    04940000
           IF FB78-NUM-OCCUP1-UIN NOT = SPACES                          04950000
              MOVE SPACES                     TO   BE01F500-REC         04960000
              MOVE FB78-NUM-OCCUP1-UIN        TO   BE01F500-IDNO        04970000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            04980000
           END-IF.                                                      04990000
                                                                        05000000
      *-----------------------> WRITE OCCUPIER     2                    05010000
           IF FB78-NUM-OCCUP2-UIN NOT = SPACES                          05020000
              MOVE SPACES                     TO   BE01F500-REC         05030000
              MOVE FB78-NUM-OCCUP2-UIN        TO   BE01F500-IDNO        05040000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            05050000
           END-IF.                                                      05060000
                                                                        05070000
      *-----------------------> WRITE OCCUPIER     3                    05080000
           IF FB78-NUM-OCCUP3-UIN NOT = SPACES                          05090000
              MOVE SPACES                     TO   BE01F500-REC         05100000
              MOVE FB78-NUM-OCCUP3-UIN        TO   BE01F500-IDNO        05110000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            05120000
           END-IF.                                                      05130000
                                                                        05140000
      *-----------------------> WRITE OCCUPIER     4                    05150000
           IF FB78-NUM-OCCUP4-UIN NOT = SPACES                          05160000
              MOVE SPACES                     TO   BE01F500-REC         05170000
              MOVE FB78-NUM-OCCUP4-UIN        TO   BE01F500-IDNO        05180000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            05190000
           END-IF.                                                      05200000
                                                                        05210000
      *-----------------------> WRITE OCCUPIER     5                    05220000
           IF FB78-NUM-OCCUP5-UIN NOT = SPACES                          05230000
              MOVE SPACES                     TO   BE01F500-REC         05240000
              MOVE FB78-NUM-OCCUP5-UIN        TO   BE01F500-IDNO        05250000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            05260000
           END-IF.                                                      05270000
                                                                        05280000
      *-----------------------> WRITE OCCUPIER     6                    05290000
           IF FB78-NUM-OCCUP6-UIN NOT = SPACES                          05300000
              MOVE SPACES                     TO   BE01F500-REC         05310000
              MOVE FB78-NUM-OCCUP6-UIN        TO   BE01F500-IDNO        05320000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            05330000
           END-IF.                                                      05340000
                                                                        05350000
      *-----------------------> WRITE OCCUPIER     7                    05360000
           IF FB78-NUM-OCCUP7-UIN NOT = SPACES                          05370000
              MOVE SPACES                     TO   BE01F500-REC         05380000
              MOVE FB78-NUM-OCCUP7-UIN        TO   BE01F500-IDNO        05390000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            05400000
           END-IF.                                                      05410000
                                                                        05420000
      *-----------------------> WRITE OCCUPIER     8                    05430000
           IF FB78-NUM-OCCUP8-UIN NOT = SPACES                          05440000
              MOVE SPACES                     TO   BE01F500-REC         05450000
              MOVE FB78-NUM-OCCUP8-UIN        TO   BE01F500-IDNO        05460000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            05470000
           END-IF.                                                      05480000
                                                                        05490000
      *-----------------------> WRITE MCPS RESIDENT1                    05500000
           IF FB78-NUM-CHILD1-PARENT-UIN NOT = SPACES                   05510000
              MOVE SPACES                     TO   BE01F500-REC         05520000
              MOVE FB78-NUM-CHILD1-PARENT-UIN TO   BE01F500-IDNO        05530000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            05540000
           END-IF.                                                      05550000
                                                                        05560000
      *-----------------------> WRITE MCPS RESIDENT2                    05570000
           IF FB78-NUM-CHILD2-PARENT-UIN NOT = SPACES                   05580000
              MOVE SPACES                     TO   BE01F500-REC         05590000
              MOVE FB78-NUM-CHILD2-PARENT-UIN TO   BE01F500-IDNO        05600000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            05610000
           END-IF.                                                      05620000
                                                                        05630000
       4050-EXIT.                                                       05640000
           EXIT.                                                        05650000
                                                                        05660000
                                                                        05670000
      **********************************************************        05680000
       4051-BE01F500-WRITE.                                             05690000
      **********************************************************        05700000
                                                                        05710000
           IF BE01F500-IDNO(1:1) = 'S' OR 'T'                           05720000
               MOVE 'UIN'            TO   BE01F500-IDNO-TYPE            05730000
           ELSE                                                         05740000
             IF BE01F500-IDNO(1:1) = 'G' OR 'F' OR 'M'                  05750001
               MOVE 'FIN'          TO   BE01F500-IDNO-TYPE              05760000
             ELSE                                                       05770000
               MOVE 'XIN'          TO   BE01F500-IDNO-TYPE              05780000
             END-IF                                                     05790000
           END-IF.                                                      05800000
                                                                        05810000
           MOVE WS-SYSTEM-DATE            TO BE01F500-DATE-FIRST-SENT.  05820000
           MOVE  'BP13'                   TO  BE01F500-SOURCE.          05830000
           MOVE  'N'                      TO  BE01F500-DB-TAG.          05840000
           MOVE FB78-NUM-REGN          TO   BE01F500-REF-NO(1:8).       05850000
           WRITE BE01F500-REC.                                          05860000
           ADD   +1                    TO   WS-F500-WRITE-CTR.          05870000
                                                                        05880000
       4051-EXIT.                                                       05890000
           EXIT.                                                        05900000
                                                                        05910000
                                                                        05920000
      **********************************************************        05930000
       4150-MOVE-SPOU-NRIC.                                             05940000
      **********************************************************        05950000
      *--------------------------------------------------------*        05960000
      * GET THE SPOUSE NRIC FROM FB78 AND MOVE TO K825         *        05970000
      *--------------------------------------------------------*        05980000
           MOVE SPACES  TO WS-TEMP-NRIC-SPOUSE.                         05990000
                                                                        06000000
           EVALUATE TRUE                                                06010000
           WHEN WS-OCC-REL = '20'                                       06020000
      *    ---MOVE THE HUSBUND NRIC TO WIFE'S    SPOUSE-NRIC FIELD      06030000
                MOVE FB78-NUM-APPLT1-UIN  TO WS-TEMP-NRIC-SPOUSE        06040000
                                                                        06050000
           WHEN WS-OCC-REL = '00'                                       06060000
      *    ---MOVE THE WIFE OR FIANCE NRIC TO HUSBUND'S SPOUSE-NRIC     06070000
                MOVE '20'                 TO WS-TMP-REL                 06080000
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                06090000
                                                                        06100000
           WHEN WS-OCC-REL = '02'                                       06110000
      *    ---MOVE THE MOTHER  NRIC TO FATHER'S  SPOUSE-NRIC FIELD      06120000
                MOVE '12'                 TO WS-TMP-REL                 06130000
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                06140000
                                                                        06150000
           WHEN WS-OCC-REL = '12'                                       06160000
      *    ---MOVE THE FATHER  NRIC TO MOTHER'S  SPOUSE-NRIC FIELD      06170000
                MOVE '02'                 TO WS-TMP-REL                 06180000
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                06190000
                                                                        06200000
           WHEN WS-OCC-REL = '32'                                       06210000
      *    ---MOVE THE FATHER-IN-LAW NRIC TO MOTHER'S  SPOUSE-NRIC      06220000
                MOVE '22'                 TO WS-TMP-REL                 06230000
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                06240000
                                                                        06250000
           WHEN WS-OCC-REL = '22'                                       06260000
      *    ---MOVE THE MOTHER-IN-LAW NRIC TO MOTHER'S  SPOUSE-NRIC      06270000
                MOVE '32'                 TO WS-TMP-REL                 06280000
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                06290000
                                                                        06300000
           WHEN WS-OCC-REL = '98'                                       06310000
      *    ---MOVE THE PARENTS NRIC                                     06320000
                MOVE '98'                 TO WS-TMP-REL                 06330000
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                06340000
                                                                        06350000
           WHEN WS-OCC-REL = '01'                                       06360000
      *    ---MOVE THE MOTHER-IN-LAW NRIC                               06370000
                MOVE '01'                 TO WS-TMP-REL                 06380000
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                06390000
                                                                        06400000
           WHEN WS-OCC-REL = '97'                                       06410000
      *    ---MOVE THE MOTHER-IN-LAW NRIC                               06420000
                MOVE '97'                 TO WS-TMP-REL                 06430000
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                06440000
                                                                        06450000
           END-EVALUATE.                                                06460000
                                                                        06470000
       4150-EXIT.                                                       06480000
           EXIT.                                                        06490000
                                                                        06500000
                                                                        06510000
      **********************************************************        06520000
       4175-GET-SPOUSE.                                                 06530000
      **********************************************************        06540000
      *--------------------------------------------------------*        06550000
      * GET THE SPOUSE NRIC FROM FB78 AND MOVE TO K825         *        06560000
      *--------------------------------------------------------*        06570000
           EVALUATE TRUE                                                06580000
           WHEN FB78-NUM-APPLT2-RLTNSP-APPLT1 = WS-TMP-REL AND          06590000
                FB78-NUM-APPLT2-UIN NOT = WS-TEMP-NRIC                  06600000
                MOVE FB78-NUM-APPLT2-UIN TO WS-TEMP-NRIC-SPOUSE         06610000
                                                                        06620000
           WHEN FB78-NUM-APPLT3-RLTNSP-APPLT1 = WS-TMP-REL AND          06630000
                FB78-NUM-APPLT3-UIN NOT = WS-TEMP-NRIC                  06640000
                MOVE FB78-NUM-APPLT3-UIN TO WS-TEMP-NRIC-SPOUSE         06650000
                                                                        06660000
           WHEN FB78-NUM-APPLT4-RLTNSP-APPLT1 = WS-TMP-REL AND          06670000
                FB78-NUM-APPLT4-UIN NOT = WS-TEMP-NRIC                  06680000
                MOVE FB78-NUM-APPLT4-UIN TO WS-TEMP-NRIC-SPOUSE         06690000
                                                                        06700000
           WHEN FB78-NUM-OCCUP1-RLTNSP-APPLT1 = WS-TMP-REL AND          06710000
                FB78-NUM-OCCUP1-UIN NOT = WS-TEMP-NRIC                  06720000
                MOVE FB78-NUM-OCCUP1-UIN  TO WS-TEMP-NRIC-SPOUSE        06730000
                                                                        06740000
           WHEN FB78-NUM-OCCUP2-RLTNSP-APPLT1 = WS-TMP-REL AND          06750000
                FB78-NUM-OCCUP2-UIN NOT = WS-TEMP-NRIC                  06760000
                MOVE FB78-NUM-OCCUP2-UIN  TO WS-TEMP-NRIC-SPOUSE        06770000
                                                                        06780000
           WHEN FB78-NUM-OCCUP3-RLTNSP-APPLT1 = WS-TMP-REL AND          06790000
                FB78-NUM-OCCUP3-UIN NOT = WS-TEMP-NRIC                  06800000
                MOVE FB78-NUM-OCCUP3-UIN  TO WS-TEMP-NRIC-SPOUSE        06810000
                                                                        06820000
           WHEN FB78-NUM-OCCUP4-RLTNSP-APPLT1 = WS-TMP-REL AND          06830000
                FB78-NUM-OCCUP4-UIN NOT = WS-TEMP-NRIC                  06840000
                MOVE FB78-NUM-OCCUP4-UIN  TO WS-TEMP-NRIC-SPOUSE        06850000
                                                                        06860000
           WHEN FB78-NUM-OCCUP5-RLTNSP-APPLT1 = WS-TMP-REL AND          06870000
                FB78-NUM-OCCUP5-UIN NOT = WS-TEMP-NRIC                  06880000
                MOVE FB78-NUM-OCCUP5-UIN  TO WS-TEMP-NRIC-SPOUSE        06890000
                                                                        06900000
           WHEN FB78-NUM-OCCUP6-RLTNSP-APPLT1 = WS-TMP-REL AND          06910000
                FB78-NUM-OCCUP6-UIN NOT = WS-TEMP-NRIC                  06920000
                MOVE FB78-NUM-OCCUP6-UIN  TO WS-TEMP-NRIC-SPOUSE        06930000
                                                                        06940000
           WHEN FB78-NUM-OCCUP7-RLTNSP-APPLT1 = WS-TMP-REL AND          06950000
                FB78-NUM-OCCUP7-UIN NOT = WS-TEMP-NRIC                  06960000
                MOVE FB78-NUM-OCCUP7-UIN  TO WS-TEMP-NRIC-SPOUSE        06970000
                                                                        06980000
           WHEN FB78-NUM-OCCUP8-RLTNSP-APPLT1 = WS-TMP-REL AND          06990000
                FB78-NUM-OCCUP8-UIN NOT = WS-TEMP-NRIC                  07000000
                MOVE FB78-NUM-OCCUP8-UIN  TO WS-TEMP-NRIC-SPOUSE        07010000
                                                                        07020000
           END-EVALUATE.                                                07030000
                                                                        07040000
       4175-EXIT.                                                       07050000
           EXIT.                                                        07060000
                                                                        07070000
                                                                        07080000
      **********************************************************        07090000
       4200-BP13K825-WRITE.                                             07100000
      **********************************************************        07110000
           MOVE SPACES               TO BP13K825-REC.                   07120000
           MOVE ZEROS                TO K825-AMT-INCOME                 07130000
                                        K825-AMT-INCOME-TP.             07140000
                                                                        07150000
           MOVE WS-TEMP-REGN         TO K825-NUM-REGN.                  07160000
           MOVE WS-TEMP-NAME         TO K825-NME-OCCP.                  07170000
           MOVE WS-TEMP-DTE-BIRTH    TO K825-DTE-BIRTH.                 07180000
           IF WS-TEMP-NRIC(1:1) = '-'                                   07190000
              MOVE 'X'                  TO K825-NUM-NRIC(1:1)           07200000
              MOVE WS-TEMP-NRIC(2:8)    TO K825-NUM-NRIC(2:8)           07210000
           ELSE                                                         07220000
              MOVE WS-TEMP-NRIC         TO K825-NUM-NRIC.               07230000
                                                                        07240000
           PERFORM 4270-CONVERT-SEX-RACE-MSTATUS THRU 4270-EXIT.        07250000
                                                                        07260000
           MOVE WS-TEMP-INCOME       TO K825-AMT-INCOME.                07270000
           MOVE WS-TEMP-CITIZENSHIP  TO K825-NUM-CITIZENSHIP.           07280000
           MOVE WS-TEMP-RELATIONSHIP TO K825-NUM-RELATIONSHIP.          07290000
           MOVE WS-TEMP-LESSEE       TO K825-NUM-LESSEE-CHECK.          07300000
           IF WS-TEMP-NRIC-SPOUSE(1:1) = '-'                            07310000
             MOVE 'X'                      TO K825-NUM-NRIC-SPOUSE(1:1) 07320000
             MOVE WS-TEMP-NRIC-SPOUSE(2:8) TO K825-NUM-NRIC-SPOUSE(2:8) 07330000
           ELSE                                                         07340000
              MOVE WS-TEMP-NRIC-SPOUSE     TO K825-NUM-NRIC-SPOUSE.     07350000
                                                                        07360000
           MOVE WS-TEMP-EDN-LVL      TO WS-TMP-EDN.                     07370000
           ADD +1                    TO WS-TMP-EDN.                     07380000
           MOVE WS-TMP-EDN           TO K825-NUM-EDUCATION.             07390000
                                                                        07400000
           MOVE WS-TEMP-PHONE        TO K825-NUM-PHONE.                 07410000
           MOVE WS-TEMP-HP-PAGER     TO K825-NUM-HP-PGR.                07420000
           MOVE WS-CURRENT-DATE      TO K825-DTE-UPDATE.                07430000
           MOVE 'P13C02B'            TO K825-NUM-USERID.                07440000
                                                                        07450000
           WRITE BP13K825-REC.                                          07460000
                                                                        07470000
           IF WS-K825-STATUS = ZEROS OR 02                              07480000
              ADD  +1                TO WS-K825-WRITE-CTR               07490000
           ELSE                                                         07500000
           IF WS-K825-STATUS = 22                                       07510000
              DISPLAY 'BP13K825 DUPLICATE EXISTS, KEY IS ' WS-TEMP-REGN 07520000
              ADD  +1                         TO WS-K825-DUP-CTR        07530000
              MOVE K-K825-DUPLICATE           TO L02B-REMARKS           07540000
              PERFORM 7000-PRINT-ERROR        THRU 7000-EXIT            07550000
           ELSE                                                         07560000
              DISPLAY 'BP13K825 WRITE ERROR, STATUS IS ' WS-K825-STATUS 07570000
              DISPLAY 'BP13K825 RECORD KEY IS ' K825-KEY-FLD            07580000
              ADD  +1                         TO WS-K825-ERROR-CTR      07590000
              MOVE K-K825-ERROR               TO L02B-REMARKS           07600000
              PERFORM 7000-PRINT-ERROR        THRU 7000-EXIT            07610000
           END-IF.                                                      07620000
                                                                        07630000
       4200-EXIT.                                                       07640000
           EXIT.                                                        07650000
                                                                        07660000
                                                                        07670000
      **********************************************************        07680000
       4250-WRITE-CO-APPL.                                              07690000
      **********************************************************        07700000
      *    MOVE SPACES                            TO WS-TEMP-RACE       07710000
      *                                              WS-TEMP-SEX.       07720000
      *------------> CO-APPLICANT  1                                    07730000
           IF FB78-NUM-APPLT2-UIN NOT = SPACES                          07740000
              MOVE FB78-NUM-APPLT2-UIN            TO WS-TEMP-NRIC       07750000
              MOVE FB78-NME-APPLT2                TO WS-TEMP-NAME       07760000
              MOVE FB78-DTE-APPLT2-BIRTH          TO WS-TEMP-DTE-BIRTH  07770000
              MOVE FB78-AMT-APPLT2-INCOME         TO WS-TEMP-INCOME     07780000
              MOVE FB78-NUM-APPLT2-RACE           TO WS-TEMP-RACE       07790000
              MOVE FB78-NUM-APPLT2-SEX            TO WS-TEMP-SEX        07800000
              MOVE FB78-NUM-APPLT2-MARITAL-STATUS TO WS-TEMP-MSTATUS    07810000
              MOVE FB78-NUM-APPLT2-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 07820000
              MOVE FB78-NUM-APPLT2-RLTNSP-APPLT1 TO WS-TEMP-RELATIONSHIP07830000
                                                    WS-OCC-REL          07840000
              MOVE FB78-NUM-APPLT2-EDN-LVL       TO WS-TEMP-EDN-LVL     07850000
              MOVE FB78-NUM-APPLT2-PHONE         TO WS-TEMP-PHONE       07860000
              MOVE FB78-NUM-APPLT2-HP-PAGER      TO WS-TEMP-HP-PAGER    07870000
              MOVE 'Y'                           TO WS-TEMP-LESSEE      07880000
                                                                        07890000
              PERFORM 4150-MOVE-SPOU-NRIC THRU 4150-EXIT                07900000
                                                                        07910000
              PERFORM 4200-BP13K825-WRITE      THRU 4200-EXIT           07920000
           END-IF.                                                      07930000
                                                                        07940000
      *------------> CO-APPLICANT  2                                    07950000
           IF FB78-NUM-APPLT3-UIN NOT = SPACES                          07960000
              MOVE FB78-NUM-APPLT3-UIN            TO WS-TEMP-NRIC       07970000
              MOVE FB78-NME-APPLT3                TO WS-TEMP-NAME       07980000
              MOVE FB78-DTE-APPLT3-BIRTH          TO WS-TEMP-DTE-BIRTH  07990000
              MOVE FB78-AMT-APPLT3-INCOME         TO WS-TEMP-INCOME     08000000
              MOVE FB78-NUM-APPLT3-RACE           TO WS-TEMP-RACE       08010000
              MOVE FB78-NUM-APPLT3-SEX            TO WS-TEMP-SEX        08020000
              MOVE FB78-NUM-APPLT3-MARITAL-STATUS TO WS-TEMP-MSTATUS    08030000
              MOVE FB78-NUM-APPLT3-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 08040000
              MOVE FB78-NUM-APPLT3-RLTNSP-APPLT1 TO WS-TEMP-RELATIONSHIP08050000
                                                    WS-OCC-REL          08060000
              MOVE FB78-NUM-APPLT3-EDN-LVL       TO WS-TEMP-EDN-LVL     08070000
              MOVE FB78-NUM-APPLT3-PHONE         TO WS-TEMP-PHONE       08080000
              MOVE FB78-NUM-APPLT3-HP-PAGER      TO WS-TEMP-HP-PAGER    08090000
              MOVE 'Y'                           TO WS-TEMP-LESSEE      08100000
              PERFORM 4150-MOVE-SPOU-NRIC THRU 4150-EXIT                08110000
                                                                        08120000
              PERFORM 4200-BP13K825-WRITE      THRU 4200-EXIT           08130000
           END-IF.                                                      08140000
                                                                        08150000
      *------------> CO-APPLICANT  3                                    08160000
           IF FB78-NUM-APPLT4-UIN NOT = SPACES                          08170000
              MOVE FB78-NUM-APPLT4-UIN            TO WS-TEMP-NRIC       08180000
              MOVE FB78-NME-APPLT4                TO WS-TEMP-NAME       08190000
              MOVE FB78-DTE-APPLT4-BIRTH          TO WS-TEMP-DTE-BIRTH  08200000
              MOVE FB78-AMT-APPLT4-INCOME         TO WS-TEMP-INCOME     08210000
              MOVE FB78-NUM-APPLT4-RACE           TO WS-TEMP-RACE       08220000
              MOVE FB78-NUM-APPLT4-SEX            TO WS-TEMP-SEX        08230000
              MOVE FB78-NUM-APPLT4-MARITAL-STATUS TO WS-TEMP-MSTATUS    08240000
              MOVE FB78-NUM-APPLT4-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 08250000
              MOVE FB78-NUM-APPLT4-RLTNSP-APPLT1 TO WS-TEMP-RELATIONSHIP08260000
                                                    WS-OCC-REL          08270000
              MOVE FB78-NUM-APPLT4-EDN-LVL       TO WS-TEMP-EDN-LVL     08280000
              MOVE FB78-NUM-APPLT4-PHONE         TO WS-TEMP-PHONE       08290000
              MOVE FB78-NUM-APPLT4-HP-PAGER      TO WS-TEMP-HP-PAGER    08300000
              MOVE 'Y'                           TO WS-TEMP-LESSEE      08310000
              PERFORM 4150-MOVE-SPOU-NRIC THRU 4150-EXIT                08320000
                                                                        08330000
              PERFORM 4200-BP13K825-WRITE      THRU 4200-EXIT           08340000
           END-IF.                                                      08350000
                                                                        08360000
       4250-EXIT.                                                       08370000
           EXIT.                                                        08380000
                                                                        08390000
                                                                        08400000
      **********************************************************        08410000
       4260-WRITE-OCCUP.                                                08420000
      **********************************************************        08430000
           MOVE SPACES                          TO WS-TEMP-NRIC-SPOUSE. 08440000
                                                                        08450000
      *------------> OCCUPANT  1                                        08460000
           IF FB78-NUM-OCCUP1-UIN NOT = SPACES                          08470000
              MOVE FB78-NUM-OCCUP1-UIN            TO WS-TEMP-NRIC       08480000
              MOVE FB78-NME-OCCUP1                TO WS-TEMP-NAME       08490000
              MOVE FB78-DTE-OCCUP1-BIRTH          TO WS-TEMP-DTE-BIRTH  08500000
              MOVE FB78-AMT-OCCUP1-INCOME         TO WS-TEMP-INCOME     08510000
              MOVE FB78-NUM-OCCUP1-MARITAL-STATUS TO WS-TEMP-MSTATUS    08520000
              MOVE FB78-NUM-OCCUP1-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 08530000
              MOVE FB78-NUM-OCCUP1-RLTNSP-APPLT1 TO                     08540000
                                                   WS-TEMP-RELATIONSHIP 08550000
                                                   WS-OCC-REL           08560000
              MOVE FB78-NUM-OCCUP1-RACE         TO WS-TEMP-RACE         08570000
              MOVE FB78-NUM-OCCUP1-SEX          TO WS-TEMP-SEX          08580000
              MOVE SPACES                       TO WS-TEMP-LESSEE       08590000
              MOVE FB78-NUM-OCCUP1-EDN-LVL      TO WS-TEMP-EDN-LVL      08600000
              MOVE FB78-NUM-OCCUP1-PHONE        TO WS-TEMP-PHONE        08610000
              MOVE FB78-NUM-OCCUP1-HP-PAGER     TO WS-TEMP-HP-PAGER     08620000
                                                                        08630000
              PERFORM 4150-MOVE-SPOU-NRIC     THRU 4150-EXIT            08640000
              PERFORM 4200-BP13K825-WRITE     THRU 4200-EXIT            08650000
           END-IF.                                                      08660000
                                                                        08670000
      *------------> OCCUPANT  2                                        08680000
           IF FB78-NUM-OCCUP2-UIN NOT = SPACES                          08690000
              MOVE FB78-NUM-OCCUP2-UIN            TO WS-TEMP-NRIC       08700000
              MOVE FB78-NME-OCCUP2                TO WS-TEMP-NAME       08710000
              MOVE FB78-DTE-OCCUP2-BIRTH          TO WS-TEMP-DTE-BIRTH  08720000
              MOVE FB78-AMT-OCCUP2-INCOME         TO WS-TEMP-INCOME     08730000
              MOVE FB78-NUM-OCCUP2-MARITAL-STATUS TO WS-TEMP-MSTATUS    08740000
              MOVE FB78-NUM-OCCUP2-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 08750000
              MOVE FB78-NUM-OCCUP2-RLTNSP-APPLT1 TO                     08760000
                                                   WS-TEMP-RELATIONSHIP 08770000
                                                   WS-OCC-REL           08780000
              MOVE FB78-NUM-OCCUP2-RACE         TO WS-TEMP-RACE         08790000
              MOVE FB78-NUM-OCCUP2-SEX          TO WS-TEMP-SEX          08800000
              MOVE SPACES                       TO WS-TEMP-LESSEE       08810000
              MOVE FB78-NUM-OCCUP2-EDN-LVL      TO WS-TEMP-EDN-LVL      08820000
              MOVE FB78-NUM-OCCUP2-PHONE        TO WS-TEMP-PHONE        08830000
              MOVE FB78-NUM-OCCUP2-HP-PAGER     TO WS-TEMP-HP-PAGER     08840000
                                                                        08850000
              PERFORM 4150-MOVE-SPOU-NRIC     THRU 4150-EXIT            08860000
              PERFORM 4200-BP13K825-WRITE     THRU 4200-EXIT            08870000
           END-IF.                                                      08880000
                                                                        08890000
      *------------> OCCUPANT  3                                        08900000
           IF FB78-NUM-OCCUP3-UIN NOT = SPACES                          08910000
              MOVE FB78-NUM-OCCUP3-UIN            TO WS-TEMP-NRIC       08920000
              MOVE FB78-NME-OCCUP3                TO WS-TEMP-NAME       08930000
              MOVE FB78-DTE-OCCUP3-BIRTH          TO WS-TEMP-DTE-BIRTH  08940000
              MOVE FB78-AMT-OCCUP3-INCOME         TO WS-TEMP-INCOME     08950000
              MOVE FB78-NUM-OCCUP3-MARITAL-STATUS TO WS-TEMP-MSTATUS    08960000
              MOVE FB78-NUM-OCCUP3-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 08970000
              MOVE FB78-NUM-OCCUP3-RLTNSP-APPLT1 TO                     08980000
                                                   WS-TEMP-RELATIONSHIP 08990000
                                                   WS-OCC-REL           09000000
              MOVE FB78-NUM-OCCUP3-RACE         TO WS-TEMP-RACE         09010000
              MOVE FB78-NUM-OCCUP3-SEX          TO WS-TEMP-SEX          09020000
              MOVE SPACES                       TO WS-TEMP-LESSEE       09030000
              MOVE FB78-NUM-OCCUP3-EDN-LVL      TO WS-TEMP-EDN-LVL      09040000
              MOVE FB78-NUM-OCCUP3-PHONE        TO WS-TEMP-PHONE        09050000
              MOVE FB78-NUM-OCCUP3-HP-PAGER     TO WS-TEMP-HP-PAGER     09060000
                                                                        09070000
              PERFORM 4150-MOVE-SPOU-NRIC     THRU 4150-EXIT            09080000
              PERFORM 4200-BP13K825-WRITE     THRU 4200-EXIT            09090000
           END-IF.                                                      09100000
                                                                        09110000
      *------------> OCCUPANT  4                                        09120000
           IF FB78-NUM-OCCUP4-UIN NOT = SPACES                          09130000
              MOVE FB78-NUM-OCCUP4-UIN            TO WS-TEMP-NRIC       09140000
              MOVE FB78-NME-OCCUP4                TO WS-TEMP-NAME       09150000
              MOVE FB78-DTE-OCCUP4-BIRTH          TO WS-TEMP-DTE-BIRTH  09160000
              MOVE FB78-AMT-OCCUP4-INCOME         TO WS-TEMP-INCOME     09170000
              MOVE FB78-NUM-OCCUP4-MARITAL-STATUS TO WS-TEMP-MSTATUS    09180000
              MOVE FB78-NUM-OCCUP4-CITIZENSHIP  TO WS-TEMP-CITIZENSHIP  09190000
              MOVE FB78-NUM-OCCUP4-RLTNSP-APPLT1 TO                     09200000
                                                   WS-TEMP-RELATIONSHIP 09210000
                                                   WS-OCC-REL           09220000
              MOVE FB78-NUM-OCCUP4-RACE         TO WS-TEMP-RACE         09230000
              MOVE FB78-NUM-OCCUP4-SEX          TO WS-TEMP-SEX          09240000
              MOVE SPACES                       TO WS-TEMP-LESSEE       09250000
              MOVE FB78-NUM-OCCUP4-EDN-LVL      TO WS-TEMP-EDN-LVL      09260000
              MOVE FB78-NUM-OCCUP4-PHONE        TO WS-TEMP-PHONE        09270000
              MOVE FB78-NUM-OCCUP4-HP-PAGER     TO WS-TEMP-HP-PAGER     09280000
                                                                        09290000
              PERFORM 4150-MOVE-SPOU-NRIC     THRU 4150-EXIT            09300000
              PERFORM 4200-BP13K825-WRITE     THRU 4200-EXIT            09310000
           END-IF.                                                      09320000
                                                                        09330000
      *------------> OCCUPANT  5                                        09340000
           IF FB78-NUM-OCCUP5-UIN NOT = SPACES                          09350000
              MOVE FB78-NUM-OCCUP5-UIN            TO WS-TEMP-NRIC       09360000
              MOVE FB78-NME-OCCUP5                TO WS-TEMP-NAME       09370000
              MOVE FB78-DTE-OCCUP5-BIRTH          TO WS-TEMP-DTE-BIRTH  09380000
              MOVE FB78-AMT-OCCUP5-INCOME         TO WS-TEMP-INCOME     09390000
              MOVE FB78-NUM-OCCUP5-MARITAL-STATUS TO WS-TEMP-MSTATUS    09400000
              MOVE FB78-NUM-OCCUP5-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 09410000
              MOVE FB78-NUM-OCCUP5-RLTNSP-APPLT1 TO                     09420000
                                                   WS-TEMP-RELATIONSHIP 09430000
                                                   WS-OCC-REL           09440000
              MOVE FB78-NUM-OCCUP5-RACE         TO WS-TEMP-RACE         09450000
              MOVE FB78-NUM-OCCUP5-SEX          TO WS-TEMP-SEX          09460000
              MOVE SPACES                       TO WS-TEMP-LESSEE       09470000
              MOVE FB78-NUM-OCCUP5-EDN-LVL      TO WS-TEMP-EDN-LVL      09480000
              MOVE FB78-NUM-OCCUP5-PHONE        TO WS-TEMP-PHONE        09490000
              MOVE FB78-NUM-OCCUP5-HP-PAGER     TO WS-TEMP-HP-PAGER     09500000
                                                                        09510000
              PERFORM 4150-MOVE-SPOU-NRIC     THRU 4150-EXIT            09520000
              PERFORM 4200-BP13K825-WRITE     THRU 4200-EXIT            09530000
           END-IF.                                                      09540000
                                                                        09550000
      *------------> OCCUPANT  6                                        09560000
           IF FB78-NUM-OCCUP6-UIN NOT = SPACES                          09570000
              MOVE FB78-NUM-OCCUP6-UIN            TO WS-TEMP-NRIC       09580000
              MOVE FB78-NME-OCCUP6                TO WS-TEMP-NAME       09590000
              MOVE FB78-DTE-OCCUP6-BIRTH          TO WS-TEMP-DTE-BIRTH  09600000
              MOVE FB78-AMT-OCCUP6-INCOME         TO WS-TEMP-INCOME     09610000
              MOVE FB78-NUM-OCCUP6-MARITAL-STATUS TO WS-TEMP-MSTATUS    09620000
              MOVE FB78-NUM-OCCUP6-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 09630000
              MOVE FB78-NUM-OCCUP6-RLTNSP-APPLT1 TO                     09640000
                                                   WS-TEMP-RELATIONSHIP 09650000
                                                   WS-OCC-REL           09660000
              MOVE FB78-NUM-OCCUP6-RACE         TO WS-TEMP-RACE         09670000
              MOVE FB78-NUM-OCCUP6-SEX          TO WS-TEMP-SEX          09680000
              MOVE SPACES                       TO WS-TEMP-LESSEE       09690000
              MOVE FB78-NUM-OCCUP6-EDN-LVL      TO WS-TEMP-EDN-LVL      09700000
              MOVE FB78-NUM-OCCUP6-PHONE        TO WS-TEMP-PHONE        09710000
              MOVE FB78-NUM-OCCUP6-HP-PAGER     TO WS-TEMP-HP-PAGER     09720000
                                                                        09730000
              PERFORM 4150-MOVE-SPOU-NRIC     THRU 4150-EXIT            09740000
              PERFORM 4200-BP13K825-WRITE     THRU 4200-EXIT            09750000
           END-IF.                                                      09760000
                                                                        09770000
      *------------> OCCUPANT  7                                        09780000
           IF FB78-NUM-OCCUP7-UIN NOT = SPACES                          09790000
              MOVE FB78-NUM-OCCUP7-UIN            TO WS-TEMP-NRIC       09800000
              MOVE FB78-NME-OCCUP7                TO WS-TEMP-NAME       09810000
              MOVE FB78-DTE-OCCUP7-BIRTH          TO WS-TEMP-DTE-BIRTH  09820000
              MOVE FB78-AMT-OCCUP7-INCOME         TO WS-TEMP-INCOME     09830000
              MOVE FB78-NUM-OCCUP7-MARITAL-STATUS TO WS-TEMP-MSTATUS    09840000
              MOVE FB78-NUM-OCCUP7-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 09850000
              MOVE FB78-NUM-OCCUP7-RLTNSP-APPLT1 TO                     09860000
                                                   WS-TEMP-RELATIONSHIP 09870000
                                                   WS-OCC-REL           09880000
              MOVE FB78-NUM-OCCUP7-RACE         TO WS-TEMP-RACE         09890000
              MOVE FB78-NUM-OCCUP7-SEX          TO WS-TEMP-SEX          09900000
              MOVE SPACES                       TO WS-TEMP-LESSEE       09910000
              MOVE FB78-NUM-OCCUP7-EDN-LVL      TO WS-TEMP-EDN-LVL      09920000
              MOVE FB78-NUM-OCCUP7-PHONE        TO WS-TEMP-PHONE        09930000
              MOVE FB78-NUM-OCCUP7-HP-PAGER     TO WS-TEMP-HP-PAGER     09940000
                                                                        09950000
              PERFORM 4150-MOVE-SPOU-NRIC     THRU 4150-EXIT            09960000
              PERFORM 4200-BP13K825-WRITE     THRU 4200-EXIT            09970000
           END-IF.                                                      09980000
                                                                        09990000
      *------------> OCCUPANT  8                                        10000000
           IF FB78-NUM-OCCUP8-UIN NOT = SPACES                          10010000
              MOVE FB78-NUM-OCCUP8-UIN            TO WS-TEMP-NRIC       10020000
              MOVE FB78-NME-OCCUP8                TO WS-TEMP-NAME       10030000
              MOVE FB78-DTE-OCCUP8-BIRTH          TO WS-TEMP-DTE-BIRTH  10040000
              MOVE FB78-AMT-OCCUP8-INCOME         TO WS-TEMP-INCOME     10050000
              MOVE FB78-NUM-OCCUP8-MARITAL-STATUS TO WS-TEMP-MSTATUS    10060000
              MOVE FB78-NUM-OCCUP8-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 10070000
              MOVE FB78-NUM-OCCUP8-RLTNSP-APPLT1 TO                     10080000
                                                   WS-TEMP-RELATIONSHIP 10090000
                                                   WS-OCC-REL           10100000
              MOVE FB78-NUM-OCCUP8-RACE         TO WS-TEMP-RACE         10110000
              MOVE FB78-NUM-OCCUP8-SEX          TO WS-TEMP-SEX          10120000
              MOVE SPACES                       TO WS-TEMP-LESSEE       10130000
              MOVE FB78-NUM-OCCUP8-EDN-LVL      TO WS-TEMP-EDN-LVL      10140000
              MOVE FB78-NUM-OCCUP8-PHONE        TO WS-TEMP-PHONE        10150000
              MOVE FB78-NUM-OCCUP8-HP-PAGER     TO WS-TEMP-HP-PAGER     10160000
                                                                        10170000
              PERFORM 4150-MOVE-SPOU-NRIC     THRU 4150-EXIT            10180000
              PERFORM 4200-BP13K825-WRITE     THRU 4200-EXIT            10190000
           END-IF.                                                      10200000
                                                                        10210000
       4260-EXIT.                                                       10220000
           EXIT.                                                        10230000
                                                                        10240000
      **********************************************************        10250000
       4270-CONVERT-SEX-RACE-MSTATUS.                                   10260000
      **********************************************************        10270000
                                                                        10280000
           IF WS-TEMP-SEX = 'M'                                         10290000
              MOVE '1' TO K825-NUM-SEX                                  10300000
           ELSE                                                         10310000
           IF WS-TEMP-SEX = 'F'                                         10320000
              MOVE '2' TO K825-NUM-SEX                                  10330000
           END-IF.                                                      10340000
                                                                        10350000
           IF WS-TEMP-MSTATUS = 'S'                                     10360000
             MOVE '1' TO K825-NUM-MARITAL-STATUS                        10370000
           ELSE                                                         10380000
           IF WS-TEMP-MSTATUS = 'O'                                     10390000
             MOVE '1' TO K825-NUM-MARITAL-STATUS                        10400000
           ELSE                                                         10410000
           IF WS-TEMP-MSTATUS = 'M'                                     10420000
             MOVE '2' TO K825-NUM-MARITAL-STATUS                        10430000
           ELSE                                                         10440000
           IF WS-TEMP-MSTATUS = 'W'                                     10450000
             MOVE '3' TO K825-NUM-MARITAL-STATUS                        10460000
           ELSE                                                         10470000
           IF WS-TEMP-MSTATUS = 'D'                                     10480000
             MOVE '4' TO K825-NUM-MARITAL-STATUS                        10490000
           ELSE                                                         10500000
           IF WS-TEMP-MSTATUS = 'P'                                     10510000
             MOVE '5' TO K825-NUM-MARITAL-STATUS                        10520000
           END-IF.                                                      10530000
                                                                        10540000
           IF WS-TEMP-RACE = 'C'                                        10550000
              MOVE '0' TO K825-NUM-ETHNIC                               10560000
           ELSE                                                         10570000
           IF WS-TEMP-RACE = 'M'                                        10580000
              MOVE '5' TO K825-NUM-ETHNIC                               10590000
           ELSE                                                         10600000
           IF WS-TEMP-RACE = 'I'                                        10610000
              MOVE '6' TO K825-NUM-ETHNIC                               10620000
           ELSE                                                         10630000
           IF WS-TEMP-RACE = 'O'                                        10640000
              MOVE '7' TO K825-NUM-ETHNIC                               10650000
           END-IF.                                                      10660000
                                                                        10670000
       4270-EXIT.                                                       10680000
           EXIT.                                                        10690000
                                                                        10700000
                                                                        10710000
      **********************************************************        10720000
       4300-BP13K730-WRITE.                                             10730000
      **********************************************************        10740000
           MOVE SPACES                      TO BP13K730-REC.            10750000
           MOVE ZEROS                       TO K730-NUM-WAIT-TIME       10760000
                                               K730-NUM-JB-CNT          10770000
                                               K730-NUM-BALLOT-POSITION.10780000
                                                                        10790000
           MOVE FB78-NUM-REGN               TO K730-NUM-REF.            10800000
           MOVE FB78-NUM-REGN               TO K730-NUM-REGN.           10810000
                                                                        10820000
           IF FB78-NUM-REGN(1:1) = '5'                                  10830000
              MOVE 'DBS'                       TO K730-NUM-ALLO-CAT     10840000
           ELSE                                                         10850000
              MOVE 'EC '                       TO K730-NUM-ALLO-CAT     10860000
           END-IF.                                                      10870000
                                                                        10880000
           MOVE 'NN'                        TO K730-NUM-REQUEST-REASON. 10890000
                                                                        10900000
           IF FB78-NUM-APPLT1-UIN(1:1) = '-'                            10910000
              MOVE 'X'                      TO K730-NUM-NRIC1(1:1)      10920000
              MOVE FB78-NUM-APPLT1-UIN(2:8) TO K730-NUM-NRIC1(2:8)      10930000
           ELSE                                                         10940000
              MOVE FB78-NUM-APPLT1-UIN      TO K730-NUM-NRIC1.          10950000
                                                                        10960000
           IF FB78-NUM-APPLT2-UIN NOT = SPACES                          10970000
              IF FB78-NUM-APPLT2-UIN(1:1) = '-'                         10980000
                 MOVE 'X'                      TO K730-NUM-NRIC2(1:1)   10990000
                 MOVE FB78-NUM-APPLT2-UIN(2:8) TO K730-NUM-NRIC2(2:8)   11000000
              ELSE                                                      11010000
                 MOVE FB78-NUM-APPLT2-UIN      TO K730-NUM-NRIC2        11020000
              END-IF                                                    11030000
           ELSE                                                         11040000
              MOVE '##'                     TO K730-NUM-NRIC2(1:2)      11050000
              MOVE FB78-NUM-APPLT1-UIN(3:7) TO K730-NUM-NRIC2(3:7)      11060000
           END-IF.                                                      11070000
                                                                        11080000
           IF FB78-NUM-APPLT3-UIN NOT = SPACES                          11090000
              IF FB78-NUM-APPLT3-UIN(1:1) = '-'                         11100000
                 MOVE 'X'                      TO K730-NUM-NRIC3(1:1)   11110000
                 MOVE FB78-NUM-APPLT3-UIN(2:8) TO K730-NUM-NRIC3(2:8)   11120000
              ELSE                                                      11130000
                 MOVE FB78-NUM-APPLT3-UIN      TO K730-NUM-NRIC3        11140000
              END-IF                                                    11150000
           ELSE                                                         11160000
              MOVE '##'                     TO K730-NUM-NRIC3(1:2)      11170000
              MOVE FB78-NUM-APPLT1-UIN(3:7) TO K730-NUM-NRIC3(3:7)      11180000
           END-IF.                                                      11190000
                                                                        11200000
           IF FB78-NUM-APPLT4-UIN NOT = SPACES                          11210000
              IF FB78-NUM-APPLT4-UIN(1:1) = '-'                         11220000
                 MOVE 'X'                      TO K730-NUM-NRIC4(1:1)   11230000
                 MOVE FB78-NUM-APPLT4-UIN(2:8) TO K730-NUM-NRIC4(2:8)   11240000
              ELSE                                                      11250000
                 MOVE FB78-NUM-APPLT4-UIN      TO K730-NUM-NRIC4        11260000
              END-IF                                                    11270000
           ELSE                                                         11280000
              MOVE '##'                     TO K730-NUM-NRIC4(1:2)      11290000
              MOVE FB78-NUM-APPLT1-UIN(3:7) TO K730-NUM-NRIC4(3:7)      11300000
           END-IF.                                                      11310000
                                                                        11320000
           IF (FB78-NUM-OWN-PTE-PRTY = 'Y' OR                           11330000
               FB78-NUM-DISPOSED-PTE-PRTY = 'Y' OR                      11340000
               FB78-NUM-OWN-PRVTE-PRPRTY = 'Y' OR                       11350000
              (FB78-NUM-OWN-FLAT = 'N' AND                              11360000
               FB78-NUM-OWN-FLAT-TYPE = '1'))                           11370000
              MOVE 'Y'                      TO K730-NUM-PPO             11380000
           ELSE                                                         11390000
              MOVE SPACES                   TO K730-NUM-PPO             11400000
           END-IF.                                                      11410000
                                                                        11420000
           MOVE FB78-NUM-NEW-TOWN           TO K730-CDE-NT1.            11430000
                                                                        11440000
           MOVE FB78-NUM-LOAN-TAG           TO K730-NUM-LOAN-TAG.       11450000
                                                                        11460000
      *** MOVE SPACE TO NT2 FOR AUG 2003 BTO. CHOICE2 USED AS FLAT-TYPE 11470000
                                                                        11480000
           MOVE SPACES                      TO K730-CDE-NT2.            11490000
           MOVE 'N'                         TO K730-CDE-NT-WITH-LAND.   11500000
           MOVE SPACES                      TO K730-CDE-JB-PARENT       11510000
                                               K730-NUM-MCPS.           11520000
                                                                        11530000
      *** READ FLAT TYPE FOR AUG 2003 BTO FROM CHOICE2                  11540000
           MOVE FB78-NUM-FLAT-TYPE          TO K730-CDE-FLAT-TYPE.      11550000
                                                                        11560000
           MOVE FB78-CDE-ELIG-SCH           TO K730-CDE-ELIG-SCH.       11570000
           MOVE FB78-CDE-ALLOC-SCH          TO K730-CDE-ALLOC-SCH.      11580000
      *    IF FB78-NUM-MCP-PRIORITY NOT = SPACES AND LOW-VALUES AND     11590000
      *                                  'M' AND 'P' AND 'C'            11600000
      *       MOVE FB78-NUM-SPEC-SCHEME     TO K730-CDE-ALLOC-SCH       11610000
      *    ELSE                                                         11620000
      *       MOVE FB78-CDE-ALLOC-SCH       TO K730-CDE-ALLOC-SCH       11630000
      *    END-IF.                                                      11640000
                                                                        11650000
           IF FB78-CDE-ALLOC-SCH = 'TCP'                                11660000
              MOVE 'TCP'                    TO K730-CDE-ELIG-SCH        11670000
              MOVE 'TCP'                    TO K730-CDE-ALLOC-SCH       11680000
           END-IF.                                                      11690000
                                                                        11700000
           EVALUATE K730-CDE-ALLOC-SCH                                  11710000
           WHEN 'JB'                                                    11720000
             MOVE         '1' TO K730-CDE-JB                            11730000
           WHEN 'MT'                                                    11740000
           WHEN 'MTS'                                                   11750000
             MOVE         '4' TO K730-CDE-JB                            11760000
           WHEN 'TCP'                                                   11770000
             MOVE         '9' TO K730-CDE-JB                            11780000
           WHEN OTHER                                                   11790000
             MOVE         '0' TO K730-CDE-JB                            11800000
           END-EVALUATE.                                                11810000
                                                                        11820000
      **  READ MCPS RES NRIC1 FOR DUXTON PLAIN BTO FROM NUM-PRSN1-UIN   11830000
           IF (FB78-NUM-MCP-PRIORITY = 'C' OR 'P') AND                  11840000
              (FB78-NUM-CHILD1-PARENT-UIN NOT = SPACES)                 11850000
              MOVE FB78-NUM-CHILD1-PARENT-UIN TO K730-NUM-RES-NRIC1.    11860000
                                                                        11870000
      **  READ MCPS RES NRIC2 FOR DUXTON PLAIN BTO FROM NUM-PRSN2-UIN   11880000
           IF (FB78-NUM-MCP-PRIORITY = 'C' OR 'P') AND                  11890000
              (FB78-NUM-CHILD2-PARENT-UIN NOT = SPACES)                 11900000
              MOVE FB78-NUM-CHILD2-PARENT-UIN TO K730-NUM-RES-NRIC2.    11910000
                                                                        11920000
      **  MOVE MCPS CODE TO K730-NUM-MCPS FOR 'C', 'P' OR 'M'           11930000
           IF FB78-NUM-MCP-PRIORITY = 'C' OR 'P' OR 'M'                 11940000
              MOVE FB78-NUM-MCP-PRIORITY    TO K730-NUM-MCPS.           11950000
                                                                        11960000
      **  MOVE MCPS POSTAL CODE TO K730-NUM-MCPS-POSTAL                 11970000
           IF FB78-NUM-CP-POST = SPACES OR LOW-VALUES                   11980000
              MOVE SPACES               TO K730-NUM-MCPS-POSTAL         11990000
           ELSE                                                         12000000
              MOVE FB78-NUM-CP-POST     TO K730-NUM-MCPS-POSTAL.        12010000
                                                                        12020000
      *---------------------------                                      12030000
      * DECODE IPD SCHEME                                               12040000
      *---------------------------                                      12050000
           MOVE 'Y'                         TO WS-FOUND-SW.             12060000
           MOVE SPACES                      TO WS-DESC.                 12070000
           SET WS-IDP-PTR                   TO 1.                       12080000
                                                                        12090000
           SEARCH WS-IDP-SCH                                            12100000
             AT   END MOVE 'N'              TO   WS-FOUND-SW            12110000
                 WHEN WS-ALC-SCH-CODE (WS-IDP-PTR) = K730-CDE-ALLOC-SCH 12120000
                      MOVE WS-IDP-SCH-CODE (WS-IDP-PTR) TO WS-DESC      12130000
           END-SEARCH.                                                  12140000
                                                                        12150000
           IF  WS-FOUND-SW = 'N'                                        12160000
               MOVE 'PA '                  TO  WS-DESC                  12170000
           END-IF.                                                      12180000
                                                                        12190000
           MOVE WS-DESC                     TO K730-CDE-IDP-SCH.        12200000
                                                                        12210000
           MOVE FB78-DTE-REQUESTED          TO K730-DTE-REQUEST.        12220000
           MOVE 'I'                         TO K730-NUM-APPLN-TYPE.     12230000
           MOVE WS-SYSTEM-DATE              TO K730-DTE-UPDATE.         12240000
           MOVE 'P13C02B'                   TO K730-NUM-USER-ID.        12250000
                                                                        12260000
      *---------------------------                                      12270000
      * LOAN/AHG/CPF GRANT REQ                                          12280000
      *---------------------------                                      12290000
                                                                        12300000
           MOVE FB78-NUM-APPL-LOAN-REQ      TO K730-NUM-APPL-LOAN-REQ.  12310000
           MOVE FB78-NUM-AHG-REQ            TO K730-NUM-AHG-REQ.        12320000
           MOVE FB78-NUM-CPFHG-REQ          TO K730-NUM-HSGNT-REQ.      12330000
                                                                        12340000
      *------------------------------                                   12350000
      * CATER FOR DIFFERENT PROJ CODE                                   12360000
      *------------------------------                                   12370000
           EVALUATE FB78-NUM-PROJECT                                    12380000
              WHEN 'D01'                                                12390000
                  MOVE '200610'                 TO K730-DTE-BALLOT      12400000
              WHEN 'D02'                                                12410000
                  MOVE '200801'                 TO K730-DTE-BALLOT      12420000
              WHEN 'D03'                                                12430000
                  MOVE '200807'                 TO K730-DTE-BALLOT      12440000
              WHEN 'D04'                                                12450000
                  MOVE '200810'                 TO K730-DTE-BALLOT      12460000
              WHEN 'D05'                                                12470000
                  MOVE '200904'                 TO K730-DTE-BALLOT      12480000
              WHEN 'D06'                                                12490000
                  MOVE '200904'                 TO K730-DTE-BALLOT      12500000
              WHEN 'D07'                                                12510000
                  MOVE '201102'                 TO K730-DTE-BALLOT      12520000
              WHEN 'D08'                                                12530000
                  MOVE '201106'                 TO K730-DTE-BALLOT      12540000
           END-EVALUATE.                                                12550000
                                                                        12560000
           WRITE BP13K730-REC.                                          12570000
                                                                        12580000
           IF WS-K730-STATUS = ZEROS OR 02                              12590000
              ADD   +1                      TO WS-K730-WRITE-CTR        12600000
           ELSE                                                         12610000
           IF WS-K730-STATUS = 22                                       12620000
              DISPLAY 'BP13K730 DUPLICATE EXISTS, KEY IS ' K730-KEY-NEW 12630000
              ADD  +1                       TO WS-K730-DUP-CTR          12640000
              MOVE K-K730-DUPLICATE         TO L02B-REMARKS             12650000
              MOVE SPACES                   TO WS-TEMP-NRIC             12660000
              PERFORM 7000-PRINT-ERROR    THRU 7000-EXIT                12670000
           ELSE                                                         12680000
              DISPLAY 'BP13K730 WRITE ERROR, STATUS IS ' WS-K730-STATUS 12690000
              DISPLAY 'BP13K730 RECORD KEY IS ' K730-KEY-NEW            12700000
              ADD  +1                       TO WS-K730-ERROR-CTR        12710000
              MOVE WS-K730-STATUS           TO RETURN-CODE              12720000
              MOVE SPACES                   TO WS-TEMP-NRIC             12730000
              MOVE K-K730-ERROR             TO L02B-REMARKS             12740000
              PERFORM 7000-PRINT-ERROR    THRU 7000-EXIT                12750000
           END-IF.                                                      12760000
                                                                        12770000
       4300-EXIT.                                                       12780000
           EXIT.                                                        12790000
                                                                        12800000
                                                                        12810000
      **********************************************************        12820000
       4400-BP13K830-WRITE.                                             12830000
      **********************************************************        12840000
           MOVE SPACES                      TO BP13K830-REC.            12850000
                                                                        12860000
           MOVE FB78-NUM-REGN               TO K830-KEY-FLD.            12870000
           MOVE FB78-NUM-REGN               TO K830-NUM-REGN.           12880000
                                                                        12890000
           MOVE FB78-NUM-MAIN-BLK           TO K830-NUM-MAIL-MAIN-BLK.  12900000
           MOVE FB78-NUM-SUB-BLK            TO K830-NUM-MAIL-SUB-BLK.   12910000
                                                                        12920000
           IF FB78-NUM-SUB-BLK NOT = SPACES AND LOW-VALUES              12930000
              MOVE '-'                      TO K830-NUM-MAIL-BLK-DASH   12940000
           ELSE                                                         12950000
              MOVE SPACES                   TO K830-NUM-MAIL-BLK-DASH   12960000
           END-IF.                                                      12970000
                                                                        12980000
           MOVE '#'                         TO K830-NUM-MAIL-LVL-CHAR.  12990000
                                                                        13000000
           IF (FB78-NUM-LEVEL(1:1) = SPACES OR LOW-VALUES) AND          13010000
              (FB78-NUM-LEVEL(2:1) NOT = SPACES AND LOW-VALUES)         13020000
              STRING '0', FB78-NUM-LEVEL(2:1)                           13030000
                 DELIMITED BY SIZE                                      13040000
                 INTO  K830-NUM-MAIL-LVL-NUM                            13050000
              END-STRING                                                13060000
           ELSE                                                         13070000
             IF (FB78-NUM-LEVEL(2:1) = SPACES OR LOW-VALUES) AND        13080000
                (FB78-NUM-LEVEL(1:1) NOT = SPACES AND LOW-VALUES)       13090000
                STRING '0', FB78-NUM-LEVEL(1:1)                         13100000
                   DELIMITED BY SIZE                                    13110000
                   INTO  K830-NUM-MAIL-LVL-NUM                          13120000
                END-STRING                                              13130000
             ELSE                                                       13140000
                MOVE FB78-NUM-LEVEL   TO K830-NUM-MAIL-LVL-NUM          13150000
             END-IF                                                     13160000
           END-IF.                                                      13170000
                                                                        13180000
           MOVE '-'                         TO K830-NUM-MAIL-LVL-DASH.  13190000
           MOVE FB78-NUM-MAIN-UNIT          TO K830-NUM-MAIL-HSEMAIN.   13200000
           MOVE FB78-NUM-SUB-UNIT           TO K830-NUM-MAIL-HSESUB.    13210000
                                                                        13220000
           MOVE FB78-NUM-CORRESP-STREET     TO K830-NME-MAIL-STR-BLDG.  13230000
           MOVE FB78-CDE-CORRESP-POST       TO K830-NUM-MAIL-POSTAL.    13240000
                                                                        13250000
           IF FB78-NUM-MAIN-BLK  NOT = SPACES AND                       13260000
              FB78-NUM-MAIN-UNIT NOT = SPACES AND                       13270000
              FB78-NUM-CORRESP-STREET NOT = SPACES                      13280000
              MOVE 'BLK'                    TO K830-NUM-MAIL-BLK-HDR    13290000
              MOVE 'H'                      TO K830-NUM-MAIL-ADDR-TYPE  13300000
           ELSE                                                         13310000
              IF FB78-NUM-MAIN-BLK  = SPACES AND                        13320000
                 FB78-NUM-MAIN-UNIT = SPACES AND                        13330000
                 FB78-NUM-CORRESP-STREET NOT = SPACES                   13340000
                 MOVE 'N'                   TO K830-NUM-MAIL-ADDR-TYPE  13350000
              ELSE                                                      13360000
                 MOVE SPACES                TO K830-NUM-MAIL-ADDR-TYPE  13370000
              END-IF                                                    13380000
              MOVE SPACES                   TO K830-NUM-MAIL-LVL-CHAR   13390000
                                               K830-NUM-MAIL-LVL-DASH   13400000
           END-IF.                                                      13410000
                                                                        13420000
           IF FB78-CDE-CORRESP-POST = SPACES                            13430000
              MOVE SPACES TO K830-NUM-MAIL-ADDR                         13440000
           END-IF.                                                      13450000
                                                                        13460000
           MOVE WS-CURRENT-DATE             TO K830-DTE-UPDATE.         13470000
           MOVE 'P13C02B'                   TO K830-NUM-USERID.         13480000
                                                                        13490000
           WRITE BP13K830-REC.                                          13500000
                                                                        13510000
           IF WS-K830-STATUS = ZEROS OR 02                              13520000
              ADD   +1                      TO WS-K830-WRITE-CTR        13530000
           ELSE                                                         13540000
           IF WS-K830-STATUS = 22                                       13550000
              DISPLAY 'BP13K830 DUPLICATE EXISTS, KEY IS ' K830-KEY-FLD 13560000
              ADD  +1                           TO WS-K830-DUP-CTR      13570000
              MOVE K-K830-DUPLICATE             TO L02B-REMARKS         13580000
              MOVE SPACES                       TO WS-TEMP-NRIC         13590000
              PERFORM 7000-PRINT-ERROR          THRU 7000-EXIT          13600000
           ELSE                                                         13610000
              DISPLAY 'BP13K830 WRITE ERROR, STATUS IS ' WS-K830-STATUS 13620000
              DISPLAY 'BP13K830 RECORD KEY IS ' K830-KEY-FLD            13630000
              ADD  +1                           TO WS-K830-ERROR-CTR    13640000
              MOVE K-K830-ERROR                 TO L02B-REMARKS         13650000
              MOVE SPACES                       TO WS-TEMP-NRIC         13660000
              PERFORM 7000-PRINT-ERROR          THRU 7000-EXIT          13670000
           END-IF.                                                      13680000
                                                                        13690000
       4400-EXIT.                                                       13700000
           EXIT.                                                        13710000
                                                                        13720000
                                                                        13730000
      **********************************************************        13740000
       7000-PRINT-ERROR.                                                13750000
      **********************************************************        13760000
           IF WS-L02B-LINECTR > 24                                      13770000
              PERFORM 7100-PRINT-HEADING THRU 7100-EXIT                 13780000
           END-IF.                                                      13790000
                                                                        13800000
           ADD   +1                      TO   WS-L02B-S-NO.             13810000
           MOVE WS-L02B-S-NO             TO   L02B-S-NO.                13820000
                                                                        13830000
           MOVE FB78-NUM-REGN            TO   L02B-REGN.                13840000
           MOVE FB78-NUM-APPLT1-UIN      TO   L02B-NRIC.                13850000
                                                                        13860000
           IF WS-TEMP-NRIC(1:1) = '-'                                   13870000
              MOVE 'X'                  TO L02B-ERROR-NRIC(1:1)         13880000
              MOVE WS-TEMP-NRIC(2:8)    TO L02B-ERROR-NRIC(2:8)         13890000
           ELSE                                                         13900000
              MOVE WS-TEMP-NRIC         TO L02B-ERROR-NRIC.             13910000
                                                                        13920000
           WRITE BP13L02B-REC          FROM   L02B-DETAIL-01            13930000
                                      AFTER   ADVANCING 2 LINES.        13940000
                                                                        13950000
           ADD  +1                       TO   WS-L02B-LINECTR.          13960000
                                                                        13970000
       7000-EXIT.                                                       13980000
           EXIT.                                                        13990000
                                                                        14000000
                                                                        14010000
      **********************************************************        14020000
       7100-PRINT-HEADING.                                              14030000
      **********************************************************        14040000
           ADD   +1               TO WS-L02B-PAGECTR.                   14050000
           MOVE WS-L02B-PAGECTR   TO L02B-PAGE-NO.                      14060000
                                                                        14070000
           WRITE BP13L02B-REC   FROM L02B-HEADING-01                    14080000
                               AFTER ADVANCING PAGE.                    14090000
                                                                        14100000
           WRITE BP13L02B-REC   FROM L02B-HEADING-02                    14110000
                               AFTER ADVANCING 1 LINE.                  14120000
                                                                        14130000
           WRITE BP13L02B-REC   FROM L02B-HEADING-03                    14140000
                               AFTER ADVANCING 1 LINE.                  14150000
                                                                        14160000
           WRITE BP13L02B-REC   FROM L02B-HEADING-04                    14170000
                               AFTER ADVANCING 2 LINES.                 14180000
                                                                        14190000
           WRITE BP13L02B-REC   FROM L02B-HEADING-05                    14200000
                               AFTER ADVANCING 1 LINES.                 14210000
                                                                        14220000
           MOVE ZEROS             TO WS-L02B-LINECTR.                   14230000
                                                                        14240000
       7100-EXIT.                                                       14250000
           EXIT.                                                        14260000
                                                                        14270000
                                                                        14280000
      **********************************************************        14290000
       8000-PRINT-REPORT.                                               14300000
      **********************************************************        14310000
      *--------------> PRINT FILE STATISTICS ON NEW PAGE                14320000
                                                                        14330000
           ADD   +1               TO WS-L02B-PAGECTR.                   14340000
           MOVE WS-L02B-PAGECTR   TO L02B-PAGE-NO.                      14350000
                                                                        14360000
           WRITE BP13L02B-REC   FROM L02B-HEADING-01                    14370000
                               AFTER ADVANCING PAGE.                    14380000
                                                                        14390000
           WRITE BP13L02B-REC   FROM L02B-HEADING-02                    14400000
                               AFTER ADVANCING 1 LINE.                  14410000
                                                                        14420000
           MOVE SPACES                      TO   L02B-TOTALS.           14430000
                                                                        14440000
      *--------------> BP13FB78 STATISTICS                              14450000
                                                                        14460000
           MOVE  K-FB78-RECORDS-READ        TO   L02B-TOTAL-DESC.       14470000
           MOVE  WS-FB78-READ-CTR           TO   L02B-TOTAL-VALUE.      14480000
           WRITE BP13L02B-REC             FROM   L02B-TOTALS            14490000
                                         AFTER   ADVANCING 2 LINES.     14500000
                                                                        14510000
      *--------------> BE01F500 STATISTICS                              14520000
                                                                        14530000
           MOVE  K-F500-RECORDS-WRITE       TO   L02B-TOTAL-DESC.       14540000
           MOVE  WS-F500-WRITE-CTR          TO   L02B-TOTAL-VALUE.      14550000
           WRITE BP13L02B-REC             FROM   L02B-TOTALS            14560000
                                         AFTER   ADVANCING 2 LINES.     14570000
                                                                        14580000
      *--------------> BP13K825 STATISTICS                              14590000
                                                                        14600000
           MOVE  K-K825-RECORDS-WRITE       TO   L02B-TOTAL-DESC.       14610000
           MOVE  WS-K825-WRITE-CTR          TO   L02B-TOTAL-VALUE.      14620000
           WRITE BP13L02B-REC             FROM   L02B-TOTALS            14630000
                                         AFTER   ADVANCING 2 LINES.     14640000
                                                                        14650000
           MOVE  K-K825-RECORDS-DUP         TO   L02B-TOTAL-DESC.       14660000
           MOVE  WS-K825-DUP-CTR            TO   L02B-TOTAL-VALUE.      14670000
           WRITE BP13L02B-REC             FROM   L02B-TOTALS            14680000
                                         AFTER   ADVANCING 1 LINES.     14690000
                                                                        14700000
           MOVE  K-K825-UNSUCC-WRITE        TO   L02B-TOTAL-DESC.       14710000
           MOVE  WS-K825-ERROR-CTR          TO   L02B-TOTAL-VALUE.      14720000
           WRITE BP13L02B-REC             FROM   L02B-TOTALS            14730000
                                         AFTER   ADVANCING 1 LINES.     14740000
                                                                        14750000
      *--------------> BP13K830 STATISTICS                              14760000
                                                                        14770000
           MOVE  K-K830-RECORDS-WRITE       TO   L02B-TOTAL-DESC.       14780000
           MOVE  WS-K830-WRITE-CTR          TO   L02B-TOTAL-VALUE.      14790000
           WRITE BP13L02B-REC             FROM   L02B-TOTALS            14800000
                                         AFTER   ADVANCING 2 LINES.     14810000
                                                                        14820000
           MOVE  K-K830-RECORDS-DUP         TO   L02B-TOTAL-DESC.       14830000
           MOVE  WS-K830-DUP-CTR            TO   L02B-TOTAL-VALUE.      14840000
           WRITE BP13L02B-REC             FROM   L02B-TOTALS            14850000
                                         AFTER   ADVANCING 1 LINES.     14860000
                                                                        14870000
           MOVE  K-K830-UNSUCC-WRITE        TO   L02B-TOTAL-DESC.       14880000
           MOVE  WS-K830-ERROR-CTR          TO   L02B-TOTAL-VALUE.      14890000
           WRITE BP13L02B-REC             FROM   L02B-TOTALS            14900000
                                         AFTER   ADVANCING 1 LINES.     14910000
                                                                        14920000
      *--------------> BP13K730 STATISTICS                              14930000
                                                                        14940000
           MOVE  K-K730-RECORDS-WRITE       TO   L02B-TOTAL-DESC.       14950000
           MOVE  WS-K730-WRITE-CTR          TO   L02B-TOTAL-VALUE.      14960000
           WRITE BP13L02B-REC             FROM   L02B-TOTALS            14970000
                                         AFTER   ADVANCING 2 LINES.     14980000
                                                                        14990000
           MOVE  K-K730-RECORDS-DUP         TO   L02B-TOTAL-DESC.       15000000
           MOVE  WS-K730-DUP-CTR            TO   L02B-TOTAL-VALUE.      15010000
           WRITE BP13L02B-REC             FROM   L02B-TOTALS            15020000
                                         AFTER   ADVANCING 1 LINES.     15030000
                                                                        15040000
           MOVE  K-K730-UNSUCC-WRITE        TO   L02B-TOTAL-DESC.       15050000
           MOVE  WS-K730-ERROR-CTR          TO   L02B-TOTAL-VALUE.      15060000
           WRITE BP13L02B-REC             FROM   L02B-TOTALS            15070000
                                         AFTER   ADVANCING 1 LINES.     15080000
                                                                        15090000
       8000-EXIT.                                                       15100000
           EXIT.                                                        15110000
                                                                        15120000
                                                                        15130000
      **********************************************************        15140000
       9000-CLOSE-FILES.                                                15150000
      **********************************************************        15160000
           CLOSE BP13FB78                                               15170000
                 BP13K730                                               15180000
                 BP13K825                                               15190000
                 BE01F500                                               15200000
                 BP13L02B.                                              15210000
                                                                        15220000
           IF WS-K730-STATUS NOT = 0                                    15230000
              DISPLAY 'BP13K730 CLOSE ERROR, STATUS IS ' WS-K730-STATUS 15240000
              MOVE WS-K730-STATUS TO RETURN-CODE .                      15250000
                                                                        15260000
           IF WS-K825-STATUS NOT = 0                                    15270000
              DISPLAY 'BP13K825 CLOSE ERROR, STATUS IS ' WS-K825-STATUS 15280000
              MOVE WS-K825-STATUS TO RETURN-CODE .                      15290000
                                                                        15300000
           IF WS-K830-STATUS NOT = 0                                    15310000
              DISPLAY 'BP13K830 CLOSE ERROR, STATUS IS ' WS-K830-STATUS 15320000
              MOVE WS-K830-STATUS TO RETURN-CODE .                      15330000
                                                                        15340000
           STOP RUN.                                                    15350000
                                                                        15360000
       9000-EXIT.                                                       15370000
           EXIT.                                                        15380000
