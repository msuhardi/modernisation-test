       IDENTIFICATION DIVISION.                                         00010023
       PROGRAM-ID.    BP13C49V.                                         00020023
      *AUTHOR.        KAVYA VAKA.                                       00030023
      *DATE-WRITTEN.  JUN 06 2021.                                      00040023
      * ============================================================    00050023
      * SYSTEM OF COMMITMENT (SOC)                                      00060023
      * ============================================================    00070023
      * OBJECTIVE  - PRINT LETTERS ON NOTIFICATION OF                   00080023
      *              REVISED COMPLETION DATE.                           00090023
      *                                                                 00100023
      * FORM USED  BP13T1                                               00110023
      *                                                                 00120023
      * INPUT FILES:  BM06F110                                          00130023
      *               BM06K110                                          00140023
      *               BP13K022                                          00150023
      *               BP13K024                                          00160023
      *               BP13K800                                          00170023
      *               BP13K820                                          00180023
      *               BP13K830                                          00190023
      *               BM06K100                                          00200023
      *               BM06K510                                          00210023
      *               BP13K857                                          00220023
      *        I-O    BP13K491                                          00230023
      *               BP13F491                                          00240023
      * REPORT:       BP13L49J                                          00250023
      *               BP13P491                                          00260023
      * ------------------------------------------------------------    00270023
      * REF NO    DATE  BY  DESCRIPTIONS                                00280023
      * -------- ------ --- ------------                                00290023
      * BP138761 040621 KV8  NEW PGM                                    00300023
      * BP138762 080621 KV8  INCLUDED NEW FORMS BP13W1,BP13X1,BP13M1    00310023
      *                      AND BP13K1                                 00320023
      * BP138763 100621 KV8  INCLUDED NEW FORMS BP13S1,BP13B1,BP13B3    00330023
      *                      BP13H1,BP13V3,BP13V1 AND BP13D1            00340023
      * BP138764 110621 KV8  INCLUDED NEW FORMS BP13F1,BP13F3,BP13T3    00350023
      *                      BP13T1,BP13P1 AND BP13P3                   00360023
      * BP138810 080721 KV8  INCLUDED NEW FORM BP13S1                   00370023
      * BP138874 250821 KV8  INCLUDED NEW FORM BP13O1 & BP13NB          00380023
      * BP138893 090921 KV8  INCLUDED NEW FORM BP13W1                   00390023
      * BP138896 160921 KV8  INCLUDED NEW FORM BP13R1 & BP13R3          00400023
      * BP138909 240921 KV8  INCLUDED NEW FORM BP13O1,BP13O3,           00410023
      *                      BP13V1,BP13V3 & BP13D1                     00420023
      * BP138913 081021 KV8  INCLUDED NEW FORM BP13V1,BP13V3 & BP13D1   00430023
      * BP138986 021221 KV8  INCLUDED NEW FORM BP13R1                   00440023
      * BP138998 081221 KV8  INCLUDED NEW FORM BP13R1,BP13V1 & BP13V3   00450023
      * BP138998 131221 KV8  TO CATER FOR WOODLANDS N7 C27 USING BP13D1 00460023
      * BP139005 171221 KV8  INCLUDED NEW FORM BP13R1,BP13V1 & BP13V3   00470023
      * BP139047 240122 KV8  INCLUDED NEW FORM BP13V1 & BP13V3          00480023
      *                      AND PRINT DATE AS 31 Jan 2022 WSII.        00490023
      * BP139068 030222 KV8  INCLUDED NEW FORM BP13R1 AND BP13D1        00500023
      * BP139107 230322 KV8  INCLUDED NEW FORM BP13R1                   00510023
      * BP139107 250322 KV8  CHANGE DATE TO 26032022                    00520023
      * BP139107 260322 KV8  TO REMOVE DATE 26032022 FOR                00530023
      *                      Champions Green (Woodlands N5 C24)         00540023
      * BP139119 280322 KV8  INCLUDED NEW FORM BP13V1 & BP13V3          00550023
      * BP139119 300322 KV8  Changed the delay months from 9 to 6       00560023
      *                      for 632A, 632B and 633A blocks             00570023
      * BP139147 160422 KV8  INCLUDED NEW FORM BP13V1,BP13V3 & BP13R1   00580023
      * BP139147 200422 KV8  INCLUDED REV DATE & DELAY MON, REMOVED     00590023
      *                      THE NO DELAY BLOCKS                        00600023
      * BP139179 280422 KV8  CHANGED THE FORM ID BP13V3 TO BP13D1       00610023
      * BP139233 230622 KV8  CHANGED THE FORM ID BP13V3 TO BP13V1       00620023
      * BP139233 290622 KV8  CHANGED THE 20220627 TO CURRENT DATE       00630023
      * BP139355 230922 KV8  FLAT ELIGIBLE FOR COTMA(BP13V1) & FLAT NOT 00640023
      *                      ELIGIBLE FOR COTMA(BP13V3)                 00650023
      * BP139395 271022 KV8  FLAT ELIGIBLE FOR COTMA(BP13V1) & FLAT NOT 00660023
      *                      ELIGIBLE FOR COTMA(BP13V3) FOR JAN 2023    00670023
      * BP139422 161122 KV8  FLAT ELIGIBLE FOR COTMA(BP13V1) AND ALLOCAT00680023
      *                      NOT EQUAL NPL & FLAT NOT ELIGIBLE FOR COTMA00690023
      *                      (BP13V3) OR ALLOCAT EQUAL NPL              00700023
      * BP139422 171122 KV8  INSERTED CODE FOR FTP                      00710023
      * BP139395 090123 KAC1 MATERIALS ON TERMINATION OF JSM FOR BTO    00720023
      *                      PROJECTS HARMONY VILLAGE.                  00730023
      * BP139395 100123 KV8  TO PRINT ALL CASES FOR 469A                00740023
      * BP139577 150523 KV8  TO PRINT ALL CASES FOR 446A & 446B         00750023
      * BP139660 170723 KV8  TO PRINT ALL CASES FOR 443A, 442A, 442B    00760023
      *                      443B, 445A & 445B                          00770023
      * BP139660 170823 KV8  TO PRINT ALL CASES FOR 443A, 442A, 442B    00780023
      *                      443B, 445A & 445B                          00790023
      * BP139702 280823 KV8  TO PRINT ALL CASES FOR 289A, 289B AND 289C 00800023
      *                      based on 31 aug 2023.                      00810023
      * BP139702 040093 KV8  TO PRINT ALL CASES FOR 289A, 289B AND 289C 00820023
      *                      based on current date.                     00830023
      * BP139760 161023 KV8  TO PRINT ALL CASES FOR 289A, 289B AND 289C 00840023
      *                      based on current date.                     00850023
      * BP139760 191023 KV8  TO PRINT ALL CASES FOR 432A & 432B         00860023
      *                      based on 20/10/2023.                       00870023
      * BP139760 201023 KV8  TO PRINT ALL CASES FOR 289A, 289B AND 289C 00880023
      *                      based on current date.                     00890023
      * BP139760 301023 KV8  TO PRINT ALL CASES FOR 289A, 289B AND 289C 00900023
      *                      based on 31/10/2023.                       00910023
      * BP139797 061123 KV8  TO PRINT ALL CASES FOR 469A based on       00920023
      *                      07/11/2023.                                00930023
      * BP139844 261223 KV8  TO PRINT ALL CASES FOR 448B                00940023
      * BP139844 060124 KV8  TO CATER FOR eFPF                          00941023
      * ============================================================    00950023
                                                                        00960023
       ENVIRONMENT DIVISION.                                            00970023
       CONFIGURATION SECTION.                                           00980023
       SOURCE-COMPUTER. IBM-3090.                                       00990023
       OBJECT-COMPUTER. IBM-3090.                                       01000023
       INPUT-OUTPUT SECTION.                                            01010023
       FILE-CONTROL.                                                    01020023
                                                                        01030023
           SELECT BP13K022  ASSIGN       TO BP13K022                    01040023
                            ACCESS MODE  IS RANDOM                      01050023
                            ORGANIZATION IS INDEXED                     01060023
                            RECORD KEY   IS K022-KEY-FLD                01070023
                            ALTERNATE RECORD KEY IS K022-NUM-REGN       01080023
                            WITH DUPLICATES                             01090023
                            FILE STATUS  IS K022-STATUS.                01100023
                                                                        01110023
           SELECT BP13K024  ASSIGN       TO BP13K024                    01120023
                            ACCESS MODE  IS RANDOM                      01130023
                            ORGANIZATION IS INDEXED                     01140023
                            RECORD KEY   IS K024-KEY-FLD                01150023
                            FILE STATUS  IS K024-STATUS.                01160023
                                                                        01170023
           SELECT BP13K800 ASSIGN        TO BP13K800                    01180023
                           ORGANIZATION  IS INDEXED                     01190023
                           ACCESS MODE   IS RANDOM                      01200023
                           RECORD KEY    IS K800-NUM-REGN               01210023
                           FILE STATUS   IS K800-STATUS.                01220023
                                                                        01230023
           SELECT BP13K820 ASSIGN        TO BP13K820                    01240023
                           ORGANIZATION  IS INDEXED                     01250023
                           ACCESS MODE   IS RANDOM                      01260023
                           RECORD KEY    IS K820-KEY-FLD                01270023
                           FILE STATUS   IS K820-STATUS.                01280023
                                                                        01290023
           SELECT BP13K830 ASSIGN        TO BP13K830                    01300023
                           ORGANIZATION  IS INDEXED                     01310023
                           ACCESS MODE   IS RANDOM                      01320023
                           RECORD KEY    IS K830-KEY-FLD                01330023
                           ALTERNATE KEY IS K830-NUM-REGN               01340023
                           FILE STATUS   IS K830-STATUS.                01350023
                                                                        01360023
           SELECT BP13K857 ASSIGN        TO BP13K857                    01370023
                           ORGANIZATION  IS INDEXED                     01380023
                           ACCESS MODE   IS RANDOM                      01390023
                           RECORD KEY    IS K857-KEY-FLD                01400023
                           FILE STATUS   IS K857-STATUS.                01410023
           SELECT BM06K510 ASSIGN        TO BM06K510                    01420023
                           ORGANIZATION  IS INDEXED                     01430023
                           ACCESS MODE   IS RANDOM                      01440023
                           RECORD KEY    IS K510-ESTCDE                 01450023
                           FILE STATUS   IS K510-STATUS.                01460023
                                                                        01470023
           SELECT BP13K491 ASSIGN       TO BP13K491                     01480023
                           ORGANIZATION  IS INDEXED                     01490023
                           ACCESS MODE   IS RANDOM                      01500023
                           RECORD KEY    IS K491-KEY-FLD                01510023
                           FILE STATUS   IS K491-STATUS.                01520023
                                                                        01530023
           SELECT BM06K100 ASSIGN        TO BM06K100                    01540023
                           ORGANIZATION  IS INDEXED                     01550023
                           ACCESS MODE   IS RANDOM                      01560023
                           RECORD KEY    IS K100-KEY-FLD                01570023
                           FILE STATUS   IS K100-STATUS.                01580023
                                                                        01590023
           SELECT  BM06K110 ASSIGN       TO BM06K110                    01600023
                            ACCESS MODE  IS RANDOM                      01610023
                            ORGANIZATION IS INDEXED                     01620023
                            RECORD KEY   IS K110-KEY-FLD                01630023
                            FILE STATUS  IS K110-STATUS.                01640023
                                                                        01650023
           SELECT BP13F491 ASSIGN       TO BP13F491.                    01660023
           SELECT BP13L49J ASSIGN       TO BP13L49J.                    01670023
           SELECT BP13P491 ASSIGN       TO BP13P491.                    01680023
           SELECT BM06F110 ASSIGN       TO BM06F110.                    01690023
      *    SELECT BP13INP1 ASSIGN       TO BP13INP1.                    01700023
           SELECT P13BC49V ASSIGN       TO P13BC49V.                    01710023
           SELECT P13HC49V ASSIGN       TO P13HC49V.                    01720023
           SELECT BP13FTP  ASSIGN       TO BP13FTP.                     01730023
                                                                        01740023
                                                                        01750023
       DATA DIVISION.                                                   01760023
       FILE SECTION.                                                    01770023
      *-------------------------------------------------------------    01780023
       FD   BP13K022                                                    01790023
            RECORD CONTAINS 100 CHARACTERS.                             01800023
       COPY BP13K022.                                                   01810023
                                                                        01820023
       FD   BP13K024                                                    01830023
            RECORD CONTAINS 100 CHARACTERS.                             01840023
       COPY BP13K024.                                                   01850023
                                                                        01860023
       FD   BP13K800                                                    01870023
            RECORD CONTAINS 2000 CHARACTERS.                            01880023
       COPY BP13K800.                                                   01890023
                                                                        01900023
       FD   BP13K820                                                    01910023
            RECORD CONTAINS 400 CHARACTERS.                             01920023
       COPY BP13K820.                                                   01930023
                                                                        01940023
       FD   BP13K830                                                    01950023
            RECORD CONTAINS 250 CHARACTERS.                             01960023
       COPY BP13K830.                                                   01970023
                                                                        01980023
       FD   BP13K857                                                    01990023
            RECORD CONTAINS 200 CHARACTERS.                             02000023
       COPY BP13K857.                                                   02010023
                                                                        02020023
       FD   BP13K491                                                    02030023
            RECORD CONTAINS 200 CHARACTERS.                             02040023
       COPY BP13K491.                                                   02050023
                                                                        02060023
       FD   BM06K510                                                    02070023
            RECORD CONTAINS 60 CHARACTERS.                              02080023
       COPY BM06K510.                                                   02090023
                                                                        02100023
       FD   BM06K100                                                    02110023
            RECORD CONTAINS 500 CHARACTERS.                             02120023
       COPY BM06K100.                                                   02130023
                                                                        02140023
       FD   BM06F110                                                    02150023
            RECORDING MODE IS F                                         02160023
            RECORD CONTAINS 500 CHARACTERS                              02170023
            BLOCK  CONTAINS 0   RECORDS.                                02180023
       COPY BM06F110.                                                   02190023
                                                                        02200023
       FD   BM06K110                                                    02210023
            RECORD CONTAINS 500 CHARACTERS.                             02220023
       COPY BM06K110.                                                   02230023
                                                                        02240023
       FD   BP13F491                                                    02250023
            RECORDING MODE IS F                                         02260023
            RECORD CONTAINS 200 CHARACTERS                              02270023
            BLOCK  CONTAINS 0   RECORDS.                                02280023
       COPY BP13F491.                                                   02290023
                                                                        02300023
      *FD   BP13INP1                                                    02310023
      *     RECORDING MODE IS F                                         02320023
      *     RECORD CONTAINS 100 CHARACTERS                              02330023
      *     BLOCK  CONTAINS 0   RECORDS.                                02340023
      *01   INP1-REC.                                                   02350023
      *      05 INP1-EST-NEIG-CON PIC X(16).                            02360023
      *      05 INP1-PROJ-NAME    PIC X(40).                            02370023
      *      05 INP1-PCD-REV      PIC X(18).                            02380023
      *      05 INP1-DELAY-MONS   PIC X(02).                            02390023
      *      05 INP1-FILLER       PIC X(24).                            02400023
                                                                        02410023
       FD   BP13L49J           RECORDING MODE IS F                      02420023
                               RECORD CONTAINS 132 CHARACTERS           02430023
                               BLOCK  CONTAINS 0   RECORDS.             02440023
       01   L49J-PRTREC        PIC X(132).                              02450023
                                                                        02460023
       FD   BP13P491           RECORDING MODE IS F                      02470023
                               RECORD CONTAINS 100 CHARACTERS           02480023
                               BLOCK  CONTAINS 0   RECORDS.             02490023
       01   P491-PRTREC        PIC X(100).                              02500023
                                                                        02510023
       FD  P13BC49V                                                     02520023
           BLOCK CONTAINS 0 RECORDS                                     02530023
           RECORD CONTAINS 1500 CHARACTERS                              02540023
           RECORDING MODE IS F.                                         02550023
       01  P13BC49V-REC                PIC X(1500).                     02560023
                                                                        02570023
       FD  P13HC49V                                                     02580023
           BLOCK CONTAINS 0 RECORDS                                     02590023
           RECORD CONTAINS 72 CHARACTERS                                02600023
           RECORDING MODE IS F.                                         02610023
       01  P13HC49V-REC                PIC X(72).                       02620023
                                                                        02630023
       FD  BP13FTP                                                      02640023
           BLOCK CONTAINS 0 RECORDS                                     02650023
           RECORD CONTAINS 72 CHARACTERS                                02660023
           RECORDING MODE IS F.                                         02670023
       01  BP13FTP-REC                 PIC X(72).                       02680023
                                                                        02690023
       WORKING-STORAGE SECTION.                                         02700023
       COPY P13FH10A.                                                   02710023
       COPY P13P49UA.                                                   02720023
                                                                        02730023
       01  K022-STATUS                   PIC 99    VALUE 0.             02740023
       01  K024-STATUS                   PIC 99    VALUE 0.             02750023
       01  K800-STATUS                   PIC 99    VALUE 0.             02760023
       01  K820-STATUS                   PIC 99    VALUE 0.             02770023
       01  K830-STATUS                   PIC 99    VALUE 0.             02780023
       01  K510-STATUS                   PIC 99    VALUE 0.             02790023
       01  K100-STATUS                   PIC 99    VALUE 0.             02800023
       01  K857-STATUS                   PIC 99    VALUE 0.             02810023
       01  K491-STATUS                   PIC 99    VALUE 0.             02820023
       01  K110-STATUS                   PIC 99    VALUE 0.             02830023
       01  WS-F110-EOF                   PIC X     VALUE 'N'.           02840023
       01  WS-F491-EOF                   PIC X     VALUE 'N'.           02850023
      *01  WS-INP1-EOF                   PIC X     VALUE 'N'.           02860023
       01  WS-FOUND-K857                 PIC X     VALUE 'N'.           02870023
       01  WS-K110-FND                   PIC X     VALUE 'N'.           02880023
       01  WS-F491-FND                   PIC X     VALUE 'N'.           02890023
      *01  WS-INP1-FND                   PIC X     VALUE 'N'.           02900023
       01  WS-FOUND-K491                 PIC X     VALUE 'N'.           02910023
                                                                        02920023
       01  WS-IOMS-VARS.                                                02930023
           05  WS-BC49V-SNO            PIC 9(7)        VALUE ZEROES.    02940023
           05  WS-HC49V-WRITE          PIC 9(7)        VALUE ZEROES.    02950023
           05  WS-FB10-WRITE           PIC 9(7)        VALUE ZEROES.    02960023
           05  WS-FH10-WRITE           PIC 9(7)        VALUE ZEROES.    02970023
           05  WS-FTP-WRITE            PIC 9(7)        VALUE ZEROES.    02980023
           05  WS-BP137Z-CNT           PIC 9(6)        VALUE ZEROES.    02990023
           05  WS-GROUP-ID             PIC X(8)        VALUE SPACES.    03000023
           05  WS-PRINT-SETTING        PIC X(1)        VALUE SPACES.    03010023
                                                                        03020023
       01  WS-OCCUPANTS.                                                03030023
           05  WS-NAME      OCCURS 4 TIMES   PIC X(66).                 03040023
                                                                        03050023
       01  WS-IOMS-VARIABLES.                                           03060023
           05  WS-UPD-TMESTAMP.                                         03070023
               10  WS-UPD-DATE         PIC X(8)        VALUE SPACES.    03080023
               10  WS-UPD-TME          PIC X(8)        VALUE SPACES.    03090023
           05  WS-FTP-DEST-REC.                                         03100023
               10  WS-FTP-JOBNAME      PIC X(8)        VALUE SPACES.    03110023
               10  FILLER              PIC X           VALUE '_'.       03120023
               10  WS-FTP-DESC         PIC X(6)        VALUE SPACES.    03130023
               10  FILLER              PIC X           VALUE '_'.       03140023
               10  WS-FTP-TMESTAMP     PIC X(13)       VALUE SPACES.    03150023
           05  WS-P13FT10A-WRITE       PIC 9(7)        VALUE ZEROES.    03160023
           05  WS-PARM.                                                 03170023
               10  WS-PARM-JOBNAME     PIC X(8)        VALUE SPACES.    03180023
               10  WS-PARM-B10-SOURCE  PIC X(70)       VALUE SPACES.    03190023
               10  WS-PARM-H10-SOURCE  PIC X(70)       VALUE SPACES.    03200023
                                                                        03210023
       01  WS-BP13FTP-REC.                                              03220023
           05  WS-FTP-LINE1.                                            03230023
               10  FILLER              PIC X(2)        VALUE SPACES.    03240023
               10  FILLER              PIC X(12)       VALUE            03250023
                   'CD /DATAFILE'.                                      03260023
               10  FILLER              PIC X(58)       VALUE SPACES.    03270023
           05  WS-FTP-LINE2.                                            03280023
               10  FILLER              PIC X(2)        VALUE SPACES.    03290023
               10  FILLER              PIC X(12)       VALUE            03300023
                   'DIR         '.                                      03310023
               10  FILLER              PIC X(58)       VALUE SPACES.    03320023
           05  WS-FTP-LINE3.                                            03330023
               10  FILLER              PIC X(2)        VALUE SPACES.    03340023
               10  FILLER              PIC X(12)       VALUE            03350023
                   'ASCII       '.                                      03360023
               10  FILLER              PIC X(58)       VALUE SPACES.    03370023
           05  WS-FTP-LINE4.                                            03380023
               10  FILLER              PIC X(2)        VALUE SPACES.    03390023
               10  WS-FTP-SOURCE       PIC X(70)       VALUE SPACES.    03400023
           05  WS-FTP-LINE5.                                            03410023
               10  FILLER              PIC X(2)        VALUE SPACES.    03420023
               10  FILLER              PIC X(12)       VALUE            03430023
                   'DIR         '.                                      03440023
               10  FILLER              PIC X(66)       VALUE SPACES.    03450023
           05  WS-FTP-LINE6.                                            03460023
               10  FILLER              PIC X(2)        VALUE SPACES.    03470023
               10  FILLER              PIC X(12)       VALUE            03480023
                   'QUIT        '.                                      03490023
               10  FILLER              PIC X(66)       VALUE SPACES.    03500023
                                                                        03510023
       01  WS-DATE                       PIC X(8)  VALUE SPACES.        03520023
       01  WS-SYS-DTE-TME.                                              03530023
           05 WS-SYS-DATE          PIC 9(8)        VALUE ZEROES.        03540023
           05 WS-SYS-TIME          PIC 9(8)        VALUE ZEROES.        03550023
       01  WS-MONTH                      PIC X(3)  VALUE SPACES.        03560023
       01  WS-QUARTER                    PIC X(11) VALUE SPACES.        03570023
       01  WS-YEAR                       PIC 9(4).                      03580023
       01  WS-NAME-EMAIL                 PIC X(66).                     03590023
                                                                        03600023
       01  WS-PREV-BLK-NO                PIC X(5).                      03610023
       01  WS-OCCP-PTR                   PIC 9(2).                      03620023
       01  WS-SQL-CODE                   PIC 9(4).                      03630023
                                                                        03640023
       01  WS-STOP                       PIC X(1)  VALUE SPACES.        03650023
       01  WS-PROCESS                    PIC X(1)  VALUE SPACES.        03660023
       01  WS-TEMP-PCD                   PIC X(15) VALUE SPACES.        03670023
       01  WS-TEMP-PCD-A                 PIC X(15) VALUE SPACES.        03680023
       01  WS-HP                         PIC X(08) VALUE SPACES.        03690023
       01  WS-A                          PIC 9(02) VALUE ZEROS.         03700023
       01  WS-B                          PIC 9(02) VALUE ZEROS.         03710023
       01  WS-C                          PIC 9(02) VALUE ZEROS.         03720023
       01  WS-D                          PIC 9(02) VALUE ZEROS.         03730023
       01  WS-BP13C913                   PIC X(08) VALUE 'BP13C913'.    03740023
                                                                        03750023
       01  WS-CL49J-HEADER               PIC X(132) VALUE SPACES.       03760023
       01  WS-DTE-TME.                                                  03770023
           05 WS-DTE                     PIC X(08) VALUE SPACES.        03780023
       01  WS-COUNTERS.                                                 03790023
           05 WS-CNT-F110-READ           PIC 9(7)  VALUE 0.             03800023
           05 WS-CNT-LETTER              PIC 9(7)  VALUE 0.             03810023
           05 WS-CNT-K800-MISS           PIC 9(7)  VALUE 0.             03820023
           05 WS-CNT-K820-MISS           PIC 9(7)  VALUE 0.             03830023
           05 WS-CNT-K830-MISS           PIC 9(7)  VALUE 0.             03840023
           05 WS-CNT-K510-MISS           PIC 9(7)  VALUE 0.             03850023
           05 WS-CNT-K100-MISS           PIC 9(7)  VALUE 0.             03860023
           05 WS-CNT-K857-W-EMAIL        PIC 9(7)  VALUE 0.             03870023
           05 WS-CNTR                    PIC X(1)  VALUE 'N'.           03880023
           05 WS-IDX                     PIC 9(2)  VALUE 0.             03890023
           05 WS-CNT                     PIC 9(2)  VALUE 0.             03900023
           05 CTR                        PIC 9(2)  VALUE 0.             03910023
           05 WS-BLK-CNT                 PIC 9(7)  VALUE 0.             03920023
           05 WS-TOTAL-CNT               PIC 9(7)  VALUE 0.             03930023
           05 WS-TOTAL-CNT-A             PIC 9(7)  VALUE 0.             03940023
           05 WS-LINE-CNT                PIC 9(7)  VALUE 0.             03950023
           05 WS-PAGE-CNT                PIC 9(7)  VALUE 0.             03960023
           05 WS-LINE-CNT-A              PIC 9(7)  VALUE 0.             03970023
           05 WS-PAGE-CNT-A              PIC 9(7)  VALUE 0.             03980023
           05 WS-F491-WRT                PIC 9(7)  VALUE 0.             03990023
           05 WS-F491-REWRITE            PIC 9(7)  VALUE 0.             04000023
           05 WS-L49J-WRT                PIC 9(7)  VALUE 0.             04010023
           05 WS-P491-WRT                PIC 9(7)  VALUE 0.             04020023
           05 WS-F859-WRT                PIC 9(7)  VALUE 0.             04030023
           05 WS-BP13FY-CTR              PIC 9(6)  VALUE ZEROS.         04040023
           05 WS-RECORD-CNT              PIC ZZZ9.                      04050023
                                                                        04060023
           05 WS-ERROR-FL                PIC X(1) VALUE 'N'.            04070023
              88 WS-NO-ERROR             VALUE 'N'.                     04080023
              88 WS-ERROR                VALUE 'Y'.                     04090023
                                                                        04100023
       01  WS-TEMP-INP1.                                                04110023
             05 TEMP-PROJ-NAME    PIC X(40).                            04120023
             05 TEMP-PCD-REV      PIC X(18).                            04130023
             05 TEMP-DELAY-MONS   PIC X(02).                            04140023
                                                                        04150023
       01  WS-TEMP-POSTAL         PIC X(20)  VALUE SPACES.              04160023
                                                                        04170023
       01  WS-TEMP-MONTH                 PIC X(45) VALUE SPACES.        04180023
       01  WS-TEMP-SPACE                 PIC X(28) VALUE                04190023
                                         'Probable Completion Date for'.04200023
       01  WS-TEMP-SPACE1                PIC X(10) VALUE SPACES.        04210023
       01  WS-TEMP-SPACE3                PIC X(13) VALUE SPACES.        04220023
       01  WS-TEMP-ADDRESS1              PIC X(85) VALUE SPACES.        04230023
       01  WS-TEMP-ADDRESS2              PIC X(85) VALUE SPACES.        04240023
       01  WS-TEMP-ADDRESS3              PIC X(85) VALUE SPACES.        04250023
       01  WS-MONTHS-IN-DIGITS-AND-WORDS.                               04260023
           05 FILLER                   PIC X(06) VALUE                  04270023
             '01 JAN'.                                                  04280023
           05 FILLER                   PIC X(06) VALUE                  04290023
             '02 FEB'.                                                  04300023
           05 FILLER                   PIC X(06) VALUE                  04310023
             '03 MAR'.                                                  04320023
           05 FILLER                   PIC X(06) VALUE                  04330023
             '04 APR'.                                                  04340023
           05 FILLER                   PIC X(06) VALUE                  04350023
             '05 MAY'.                                                  04360023
           05 FILLER                   PIC X(06) VALUE                  04370023
             '06 JUN'.                                                  04380023
           05 FILLER                   PIC X(06) VALUE                  04390023
             '07 JUL'.                                                  04400023
           05 FILLER                   PIC X(06) VALUE                  04410023
             '08 AUG'.                                                  04420023
           05 FILLER                   PIC X(06) VALUE                  04430023
             '09 SEP'.                                                  04440023
           05 FILLER                   PIC X(06) VALUE                  04450023
             '10 OCT'.                                                  04460023
           05 FILLER                   PIC X(06) VALUE                  04470023
             '11 NOV'.                                                  04480023
           05 FILLER                   PIC X(06) VALUE                  04490023
             '12 DEC'.                                                  04500023
       01  FILLER  REDEFINES  WS-MONTHS-IN-DIGITS-AND-WORDS.            04510023
           05 WS-MONTH-TABLE               OCCURS 12                    04520023
                                           INDEXED BY WS-MTH-IND.       04530023
              10 WS-MONTH-IN-DIGITS    PIC X(02).                       04540023
              10 FILLER                PIC X(01).                       04550023
              10 WS-MONTH-IN-WORDS     PIC X(03).                       04560023
                                                                        04570023
                                                                        04580023
       01 WS-REPORT-FIELDS.                                             04590023
           05  WS-DATE-RPT-DTL.                                         04600023
               10 FILLER                PIC X(6)  VALUE 'DATE: '.       04610023
               10 WS-DATE-RPT           PIC X(10) VALUE SPACES.         04620023
           05  WS-MAIL-RPT1             PIC X(12) VALUE 'HELO SGPHDB1'. 04630023
           05  WS-MAIL-RPT2             PIC X(27)                       04640023
               VALUE 'MAIL FROM:<OPCP@SGPHDB1>'.                        04650023
           05  WS-MAIL-RPT18.                                           04660023
               10 WS-ADDR-RPT           PIC X(98).                      04670023
                                                                        04680023
      *=======================================================*         04690023
      *    LINKAGE VARIABLES                                  *         04700023
      *=======================================================*         04710023
       01   WS-LINK-REC.                                                04720023
            05 WS-LINK-NUM-SCH            PIC X(4).                     04730023
            05 WS-LINK-NUM-ACC            PIC X(4).                     04740023
            05 WS-LINK-NUM-CHK            PIC X(1).                     04750023
                                                                        04760023
       COPY P13COMM8.                                                   04770023
                                                                        04780023
      *-------------------------------------------------------------    04790023
      *    LETTER LAYOUT                                                04800023
      *-------------------------------------------------------------    04810023
       01  P491-LINE01.                                                 04820023
           05 FILLER                     PIC X(63) VALUE SPACES.        04830023
           05 P491-REGN-NO               PIC X(8)  VALUE SPACES.        04840023
                                                                        04850023
       01  P491-LINE02.                                                 04860023
           05 FILLER                     PIC X(63) VALUE SPACES.        04870023
           05 P491-DATE                  PIC X(10) VALUE SPACES.        04880023
                                                                        04890023
       01  P491-LINE03.                                                 04900023
           05 FILLER                     PIC X(74) VALUE SPACES.        04910023
           05 P491-OIC-TEL               PIC X(8)  VALUE SPACES.        04920023
                                                                        04930023
       01  P491-LINE04.                                                 04940023
           05 FILLER                     PIC X(01)  VALUE SPACES.       04950023
           05 P491-NAME1                 PIC X(66)  VALUE SPACES.       04960023
                                                                        04970023
       01  P491-LINE04B.                                                04980023
           05 FILLER                     PIC X(01)  VALUE SPACES.       04990023
           05 P491-NAME2                 PIC X(66)  VALUE SPACES.       05000023
                                                                        05010023
       01  P491-LINE04C.                                                05020023
           05 FILLER                     PIC X(01)  VALUE SPACES.       05030023
           05 P491-NAME3                 PIC X(66)  VALUE SPACES.       05040023
                                                                        05050023
       01  P491-LINE04D.                                                05060023
           05 FILLER                     PIC X(01)  VALUE SPACES.       05070023
           05 P491-NAME4                 PIC X(66)  VALUE SPACES.       05080023
                                                                        05090023
       01  P491-LINE05.                                                 05100023
           05 FILLER                     PIC X(01)  VALUE SPACES.       05110023
           05 P491-BLK                   PIC X(10)  VALUE SPACES.       05120023
           05 FILLER                     PIC X(2)   VALUE SPACES.       05130023
           05 P491-FLAT-NO.                                             05140023
              15  P491-CHAR              PIC X      VALUE SPACE.        05150023
              15  P491-LEVEL             PIC X(2)   VALUE SPACES.       05160023
              15  P491-DASH              PIC X      VALUE SPACE.        05170023
              15  P491-HSE-MAIN          PIC X(4)   VALUE SPACES.       05180023
              15  P491-HSE-SUB           PIC X(3)   VALUE SPACES.       05190023
                                                                        05200023
       01  P491-LINE05B.                                                05210023
           05 FILLER                     PIC X(01) VALUE SPACES.        05220023
           05 P491-STREET                PIC X(32) VALUE SPACES.        05230023
                                                                        05240023
       01  P491-LINE05C.                                                05250023
           05 FILLER                     PIC X(01) VALUE SPACES.        05260023
           05 FILLER                     PIC X(9)  VALUE 'SINGAPORE'.   05270023
           05 FILLER                     PIC X(1)  VALUE SPACES.        05280023
           05 P491-POSTAL                PIC X(6)  VALUE SPACES.        05290023
                                                                        05300023
       01  PECD-LINE06.                                                 05310023
           05  FILLER                    PIC X(04) VALUE SPACES.        05320023
           05  PECD-BAR-CODE             PIC X(09) VALUE SPACES.        05330023
                                                                        05340023
       01  PECD-LINE07.                                                 05350023
           05 FILLER                     PIC X(20) VALUE SPACES.        05360023
           05 FILLER                     PIC X(4)  VALUE 'BLK'.         05370023
           05 P491-UNIT-BLK              PIC X(5)  VALUE SPACES.        05380023
           05 FILLER                     PIC X(3)  VALUE SPACES.        05390023
           05 P491-UNIT-FLAT-NO.                                        05400023
              10 FILLER                  PIC X     VALUE '#'.           05410023
              10 P491-UNIT-LVL-NO        PIC X(2)  VALUE SPACES.        05420023
              10 FILLER                  PIC X     VALUE '-'.           05430023
              10 P491-UNIT-UNIT-NO       PIC X(5)  VALUE SPACES.        05440023
           05 FILLER                     PIC X(3)  VALUE SPACES.        05450023
           05 P491-UNIT-STREET-POSTAL    PIC X(50) VALUE SPACES.        05460023
                                                                        05470023
       01  P491-LINE07A.                                                05480023
           05 FILLER                     PIC X(3)  VALUE SPACES.        05490023
           05 P491-POSTAL1               PIC X(6)  VALUE SPACES.        05500023
                                                                        05510023
       01  PECD-LINE07B.                                                05520023
           05 FILLER                     PIC X(01) VALUE SPACES.        05530023
           05 P491-PROJ-NAME             PIC X(40) VALUE SPACES.        05540023
                                                                        05550023
       01  PECD-LINE08A.                                                05560023
           05 FILLER                     PIC X(29) VALUE SPACES.        05570023
           05 P491-DTE-COMPLT-MM         PIC X(03) VALUE SPACES.        05580023
           05 FILLER                     PIC X(01) VALUE SPACES.        05590023
           05 P491-DTE-COMPLT-YR         PIC X(05) VALUE SPACES.        05600023
                                                                        05610023
       01  PECD-LINE9.                                                  05620023
           05 FILLER                     PIC X(22) VALUE SPACES.        05630023
           05 P491-MAIL                  PIC X(67) VALUE                05640023
           '<https://services2.hdb.gov.sg/webapp/SX05AWSPCP/SX05PSPCPLog05650023
      -        'in.jsp>'.                                               05660023
                                                                        05670023
       01  PECD-LINE09A.                                                05680023
           05 FILLER                     PIC X(01) VALUE SPACES.        05690023
           05 P491-PROJ-NAME-9A          PIC X(40) VALUE SPACES.        05700023
           05 FILLER                     PIC X(03) VALUE SPACES.        05710023
           05 P491-PCD-REV               PIC X(18) VALUE SPACES.        05720023
           05 FILLER                     PIC X(03) VALUE SPACES.        05730023
           05 P491-ORIG-PCD              PIC X(18) VALUE SPACES.        05740023
                                                                        05750023
       01  PECD-LINE09C.                                                05760023
           05 FILLER                     PIC X(02) VALUE SPACES.        05770023
           05 P491-DELAY-MONS            PIC X(02) VALUE SPACES.        05780023
                                                                        05790023
       01  PECD-LINE10.                                                 05800023
           05 FILLER                     PIC X(52) VALUE SPACES.        05810023
           05 P491-NEW-PCD               PIC X(18) VALUE SPACES.        05820023
                                                                        05830023
       01  PECD-LINE10A.                                                05840023
           05 FILLER                     PIC X(47) VALUE SPACES.        05850023
           05 FILLER                     PIC X(12) VALUE SPACES.        05860023
           05 P491-NEW-PCDA              PIC X(18) VALUE SPACES.        05870023
                                                                        05880023
       01  PECD-LINE10Q.                                                05890023
           05 FILLER                     PIC X(29) VALUE SPACES.        05900023
           05 P491-NEW-PCDQ              PIC X(16) VALUE SPACES.        05910023
                                                                        05920023
       01  PECD-NOTE-LINE10A.                                           05930023
           05 FILLER                     PIC X(23) VALUE SPACES.        05940023
           05 FILLER                     PIC X(73) VALUE SPACES.        05950023
           05 P491-NOTEA-PCD             PIC X(18) VALUE SPACES.        05960023
                                                                        05970023
       01  PECD-NOTE-LINE10B.                                           05980023
           05 FILLER                     PIC X(49) VALUE SPACES.        05990023
           05 FILLER                     PIC X(10) VALUE SPACES.        06000023
           05 P491-NOTEB-PCD             PIC X(18) VALUE SPACES.        06010023
                                                                        06020023
       01  PECD-NOTE-LINE10C.                                           06030023
           05 FILLER                     PIC X(23) VALUE SPACES.        06040023
           05 FILLER                     PIC X(57) VALUE SPACES.        06050023
           05 P491-NOTEC-PCD             PIC X(18) VALUE SPACES.        06060023
                                                                        06070023
       01  PECD-NOTE-LINE10D.                                           06080023
           05 FILLER                     PIC X(29) VALUE SPACES.        06090023
           05 P491-NOTED-PCD             PIC X(16) VALUE SPACES.        06100023
                                                                        06110023
                                                                        06120023
       01  PECD-FT-OIC.                                                 06130023
           05 FILLER                     PIC X(10) VALUE SPACES.        06140023
           05 P491-NME-OIC               PIC X(30) VALUE SPACES.        06150023
                                                                        06160023
      *-------------------------------------------------------------    06170023
      *    REPORT LAYOUT                                                06180023
      *-------------------------------------------------------------    06190023
       01  L49J-HDR01.                                                  06200023
           05 FILLER                     PIC X(14) VALUE 'BP13L49J'.    06210023
           05 FILLER                     PIC X(30) VALUE 'HDB3'.        06220023
           05 FILLER                     PIC X(42) VALUE                06230023
             'S Y S T E M   O F   C O M M I T M E N T'.                 06240023
           05 FILLER                     PIC X(13) VALUE SPACES.        06250023
           05 FILLER                     PIC X(7)  VALUE 'DATE: '.      06260023
           05 L49J-DATE                  PIC X(10) VALUE SPACES.        06270023
           05 FILLER                     PIC X(10) VALUE '   PAGE: '.   06280023
           05 L49J-PAGE                  PIC ZZZZ9.                     06290023
                                                                        06300023
       01  L49J-HDR02.                                                  06310023
           05 FILLER                     PIC X(40) VALUE SPACES.        06320023
           05 FILLER                     PIC X(80) VALUE                06330023
             'LETTERS PRINTED FOR NOTIFICATION OF NEW PCD DATE'.        06340023
                                                                        06350023
       01  L49J-HDR03.                                                  06360023
           05 FILLER                     PIC X(10) VALUE '  BLOCK: '.   06370023
           05 L49J-BLOCK                 PIC X(5)  VALUE SPACES.        06380023
           05 FILLER                     PIC X(4)  VALUE SPACES.        06390023
           05 L49J-STREET-NAME           PIC X(32) VALUE SPACES.        06400023
                                                                        06410023
       01  L49J-HDR04.                                                  06420023
           05 FILLER                     PIC X(9)  VALUE '   NO.   '.   06430023
           05 FILLER                     PIC X(14) VALUE 'SCH-ACC NO'.  06440023
           05 FILLER                     PIC X(10) VALUE '  REGN NO.'.  06450023
           05 FILLER                     PIC X(34)                      06460023
                    VALUE '  NAME(TRUNCATED) '.                         06470023
           05 FILLER                     PIC X(10) VALUE '  NRIC NO.'.  06480023
           05 FILLER                     PIC X(7)  VALUE '  BLK '.      06490023
           05 FILLER                     PIC X(26)                      06500023
                    VALUE '      MAIL STREET NAME'.                     06510023
           05 FILLER                     PIC X(10) VALUE '  FLAT NO.'.  06520023
           05 FILLER                     PIC X(8)  VALUE '  PC'.        06530023
                                                                        06540023
       01  L49J-DETAIL.                                                 06550023
           05 FILLER                     PIC X(2)  VALUE SPACES.        06560023
           05 L49J-NO                    PIC ZZZZ9.                     06570023
           05 FILLER                     PIC X(2)  VALUE SPACES.        06580023
           05 L49J-SCH-ACC               PIC X(14) VALUE SPACES.        06590023
           05 FILLER                     PIC X(2)  VALUE SPACES.        06600023
           05 L49J-REGN-NO               PIC X(8)  VALUE SPACES.        06610023
           05 FILLER                     PIC X(2)  VALUE SPACES.        06620023
           05 L49J-NAME                  PIC X(32) VALUE SPACES.        06630023
           05 FILLER                     PIC X(2)  VALUE SPACES.        06640023
           05 L49J-NRIC-NO               PIC X(9)  VALUE SPACES.        06650023
           05 FILLER                     PIC X     VALUE SPACES.        06660023
           05 L49J-BLK-NO                PIC X(10) VALUE SPACES.        06670023
           05 FILLER                     PIC X     VALUE SPACES.        06680023
           05 L49J-STREET                PIC X(20) VALUE SPACES.        06690023
           05 FILLER                     PIC X(2)  VALUE SPACES.        06700023
           05 L49J-FLAT-NO.                                             06710023
              10 FILLER                  PIC X     VALUE '#'.           06720023
              10 L49J-LVL-NO             PIC X(2)  VALUE SPACES.        06730023
              10 FILLER                  PIC X     VALUE '-'.           06740023
              10 L49J-UNIT-NO            PIC X(4)  VALUE SPACES.        06750023
           05 FILLER                     PIC X(2)  VALUE SPACES.        06760023
           05 L49J-POSTAL-CODE           PIC X(6)  VALUE SPACES.        06770023
                                                                        06780023
       01  L49J-PRT-TOTAL.                                              06790023
           05 FILLER                     PIC X(10) VALUE SPACES.        06800023
           05 FILLER                     PIC X(30)                      06810023
              VALUE 'TOTAL NUMBER OF LETTERS: '.                        06820023
           05 L49J-TOTAL                 PIC Z,ZZZ,ZZ9.                 06830023
                                                                        06840023
      *------------------------------------------------------------*    06850023
      *  DJDE LINE                                                 *    06860023
      *------------------------------------------------------------*    06870023
                                                                        06880023
       01  DJDE-LINE-FY-PAGE1             PIC X(80)  VALUE              06890023
           '$DJDE$ JDE=13POT9,JDL=BP13,FORMS=BP137Z,NUMBER=(0000,29,65,306900023
      -    '),DUPLEX=NO,END;'.                                          06910023
       01  DJDE-LINE-FX-PAGE2             PIC X(80)  VALUE              06920023
           '$DJDE$ FORMS=BP137Z,END;'.                                  06930023
                                                                        06940023
      *-------------------------------------------------------------    06950023
      *    REPORT LAYOUT FOR LETTERS TO BE EMAILED                      06960023
      *-------------------------------------------------------------    06970023
      *-------------------------------------------------------------    06980023
      *-------------------------------------------------------------    06990023
      *  LINKAGE FOR BP13CB4A                                           07000023
      *-------------------------------------------------------------    07010023
                                                                        07020023
       PROCEDURE DIVISION.                                              07030023
      *-------------------------------------------------------------    07040023
       0000-CONTROL.                                                    07050023
      *-------------------------------------------------------------    07060023
           ACCEPT WS-PARM-JOBNAME.                                      07070023
           ACCEPT WS-PARM-B10-SOURCE.                                   07080023
           ACCEPT WS-PARM-H10-SOURCE.                                   07090023
      *    MOVE 'BP13W009'  TO WS-PARM-JOBNAME                          07100023
      *    MOVE 'FIOMSB10'  TO WS-PARM-B10-SOURCE                       07110023
      *    MOVE 'FIOMSH10'  TO WS-PARM-H10-SOURCE                       07120023
                                                                        07130023
           PERFORM 1000-START-UP         THRU 1000-EXIT.                07140023
           PERFORM 2000-MAIN-ROUTINE     THRU 2000-EXIT                 07150023
                   UNTIL WS-F110-EOF = 'Y'.                             07160023
           PERFORM 8900-CREATE-FIOMS-REC THRU 8900-EXIT.                07170023
           PERFORM 9999-WRAP-UP.                                        07180023
                                                                        07190023
       0000-EXIT.                                                       07200023
            EXIT.                                                       07210023
                                                                        07220023
      *-------------------------------------------------------------    07230023
       1000-START-UP.                                                   07240023
      *-------------------------------------------------------------    07250023
            OPEN INPUT  BP13K022                                        07260023
                        BP13K024                                        07270023
                        BP13K800                                        07280023
                        BP13K820                                        07290023
                        BP13K830                                        07300023
                        BM06K510                                        07310023
                        BM06K100                                        07320023
                        BM06F110                                        07330023
                        BM06K110                                        07340023
                        BP13K857                                        07350023
      *                 BP13INP1                                        07360023
                OUTPUT  BP13L49J                                        07370023
                        BP13P491                                        07380023
                        P13BC49V                                        07390023
                        P13HC49V                                        07400023
                        BP13FTP                                         07410023
                   I-O  BP13K491                                        07420023
                        BP13F491.                                       07430023
                                                                        07440023
            IF K491-STATUS NOT = 00 AND 97                              07450023
               DISPLAY 'OPEN FAILED FOR BP13K491,STATUS ' K491-STATUS   07460023
               MOVE K491-STATUS TO RETURN-CODE                          07470023
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                 07480023
            END-IF.                                                     07490023
                                                                        07500023
            IF K022-STATUS NOT = 00 AND 97                              07510023
               DISPLAY 'OPEN FAILED FOR BP13K022,STATUS ' K022-STATUS   07520023
               MOVE K022-STATUS TO RETURN-CODE                          07530023
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                 07540023
            END-IF.                                                     07550023
                                                                        07560023
            IF K024-STATUS NOT = 00 AND 97                              07570023
               DISPLAY 'OPEN FAILED FOR BP13K024,STATUS ' K024-STATUS   07580023
               MOVE K024-STATUS TO RETURN-CODE                          07590023
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                 07600023
            END-IF.                                                     07610023
                                                                        07620023
            IF K800-STATUS NOT = 00 AND 97                              07630023
               DISPLAY 'OPEN FAILED FOR BP13K800,STATUS ' K800-STATUS   07640023
               MOVE K800-STATUS TO RETURN-CODE                          07650023
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                 07660023
            END-IF.                                                     07670023
                                                                        07680023
            IF K820-STATUS NOT = 00 AND 97                              07690023
               DISPLAY 'OPEN FAILED FOR BP13K820,STATUS ' K820-STATUS   07700023
               MOVE K820-STATUS TO RETURN-CODE                          07710023
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                 07720023
            END-IF.                                                     07730023
                                                                        07740023
            IF K830-STATUS NOT = 00 AND 97                              07750023
               DISPLAY 'OPEN FAILED FOR BP13K830,STATUS ' K830-STATUS   07760023
               MOVE K830-STATUS TO RETURN-CODE                          07770023
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                 07780023
            END-IF.                                                     07790023
                                                                        07800023
            IF K510-STATUS NOT = 00 AND 97                              07810023
               DISPLAY 'OPEN FAILED FOR BM06K510,STATUS ' K510-STATUS   07820023
               MOVE K510-STATUS TO RETURN-CODE                          07830023
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                 07840023
            END-IF.                                                     07850023
                                                                        07860023
            IF K100-STATUS NOT = 00 AND 97                              07870023
               DISPLAY 'OPEN FAILED FOR BM06K100,STATUS ' K100-STATUS   07880023
               MOVE K100-STATUS TO RETURN-CODE                          07890023
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                 07900023
            END-IF.                                                     07910023
                                                                        07920023
            IF K857-STATUS NOT = 00 AND 97                              07930023
               DISPLAY 'OPEN FAILED FOR BP13K857,STATUS ' K857-STATUS   07940023
               MOVE K857-STATUS TO RETURN-CODE                          07950023
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                 07960023
            END-IF.                                                     07970023
                                                                        07980023
            IF K110-STATUS NOT = 00 AND 97                              07990023
               DISPLAY 'BM06K110 - ERROR OPENING : ' K110-STATUS        08000023
               MOVE K110-STATUS                      TO RETURN-CODE     08010023
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                 08020023
            END-IF.                                                     08030023
                                                                        08040023
            READ BM06F110                                               08050023
                 AT END                                                 08060023
                         MOVE 'Y'          TO WS-F110-EOF               08070023
                         GO TO 1000-EXIT                                08080023
                 NOT AT END                                             08090023
                  IF F110-REGN-NO(1:2) = '##'                           08100023
                     READ BM06F110                                      08110023
                          AT END                                        08120023
                                  MOVE 'Y'          TO WS-F110-EOF      08130023
                                  GO TO 1000-EXIT                       08140023
                  END-IF                                                08150023
            END-READ.                                                   08160023
                                                                        08170023
            MOVE 60                  TO WS-LINE-CNT.                    08180023
            MOVE 60                  TO WS-LINE-CNT-A.                  08190023
            ADD  1                   TO WS-CNT-F110-READ.               08200023
            MOVE F110-BLK-NO         TO WS-PREV-BLK-NO.                 08210023
                                                                        08220023
            MOVE FUNCTION CURRENT-DATE TO WS-DATE.                      08230023
                                                                        08240023
            MOVE FUNCTION CURRENT-DATE  TO WS-SYS-DTE-TME               08250023
                                          WS-UPD-TMESTAMP.              08260023
                                                                        08270023
            STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)       08280023
                   DELIMITED BY SIZE INTO P491-DATE.                    08290023
      *     MOVE '07/11/2023'          TO P491-DATE                     08300023
                                                                        08310023
            STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)       08320023
                   DELIMITED BY SIZE INTO L49J-DATE.                    08330023
                                                                        08340023
       1000-EXIT.                                                       08350023
            EXIT.                                                       08360023
                                                                        08370023
      *-------------------------------------------------------------    08380023
       2000-MAIN-ROUTINE.                                               08390023
      *-------------------------------------------------------------    08400023
                                                                        08410023
           IF F110-REGN-NO(1:2) = '##'                                  08420023
              READ BM06F110 AT END                                      08430023
                   MOVE 'Y' TO WS-F110-EOF                              08440023
                   GO TO 2000-EXIT                                      08450023
                   NOT AT END                                           08460023
                   IF F110-REGN-NO(1:2) = '##'                          08470023
                      GO TO 2000-EXIT                                   08480023
                   END-IF                                               08490023
           END-IF                                                       08500023
                                                                        08510023
           SET WS-NO-ERROR           TO TRUE.                           08520023
           INITIALIZE  WS-OCCUPANTS.                                    08530023
           INITIALIZE  WS-NAME-EMAIL.                                   08540023
           MOVE SPACES                   TO  BP13K491-REC BP13F491-REC  08550023
                                             WS-F491-EOF WS-F491-FND.   08560023
           INITIALIZE                        BP13K491-REC BP13F491-REC. 08570023
                                                                        08580023
      *-------------------------------------------------------------*   08590023
      * READS BM06F110 AND PROCESS EACH RECORD UNTIL END OF FILE    *   08600023
      *-------------------------------------------------------------*   08610023
                                                                        08620023
           MOVE 'N'     TO WS-PROCESS WS-FOUND-K857.                    08630023
           MOVE SPACES  TO WS-HP.                                       08640023
                                                                        08650023
           MOVE SPACES                     TO BP13K491-REC.             08660023
           PERFORM 3003-READ-K491   THRU 3003-EXIT.                     08670023
      *    IF WS-F491-FND = 'Y' OR WS-PROCESS = 'N'                     08680023
              CLOSE BP13F491                                            08690023
              OPEN I-O BP13F491                                         08700023
      *    END-IF                                                       08710023
           PERFORM 3004-READ-F491   THRU 3004-EXIT                      08720023
             UNTIL WS-F491-EOF = 'Y' OR WS-F491-FND = 'Y'               08730023
           IF WS-F491-EOF = 'Y' AND WS-F491-FND = 'N'                   08740023
              CLOSE BP13F491                                            08750023
              OPEN EXTEND BP13F491                                      08760023
           END-IF                                                       08770023
                                                                        08780023
      ***NEW FLAT FILE                                                  08790023
      *    MOVE SPACES    TO WS-INP1-EOF                                08800023
      *                      WS-INP1-FND.                               08810023
      *       CLOSE BP13INP1                                            08820023
      *       OPEN INPUT BP13INP1                                       08830023
      *    PERFORM 3007-READ-INP1   THRU 3007-EXIT                      08840023
      *      UNTIL WS-INP1-EOF = 'Y' OR WS-INP1-FND = 'Y'               08850023
      *    IF WS-INP1-FND = 'Y'                                         08860023
      *       MOVE INP1-PROJ-NAME  TO TEMP-PROJ-NAME                    08870023
      *       MOVE INP1-PCD-REV    TO TEMP-PCD-REV                      08880023
      *       MOVE INP1-DELAY-MONS TO TEMP-DELAY-MONS                   08890023
      *    ELSE                                                         08900023
      *       MOVE SPACES          TO TEMP-PROJ-NAME                    08910023
      *                               TEMP-PCD-REV                      08920023
      *                               TEMP-DELAY-MONS                   08930023
      *                                                                 08940023
      *    END-IF.                                                      08950023
      *    IF WS-INP1-EOF = 'Y' AND WS-INP1-FND = 'N'                   08960023
      *       CLOSE BP13INP1                                            08970023
      *       OPEN  EXTEND BP13INP1                                     08980023
      *    END-IF.                                                      08990023
                                                                        09000023
           PERFORM 2100-RETRIEVE-DATA   THRU 2100-EXIT.                 09010023
           PERFORM 3000-FORMAT-LETTER   THRU 3000-EXIT                  09020023
           PERFORM 4000-READ-K857       THRU 4000-EXIT                  09030023
             IF WS-FOUND-K857 = 'Y'                                     09040023
                IF K857-NUM-EMAIL NOT = SPACES AND LOW-VALUES           09050023
                 ADD 1 TO WS-CNT-K857-W-EMAIL                           09060023
                 IF WS-FOUND-K491 = 'N'                                 09070023
                    PERFORM 3001-FORMAT-EMAIL    THRU 3001-EXIT         09080023
                 ELSE                                                   09090023
                    PERFORM 3002-FORMAT-EMAIL    THRU 3002-EXIT         09100023
                 END-IF                                                 09110023
                 IF WS-F491-FND = 'N'                                   09120023
                    PERFORM 3005-FORMAT-EMAIL    THRU 3005-EXIT         09130023
                 ELSE                                                   09140023
                    PERFORM 3006-FORMAT-EMAIL    THRU 3006-EXIT         09150023
                 END-IF                                                 09160023
                 MOVE 'Y' TO WS-PROCESS                                 09170023
                END-IF                                                  09180023
             END-IF                                                     09190023
             IF WS-PROCESS NOT = 'Y'                                    09200023
                 IF K100-NUM-PACD = 'M' OR K100-NUM-PACD = 'Q'          09210023
      *             PERFORM 3100-PRINT-LETTER THRU 3100-EXIT            09220023
                    PERFORM 310A-PRINT-IOMS   THRU 310A-EXIT            09230023
                 END-IF                                                 09240023
               PERFORM 3200-PRINT-AUDIT     THRU 3200-EXIT              09250023
             END-IF.                                                    09260023
                                                                        09270023
             IF K800-STATUS = 00                                        09280023
                IF K110-AIX1 = '201N4  C26  469A'                       09290023
                   PERFORM 310A-PRINT-IOMS   THRU 310A-EXIT             09300023
                END-IF                                                  09310023
             END-IF.                                                    09320023
                                                                        09330023
           READ BM06F110 AT END                                         09340023
                MOVE 'Y' TO WS-F110-EOF                                 09350023
                GO TO 2000-EXIT                                         09360023
                 NOT AT END                                             09370023
                  IF F110-REGN-NO(1:2) = '##'                           09380023
                     READ BM06F110 AT END                               09390023
                          MOVE 'Y' TO WS-F110-EOF                       09400023
                          GO TO 2000-EXIT                               09410023
                  END-IF                                                09420023
                END-READ.                                               09430023
                                                                        09440023
           ADD  1                          TO WS-CNT-F110-READ.         09450023
                                                                        09460023
       2000-EXIT.                                                       09470023
            EXIT.                                                       09480023
                                                                        09490023
      *-------------------------------------------------------------    09500023
       2100-RETRIEVE-DATA.                                              09510023
      *-------------------------------------------------------------    09520023
           MOVE F110-REGN-NO               TO K800-NUM-REGN.            09530023
           MOVE SPACES                     TO WS-TEMP-PCD               09540023
                                              WS-TEMP-PCD-A.            09550023
           PERFORM 8100-READ-K800          THRU 8100-EXIT.              09560023
           PERFORM 8150-READ-K110          THRU 8150-EXIT.              09570023
           IF WS-NO-ERROR                                               09580023
              PERFORM 2200-GET-NRIC-NAMES  THRU 2200-EXIT               09590023
              PERFORM 2300-GET-NRIC-ADDR   THRU 2300-EXIT               09600023
              PERFORM 2400-GET-BLK-ADDRESS THRU 2400-EXIT               09610023
              PERFORM 2500-GET-NEWTOWN     THRU 2500-EXIT               09620023
              PERFORM 2600-GET-PCD         THRU 2600-EXIT               09630023
           END-IF                                                       09640023
                                                                        09650023
           .                                                            09660023
       2100-EXIT.                                                       09670023
            EXIT.                                                       09680023
                                                                        09690023
      *-------------------------------------------------------------    09700023
       2200-GET-NRIC-NAMES.                                             09710023
      *-------------------------------------------------------------    09720023
           MOVE  4                         TO   WS-OCCP-PTR.            09730023
           MOVE SPACES                     TO   WS-NAME-EMAIL.          09740023
           IF K800-NUM-NRIC4 NOT = SPACES                               09750023
              MOVE SPACES                  TO   BP13K820-REC            09760023
              MOVE K800-NUM-REGN           TO   K820-NUM-REGN           09770023
              MOVE K800-NUM-NRIC4          TO   K820-NUM-NRIC           09780023
              PERFORM 8200-READ-K820       THRU 8200-EXIT               09790023
              MOVE K820-NME-OCCP           TO   WS-NAME(WS-OCCP-PTR)    09800023
              SUBTRACT   1                 FROM WS-OCCP-PTR             09810023
              MOVE K820-NUM-HP-PGR         TO   WS-HP                   09820023
           END-IF.                                                      09830023
                                                                        09840023
           IF K800-NUM-NRIC3 NOT = SPACES AND WS-NO-ERROR               09850023
              MOVE SPACES                  TO   BP13K820-REC            09860023
              MOVE K800-NUM-REGN           TO   K820-NUM-REGN           09870023
              MOVE K800-NUM-NRIC3          TO   K820-NUM-NRIC           09880023
              PERFORM 8200-READ-K820       THRU 8200-EXIT               09890023
              MOVE K820-NME-OCCP           TO   WS-NAME(WS-OCCP-PTR)    09900023
              SUBTRACT   1                 FROM WS-OCCP-PTR             09910023
              IF K820-NUM-HP-PGR NOT = SPACES AND LOW-VALUES            09920023
                 MOVE K820-NUM-HP-PGR         TO   WS-HP                09930023
              END-IF                                                    09940023
           END-IF.                                                      09950023
                                                                        09960023
           IF K800-NUM-NRIC2 NOT = SPACES AND WS-NO-ERROR               09970023
              MOVE SPACES                  TO   BP13K820-REC            09980023
              MOVE K800-NUM-REGN           TO   K820-NUM-REGN           09990023
              MOVE K800-NUM-NRIC2          TO   K820-NUM-NRIC           10000023
              PERFORM 8200-READ-K820       THRU 8200-EXIT               10010023
              MOVE K820-NME-OCCP           TO   WS-NAME(WS-OCCP-PTR)    10020023
              SUBTRACT   1                 FROM WS-OCCP-PTR             10030023
              IF K820-NUM-HP-PGR NOT = SPACES AND LOW-VALUES            10040023
                 MOVE K820-NUM-HP-PGR         TO   WS-HP                10050023
              END-IF                                                    10060023
           END-IF.                                                      10070023
                                                                        10080023
           IF K800-NUM-NRIC1 NOT = SPACES AND WS-NO-ERROR               10090023
              MOVE SPACES                  TO   BP13K820-REC            10100023
              MOVE K800-NUM-REGN           TO   K820-NUM-REGN           10110023
              MOVE K800-NUM-NRIC1          TO   K820-NUM-NRIC           10120023
              PERFORM 8200-READ-K820       THRU 8200-EXIT               10130023
              MOVE K820-NME-OCCP           TO   WS-NAME(WS-OCCP-PTR)    10140023
                                                WS-NAME-EMAIL           10150023
              MOVE K820-NUM-HP-PGR         TO   WS-HP                   10160023
              IF K820-NUM-HP-PGR NOT = SPACES AND LOW-VALUES            10170023
                 MOVE K820-NUM-HP-PGR         TO   WS-HP                10180023
              END-IF                                                    10190023
           END-IF.                                                      10200023
                                                                        10210023
       2200-EXIT.                                                       10220023
            EXIT.                                                       10230023
                                                                        10240023
      *-------------------------------------------------------------    10250023
       2300-GET-NRIC-ADDR.                                              10260023
      *------------------------------------------------------           10270023
                                                                        10280023
           MOVE F110-REGN-NO               TO  K830-NUM-REGN.           10290023
           PERFORM 8300-READ-K830          THRU 8300-EXIT.              10300023
                                                                        10310023
       2300-EXIT.                                                       10320023
            EXIT.                                                       10330023
                                                                        10340023
      *-------------------------------------------------------------    10350023
       2400-GET-BLK-ADDRESS.                                            10360023
      *------------------------------------------------------           10370023
           MOVE SPACES           TO BP13COMM8-REC.                      10380023
           MOVE K800-NUM-SCH     TO WS-LINK-NUM-SCH.                    10390023
           MOVE K800-NUM-ACC     TO WS-LINK-NUM-ACC.                    10400023
           MOVE K800-NUM-ACC-CK  TO WS-LINK-NUM-CHK.                    10410023
                                                                        10420023
           CALL WS-BP13C913 USING                                       10430023
                 WS-LINK-REC, BP13COMM8-REC                             10440023
           END-CALL.                                                    10450023
                                                                        10460023
           IF COMM8-CDE-SYSERR NOT = 0                                  10470023
              MOVE COMM8-CDE-SYSERR  TO WS-SQL-CODE                     10480023
              IF COMM8-CDE-SYSERR = 100                                 10490023
                 DISPLAY 'SCH-ACC NOT FOUND IN PBF TABLE' WS-SQL-CODE   10500023
              ELSE                                                      10510023
                 DISPLAY 'ERROR READING PBF TABLE' WS-SQL-CODE          10520023
              END-IF                                                    10530023
              MOVE SPACES        TO BP13COMM8-REC                       10540023
              SET WS-ERROR       TO TRUE                                10550023
           END-IF.                                                      10560023
                                                                        10570023
       2400-EXIT.                                                       10580023
            EXIT.                                                       10590023
      *                                                                 10600023
       2500-GET-NEWTOWN.                                                10610023
      *------------------------------------------------------           10620023
                                                                        10630023
            MOVE F110-ESTATE        TO   K510-ESTCDE.                   10640023
            PERFORM 8400-READ-K510  THRU 8400-EXIT.                     10650023
                                                                        10660023
       2500-EXIT.                                                       10670023
            EXIT.                                                       10680023
                                                                        10690023
      *-------------------------------------------------------------    10700023
       2600-GET-PCD.                                                    10710023
      *------------------------------------------------------           10720023
                                                                        10730023
           MOVE F110-AIX1          TO   K100-KEY-FLD.                   10740023
           PERFORM 8500-READ-K100  THRU 8500-EXIT.                      10750023
                                                                        10760023
           IF K100-NUM-PACD = 'M'                                       10770023
              PERFORM 2700-MONTHLY-PACD   THRU 2700-EXIT                10780023
           ELSE                                                         10790023
             IF K100-NUM-PACD = 'Q'                                     10800023
                PERFORM 2800-QUARTERLY-PACD   THRU 2800-EXIT            10810023
             END-IF                                                     10820023
           END-IF.                                                      10830023
                                                                        10840023
       2600-EXIT.                                                       10850023
            EXIT.                                                       10860023
                                                                        10870023
      *-------------------------------------------------------------    10880023
       2700-MONTHLY-PACD.                                               10890023
      *------------------------------------------------------           10900023
           SET WS-MTH-IND TO 1.                                         10910023
                                                                        10920023
           SEARCH WS-MONTH-TABLE                                        10930023
               AT END                                                   10940023
               MOVE '   ' TO WS-MONTH                                   10950023
            WHEN WS-MONTH-IN-DIGITS(WS-MTH-IND) = K100-DTE-PACD-QTR(5:2)10960023
               MOVE WS-MONTH-IN-WORDS(WS-MTH-IND) TO WS-MONTH           10970023
           END-SEARCH.                                                  10980023
                                                                        10990023
           MOVE K100-DTE-PACD-QTR(1:4)       TO WS-YEAR.                11000023
                                                                        11010023
           IF (F110-ESTATE = '201' AND                                  11020023
              F110-NEIGHBOURHOOD  =  'N4  '  AND                        11030023
              F110-CONTRACT-NO    =  'C18 '  AND                        11040023
              F110-BLK-NO      =  ' 467A')                              11050023
               MOVE 'JAN/FEB' TO WS-MONTH                               11060023
           END-IF.                                                      11070023
                                                                        11080023
           IF (F110-ESTATE = '201' AND                                  11090023
              F110-NEIGHBOURHOOD  =  'N4  '  AND                        11100023
              F110-CONTRACT-NO    =  'C18 '  AND                        11110023
              F110-BLK-NO      =  ' 467B')                              11120023
               MOVE 'JAN/FEB' TO WS-MONTH                               11130023
           END-IF.                                                      11140023
                                                                        11150023
           MOVE SPACES                 TO K491-DTE-PCD F491-DTE-PCD     11160023
           STRING WS-MONTH ' ' WS-YEAR                                  11170023
                  DELIMITED BY SIZE                                     11180023
                  INTO K491-DTE-PCD                                     11190023
           END-STRING.                                                  11200023
           STRING WS-MONTH ' ' WS-YEAR                                  11210023
                  DELIMITED BY SIZE                                     11220023
                  INTO F491-DTE-PCD                                     11230023
           END-STRING.                                                  11240023
           MOVE WS-MONTH                     TO P491-DTE-COMPLT-MM      11250023
           STRING WS-YEAR DELIMITED BY SIZE  INTO P491-DTE-COMPLT-YR    11260023
                                                                        11270023
           MOVE K491-DTE-PCD  TO WS-TEMP-PCD                            11280023
                                 P491-ORIG-PCD.                         11290023
                                                                        11300023
       2700-EXIT.                                                       11310023
            EXIT.                                                       11320023
                                                                        11330023
      *-------------------------------------------------------------    11340023
       2800-QUARTERLY-PACD.                                             11350023
      *------------------------------------------------------           11360023
           IF K100-DTE-PACD-QTR(5:2) = '01' OR '02' OR '03'             11370023
              MOVE '1ST QUARTER' TO WS-QUARTER                          11380023
           ELSE                                                         11390023
              IF K100-DTE-PACD-QTR(5:2) = '04' OR '05' OR '06'          11400023
                 MOVE '2ND QUARTER' TO WS-QUARTER                       11410023
              ELSE                                                      11420023
                 IF K100-DTE-PACD-QTR(5:2) = '07' OR '08' OR '09'       11430023
                    MOVE '3RD QUARTER' TO WS-QUARTER                    11440023
                 ELSE                                                   11450023
                    MOVE '4TH QUARTER' TO WS-QUARTER                    11460023
                 END-IF                                                 11470023
              END-IF                                                    11480023
           END-IF.                                                      11490023
                                                                        11500023
           MOVE K100-DTE-PACD-QTR(1:4)       TO WS-YEAR.                11510023
                                                                        11520023
           STRING WS-QUARTER ' ' WS-YEAR                                11530023
                  DELIMITED BY SIZE                                     11540023
                  INTO P491-NEW-PCDQ                                    11550023
           MOVE P491-NEW-PCDQ   TO P491-ORIG-PCD                        11560023
                                                                        11570023
           MOVE SPACES                 TO K491-DTE-PCD F491-DTE-PCD     11580023
           STRING WS-QUARTER ' ' WS-YEAR                                11590023
                  DELIMITED BY SIZE                                     11600023
                  INTO K491-DTE-PCD                                     11610023
           END-STRING.                                                  11620023
           STRING WS-QUARTER ' ' WS-YEAR                                11630023
                  DELIMITED BY SIZE                                     11640023
                  INTO F491-DTE-PCD                                     11650023
           END-STRING.                                                  11660023
           MOVE K491-DTE-PCD  TO WS-TEMP-PCD                            11670023
                                 P491-ORIG-PCD.                         11680023
                                                                        11690023
       2800-EXIT.                                                       11700023
            EXIT.                                                       11710023
                                                                        11720023
      *------------------------------------------------------           11730023
       3000-FORMAT-LETTER.                                              11740023
      *------------------------------------------------------           11750023
           MOVE SPACES                   TO  P491-REGN-NO               11760023
                                             P491-NAME1                 11770023
                                             P491-NAME2                 11780023
                                             P491-NAME3                 11790023
                                             P491-NAME4                 11800023
                                             P491-OIC-TEL               11810023
                                             P491-NME-OIC.              11820023
                                                                        11830023
           MOVE K800-NUM-REGN            TO  P491-REGN-NO.              11840023
           MOVE WS-NAME(1)               TO  P491-NAME1.                11850023
           MOVE WS-NAME(2)               TO  P491-NAME2.                11860023
           MOVE WS-NAME(3)               TO  P491-NAME3.                11870023
           MOVE WS-NAME(4)               TO  P491-NAME4.                11880023
           IF K830-NUM-MAIL-ADDR NOT = SPACES AND LOW-VALUES            11890023
              PERFORM 3050-FORMAT-MAIL-ADDR THRU 3050-EXIT              11900023
           ELSE                                                         11910023
              PERFORM 3055-FORMAT-HOME-ADDR THRU 3055-EXIT              11920023
           END-IF.                                                      11930023
           MOVE COMM8-NUM-BLK            TO  P491-UNIT-BLK.             11940023
           MOVE COMM8-NME-STREET         TO  P491-UNIT-STREET-POSTAL.   11950023
           MOVE COMM8-NUM-LEVEL          TO  P491-UNIT-LVL-NO.          11960023
           MOVE COMM8-NUM-UNIT-MAIN      TO  P491-UNIT-UNIT-NO.         11970023
           MOVE COMM8-NUM-POSTAL-CODE    TO  P491-POSTAL1.              11980023
                                                                        11990023
      *** TESTING                                                       12000023
      *    MOVE '114'                    TO  P491-UNIT-BLK.             12010023
      *    MOVE 'LORONG 1 TOA PAYOH'     TO  P491-UNIT-STREET-POSTAL.   12020023
      *    MOVE '02'                     TO  P491-UNIT-LVL-NO.          12030023
      *    MOVE '434'                    TO  P491-UNIT-UNIT-NO.         12040023
      *    MOVE '310114'                 TO  P491-POSTAL1.              12050023
                                                                        12060023
            STRING WS-TEMP-SPACE1 WS-TEMP-SPACE  ' BLK' P491-UNIT-BLK' '12070023
                   P491-UNIT-FLAT-NO ' '                                12080023
                   P491-UNIT-STREET-POSTAL                              12090023
                   DELIMITED BY SIZE INTO WS-TEMP-ADDRESS1.             12100023
                                                                        12110023
            STRING WS-TEMP-SPACE1 'SINGAPORE ' P491-POSTAL1             12120023
                   DELIMITED BY SIZE INTO WS-TEMP-ADDRESS2.             12130023
      *     STRING WS-TEMP-SPACE1 'SALES REG NO:'P491-REGN-NO           12140023
      *            DELIMITED BY SIZE INTO WS-TEMP-ADDRESS3.             12150023
                                                                        12160023
           MOVE TEMP-PROJ-NAME      TO P491-PROJ-NAME                   12170023
                                       P491-PROJ-NAME-9A                12180023
           MOVE TEMP-PCD-REV        TO P491-PCD-REV                     12190023
           MOVE TEMP-DELAY-MONS     TO P491-DELAY-MONS                  12200023
                                                                        12210023
           PERFORM 5000-RETRIEVE-CSM THRU 5000-EXIT.                    12220023
                                                                        12230023
       3000-EXIT.                                                       12240023
            EXIT.                                                       12250023
                                                                        12260023
      *-------------------------------------------------------------    12270023
       3001-FORMAT-EMAIL.                                               12280023
      *------------------------------------------------------           12290023
                                                                        12300023
           MOVE K800-NUM-REGN            TO  K491-NUM-REGN.             12310023
           IF K800-NUM-DEFER-INCOME-ASSESS = 'Y'                        12320023
           MOVE 'Y'                      TO  K491-CDE-DA                12330023
           END-IF.                                                      12340023
           MOVE K857-NUM-EMAIL           TO  K491-NUM-EMAIL             12350023
           MOVE COMM8-NUM-BLK            TO  K491-NUM-BLK               12360023
           MOVE COMM8-NUM-LEVEL          TO  K491-NUM-LEVEL             12370023
           MOVE COMM8-NUM-UNIT-MAIN      TO  K491-NUM-MAIN-UNIT         12380023
           MOVE COMM8-NME-STREET         TO  K491-NUM-STREET            12390023
           MOVE COMM8-NUM-POSTAL-CODE    TO  K491-NUM-POSTAL            12400023
           PERFORM 5000-RETRIEVE-CSM THRU 5000-EXIT.                    12410023
           MOVE K024-NME-OIC             TO  K491-NME-OIC.              12420023
           MOVE WS-DATE                TO K491-DTE-UPDATE.              12430023
                                                                        12440023
           WRITE BP13K491-REC.                                          12450023
                                                                        12460023
           EVALUATE K491-STATUS                                         12470023
             WHEN 00                                                    12480023
                 ADD 1 TO WS-F491-WRT                                   12490023
             WHEN 02                                                    12500023
             WHEN 22                                                    12510023
                 DISPLAY 'DUP RECORD K491..STAT'    K491-STATUS         12520023
                          '/' K491-NUM-REGN                             12530023
             WHEN OTHER                                                 12540023
                 DISPLAY 'ERROR WRITING THE RECORD K491..STAT'          12550023
                    K491-STATUS                                         12560023
                 DISPLAY 'KEY FIELD K028 ' K491-KEY-FLD                 12570023
                 MOVE K491-STATUS           TO RETURN-CODE              12580023
                 PERFORM 9999-WRAP-UP        THRU 9999-EXIT             12590023
           END-EVALUATE.                                                12600023
                                                                        12610023
       3001-EXIT.                                                       12620023
            EXIT.                                                       12630023
                                                                        12640023
      *-------------------------------------------------------------    12650023
       3002-FORMAT-EMAIL.                                               12660023
      *------------------------------------------------------           12670023
                                                                        12680023
           MOVE K800-NUM-REGN            TO  K491-NUM-REGN.             12690023
           MOVE K857-NUM-EMAIL           TO  K491-NUM-EMAIL             12700023
           MOVE COMM8-NUM-BLK            TO  K491-NUM-BLK               12710023
           MOVE COMM8-NUM-LEVEL          TO  K491-NUM-LEVEL             12720023
           MOVE COMM8-NUM-UNIT-MAIN      TO  K491-NUM-MAIN-UNIT         12730023
           MOVE COMM8-NME-STREET         TO  K491-NUM-STREET            12740023
           MOVE COMM8-NUM-POSTAL-CODE    TO  K491-NUM-POSTAL            12750023
           PERFORM 5000-RETRIEVE-CSM THRU 5000-EXIT.                    12760023
           MOVE K024-NME-OIC             TO  K491-NME-OIC.              12770023
           MOVE WS-DATE                TO K491-DTE-UPDATE.              12780023
      *     to cater for eFPF                                           12780124
           MOVE '20240129'             TO K491-DTE-EFPF-DUE.            12781023
                                                                        12790023
           REWRITE BP13K491-REC.                                        12800023
                                                                        12810023
           EVALUATE K491-STATUS                                         12820023
             WHEN 00                                                    12830023
                 ADD 1 TO WS-F491-REWRITE                               12840023
             WHEN OTHER                                                 12850023
                 DISPLAY 'ERROR REWRITING THE RECORD K491..STAT'        12860023
                    K491-STATUS                                         12870023
                 DISPLAY 'KEY FIELD K491 ' K491-KEY-FLD                 12880023
                 MOVE K491-STATUS           TO RETURN-CODE              12890023
                 PERFORM 9999-WRAP-UP        THRU 9999-EXIT             12900023
           END-EVALUATE.                                                12910023
                                                                        12920023
       3002-EXIT.                                                       12930023
            EXIT.                                                       12940023
                                                                        12950023
      *-------------------------------------------------------------    12960023
       3003-READ-K491.                                                  12970023
      *-------------------------------------------------------------    12980023
           MOVE SPACES         TO BP13K491-REC.                         12990023
           MOVE 'N'            TO WS-FOUND-K491.                        13000023
           MOVE F110-REGN-NO   TO K491-NUM-REGN.                        13010023
           READ BP13K491.                                               13020023
                                                                        13030023
           IF K491-STATUS = 00                                          13040023
              MOVE 'Y'  TO WS-FOUND-K491                                13050023
           ELSE                                                         13060023
           IF K491-STATUS = 23                                          13070023
              MOVE 'N'  TO WS-FOUND-K491                                13080023
           ELSE                                                         13090023
              DISPLAY 'ERROR READING BP13K491, STATUS ' K491-STATUS     13100023
              MOVE K491-STATUS TO RETURN-CODE                           13110023
              PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT.                 13120023
                                                                        13130023
       3003-EXIT.                                                       13140023
            EXIT.                                                       13150023
                                                                        13160023
      *-------------------------------------------------------------    13170023
       3004-READ-F491.                                                  13180023
      *-------------------------------------------------------------    13190023
                                                                        13200023
           READ BP13F491                                                13210023
             AT END                                                     13220023
                 MOVE 'Y'          TO WS-F491-EOF                       13230023
                 MOVE 'N'          TO WS-F491-FND                       13240023
             NOT AT END                                                 13250023
              IF F491-NUM-REGN = F110-REGN-NO                           13260023
                 MOVE 'Y'          TO WS-F491-FND                       13270023
              END-IF                                                    13280023
           END-READ.                                                    13290023
                                                                        13300023
       3004-EXIT.                                                       13310023
            EXIT.                                                       13320023
                                                                        13330023
      *-------------------------------------------------------------    13340023
       3005-FORMAT-EMAIL.                                               13350023
      *------------------------------------------------------           13360023
                                                                        13370023
           MOVE K800-NUM-REGN            TO  F491-NUM-REGN.             13380023
           MOVE K857-NUM-EMAIL           TO  F491-NUM-EMAIL             13390023
           MOVE COMM8-NUM-BLK            TO  F491-NUM-BLK               13400023
           MOVE COMM8-NUM-LEVEL          TO  F491-NUM-LEVEL             13410023
           MOVE COMM8-NUM-UNIT-MAIN      TO  F491-NUM-MAIN-UNIT         13420023
           MOVE COMM8-NME-STREET         TO  F491-NUM-STREET            13430023
           MOVE COMM8-NUM-POSTAL-CODE    TO  F491-NUM-POSTAL            13440023
           PERFORM 5000-RETRIEVE-CSM THRU 5000-EXIT.                    13450023
           MOVE K024-NME-OIC             TO  F491-NME-OIC.              13460023
           MOVE WS-DATE                  TO  F491-DTE-UPDATE.           13470023
                                                                        13480023
           WRITE BP13F491-REC.                                          13490023
                                                                        13500023
       3005-EXIT.                                                       13510023
            EXIT.                                                       13520023
                                                                        13530023
      *-------------------------------------------------------------    13540023
       3006-FORMAT-EMAIL.                                               13550023
      *------------------------------------------------------           13560023
                                                                        13570023
           MOVE K800-NUM-REGN            TO  F491-NUM-REGN.             13580023
           MOVE K857-NUM-EMAIL           TO  F491-NUM-EMAIL             13590023
           MOVE COMM8-NUM-BLK            TO  F491-NUM-BLK               13600023
           MOVE COMM8-NUM-LEVEL          TO  F491-NUM-LEVEL             13610023
           MOVE COMM8-NUM-UNIT-MAIN      TO  F491-NUM-MAIN-UNIT         13620023
           MOVE COMM8-NME-STREET         TO  F491-NUM-STREET            13630023
           MOVE COMM8-NUM-POSTAL-CODE    TO  F491-NUM-POSTAL            13640023
           PERFORM 5000-RETRIEVE-CSM THRU 5000-EXIT.                    13650023
           MOVE K024-NME-OIC             TO  F491-NME-OIC.              13660023
           MOVE WS-DATE                  TO  F491-DTE-UPDATE.           13670023
                                                                        13680023
           REWRITE BP13F491-REC.                                        13690023
                                                                        13700023
       3006-EXIT.                                                       13710023
            EXIT.                                                       13720023
                                                                        13730023
      *-------------------------------------------------------------    13740023
      *3007-READ-INP1.                                                  13750023
      *-------------------------------------------------------------    13760023
      *                                                                 13770023
      *    READ BP13INP1                                                13780023
      *      AT END                                                     13790023
      *          MOVE 'Y'          TO WS-INP1-EOF                       13800023
      *          MOVE 'N'          TO WS-INP1-FND                       13810023
      *      NOT AT END                                                 13820023
      *       IF INP1-EST-NEIG-CON = F110-AIX1                          13830023
      *          MOVE 'Y'          TO WS-INP1-FND                       13840023
      *       END-IF                                                    13850023
      *    END-READ.                                                    13860023
      *                                                                 13870023
      *3007-EXIT.                                                       13880023
      *     EXIT.                                                       13890023
      *                                                                 13900023
      *-------------------------------------------------------------    13910023
       3050-FORMAT-MAIL-ADDR.                                           13920023
      *------------------------------------------------------           13930023
                                                                        13940023
           IF K830-NUM-MAIL-ADDR-TYPE  = 'H'                            13950023
              MOVE K830-NME-MAIL-STR-BLDG TO P491-STREET                13960023
              MOVE K830-NUM-MAIL-LVL-CHAR TO P491-CHAR                  13970023
              MOVE K830-NUM-MAIL-LVL-NUM  TO P491-LEVEL                 13980023
              MOVE K830-NUM-MAIL-LVL-DASH TO P491-DASH                  13990023
              MOVE K830-NUM-MAIL-HSEMAIN  TO P491-HSE-MAIN              14000023
              MOVE K830-NUM-MAIL-HSESUB   TO P491-HSE-SUB               14010023
           ELSE                                                         14020023
              MOVE K830-NUM-MAIL-FLAT     TO P491-FLAT-NO               14030023
              MOVE K830-NME-MAIL-STR-BLDG TO P491-STREET                14040023
           END-IF.                                                      14050023
                                                                        14060023
           MOVE K830-NUM-MAIL-BLK         TO P491-BLK.                  14070023
                                                                        14080023
           IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR ZEROS      14090023
              MOVE SPACES                   TO P491-LINE05C             14100023
           ELSE                                                         14110023
              MOVE 'SINGAPORE'              TO P491-LINE05C(02:9)       14120023
           END-IF.                                                      14130023
           STRING 'SINGAPORE ' K830-NUM-MAIL-POSTAL                     14140023
           DELIMITED BY SIZE            INTO WS-TEMP-POSTAL.            14150023
                                                                        14160023
           MOVE  K830-NUM-MAIL-POSTAL TO PECD-BAR-CODE.                 14170023
                                                                        14180023
           IF K830-NUM-MAIL-POSTAL = SPACES OR ZEROS                    14190023
              DISPLAY '- MAIL POSTAL EMPTY ' K830-NUM-MAIL-POSTAL       14200023
                      ', REGN IS ' K800-NUM-REGN.                       14210023
                                                                        14220023
       3050-EXIT.                                                       14230023
            EXIT.                                                       14240023
                                                                        14250023
                                                                        14260023
      *-------------------------------------------------------------    14270023
       3055-FORMAT-HOME-ADDR.                                           14280023
      *------------------------------------------------------           14290023
                                                                        14300023
           IF K830-NUM-ADDR-TYPE  = 'H'                                 14310023
              MOVE K830-NME-STREET      TO P491-STREET                  14320023
              MOVE K830-NUM-LVL-CHAR    TO P491-CHAR                    14330023
              MOVE K830-NUM-LVL-NUM     TO P491-LEVEL                   14340023
              MOVE K830-NUM-LVL-DASH    TO P491-DASH                    14350023
              MOVE K830-NUM-HSEMAIN     TO P491-HSE-MAIN                14360023
              MOVE K830-NUM-HSESUB      TO P491-HSE-SUB                 14370023
           ELSE                                                         14380023
              MOVE K830-NUM-FLAT        TO P491-FLAT-NO                 14390023
              MOVE K830-NME-STREET-BLDG TO P491-STREET                  14400023
           END-IF.                                                      14410023
                                                                        14420023
           MOVE K830-NUM-BLK            TO P491-BLK.                    14430023
           IF K830-NUM-POSTAL = SPACES OR LOW-VALUES OR ZEROS           14440023
              MOVE SPACES                  TO P491-LINE05C              14450023
           ELSE                                                         14460023
              MOVE 'SINGAPORE'             TO P491-LINE05C(02:9)        14470023
           END-IF.                                                      14480023
           STRING 'SINGAPORE ' K830-NUM-POSTAL                          14490023
           DELIMITED BY SIZE          INTO WS-TEMP-POSTAL.              14500023
                                                                        14510023
           MOVE   K830-NUM-POSTAL  TO PECD-BAR-CODE                     14520023
                                                                        14530023
           IF K830-NUM-POSTAL = SPACES OR ZEROS                         14540023
              DISPLAY '- RES POSTAL EMPTY ' K830-NUM-MAIL-POSTAL        14550023
                      ', REGN IS ' K800-NUM-REGN.                       14560023
                                                                        14570023
                                                                        14580023
       3055-EXIT.                                                       14590023
            EXIT.                                                       14600023
                                                                        14610023
                                                                        14620023
      *-------------------------------------------------------------    14630023
       3100-PRINT-LETTER.                                               14640023
      *-------------------------------------------------------------    14650023
                                                                        14660023
      * LETTER TO BE SENT OUT FOR MONTHLY                               14670023
      *-------------------------------------------------------------    14680023
                                                                        14690023
           MOVE SPACES TO WS-TEMP-MONTH                                 14700023
           IF K100-NUM-PACD = 'M'                                       14710023
            STRING WS-TEMP-SPACE3 P491-DTE-COMPLT-MM ' '                14720023
                   P491-DTE-COMPLT-YR                                   14730023
                   DELIMITED BY SIZE INTO WS-TEMP-MONTH                 14740023
           ELSE                                                         14750023
             IF K100-NUM-PACD = 'Q'                                     14760023
                STRING WS-TEMP-SPACE3 P491-NEW-PCDQ                     14770023
                       DELIMITED BY SIZE INTO WS-TEMP-MONTH             14780023
                IF P491-REGN-NO = '3402543F' OR '1555311A'              14790023
                 MOVE SPACES TO WS-TEMP-MONTH                           14800023
                 STRING WS-TEMP-SPACE3 '4TH QUARTER ' '2020'            14810023
                   DELIMITED BY SIZE INTO WS-TEMP-MONTH                 14820023
                END-IF                                                  14830023
             END-IF                                                     14840023
           END-IF                                                       14850023
           ADD   1                   TO WS-BP13FY-CTR.                  14860023
           MOVE  SPACES              TO P491-PRTREC.                    14870023
           MOVE  WS-BP13FY-CTR       TO WS-RECORD-CNT.                  14880023
           MOVE  WS-RECORD-CNT       TO DJDE-LINE-FY-PAGE1(49:4).       14890023
           MOVE  DJDE-LINE-FY-PAGE1  TO P491-PRTREC.                    14900023
           WRITE P491-PRTREC      AFTER PAGE.                           14910023
                                                                        14920023
           ADD   1                   TO WS-CNT-LETTER                   14930023
                                        WS-P491-WRT                     14940023
           WRITE P491-PRTREC FROM P491-LINE01.                          14950023
           WRITE P491-PRTREC FROM P491-LINE02.                          14960023
                                                                        14970023
           WRITE P491-PRTREC FROM P491-LINE04 AFTER 4.                  14980023
           WRITE P491-PRTREC FROM P491-LINE04B.                         14990023
           WRITE P491-PRTREC FROM P491-LINE04C.                         15000023
           WRITE P491-PRTREC FROM P491-LINE04D.                         15010023
                                                                        15020023
           WRITE P491-PRTREC FROM P491-LINE05.                          15030023
           WRITE P491-PRTREC FROM P491-LINE05B.                         15040023
           IF P491-POSTAL = SPACES                                      15050023
              MOVE SPACES   TO P491-LINE05C                             15060023
           END-IF                                                       15070023
           WRITE P491-PRTREC FROM P491-LINE05C.                         15080023
                                                                        15090023
           WRITE P491-PRTREC FROM PECD-LINE07B AFTER 7.                 15100023
           WRITE P491-PRTREC FROM PECD-LINE09A AFTER 25.                15110023
           WRITE P491-PRTREC FROM PECD-LINE09C AFTER 1.                 15120023
                                                                        15130023
      **   WRITE P491-PRTREC FROM WS-TEMP-ADDRESS1 AFTER 7.             15140023
      **   WRITE P491-PRTREC FROM WS-TEMP-ADDRESS2 AFTER 1.             15150023
      *    WRITE P491-PRTREC FROM WS-TEMP-ADDRESS3 AFTER 1.             15160023
      **   WRITE P491-PRTREC FROM WS-TEMP-MONTH     AFTER 7.            15170023
                                                                        15180023
           MOVE  SPACES              TO P491-PRTREC.                    15190023
           MOVE  DJDE-LINE-FX-PAGE2  TO P491-PRTREC.                    15200023
           WRITE P491-PRTREC      AFTER PAGE.                           15210023
                                                                        15220023
       3100-EXIT.                                                       15230023
           EXIT.                                                        15240023
                                                                        15250023
      ***************************************************************** 15260023
       310A-PRINT-IOMS.                                                 15270023
      ***************************************************************** 15280023
                                                                        15290023
           PERFORM 310B-PROCESS-B10-REC  THRU 310B-EXIT.                15300023
                                                                        15310023
           ADD 1                       TO WS-BC49V-SNO.                 15320023
           MOVE WS-BC49V-SNO           TO WS-P49UA-NUM-SNO.             15330023
                                                                        15340023
      *    IF K110-AIX1 = '206N6  C12  640A'                            15350023
      *        MOVE 'BP13O1'     TO WS-P49UA-DESC                       15360023
      *                             WS-P49UA-NUM-FORMID1                15370023
      *        MOVE 'SENJA HEIGHTS'  TO WS-P49UA-TXT-PROJ-NAME          15380023
      *        MOVE '1Q 2022'        TO WS-P49UA-TXT-ORIG-PCD           15390023
      *    ELSE                                                         15400023
      *    IF K110-AIX1 = '206N6  C12  641A'                            15410023
      *        MOVE 'BP13O1'     TO WS-P49UA-DESC                       15420023
      *                             WS-P49UA-NUM-FORMID1                15430023
      *       MOVE 'SENJA HEIGHTS'  TO WS-P49UA-TXT-PROJ-NAME           15440023
      *       MOVE '4Q 2021'        TO WS-P49UA-TXT-ORIG-PCD            15450023
      *    ELSE                                                         15460023
      *     IF K110-AIX1 = '206N6  C15  638A'                           15470023
      *        MOVE 'BP13O1'     TO WS-P49UA-DESC                       15480023
      *                             WS-P49UA-NUM-FORMID1                15490023
      *        MOVE 'SENJA RIDGES'  TO WS-P49UA-TXT-PROJ-NAME           15500023
      *        MOVE '4Q 2021'        TO WS-P49UA-TXT-ORIG-PCD           15510023
      *     ELSE                                                        15520023
      *      IF K110-AIX1 = '108N8  C1   801A' OR                       15530023
      *                     '108N8  C1   801B' OR                       15540023
      *                     '108N8  C1   801C'                          15550023
      *         MOVE 'BP13NB'     TO WS-P49UA-DESC                      15560023
      *                              WS-P49UA-NUM-FORMID1               15570023
      *         MOVE 'WEST COAST PARKVIEW'  TO WS-P49UA-TXT-PROJ-NAME   15580023
      *         MOVE '2Q 2023'        TO WS-P49UA-TXT-ORIG-PCD          15590023
      *      ELSE                                                       15600023
      *       IF K110-AIX1 = '201N1  C15  114A' OR                      15610023
      *                      '201N1  C15  114B'                         15620023
      *          MOVE 'BP13O1'     TO WS-P49UA-DESC                     15630023
      *                               WS-P49UA-NUM-FORMID1              15640023
      *         MOVE 'SKY VISTA @ BUKIT BATOK' TO WS-P49UA-TXT-PROJ-NAME15650023
      *         MOVE '3Q 2022'        TO WS-P49UA-TXT-ORIG-PCD          15660023
      *       ELSE                                                      15670023
      *        IF K110-AIX1 = '301N1  C25  187A' OR                     15680023
      *                       '301N1  C25  188A' OR                     15690023
      *                       '301N1  C25  188B' OR                     15700023
      *                       '301N1  C25  189A' OR                     15710023
      *                       '301N1  C25  189B'                        15720023
      *           MOVE 'BP13O1'     TO WS-P49UA-DESC                    15730023
      *                                WS-P49UA-NUM-FORMID1             15740023
      *           MOVE 'MARSILING GROVE'  TO WS-P49UA-TXT-PROJ-NAME     15750023
      *           MOVE '4Q 2022'        TO WS-P49UA-TXT-ORIG-PCD        15760023
      *        END-IF                                                   15770023
      *       END-IF                                                    15780023
      *      END-IF                                                     15790023
      *     END-IF                                                      15800023
      *    END-IF                                                       15810023
      *    END-IF                                                       15820023
      *    IF K110-AIX1 = '750S4  C13  431B' OR                         15830023
      *                   '750S4  C13  431C' OR                         15840023
      *                   '750S4  C13  432A' OR                         15850023
      *                   '750S4  C13  432B' OR                         15860023
      *                   '750S4  C13  433A' OR                         15870023
      *                   '750S4  C13  433B'                            15880023
      *       MOVE 'BP13W1'                    TO WS-P49UA-DESC         15890023
      *                                           WS-P49UA-NUM-FORMID1  15900023
      *       MOVE 'PUNGGOL POINT WOODS'       TO WS-P49UA-TXT-PROJ-NAME15910023
      *       MOVE '6'                        TO WS-P49UA-TXT-DELAY-MONS15920023
      *       IF K110-AIX1 = '750S4  C13  431B' OR                      15930023
      *                      '750S4  C13  431C'                         15940023
      *          MOVE 'Q4-2023'                TO WS-P49UA-TXT-REV-PCD  15950023
      *          MOVE 'Q2-2023'                TO WS-P49UA-TXT-ORIG-PCD 15960023
      *       END-IF                                                    15970023
      *       IF K110-AIX1 = '750S4  C13  432A' OR                      15980023
      *                      '750S4  C13  432B' OR                      15990023
      *                      '750S4  C13  433A' OR                      16000023
      *                      '750S4  C13  433B'                         16010023
      *          MOVE 'Q3-2023'                TO WS-P49UA-TXT-REV-PCD  16020023
      *          MOVE 'Q1-2023'                TO WS-P49UA-TXT-ORIG-PCD 16030023
      *       END-IF                                                    16040023
      *    ELSE                                                         16050023
      *    IF K110-AIX1 = '750S4  C14  446A' OR                         16060023
      *                   '750S4  C14  446B' OR                         16070023
      *                   '750S4  C14  447A' OR                         16080023
      *                   '750S4  C14  448A' OR                         16090023
      *                   '750S4  C14  448B'                            16100023
      *       MOVE 'BP13W1'                    TO WS-P49UA-DESC         16110023
      *                                           WS-P49UA-NUM-FORMID1  16120023
      *       MOVE 'PUNGGOL POINT COVE'        TO WS-P49UA-TXT-PROJ-NAME16130023
      *       MOVE '9'                        TO WS-P49UA-TXT-DELAY-MONS16140023
      *       IF K110-AIX1 = '750S4  C14  446A' OR                      16150023
      *                      '750S4  C14  446B' OR                      16160023
      *                      '750S4  C14  448B'                         16170023
      *          MOVE 'Q4-2023'                TO WS-P49UA-TXT-REV-PCD  16180023
      *          MOVE 'Q1-2023'                TO WS-P49UA-TXT-ORIG-PCD 16190023
      *       END-IF                                                    16200023
      *       IF K110-AIX1 = '750S4  C14  447A' OR                      16210023
      *                      '750S4  C14  448A'                         16220023
      *          MOVE 'Q1-2024'                TO WS-P49UA-TXT-REV-PCD  16230023
      *          MOVE 'Q2-2023'                TO WS-P49UA-TXT-ORIG-PCD 16240023
      *       END-IF                                                    16250023
      *    ELSE                                                         16260023
      *     IF K110-AIX1 = '618N6  C4   662A' OR                        16270023
      *                    '618N6  C4   662B' OR                        16280023
      *                    '618N6  C4   662C' OR                        16290023
      *                    '618N6  C4   663A' OR                        16300023
      *                    '618N6  C4   663B' OR                        16310023
      *                    '618N6  C4   663C'                           16320023
      *        MOVE 'BP13W1'                   TO WS-P49UA-DESC         16330023
      *                                           WS-P49UA-NUM-FORMID1  16340023
      *        MOVE 'TAMPINES GREENGLEN'       TO WS-P49UA-TXT-PROJ-NAME16350023
      *        MOVE '9'                       TO WS-P49UA-TXT-DELAY-MONS16360023
      *        IF K110-AIX1 = '618N6  C4   662A' OR                     16370023
      *                       '618N6  C4   662B' OR                     16380023
      *                       '618N6  C4   662C' OR                     16390023
      *                       '618N6  C4   663C'                        16400023
      *           MOVE 'Q4-2023'               TO WS-P49UA-TXT-REV-PCD  16410023
      *           MOVE 'Q1-2023'               TO WS-P49UA-TXT-ORIG-PCD 16420023
      *        END-IF                                                   16430023
      *        IF K110-AIX1 = '618N6  C4   663A' OR                     16440023
      *                       '618N6  C4   663B'                        16450023
      *           MOVE 'Q1-2024'               TO WS-P49UA-TXT-REV-PCD  16460023
      *           MOVE 'Q2-2023'               TO WS-P49UA-TXT-ORIG-PCD 16470023
      *        END-IF                                                   16480023
      *     ELSE                                                        16490023
      *      IF K110-AIX1 = '618N9  C18  951A' OR                       16500023
      *                     '618N9  C18  951B' OR                       16510023
      *                     '618N9  C18  951C' OR                       16520023
      *                     '618N9  C18  952A' OR                       16530023
      *                     '618N9  C18  952B' OR                       16540023
      *                     '618N9  C18  952C' OR                       16550023
      *                     '618N9  C18  953A' OR                       16560023
      *                     '618N9  C18  953B' OR                       16570023
      *                     '618N9  C18  953C' OR                       16580023
      *                     '618N9  C18  954A' OR                       16590023
      *                     '618N9  C18  954B' OR                       16600023
      *                     '618N9  C18  954C' OR                       16610023
      *                     '618N9  C18  954D'                          16620023
      *         MOVE 'BP13W1'                  TO WS-P49UA-DESC         16630023
      *                                           WS-P49UA-NUM-FORMID1  16640023
      *         MOVE 'TAMPINES GREENGEM'       TO WS-P49UA-TXT-PROJ-NAME16650023
      *         MOVE '9'                      TO WS-P49UA-TXT-DELAY-MONS16660023
      *        IF K110-AIX1 = '618N9  C18  951A' OR                     16670023
      *                       '618N9  C18  951B' OR                     16680023
      *                       '618N9  C18  951C' OR                     16690023
      *                       '618N9  C18  954A'                        16700023
      *           MOVE 'Q1-2024'               TO WS-P49UA-TXT-REV-PCD  16710023
      *           MOVE 'Q2-2023'               TO WS-P49UA-TXT-ORIG-PCD 16720023
      *        END-IF                                                   16730023
      *        IF K110-AIX1 = '618N9  C18  952A' OR                     16740023
      *                       '618N9  C18  952B' OR                     16750023
      *                       '618N9  C18  952C' OR                     16760023
      *                       '618N9  C18  953A' OR                     16770023
      *                       '618N9  C18  953B' OR                     16780023
      *                       '618N9  C18  953C' OR                     16790023
      *                       '618N9  C18  954B' OR                     16800023
      *                       '618N9  C18  954C' OR                     16810023
      *                       '618N9  C18  954D'                        16820023
      *           MOVE 'Q4-2023'               TO WS-P49UA-TXT-REV-PCD  16830023
      *           MOVE 'Q1-2023'               TO WS-P49UA-TXT-ORIG-PCD 16840023
      *        END-IF                                                   16850023
      *      END-IF                                                     16860023
      *     END-IF                                                      16870023
      *    END-IF                                                       16880023
      *    END-IF                                                       16890023
      *    IF K110-AIX1 = '749N9  C8   206A' OR                         16900023
      *                   '749N9  C8   206B' OR                         16910023
      *                   '749N9  C8   206C' OR                         16920023
      *                   '749N9  C8   206D' OR                         16930023
      *                   '749N9  C8   207A' OR                         16940023
      *                   '749N9  C8   207B' OR                         16950023
      *                   '749N9  C8   207C' OR                         16960023
      *                   '749N9  C8   207D'                            16970023
      *       MOVE 'BP13R1'                    TO WS-P49UA-DESC         16980023
      *                                           WS-P49UA-NUM-FORMID1  16990023
      *       MOVE 'Woodleigh Glen'            TO WS-P49UA-TXT-PROJ-NAME17000023
      *       MOVE '9'                        TO WS-P49UA-TXT-DELAY-MONS17010023
      *       IF K110-AIX1 = '749N9  C8   206A' OR                      17020023
      *                      '749N9  C8   206B' OR                      17030023
      *                      '749N9  C8   206C'                         17040023
      *          MOVE 'Q2-2022'                TO WS-P49UA-TXT-REV-PCD  17050023
      *          MOVE 'Q1-2022'                TO WS-P49UA-TXT-ORIG-PCD 17060023
      *       END-IF                                                    17070023
      *       IF K110-AIX1 = '749N9  C8   206D' OR                      17080023
      *                      '749N9  C8   207A' OR                      17090023
      *                      '749N9  C8   207B' OR                      17100023
      *                      '749N9  C8   207C' OR                      17110023
      *                      '749N9  C8   207D'                         17120023
      *          MOVE 'Q3-2022'                TO WS-P49UA-TXT-REV-PCD  17130023
      *          MOVE 'Q2-2022'                TO WS-P49UA-TXT-ORIG-PCD 17140023
      *       END-IF                                                    17150023
      *    ELSE                                                         17160023
      *    IF K110-AIX1 = '750S4  C5   401A' OR                         17170023
      *                   '750S4  C5   402A' OR                         17180023
      *                   '750S4  C5   402B'                            17190023
      *       MOVE 'BP13R3'                    TO WS-P49UA-DESC         17200023
      *                                           WS-P49UA-NUM-FORMID1  17210023
      *       MOVE 'Northshore Edge'           TO WS-P49UA-TXT-PROJ-NAME17220023
      *       MOVE '6'                        TO WS-P49UA-TXT-DELAY-MONS17230023
      *       MOVE 'Q2-2022'                   TO WS-P49UA-TXT-REV-PCD  17240023
      *       MOVE 'Q1-2022'                   TO WS-P49UA-TXT-ORIG-PCD 17250023
      *    ELSE                                                         17260023
      *    IF K110-AIX1 = '744N4  C31  461A' OR                         17270023
      *                   '744N4  C31  461B' OR                         17280023
      *                   '744N4  C31  461C' OR                         17290023
      *                   '744N4  C31  462A'                            17300023
      *       MOVE 'BP13R1'                    TO WS-P49UA-DESC         17310023
      *                                           WS-P49UA-NUM-FORMID1  17320023
      *       MOVE 'Fernvale Glades'           TO WS-P49UA-TXT-PROJ-NAME17330023
      *       MOVE '9'                        TO WS-P49UA-TXT-DELAY-MONS17340023
      *       MOVE 'Q2-2022'                   TO WS-P49UA-TXT-REV-PCD  17350023
      *       MOVE 'Q1-2022'                   TO WS-P49UA-TXT-ORIG-PCD 17360023
      *    ELSE                                                         17370023
      *    IF K110-AIX1 = '401N3  C25  383A' OR                         17380023
      *                   '401N3  C25  383B' OR                         17390023
      *                   '401N3  C25  383C' OR                         17400023
      *                   '401N3  C25  384A' OR                         17410023
      *                   '401N3  C25  384B'                            17420023
      *       MOVE 'BP13R3'                    TO WS-P49UA-DESC         17430023
      *                                           WS-P49UA-NUM-FORMID1  17440023
      *       MOVE 'Yishun Glen'               TO WS-P49UA-TXT-PROJ-NAME17450023
      *       MOVE '6'                        TO WS-P49UA-TXT-DELAY-MONS17460023
      *       IF K110-AIX1 = '401N3  C25  383A' OR                      17470023
      *                      '401N3  C25  383B'                         17480023
      *          MOVE 'Q4-2022'                TO WS-P49UA-TXT-REV-PCD  17490023
      *          MOVE 'Q2-2022'                TO WS-P49UA-TXT-ORIG-PCD 17500023
      *       END-IF                                                    17510023
      *       IF K110-AIX1 = '401N3  C25  383C'                         17520023
      *          MOVE 'Q4-2022'                TO WS-P49UA-TXT-REV-PCD  17530023
      *          MOVE 'Q3-2022'                TO WS-P49UA-TXT-ORIG-PCD 17540023
      *       END-IF                                                    17550023
      *       IF K110-AIX1 = '401N3  C25  384A'                         17560023
      *          MOVE 'Q1-2023'                TO WS-P49UA-TXT-REV-PCD  17570023
      *          MOVE 'Q2-2022'                TO WS-P49UA-TXT-ORIG-PCD 17580023
      *       END-IF                                                    17590023
      *       IF K110-AIX1 = '401N3  C25  384B'                         17600023
      *          MOVE 'Q1-2023'                TO WS-P49UA-TXT-REV-PCD  17610023
      *          MOVE 'Q3-2022'                TO WS-P49UA-TXT-ORIG-PCD 17620023
      *       END-IF                                                    17630023
      *    ELSE                                                         17640023
      *    IF K110-AIX1 = '401N3  C25  381A' OR                         17650023
      *                   '401N3  C25  381B' OR                         17660023
      *                   '401N3  C25  381C' OR                         17670023
      *                   '401N3  C25  381D' OR                         17680023
      *                   '401N3  C25  382C' OR                         17690023
      *                   '401N3  C25  382B' OR                         17700023
      *                   '401N3  C25  382A'                            17710023
      *       MOVE 'BP13R3'                    TO WS-P49UA-DESC         17720023
      *                                           WS-P49UA-NUM-FORMID1  17730023
      *       MOVE 'Yishun Glen'               TO WS-P49UA-TXT-PROJ-NAME17740023
      *       MOVE '6'                        TO WS-P49UA-TXT-DELAY-MONS17750023
      *       IF K110-AIX1 = '401N3  C25  381A' OR                      17760023
      *                      '401N3  C25  381B'                         17770023
      *          MOVE 'Q4-2022'                TO WS-P49UA-TXT-REV-PCD  17780023
      *          MOVE 'Q2-2022'                TO WS-P49UA-TXT-ORIG-PCD 17790023
      *       END-IF                                                    17800023
      *       IF K110-AIX1 = '401N3  C25  381C' OR                      17810023
      *                      '401N3  C25  381D' OR                      17820023
      *                      '401N3  C25  382C'                         17830023
      *          MOVE 'Q3-2022'                TO WS-P49UA-TXT-REV-PCD  17840023
      *          MOVE 'Q1-2022'                TO WS-P49UA-TXT-ORIG-PCD 17850023
      *       END-IF                                                    17860023
      *       IF K110-AIX1 = '401N3  C25  382B' OR                      17870023
      *                      '401N3  C25  382A'                         17880023
      *          MOVE 'Q2-2022'                TO WS-P49UA-TXT-REV-PCD  17890023
      *          MOVE 'Q1-2022'                TO WS-P49UA-TXT-ORIG-PCD 17900023
      *       END-IF                                                    17910023
      *    ELSE                                                         17920023
      *    IF K110-AIX1 = '401N4  C20  470A' OR                         17930023
      *                   '401N4  C20  472B' OR                         17940023
      *                   '401N4  C20  471B' OR                         17950023
      *                   '401N4  C20  470B' OR                         17960023
      *                   '401N4  C20  471A' OR                         17970023
      *                   '401N4  C20  472A' OR                         17980023
      *                   '401N4  C20  473A' OR                         17990023
      *                   '401N4  C20  473B'                            18000023
      *       MOVE 'BP13R1'                    TO WS-P49UA-DESC         18010023
      *                                           WS-P49UA-NUM-FORMID1  18020023
      *       MOVE 'Forest Spring @ Yishun'    TO WS-P49UA-TXT-PROJ-NAME18030023
      *       IF K110-AIX1 = '401N4  C20  470A' OR                      18040023
      *                      '401N4  C20  472B'                         18050023
      *          MOVE '6'                     TO WS-P49UA-TXT-DELAY-MONS18060023
      *          MOVE 'Q2-2022'                TO WS-P49UA-TXT-REV-PCD  18070023
      *          MOVE 'Q1-2022'                TO WS-P49UA-TXT-ORIG-PCD 18080023
      *       END-IF                                                    18090023
      *       IF K110-AIX1 = '401N4  C20  471B' OR                      18100023
      *                      '401N4  C20  470B'                         18110023
      *          MOVE '9'                     TO WS-P49UA-TXT-DELAY-MONS18120023
      *          MOVE 'Q2-2022'                TO WS-P49UA-TXT-REV-PCD  18130023
      *          MOVE 'Q1-2022'                TO WS-P49UA-TXT-ORIG-PCD 18140023
      *       END-IF                                                    18150023
      *       IF K110-AIX1 = '401N4  C20  471A' OR                      18160023
      *                      '401N4  C20  472A' OR                      18170023
      *                      '401N4  C20  473A' OR                      18180023
      *                      '401N4  C20  473B'                         18190023
      *          MOVE '9'                     TO WS-P49UA-TXT-DELAY-MONS18200023
      *          MOVE 'Q3-2022'                TO WS-P49UA-TXT-REV-PCD  18210023
      *          MOVE 'Q2-2022'                TO WS-P49UA-TXT-ORIG-PCD 18220023
      *       END-IF                                                    18230023
      *    ELSE                                                         18240023
      *    IF K110-AIX1 = '401N4  C21B 475A' OR                         18250023
      *                   '401N4  C21B 475B' OR                         18260023
      *                   '401N4  C21B 477B' OR                         18270023
      *                   '401N4  C21B 477C'                            18280023
      *       MOVE 'BP13R3'                    TO WS-P49UA-DESC         18290023
      *                                           WS-P49UA-NUM-FORMID1  18300023
      *       MOVE 'Melody Spring @ Yishun'    TO WS-P49UA-TXT-PROJ-NAME18310023
      *       MOVE '6'                        TO WS-P49UA-TXT-DELAY-MONS18320023
      *       MOVE 'Q2-2022'                   TO WS-P49UA-TXT-REV-PCD  18330023
      *       MOVE 'Q1-2022'                   TO WS-P49UA-TXT-ORIG-PCD 18340023
      *    END-IF                                                       18350023
      *    END-IF                                                       18360023
      *    END-IF                                                       18370023
      *    END-IF                                                       18380023
      *    END-IF                                                       18390023
      *    END-IF                                                       18400023
      *    END-IF                                                       18410023
      *    IF K110-AIX1 = '206N6  C12  640A' OR                         18420023
      *                   '206N6  C12  641A'                            18430023
      *       MOVE 'BP13V3'                    TO WS-P49UA-DESC         18440023
      *                                           WS-P49UA-NUM-FORMID1  18450023
      *       MOVE 'Senja Heights'             TO WS-P49UA-TXT-PROJ-NAME18460023
      *       IF K110-AIX1 = '206N6  C12  640A'                         18470023
      *          MOVE 'Q2-2022'                TO WS-P49UA-TXT-REV-PCD  18480023
      *       END-IF                                                    18490023
      *       IF K110-AIX1 = '206N6  C12  641A'                         18500023
      *          MOVE 'Q1-2022'                TO WS-P49UA-TXT-REV-PCD  18510023
      *       END-IF                                                    18520023
      *    ELSE                                                         18530023
      *    IF K110-AIX1 = '206N6  C15  638A'                            18540023
      *       MOVE 'BP13V1'                    TO WS-P49UA-DESC         18550023
      *                                           WS-P49UA-NUM-FORMID1  18560023
      *       MOVE 'Senja Ridges'              TO WS-P49UA-TXT-PROJ-NAME18570023
      *    ELSE                                                         18580023
      *    IF K110-AIX1 = '108N8  C1   801A' OR                         18590023
      *                   '108N8  C1   801B' OR                         18600023
      *                   '108N8  C1   801C'                            18610023
      *       MOVE 'BP13O3'                    TO WS-P49UA-DESC         18620023
      *                                           WS-P49UA-NUM-FORMID1  18630023
      *       MOVE 'West Coast Parkview'       TO WS-P49UA-TXT-PROJ-NAME18640023
      *    ELSE                                                         18650023
      *    IF K110-AIX1 = '201N1  C15  114A' OR                         18660023
      *                   '201N1  C15  114B'                            18670023
      *       MOVE 'BP13O1'                    TO WS-P49UA-DESC         18680023
      *                                           WS-P49UA-NUM-FORMID1  18690023
      *       MOVE 'Sky Vista @ Bukit Batok'   TO WS-P49UA-TXT-PROJ-NAME18700023
      *    ELSE                                                         18710023
      *    IF K110-AIX1 = '301N1  C25  187A' OR                         18720023
      *                   '301N1  C25  188A' OR                         18730023
      *                   '301N1  C25  188B' OR                         18740023
      *                   '301N1  C25  189A' OR                         18750023
      *                   '301N1  C25  189B'                            18760023
      *       MOVE 'BP13D1'                    TO WS-P49UA-DESC         18770023
      *                                           WS-P49UA-NUM-FORMID1  18780023
      *       MOVE 'Marsiling Grove'           TO WS-P49UA-TXT-PROJ-NAME18790023
      *       IF K110-AIX1 = '301N1  C25  187A'                         18800023
      *          MOVE '31 MAR 2023'            TO WS-P49UA-TXT-REV-PCD  18810023
      *       END-IF                                                    18820023
      *       IF K110-AIX1 = '301N1  C25  188A'                         18830023
      *          MOVE '31 JAN 2023'            TO WS-P49UA-TXT-REV-PCD  18840023
      *       END-IF                                                    18850023
      *       IF K110-AIX1 = '301N1  C25  188B'                         18860023
      *          MOVE '28 FEB 2023'            TO WS-P49UA-TXT-REV-PCD  18870023
      *       END-IF                                                    18880023
      *       IF K110-AIX1 = '301N1  C25  189A'                         18890023
      *          MOVE '28 FEB 2023'            TO WS-P49UA-TXT-REV-PCD  18900023
      *       END-IF                                                    18910023
      *       IF K110-AIX1 = '301N1  C25  189B'                         18920023
      *          MOVE '31 MAR 2023'            TO WS-P49UA-TXT-REV-PCD  18930023
      *       END-IF                                                    18940023
      *    END-IF                                                       18950023
      *    END-IF                                                       18960023
      *    END-IF                                                       18970023
      *    END-IF                                                       18980023
      *    END-IF                                                       18990023
           IF K800-STATUS = 00                                          19000023
      *       IF K110-AIX1 = '201N4  C26  469A'                         19010023
      *          MOVE 'BP13NB'           TO WS-P49UA-DESC               19020023
      *       IF (K110-AIX1 = '750S4  C14  446A' OR                     19030023
      *                       '750S4  C14  446B')                       19040023
              IF (K110-AIX1 = '129N2  C26  289A' OR                     19050023
                              '129N2  C26  289B' OR                     19060023
                              '129N2  C26  289C')                       19070023
                 MOVE 'BP13V1'           TO WS-P49UA-DESC               19080023
                                            WS-P49UA-NUM-FORMID1        19090023
              ELSE                                                      19100023
              IF (K110-AIX1 = '201N4  C26  469A')                       19110023
                 MOVE 'BP13V1'           TO WS-P49UA-DESC               19120023
                                            WS-P49UA-NUM-FORMID1        19130023
              ELSE                                                      19140023
              IF (K110-AIX1 = '750S4  C13  432A' OR                     19150023
                              '750S4  C13  432B')                       19160023
                 MOVE 'BP13V3'           TO WS-P49UA-DESC               19170023
                                            WS-P49UA-NUM-FORMID1        19180023
              ELSE                                                      19190023
              IF (K110-AIX1 = '750S4  C15  443A')                       19200023
      *          MOVE 'BP13R1'           TO WS-P49UA-DESC               19210023
                 MOVE 'BP13D1'           TO WS-P49UA-DESC               19220023
                                            WS-P49UA-NUM-FORMID1        19230023
              ELSE                                                      19240023
              IF (K110-AIX1 = '750S4  C15  442A' OR                     19250023
                              '750S4  C15  442B')                       19260023
      *          MOVE 'BP13V1'           TO WS-P49UA-DESC               19270023
                 MOVE 'BP13R1'           TO WS-P49UA-DESC               19280023
                                            WS-P49UA-NUM-FORMID1        19290023
              ELSE                                                      19300023
              IF (K110-AIX1 = '750S4  C15  443B' OR                     19310023
                              '750S4  C15  445A' OR                     19320023
                              '750S4  C15  445B')                       19330023
                 MOVE 'BP13V1'           TO WS-P49UA-DESC               19340023
                                            WS-P49UA-NUM-FORMID1        19350023
              ELSE                                                      19360023
              IF ((K800-DTE-REGN >= '20210501') OR                      19370023
                  (K800-NUM-ALLO-CAT = 'NPL'))                          19380023
                   MOVE 'BP13V3'         TO WS-P49UA-DESC               19390023
                                            WS-P49UA-NUM-FORMID1        19400023
              ELSE                                                      19410023
              IF ((K800-DTE-REGN <= '20210430') AND                     19420023
                  (K800-NUM-ALLO-CAT NOT = 'NPL'))                      19430023
                   MOVE 'BP13V1'         TO WS-P49UA-DESC               19440023
                                            WS-P49UA-NUM-FORMID1        19450023
              ELSE                                                      19460023
              IF (K110-AIX1 = '750S4  C14  448B')                       19470023
                  MOVE 'BP13V1'          TO WS-P49UA-DESC               19480023
                                            WS-P49UA-NUM-FORMID1        19490023
              END-IF                                                    19500023
              END-IF                                                    19510023
              END-IF                                                    19520023
              END-IF                                                    19530023
              END-IF                                                    19540023
              END-IF                                                    19550023
              END-IF                                                    19560023
              END-IF                                                    19570023
              END-IF                                                    19580023
           ELSE                                                         19590023
              GO TO 310A-EXIT                                           19600023
           END-IF                                                       19610023
           MOVE  P491-REGN-NO          TO WS-P49UA-NUM-REGN             19620023
           MOVE  P491-DATE             TO WS-P49UA-DTE-PRINT            19630023
           MOVE  P491-NME-OIC          TO WS-P49UA-NME-OIC              19640023
                                                                        19650023
           MOVE  P491-NAME1            TO WS-P49UA-NME-APPLT1           19660023
           MOVE  P491-NAME2            TO WS-P49UA-NME-APPLT2           19670023
           MOVE  P491-NAME3            TO WS-P49UA-NME-APPLT3           19680023
           MOVE  P491-NAME4            TO WS-P49UA-NME-APPLT4           19690023
                                                                        19700023
           MOVE  P491-BLK              TO WS-P49UA-BLK                  19710023
           MOVE  P491-STREET           TO WS-P49UA-STR-BLDG             19720023
           MOVE  P491-FLAT-NO          TO WS-P49UA-HSE-NO               19730023
           MOVE  WS-TEMP-POSTAL        TO WS-P49UA-POSTAL               19740023
           MOVE  PECD-BAR-CODE         TO WS-P49UA-BAR-CODE             19750023
                                                                        19760023
      *    MOVE  P491-PROJ-NAME-9A     TO WS-P49UA-TXT-PROJ-NAME        19770023
      *    MOVE  P491-PCD-REV          TO WS-P49UA-TXT-REV-PCD          19780023
      *    MOVE  P491-ORIG-PCD         TO WS-P49UA-TXT-ORIG-PCD         19790023
      *    MOVE  P491-DELAY-MONS       TO WS-P49UA-TXT-DELAY-MONS       19800023
                                                                        19810023
           MOVE 'Update on Progress of'   TO WS-P49UA-HEADER-DESC.      19820023
           STRING 'BLK ' P491-UNIT-BLK                                  19830023
           DELIMITED BY SIZE         INTO WS-P49UA-PCD-BLK              19840023
           STRING '#' P491-UNIT-LVL-NO '-' P491-UNIT-UNIT-NO            19850023
              DELIMITED BY SIZE      INTO WS-P49UA-PCD-HSE-NO           19860023
           MOVE P491-UNIT-STREET-POSTAL TO WS-P49UA-PCD-STREET          19870023
           STRING 'SINGAPORE ' P491-POSTAL1                             19880023
           DELIMITED BY SIZE           INTO WS-P49UA-PCD-POSTAL         19890023
                                                                        19900023
           WRITE P13BC49V-REC FROM WS-P13P49UA-B10-REC.                 19910023
           ADD 1                       TO WS-HC49V-WRITE                19920023
                                          WS-BP137Z-CNT                 19930023
                                          WS-FB10-WRITE.                19940023
                                                                        19950023
       310A-EXIT.                                                       19960023
           EXIT.                                                        19970023
                                                                        19980023
      ***************************************************************** 19990023
       310B-PROCESS-B10-REC.                                            20000023
      ***************************************************************** 20010023
                                                                        20020023
           MOVE SPACES                 TO WS-P13P49UA-B10-REC.          20030023
           INITIALIZE WS-P13P49UA-B10-REC.                              20040023
                                                                        20050023
           MOVE '_'                    TO WS-P49UA-UNDERSCORE1          20060023
                                          WS-P49UA-UNDERSCORE2          20070023
                                          WS-P49UA-UNDERSCORE3.         20080023
           MOVE 'B10'                  TO WS-P49UA-RECORD-TYPE.         20090023
           MOVE WS-PARM-JOBNAME        TO WS-P49UA-JOBNAME.             20100023
           MOVE WS-UPD-TMESTAMP(1:12)  TO WS-P49UA-TMESTAMP.            20110023
           MOVE P491-REGN-NO           TO WS-P49UA-NUM-REGN             20120023
                                          WS-P49UA-OUR-REF.             20130023
                                                                        20140023
       310B-EXIT.                                                       20150023
           EXIT.                                                        20160023
                                                                        20170023
      *-------------------------------------------------------------    20180023
       3200-PRINT-AUDIT.                                                20190023
      *-------------------------------------------------------------    20200023
           IF WS-LINE-CNT > 55                                          20210023
           OR WS-PREV-BLK-NO NOT = F110-BLK-NO                          20220023
              PERFORM 5200-CREATE-EMAIL  THRU 5200-EXIT                 20230023
              PERFORM 6000-PRINT-HEADING THRU 6000-EXIT                 20240023
           END-IF.                                                      20250023
                                                                        20260023
           MOVE SPACES                       TO L49J-DETAIL             20270023
           INITIALIZE                           L49J-DETAIL.            20280023
           ADD 2                TO WS-LINE-CNT.                         20290023
           ADD 1                TO WS-BLK-CNT.                          20300023
                                                                        20310023
           MOVE SPACES          TO L49J-PRTREC                          20320023
           INITIALIZE              L49J-PRTREC                          20330023
           MOVE WS-BLK-CNT      TO L49J-NO                              20340023
                                   WS-L49J-WRT.                         20350023
           STRING F110-SCHEME '-' F110-ACC '-' F110-CHK '-'             20360023
                  F110-ACC-TYPE                                         20370023
                  DELIMITED BY SIZE INTO L49J-SCH-ACC.                  20380023
                                                                        20390023
           MOVE F110-REGN-NO    TO L49J-REGN-NO.                        20400023
                                                                        20410023
           PERFORM VARYING WS-IDX FROM 1 BY 1                           20420023
             UNTIL WS-NAME(WS-IDX) NOT = SPACES                         20430023
                OR WS-IDX > 4                                           20440023
              CONTINUE                                                  20450023
           END-PERFORM.                                                 20460023
                                                                        20470023
           IF WS-IDX > 4                                                20480023
              MOVE 1            TO WS-IDX                               20490023
           END-IF.                                                      20500023
           MOVE WS-NAME(WS-IDX) TO L49J-NAME.                           20510023
           MOVE K800-NUM-NRIC1  TO L49J-NRIC-NO.                        20520023
           MOVE P491-BLK        TO L49J-BLK-NO.                         20530023
           MOVE P491-STREET     TO L49J-STREET.                         20540023
           MOVE P491-FLAT-NO    TO L49J-FLAT-NO.                        20550023
           MOVE P491-POSTAL     TO L49J-POSTAL-CODE.                    20560023
                                                                        20570023
           WRITE L49J-PRTREC FROM L49J-DETAIL AFTER 2.                  20580023
                                                                        20590023
       3200-EXIT.                                                       20600023
           EXIT.                                                        20610023
                                                                        20620023
      *-------------------------------------------------------------    20630023
       4000-READ-K857.                                                  20640023
      *-------------------------------------------------------------    20650023
           MOVE SPACES         TO BP13K857-REC.                         20660023
           MOVE 'N'            TO WS-FOUND-K857.                        20670023
           MOVE F110-REGN-NO   TO K857-NUM-REGN.                        20680023
           READ BP13K857.                                               20690023
                                                                        20700023
           IF K857-STATUS = 00                                          20710023
              MOVE 'Y'  TO WS-FOUND-K857                                20720023
           ELSE                                                         20730023
           IF K857-STATUS = 23                                          20740023
              MOVE 'N'  TO WS-FOUND-K857                                20750023
              DISPLAY '> NOT FOUND K857 FOR '                           20760023
                      K022-NUM-REGN                                     20770023
           ELSE                                                         20780023
              DISPLAY 'ERROR READING BP13K857, STATUS ' K857-STATUS     20790023
              MOVE K857-STATUS TO RETURN-CODE                           20800023
              PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT.                 20810023
                                                                        20820023
       4000-EXIT.                                                       20830023
            EXIT.                                                       20840023
                                                                        20850023
                                                                        20860023
                                                                        20870023
      *-------------------------------------------------------------    20880023
       5000-RETRIEVE-CSM.                                               20890023
      *-------------------------------------------------------------    20900023
           MOVE K800-NUM-REGN TO K022-NUM-REGN.                         20910023
           READ BP13K022 KEY IS K022-NUM-REGN.                          20920023
                                                                        20930023
           IF K022-STATUS = 00                                          20940023
              MOVE K022-NUM-OIC TO K024-NUM-OIC                         20950023
              PERFORM 5100-READ-BP13K024 THRU 5100-EXIT                 20960023
           ELSE                                                         20970023
           IF K022-STATUS = 23                                          20980023
              DISPLAY '> CSM FOR ' K022-NUM-REGN ' NOT FOUND.'          20990023
           ELSE                                                         21000023
              DISPLAY 'ERROR READING BP13K022, STATUS ' K022-STATUS     21010023
              MOVE K022-STATUS TO RETURN-CODE                           21020023
              PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT.                 21030023
                                                                        21040023
       5000-EXIT.                                                       21050023
            EXIT.                                                       21060023
                                                                        21070023
                                                                        21080023
       5100-READ-BP13K024.                                              21090023
      *-------------------------------------------------------------    21100023
           READ BP13K024 KEY IS K024-KEY-FLD.                           21110023
                                                                        21120023
           IF K024-STATUS = 00                                          21130023
              MOVE K024-NME-OIC TO P491-NME-OIC                         21140023
              MOVE K024-NUM-DID TO P491-OIC-TEL                         21150023
              CONTINUE                                                  21160023
           ELSE                                                         21170023
           IF K024-STATUS = 23                                          21180023
              DISPLAY '> CSM DETAIL OF ' K024-NUM-OIC ' FOR '           21190023
                      K022-NUM-REGN ' NOT FOUND.'                       21200023
           ELSE                                                         21210023
              DISPLAY 'ERROR READING BP13K024, STATUS ' K024-STATUS     21220023
              MOVE K024-STATUS TO RETURN-CODE                           21230023
              PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT.                 21240023
                                                                        21250023
       5100-EXIT.                                                       21260023
            EXIT.                                                       21270023
                                                                        21280023
      *================================================================*21290023
       5200-CREATE-EMAIL.                                               21300023
      *================================================================*21310023
                                                                        21320023
            WRITE L49J-PRTREC  FROM WS-MAIL-RPT1                        21330023
            WRITE L49J-PRTREC  FROM WS-MAIL-RPT2                        21340023
                                                                        21350023
            STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)       21360023
                   DELIMITED BY SIZE INTO WS-DATE-RPT                   21370023
            WRITE L49J-PRTREC  FROM WS-DATE-RPT-DTL                     21380023
            MOVE SPACES TO  L49J-PRTREC                                 21390023
            WRITE   L49J-PRTREC.                                        21400023
                                                                        21410023
       5200-EXIT.                                                       21420023
            EXIT.                                                       21430023
                                                                        21440023
      *-------------------------------------------------------------    21450023
       6000-PRINT-HEADING.                                              21460023
      *-------------------------------------------------------------    21470023
           ADD  1                    TO WS-PAGE-CNT.                    21480023
           MOVE WS-PAGE-CNT          TO L49J-PAGE.                      21490023
           MOVE F110-BLK-NO          TO L49J-BLOCK.                     21500023
           MOVE COMM8-NME-STREET     TO L49J-STREET-NAME.               21510023
                                                                        21520023
           MOVE  8                   TO WS-LINE-CNT.                    21530023
                                                                        21540023
           IF WS-PREV-BLK-NO  NOT = F110-BLK-NO                         21550023
              ADD WS-BLK-CNT         TO WS-TOTAL-CNT                    21560023
              INITIALIZE                WS-BLK-CNT                      21570023
           END-IF.                                                      21580023
           MOVE F110-BLK-NO          TO WS-PREV-BLK-NO.                 21590023
                                                                        21600023
           MOVE SPACES               TO L49J-PRTREC.                    21610023
           INITIALIZE                   L49J-PRTREC                     21620023
           WRITE L49J-PRTREC         FROM L49J-HDR01 AFTER PAGE.        21630023
           WRITE L49J-PRTREC         FROM L49J-HDR02.                   21640023
           WRITE L49J-PRTREC         FROM L49J-HDR03 AFTER 2.           21650023
           WRITE L49J-PRTREC         FROM L49J-HDR04 AFTER 2.           21660023
           MOVE ALL '='              TO L49J-PRTREC.                    21670023
           WRITE L49J-PRTREC            AFTER 1.                        21680023
                                                                        21690023
       6000-EXIT.                                                       21700023
            EXIT.                                                       21710023
                                                                        21720023
      *-------------------------------------------------------------    21730023
       8100-READ-K800.                                                  21740023
      *-------------------------------------------------------------    21750023
           READ BP13K800 KEY IS K800-NUM-REGN.                          21760023
                                                                        21770023
           EVALUATE K800-STATUS                                         21780023
               WHEN 00                                                  21790023
               WHEN 02                                                  21800023
                    CONTINUE                                            21810023
               WHEN 10                                                  21820023
               WHEN 23                                                  21830023
                    ADD  1                  TO WS-CNT-K800-MISS         21840023
                    DISPLAY 'K800 REC NOT FOUND : ' F110-REGN-NO        21850023
                            ' ; ' F110-SCH-ACC-NO                       21860023
                    SET WS-ERROR            TO TRUE                     21870023
                    GO TO 8100-EXIT                                     21880023
               WHEN OTHER                                               21890023
                    MOVE K800-STATUS              TO RETURN-CODE        21900023
                    DISPLAY 'ERROR READING BP13K800, STATUS '           21910023
                             K800-STATUS                                21920023
                    PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT            21930023
           END-EVALUATE.                                                21940023
                                                                        21950023
       8100-EXIT.                                                       21960023
            EXIT.                                                       21970023
                                                                        21980023
      *************************************************************     21990023
       8150-READ-K110.                                                  22000023
      *************************************************************     22010023
                                                                        22020023
           MOVE SPACES                   TO K110-REC.                   22030023
           INITIALIZE                       K110-REC.                   22040023
                                                                        22050023
           MOVE F110-SCH-ACC-NO          TO K110-KEY-FLD.               22060023
                                                                        22070023
           READ BM06K110.                                               22080023
                                                                        22090023
           EVALUATE K110-STATUS                                         22100023
               WHEN 00                                                  22110023
                    MOVE 'Y'             TO WS-K110-FND                 22120023
               WHEN 23                                                  22130023
                    ADD  1                  TO WS-CNT-K800-MISS         22140023
                    DISPLAY 'BM06K110 REC NOT FOUND : ' F110-REGN-NO    22150023
                            ' ; ' F110-SCH-ACC-NO                       22160023
                    SET WS-ERROR            TO TRUE                     22170023
                    GO TO 8150-EXIT                                     22180023
               WHEN OTHER                                               22190023
                    DISPLAY 'BM06K110 READ ERROR ' K110-STATUS          22200023
                    DISPLAY 'K110 KEY: ' F110-SCH-ACC-NO                22210023
                    MOVE K110-STATUS   TO   RETURN-CODE                 22220023
                                                                        22230023
                    PERFORM 9900-HANDLE-ABEND  THRU 9900-EXIT           22240023
           END-EVALUATE.                                                22250023
                                                                        22260023
       8150-EXIT.                                                       22270023
            EXIT.                                                       22280023
                                                                        22290023
      *-------------------------------------------------------------    22300023
       8200-READ-K820.                                                  22310023
      *-------------------------------------------------------------    22320023
           READ BP13K820 KEY IS K820-KEY-FLD.                           22330023
                                                                        22340023
           EVALUATE K820-STATUS                                         22350023
               WHEN 00                                                  22360023
               WHEN 02                                                  22370023
                    CONTINUE                                            22380023
               WHEN 10                                                  22390023
               WHEN 23                                                  22400023
                    MOVE SPACES             TO K820-NME-OCCP            22410023
                    ADD  1                  TO WS-CNT-K820-MISS         22420023
                    DISPLAY 'K820 REC NOT FOUND : ' K800-NUM-REGN       22430023
                    GO TO 8200-EXIT                                     22440023
               WHEN OTHER                                               22450023
                    MOVE K820-STATUS              TO RETURN-CODE        22460023
                    DISPLAY 'ERROR READING BP13K820, STATUS '           22470023
                             K820-STATUS                                22480023
                    PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT            22490023
           END-EVALUATE.                                                22500023
                                                                        22510023
       8200-EXIT.                                                       22520023
            EXIT.                                                       22530023
                                                                        22540023
      *-------------------------------------------------------------    22550023
       8300-READ-K830.                                                  22560023
      *-------------------------------------------------------------    22570023
           READ BP13K830 KEY IS K830-NUM-REGN.                          22580023
                                                                        22590023
           EVALUATE K830-STATUS                                         22600023
               WHEN 00                                                  22610023
               WHEN 02                                                  22620023
                    CONTINUE                                            22630023
               WHEN 10                                                  22640023
               WHEN 23                                                  22650023
                    MOVE SPACES             TO BP13K830-REC             22660023
                    ADD  1                  TO WS-CNT-K830-MISS         22670023
                    DISPLAY 'REGN-NUM' K830-NUM-REGN                    22680023
                    DISPLAY 'K830 REC NOT FOUND : ' K800-NUM-NRIC1      22690023
                                                    K800-NUM-NRIC2      22700023
                    SET WS-ERROR            TO TRUE                     22710023
                    GO TO 8300-EXIT                                     22720023
               WHEN OTHER                                               22730023
                    MOVE K830-STATUS              TO RETURN-CODE        22740023
                    DISPLAY 'ERROR READING BP13K830, STATUS '           22750023
                             K830-STATUS                                22760023
                    PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT            22770023
           END-EVALUATE.                                                22780023
                                                                        22790023
       8300-EXIT.                                                       22800023
            EXIT.                                                       22810023
                                                                        22820023
      *-------------------------------------------------------------    22830023
       8400-READ-K510.                                                  22840023
      *-------------------------------------------------------------    22850023
                                                                        22860023
           READ BM06K510 KEY IS K510-ESTCDE.                            22870023
                                                                        22880023
           EVALUATE K510-STATUS                                         22890023
               WHEN 00                                                  22900023
               WHEN 02                                                  22910023
                    CONTINUE                                            22920023
               WHEN 10                                                  22930023
               WHEN 23                                                  22940023
                    ADD  1                  TO WS-CNT-K510-MISS         22950023
                    DISPLAY 'K510 REC NOT FOUND : ' K510-ESTCDE         22960023
                    GO TO 8400-EXIT                                     22970023
               WHEN OTHER                                               22980023
                    MOVE K510-STATUS              TO RETURN-CODE        22990023
                    DISPLAY 'ERROR READING BM06K510, STATUS '           23000023
                             K510-STATUS                                23010023
                    PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT            23020023
           END-EVALUATE.                                                23030023
                                                                        23040023
       8400-EXIT.                                                       23050023
            EXIT.                                                       23060023
                                                                        23070023
      *-------------------------------------------------------------    23080023
       8500-READ-K100.                                                  23090023
      *-------------------------------------------------------------    23100023
                                                                        23110023
           READ BM06K100 KEY IS K100-KEY-FLD.                           23120023
                                                                        23130023
           EVALUATE K100-STATUS                                         23140023
               WHEN 00                                                  23150023
               WHEN 02                                                  23160023
                    CONTINUE                                            23170023
               WHEN 10                                                  23180023
               WHEN 23                                                  23190023
                    ADD  1                  TO WS-CNT-K100-MISS         23200023
                    DISPLAY 'K100 REC NOT FOUND : ' K100-KEY-FLD        23210023
                    GO TO 8500-EXIT                                     23220023
               WHEN OTHER                                               23230023
                    MOVE K100-STATUS              TO RETURN-CODE        23240023
                    DISPLAY 'ERROR READING BM06K100, STATUS '           23250023
                             K100-STATUS                                23260023
                    PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT            23270023
           END-EVALUATE.                                                23280023
                                                                        23290023
       8500-EXIT.                                                       23300023
            EXIT.                                                       23310023
                                                                        23320023
      ***************************************************************** 23330023
       8900-CREATE-FIOMS-REC.                                           23340023
      ***************************************************************** 23350023
                                                                        23360023
           PERFORM 8910-WRITE-BP13FH10 THRU 8910-EXIT.                  23370023
                                                                        23380023
      * FTP                                                             23390023
           WRITE BP13FTP-REC FROM WS-FTP-LINE1.                         23400023
           WRITE BP13FTP-REC FROM WS-FTP-LINE2.                         23410023
           WRITE BP13FTP-REC FROM WS-FTP-LINE3.                         23420023
           ADD 3                       TO WS-FTP-WRITE.                 23430023
                                                                        23440023
      *    IF K110-AIX1 = '201N4  C26  469A'                            23450023
      *       MOVE 'BP13NB'                  TO WS-FTP-DESC             23460023
      *    IF (K110-AIX1 = '750S4  C14  446A' OR                        23470023
      *                    '750S4  C14  446B')                          23480023
           IF (K110-AIX1 = '129N2  C26  289A' OR                        23490023
                           '129N2  C26  289B' OR                        23500023
                           '129N2  C26  289C')                          23510023
              MOVE 'BP13V1'           TO WS-FTP-DESC                    23520023
                                         WS-P49UA-NUM-FORMID1           23530023
           ELSE                                                         23540023
           IF (K110-AIX1 = '201N4  C26  469A')                          23550023
              MOVE 'BP13V1'           TO WS-FTP-DESC                    23560023
                                         WS-P49UA-NUM-FORMID1           23570023
           ELSE                                                         23580023
           IF (K110-AIX1 = '750S4  C13  432A' OR                        23590023
                           '750S4  C13  432B')                          23600023
              MOVE 'BP13V3'           TO WS-FTP-DESC                    23610023
                                         WS-P49UA-NUM-FORMID1           23620023
           ELSE                                                         23630023
           IF (K110-AIX1 = '750S4  C15  443A')                          23640023
      *       MOVE 'BP13R1'           TO WS-FTP-DESC                    23650023
              MOVE 'BP13D1'           TO WS-FTP-DESC                    23660023
                                         WS-P49UA-NUM-FORMID1           23670023
           ELSE                                                         23680023
           IF (K110-AIX1 = '750S4  C15  442A' OR                        23690023
                           '750S4  C15  442B')                          23700023
      *       MOVE 'BP13V1'           TO WS-FTP-DESC                    23710023
              MOVE 'BP13R1'           TO WS-FTP-DESC                    23720023
                                         WS-P49UA-NUM-FORMID1           23730023
           ELSE                                                         23740023
           IF (K110-AIX1 = '750S4  C15  443B' OR                        23750023
                           '750S4  C15  445A' OR                        23760023
                           '750S4  C15  445B')                          23770023
              MOVE 'BP13V1'           TO WS-FTP-DESC                    23780023
                                         WS-P49UA-NUM-FORMID1           23790023
           ELSE                                                         23800023
           IF ((K800-DTE-REGN >= '20210501') OR                         23810023
               (K800-NUM-ALLO-CAT = 'NPL'))                             23820023
                MOVE 'BP13V3'                TO WS-FTP-DESC             23830023
                                                WS-P49UA-NUM-FORMID1    23840023
           ELSE                                                         23850023
           IF ((K800-DTE-REGN <= '20210430') AND                        23860023
               (K800-NUM-ALLO-CAT NOT = 'NPL') AND                      23870023
               (K110-AIX1 = '201N4  C26  469A'))                        23880023
                MOVE 'BP13V1'                TO WS-FTP-DESC             23890023
                                                WS-P49UA-NUM-FORMID1    23900023
              ELSE                                                      23910023
              IF (K110-AIX1 = '750S4  C14  448B')                       23920023
                  MOVE 'BP13V1'              TO WS-FTP-DESC             23930023
                                               WS-P49UA-NUM-FORMID1     23940023
           END-IF                                                       23950023
           END-IF                                                       23960023
           END-IF                                                       23970023
           END-IF                                                       23980023
           END-IF                                                       23990023
           END-IF                                                       24000023
           END-IF                                                       24010023
           END-IF                                                       24020023
           END-IF                                                       24030023
                                                                        24040023
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.               24050023
           WRITE BP13FTP-REC FROM WS-FTP-LINE5.                         24060023
           WRITE BP13FTP-REC FROM WS-FTP-LINE6.                         24070023
           ADD 2                       TO WS-FTP-WRITE.                 24080023
                                                                        24090023
                                                                        24100023
       8900-EXIT.                                                       24110023
           EXIT.                                                        24120023
                                                                        24130023
      ***************************************************************** 24140023
       8910-WRITE-BP13FH10.                                             24150023
      ***************************************************************** 24160023
                                                                        24170023
           MOVE 'EASSSS3I'             TO WS-GROUP-ID.                  24180023
      *    IF WS-P49UA-NUM-FORMID1 = 'BP13R1' OR 'BP13V1' OR 'BP13V3'   24190023
      *    MOVE 'D'                    TO WS-PRINT-SETTING              24200023
      *    ELSE                                                         24210023
           MOVE 'S'                    TO WS-PRINT-SETTING              24220023
      *    END-IF                                                       24230023
           MOVE WS-HC49V-WRITE         TO WS-P13FT10A-WRITE.            24240023
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                  24250023
           WRITE P13HC49V-REC FROM WS-P13FH10A-REC.                     24260023
           WRITE P13HC49V-REC FROM WS-P13FT10A-REC.                     24270023
           ADD 2                       TO WS-FH10-WRITE.                24280023
                                                                        24290023
                                                                        24300023
       8910-EXIT.                                                       24310023
           EXIT.                                                        24320023
                                                                        24330023
      ***************************************************************** 24340023
       8915-POPULATE-FH10A.                                             24350023
      ***************************************************************** 24360023
                                                                        24370023
      * H10                                                             24380023
           MOVE SPACES                 TO WS-P13FH10A-REC.              24390023
           INITIALIZE WS-P13FH10A-REC.                                  24400023
                                                                        24410023
           MOVE 'H10'                  TO WS-FH10-RECORD-TYPE.          24420023
           MOVE WS-PARM-JOBNAME        TO WS-FH10-JOBNAME.              24430023
           MOVE WS-UPD-TMESTAMP(1:14)  TO WS-FH10-JOBDATE.              24440023
           MOVE 'BP13W009'             TO WS-FH10-WFD-ID.               24450023
      *    IF WS-P49UA-DESC = "BP13V1"                                  24460023
      *       MOVE 'BP13W011'          TO WS-FH10-WFD-ID                24470023
      *    ELSE                                                         24480023
      *    IF WS-P49UA-DESC = "BP13V3"                                  24490023
      *       MOVE 'BP13W012'          TO WS-FH10-WFD-ID                24500023
      *    END-IF                                                       24510023
      *    END-IF                                                       24520023
      *    IF WS-P49UA-DESC = "BP13R1"                                  24530023
      *       MOVE 'BP13W013'          TO WS-FH10-WFD-ID                24540023
      *    ELSE                                                         24550023
      *    IF WS-P49UA-DESC = "BP13D1"                                  24560023
      *       MOVE 'BP13W014'          TO WS-FH10-WFD-ID                24570023
      *    END-IF                                                       24580023
      *    END-IF                                                       24590023
           MOVE 'Y'                    TO WS-FH10-OUTPUT-PRINT.         24600023
           MOVE WS-GROUP-ID            TO WS-FH10-GROUP-ID.             24610023
                                                                        24620023
      * FEEDBACK FROM MOOI ON 18/5/2017                                 24630023
      * IOMS NOT CATER FOR THE PRINTING OF 2 COPIES                     24640023
      * USING PROGRAM TO TRIGGER TWICE INSTEAD                          24650023
      *    MOVE 2                      TO WS-FH10-COPIES.               24660023
      *                                                                 24670023
           MOVE 2                      TO WS-FH10-COPIES.               24680023
      *    MOVE 'B'                    TO WS-FH10-COLOUR.               24690023
           MOVE 'B'                    TO WS-FH10-COLOUR.               24700023
           MOVE 'A4W'                  TO WS-FH10-PAPER-TYPE.           24710023
           MOVE WS-PRINT-SETTING       TO WS-FH10-PRINT-SETTING.        24720023
           MOVE 'N'                    TO WS-FH10-AMIS                  24730023
                                          WS-FH10-OMR                   24740023
                                          WS-FH10-OUTPUT-FILING         24750023
                                          WS-FH10-OUTPUT-ONEINBOX       24760023
                                          WS-FH10-OUTPUT-SMS            24770023
                                          WS-FH10-OUTPUT-EMAIL          24780023
                                          WS-FH10-OUTPUT-FAX.           24790023
                                                                        24800023
      * T10                                                             24810023
           MOVE SPACES                 TO WS-P13FT10A-REC.              24820023
           INITIALIZE WS-P13FT10A-REC.                                  24830023
                                                                        24840023
           MOVE 'T10'                  TO WS-FT10-RECORD-TYPE.          24850023
           MOVE WS-P13FT10A-WRITE      TO WS-FT10-TOTAL-ACCOUNTS.       24860023
                                                                        24870023
       8915-EXIT.                                                       24880023
           EXIT.                                                        24890023
                                                                        24900023
      ***************************************************************** 24910023
       8920-WRITE-BP13FTP-SRC.                                          24920023
      ***************************************************************** 24930023
                                                                        24940023
           MOVE WS-PARM-JOBNAME        TO WS-FTP-JOBNAME.               24950023
           MOVE WS-UPD-TMESTAMP(1:13)  TO WS-FTP-TMESTAMP.              24960023
                                                                        24970023
      * B10                                                             24980023
           MOVE SPACES                 TO  WS-FTP-SOURCE.               24990023
           STRING "PUT '"                                               25000023
                  WS-PARM-B10-SOURCE "." WS-FTP-DESC                    25010023
                  "' "                                                  25020023
                  WS-FTP-DEST-REC ".TXT"                                25030023
              DELIMITED BY '  ' INTO WS-FTP-SOURCE                      25040023
           END-STRING.                                                  25050023
           WRITE BP13FTP-REC FROM WS-FTP-LINE4.                         25060023
           ADD 1                       TO WS-FTP-WRITE.                 25070023
                                                                        25080023
      * H10                                                             25090023
           MOVE SPACES                 TO WS-FTP-SOURCE.                25100023
           STRING "PUT '"                                               25110023
                  WS-PARM-H10-SOURCE "." WS-FTP-DESC                    25120023
                  "' "                                                  25130023
                  WS-FTP-DEST-REC ".H10"                                25140023
              DELIMITED BY '  ' INTO WS-FTP-SOURCE                      25150023
           END-STRING.                                                  25160023
           WRITE BP13FTP-REC FROM WS-FTP-LINE4.                         25170023
           ADD 1                       TO WS-FTP-WRITE.                 25180023
                                                                        25190023
       8920-EXIT.                                                       25200023
           EXIT.                                                        25210023
                                                                        25220023
      *-------------------------------------------------------------    25230023
       9900-HANDLE-ABEND.                                               25240023
      *-------------------------------------------------------------    25250023
                                                                        25260023
           DISPLAY ' '.                                                 25270023
           DISPLAY '- BP13C49V CONTROL TOTAL -------------'.            25280023
           DISPLAY 'TOTAL BM06F110 RECS READ  = ' WS-CNT-F110-READ.     25290023
           DISPLAY 'TOTAL LETTERS PRINTED     = ' WS-CNT-LETTER.        25300023
           DISPLAY 'TOTAL LETTERS PRINTED IOMS  ' WS-BC49V-SNO.         25310023
           DISPLAY 'TOTAL MISSING K800 REC    = ' WS-CNT-K800-MISS.     25320023
           DISPLAY 'TOTAL MISSING K820 REC    = ' WS-CNT-K820-MISS.     25330023
           DISPLAY 'TOTAL MISSING K830 REC    = ' WS-CNT-K830-MISS.     25340023
           DISPLAY 'TOTAL MISSING K510 REC    = ' WS-CNT-K510-MISS.     25350023
           DISPLAY 'TOTAL MISSING K100 REC    = ' WS-CNT-K100-MISS.     25360023
           DISPLAY 'TOTAL CASES WITH EMAIL    = ' WS-CNT-K857-W-EMAIL.  25370023
           DISPLAY 'TOTAL CASES WRITEN K491   = ' WS-F491-WRT.          25380023
           DISPLAY 'TOTAL CASES REWRITE K491  = ' WS-F491-REWRITE.      25390023
           DISPLAY 'TOTAL CASES WRITEN L49J   = ' WS-L49J-WRT.          25400023
           DISPLAY 'TOTAL CASES WRITEN P491   = ' WS-P491-WRT.          25410023
           DISPLAY 'TOTAL CASES WRITEN C49V   = ' WS-FB10-WRITE.        25420023
                                                                        25430023
           CLOSE BP13K022                                               25440023
                 BP13K024                                               25450023
                 BP13K800                                               25460023
                 BP13K820                                               25470023
                 BP13K830                                               25480023
                 BM06F110                                               25490023
                 BP13K491                                               25500023
                 BP13F491                                               25510023
                 BP13L49J                                               25520023
                 BP13P491.                                              25530023
                                                                        25540023
           IF K022-STATUS NOT = 00 AND 97                               25550023
              MOVE K022-STATUS TO RETURN-CODE                           25560023
              DISPLAY 'CLOSE FAILED FOR BP13K022 ' K022-STATUS          25570023
           END-IF.                                                      25580023
                                                                        25590023
           IF K024-STATUS NOT = 00 AND 97                               25600023
              MOVE K024-STATUS TO RETURN-CODE                           25610023
              DISPLAY 'CLOSE FAILED FOR BP13K800 ' K024-STATUS          25620023
           END-IF.                                                      25630023
                                                                        25640023
           IF K800-STATUS NOT = 00 AND 97                               25650023
              MOVE K800-STATUS TO RETURN-CODE                           25660023
              DISPLAY 'CLOSE FAILED FOR BP13K800 ' K800-STATUS          25670023
           END-IF.                                                      25680023
                                                                        25690023
           IF K820-STATUS NOT = 00 AND 97                               25700023
              MOVE K820-STATUS TO RETURN-CODE                           25710023
              DISPLAY 'CLOSE FAILED FOR BP13K820 ' K820-STATUS          25720023
           END-IF.                                                      25730023
                                                                        25740023
           IF K830-STATUS NOT = 00 AND 97                               25750023
              MOVE K830-STATUS TO RETURN-CODE                           25760023
              DISPLAY 'CLOSE FAILED FOR BP13K830 ' K830-STATUS          25770023
           END-IF.                                                      25780023
                                                                        25790023
           IF K510-STATUS NOT = 00 AND 97                               25800023
              DISPLAY 'CLOSE FAILED FOR BM06K510 ' K510-STATUS          25810023
              MOVE K510-STATUS TO RETURN-CODE.                          25820023
                                                                        25830023
           IF K100-STATUS NOT = 00 AND 97                               25840023
              DISPLAY 'CLOSE FAILED FOR BM06K100 ' K100-STATUS          25850023
              MOVE K100-STATUS TO RETURN-CODE.                          25860023
                                                                        25870023
           IF K857-STATUS NOT = 00 AND 97                               25880023
              DISPLAY 'CLOSE FAILED FOR BP13K857 ' K857-STATUS          25890023
              MOVE K857-STATUS TO RETURN-CODE.                          25900023
           STOP RUN.                                                    25910023
                                                                        25920023
       9900-EXIT.                                                       25930023
            EXIT.                                                       25940023
                                                                        25950023
      *-------------------------------------------------------------    25960023
       9999-WRAP-UP.                                                    25970023
      *-------------------------------------------------------------    25980023
           ADD WS-BLK-CNT                        TO WS-TOTAL-CNT.       25990023
           MOVE WS-TOTAL-CNT                     TO L49J-TOTAL.         26000023
           WRITE L49J-PRTREC FROM L49J-PRT-TOTAL AFTER 2.               26010023
                                                                        26020023
           DISPLAY ' '.                                                 26030023
           DISPLAY '- BP13C49V CONTROL TOTAL -------------'.            26040023
           DISPLAY ' TOTAL BM06F110 REC READ : ' WS-CNT-F110-READ.      26050023
           DISPLAY ' TOTAL LETTERS PRINTED   : ' WS-CNT-LETTER.         26060023
           DISPLAY ' TOTAL LETTERS PRINTED IOMS' WS-BC49V-SNO.          26070023
           DISPLAY ' TOTAL MISSING K800 REC  : ' WS-CNT-K800-MISS.      26080023
           DISPLAY ' TOTAL MISSING K820 REC  : ' WS-CNT-K820-MISS.      26090023
           DISPLAY ' TOTAL MISSING K830 REC  : ' WS-CNT-K830-MISS.      26100023
           DISPLAY ' TOTAL MISSING K510 REC  : ' WS-CNT-K510-MISS.      26110023
           DISPLAY ' TOTAL MISSING K100 REC  : ' WS-CNT-K100-MISS.      26120023
           DISPLAY ' TOTAL CASES WITH EMAIL  : ' WS-CNT-K857-W-EMAIL.   26130023
           DISPLAY ' TOTAL CASES WRITEN K491 :  ' WS-F491-WRT.          26140023
           DISPLAY ' TOTAL CASES REWRITE K491 : ' WS-F491-REWRITE.      26150023
           DISPLAY ' TOTAL CASES WRITEN L49J  : ' WS-L49J-WRT.          26160023
           DISPLAY ' TOTAL CASES WRITEN P491  : ' WS-P491-WRT.          26170023
           DISPLAY ' TOTAL CASES WRITEN C49V  : ' WS-FB10-WRITE.        26180023
                                                                        26190023
           CLOSE BP13K022                                               26200023
                 BP13K024                                               26210023
                 BP13K800                                               26220023
                 BP13K820                                               26230023
                 BP13K830                                               26240023
                 BM06K510                                               26250023
                 BM06K100                                               26260023
                 BM06F110                                               26270023
                 BP13K857                                               26280023
                 BP13K491                                               26290023
                 BP13L49J                                               26300023
                 BP13P491.                                              26310023
                                                                        26320023
           IF K491-STATUS NOT = 00 AND 97                               26330023
              DISPLAY 'CLOSE FAILED FOR BP13K491 ' K491-STATUS          26340023
              MOVE K491-STATUS TO RETURN-CODE.                          26350023
                                                                        26360023
                                                                        26370023
           IF K022-STATUS NOT = 00 AND 97                               26380023
              DISPLAY 'CLOSE FAILED FOR BP13K022 ' K022-STATUS          26390023
              MOVE K022-STATUS TO RETURN-CODE.                          26400023
                                                                        26410023
           IF K024-STATUS NOT = 00 AND 97                               26420023
              DISPLAY 'CLOSE FAILED FOR BP13K024 ' K024-STATUS          26430023
              MOVE K024-STATUS TO RETURN-CODE.                          26440023
                                                                        26450023
           IF K800-STATUS NOT = 00 AND 97                               26460023
              DISPLAY 'CLOSE FAILED FOR BP13K800 ' K800-STATUS          26470023
              MOVE K800-STATUS TO RETURN-CODE.                          26480023
                                                                        26490023
           IF K820-STATUS NOT = 00 AND 97                               26500023
              DISPLAY 'CLOSE FAILED FOR BP13K820 ' K820-STATUS          26510023
              MOVE K820-STATUS TO RETURN-CODE.                          26520023
                                                                        26530023
           IF K830-STATUS NOT = 00 AND 97                               26540023
              DISPLAY 'CLOSE FAILED FOR BP13K830 ' K830-STATUS          26550023
              MOVE K830-STATUS TO RETURN-CODE.                          26560023
                                                                        26570023
           IF K510-STATUS NOT = 00 AND 97                               26580023
              DISPLAY 'CLOSE FAILED FOR BM06K510 ' K510-STATUS          26590023
              MOVE K510-STATUS TO RETURN-CODE.                          26600023
                                                                        26610023
           IF K100-STATUS NOT = 00 AND 97                               26620023
              DISPLAY 'CLOSE FAILED FOR BM06K100 ' K100-STATUS          26630023
              MOVE K100-STATUS TO RETURN-CODE.                          26640023
                                                                        26650023
           IF K857-STATUS NOT = 00 AND 97                               26660023
              DISPLAY 'CLOSE FAILED FOR BP13K857 ' K857-STATUS          26670023
              MOVE K857-STATUS TO RETURN-CODE.                          26680023
           STOP RUN.                                                    26690023
                                                                        26700023
       9999-EXIT.                                                       26710023
            EXIT.                                                       26720023
