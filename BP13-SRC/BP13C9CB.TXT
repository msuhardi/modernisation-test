      *-----------------------*                                         00010000
       IDENTIFICATION DIVISION.                                         00020000
      *-----------------------*                                         00030000
       PROGRAM-ID.    BP13C9CB.                                         00040000
      *AUTHOR.        YCH2.                                             00050000
      *DTE WRITTEN.   21 MAY 2011.                                      00060000
      **********************************************************        00070000
      *    SYSTEM NAME : SYSTEM OF COMMITMENT                  *        00080000
      *    SYSTEM ID   : BP13                                  *        00090000
      **********************************************************        00100000
      *                                                        *        00110000
      *    OBJECTIVES  :                                       *        00120000
      *                                                        *        00130000
      *    NOTES: SIMILAR TO BP13C02B BUT OUTPUT TO SEQUENTIAL *        00140000
      *                                                        *        00150000
      *    1.  TO CREATE BP13F730 AND BP13F825 RECORDS WITH    *        00160000
      *        THE FILE FROM UPLOADED FROM DBS INTERNET MODULE.*        00170000
      *        (SIMILAR TO BP13C796, BP13C023)                 *        00180000
      *                                                        *        00190000
      *    INPUT FILES : BP13FB78 - DBS FILE                   *        00200000
      *                                                        *        00210000
      *    INPUT-OUTPUT: BP13F730 - MATURE REQUEST FOR REGN    *        00220000
      *                  BP13F830 - CORR ADDRESS FILE          *        00230000
      *                                                        *        00240000
      *    OUTPUT FILE : BP13L9CB - LIST OF APPLICANTS W/O     *        00250000
      *                             REGISTRATION NUMBER        *        00260000
      *                  BE01F500 - MHA INTERFACE FILE         *        00270000
      *                                                        *        00280000
      *    SUBROUTINES :                                       *        00290000
      *                                                        *        00300000
      *--------------------------------------------------------*        00310000
      * CHG-NO   BY    DATE   DETAILS                          *        00320000
      * ======= ====  ======  ================================ *        00330000
      * BP132886 LSB  061006  NEW PROGRAM                      *        00340000
      * BP133323 JB8  220708  CATER FOR DIFFERENT PROJ CODE    *        00350000
      * BP133505 IL5  190109  HARDCODE BALLOT DATE FOR D04     *        00360000
      * BP133533 IL5  140409  HARDCODE BALLOT DATE FOR D05     *        00370000
      * BP133541 IL5  140409  HARDCODE BALLOT DATE FOR D06     *        00380000
      * BP134025 IL5  300910  CATER FOR EC                     *        00390000
      * BP134067 IL5  251111  HARDCODE BALLOT DATE FOR D07     *        00400000
      * BP134229 YCH2 210511  WRITE TO SEQUENTIAL FILE         *        00410000
      * BP134474 YCH2 23042012 MOVE EC DETERMINED HH TO PREVENT*        00420000
      *                        ONLINE CHECK ON EXISTING EC FLAT*        00430000
      * BP134996 SMR2 29072013 CEASE WRITING OF XIN TO BE01F500*        00440000
      * BP138971 KR13 21122021 CATER FOR NEW FIN SERIES 'M'    *        00441002
      * ====================================================== *        00450000
                                                                        00460000
      *-----------------------*                                         00470000
       ENVIRONMENT DIVISION.                                            00480000
      *-----------------------*                                         00490000
       CONFIGURATION SECTION.                                           00500000
      *-----------------------*                                         00510000
                                                                        00520000
       SOURCE-COMPUTER. IBM-9121.                                       00530000
       OBJECT-COMPUTER. IBM-9121.                                       00540000
                                                                        00550000
      *-----------------------*                                         00560000
       INPUT-OUTPUT SECTION.                                            00570000
      *-----------------------*                                         00580000
       FILE-CONTROL.                                                    00590000
                                                                        00600000
           SELECT BP13FB78 ASSIGN    TO BP13FB78.                       00610000
                                                                        00620000
           SELECT BE01F500 ASSIGN    TO BE01F500.                       00630000
                                                                        00640000
           SELECT BP13F830 ASSIGN    TO BP13F830.                       00650000
                                                                        00660000
           SELECT BP13F730 ASSIGN    TO BP13F730.                       00670000
                                                                        00680000
           SELECT BP13F825 ASSIGN    TO BP13F825.                       00690000
                                                                        00700000
           SELECT BP13L9CB ASSIGN    TO BP13L9CB.                       00710000
                                                                        00720000
                                                                        00730000
      *-----------------------*                                         00740000
       DATA DIVISION.                                                   00750000
      *-----------------------*                                         00760000
       FILE SECTION.                                                    00770000
      *-----------------------*                                         00780000
                                                                        00790000
       FD   BP13FB78                                                    00800000
            BLOCK      CONTAINS 0    RECORDS                            00810000
            RECORD     CONTAINS 3300 CHARACTERS                         00820000
            LABEL      RECORDS  ARE  STANDARD                           00830000
            RECORDING  MODE     IS  F.                                  00840000
       COPY BP13FB78.                                                   00850000
                                                                        00860000
       FD   BE01F500                                                    00870000
            BLOCK      CONTAINS 0   RECORDS                             00880000
            RECORD     CONTAINS 50  CHARACTERS                          00890000
            LABEL      RECORDS  ARE STANDARD                            00900000
            RECORDING  MODE     IS  F.                                  00910000
       COPY BE01F500.                                                   00920000
                                                                        00930000
       FD   BP13F830                                                    00940000
            BLOCK      CONTAINS 0   RECORDS                             00950000
            RECORD     CONTAINS 250 CHARACTERS                          00960000
            LABEL      RECORDS  ARE STANDARD                            00970000
            RECORDING  MODE     IS  F.                                  00980000
       COPY BP13F830.                                                   00990000
                                                                        01000000
       FD   BP13F730                                                    01010000
            BLOCK      CONTAINS 0    RECORDS                            01020000
            RECORD     CONTAINS 500 CHARACTERS                          01030000
            LABEL      RECORDS  ARE  STANDARD                           01040000
            RECORDING  MODE     IS  F.                                  01050000
       COPY BP13F730.                                                   01060000
                                                                        01070000
       FD   BP13F825                                                    01080000
            BLOCK      CONTAINS 0    RECORDS                            01090000
            RECORD     CONTAINS 200 CHARACTERS                          01100000
            LABEL      RECORDS  ARE  STANDARD                           01110000
            RECORDING  MODE     IS  F.                                  01120000
       COPY BP13F825.                                                   01130000
                                                                        01140000
       FD   BP13L9CB                                                    01150000
            BLOCK     CONTAINS 0   RECORDS                              01160000
            RECORD    CONTAINS 132 CHARACTERS                           01170000
            LABEL     RECORDS  ARE OMITTED                              01180000
            RECORDING MODE     IS  F.                                   01190000
       01   BP13L9CB-REC           PIC X(132).                          01200000
                                                                        01210000
                                                                        01220000
      *-----------------------*                                         01230000
       WORKING-STORAGE SECTION.                                         01240000
      *-----------------------*                                         01250000
                                                                        01260000
       COPY IDPTABLE.                                                   01270000
                                                                        01280000
       01  WS-FILE-CONTROLS.                                            01290000
           05  WS-FB78-EOF-SW             PIC X(1)    VALUE 'N'.        01300000
                                                                        01310000
       01  WS-L9CB-CONTROLS.                                            01320000
           05  WS-L9CB-LINECTR            PIC 9(2)    VALUE 25.         01330000
           05  WS-L9CB-PAGECTR            PIC 9(4)    VALUE 0.          01340000
           05  WS-L9CB-S-NO               PIC 9(5)    VALUE 0.          01350000
                                                                        01360000
       01  WS-RECORD-COUNTERS.                                          01370000
           05  WS-FB78-READ-CTR           PIC 9(5)    VALUE 0.          01380000
           05  WS-F500-WRITE-CTR          PIC 9(5)    VALUE 0.          01390000
           05  WS-F830-WRITE-CTR          PIC 9(5)    VALUE 0.          01400000
           05  WS-F830-DUP-CTR            PIC 9(5)    VALUE 0.          01410000
           05  WS-F830-ERROR-CTR          PIC 9(5)    VALUE 0.          01420000
           05  WS-F825-WRITE-CTR          PIC 9(5)    VALUE 0.          01430000
           05  WS-F825-DUP-CTR            PIC 9(5)    VALUE 0.          01440000
           05  WS-F825-ERROR-CTR          PIC 9(5)    VALUE 0.          01450000
           05  WS-F730-WRITE-CTR          PIC 9(5)    VALUE 0.          01460000
           05  WS-F730-DUP-CTR            PIC 9(5)    VALUE 0.          01470000
           05  WS-F730-ERROR-CTR          PIC 9(5)    VALUE 0.          01480000
                                                                        01490000
       01  WS-DATES.                                                    01500000
           05  WS-EDITED-DATE.                                          01510000
               10  WS-EDITED-DD           PIC 9(2).                     01520000
               10  FILLER                 PIC X(1)    VALUE '/'.        01530000
               10  WS-EDITED-MM           PIC 9(2).                     01540000
               10  FILLER                 PIC X(1)    VALUE '/'.        01550000
               10  WS-EDITED-YY           PIC 9(4).                     01560000
           05  WS-CURRENT-DATE.                                         01570000
               10  WS-CURR-CCYY.                                        01580000
                   15  WS-CURR-YY         PIC 9(4).                     01590000
               10  WS-CURR-MM             PIC 9(2).                     01600000
               10  WS-CURR-DD             PIC 9(2).                     01610000
                                                                        01620000
       01  WS-SYSTEM-DATE.                                              01630000
           05  WS-SYS-YY                  PIC 9(4).                     01640000
           05  WS-SYS-MM                  PIC 9(2).                     01650000
           05  WS-SYS-DD                  PIC 9(2).                     01660000
                                                                        01670000
       01  WS-TEMPORARY-FIELDS.                                         01680000
           05  WS-TEMP-NAME               PIC X(66).                    01690000
           05  WS-TEMP-DTE-BIRTH          PIC X(10).                    01700000
           05  WS-TEMP-REGN               PIC X(8).                     01710000
           05  WS-TEMP-NRIC               PIC X(9).                     01720000
           05  WS-TEMP-MSTATUS            PIC X(1).                     01730000
           05  WS-TEMP-INCOME             PIC X(5).                     01740000
           05  WS-TEMP-CITIZENSHIP        PIC X(2).                     01750000
           05  WS-TEMP-RELATIONSHIP       PIC X(2).                     01760000
           05  WS-TEMP-LESSEE             PIC X(1).                     01770000
           05  WS-TEMP-RACE               PIC X(1).                     01780000
           05  WS-TEMP-SEX                PIC X(1).                     01790000
           05  WS-TEMP-NRIC-SPOUSE        PIC X(9).                     01800000
           05  WS-TEMP-EDN-LVL            PIC X(1).                     01810000
           05  WS-TEMP-PHONE              PIC X(8).                     01820000
           05  WS-TEMP-HP-PAGER           PIC X(8).                     01830000
                                                                        01840000
       01  WS-OTHERS.                                                   01850000
           05  WS-OCC-REL                 PIC X(2).                     01860000
           05  WS-TMP-REL                 PIC X(2).                     01870000
           05  WS-TMP-EDN                 PIC 9(1).                     01880000
           05  WS-FOUND-SW                PIC X(1)    VALUE 'N'.        01890000
           05  WS-DESC                    PIC X(3)    VALUE SPACES.     01900000
                                                                        01910000
       01  WS-CONSTANT-TEXTS.                                           01920000
           05  WS-TOTAL-DESC.                                           01930000
               10  K-FB78-RECORDS-READ    PIC X(50)   VALUE             01940000
                      'TOTAL RECORDS READ IN BP13FB78            : '.   01950000
               10  K-F730-RECORDS-WRITE   PIC X(50)   VALUE             01960000
                      'TOTAL RECORDS WRITE TO BP13F730           : '.   01970000
               10  K-F500-RECORDS-WRITE   PIC X(50)   VALUE             01980000
                      'TOTAL RECORDS WRITE TO BE01F500           : '.   01990000
               10  K-F830-RECORDS-WRITE   PIC X(50)   VALUE             02000000
                      'TOTAL RECORDS WRITE TO BP13F830           : '.   02010000
               10  K-F825-RECORDS-WRITE   PIC X(50)   VALUE             02020000
                      'TOTAL RECORDS WRITE TO BP13F825           : '.   02030000
                                                                        02040000
      **************************************************************    02050000
      *       BP13L9CB -  R E P O R T   L A Y O U T                *    02060000
      **************************************************************    02070000
       01  L9CB-HEADING-01.                                             02080000
           05  FILLER              PIC X(08)     VALUE 'BP13L9CB'.      02090000
           05  FILLER              PIC X(06)     VALUE SPACES.          02100000
           05  FILLER              PIC X(08)     VALUE 'HDB3'.          02110000
           05  FILLER              PIC X(24)     VALUE SPACES.          02120000
           05  FILLER              PIC X(39)     VALUE                  02130000
               'S Y S T E M   O F   C O M M I T M E N T'.               02140000
           05  FILLER              PIC X(13)     VALUE SPACES.          02150000
           05  FILLER              PIC X(07)     VALUE 'DATE :'.        02160000
           05  L9CB-RUN-DATE       PIC X(10).                           02170000
           05  FILLER              PIC X(04)     VALUE SPACES.          02180000
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.       02190000
           05  L9CB-PAGE-NO        PIC ZZZZ9 .                          02200000
                                                                        02210000
       01  L9CB-HEADING-02.                                             02220000
           05  FILLER              PIC X(100)    VALUE SPACES.          02230000
           05  FILLER              PIC X(33)     VALUE                  02240000
               'SALES UNIT (APPLICATION TEAM)'.                         02250000
                                                                        02260000
       01  L9CB-HEADING-03.                                             02270000
           05  FILLER              PIC X(26)     VALUE SPACES.          02280000
           05  FILLER              PIC X(78)     VALUE                  02290000
               'ERRORS ENCOUNTERED FOR INTERNET APPLICATION'.           02300000
                                                                        02310000
       01  L9CB-HEADING-04.                                             02320000
           05  FILLER              PIC X(08)     VALUE SPACES.          02330000
           05  FILLER              PIC X(05)     VALUE ' S/N'.          02340000
           05  FILLER              PIC X(05)     VALUE SPACES.          02350000
           05  FILLER              PIC X(06)     VALUE 'REGN  '.        02360000
           05  FILLER              PIC X(05)     VALUE SPACES.          02370000
           05  FILLER              PIC X(09)     VALUE '  NRIC'.        02380000
           05  FILLER              PIC X(07)     VALUE SPACES.          02390000
           05  FILLER              PIC X(11)     VALUE 'ERROR NRIC'.    02400000
           05  FILLER              PIC X(05)     VALUE SPACES.          02410000
           05  FILLER              PIC X(40)     VALUE 'REMARKS'.       02420000
                                                                        02430000
       01  L9CB-HEADING-05.                                             02440000
           05  FILLER              PIC X(132)    VALUE ALL '_'.         02450000
                                                                        02460000
       01  L9CB-DETAIL-01.                                              02470000
           05  FILLER              PIC X(08)     VALUE SPACES.          02480000
           05  L9CB-S-NO           PIC X(05).                           02490000
           05  FILLER              PIC X(05)     VALUE SPACES.          02500000
           05  L9CB-REGN           PIC X(08).                           02510000
           05  FILLER              PIC X(03)     VALUE SPACES.          02520000
           05  L9CB-NRIC           PIC X(09).                           02530000
           05  FILLER              PIC X(07)     VALUE SPACES.          02540000
           05  L9CB-ERROR-NRIC     PIC X(09).                           02550000
           05  FILLER              PIC X(07)     VALUE SPACES.          02560000
           05  L9CB-REMARKS        PIC X(40).                           02570000
           05  FILLER              PIC X(49)     VALUE SPACES.          02580000
                                                                        02590000
       01  L9CB-TOTALS             REDEFINES     L9CB-DETAIL-01.        02600000
           05  FILLER              PIC X(39).                           02610000
           05  L9CB-TOTAL-DESC     PIC X(50).                           02620000
           05  L9CB-TOTAL-VALUE    PIC X(05).                           02630000
                                                                        02640000
                                                                        02650000
      *-----------------------*                                         02660000
       PROCEDURE DIVISION.                                              02670000
      *-----------------------*                                         02680000
                                                                        02690000
      ******************************************************************02700000
       0000-MAIN.                                                       02710000
      ******************************************************************02720000
           PERFORM  1000-OPEN-FILES         THRU 1000-EXIT.             02730000
           PERFORM  2000-MAIN-ROUTINE       THRU 2000-EXIT.             02740000
           PERFORM  8000-PRINT-REPORT       THRU 8000-EXIT.             02750000
           PERFORM  9000-CLOSE-FILES        THRU 9000-EXIT.             02760000
                                                                        02770000
       0000-EXIT.                                                       02780000
           EXIT.                                                        02790000
                                                                        02800000
                                                                        02810000
      ******************************************************************02820000
       1000-OPEN-FILES.                                                 02830000
      ******************************************************************02840000
           OPEN INPUT  BP13FB78                                         02850000
                OUTPUT BP13F730                                         02860000
                       BP13F830                                         02870000
                       BP13F825                                         02880000
                       BP13L9CB                                         02890000
                       BE01F500.                                        02900000
                                                                        02910000
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-SYSTEM-DATE.           02920000
                                                                        02930000
           MOVE   WS-SYS-YY                TO    WS-EDITED-YY           02940000
                                                 WS-CURR-YY.            02950000
           MOVE   WS-SYS-MM                TO    WS-EDITED-MM           02960000
                                                 WS-CURR-MM.            02970000
           MOVE   WS-SYS-DD                TO    WS-EDITED-DD           02980000
                                                 WS-CURR-DD.            02990000
           MOVE   WS-EDITED-DATE           TO    L9CB-RUN-DATE.         03000000
                                                                        03010000
       1000-EXIT.                                                       03020000
           EXIT.                                                        03030000
                                                                        03040000
                                                                        03050000
      ******************************************************************03060000
       2000-MAIN-ROUTINE.                                               03070000
      ******************************************************************03080000
           PERFORM  3000-BP13FB78-READ     THRU 3000-EXIT.              03090000
                                                                        03100000
           PERFORM  4000-PROCESS-FB78-REC  THRU 4000-EXIT               03110000
              UNTIL WS-FB78-EOF-SW = 'Y'.                               03120000
                                                                        03130000
       2000-EXIT.                                                       03140000
           EXIT.                                                        03150000
                                                                        03160000
                                                                        03170000
      ******************************************************************03180000
       3000-BP13FB78-READ.                                              03190000
      ******************************************************************03200000
           READ BP13FB78                                                03210000
              AT END MOVE 'Y'     TO WS-FB78-EOF-SW                     03220000
              GO TO  3000-EXIT                                          03230000
           END-READ.                                                    03240000
                                                                        03250000
           ADD +1                 TO WS-FB78-READ-CTR.                  03260000
                                                                        03270000
           PERFORM 3100-EDIT-NUMERIC-FIELDS    THRU 3100-EXIT.          03280000
                                                                        03290000
       3000-EXIT.                                                       03300000
           EXIT.                                                        03310000
                                                                        03320000
                                                                        03330000
      **********************************************************        03340000
       3100-EDIT-NUMERIC-FIELDS.                                        03350000
      **********************************************************        03360000
           INSPECT FB78-AMT-APPLT1-INCOME                               03370000
              REPLACING LEADING SPACES BY ZEROS                         03380000
                                                                        03390000
           INSPECT FB78-AMT-APPLT2-INCOME                               03400000
              REPLACING LEADING SPACES BY ZEROS                         03410000
                                                                        03420000
           INSPECT FB78-AMT-APPLT3-INCOME                               03430000
              REPLACING LEADING SPACES BY ZEROS                         03440000
                                                                        03450000
           INSPECT FB78-AMT-APPLT4-INCOME                               03460000
              REPLACING LEADING SPACES BY ZEROS                         03470000
                                                                        03480000
           INSPECT FB78-AMT-OCCUP1-INCOME                               03490000
              REPLACING LEADING SPACES BY ZEROS                         03500000
                                                                        03510000
           INSPECT FB78-AMT-OCCUP2-INCOME                               03520000
              REPLACING LEADING SPACES BY ZEROS                         03530000
                                                                        03540000
           INSPECT FB78-AMT-OCCUP3-INCOME                               03550000
              REPLACING LEADING SPACES BY ZEROS                         03560000
                                                                        03570000
           INSPECT FB78-AMT-OCCUP4-INCOME                               03580000
              REPLACING LEADING SPACES BY ZEROS                         03590000
                                                                        03600000
           INSPECT FB78-AMT-OCCUP5-INCOME                               03610000
              REPLACING LEADING SPACES BY ZEROS                         03620000
                                                                        03630000
           INSPECT FB78-AMT-OCCUP6-INCOME                               03640000
              REPLACING LEADING SPACES BY ZEROS.                        03650000
                                                                        03660000
           INSPECT FB78-AMT-OCCUP7-INCOME                               03670000
              REPLACING LEADING SPACES BY ZEROS.                        03680000
                                                                        03690000
           INSPECT FB78-AMT-OCCUP8-INCOME                               03700000
              REPLACING LEADING SPACES BY ZEROS.                        03710000
                                                                        03720000
       3100-EXIT.                                                       03730000
           EXIT.                                                        03740000
                                                                        03750000
                                                                        03760000
      **********************************************************        03770000
       4000-PROCESS-FB78-REC.                                           03780000
      **********************************************************        03790000
           MOVE SPACES TO WS-TEMP-SEX                                   03800000
                          WS-TEMP-RACE                                  03810000
                          WS-TEMP-MSTATUS.                              03820000
                                                                        03830000
           IF FB78-NUM-REGN      = SPACE OR LOW-VALUES                  03840000
              PERFORM 3000-BP13FB78-READ THRU 3000-EXIT                 03850000
              GO TO 4000-EXIT.                                          03860000
                                                                        03870000
           PERFORM 4300-BP13F730-WRITE  THRU 4300-EXIT.                 03880000
                                                                        03890000
           PERFORM 4050-WRITE-MHA-INFO  THRU 4050-EXIT                  03900000
                                                                        03910000
           MOVE FB78-NUM-REGN           TO WS-TEMP-REGN                 03920000
           MOVE FB78-NME-APPLT1         TO WS-TEMP-NAME                 03930000
           MOVE FB78-DTE-APPLT1-BIRTH   TO WS-TEMP-DTE-BIRTH            03940000
           MOVE FB78-NUM-APPLT1-UIN     TO WS-TEMP-NRIC                 03950000
           MOVE FB78-NUM-APPLT1-MARITAL-STATUS TO                       03960000
                                           WS-TEMP-MSTATUS              03970000
           MOVE FB78-AMT-APPLT1-INCOME  TO WS-TEMP-INCOME               03980000
           MOVE '10'                    TO WS-TEMP-CITIZENSHIP          03990000
           MOVE '00'                    TO WS-TEMP-RELATIONSHIP         04000000
                                           WS-OCC-REL                   04010000
           MOVE 'Y'                     TO WS-TEMP-LESSEE               04020000
           MOVE FB78-NUM-APPLT1-RACE    TO WS-TEMP-RACE                 04030000
           MOVE FB78-NUM-APPLT1-SEX     TO WS-TEMP-SEX                  04040000
           MOVE FB78-NUM-APPLT1-EDN-LVL TO WS-TEMP-EDN-LVL              04050000
           MOVE FB78-NUM-APPLT1-PHONE   TO WS-TEMP-PHONE                04060000
           MOVE FB78-NUM-APPLT1-HP-PAGER TO WS-TEMP-HP-PAGER            04070000
                                                                        04080000
           PERFORM 4150-MOVE-SPOU-NRIC  THRU 4150-EXIT                  04090000
           PERFORM 4200-BP13F825-WRITE  THRU 4200-EXIT                  04100000
           PERFORM 4250-WRITE-CO-APPL   THRU 4250-EXIT                  04110000
           PERFORM 4260-WRITE-OCCUP     THRU 4260-EXIT                  04120000
           PERFORM 4400-BP13F830-WRITE  THRU 4400-EXIT                  04130000
                                                                        04140000
           PERFORM 3000-BP13FB78-READ      THRU 3000-EXIT.              04150000
                                                                        04160000
       4000-EXIT.                                                       04170000
           EXIT.                                                        04180000
                                                                        04190000
                                                                        04200000
      **********************************************************        04210000
       4050-WRITE-MHA-INFO.                                             04220000
      **********************************************************        04230000
      *-----------------------> WRITE APPLICANT    1                    04240000
           MOVE SPACES                        TO   BE01F500-REC.        04250000
           MOVE FB78-NUM-APPLT1-UIN           TO   BE01F500-IDNO.       04260000
           PERFORM 4051-BE01F500-WRITE        THRU 4051-EXIT.           04270000
                                                                        04280000
      *-----------------------> WRITE CO-APPLICANT 1                    04290000
           IF FB78-NUM-APPLT2-UIN   NOT = SPACES                        04300000
              MOVE SPACES                     TO   BE01F500-REC         04310000
              MOVE FB78-NUM-APPLT2-UIN        TO   BE01F500-IDNO        04320000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            04330000
           END-IF.                                                      04340000
                                                                        04350000
      *-----------------------> WRITE CO-APPLICANT 2                    04360000
           IF FB78-NUM-APPLT3-UIN  NOT = SPACES                         04370000
              MOVE SPACES                     TO   BE01F500-REC         04380000
              MOVE FB78-NUM-APPLT3-UIN        TO   BE01F500-IDNO        04390000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            04400000
           END-IF.                                                      04410000
                                                                        04420000
      *-----------------------> WRITE CO-APPLICANT 3                    04430000
           IF FB78-NUM-APPLT4-UIN   NOT = SPACES                        04440000
              MOVE SPACES                     TO   BE01F500-REC         04450000
              MOVE FB78-NUM-APPLT4-UIN        TO   BE01F500-IDNO        04460000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            04470000
           END-IF.                                                      04480000
                                                                        04490000
      *-----------------------> WRITE OCCUPIER     1                    04500000
           IF FB78-NUM-OCCUP1-UIN NOT = SPACES                          04510000
              MOVE SPACES                     TO   BE01F500-REC         04520000
              MOVE FB78-NUM-OCCUP1-UIN        TO   BE01F500-IDNO        04530000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            04540000
           END-IF.                                                      04550000
                                                                        04560000
      *-----------------------> WRITE OCCUPIER     2                    04570000
           IF FB78-NUM-OCCUP2-UIN NOT = SPACES                          04580000
              MOVE SPACES                     TO   BE01F500-REC         04590000
              MOVE FB78-NUM-OCCUP2-UIN        TO   BE01F500-IDNO        04600000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            04610000
           END-IF.                                                      04620000
                                                                        04630000
      *-----------------------> WRITE OCCUPIER     3                    04640000
           IF FB78-NUM-OCCUP3-UIN NOT = SPACES                          04650000
              MOVE SPACES                     TO   BE01F500-REC         04660000
              MOVE FB78-NUM-OCCUP3-UIN        TO   BE01F500-IDNO        04670000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            04680000
           END-IF.                                                      04690000
                                                                        04700000
      *-----------------------> WRITE OCCUPIER     4                    04710000
           IF FB78-NUM-OCCUP4-UIN NOT = SPACES                          04720000
              MOVE SPACES                     TO   BE01F500-REC         04730000
              MOVE FB78-NUM-OCCUP4-UIN        TO   BE01F500-IDNO        04740000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            04750000
           END-IF.                                                      04760000
                                                                        04770000
      *-----------------------> WRITE OCCUPIER     5                    04780000
           IF FB78-NUM-OCCUP5-UIN NOT = SPACES                          04790000
              MOVE SPACES                     TO   BE01F500-REC         04800000
              MOVE FB78-NUM-OCCUP5-UIN        TO   BE01F500-IDNO        04810000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            04820000
           END-IF.                                                      04830000
                                                                        04840000
      *-----------------------> WRITE OCCUPIER     6                    04850000
           IF FB78-NUM-OCCUP6-UIN NOT = SPACES                          04860000
              MOVE SPACES                     TO   BE01F500-REC         04870000
              MOVE FB78-NUM-OCCUP6-UIN        TO   BE01F500-IDNO        04880000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            04890000
           END-IF.                                                      04900000
                                                                        04910000
      *-----------------------> WRITE OCCUPIER     7                    04920000
           IF FB78-NUM-OCCUP7-UIN NOT = SPACES                          04930000
              MOVE SPACES                     TO   BE01F500-REC         04940000
              MOVE FB78-NUM-OCCUP7-UIN        TO   BE01F500-IDNO        04950000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            04960000
           END-IF.                                                      04970000
                                                                        04980000
      *-----------------------> WRITE OCCUPIER     8                    04990000
           IF FB78-NUM-OCCUP8-UIN NOT = SPACES                          05000000
              MOVE SPACES                     TO   BE01F500-REC         05010000
              MOVE FB78-NUM-OCCUP8-UIN        TO   BE01F500-IDNO        05020000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            05030000
           END-IF.                                                      05040000
                                                                        05050000
      *-----------------------> WRITE MCPS RESIDENT1                    05060000
           IF FB78-NUM-CHILD1-PARENT-UIN NOT = SPACES                   05070000
              MOVE SPACES                     TO   BE01F500-REC         05080000
              MOVE FB78-NUM-CHILD1-PARENT-UIN TO   BE01F500-IDNO        05090000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            05100000
           END-IF.                                                      05110000
                                                                        05120000
      *-----------------------> WRITE MCPS RESIDENT2                    05130000
           IF FB78-NUM-CHILD2-PARENT-UIN NOT = SPACES                   05140000
              MOVE SPACES                     TO   BE01F500-REC         05150000
              MOVE FB78-NUM-CHILD2-PARENT-UIN TO   BE01F500-IDNO        05160000
              PERFORM 4051-BE01F500-WRITE     THRU 4051-EXIT            05170000
           END-IF.                                                      05180000
                                                                        05190000
       4050-EXIT.                                                       05200000
           EXIT.                                                        05210000
                                                                        05220000
                                                                        05230000
      **********************************************************        05240000
       4051-BE01F500-WRITE.                                             05250000
      **********************************************************        05260000
                                                                        05270000
           IF BE01F500-IDNO(1:1) = 'S' OR 'T'                           05280000
               MOVE 'UIN'            TO   BE01F500-IDNO-TYPE            05290000
           ELSE                                                         05300000
             IF BE01F500-IDNO(1:1) = 'G' OR 'F' OR 'M'                  05310001
               MOVE 'FIN'          TO   BE01F500-IDNO-TYPE              05320000
             ELSE                                                       05330000
               GO TO 4051-EXIT                                          05340000
             END-IF                                                     05350000
           END-IF.                                                      05360000
                                                                        05370000
           MOVE WS-SYSTEM-DATE            TO BE01F500-DATE-FIRST-SENT.  05380000
           MOVE  'BP13'                   TO  BE01F500-SOURCE.          05390000
           MOVE  'N'                      TO  BE01F500-DB-TAG.          05400000
           MOVE FB78-NUM-REGN          TO   BE01F500-REF-NO(1:8).       05410000
           WRITE BE01F500-REC.                                          05420000
           ADD   +1                    TO   WS-F500-WRITE-CTR.          05430000
                                                                        05440000
       4051-EXIT.                                                       05450000
           EXIT.                                                        05460000
                                                                        05470000
                                                                        05480000
      **********************************************************        05490000
       4150-MOVE-SPOU-NRIC.                                             05500000
      **********************************************************        05510000
      *--------------------------------------------------------*        05520000
      * GET THE SPOUSE NRIC FROM FB78 AND MOVE TO F825         *        05530000
      *--------------------------------------------------------*        05540000
           MOVE SPACES  TO WS-TEMP-NRIC-SPOUSE.                         05550000
                                                                        05560000
           EVALUATE TRUE                                                05570000
           WHEN WS-OCC-REL = '20'                                       05580000
      *    ---MOVE THE HUSBUND NRIC TO WIFE'S    SPOUSE-NRIC FIELD      05590000
                MOVE FB78-NUM-APPLT1-UIN  TO WS-TEMP-NRIC-SPOUSE        05600000
                                                                        05610000
           WHEN WS-OCC-REL = '00'                                       05620000
      *    ---MOVE THE WIFE OR FIANCE NRIC TO HUSBUND'S SPOUSE-NRIC     05630000
                MOVE '20'                 TO WS-TMP-REL                 05640000
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                05650000
                                                                        05660000
           WHEN WS-OCC-REL = '02'                                       05670000
      *    ---MOVE THE MOTHER  NRIC TO FATHER'S  SPOUSE-NRIC FIELD      05680000
                MOVE '12'                 TO WS-TMP-REL                 05690000
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                05700000
                                                                        05710000
           WHEN WS-OCC-REL = '12'                                       05720000
      *    ---MOVE THE FATHER  NRIC TO MOTHER'S  SPOUSE-NRIC FIELD      05730000
                MOVE '02'                 TO WS-TMP-REL                 05740000
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                05750000
                                                                        05760000
           WHEN WS-OCC-REL = '32'                                       05770000
      *    ---MOVE THE FATHER-IN-LAW NRIC TO MOTHER'S  SPOUSE-NRIC      05780000
                MOVE '22'                 TO WS-TMP-REL                 05790000
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                05800000
                                                                        05810000
           WHEN WS-OCC-REL = '22'                                       05820000
      *    ---MOVE THE MOTHER-IN-LAW NRIC TO MOTHER'S  SPOUSE-NRIC      05830000
                MOVE '32'                 TO WS-TMP-REL                 05840000
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                05850000
                                                                        05860000
           WHEN WS-OCC-REL = '98'                                       05870000
      *    ---MOVE THE PARENTS NRIC                                     05880000
                MOVE '98'                 TO WS-TMP-REL                 05890000
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                05900000
                                                                        05910000
           WHEN WS-OCC-REL = '01'                                       05920000
      *    ---MOVE THE MOTHER-IN-LAW NRIC                               05930000
                MOVE '01'                 TO WS-TMP-REL                 05940000
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                05950000
                                                                        05960000
           WHEN WS-OCC-REL = '97'                                       05970000
      *    ---MOVE THE MOTHER-IN-LAW NRIC                               05980000
                MOVE '97'                 TO WS-TMP-REL                 05990000
                PERFORM 4175-GET-SPOUSE   THRU 4175-EXIT                06000000
                                                                        06010000
           END-EVALUATE.                                                06020000
                                                                        06030000
       4150-EXIT.                                                       06040000
           EXIT.                                                        06050000
                                                                        06060000
                                                                        06070000
      **********************************************************        06080000
       4175-GET-SPOUSE.                                                 06090000
      **********************************************************        06100000
      *--------------------------------------------------------*        06110000
      * GET THE SPOUSE NRIC FROM FB78 AND MOVE TO F825         *        06120000
      *--------------------------------------------------------*        06130000
           EVALUATE TRUE                                                06140000
           WHEN FB78-NUM-APPLT2-RLTNSP-APPLT1 = WS-TMP-REL AND          06150000
                FB78-NUM-APPLT2-UIN NOT = WS-TEMP-NRIC                  06160000
                MOVE FB78-NUM-APPLT2-UIN TO WS-TEMP-NRIC-SPOUSE         06170000
                                                                        06180000
           WHEN FB78-NUM-APPLT3-RLTNSP-APPLT1 = WS-TMP-REL AND          06190000
                FB78-NUM-APPLT3-UIN NOT = WS-TEMP-NRIC                  06200000
                MOVE FB78-NUM-APPLT3-UIN TO WS-TEMP-NRIC-SPOUSE         06210000
                                                                        06220000
           WHEN FB78-NUM-APPLT4-RLTNSP-APPLT1 = WS-TMP-REL AND          06230000
                FB78-NUM-APPLT4-UIN NOT = WS-TEMP-NRIC                  06240000
                MOVE FB78-NUM-APPLT4-UIN TO WS-TEMP-NRIC-SPOUSE         06250000
                                                                        06260000
           WHEN FB78-NUM-OCCUP1-RLTNSP-APPLT1 = WS-TMP-REL AND          06270000
                FB78-NUM-OCCUP1-UIN NOT = WS-TEMP-NRIC                  06280000
                MOVE FB78-NUM-OCCUP1-UIN  TO WS-TEMP-NRIC-SPOUSE        06290000
                                                                        06300000
           WHEN FB78-NUM-OCCUP2-RLTNSP-APPLT1 = WS-TMP-REL AND          06310000
                FB78-NUM-OCCUP2-UIN NOT = WS-TEMP-NRIC                  06320000
                MOVE FB78-NUM-OCCUP2-UIN  TO WS-TEMP-NRIC-SPOUSE        06330000
                                                                        06340000
           WHEN FB78-NUM-OCCUP3-RLTNSP-APPLT1 = WS-TMP-REL AND          06350000
                FB78-NUM-OCCUP3-UIN NOT = WS-TEMP-NRIC                  06360000
                MOVE FB78-NUM-OCCUP3-UIN  TO WS-TEMP-NRIC-SPOUSE        06370000
                                                                        06380000
           WHEN FB78-NUM-OCCUP4-RLTNSP-APPLT1 = WS-TMP-REL AND          06390000
                FB78-NUM-OCCUP4-UIN NOT = WS-TEMP-NRIC                  06400000
                MOVE FB78-NUM-OCCUP4-UIN  TO WS-TEMP-NRIC-SPOUSE        06410000
                                                                        06420000
           WHEN FB78-NUM-OCCUP5-RLTNSP-APPLT1 = WS-TMP-REL AND          06430000
                FB78-NUM-OCCUP5-UIN NOT = WS-TEMP-NRIC                  06440000
                MOVE FB78-NUM-OCCUP5-UIN  TO WS-TEMP-NRIC-SPOUSE        06450000
                                                                        06460000
           WHEN FB78-NUM-OCCUP6-RLTNSP-APPLT1 = WS-TMP-REL AND          06470000
                FB78-NUM-OCCUP6-UIN NOT = WS-TEMP-NRIC                  06480000
                MOVE FB78-NUM-OCCUP6-UIN  TO WS-TEMP-NRIC-SPOUSE        06490000
                                                                        06500000
           WHEN FB78-NUM-OCCUP7-RLTNSP-APPLT1 = WS-TMP-REL AND          06510000
                FB78-NUM-OCCUP7-UIN NOT = WS-TEMP-NRIC                  06520000
                MOVE FB78-NUM-OCCUP7-UIN  TO WS-TEMP-NRIC-SPOUSE        06530000
                                                                        06540000
           WHEN FB78-NUM-OCCUP8-RLTNSP-APPLT1 = WS-TMP-REL AND          06550000
                FB78-NUM-OCCUP8-UIN NOT = WS-TEMP-NRIC                  06560000
                MOVE FB78-NUM-OCCUP8-UIN  TO WS-TEMP-NRIC-SPOUSE        06570000
                                                                        06580000
           END-EVALUATE.                                                06590000
                                                                        06600000
       4175-EXIT.                                                       06610000
           EXIT.                                                        06620000
                                                                        06630000
                                                                        06640000
      **********************************************************        06650000
       4200-BP13F825-WRITE.                                             06660000
      **********************************************************        06670000
           MOVE SPACES               TO BP13F825-REC.                   06680000
           MOVE ZEROS                TO F825-AMT-INCOME                 06690000
                                        F825-AMT-INCOME-TP.             06700000
                                                                        06710000
           MOVE WS-TEMP-REGN         TO F825-NUM-REGN.                  06720000
           MOVE WS-TEMP-NAME         TO F825-NME-OCCP.                  06730000
           MOVE WS-TEMP-DTE-BIRTH    TO F825-DTE-BIRTH.                 06740000
           IF WS-TEMP-NRIC(1:1) = '-'                                   06750000
              MOVE 'X'                  TO F825-NUM-NRIC(1:1)           06760000
              MOVE WS-TEMP-NRIC(2:8)    TO F825-NUM-NRIC(2:8)           06770000
           ELSE                                                         06780000
              MOVE WS-TEMP-NRIC         TO F825-NUM-NRIC.               06790000
                                                                        06800000
           PERFORM 4270-CONVERT-SEX-RACE-MSTATUS THRU 4270-EXIT.        06810000
                                                                        06820000
           MOVE WS-TEMP-INCOME       TO F825-AMT-INCOME.                06830000
           MOVE WS-TEMP-CITIZENSHIP  TO F825-NUM-CITIZENSHIP.           06840000
           MOVE WS-TEMP-RELATIONSHIP TO F825-NUM-RELATIONSHIP.          06850000
           MOVE WS-TEMP-LESSEE       TO F825-NUM-LESSEE-CHECK.          06860000
           IF WS-TEMP-NRIC-SPOUSE(1:1) = '-'                            06870000
             MOVE 'X'                      TO F825-NUM-NRIC-SPOUSE(1:1) 06880000
             MOVE WS-TEMP-NRIC-SPOUSE(2:8) TO F825-NUM-NRIC-SPOUSE(2:8) 06890000
           ELSE                                                         06900000
              MOVE WS-TEMP-NRIC-SPOUSE     TO F825-NUM-NRIC-SPOUSE.     06910000
                                                                        06920000
           MOVE WS-TEMP-EDN-LVL      TO WS-TMP-EDN.                     06930000
           ADD +1                    TO WS-TMP-EDN.                     06940000
           MOVE WS-TMP-EDN           TO F825-NUM-EDUCATION.             06950000
                                                                        06960000
           MOVE WS-TEMP-PHONE        TO F825-NUM-PHONE.                 06970000
           MOVE WS-TEMP-HP-PAGER     TO F825-NUM-HP-PGR.                06980000
           MOVE WS-CURRENT-DATE      TO F825-DTE-UPDATE.                06990000
           MOVE 'P13C9CB'            TO F825-NUM-USERID.                07000000
                                                                        07010000
           WRITE BP13F825-REC.                                          07020000
           ADD  +1                   TO WS-F825-WRITE-CTR.              07030000
                                                                        07040000
       4200-EXIT.                                                       07050000
           EXIT.                                                        07060000
                                                                        07070000
                                                                        07080000
      **********************************************************        07090000
       4250-WRITE-CO-APPL.                                              07100000
      **********************************************************        07110000
      *    MOVE SPACES                            TO WS-TEMP-RACE       07120000
      *                                              WS-TEMP-SEX.       07130000
      *------------> CO-APPLICANT  1                                    07140000
           IF FB78-NUM-APPLT2-UIN NOT = SPACES AND LOW-VALUES           07150000
              MOVE FB78-NUM-APPLT2-UIN            TO WS-TEMP-NRIC       07160000
              MOVE FB78-NME-APPLT2                TO WS-TEMP-NAME       07170000
              MOVE FB78-DTE-APPLT2-BIRTH          TO WS-TEMP-DTE-BIRTH  07180000
              MOVE FB78-AMT-APPLT2-INCOME         TO WS-TEMP-INCOME     07190000
              MOVE FB78-NUM-APPLT2-RACE           TO WS-TEMP-RACE       07200000
              MOVE FB78-NUM-APPLT2-SEX            TO WS-TEMP-SEX        07210000
              MOVE FB78-NUM-APPLT2-MARITAL-STATUS TO WS-TEMP-MSTATUS    07220000
              MOVE FB78-NUM-APPLT2-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 07230000
              MOVE FB78-NUM-APPLT2-RLTNSP-APPLT1 TO WS-TEMP-RELATIONSHIP07240000
                                                    WS-OCC-REL          07250000
              MOVE FB78-NUM-APPLT2-EDN-LVL       TO WS-TEMP-EDN-LVL     07260000
              MOVE FB78-NUM-APPLT2-PHONE         TO WS-TEMP-PHONE       07270000
              MOVE FB78-NUM-APPLT2-HP-PAGER      TO WS-TEMP-HP-PAGER    07280000
              MOVE 'Y'                           TO WS-TEMP-LESSEE      07290000
                                                                        07300000
              PERFORM 4150-MOVE-SPOU-NRIC THRU 4150-EXIT                07310000
                                                                        07320000
              PERFORM 4200-BP13F825-WRITE      THRU 4200-EXIT           07330000
           END-IF.                                                      07340000
                                                                        07350000
      *------------> CO-APPLICANT  2                                    07360000
           IF FB78-NUM-APPLT3-UIN NOT = SPACES  AND LOW-VALUES          07370000
              MOVE FB78-NUM-APPLT3-UIN            TO WS-TEMP-NRIC       07380000
              MOVE FB78-NME-APPLT3                TO WS-TEMP-NAME       07390000
              MOVE FB78-DTE-APPLT3-BIRTH          TO WS-TEMP-DTE-BIRTH  07400000
              MOVE FB78-AMT-APPLT3-INCOME         TO WS-TEMP-INCOME     07410000
              MOVE FB78-NUM-APPLT3-RACE           TO WS-TEMP-RACE       07420000
              MOVE FB78-NUM-APPLT3-SEX            TO WS-TEMP-SEX        07430000
              MOVE FB78-NUM-APPLT3-MARITAL-STATUS TO WS-TEMP-MSTATUS    07440000
              MOVE FB78-NUM-APPLT3-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 07450000
              MOVE FB78-NUM-APPLT3-RLTNSP-APPLT1 TO WS-TEMP-RELATIONSHIP07460000
                                                    WS-OCC-REL          07470000
              MOVE FB78-NUM-APPLT3-EDN-LVL       TO WS-TEMP-EDN-LVL     07480000
              MOVE FB78-NUM-APPLT3-PHONE         TO WS-TEMP-PHONE       07490000
              MOVE FB78-NUM-APPLT3-HP-PAGER      TO WS-TEMP-HP-PAGER    07500000
              MOVE 'Y'                           TO WS-TEMP-LESSEE      07510000
              PERFORM 4150-MOVE-SPOU-NRIC THRU 4150-EXIT                07520000
                                                                        07530000
              PERFORM 4200-BP13F825-WRITE      THRU 4200-EXIT           07540000
           END-IF.                                                      07550000
                                                                        07560000
      *------------> CO-APPLICANT  3                                    07570000
           IF FB78-NUM-APPLT4-UIN NOT = SPACES AND LOW-VALUES           07580000
              MOVE FB78-NUM-APPLT4-UIN            TO WS-TEMP-NRIC       07590000
              MOVE FB78-NME-APPLT4                TO WS-TEMP-NAME       07600000
              MOVE FB78-DTE-APPLT4-BIRTH          TO WS-TEMP-DTE-BIRTH  07610000
              MOVE FB78-AMT-APPLT4-INCOME         TO WS-TEMP-INCOME     07620000
              MOVE FB78-NUM-APPLT4-RACE           TO WS-TEMP-RACE       07630000
              MOVE FB78-NUM-APPLT4-SEX            TO WS-TEMP-SEX        07640000
              MOVE FB78-NUM-APPLT4-MARITAL-STATUS TO WS-TEMP-MSTATUS    07650000
              MOVE FB78-NUM-APPLT4-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 07660000
              MOVE FB78-NUM-APPLT4-RLTNSP-APPLT1 TO WS-TEMP-RELATIONSHIP07670000
                                                    WS-OCC-REL          07680000
              MOVE FB78-NUM-APPLT4-EDN-LVL       TO WS-TEMP-EDN-LVL     07690000
              MOVE FB78-NUM-APPLT4-PHONE         TO WS-TEMP-PHONE       07700000
              MOVE FB78-NUM-APPLT4-HP-PAGER      TO WS-TEMP-HP-PAGER    07710000
              MOVE 'Y'                           TO WS-TEMP-LESSEE      07720000
              PERFORM 4150-MOVE-SPOU-NRIC THRU 4150-EXIT                07730000
                                                                        07740000
              PERFORM 4200-BP13F825-WRITE      THRU 4200-EXIT           07750000
           END-IF.                                                      07760000
                                                                        07770000
       4250-EXIT.                                                       07780000
           EXIT.                                                        07790000
                                                                        07800000
                                                                        07810000
      **********************************************************        07820000
       4260-WRITE-OCCUP.                                                07830000
      **********************************************************        07840000
           MOVE SPACES                          TO WS-TEMP-NRIC-SPOUSE. 07850000
                                                                        07860000
      *------------> OCCUPANT  1                                        07870000
           IF FB78-NUM-OCCUP1-UIN NOT = SPACES AND LOW-VALUES           07880000
              MOVE FB78-NUM-OCCUP1-UIN            TO WS-TEMP-NRIC       07890000
              MOVE FB78-NME-OCCUP1                TO WS-TEMP-NAME       07900000
              MOVE FB78-DTE-OCCUP1-BIRTH          TO WS-TEMP-DTE-BIRTH  07910000
              MOVE FB78-AMT-OCCUP1-INCOME         TO WS-TEMP-INCOME     07920000
              MOVE FB78-NUM-OCCUP1-MARITAL-STATUS TO WS-TEMP-MSTATUS    07930000
              MOVE FB78-NUM-OCCUP1-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 07940000
              MOVE FB78-NUM-OCCUP1-RLTNSP-APPLT1 TO                     07950000
                                                   WS-TEMP-RELATIONSHIP 07960000
                                                   WS-OCC-REL           07970000
              MOVE FB78-NUM-OCCUP1-RACE         TO WS-TEMP-RACE         07980000
              MOVE FB78-NUM-OCCUP1-SEX          TO WS-TEMP-SEX          07990000
              MOVE SPACES                       TO WS-TEMP-LESSEE       08000000
              MOVE FB78-NUM-OCCUP1-EDN-LVL      TO WS-TEMP-EDN-LVL      08010000
              MOVE FB78-NUM-OCCUP1-PHONE        TO WS-TEMP-PHONE        08020000
              MOVE FB78-NUM-OCCUP1-HP-PAGER     TO WS-TEMP-HP-PAGER     08030000
                                                                        08040000
              PERFORM 4150-MOVE-SPOU-NRIC     THRU 4150-EXIT            08050000
              PERFORM 4200-BP13F825-WRITE     THRU 4200-EXIT            08060000
           END-IF.                                                      08070000
                                                                        08080000
      *------------> OCCUPANT  2                                        08090000
           IF FB78-NUM-OCCUP2-UIN NOT = SPACES AND LOW-VALUES           08100000
              MOVE FB78-NUM-OCCUP2-UIN            TO WS-TEMP-NRIC       08110000
              MOVE FB78-NME-OCCUP2                TO WS-TEMP-NAME       08120000
              MOVE FB78-DTE-OCCUP2-BIRTH          TO WS-TEMP-DTE-BIRTH  08130000
              MOVE FB78-AMT-OCCUP2-INCOME         TO WS-TEMP-INCOME     08140000
              MOVE FB78-NUM-OCCUP2-MARITAL-STATUS TO WS-TEMP-MSTATUS    08150000
              MOVE FB78-NUM-OCCUP2-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 08160000
              MOVE FB78-NUM-OCCUP2-RLTNSP-APPLT1 TO                     08170000
                                                   WS-TEMP-RELATIONSHIP 08180000
                                                   WS-OCC-REL           08190000
              MOVE FB78-NUM-OCCUP2-RACE         TO WS-TEMP-RACE         08200000
              MOVE FB78-NUM-OCCUP2-SEX          TO WS-TEMP-SEX          08210000
              MOVE SPACES                       TO WS-TEMP-LESSEE       08220000
              MOVE FB78-NUM-OCCUP2-EDN-LVL      TO WS-TEMP-EDN-LVL      08230000
              MOVE FB78-NUM-OCCUP2-PHONE        TO WS-TEMP-PHONE        08240000
              MOVE FB78-NUM-OCCUP2-HP-PAGER     TO WS-TEMP-HP-PAGER     08250000
                                                                        08260000
              PERFORM 4150-MOVE-SPOU-NRIC     THRU 4150-EXIT            08270000
              PERFORM 4200-BP13F825-WRITE     THRU 4200-EXIT            08280000
           END-IF.                                                      08290000
                                                                        08300000
      *------------> OCCUPANT  3                                        08310000
           IF FB78-NUM-OCCUP3-UIN NOT = SPACES AND LOW-VALUES           08320000
              MOVE FB78-NUM-OCCUP3-UIN            TO WS-TEMP-NRIC       08330000
              MOVE FB78-NME-OCCUP3                TO WS-TEMP-NAME       08340000
              MOVE FB78-DTE-OCCUP3-BIRTH          TO WS-TEMP-DTE-BIRTH  08350000
              MOVE FB78-AMT-OCCUP3-INCOME         TO WS-TEMP-INCOME     08360000
              MOVE FB78-NUM-OCCUP3-MARITAL-STATUS TO WS-TEMP-MSTATUS    08370000
              MOVE FB78-NUM-OCCUP3-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 08380000
              MOVE FB78-NUM-OCCUP3-RLTNSP-APPLT1 TO                     08390000
                                                   WS-TEMP-RELATIONSHIP 08400000
                                                   WS-OCC-REL           08410000
              MOVE FB78-NUM-OCCUP3-RACE         TO WS-TEMP-RACE         08420000
              MOVE FB78-NUM-OCCUP3-SEX          TO WS-TEMP-SEX          08430000
              MOVE SPACES                       TO WS-TEMP-LESSEE       08440000
              MOVE FB78-NUM-OCCUP3-EDN-LVL      TO WS-TEMP-EDN-LVL      08450000
              MOVE FB78-NUM-OCCUP3-PHONE        TO WS-TEMP-PHONE        08460000
              MOVE FB78-NUM-OCCUP3-HP-PAGER     TO WS-TEMP-HP-PAGER     08470000
                                                                        08480000
              PERFORM 4150-MOVE-SPOU-NRIC     THRU 4150-EXIT            08490000
              PERFORM 4200-BP13F825-WRITE     THRU 4200-EXIT            08500000
           END-IF.                                                      08510000
                                                                        08520000
      *------------> OCCUPANT  4                                        08530000
           IF FB78-NUM-OCCUP4-UIN NOT = SPACES AND LOW-VALUES           08540000
              MOVE FB78-NUM-OCCUP4-UIN            TO WS-TEMP-NRIC       08550000
              MOVE FB78-NME-OCCUP4                TO WS-TEMP-NAME       08560000
              MOVE FB78-DTE-OCCUP4-BIRTH          TO WS-TEMP-DTE-BIRTH  08570000
              MOVE FB78-AMT-OCCUP4-INCOME         TO WS-TEMP-INCOME     08580000
              MOVE FB78-NUM-OCCUP4-MARITAL-STATUS TO WS-TEMP-MSTATUS    08590000
              MOVE FB78-NUM-OCCUP4-CITIZENSHIP  TO WS-TEMP-CITIZENSHIP  08600000
              MOVE FB78-NUM-OCCUP4-RLTNSP-APPLT1 TO                     08610000
                                                   WS-TEMP-RELATIONSHIP 08620000
                                                   WS-OCC-REL           08630000
              MOVE FB78-NUM-OCCUP4-RACE         TO WS-TEMP-RACE         08640000
              MOVE FB78-NUM-OCCUP4-SEX          TO WS-TEMP-SEX          08650000
              MOVE SPACES                       TO WS-TEMP-LESSEE       08660000
              MOVE FB78-NUM-OCCUP4-EDN-LVL      TO WS-TEMP-EDN-LVL      08670000
              MOVE FB78-NUM-OCCUP4-PHONE        TO WS-TEMP-PHONE        08680000
              MOVE FB78-NUM-OCCUP4-HP-PAGER     TO WS-TEMP-HP-PAGER     08690000
                                                                        08700000
              PERFORM 4150-MOVE-SPOU-NRIC     THRU 4150-EXIT            08710000
              PERFORM 4200-BP13F825-WRITE     THRU 4200-EXIT            08720000
           END-IF.                                                      08730000
                                                                        08740000
      *------------> OCCUPANT  5                                        08750000
           IF FB78-NUM-OCCUP5-UIN NOT = SPACES AND LOW-VALUES           08760000
              MOVE FB78-NUM-OCCUP5-UIN            TO WS-TEMP-NRIC       08770000
              MOVE FB78-NME-OCCUP5                TO WS-TEMP-NAME       08780000
              MOVE FB78-DTE-OCCUP5-BIRTH          TO WS-TEMP-DTE-BIRTH  08790000
              MOVE FB78-AMT-OCCUP5-INCOME         TO WS-TEMP-INCOME     08800000
              MOVE FB78-NUM-OCCUP5-MARITAL-STATUS TO WS-TEMP-MSTATUS    08810000
              MOVE FB78-NUM-OCCUP5-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 08820000
              MOVE FB78-NUM-OCCUP5-RLTNSP-APPLT1 TO                     08830000
                                                   WS-TEMP-RELATIONSHIP 08840000
                                                   WS-OCC-REL           08850000
              MOVE FB78-NUM-OCCUP5-RACE         TO WS-TEMP-RACE         08860000
              MOVE FB78-NUM-OCCUP5-SEX          TO WS-TEMP-SEX          08870000
              MOVE SPACES                       TO WS-TEMP-LESSEE       08880000
              MOVE FB78-NUM-OCCUP5-EDN-LVL      TO WS-TEMP-EDN-LVL      08890000
              MOVE FB78-NUM-OCCUP5-PHONE        TO WS-TEMP-PHONE        08900000
              MOVE FB78-NUM-OCCUP5-HP-PAGER     TO WS-TEMP-HP-PAGER     08910000
                                                                        08920000
              PERFORM 4150-MOVE-SPOU-NRIC     THRU 4150-EXIT            08930000
              PERFORM 4200-BP13F825-WRITE     THRU 4200-EXIT            08940000
           END-IF.                                                      08950000
                                                                        08960000
      *------------> OCCUPANT  6                                        08970000
           IF FB78-NUM-OCCUP6-UIN NOT = SPACES AND LOW-VALUES           08980000
              MOVE FB78-NUM-OCCUP6-UIN            TO WS-TEMP-NRIC       08990000
              MOVE FB78-NME-OCCUP6                TO WS-TEMP-NAME       09000000
              MOVE FB78-DTE-OCCUP6-BIRTH          TO WS-TEMP-DTE-BIRTH  09010000
              MOVE FB78-AMT-OCCUP6-INCOME         TO WS-TEMP-INCOME     09020000
              MOVE FB78-NUM-OCCUP6-MARITAL-STATUS TO WS-TEMP-MSTATUS    09030000
              MOVE FB78-NUM-OCCUP6-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 09040000
              MOVE FB78-NUM-OCCUP6-RLTNSP-APPLT1 TO                     09050000
                                                   WS-TEMP-RELATIONSHIP 09060000
                                                   WS-OCC-REL           09070000
              MOVE FB78-NUM-OCCUP6-RACE         TO WS-TEMP-RACE         09080000
              MOVE FB78-NUM-OCCUP6-SEX          TO WS-TEMP-SEX          09090000
              MOVE SPACES                       TO WS-TEMP-LESSEE       09100000
              MOVE FB78-NUM-OCCUP6-EDN-LVL      TO WS-TEMP-EDN-LVL      09110000
              MOVE FB78-NUM-OCCUP6-PHONE        TO WS-TEMP-PHONE        09120000
              MOVE FB78-NUM-OCCUP6-HP-PAGER     TO WS-TEMP-HP-PAGER     09130000
                                                                        09140000
              PERFORM 4150-MOVE-SPOU-NRIC     THRU 4150-EXIT            09150000
              PERFORM 4200-BP13F825-WRITE     THRU 4200-EXIT            09160000
           END-IF.                                                      09170000
                                                                        09180000
      *------------> OCCUPANT  7                                        09190000
           IF FB78-NUM-OCCUP7-UIN NOT = SPACES AND LOW-VALUES           09200000
              MOVE FB78-NUM-OCCUP7-UIN            TO WS-TEMP-NRIC       09210000
              MOVE FB78-NME-OCCUP7                TO WS-TEMP-NAME       09220000
              MOVE FB78-DTE-OCCUP7-BIRTH          TO WS-TEMP-DTE-BIRTH  09230000
              MOVE FB78-AMT-OCCUP7-INCOME         TO WS-TEMP-INCOME     09240000
              MOVE FB78-NUM-OCCUP7-MARITAL-STATUS TO WS-TEMP-MSTATUS    09250000
              MOVE FB78-NUM-OCCUP7-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 09260000
              MOVE FB78-NUM-OCCUP7-RLTNSP-APPLT1 TO                     09270000
                                                   WS-TEMP-RELATIONSHIP 09280000
                                                   WS-OCC-REL           09290000
              MOVE FB78-NUM-OCCUP7-RACE         TO WS-TEMP-RACE         09300000
              MOVE FB78-NUM-OCCUP7-SEX          TO WS-TEMP-SEX          09310000
              MOVE SPACES                       TO WS-TEMP-LESSEE       09320000
              MOVE FB78-NUM-OCCUP7-EDN-LVL      TO WS-TEMP-EDN-LVL      09330000
              MOVE FB78-NUM-OCCUP7-PHONE        TO WS-TEMP-PHONE        09340000
              MOVE FB78-NUM-OCCUP7-HP-PAGER     TO WS-TEMP-HP-PAGER     09350000
                                                                        09360000
              PERFORM 4150-MOVE-SPOU-NRIC     THRU 4150-EXIT            09370000
              PERFORM 4200-BP13F825-WRITE     THRU 4200-EXIT            09380000
           END-IF.                                                      09390000
                                                                        09400000
      *------------> OCCUPANT  8                                        09410000
           IF FB78-NUM-OCCUP8-UIN NOT = SPACES AND LOW-VALUES           09420000
              MOVE FB78-NUM-OCCUP8-UIN            TO WS-TEMP-NRIC       09430000
              MOVE FB78-NME-OCCUP8                TO WS-TEMP-NAME       09440000
              MOVE FB78-DTE-OCCUP8-BIRTH          TO WS-TEMP-DTE-BIRTH  09450000
              MOVE FB78-AMT-OCCUP8-INCOME         TO WS-TEMP-INCOME     09460000
              MOVE FB78-NUM-OCCUP8-MARITAL-STATUS TO WS-TEMP-MSTATUS    09470000
              MOVE FB78-NUM-OCCUP8-CITIZENSHIP   TO WS-TEMP-CITIZENSHIP 09480000
              MOVE FB78-NUM-OCCUP8-RLTNSP-APPLT1 TO                     09490000
                                                   WS-TEMP-RELATIONSHIP 09500000
                                                   WS-OCC-REL           09510000
              MOVE FB78-NUM-OCCUP8-RACE         TO WS-TEMP-RACE         09520000
              MOVE FB78-NUM-OCCUP8-SEX          TO WS-TEMP-SEX          09530000
              MOVE SPACES                       TO WS-TEMP-LESSEE       09540000
              MOVE FB78-NUM-OCCUP8-EDN-LVL      TO WS-TEMP-EDN-LVL      09550000
              MOVE FB78-NUM-OCCUP8-PHONE        TO WS-TEMP-PHONE        09560000
              MOVE FB78-NUM-OCCUP8-HP-PAGER     TO WS-TEMP-HP-PAGER     09570000
                                                                        09580000
              PERFORM 4150-MOVE-SPOU-NRIC     THRU 4150-EXIT            09590000
              PERFORM 4200-BP13F825-WRITE     THRU 4200-EXIT            09600000
           END-IF.                                                      09610000
                                                                        09620000
       4260-EXIT.                                                       09630000
           EXIT.                                                        09640000
                                                                        09650000
      **********************************************************        09660000
       4270-CONVERT-SEX-RACE-MSTATUS.                                   09670000
      **********************************************************        09680000
                                                                        09690000
           IF WS-TEMP-SEX = 'M'                                         09700000
              MOVE '1' TO F825-NUM-SEX                                  09710000
           ELSE                                                         09720000
           IF WS-TEMP-SEX = 'F'                                         09730000
              MOVE '2' TO F825-NUM-SEX                                  09740000
           END-IF.                                                      09750000
                                                                        09760000
           IF WS-TEMP-MSTATUS = 'S'                                     09770000
             MOVE '1' TO F825-NUM-MARITAL-STATUS                        09780000
           ELSE                                                         09790000
           IF WS-TEMP-MSTATUS = 'O'                                     09800000
             MOVE '1' TO F825-NUM-MARITAL-STATUS                        09810000
           ELSE                                                         09820000
           IF WS-TEMP-MSTATUS = 'M'                                     09830000
             MOVE '2' TO F825-NUM-MARITAL-STATUS                        09840000
           ELSE                                                         09850000
           IF WS-TEMP-MSTATUS = 'W'                                     09860000
             MOVE '3' TO F825-NUM-MARITAL-STATUS                        09870000
           ELSE                                                         09880000
           IF WS-TEMP-MSTATUS = 'D'                                     09890000
             MOVE '4' TO F825-NUM-MARITAL-STATUS                        09900000
           ELSE                                                         09910000
           IF WS-TEMP-MSTATUS = 'P'                                     09920000
             MOVE '5' TO F825-NUM-MARITAL-STATUS                        09930000
           END-IF.                                                      09940000
                                                                        09950000
           IF WS-TEMP-RACE = 'C'                                        09960000
              MOVE '0' TO F825-NUM-ETHNIC                               09970000
           ELSE                                                         09980000
           IF WS-TEMP-RACE = 'M'                                        09990000
              MOVE '5' TO F825-NUM-ETHNIC                               10000000
           ELSE                                                         10010000
           IF WS-TEMP-RACE = 'I'                                        10020000
              MOVE '6' TO F825-NUM-ETHNIC                               10030000
           ELSE                                                         10040000
           IF WS-TEMP-RACE = 'O'                                        10050000
              MOVE '7' TO F825-NUM-ETHNIC                               10060000
           END-IF.                                                      10070000
                                                                        10080000
       4270-EXIT.                                                       10090000
           EXIT.                                                        10100000
                                                                        10110000
                                                                        10120000
      **********************************************************        10130000
       4300-BP13F730-WRITE.                                             10140000
      **********************************************************        10150000
           MOVE SPACES                      TO BP13F730-REC.            10160000
           MOVE ZEROS                       TO F730-NUM-WAIT-TIME       10170000
                                               F730-NUM-JB-CNT          10180000
                                               F730-NUM-BALLOT-POSITION.10190000
                                                                        10200000
           MOVE FB78-NUM-REGN               TO F730-NUM-REF.            10210000
           MOVE FB78-NUM-REGN               TO F730-NUM-REGN.           10220000
                                                                        10230000
           IF FB78-NUM-REGN(1:1) = '5'                                  10240000
              MOVE 'DBS'                       TO F730-NUM-ALLO-CAT     10250000
           ELSE                                                         10260000
              MOVE 'EC '                       TO F730-NUM-ALLO-CAT     10270000
              IF FB78-NUM-HH NOT = SPACES AND LOW-VALUES                10280000
                 MOVE FB78-NUM-HH           TO F730-CDE-HOUSEHOLD       10290000
              END-IF                                                    10300000
           END-IF.                                                      10310000
                                                                        10320000
           MOVE 'NN'                        TO F730-NUM-REQUEST-REASON. 10330000
                                                                        10340000
           IF FB78-NUM-APPLT1-UIN(1:1) = '-'                            10350000
              MOVE 'X'                      TO F730-NUM-NRIC1(1:1)      10360000
              MOVE FB78-NUM-APPLT1-UIN(2:8) TO F730-NUM-NRIC1(2:8)      10370000
           ELSE                                                         10380000
              MOVE FB78-NUM-APPLT1-UIN      TO F730-NUM-NRIC1.          10390000
                                                                        10400000
           IF FB78-NUM-APPLT2-UIN NOT = SPACES                          10410000
              IF FB78-NUM-APPLT2-UIN(1:1) = '-'                         10420000
                 MOVE 'X'                      TO F730-NUM-NRIC2(1:1)   10430000
                 MOVE FB78-NUM-APPLT2-UIN(2:8) TO F730-NUM-NRIC2(2:8)   10440000
              ELSE                                                      10450000
                 MOVE FB78-NUM-APPLT2-UIN      TO F730-NUM-NRIC2        10460000
              END-IF                                                    10470000
           ELSE                                                         10480000
              MOVE '##'                     TO F730-NUM-NRIC2(1:2)      10490000
              MOVE FB78-NUM-APPLT1-UIN(3:7) TO F730-NUM-NRIC2(3:7)      10500000
           END-IF.                                                      10510000
                                                                        10520000
           IF FB78-NUM-APPLT3-UIN NOT = SPACES                          10530000
              IF FB78-NUM-APPLT3-UIN(1:1) = '-'                         10540000
                 MOVE 'X'                      TO F730-NUM-NRIC3(1:1)   10550000
                 MOVE FB78-NUM-APPLT3-UIN(2:8) TO F730-NUM-NRIC3(2:8)   10560000
              ELSE                                                      10570000
                 MOVE FB78-NUM-APPLT3-UIN      TO F730-NUM-NRIC3        10580000
              END-IF                                                    10590000
           ELSE                                                         10600000
              MOVE '##'                     TO F730-NUM-NRIC3(1:2)      10610000
              MOVE FB78-NUM-APPLT1-UIN(3:7) TO F730-NUM-NRIC3(3:7)      10620000
           END-IF.                                                      10630000
                                                                        10640000
           IF FB78-NUM-APPLT4-UIN NOT = SPACES                          10650000
              IF FB78-NUM-APPLT4-UIN(1:1) = '-'                         10660000
                 MOVE 'X'                      TO F730-NUM-NRIC4(1:1)   10670000
                 MOVE FB78-NUM-APPLT4-UIN(2:8) TO F730-NUM-NRIC4(2:8)   10680000
              ELSE                                                      10690000
                 MOVE FB78-NUM-APPLT4-UIN      TO F730-NUM-NRIC4        10700000
              END-IF                                                    10710000
           ELSE                                                         10720000
              MOVE '##'                     TO F730-NUM-NRIC4(1:2)      10730000
              MOVE FB78-NUM-APPLT1-UIN(3:7) TO F730-NUM-NRIC4(3:7)      10740000
           END-IF.                                                      10750000
                                                                        10760000
           IF (FB78-NUM-OWN-PTE-PRTY = 'Y' OR                           10770000
               FB78-NUM-DISPOSED-PTE-PRTY = 'Y' OR                      10780000
               FB78-NUM-OWN-PRVTE-PRPRTY = 'Y' OR                       10790000
              (FB78-NUM-OWN-FLAT = 'N' AND                              10800000
               FB78-NUM-OWN-FLAT-TYPE = '1'))                           10810000
              MOVE 'Y'                      TO F730-NUM-PPO             10820000
           ELSE                                                         10830000
              MOVE SPACES                   TO F730-NUM-PPO             10840000
           END-IF.                                                      10850000
                                                                        10860000
           MOVE FB78-NUM-NEW-TOWN           TO F730-CDE-NT1.            10870000
                                                                        10880000
           MOVE FB78-NUM-LOAN-TAG           TO F730-NUM-LOAN-TAG.       10890000
                                                                        10900000
      *** MOVE SPACE TO NT2 FOR AUG 2003 BTO. CHOICE2 USED AS FLAT-TYPE 10910000
                                                                        10920000
           MOVE SPACES                      TO F730-CDE-NT2.            10930000
           MOVE 'N'                         TO F730-CDE-NT-WITH-LAND.   10940000
           MOVE SPACES                      TO F730-CDE-JB-PARENT       10950000
                                               F730-NUM-MCPS.           10960000
                                                                        10970000
      *** READ FLAT TYPE FOR AUG 2003 BTO FROM CHOICE2                  10980000
           MOVE FB78-NUM-FLAT-TYPE          TO F730-CDE-FLAT-TYPE.      10990000
                                                                        11000000
           MOVE FB78-CDE-ELIG-SCH           TO F730-CDE-ELIG-SCH.       11010000
           MOVE FB78-CDE-ALLOC-SCH          TO F730-CDE-ALLOC-SCH.      11020000
      *    IF FB78-NUM-MCP-PRIORITY NOT = SPACES AND LOW-VALUES AND     11030000
      *                                  'M' AND 'P' AND 'C'            11040000
      *       MOVE FB78-NUM-SPEC-SCHEME     TO F730-CDE-ALLOC-SCH       11050000
      *    ELSE                                                         11060000
      *       MOVE FB78-CDE-ALLOC-SCH       TO F730-CDE-ALLOC-SCH       11070000
      *    END-IF.                                                      11080000
                                                                        11090000
           IF FB78-CDE-ALLOC-SCH = 'TCP'                                11100000
              MOVE 'TCP'                    TO F730-CDE-ELIG-SCH        11110000
              MOVE 'TCP'                    TO F730-CDE-ALLOC-SCH       11120000
           END-IF.                                                      11130000
                                                                        11140000
           EVALUATE F730-CDE-ALLOC-SCH                                  11150000
           WHEN 'JB'                                                    11160000
             MOVE         '1' TO F730-CDE-JB                            11170000
           WHEN 'MT'                                                    11180000
           WHEN 'MTS'                                                   11190000
             MOVE         '4' TO F730-CDE-JB                            11200000
           WHEN 'TCP'                                                   11210000
             MOVE         '9' TO F730-CDE-JB                            11220000
           WHEN OTHER                                                   11230000
             MOVE         '0' TO F730-CDE-JB                            11240000
           END-EVALUATE.                                                11250000
                                                                        11260000
      **  READ MCPS RES NRIC1 FOR DUXTON PLAIN BTO FROM NUM-PRSN1-UIN   11270000
           IF (FB78-NUM-MCP-PRIORITY = 'C' OR 'P') AND                  11280000
              (FB78-NUM-CHILD1-PARENT-UIN NOT = SPACES)                 11290000
              MOVE FB78-NUM-CHILD1-PARENT-UIN TO F730-NUM-RES-NRIC1.    11300000
                                                                        11310000
      **  READ MCPS RES NRIC2 FOR DUXTON PLAIN BTO FROM NUM-PRSN2-UIN   11320000
           IF (FB78-NUM-MCP-PRIORITY = 'C' OR 'P') AND                  11330000
              (FB78-NUM-CHILD2-PARENT-UIN NOT = SPACES)                 11340000
              MOVE FB78-NUM-CHILD2-PARENT-UIN TO F730-NUM-RES-NRIC2.    11350000
                                                                        11360000
      **  MOVE MCPS CODE TO F730-NUM-MCPS FOR 'C', 'P' OR 'M'           11370000
           IF FB78-NUM-MCP-PRIORITY = 'C' OR 'P' OR 'M'                 11380000
              MOVE FB78-NUM-MCP-PRIORITY    TO F730-NUM-MCPS.           11390000
                                                                        11400000
      **  MOVE MCPS POSTAL CODE TO F730-NUM-MCPS-POSTAL                 11410000
           IF FB78-NUM-CP-POST = SPACES OR LOW-VALUES                   11420000
              MOVE SPACES               TO F730-NUM-MCPS-POSTAL         11430000
           ELSE                                                         11440000
              MOVE FB78-NUM-CP-POST     TO F730-NUM-MCPS-POSTAL.        11450000
                                                                        11460000
      *---------------------------                                      11470000
      * DECODE IPD SCHEME                                               11480000
      *---------------------------                                      11490000
           MOVE 'Y'                         TO WS-FOUND-SW.             11500000
           MOVE SPACES                      TO WS-DESC.                 11510000
           SET WS-IDP-PTR                   TO 1.                       11520000
                                                                        11530000
           SEARCH WS-IDP-SCH                                            11540000
             AT   END MOVE 'N'              TO   WS-FOUND-SW            11550000
                 WHEN WS-ALC-SCH-CODE (WS-IDP-PTR) = F730-CDE-ALLOC-SCH 11560000
                      MOVE WS-IDP-SCH-CODE (WS-IDP-PTR) TO WS-DESC      11570000
           END-SEARCH.                                                  11580000
                                                                        11590000
           IF  WS-FOUND-SW = 'N'                                        11600000
               MOVE 'PA '                  TO  WS-DESC                  11610000
           END-IF.                                                      11620000
                                                                        11630000
           MOVE WS-DESC                     TO F730-CDE-IDP-SCH.        11640000
                                                                        11650000
           MOVE FB78-DTE-REQUESTED          TO F730-DTE-REQUEST.        11660000
           MOVE 'I'                         TO F730-NUM-APPLN-TYPE.     11670000
           MOVE WS-SYSTEM-DATE              TO F730-DTE-UPDATE.         11680000
           MOVE 'P13C9CB'                   TO F730-NUM-USER-ID.        11690000
                                                                        11700000
      *---------------------------                                      11710000
      * LOAN/AHG/CPF GRANT REQ                                          11720000
      *---------------------------                                      11730000
                                                                        11740000
           MOVE FB78-NUM-APPL-LOAN-REQ      TO F730-NUM-APPL-LOAN-REQ.  11750000
           MOVE FB78-NUM-AHG-REQ            TO F730-NUM-AHG-REQ.        11760000
           MOVE FB78-NUM-CPFHG-REQ          TO F730-NUM-HSGNT-REQ.      11770000
                                                                        11780000
      *------------------------------                                   11790000
      * CATER FOR DIFFERENT PROJ CODE                                   11800000
      *------------------------------                                   11810000
           EVALUATE FB78-NUM-PROJECT                                    11820000
              WHEN 'D01'                                                11830000
                  MOVE '200610'                 TO F730-DTE-BALLOT      11840000
              WHEN 'D02'                                                11850000
                  MOVE '200801'                 TO F730-DTE-BALLOT      11860000
              WHEN 'D03'                                                11870000
                  MOVE '200807'                 TO F730-DTE-BALLOT      11880000
              WHEN 'D04'                                                11890000
                  MOVE '200810'                 TO F730-DTE-BALLOT      11900000
              WHEN 'D05'                                                11910000
                  MOVE '200904'                 TO F730-DTE-BALLOT      11920000
              WHEN 'D06'                                                11930000
                  MOVE '200904'                 TO F730-DTE-BALLOT      11940000
              WHEN 'D07'                                                11950000
                  MOVE '201102'                 TO F730-DTE-BALLOT      11960000
              WHEN 'D08'                                                11970000
                  MOVE '201106'                 TO F730-DTE-BALLOT      11980000
              WHEN OTHER                                                11990000
                  MOVE FB78-DTE-BALLOT          TO F730-DTE-BALLOT      12000000
           END-EVALUATE.                                                12010000
                                                                        12020000
           WRITE BP13F730-REC.                                          12030000
           ADD   +1   TO WS-F730-WRITE-CTR.                             12040000
                                                                        12050000
       4300-EXIT.                                                       12060000
           EXIT.                                                        12070000
                                                                        12080000
                                                                        12090000
      **********************************************************        12100000
       4400-BP13F830-WRITE.                                             12110000
      **********************************************************        12120000
           MOVE SPACES                      TO BP13F830-REC.            12130000
                                                                        12140000
           MOVE FB78-NUM-REGN               TO F830-KEY-FLD.            12150000
           MOVE FB78-NUM-REGN               TO F830-NUM-REGN.           12160000
                                                                        12170000
           MOVE FB78-NUM-MAIN-BLK           TO F830-NUM-MAIL-MAIN-BLK.  12180000
           MOVE FB78-NUM-SUB-BLK            TO F830-NUM-MAIL-SUB-BLK.   12190000
                                                                        12200000
           IF FB78-NUM-SUB-BLK NOT = SPACES AND LOW-VALUES              12210000
              MOVE '-'                      TO F830-NUM-MAIL-BLK-DASH   12220000
           ELSE                                                         12230000
              MOVE SPACES                   TO F830-NUM-MAIL-BLK-DASH   12240000
           END-IF.                                                      12250000
                                                                        12260000
           MOVE '#'                         TO F830-NUM-MAIL-LVL-CHAR.  12270000
                                                                        12280000
           IF (FB78-NUM-LEVEL(1:1) = SPACES OR LOW-VALUES) AND          12290000
              (FB78-NUM-LEVEL(2:1) NOT = SPACES AND LOW-VALUES)         12300000
              STRING '0', FB78-NUM-LEVEL(2:1)                           12310000
                 DELIMITED BY SIZE                                      12320000
                 INTO  F830-NUM-MAIL-LVL-NUM                            12330000
              END-STRING                                                12340000
           ELSE                                                         12350000
             IF (FB78-NUM-LEVEL(2:1) = SPACES OR LOW-VALUES) AND        12360000
                (FB78-NUM-LEVEL(1:1) NOT = SPACES AND LOW-VALUES)       12370000
                STRING '0', FB78-NUM-LEVEL(1:1)                         12380000
                   DELIMITED BY SIZE                                    12390000
                   INTO  F830-NUM-MAIL-LVL-NUM                          12400000
                END-STRING                                              12410000
             ELSE                                                       12420000
                MOVE FB78-NUM-LEVEL   TO F830-NUM-MAIL-LVL-NUM          12430000
             END-IF                                                     12440000
           END-IF.                                                      12450000
                                                                        12460000
           MOVE '-'                         TO F830-NUM-MAIL-LVL-DASH.  12470000
           MOVE FB78-NUM-MAIN-UNIT          TO F830-NUM-MAIL-HSEMAIN.   12480000
           MOVE FB78-NUM-SUB-UNIT           TO F830-NUM-MAIL-HSESUB.    12490000
                                                                        12500000
           MOVE FB78-NUM-CORRESP-STREET     TO F830-NME-MAIL-STR-BLDG.  12510000
           MOVE FB78-CDE-CORRESP-POST       TO F830-NUM-MAIL-POSTAL.    12520000
                                                                        12530000
           IF FB78-NUM-MAIN-BLK  NOT = SPACES AND                       12540000
              FB78-NUM-MAIN-UNIT NOT = SPACES AND                       12550000
              FB78-NUM-CORRESP-STREET NOT = SPACES                      12560000
              MOVE 'BLK'                    TO F830-NUM-MAIL-BLK-HDR    12570000
              MOVE 'H'                      TO F830-NUM-MAIL-ADDR-TYPE  12580000
           ELSE                                                         12590000
              IF FB78-NUM-MAIN-BLK  = SPACES AND                        12600000
                 FB78-NUM-MAIN-UNIT = SPACES AND                        12610000
                 FB78-NUM-CORRESP-STREET NOT = SPACES                   12620000
                 MOVE 'N'                   TO F830-NUM-MAIL-ADDR-TYPE  12630000
              ELSE                                                      12640000
                 MOVE SPACES                TO F830-NUM-MAIL-ADDR-TYPE  12650000
              END-IF                                                    12660000
              MOVE SPACES                   TO F830-NUM-MAIL-LVL-CHAR   12670000
                                               F830-NUM-MAIL-LVL-DASH   12680000
           END-IF.                                                      12690000
                                                                        12700000
           IF FB78-CDE-CORRESP-POST = SPACES                            12710000
              MOVE SPACES TO F830-NUM-MAIL-ADDR                         12720000
           END-IF.                                                      12730000
                                                                        12740000
           MOVE WS-CURRENT-DATE             TO F830-DTE-UPDATE.         12750000
           MOVE 'P13C9CB'                   TO F830-NUM-USERID.         12760000
                                                                        12770000
           WRITE BP13F830-REC.                                          12780000
           ADD   +1                         TO WS-F830-WRITE-CTR.       12790000
                                                                        12800000
       4400-EXIT.                                                       12810000
           EXIT.                                                        12820000
                                                                        12830000
                                                                        12840000
      **********************************************************        12850000
       7000-PRINT-ERROR.                                                12860000
      **********************************************************        12870000
           IF WS-L9CB-LINECTR > 24                                      12880000
              PERFORM 7100-PRINT-HEADING THRU 7100-EXIT                 12890000
           END-IF.                                                      12900000
                                                                        12910000
           ADD   +1                      TO   WS-L9CB-S-NO.             12920000
           MOVE WS-L9CB-S-NO             TO   L9CB-S-NO.                12930000
                                                                        12940000
           MOVE FB78-NUM-REGN            TO   L9CB-REGN.                12950000
           MOVE FB78-NUM-APPLT1-UIN      TO   L9CB-NRIC.                12960000
                                                                        12970000
           IF WS-TEMP-NRIC(1:1) = '-'                                   12980000
              MOVE 'X'                  TO L9CB-ERROR-NRIC(1:1)         12990000
              MOVE WS-TEMP-NRIC(2:8)    TO L9CB-ERROR-NRIC(2:8)         13000000
           ELSE                                                         13010000
              MOVE WS-TEMP-NRIC         TO L9CB-ERROR-NRIC.             13020000
                                                                        13030000
           WRITE BP13L9CB-REC          FROM   L9CB-DETAIL-01            13040000
                                      AFTER   ADVANCING 2 LINES.        13050000
                                                                        13060000
           ADD  +1                       TO   WS-L9CB-LINECTR.          13070000
                                                                        13080000
       7000-EXIT.                                                       13090000
           EXIT.                                                        13100000
                                                                        13110000
                                                                        13120000
      **********************************************************        13130000
       7100-PRINT-HEADING.                                              13140000
      **********************************************************        13150000
           ADD   +1               TO WS-L9CB-PAGECTR.                   13160000
           MOVE WS-L9CB-PAGECTR   TO L9CB-PAGE-NO.                      13170000
                                                                        13180000
           WRITE BP13L9CB-REC   FROM L9CB-HEADING-01                    13190000
                               AFTER ADVANCING PAGE.                    13200000
                                                                        13210000
           WRITE BP13L9CB-REC   FROM L9CB-HEADING-02                    13220000
                               AFTER ADVANCING 1 LINE.                  13230000
                                                                        13240000
           WRITE BP13L9CB-REC   FROM L9CB-HEADING-03                    13250000
                               AFTER ADVANCING 1 LINE.                  13260000
                                                                        13270000
           WRITE BP13L9CB-REC   FROM L9CB-HEADING-04                    13280000
                               AFTER ADVANCING 2 LINES.                 13290000
                                                                        13300000
           WRITE BP13L9CB-REC   FROM L9CB-HEADING-05                    13310000
                               AFTER ADVANCING 1 LINES.                 13320000
                                                                        13330000
           MOVE ZEROS             TO WS-L9CB-LINECTR.                   13340000
                                                                        13350000
       7100-EXIT.                                                       13360000
           EXIT.                                                        13370000
                                                                        13380000
                                                                        13390000
      **********************************************************        13400000
       8000-PRINT-REPORT.                                               13410000
      **********************************************************        13420000
      *--------------> PRINT FILE STATISTICS ON NEW PAGE                13430000
                                                                        13440000
           ADD   +1               TO WS-L9CB-PAGECTR.                   13450000
           MOVE WS-L9CB-PAGECTR   TO L9CB-PAGE-NO.                      13460000
                                                                        13470000
           WRITE BP13L9CB-REC   FROM L9CB-HEADING-01                    13480000
                               AFTER ADVANCING PAGE.                    13490000
                                                                        13500000
           WRITE BP13L9CB-REC   FROM L9CB-HEADING-02                    13510000
                               AFTER ADVANCING 1 LINE.                  13520000
                                                                        13530000
           MOVE SPACES                      TO   L9CB-TOTALS.           13540000
                                                                        13550000
      *--------------> BP13FB78 STATISTICS                              13560000
                                                                        13570000
           MOVE  K-FB78-RECORDS-READ        TO   L9CB-TOTAL-DESC.       13580000
           MOVE  WS-FB78-READ-CTR           TO   L9CB-TOTAL-VALUE.      13590000
           WRITE BP13L9CB-REC             FROM   L9CB-TOTALS            13600000
                                         AFTER   ADVANCING 2 LINES.     13610000
                                                                        13620000
      *--------------> BE01F500 STATISTICS                              13630000
                                                                        13640000
           MOVE  K-F500-RECORDS-WRITE       TO   L9CB-TOTAL-DESC.       13650000
           MOVE  WS-F500-WRITE-CTR          TO   L9CB-TOTAL-VALUE.      13660000
           WRITE BP13L9CB-REC             FROM   L9CB-TOTALS            13670000
                                         AFTER   ADVANCING 2 LINES.     13680000
                                                                        13690000
      *--------------> BP13F825 STATISTICS                              13700000
                                                                        13710000
           MOVE  K-F825-RECORDS-WRITE       TO   L9CB-TOTAL-DESC.       13720000
           MOVE  WS-F825-WRITE-CTR          TO   L9CB-TOTAL-VALUE.      13730000
           WRITE BP13L9CB-REC             FROM   L9CB-TOTALS            13740000
                                         AFTER   ADVANCING 2 LINES.     13750000
                                                                        13760000
                                                                        13770000
      *--------------> BP13F830 STATISTICS                              13780000
                                                                        13790000
           MOVE  K-F830-RECORDS-WRITE       TO   L9CB-TOTAL-DESC.       13800000
           MOVE  WS-F830-WRITE-CTR          TO   L9CB-TOTAL-VALUE.      13810000
           WRITE BP13L9CB-REC             FROM   L9CB-TOTALS            13820000
                                         AFTER   ADVANCING 2 LINES.     13830000
                                                                        13840000
      *--------------> BP13F730 STATISTICS                              13850000
                                                                        13860000
           MOVE  K-F730-RECORDS-WRITE       TO   L9CB-TOTAL-DESC.       13870000
           MOVE  WS-F730-WRITE-CTR          TO   L9CB-TOTAL-VALUE.      13880000
           WRITE BP13L9CB-REC             FROM   L9CB-TOTALS            13890000
                                         AFTER   ADVANCING 2 LINES.     13900000
                                                                        13910000
       8000-EXIT.                                                       13920000
           EXIT.                                                        13930000
                                                                        13940000
                                                                        13950000
      **********************************************************        13960000
       9000-CLOSE-FILES.                                                13970000
      **********************************************************        13980000
           CLOSE BP13FB78                                               13990000
                 BP13F730                                               14000000
                 BP13F825                                               14010000
                 BE01F500                                               14020000
                 BP13L9CB.                                              14030000
                                                                        14040000
           STOP RUN.                                                    14050000
                                                                        14060000
       9000-EXIT.                                                       14070000
           EXIT.                                                        14080000
