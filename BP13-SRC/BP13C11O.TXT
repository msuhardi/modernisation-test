       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C11O.                                                 
      *AUTHOR.        ZARITA SARMIENTO.                                         
      *DATE-WRITTEN.  29/11/2018.                                               
      * ========================================================== *            
      * OBJECTIVE    :  CREATE BP13KC66 FILE                       *            
      * ========================================================== *            
      * INPUT  FILES :  1.) BP13FC55                               *            
      * I-O    FILES :  1.) BP13KC66                               *            
      * ========================================================== *            
      * CHG-NO   BY   DATE       DESCRIPTION                       *            
      * -------- ---  ------     -----------                       *            
      * BP137466 ZS13 29/11/2018 NEW PROGRAM                       *            
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13FC55  ASSIGN        TO BP13FC55.                          
                                                                                
           SELECT BP13KC66  ASSIGN        TO BP13KC66                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS KC66-KEY-FLD                       
                            FILE STATUS   IS WS-KC66-STATUS.                    
                                                                                
           SELECT BP13K800  ASSIGN        TO BP13K800                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K800-NUM-REGN                      
                            FILE STATUS   IS WS-K800-STATUS.                    
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  BP13FC55                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 100 CHARACTERS.                                      
           COPY BP13FC55.                                                       
                                                                                
       FD  BP13KC66                                                             
           RECORD CONTAINS 100 CHARACTERS.                                      
           COPY BP13KC66.                                                       
                                                                                
       FD  BP13K800                                                             
           RECORD CONTAINS 2000 CHARACTERS.                                     
           COPY BP13K800.                                                       
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
                                                                                
       01  WS-FILE-STATUS.                                                      
           05  WS-KC66-STATUS            PIC 9(2)   VALUE ZEROES.               
           05  WS-K800-STATUS            PIC 9(2)   VALUE ZEROES.               
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-CNT-FC55-READ          PIC 9(6)   VALUE ZEROES.               
           05  WS-CNT-KC66-WRITE         PIC 9(6)   VALUE ZEROES.               
           05  WS-CNT-K800-READ          PIC 9(6)   VALUE ZEROES.               
                                                                                
       01  WS-CNT-OIC-TABLE.                                                    
           05  WS-AGR-NUM-GT-24MON      PIC 9(5).                               
           05  WS-AGR-NUM-GT-18MON      PIC 9(5).                               
           05  WS-AGR-NUM-GT-12MON      PIC 9(5).                               
           05  WS-AGR-NUM-GT-09MON      PIC 9(5).                               
           05  WS-AGR-NUM-GT-06MON      PIC 9(5).                               
           05  WS-AGR-NUM-GT-03MON      PIC 9(5).                               
           05  WS-AGR-NUM-LT-03MON      PIC 9(5).                               
           05  WS-RST-NUM-GT-24MON      PIC 9(5).                               
           05  WS-RST-NUM-GT-18MON      PIC 9(5).                               
           05  WS-RST-NUM-GT-12MON      PIC 9(5).                               
           05  WS-RST-NUM-GT-09MON      PIC 9(5).                               
           05  WS-RST-NUM-GT-06MON      PIC 9(5).                               
           05  WS-RST-NUM-GT-03MON      PIC 9(5).                               
           05  WS-RST-NUM-LT-03MON      PIC 9(5).                               
           05  WS-CRM1-NUM-GT-24MON      PIC 9(5).                              
           05  WS-CRM1-NUM-GT-18MON      PIC 9(5).                              
           05  WS-CRM1-NUM-GT-12MON      PIC 9(5).                              
           05  WS-CRM1-NUM-GT-09MON      PIC 9(5).                              
           05  WS-CRM1-NUM-GT-06MON      PIC 9(5).                              
           05  WS-CRM1-NUM-GT-03MON      PIC 9(5).                              
           05  WS-CRM1-NUM-LT-03MON      PIC 9(5).                              
           05  WS-CRM2-NUM-GT-24MON      PIC 9(5).                              
           05  WS-CRM2-NUM-GT-18MON      PIC 9(5).                              
           05  WS-CRM2-NUM-GT-12MON      PIC 9(5).                              
           05  WS-CRM2-NUM-GT-09MON      PIC 9(5).                              
           05  WS-CRM2-NUM-GT-06MON      PIC 9(5).                              
           05  WS-CRM2-NUM-GT-03MON      PIC 9(5).                              
           05  WS-CRM2-NUM-LT-03MON      PIC 9(5).                              
           05  WS-CRM3-NUM-GT-24MON      PIC 9(5).                              
           05  WS-CRM3-NUM-GT-18MON      PIC 9(5).                              
           05  WS-CRM3-NUM-GT-12MON      PIC 9(5).                              
           05  WS-CRM3-NUM-GT-09MON      PIC 9(5).                              
           05  WS-CRM3-NUM-GT-06MON      PIC 9(5).                              
           05  WS-CRM3-NUM-GT-03MON      PIC 9(5).                              
           05  WS-CRM3-NUM-LT-03MON      PIC 9(5).                              
           05  WS-CRM4-NUM-GT-24MON      PIC 9(5).                              
           05  WS-CRM4-NUM-GT-18MON      PIC 9(5).                              
           05  WS-CRM4-NUM-GT-12MON      PIC 9(5).                              
           05  WS-CRM4-NUM-GT-09MON      PIC 9(5).                              
           05  WS-CRM4-NUM-GT-06MON      PIC 9(5).                              
           05  WS-CRM4-NUM-GT-03MON      PIC 9(5).                              
           05  WS-CRM4-NUM-LT-03MON      PIC 9(5).                              
           05  WS-CRM5-NUM-GT-24MON      PIC 9(5).                              
           05  WS-CRM5-NUM-GT-18MON      PIC 9(5).                              
           05  WS-CRM5-NUM-GT-12MON      PIC 9(5).                              
           05  WS-CRM5-NUM-GT-09MON      PIC 9(5).                              
           05  WS-CRM5-NUM-GT-06MON      PIC 9(5).                              
           05  WS-CRM5-NUM-GT-03MON      PIC 9(5).                              
           05  WS-CRM5-NUM-LT-03MON      PIC 9(5).                              
           05  WS-CRM6-NUM-GT-24MON      PIC 9(5).                              
           05  WS-CRM6-NUM-GT-18MON      PIC 9(5).                              
           05  WS-CRM6-NUM-GT-12MON      PIC 9(5).                              
           05  WS-CRM6-NUM-GT-09MON      PIC 9(5).                              
           05  WS-CRM6-NUM-GT-06MON      PIC 9(5).                              
           05  WS-CRM6-NUM-GT-03MON      PIC 9(5).                              
           05  WS-CRM6-NUM-LT-03MON      PIC 9(5).                              
           05  WS-CRM7-NUM-GT-24MON      PIC 9(5).                              
           05  WS-CRM7-NUM-GT-18MON      PIC 9(5).                              
           05  WS-CRM7-NUM-GT-12MON      PIC 9(5).                              
           05  WS-CRM7-NUM-GT-09MON      PIC 9(5).                              
           05  WS-CRM7-NUM-GT-06MON      PIC 9(5).                              
           05  WS-CRM7-NUM-GT-03MON      PIC 9(5).                              
           05  WS-CRM7-NUM-LT-03MON      PIC 9(5).                              
           05  WS-CRM8-NUM-GT-24MON      PIC 9(5).                              
           05  WS-CRM8-NUM-GT-18MON      PIC 9(5).                              
           05  WS-CRM8-NUM-GT-12MON      PIC 9(5).                              
           05  WS-CRM8-NUM-GT-09MON      PIC 9(5).                              
           05  WS-CRM8-NUM-GT-06MON      PIC 9(5).                              
           05  WS-CRM8-NUM-GT-03MON      PIC 9(5).                              
           05  WS-CRM8-NUM-LT-03MON      PIC 9(5).                              
                                                                                
       01  WS-FLAGS.                                                            
           05  WS-FC55-EOF               PIC X(1)   VALUE 'N'.                  
                                                                                
       01  WS-OTH-VAR.                                                          
           05  ENQY-AHG-REQ                PIC X(1)   VALUE SPACE.              
           05  ENQY-SHG-REQ                PIC X(1)   VALUE SPACE.              
           05  ENQY-AHG-STATUS             PIC X(1)   VALUE SPACE.              
           05  ENQY-SHG-STATUS             PIC X(1)   VALUE SPACE.              
       01  WS-DATE.                                                             
           05  WS-DTE-SYSTEM               PIC S9(15) COMP-3.                   
           05  WS-DTE-CURRENT              PIC X(8).                            
           05  WS-DTE-TMP.                                                      
               10  WS-TMP-CCYY             PIC 9(4)   VALUE ZEROES.             
               10  WS-TMP-MM               PIC 9(2)   VALUE ZEROES.             
               10  WS-TMP-DD               PIC 9(2)   VALUE ZEROES.             
                                                                                
       01  WS-CURRENT-DATE                 PIC 9(08) VALUE ZEROES.              
       01  WS-DTE-START                    PIC 9(08) VALUE ZEROES.              
                                                                                
       01  WS-NUM-CURR-DTE                 PIC 9(07) VALUE ZEROES.              
       01  WS-NUM-START-DTE                PIC 9(07) VALUE ZEROES.              
       01  WS-NUM-DIFF-DTE                 PIC 9(07) VALUE ZEROES.              
       01  WS-NUM-DIFF-MTH                 PIC 9(04) VALUE ZEROES.              
       01  WS-TOTAL-AGR                    PIC 9(06) VALUE ZEROES.              
       01  WS-TOTAL-RST                    PIC 9(06) VALUE ZEROES.              
       01  WS-TOTAL-CRM1                   PIC 9(06) VALUE ZEROES.              
       01  WS-TOTAL-CRM2                   PIC 9(06) VALUE ZEROES.              
       01  WS-TOTAL-CRM3                   PIC 9(06) VALUE ZEROES.              
       01  WS-TOTAL-CRM4                   PIC 9(06) VALUE ZEROES.              
       01  WS-TOTAL-CRM5                   PIC 9(06) VALUE ZEROES.              
       01  WS-TOTAL-CRM6                   PIC 9(06) VALUE ZEROES.              
       01  WS-TOTAL-CRM7                   PIC 9(06) VALUE ZEROES.              
       01  WS-TOTAL-CRM8                   PIC 9(06) VALUE ZEROES.              
                                                                                
       PROCEDURE DIVISION.                                                      
      *=============================================================            
       0000-CONTROL.                                                            
      *=============================================================            
                                                                                
           PERFORM 1000-OPEN-ROUTINE       THRU 1000-EXIT.                      
           PERFORM 2000-BP13FC55-READ      THRU 2000-EXIT.                      
           PERFORM 3000-MAIN-ROUTINE       THRU 3000-EXIT                       
                   UNTIL WS-FC55-EOF = 'Y'.                                     
           PERFORM 2100-WRITE-BP13KC66     THRU 2100-EXIT.                      
           PERFORM 6000-DISPLAY-COUNTERS   THRU 6000-EXIT.                      
           PERFORM 9000-CLOSE-ROUTINE      THRU 9000-EXIT.                      
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *=============================================================            
       1000-OPEN-ROUTINE.                                                       
      *=============================================================            
                                                                                
           OPEN INPUT  BP13FC55                                                 
                       BP13K800                                                 
                I-O    BP13KC66.                                                
                                                                                
           IF WS-KC66-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING BP13KC66 ERROR ' WS-KC66-STATUS                  
              MOVE     WS-KC66-STATUS      TO   RETURN-CODE                     
              PERFORM  9000-CLOSE-ROUTINE  THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING BP13K800 ERROR ' WS-K800-STATUS                  
              MOVE     WS-K800-STATUS      TO   RETURN-CODE                     
              PERFORM  9000-CLOSE-ROUTINE  THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           MOVE SPACES                     TO WS-CNT-OIC-TABLE                  
           INITIALIZE                         WS-CNT-OIC-TABLE.                 
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8) TO   WS-CURRENT-DATE.                
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
                                                                                
      *=============================================================            
       2000-BP13FC55-READ.                                                      
      *=============================================================            
                                                                                
           READ BP13FC55                                                        
              AT END MOVE 'Y'              TO   WS-FC55-EOF.                    
                                                                                
           IF WS-FC55-EOF NOT = 'Y'                                             
              ADD 1                        TO   WS-CNT-FC55-READ                
           END-IF.                                                              
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       2100-WRITE-BP13KC66.                                                     
      *=============================================================            
                                                                                
           PERFORM 3200-MOVE-VALUES     THRU 3200-EXIT.                         
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3000-MAIN-ROUTINE.                                                       
      *=============================================================            
      *-------------------------------------------------------------            
      *    GET AHG/SHG                                                          
      *-------------------------------------------------------------            
           PERFORM 4000-BP13K800-READ   THRU 4000-EXIT.                         
           PERFORM 4100-GET-AHG-SHG     THRU 4100-EXIT.                         
           PERFORM 5000-PROCESS-DATE    THRU 5000-EXIT.                         
                                                                                
      *-------------------------------------------------------------            
      *    COUNT CASES                                                          
      *-------------------------------------------------------------            
           PERFORM 3100-PROCESS-TEAM    THRU 3100-EXIT.                         
                                                                                
                                                                                
           PERFORM 2000-BP13FC55-READ      THRU 2000-EXIT.                      
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3100-PROCESS-TEAM.                                                       
      *=============================================================            
                                                                                
             EVALUATE FC55-CDE-TEAM                                             
                 WHEN '1'                                                       
                    PERFORM 3101-PROCESS-TEAM1 THRU 3101-EXIT                   
                                                                                
                 WHEN '2'                                                       
                    PERFORM 3102-PROCESS-TEAM2 THRU 3102-EXIT                   
                                                                                
                 WHEN '3'                                                       
                    PERFORM 3103-PROCESS-TEAM3 THRU 3103-EXIT                   
                                                                                
                 WHEN '4'                                                       
                    PERFORM 3104-PROCESS-TEAM4 THRU 3104-EXIT                   
                                                                                
                 WHEN '5'                                                       
                    PERFORM 3105-PROCESS-TEAM5 THRU 3105-EXIT                   
                                                                                
                 WHEN '6'                                                       
                    PERFORM 3106-PROCESS-TEAM6 THRU 3106-EXIT                   
                                                                                
                 WHEN '7'                                                       
                    PERFORM 3109-PROCESS-TEAM7 THRU 3109-EXIT                   
                                                                                
                 WHEN '8'                                                       
                    PERFORM 3110-PROCESS-TEAM8 THRU 3110-EXIT                   
                                                                                
                 WHEN 'A'                                                       
                    PERFORM 3107-PROCESS-AGR   THRU 3107-EXIT                   
                                                                                
                 WHEN 'R'                                                       
                    PERFORM 3108-PROCESS-RST   THRU 3108-EXIT                   
                                                                                
             END-EVALUATE.                                                      
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3101-PROCESS-TEAM1.                                                      
      *=============================================================            
                                                                                
           IF WS-NUM-DIFF-MTH >= 24                                             
              ADD 1 TO WS-CRM1-NUM-GT-24MON                                     
           ELSE                                                                 
              IF (WS-NUM-DIFF-MTH >= 18) AND (WS-NUM-DIFF-MTH <= 23)            
                  ADD 1 TO WS-CRM1-NUM-GT-18MON                                 
              ELSE                                                              
                 IF (WS-NUM-DIFF-MTH >= 12) AND (WS-NUM-DIFF-MTH <= 17)         
                     ADD 1 TO WS-CRM1-NUM-GT-12MON                              
                 ELSE                                                           
                    IF (WS-NUM-DIFF-MTH >= 9) AND                               
                       (WS-NUM-DIFF-MTH <= 11)                                  
                       ADD 1 TO WS-CRM1-NUM-GT-09MON                            
                    ELSE                                                        
                       IF (WS-NUM-DIFF-MTH >= 6) AND                            
                          (WS-NUM-DIFF-MTH <= 8)                                
                          ADD 1 TO WS-CRM1-NUM-GT-06MON                         
                       ELSE                                                     
                         IF (WS-NUM-DIFF-MTH >= 3) AND                          
                            (WS-NUM-DIFF-MTH <= 5)                              
                            ADD 1 TO WS-CRM1-NUM-GT-03MON                       
                         ELSE                                                   
                            ADD 1 TO WS-CRM1-NUM-LT-03MON                       
                         END-IF                                                 
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3101-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3102-PROCESS-TEAM2.                                                      
      *=============================================================            
                                                                                
           IF WS-NUM-DIFF-MTH >= 24                                             
              ADD 1 TO WS-CRM2-NUM-GT-24MON                                     
           ELSE                                                                 
              IF (WS-NUM-DIFF-MTH >= 18) AND (WS-NUM-DIFF-MTH <= 23)            
                  ADD 1 TO WS-CRM2-NUM-GT-18MON                                 
              ELSE                                                              
                 IF (WS-NUM-DIFF-MTH >= 12) AND (WS-NUM-DIFF-MTH <= 17)         
                     ADD 1 TO WS-CRM2-NUM-GT-12MON                              
                 ELSE                                                           
                    IF (WS-NUM-DIFF-MTH >= 9) AND                               
                       (WS-NUM-DIFF-MTH <= 11)                                  
                       ADD 1 TO WS-CRM2-NUM-GT-09MON                            
                    ELSE                                                        
                       IF (WS-NUM-DIFF-MTH >= 6) AND                            
                          (WS-NUM-DIFF-MTH <= 8)                                
                          ADD 1 TO WS-CRM2-NUM-GT-06MON                         
                       ELSE                                                     
                         IF (WS-NUM-DIFF-MTH >= 3) AND                          
                            (WS-NUM-DIFF-MTH <= 5)                              
                            ADD 1 TO WS-CRM2-NUM-GT-03MON                       
                         ELSE                                                   
                            ADD 1 TO WS-CRM2-NUM-LT-03MON                       
                         END-IF                                                 
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
                                                                                
       3102-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *=============================================================            
       3103-PROCESS-TEAM3.                                                      
      *=============================================================            
                                                                                
           IF WS-NUM-DIFF-MTH >= 24                                             
              ADD 1 TO WS-CRM3-NUM-GT-24MON                                     
           ELSE                                                                 
              IF (WS-NUM-DIFF-MTH >= 18) AND (WS-NUM-DIFF-MTH <= 23)            
                  ADD 1 TO WS-CRM3-NUM-GT-18MON                                 
              ELSE                                                              
                 IF (WS-NUM-DIFF-MTH >= 12) AND (WS-NUM-DIFF-MTH <= 17)         
                     ADD 1 TO WS-CRM3-NUM-GT-12MON                              
                 ELSE                                                           
                    IF (WS-NUM-DIFF-MTH >= 9) AND                               
                       (WS-NUM-DIFF-MTH <= 11)                                  
                       ADD 1 TO WS-CRM3-NUM-GT-09MON                            
                    ELSE                                                        
                       IF (WS-NUM-DIFF-MTH >= 6) AND                            
                          (WS-NUM-DIFF-MTH <= 8)                                
                          ADD 1 TO WS-CRM3-NUM-GT-06MON                         
                       ELSE                                                     
                         IF (WS-NUM-DIFF-MTH >= 3) AND                          
                            (WS-NUM-DIFF-MTH <= 5)                              
                            ADD 1 TO WS-CRM3-NUM-GT-03MON                       
                         ELSE                                                   
                            ADD 1 TO WS-CRM3-NUM-LT-03MON                       
                         END-IF                                                 
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3103-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *=============================================================            
       3104-PROCESS-TEAM4.                                                      
      *=============================================================            
                                                                                
           IF WS-NUM-DIFF-MTH >= 24                                             
              ADD 1 TO WS-CRM4-NUM-GT-24MON                                     
           ELSE                                                                 
              IF (WS-NUM-DIFF-MTH >= 18) AND (WS-NUM-DIFF-MTH <= 23)            
                  ADD 1 TO WS-CRM4-NUM-GT-18MON                                 
              ELSE                                                              
                 IF (WS-NUM-DIFF-MTH >= 12) AND (WS-NUM-DIFF-MTH <= 17)         
                     ADD 1 TO WS-CRM4-NUM-GT-12MON                              
                 ELSE                                                           
                    IF (WS-NUM-DIFF-MTH >= 9) AND                               
                       (WS-NUM-DIFF-MTH <= 11)                                  
                       ADD 1 TO WS-CRM4-NUM-GT-09MON                            
                    ELSE                                                        
                       IF (WS-NUM-DIFF-MTH >= 6) AND                            
                          (WS-NUM-DIFF-MTH <= 8)                                
                          ADD 1 TO WS-CRM4-NUM-GT-06MON                         
                       ELSE                                                     
                         IF (WS-NUM-DIFF-MTH >= 3) AND                          
                            (WS-NUM-DIFF-MTH <= 5)                              
                            ADD 1 TO WS-CRM4-NUM-GT-03MON                       
                         ELSE                                                   
                            ADD 1 TO WS-CRM4-NUM-LT-03MON                       
                         END-IF                                                 
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3104-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3105-PROCESS-TEAM5.                                                      
      *=============================================================            
                                                                                
           IF WS-NUM-DIFF-MTH >= 24                                             
              ADD 1 TO WS-CRM5-NUM-GT-24MON                                     
           ELSE                                                                 
              IF (WS-NUM-DIFF-MTH >= 18) AND (WS-NUM-DIFF-MTH <= 23)            
                  ADD 1 TO WS-CRM5-NUM-GT-18MON                                 
              ELSE                                                              
                 IF (WS-NUM-DIFF-MTH >= 12) AND (WS-NUM-DIFF-MTH <= 17)         
                     ADD 1 TO WS-CRM5-NUM-GT-12MON                              
                 ELSE                                                           
                    IF (WS-NUM-DIFF-MTH >= 9) AND                               
                       (WS-NUM-DIFF-MTH <= 11)                                  
                       ADD 1 TO WS-CRM5-NUM-GT-09MON                            
                    ELSE                                                        
                       IF (WS-NUM-DIFF-MTH >= 6) AND                            
                          (WS-NUM-DIFF-MTH <= 8)                                
                          ADD 1 TO WS-CRM5-NUM-GT-06MON                         
                       ELSE                                                     
                         IF (WS-NUM-DIFF-MTH >= 3) AND                          
                            (WS-NUM-DIFF-MTH <= 5)                              
                            ADD 1 TO WS-CRM5-NUM-GT-03MON                       
                         ELSE                                                   
                            ADD 1 TO WS-CRM5-NUM-LT-03MON                       
                         END-IF                                                 
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3105-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3106-PROCESS-TEAM6.                                                      
      *=============================================================            
                                                                                
           IF WS-NUM-DIFF-MTH >= 24                                             
              ADD 1 TO WS-CRM6-NUM-GT-24MON                                     
           ELSE                                                                 
              IF (WS-NUM-DIFF-MTH >= 18) AND (WS-NUM-DIFF-MTH <= 23)            
                  ADD 1 TO WS-CRM6-NUM-GT-18MON                                 
              ELSE                                                              
                 IF (WS-NUM-DIFF-MTH >= 12) AND (WS-NUM-DIFF-MTH <= 17)         
                     ADD 1 TO WS-CRM6-NUM-GT-12MON                              
                 ELSE                                                           
                    IF (WS-NUM-DIFF-MTH >= 9) AND                               
                       (WS-NUM-DIFF-MTH <= 11)                                  
                       ADD 1 TO WS-CRM6-NUM-GT-09MON                            
                    ELSE                                                        
                       IF (WS-NUM-DIFF-MTH >= 6) AND                            
                          (WS-NUM-DIFF-MTH <= 8)                                
                          ADD 1 TO WS-CRM6-NUM-GT-06MON                         
                       ELSE                                                     
                         IF (WS-NUM-DIFF-MTH >= 3) AND                          
                            (WS-NUM-DIFF-MTH <= 5)                              
                            ADD 1 TO WS-CRM6-NUM-GT-03MON                       
                         ELSE                                                   
                            ADD 1 TO WS-CRM6-NUM-LT-03MON                       
                         END-IF                                                 
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3106-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3107-PROCESS-AGR.                                                        
      *=============================================================            
                                                                                
           IF WS-NUM-DIFF-MTH >= 24                                             
              ADD 1 TO WS-AGR-NUM-GT-24MON                                      
           ELSE                                                                 
              IF (WS-NUM-DIFF-MTH >= 18) AND (WS-NUM-DIFF-MTH <= 23)            
                  ADD 1 TO WS-AGR-NUM-GT-18MON                                  
              ELSE                                                              
                 IF (WS-NUM-DIFF-MTH >= 12) AND (WS-NUM-DIFF-MTH <= 17)         
                     ADD 1 TO WS-AGR-NUM-GT-12MON                               
                 ELSE                                                           
                    IF (WS-NUM-DIFF-MTH >= 9) AND                               
                       (WS-NUM-DIFF-MTH <= 11)                                  
                       ADD 1 TO WS-AGR-NUM-GT-09MON                             
                    ELSE                                                        
                       IF (WS-NUM-DIFF-MTH >= 6) AND                            
                          (WS-NUM-DIFF-MTH <= 8)                                
                          ADD 1 TO WS-AGR-NUM-GT-06MON                          
                       ELSE                                                     
                         IF (WS-NUM-DIFF-MTH >= 3) AND                          
                            (WS-NUM-DIFF-MTH <= 5)                              
                            ADD 1 TO WS-AGR-NUM-GT-03MON                        
                         ELSE                                                   
                            ADD 1 TO WS-AGR-NUM-LT-03MON                        
                         END-IF                                                 
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3107-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3108-PROCESS-RST.                                                        
      *=============================================================            
                                                                                
           IF WS-NUM-DIFF-MTH >= 24                                             
              ADD 1 TO WS-RST-NUM-GT-24MON                                      
           ELSE                                                                 
              IF (WS-NUM-DIFF-MTH >= 18) AND (WS-NUM-DIFF-MTH <= 23)            
                  ADD 1 TO WS-RST-NUM-GT-18MON                                  
              ELSE                                                              
                 IF (WS-NUM-DIFF-MTH >= 12) AND (WS-NUM-DIFF-MTH <= 17)         
                     ADD 1 TO WS-RST-NUM-GT-12MON                               
                 ELSE                                                           
                    IF (WS-NUM-DIFF-MTH >= 9) AND                               
                       (WS-NUM-DIFF-MTH <= 11)                                  
                       ADD 1 TO WS-RST-NUM-GT-09MON                             
                    ELSE                                                        
                       IF (WS-NUM-DIFF-MTH >= 6) AND                            
                          (WS-NUM-DIFF-MTH <= 8)                                
                          ADD 1 TO WS-RST-NUM-GT-06MON                          
                       ELSE                                                     
                         IF (WS-NUM-DIFF-MTH >= 3) AND                          
                            (WS-NUM-DIFF-MTH <= 5)                              
                            ADD 1 TO WS-RST-NUM-GT-03MON                        
                         ELSE                                                   
                            ADD 1 TO WS-RST-NUM-LT-03MON                        
                         END-IF                                                 
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3108-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3109-PROCESS-TEAM7.                                                      
      *=============================================================            
                                                                                
           IF WS-NUM-DIFF-MTH >= 24                                             
              ADD 1 TO WS-CRM7-NUM-GT-24MON                                     
           ELSE                                                                 
              IF (WS-NUM-DIFF-MTH >= 18) AND (WS-NUM-DIFF-MTH <= 23)            
                  ADD 1 TO WS-CRM7-NUM-GT-18MON                                 
              ELSE                                                              
                 IF (WS-NUM-DIFF-MTH >= 12) AND (WS-NUM-DIFF-MTH <= 17)         
                     ADD 1 TO WS-CRM7-NUM-GT-12MON                              
                 ELSE                                                           
                    IF (WS-NUM-DIFF-MTH >= 9) AND                               
                       (WS-NUM-DIFF-MTH <= 11)                                  
                       ADD 1 TO WS-CRM7-NUM-GT-09MON                            
                    ELSE                                                        
                       IF (WS-NUM-DIFF-MTH >= 6) AND                            
                          (WS-NUM-DIFF-MTH <= 8)                                
                          ADD 1 TO WS-CRM7-NUM-GT-06MON                         
                       ELSE                                                     
                         IF (WS-NUM-DIFF-MTH >= 3) AND                          
                            (WS-NUM-DIFF-MTH <= 5)                              
                            ADD 1 TO WS-CRM7-NUM-GT-03MON                       
                         ELSE                                                   
                            ADD 1 TO WS-CRM7-NUM-LT-03MON                       
                         END-IF                                                 
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3109-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3110-PROCESS-TEAM8.                                                      
      *=============================================================            
                                                                                
           IF WS-NUM-DIFF-MTH >= 24                                             
              ADD 1 TO WS-CRM8-NUM-GT-24MON                                     
           ELSE                                                                 
              IF (WS-NUM-DIFF-MTH >= 18) AND (WS-NUM-DIFF-MTH <= 23)            
                  ADD 1 TO WS-CRM8-NUM-GT-18MON                                 
              ELSE                                                              
                 IF (WS-NUM-DIFF-MTH >= 12) AND (WS-NUM-DIFF-MTH <= 17)         
                     ADD 1 TO WS-CRM8-NUM-GT-12MON                              
                 ELSE                                                           
                    IF (WS-NUM-DIFF-MTH >= 9) AND                               
                       (WS-NUM-DIFF-MTH <= 11)                                  
                       ADD 1 TO WS-CRM8-NUM-GT-09MON                            
                    ELSE                                                        
                       IF (WS-NUM-DIFF-MTH >= 6) AND                            
                          (WS-NUM-DIFF-MTH <= 8)                                
                          ADD 1 TO WS-CRM8-NUM-GT-06MON                         
                       ELSE                                                     
                         IF (WS-NUM-DIFF-MTH >= 3) AND                          
                            (WS-NUM-DIFF-MTH <= 5)                              
                            ADD 1 TO WS-CRM8-NUM-GT-03MON                       
                         ELSE                                                   
                            ADD 1 TO WS-CRM8-NUM-LT-03MON                       
                         END-IF                                                 
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3110-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *=============================================================            
       3200-MOVE-VALUES.                                                        
      *=============================================================            
                                                                                
           MOVE SPACES                TO BP13KC66-REC                           
           INITIALIZE                    BP13KC66-REC.                          
                                                                                
      ***AGR                                                                    
           MOVE 'A'                    TO KC66-NUM-TEAM-OIC                     
           MOVE WS-AGR-NUM-GT-24MON    TO KC66-NUM-GT-24MON                     
           MOVE WS-AGR-NUM-GT-18MON    TO KC66-NUM-GT-18MON                     
           MOVE WS-AGR-NUM-GT-12MON    TO KC66-NUM-GT-12MON                     
           MOVE WS-AGR-NUM-GT-09MON    TO KC66-NUM-GT-09MON                     
           MOVE WS-AGR-NUM-GT-06MON    TO KC66-NUM-GT-06MON                     
           MOVE WS-AGR-NUM-GT-03MON    TO KC66-NUM-GT-03MON                     
           MOVE WS-AGR-NUM-LT-03MON    TO KC66-NUM-LT-03MON                     
           MOVE WS-CURRENT-DATE        TO KC66-DTE-UPDATE                       
           MOVE 'BP13C11O'             TO KC66-NUM-USERID                       
           PERFORM 3210-BP13KC66-WRITE   THRU 3210-EXIT.                        
                                                                                
           MOVE SPACES                TO BP13KC66-REC                           
           INITIALIZE                    BP13KC66-REC.                          
                                                                                
      ***RST                                                                    
           MOVE 'R'                    TO KC66-NUM-TEAM-OIC                     
           MOVE WS-RST-NUM-GT-24MON    TO KC66-NUM-GT-24MON                     
           MOVE WS-RST-NUM-GT-18MON    TO KC66-NUM-GT-18MON                     
           MOVE WS-RST-NUM-GT-12MON    TO KC66-NUM-GT-12MON                     
           MOVE WS-RST-NUM-GT-09MON    TO KC66-NUM-GT-09MON                     
           MOVE WS-RST-NUM-GT-06MON    TO KC66-NUM-GT-06MON                     
           MOVE WS-RST-NUM-GT-03MON    TO KC66-NUM-GT-03MON                     
           MOVE WS-RST-NUM-LT-03MON    TO KC66-NUM-LT-03MON                     
           MOVE WS-CURRENT-DATE        TO KC66-DTE-UPDATE                       
           MOVE 'BP13C11O'             TO KC66-NUM-USERID                       
           PERFORM 3210-BP13KC66-WRITE   THRU 3210-EXIT.                        
                                                                                
           MOVE SPACES                TO BP13KC66-REC                           
           INITIALIZE                    BP13KC66-REC.                          
                                                                                
      ***CRM1                                                                   
           MOVE '1'                    TO KC66-NUM-TEAM-OIC                     
           MOVE WS-CRM1-NUM-GT-24MON    TO KC66-NUM-GT-24MON                    
           MOVE WS-CRM1-NUM-GT-18MON    TO KC66-NUM-GT-18MON                    
           MOVE WS-CRM1-NUM-GT-12MON    TO KC66-NUM-GT-12MON                    
           MOVE WS-CRM1-NUM-GT-09MON    TO KC66-NUM-GT-09MON                    
           MOVE WS-CRM1-NUM-GT-06MON    TO KC66-NUM-GT-06MON                    
           MOVE WS-CRM1-NUM-GT-03MON    TO KC66-NUM-GT-03MON                    
           MOVE WS-CRM1-NUM-LT-03MON    TO KC66-NUM-LT-03MON                    
           MOVE WS-CURRENT-DATE        TO KC66-DTE-UPDATE                       
           MOVE 'BP13C11O'             TO KC66-NUM-USERID                       
           PERFORM 3210-BP13KC66-WRITE   THRU 3210-EXIT.                        
                                                                                
           MOVE SPACES                TO BP13KC66-REC                           
           INITIALIZE                    BP13KC66-REC.                          
                                                                                
      ***CRM2                                                                   
           MOVE '2'                    TO KC66-NUM-TEAM-OIC                     
           MOVE WS-CRM2-NUM-GT-24MON    TO KC66-NUM-GT-24MON                    
           MOVE WS-CRM2-NUM-GT-18MON    TO KC66-NUM-GT-18MON                    
           MOVE WS-CRM2-NUM-GT-12MON    TO KC66-NUM-GT-12MON                    
           MOVE WS-CRM2-NUM-GT-09MON    TO KC66-NUM-GT-09MON                    
           MOVE WS-CRM2-NUM-GT-06MON    TO KC66-NUM-GT-06MON                    
           MOVE WS-CRM2-NUM-GT-03MON    TO KC66-NUM-GT-03MON                    
           MOVE WS-CRM2-NUM-LT-03MON    TO KC66-NUM-LT-03MON                    
           MOVE WS-CURRENT-DATE        TO KC66-DTE-UPDATE                       
           MOVE 'BP13C11O'             TO KC66-NUM-USERID                       
           PERFORM 3210-BP13KC66-WRITE   THRU 3210-EXIT.                        
                                                                                
           MOVE SPACES                TO BP13KC66-REC                           
           INITIALIZE                    BP13KC66-REC.                          
                                                                                
      ***CRM3                                                                   
           MOVE '3'                    TO KC66-NUM-TEAM-OIC                     
           MOVE WS-CRM3-NUM-GT-24MON    TO KC66-NUM-GT-24MON                    
           MOVE WS-CRM3-NUM-GT-18MON    TO KC66-NUM-GT-18MON                    
           MOVE WS-CRM3-NUM-GT-12MON    TO KC66-NUM-GT-12MON                    
           MOVE WS-CRM3-NUM-GT-09MON    TO KC66-NUM-GT-09MON                    
           MOVE WS-CRM3-NUM-GT-06MON    TO KC66-NUM-GT-06MON                    
           MOVE WS-CRM3-NUM-GT-03MON    TO KC66-NUM-GT-03MON                    
           MOVE WS-CRM3-NUM-LT-03MON    TO KC66-NUM-LT-03MON                    
           MOVE WS-CURRENT-DATE        TO KC66-DTE-UPDATE                       
           MOVE 'BP13C11O'             TO KC66-NUM-USERID                       
           PERFORM 3210-BP13KC66-WRITE   THRU 3210-EXIT.                        
                                                                                
           MOVE SPACES                TO BP13KC66-REC                           
           INITIALIZE                    BP13KC66-REC.                          
                                                                                
      ***CRM4                                                                   
           MOVE '4'                    TO KC66-NUM-TEAM-OIC                     
           MOVE WS-CRM4-NUM-GT-24MON    TO KC66-NUM-GT-24MON                    
           MOVE WS-CRM4-NUM-GT-18MON    TO KC66-NUM-GT-18MON                    
           MOVE WS-CRM4-NUM-GT-12MON    TO KC66-NUM-GT-12MON                    
           MOVE WS-CRM4-NUM-GT-09MON    TO KC66-NUM-GT-09MON                    
           MOVE WS-CRM4-NUM-GT-06MON    TO KC66-NUM-GT-06MON                    
           MOVE WS-CRM4-NUM-GT-03MON    TO KC66-NUM-GT-03MON                    
           MOVE WS-CRM4-NUM-LT-03MON    TO KC66-NUM-LT-03MON                    
           MOVE WS-CURRENT-DATE        TO KC66-DTE-UPDATE                       
           MOVE 'BP13C11O'             TO KC66-NUM-USERID                       
           PERFORM 3210-BP13KC66-WRITE   THRU 3210-EXIT.                        
                                                                                
           MOVE SPACES                TO BP13KC66-REC                           
           INITIALIZE                    BP13KC66-REC.                          
                                                                                
      ***CRM5                                                                   
           MOVE '5'                    TO KC66-NUM-TEAM-OIC                     
           MOVE WS-CRM5-NUM-GT-24MON    TO KC66-NUM-GT-24MON                    
           MOVE WS-CRM5-NUM-GT-18MON    TO KC66-NUM-GT-18MON                    
           MOVE WS-CRM5-NUM-GT-12MON    TO KC66-NUM-GT-12MON                    
           MOVE WS-CRM5-NUM-GT-09MON    TO KC66-NUM-GT-09MON                    
           MOVE WS-CRM5-NUM-GT-06MON    TO KC66-NUM-GT-06MON                    
           MOVE WS-CRM5-NUM-GT-03MON    TO KC66-NUM-GT-03MON                    
           MOVE WS-CRM5-NUM-LT-03MON    TO KC66-NUM-LT-03MON                    
           MOVE WS-CURRENT-DATE        TO KC66-DTE-UPDATE                       
           MOVE 'BP13C11O'             TO KC66-NUM-USERID                       
           PERFORM 3210-BP13KC66-WRITE   THRU 3210-EXIT.                        
                                                                                
           MOVE SPACES                TO BP13KC66-REC                           
           INITIALIZE                    BP13KC66-REC.                          
                                                                                
      ***CRM6                                                                   
           MOVE '6'                    TO KC66-NUM-TEAM-OIC                     
           MOVE WS-CRM6-NUM-GT-24MON    TO KC66-NUM-GT-24MON                    
           MOVE WS-CRM6-NUM-GT-18MON    TO KC66-NUM-GT-18MON                    
           MOVE WS-CRM6-NUM-GT-12MON    TO KC66-NUM-GT-12MON                    
           MOVE WS-CRM6-NUM-GT-09MON    TO KC66-NUM-GT-09MON                    
           MOVE WS-CRM6-NUM-GT-06MON    TO KC66-NUM-GT-06MON                    
           MOVE WS-CRM6-NUM-GT-03MON    TO KC66-NUM-GT-03MON                    
           MOVE WS-CRM6-NUM-LT-03MON    TO KC66-NUM-LT-03MON                    
           MOVE WS-CURRENT-DATE        TO KC66-DTE-UPDATE                       
           MOVE 'BP13C11O'             TO KC66-NUM-USERID                       
           PERFORM 3210-BP13KC66-WRITE   THRU 3210-EXIT.                        
                                                                                
           MOVE SPACES                TO BP13KC66-REC                           
           INITIALIZE                    BP13KC66-REC.                          
                                                                                
      ***CRM7                                                                   
           MOVE '7'                    TO KC66-NUM-TEAM-OIC                     
           MOVE WS-CRM7-NUM-GT-24MON    TO KC66-NUM-GT-24MON                    
           MOVE WS-CRM7-NUM-GT-18MON    TO KC66-NUM-GT-18MON                    
           MOVE WS-CRM7-NUM-GT-12MON    TO KC66-NUM-GT-12MON                    
           MOVE WS-CRM7-NUM-GT-09MON    TO KC66-NUM-GT-09MON                    
           MOVE WS-CRM7-NUM-GT-06MON    TO KC66-NUM-GT-06MON                    
           MOVE WS-CRM7-NUM-GT-03MON    TO KC66-NUM-GT-03MON                    
           MOVE WS-CRM7-NUM-LT-03MON    TO KC66-NUM-LT-03MON                    
           MOVE WS-CURRENT-DATE        TO KC66-DTE-UPDATE                       
           MOVE 'BP13C11O'             TO KC66-NUM-USERID                       
           PERFORM 3210-BP13KC66-WRITE   THRU 3210-EXIT.                        
                                                                                
           MOVE SPACES                TO BP13KC66-REC                           
           INITIALIZE                    BP13KC66-REC.                          
                                                                                
      ***CRM8                                                                   
           MOVE '8'                    TO KC66-NUM-TEAM-OIC                     
           MOVE WS-CRM8-NUM-GT-24MON    TO KC66-NUM-GT-24MON                    
           MOVE WS-CRM8-NUM-GT-18MON    TO KC66-NUM-GT-18MON                    
           MOVE WS-CRM8-NUM-GT-12MON    TO KC66-NUM-GT-12MON                    
           MOVE WS-CRM8-NUM-GT-09MON    TO KC66-NUM-GT-09MON                    
           MOVE WS-CRM8-NUM-GT-06MON    TO KC66-NUM-GT-06MON                    
           MOVE WS-CRM8-NUM-GT-03MON    TO KC66-NUM-GT-03MON                    
           MOVE WS-CRM8-NUM-LT-03MON    TO KC66-NUM-LT-03MON                    
           MOVE WS-CURRENT-DATE        TO KC66-DTE-UPDATE                       
           MOVE 'BP13C11O'             TO KC66-NUM-USERID                       
           PERFORM 3210-BP13KC66-WRITE   THRU 3210-EXIT.                        
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3210-BP13KC66-WRITE.                                                     
      *=============================================================            
                                                                                
           WRITE BP13KC66-REC.                                                  
                                                                                
           EVALUATE WS-KC66-STATUS                                              
           WHEN 00                                                              
           WHEN 02                                                              
              ADD 1                        TO   WS-CNT-KC66-WRITE               
                                                                                
           WHEN 22                                                              
              DISPLAY 'DUPLICATE KC66 RECORD: ' KC66-KEY-FLD                    
                                                                                
           WHEN OTHER                                                           
              DISPLAY 'WRITE BP13KC66 ERROR ' WS-KC66-STATUS                    
              MOVE     WS-KC66-STATUS      TO   RETURN-CODE                     
              PERFORM  9000-CLOSE-ROUTINE  THRU 9000-EXIT                       
           END-EVALUATE.                                                        
                                                                                
       3210-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4000-BP13K800-READ.                                                      
      *=============================================================            
                                                                                
           MOVE SPACES        TO BP13K800-MASTER                                
           MOVE FC55-NUM-REGN TO K800-NUM-REGN                                  
                                                                                
           READ BP13K800.                                                       
                                                                                
           EVALUATE WS-K800-STATUS                                              
           WHEN 00                                                              
              CONTINUE                                                          
                                                                                
           WHEN 23                                                              
              MOVE SPACES    TO BP13K800-MASTER                                 
                                                                                
           WHEN OTHER                                                           
              DISPLAY 'READ BP13K800 ERROR '    WS-K800-STATUS                  
              MOVE    WS-K800-STATUS       TO   RETURN-CODE                     
              PERFORM 9000-CLOSE-ROUTINE   THRU 9000-EXIT                       
           END-EVALUATE.                                                        
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *=============================================================            
       4100-GET-AHG-SHG.                                                        
      *=============================================================            
                                                                                
           IF K800-DTE-AHG-REQ = SPACES OR LOW-VALUES OR ZEROES                 
              IF K800-DTE-AHG-FORM-PRT NOT = SPACES AND LOW-VALUES              
                                                    AND ZEROS                   
                 MOVE 'F'                    TO ENQY-AHG-REQ                    
              ELSE                                                              
                 MOVE SPACES                 TO ENQY-AHG-REQ                    
              END-IF                                                            
           ELSE                                                                 
              MOVE 'Y'                    TO ENQY-AHG-REQ                       
           END-IF.                                                              
                                                                                
           MOVE K800-NUM-AHG-STATUS       TO ENQY-AHG-STATUS                    
                                                                                
           IF K800-DTE-SHG-REQ = SPACES OR LOW-VALUES OR ZEROES                 
              IF K800-DTE-SHG-FORM-PRT NOT = SPACES AND LOW-VALUES              
                                                    AND ZEROS                   
                 MOVE 'F'                    TO ENQY-SHG-REQ                    
              ELSE                                                              
                 MOVE SPACES                 TO ENQY-SHG-REQ                    
              END-IF                                                            
           ELSE                                                                 
              MOVE 'Y'                    TO ENQY-SHG-REQ                       
           END-IF.                                                              
                                                                                
           MOVE K800-NUM-SHG-STATUS       TO ENQY-SHG-STATUS.                   
                                                                                
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       5000-PROCESS-DATE.                                                       
      *=============================================================            
                                                                                
           MOVE FC55-DTE-START                 TO WS-DTE-START.                 
                                                                                
           COMPUTE WS-NUM-CURR-DTE  =                                           
                   FUNCTION INTEGER-OF-DATE(WS-CURRENT-DATE).                   
                                                                                
           COMPUTE WS-NUM-START-DTE =                                           
                   FUNCTION INTEGER-OF-DATE(WS-DTE-START).                      
                                                                                
           IF WS-NUM-CURR-DTE >= WS-NUM-START-DTE                               
              COMPUTE WS-NUM-DIFF-DTE = WS-NUM-CURR-DTE -                       
                                        WS-NUM-START-DTE                        
                                                                                
              COMPUTE WS-NUM-DIFF-MTH = WS-NUM-DIFF-DTE / 30                    
           END-IF.                                                              
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6000-DISPLAY-COUNTERS.                                                   
      *=============================================================            
                                                                                
           COMPUTE WS-TOTAL-AGR = WS-AGR-NUM-GT-24MON +                         
                                  WS-AGR-NUM-GT-18MON +                         
                                  WS-AGR-NUM-GT-12MON +                         
                                  WS-AGR-NUM-GT-09MON +                         
                                  WS-AGR-NUM-GT-06MON +                         
                                  WS-AGR-NUM-GT-03MON +                         
                                  WS-AGR-NUM-LT-03MON                           
                                                                                
           COMPUTE WS-TOTAL-RST = WS-RST-NUM-GT-24MON +                         
                                  WS-RST-NUM-GT-18MON +                         
                                  WS-RST-NUM-GT-12MON +                         
                                  WS-RST-NUM-GT-09MON +                         
                                  WS-RST-NUM-GT-06MON +                         
                                  WS-RST-NUM-GT-03MON +                         
                                  WS-RST-NUM-LT-03MON                           
                                                                                
           COMPUTE WS-TOTAL-CRM1 = WS-CRM1-NUM-GT-24MON +                       
                                   WS-CRM1-NUM-GT-18MON +                       
                                   WS-CRM1-NUM-GT-12MON +                       
                                   WS-CRM1-NUM-GT-09MON +                       
                                   WS-CRM1-NUM-GT-06MON +                       
                                   WS-CRM1-NUM-GT-03MON +                       
                                   WS-CRM1-NUM-LT-03MON                         
                                                                                
           COMPUTE WS-TOTAL-CRM2 = WS-CRM2-NUM-GT-24MON +                       
                                   WS-CRM2-NUM-GT-18MON +                       
                                   WS-CRM2-NUM-GT-12MON +                       
                                   WS-CRM2-NUM-GT-09MON +                       
                                   WS-CRM2-NUM-GT-06MON +                       
                                   WS-CRM2-NUM-GT-03MON +                       
                                   WS-CRM2-NUM-LT-03MON                         
                                                                                
           COMPUTE WS-TOTAL-CRM3 = WS-CRM3-NUM-GT-24MON +                       
                                   WS-CRM3-NUM-GT-18MON +                       
                                   WS-CRM3-NUM-GT-12MON +                       
                                   WS-CRM3-NUM-GT-09MON +                       
                                   WS-CRM3-NUM-GT-06MON +                       
                                   WS-CRM3-NUM-GT-03MON +                       
                                   WS-CRM3-NUM-LT-03MON                         
                                                                                
           COMPUTE WS-TOTAL-CRM4 = WS-CRM4-NUM-GT-24MON +                       
                                   WS-CRM4-NUM-GT-18MON +                       
                                   WS-CRM4-NUM-GT-12MON +                       
                                   WS-CRM4-NUM-GT-09MON +                       
                                   WS-CRM4-NUM-GT-06MON +                       
                                   WS-CRM4-NUM-GT-03MON +                       
                                   WS-CRM4-NUM-LT-03MON                         
                                                                                
           COMPUTE WS-TOTAL-CRM5 = WS-CRM5-NUM-GT-24MON +                       
                                   WS-CRM5-NUM-GT-18MON +                       
                                   WS-CRM5-NUM-GT-12MON +                       
                                   WS-CRM5-NUM-GT-09MON +                       
                                   WS-CRM5-NUM-GT-06MON +                       
                                   WS-CRM5-NUM-GT-03MON +                       
                                   WS-CRM5-NUM-LT-03MON                         
                                                                                
           COMPUTE WS-TOTAL-CRM6 = WS-CRM6-NUM-GT-24MON +                       
                                   WS-CRM6-NUM-GT-18MON +                       
                                   WS-CRM6-NUM-GT-12MON +                       
                                   WS-CRM6-NUM-GT-09MON +                       
                                   WS-CRM6-NUM-GT-06MON +                       
                                   WS-CRM6-NUM-GT-03MON +                       
                                   WS-CRM6-NUM-LT-03MON                         
                                                                                
           COMPUTE WS-TOTAL-CRM7 = WS-CRM7-NUM-GT-24MON +                       
                                   WS-CRM7-NUM-GT-18MON +                       
                                   WS-CRM7-NUM-GT-12MON +                       
                                   WS-CRM7-NUM-GT-09MON +                       
                                   WS-CRM7-NUM-GT-06MON +                       
                                   WS-CRM7-NUM-GT-03MON +                       
                                   WS-CRM7-NUM-LT-03MON                         
                                                                                
           COMPUTE WS-TOTAL-CRM8 = WS-CRM8-NUM-GT-24MON +                       
                                   WS-CRM8-NUM-GT-18MON +                       
                                   WS-CRM8-NUM-GT-12MON +                       
                                   WS-CRM8-NUM-GT-09MON +                       
                                   WS-CRM8-NUM-GT-06MON +                       
                                   WS-CRM8-NUM-GT-03MON +                       
                                   WS-CRM8-NUM-LT-03MON.                        
                                                                                
                                                                                
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       9000-CLOSE-ROUTINE.                                                      
      *=============================================================            
                                                                                
           CLOSE BP13FC55                                                       
                 BP13K800                                                       
                 BP13KC66.                                                      
                                                                                
           IF WS-KC66-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSING BP13KC66 ERROR ' WS-KC66-STATUS                  
              MOVE     WS-KC66-STATUS      TO   RETURN-CODE                     
           END-IF.                                                              
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSING BP13K800 ERROR ' WS-K800-STATUS                  
              MOVE     WS-K800-STATUS      TO   RETURN-CODE                     
           END-IF.                                                              
                                                                                
           DISPLAY '   '.                                                       
           DISPLAY '*------- BP13C11O CONTROL TOTAL -------*'.                  
           DISPLAY '   '.                                                       
           DISPLAY ' 1. NO OF BP13FC55 READ      : ' WS-CNT-FC55-READ.          
           DISPLAY ' 2. NO OF BP13KC66 WRITE     : ' WS-CNT-KC66-WRITE.         
           DISPLAY ' 3. NO OF AGR CASES          : ' WS-TOTAL-AGR.              
           DISPLAY ' 4. NO OF RST CASES          : ' WS-TOTAL-RST.              
           DISPLAY ' 5. NO OF CRM1 CASES         : ' WS-TOTAL-CRM1.             
           DISPLAY ' 6. NO OF CRM2 CASES         : ' WS-TOTAL-CRM2.             
           DISPLAY ' 7. NO OF CRM3 CASES         : ' WS-TOTAL-CRM3.             
           DISPLAY ' 8. NO OF CRM4 CASES         : ' WS-TOTAL-CRM4.             
           DISPLAY ' 8. NO OF CRM5 CASES         : ' WS-TOTAL-CRM5.             
           DISPLAY ' 9. NO OF CRM6 CASES         : ' WS-TOTAL-CRM6.             
           DISPLAY '10. NO OF CRM7 CASES         : ' WS-TOTAL-CRM7.             
           DISPLAY '11. NO OF CRM8 CASES         : ' WS-TOTAL-CRM8.             
           DISPLAY '  '.                                                        
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
