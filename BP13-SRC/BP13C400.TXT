      ***************************                                               
       IDENTIFICATION DIVISION.                                                 
      ***************************                                               
       PROGRAM-ID.    BP13C400.                                                 
       AUTHOR.        KH LEE.                                                   
      *DATE-WRITTEN.  30/09/89.                                                 
                                                                                
      * ============================================================ *          
      *                SYSTEM OF COMMITMENT  (BP13)                  *          
      * ============================================================ *          
      *    OBJECTIVE                                                 *          
      *      1.  THIS IS THE PROGRAM TO PRINT OUT LETTERS TO INFORM  *          
      *          APPLICANTS TO SIGN SALES ORDER (TAKE POSSESSION)    *          
      *          FOR TYPE 10 SOC FLATS.                              *          
      *          (ONLY FOR TP CA=N CASES AND PREMIUM NOT CONSIDERED) *          
      *      2.  PRINT CONTROL REPORT.                               *          
      *      3.  PRINT WORKSHEET ON COMPUTATION LOAN INSTALLMENT.    *          
      *                                                              *          
      * ============================================================ *          
      * CHG-NO   BY   DATE    DESCRIPTION                            *          
      * -------- ---  ------  -----------                            *          
      * C901253  YPH  910129  ALIGN THE NAME AND ADDRESS             *          
      * C910481  ACK  910515  PRINT EXPIRED DATE OF TP ON THE        *          
      *                       APPOINTMENT LETTER FOR TP              *          
      * C9201    YPH  920108  ALIGN THE NAME, ADDRESS & DATES        *          
      * C910943  TJF  920217  CHANGE SPC TO BUC                      *          
      * C920769  RAZ  920722  INCLUDE WORKSHEET PRINTING CEASE       *          
      *                       PRINTING OF GIRO FORM                  *          
      * C9305C5 LITO  930529  INCLUDE THE COMPUTATION OF SC/CC AD    *          
      *                       VALOREM STAMP FEE                      *          
      * I920718 LITO  930529  CONVERT TO COBOL II                    *          
      * SOC81    RML  930614  RETRIEVE ADDRESS FROM BP13K830         *          
      * C930317  LMS  930709  TO CHANGE B01K253 TO AB03K050 DUE TO   *          
      *                       SMS PHASE 3B                           *          
      * SOC-PH8  KPS  930720  REFER TO BP13K800/K820, REGN/NRIC      *          
      * C9309A1  JEP  931027  TO CHECK FOR FOREIGN ADDRESS           *          
      * N940006  JK   940401  TO PRINT 4 NAMES                       *          
      * C930993  JEP  940807  TO INCLUDE REBATE COMPONENT FOR SC/CC  *          
      *                       AND GST COMPUTATION                    *          
      * C9404G4  LJL  940503  TO COMPUTE THE MORT INSTALMENT BY      *          
      *                       ROUNDING THE LOAN BY THE NEAREST $100  *          
      * C940256  BAL  940704  RE-ALIGN THE PRINTING FORMAT AND CALL  *          
      *                       AB20C901 TO BE ABLE TO PRINT           *          
      *                       AMT-INSURED AND AMT-PREMIUM.           *          
      * BP130018 EG   950814  TO PRINT CONTROL LIST FOR KEY-AVAIL    *          
      *                       CASES ONLY, NO LETTER IS TO BE PRINTED *          
      * BP130018 EG1  950904  TO PROCESS TL AND TB CASES.            *          
      * BP130020 SSS  951013  REPOSITION 400-LIST TO COL 1           *          
      *                        RENAME 'BP13L400B' TO 'P13L400B'       *         
      * BP130046 EG1  951101  ADDED THE HANDLING OF JUNK-MAIL OPTION.*          
      * BP130107 SSS  960404  CALL AB20C900 INSTEAD OF AB20C901      *          
      * BP130124 SSS  960729  CHG CDATEHOL TO AV02C011               *          
      * BP130181 LJL  960910  COLLECTION OF 15%, 20%, 25%,           *          
      *                          30% & 40% PREMIUM                   *          
      * BP130173 SSS  960917  DUPLEX FOR BP1313 & BP1305.            *          
      *                       (IMPLEMENT WITH CHG REQ BP130181)      *          
      * BP130286 SGK  290597  CHECKING EX-APPLICANT FILE REFUND = 0  *          
      *                       IF ZERO ALLOW PRINT LETTER             *          
      * XXXXXXXX SGK  010897  TO INCLUDE GRANT IN SC/CC CALC.        *          
      * BP130418 SSS  980706  CHG AV02C011 TO AV02C002               *          
      * BP130480 SGK  160498  TO REFLECT THE AB03K050 KEY & SIZE     *          
      *                       CHANGES.                               *          
      * BP130418 SGK  981012  CHG Y2K CHANGES                        *          
      * BP130636 JMS  990212  TO CATER FOR TC RECOVERY AMOUNT.       *          
      * BP130669 JMS  990603  TO ADD SALES-TYPE-SURVEY.              *          
      * BP130885 RAS  260600  TO CHANGE BP13C902 TO BP13C903         *          
      * BP130998 MAC  020501  ENHANCE AB20C900 FOR SA FLAT           *          
      * BP130925 ANC  030701  REMOVE K800-NUM-LESSEE                 *          
      * BP132031 MALC 031001  CATER FOR SALE OF SERS FLAT TO SINGLES *          
      * BP132125 MCC  070402  ROUNDING OF ODD CENTS                  *          
      * BP132095 CKK  220402  ADD BARCODE FOR QMS. REMOVE PRINTING   *          
      *                       OF JUNK-MAIL LETTER.                   *          
      * BP132127 CKK  130502  CHANGE LETTER LAYOUT DUE TO RELOCATION *          
      * BP132160 AS1  220602  MOVE THE BAR CODE FROM TOP TO BOTTOM   *          
      * BP132263 MALC 230902  TO CATER FOR CHANGE OF GST             *          
      * BP132352 CKK7 120603  TO READ K022 AND K024                  *          
      * BP132352 SK   070603  TO REMOVE PRINTING HP NUMBER           *          
      * BP132429 MALC 141103  TO HARDCODE 5% GST                     *          
      * BP132566 JF4  140704  PRINT LISTING FOR CASES ACCEPTED WITH  *          
      *                       KEY AVAILABLE AND NO AO DATE           *          
      * BP132568 JF4  220704  CATER FOR ENHANCEMENT OF APPT LETTER   *          
      * BP132576 SSD  120804  PRINT BLANK REPORT FOR L400F IF NO CASE*          
      * BP132588 JF4  240804  PASS SYSTEM DATE TO AB20C900 PROGRAM   *          
      * BP132609 JF4  071004  PRINT ALL CASES FOR P13L400B           *          
      *                       PRINT BLANK L400F ONLY IF L400B PRINTED*          
      * BP132656 JF4  270105  REMOVE CHECK ON AMT-CD                 *          
      * BP132656 JF4  210205  TO CATER FOR SERS SA/TP CA=N CASES     *          
      * BP132660 JF4  150305  TO GET PREMIUM FROM BP13K800           *          
      * BP132717 JF4  080705  CATER FOR CD CASH REFUND               *          
      * BP132702 JF4  100805  REMOVE PRINTING OF BP1305              *          
      * BP133600 ZDD1 160311  REVISED REPORT FIELDS FOR L400F        *          
      *                       CHANGE SELLING PRICE TO AHG REQ/STATUS *          
      *                       ADD BUY SELL TAG AND FILE RECEIVE DTE  *          
      * BP135109 RJE1 201213  LETTERHEADS WITH NEW PUBLIC MAILBOX    *          
      *                       EMAIL ADDRESSES                        *          
      * BP136911 MRN1 200317  CALL BP13CB4A TO READ DB2 GRANT TABLE  *          
      *                       AND REPLACE K800 AHG-STATUS            *          
      * BP139211 KAC1 040123  CHANGED BP13CB4A TO DYNAMIC CALL       *          
      * BP139485 KAC1 020124  CALL BP13C90D FOR 9% GST WEF 20240101  *          
      * ============================================================ *          
                                                                                
      ************************                                                  
       ENVIRONMENT DIVISION.                                                    
      ************************                                                  
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F310  ASSIGN        TO BP13F310.                          
                                                                                
           SELECT BP13K800  ASSIGN        TO BP13K800                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K800-NUM-REGN                      
                            FILE STATUS   IS BP13K800-STATUS.                   
                                                                                
           SELECT BP13K022  ASSIGN       TO BP13K022                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K022-KEY-FLD                        
                            ALTERNATE RECORD KEY IS K022-NUM-REGN               
                            WITH DUPLICATES                                     
                            FILE STATUS  IS BP13K022-STATUS.                    
                                                                                
           SELECT BP13K024  ASSIGN       TO BP13K024                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K024-KEY-FLD                        
                            FILE STATUS  IS BP13K024-STATUS.                    
                                                                                
           SELECT BP13K820  ASSIGN        TO BP13K820                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K820-KEY-FLD                       
                            FILE STATUS   IS BP13K820-STATUS.                   
                                                                                
           SELECT BP13K830  ASSIGN        TO BP13K830                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K830-KEY-FLD                       
                            ALTERNATE RECORD KEY  IS K830-NUM-REGN              
                            FILE STATUS   IS BP13K830-STATUS.                   
                                                                                
           SELECT BM06K100  ASSIGN        TO BM06K100                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K100-KEY-FLD                       
                            FILE STATUS   IS BM06K100-STATUS.                   
                                                                                
           SELECT BM06K110  ASSIGN        TO BM06K110                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K110-KEY-FLD                       
                            FILE STATUS   IS BM06K110-STATUS.                   
                                                                                
           SELECT AB03K050  ASSIGN        TO AB03K050                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K050-KEY                           
                            FILE STATUS   IS AB03K050-STATUS.                   
                                                                                
           SELECT BP13K885  ASSIGN        TO BP13K885                           
                            ACCESS MODE   IS DYNAMIC                            
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K885-KEY-FLD                       
                            FILE STATUS   IS BP13K885-STATUS.                   
                                                                                
           SELECT BP13K880  ASSIGN        TO BP13K880                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K880-KEY-FLD                       
                            FILE STATUS   IS BP13K880-STATUS.                   
                                                                                
           SELECT P13L400A  ASSIGN        TO P13L400A.                          
           SELECT P13L400B  ASSIGN        TO P13L400B.                          
           SELECT P13L400C  ASSIGN        TO P13L400C.                          
           SELECT P13L400D  ASSIGN        TO P13L400D.                          
           SELECT P13L400F  ASSIGN        TO P13L400F.                          
           SELECT BP13L400  ASSIGN        TO BP13L400.                          
                                                                                
      *****************                                                         
       DATA DIVISION.                                                           
      *****************                                                         
       FILE SECTION.                                                            
                                                                                
       FD   BP13F310                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 150 CHARACTERS.                                     
       COPY BP13F310.                                                           
                                                                                
       FD   BP13K022                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K022.                                                           
                                                                                
       FD   BP13K024                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K024.                                                           
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD   BP13K885                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K885.                                                           
                                                                                
       FD   BP13K880                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K880.                                                           
                                                                                
       FD   BP13K830                                                            
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD   BM06K110                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K110.                                                           
                                                                                
       FD   BM06K100                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K100.                                                           
                                                                                
       FD   AB03K050                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY AB03K050.                                                           
                                                                                
       FD   P13L400A                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 80  CHARACTERS.                                     
       01   PRINT-REC-1                 PIC X(80).                              
                                                                                
       FD   BP13L400                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   PRINT-REC-2                 PIC X(132).                             
                                                                                
       FD   P13L400B                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   PRINT-REC-3                 PIC X(132).                             
                                                                                
       FD   P13L400C                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   ERR-REC                     PIC X(132).                             
                                                                                
       FD   P13L400D                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   PRINT-REC2                  PIC X(132).                             
                                                                                
       FD   P13L400F                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 132 CHARACTERS.                                     
       01   PRINT-REC-L400F             PIC X(132).                             
                                                                                
      ************************                                                  
       WORKING-STORAGE SECTION.                                                 
      ************************                                                  
       COPY AV02COMM.                                                           
       COPY AB20M97C.                                                           
                                                                                
      *-------------------------------------------------------*                 
      *    COPY BOOK FOR SUBROUTINE - BP13CB4A.               *                 
      *-------------------------------------------------------*                 
       COPY P13COM73.                                                           
                                                                                
       01  WS-C908-PARAMETERS.                                                  
           05  WS-INPUT-PARAMETERS.                                             
               10  WS-C908-TXT-IN-SIZE       PIC 9(2).                          
               10  WS-C908-TXT-INPUT         PIC X(30).                         
           05  WS-OUTPUT-PARAMETERS.                                            
               10  WS-C908-TXT-OUT-SIZE      PIC 9(2).                          
               10  WS-C908-TXT-OUTPUT        PIC X(40).                         
           05  WS-C908-RETCODE               PIC S9(04)  COMP.                  
                                                                                
      *------------------------*                                                
      *  LINKAGE FOR AV02C015  *                                                
      *------------------------*                                                
        01  WS-LINK-AV02C015.                                                   
            05  AV02C015-IN-POSTCODE         PIC X(6).                          
            05  AV02C015-OUT-POSTCODE-CHKSUM PIC X(9).                          
                                                                                
       01  WS-INDICATORS.                                                       
           05  BP13K022-STATUS          PIC 99     VALUE ZEROS.                 
           05  BP13K024-STATUS          PIC 99     VALUE ZEROS.                 
           05  AB03K050-STATUS          PIC 99     VALUE ZEROS.                 
           05  BM06K110-STATUS          PIC 99     VALUE ZEROS.                 
           05  BM06K100-STATUS          PIC 99     VALUE ZEROS.                 
           05  BP13K800-STATUS          PIC 99     VALUE ZEROS.                 
           05  BP13K820-STATUS          PIC 99     VALUE ZEROS.                 
           05  BP13K830-STATUS          PIC 99     VALUE ZEROS.                 
           05  BP13K880-STATUS          PIC 99     VALUE ZEROS.                 
           05  BP13K885-STATUS          PIC 99     VALUE ZEROS.                 
           05  WS-EOF                   PIC X(1)   VALUE 'N'.                   
           05  WS-K050-EOF              PIC X(1)   VALUE 'N'.                   
           05  WS-K820-EOF              PIC X(1)   VALUE 'N'.                   
           05  WS-K885-EOF              PIC X(1)   VALUE 'N'.                   
           05  K800-NOT-FOUND           PIC X      VALUE 'N'.                   
           05  WS-LOOP-EXIT             PIC X      VALUE 'N'.                   
           05  WS-NO-PRINT              PIC X      VALUE 'N'.                   
           05  WS-AB03K050-REC          PIC X(200) VALUE SPACES.                
           05  K022-FOUND               PIC X     VALUE 'N'.                    
           05  K024-FOUND               PIC X     VALUE 'N'.                    
           05  WS-NUM-OIC               PIC X(5).                               
           05  WS-OIC-TABLE.                                                    
               10 WS-OIC-TAB OCCURS 5 TIMES PIC X.                              
           05  WS-OIC-EMAIL-TABLE.                                              
               10 WS-OIC-EMAIL-TAB OCCURS 5 TIMES PIC X.                        
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-NUMBER-1              PIC 9(2)   VALUE 60.                    
           05  WS-LINE                  PIC 9(2)   VALUE 60.                    
           05  WS-NUMBER-2              PIC 9(2)   VALUE 60.                    
           05  WS-NUMBER-L400F          PIC 9(2)   VALUE 60.                    
           05  NO-OF-LETTER             PIC 9(6)   VALUE ZEROS.                 
           05  NO-OF-L400B              PIC 9(6)   VALUE ZEROS.                 
           05  NO-OF-L400F              PIC 9(6)   VALUE ZEROS.                 
           05  NO-OF-PAGE-1             PIC 9(5)   VALUE ZEROS.                 
           05  NO-OF-PAGE-2             PIC 9(5)   VALUE ZEROS.                 
           05  NO-OF-PAGE-L400F         PIC 9(5)   VALUE ZEROS.                 
           05  WS-ERR-LINE              PIC 9(2)   VALUE ZEROS.                 
           05  WS-F310-CNT              PIC 9(2)   VALUE ZEROS.                 
           05  WS-CNT-K024              PIC 9(3)   VALUE ZEROS.                 
           05  WS-CNT-K022              PIC 9(3)   VALUE ZEROS.                 
           05  WS-CTR                   PIC 9      VALUE ZEROS.                 
           05  WS-CTR2                  PIC 9      VALUE ZEROS.                 
           05  WS-A                     PIC 9(02) VALUE ZEROES.                 
                                                                                
       01  WS-OTHER-VARIABLES.                                                  
           05  WS-IDP-SCH               PIC X(3)   VALUE SPACES.                
           05  WS-SCH-ACCNT.                                                    
               10  WS-SCHEME            PIC X(4)   VALUE SPACES.                
               10  WS-ACC               PIC X(4)   VALUE SPACES.                
               10  WS-CHK               PIC X(1)   VALUE SPACE.                 
           05  WS-SC-CC-NUM-AMT         PIC 9(04)V99 VALUE ZEROES.              
           05  WS-SC-CC-NUM-GST-AMT     PIC 9(04)V99 VALUE ZEROES.              
           05  WS-EMAIL                 PIC X(19)  VALUE SPACES.                
           05  WS-HDR-PHONE-DID         PIC X(25)  VALUE SPACES.                
           05  WS-AHG-STATUS            PIC X(3)   VALUE SPACES.                
                                                                                
           05  WS-APPLICANT-NAMES.                                              
               10  WS-NME-APPL          PIC X(66)  VALUE SPACES.                
               10  WS-NME-COAPPL        PIC X(66)  VALUE SPACES.                
               10  WS-NME-THIRD-APPL    PIC X(66)  VALUE SPACES.                
               10  WS-NME-FOURTH-APPL   PIC X(66)  VALUE SPACES.                
                                                                                
           05  WS-SC-CC-DESC.                                                   
               10  FILLER               PIC X(1)   VALUE '('.                   
               10  WS-SC-CC-AMT         PIC ZZ9.99 VALUE SPACES.                
               10  FILLER               PIC X(1)   VALUE '+'.                   
               10  WS-SC-CC-GST-AMT     PIC   9.99 VALUE SPACES.                
               10  FILLER               PIC X(3)   VALUE 'GST'.                 
               10  WS-SC-CC-SIGN        PIC X(1)   VALUE '-'.                   
               10  WS-SC-CC-REBATE-AMT  PIC   Z.ZZ VALUE SPACES.                
               10  WS-SC-CC-REBATE-DESC PIC X(3)   VALUE 'REB'.                 
               10  WS-SC-CC-SIGN2       PIC X(1)   VALUE '-'.                   
               10  WS-SC-CC-GRANT-AMT   PIC   Z.ZZ VALUE SPACES.                
               10  WS-SC-CC-GRANT-DESC  PIC X(3)   VALUE 'GRT'.                 
               10  WS-SC-CC-SIGN3       PIC X(1)   VALUE '-'.                   
               10  WS-SC-CC-REB-SP-AMT  PIC   Z.ZZ VALUE SPACES.                
               10  WS-SC-CC-REB-SP-DESC PIC X(3)   VALUE 'SP)'.                 
                                                                                
       01  WS-COMP-VARIABLES.                                                   
           05  WS-COMP-LEASE            PIC 9(5)V99 VALUE ZEROS.                
           05  WS-COMP-MORTGAGE         PIC 9(5)V99 VALUE ZEROS.                
           05  WS-TOT-STAMP-FEE         PIC 9(5)V99 VALUE ZEROS.                
           05  WS-MORT-STAMP-FEE        PIC 9(5)V99 VALUE ZEROS.                
           05  WS-COMP-SURVEY-FEE       PIC 9(5)V99 VALUE ZEROS.                
           05  WS-TOTAL-FEES            PIC 9(6)V99 VALUE ZEROS.                
           05  WS-TOTAL-SELLPR          PIC 9(8)V99 VALUE ZEROS.                
           05  WS-TOTAL-CD              PIC 9(7)V99 VALUE ZEROS.                
           05  WS-UPD-CD-CASH           PIC 9(7)V99 VALUE ZEROS.                
           05  WS-BALANCE-AMT           PIC 9(8)V99 VALUE ZEROS.                
           05  WS-MAX-LOAN-AMT          PIC 9(7)V99 VALUE ZEROS.                
           05  WS-MTHLY-INSTAL          PIC 9(5)V99 VALUE ZEROS.                
           05  WS-TOT-SCCC              PIC 9(5)V99 VALUE ZEROS.                
           05  WS-INTREST-RATE          PIC 9(2)V99 VALUE ZEROS.                
           05  WS-SC-CC1-AMT            PIC 9(5)V99 VALUE ZEROS.                
           05  WS-SC-CC2-AMT            PIC 9(5)V99 VALUE ZEROS.                
           05  WS-S903-SC-CC1-GST       PIC 9(4)V99 VALUE ZEROS.                
           05  WS-S903-SC-CC2-GST       PIC 9(4)V99 VALUE ZEROS.                
           05  WS-S903-SC-CC3-GST       PIC 9(4)V99 VALUE ZEROS.                
           05  WS-S903-SC-TC1-GST       PIC 9(4)V99 VALUE ZEROS.                
           05  WS-S903-SC-TC2-GST       PIC 9(4)V99 VALUE ZEROS.                
           05  WS-S903-SC-TC3-GST       PIC 9(4)V99 VALUE ZEROS.                
                                                                                
           05  WS-LOAN-ROUND-DOWN.                                              
               10  WS-LOAN-INT-5        PIC 9(5)    VALUE ZEROS.                
               10  WS-LOAN-INT-2        PIC 9(2)V99 VALUE ZEROS.                
                                                                                
           05  WS-CURRENT-DATE.                                                 
               10  WS-CURR-CC           PIC 99     VALUE 00.                    
               10  WS-CURR-DATE.                                                
                   15  WS-CURR-YY       PIC 99     VALUE 00.                    
                   15  WS-CURR-MM       PIC 99     VALUE 00.                    
                   15  WS-CURR-DD       PIC 99     VALUE 00.                    
                                                                                
           05  WS-DTE-EXPIRED-TP.                                               
               10  WS-DTE-TP-CC         PIC 99     VALUE 00.                    
               10  WS-DTE-TP.                                                   
                   15  WS-DTE-TP-YY     PIC 99     VALUE 00.                    
                   15  WS-DTE-TP-MM     PIC 99     VALUE 00.                    
                   15  WS-DTE-TP-DD     PIC 99     VALUE 00.                    
                                                                                
           05  WS-EDITED-EXPIRED.                                               
               10  WS-DTE-DD            PIC 99     VALUE 00.                    
               10  FILLER               PIC X      VALUE '/'.                   
               10  WS-DTE-MM            PIC 99     VALUE 00.                    
               10  FILLER               PIC X      VALUE '/'.                   
               10  WS-DTE-CC            PIC 99     VALUE 00.                    
               10  WS-DTE-YY            PIC 99     VALUE 00.                    
                                                                                
           05  WS-EDITED-DATE.                                                  
               10  WS-EDIT-DD           PIC 99     VALUE 00.                    
               10  FILLER               PIC X      VALUE '/'.                   
               10  WS-EDIT-MM           PIC 99     VALUE 00.                    
               10  FILLER               PIC X      VALUE '/'.                   
               10  WS-EDIT-CC           PIC 99     VALUE 00.                    
               10  WS-EDIT-YY           PIC 99     VALUE 00.                    
                                                                                
           05  WS-DATE-WEF.                                                     
               10  WS-WEF-CC            PIC XX     VALUE SPACES.                
               10  WS-WEF-YY            PIC XX     VALUE SPACES.                
               10  FILLER               PIC X      VALUE SPACE.                 
               10  WS-WEF-MM            PIC XX     VALUE SPACES.                
               10  FILLER               PIC X      VALUE SPACE.                 
               10  WS-WEF-DD            PIC XX     VALUE SPACES.                
                                                                                
           05  WS-SCCC-DATE.                                                    
               10  WS-SCCC-DD           PIC 99     VALUE 00.                    
               10  FILLER               PIC X      VALUE '/'.                   
               10  WS-SCCC-MM           PIC 99     VALUE 00.                    
               10  FILLER               PIC X      VALUE '/'.                   
               10  WS-SCCC-CC           PIC 99     VALUE 00.                    
               10  WS-SCCC-YY           PIC 99     VALUE 00.                    
                                                                                
           05  WS-COMPUTE-DATE.                                                 
               10  WS-COMPUTE-CC        PIC 99.                                 
               10  WS-COMPUTE-YY        PIC 99     VALUE ZEROS.                 
               10  WS-COMPUTE-MM        PIC 99     VALUE ZEROS.                 
               10  WS-COMPUTE-DD        PIC 99     VALUE ZEROS.                 
                                                                        00830001
       01  WS-NUM-FIELD.                                                00840001
           05  WS-REM                   PIC 9(3).                       00850001
           05  WS-YEAR                  PIC 9(4).                       00860001
                                                                        00880001
       01  WS-BP13CB4A                  PIC X(8) VALUE 'BP13CB4A'.      00840001
                                                                                
       01  WS-400F-DTE-FLE-RECV         PIC X(10) VALUE SPACES.         00840001
       01  400F-SELLING-PR              PIC $$$$$$$$9.                          
                                                                                
       01  DATE-RECORD.                                                 00890001
           05  DATE-REC                   PIC X(8).                     00900001
           05  DATE-REC1 REDEFINES DATE-REC.                            00910001
               10 CAL-DATE.                                             00920001
                   15 CAL-YEAR            PIC 9(4).                     00930001
                       88 VALID-YEAR          VALUE 1900 THRU 2100.     00940001
                   15 CAL-MONTH           PIC 9(2).                     00950001
                       88 31-DAY-MONTH        VALUE 01, 03, 05, 07, 08, 00960001
                                                        10, 12.         00970001
                       88 30-DAY-MONTH        VALUE 04, 06, 09, 11.     00980001
                       88 28-29-DAY-MONTH     VALUE 02.                 00990001
                       88 VALID-MONTH         VALUE 01 THRU 12.         01000001
                   15 CAL-DAY             PIC 9(2).                     01010001
                       88 VALID-DAY           VALUE 01 THRU 31.         01020001
                                                                        01030001
      *------------------------------------------------------------*            
      *    WS PRINT VARIABLES                                      *            
      *------------------------------------------------------------*            
       01  L400A-LINE-OIC.                                                      
           05  FILLER                   PIC X(10)  VALUE SPACES.                
           05  400A-OIC-NAME            PIC X(30)  VALUE SPACES.                
           05  FILLER                   PIC X(26)  VALUE SPACES.                
                                                                                
       01  L400A-LINE-OIC1.                                                     
           05  FILLER                   PIC X(10)  VALUE SPACES.                
           05  400A-OIC-DESG            PIC X(24)  VALUE SPACES.                
           05  FILLER                   PIC X(32)  VALUE SPACES.                
                                                                                
       01  L400A-LINE-BARCODE.                                                  
           05  FILLER                   PIC X(66)  VALUE SPACES.                
           05  L400-BARCODE-REGN        PIC X(13)  VALUE SPACES.                
                                                                                
       01  L400A-LINE-BARCODE1.                                                 
           05  FILLER                   PIC X(82)  VALUE SPACES.                
           05  L400-BARCODE1-PREFIX     PIC X(2)   VALUE SPACES.                
           05  L400-BARCODE1-REGN       PIC X(8)   VALUE SPACES.                
                                                                                
       01  L400A-PR-HEAD.                                                       
           05  FILLER                   PIC X(40)  VALUE SPACES.                
           05  400A-DTE-SYS             PIC X(10)  VALUE SPACES.                
                                                                                
       01  L400A-PR-HEAD-A.                                                     
           05  FILLER                   PIC X(28)  VALUE SPACES.                
           05  400A-BOTCCC.                                                     
               10  400A-TC              PIC X(2)   VALUE SPACES.                
               10  400A-SLASH1          PIC X      VALUE SPACE.                 
               10  400A-BO              PIC X(2)   VALUE SPACES.                
               10  400A-SLASH2          PIC X      VALUE SPACES.                
               10  400A-CC              PIC X(2)   VALUE SPACES.                
           05  FILLER                   PIC X(40)  VALUE SPACES.                
                                                                                
       01  L400A-PR-HEAD-1.                                                     
           05  FILLER                   PIC X(28)  VALUE SPACES.                
           05  400A-ALLOC-NT            PIC X(3)   VALUE SPACES.                
           05  FILLER                   PIC X      VALUE '/'.                   
           05  400A-RM-TY               PIC X(2)   VALUE SPACES.                
           05  FILLER                   PIC X      VALUE '/'.                   
           05  400A-REGN-NO             PIC X(8)   VALUE SPACES.                
           05  FILLER                   PIC XX     VALUE ' ('.                  
           05  400A-ALLOC-SCH           PIC X(3)   VALUE SPACES.                
           05  FILLER                   PIC X      VALUE ')'.                   
                                                                                
       01  L400A-PR-HEAD-2.                                                     
           05  FILLER                   PIC X(28)  VALUE SPACES.                
           05  400A-SCHEME              PIC X(4)   VALUE SPACES.                
           05  FILLER                   PIC X      VALUE '-'.                   
           05  400A-ACC                 PIC X(4)   VALUE SPACES.                
           05  FILLER                   PIC X      VALUE '-'.                   
           05  400A-CHK                 PIC X      VALUE SPACE.                 
           05  FILLER                   PIC X      VALUE '-'.                   
           05  400A-ACC-TYPE            PIC X(2)   VALUE SPACES.                
           05  FILLER                   PIC X(33)  VALUE SPACES.                
           05  400A-HDR-PHONE-DID       PIC X(24)  VALUE SPACES.                
                                                                                
       01  L400A-PR-HEAD-2A.                                                    
           05  FILLER                   PIC X(75)  VALUE SPACES.                
           05  400A-CURRENT-DATE        PIC X(10)  VALUE SPACES.                
                                                                                
       01  L400A-PR-HEAD-3.                                                     
           05  FILLER                   PIC X(11)  VALUE SPACES.                
           05  400A-APPL-NAME           PIC X(66)  VALUE SPACES.                
           05  FILLER                   PIC X(6)   VALUE SPACES.                
           05  400A-EMAIL               PIC X(19)  VALUE SPACES.                
                                                                                
       01  L400A-PR-HEAD-3B.                                                    
           05  FILLER                   PIC X(11)  VALUE SPACES.                
           05  400A-COAPPL-NAME         PIC X(66)  VALUE SPACES.                
                                                                                
       01  L400A-PR-HEAD-3C.                                                    
           05  FILLER                   PIC X(11)  VALUE SPACES.                
           05  400A-THIRD-NAME          PIC X(66)  VALUE SPACES.                
                                                                                
       01  L400A-PR-HEAD-3D.                                                    
           05  FILLER                   PIC X(11)  VALUE SPACES.                
           05  400A-FOURTH-NAME         PIC X(66)  VALUE SPACES.                
                                                                                
       01  L400A-PR-HEAD-4.                                                     
           05  FILLER                   PIC X(11)  VALUE SPACES.                
           05  400A-K830-BLK-NO         PIC X(10)  VALUE SPACES.                
           05  FILLER                   PIC X(2)   VALUE SPACES.                
           05  400A-NUM-FLAT.                                                   
               10  400A-K830-CHAR       PIC X      VALUE SPACE.                 
               10  400A-K830-LEVEL      PIC X(2)   VALUE SPACES.                
               10  400A-K830-DASH       PIC X      VALUE SPACE.                 
               10  400A-K830-HSE-MAIN   PIC X(4)   VALUE SPACES.                
               10  400A-K830-HSE-SUB    PIC X(3)   VALUE SPACES.                
           05  FILLER                   PIC X(38)  VALUE SPACES.                
                                                                                
       01  L400A-PR-HEAD-5.                                                     
           05  FILLER                   PIC X(11)  VALUE SPACES.                
           05  400A-K830-STREET-NAME    PIC X(65)  VALUE SPACES.                
                                                                                
       01  L400A-PR-HEAD-6.                                                     
           05  FILLER                   PIC X(11)  VALUE SPACES.                
           05  400A-COUNTRY-NME1        PIC X(10)  VALUE 'SINGAPORE '.          
           05  400A-POSTAL-CD           PIC X(6)   VALUE SPACES.                
           05  FILLER                   PIC X(1)   VALUE '.'.                   
           05  FILLER                   PIC X(32)  VALUE SPACES.                
                                                                                
       01  L400A-PR-HEAD-7.                                                     
           05  FILLER                   PIC X(10)  VALUE SPACES.                
           05  400A-BAR-CODE            PIC X(9)   VALUE SPACES.                
                                                                                
       01  L400A-PR-HEAD-9.                                                     
           05  FILLER                   PIC X(18)  VALUE SPACES.                
           05  400A-BLK-NO              PIC X(5)   VALUE SPACES.                
           05  FILLER                   PIC X      VALUE SPACE.                 
           05  FILLER                   PIC X(2)   VALUE ' #'.                  
           05  400A-LEVEL-NO            PIC X(2)   VALUE SPACES.                
           05  FILLER                   PIC X      VALUE '-'.                   
           05  400A-UNIT-NO             PIC X(5)   VALUE SPACES.                
           05  FILLER                   PIC X(1)   VALUE SPACE.                 
           05  400A-STREET-NAME         PIC X(20)  VALUE SPACES.                
           05  FILLER                   PIC X(1)   VALUE SPACES.                
           05  400A-COUNTRY-NME2        PIC X(10)  VALUE 'SINGAPORE '.          
           05  400A-POST-CODE           PIC X(6)   VALUE SPACES.                
           05  FILLER                   PIC X(1)   VALUE '.'.                   
           05  FILLER                   PIC X(14)  VALUE SPACES.                
                                                                                
       01  L400A-PR-HEAD-10.                                                    
           05  FILLER                   PIC X(27)  VALUE SPACES.                
           05  400A-SELLING-PRICE       PIC $$$$,$$9.                           
                                                                                
       01  L400A-PR-HEAD-10A.                                                   
           05  FILLER                   PIC X(70)  VALUE SPACES.                
           05  L400A-AMT-INSURED        PIC ZZZ,ZZ9.99.                         
           05  L400A-AMT-I-R REDEFINES L400A-AMT-INSURED                        
                                        PIC X(10).                              
       01  L400A-PR-HEAD-10B.                                                   
           05  FILLER                   PIC X(26)  VALUE SPACES.                
           05  L400A-AMT-PREMIUM        PIC ZZ9.99.                             
           05  L400A-AMT-P-R REDEFINES L400A-AMT-PREMIUM                        
                                        PIC X(6).                               
       01  L400A-PR-HEAD-10C.                                                   
           05  FILLER                   PIC X(43)  VALUE SPACES.                
           05  L400A-APPOINT-DATE       PIC X(10)  VALUE SPACES.                
                                                                                
       01  L400A-PR-HEAD-11.                                                    
           05  FILLER                   PIC X(10)  VALUE SPACES.                
           05  FILLER                   PIC X(12)  VALUE 'ED FOR TP :'.         
           05  400A-DTE-EXPIRED-TP1     PIC X(10)  VALUE SPACES .               
           05  400A-DTE-DES1            PIC X(3)   VALUE SPACES.                
           05  400A-DTE-EXPIRED-DES     PIC X(3)   VALUE SPACES.                
           05  400A-DTE-DES2            PIC X(2)   VALUE SPACES.                
                                                                                
                                                                                
      *-----------------------------------------------------------*             
      *    WS PRINT LAY-OUT FOR LETTERS  (BP1312)                 *             
      *    AND CONTRACT PERSONS                                   *             
      *-----------------------------------------------------------*             
       01  L400A-DTL-HAND-PHONE.                                                
           05  FILLER                   PIC X(53)  VALUE SPACES.                
           05  400A-ASSIST-HP           PIC X(12)  VALUE SPACES.                
                                                                                
       01  L400A-DTL-DID.                                                       
           05  FILLER                   PIC X(48)  VALUE SPACES.                
           05  400A-CHG-APPT-DID        PIC X(8)   VALUE SPACES.                
                                                                                
       01  L400-PR-HEAD-16.                                                     
           05  400-LIST                 PIC X(8)   VALUE SPACES.                
           05  FILLER                   PIC X(37)  VALUE SPACES.                
           05  FILLER                   PIC X(27)  VALUE                        
               'SYSTEM   OF   COMMITMENT '.                                     
           05  FILLER                   PIC X(32)  VALUE SPACES.                
           05  FILLER                   PIC X(9)   VALUE '  PAGE : '.           
           05  400-PAGE                 PIC ZZZZ9.                              
           05  FILLER                   PIC X(16)  VALUE SPACES.                
                                                                                
       01  L400F-PR-HEAD-16.                                                    
           05  400F-LIST                PIC X(8)   VALUE SPACES.                
           05  FILLER                   PIC X(37)  VALUE SPACES.                
           05  FILLER                   PIC X(27)  VALUE                        
               'SYSTEM   OF   COMMITMENT '.                                     
           05  FILLER                   PIC X(32)  VALUE SPACES.                
           05  FILLER                   PIC X(9)   VALUE '  PAGE : '.           
           05  400F-PAGE                PIC ZZZZ9.                              
           05  FILLER                   PIC X(16)  VALUE SPACES.                
                                                                                
       01  L400-PR-HEAD-17.                                                     
           05  FILLER                   PIC X(25)  VALUE SPACES.                
           05  400-LIST-TITLE           PIC X(70)  VALUE                        
              'CONTROL LIST ON APPOINTMENT LETTER FOR TAKE POSSESSION'.         
           05  FILLER                   PIC X(7)   VALUE 'DATE :'.              
           05  400-DATE                 PIC X(10).                              
           05  FILLER                   PIC X      VALUE SPACES.                
           05  FILLER                   PIC X(14)  VALUE                        
              'AGREEMENT TEAM'.                                                 
                                                                                
       01  L400F-PR-HEAD-17.                                                    
           05  FILLER                   PIC X(20)  VALUE SPACES.                
           05  400F-LIST-TITLE          PIC X(75)  VALUE SPACES.                
           05  FILLER                   PIC X(7)   VALUE 'DATE :'.              
           05  400F-DATE                PIC X(10).                              
           05  FILLER                   PIC X      VALUE SPACES.                
           05  FILLER                   PIC X(14)  VALUE                        
              'AGREEMENT TEAM'.                                                 
                                                                                
       01  L400-PR-HEAD-18.                                                     
           05  FILLER                   PIC X(35)  VALUE                        
               'REGN-NO   NAME (TRUNCATED)'.                                    
           05  FILLER                   PIC X(49)  VALUE                        
               'NRIC       BLOCK     STREET-NAME     '.                         
           05  FILLER                   PIC X(50)  VALUE                        
               'UNIT-NO   SELLING-PRICE   SCH-ACC-NO   ED FOR TP'.              
                                                                                
       01  L400F-PR-HEAD-18.                                                    
           05  FILLER                   PIC X(35)  VALUE                        
               'REGN-NO   NAME (TRUNCATED)'.                                    
           05  FILLER                   PIC X(49)  VALUE                        
               'NRIC       BLOCK     STREET-NAME     '.                         
           05  FILLER                   PIC X(50)  VALUE                        
               'UNIT-NO   SELLING-PRICE   LOAN-TAG   ACCEPT-DATE'.              
                                                                                
       01  L400F-PR-HEAD-18F.                                                   
           05  FILLER                   PIC X(35)  VALUE                        
               'REGN-NO   NAME (TRUNCATED)'.                                    
           05  FILLER                   PIC X(49)  VALUE                        
               'NRIC       BLOCK     STREET-NAME     '.                         
           05  FILLER                   PIC X(50)  VALUE                        
               'UNIT-NO   AHG REQ/STATUS  LOAN-TAG/  ACCEPT-DATE/'.             
                                                                                
       01  L400F-PR-HEAD-18B.                                                   
           05  FILLER                   PIC X(35)  VALUE                        
               '                          '.                                    
           05  FILLER                   PIC X(49)  VALUE                        
               '                                     '.                         
           05  FILLER                   PIC X(50)  VALUE                        
               '                        BUY/SELL TAG FLE REC DTE'.              
                                                                                
       01  L400-PR-HEAD-19.                                                     
           05  400-REGN-NO              PIC X(8)   VALUE SPACES.                
           05  FILLER                   PIC X(2)   VALUE SPACES.                
           05  400-NAME                 PIC X(22)  VALUE SPACES.                
           05  FILLER                   PIC X(3)   VALUE SPACES.                
           05  400-NRIC                 PIC X(9)   VALUE SPACES.                
           05  FILLER                   PIC X(2)   VALUE SPACES.                
           05  400-BLK-NO               PIC X(5)   VALUE SPACES.                
           05  FILLER                   PIC X(3)   VALUE SPACES.                
           05  400-STREET-NAME          PIC X(30)  VALUE SPACES.                
           05  FILLER                   PIC X      VALUE SPACE.                 
           05  400-LEVEL-NO             PIC X(2)   VALUE SPACES.                
           05  400-DASH                 PIC X      VALUE SPACE.                 
           05  400-UNIT-NO              PIC X(5)   VALUE SPACES.                
           05  FILLER                   PIC X(3)   VALUE SPACES.                
           05  400-SELLING-PR           PIC $$$$$$$$9.                          
           05  FILLER                   PIC X(4)   VALUE SPACES.                
           05  400-SCH-ACC-NO           PIC X(11)  VALUE SPACES.                
           05  FILLER                   PIC X(3)   VALUE SPACES.                
           05  400-DTE-EXPIRED-TP       PIC X(8)   VALUE SPACES.                
           05  FILLER                   PIC X(6)   VALUE SPACES.                
                                                                                
                                                                                
       01  L400F-PR-HEAD-19.                                                    
           05  400F-REGN-NO             PIC X(8)   VALUE SPACES.                
           05  FILLER                   PIC X(2)   VALUE SPACES.                
           05  400F-NAME                PIC X(22)  VALUE SPACES.                
           05  FILLER                   PIC X(3)   VALUE SPACES.                
           05  400F-NRIC                PIC X(9)   VALUE SPACES.                
           05  FILLER                   PIC X(2)   VALUE SPACES.                
           05  400F-BLK-NO              PIC X(5)   VALUE SPACES.                
           05  FILLER                   PIC X(3)   VALUE SPACES.                
           05  400F-STREET-NAME         PIC X(30)  VALUE SPACES.                
           05  FILLER                   PIC X      VALUE SPACE.                 
           05  400F-LEVEL-NO            PIC X(2)   VALUE SPACES.                
           05  400F-DASH                PIC X      VALUE SPACE.                 
           05  400F-UNIT-NO             PIC X(5)   VALUE SPACES.                
           05  FILLER                   PIC X(5)   VALUE SPACES.                
           05  WS-SEL-PRICE.                                                    
             10  400F-AHG-REQ           PIC X(1)   VALUE SPACES.                
             10  FILLER-SL1             PIC X(3)   VALUE ' / ' .                
             10  400F-AHG-STATUS        PIC X(1)   VALUE SPACES.                
             10  FILLER                 PIC X(11)  VALUE SPACES.                
           05  400F-LOAN-TAG            PIC X(1)   VALUE SPACES.                
           05  FILLER-SL2               PIC X(3)   VALUE ' / ' .                
           05  400F-BUY-SEL-TAG         PIC X(1)   VALUE SPACES.                
           05  FILLER                   PIC X(2)   VALUE SPACES.                
           05  400F-DTE-ACCEPT          PIC X(10)  VALUE SPACES.                
           05  FILLER                   PIC X(4)   VALUE SPACES.                
                                                                                
       01  L400-PR-HEAD-20.                                                     
           05  FILLER                   PIC X(10)  VALUE SPACES.                
           05  FILLER                   PIC X(23)  VALUE                        
               'NO LETTERS PRINTED   : '.                                       
           05  400-TOTAL                PIC ZZZZZ9.                             
           05  FILLER                   PIC X(90)  VALUE SPACES.                
                                                                                
       01  L400-PR-HEAD-20B.                                                    
           05  FILLER                   PIC X(10)  VALUE SPACES.                
           05  FILLER                   PIC X(23)  VALUE                        
               'NO OF CASES.         : '.                                       
           05  400-TOTAL-2              PIC ZZZZZ9.                             
           05  FILLER                   PIC X(90)  VALUE SPACES.                
                                                                                
       01  L400F-PR-HEAD-20.                                                    
           05  FILLER                   PIC X(10)  VALUE SPACES.                
           05  FILLER                   PIC X(23)  VALUE                        
               'TOTAL NO OF CASES    : '.                                       
           05  400F-TOTAL               PIC ZZZZZ9.                             
           05  FILLER                   PIC X(90)  VALUE SPACES.                
                                                                                
       01  L400C-PR-HEAD-1.                                                     
           05  FILLER                   PIC X(33)  VALUE SPACES.                
           05  FILLER                   PIC X(65)  VALUE                        
               '   LIST OF RECORDS WITH KEY AVAILABLE DATE       '.             
           05  FILLER                   PIC X(7)   VALUE 'DATE :'.              
           05  400C-DATE                PIC X(10)  VALUE SPACES.                
                                                                                
       01  L400C-PR-HEAD-2.                                                     
           05  FILLER                   PIC X(10)  VALUE SPACES.                
           05  FILLER                   PIC X(30)  VALUE                        
               'NO WITH KEY AVAILABLE DATE : '.                                 
           05  400C-EXPIRED-TP          PIC ZZZZZ9.                             
           05  FILLER                   PIC X(90)  VALUE SPACES.                
                                                                                
       01  L400C-PR-LINE-0.                                                     
           05  FILLER                   PIC X(19)  VALUE SPACES.                
           05  400C-CURRENT-DATE        PIC X(10)  VALUE SPACES.                
                                                                                
       01  L400C-PR-LINE-1.                                                     
           05  FILLER                   PIC X(18)  VALUE SPACES.                
           05  400C-RM-TY               PIC X(2)   VALUE SPACES.                
           05  FILLER                   PIC X      VALUE '/'.                   
           05  400C-REGN                PIC X(8)   VALUE SPACES.                
                                                                                
       01  L400C-PR-LINE-2.                                                     
           05  FILLER                   PIC X(63)  VALUE SPACES.                
           05  400C-INT-RATE            PIC Z9.99.                              
           05  FILLER                   PIC X(2)   VALUE ' %'.                  
                                                                                
       01  L400C-PR-LINE-3.                                                     
           05  FILLER                   PIC X(63)  VALUE SPACES.                
           05  400C-SELLING-PRICE       PIC ZZ,ZZZ,ZZ9.99.                      
                                                                                
       01  L400C-PR-LINE-4.                                                     
           05  FILLER                   PIC X(53)  VALUE SPACES.                
           05  400C-LEASE-FEE           PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-5.                                                     
           05  FILLER                   PIC X(53)  VALUE SPACES.                
           05  400C-MORT-STAMP-FEE      PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-6.                                                     
           05  FILLER                   PIC X(53)  VALUE SPACES.                
           05  400C-MORTGAGE-FEE        PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-7.                                                     
           05  FILLER                   PIC X(53)  VALUE SPACES.                
           05  400C-TOT-STAMP-FEE       PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-8.                                                     
           05  FILLER                   PIC X(23)  VALUE SPACES.                
           05  400C-SURVEY-FEE-ACT      PIC Z,ZZZ.ZZ.                           
           05  FILLER                   PIC X(3)   VALUE ' + '.                 
           05  400C-SURVEY-FEE-GST      PIC ZZZ.ZZ.                             
           05  FILLER                   PIC X(13)  VALUE ' (GST)'.              
           05  400C-TOT-SURVEY-FEE      PIC ZZZ,ZZ9.99.                         
           05  FILLER                   PIC X(3)   VALUE SPACES.                
           05  400C-TOT-FEES            PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-9.                                                     
           05  FILLER                   PIC X(63)  VALUE SPACES.                
           05  400C-TOT-SELLPR          PIC ZZ,ZZZ,ZZ9.99.                      
                                                                                
       01  L400C-PR-LINE-10.                                                    
           05  FILLER                   PIC X(51)  VALUE SPACES.                
           05  400C-CD-CASH             PIC Z,ZZZ,ZZ9.99.                       
                                                                                
       01  L400C-PR-LINE-11.                                                    
           05  FILLER                   PIC X(51)  VALUE SPACES.                
           05  400C-CD-CPF1             PIC Z,ZZZ,ZZ9.99.                       
                                                                                
       01  L400C-PR-LINE-12.                                                    
           05  FILLER                   PIC X(51)  VALUE SPACES.                
           05  400C-CD-CPF2             PIC Z,ZZZ,ZZ9.99.                       
                                                                                
       01  L400C-PR-LINE-13.                                                    
           05  FILLER                   PIC X(51)  VALUE SPACES.                
           05  400C-CD-CPF3             PIC Z,ZZZ,ZZ9.99.                       
                                                                                
       01  L400C-PR-LINE-14.                                                    
           05  FILLER                   PIC X(51)  VALUE SPACES.                
           05  400C-CD-CPF4             PIC Z,ZZZ,ZZ9.99.                       
           05  FILLER                   PIC X      VALUE SPACES.                
           05  400C-TOTAL-CD            PIC Z,ZZZ,ZZ9.99.                       
                                                                                
       01  L400C-PR-LINE-15.                                                    
           05  FILLER                   PIC X(63)  VALUE SPACES.                
           05  400C-BALANCE-AMT         PIC ZZ,ZZZ,ZZ9.99.                      
                                                                                
       01  L400C-PR-LINE-16.                                                    
           05  FILLER                   PIC X(64)  VALUE SPACES.                
           05  400C-MAX-LOAN-AMT        PIC Z,ZZZ,ZZ9.99.                       
                                                                                
       01  L400C-PR-LINE-17.                                                    
           05  FILLER                   PIC X(68)  VALUE SPACES.                
           05  400C-MTHLY-INSTAL        PIC Z,ZZ9.99.                           
                                                                                
       01  L400C-PR-LINE-18.                                                    
           05  FILLER                  PIC X(30)  VALUE SPACES.                 
           05  FILLER                  PIC X(13)  VALUE '(INCLUDE GST)'.        
           05  FILLER                  PIC X(25)  VALUE SPACES.                 
           05  400C-SC-CC-AMT          PIC Z,ZZ9.99.                            
                                                                                
       01  L400C-PR-LINE-19.                                                    
           05  FILLER                   PIC X(01)  VALUE SPACES.                
           05  FILLER                   PIC X(03)  VALUE 'SC:'.                 
           05  400C-AMT-CURR-SCCC       PIC ZZ9.99.                             
           05  FILLER                   PIC X(5)   VALUE ' WEF '.               
           05  400C-DTE-CURR-SCCC       PIC X(10)  VALUE SPACES.                
           05  FILLER                   PIC X(1)   VALUE SPACES.                
           05  400C-CURR-GST-DESC       PIC X(48)  VALUE SPACES.                
                                                                                
       01  L400C-PR-LINE-20.                                                    
           05  FILLER                   PIC X(04)  VALUE SPACES.                
           05  400C-AMT-NEXT-SCCC       PIC ZZ9.99.                             
           05  FILLER                   PIC X(5)   VALUE ' WEF '.               
           05  400C-DTE-NEXT-SCCC       PIC X(10)  VALUE SPACES.                
           05  FILLER                   PIC X(1)   VALUE SPACES.                
           05  400C-NEXT-GST-DESC       PIC X(48)  VALUE SPACES.                
                                                                                
       01  L400-BLANK                   PIC X(80)  VALUE SPACES.                
                                                                                
       01  L400C-TITLE1.                                                        
           05   FILLER                  PIC X(6)   VALUE 'L400C '.              
           05   ERR-DATE.                                                       
                09 ERR-DATE-DD          PIC X(2)   VALUE SPACES.                
                09 FILLER               PIC X      VALUE '/'.                   
                09 ERR-DATE-MM          PIC X(2)   VALUE SPACES.                
                09 FILLER               PIC X      VALUE '/'.                   
                09 ERR-DATE-CC          PIC X(2)   VALUE SPACES.                
                09 ERR-DATE-YY          PIC X(2)   VALUE SPACES.                
           05   FILLER                  PIC X(28)  VALUE SPACES.                
           05   FILLER                  PIC X(45)  VALUE                        
                 'LIST OF SUB-TRANSFER REFUND NOT CLEARED CASES'.               
           05   FILLER                  PIC  X(30) VALUE SPACES.                
           05   FILLER PIC  X(6) VALUE 'PAGE: '.                                
           05   WS-ERR-PAGE             PIC  9(3)  VALUE ZERO.                  
                                                                                
       01  L400C-TITLE2.                                                        
           05   FILLER               PIC  X(20)  VALUE SPACES.                  
           05   FILLER               PIC  X(08)  VALUE 'REGN NO.'.              
           05   FILLER               PIC  X(05)  VALUE SPACES.                  
           05   FILLER               PIC  X(09)  VALUE '   NRIC  '.             
           05   FILLER               PIC  X(05)  VALUE SPACES.                  
           05   FILLER               PIC  X(13)  VALUE                          
                                             'REFUND AMOUNT'.                   
                                                                                
       01  L400C-DETAIL.                                                        
           05   FILLER               PIC  X(20)  VALUE SPACES.                  
           05   ERR-NUM-REGN         PIC  X(8)   VALUE SPACES.                  
           05   FILLER               PIC  X(05)  VALUE SPACES.                  
           05   ERR-NUM-NRIC         PIC  X(09)  VALUE SPACES.                  
           05   FILLER               PIC  X(07)  VALUE SPACES.                  
           05   ERR-AMT-REFUND       PIC  ------9.99.                           
                                                                                
       01  BLANK-LINE                PIC  X(80)  VALUE SPACES.                  
                                                                                
      *===========================================================*             
      *              SUB ROUTINE PARAMETERS                       *             
      *===========================================================*             
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED  TO SUB-PROGRAM "BP13C900"         *             
      *-----------------------------------------------------------*             
       01  WS-LINK-S900.                                                        
           05  WS-S900-SELL-PR             PIC 9(8)     VALUE ZEROES.           
           05  WS-S900-DESIGN              PIC X(3)     VALUE SPACES.           
           05  WS-S900-RM                  PIC X(2)     VALUE SPACES.           
           05  WS-S900-CD-PREV-PAID        PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S900-TOT-ICP             PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S900-REPAY-PD            PIC 99       VALUE ZEROES.           
           05  WS-S900-PREM-ST-FEE         PIC 9(5)V99  VALUE ZEROES.           
           05  WS-S900-SURVEY-FEE          PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-LS-ESCROW-FEE       PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-LS-REGN-FEE         PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-CONVEY-FEE          PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-MORT-ESCROW-FEE     PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-MORT-ST-FEE         PIC 9(5)V99  VALUE ZEROES.           
           05  WS-S900-MORT-REGN-FEE       PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-LOAN                PIC S9(7)V99 VALUE ZEROES.           
           05  WS-S900-ORIG-SELL           PIC 9(8)     VALUE ZEROES.           
           05  WS-S900-SALE-TYPE           PIC X(2)     VALUE SPACES.           
           05  WS-S900-PREMIUM-CODE        PIC X(2)     VALUE SPACES.           
           05  WS-S900-SURVEY-FEE-GST      PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-CONVEY-FEE-GST      PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-SALES-TYPE-SURVEY   PIC X(2)     VALUE SPACES.           
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED  TO SUB-PROGRAM "BP13C901"         *             
      *-----------------------------------------------------------*             
       01  WS-LINK-S901.                                                        
           05  WS-S901-INT                 PIC 9V9(4)   VALUE ZEROES.           
           05  WS-S901-FAC                 PIC 9(2)     VALUE ZEROES.           
           05  WS-S901-ERL                 PIC X        VALUE SPACE.            
           05  WS-S901-LOAN-AMT            PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S901-ERL-LOAN-AMT        PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S901-REPAY-PD            PIC 99       VALUE ZEROES.           
           05  WS-S901-RM                  PIC X(2)     VALUE SPACES.           
           05  WS-S901-DESIGN              PIC X(3)     VALUE SPACES.           
           05  FILLER                      PIC X(1)     VALUE SPACE.            
           05  WS-S901-MTH-INSTAL          PIC S9(5)V99 VALUE +0.               
           05  WS-S901-SUB-INSTAL          PIC S9(5)V99 VALUE +0.               
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED  TO SUB-PROGRAM "BP13C903"         *             
      *-----------------------------------------------------------*             
       01  WS-LINK-S903.                                                        
           05  WS-S903-NUM-SCH-ACC         PIC X(9)     VALUE SPACES.           
           05  WS-S903-SO-EFF-DATE.                                             
               10  WS-S903-SO-EFF-CC       PIC 9(2)     VALUE ZEROES.           
               10  WS-S903-SO-EFF-YYMMDD   PIC 9(6)     VALUE ZEROES.           
           05  WS-S903-DESIGN-TY           PIC X(3)     VALUE SPACES.           
           05  WS-S903-ROOM-TY             PIC X(2)     VALUE SPACES.           
           05  WS-S903-SC-CC1              PIC 9(6)V99  VALUE ZEROES.           
           05  WS-S903-SC-CC2              PIC 9(6)V99  VALUE ZEROES.           
           05  WS-S903-SC-CC3              PIC 9(6)V99  VALUE ZEROES.           
           05  WS-S903-SC-TOTAL-AMT        PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S903-SC-REBATE1          PIC 9(4)V99  VALUE ZEROES.           
           05  WS-S903-SC-REBATE2          PIC 9(4)V99  VALUE ZEROES.           
           05  WS-S903-SC-REBATE3          PIC 9(4)V99  VALUE ZEROES.           
           05  WS-S903-SC-GRANT1           PIC 9(4)V99  VALUE ZEROES.           
           05  WS-S903-SC-GRANT2           PIC 9(4)V99  VALUE ZEROES.           
           05  WS-S903-SC-GRANT3           PIC 9(4)V99  VALUE ZEROES.           
           05  WS-S903-SC-REC-TC1          PIC 9(4)V99  VALUE ZEROES.           
           05  WS-S903-SC-REC-TC2          PIC 9(4)V99  VALUE ZEROES.           
           05  WS-S903-SC-REC-TC3          PIC 9(4)V99  VALUE ZEROES.           
           05  WS-S903-SC-REB-SP1          PIC 9(4)V99  VALUE ZEROES.           
           05  WS-S903-SC-REB-SP2          PIC 9(4)V99  VALUE ZEROES.           
           05  WS-S903-SC-REB-SP3          PIC 9(4)V99  VALUE ZEROES.           
           05  WS-S903-SC-CURR-EFF-DATE    PIC X(10)    VALUE SPACES.           
           05  WS-S903-SC-NEXT-EFF-DATE    PIC X(10)    VALUE SPACES.           
           05  WS-S903-RET-CODE            PIC X(2)     VALUE SPACES.           
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED  TO SUB-PROGRAM "BP13C905"         *             
      *-----------------------------------------------------------*             
       01  WS-LINK-S905.                                                        
           05  WS-S905-SC-CC1              PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S905-SC-CC2              PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S905-SC-CC3              PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S905-SC-TOTAL-AMT        PIC 9(7)V99  VALUE ZEROES.           
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED  TO SUB-PROGRAM "AV02C021"         *             
      *-----------------------------------------------------------*             
       COPY P13GST01.                                                           
                                                                                
       LINKAGE SECTION.                                                         
       01  PARM-FIELD.                                                          
           05  PARM-LENGTH             PIC S9(04) COMP.                         
           05  PARM-DATA               PIC X(02).                               
                                                                                
                                                                                
      *-------------------------------------*                                   
       PROCEDURE DIVISION USING PARM-FIELD.                                     
      *-------------------------------------*                                   
                                                                                
      ******************************************************************        
       MAIN.                                                                    
      ******************************************************************        
           OPEN INPUT BP13F310                                                  
                      BP13K022                                                  
                      BP13K024                                                  
                      BP13K800                                                  
                      BP13K820                                                  
                      BP13K830                                                  
                      BP13K880                                                  
                      BP13K885                                                  
                      BM06K100                                                  
                      BM06K110                                                  
                      AB03K050                                                  
               OUTPUT P13L400A                                                  
                      P13L400B                                                  
                      P13L400C                                                  
                      P13L400D                                                  
                      P13L400F                                                  
                      BP13L400.                                                 
                                                                                
           IF BP13K800-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR, BP13K800-STATUS ' BP13K800-STATUS         
              MOVE     BP13K800-STATUS TO RETURN-CODE                           
              PERFORM  9000-CLOSE-ROUTINE THRU 1500-EXIT.                       
                                                                                
           IF BP13K022-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K022-STATUS ' BP13K022-STATUS          
              MOVE     BP13K022-STATUS TO RETURN-CODE                           
              PERFORM  9000-CLOSE-ROUTINE THRU 1500-EXIT.                       
                                                                                
           IF BP13K024-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K024-STATUS ' BP13K024-STATUS          
              MOVE     BP13K024-STATUS TO RETURN-CODE                           
              PERFORM  9000-CLOSE-ROUTINE THRU 1500-EXIT.                       
                                                                                
           IF BP13K820-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR, BP13K820-STATUS ' BP13K820-STATUS         
              MOVE     BP13K820-STATUS TO RETURN-CODE                           
              PERFORM  9000-CLOSE-ROUTINE THRU 1500-EXIT.                       
                                                                                
           IF BP13K830-STATUS NOT = 0 AND 97                                    
              DISPLAY 'OPENING ERROR,BP13K830-STATUS ' BP13K830-STATUS          
              MOVE     BP13K830-STATUS TO RETURN-CODE                           
              PERFORM  9000-CLOSE-ROUTINE THRU 1500-EXIT.                       
                                                                                
           IF BP13K880-STATUS NOT = 0 AND 97                                    
              DISPLAY 'OPENING ERROR,BP13K880-STATUS ' BP13K880-STATUS          
              MOVE     BP13K880-STATUS TO RETURN-CODE                           
              PERFORM  9000-CLOSE-ROUTINE THRU 1500-EXIT.                       
                                                                                
           IF BP13K885-STATUS NOT = 0 AND 97                                    
              DISPLAY 'OPENING ERROR,BP13K885-STATUS ' BP13K885-STATUS          
              MOVE     BP13K885-STATUS TO RETURN-CODE                           
              PERFORM  9000-CLOSE-ROUTINE THRU 1500-EXIT.                       
                                                                                
           IF BM06K100-STATUS NOT = 0 AND 97                                    
              DISPLAY 'OPENING ERROR,BM06K100-STATUS ' BM06K100-STATUS          
              MOVE     BM06K100-STATUS TO RETURN-CODE                           
              PERFORM  9000-CLOSE-ROUTINE THRU 1500-EXIT.                       
                                                                                
           IF BM06K110-STATUS NOT = 0 AND 97                                    
              DISPLAY 'OPENING ERROR,BM06K110-STATUS ' BM06K110-STATUS          
              MOVE     BM06K110-STATUS TO RETURN-CODE                           
              PERFORM  9000-CLOSE-ROUTINE THRU 1500-EXIT.                       
                                                                                
           IF AB03K050-STATUS NOT = 0 AND 97                                    
              DISPLAY 'OPENING ERROR, AB03K050-STATUS ' AB03K050-STATUS         
              MOVE     AB03K050-STATUS TO RETURN-CODE                           
              PERFORM  9000-CLOSE-ROUTINE THRU 1500-EXIT.                       
                                                                                
           MOVE FUNCTION CURRENT-DATE TO    WS-CURRENT-DATE.                    
           MOVE    WS-CURR-DD         TO    WS-EDIT-DD.                         
           MOVE    WS-CURR-MM         TO    WS-EDIT-MM.                         
           MOVE    WS-CURR-CC         TO    WS-EDIT-CC.                         
           MOVE    WS-CURR-YY         TO    WS-EDIT-YY.                         
                                                                                
           MOVE    WS-EDITED-DATE     TO    ERR-DATE.                           
                                                                                
           PERFORM  100-MOVE-GST-RATE     THRU 100-EXIT.                        
           PERFORM  200-READ-DATA         THRU 200-EXIT.                        
           PERFORM  300-PRINT-LETTER      THRU 300-EXIT                         
                        UNTIL WS-EOF = 'Y'.                                     
           PERFORM  1000-PRINT-TOTAL      THRU 1000-EXIT.                       
           PERFORM  9000-CLOSE-ROUTINE    THRU 1500-EXIT.                       
                                                                                
                                                                                
      ******************************************************************        
       100-MOVE-GST-RATE.                                                       
      ******************************************************************        
      *-----------------------------------------------------------*             
      *    CALL BP13C90D TO GET GST-RATE                          *             
      *-----------------------------------------------------------*             
           CALL 'BP13C90D' USING WS-COMM-AREA-GST.                              
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       200-READ-DATA.                                                           
      ******************************************************************        
            READ BP13F310                                                       
                 AT END MOVE 'Y'  TO  WS-EOF                                    
                        GO TO 200-EXIT.                                         
            ADD  1  TO  WS-F310-CNT.                                            
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       300-PRINT-LETTER.                                                        
      ******************************************************************        
                                                                                
           IF F310-CDE-SALES-TYPE NOT = '10'                                    
              GO TO 300-READ-FILE.                                              
                                                                                
           MOVE F310-SCH-ACC TO K110-KEY-FLD.                                   
           READ BM06K110.                                                       
                                                                                
           IF BM06K110-STATUS NOT = 0                                           
              DISPLAY 'BM06K110 - RECORD NOT FOUND , KEY : '                    
                          K110-KEY-FLD                                          
              GO TO 300-READ-FILE.                                              
                                                                                
           PERFORM 303-CALL-BP13CB4A    THRU 303-EXIT.                          
                                                                                
           MOVE F310-REGN-NO TO K800-NUM-REGN.                                  
           READ BP13K800 KEY IS K800-NUM-REGN.                                  
                                                                                
           IF BP13K800-STATUS = 00                                              
              PERFORM 305-CHECK-SUB-TRANSFER     THRU 305-EXIT                  
              PERFORM 315-GET-REGN-CHKDIGIT      THRU 315-EXIT                  
              PERFORM 310-CHECK-AMT-CD           THRU 310-EXIT                  
           ELSE                                                                 
              GO TO 300-READ-FILE                                               
           END-IF.                                                              
                                                                                
           PERFORM  320-MOVE-DATA                THRU 320-EXIT.                 
           PERFORM  600-L400A-PROCESS-PRINT.                                    
                                                                                
           IF F310-CDE-TRANS  = 'TL' OR 'TB'                                    
              MOVE K110-AIX1                     TO K100-KEY-FLD                
              PERFORM  2000-READ-BM06K100        THRU 2000-EXIT                 
              IF BM06K100-STATUS = 0                                            
                 PERFORM  610-PRINT-LETTER-L400A THRU 610-EXIT                  
                 STRING '      CONTROL LIST ON APPOINTMENT LETTER '             
                        'FOR TAKE POSSESSION'       DELIMITED BY SIZE           
                        INTO 400-LIST-TITLE                                     
                 PERFORM  700-L400-PROCESS-PRINT THRU 700-EXIT                  
                 PERFORM  620-PRINT-WORK         THRU 620-EXIT                  
              ELSE                                                              
                 DISPLAY 'MISSING K100 REC: ' K110-AIX1 ' ' F310-REGN-NO        
              END-IF                                                            
           ELSE                                                                 
              IF (K110-DTE-ACCEPTANCE NOT = SPACES AND ZEROES AND               
                                            LOW-VALUES)  AND                    
                 (K800-DTE-RAISE-AO = SPACES OR ZEROES OR LOW-VALUES)           
                 STRING 'CONTROL LIST ON ACCEPTED CASES THAT HAVE '             
                        'KEY-AVAILABLE BUT NO AO DATE'                          
                        DELIMITED BY SIZE  INTO 400F-LIST-TITLE                 
                 PERFORM  720-L400F-PROCESS-PRINT THRU 720-EXIT                 
              ELSE                                                              
                 STRING 'CONTROL LIST ON CASES THAT HAVE KEY-AVAILABLE'         
                        ' AFTER SALES AGREEMENT' DELIMITED BY SIZE              
                        INTO 400-LIST-TITLE                                     
                 PERFORM  710-L400-PROCESS-PRINT  THRU 710-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
       300-READ-FILE.                                                           
      ******************************************************************        
            PERFORM 200-READ-DATA        THRU 200-EXIT.                         
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ******************************************************************        
       303-CALL-BP13CB4A.                                                       
      ******************************************************************        
           INITIALIZE COM73-COMMAREA.                                           
                                                                                
           MOVE 'R'                  TO  COM73-NUM-CALL-ACTION.                 
           MOVE F310-REGN-NO         TO  COM73-NUM-RGSTRN-INPUT.                
           MOVE SPACES               TO  WS-AHG-STATUS.                         
           CALL WS-BP13CB4A USING COM73-COMMAREA.                               
                                                                                
           IF COM73-CDE-ERROR = SPACES OR ZEROES                                
              NEXT SENTENCE                                                     
           ELSE                                                                 
              MOVE SPACES                TO COM73-COMMAREA                      
              INITIALIZE                    COM73-COMMAREA                      
           END-IF.                                                              
                                                                                
           PERFORM VARYING WS-A FROM 1 BY 1 UNTIL WS-A > 5                      
             IF COM73-NUM-GRANT-TYPE(WS-A) = 'AHG'                              
                MOVE COM73-GRANT-STATUS(WS-A)  TO WS-AHG-STATUS                 
             END-IF                                                             
           END-PERFORM.                                                         
                                                                                
       303-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       305-CHECK-SUB-TRANSFER.                                                  
      ******************************************************************        
            IF K800-NUM-SUB-TRANSFER   = SPACES OR  LOW-VALUES                  
               GO TO 305-EXIT                                                   
            END-IF.                                                             
                                                                                
            MOVE  F310-REGN-NO  TO  K880-NUM-REGN.                              
            READ BP13K880.                                                      
            IF BP13K880-STATUS NOT = '00'                                       
               GO TO 305-EXIT                                                   
            END-IF.                                                             
                                                                                
            MOVE F310-REGN-NO   TO      K885-NUM-REGN                           
            MOVE LOW-VALUES     TO      K885-NUM-NRIC                           
                                                                                
            MOVE 'N'            TO      WS-K885-EOF ,                           
                                        WS-NO-PRINT.                            
                                                                                
            START BP13K885 KEY >= K885-KEY-FLD.                                 
                                                                                
            IF BP13K885-STATUS NOT = '00'                                       
               DISPLAY 'START ERROR  BP13K885 STATUS ' BP13K885-STATUS          
               GO TO 305-EXIT                                                   
            END-IF.                                                             
                                                                                
            MOVE 'N' TO WS-LOOP-EXIT.                                           
                                                                                
            PERFORM UNTIL WS-LOOP-EXIT = 'Y'                                    
              READ BP13K885 NEXT AT END                                         
                   MOVE 'Y'  TO  WS-K885-EOF                                    
              END-READ                                                          
              IF K885-NUM-REGN NOT = F310-REGN-NO OR                            
                 WS-K885-EOF = 'Y'                                              
                   MOVE 'Y'  TO  WS-LOOP-EXIT                                   
              ELSE                                                              
                 IF K885-AMT-REFUND > 0                                         
                    PERFORM 306-WRITE-ERR-LIST THRU 306-EXIT                    
                    MOVE 'Y' TO  WS-LOOP-EXIT                                   
                    MOVE 'Y' TO  WS-NO-PRINT                                    
                 END-IF                                                         
              END-IF                                                            
            END-PERFORM.                                                        
                                                                                
           IF (F310-CDE-TRANS  NOT = 'TL' AND 'TB')                             
              IF (K110-DTE-ACCEPTANCE = SPACES OR ZEROES OR LOW-VALUES)         
                                      OR                                        
                 (K800-DTE-RAISE-AO NOT = SPACES AND ZEROES AND                 
                                          LOW-VALUES)                           
                 MOVE  'N'   TO  WS-NO-PRINT                                    
              END-IF                                                            
           END-IF.                                                              
                                                                                
            IF WS-NO-PRINT = 'Y'                                                
      * CPF-REFUND IS NOT FULLY MADE HENCE CANCEL PRINTING LETTER               
                GO TO 300-READ-FILE                                             
            END-IF.                                                             
                                                                                
       305-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       306-WRITE-ERR-LIST.                                                      
      ******************************************************************        
              ADD   1     TO    WS-ERR-LINE.                                    
                                                                                
              IF WS-ERR-LINE = 1   OR   WS-ERR-LINE > 56                        
                 MOVE  1     TO   WS-ERR-LINE                                   
                 ADD   1     TO   WS-ERR-PAGE                                   
                 PERFORM 307-WRITE-ERR-HEAD  THRU   307-EXIT                    
              END-IF.                                                           
                                                                                
              MOVE K885-NUM-REGN       TO      ERR-NUM-REGN.                    
              MOVE K885-NUM-NRIC       TO      ERR-NUM-NRIC.                    
                                                                                
              IF K885-AMT-REFUND IS NOT NUMERIC                                 
                 MOVE  ZERO  TO  K885-AMT-REFUND                                
              END-IF.                                                           
              MOVE K885-AMT-REFUND     TO      ERR-AMT-REFUND.                  
                                                                                
              WRITE ERR-REC FROM L400C-DETAIL AFTER ADVANCING 1 LINE.           
                                                                                
       306-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       307-WRITE-ERR-HEAD.                                                      
      ******************************************************************        
           WRITE ERR-REC FROM L400C-TITLE1 AFTER ADVANCING PAGE.                
           WRITE ERR-REC FROM L400C-TITLE2 AFTER ADVANCING 2 LINES.             
                                                                                
       307-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       310-CHECK-AMT-CD.                                                        
      ******************************************************************        
           IF F310-CDE-TRANS  = 'TL' OR 'TB'                                    
              IF K800-AMT-CD = ZEROS                                            
                 IF (K800-NUM-IDP-SCHEME = 'NRT' OR 'ERT') AND                  
                    ((F310-CDE-TYP-ACTUSE = '01' OR '02' OR '03') OR            
                     (F310-CDE-TYP-ACTUSE = '04' AND                            
                      F310-CDE-MODL-DESG  = '06' OR '36'))                      
                      NEXT SENTENCE                                             
                 ELSE                                                           
                     GO TO 300-READ-FILE                                        
                 END-IF                                                         
              ELSE                                                              
                 NEXT SENTENCE                                                  
              END-IF                                                            
           ELSE                                                                 
              NEXT SENTENCE                                                     
           END-IF.                                                              
                                                                                
           MOVE K800-NUM-REGN          TO 400A-REGN-NO                          
                                          L400-BARCODE1-REGN.                   
           MOVE K800-NUM-NEW-TOWN      TO 400A-ALLOC-NT.                        
           MOVE K800-NUM-SCH           TO 400A-SCHEME.                          
           MOVE K800-NUM-ACC           TO 400A-ACC.                             
           MOVE K800-NUM-ACC-CK        TO 400A-CHK.                             
           MOVE K800-NUM-LESSEE-CODE   TO 400A-ACC-TYPE.                        
           MOVE K800-NUM-ALLO-SCHEME   TO 400A-ALLOC-SCH.                       
                                                                                
           MOVE 'SL'                   TO L400-BARCODE1-PREFIX.                 
                                                                                
           EVALUATE F310-CDE-TRANS                                              
           WHEN 'TB'                                                            
                MOVE F310-DTE-TRANS    TO DATE-REC                              
                PERFORM 510-COMPUTE-DTE-EXPIRED-TP THRU 510-EXIT                
                STRING CAL-DAY         DELIMITED BY SIZE                        
                       '/'             DELIMITED BY SIZE                        
                       CAL-MONTH       DELIMITED BY SIZE                        
                       '/'             DELIMITED BY SIZE                        
                       CAL-YEAR        DELIMITED BY SIZE                        
                       INTO L400A-APPOINT-DATE                                  
           WHEN OTHER                                                           
                MOVE SPACES            TO L400A-APPOINT-DATE                    
           END-EVALUATE.                                                        
                                                                                
           IF K800-DTE-EXPIRED-TP = '00000000' OR                               
                                     LOW-VALUE OR SPACES                        
              MOVE '00000000'          TO WS-DTE-EXPIRED-TP                     
           ELSE                                                                 
              MOVE K800-DTE-EXPIRED-TP TO WS-DTE-EXPIRED-TP                     
           END-IF.                                                              
                                                                                
           MOVE WS-DTE-TP-CC           TO WS-DTE-CC.                            
           MOVE WS-DTE-TP-YY           TO WS-DTE-YY.                            
           MOVE WS-DTE-TP-MM           TO WS-DTE-MM.                            
           MOVE WS-DTE-TP-DD           TO WS-DTE-DD.                            
           MOVE WS-EDITED-EXPIRED      TO 400A-DTE-EXPIRED-TP1.                 
                                                                                
           IF F310-CDE-ECD = '*'                                                
              MOVE 'ECD'               TO 400A-DTE-EXPIRED-DES                  
              MOVE '(  '               TO 400A-DTE-DES1                         
              MOVE ')'                 TO 400A-DTE-DES2                         
           ELSE                                                                 
              MOVE SPACES              TO 400A-DTE-EXPIRED-DES                  
              MOVE SPACES              TO 400A-DTE-DES1                         
              MOVE SPACES              TO 400A-DTE-DES2.                        
                                                                                
           MOVE '/'                    TO 400A-SLASH1 400A-SLASH2.              
           MOVE F310-CDE-BO            TO 400A-BO.                              
           MOVE F310-CDE-CC            TO 400A-CC.                              
           MOVE F310-CDE-TC            TO 400A-TC.                              
                                                                                
       310-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       315-GET-REGN-CHKDIGIT.                                                   
      *-------------------------------------------------------------            
           STRING 'SL' K800-NUM-REGN DELIMITED BY SIZE                          
             INTO  WS-C908-TXT-INPUT.                                           
                                                                                
           MOVE SPACES               TO WS-C908-TXT-OUTPUT.                     
           MOVE 10                   TO WS-C908-TXT-IN-SIZE.                    
           MOVE ZEROS                TO WS-C908-RETCODE                         
                                        WS-C908-TXT-OUT-SIZE.                   
                                                                                
           CALL 'BP13C908'    USING WS-C908-PARAMETERS.                         
                                                                                
           IF WS-C908-RETCODE = ZEROS                                           
              MOVE WS-C908-TXT-OUTPUT(1:WS-C908-TXT-OUT-SIZE) TO                
                   L400-BARCODE-REGN                                            
           ELSE                                                                 
              DISPLAY 'ERROR IN BP13C908-REGN: ' WS-C908-TXT-INPUT              
              MOVE SPACES                 TO  L400-BARCODE-REGN.                
                                                                                
       315-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       320-MOVE-DATA.                                                           
      ******************************************************************        
           MOVE K800-NUM-REGN          TO K820-NUM-REGN.                        
           MOVE K800-NUM-NRIC1         TO K820-NUM-NRIC.                        
           PERFORM 400-READ-BP13K820   THRU 400-EXIT.                           
                                                                                
           MOVE K820-NME-OCCP          TO 400A-APPL-NAME                        
                                          WS-NME-APPL.                          
                                                                                
           IF K800-NUM-NRIC2(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC2      NOT = SPACES                                  
              MOVE K800-NUM-REGN       TO K820-NUM-REGN                         
              MOVE K800-NUM-NRIC2      TO K820-NUM-NRIC                         
              PERFORM 400-READ-BP13K820  THRU 400-EXIT                          
              MOVE K820-NME-OCCP       TO 400A-COAPPL-NAME                      
                                          WS-NME-COAPPL                         
           ELSE                                                                 
              MOVE SPACES              TO 400A-COAPPL-NAME                      
                                          WS-NME-COAPPL.                        
                                                                                
           IF K800-NUM-NRIC3(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC3      NOT = SPACES                                  
              MOVE K800-NUM-REGN       TO K820-NUM-REGN                         
              MOVE K800-NUM-NRIC3      TO K820-NUM-NRIC                         
              PERFORM 400-READ-BP13K820  THRU 400-EXIT                          
              MOVE K820-NME-OCCP       TO 400A-THIRD-NAME                       
                                          WS-NME-THIRD-APPL                     
           ELSE                                                                 
              MOVE SPACES              TO 400A-THIRD-NAME                       
                                          WS-NME-THIRD-APPL.                    
                                                                                
           IF K800-NUM-NRIC4(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC4      NOT = SPACES                                  
              MOVE K800-NUM-REGN       TO K820-NUM-REGN                         
              MOVE K800-NUM-NRIC4      TO K820-NUM-NRIC                         
              PERFORM 400-READ-BP13K820  THRU 400-EXIT                          
              MOVE K820-NME-OCCP       TO 400A-FOURTH-NAME                      
                                          WS-NME-FOURTH-APPL                    
           ELSE                                                                 
              MOVE SPACES              TO 400A-FOURTH-NAME                      
                                          WS-NME-FOURTH-APPL.                   
                                                                                
      *-----------------------------------------------------------*             
      *    RETRIEVE ADDRESS FROM BP13K830 USING F310-REGN-NO      *             
      *-----------------------------------------------------------*             
           MOVE F310-REGN-NO           TO K830-NUM-REGN.                        
                                                                                
           READ BP13K830 KEY IS K830-NUM-REGN.                                  
                                                                                
           IF BP13K830-STATUS = 00 OR 02                                        
            IF K830-NUM-MAIL-ADDR = SPACES OR LOW-VALUES                        
             IF K830-NUM-ADDR-TYPE = 'H'                                        
                MOVE SPACES            TO 400A-K830-STREET-NAME                 
                MOVE K830-NUM-BLK      TO 400A-K830-BLK-NO                      
                MOVE K830-NME-STREET   TO 400A-K830-STREET-NAME                 
                MOVE K830-NUM-LVL-CHAR TO 400A-K830-CHAR                        
                MOVE K830-NUM-LVL-NUM  TO 400A-K830-LEVEL                       
                MOVE K830-NUM-LVL-DASH TO 400A-K830-DASH                        
                MOVE K830-NUM-HSEMAIN  TO 400A-K830-HSE-MAIN                    
                MOVE K830-NUM-HSESUB   TO 400A-K830-HSE-SUB                     
                IF K830-NUM-POSTAL = SPACES OR LOW-VALUES OR ZEROES             
                   MOVE SPACES         TO 400A-COUNTRY-NME1                     
                   MOVE SPACES         TO 400A-POSTAL-CD                        
                ELSE                                                            
                   MOVE 'SINGAPORE'     TO 400A-COUNTRY-NME1                    
                   MOVE K830-NUM-POSTAL TO 400A-POSTAL-CD                       
             ELSE                                                               
                MOVE SPACES               TO 400A-K830-STREET-NAME              
                MOVE K830-NUM-BLK         TO 400A-K830-BLK-NO                   
                MOVE K830-NME-STREET-BLDG TO 400A-K830-STREET-NAME              
                MOVE K830-NUM-FLAT        TO 400A-NUM-FLAT                      
                IF K830-NUM-POSTAL =  SPACES OR LOW-VALUES OR ZEROES            
                   MOVE SPACES            TO 400A-COUNTRY-NME1                  
                   MOVE SPACES            TO 400A-POSTAL-CD                     
                ELSE                                                            
                   MOVE 'SINGAPORE'       TO 400A-COUNTRY-NME1                  
                   MOVE K830-NUM-POSTAL   TO 400A-POSTAL-CD                     
                END-IF                                                          
             END-IF                                                             
      *--------TO GET THE BAR CODE -----------------------------------          
                                                                                
                MOVE SPACES                     TO WS-LINK-AV02C015             
                MOVE K830-NUM-POSTAL            TO AV02C015-IN-POSTCODE         
                PERFORM 605-CALL-AV02C015       THRU 605-EXIT                   
                MOVE AV02C015-OUT-POSTCODE-CHKSUM TO 400A-BAR-CODE              
                                                                                
            ELSE                                                                
             IF K830-NUM-MAIL-ADDR-TYPE = 'H'                                   
                MOVE SPACES                 TO 400A-K830-STREET-NAME            
                MOVE K830-NUM-MAIL-BLK      TO 400A-K830-BLK-NO                 
                MOVE K830-NME-MAIL-STREET   TO 400A-K830-STREET-NAME            
                MOVE K830-NUM-MAIL-LVL-CHAR TO 400A-K830-CHAR                   
                MOVE K830-NUM-MAIL-LVL-NUM  TO 400A-K830-LEVEL                  
                MOVE K830-NUM-MAIL-LVL-DASH TO 400A-K830-DASH                   
                MOVE K830-NUM-MAIL-HSEMAIN  TO 400A-K830-HSE-MAIN               
                MOVE K830-NUM-MAIL-HSESUB   TO 400A-K830-HSE-SUB                
                IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR ZEROES        
                   MOVE SPACES              TO 400A-POSTAL-CD                   
                   MOVE SPACES              TO 400A-COUNTRY-NME1                
                ELSE                                                            
                   MOVE 'SINGAPORE'          TO 400A-COUNTRY-NME1               
                   MOVE K830-NUM-MAIL-POSTAL TO 400A-POSTAL-CD                  
                END-IF                                                          
             ELSE                                                               
                MOVE SPACES                 TO 400A-K830-STREET-NAME            
                MOVE K830-NUM-MAIL-BLK      TO 400A-K830-BLK-NO                 
                MOVE K830-NME-MAIL-STR-BLDG TO 400A-K830-STREET-NAME            
                MOVE K830-NUM-MAIL-FLAT     TO 400A-NUM-FLAT                    
                IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR ZEROES        
                   MOVE SPACES              TO 400A-POSTAL-CD                   
                   MOVE SPACES              TO 400A-POSTAL-CD                   
                ELSE                                                            
                   MOVE 'SINGAPORE'          TO 400A-COUNTRY-NME1               
                   MOVE K830-NUM-MAIL-POSTAL TO 400A-POSTAL-CD                  
                END-IF                                                          
             END-IF                                                             
      *--------TO GET THE BAR CODE -----------------------------------          
                                                                                
                MOVE SPACES                     TO WS-LINK-AV02C015             
                MOVE K830-NUM-POSTAL            TO AV02C015-IN-POSTCODE         
                PERFORM 605-CALL-AV02C015       THRU 605-EXIT                   
                MOVE AV02C015-OUT-POSTCODE-CHKSUM TO 400A-BAR-CODE              
             END-IF.                                                            
                                                                                
           IF BP13K830-STATUS = 23                                              
              DISPLAY 'BP13K830 RECORD NOT FOUND = ' BP13K830-STATUS            
              DISPLAY '    K830-NUM-REGN         = ' K830-NUM-REGN.             
                                                                                
           IF BP13K830-STATUS NOT = 00 AND 02 AND 23                            
              DISPLAY 'ERROR READING BP13K830    = ' BP13K830-STATUS            
              DISPLAY '      K830-NUM-REGN       = ' K830-NUM-REGN              
              GO TO    9000-CLOSE-ROUTINE.                                      
                                                                                
       320-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       400-READ-BP13K820.                                                       
      ******************************************************************        
           READ BP13K820.                                                       
                                                                                
           IF BP13K820-STATUS = 00                                              
              NEXT SENTENCE                                                     
           ELSE                                                                 
           IF BP13K820-STATUS = 23                                              
              MOVE     SPACES   TO K820-NME-OCCP                                
              DISPLAY 'BP13K820 RECORD NOT FOUND = ' BP13K820-STATUS            
              DISPLAY '    K820-NUM-REGN         = ' K820-NUM-REGN              
           ELSE                                                                 
              MOVE     SPACES   TO K820-NME-OCCP                                
              DISPLAY 'ERROR READING BP13K820 ' BP13K820-STATUS.                
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *************************************************************     02500001
      *  ROUTINE TO COMPUTE THE K800-DTE-EXPIRED-TP               *     02510001
      *  IE. 30 DAYS  AFTER F200-DTE-BKAPPMT-DATE                 *     02520001
      *************************************************************     02530001
      ******************************************************************        
       510-COMPUTE-DTE-EXPIRED-TP.                                      02550001
      ******************************************************************        
           MOVE ZEROS            TO WS-NUM-FIELD.                       02570036
           ADD  30               TO CAL-DAY.                            02610036
                                                                        02620001
           PERFORM 520-PROCESS-DATE  THRU 520-EXIT.                     02630001
                                                                        02640120
           MOVE  SPACES TO LINK-REC.                                    02640234
                                                                        02640334
           PERFORM 530-CHECK-HOLIDAY THRU 530-EXIT                      02650003
             UNTIL WS-RET-DAY = 'EVE' OR 'DAY' OR 'EIF' OR 'EID' OR     02661018
                                'EIR'.                                  02662018
                                                                        02672010
       510-EXIT.                                                        02680001
           EXIT.                                                        02690001
                                                                        02700001
                                                                        02700001
      ******************************************************************        
       520-PROCESS-DATE.                                                02720001
      ******************************************************************        
           IF 31-DAY-MONTH                                              02740001
               IF CAL-DAY > 31                                          02750002
               COMPUTE CAL-DAY    = CAL-DAY    - 31                     02760001
               COMPUTE CAL-MONTH  = CAL-MONTH  + 1                      02770002
               END-IF                                                   02771002
           END-IF.                                                      02772002
                                                                        02780001
           IF 30-DAY-MONTH                                              02790001
               IF CAL-DAY > 30                                          02800002
               COMPUTE CAL-DAY    = CAL-DAY    - 30                     02810001
               COMPUTE CAL-MONTH  = CAL-MONTH  + 1                      02820002
               END-IF                                                   02821002
           END-IF.                                                      02822002
                                                                        02830001
           IF 28-29-DAY-MONTH                                           02840001
               IF  CAL-DAY < 29                                         02850002
                   GO TO 520-EXIT                                       02860001
               ELSE                                                     02870001
                   PERFORM 540-FEBRUARY                                 02880001
                      THRU 540-EXIT                                     02890001
               END-IF                                                   02891002
           END-IF.                                                      02892002
                                                                        02910001
           IF CAL-MONTH  > 12                                           02920001
              MOVE 01 TO CAL-MONTH                                      02930001
              ADD 01 TO CAL-YEAR.                                       02940001
                                                                        02950001
       520-EXIT.                                                        02960001
           EXIT.                                                        02970001
                                                                        02980001
                                                                        02980001
      *------------------*                                              02990003
       530-CHECK-HOLIDAY.                                               03000003
      *------------------*                                              03010003
           MOVE  CAL-DATE              TO WS-IN-DATE.                   03011323
           MOVE 'HD'                   TO WS-IN-OPTION.                 03011503
           MOVE '000'                  TO WS-RETURN.                    03012003
                                                                        03013003
           CALL 'AV02C002' USING LINK-REC.                              03014223
                                                                        03015003
           IF WS-RETURN = 'EID'                                         03016003
              DISPLAY 'ERROR IN DATE ' WS-IN-DATE                       03017003
              MOVE SPACES TO CAL-DATE.                                  03017103
                                                                        03018003
           IF WS-RET-DAY = 'HOL'                                        03019003
              ADD 1 TO CAL-DAY                                          03019103
              PERFORM 520-PROCESS-DATE                                  03019303
                 THRU 520-EXIT                                          03019403
           END-IF.                                                      03019503
                                                                        03020003
       530-EXIT.                                                        03120001
           EXIT.                                                        03130001
                                                                        03140001
                                                                        03140001
      *----------------*                                                03150001
       540-FEBRUARY.                                                    03160001
      *----------------*                                                03170001
           DIVIDE 4 INTO CAL-YEAR GIVING WS-YEAR REMAINDER WS-REM.      03180001
           IF (WS-REM = ZERO) AND (CAL-DAY > 29)                        03190002
              COMPUTE CAL-DAY = CAL-DAY - 29                            03210001
              MOVE 03 TO CAL-MONTH                                      03220001
           ELSE                                                         03230001
           IF (WS-REM NOT = ZERO) AND (CAL-DAY > 28)                    03250002
              COMPUTE CAL-DAY = CAL-DAY - 28                            03270001
              MOVE 03 TO CAL-MONTH.                                     03280001
                                                                        03290001
       540-EXIT.                                                        03300001
           EXIT.                                                        03310001
                                                                        03320001
                                                                        03320001
      ******************************************************************        
       600-L400A-PROCESS-PRINT.                                                 
      ******************************************************************        
      *-----------------------------------------------------------*             
      *    PRINT  APPOINTMENT LETTERS (S.O)                       *             
      *-----------------------------------------------------------*             
           IF F310-CDE-TYP-ACTUSE = '06'                                        
              MOVE 'E ' TO 400A-RM-TY 400C-RM-TY                                
           ELSE                                                                 
           IF F310-CDE-TYP-ACTUSE = '08'                                        
              MOVE 'MG' TO 400A-RM-TY 400C-RM-TY                                
           ELSE                                                                 
           IF F310-CDE-TYP-ACTUSE = '04' AND                                    
              F310-CDE-MODL-DESG = '06'                                         
              MOVE '4S' TO 400A-RM-TY 400C-RM-TY                                
           ELSE                                                                 
              MOVE F310-CDE-TYP-ACTUSE TO 400A-RM-TY                            
                                          400C-RM-TY.                           
                                                                                
           IF F310-DTE-TRANS NOT = SPACES AND LOW-VALUES                        
              STRING F310-DTE-DD OF F310-DTE-TRANS DELIMITED BY SIZE            
                     '/'                    DELIMITED BY SIZE                   
                     F310-DTE-MM OF F310-DTE-TRANS DELIMITED BY SIZE            
                     '/'                    DELIMITED BY SIZE                   
                     F310-DTE-CC OF F310-DTE-TRANS DELIMITED BY SIZE            
                     F310-DTE-YY OF F310-DTE-TRANS DELIMITED BY SIZE            
                                        INTO 400A-CURRENT-DATE                  
           ELSE                                                                 
              MOVE SPACES                 TO 400A-CURRENT-DATE                  
           END-IF.                                                              
                                                                                
           MOVE  WS-EDITED-DATE        TO 400C-CURRENT-DATE.                    
           MOVE  F310-NUM-BLK          TO 400A-BLK-NO.                          
           MOVE  F310-NME-STREET       TO 400A-STREET-NAME.                     
           MOVE  F310-NUM-LEVEL        TO 400A-LEVEL-NO.                        
           MOVE  F310-NUM-MAIN         TO 400A-UNIT-NO.                         
                                                                                
           IF F310-NUM-POSTAL = SPACES OR LOW-VALUES OR ZEROES                  
              MOVE SPACES              TO 400A-POST-CODE                        
              MOVE SPACES              TO 400A-COUNTRY-NME2                     
           ELSE                                                                 
              MOVE 'SINGAPORE'         TO 400A-COUNTRY-NME2                     
              MOVE F310-NUM-POSTAL     TO 400A-POST-CODE.                       
                                                                                
           IF K110-CURR-SELLING-PRICE IS NOT NUMERIC                            
              MOVE  ZERO                TO K110-CURR-SELLING-PRICE              
           END-IF.                                                              
           MOVE K110-CURR-SELLING-PRICE TO 400A-SELLING-PRICE.                  
                                                                                
           MOVE F310-CDE-TYP-ACTUSE     TO  BM97-NUM-FLAT-TYPE.                 
           MOVE F310-CDE-MODL-DESG      TO  BM97-CDE-MODL-DESG.                 
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-CURRENT-DATE.                  
                                                                                
           MOVE WS-CURRENT-DATE         TO  BM97-DTE-COMPARE.                   
                                                                                
           INITIALIZE                       BM97-NUM-ERROR                      
                                            BM97-NUM-SYSERR.                    
                                                                                
           CALL 'AB20C900' USING WS-BM97-AREA.                                  
                                                                                
           IF BM97-NUM-ERROR = ZEROS OR SPACES AND                              
              BM97-NUM-SYSERR = ZEROS                                           
              IF   BM97-AMT-INSURED IS NOT NUMERIC                              
                   MOVE  ZERO          TO  BM97-AMT-INSURED                     
              END-IF                                                            
              MOVE BM97-AMT-INSURED    TO  L400A-AMT-INSURED                    
              IF   BM97-AMT-PREMIUM IS NOT NUMERIC                              
                   MOVE  ZERO          TO  BM97-AMT-PREMIUM                     
              END-IF                                                            
              MOVE BM97-AMT-PREMIUM    TO  L400A-AMT-PREMIUM                    
           ELSE                                                                 
              MOVE BM97-NUM-SYSERR     TO  RETURN-CODE                          
              DISPLAY 'ERROR IN CALLING AB20C900, ' BM97-NUM-ERROR              
              MOVE SPACES              TO  L400A-AMT-I-R                        
                                           L400A-AMT-P-R.                       
                                                                                
       600-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       605-CALL-AV02C015.                                                       
      *****************************************************************         
           CALL 'AV02C015'          USING                                       
                                    AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM.               
       605-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       610-PRINT-LETTER-L400A.                                                  
      ******************************************************************        
           ADD 1                TO NO-OF-LETTER.                                
                                                                                
           PERFORM 830-READ-BP13K022  THRU 830-EXIT.                            
           PERFORM 840-GET-CSM-INFO   THRU 840-EXIT.                            
                                                                                
           MOVE SPACES TO PRINT-REC2.                                           
           WRITE PRINT-REC2                        AFTER PAGE.                  
                                                                                
           WRITE PRINT-REC2  FROM L400A-PR-HEAD-A  AFTER 4.                     
           WRITE PRINT-REC2  FROM L400A-PR-HEAD-1  AFTER 1.                     
           WRITE PRINT-REC2  FROM L400A-PR-HEAD-2A AFTER 0                      
           WRITE PRINT-REC2  FROM L400A-PR-HEAD-2  AFTER 1.                     
           WRITE PRINT-REC2  FROM L400A-PR-HEAD-3  AFTER 2.                     
           WRITE PRINT-REC2  FROM L400A-PR-HEAD-3B AFTER 1.                     
                                                                                
           IF K800-NUM-NRIC3(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC3      NOT = SPACES                                  
              WRITE PRINT-REC2  FROM L400A-PR-HEAD-3C AFTER 1                   
              WRITE PRINT-REC2  FROM L400A-PR-HEAD-3D AFTER 1                   
              WRITE PRINT-REC2  FROM L400A-PR-HEAD-4 AFTER  1                   
              WRITE PRINT-REC2  FROM L400A-PR-HEAD-5 AFTER  1                   
              WRITE PRINT-REC2  FROM L400A-PR-HEAD-6 AFTER  1                   
              WRITE PRINT-REC2  FROM L400A-PR-HEAD-7 AFTER  1                   
              WRITE PRINT-REC2  FROM L400A-PR-HEAD-9 AFTER  5                   
           ELSE                                                                 
              WRITE PRINT-REC2  FROM L400A-PR-HEAD-4 AFTER  1                   
              WRITE PRINT-REC2  FROM L400A-PR-HEAD-5 AFTER  1                   
              WRITE PRINT-REC2  FROM L400A-PR-HEAD-6 AFTER  1                   
              WRITE PRINT-REC2  FROM L400A-PR-HEAD-7 AFTER  3                   
              WRITE PRINT-REC2  FROM L400A-PR-HEAD-9 AFTER  5                   
           END-IF.                                                              
                                                                                
           WRITE PRINT-REC2 FROM L400A-PR-HEAD-10    AFTER 2.                   
           WRITE PRINT-REC2 FROM L400A-PR-HEAD-10A   AFTER 16.                  
           WRITE PRINT-REC2 FROM L400A-PR-HEAD-10B   AFTER 1.                   
           WRITE PRINT-REC2 FROM L400A-PR-HEAD-10C   AFTER 5.                   
                                                                                
           WRITE PRINT-REC2 FROM L400A-LINE-OIC      AFTER 13.                  
           WRITE PRINT-REC2 FROM L400A-LINE-OIC1     AFTER 1.                   
                                                                                
           WRITE PRINT-REC2 FROM L400A-PR-HEAD-11    AFTER 1.                   
           WRITE PRINT-REC2 FROM L400A-LINE-BARCODE  AFTER 0.                   
           WRITE PRINT-REC2 FROM L400A-LINE-BARCODE1 AFTER 1.                   
                                                                                
           MOVE SPACES TO 400A-DTE-EXPIRED-DES.                                 
                                                                                
       610-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       620-PRINT-WORK.                                                          
      ******************************************************************        
      *-----------------------------------------------------------*             
      *    PRINT WORKSHEET FORM                                   *             
      *-----------------------------------------------------------*             
           MOVE K800-NUM-IDP-SCHEME    TO WS-IDP-SCH.                           
                                                                                
           IF K800-AMT-CD-CASH IS NOT NUMERIC                                   
              MOVE  ZERO             TO    K800-AMT-CD-CASH                     
           END-IF.                                                              
           IF K800-AMT-CD-CPF1 IS NOT NUMERIC                                   
              MOVE  ZERO             TO    K800-AMT-CD-CPF1                     
           END-IF.                                                              
           IF K800-AMT-CD-CPF2 IS NOT NUMERIC                                   
              MOVE  ZERO             TO    K800-AMT-CD-CPF2                     
           END-IF.                                                              
           IF K800-AMT-CD-CPF3 IS NOT NUMERIC                                   
              MOVE  ZERO             TO    K800-AMT-CD-CPF3                     
           END-IF.                                                              
           IF K800-AMT-CD-CPF4 IS NOT NUMERIC                                   
              MOVE  ZERO             TO    K800-AMT-CD-CPF4                     
           END-IF.                                                              
           IF K800-AMT-CD-REFUND IS NOT NUMERIC                                 
              MOVE  ZERO             TO    K800-AMT-CD-REFUND                   
           END-IF.                                                              
                                                                                
           MOVE  ZERO             TO    WS-UPD-CD-CASH.                         
                                                                                
           COMPUTE WS-UPD-CD-CASH = K800-AMT-CD-CASH -                          
                                    K800-AMT-CD-REFUND.                         
           COMPUTE WS-TOTAL-CD = WS-UPD-CD-CASH   + K800-AMT-CD-CPF1 +          
                                 K800-AMT-CD-CPF2 + K800-AMT-CD-CPF3 +          
                                 K800-AMT-CD-CPF4.                              
                                                                                
           IF WS-TOTAL-CD NOT NUMERIC                                           
              MOVE ZEROS               TO WS-TOTAL-CD.                          
                                                                                
           IF K110-CURR-SELLING-PRICE IS NOT NUMERIC                            
              MOVE  ZERO             TO    K110-CURR-SELLING-PRICE              
           END-IF.                                                              
                                                                                
      *-----------------------------------------------------------*             
      *    TO COMPUTE THE SC/CC FIRST , THEN                      *             
      *       COMPUTE THE SC/CC AD VALOREM STAMP FEE              *             
      *-----------------------------------------------------------*             
           PERFORM 1300-PROCESS-S903     THRU 1300-S903-EXIT.                   
           PERFORM 1400-PROCESS-S905     THRU 1400-S905-EXIT.                   
           MOVE 0                        TO WS-S900-TOT-ICP.                    
           PERFORM 1100-PROCESS-S900     THRU 1100-S900-EXIT.                   
           ADD WS-LOAN-INT-2             TO WS-S900-TOT-ICP.                    
           MOVE ZEROS                    TO WS-LOAN-INT-2.                      
           MOVE WS-LOAN-ROUND-DOWN       TO WS-MAX-LOAN-AMT.                    
           PERFORM 1100-PROCESS-S900     THRU 1100-S900-EXIT.                   
           PERFORM 1200-PROCESS-S800     THRU 1200-S800-EXIT.                   
           PERFORM 1400-PROCESS-S901     THRU 1400-S901-EXIT.                   
                                                                                
           COMPUTE WS-TOT-STAMP-FEE = WS-COMP-LEASE + WS-MORT-STAMP-FEE         
                                    + WS-COMP-MORTGAGE.                         
                                                                                
           COMPUTE WS-TOTAL-FEES    = WS-TOT-STAMP-FEE +                        
                                      WS-COMP-SURVEY-FEE.                       
                                                                                
           COMPUTE WS-TOTAL-SELLPR  = WS-TOTAL-FEES +                           
                                      K110-CURR-SELLING-PRICE.                  
                                                                                
           COMPUTE WS-BALANCE-AMT   = WS-TOTAL-SELLPR - WS-TOTAL-CD.            
                                                                                
           MOVE K800-NUM-REGN            TO 400C-REGN.                          
           MOVE WS-INTREST-RATE          TO 400C-INT-RATE.                      
           MOVE K110-CURR-SELLING-PRICE  TO 400C-SELLING-PRICE.                 
           MOVE WS-COMP-LEASE            TO 400C-LEASE-FEE.                     
           MOVE WS-MORT-STAMP-FEE        TO 400C-MORT-STAMP-FEE.                
           MOVE WS-COMP-MORTGAGE         TO 400C-MORTGAGE-FEE.                  
           MOVE WS-TOT-STAMP-FEE         TO 400C-TOT-STAMP-FEE.                 
           MOVE WS-COMP-SURVEY-FEE       TO 400C-TOT-SURVEY-FEE.                
           MOVE WS-TOTAL-FEES            TO 400C-TOT-FEES.                      
           MOVE WS-TOTAL-SELLPR          TO 400C-TOT-SELLPR.                    
           MOVE WS-UPD-CD-CASH           TO 400C-CD-CASH.                       
           MOVE K800-AMT-CD-CPF1         TO 400C-CD-CPF1.                       
           MOVE K800-AMT-CD-CPF2         TO 400C-CD-CPF2.                       
           MOVE K800-AMT-CD-CPF3         TO 400C-CD-CPF3.                       
           MOVE K800-AMT-CD-CPF4         TO 400C-CD-CPF4.                       
           MOVE WS-TOTAL-CD              TO 400C-TOTAL-CD                       
           MOVE WS-BALANCE-AMT           TO 400C-BALANCE-AMT.                   
           MOVE WS-MAX-LOAN-AMT          TO 400C-MAX-LOAN-AMT.                  
           MOVE WS-MTHLY-INSTAL          TO 400C-MTHLY-INSTAL.                  
                                                                                
           IF (K800-NUM-SCCC-ELGBTY   = 'N' OR 'Z') OR                          
              (K800-NUM-ALLO-SCHEME   = 'SPO' OR 'SPP' OR 'SSP' OR              
                                        'SPS' OR 'SRP')                         
               COMPUTE WS-SC-CC1-AMT  = WS-S903-SC-CC1      +                   
                                        WS-S903-SC-CC1-GST  +                   
                                        WS-S903-SC-REC-TC1  +                   
                                        WS-S903-SC-TC1-GST                      
           ELSE                                                                 
               COMPUTE WS-SC-CC1-AMT  = WS-S903-SC-CC1      +                   
                                        WS-S903-SC-CC1-GST  -                   
                                        WS-S903-SC-REBATE1  -                   
                                        WS-S903-SC-GRANT1   -                   
                                        WS-S903-SC-REB-SP1                      
           END-IF.                                                              
                                                                                
           MOVE WS-S903-SC-CURR-EFF-DATE TO WS-DATE-WEF.                        
           MOVE WS-WEF-DD                TO WS-SCCC-DD.                         
           MOVE WS-WEF-MM                TO WS-SCCC-MM.                         
           MOVE WS-WEF-CC                TO WS-SCCC-CC.                         
           MOVE WS-WEF-YY                TO WS-SCCC-YY.                         
                                                                                
           IF (K800-NUM-SCCC-ELGBTY          = 'N' OR 'Z') OR                   
              (K800-NUM-ALLO-SCHEME          = 'SPO' OR 'SPP' OR 'SSP'          
                                            OR 'SPS' OR 'SRP')                  
               COMPUTE WS-SC-CC-NUM-AMT      =  WS-S903-SC-CC1 +                
                                                WS-S903-SC-REC-TC1              
               COMPUTE WS-SC-CC-NUM-GST-AMT  =  WS-S903-SC-CC1-GST +            
                                                WS-S903-SC-TC1-GST              
               MOVE WS-SC-CC-NUM-AMT         TO WS-SC-CC-AMT                    
               MOVE WS-SC-CC-NUM-GST-AMT     TO WS-SC-CC-GST-AMT                
           ELSE                                                                 
               MOVE WS-S903-SC-CC1           TO WS-SC-CC-AMT                    
               MOVE WS-S903-SC-CC1-GST       TO WS-SC-CC-GST-AMT                
           END-IF.                                                              
                                                                                
           IF (K800-NUM-SCCC-ELGBTY      =  'N' OR 'Z') OR                      
              (K800-NUM-ALLO-SCHEME      = 'SPO' OR 'SPP' OR  'SSP'             
                                            OR 'SPS' OR 'SRP')                  
               MOVE ')'                  TO WS-SC-CC-SIGN                       
               MOVE ZEROES               TO WS-SC-CC-REBATE-AMT                 
               MOVE SPACES               TO WS-SC-CC-REBATE-DESC                
               MOVE SPACES               TO WS-SC-CC-SIGN2                      
               MOVE ZEROES               TO WS-SC-CC-GRANT-AMT                  
               MOVE SPACES               TO WS-SC-CC-GRANT-DESC                 
               MOVE SPACES               TO WS-SC-CC-SIGN3                      
               MOVE ZEROES               TO WS-SC-CC-REB-SP-AMT                 
               MOVE SPACES               TO WS-SC-CC-REB-SP-DESC                
           ELSE                                                                 
           IF WS-S903-SC-REBATE1         =  ZEROES                              
              IF WS-S903-SC-GRANT1       =  ZEROES                              
                 IF WS-S903-SC-REB-SP1   =  ZEROES OR                           
                    WS-S903-ROOM-TY      = '06'                                 
                    MOVE ')'             TO WS-SC-CC-SIGN                       
                    MOVE ZEROES          TO WS-SC-CC-REBATE-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REBATE-DESC                
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN                       
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-REBATE-AMT              
                    MOVE  'SP)'         TO WS-SC-CC-REBATE-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN                       
                 MOVE WS-S903-SC-GRANT1  TO WS-SC-CC-REBATE-AMT                 
                 MOVE 'GRT'              TO WS-SC-CC-REBATE-DESC                
                 IF WS-S903-SC-REB-SP1    =  ZEROES OR                          
                    WS-S903-ROOM-TY      = '06'                                 
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              MOVE '-'                   TO WS-SC-CC-SIGN                       
              MOVE WS-S903-SC-REBATE1    TO WS-SC-CC-REBATE-AMT                 
              MOVE 'REB'                 TO WS-SC-CC-REBATE-DESC                
              IF WS-S903-SC-GRANT1        =  ZEROES                             
                 IF WS-S903-SC-REB-SP1    =  ZEROES OR                          
                    WS-S903-ROOM-TY      = '06'                                 
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN2                      
                 MOVE WS-S903-SC-GRANT1  TO WS-SC-CC-GRANT-AMT                  
                 MOVE 'GRT'              TO WS-SC-CC-GRANT-DESC                 
                 IF WS-S903-SC-REB-SP1    =  ZEROES OR                          
                    WS-S903-ROOM-TY      = '06'                                 
                    MOVE ')'             TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN3                      
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-REB-SP-AMT              
                    MOVE  'SP)'          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE WS-SC-CC1-AMT            TO 400C-AMT-CURR-SCCC.                 
           MOVE WS-SCCC-DATE             TO 400C-DTE-CURR-SCCC.                 
           MOVE WS-SC-CC-DESC            TO 400C-CURR-GST-DESC.                 
                                                                                
           IF (K800-NUM-SCCC-ELGBTY = 'N' OR 'Z') OR                            
              (K800-NUM-ALLO-SCHEME = 'SPO' OR 'SSP' OR 'SPP' OR                
                                      'SPS' OR 'SRP')                           
              COMPUTE WS-SC-CC2-AMT = WS-S903-SC-CC2     +                      
                                      WS-S903-SC-CC2-GST +                      
                                      WS-S903-SC-REC-TC2 +                      
                                      WS-S903-SC-TC2-GST                        
           ELSE                                                                 
              COMPUTE WS-SC-CC2-AMT = WS-S903-SC-CC2     +                      
                                      WS-S903-SC-CC2-GST -                      
                                      WS-S903-SC-REBATE2 -                      
                                      WS-S903-SC-GRANT2  -                      
                                      WS-S903-SC-REB-SP2                        
           END-IF.                                                              
                                                                                
           MOVE WS-S903-SC-NEXT-EFF-DATE TO WS-DATE-WEF.                        
           MOVE WS-WEF-DD                TO WS-SCCC-DD.                         
           MOVE WS-WEF-MM                TO WS-SCCC-MM.                         
           MOVE WS-WEF-CC                TO WS-SCCC-CC.                         
           MOVE WS-WEF-YY                TO WS-SCCC-YY.                         
                                                                                
           IF (K800-NUM-SCCC-ELGBTY          = 'N' OR 'Z') OR                   
              (K800-NUM-ALLO-SCHEME          = 'SPO' OR 'SPP' OR 'SSP'          
                                            OR 'SPS' OR 'SRP')                  
               COMPUTE WS-SC-CC-NUM-AMT      =  WS-S903-SC-CC2 +                
                                                WS-S903-SC-REC-TC2              
               COMPUTE WS-SC-CC-NUM-GST-AMT  =  WS-S903-SC-CC2-GST +            
                                                WS-S903-SC-TC2-GST              
               MOVE WS-SC-CC-NUM-AMT         TO WS-SC-CC-AMT                    
               MOVE WS-SC-CC-NUM-GST-AMT     TO WS-SC-CC-GST-AMT                
           ELSE                                                                 
               MOVE WS-S903-SC-CC2           TO WS-SC-CC-AMT                    
               MOVE WS-S903-SC-CC2-GST       TO WS-SC-CC-GST-AMT                
           END-IF.                                                              
                                                                                
           IF (K800-NUM-SCCC-ELGBTY      =  'N' OR 'Z') OR                      
              (K800-NUM-ALLO-SCHEME      = 'SPO' OR 'SPP' OR 'SSP'              
                                        OR 'SPS' OR 'SRP')                      
               MOVE ')'                  TO WS-SC-CC-SIGN                       
               MOVE ZEROES               TO WS-SC-CC-REBATE-AMT                 
               MOVE SPACES               TO WS-SC-CC-REBATE-DESC                
               MOVE SPACES               TO WS-SC-CC-SIGN2                      
               MOVE ZEROES               TO WS-SC-CC-GRANT-AMT                  
               MOVE SPACES               TO WS-SC-CC-GRANT-DESC                 
               MOVE SPACES               TO WS-SC-CC-SIGN3                      
               MOVE ZEROES               TO WS-SC-CC-REB-SP-AMT                 
               MOVE SPACES               TO WS-SC-CC-REB-SP-DESC                
           ELSE                                                                 
           IF WS-S903-SC-REBATE2         =  ZEROES                              
              IF WS-S903-SC-GRANT2       =  ZEROES                              
                 IF WS-S903-SC-REB-SP2   =  ZEROES OR                           
                    WS-S903-ROOM-TY      = '06'                                 
                    MOVE ')'             TO WS-SC-CC-SIGN                       
                    MOVE ZEROES          TO WS-SC-CC-REBATE-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REBATE-DESC                
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN                       
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-REBATE-AMT              
                    MOVE  'SP)'          TO WS-SC-CC-REBATE-DESC                
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN                       
                 MOVE WS-S903-SC-GRANT2  TO WS-SC-CC-REBATE-AMT                 
                 MOVE 'GRT'             TO WS-SC-CC-REBATE-DESC                 
                 IF WS-S903-SC-REB-SP2    =  ZEROES OR                          
                    WS-S903-ROOM-TY      = '06'                                 
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              MOVE '-'                   TO WS-SC-CC-SIGN                       
              MOVE WS-S903-SC-REBATE2    TO WS-SC-CC-REBATE-AMT                 
              MOVE 'REB'                 TO WS-SC-CC-REBATE-DESC                
              IF WS-S903-SC-GRANT1        =  ZEROES                             
                 IF WS-S903-SC-REB-SP2    =  ZEROES OR                          
                    WS-S903-ROOM-TY      = '06'                                 
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN2                      
                 MOVE WS-S903-SC-GRANT2  TO WS-SC-CC-GRANT-AMT                  
                 MOVE 'GRT'              TO WS-SC-CC-GRANT-DESC                 
                 IF WS-S903-SC-REB-SP2    =  ZEROES OR                          
                    WS-S903-ROOM-TY      = '06'                                 
                    MOVE ')'             TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN3                      
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-REB-SP-AMT              
                    MOVE  'SP)'          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE WS-SC-CC2-AMT            TO 400C-AMT-NEXT-SCCC.                 
           MOVE WS-SCCC-DATE             TO 400C-DTE-NEXT-SCCC.                 
           MOVE WS-SC-CC-DESC            TO 400C-NEXT-GST-DESC.                 
           COMPUTE WS-TOT-SCCC = WS-SC-CC1-AMT + (WS-SC-CC2-AMT * 2)            
                                                                                
           MOVE WS-TOT-SCCC   TO 400C-SC-CC-AMT.                                
                                                                                
           MOVE  SPACES       TO PRINT-REC-1.                                   
                                                                                
           WRITE PRINT-REC-1             AFTER PAGE.                            
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-1  AFTER 6.         
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-2  AFTER 2.         
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-3  AFTER 3.         
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-4  AFTER 2.         
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-5  AFTER 2.         
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-6  AFTER 2.         
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-7  AFTER 2.         
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-8  AFTER 2.         
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-9  AFTER 3.         
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-10 AFTER 4.         
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-11 AFTER 2.         
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-12 AFTER 2.         
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-13 AFTER 2.         
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-14 AFTER 2.         
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-15 AFTER 3.         
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-16 AFTER 3.         
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-17 AFTER 3.         
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-18 AFTER 2.         
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-0  AFTER 11.        
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-19 AFTER 1.         
           WRITE PRINT-REC-1             FROM L400C-PR-LINE-20 AFTER 1.         
                                                                                
       620-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       700-L400-PROCESS-PRINT.                                                  
      ******************************************************************        
      *-----------------------------------------------------------*             
      *    PRINT CONTROL LIST FOR APPOINTMENT LETTERS (S.O)       *             
      *-----------------------------------------------------------*             
           IF WS-NUMBER-1 > 46                                                  
              PERFORM 800-PRINT-HEADING  THRU 800-EXIT.                         
                                                                                
           PERFORM    900-PRINT-DETAIL   THRU 900-EXIT.                         
                                                                                
       700-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       710-L400-PROCESS-PRINT.                                                  
      ******************************************************************        
      *-----------------------------------------------------------*             
      *    PRINT CONTROL LIST FOR CASES W/ KEY-AVAIL. AFTER SA.   *             
      *-----------------------------------------------------------*             
           IF WS-NUMBER-2 > 46                                                  
              PERFORM 810-PRINT-HEADING  THRU 810-EXIT.                         
                                                                                
           PERFORM    910-PRINT-DETAIL   THRU 910-EXIT.                         
           ADD 1  TO NO-OF-L400B.                                               
                                                                                
       710-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       720-L400F-PROCESS-PRINT.                                                 
      ******************************************************************        
      *---------------------------------------------------------------*         
      * PRINT CONTROL LIST FOR ACCEPTED CASES THAT HAVE KEY-AVAILABLE *         
      *  BUT NO AGREEMENT ORDER DATE                                  *         
      *---------------------------------------------------------------*         
           IF WS-NUMBER-L400F > 46                                              
              PERFORM 850-PRINT-HEADING  THRU 850-EXIT                          
           END-IF.                                                              
                                                                                
           PERFORM    950-PRINT-DETAIL   THRU 950-EXIT.                         
           ADD 1  TO NO-OF-L400F.                                               
                                                                                
       720-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       800-PRINT-HEADING.                                                       
      ******************************************************************        
            ADD    1               TO    NO-OF-PAGE-1.                          
            MOVE   NO-OF-PAGE-1    TO    400-PAGE.                              
            MOVE  'BP13L400'       TO    400-LIST.                              
            WRITE  PRINT-REC-2     FROM  L400-PR-HEAD-16 AFTER PAGE.            
            MOVE   WS-EDITED-DATE  TO    400-DATE.                              
            WRITE  PRINT-REC-2     FROM  L400-PR-HEAD-17 AFTER 2.               
            WRITE  PRINT-REC-2     FROM  L400-PR-HEAD-18 AFTER 3.               
            MOVE   SPACES          TO    PRINT-REC-2.                           
            WRITE  PRINT-REC-2     AFTER 2.                                     
            MOVE   0               TO    WS-NUMBER-1.                           
                                                                                
       800-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       810-PRINT-HEADING.                                                       
      ******************************************************************        
            ADD    1               TO     NO-OF-PAGE-2.                         
            MOVE   NO-OF-PAGE-2    TO     400-PAGE.                             
            MOVE  'P13L400B'       TO     400-LIST.                             
            WRITE  PRINT-REC-3     FROM   L400-PR-HEAD-16 AFTER PAGE.           
            MOVE   WS-EDITED-DATE  TO     400-DATE.                             
            WRITE  PRINT-REC-3     FROM   L400-PR-HEAD-17 AFTER 2.              
            WRITE  PRINT-REC-3     FROM   L400F-PR-HEAD-18 AFTER 3.             
            MOVE   SPACES          TO     PRINT-REC-3.                          
            WRITE  PRINT-REC-3     AFTER  2.                                    
            MOVE   0               TO     WS-NUMBER-2.                          
                                                                                
       810-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       830-READ-BP13K022.                                                       
      ******************************************************************        
           MOVE 'N'          TO K022-FOUND.                                     
                                                                                
           MOVE F310-REGN-NO TO K022-NUM-REGN.                                  
                                                                                
           READ BP13K022 KEY IS K022-NUM-REGN.                                  
                                                                                
           IF BP13K022-STATUS = 00                                              
              MOVE 'Y' TO K022-FOUND                                            
           ELSE                                                                 
           IF BP13K022-STATUS = 23                                              
              MOVE 'N' TO K022-FOUND                                            
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K022 = '  BP13K022-STATUS              
              MOVE 'N' TO K022-FOUND.                                           
                                                                                
           MOVE 'N'          TO K024-FOUND.                                     
           IF K022-FOUND = 'Y'                                                  
              ADD 1                       TO   WS-CNT-K022                      
              MOVE K022-NUM-OIC           TO   K024-NUM-OIC                     
              PERFORM 835-READ-BP13K024   THRU 835-EXIT                         
           END-IF.                                                              
                                                                                
       830-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       835-READ-BP13K024.                                                       
      ******************************************************************        
           READ BP13K024 KEY IS K024-KEY-FLD.                                   
                                                                                
           IF BP13K024-STATUS = 00                                              
              MOVE 'Y' TO K024-FOUND                                            
           ELSE                                                                 
           IF BP13K024-STATUS = 23                                              
              MOVE 'N' TO K024-FOUND                                            
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K024 = '  BP13K024-STATUS              
              MOVE 'N' TO K024-FOUND.                                           
                                                                                
           IF K024-FOUND = 'Y'                                                  
              ADD   1  TO WS-CNT-K024                                           
           END-IF.                                                              
                                                                                
       835-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       840-GET-CSM-INFO.                                                        
      ******************************************************************        
           MOVE SPACES TO 400A-HDR-PHONE-DID                                    
                          L400A-DTL-HAND-PHONE                                  
      *                   400A-EMAIL                                            
                          L400A-DTL-DID                                         
                          400A-OIC-NAME                                         
                          400A-OIC-DESG                                         
                          WS-HDR-PHONE-DID                                      
                          WS-EMAIL.                                             
                                                                                
           IF K024-FOUND = 'Y'                                                  
              PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 5               
                 MOVE SPACES TO WS-OIC-EMAIL-TAB(WS-CTR)                        
                 MOVE SPACES TO WS-OIC-TAB(WS-CTR)                              
              END-PERFORM                                                       
                                                                                
              MOVE K024-NME-OIC                 TO 400A-OIC-NAME                
              MOVE 'CUSTOMER SERVICE MANAGER'   TO 400A-OIC-DESG                
              MOVE K024-NUM-DID                 TO 400A-HDR-PHONE-DID           
                                                   400A-CHG-APPT-DID            
              MOVE '1800-8663066'               TO 400A-ASSIST-HP               
      *       MOVE 'HDBSALES@HDB.GOV.SG'        TO WS-EMAIL                     
           ELSE                                                                 
              MOVE '1800-8663066(TOLL-FREE)'    TO WS-HDR-PHONE-DID             
              MOVE FUNCTION LOWER-CASE(WS-HDR-PHONE-DID)                        
                                                TO 400A-HDR-PHONE-DID           
              MOVE '64903783'                   TO 400A-CHG-APPT-DID            
              MOVE '1800-8663066'               TO 400A-ASSIST-HP               
      *       MOVE 'HDBSALES@HDB.GOV.SG'        TO WS-EMAIL                     
           END-IF.                                                              
                                                                                
      *    MOVE FUNCTION LOWER-CASE(WS-EMAIL)   TO 400A-EMAIL.                  
                                                                                
       840-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       850-PRINT-HEADING.                                                       
      ******************************************************************        
            ADD    1                TO     NO-OF-PAGE-L400F.                    
            MOVE   NO-OF-PAGE-L400F TO     400F-PAGE.                           
            MOVE  'P13L400F'        TO     400F-LIST.                           
            WRITE  PRINT-REC-L400F  FROM   L400F-PR-HEAD-16 AFTER PAGE.         
            MOVE   WS-EDITED-DATE   TO     400F-DATE.                           
            WRITE  PRINT-REC-L400F  FROM   L400F-PR-HEAD-17 AFTER 2.            
            WRITE  PRINT-REC-L400F  FROM   L400F-PR-HEAD-18F AFTER 3.           
            WRITE  PRINT-REC-L400F  FROM   L400F-PR-HEAD-18B AFTER 1.           
            MOVE   SPACES           TO     PRINT-REC-L400F.                     
            WRITE  PRINT-REC-L400F  AFTER  2.                                   
            MOVE   0                TO     WS-NUMBER-L400F.                     
                                                                                
       850-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       900-PRINT-DETAIL.                                                        
      ******************************************************************        
            ADD  1                        TO WS-NUMBER-1.                       
            MOVE K800-NUM-REGN            TO 400-REGN-NO.                       
                                                                                
            IF K800-NOT-FOUND = 'Y'                                             
               MOVE SPACES                TO 400-NRIC                           
            ELSE                                                                
               MOVE K800-NUM-NRIC1        TO 400-NRIC.                          
                                                                                
            MOVE WS-NME-APPL              TO 400-NAME.                          
            MOVE F310-NUM-BLK             TO 400-BLK-NO.                        
            MOVE F310-NME-STREET          TO 400-STREET-NAME.                   
            MOVE F310-NUM-LEVEL           TO 400-LEVEL-NO.                      
            MOVE '-'                      TO 400-DASH.                          
            MOVE F310-NUM-MAIN            TO 400-UNIT-NO.                       
            MOVE K110-CURR-SELLING-PRICE  TO 400-SELLING-PR.                    
            MOVE K800-NUM-SCH-ACC         TO 400-SCH-ACC-NO.                    
            MOVE WS-DTE-EXPIRED-TP        TO 400-DTE-EXPIRED-TP.                
                                                                                
            WRITE PRINT-REC-2 FROM L400-PR-HEAD-19 AFTER 1.                     
                                                                                
            IF WS-NME-COAPPL NOT = SPACES                                       
               IF K800-NOT-FOUND NOT = 'Y'                                      
                  ADD 1                   TO WS-NUMBER-1                        
                  MOVE SPACES             TO L400-PR-HEAD-19                    
                  MOVE WS-NME-COAPPL      TO 400-NAME                           
                  MOVE K800-NUM-NRIC2     TO 400-NRIC                           
                  WRITE PRINT-REC-2 FROM L400-PR-HEAD-19 AFTER 1.               
                                                                                
            IF WS-NME-THIRD-APPL NOT = SPACES                                   
               IF K800-NOT-FOUND NOT = 'Y'                                      
                  ADD 1                   TO WS-NUMBER-1                        
                  MOVE SPACES             TO L400-PR-HEAD-19                    
                  MOVE WS-NME-THIRD-APPL  TO 400-NAME                           
                  MOVE K800-NUM-NRIC3     TO 400-NRIC                           
                  WRITE PRINT-REC-2 FROM L400-PR-HEAD-19 AFTER 1.               
                                                                                
            IF WS-NME-FOURTH-APPL NOT = SPACES                                  
               IF K800-NOT-FOUND NOT = 'Y'                                      
                  ADD 1                   TO WS-NUMBER-1                        
                  MOVE SPACES             TO L400-PR-HEAD-19                    
                  MOVE WS-NME-FOURTH-APPL TO 400-NAME                           
                  MOVE K800-NUM-NRIC4     TO 400-NRIC                           
                  WRITE PRINT-REC-2 FROM L400-PR-HEAD-19 AFTER 1.               
                                                                                
            MOVE  SPACES                  TO PRINT-REC-2.                       
            WRITE PRINT-REC-2             AFTER 1.                              
            ADD  1                        TO WS-NUMBER-1.                       
                                                                                
       900-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       910-PRINT-DETAIL.                                                        
      ******************************************************************        
            ADD  1                        TO WS-NUMBER-2.                       
            MOVE K800-NUM-REGN            TO 400F-REGN-NO.                      
                                                                                
            IF K800-NOT-FOUND = 'Y'                                             
               MOVE SPACES                TO 400F-NRIC                          
            ELSE                                                                
               MOVE K800-NUM-NRIC1        TO 400F-NRIC.                         
                                                                                
            MOVE WS-NME-APPL              TO 400F-NAME.                         
            MOVE F310-NUM-BLK             TO 400F-BLK-NO.                       
            MOVE F310-NME-STREET          TO 400F-STREET-NAME.                  
            MOVE F310-NUM-LEVEL           TO 400F-LEVEL-NO.                     
            MOVE '-'                      TO 400F-DASH.                         
            MOVE F310-NUM-MAIN            TO 400F-UNIT-NO.                      
            MOVE K110-CURR-SELLING-PRICE  TO 400F-SELLING-PR.                   
            MOVE 400F-SELLING-PR          TO WS-SEL-PRICE.                      
            MOVE SPACES                   TO FILLER-SL2                         
                                             400F-BUY-SEL-TAG.                  
            STRING K110-DTE-ACCEPTANCE(7:2) '/'                                 
                   K110-DTE-ACCEPTANCE(5:2) '/'                                 
                   K110-DTE-ACCEPTANCE(1:4)                                     
                   DELIMITED BY SIZE    INTO 400F-DTE-ACCEPT.                   
                                                                                
            WRITE PRINT-REC-3 FROM L400F-PR-HEAD-19 AFTER 1.                    
                                                                                
            IF WS-NME-COAPPL NOT = SPACES                                       
               IF K800-NOT-FOUND NOT = 'Y'                                      
                  ADD 1                   TO WS-NUMBER-2                        
                  MOVE SPACES             TO L400F-PR-HEAD-19                   
                  MOVE WS-NME-COAPPL      TO 400F-NAME                          
                  MOVE K800-NUM-NRIC2     TO 400F-NRIC                          
                  WRITE PRINT-REC-3 FROM L400F-PR-HEAD-19 AFTER 1.              
                                                                                
            IF WS-NME-THIRD-APPL NOT = SPACES                                   
               IF K800-NOT-FOUND NOT = 'Y'                                      
                  ADD 1                   TO WS-NUMBER-2                        
                  MOVE SPACES             TO L400F-PR-HEAD-19                   
                  MOVE WS-NME-THIRD-APPL  TO 400F-NAME                          
                  MOVE K800-NUM-NRIC3     TO 400F-NRIC                          
                  WRITE PRINT-REC-3 FROM L400F-PR-HEAD-19 AFTER 1.              
                                                                                
            IF WS-NME-FOURTH-APPL NOT = SPACES                                  
               IF K800-NOT-FOUND NOT = 'Y'                                      
                  ADD 1                   TO WS-NUMBER-2                        
                  MOVE SPACES             TO L400F-PR-HEAD-19                   
                  MOVE WS-NME-FOURTH-APPL TO 400F-NAME                          
                  MOVE K800-NUM-NRIC4     TO 400F-NRIC                          
                  WRITE PRINT-REC-3 FROM L400F-PR-HEAD-19 AFTER 1.              
                                                                                
            MOVE  SPACES                  TO PRINT-REC-3.                       
            WRITE PRINT-REC-3             AFTER 1.                              
            ADD  1                        TO WS-NUMBER-2.                       
                                                                                
       910-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       950-PRINT-DETAIL.                                                        
      ******************************************************************        
            ADD  1                        TO WS-NUMBER-L400F.                   
            MOVE K800-NUM-REGN            TO 400F-REGN-NO.                      
                                                                                
            IF K800-NOT-FOUND = 'Y'                                             
               MOVE SPACES                TO 400F-NRIC                          
            ELSE                                                                
               MOVE K800-NUM-NRIC1        TO 400F-NRIC.                         
                                                                                
            MOVE WS-NME-APPL              TO 400F-NAME.                         
            MOVE F310-NUM-BLK             TO 400F-BLK-NO.                       
            MOVE F310-NME-STREET          TO 400F-STREET-NAME.                  
            MOVE F310-NUM-LEVEL           TO 400F-LEVEL-NO.                     
            MOVE '-'                      TO 400F-DASH.                         
            MOVE F310-NUM-MAIN            TO 400F-UNIT-NO.                      
            MOVE SPACES                   TO WS-SEL-PRICE                       
            MOVE ' / '                    TO FILLER-SL1                         
                                             FILLER-SL2.                        
      *     MOVE K110-CURR-SELLING-PRICE  TO 400F-SELLING-PR.                   
            MOVE WS-AHG-STATUS            TO 400F-AHG-STATUS.                   
            MOVE K800-NUM-LOAN-TAG        TO 400F-LOAN-TAG.                     
            MOVE K800-NUM-BUY-SELL-TAG    TO 400F-BUY-SEL-TAG.                  
                                                                                
            IF K800-DTE-AHG-EHG-REQ = SPACES OR LOW-VALUES OR ZEROES            
               IF K800-DTE-AHG-EHG-FORM-PRT NOT = SPACES AND LOW-VALUES         
                                                     AND ZEROS                  
                  MOVE 'F'                    TO 400F-AHG-REQ                   
               ELSE                                                             
                  MOVE SPACES                 TO 400F-AHG-REQ                   
               END-IF                                                           
            ELSE                                                                
               MOVE 'Y'                    TO 400F-AHG-REQ                      
            END-IF.                                                             
                                                                                
            STRING K800-DTE-FILE-RECEIVED(7:2) '/'                              
                   K800-DTE-FILE-RECEIVED(5:2) '/'                              
                   K800-DTE-FILE-RECEIVED(1:4)                                  
                   DELIMITED BY SIZE    INTO WS-400F-DTE-FLE-RECV.              
                                                                                
                                                                                
            STRING K110-DTE-ACCEPTANCE(7:2) '/'                                 
                   K110-DTE-ACCEPTANCE(5:2) '/'                                 
                   K110-DTE-ACCEPTANCE(1:4)                                     
                   DELIMITED BY SIZE    INTO 400F-DTE-ACCEPT.                   
                                                                                
            WRITE PRINT-REC-L400F FROM L400F-PR-HEAD-19 AFTER 1.                
                                                                                
            IF WS-NME-COAPPL NOT = SPACES                                       
               IF K800-NOT-FOUND NOT = 'Y'                                      
                  ADD 1                   TO WS-NUMBER-L400F                    
                  MOVE SPACES             TO L400F-PR-HEAD-19                   
                  MOVE WS-NME-COAPPL      TO 400F-NAME                          
                  MOVE K800-NUM-NRIC2     TO 400F-NRIC                          
                  MOVE WS-400F-DTE-FLE-RECV TO  400F-DTE-ACCEPT                 
                  WRITE PRINT-REC-L400F FROM L400F-PR-HEAD-19 AFTER 1.          
                                                                                
            IF WS-NME-THIRD-APPL NOT = SPACES                                   
               IF K800-NOT-FOUND NOT = 'Y'                                      
                  ADD 1                   TO WS-NUMBER-L400F                    
                  MOVE SPACES             TO L400F-PR-HEAD-19                   
                  MOVE WS-NME-THIRD-APPL  TO 400F-NAME                          
                  MOVE K800-NUM-NRIC3     TO 400F-NRIC                          
                  WRITE PRINT-REC-L400F FROM L400F-PR-HEAD-19 AFTER 1.          
                                                                                
            IF WS-NME-FOURTH-APPL NOT = SPACES                                  
               IF K800-NOT-FOUND NOT = 'Y'                                      
                  ADD 1                   TO WS-NUMBER-L400F                    
                  MOVE SPACES             TO L400F-PR-HEAD-19                   
                  MOVE WS-NME-FOURTH-APPL TO 400F-NAME                          
                  MOVE K800-NUM-NRIC4     TO 400F-NRIC                          
                  WRITE PRINT-REC-L400F FROM L400F-PR-HEAD-19 AFTER 1.          
                                                                                
            MOVE  SPACES                  TO PRINT-REC-L400F.                   
            WRITE PRINT-REC-L400F         AFTER 1.                              
            ADD  1                        TO WS-NUMBER-L400F.                   
                                                                                
       950-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       1000-PRINT-TOTAL.                                                        
      ******************************************************************        
      *-----------------------------------------------------------*             
      *     1. OUTPUT TOTAL NUMBERS OF LETTERS PRINTED            *             
      *     2. OUTPUT TOTAL NUMBERS OF GIRO FORMS PRINTED.        *             
      *     3. OUTPUT TOTAL NUMBERS OF ERRORS PRINTED.            *             
      *-----------------------------------------------------------*             
            DISPLAY 'NO-OF-LETTER = ' NO-OF-LETTER.                             
            DISPLAY 'NO-OF-L400B  = ' NO-OF-L400B.                              
            DISPLAY 'NO-OF-L400F  = ' NO-OF-L400F.                              
                                                                                
            IF NO-OF-LETTER > 0                                                 
               MOVE NO-OF-LETTER TO 400-TOTAL                                   
               WRITE PRINT-REC-2 FROM L400-PR-HEAD-20 AFTER 3                   
            END-IF.                                                             
                                                                                
            IF NO-OF-L400B > 0                                                  
               MOVE NO-OF-L400B TO 400-TOTAL-2                                  
               WRITE PRINT-REC-3 FROM L400-PR-HEAD-20B AFTER 3                  
            END-IF.                                                             
                                                                                
            IF PARM-DATA = 'KA'                                                 
               IF NO-OF-L400F > 0                                               
                  MOVE NO-OF-L400F TO 400F-TOTAL                                
                  WRITE PRINT-REC-L400F FROM L400F-PR-HEAD-20 AFTER 3           
               ELSE                                                             
                  IF NO-OF-L400B > 0                                            
                    STRING 'CONTROL LIST ON ACCEPTED CASES THAT HAVE '          
                           'KEY-AVAILABLE BUT NO AO DATE'                       
                            DELIMITED BY SIZE  INTO 400F-LIST-TITLE             
                    PERFORM 850-PRINT-HEADING  THRU 850-EXIT                    
                    MOVE NO-OF-L400F TO 400F-TOTAL                              
                    WRITE PRINT-REC-L400F FROM L400F-PR-HEAD-20 AFTER 3         
                  END-IF                                                        
               END-IF                                                           
            END-IF.                                                             
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       1100-PROCESS-S900.                                                       
      ******************************************************************        
           MOVE WS-TOTAL-CD              TO WS-S900-CD-PREV-PAID.               
           MOVE K110-CURR-SELLING-PRICE  TO WS-S900-SELL-PR.                    
           MOVE F310-CDE-TYP-ACTUSE      TO WS-S900-RM.                         
           MOVE F310-CDE-MODL-DESG       TO WS-S900-DESIGN.                     
           MOVE 25                       TO WS-S900-REPAY-PD.                   
           MOVE '10'                     TO WS-S900-SALE-TYPE.                  
           MOVE F310-CDE-SALES-TYPE      TO WS-S900-SALES-TYPE-SURVEY.          
           MOVE K110-CURR-SELLING-PRICE  TO WS-S900-ORIG-SELL.                  
           MOVE '00'                     TO WS-S900-PREMIUM-CODE.               
           MOVE ZEROS                    TO WS-S900-TOT-ICP.                    
                                                                                
           CALL 'BP13C900' USING WS-LINK-S900.                                  
                                                                                
           MOVE WS-S900-SURVEY-FEE       TO WS-COMP-SURVEY-FEE.                 
                                                                                
      *-----------------------------------------------------------*             
      *    CALL AV02C021 TO GET GST COMPUTATION FOR SURVEY FEE    *             
      *-----------------------------------------------------------*             
           MOVE WS-COMP-SURVEY-FEE      TO 400C-SURVEY-FEE-ACT.                 
                                                                                
           ADD  WS-S900-SURVEY-FEE-GST  TO WS-COMP-SURVEY-FEE.                  
           MOVE WS-S900-SURVEY-FEE-GST  TO 400C-SURVEY-FEE-GST.                 
                                                                                
           IF WS-S900-LS-ESCROW-FEE NOT > ZEROES                                
              MOVE ZEROES TO WS-S900-LS-ESCROW-FEE                              
           END-IF.                                                              
                                                                                
           IF WS-S900-LS-REGN-FEE NOT > ZEROES                                  
              MOVE ZEROES TO WS-S900-LS-REGN-FEE                                
           END-IF.                                                              
                                                                                
           COMPUTE WS-COMP-LEASE  =  WS-S900-LS-ESCROW-FEE +                    
                                     WS-S900-LS-REGN-FEE.                       
           MOVE WS-S900-MORT-ST-FEE     TO WS-MORT-STAMP-FEE.                   
           COMPUTE WS-COMP-MORTGAGE =  WS-S900-MORT-ESCROW-FEE +                
                                       WS-S900-MORT-REGN-FEE.                   
           MOVE WS-S900-LOAN  TO WS-LOAN-ROUND-DOWN.                            
                                                                                
       1100-S900-EXIT.                                                          
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       1200-PROCESS-S800.                                                       
      ******************************************************************        
            MOVE  FUNCTION CURRENT-DATE(1:8)   TO  WS-COMPUTE-DATE.             
            MOVE 01                            TO  WS-COMPUTE-DD.               
                                                                                
            PERFORM 1225-PROCESS-AB03K050    THRU 1225-EXIT.                    
                                                                                
       1200-S800-EXIT.                                                          
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1225-PROCESS-AB03K050.                                                   
      ******************************************************************        
            MOVE LOW-VALUES            TO K050-DTE-INT-EFF.                     
            MOVE 'P'                   TO K050-CDE-LOAN-SCH.                    
                                                                                
            START  AB03K050   KEY  > K050-KEY.                                  
                                                                                
            IF  AB03K050-STATUS NOT = 00                                        
                DISPLAY 'ERROR READING AB03K050, STATUS '                       
                                       AB03K050-STATUS                          
                MOVE AB03K050-STATUS TO RETURN-CODE                             
                GO TO 9000-CLOSE-ROUTINE                                        
            END-IF.                                                             
                                                                                
            MOVE 'N' TO WS-K050-EOF.                                            
            PERFORM  UNTIL  K050-DTE-INT-EFF >= WS-COMPUTE-DATE                 
                                        OR                                      
                            WS-K050-EOF = 'Y'                                   
              MOVE  AB03K050-REC  TO      WS-AB03K050-REC                       
              READ  AB03K050  NEXT  AT  END  MOVE 'Y'  TO  WS-K050-EOF          
                                             GO TO  1225-CHECK-DATE             
              END-READ                                                          
              IF  AB03K050-STATUS  NOT = ZERO                                   
                  DISPLAY 'ERROR READING AB03K050, STATUS '                     
                                         AB03K050-STATUS                        
                  MOVE AB03K050-STATUS TO RETURN-CODE                           
                  GO TO 9000-CLOSE-ROUTINE                                      
              END-IF                                                            
              IF  K050-CDE-LOAN-SCH NOT = 'P'                                   
                  MOVE  'Y'       TO     WS-K050-EOF                            
              END-IF                                                            
            END-PERFORM.                                                        
                                                                                
       1225-CHECK-DATE.                                                         
                                                                                
            IF K050-DTE-INT-EFF > WS-COMPUTE-DATE  OR                           
               K050-CDE-LOAN-SCH NOT = 'P'                                      
               MOVE  WS-AB03K050-REC     TO   AB03K050-REC                      
            END-IF.                                                             
                                                                                
            IF K050-DTE-INT-EFF IS NOT NUMERIC                                  
               DISPLAY 'NO MATCH IN   AB03K050         '                        
               MOVE '99'            TO RETURN-CODE                              
               GO TO 9000-CLOSE-ROUTINE                                         
            END-IF.                                                             
                                                                                
            MOVE K050-PCT-PA-INT        TO WS-INTREST-RATE.                     
            MOVE K050-CDE-PA-FACTOR     TO WS-S901-FAC.                         
                                                                                
       1225-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1300-PROCESS-S903.                                                       
      ******************************************************************        
           MOVE FUNCTION CURRENT-DATE  TO WS-CURRENT-DATE.                      
           MOVE     WS-CURRENT-DATE    TO WS-S903-SO-EFF-DATE.                  
                                                                                
           MOVE     ZEROES             TO WS-S903-SC-CC1                        
                                          WS-S903-SC-CC2                        
                                          WS-S903-SC-CC3.                       
                                                                                
           MOVE     ZEROES             TO WS-S903-SC-REBATE1                    
                                          WS-S903-SC-REBATE2                    
                                          WS-S903-SC-REBATE3                    
                                          WS-S903-SC-GRANT1                     
                                          WS-S903-SC-GRANT2                     
                                          WS-S903-SC-GRANT3                     
                                          WS-S903-SC-TOTAL-AMT.                 
                                                                                
           MOVE     ZEROES               TO    WS-S903-SC-TOTAL-AMT.            
           MOVE     K110-SCH-ACC-NO(1:9) TO    WS-S903-NUM-SCH-ACC.             
           MOVE     F310-CDE-TYP-ACTUSE  TO    WS-S903-ROOM-TY.                 
           MOVE     F310-CDE-MODL-DESG   TO    WS-S903-DESIGN-TY.               
                                                                                
      *-----------------------------------------------------------*             
      *    CALL BP13C903 TO GET THE SC-CC1,SC-CC2 AND SC-CC3      *             
      *-----------------------------------------------------------*             
           CALL 'BP13C903' USING WS-LINK-S903.                                  
                                                                                
      *-----------------------------------------------------------*             
      *    CALL AV02C021 TO COMPUTE THE GST FOR SC-CC1/CC2/CC3    *             
      *-----------------------------------------------------------*             
                                                                                
           MOVE  WS-S903-SC-CC1        TO WS-AMT-NETT.                          
           MOVE  'Y'                   TO WS-NUM-FLAT-SCCC.                     
                                                                                
           CALL 'AV02C021' USING WS-COMM-AREA-GST.                              
                                                                                
           MOVE  WS-AMT-GST            TO WS-S903-SC-CC1-GST.                   
                                                                                
           IF    WS-S903-SC-CC1 = WS-S903-SC-CC2                                
                 MOVE WS-AMT-GST       TO WS-S903-SC-CC2-GST                    
           ELSE                                                                 
                 MOVE WS-S903-SC-CC2   TO WS-AMT-NETT                           
                 MOVE  'Y'             TO WS-NUM-FLAT-SCCC                      
                 CALL 'AV02C021'       USING WS-COMM-AREA-GST                   
                 MOVE WS-AMT-GST       TO WS-S903-SC-CC2-GST.                   
                                                                                
           IF    WS-S903-SC-CC2 = WS-S903-SC-CC3                                
                 MOVE WS-S903-SC-CC2-GST  TO WS-S903-SC-CC3-GST                 
           ELSE                                                                 
                 MOVE WS-S903-SC-CC3   TO WS-AMT-NETT                           
                 MOVE  'Y'             TO WS-NUM-FLAT-SCCC                      
                 CALL 'AV02C021'       USING WS-COMM-AREA-GST                   
                 MOVE WS-AMT-GST       TO WS-S903-SC-CC3-GST.                   
                                                                                
           IF    WS-S903-SC-REC-TC1 > 0                                         
                 MOVE WS-S903-SC-REC-TC1   TO WS-AMT-NETT                       
                 MOVE  'Y'                 TO WS-NUM-FLAT-SCCC                  
                 CALL 'AV02C021'       USING WS-COMM-AREA-GST                   
                 MOVE WS-AMT-GST           TO WS-S903-SC-TC1-GST.               
                                                                                
           IF    WS-S903-SC-REC-TC2 = WS-S903-SC-REC-TC1                        
                 MOVE WS-S903-SC-TC1-GST   TO WS-S903-SC-TC2-GST                
           ELSE                                                                 
                 MOVE WS-S903-SC-REC-TC2   TO WS-AMT-NETT                       
                 MOVE  'Y'                 TO WS-NUM-FLAT-SCCC                  
                 CALL 'AV02C021'       USING WS-COMM-AREA-GST                   
                 MOVE WS-AMT-GST           TO WS-S903-SC-TC2-GST.               
                                                                                
           IF    WS-S903-SC-REC-TC3 = WS-S903-SC-REC-TC2                        
                 MOVE WS-S903-SC-TC2-GST   TO WS-S903-SC-TC3-GST                
           ELSE                                                                 
                 MOVE WS-S903-SC-REC-TC3   TO WS-AMT-NETT                       
                 MOVE  'Y'                 TO WS-NUM-FLAT-SCCC                  
                 CALL 'AV02C021'       USING WS-COMM-AREA-GST                   
                 MOVE WS-AMT-GST           TO WS-S903-SC-TC2-GST.               
                                                                                
           IF (K800-NUM-SCCC-ELGBTY = 'N' OR 'Z') OR                            
              (K800-NUM-ALLO-SCHEME = 'SPO' OR 'SPP' OR 'SSP'                   
                                   OR 'SPS' OR 'SRP')                           
              COMPUTE WS-TOT-SCCC = WS-S903-SC-CC1      +                       
                                    WS-S903-SC-CC2      +                       
                                    WS-S903-SC-CC3      +                       
                                    WS-S903-SC-CC1-GST  +                       
                                    WS-S903-SC-CC2-GST  +                       
                                    WS-S903-SC-CC3-GST  +                       
                                    WS-S903-SC-REC-TC1  +                       
                                    WS-S903-SC-REC-TC2  +                       
                                    WS-S903-SC-REC-TC3  +                       
                                    WS-S903-SC-TC1-GST  +                       
                                    WS-S903-SC-TC2-GST  +                       
                                    WS-S903-SC-TC3-GST                          
           ELSE                                                                 
               COMPUTE WS-TOT-SCCC = WS-S903-SC-CC1      +                      
                                     WS-S903-SC-CC2      +                      
                                     WS-S903-SC-CC3      +                      
                                     WS-S903-SC-CC1-GST  +                      
                                     WS-S903-SC-CC2-GST  +                      
                                     WS-S903-SC-CC3-GST  +                      
                                     WS-S903-SC-REBATE1  -                      
                                     WS-S903-SC-REBATE2  -                      
                                     WS-S903-SC-REBATE3  -                      
                                     WS-S903-SC-GRANT1   -                      
                                     WS-S903-SC-GRANT2   -                      
                                     WS-S903-SC-GRANT3   -                      
                                     WS-S903-SC-REB-SP1  -                      
                                     WS-S903-SC-REB-SP2  -                      
                                     WS-S903-SC-REB-SP3                         
           END-IF.                                                              
                                                                                
       1300-S903-EXIT.                                                          
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1400-PROCESS-S901.                                                       
      ******************************************************************        
            MOVE   'N'                    TO WS-S901-ERL.                       
            MOVE    F310-CDE-TYP-ACTUSE   TO WS-S901-RM.                        
            MOVE    F310-CDE-MODL-DESG    TO WS-S901-DESIGN.                    
            MOVE    25                    TO WS-S901-REPAY-PD.                  
                                                                                
            COMPUTE WS-S901-INT = WS-INTREST-RATE * 0.01.                       
            MOVE    WS-MAX-LOAN-AMT       TO WS-S901-LOAN-AMT.                  
            MOVE    ZEROES                TO WS-S901-ERL-LOAN-AMT.              
                                                                                
            CALL   'BP13C901' USING WS-LINK-S901.                               
                                                                                
            MOVE    WS-S901-MTH-INSTAL    TO WS-MTHLY-INSTAL.                   
                                                                                
       1400-S901-EXIT.                                                          
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1400-PROCESS-S905.                                                       
      ******************************************************************        
            IF (K800-NUM-SCCC-ELGBTY = 'N' OR 'Z') OR                           
               (K800-NUM-ALLO-SCHEME = 'SPO' OR 'SPP' OR 'SSP'                  
                                    OR 'SPS' OR 'SRP')                          
                COMPUTE WS-S905-SC-CC1 =  WS-S903-SC-CC1 +                      
                                          WS-S903-SC-REC-TC1                    
                COMPUTE WS-S905-SC-CC2 =  WS-S903-SC-CC2 +                      
                                          WS-S903-SC-REC-TC2                    
                COMPUTE WS-S905-SC-CC3 =  WS-S903-SC-CC3 +                      
                                          WS-S903-SC-REC-TC3                    
                MOVE ZERO                 TO WS-S905-SC-TOTAL-AMT               
            ELSE                                                                
                MOVE WS-S903-SC-CC1       TO WS-S905-SC-CC1                     
                MOVE WS-S903-SC-CC2       TO WS-S905-SC-CC2                     
                MOVE WS-S903-SC-CC3       TO WS-S905-SC-CC3                     
                MOVE ZERO                 TO WS-S905-SC-TOTAL-AMT               
            END-IF.                                                             
                                                                                
            CALL   'BP13C905' USING WS-LINK-S905.                               
                                                                                
            MOVE    WS-S905-SC-TOTAL-AMT TO WS-S900-PREM-ST-FEE.                
                                                                                
       1400-S905-EXIT.                                                          
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       2000-READ-BM06K100.                                                      
      ******************************************************************        
            READ BM06K100.                                                      
            IF BM06K100-STATUS NOT = 0 AND 23                                   
               DISPLAY 'BM06K100 READ ERROR, STATUS ' BM06K100-STATUS           
               PERFORM 9000-CLOSE-ROUTINE    THRU 1500-EXIT                     
            END-IF.                                                             
                                                                                
       2000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       9000-CLOSE-ROUTINE.                                                      
      ******************************************************************        
           CLOSE BP13F310                                                       
                 BP13K022                                                       
                 BP13K024                                                       
                 BP13K800                                                       
                 BP13K820                                                       
                 BP13K830                                                       
                 BP13K880                                                       
                 BP13K885                                                       
                 BM06K100                                                       
                 BM06K110                                                       
                 AB03K050                                                       
                 P13L400A                                                       
                 P13L400B                                                       
                 P13L400C                                                       
                 P13L400D                                                       
                 P13L400F                                                       
                 BP13L400.                                                      
                                                                                
           CALL 'CAV02001' USING LINK-REC.                                      
                                                                                
           IF BP13K800-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSING ERROR, BP13K800-STATUS ' BP13K800-STATUS.        
                                                                                
           IF BP13K022-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSING ERROR, BP13K022-STATUS ' BP13K022-STATUS.        
                                                                                
           IF BP13K024-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSING ERROR, BP13K024-STATUS ' BP13K024-STATUS.        
                                                                                
           IF BP13K820-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSING ERROR, BP13K800-STATUS ' BP13K800-STATUS.        
                                                                                
           IF BP13K830-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSING ERROR, BP13K830-STATUS ' BP13K830-STATUS.        
                                                                                
           IF BP13K880-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSING ERROR, BP13K880-STATUS ' BP13K880-STATUS.        
                                                                                
           IF BP13K885-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSING ERROR, BP13K885-STATUS ' BP13K885-STATUS.        
                                                                                
           IF BM06K100-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSING ERROR, BM06K100-STATUS ' BM06K100-STATUS.        
                                                                                
           IF BM06K110-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSING ERROR, BM06K110-STATUS ' BM06K110-STATUS.        
                                                                                
           IF AB03K050-STATUS NOT = 00 AND 97                                   
              DISPLAY 'CLOSING ERROR, AB03K050-STATUS ' AB03K050-STATUS.        
                                                                                
           STOP RUN.                                                            
                                                                                
       1500-EXIT.                                                               
            EXIT.                                                               
