      *===============================================================*         
       IDENTIFICATION DIVISION.                                                 
      *===============================================================*         
       PROGRAM-ID.    BP13CE08.                                                 
       AUTHOR.        MRN1.                                                     
       DATE-WRITTEN.  15032012.                                                 
      *===============================================================*         
      *   OBJECTIVE:  UPDATE/CREATE BP13KD09 RECORDS BASED ON         *         
      *               INPUT BP13FD05, BP13K800, BP13K893              *         
      *===============================================================*         
      *                                                               *         
      *     INPUT FILE :                                              *         
      *                  1. BP13FD05                                  *         
      *                  2. BP13K800                                  *         
      *                  3. BP13K893                                  *         
      *                  4. BM06K110                                  *         
      *                                                               *         
      *     OUTPUT FILE:                                              *         
      *                  1. BP13KD09                                  *         
      *                                                               *         
      *     REPORT FILE:                                              *         
      *                  1. P13LE08A (FROM K800)                      *         
      *                  2. P13LE08B (FROM K893)                      *         
      *                  3. P13LE08C (ADDED TO KD09)                  *         
      *                  4. P13LE08D (UPDATED TO KD09)                *         
      *===============================================================*         
      * REF NO   DATE       BY   AMENDMENTS/ENHANCEMENTS              *         
      * -------- ---------- ---- -----------------------              *         
      * BP134498 15/03/2012 MRN1 NEW PROGRAM.                         *         
      * BP134641 03/08/2012 MDT2 CHANGE LRECL OF BP13FD05 FROM 300 TO *         
      *                          500                                  *         
      * BP135129 28/02/2014 MRN1 TO CATER FOR SUG.                    *         
      * BP135129 05/03/2014 PCL4 TO INITIALIZE SUG GRANT/RECOVERY     *         
      * BP135741 17/04/2015 LSB1 TO K800-DTE-AHG-PAYMENT FOR GRANT GIVEN        
      *===============================================================*         
                                                                                
                                                                                
      **********************                                                    
       ENVIRONMENT DIVISION.                                                    
      **********************                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT  BP13FD05  ASSIGN        TO BP13FD05.                         
                                                                                
           SELECT  BP13KD09  ASSIGN        TO BP13KD09                          
                             ACCESS MODE   IS RANDOM                            
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS KD09-KEY-FLD                      
                             FILE STATUS   IS WS-KD09-STATUS.                   
                                                                                
           SELECT  BP13K800  ASSIGN        TO BP13K800                          
                             ACCESS MODE   IS RANDOM                            
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K800-NUM-REGN                     
                             FILE STATUS   IS WS-K800-STATUS.                   
                                                                                
           SELECT BP13K893   ASSIGN        TO BP13K893                          
                             ACCESS MODE   IS DYNAMIC                           
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K893-KEY-FLD                      
                             FILE STATUS   IS WS-K893-STATUS.                   
                                                                                
           SELECT BM06K110   ASSIGN        TO BM06K110                          
                             ACCESS MODE   IS RANDOM                            
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K110-KEY-FLD                      
                             FILE STATUS   IS WS-K110-STATUS.                   
                                                                                
           SELECT  P13LE08A  ASSIGN        TO P13LE08A.                         
                                                                                
           SELECT  P13LE08B  ASSIGN        TO P13LE08B.                         
                                                                                
           SELECT  P13LE08C  ASSIGN        TO P13LE08C.                         
                                                                                
           SELECT  P13LE08D  ASSIGN        TO P13LE08D.                         
                                                                                
      ***************                                                           
       DATA DIVISION.                                                           
      ***************                                                           
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD   BP13FD05                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 500 CHARACTERS                                      
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13FD05.                                                           
                                                                                
       FD   BP13KD09                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13KD09.                                                           
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K893                                                            
            RECORD CONTAINS 2050 CHARACTERS.                                    
       COPY BP13K893.                                                           
                                                                                
       FD   BM06K110                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K110.                                                           
                                                                                
       FD  P13LE08A                                                             
           RECORD CONTAINS 200 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       01  P13LE08A-REC                  PIC X(200).                            
                                                                                
       FD  P13LE08B                                                             
           RECORD CONTAINS 200 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       01  P13LE08B-REC                  PIC X(200).                            
                                                                                
       FD  P13LE08C                                                             
           RECORD CONTAINS 200 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       01  P13LE08C-REC                  PIC X(200).                            
                                                                                
       FD  P13LE08D                                                             
           RECORD CONTAINS 200 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       01  P13LE08D-REC                  PIC X(200).                            
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
      *****************************************************************         
      *                   WORKING-STORAGE AREA                                  
      *****************************************************************         
       01  FILE-VARIABLES.                                                      
           05  WS-FD05-EOF             PIC X(1)  VALUE 'N'.                     
           05  WS-KD09-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K800-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K893-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K110-STATUS          PIC 9(02) VALUE ZEROES.                  
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-FD05-READ            PIC 9(7)  VALUE ZEROES.                  
           05  WS-K800-FND             PIC 9(7)  VALUE ZEROES.                  
           05  WS-K800-NFND            PIC 9(7)  VALUE ZEROES.                  
           05  WS-K800-VALID           PIC 9(7)  VALUE ZEROES.                  
           05  WS-K893-FND             PIC 9(7)  VALUE ZEROES.                  
           05  WS-K893-NFND            PIC 9(7)  VALUE ZEROES.                  
           05  WS-K893-VALID           PIC 9(7)  VALUE ZEROES.                  
           05  WS-K893-SCHACCT-BLANK   PIC 9(7)  VALUE ZEROES.                  
           05  WS-K893-EOF             PIC X(1)  VALUE 'N'.                     
           05  WS-KD09-FND             PIC 9(7)  VALUE ZEROES.                  
           05  WS-KD09-NFND            PIC 9(7)  VALUE ZEROES.                  
           05  WS-KD09-UPD             PIC 9(7)  VALUE ZEROES.                  
           05  WS-KD09-WRITE           PIC 9(7)  VALUE ZEROES.                  
           05  WS-KD09-DUP             PIC 9(7)  VALUE ZEROES.                  
           05  WS-K110-FND             PIC 9(7)  VALUE ZEROES.                  
           05  WS-K110-NFND            PIC 9(7)  VALUE ZEROES.                  
           05  WS-K110-SOLD            PIC 9(7)  VALUE ZEROES.                  
           05  WS-K110-ZERO-KI         PIC 9(7)  VALUE ZEROES.                  
           05  WS-SNO                  PIC 9(7)  VALUE ZEROES.                  
           05  WS-SNO2                 PIC 9(7)  VALUE ZEROES.                  
           05  WS-SNO3                 PIC 9(7)  VALUE ZEROES.                  
           05  WS-SNO4                 PIC 9(7)  VALUE ZEROES.                  
           05  WS-LINE-CTR             PIC 9(2)  VALUE ZEROES.                  
                                                                                
       01  WS-VARIABLES.                                                        
           05 WS-SYSTEM-DATE-TIME.                                              
              10 WS-SYSTEM-DATE        PIC X(08) VALUE ZEROES.                  
              10 WS-SYSTEM-TIME        PIC X(08) VALUE ZEROES.                  
           05 WS-DTE-APPROVE           PIC 9(08) VALUE ZEROES.                  
           05 WS-DTE-CURRENT.                                                   
              10 WS-DTE-YY             PIC 9(4)  VALUE ZEROES.                  
              10 WS-DTE-MM             PIC 9(2)  VALUE ZEROES.                  
              10 WS-DTE-DD             PIC 9(2)  VALUE ZEROES.                  
           05 WS-DTE-PREV.                                                      
              10 WS-LST-YY             PIC 9(4)  VALUE ZEROES.                  
              10 WS-LST-MM             PIC 9(2)  VALUE ZEROES.                  
              10 WS-LST-DD             PIC 9(2)  VALUE ZEROES.                  
           05 WS-DTE-HSGNT             PIC X(10) VALUE SPACES.                  
           05 WS-AMT-SHG-GRANT         PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AMT-SHG-RECOVER       PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AMT-SUG-GRANT         PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AMT-SUG-RECOVER       PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AMT-HSG-GRANT         PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AMT-HSG-RECOVER       PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AMT-AHG-GRANT         PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AMT-AHG-RECOVER       PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AMT-SHG-GRANT-PREV    PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AMT-SHG-RECOVER-PREV  PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AMT-SUG-GRANT-PREV    PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AMT-SUG-RECOVER-PREV  PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AMT-HSG-GRANT-PREV    PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AMT-HSG-RECOVER-PREV  PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AMT-AHG-GRANT-PREV    PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AMT-AHG-RECOVER-PREV  PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AMT-AHG-DIFF          PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AMT-SHG-DIFF          PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AMT-SUG-DIFF          PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AMT-HSG-DIFF          PIC S9(6)V99 VALUE ZEROES.               
           05 WS-AHG-GNT                PIC S9(6)V99 VALUE ZEROES.              
           05 WS-SHG-GNT                PIC S9(6)V99 VALUE ZEROES.              
           05 WS-TOT-UPD-AHG-GRANT-B4   PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-UPD-AHG-RECOVER-B4 PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-UPD-SHG-GRANT-B4   PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-UPD-SHG-RECOVER-B4 PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-UPD-SUG-GRANT-B4   PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-UPD-SUG-RECOVER-B4 PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-UPD-AHG-GRANT      PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-UPD-AHG-RECOVER    PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-UPD-SHG-GRANT      PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-UPD-SHG-RECOVER    PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-UPD-SUG-GRANT      PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-UPD-SUG-RECOVER    PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-UPD-AHG-DIFF       PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-UPD-SHG-DIFF       PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-UPD-SUG-DIFF       PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-ADD-AHG-GRANT      PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-ADD-AHG-RECOVER    PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-ADD-SHG-GRANT      PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-ADD-SHG-RECOVER    PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-ADD-SUG-RECOVER    PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-AHG-GRANT-K800     PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-AHG-RECOVER-K800   PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-SHG-GRANT-K800     PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-SHG-RECOVER-K800   PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-SUG-RECOVER-K800   PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-AHG-GRANT-K893     PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-AHG-RECOVER-K893   PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-SHG-GRANT-K893     PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-SHG-RECOVER-K893   PIC S9(8)V99 VALUE ZEROES.              
           05 WS-TOT-SUG-RECOVER-K893   PIC S9(8)V99 VALUE ZEROES.              
           05 TEMP-NUM-REGN             PIC X(8) VALUE SPACES.                  
           05 WS-KD09-FOUND-TAG         PIC X(1) VALUE SPACES.                  
           05 WS-K800-FOUND-TAG         PIC X(1) VALUE SPACES.                  
           05 WS-K893-FOUND-TAG         PIC X(1) VALUE SPACES.                  
           05 WS-NUM-AHG-THOU           PIC 9(2) VALUE ZEROES.                  
           05 WS-NUM-SHG-THOU           PIC 9(2) VALUE ZEROES.                  
           05 WS-NUM-SUG-THOU           PIC 9(2) VALUE ZEROES.                  
           05 WS-NUM-AHG-NUMERIC        PIC 9(2) VALUE ZEROES.                  
           05 WS-NUM-SHG-NUMERIC        PIC 9(2) VALUE ZEROES.                  
           05 WS-NUM-SUG-NUMERIC        PIC 9(2) VALUE ZEROES.                  
           05 WS-DATE                   PIC X(08) VALUE SPACES.                 
           05 WS-DTE-KEY-ISSUED         PIC X(08) VALUE SPACES.                 
                                                                                
      *01 WS-LE08-REPORT.                                                       
           05  WS-HEADER-LINE1.                                                 
               07  FILLER       PIC X(09) VALUE 'BP13-LE08'.                    
               07  FILLER       PIC X(04) VALUE SPACES.                         
               07  FILLER       PIC X(04) VALUE 'HDB3'.                         
               07  FILLER       PIC X(30) VALUE SPACES.                         
               07  FILLER       PIC X(20) VALUE 'SYSTEM OF COMMITMENT'.         
               07  FILLER       PIC X(24) VALUE SPACES.                         
               07  FILLER       PIC X(07) VALUE 'DATE : '.                      
               07  LE08-DATE    PIC X(10).                                      
               07  FILLER       PIC X(94) VALUE SPACES.                         
                                                                                
           05  WS-HEADER-LINE2A.                                                
               07 FILLER        PIC X(36) VALUE SPACES.                         
               07 FILLER        PIC X(43) VALUE                                 
                         'K800 RECORDS NOT EQUAL TO AMT-AHG & AMT-SHG'.         
               07 FILLER        PIC X(121) VALUE SPACES.                        
                                                                                
           05  WS-HEADER-LINE2B.                                                
               07 FILLER        PIC X(36) VALUE SPACES.                         
               07 FILLER        PIC X(43) VALUE                                 
                         'K893 RECORDS NOT EQUAL TO AMT-AHG & AMT-SHG'.         
               07 FILLER        PIC X(121) VALUE SPACES.                        
                                                                                
           05  WS-HEADER-LINE2C.                                                
               07 FILLER        PIC X(36) VALUE SPACES.                         
               07 FILLER        PIC X(43) VALUE                                 
                         '        RECORDS ADDED TO BP13KD09          '.         
               07 FILLER        PIC X(121) VALUE SPACES.                        
                                                                                
           05  WS-HEADER-LINE2D.                                                
               07 FILLER        PIC X(36) VALUE SPACES.                         
               07 FILLER        PIC X(43) VALUE                                 
                         '        RECORDS UPDATED TO BP13KD09        '.         
               07 FILLER        PIC X(121) VALUE SPACES.                        
                                                                                
           05  WS-HEADER-LINE3.                                                 
               07 FILLER        PIC X(05) VALUE ' S/NO'.                        
               07 FILLER        PIC X(03) VALUE SPACES.                         
               07 FILLER        PIC X(08) VALUE ' REG-NO '.                     
               07 FILLER        PIC X(05) VALUE SPACES.                         
               07 FILLER        PIC X(11) VALUE 'SCHEME-ACCT'.                  
               07 FILLER        PIC X(05) VALUE SPACES.                         
               07 FILLER        PIC X(09) VALUE 'AHG-GRANT'.                    
               07 FILLER        PIC X(05) VALUE SPACES.                         
               07 FILLER        PIC X(11) VALUE 'AHG-RECOVER'.                  
               07 FILLER        PIC X(05) VALUE SPACES.                         
               07 FILLER        PIC X(09) VALUE 'SHG-GRANT'.                    
               07 FILLER        PIC X(05) VALUE SPACES.                         
               07 FILLER        PIC X(11) VALUE 'SHG-RECOVER'.                  
               07 FILLER        PIC X(05) VALUE SPACES.                         
               07 FILLER        PIC X(07) VALUE 'NUM-AHG'.                      
               07 FILLER        PIC X(05) VALUE SPACES.                         
               07 FILLER        PIC X(07) VALUE 'NUM-SHG'.                      
               07 FILLER        PIC X(84) VALUE SPACES.                         
                                                                                
           05  WS-HEADER-LINE3-ADD.                                             
               07 FILLER        PIC X(05) VALUE ' S/NO'.                        
               07 FILLER        PIC X(03) VALUE SPACES.                         
               07 FILLER        PIC X(08) VALUE ' REG-NO '.                     
               07 FILLER        PIC X(05) VALUE SPACES.                         
               07 FILLER        PIC X(11) VALUE 'SCHEME-ACCT'.                  
               07 FILLER        PIC X(05) VALUE SPACES.                         
               07 FILLER        PIC X(09) VALUE 'AHG-GRANT'.                    
               07 FILLER        PIC X(05) VALUE SPACES.                         
               07 FILLER        PIC X(11) VALUE 'AHG-RECOVER'.                  
               07 FILLER        PIC X(05) VALUE SPACES.                         
               07 FILLER        PIC X(09) VALUE 'SHG-GRANT'.                    
               07 FILLER        PIC X(05) VALUE SPACES.                         
               07 FILLER        PIC X(11) VALUE 'SHG-RECOVER'.                  
               07 FILLER        PIC X(05) VALUE SPACES.                         
               07 FILLER        PIC X(08) VALUE 'AHG-APPR'.                     
               07 FILLER        PIC X(05) VALUE SPACES.                         
               07 FILLER        PIC X(08) VALUE 'SHG-APPR'.                     
               07 FILLER        PIC X(82) VALUE SPACES.                         
                                                                                
           05  WS-HEADER-LINE3A-UPD.                                            
               07 FILLER        PIC X(30) VALUE SPACES.                         
               07 FILLER        PIC X(08) VALUE 'PREVIOUS'.                     
               07 FILLER        PIC X(03) VALUE SPACES.                         
               07 FILLER        PIC X(08) VALUE 'PREVIOUS'.                     
               07 FILLER        PIC X(05) VALUE SPACES.                         
               07 FILLER        PIC X(08) VALUE 'PREVIOUS'.                     
               07 FILLER        PIC X(03) VALUE SPACES.                         
               07 FILLER        PIC X(08) VALUE 'PREVIOUS'.                     
               07 FILLER        PIC X(07) VALUE SPACES.                         
               07 FILLER        PIC X(03) VALUE 'NEW'.                          
               07 FILLER        PIC X(09) VALUE SPACES.                         
               07 FILLER        PIC X(03) VALUE 'NEW'.                          
               07 FILLER        PIC X(09) VALUE SPACES.                         
               07 FILLER        PIC X(03) VALUE 'NEW'.                          
               07 FILLER        PIC X(09) VALUE SPACES.                         
               07 FILLER        PIC X(03) VALUE 'NEW'.                          
               07 FILLER        PIC X(81) VALUE SPACES.                         
                                                                                
           05  WS-HEADER-LINE3B-UPD.                                            
               07 FILLER        PIC X(05) VALUE ' S/NO'.                        
               07 FILLER        PIC X(02) VALUE SPACES.                         
               07 FILLER        PIC X(06) VALUE 'REG-NO'.                       
               07 FILLER        PIC X(03) VALUE SPACES.                         
               07 FILLER        PIC X(11) VALUE 'SCHEME-ACCT'.                  
               07 FILLER        PIC X(02) VALUE SPACES.                         
               07 FILLER        PIC X(09) VALUE 'AHG-GRANT'.                    
               07 FILLER        PIC X(02) VALUE SPACES.                         
               07 FILLER        PIC X(11) VALUE 'AHG-RECOVER'.                  
               07 FILLER        PIC X(02) VALUE SPACES.                         
               07 FILLER        PIC X(09) VALUE 'SHG-GRANT'.                    
               07 FILLER        PIC X(02) VALUE SPACES.                         
               07 FILLER        PIC X(11) VALUE 'SHG-RECOVER'.                  
               07 FILLER        PIC X(02) VALUE SPACES.                         
               07 FILLER        PIC X(09) VALUE 'AHG-GRANT'.                    
               07 FILLER        PIC X(02) VALUE SPACES.                         
               07 FILLER        PIC X(11) VALUE 'AHG-RECOVER'.                  
               07 FILLER        PIC X(02) VALUE SPACES.                         
               07 FILLER        PIC X(09) VALUE 'SHG-GRANT'.                    
               07 FILLER        PIC X(02) VALUE SPACES.                         
               07 FILLER        PIC X(11) VALUE 'SHG-RECOVER'.                  
               07 FILLER        PIC X(03) VALUE SPACES.                         
               07 FILLER        PIC X(08) VALUE 'AHG-DIFF'.                     
               07 FILLER        PIC X(04) VALUE SPACES.                         
               07 FILLER        PIC X(08) VALUE 'SHG-DIFF'.                     
               07 FILLER        PIC X(02) VALUE SPACES.                         
               07 FILLER        PIC X(08) VALUE 'AHG-APPR'.                     
               07 FILLER        PIC X(02) VALUE SPACES.                         
               07 FILLER        PIC X(08) VALUE 'SHG-APPR'.                     
               07 FILLER        PIC X(34) VALUE SPACES.                         
                                                                                
           05  WS-SPACES.                                                       
               07  FILLER       PIC X(200)   VALUE SPACES.                      
                                                                                
           05  WS-LE08-DETAIL.                                                  
               07 FILLER              PIC X(02) VALUE SPACES.                   
               07 WS-LE08-SNO         PIC ZZ9.                                  
               07 FILLER              PIC X(03) VALUE SPACES.                   
               07 WS-LE08-REGNO       PIC X(08).                                
               07 FILLER              PIC X(05) VALUE SPACES.                   
               07 WS-LE08-SCHACCT     PIC X(11).                                
               07 FILLER              PIC X(05) VALUE SPACES.                   
               07 WS-LE08-AHG-GRANT   PIC ZZZZZ9.99.                            
               07 FILLER              PIC X(07) VALUE SPACES.                   
               07 WS-LE08-AHG-RECOVER PIC ZZZZZ9.99.                            
               07 FILLER              PIC X(05) VALUE SPACES.                   
               07 WS-LE08-SHG-GRANT   PIC ZZZZZ9.99.                            
               07 FILLER              PIC X(07) VALUE SPACES.                   
               07 WS-LE08-SHG-RECOVER PIC ZZZZZ9.99.                            
               07 FILLER              PIC X(09) VALUE SPACES.                   
               07 WS-LE08-NUM-AHG     PIC X(03).                                
               07 FILLER              PIC X(09) VALUE SPACES.                   
               07 WS-LE08-NUM-SHG     PIC X(03).                                
               07 FILLER              PIC X(44) VALUE SPACES.                   
                                                                                
           05  WS-LE08-ADD-DETAIL.                                              
               07 FILLER                  PIC X(02) VALUE SPACES.               
               07 WS-LE08-ADD-SNO         PIC ZZ9.                              
               07 FILLER                  PIC X(03) VALUE SPACES.               
               07 WS-LE08-ADD-REGNO       PIC X(08).                            
               07 FILLER                  PIC X(05) VALUE SPACES.               
               07 WS-LE08-ADD-SCHACCT     PIC X(11).                            
               07 FILLER                  PIC X(05) VALUE SPACES.               
               07 WS-LE08-ADD-AHG-GRANT   PIC ZZZZZ9.99.                        
               07 FILLER                  PIC X(07) VALUE SPACES.               
               07 WS-LE08-ADD-AHG-RECOVER PIC ZZZZZ9.99.                        
               07 FILLER                  PIC X(05) VALUE SPACES.               
               07 WS-LE08-ADD-SHG-GRANT   PIC ZZZZZ9.99.                        
               07 FILLER                  PIC X(07) VALUE SPACES.               
               07 WS-LE08-ADD-SHG-RECOVER PIC ZZZZZ9.99.                        
               07 FILLER                  PIC X(05) VALUE SPACES.               
               07 WS-LE08-ADD-DTE-AHG-APP PIC X(08).                            
               07 FILLER                  PIC X(05) VALUE SPACES.               
               07 WS-LE08-ADD-DTE-SHG-APP PIC X(08).                            
               07 FILLER                  PIC X(82) VALUE SPACES.               
                                                                                
           05  WS-LE08-UPD-DETAIL.                                              
               07 FILLER                        PIC X(02) VALUE SPACES.         
               07 WS-LE08-UPD-SNO               PIC ZZ9.                        
               07 FILLER                        PIC X(01) VALUE SPACES.         
               07 WS-LE08-UPD-REGNO             PIC X(08).                      
               07 FILLER                        PIC X(02) VALUE SPACES.         
               07 WS-LE08-UPD-SCHACCT           PIC X(11).                      
               07 FILLER                        PIC X(02) VALUE SPACES.         
               07 WS-LE08-UPD-AHG-GRANT-B4      PIC ZZZZZ9.99.                  
               07 FILLER                        PIC X(03) VALUE SPACES.         
               07 WS-LE08-UPD-AHG-RECOVER-B4    PIC ZZZZZ9.99.                  
               07 FILLER                        PIC X(03) VALUE SPACES.         
               07 WS-LE08-UPD-SHG-GRANT-B4      PIC ZZZZZ9.99.                  
               07 FILLER                        PIC X(03) VALUE SPACES.         
               07 WS-LE08-UPD-SHG-RECOVER-B4    PIC ZZZZZ9.99.                  
               07 FILLER                        PIC X(03) VALUE SPACES.         
               07 WS-LE08-UPD-AHG-GRANT         PIC ZZZZZ9.99.                  
               07 FILLER                        PIC X(03) VALUE SPACES.         
               07 WS-LE08-UPD-AHG-RECOVER       PIC ZZZZZ9.99.                  
               07 FILLER                        PIC X(03) VALUE SPACES.         
               07 WS-LE08-UPD-SHG-GRANT         PIC ZZZZZ9.99.                  
               07 FILLER                        PIC X(03) VALUE SPACES.         
               07 WS-LE08-UPD-SHG-RECOVER       PIC ZZZZZ9.99.                  
               07 FILLER                        PIC X(03) VALUE SPACES.         
               07 WS-LE08-UPD-AHG-DIFF          PIC ZZZZZ9.99.                  
               07 FILLER                        PIC X(03) VALUE SPACES.         
               07 WS-LE08-UPD-SHG-DIFF          PIC ZZZZZ9.99.                  
               07 FILLER                        PIC X(02) VALUE SPACES.         
               07 WS-LE08-UPD-DTE-AHG-APP       PIC X(08).                      
               07 FILLER                        PIC X(02) VALUE SPACES.         
               07 WS-LE08-UPD-DTE-SHG-APP       PIC X(08).                      
               07 FILLER                        PIC X(34) VALUE SPACES.         
                                                                                
           05  WS-LE08-TOTALS.                                                  
               07 FILLER                   PIC X(08) VALUE ' TOTALS:'.          
               07 FILLER                   PIC X(27) VALUE SPACES.              
               07 WS-LE08-TOT-AHG-GRANT    PIC ZZZZZZZ9.99.                     
               07 FILLER                   PIC X(05) VALUE SPACES.              
               07 WS-LE08-TOT-AHG-RECOVER  PIC ZZZZZZZ9.99.                     
               07 FILLER                   PIC X(03) VALUE SPACES.              
               07 WS-LE08-TOT-SHG-GRANT    PIC ZZZZZZZ9.99.                     
               07 FILLER                   PIC X(05) VALUE SPACES.              
               07 WS-LE08-TOT-SHG-RECOVER  PIC ZZZZZZZ9.99.                     
               07 FILLER                   PIC X(108) VALUE SPACES.             
                                                                                
           05  WS-LE08-TOTALS-ADD.                                              
               07 FILLER                   PIC X(08) VALUE ' TOTALS:'.          
               07 FILLER                   PIC X(27) VALUE SPACES.              
               07 WS-LE08C-TOT-AHG-GRANT   PIC ZZZZZZZ9.99.                     
               07 FILLER                   PIC X(05) VALUE SPACES.              
               07 WS-LE08C-TOT-AHG-RECOVER PIC ZZZZZZZ9.99.                     
               07 FILLER                   PIC X(03) VALUE SPACES.              
               07 WS-LE08C-TOT-SHG-GRANT   PIC ZZZZZZZ9.99.                     
               07 FILLER                   PIC X(05) VALUE SPACES.              
               07 WS-LE08C-TOT-SHG-RECOVER PIC ZZZZZZZ9.99.                     
               07 FILLER                   PIC X(108) VALUE SPACES.             
                                                                                
           05  WS-LE08-TOTALS-UPD.                                              
               07 FILLER                     PIC X(08) VALUE ' TOTALS:'.        
               07 FILLER                     PIC X(19) VALUE SPACES.            
               07 WS-LE08D-TOT-AHG-GRANT-B4  PIC ZZZZZZZ9.99.                   
               07 FILLER                     PIC X(01) VALUE SPACES.            
               07 WS-LE08D-TOT-AHG-RECOVER-B4 PIC ZZZZZZZ9.99.                  
               07 FILLER                      PIC X(01) VALUE SPACES.           
               07 WS-LE08D-TOT-SHG-GRANT-B4   PIC ZZZZZZZ9.99.                  
               07 FILLER                      PIC X(01) VALUE SPACES.           
               07 WS-LE08D-TOT-SHG-RECOVER-B4 PIC ZZZZZZZ9.99.                  
               07 FILLER                      PIC X(01) VALUE SPACES.           
               07 WS-LE08D-TOT-AHG-GRANT      PIC ZZZZZZZ9.99.                  
               07 FILLER                      PIC X(01) VALUE SPACES.           
               07 WS-LE08D-TOT-AHG-RECOVER    PIC ZZZZZZZ9.99.                  
               07 FILLER                      PIC X(01) VALUE SPACES.           
               07 WS-LE08D-TOT-SHG-GRANT      PIC ZZZZZZZ9.99.                  
               07 FILLER                      PIC X(01) VALUE SPACES.           
               07 WS-LE08D-TOT-SHG-RECOVER    PIC ZZZZZZZ9.99.                  
               07 FILLER                      PIC X(01) VALUE SPACES.           
               07 WS-LE08D-TOT-AHG-DIFF       PIC ZZZZZZZ9.99.                  
               07 FILLER                      PIC X(01) VALUE SPACES.           
               07 WS-LE08D-TOT-SHG-DIFF       PIC ZZZZZZZ9.99.                  
               07 FILLER                      PIC X(54) VALUE SPACES.           
      *****************************************************************         
      *                   P R O G R A M     B O D Y                             
      *****************************************************************         
                                                                                
      ********************                                                      
       PROCEDURE DIVISION.                                                      
      ********************                                                      
                                                                                
      ******************************************************************        
       0000-MAIN.                                                               
      ******************************************************************        
                                                                                
           PERFORM 1000-OPEN-ROUTINE       THRU 1000-EXIT.                      
           PERFORM 2000-READ-BP13FD05      THRU 2000-EXIT.                      
           PERFORM 3000-PROCESS-RECORDS    THRU 3000-EXIT                       
             UNTIL WS-FD05-EOF = 'Y'.                                           
           PERFORM 7000-PRINT-TOTALS       THRU 7000-EXIT.                      
           PERFORM 9999-CLOSE-ROUTINE      THRU 9999-EXIT.                      
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       1000-OPEN-ROUTINE.                                                       
      ******************************************************************        
                                                                                
           OPEN INPUT  BP13FD05                                                 
                       BP13K800                                                 
                       BP13K893                                                 
                       BM06K110                                                 
                 I-O   BP13KD09                                                 
               OUTPUT  P13LE08A                                                 
                       P13LE08B                                                 
                       P13LE08C                                                 
                       P13LE08D.                                                
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K800 - ERROR OPENING : ' WS-K800-STATUS              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K893-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K893 - ERROR OPENING : ' WS-K893-STATUS              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-KD09-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13KD09 - ERROR OPENING : ' WS-KD09-STATUS              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K110-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BM06K110 - ERROR OPENING : ' WS-K110-STATUS              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE TO WS-DATE.                               
           STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)                
              DELIMITED BY SIZE INTO LE08-DATE.                                 
                                                                                
           WRITE P13LE08A-REC FROM WS-HEADER-LINE1.                             
           WRITE P13LE08A-REC FROM WS-HEADER-LINE2A.                            
           WRITE P13LE08A-REC FROM WS-SPACES.                                   
                                                                                
           WRITE P13LE08A-REC FROM WS-HEADER-LINE3.                             
                                                                                
           WRITE P13LE08B-REC FROM WS-HEADER-LINE1.                             
           WRITE P13LE08B-REC FROM WS-HEADER-LINE2B.                            
           WRITE P13LE08B-REC FROM WS-SPACES.                                   
           WRITE P13LE08B-REC FROM WS-HEADER-LINE3.                             
                                                                                
           WRITE P13LE08C-REC FROM WS-HEADER-LINE1.                             
           WRITE P13LE08C-REC FROM WS-HEADER-LINE2C.                            
           WRITE P13LE08C-REC FROM WS-SPACES.                                   
           WRITE P13LE08C-REC FROM WS-HEADER-LINE3-ADD.                         
                                                                                
           WRITE P13LE08D-REC FROM WS-HEADER-LINE1.                             
           WRITE P13LE08D-REC FROM WS-HEADER-LINE2D.                            
           WRITE P13LE08D-REC FROM WS-SPACES.                                   
           WRITE P13LE08D-REC FROM WS-HEADER-LINE3A-UPD.                        
           WRITE P13LE08D-REC FROM WS-HEADER-LINE3B-UPD.                        
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       2000-READ-BP13FD05.                                                      
      ******************************************************************        
                                                                                
           READ BP13FD05           AT END                                       
                MOVE 'Y'           TO WS-FD05-EOF                               
                GO                 TO 2000-EXIT.                                
                                                                                
           ADD  1                  TO WS-FD05-READ.                             
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       3000-PROCESS-RECORDS.                                                    
      ******************************************************************        
                                                                                
           MOVE SPACES                    TO BP13KD09-REC                       
                                             BP13K800-MASTER                    
                                             BP13K893-MASTER.                   
           INITIALIZE                        BP13KD09-REC                       
                                             BP13K800-MASTER                    
                                             BP13K893-MASTER.                   
           MOVE SPACES                    TO WS-DTE-KEY-ISSUED.                 
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:16)  TO WS-SYSTEM-DATE-TIME.            
           MOVE SPACES  TO WS-KD09-FOUND-TAG.                                   
           MOVE SPACES  TO WS-K800-FOUND-TAG.                                   
           MOVE FD05-NUM-REGN TO TEMP-NUM-REGN.                                 
                                                                                
           MOVE ZEROES        TO WS-AMT-SUG-GRANT                               
                                 WS-AMT-SUG-RECOVER                             
                                 WS-AMT-SHG-GRANT                               
                                 WS-AMT-SHG-RECOVER                             
                                 WS-AMT-AHG-GRANT                               
                                 WS-AMT-AHG-RECOVER                             
                                 WS-AMT-HSG-GRANT                               
                                 WS-AMT-HSG-RECOVER.                            
                                                                                
           PERFORM 3500-PROCESS-GRANT-BY-NRIC THRU 3500-EXIT                    
                                                                                
                   UNTIL FD05-NUM-REGN NOT = TEMP-NUM-REGN                      
                   OR WS-FD05-EOF = 'Y'.                                        
                                                                                
           MOVE TEMP-NUM-REGN TO KD09-KEY-FLD.                                  
           PERFORM 4300-READ-BP13KD09  THRU 4300-EXIT.                          
           PERFORM 4350-KD09-CHECK-NON-NUMERIC THRU 4350-EXIT.                  
                                                                                
           MOVE TEMP-NUM-REGN TO K800-NUM-REGN.                                 
           PERFORM 4500-READ-BP13K800  THRU 4500-EXIT.                          
                                                                                
           IF WS-KD09-FOUND-TAG = 'N'                                           
               IF WS-K800-FOUND-TAG = 'Y'                                       
                  IF K800-NUM-AHG-STATUS = 'A' OR                               
                     K800-NUM-SHG-STATUS = 'A' OR                               
                  (K800-DTE-AHG-PAYMENT NOT = SPACES AND LOW-VALUES)            
                     OR                                                         
                     K800-NUM-STEPUP = 'Y'                                      
                     ADD 1 TO WS-K800-VALID                                     
                                                                                
                     PERFORM 4600-CREATE-KD09-WITH-K800 THRU 4600-EXIT          
                  END-IF                                                        
               ELSE                                                             
                  PERFORM 5000-STARTBR-K893        THRU 5000-EXIT               
               END-IF                                                           
           ELSE                                                                 
               IF WS-K800-FOUND-TAG = 'Y'                                       
                  IF K800-NUM-AHG-STATUS = 'A' OR                               
                     K800-NUM-SHG-STATUS = 'A' OR                               
                     K800-NUM-STEPUP = 'Y'                                      
                     ADD 1 TO WS-K800-VALID                                     
                     PERFORM 4680-COMPUTE-OLD-NEW   THRU 4680-EXIT              
                     IF (WS-AMT-AHG-DIFF NOT = ZEROES) OR                       
                        (WS-AMT-SHG-DIFF NOT = ZEROES)                          
                         PERFORM 4660-UPDATE-KD09-WITH-K800                     
                                                    THRU 4660-EXIT              
                     END-IF                                                     
                  END-IF                                                        
               ELSE                                                             
                  PERFORM 5000-STARTBR-K893        THRU 5000-EXIT               
               END-IF                                                           
           END-IF.                                                              
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       3500-PROCESS-GRANT-BY-NRIC.                                              
      ******************************************************************        
                                                                                
           IF FD05-NUM-REGN  = TEMP-NUM-REGN                                    
                                                                                
              IF FD05-AMT-AHG-GRANT IS NOT NUMERIC                              
                  MOVE ZEROS TO FD05-AMT-AHG-GRANT                              
              END-IF                                                            
              IF FD05-AMT-AHG-GRANT-RECOVER IS NOT NUMERIC                      
                  MOVE ZEROS TO FD05-AMT-AHG-GRANT-RECOVER                      
              END-IF                                                            
              IF FD05-AMT-HSGNT-RECOVER  IS NOT NUMERIC                         
                  MOVE ZEROS TO FD05-AMT-HSGNT-RECOVER                          
              END-IF                                                            
              IF FD05-AMT-HSGNT IS NOT NUMERIC                                  
                  MOVE ZEROS TO FD05-AMT-HSGNT                                  
              END-IF                                                            
              IF FD05-AMT-SHG-GRANT-RECOVER IS NOT NUMERIC                      
                  MOVE ZEROS TO FD05-AMT-SHG-GRANT-RECOVER                      
              END-IF                                                            
              IF FD05-AMT-SHG-GRANT IS NOT NUMERIC                              
                  MOVE ZEROS TO FD05-AMT-SHG-GRANT                              
              END-IF                                                            
              IF FD05-AMT-SUG-GRANT-RECOVER IS NOT NUMERIC                      
                  MOVE ZEROS TO FD05-AMT-SUG-GRANT-RECOVER                      
              END-IF                                                            
              IF FD05-AMT-SUG-GRANT IS NOT NUMERIC                              
                  MOVE ZEROS TO FD05-AMT-SUG-GRANT                              
              END-IF                                                            
                                                                                
              ADD FD05-AMT-AHG-GRANT         TO WS-AMT-AHG-GRANT                
              ADD FD05-AMT-AHG-GRANT-RECOVER TO WS-AMT-AHG-RECOVER              
                                                                                
              ADD FD05-AMT-HSGNT             TO WS-AMT-HSG-GRANT                
              ADD FD05-AMT-HSGNT-RECOVER     TO WS-AMT-HSG-RECOVER              
                                                                                
              ADD FD05-AMT-SHG-GRANT         TO WS-AMT-SHG-GRANT                
              ADD FD05-AMT-SHG-GRANT-RECOVER TO WS-AMT-SHG-RECOVER              
                                                                                
              ADD FD05-AMT-SUG-GRANT         TO WS-AMT-SUG-GRANT                
              ADD FD05-AMT-SUG-GRANT-RECOVER TO WS-AMT-SUG-RECOVER              
           END-IF.                                                              
                                                                                
           PERFORM 2000-READ-BP13FD05  THRU 2000-EXIT.                          
                                                                                
       3500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4300-READ-BP13KD09.                                                      
      ******************************************************************        
                                                                                
           READ BP13KD09.                                                       
                                                                                
           EVALUATE WS-KD09-STATUS                                              
               WHEN 00                                                          
                    MOVE 'Y' TO WS-KD09-FOUND-TAG                               
                    ADD 1                             TO WS-KD09-FND            
               WHEN 23                                                          
                    MOVE 'N' TO WS-KD09-FOUND-TAG                               
                    ADD 1                             TO WS-KD09-NFND           
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13KD09 : ' WS-KD09-STATUS          
                            ' REGN = ' KD09-KEY-FLD                             
                    PERFORM  9999-CLOSE-ROUTINE     THRU 9999-EXIT              
           END-EVALUATE.                                                        
                                                                                
       4300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4350-KD09-CHECK-NON-NUMERIC.                                             
      ******************************************************************        
           IF KD09-AMT-SHG-GRANT IS NOT NUMERIC                                 
              MOVE ZEROS TO KD09-AMT-SHG-GRANT                                  
           END-IF.                                                              
                                                                                
           IF KD09-AMT-SHG-RECOVER IS NOT NUMERIC                               
              MOVE ZEROS TO KD09-AMT-SHG-RECOVER                                
           END-IF.                                                              
                                                                                
           IF KD09-AMT-SUG-GRANT IS NOT NUMERIC                                 
              MOVE ZEROS TO KD09-AMT-SUG-GRANT                                  
           END-IF.                                                              
                                                                                
           IF KD09-AMT-SUG-RECOVER IS NOT NUMERIC                               
              MOVE ZEROS TO KD09-AMT-SUG-RECOVER                                
           END-IF.                                                              
                                                                                
           IF KD09-AMT-AHG-GRANT IS NOT NUMERIC                                 
              MOVE ZEROS TO KD09-AMT-AHG-GRANT                                  
           END-IF.                                                              
                                                                                
           IF KD09-AMT-AHG-RECOVER IS NOT NUMERIC                               
              MOVE ZEROS TO KD09-AMT-AHG-RECOVER                                
           END-IF.                                                              
                                                                                
           IF KD09-AMT-HSGNT-GRANT IS NOT NUMERIC                               
              MOVE ZEROS TO KD09-AMT-HSGNT-GRANT                                
           END-IF.                                                              
                                                                                
           IF KD09-AMT-HSGNT-RECOVER IS NOT NUMERIC                             
              MOVE ZEROS TO KD09-AMT-HSGNT-RECOVER                              
           END-IF.                                                              
                                                                                
       4350-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4500-READ-BP13K800.                                                      
      ******************************************************************        
                                                                                
           READ BP13K800.                                                       
                                                                                
           EVALUATE WS-K800-STATUS                                              
               WHEN 00                                                          
                    MOVE 'Y' TO WS-K800-FOUND-TAG                               
                    ADD 1                TO WS-K800-FND                         
               WHEN 23                                                          
                    MOVE 'N' TO WS-K800-FOUND-TAG                               
                    ADD 1                TO WS-K800-NFND                        
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BP13K800 : ' WS-K800-STATUS          
                            ' REGN = ' K800-NUM-REGN                            
                    PERFORM  9999-CLOSE-ROUTINE     THRU 9999-EXIT              
           END-EVALUATE.                                                        
                                                                                
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4600-CREATE-KD09-WITH-K800.                                              
      ******************************************************************        
                                                                                
           MOVE SPACES                    TO BP13KD09-REC.                      
           INITIALIZE                        BP13KD09-REC.                      
           MOVE TEMP-NUM-REGN             TO KD09-KEY-FLD.                      
           IF K800-NUM-SCH-ACC = SPACES OR LOW-VALUES                           
              STRING '#' TEMP-NUM-REGN                                          
                        DELIMITED BY SIZE INTO KD09-NUM-SCH-ACCNT               
           ELSE                                                                 
              MOVE K800-NUM-SCH-ACC          TO KD09-NUM-SCH-ACCNT              
           END-IF.                                                              
                                                                                
           MOVE K800-NUM-AHG              TO KD09-NUM-AHG.                      
           MOVE K800-DTE-AHG-REQ          TO KD09-DTE-AHG-REQ.                  
           MOVE K800-DTE-AHG-PROCESS      TO KD09-DTE-AHG-PROCESS.              
           MOVE K800-NUM-AHG-STATUS       TO KD09-NUM-AHG-STATUS.               
           MOVE K800-DTE-AHG-PROCESS      TO KD09-DTE-AHG-PROCESS.              
           MOVE K800-DTE-AHG-FORM-PRT     TO KD09-DTE-AHG-FORM-PRT.             
           MOVE K800-DTE-AHG-PAYMENT      TO KD09-DTE-AHG-PAYMENT.              
           MOVE K800-NUM-AHG-PARENT-CHILD TO KD09-NUM-AHG-PARENT-CHILD.         
           MOVE K800-NUM-AHG-REJECT       TO KD09-NUM-AHG-REJECT.               
           MOVE K800-DTE-AHG-ACK          TO KD09-DTE-AHG-ACK.                  
           MOVE K800-NUM-AHG-DOC-REC      TO KD09-NUM-AHG-DOC-REC.              
           MOVE K800-NUM-NOAHG-REASON     TO KD09-NUM-NOAHG-REASON.             
           MOVE K800-DTE-NOAHG-REASON     TO KD09-DTE-NOAHG-REASON.             
           MOVE K800-NUM-AHG-WITHDRAW     TO KD09-NUM-AHG-WITHDRAW.             
           MOVE K800-DTE-NOAPPLY-AHG-PRT  TO KD09-DTE-NOAPPLY-AHG-PRT.          
           MOVE K800-DTE-CPF-ACK-GRANT    TO KD09-DTE-CPF-ACK-GRANT.            
           MOVE K800-NUM-GRANT-CREDIT-TAG TO KD09-NUM-GRANT-CREDIT-TAG.         
           MOVE K800-CDE-CITIZENSHIP-HOUSEHOLD                                  
                                     TO KD09-NUM-CITIZENSHIP-HOUSEHOLD.         
           MOVE 'BP13CE08'           TO KD09-NUM-USERID.                        
           MOVE K800-NUM-SHG         TO KD09-NUM-SHG.                           
           MOVE K800-DTE-SHG-REQ     TO KD09-DTE-SHG-REQ.                       
           MOVE K800-DTE-SHG-PROCESS TO KD09-DTE-SHG-PROCESS.                   
           MOVE K800-NUM-SHG-STATUS       TO KD09-NUM-SHG-STATUS.               
                                                                                
           MOVE K800-DTE-SHG-PROCESS      TO KD09-DTE-SHG-PROCESS.              
           MOVE K800-DTE-SHG-FORM-PRT     TO KD09-DTE-SHG-FORM-PRT.             
           MOVE K800-NUM-SHG-REJECT       TO KD09-NUM-SHG-REJECT.               
           MOVE K800-NUM-NOSHG-REASON     TO KD09-NUM-NOSHG-REASON.             
           MOVE K800-DTE-NOSHG-REASON     TO KD09-DTE-NOSHG-REASON.             
           MOVE K800-NUM-SHG-WITHDRAW     TO KD09-NUM-SHG-WITHDRAW.             
           MOVE K800-SHG-ELIG             TO KD09-SHG-ELIG.                     
           MOVE K800-SHG-MTHS-WORKED      TO KD09-SHG-MTHS-WORKED.              
           MOVE WS-SYSTEM-DATE            TO KD09-DTE-BKIMAGE.                  
           MOVE WS-SYSTEM-TIME            TO KD09-TME-BKIMAGE.                  
                                                                                
           MOVE WS-AMT-SHG-GRANT          TO KD09-AMT-SHG-GRANT.                
           MOVE WS-AMT-SHG-RECOVER        TO KD09-AMT-SHG-RECOVER.              
           MOVE WS-AMT-SUG-GRANT          TO KD09-AMT-SUG-GRANT.                
           MOVE WS-AMT-SUG-RECOVER        TO KD09-AMT-SUG-RECOVER.              
           MOVE WS-AMT-HSG-GRANT          TO KD09-AMT-HSGNT-GRANT.              
           MOVE WS-AMT-HSG-RECOVER        TO KD09-AMT-HSGNT-RECOVER.            
           MOVE WS-AMT-AHG-GRANT          TO KD09-AMT-AHG-GRANT.                
           MOVE WS-AMT-AHG-RECOVER        TO KD09-AMT-AHG-RECOVER.              
                                                                                
           PERFORM 4800-WRITE-BP13KD09    THRU 4800-EXIT.                       
           PERFORM 4900-REPORT-ADD-TO-KD09 THRU 4900-EXIT.                      
           PERFORM 6000-REPORT-DETAIL-K800 THRU 6000-EXIT.                      
                                                                                
       4600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4660-UPDATE-KD09-WITH-K800.                                              
      ******************************************************************        
                                                                                
           IF K800-NUM-SCH-ACC = SPACES OR LOW-VALUES                           
              STRING '#' TEMP-NUM-REGN                                          
                        DELIMITED BY SIZE INTO KD09-NUM-SCH-ACCNT               
           ELSE                                                                 
              MOVE K800-NUM-SCH-ACC          TO KD09-NUM-SCH-ACCNT              
           END-IF.                                                              
           MOVE K800-NUM-AHG              TO KD09-NUM-AHG.                      
           MOVE K800-DTE-AHG-REQ          TO KD09-DTE-AHG-REQ.                  
           MOVE K800-DTE-AHG-PROCESS      TO KD09-DTE-AHG-PROCESS.              
           MOVE K800-NUM-AHG-STATUS       TO KD09-NUM-AHG-STATUS.               
           MOVE K800-DTE-AHG-PROCESS      TO KD09-DTE-AHG-PROCESS.              
           MOVE K800-DTE-AHG-FORM-PRT     TO KD09-DTE-AHG-FORM-PRT.             
           MOVE K800-DTE-AHG-PAYMENT      TO KD09-DTE-AHG-PAYMENT.              
           MOVE K800-NUM-AHG-PARENT-CHILD TO KD09-NUM-AHG-PARENT-CHILD.         
           MOVE K800-NUM-AHG-REJECT       TO KD09-NUM-AHG-REJECT.               
           MOVE K800-DTE-AHG-ACK          TO KD09-DTE-AHG-ACK.                  
           MOVE K800-NUM-AHG-DOC-REC      TO KD09-NUM-AHG-DOC-REC.              
           MOVE K800-NUM-NOAHG-REASON     TO KD09-NUM-NOAHG-REASON.             
           MOVE K800-DTE-NOAHG-REASON     TO KD09-DTE-NOAHG-REASON.             
           MOVE K800-NUM-AHG-WITHDRAW     TO KD09-NUM-AHG-WITHDRAW.             
           MOVE K800-DTE-NOAPPLY-AHG-PRT  TO KD09-DTE-NOAPPLY-AHG-PRT.          
           MOVE K800-DTE-CPF-ACK-GRANT    TO KD09-DTE-CPF-ACK-GRANT.            
           MOVE K800-NUM-GRANT-CREDIT-TAG TO KD09-NUM-GRANT-CREDIT-TAG.         
           MOVE K800-CDE-CITIZENSHIP-HOUSEHOLD                                  
                                     TO KD09-NUM-CITIZENSHIP-HOUSEHOLD.         
           MOVE 'BP13CE08'           TO KD09-NUM-USERID.                        
           MOVE K800-NUM-SHG         TO KD09-NUM-SHG.                           
           MOVE K800-DTE-SHG-REQ     TO KD09-DTE-SHG-REQ.                       
           MOVE K800-DTE-SHG-PROCESS TO KD09-DTE-SHG-PROCESS.                   
           MOVE K800-NUM-SHG-STATUS       TO KD09-NUM-SHG-STATUS.               
           MOVE K800-DTE-SHG-PROCESS      TO KD09-DTE-SHG-PROCESS.              
           MOVE K800-DTE-SHG-FORM-PRT     TO KD09-DTE-SHG-FORM-PRT.             
           MOVE K800-NUM-SHG-REJECT       TO KD09-NUM-SHG-REJECT.               
           MOVE K800-NUM-NOSHG-REASON     TO KD09-NUM-NOSHG-REASON.             
           MOVE K800-DTE-NOSHG-REASON     TO KD09-DTE-NOSHG-REASON.             
           MOVE K800-NUM-SHG-WITHDRAW     TO KD09-NUM-SHG-WITHDRAW.             
           MOVE K800-SHG-ELIG             TO KD09-SHG-ELIG.                     
           MOVE K800-SHG-MTHS-WORKED      TO KD09-SHG-MTHS-WORKED.              
           MOVE WS-SYSTEM-DATE            TO KD09-DTE-BKIMAGE.                  
           MOVE WS-SYSTEM-TIME            TO KD09-TME-BKIMAGE.                  
                                                                                
           MOVE WS-AMT-SHG-GRANT      TO KD09-AMT-SHG-GRANT.                    
           MOVE WS-AMT-SHG-RECOVER    TO KD09-AMT-SHG-RECOVER.                  
           MOVE WS-AMT-SUG-GRANT      TO KD09-AMT-SUG-GRANT.                    
           MOVE WS-AMT-SUG-RECOVER    TO KD09-AMT-SUG-RECOVER.                  
           MOVE WS-AMT-AHG-GRANT      TO KD09-AMT-AHG-GRANT.                    
           MOVE WS-AMT-AHG-RECOVER    TO KD09-AMT-AHG-RECOVER.                  
           MOVE WS-AMT-HSG-GRANT      TO KD09-AMT-HSGNT-GRANT.                  
           MOVE WS-AMT-HSG-RECOVER    TO KD09-AMT-HSGNT-RECOVER.                
                                                                                
           PERFORM 4700-REWRITE-BP13KD09  THRU 4700-EXIT.                       
           PERFORM 4750-REPORT-UPD-TO-KD09 THRU 4750-EXIT.                      
           PERFORM 6000-REPORT-DETAIL-K800 THRU 6000-EXIT.                      
                                                                                
       4660-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4680-COMPUTE-OLD-NEW.                                                    
      ******************************************************************        
           MOVE ZEROES        TO WS-AMT-SHG-GRANT-PREV                          
                                 WS-AMT-SHG-RECOVER-PREV                        
                                 WS-AMT-AHG-GRANT-PREV                          
                                 WS-AMT-AHG-RECOVER-PREV                        
                                 WS-AMT-HSG-GRANT-PREV                          
                                 WS-AMT-HSG-RECOVER-PREV.                       
                                                                                
           MOVE KD09-AMT-SHG-GRANT    TO WS-AMT-SHG-GRANT-PREV.                 
           MOVE KD09-AMT-SHG-RECOVER  TO WS-AMT-SHG-RECOVER-PREV.               
           MOVE KD09-AMT-AHG-GRANT    TO WS-AMT-AHG-GRANT-PREV.                 
           MOVE KD09-AMT-AHG-RECOVER  TO WS-AMT-AHG-RECOVER-PREV.               
           MOVE KD09-AMT-HSGNT-GRANT  TO WS-AMT-HSG-GRANT-PREV.                 
           MOVE KD09-AMT-HSGNT-RECOVER TO WS-AMT-HSG-RECOVER-PREV.              
                                                                                
           COMPUTE WS-AMT-AHG-DIFF = (WS-AMT-AHG-GRANT-PREV +                   
                                      WS-AMT-AHG-RECOVER-PREV) -                
                                     (WS-AMT-AHG-GRANT +                        
                                      WS-AMT-AHG-RECOVER).                      
                                                                                
           COMPUTE WS-AMT-SHG-DIFF = (WS-AMT-SHG-GRANT-PREV +                   
                                      WS-AMT-SHG-RECOVER-PREV) -                
                                     (WS-AMT-SHG-GRANT +                        
                                      WS-AMT-SHG-RECOVER).                      
                                                                                
           COMPUTE WS-AMT-HSG-DIFF = (WS-AMT-HSG-GRANT-PREV +                   
                                      WS-AMT-HSG-RECOVER-PREV) -                
                                     (WS-AMT-HSG-GRANT +                        
                                      WS-AMT-HSG-RECOVER).                      
                                                                                
       4680-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4700-REWRITE-BP13KD09.                                                   
      ******************************************************************        
                                                                                
           REWRITE BP13KD09-REC.                                                
                                                                                
           EVALUATE WS-KD09-STATUS                                              
           WHEN 00                                                              
           WHEN 02                                                              
              ADD 1                         TO WS-KD09-UPD                      
           WHEN 22                                                              
              ADD 1                         TO WS-KD09-DUP                      
              DISPLAY 'BP13KD09 DUPLICATE ERROR : ' WS-KD09-STATUS              
              DISPLAY 'BP13KD09 REGNO           : ' KD09-KEY-FLD                
           WHEN OTHER                                                           
              DISPLAY 'BP13KD09 REWRITE ERROR : ' WS-KD09-STATUS                
              DISPLAY 'BP13KD09 REGNO         : ' KD09-KEY-FLD                  
              MOVE WS-KD09-STATUS           TO RETURN-CODE                      
              PERFORM 9999-CLOSE-ROUTINE    THRU 9999-EXIT                      
           END-EVALUATE.                                                        
                                                                                
       4700-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       4750-REPORT-UPD-TO-KD09.                                                 
      ******************************************************************        
                                                                                
           COMPUTE WS-AMT-AHG-DIFF = (WS-AMT-AHG-GRANT-PREV +                   
                                      WS-AMT-AHG-RECOVER-PREV) -                
                                     (WS-AMT-AHG-GRANT +                        
                                      WS-AMT-AHG-RECOVER).                      
                                                                                
           COMPUTE WS-AMT-SHG-DIFF = (WS-AMT-SHG-GRANT-PREV +                   
                                      WS-AMT-SHG-RECOVER-PREV) -                
                                     (WS-AMT-SHG-GRANT +                        
                                      WS-AMT-SHG-RECOVER).                      
                                                                                
           MOVE KD09-NUM-REGN            TO WS-LE08-UPD-REGNO.                  
           MOVE KD09-NUM-SCH-ACCNT       TO WS-LE08-UPD-SCHACCT.                
           IF KD09-NUM-AHG-STATUS = 'A'                                         
              MOVE KD09-DTE-AHG-PROCESS  TO WS-LE08-UPD-DTE-AHG-APP             
           ELSE                                                                 
              MOVE SPACES                TO WS-LE08-UPD-DTE-AHG-APP             
           END-IF.                                                              
           IF KD09-NUM-SHG-STATUS = 'A'                                         
              MOVE KD09-DTE-SHG-PROCESS  TO WS-LE08-UPD-DTE-SHG-APP             
           ELSE                                                                 
              MOVE SPACES                TO WS-LE08-UPD-DTE-SHG-APP             
           END-IF.                                                              
                                                                                
           MOVE WS-AMT-AHG-GRANT-PREV    TO WS-LE08-UPD-AHG-GRANT-B4.           
           MOVE WS-AMT-AHG-RECOVER-PREV  TO WS-LE08-UPD-AHG-RECOVER-B4.         
           MOVE WS-AMT-SHG-GRANT-PREV    TO WS-LE08-UPD-SHG-GRANT-B4.           
           MOVE WS-AMT-SHG-RECOVER-PREV  TO WS-LE08-UPD-SHG-RECOVER-B4.         
           MOVE WS-AMT-AHG-GRANT         TO WS-LE08-UPD-AHG-GRANT.              
           MOVE WS-AMT-AHG-RECOVER       TO WS-LE08-UPD-AHG-RECOVER.            
           MOVE WS-AMT-SHG-GRANT         TO WS-LE08-UPD-SHG-GRANT.              
           MOVE WS-AMT-SHG-RECOVER       TO WS-LE08-UPD-SHG-RECOVER.            
           MOVE WS-AMT-AHG-DIFF          TO WS-LE08-UPD-AHG-DIFF.               
           MOVE WS-AMT-SHG-DIFF          TO WS-LE08-UPD-SHG-DIFF.               
                                                                                
           ADD  WS-AMT-AHG-GRANT-PREV    TO WS-TOT-UPD-AHG-GRANT-B4.            
           ADD  WS-AMT-AHG-RECOVER-PREV  TO WS-TOT-UPD-AHG-RECOVER-B4.          
           ADD  WS-AMT-SHG-GRANT-PREV    TO WS-TOT-UPD-SHG-GRANT-B4.            
           ADD  WS-AMT-SHG-RECOVER-PREV  TO WS-TOT-UPD-SHG-RECOVER-B4.          
           ADD  WS-AMT-AHG-GRANT         TO WS-TOT-UPD-AHG-GRANT.               
           ADD  WS-AMT-AHG-RECOVER       TO WS-TOT-UPD-AHG-RECOVER.             
           ADD  WS-AMT-SHG-GRANT         TO WS-TOT-UPD-SHG-GRANT.               
           ADD  WS-AMT-SHG-RECOVER       TO WS-TOT-UPD-SHG-RECOVER.             
           ADD  WS-AMT-AHG-DIFF          TO WS-TOT-UPD-AHG-DIFF.                
           ADD  WS-AMT-SHG-DIFF          TO WS-TOT-UPD-SHG-DIFF.                
                                                                                
           ADD  1                        TO WS-SNO4.                            
           MOVE WS-SNO4                  TO WS-LE08-UPD-SNO.                    
           WRITE P13LE08D-REC FROM WS-LE08-UPD-DETAIL.                          
                                                                                
       4750-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       4800-WRITE-BP13KD09.                                                     
      ******************************************************************        
                                                                                
           DISPLAY 'REGN '             KD09-NUM-REGN                            
           DISPLAY 'AMT-HSG-GRANT '    KD09-AMT-HSGNT-GRANT                     
                                       WS-AMT-HSG-GRANT                         
           IF  KD09-AMT-SUG-GRANT > 0                                           
           DISPLAY 'AMT-SUG-GRANT '    KD09-AMT-SUG-GRANT                       
                                       WS-AMT-SUG-GRANT                         
           END-IF                                                               
           DISPLAY 'AMT-HSG-RECOVER'   KD09-AMT-HSGNT-RECOVER                   
                                       WS-AMT-HSG-RECOVER                       
           DISPLAY 'WS-AMT-AHG-GRANT'  KD09-AMT-AHG-GRANT                       
                                       WS-AMT-AHG-GRANT                         
           DISPLAY 'WS-AMT-AHG-RECOVER'  KD09-AMT-AHG-RECOVER                   
                                         WS-AMT-AHG-RECOVER                     
           WRITE BP13KD09-REC.                                                  
                                                                                
           EVALUATE WS-KD09-STATUS                                              
           WHEN 00                                                              
           WHEN 02                                                              
              ADD 1                         TO WS-KD09-WRITE                    
           WHEN 22                                                              
              ADD 1                         TO WS-KD09-DUP                      
              DISPLAY 'BP13KD09 DUPLICATE ERROR : ' WS-KD09-STATUS              
              DISPLAY 'BP13KD09 REGNO           : ' KD09-KEY-FLD                
           WHEN OTHER                                                           
              DISPLAY 'BP13KD09 WRITE ERROR : ' WS-KD09-STATUS                  
                                                                                
              DISPLAY 'BP13KD09 REGNO       : ' KD09-KEY-FLD                    
              MOVE WS-KD09-STATUS           TO RETURN-CODE                      
              PERFORM 9999-CLOSE-ROUTINE    THRU 9999-EXIT                      
           END-EVALUATE.                                                        
                                                                                
       4800-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       4900-REPORT-ADD-TO-KD09.                                                 
      ******************************************************************        
                                                                                
           MOVE KD09-NUM-REGN            TO WS-LE08-ADD-REGNO.                  
           MOVE KD09-NUM-SCH-ACCNT       TO WS-LE08-ADD-SCHACCT.                
           IF KD09-NUM-AHG-STATUS = 'A'                                         
              MOVE KD09-DTE-AHG-PROCESS  TO WS-LE08-ADD-DTE-AHG-APP             
           ELSE                                                                 
              MOVE SPACES                TO WS-LE08-ADD-DTE-AHG-APP             
           END-IF.                                                              
           IF KD09-NUM-SHG-STATUS = 'A'                                         
              MOVE KD09-DTE-SHG-PROCESS  TO WS-LE08-ADD-DTE-SHG-APP             
           ELSE                                                                 
              MOVE SPACES                TO WS-LE08-ADD-DTE-SHG-APP             
           END-IF.                                                              
                                                                                
           MOVE WS-AMT-AHG-GRANT         TO WS-LE08-ADD-AHG-GRANT.              
           MOVE WS-AMT-AHG-RECOVER       TO WS-LE08-ADD-AHG-RECOVER.            
           MOVE WS-AMT-SHG-GRANT         TO WS-LE08-ADD-SHG-GRANT.              
           MOVE WS-AMT-SHG-RECOVER       TO WS-LE08-ADD-SHG-RECOVER.            
                                                                                
           ADD  WS-AMT-AHG-GRANT         TO WS-TOT-ADD-AHG-GRANT.               
           ADD  WS-AMT-AHG-RECOVER       TO WS-TOT-ADD-AHG-RECOVER.             
           ADD  WS-AMT-SHG-GRANT         TO WS-TOT-ADD-SHG-GRANT.               
           ADD  WS-AMT-SHG-RECOVER       TO WS-TOT-ADD-SHG-RECOVER.             
                                                                                
           ADD  1                        TO WS-SNO3.                            
           MOVE WS-SNO3                  TO WS-LE08-ADD-SNO.                    
           WRITE P13LE08C-REC FROM WS-LE08-ADD-DETAIL.                          
                                                                                
       4900-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       5000-STARTBR-K893.                                                       
      ******************************************************************        
                                                                                
           MOVE 'N'             TO  WS-K893-EOF.                                
           MOVE TEMP-NUM-REGN   TO  K893-NUM-REGN-HIST.                         
                                                                                
           START BP13K893 KEY >= K893-NUM-REGN-HIST.                            
           EVALUATE WS-K893-STATUS                                              
           WHEN 00                                                              
                MOVE 'N' TO WS-K893-FOUND-TAG                                   
                PERFORM 5100-READNEXT-BP13K893 THRU 5100-EXIT                   
                   UNTIL K893-NUM-REGN-HIST NOT = TEMP-NUM-REGN                 
                      OR WS-K893-EOF = 'Y'                                      
                IF WS-K893-FOUND-TAG = 'N'                                      
                   ADD 1 TO WS-K893-NFND                                        
                END-IF                                                          
           WHEN 23                                                              
                CONTINUE                                                        
           WHEN OTHER                                                           
                DISPLAY 'ERROR START BP13K893, STATUS  '                        
                        WS-K893-STATUS                                          
                        ',  REGN ' K893-NUM-REGN-HIST                           
                PERFORM 9999-CLOSE-ROUTINE    THRU 9999-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       5100-READNEXT-BP13K893.                                                  
                                                                                
      *-------------------------------------------------------------            
                                                                                
           READ BP13K893 NEXT RECORD                                            
                AT END MOVE 'Y' TO WS-K893-EOF.                                 
                                                                                
           EVALUATE WS-K893-STATUS                                              
           WHEN 00                                                              
           WHEN 02                                                              
                IF K893-NUM-REGN-HIST = TEMP-NUM-REGN                           
                   MOVE 'Y' TO WS-K893-FOUND-TAG                                
                   ADD 1    TO WS-K893-FND                                      
                   IF K893-NUM-AHG-STATUS = 'A' OR                              
                      K893-NUM-SHG-STATUS = 'A' OR                              
                  (K893-DTE-AHG-PAYMENT NOT = SPACES AND LOW-VALUES)            
                     OR                                                         
                      K893-NUM-STEP-UP = 'Y'                                    
                      ADD 1 TO WS-K893-VALID                                    
                      IF K893-NUM-SCH-ACC = SPACES OR LOW-VALUES                
                         ADD 1 TO WS-K893-SCHACCT-BLANK                         
                      ELSE                                                      
                         MOVE K893-NUM-SCH-ACC TO K110-KEY-FLD                  
                         PERFORM 5105-READ-BM06K110  THRU 5105-EXIT             
                      END-IF                                                    
                      IF WS-KD09-FOUND-TAG = 'N'                                
                         PERFORM 5200-CREATE-KD09-WITH-K893                     
                                                       THRU 5200-EXIT           
                      ELSE                                                      
                         PERFORM 4680-COMPUTE-OLD-NEW   THRU 4680-EXIT          
                         IF (WS-AMT-AHG-DIFF NOT = ZEROES) OR                   
                            (WS-AMT-SHG-DIFF NOT = ZEROES) OR                   
                            (WS-AMT-HSG-DIFF NOT = ZEROES)                      
                             PERFORM 5300-UPDATE-KD09-WITH-K893                 
                                                       THRU 5300-EXIT           
                         END-IF                                                 
                      END-IF                                                    
                   END-IF                                                       
                ELSE                                                            
                   MOVE 'Y' TO WS-K893-EOF                                      
                END-IF                                                          
           WHEN 10                                                              
           WHEN 23                                                              
                MOVE 'Y' TO WS-K893-EOF                                         
           WHEN OTHER                                                           
                DISPLAY 'ERROR READING BP13K893, STATUS  '                      
                        WS-K893-STATUS                                          
                        ',  REGN ' K893-NUM-REGN-HIST                           
                PERFORM 9999-CLOSE-ROUTINE    THRU 9999-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       5100-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       5105-READ-BM06K110.                                                      
      ******************************************************************        
                                                                                
           READ BM06K110.                                                       
                                                                                
           EVALUATE WS-K110-STATUS                                              
               WHEN 00                                                          
                    ADD 1                TO WS-K110-FND                         
                    MOVE K110-DTE-KEY-ISSUED TO WS-DTE-KEY-ISSUED               
                    DISPLAY '*FOUND IN K110: ' K110-KEY-FLD                     
                            ' KI=' K110-DTE-KEY-ISSUED                          
                                                                                
                    IF  K110-DTE-KEY-ISSUED > ZEROS                             
                        ADD 1 TO WS-K110-SOLD                                   
                    ELSE                                                        
                        ADD 1 TO WS-K110-ZERO-KI                                
                    END-IF                                                      
               WHEN 23                                                          
                    DISPLAY '*NTFND IN K110: ' K110-KEY-FLD                     
                    ADD 1                TO WS-K110-NFND                        
               WHEN OTHER                                                       
                    DISPLAY 'ERROR READING BM06K110 : ' WS-K110-STATUS          
                            ' REGN = ' K110-KEY-FLD                             
                    PERFORM  9999-CLOSE-ROUTINE     THRU 9999-EXIT              
           END-EVALUATE.                                                        
                                                                                
       5105-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       5200-CREATE-KD09-WITH-K893.                                              
      ******************************************************************        
                                                                                
           MOVE SPACES                    TO BP13KD09-REC.                      
           INITIALIZE                        BP13KD09-REC.                      
           MOVE TEMP-NUM-REGN             TO KD09-KEY-FLD.                      
           IF K893-NUM-SCH-ACC = SPACES OR LOW-VALUES                           
              STRING '#' TEMP-NUM-REGN                                          
                        DELIMITED BY SIZE INTO KD09-NUM-SCH-ACCNT               
           ELSE                                                                 
              MOVE K893-NUM-SCH-ACC          TO KD09-NUM-SCH-ACCNT              
           END-IF.                                                              
           MOVE K893-NUM-AHG              TO KD09-NUM-AHG.                      
           MOVE K893-DTE-AHG-REQ          TO KD09-DTE-AHG-REQ.                  
           MOVE K893-DTE-AHG-PROCESS      TO KD09-DTE-AHG-PROCESS.              
           MOVE K893-NUM-AHG-STATUS       TO KD09-NUM-AHG-STATUS.               
           MOVE K893-DTE-AHG-PROCESS      TO KD09-DTE-AHG-PROCESS.              
           MOVE K893-DTE-AHG-FORM-PRT     TO KD09-DTE-AHG-FORM-PRT.             
           MOVE K893-DTE-AHG-PAYMENT      TO KD09-DTE-AHG-PAYMENT.              
           MOVE K893-NUM-AHG-PARENT-CHILD TO KD09-NUM-AHG-PARENT-CHILD.         
           MOVE K893-NUM-AHG-REJECT       TO KD09-NUM-AHG-REJECT.               
           MOVE K893-DTE-AHG-ACK          TO KD09-DTE-AHG-ACK.                  
           MOVE K893-NUM-AHG-DOC-REC      TO KD09-NUM-AHG-DOC-REC.              
           MOVE K893-NUM-NOAHG-REASON     TO KD09-NUM-NOAHG-REASON.             
           MOVE K893-DTE-NOAHG-REASON     TO KD09-DTE-NOAHG-REASON.             
           MOVE K893-NUM-AHG-WITHDRAW     TO KD09-NUM-AHG-WITHDRAW.             
           MOVE K893-DTE-NOAPPLY-AHG-PRT  TO KD09-DTE-NOAPPLY-AHG-PRT.          
           MOVE K893-DTE-CPF-ACK-GRANT    TO KD09-DTE-CPF-ACK-GRANT.            
           MOVE K893-NUM-GRANT-CREDIT-TAG TO KD09-NUM-GRANT-CREDIT-TAG.         
           MOVE K893-CDE-CITIZENSHIP-HOUSEHOLD                                  
                                     TO KD09-NUM-CITIZENSHIP-HOUSEHOLD.         
           MOVE 'BP13CE08'           TO KD09-NUM-USERID.                        
           MOVE K893-NUM-SHG         TO KD09-NUM-SHG.                           
           MOVE K893-DTE-SHG-REQ     TO KD09-DTE-SHG-REQ.                       
           MOVE K893-DTE-SHG-PROCESS TO KD09-DTE-SHG-PROCESS.                   
           MOVE K893-NUM-SHG-STATUS       TO KD09-NUM-SHG-STATUS.               
           MOVE K893-DTE-SHG-PROCESS      TO KD09-DTE-SHG-PROCESS.              
           MOVE K893-DTE-SHG-FORM-PRT     TO KD09-DTE-SHG-FORM-PRT.             
           MOVE K893-NUM-SHG-REJECT       TO KD09-NUM-SHG-REJECT.               
           MOVE K893-NUM-NOSHG-REASON     TO KD09-NUM-NOSHG-REASON.             
           MOVE K893-DTE-NOSHG-REASON     TO KD09-DTE-NOSHG-REASON.             
           MOVE K893-NUM-SHG-WITHDRAW     TO KD09-NUM-SHG-WITHDRAW.             
           MOVE K893-SHG-ELIG             TO KD09-SHG-ELIG.                     
           MOVE K893-SHG-MTHS-WORKED      TO KD09-SHG-MTHS-WORKED.              
           MOVE WS-SYSTEM-DATE            TO KD09-DTE-BKIMAGE.                  
           MOVE WS-SYSTEM-TIME            TO KD09-TME-BKIMAGE.                  
                                                                                
           MOVE WS-AMT-SHG-GRANT          TO KD09-AMT-SHG-GRANT.                
           MOVE WS-AMT-SHG-RECOVER        TO KD09-AMT-SHG-RECOVER.              
           MOVE WS-AMT-AHG-GRANT          TO KD09-AMT-AHG-GRANT.                
           MOVE WS-AMT-AHG-RECOVER        TO KD09-AMT-AHG-RECOVER.              
           MOVE WS-DTE-KEY-ISSUED         TO KD09-DTE-KEY-ISSUED.               
                                                                                
           PERFORM 4800-WRITE-BP13KD09    THRU 4800-EXIT.                       
           PERFORM 4900-REPORT-ADD-TO-KD09 THRU 4900-EXIT.                      
           PERFORM 6100-REPORT-DETAIL-K893 THRU 6100-EXIT.                      
                                                                                
       5200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       5300-UPDATE-KD09-WITH-K893.                                              
      ******************************************************************        
                                                                                
           IF K893-NUM-SCH-ACC = SPACES OR LOW-VALUES                           
              STRING '#' TEMP-NUM-REGN                                          
                        DELIMITED BY SIZE INTO KD09-NUM-SCH-ACCNT               
           ELSE                                                                 
              MOVE K893-NUM-SCH-ACC          TO KD09-NUM-SCH-ACCNT              
           END-IF.                                                              
           MOVE K893-NUM-AHG              TO KD09-NUM-AHG.                      
           MOVE K893-DTE-AHG-REQ          TO KD09-DTE-AHG-REQ.                  
           MOVE K893-DTE-AHG-PROCESS      TO KD09-DTE-AHG-PROCESS.              
           MOVE K893-NUM-AHG-STATUS       TO KD09-NUM-AHG-STATUS.               
           MOVE K893-DTE-AHG-PROCESS      TO KD09-DTE-AHG-PROCESS.              
           MOVE K893-DTE-AHG-FORM-PRT     TO KD09-DTE-AHG-FORM-PRT.             
           MOVE K893-DTE-AHG-PAYMENT      TO KD09-DTE-AHG-PAYMENT.              
           MOVE K893-NUM-AHG-PARENT-CHILD TO KD09-NUM-AHG-PARENT-CHILD.         
           MOVE K893-NUM-AHG-REJECT       TO KD09-NUM-AHG-REJECT.               
           MOVE K893-DTE-AHG-ACK          TO KD09-DTE-AHG-ACK.                  
           MOVE K893-NUM-AHG-DOC-REC      TO KD09-NUM-AHG-DOC-REC.              
           MOVE K893-NUM-NOAHG-REASON     TO KD09-NUM-NOAHG-REASON.             
           MOVE K893-DTE-NOAHG-REASON     TO KD09-DTE-NOAHG-REASON.             
           MOVE K893-NUM-AHG-WITHDRAW     TO KD09-NUM-AHG-WITHDRAW.             
           MOVE K893-DTE-NOAPPLY-AHG-PRT  TO KD09-DTE-NOAPPLY-AHG-PRT.          
           MOVE K893-DTE-CPF-ACK-GRANT    TO KD09-DTE-CPF-ACK-GRANT.            
           MOVE K893-NUM-GRANT-CREDIT-TAG TO KD09-NUM-GRANT-CREDIT-TAG.         
           MOVE K893-CDE-CITIZENSHIP-HOUSEHOLD                                  
                                     TO KD09-NUM-CITIZENSHIP-HOUSEHOLD.         
           MOVE 'BP13CE08'           TO KD09-NUM-USERID.                        
           MOVE K893-NUM-SHG         TO KD09-NUM-SHG.                           
           MOVE K893-DTE-SHG-REQ     TO KD09-DTE-SHG-REQ.                       
           MOVE K893-DTE-SHG-PROCESS TO KD09-DTE-SHG-PROCESS.                   
           MOVE K893-NUM-SHG-STATUS       TO KD09-NUM-SHG-STATUS.               
           MOVE K893-DTE-SHG-PROCESS      TO KD09-DTE-SHG-PROCESS.              
           MOVE K893-DTE-SHG-FORM-PRT     TO KD09-DTE-SHG-FORM-PRT.             
           MOVE K893-NUM-SHG-REJECT       TO KD09-NUM-SHG-REJECT.               
           MOVE K893-NUM-NOSHG-REASON     TO KD09-NUM-NOSHG-REASON.             
           MOVE K893-DTE-NOSHG-REASON     TO KD09-DTE-NOSHG-REASON.             
           MOVE K893-NUM-SHG-WITHDRAW     TO KD09-NUM-SHG-WITHDRAW.             
           MOVE K893-SHG-ELIG             TO KD09-SHG-ELIG.                     
           MOVE K893-SHG-MTHS-WORKED      TO KD09-SHG-MTHS-WORKED.              
           MOVE WS-SYSTEM-DATE        TO KD09-DTE-BKIMAGE.                      
           MOVE WS-SYSTEM-TIME        TO KD09-TME-BKIMAGE.                      
                                                                                
           MOVE WS-AMT-SHG-GRANT          TO KD09-AMT-SHG-GRANT.                
           MOVE WS-AMT-SHG-RECOVER        TO KD09-AMT-SHG-RECOVER.              
           MOVE WS-AMT-HSG-GRANT          TO KD09-AMT-HSGNT-GRANT.              
           MOVE WS-AMT-HSG-RECOVER        TO KD09-AMT-HSGNT-RECOVER.            
           MOVE WS-AMT-AHG-GRANT          TO KD09-AMT-AHG-GRANT.                
           MOVE WS-AMT-AHG-RECOVER        TO KD09-AMT-AHG-RECOVER.              
           MOVE WS-DTE-KEY-ISSUED         TO KD09-DTE-KEY-ISSUED.               
                                                                                
           PERFORM 4700-REWRITE-BP13KD09   THRU 4700-EXIT.                      
           PERFORM 4750-REPORT-UPD-TO-KD09 THRU 4750-EXIT.                      
           PERFORM 6100-REPORT-DETAIL-K893 THRU 6100-EXIT.                      
                                                                                
       5300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6000-REPORT-DETAIL-K800.                                                 
      ******************************************************************        
                                                                                
           COMPUTE WS-AHG-GNT = WS-AMT-AHG-GRANT -                              
                                WS-AMT-AHG-RECOVER.                             
           COMPUTE WS-SHG-GNT = WS-AMT-SHG-GRANT -                              
                                WS-AMT-SHG-RECOVER.                             
                                                                                
           IF K800-NUM-AHG(2:2) = SPACES                                        
              MOVE '00' TO WS-NUM-AHG-NUMERIC                                   
           ELSE                                                                 
              MOVE K800-NUM-AHG(2:2) TO WS-NUM-AHG-NUMERIC                      
           END-IF.                                                              
           IF K800-NUM-SHG(2:2) = SPACES                                        
              MOVE '00' TO WS-NUM-SHG-NUMERIC                                   
           ELSE                                                                 
              MOVE K800-NUM-SHG(2:2) TO WS-NUM-SHG-NUMERIC                      
           END-IF.                                                              
                                                                                
           COMPUTE WS-NUM-AHG-THOU = WS-AHG-GNT / 1000.                         
           COMPUTE WS-NUM-SHG-THOU = WS-SHG-GNT / 1000.                         
                                                                                
           IF WS-NUM-AHG-THOU NOT = WS-NUM-AHG-NUMERIC OR                       
              WS-NUM-SHG-THOU NOT = WS-NUM-SHG-NUMERIC                          
              MOVE TEMP-NUM-REGN            TO WS-LE08-REGNO                    
              MOVE WS-AMT-AHG-GRANT         TO WS-LE08-AHG-GRANT                
              MOVE WS-AMT-AHG-RECOVER       TO WS-LE08-AHG-RECOVER              
              MOVE WS-AMT-SHG-GRANT         TO WS-LE08-SHG-GRANT                
              MOVE WS-AMT-SHG-RECOVER       TO WS-LE08-SHG-RECOVER              
              ADD  WS-AMT-AHG-GRANT         TO WS-TOT-AHG-GRANT-K800            
              ADD  WS-AMT-AHG-RECOVER       TO WS-TOT-AHG-RECOVER-K800          
              ADD  WS-AMT-SHG-GRANT         TO WS-TOT-SHG-GRANT-K800            
              ADD  WS-AMT-SHG-RECOVER       TO WS-TOT-SHG-RECOVER-K800          
              MOVE K800-NUM-AHG             TO WS-LE08-NUM-AHG                  
              MOVE K800-NUM-SHG             TO WS-LE08-NUM-SHG                  
              MOVE KD09-NUM-SCH-ACCNT       TO WS-LE08-SCHACCT                  
              ADD  1                        TO WS-SNO                           
              MOVE WS-SNO                   TO WS-LE08-SNO                      
              WRITE P13LE08A-REC FROM WS-LE08-DETAIL                            
           END-IF.                                                              
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       6100-REPORT-DETAIL-K893.                                                 
      ******************************************************************        
                                                                                
           COMPUTE WS-AHG-GNT = WS-AMT-AHG-GRANT -                              
                                WS-AMT-AHG-RECOVER.                             
           COMPUTE WS-SHG-GNT = WS-AMT-SHG-GRANT -                              
                                WS-AMT-SHG-RECOVER.                             
                                                                                
           IF K893-NUM-AHG(2:2) = SPACES                                        
              MOVE '00' TO WS-NUM-AHG-NUMERIC                                   
           ELSE                                                                 
              MOVE K893-NUM-AHG(2:2) TO WS-NUM-AHG-NUMERIC                      
           END-IF.                                                              
           IF K893-NUM-SHG(2:2) = SPACES                                        
              MOVE '00' TO WS-NUM-SHG-NUMERIC                                   
           ELSE                                                                 
              MOVE K893-NUM-SHG(2:2) TO WS-NUM-SHG-NUMERIC                      
           END-IF.                                                              
                                                                                
           COMPUTE WS-NUM-AHG-THOU = WS-AHG-GNT / 1000.                         
           COMPUTE WS-NUM-SHG-THOU = WS-SHG-GNT / 1000.                         
                                                                                
           IF WS-NUM-AHG-THOU NOT = WS-NUM-AHG-NUMERIC OR                       
              WS-NUM-SHG-THOU NOT = WS-NUM-SHG-NUMERIC                          
              MOVE TEMP-NUM-REGN            TO WS-LE08-REGNO                    
              MOVE WS-AMT-AHG-GRANT         TO WS-LE08-AHG-GRANT                
              MOVE WS-AMT-AHG-RECOVER       TO WS-LE08-AHG-RECOVER              
              MOVE WS-AMT-SHG-GRANT         TO WS-LE08-SHG-GRANT                
              MOVE WS-AMT-SHG-RECOVER       TO WS-LE08-SHG-RECOVER              
              ADD  WS-AMT-AHG-GRANT         TO WS-TOT-AHG-GRANT-K893            
              ADD  WS-AMT-AHG-RECOVER       TO WS-TOT-AHG-RECOVER-K893          
              ADD  WS-AMT-SHG-GRANT         TO WS-TOT-SHG-GRANT-K893            
              ADD  WS-AMT-SHG-RECOVER       TO WS-TOT-SHG-RECOVER-K893          
              MOVE K893-NUM-AHG             TO WS-LE08-NUM-AHG                  
              MOVE K893-NUM-SHG             TO WS-LE08-NUM-SHG                  
              MOVE KD09-NUM-SCH-ACCNT       TO WS-LE08-SCHACCT                  
              ADD  1                        TO WS-SNO2                          
              MOVE WS-SNO2                  TO WS-LE08-SNO                      
              WRITE P13LE08B-REC FROM WS-LE08-DETAIL                            
           END-IF.                                                              
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       7000-PRINT-TOTALS.                                                       
      ******************************************************************        
                                                                                
           MOVE WS-TOT-AHG-GRANT-K800    TO WS-LE08-TOT-AHG-GRANT.              
           MOVE WS-TOT-AHG-RECOVER-K800  TO WS-LE08-TOT-AHG-RECOVER.            
           MOVE WS-TOT-SHG-GRANT-K800    TO WS-LE08-TOT-SHG-GRANT.              
           MOVE WS-TOT-SHG-RECOVER-K800  TO WS-LE08-TOT-SHG-RECOVER.            
           WRITE P13LE08A-REC            FROM WS-SPACES.                        
           WRITE P13LE08A-REC            FROM WS-LE08-TOTALS.                   
                                                                                
           MOVE WS-TOT-AHG-GRANT-K893    TO WS-LE08-TOT-AHG-GRANT.              
           MOVE WS-TOT-AHG-RECOVER-K893  TO WS-LE08-TOT-AHG-RECOVER.            
           MOVE WS-TOT-SHG-GRANT-K893    TO WS-LE08-TOT-SHG-GRANT.              
           MOVE WS-TOT-SHG-RECOVER-K893  TO WS-LE08-TOT-SHG-RECOVER.            
           WRITE P13LE08B-REC            FROM WS-SPACES.                        
           WRITE P13LE08B-REC            FROM WS-LE08-TOTALS.                   
                                                                                
           MOVE WS-TOT-ADD-AHG-GRANT     TO WS-LE08C-TOT-AHG-GRANT.             
           MOVE WS-TOT-ADD-AHG-RECOVER   TO WS-LE08C-TOT-AHG-RECOVER.           
           MOVE WS-TOT-ADD-SHG-GRANT     TO WS-LE08C-TOT-SHG-GRANT.             
           MOVE WS-TOT-ADD-SHG-RECOVER   TO WS-LE08C-TOT-SHG-RECOVER.           
           WRITE P13LE08C-REC            FROM WS-SPACES.                        
           WRITE P13LE08C-REC            FROM WS-LE08-TOTALS-ADD.               
                                                                                
           MOVE WS-TOT-UPD-AHG-GRANT-B4  TO WS-LE08D-TOT-AHG-GRANT-B4.          
           MOVE WS-TOT-UPD-AHG-RECOVER-B4                                       
                                         TO WS-LE08D-TOT-AHG-RECOVER-B4.        
           MOVE WS-TOT-UPD-SHG-GRANT-B4  TO WS-LE08D-TOT-SHG-GRANT-B4.          
           MOVE WS-TOT-UPD-SHG-RECOVER-B4                                       
                                         TO WS-LE08D-TOT-SHG-RECOVER-B4.        
           MOVE WS-TOT-UPD-AHG-GRANT     TO WS-LE08D-TOT-AHG-GRANT.             
           MOVE WS-TOT-UPD-AHG-RECOVER   TO WS-LE08D-TOT-AHG-RECOVER.           
           MOVE WS-TOT-UPD-SHG-GRANT     TO WS-LE08D-TOT-SHG-GRANT.             
           MOVE WS-TOT-UPD-SHG-RECOVER   TO WS-LE08D-TOT-SHG-RECOVER.           
           MOVE WS-TOT-UPD-AHG-DIFF      TO WS-LE08D-TOT-AHG-DIFF.              
           MOVE WS-TOT-UPD-SHG-DIFF      TO WS-LE08D-TOT-SHG-DIFF.              
           WRITE P13LE08D-REC            FROM WS-SPACES.                        
           WRITE P13LE08D-REC            FROM WS-LE08-TOTALS-UPD.               
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       9999-CLOSE-ROUTINE.                                                      
      ******************************************************************        
                                                                                
           DISPLAY '*************** CONTROL    TOTALS ***************'.         
           DISPLAY 'PROGRAM-ID : BP13CE08'.                                     
           DISPLAY '-------------------------------------------------'.         
           DISPLAY '(01) NO OF BP13FD05 RECORDS READ............. : '           
                    WS-FD05-READ.                                               
           DISPLAY '(02) NO OF BP13K800 RECORDS FOUND  .......... : '           
                    WS-K800-FND.                                                
           DISPLAY '(03) NO OF BP13K800 RECORDS NOT FOUND ....... : '           
                    WS-K800-NFND.                                               
           DISPLAY '(04) NO OF BP13K800 VALID RECORDS ........... : '           
                    WS-K800-VALID.                                              
           DISPLAY '(05) NO OF BP13K893 RECORDS FOUND  .......... : '           
                    WS-K893-FND.                                                
           DISPLAY '(06) NO OF BP13K893 RECORDS NOT FOUND ....... : '           
                    WS-K893-NFND.                                               
           DISPLAY '(07) NO OF BP13K893 VALID RECORDS ........... : '           
                    WS-K893-VALID.                                              
           DISPLAY '(08) NO OF BP13KD09 RECORDS FOUND  .......... : '           
                    WS-KD09-FND.                                                
           DISPLAY '(09) NO OF BP13KD09 RECORDS NOT FOUND ....... : '           
                    WS-KD09-NFND.                                               
           DISPLAY '(10) NO OF BP13KD09 RECORDS CREATED   ....... : '           
                    WS-KD09-WRITE.                                              
           DISPLAY '(11) NO OF BP13KD09 RECORDS UPDATED   ....... : '           
                    WS-KD09-UPD.                                                
           DISPLAY '(12) NO OF BP13KD09 DUPLICATES .............. : '           
                    WS-KD09-DUP.                                                
           DISPLAY '(13) NO OF BM06K110 RECORDS FOUND  .......... : '           
                    WS-K110-FND.                                                
           DISPLAY '(14) NO OF BP13K110 RECORDS NOT FOUND ....... : '           
                    WS-K110-NFND.                                               
           DISPLAY '(15) NO OF BM06K110 RECORDS KEY-ISSUED ...... : '           
                    WS-K110-SOLD.                                               
           DISPLAY '(16) NO OF BM06K110 NO KEY-ISSUED ........... : '           
                    WS-K110-ZERO-KI.                                            
           DISPLAY '(17) NO OF BLANK SCHACCT IN K893 ............ : '           
                    WS-K893-SCHACCT-BLANK.                                      
                                                                                
           CLOSE    BP13FD05                                                    
                    BP13KD09                                                    
                    BP13K800                                                    
                    BP13K893                                                    
                    BM06K110                                                    
                    P13LE08A                                                    
                    P13LE08B                                                    
                    P13LE08C                                                    
                    P13LE08D.                                                   
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K800 - ERROR CLOSING : ' WS-K800-STATUS              
           END-IF.                                                              
                                                                                
           IF WS-KD09-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13KD09 - ERROR CLOSING : ' WS-KD09-STATUS              
           END-IF.                                                              
                                                                                
           IF WS-K893-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K893 - ERROR CLOSING : ' WS-K893-STATUS              
           END-IF.                                                              
                                                                                
           IF WS-K110-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BM06K110 - ERROR CLOSING : ' WS-K110-STATUS              
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
       9999-EXIT.                                                               
           EXIT.                                                                
