       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CF68.                                                 
      *AUTHOR.        SMR2.                                                     
      *DATE-WRITTEN.  29/10/2012.                                               
      * ========================================================== *            
      * SYSTEM OF COMMITMENT  (BP13)                               *            
      * ========================================================== *            
      *                                                            *            
      *  OBJECTIVE   : PRINT SUCC OR UNSUCC LETTER FOR SBF - PA    *            
      *                                                            *            
      *  INPUT FILES : 1.  BP13F740  -  SOC REQ FILE               *            
      *                2.  BP13K813  -  BTO/SBF SITE INFORMATION   *            
      *                3.  BP13K825  -  OCCUPIER FILE              *            
      *                4.  BP13K830  -  ADDRESS FILE               *            
      *                                                            *            
      *  LISTINGS    : 1.  P13LF68C  -  CONTROL LISTING FOR SUCC   *            
      *                2.  P13LF68D  -  CONTROL LISTING FOR UNSUCC *            
      *                7.  P13LF68Y  -  NON-SA QUEUE WITHIN 100%   *            
      *                8.  P13LF681  -  NON-SA QUEUE WITHIN 200%   *            
      *                9.  P13LF68G  -  NON-SA QUEUE WITHIN 300%   *            
      *               10.  P13LF68H  -  NON-SA QUEUE BEYOND 300%   *            
      *               11.  P13LF68I  -  3GEN FLAT                  *            
      *                                                            *            
      * ---------------------------------------------------------- *            
      * CHG REF   BY    DATE      DESCRIPTION                      *            
      * --------  ----  --------  -------------------------------- *            
      * BP134688  SMR2  20121029  NEW PROGRAM (SIMILAR TO BP13C089)*            
      * BP134718  SMR2  20121213  ADD TXT-NEXT-LAUNCH-LTR          *            
      * BP134982  IL5   20130723  UPDATE HARDCODING FOR FLAT TYPE  *            
      * BP135162  SMR2  20140127  FORMS REVISION AND REALIGNMENT   *            
      * BP135190  SMR2  20131204  EXPAND BP13K813 TO 1000          *            
      * BP135392  SMR2  20140723  INCREASE LENGTH OF FT FIELD      *            
      * BP135625  SMR2  20150112  CATER FOR 3GEN                   *            
      * BP135625  IL5   20150207  MOVE PROJECT-LTR INSTEAD OF      *            
      *                           PROJECT-MGPS-LTRTO GEN3-ESTATE   *            
      * BP136107  SMR2  20160219  CATER FOR SINGLES AND REMOVE SA  *            
      *                           FORMS                            *            
      * BP136169  SMR2  20160407  SWITCH THE FIELDS, UNIT & STREET *            
      * BP136296  IL5   20160728  STOP PRINTING FAQ FOR BP13XB AND *            
      *                           BP131T                           *            
      * BP136296  SMR2  20160811  FIX ALIGNMENT ISSUE ON BP13XB/1T *            
      * BP137685  AM25  20190218  UPDATE TEXT EXERCISE FIELD       *            
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
      *-------------------------------------------------------------            
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F740  ASSIGN       TO BP13F740                            
                            FILE STATUS  IS WS-F740-STATUS.                     
                                                                                
           SELECT BP13K825  ASSIGN       TO BP13K825                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K825-KEY-FLD                        
                            FILE STATUS  IS WS-K825-STATUS.                     
                                                                                
           SELECT BP13K830  ASSIGN       TO BP13K830                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K830-KEY-FLD                        
                            ALTERNATE RECORD KEY IS  K830-NUM-REGN              
                            FILE STATUS  IS WS-K830-STATUS.                     
                                                                                
           SELECT BP13K813  ASSIGN       TO BP13K813                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K813-KEY-FLD                        
                            FILE STATUS  IS WS-K813-STATUS.                     
                                                                                
           SELECT P13LF68C  ASSIGN       TO P13LF68C.                           
           SELECT P13LF68D  ASSIGN       TO P13LF68D.                           
           SELECT P13LF68G  ASSIGN       TO P13LF68G.                           
           SELECT P13LF68H  ASSIGN       TO P13LF68H.                           
           SELECT P13LF68I  ASSIGN       TO P13LF68I.                           
           SELECT P13LF68Y  ASSIGN       TO P13LF68Y.                           
           SELECT P13LF681  ASSIGN       TO P13LF681.                           
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       FD   BP13F740                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13F740.                                                           
                                                                                
       FD   BP13K825                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13K825.                                                           
                                                                                
       FD   BP13K830                                                            
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD   BP13K813                                                            
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BP13K813.                                                           
                                                                                
       FD  P13LF68C                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132 CHARACTERS.                                      
       01  LF68C-PRTREC                     PIC X(132).                         
                                                                                
       FD  P13LF68D                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132 CHARACTERS.                                      
       01  LF68D-PRTREC                     PIC X(132).                         
                                                                                
       FD  P13LF68G                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LF68G-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13LF68H                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LF68H-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13LF68I                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LF68I-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13LF68Y                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LF68Y-PRTREC                     PIC X(90).                          
                                                                                
       FD  P13LF681                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 90  CHARACTERS.                                      
       01  LF681-PRTREC                     PIC X(90).                          
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
       COPY PRIOSCH.                                                            
                                                                                
       01  WS-STATUS.                                                           
           05  WS-K825-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K830-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-F740-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K813-STATUS               PIC 99    VALUE ZEROS.              
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-F740-NOT-FND              PIC 9(06)  VALUE ZEROS.             
           05  WS-F740-READ-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LF68G-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LF68H-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LF68I-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LF68Y-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-LF681-WRT-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-LETTERS-SUCC          PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-LETTERS-UNSUCC        PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-PAGE-LF68C            PIC 9(04)  VALUE ZEROS.             
           05  WS-CNT-LINE-LF68C            PIC 9(06)  VALUE 60.                
           05  WS-CNT-PAGE-LF68D            PIC 9(04)  VALUE ZEROS.             
           05  WS-CNT-LINE-LF68D            PIC 9(06)  VALUE 60.                
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-F740-EOF                  PIC X     VALUE 'N'.                
           05  WS-BALLOT-SW                 PIC X(2)  VALUE SPACES.             
           05  WS-K825-NME-OCCP             PIC X(66) VALUE SPACES.             
           05  WS-ALLOCSCH-TYPE             PIC X(3)  VALUE SPACES.             
           05  WS-IDX-X                     PIC 99    VALUE 01.                 
           05  WS-RECORD-CNT                PIC ZZZ9.                           
           05  WS-NUM-UNIT-OFFER            PIC 9(04) VALUE ZEROES.             
           05  WS-NUM-UNIT-OFFER-GEN3       PIC 9(04) VALUE ZEROES.             
           05  WS-NUM-QUEUE-START           PIC X(05) VALUE SPACES.             
           05  WS-NUM-QUEUE-MID             PIC X(05) VALUE SPACES.             
           05  WS-NUM-QUEUE-END             PIC X(05) VALUE SPACES.             
                                                                                
       01  WS-DATE-VARIABLES.                                                   
           05  WS-DATE.                                                         
               10  WS-CCYY                  PIC 9(4)  VALUE 0000.               
               10  WS-MM                    PIC 99    VALUE 00.                 
               10  WS-DD                    PIC 99    VALUE 00.                 
           05  WS-CURR-DATE                 PIC 9(8)  VALUE ZEROES.             
           05  WS-SENT-DATE                 PIC 9(8)  VALUE ZEROES.             
           05  WS-SENT-DATE-X REDEFINES WS-SENT-DATE PIC X(8).                  
           05  WS-DAYS                      PIC 9(7)  VALUE ZEROES.             
           05  WS-APPMT-TIME.                                                   
               10  WS-APPMT-HR              PIC 9(2)  VALUE 00.                 
               10  WS-APPMT-MIN             PIC 9(2)  VALUE 00.                 
           05  WS-DTE-BALLOT                PIC X(6)  VALUE SPACES.             
           05  WS-MTH-BE                    PIC X(9)  VALUE SPACES.             
                                                                                
       01  WS2-DEFAULT.                                                         
           05  WS2-MAX-LINES-LF68C          PIC 9(2)   VALUE 37.                
           05  WS2-MAX-LINES-LF68D          PIC 9(2)   VALUE 45.                
                                                                                
       01  WS-MTH-CONV.                                                         
           05  FILLER                  PIC X(5)    VALUE 'JAN01'.               
           05  FILLER                  PIC X(5)    VALUE 'FEB02'.               
           05  FILLER                  PIC X(5)    VALUE 'MAR03'.               
           05  FILLER                  PIC X(5)    VALUE 'APR04'.               
           05  FILLER                  PIC X(5)    VALUE 'MAY05'.               
           05  FILLER                  PIC X(5)    VALUE 'JUN06'.               
           05  FILLER                  PIC X(5)    VALUE 'JUL07'.               
           05  FILLER                  PIC X(5)    VALUE 'AUG08'.               
           05  FILLER                  PIC X(5)    VALUE 'SEP09'.               
           05  FILLER                  PIC X(5)    VALUE 'OCT10'.               
           05  FILLER                  PIC X(5)    VALUE 'NOV11'.               
           05  FILLER                  PIC X(5)    VALUE 'DEC12'.               
       01  WS-MTH-CONV-TABLE REDEFINES WS-MTH-CONV.                             
           05  WS-TF-MTH       OCCURS 12 TIMES INDEXED BY WS-IDX.               
               10  WS-TRAN-MM          PIC X(3).                                
               10  WS-NUM-MM           PIC X(2).                                
                                                                                
       01  WS-MONTHS-IN-DIGITS-AND-WORDS.                                       
           05 FILLER                   PIC X(12) VALUE                          
             '01  JANUARY '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '02  FEBRUARY'.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '03   MARCH  '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '04   APRIL  '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '05    MAY   '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '06   JUNE   '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '07   JULY   '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '08   AUGUST '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '09 SEPTEMBER'.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '10  OCTOBER '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '11 NOVEMBER '.                                                    
           05 FILLER                   PIC X(12) VALUE                          
             '12 DECEMBER '.                                                    
       01  FILLER  REDEFINES  WS-MONTHS-IN-DIGITS-AND-WORDS.                    
           05 WS-MONTH-TABLE               OCCURS 12                            
                                           INDEXED BY WS-MTH-IND.               
              10 WS-MONTH-IN-DIGITS    PIC X(02).                               
              10 FILLER                PIC X(01).                               
              10 WS-MONTH-IN-WORDS     PIC X(09).                               
                                                                                
      *===============================                                          
      *   LINKAGE SECTION FOR AV02C015                                          
      *===============================                                          
       01  WS-LINK-AV02C015.                                                    
           05  AV02C015-IN-POSTCODE             PIC X(6).                       
           05  AV02C015-OUT-POSTCODE-CHKSUM     PIC X(9).                       
                                                                                
       01  DJDE-LINE-NON-POD1             PIC X(85)  VALUE                      
           '$DJDE$ JDE=13C24W,JDL=BP13,FORMS=BP13JP,BFORM=BP13JQ,NUMBER=        
      -    'NO,COPIES=1,END;'.                                                  
                                                                                
       01  DJDE-LINE-NON-POD2             PIC X(85)  VALUE                      
           '$DJDE$ JDE=13C24W,JDL=BP13,FORMS=BP13J8,BFORM=BLANKF,NUMBER=        
      -    'NO,COPIES=1,END;'.                                                  
                                                                                
       01  DJDE-LINE-WY                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13WY,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-WZ                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13WZ,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-XA                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13XA,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-XB                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP13XB,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-LINE-1T                   PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT5,JDL=BP13,FORMS=BP131T,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
                                                                                
       01  DJDE-BLANKF                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BLANKF,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP13W2                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13W2,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-BP13W8                   PIC X(90) VALUE                        
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13W8,SHIFT=(0,0),NUMBER=NO,END        
      -    ';'.                                                                 
                                                                                
      *------------------------------------------------------------*            
      *        LAY-OUT FOR LETTER TO APPLICANT                     *            
      *------------------------------------------------------------*            
       01  LF68-LINE01.                                                         
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  LF68-REFNO               PIC X(15) VALUE SPACES.                 
                                                                                
       01  LF68-LINE01B.                                                        
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  LF68-NUM-REGN            PIC X(14) VALUE SPACES.                 
                                                                                
       01  LF68-LINE02.                                                         
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  LF68-DATE                PIC X(10) VALUE SPACES.                 
                                                                                
       01  LF68-LINE03.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LF68-NAME                PIC X(66) VALUE SPACES.                 
                                                                                
       01  LF68-LINE04.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LF68-NAME2               PIC X(66) VALUE SPACES.                 
                                                                                
       01  LF68-LINE05.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LF68-BLK                 PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(01) VALUE SPACES.                 
           05  LF68-ADDR-L2             PIC X(47) VALUE SPACES.                 
                                                                                
       01  LF68-LINE06.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LF68-UNIT                PIC X(11) VALUE SPACES.                 
                                                                                
       01  LF68-LINE07.                                                         
           05  FILLER                   PIC X(12) VALUE SPACES.                 
           05  LF68-ADDR-L3             PIC X(20) VALUE SPACES.                 
                                                                                
       01  LF68-LINE08.                                                         
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  LF68-BAR-CODE            PIC X(09) VALUE SPACES.                 
                                                                                
       01  LF68-LINE8A.                                                         
           05  FILLER                   PIC X(49) VALUE SPACES.                 
           05  LF68-ROOM-NO             PIC X(36) VALUE SPACES.                 
                                                                                
       01  LF68-LINE8B.                                                         
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  LF68-ESTATE              PIC X(33) VALUE SPACES.                 
                                                                                
       01  LF68-LINE8C.                                                         
           05  FILLER                   PIC X(46) VALUE SPACES.                 
           05  LF68-ROOM-NO2            PIC X(17) VALUE SPACES.                 
           05  FILLER                   PIC X(03) VALUE SPACES.                 
           05  LF68-ESTATE2             PIC X(28) VALUE SPACES.                 
                                                                                
       01  LF68-LINE8D.                                                         
           05  FILLER                   PIC X(66) VALUE SPACES.                 
           05  LF68-ESTATE3             PIC X(28) VALUE SPACES.                 
                                                                                
       01  LF68-LINE8E.                                                         
           05  FILLER                   PIC X(28) VALUE SPACES.                 
           05  LF68-GEN3-ESTATE         PIC X(28) VALUE SPACES.                 
                                                                                
       01  LF68-LINE9A.                                                         
           05  FILLER                   PIC X(40) VALUE SPACES.                 
           05  LF68-NEXT-LAUNCH-A       PIC X(08) VALUE SPACES.                 
                                                                                
       01  LF68-LINE9B.                                                         
           05  FILLER                   PIC X(73) VALUE SPACES.                 
           05  LF68-NEXT-LAUNCH-B       PIC X(08) VALUE SPACES.                 
                                                                                
       01  LF68-LINE10A.                                                        
           05  FILLER                   PIC X(61) VALUE SPACES.                 
           05  LF68-QUEUE-NO            PIC ZZZZ9.                              
                                                                                
       01  LF68-LINE10B.                                                        
           05  FILLER                   PIC X(65) VALUE SPACES.                 
           05  LF68-QUEUE-NO2           PIC ZZZZ9.                              
                                                                                
       01  LF68-LINE10C.                                                        
           05  FILLER                   PIC X(61) VALUE SPACES.                 
           05  LF68-QUEUE-NO3           PIC ZZZZ9.                              
           05  FILLER                   PIC X(17) VALUE SPACES.                 
           05  LF68-UNIT-OFFER-D        PIC ZZZ9.                               
                                                                                
       01  LF68-LINE10D-DATE.                                                   
           05  FILLER                   PIC X(54) VALUE SPACES.                 
           05  LF68-DTE-SEL             PIC X(20) VALUE SPACES.                 
                                                                                
       01  LF68-LINE10D-BE-DATE.                                                
           05  FILLER                   PIC X(53) VALUE SPACES.                 
           05  LF68-DTE-SEL-BE          PIC X(20) VALUE SPACES.                 
                                                                                
       01  LF68-LINE11A.                                                        
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  LF68-UNIT-OFFER-A        PIC ZZZ9.                               
                                                                                
       01  LF68-LINE11B.                                                        
           05  FILLER                   PIC X(28) VALUE SPACES.                 
           05  LF68-UNIT-OFFER-B        PIC ZZZ9.                               
                                                                                
       01  LF68-LINE11C.                                                        
           05  FILLER                   PIC X(21) VALUE SPACES.                 
           05  LF68-UNIT-OFFER-C        PIC ZZZ9.                               
                                                                                
       01  LF68-LINE11E.                                                        
           05  FILLER                   PIC X(44) VALUE SPACES.                 
           05  LF68-UNIT-OFFER-E        PIC ZZZ9.                               
                                                                                
       01  LF68-LINE11A-BALLOT.                                                 
           05  FILLER                   PIC X(15) VALUE SPACES.                 
           05  LF68-BALLOT-DTE          PIC X(70) VALUE SPACES.                 
                                                                                
       01  LF68-LINE11A-BALLOT2.                                                
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  LF68-BALLOT-DTE2         PIC X(79) VALUE SPACES.                 
                                                                                
       01  LF68E-LINE02A.                                                       
           05  FILLER                   PIC X(14) VALUE SPACES.                 
           05  LF68E-NAME1              PIC X(56) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LF68E-NRIC1              PIC X(9)  VALUE SPACES.                 
                                                                                
       01  LF68E-LINE02B.                                                       
           05  FILLER                   PIC X(14) VALUE SPACES.                 
           05  LF68E-NAME2              PIC X(56) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LF68E-NRIC2              PIC X(9)  VALUE SPACES.                 
                                                                                
       01  LF68E-LINE02C.                                                       
           05  FILLER                   PIC X(14) VALUE SPACES.                 
           05  LF68E-NAME3              PIC X(56) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LF68E-NRIC3              PIC X(9)  VALUE SPACES.                 
                                                                                
       01  LF68E-LINE02D.                                                       
           05  FILLER                   PIC X(14) VALUE SPACES.                 
           05  LF68E-NAME4              PIC X(56) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LF68E-NRIC4              PIC X(9)  VALUE SPACES.                 
                                                                                
      *------------------------------------------------------------*            
      *        LAY-OUT FOR CONTROL LISTING                         *            
      *------------------------------------------------------------*            
       01  LF68A-HDG1.                                                          
           05  LF68A-LISTING            PIC X(14) VALUE 'P13LF68C'.             
           05  FILLER                   PIC X(8)  VALUE 'HDB3'.                 
           05  FILLER                   PIC X(18) VALUE SPACES.                 
           05  FILLER                   PIC X(39) VALUE                         
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                   PIC X(18) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'DATE: '.               
           05  LF68A-DATE               PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE ' PAGE: '.              
           05  LF68A-PAGE               PIC ZZZZ9.                              
                                                                                
       01  LF68A-HDG2.                                                          
           05  FILLER                   PIC X(20) VALUE SPACES.                 
           05  LF68A-LISTING-TYPE       PIC X(89) VALUE SPACES.                 
                                                                                
       01  LF68A-HDG4.                                                          
           05  FILLER                   PIC X(7)  VALUE ' S/N   '.              
           05  FILLER                   PIC X(9)  VALUE 'REF-NO   '.            
           05  FILLER                   PIC X(15) VALUE                         
               'APPLICANT NAMES'.                                               
           05  FILLER                   PIC X(8)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE '  UIN  '.              
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(5)  VALUE 'CAT  '.                
           05  FILLER                   PIC X(5)  VALUE 'ALLOC'.                
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE 'FLAT'.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'HHTY   '.              
           05  FILLER                   PIC X(4)  VALUE 'MCPS'.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'RES-HA1'.              
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'SUCC'.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'NT1   '.               
           05  FILLER                   PIC X(6)  VALUE 'UNSUCC'.               
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'BALLOT'.               
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(2)  VALUE 'ZE'.                   
                                                                                
       01  LF68A-HDG5.                                                          
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE 'REGN-NO'.              
           05  FILLER                   PIC X(40) VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE 'SCH'.                  
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE 'TYPE'.                 
           05  FILLER                   PIC X(5)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE '    '.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE '       '.              
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(5)  VALUE '     '.                
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'ZONE   '.              
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE '   '.                  
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE 'ZONE'.                 
           05  FILLER                   PIC X(5)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE 'POS'.                  
           05  FILLER                   PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE 'Q-POS'.                
                                                                                
       01  LF68A-HDG6.                                                          
           05  FILLER                   PIC X(7)  VALUE '       '.              
           05  FILLER                   PIC X(9)  VALUE 'LOAN-TAG '.            
           05  FILLER                   PIC X(15) VALUE                         
               'REQ-STATUS     '.                                               
                                                                                
       01  LF68A-DTL-1.                                                         
           05  LF68A-SERIAL-NO          PIC ZZZ9.                               
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF68A-REF-NO             PIC X(8)  VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LF68A-NAME-1             PIC X(22) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LF68A-NRIC-1             PIC X(9)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF68A-CAT                PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF68A-ALLOC              PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE SPACES.                 
           05  LF68A-FLAT               PIC X(2)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  LF68A-HHTY               PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE SPACES.                 
           05  LF68A-MCPS               PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(9)  VALUE SPACES.                 
           05  LF68A-RES-HA1            PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LF68A-SUCC               PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(6)  VALUE SPACES.                 
           05  LF68A-NT1                PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(5)  VALUE SPACES.                 
           05  LF68A-UNSUCC             PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  LF68A-BALLOT-POS         PIC X(5)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF68A-ZONE               PIC X(2)  VALUE SPACES.                 
                                                                                
       01  LF68A-DTL-2.                                                         
           05  FILLER                   PIC X(7)  VALUE SPACES.                 
           05  LF68A-REGN-NO            PIC X(8)  VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LF68A-NAME-2             PIC X(22) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LF68A-NRIC-2             PIC X(9)  VALUE SPACES.                 
           05  FILLER                   PIC X(79) VALUE SPACES.                 
           05  LF68A-QUEUE              PIC X(5)  VALUE SPACES.                 
                                                                                
       01  LF68A-DTL-3.                                                         
           05  FILLER                   PIC X(16) VALUE SPACES.                 
           05  LF68A-BLK                PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LF68A-UNIT               PIC X(11) VALUE SPACES.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  LF68A-ADDR2              PIC X(65) VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF68A-ADDR3              PIC X(20) VALUE SPACES.                 
                                                                                
       01  LF68A-DTL-4.                                                         
           05  FILLER                   PIC X(4)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF68A-LOAN-TAG           PIC X(6)  VALUE SPACES.                 
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  LF68A-REQ-STATUS         PIC X(22) VALUE SPACES.                 
                                                                                
                                                                                
      *=============================================================            
       PROCEDURE DIVISION.                                                      
      *=============================================================            
       0000-MAIN-ROUTINE.                                                       
      *=============================================================            
                                                                                
           PERFORM 1000-OPEN-FILES           THRU 1000-EXIT.                    
           PERFORM 3000-PROCESS-RECORDS      THRU 3000-EXIT                     
             UNTIL WS-F740-EOF = 'Y'.                                           
           PERFORM 9000-CLOSE-ROUTINE        THRU 9000-EXIT.                    
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       1000-OPEN-FILES.                                                         
      *=============================================================            
                                                                                
           OPEN INPUT BP13F740                                                  
                      BP13K825                                                  
                      BP13K830                                                  
                      BP13K813                                                  
               OUTPUT P13LF68C                                                  
                      P13LF68D                                                  
                      P13LF68G                                                  
                      P13LF68H                                                  
                      P13LF68I                                                  
                      P13LF68Y                                                  
                      P13LF681.                                                 
                                                                                
           IF WS-K825-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'OPENING ERROR K825 STATUS ' WS-K825-STATUS               
              MOVE WS-K825-STATUS            TO RETURN-CODE                     
              PERFORM 9000-CLOSE-ROUTINE     THRU 9000-EXIT                     
           END-IF.                                                              
                                                                                
           IF WS-K830-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'OPENING ERROR K830 STATUS ' WS-K830-STATUS               
              MOVE WS-K830-STATUS            TO RETURN-CODE                     
              PERFORM 9000-CLOSE-ROUTINE     THRU 9000-EXIT                     
           END-IF.                                                              
                                                                                
           IF WS-K813-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'OPENING ERROR K813 STATUS ' WS-K813-STATUS               
              MOVE WS-K813-STATUS            TO RETURN-CODE                     
              PERFORM 9000-CLOSE-ROUTINE     THRU 9000-EXIT                     
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8)   TO WS-DATE                         
                                                WS-CURR-DATE.                   
                                                                                
           STRING WS-DD '/' WS-MM '/' WS-CCYY                                   
           DELIMITED BY SIZE INTO LF68A-DATE.                                   
                                                                                
           MOVE SPACES                   TO LF68G-PRTREC                        
                                            LF68Y-PRTREC                        
                                            LF681-PRTREC.                       
                                                                                
           MOVE SPACES           TO LF68G-PRTREC.                               
           WRITE LF68G-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO LF68G-PRTREC.                               
           WRITE LF68G-PRTREC    AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO LF68Y-PRTREC.                               
           WRITE LF68Y-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO LF68Y-PRTREC.                               
           WRITE LF68Y-PRTREC    AFTER PAGE.                                    
                                                                                
           MOVE SPACES           TO LF681-PRTREC.                               
           WRITE LF681-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.           
           MOVE SPACES           TO LF681-PRTREC.                               
           WRITE LF681-PRTREC    AFTER PAGE.                                    
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3000-PROCESS-RECORDS.                                                    
      *=============================================================            
                                                                                
           PERFORM 4000-READ-BP13F740        THRU 4000-EXIT.                    
           PERFORM 4500-MOVE-DETAILS         THRU 4500-EXIT                     
             UNTIL WS-F740-EOF = 'Y'.                                           
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4000-READ-BP13F740.                                                      
      *=============================================================            
                                                                                
            READ BP13F740                                                       
              AT END                                                            
                 MOVE 'Y'                    TO WS-F740-EOF                     
                 GO TO 4000-EXIT.                                               
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4500-MOVE-DETAILS.                                                       
      *=============================================================            
                                                                                
           MOVE SPACES                    TO K825-KEY-FLD                       
                                             LF68E-NAME1                        
                                             LF68E-NAME2                        
                                             LF68E-NAME3                        
                                             LF68E-NAME4                        
                                             LF68E-NRIC1                        
                                             LF68E-NRIC2                        
                                             LF68E-NRIC3                        
                                             LF68E-NRIC4                        
                                             LF68-NUM-REGN                      
                                             LF68-ROOM-NO                       
                                             LF68-ROOM-NO2                      
                                             LF68-BALLOT-DTE                    
                                             LF68-BALLOT-DTE2                   
                                             LF68-DTE-SEL                       
                                             LF68-DTE-SEL-BE                    
                                             WS-NUM-QUEUE-START                 
                                             WS-NUM-QUEUE-MID                   
                                             WS-NUM-QUEUE-END.                  
                                                                                
           MOVE ZEROES                 TO   WS-NUM-UNIT-OFFER                   
                                            WS-NUM-UNIT-OFFER-GEN3.             
                                                                                
           MOVE F740-NUM-REF              TO LF68-REFNO.                        
                                                                                
           MOVE F740-NUM-NT-FT-QUEUE      TO LF68-QUEUE-NO                      
                                             LF68-QUEUE-NO2                     
                                             LF68-QUEUE-NO3.                    
                                                                                
      *BP133200                                                                 
           STRING F740-CDE-SUCC-NT-ZONE DELIMITED BY SPACES                     
                  F740-CDE-FLAT-TYPE DELIMITED BY SPACES                        
                  '/' F740-NUM-REGN                                             
                  DELIMITED BY SIZE INTO LF68-NUM-REGN.                         
                                                                                
           MOVE F740-NUM-REGN          TO K825-NUM-REGN.                        
           MOVE F740-NUM-NRIC1         TO K825-NUM-NRIC.                        
                                                                                
           PERFORM  4600-READ-K825      THRU 4600-EXIT.                         
           MOVE     WS-K825-NME-OCCP      TO LF68-NAME                          
                                             LF68E-NAME1.                       
           MOVE F740-NUM-NRIC1            TO LF68E-NRIC1.                       
                                                                                
           IF F740-NUM-NRIC2 (2:1) = '#' OR SPACES OR LOW-VALUES                
              MOVE SPACES                    TO LF68-NAME2                      
                                                LF68E-NAME2                     
                                                LF68E-NRIC2                     
           ELSE                                                                 
              MOVE SPACES                    TO K825-KEY-FLD                    
              MOVE F740-NUM-REGN          TO K825-NUM-REGN                      
              MOVE F740-NUM-NRIC2            TO K825-NUM-NRIC                   
              PERFORM  4600-READ-K825        THRU 4600-EXIT                     
              MOVE     WS-K825-NME-OCCP      TO LF68-NAME2                      
                                                LF68E-NAME2                     
              MOVE F740-NUM-NRIC2            TO LF68E-NRIC2                     
           END-IF.                                                              
                                                                                
           IF F740-NUM-NRIC3 (2:1) = '#' OR SPACES OR LOW-VALUES                
              MOVE SPACES                    TO LF68E-NAME3                     
                                                LF68E-NRIC3                     
           ELSE                                                                 
              MOVE SPACES                    TO K825-KEY-FLD                    
              MOVE F740-NUM-REGN          TO K825-NUM-REGN                      
              MOVE F740-NUM-NRIC3            TO K825-NUM-NRIC                   
              PERFORM  4600-READ-K825        THRU 4600-EXIT                     
              MOVE     WS-K825-NME-OCCP      TO LF68E-NAME3                     
              MOVE F740-NUM-NRIC3            TO LF68E-NRIC3                     
           END-IF.                                                              
                                                                                
           IF F740-NUM-NRIC4 (2:1) = '#' OR SPACES OR LOW-VALUES                
              MOVE SPACES                    TO LF68E-NAME4                     
                                                LF68E-NRIC4                     
           ELSE                                                                 
              MOVE SPACES                    TO K825-KEY-FLD                    
              MOVE F740-NUM-REGN          TO K825-NUM-REGN                      
              MOVE F740-NUM-NRIC4            TO K825-NUM-NRIC                   
              PERFORM  4600-READ-K825        THRU 4600-EXIT                     
              MOVE     WS-K825-NME-OCCP      TO LF68E-NAME4                     
              MOVE F740-NUM-NRIC4            TO LF68E-NRIC4                     
           END-IF.                                                              
                                                                                
           MOVE F740-DTE-BALLOT              TO WS-DTE-BALLOT.                  
                                                                                
           EVALUATE WS-DTE-BALLOT(5:2)                                          
           WHEN 01                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'JANUARY '    F740-DTE-BALLOT(1:4)                      
                        ' Sale of Balance Flats (SBF) Exercise '                
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE                   
                                                                                
                 STRING 'FLAT APPLICATION IN JANUARY '                          
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 02                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'FEBRUARY '   F740-DTE-BALLOT(1:4)                      
                        ' Sale of Balance Flats (SBF) Exercise '                
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE                   
                                                                                
                 STRING 'FLAT APPLICATION IN FEBRUARY '                         
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 03                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'MARCH '      F740-DTE-BALLOT(1:4)                      
                        ' Sale of Balance Flats (SBF) Exercise '                
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE                   
                                                                                
                 STRING 'FLAT APPLICATION IN MARCH '                            
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 04                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'APRIL '      F740-DTE-BALLOT(1:4)                      
                        ' Sale of Balance Flats (SBF) Exercise '                
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE                   
                                                                                
                 STRING 'FLAT APPLICATION IN APRIL '                            
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 05                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'MAY '        F740-DTE-BALLOT(1:4)                      
                        ' Sale of Balance Flats (SBF) Exercise '                
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE                   
                                                                                
                 STRING 'FLAT APPLICATION IN MAY '                              
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 06                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'JUNE '       F740-DTE-BALLOT(1:4)                      
                        ' Sale of Balance Flats (SBF) Exercise '                
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE                   
                                                                                
                 STRING 'FLAT APPLICATION IN JUNE '                             
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 07                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'JULY '       F740-DTE-BALLOT(1:4)                      
                        ' Sale of Balance Flats (SBF) Exercise '                
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE                   
                                                                                
                 STRING 'FLAT APPLICATION IN JULY '                             
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 08                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'AUGUST '     F740-DTE-BALLOT(1:4)                      
                        ' Sale of Balance Flats (SBF) Exercise '                
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE                   
                                                                                
                 STRING 'FLAT APPLICATION IN AUGUST '                           
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 09                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'SEPTEMBER '  F740-DTE-BALLOT(1:4)                      
                        ' Sale of Balance Flats (SBF) Exercise '                
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE                   
                                                                                
                 STRING 'FLAT APPLICATION IN SEPTEMBER '                        
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 10                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'OCTOBER '    F740-DTE-BALLOT(1:4)                      
                        ' Sale of Balance Flats (SBF) Exercise '                
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE                   
                                                                                
                 STRING 'FLAT APPLICATION IN OCTOBER '                          
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 11                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'NOVEMBER '   F740-DTE-BALLOT(1:4)                      
                        ' Sale of Balance Flats (SBF) Exercise '                
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE                   
                                                                                
                 STRING 'FLAT APPLICATION IN NOVEMBER '                         
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE2                  
              END-IF                                                            
                                                                                
           WHEN 12                                                              
              IF F740-NUM-ALLO-CAT = 'SBF'                                      
                 STRING 'DECEMBER '   F740-DTE-BALLOT(1:4)                      
                        ' Sale of Balance Flats (SBF) Exercise '                
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE                   
                                                                                
                 STRING 'FLAT APPLICATION IN DECEMBER '                         
                        F740-DTE-BALLOT(1:4)                                    
                        ' SALE OF BALANCE FLATS (SBF) EXERCISE'                 
                 DELIMITED BY SIZE INTO       LF68-BALLOT-DTE2                  
              END-IF                                                            
           END-EVALUATE.                                                        
                                                                                
           PERFORM 7200-READ-K813            THRU 7200-EXIT.                    
           PERFORM 4800-GET-ADDR             THRU 4800-EXIT.                    
           PERFORM 7000-CHECK-SCH            THRU 7000-EXIT.                    
                                                                                
           IF K813-NUM-GEN3-TAG = 'Y'                                           
              IF F740-NUM-GEN3 = 'Y'                                            
                 CONTINUE                                                       
              ELSE                                                              
                 MOVE K813-NUM-UNIT-OFFER   TO WS-NUM-UNIT-OFFER                
                 IF K813-NUM-UNIT-OFFER-GEN3 IS NOT NUMERIC                     
                    MOVE ZEROES             TO WS-NUM-UNIT-OFFER-GEN3           
                 ELSE                                                           
                    MOVE K813-NUM-UNIT-OFFER-GEN3                               
                                            TO WS-NUM-UNIT-OFFER-GEN3           
                 END-IF                                                         
                 COMPUTE LF68-UNIT-OFFER-A = WS-NUM-UNIT-OFFER -                
                                             WS-NUM-UNIT-OFFER-GEN3             
                 MOVE LF68-UNIT-OFFER-A     TO LF68-UNIT-OFFER-B                
                                               LF68-UNIT-OFFER-C                
                                               LF68-UNIT-OFFER-D                
                                               LF68-UNIT-OFFER-E                
                                                                                
                 IF K813-NUM-QUEUE-START-MGPSGEN3 IS NOT NUMERIC                
                    MOVE ZEROES        TO K813-NUM-QUEUE-START-MGPSGEN3         
                 END-IF                                                         
                 MOVE K813-NUM-QUEUE-START-MGPSGEN3                             
                                       TO WS-NUM-QUEUE-START                    
                 IF K813-NUM-QUEUE-MID-MGPSGEN3 IS NOT NUMERIC                  
                    MOVE ZEROES        TO K813-NUM-QUEUE-MID-MGPSGEN3           
                 END-IF                                                         
                 MOVE K813-NUM-QUEUE-MID-MGPSGEN3                               
                                       TO WS-NUM-QUEUE-MID                      
                 IF K813-NUM-QUEUE-END-MGPSGEN3 IS NOT NUMERIC                  
                    MOVE ZEROES        TO K813-NUM-QUEUE-END-MGPSGEN3           
                 END-IF                                                         
                 MOVE K813-NUM-QUEUE-END-MGPSGEN3                               
                                       TO WS-NUM-QUEUE-END                      
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF F740-NUM-ALLO-CAT = 'SBF'                                         
              IF F740-CDE-FLAT-TYPE NOT = '1A'                                  
                 IF F740-NUM-GEN3 = 'Y' AND                                     
                    F740-CDE-REQUEST-STATUS = 'K'                               
                    PERFORM 6400-PRT-BP131T         THRU 6400-EXIT              
                    PERFORM 6500-PRINT-CONTROL-LIST THRU 6500-EXIT              
                    ADD 1                           TO WS-F740-READ-CTR         
                    PERFORM 4000-READ-BP13F740      THRU 4000-EXIT              
                    GO TO 4500-EXIT                                             
                 END-IF                                                         
                 IF F740-NUM-NT-FT-QUEUE = SPACES OR LOW-VALUES                 
                    PERFORM 6300-PRT-BP13XB    THRU 6300-EXIT                   
                 ELSE                                                           
                    IF F740-NUM-NT-FT-QUEUE >= WS-NUM-QUEUE-START AND           
                       F740-NUM-NT-FT-QUEUE <= WS-NUM-QUEUE-MID                 
                       PERFORM 6000-PRT-BP13WY THRU 6000-EXIT                   
                    END-IF                                                      
                                                                                
                    IF F740-NUM-NT-FT-QUEUE > WS-NUM-QUEUE-MID AND              
                       F740-NUM-NT-FT-QUEUE <= WS-NUM-QUEUE-END                 
                       PERFORM 6100-PRT-BP13WZ THRU 6100-EXIT                   
                    END-IF                                                      
                                                                                
                    IF F740-NUM-NT-FT-QUEUE > WS-NUM-QUEUE-END                  
                       PERFORM 6200-PRT-BP13XA THRU 6200-EXIT                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 6500-PRINT-CONTROL-LIST   THRU 6500-EXIT.                    
                                                                                
           ADD 1                             TO WS-F740-READ-CTR.               
           PERFORM 4000-READ-BP13F740        THRU 4000-EXIT.                    
                                                                                
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4600-READ-K825.                                                          
      *=============================================================            
                                                                                
           MOVE    SPACES                TO  WS-K825-NME-OCCP                   
           READ BP13K825.                                                       
                                                                                
           IF WS-K825-STATUS = 00 OR 02                                         
              MOVE    K825-NME-OCCP      TO  WS-K825-NME-OCCP                   
           ELSE                                                                 
           IF WS-K825-STATUS = 23                                               
              DISPLAY 'K825 REC NOT FOUND : '   K825-KEY-FLD                    
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K825 = '   WS-K825-STATUS              
                      ', K825-KEY-FLD = '   K825-KEY-FLD                        
              PERFORM 9000-CLOSE-ROUTINE   THRU 9000-EXIT.                      
                                                                                
       4600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4800-GET-ADDR.                                                           
      *=============================================================            
                                                                                
           MOVE SPACES TO LF68-LINE05                                           
                          LF68-LINE06                                           
                          LF68-LINE07                                           
                          LF68-LINE08.                                          
                                                                                
           MOVE SPACES            TO    K830-KEY-FLD.                           
                                                                                
           MOVE F740-NUM-REF      TO    K830-KEY-FLD.                           
           READ BP13K830.                                                       
                                                                                
           IF WS-K830-STATUS = 00                                               
              IF (K830-NUM-MAIL-ADDR =  SPACES OR LOW-VALUES) OR                
                 ((K830-NUM-MAIL-LVL-CHAR =  '#') AND                           
                 (K830-NUM-MAIL-LVL-NUM =  SPACES OR LOW-VALUES))               
                 MOVE K830-NUM-BLK         TO LF68-BLK                          
                 IF K830-NUM-LVL-NUM = SPACES AND                               
                    K830-NUM-HSEMAIN = SPACES                                   
                    MOVE SPACES            TO LF68-UNIT                         
                 ELSE                                                           
                    MOVE K830-NUM-FLAT     TO LF68-UNIT                         
                 END-IF                                                         
                 MOVE K830-NME-STREET-BLDG(1:47) TO LF68-ADDR-L2                
                 IF K830-NUM-POSTAL  = SPACES OR LOW-VALUES OR ZEROES           
                    MOVE SPACES            TO LF68-ADDR-L3                      
                    DISPLAY ' RES POSTAL CDE IS ' K830-NUM-POSTAL               
                            ' FOR REC KEY-FLD ' K830-KEY-FLD                    
                 ELSE                                                           
                    STRING 'SINGAPORE '  K830-NUM-POSTAL                        
                       DELIMITED BY SIZE INTO LF68-ADDR-L3                      
                 END-IF                                                         
      *------ TO GET THE BAR CODE ------                                        
                 MOVE SPACES                    TO WS-LINK-AV02C015             
                 MOVE K830-NUM-POSTAL           TO AV02C015-IN-POSTCODE         
                 PERFORM 4950-CALL-AV02C015     THRU 4950-EXIT                  
                 MOVE AV02C015-OUT-POSTCODE-CHKSUM TO LF68-BAR-CODE             
              ELSE                                                              
                 MOVE K830-NUM-MAIL-BLK        TO LF68-BLK                      
                 IF K830-NUM-MAIL-LVL-NUM = SPACES AND                          
                    K830-NUM-MAIL-HSEMAIN = SPACES                              
                    MOVE SPACES                TO LF68-UNIT                     
                 ELSE                                                           
                    MOVE K830-NUM-MAIL-FLAT    TO LF68-UNIT                     
                 END-IF                                                         
                 MOVE K830-NME-MAIL-STR-BLDG(1:47) TO LF68-ADDR-L2              
                 IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR ZEROS        
                    MOVE SPACES                TO LF68-ADDR-L3                  
                    DISPLAY ' MAIL POSTAL CDE IS ' K830-NUM-POSTAL              
                            ' FOR REC KEY-FLD ' K830-KEY-FLD                    
                 ELSE                                                           
                    STRING 'SINGAPORE '      K830-NUM-MAIL-POSTAL               
                           DELIMITED BY SIZE INTO LF68-ADDR-L3                  
                 END-IF                                                         
      *------ TO GET THE BAR CODE ------                                        
                                                                                
                 MOVE SPACES                    TO WS-LINK-AV02C015             
                 MOVE K830-NUM-MAIL-POSTAL      TO AV02C015-IN-POSTCODE         
                 PERFORM 4950-CALL-AV02C015     THRU 4950-EXIT                  
                 MOVE AV02C015-OUT-POSTCODE-CHKSUM TO LF68-BAR-CODE             
              END-IF                                                            
           ELSE                                                                 
           IF WS-K830-STATUS = 23                                               
              MOVE SPACES TO LF68-LINE05                                        
                             LF68-LINE06                                        
                             LF68-LINE07                                        
                             LF68-LINE08                                        
              DISPLAY 'BP13K830 RECORD NOT FOUND = ' WS-K830-STATUS             
                      ',  K830-KEY-FLD IS ' K830-KEY-FLD                        
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K830 = ' WS-K830-STATUS                
                      ',  K830-KEY-FLD IS ' K830-KEY-FLD                        
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT.                        
                                                                                
       4800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4950-CALL-AV02C015.                                                      
      *=============================================================            
                                                                                
           CALL 'AV02C015'          USING                                       
                                    AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM.               
       4950-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6000-PRT-BP13WY.                                                         
      *=============================================================            
      *** For non-SA applications with queue position within ***                
      *** 100% of flat supply                                ***                
                                                                                
            ADD   1               TO    WS-LF68Y-WRT-CTR.                       
            MOVE  SPACES          TO    LF68Y-PRTREC.                           
            MOVE WS-LF68Y-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-WY(49:4).                     
            WRITE LF68Y-PRTREC    FROM  DJDE-LINE-WY     AFTER PAGE.            
                                                                                
            MOVE  SPACES          TO    LF68Y-PRTREC.                           
            WRITE LF68Y-PRTREC          AFTER PAGE.                             
            WRITE LF68Y-PRTREC    FROM  LF68-LINE01          AFTER 1.           
            WRITE LF68Y-PRTREC    FROM  LF68-LINE02.                            
            WRITE LF68Y-PRTREC    FROM  LF68-LINE03          AFTER 5.           
            WRITE LF68Y-PRTREC    FROM  LF68-LINE04.                            
            WRITE LF68Y-PRTREC    FROM  LF68-LINE05.                            
            WRITE LF68Y-PRTREC    FROM  LF68-LINE06.                            
            WRITE LF68Y-PRTREC    FROM  LF68-LINE07.                            
            WRITE LF68Y-PRTREC    FROM  LF68-LINE08          AFTER 3.           
            WRITE LF68Y-PRTREC    FROM  LF68-LINE11A-BALLOT2 AFTER 6.           
                                                                                
            WRITE LF68Y-PRTREC    FROM  LF68-LINE8A          AFTER 2.           
            WRITE LF68Y-PRTREC    FROM  LF68-LINE8B          AFTER 1.           
            WRITE LF68Y-PRTREC    FROM  LF68-LINE10A         AFTER 2.           
            WRITE LF68Y-PRTREC    FROM  LF68-LINE11A         AFTER 1.           
            WRITE LF68Y-PRTREC    FROM  LF68-LINE10D-DATE    AFTER 2.           
                                                                                
            MOVE SPACES           TO    LF68Y-PRTREC                            
                                        DJDE-LINE-WY(49:4)                      
            IF (F740-CDE-ALLOC-SCH = 'FTS' OR 'STS') OR                         
               (F740-CDE-ALLOC-SCH = 'SAP' AND                                  
               (F740-CDE-REQ-ALLOC-SCH = 'FTS' OR 'STS'))                       
               WRITE LF68Y-PRTREC FROM  DJDE-BP13W8        AFTER PAGE           
            ELSE                                                                
               WRITE LF68Y-PRTREC FROM  DJDE-BP13W2        AFTER PAGE           
            END-IF.                                                             
            MOVE SPACES           TO    LF68Y-PRTREC.                           
            WRITE LF68Y-PRTREC    AFTER 5.                                      
            MOVE SPACES           TO LF68Y-PRTREC.                              
            WRITE LF68Y-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO LF68Y-PRTREC.                              
            WRITE LF68Y-PRTREC    AFTER PAGE.                                   
                                                                                
            MOVE SPACES           TO LF68Y-PRTREC.                              
            WRITE LF68Y-PRTREC    FROM DJDE-LINE-NON-POD2  AFTER PAGE.          
            MOVE SPACES           TO LF68Y-PRTREC.                              
            WRITE LF68Y-PRTREC    AFTER PAGE.                                   
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6100-PRT-BP13WZ.                                                         
      *=============================================================            
      *** For non-SA applications with queue position within ***                
      *** 200% of flat supply                                ***                
                                                                                
            ADD   1               TO    WS-LF681-WRT-CTR.                       
            MOVE  SPACES          TO    LF681-PRTREC.                           
            MOVE WS-LF681-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-WZ(49:4).                     
            WRITE LF681-PRTREC    FROM  DJDE-LINE-WZ  AFTER PAGE.               
                                                                                
            MOVE  SPACES          TO    LF681-PRTREC.                           
            WRITE LF681-PRTREC    AFTER PAGE.                                   
                                                                                
            WRITE LF681-PRTREC    FROM  LF68-LINE01    AFTER 1.                 
            WRITE LF681-PRTREC    FROM  LF68-LINE02.                            
            WRITE LF681-PRTREC    FROM  LF68-LINE03    AFTER 5.                 
            WRITE LF681-PRTREC    FROM  LF68-LINE04.                            
            WRITE LF681-PRTREC    FROM  LF68-LINE05.                            
            WRITE LF681-PRTREC    FROM  LF68-LINE06.                            
            WRITE LF681-PRTREC    FROM  LF68-LINE07.                            
            WRITE LF681-PRTREC    FROM  LF68-LINE08    AFTER 3.                 
            WRITE LF681-PRTREC    FROM  LF68-LINE11A-BALLOT2 AFTER 6.           
                                                                                
            WRITE LF681-PRTREC    FROM  LF68-LINE8A          AFTER 2.           
            WRITE LF681-PRTREC    FROM  LF68-LINE8B          AFTER 1.           
            WRITE LF681-PRTREC    FROM  LF68-LINE10A         AFTER 2.           
            WRITE LF681-PRTREC    FROM  LF68-LINE11C         AFTER 1.           
            WRITE LF681-PRTREC    FROM  LF68-LINE10D-DATE    AFTER 3.           
                                                                                
            MOVE SPACES           TO    LF681-PRTREC                            
                                        DJDE-LINE-WZ(49:4)                      
            IF (F740-CDE-ALLOC-SCH = 'FTS' OR 'STS') OR                         
               (F740-CDE-ALLOC-SCH = 'SAP' AND                                  
               (F740-CDE-REQ-ALLOC-SCH = 'FTS' OR 'STS'))                       
               WRITE LF681-PRTREC FROM  DJDE-BP13W8        AFTER PAGE           
            ELSE                                                                
               WRITE LF681-PRTREC FROM  DJDE-BP13W2        AFTER PAGE           
            END-IF.                                                             
            MOVE SPACES           TO    LF681-PRTREC                            
            WRITE LF681-PRTREC    AFTER 5.                                      
            MOVE SPACES           TO LF681-PRTREC.                              
            WRITE LF681-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO LF681-PRTREC.                              
            WRITE LF681-PRTREC                             AFTER PAGE.          
                                                                                
            MOVE SPACES           TO LF681-PRTREC.                              
            WRITE LF681-PRTREC    FROM DJDE-LINE-NON-POD2  AFTER PAGE.          
            MOVE SPACES           TO LF681-PRTREC.                              
            WRITE LF681-PRTREC                             AFTER PAGE.          
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6200-PRT-BP13XA.                                                         
      *=============================================================            
      *** For non-SA applications with queue position within ***                
      *** 300% of flat supply                                ***                
                                                                                
            ADD   1               TO    WS-LF68G-WRT-CTR.                       
            MOVE  SPACES          TO    LF68G-PRTREC.                           
            MOVE WS-LF68G-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-XA(49:4).                     
            WRITE LF68G-PRTREC    FROM  DJDE-LINE-XA  AFTER PAGE.               
                                                                                
            MOVE  SPACES          TO    LF68G-PRTREC.                           
            WRITE LF68G-PRTREC    AFTER PAGE.                                   
            WRITE LF68G-PRTREC    FROM  LF68-LINE01    AFTER 1.                 
            WRITE LF68G-PRTREC    FROM  LF68-LINE02.                            
            WRITE LF68G-PRTREC    FROM  LF68-LINE03    AFTER 5.                 
            WRITE LF68G-PRTREC    FROM  LF68-LINE04.                            
            WRITE LF68G-PRTREC    FROM  LF68-LINE05.                            
            WRITE LF68G-PRTREC    FROM  LF68-LINE06.                            
            WRITE LF68G-PRTREC    FROM  LF68-LINE07.                            
            WRITE LF68G-PRTREC    FROM  LF68-LINE08    AFTER 3.                 
            WRITE LF68G-PRTREC    FROM  LF68-LINE11A-BALLOT2 AFTER 6.           
                                                                                
            WRITE LF68G-PRTREC    FROM  LF68-LINE8A          AFTER 2.           
            WRITE LF68G-PRTREC    FROM  LF68-LINE8B          AFTER 1.           
            WRITE LF68G-PRTREC    FROM  LF68-LINE10C         AFTER 2.           
                                                                                
            MOVE SPACES           TO    LF68G-PRTREC                            
                                        DJDE-LINE-XA(49:4)                      
            IF (F740-CDE-ALLOC-SCH = 'FTS' OR 'STS') OR                         
               (F740-CDE-ALLOC-SCH = 'SAP' AND                                  
               (F740-CDE-REQ-ALLOC-SCH = 'FTS' OR 'STS'))                       
               WRITE LF68G-PRTREC FROM  DJDE-BP13W8        AFTER PAGE           
            ELSE                                                                
               WRITE LF68G-PRTREC FROM  DJDE-BP13W2        AFTER PAGE           
            END-IF.                                                             
            MOVE SPACES           TO    LF68G-PRTREC                            
            WRITE LF68G-PRTREC    AFTER 5.                                      
            MOVE SPACES           TO LF68G-PRTREC.                              
            WRITE LF68G-PRTREC    FROM DJDE-LINE-NON-POD1  AFTER PAGE.          
            MOVE SPACES           TO LF68G-PRTREC.                              
            WRITE LF68G-PRTREC                             AFTER PAGE.          
                                                                                
            MOVE SPACES           TO LF68G-PRTREC.                              
            WRITE LF68G-PRTREC    FROM DJDE-LINE-NON-POD2  AFTER PAGE.          
            MOVE SPACES           TO LF68G-PRTREC.                              
            WRITE LF68G-PRTREC                             AFTER PAGE.          
                                                                                
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6300-PRT-BP13XB.                                                         
      *=============================================================            
      *** For non-SA applications with queue position within ***                
      *** > 300% of flat supply                              ***                
                                                                                
            ADD   1               TO    WS-LF68H-WRT-CTR.                       
            MOVE  SPACES          TO    LF68H-PRTREC.                           
            MOVE WS-LF68H-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-XB(49:4).                     
            WRITE LF68H-PRTREC    FROM  DJDE-LINE-XB  AFTER PAGE.               
                                                                                
            MOVE  SPACES          TO    LF68H-PRTREC.                           
            WRITE LF68H-PRTREC    AFTER PAGE.                                   
            WRITE LF68H-PRTREC    FROM  LF68-LINE01    AFTER 1.                 
            WRITE LF68H-PRTREC    FROM  LF68-LINE02.                            
            WRITE LF68H-PRTREC    FROM  LF68-LINE03    AFTER 5.                 
            WRITE LF68H-PRTREC    FROM  LF68-LINE04.                            
            WRITE LF68H-PRTREC    FROM  LF68-LINE05.                            
            WRITE LF68H-PRTREC    FROM  LF68-LINE06.                            
            WRITE LF68H-PRTREC    FROM  LF68-LINE07.                            
            WRITE LF68H-PRTREC    FROM  LF68-LINE08    AFTER 3.                 
            WRITE LF68H-PRTREC    FROM  LF68-LINE11A-BALLOT2 AFTER 6.           
                                                                                
            WRITE LF68H-PRTREC    FROM  LF68-LINE8A          AFTER 2.           
            WRITE LF68H-PRTREC    FROM  LF68-LINE8B          AFTER 1.           
                                                                                
            MOVE SPACES           TO    LF68H-PRTREC                            
                                        DJDE-LINE-XB(49:4)                      
            WRITE LF68H-PRTREC    FROM  DJDE-BLANKF        AFTER PAGE.          
            MOVE SPACES           TO    LF68H-PRTREC                            
            WRITE LF68H-PRTREC    AFTER PAGE.                                   
                                                                                
       6300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6400-PRT-BP131T.                                                         
      *=============================================================            
      *** PA - 3GEN FLAT ***                                                    
                                                                                
            ADD   1               TO    WS-LF68I-WRT-CTR.                       
            MOVE  SPACES          TO    LF68I-PRTREC.                           
            MOVE WS-LF68I-WRT-CTR TO    WS-RECORD-CNT.                          
            MOVE WS-RECORD-CNT    TO    DJDE-LINE-1T(49:4).                     
            WRITE LF68I-PRTREC    FROM  DJDE-LINE-1T  AFTER PAGE.               
                                                                                
            MOVE  SPACES          TO    LF68I-PRTREC.                           
            WRITE LF68I-PRTREC    AFTER PAGE.                                   
            WRITE LF68I-PRTREC    FROM  LF68-LINE01   AFTER 1.                  
            WRITE LF68I-PRTREC    FROM  LF68-LINE02.                            
            WRITE LF68I-PRTREC    FROM  LF68-LINE03   AFTER 5.                  
            WRITE LF68I-PRTREC    FROM  LF68-LINE04.                            
            WRITE LF68I-PRTREC    FROM  LF68-LINE05.                            
            WRITE LF68I-PRTREC    FROM  LF68-LINE06.                            
            WRITE LF68I-PRTREC    FROM  LF68-LINE07.                            
            WRITE LF68I-PRTREC    FROM  LF68-LINE08   AFTER 3.                  
            WRITE LF68I-PRTREC    FROM  LF68-LINE11A-BALLOT2 AFTER 6.           
                                                                                
            WRITE LF68I-PRTREC    FROM  LF68-LINE8A   AFTER 2.                  
            WRITE LF68I-PRTREC    FROM  LF68-LINE8B   AFTER 1.                  
            WRITE LF68I-PRTREC    FROM  LF68-LINE10B  AFTER 2.                  
            WRITE LF68I-PRTREC    FROM  LF68-LINE11E  AFTER 1.                  
            WRITE LF68I-PRTREC    FROM  LF68-LINE8E   AFTER 5.                  
                                                                                
            MOVE SPACES           TO    LF68I-PRTREC                            
                                        DJDE-LINE-1T(49:4)                      
            WRITE LF68I-PRTREC    FROM  DJDE-BLANKF   AFTER PAGE.               
            MOVE SPACES           TO    LF68I-PRTREC                            
            WRITE LF68I-PRTREC    AFTER PAGE.                                   
                                                                                
       6400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6500-PRINT-CONTROL-LIST.                                                 
      *=============================================================            
      *    PRINT CONTROL LISTING FOR SUCCESSFUL APPLICANTS                      
      *-------------------------------------------------------------            
                                                                                
           MOVE F740-NUM-REF              TO    LF68A-REF-NO.                   
           MOVE F740-NUM-REGN             TO    LF68A-REGN-NO.                  
           MOVE LF68-NAME                 TO    LF68A-NAME-1.                   
           MOVE F740-NUM-NRIC1            TO    LF68A-NRIC-1.                   
           MOVE F740-CDE-NT1              TO    LF68A-NT1.                      
           MOVE F740-CDE-HOUSEHOLD        TO    LF68A-HHTY.                     
           MOVE F740-NUM-MCPS             TO    LF68A-MCPS.                     
           MOVE F740-CDE-RESIDENT-HA1     TO    LF68A-RES-HA1.                  
           MOVE F740-CDE-FLAT-TYPE        TO    LF68A-FLAT.                     
           MOVE F740-CDE-ALLOC-SCH        TO    LF68A-ALLOC.                    
           MOVE F740-CDE-UNSUCC           TO    LF68A-UNSUCC.                   
           MOVE F740-CDE-CATEGORY         TO    LF68A-CAT.                      
           MOVE F740-CDE-SUCC-NT-ZONE     TO    LF68A-SUCC.                     
           MOVE F740-CDE-ZONE             TO    LF68A-ZONE.                     
           MOVE LF68-NAME2                TO    LF68A-NAME-2.                   
           IF F740-NUM-NRIC2 (2:1) NOT = '#'                                    
              MOVE F740-NUM-NRIC2         TO    LF68A-NRIC-2                    
           ELSE                                                                 
              MOVE SPACES                 TO    LF68A-NRIC-2.                   
           MOVE F740-NUM-NT-FT-QUEUE      TO    LF68A-QUEUE.                    
           MOVE F740-NUM-BALLOT-POSITION  TO    LF68A-BALLOT-POS.               
           MOVE F740-NUM-LOAN-TAG         TO    LF68A-LOAN-TAG.                 
           MOVE F740-CDE-REQUEST-STATUS   TO    LF68A-REQ-STATUS.               
                                                                                
      *-----------> PREPARE ADDRESS FOR BP13L089A CONTROL LIST                  
           MOVE SPACES                    TO    LF68A-DTL-3.                    
           MOVE LF68-BLK                  TO    LF68A-BLK.                      
           MOVE LF68-UNIT                 TO    LF68A-UNIT.                     
           MOVE LF68-ADDR-L2              TO    LF68A-ADDR2.                    
           MOVE LF68-ADDR-L3              TO    LF68A-ADDR3.                    
           MOVE LF68-ADDR-L3              TO    LF68A-ADDR3.                    
                                                                                
      * BP133380                                                                
           IF F740-NUM-ALLO-CAT = 'SBF'                                         
              IF (F740-NUM-NT-FT-QUEUE = SPACES OR LOW-VALUES) OR               
                 (F740-NUM-GEN3 = 'Y' AND F740-CDE-REQUEST-STATUS = 'K')        
                 STRING 'CONTROL LIST FOR UNSUCCESSFUL LETTERS W/O '            
                        'EMAIL ADDRESSES (APPLICATION BEYOND 300%)'             
                 DELIMITED BY SIZE INTO LF68A-LISTING-TYPE                      
                 PERFORM 6700-PRINT-CONTROL-UNSUCC THRU 6700-EXIT               
              ELSE                                                              
                 STRING 'CONTROL LIST FOR SUCCESSFUL LETTERS W/O EMAIL '        
                        'ADDRESSES (APPLICATION WITHIN 300%)'                   
                 DELIMITED BY SIZE INTO LF68A-LISTING-TYPE                      
                 PERFORM 6600-PRINT-CONTROL-SUCC   THRU 6600-EXIT               
              END-IF                                                            
           END-IF.                                                              
                                                                                
       6500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       6600-PRINT-CONTROL-SUCC.                                                 
      **************************************************************            
                                                                                
           MOVE 'P13LF68C'             TO LF68A-LISTING.                        
           ADD    1                    TO    WS-CNT-LETTERS-SUCC.               
           MOVE   WS-CNT-LETTERS-SUCC  TO    LF68A-SERIAL-NO.                   
                                                                                
           IF WS-CNT-LINE-LF68C > WS2-MAX-LINES-LF68C                           
              ADD   1                  TO   WS-CNT-PAGE-LF68C                   
              MOVE  1                  TO   WS-CNT-LINE-LF68C                   
              MOVE  WS-CNT-PAGE-LF68C  TO   LF68A-PAGE                          
              WRITE LF68C-PRTREC       FROM LF68A-HDG1 AFTER PAGE               
                                                                                
              WRITE LF68C-PRTREC       FROM LF68A-HDG2 AFTER 1                  
              WRITE LF68C-PRTREC       FROM LF68A-HDG4 AFTER 2                  
              WRITE LF68C-PRTREC       FROM LF68A-HDG5 AFTER 1                  
              WRITE LF68C-PRTREC       FROM LF68A-HDG6 AFTER 1                  
                                                                                
              MOVE  SPACES             TO   LF68C-PRTREC                        
              WRITE LF68C-PRTREC                                                
           END-IF.                                                              
                                                                                
           WRITE   LF68C-PRTREC         FROM  LF68A-DTL-1 AFTER 1.              
           WRITE   LF68C-PRTREC         FROM  LF68A-DTL-2 AFTER 1.              
           WRITE   LF68C-PRTREC         FROM  LF68A-DTL-3 AFTER 1.              
           WRITE   LF68C-PRTREC         FROM  LF68A-DTL-4 AFTER 1.              
           MOVE    SPACES               TO    LF68C-PRTREC.                     
           WRITE   LF68C-PRTREC.                                                
           ADD     4                    TO    WS-CNT-LINE-LF68C.                
                                                                                
       6600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       6700-PRINT-CONTROL-UNSUCC.                                               
      **************************************************************            
                                                                                
           MOVE 'P13LF68D'             TO LF68A-LISTING.                        
           ADD    1                    TO    WS-CNT-LETTERS-UNSUCC.             
           MOVE   WS-CNT-LETTERS-UNSUCC  TO    LF68A-SERIAL-NO.                 
                                                                                
           IF WS-CNT-LINE-LF68D > WS2-MAX-LINES-LF68D                           
              ADD   1                  TO   WS-CNT-PAGE-LF68D                   
              MOVE  1                  TO   WS-CNT-LINE-LF68D                   
              MOVE  WS-CNT-PAGE-LF68D  TO   LF68A-PAGE                          
              WRITE LF68D-PRTREC       FROM LF68A-HDG1 AFTER PAGE               
                                                                                
              WRITE LF68D-PRTREC       FROM LF68A-HDG2 AFTER 1                  
              WRITE LF68D-PRTREC       FROM LF68A-HDG4 AFTER 2                  
              WRITE LF68D-PRTREC       FROM LF68A-HDG5 AFTER 1                  
                                                                                
              MOVE  SPACES             TO   LF68D-PRTREC                        
              WRITE LF68D-PRTREC                                                
           END-IF.                                                              
                                                                                
           WRITE   LF68D-PRTREC         FROM  LF68A-DTL-1 AFTER 1.              
           WRITE   LF68D-PRTREC         FROM  LF68A-DTL-2 AFTER 1.              
           WRITE   LF68D-PRTREC         FROM  LF68A-DTL-3 AFTER 1.              
           MOVE    SPACES               TO    LF68D-PRTREC.                     
           WRITE   LF68D-PRTREC.                                                
           ADD     4                    TO    WS-CNT-LINE-LF68D.                
                                                                                
       6700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       7000-CHECK-SCH.                                                          
      **************************************************************            
                                                                                
           SET WS-ALLOC-PTR TO 1.                                               
                                                                                
           SEARCH WS-ALLOC-SCH                                                  
               AT END MOVE 'XXX' TO WS-ALLOCSCH-TYPE                            
             WHEN F740-CDE-ALLOC-SCH = WS-ALLOC-SCH-DESP(WS-ALLOC-PTR)          
             MOVE WS-MAIN-SCH-CD(WS-ALLOC-PTR) TO WS-ALLOCSCH-TYPE.             
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       7200-READ-K813.                                                          
      **************************************************************            
                                                                                
           MOVE SPACES                       TO K813-KEY-FLD.                   
           MOVE F740-CDE-NT1                 TO K813-NUM-ZONE.                  
           MOVE F740-CDE-FLAT-TYPE           TO K813-NUM-FLAT-TYPE.             
           MOVE F740-DTE-BALLOT              TO K813-DTE-BALLOT.                
                                                                                
           READ BP13K813.                                                       
                                                                                
           EVALUATE WS-K813-STATUS                                              
           WHEN ZEROES                                                          
              MOVE K813-NME-PROJECT-LTR      TO LF68-ESTATE                     
                                                LF68-ESTATE2                    
                                                LF68-ESTATE3                    
                                                LF68-GEN3-ESTATE                
                                                                                
              MOVE K813-TXT-SEL-PERIOD-LTR   TO LF68-DTE-SEL                    
                                                LF68-DTE-SEL-BE                 
                                                                                
              STRING K813-DTE-LETTER-PRINT (7:2) '/'                            
                     K813-DTE-LETTER-PRINT (5:2) '/'                            
                     K813-DTE-LETTER-PRINT(1:4)                                 
              DELIMITED BY SIZE INTO LF68-DATE                                  
                                                                                
              MOVE K813-NUM-UNIT-OFFER       TO LF68-UNIT-OFFER-A               
                                                LF68-UNIT-OFFER-B               
                                                LF68-UNIT-OFFER-C               
                                                LF68-UNIT-OFFER-D               
                                                LF68-UNIT-OFFER-E               
                                                                                
              MOVE K813-TXT-NEXT-LAUNCH-LTR  TO LF68-NEXT-LAUNCH-A              
                                                LF68-NEXT-LAUNCH-B              
                                                                                
              MOVE K813-NUM-QUEUE-START      TO WS-NUM-QUEUE-START              
              MOVE K813-NUM-QUEUE-MID        TO WS-NUM-QUEUE-MID                
              MOVE K813-NUM-QUEUE-END        TO WS-NUM-QUEUE-END                
                                                                                
              MOVE K813-NME-FLAT-TYPE-LTR    TO LF68-ROOM-NO                    
                                                LF68-ROOM-NO2                   
                                                                                
           WHEN 23                                                              
              CONTINUE                                                          
                                                                                
           WHEN OTHER                                                           
              MOVE WS-K813-STATUS            TO RETURN-CODE                     
              DISPLAY 'BP13K813 READ ERROR,STATUS ' WS-K813-STATUS              
              PERFORM 9000-CLOSE-ROUTINE     THRU 9000-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       7200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       9000-CLOSE-ROUTINE.                                                      
      **************************************************************            
                                                                                
           DISPLAY ' '.                                                         
           DISPLAY ' ====  BP13CF68 CONTROL TOTALS  ======'.                    
           DISPLAY ' '.                                                         
           DISPLAY ' F740 RECORDS READ          : ' WS-F740-READ-CTR.           
           DISPLAY ' NON-SA WITHIN 100% (BP13WY): ' WS-LF68Y-WRT-CTR.           
           DISPLAY ' NON-SA WITHIN 200% (BP13WZ): ' WS-LF681-WRT-CTR.           
           DISPLAY ' NON-SA WITHIN 300% (BP13XA): ' WS-LF68G-WRT-CTR.           
           DISPLAY ' NON-SA BEYOND 300% (BP13XB): ' WS-LF68H-WRT-CTR.           
           DISPLAY ' 3GEN FLAT          (BP131T): ' WS-LF68I-WRT-CTR.           
           DISPLAY ' '.                                                         
           DISPLAY ' ====================================='.                    
                                                                                
           CLOSE BP13F740                                                       
                 BP13K825                                                       
                 BP13K830                                                       
                 BP13K813                                                       
                 P13LF68C                                                       
                 P13LF68D                                                       
                 P13LF68G                                                       
                 P13LF68H                                                       
                 P13LF68I                                                       
                 P13LF68Y                                                       
                 P13LF681.                                                      
                                                                                
           IF WS-K825-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'CLOSING ERROR BP13K825-STAT ' WS-K825-STATUS             
           END-IF.                                                              
                                                                                
           IF WS-K830-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'CLOSING ERROR BP13K830-STAT ' WS-K830-STATUS             
           END-IF.                                                              
                                                                                
           IF WS-K813-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'CLOSING ERROR BP13K813-STAT ' WS-K813-STATUS             
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
                                                                                
