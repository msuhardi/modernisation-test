       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CD56.                                                 
      *AUTHOR.        JIANG BO.                                                 
      *DATE-WRITTEN.  23/10/08.                                                 
      * ========================================================== *            
      * SYSTEM OF COMMITMENT  (BP13)                               *            
      * ========================================================== *            
      *                                                            *            
      *  OBJECTIVE   : print renovation notice for dbss flats      *            
      *              :                                             *            
      *  INPUT FILES : 1.  BP13K800  -                             *            
      *                2.  BP13K820  -                             *            
      *                3.  BP13K830  -                             *            
      *                6.  BM06F120  -                             *            
      *                                                            *            
      *  LETTERS     : 1.  BP13PD56  -(BP13IM,BP13IN,BP13IP,BP13IQ)*            
      *  REPORT      : 1.  BP13LD56  -                             *            
      *                                                            *            
      * ---------------------------------------------------------- *            
      * CHG REF  BY    DATE    DESCRIPTION                         *            
      * -------- ---- -------- -----------                         *            
      * BP133505 JB8  20081023 NEW PROGRAM.                        *            
      * BP134124 ZDD1 20110405 REALIGNMENT FOR FORM REVISIONS      *            
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
      *-------------------------------------------------------------            
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BM06F120  ASSIGN        TO BM06F120.                          
           SELECT SY02F001  ASSIGN        TO SY02F001.                          
                                                                                
           SELECT BP13KB20  ASSIGN        TO BP13KB20                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS KB20-KEY-FLD                       
                            FILE STATUS   IS WS-KB20-STATUS.                    
                                                                                
           SELECT BP13K800  ASSIGN        TO BP13K800                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K800-NUM-REGN                      
                            FILE STATUS   IS WS-K800-STATUS.                    
                                                                                
           SELECT BP13K820  ASSIGN        TO BP13K820                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K820-KEY-FLD                       
                            FILE STATUS   IS WS-K820-STATUS.                    
                                                                                
           SELECT BP13K830  ASSIGN        TO BP13K830                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K830-KEY-FLD                       
                            ALTERNATE KEY IS K830-NUM-REGN                      
                            FILE STATUS   IS WS-K830-STATUS.                    
                                                                                
           SELECT BP13PD56  ASSIGN        TO BP13PD56.                          
           SELECT BP13LD56  ASSIGN        TO BP13LD56.                          
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       COPY SY02F001.                                                           
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BM06F120                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 700 CHARACTERS.                                     
       COPY BM06F120.                                                           
                                                                                
       FD   BP13KB20                                                            
            RECORD CONTAINS 3300 CHARACTERS.                                    
       COPY BP13KB20.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD   BP13K830                                                            
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD  BP13LD56                                                             
           RECORDING MODE  IS  F.                                               
       01  LD56-PRTREC                      PIC X(132).                         
                                                                                
       FD  BP13PD56                                                             
           RECORDING MODE  IS  F.                                               
       01  BP13PD56-PRTREC                  PIC X(100).                         
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
                                                                                
       01  WS-STATUS.                                                           
           05  WS-KB20-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K800-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K820-STATUS               PIC 99    VALUE ZEROS.              
           05  WS-K830-STATUS               PIC 99    VALUE ZEROS.              
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-F120-READ-CTR             PIC 9(06)  VALUE ZEROS.             
           05  WS-PD56-WRT-CTR              PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-PAGE-LD56             PIC 9(04)  VALUE ZEROS.             
           05  WS-CNT-LINE-LD56             PIC 9(06)  VALUE ZEROS.             
           05  WS-CNT-CUR-LINE              PIC 9(02)  VALUE 56.                
           05  WS-RECORD-CNT                PIC ZZZ9.                           
           05  WS-CTR                       PIC 9(03)  VALUE ZEROS.             
           05  WS-CNT                       PIC 9(03)  VALUE ZEROS.             
           05  WS-CNT2                      PIC 9(03)  VALUE ZEROS.             
           05  WS-SKIP                      PIC 9(06)  VALUE ZEROS.             
           05  WS-K800-FND                  PIC 9(06)  VALUE ZEROS.             
           05  WS-K800-NOTFND               PIC 9(06)  VALUE ZEROS.             
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-K820-NME-OCCP             PIC X(66) VALUE SPACES.             
           05  WS-K820-NME-HA1              PIC X(66) VALUE SPACES.             
           05  WS-F001-EOF                  PIC X(1)  VALUE 'N'.                
               88 EOF-F001                            VALUE 'Y'.                
           05  WS-EOF-F120                  PIC X(1)  VALUE 'N'.                
           05  WS-RETCODE                   PIC S9(8)                           
                                            SIGN IS LEADING SEPARATE.           
                                                                                
       01  WS-DATE-VARIABLES.                                                   
           05  WS-DATE.                                                         
               10  WS-CCYY                  PIC 9(4)  VALUE 0000.               
               10  WS-MM                    PIC 99    VALUE 00.                 
               10  WS-DD                    PIC 99    VALUE 00.                 
           05  WS-CURR-DATE                 PIC 9(8)  VALUE ZEROES.             
                                                                                
       01  WS-FORM-VARIABLES.                                                   
           05  WS-NUM-REGN                  PIC X(08)    VALUE SPACES.          
           05  WS-NUM-SCH-ACC               PIC X(14)    VALUE SPACES.          
           05  WS-NUM-DATE                  PIC X(10)    VALUE SPACES.          
           05  WS-NUM-SERIAL                PIC X(04)    VALUE SPACES.          
           05  WS-NAME-HA1                  PIC X(66)    VALUE SPACES.          
           05  WS-NRIC-HA1                  PIC X(09)    VALUE SPACES.          
           05  WS-CPF-HA1                   PIC X(09)    VALUE SPACES.          
           05  WS-NAME-HA2                  PIC X(66)    VALUE SPACES.          
           05  WS-NRIC-HA2                  PIC X(09)    VALUE SPACES.          
           05  WS-NAME-HA3                  PIC X(66)    VALUE SPACES.          
           05  WS-NRIC-HA3                  PIC X(09)    VALUE SPACES.          
           05  WS-NAME-HA4                  PIC X(66)    VALUE SPACES.          
           05  WS-NRIC-HA4                  PIC X(09)    VALUE SPACES.          
           05  WS-CPF-HA2                   PIC X(09)    VALUE SPACES.          
           05  WS-K830-BLK                  PIC X(10)    VALUE SPACES.          
           05  WS-K830-FLAT                 PIC X(11)    VALUE SPACES.          
           05  WS-K830-ADDR-L2              PIC X(47)    VALUE SPACES.          
           05  WS-K830-ADDR-L3              PIC X(20)    VALUE SPACES.          
           05  WS-BAR-CODE                  PIC X(09)    VALUE SPACES.          
           05  WS-PIDB-STREET               PIC X(47)    VALUE SPACES.          
           05  WS-PIDB-ADDRESS              PIC X(37)    VALUE SPACES.          
           05  WS-PIDB-ADDRESS2             PIC X(89)    VALUE SPACES.          
           05  WS-PIDB-BLK                  PIC X(05)    VALUE SPACES.          
           05  WS-PIDB-LEVEL                PIC X(02)    VALUE SPACES.          
           05  WS-PIDB-UNIT                 PIC X(04)    VALUE SPACES.          
           05  WS-DTE-SO-APPT               PIC X(16)    VALUE SPACES.          
           05  WS-TME-SO-APPT               PIC X(05)    VALUE SPACES.          
           05  WS-WEEK                      PIC X(03)    VALUE SPACES.          
                                                                                
       01  DJDE-LINE-IM                   PIC X(80)  VALUE                      
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13IM,NUMBER=(0000,29,65,3),END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-LINE-IN                   PIC X(80)  VALUE                      
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13IN,NUMBER=NO,END;'.                 
                                                                                
       01  DJDE-LINE-IP                   PIC X(80)  VALUE                      
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13IP,NUMBER=(0000,29,65,3),END        
      -    ';'.                                                                 
                                                                                
       01  DJDE-LINE-IQ                   PIC X(80)  VALUE                      
           '$DJDE$ PMODE=PORTRAIT,FORMS=BP13IQ,NUMBER=NO,END;'.                 
                                                                                
      *-----------------------------------------------------------*             
      * COMMAREA FOR CALLING AB20C900                                           
      *-----------------------------------------------------------*             
       COPY AB20M97C.                                                           
      *-----------------------------------------------------------*             
      * BP13C913 PARAMETERS                                                     
      *-----------------------------------------------------------*             
       01  WS-LINK-REC.                                                         
           05 WS-LINK-NUM-SCH-ACC.                                              
              10 WS-LINK-NUM-SCH       PIC X(4).                                
              10 WS-LINK-NUM-ACC       PIC X(5).                                
       COPY P13COMM8.                                                           
      *-----------------------------------------------------------*             
      *   LINKAGE SECTION FOR AV02C015                                          
      *-----------------------------------------------------------*             
       01  WS-LINK-AV02C015.                                                    
           05  AV02C015-IN-POSTCODE             PIC X(6).                       
           05  AV02C015-OUT-POSTCODE-CHKSUM     PIC X(9).                       
                                                                                
      *-----------------------------------------------------------              
      *  COMMAREA FOR CALLING AV02C001                                          
      *-----------------------------------------------------------              
       COPY AV02COMM.                                                           
                                                                                
      *------------------------------------------------------------*            
      *        LAY-OUT FOR LETTER BP13IK                           *            
      *------------------------------------------------------------*            
       01  PD56-LINE01.                                                         
           05  FILLER                   PIC X(28) VALUE SPACES.                 
           05  PD56-NUM-REGN            PIC X(08) VALUE SPACES.                 
                                                                                
       01  PD56-LINE01A.                                                        
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  PD56-NUM-SCH-ACC         PIC X(14) VALUE SPACES.                 
                                                                                
       01  PD56-LINE02.                                                         
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  PD56-DATE                PIC X(10) VALUE SPACES.                 
                                                                                
       01  PD56-LINE02-DTE.                                                     
           05  FILLER                   PIC X(17) VALUE SPACES.                 
           05  PD56-DATEA               PIC X(10) VALUE SPACES.                 
                                                                                
       01  PD56-LINE02A.                                                        
           05  FILLER                   PIC X(72) VALUE SPACES.                 
           05  PD56-SERIAL              PIC X(06) VALUE SPACES.                 
                                                                                
       01  PD56-LINE03.                                                         
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  PD56-NAME                PIC X(66) VALUE SPACES.                 
                                                                                
       01  PD56-LINE04.                                                         
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  PD56-NAME2               PIC X(66) VALUE SPACES.                 
                                                                                
       01  PD56-LINE04A.                                                        
           05  FILLER                   PIC X(17) VALUE SPACES.                 
           05  PD56-NAME3               PIC X(66) VALUE SPACES.                 
                                                                                
       01  PD56-LINE04B.                                                        
           05  FILLER                   PIC X(17) VALUE SPACES.                 
           05  PD56-NAME4               PIC X(66) VALUE SPACES.                 
                                                                                
       01  PD56-LINE05.                                                         
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  PD56-BLK                 PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(01) VALUE SPACES.                 
           05  PD56-UNIT                PIC X(11) VALUE SPACES.                 
                                                                                
       01  PD56-LINE06.                                                         
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  PD56-ADDR-L2             PIC X(47) VALUE SPACES.                 
                                                                                
       01  PD56-LINE07.                                                         
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  PD56-ADDR-L3             PIC X(20) VALUE SPACES.                 
                                                                                
       01  PD56-LINE08.                                                         
           05  FILLER                   PIC X(10) VALUE SPACES.                 
           05  PD56-BAR-CODE            PIC X(09) VALUE SPACES.                 
                                                                                
       01  PD56-LINE09.                                                         
           05  FILLER                   PIC X(77) VALUE SPACES.                 
           05  FILLER                   PIC X(04) VALUE 'BLK '.                 
           05  PD56-PIDB-BLK            PIC X(05) VALUE SPACES.                 
           05  FILLER                   PIC X(03) VALUE ' # '.                  
           05  PD56-PIDB-LEVEL          PIC X(02) VALUE SPACES.                 
           05  FILLER                   PIC X(02) VALUE ' -'.                   
           05  PD56-PIDB-UNIT           PIC X(04) VALUE SPACES.                 
                                                                                
       01  PD56-LINE09A.                                                        
           05  FILLER                   PIC X(11) VALUE SPACES.                 
           05  PD56-PIDB-ADDR2          PIC X(89) VALUE SPACES.                 
                                                                                
       01  PD56-LINE10A.                                                        
           05  FILLER                   PIC X(19) VALUE SPACES.                 
           05  PD56-HA1-NAME            PIC X(25) VALUE SPACES.                 
           05  FILLER                   PIC X(14) VALUE SPACES.                 
           05  PD56-HA2-NAME            PIC X(25) VALUE SPACES.                 
                                                                                
       01  PD56-LINE10B.                                                        
           05  FILLER                   PIC X(19) VALUE SPACES.                 
           05  PD56-HA1-NRIC            PIC X(25) VALUE SPACES.                 
           05  FILLER                   PIC X(14) VALUE SPACES.                 
           05  PD56-HA2-NRIC            PIC X(25) VALUE SPACES.                 
                                                                                
       01  PD56-LINE10C.                                                        
           05  FILLER                   PIC X(19) VALUE SPACES.                 
           05  PD56-HA3-NAME            PIC X(25) VALUE SPACES.                 
           05  FILLER                   PIC X(14) VALUE SPACES.                 
           05  PD56-HA4-NAME            PIC X(25) VALUE SPACES.                 
                                                                                
       01  PD56-LINE10D.                                                        
           05  FILLER                   PIC X(19) VALUE SPACES.                 
           05  PD56-HA3-NRIC            PIC X(25) VALUE SPACES.                 
           05  FILLER                   PIC X(14) VALUE SPACES.                 
           05  PD56-HA4-NRIC            PIC X(25) VALUE SPACES.                 
                                                                                
       01  PD56-LINE10E.                                                        
           05  FILLER                   PIC X(24) VALUE SPACES.                 
           05  PD56-ADD-BP13IN          PIC X(66) VALUE SPACES.                 
                                                                                
       01  PD56-LINE11A.                                                        
           05  FILLER                   PIC X(69) VALUE SPACES.                 
           05  PD56-DTE-SO-APPT         PIC X(16) VALUE SPACES.                 
                                                                                
       01  PD56-LINE11B.                                                        
           05  FILLER                   PIC X(19) VALUE SPACES.                 
           05  PD56-TME-SO-APPT         PIC X(05) VALUE SPACES.                 
                                                                                
      *------------------------------------------------------------*            
      *        LAY-OUT FOR CONTROL LISTING                         *            
      *------------------------------------------------------------*            
       01  LD56-HDG1.                                                           
           05  LD56-LISTING             PIC X(14) VALUE 'BP13LD56'.             
           05  FILLER                   PIC X(8)  VALUE 'HDB3'.                 
           05  FILLER                   PIC X(18) VALUE SPACES.                 
           05  FILLER                   PIC X(39) VALUE                         
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                   PIC X(18) VALUE SPACES.                 
           05  FILLER                   PIC X(7)  VALUE 'DATE: '.               
           05  LD56-DATE                PIC X(10) VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE ' PAGE: '.              
           05  LD56-PAGE                PIC ZZZZ9.                              
                                                                                
       01  LD56-HDG2.                                                           
           05  FILLER                   PIC X(41) VALUE SPACES.                 
           05  FILLER                   PIC X(25) VALUE                         
               'CONTROL LIST FOR LETTERS '.                                     
           05  FILLER                   PIC X(26) VALUE                         
               'TO BUYER BEFORE NVP SERVED'.                                    
                                                                                
       01  LD56-HDG3.                                                           
           05  FILLER                   PIC X(5)  VALUE ' S/NO'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE 'REG NO  '.             
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(5)  VALUE 'BLK  '.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(28) VALUE                         
                                                  'STREET (TRANCATED)'.         
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(08) VALUE 'HSE NO'.               
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(29) VALUE                         
                                                  'NAME (TRANCATED)'.           
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(09) VALUE 'NRIC'.                 
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
                                                                                
       01  LD56-HDG4.                                                           
           05  FILLER                   PIC X(5)  VALUE ALL '-'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(8)  VALUE ALL '-'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(5)  VALUE ALL '-'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(28) VALUE ALL '-'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(08) VALUE ALL '-'.                
           05  FILLER                   PIC X(3)  VALUE SPACES.                 
           05  FILLER                   PIC X(29) VALUE ALL '-'.                
           05  FILLER                   PIC X(1)  VALUE SPACES.                 
           05  FILLER                   PIC X(09) VALUE ALL '-'.                
                                                                                
       01  LD56-DTL.                                                            
           05  LD56-SNO                 PIC ZZZZ9 VALUE ZEROES.                 
           05  FILLER                   PIC X(1).                               
           05  LD56-NUM-REGN            PIC X(08) VALUE SPACES.                 
           05  FILLER                   PIC X(1).                               
           05  LD56-NUM-BLK             PIC X(05) VALUE SPACES.                 
           05  FILLER                   PIC X(1).                               
           05  LD56-NME-STREET          PIC X(28) VALUE SPACES.                 
           05  FILLER                   PIC X(1).                               
           05  LD56-NUM-HSE-NO          PIC X(08) VALUE SPACES.                 
           05  FILLER                   PIC X(3).                               
           05  LD56-HA1-NAME            PIC X(29) VALUE SPACES.                 
           05  FILLER                   PIC X(1).                               
           05  LD56-HA1-NRIC            PIC X(09) VALUE SPACES.                 
           05  FILLER                   PIC X(1).                               
                                                                                
      *=============================================================            
       PROCEDURE DIVISION.                                                      
      *=============================================================            
       0000-MAIN-ROUTINE.                                                       
      *=============================================================            
                                                                                
           PERFORM 1000-OPEN-FILES             THRU 1000-EXIT.                  
           PERFORM 3000-PROCESS-MATCH          THRU 3000-EXIT                   
             UNTIL WS-EOF-F120 = 'Y'.                                           
           PERFORM 9000-CLOSE-ROUTINE          THRU 9000-EXIT.                  
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *=============================================================            
       1000-OPEN-FILES.                                                         
      *=============================================================            
           OPEN INPUT BP13K800                                                  
                      SY02F001                                                  
                      BP13KB20                                                  
                      BP13K820                                                  
                      BM06F120                                                  
                      BP13K830                                                  
               OUTPUT BP13PD56                                                  
                      BP13LD56.                                                 
                                                                                
           IF WS-KB20-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR KB20 STATUS ' WS-KB20-STATUS               
              MOVE     WS-KB20-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K800 STATUS ' WS-K800-STATUS               
              MOVE     WS-K800-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K820-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K820 STATUS ' WS-K820-STATUS               
              MOVE     WS-K820-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           IF WS-K830-STATUS NOT = 00 AND 97                                    
              DISPLAY 'OPENING ERROR K830 STATUS ' WS-K830-STATUS               
              MOVE     WS-K830-STATUS TO RETURN-CODE                            
              PERFORM 9000-CLOSE-ROUTINE.                                       
                                                                                
           READ SY02F001 AT END MOVE 'Y'  TO WS-F001-EOF.                       
           IF EOF-F001                                                          
              DISPLAY 'RECORD NOT FOUND IN SY01F001 '                           
              DISPLAY 'PROCESSING TERMINATED '                                  
              GO TO 9000-CLOSE-ROUTINE                                          
           ELSE                                                                 
              MOVE F001-DTE-CURRENT      TO   WS-DATE WS-CURR-DATE              
           END-IF.                                                              
      *    STRING WS-DD '/'                                                     
      *           WS-MM '/'                                                     
      *           WS-CCYY DELIMITED BY SIZE                                     
      *           INTO WS-NUM-DATE.                                             
           MOVE '21/04/2011'     TO WS-NUM-DATE.                                
                                                                                
           MOVE DJDE-LINE-IM     TO BP13PD56-PRTREC.                            
           WRITE BP13PD56-PRTREC AFTER PAGE.                                    
           MOVE SPACES           TO BP13PD56-PRTREC.                            
           WRITE BP13PD56-PRTREC AFTER 5.                                       
                                                                                
           MOVE DJDE-LINE-IN     TO BP13PD56-PRTREC.                            
           WRITE BP13PD56-PRTREC AFTER PAGE.                                    
           MOVE SPACES           TO BP13PD56-PRTREC.                            
           WRITE BP13PD56-PRTREC AFTER 5.                                       
                                                                                
           PERFORM 2000-READ-BM06F120  THRU 2000-EXIT.                          
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       2000-READ-BM06F120.                                                      
      *=============================================================            
                                                                                
            READ BM06F120 AT END                                                
                 MOVE HIGH-VALUES TO F120-REGN-NO                               
                 MOVE 'Y'         TO WS-EOF-F120                                
                 GO TO 2000-EXIT.                                               
                                                                                
            ADD  1  TO WS-F120-READ-CTR.                                        
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3000-PROCESS-MATCH.                                                      
      *=============================================================            
                                                                                
           IF F120-REGN-NO NOT = SPACES AND LOW-VALUES                          
              PERFORM 3100-READ-BP13K800         THRU 3100-EXIT                 
              IF WS-K800-STATUS = 00                                            
                 PERFORM 3500-PROCESS-RECORDS    THRU 3500-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 2000-READ-BM06F120            THRU 2000-EXIT.                
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3100-READ-BP13K800.                                                      
      *=============================================================            
                                                                                
           MOVE SPACES                   TO  BP13K800-MASTER.                   
           INITIALIZE                        BP13K800-MASTER.                   
                                                                                
           MOVE F120-REGN-NO             TO  K800-NUM-REGN.                     
                                                                                
           READ BP13K800.                                                       
                                                                                
           IF WS-K800-STATUS = 00                                               
              ADD 1 TO WS-K800-FND                                              
           ELSE                                                                 
              IF WS-K800-STATUS = 23                                            
                 ADD 1 TO WS-K800-NOTFND                                        
              ELSE                                                              
                 DISPLAY 'ERROR READING BP13K800 = ' WS-K800-STATUS             
                         ', K800-KEY-FLD = ' K800-NUM-REGN                      
                 PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                      
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       3500-PROCESS-RECORDS.                                                    
      *=============================================================            
                                                                                
           INITIALIZE     PD56-LINE01 PD56-LINE02 PD56-LINE03                   
                          PD56-LINE04 PD56-LINE05 PD56-LINE06                   
                          PD56-LINE07 PD56-LINE08 PD56-LINE09.                  
                                                                                
           PERFORM 6100-GET-WEEK          THRU 6100-EXIT.                       
                                                                                
           MOVE K800-NUM-REGN            TO WS-NUM-REGN                         
           STRING K800-NUM-SCH '-'                                              
                  K800-NUM-ACC '-'                                              
                  K800-NUM-ACC-CK '-'                                           
                  K800-NUM-LESSEE-CODE                                          
              DELIMITED BY SIZE INTO WS-NUM-SCH-ACC                             
           IF K800-DTE-SO-APPT NOT = SPACES AND LOW-VALUES AND ZEROES           
              STRING K800-DTE-SO-APPT(7:2) '/'                                  
                     K800-DTE-SO-APPT(5:2) '/'                                  
                     K800-DTE-SO-APPT(1:4) ' ('                                 
                     WS-WEEK               ')'                                  
                     DELIMITED BY SIZE INTO WS-DTE-SO-APPT                      
              END-STRING                                                        
           ELSE                                                                 
              MOVE SPACES  TO WS-DTE-SO-APPT                                    
           END-IF                                                               
                                                                                
           IF K800-TME-SO-APPT NOT = SPACES AND LOW-VALUES AND ZEROES           
              STRING K800-TME-SO-APPT(1:2) ':' K800-TME-SO-APPT(3:2)            
                    DELIMITED BY SIZE INTO WS-TME-SO-APPT                       
              END-STRING                                                        
           ELSE                                                                 
              MOVE SPACES  TO WS-TME-SO-APPT                                    
           END-IF                                                               
                                                                                
      *GET NAME OF HA1                                                          
           MOVE K800-NUM-REGN            TO K820-NUM-REGN                       
           MOVE K800-NUM-NRIC1           TO K820-NUM-NRIC WS-NRIC-HA1.          
           PERFORM 4600-READ-K820      THRU 4600-EXIT                           
           MOVE WS-K820-NME-OCCP         TO WS-NAME-HA1                         
           MOVE K820-NUM-CPF             TO WS-CPF-HA1.                         
      *GET NAME OF HA2                                                          
           IF K800-NUM-NRIC2  = SPACES OR LOW-VALUES                            
              MOVE SPACES                TO WS-NAME-HA2   WS-NRIC-HA2           
           ELSE                                                                 
              MOVE K800-NUM-NRIC2        TO K820-NUM-NRIC WS-NRIC-HA2           
              PERFORM 4600-READ-K820   THRU 4600-EXIT                           
              MOVE WS-K820-NME-OCCP      TO WS-NAME-HA2                         
              MOVE K820-NUM-CPF          TO WS-CPF-HA2                          
           END-IF.                                                              
                                                                                
      *GET NAME OF HA3                                                          
           IF K800-NUM-NRIC3  = SPACES OR LOW-VALUES                            
              MOVE SPACES                TO WS-NAME-HA3   WS-NRIC-HA3           
           ELSE                                                                 
              MOVE K800-NUM-NRIC3        TO K820-NUM-NRIC WS-NRIC-HA3           
              PERFORM 4600-READ-K820   THRU 4600-EXIT                           
              MOVE WS-K820-NME-OCCP      TO WS-NAME-HA3                         
           END-IF.                                                              
                                                                                
      *GET NAME OF HA4                                                          
           IF K800-NUM-NRIC4  = SPACES OR LOW-VALUES                            
              MOVE SPACES                TO WS-NAME-HA4   WS-NRIC-HA4           
           ELSE                                                                 
              MOVE K800-NUM-NRIC4        TO K820-NUM-NRIC WS-NRIC-HA4           
              PERFORM 4600-READ-K820   THRU 4600-EXIT                           
              MOVE WS-K820-NME-OCCP      TO WS-NAME-HA4                         
           END-IF.                                                              
                                                                                
           PERFORM 4800-GET-ADDR          THRU 4800-EXIT.                       
           PERFORM 5000-READ-BP13KB20     THRU 5000-EXIT.                       
           PERFORM 6000-READ-PIDB         THRU 6000-EXIT.                       
                                                                                
           PERFORM 7000-PRT-LETTER        THRU 7000-EXIT                        
           PERFORM 8000-PRN-CNTRL-LIST    THRU 8000-EXIT.                       
                                                                                
       3500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4600-READ-K820.                                                          
      *=============================================================            
           MOVE    SPACES                TO  WS-K820-NME-OCCP                   
           READ BP13K820.                                                       
                                                                                
           IF WS-K820-STATUS = 00 OR 02                                         
              MOVE    K820-NME-OCCP      TO  WS-K820-NME-OCCP                   
           ELSE                                                                 
           IF WS-K820-STATUS = 23                                               
              DISPLAY 'K820 REC NOT FOUND : '   K820-KEY-FLD                    
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K820 = '   WS-K820-STATUS              
                      ', K820-KEY-FLD = '   K820-KEY-FLD                        
              PERFORM 9000-CLOSE-ROUTINE   THRU 9000-EXIT.                      
                                                                                
       4600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4800-GET-ADDR.                                                           
      *=============================================================            
                                                                                
           MOVE K800-NUM-REGN TO K830-NUM-REGN                                  
           READ BP13K830  KEY IS K830-NUM-REGN.                                 
                                                                                
           IF WS-K830-STATUS = 00                                               
              IF (K830-NUM-MAIL-ADDR =  SPACES OR LOW-VALUES) OR                
                 ((K830-NUM-MAIL-LVL-CHAR =  '#') AND                           
                 (K830-NUM-MAIL-LVL-NUM =  SPACES OR LOW-VALUES))               
                 MOVE K830-NUM-BLK         TO WS-K830-BLK                       
                 IF K830-NUM-LVL-NUM = SPACES AND                               
                    K830-NUM-HSEMAIN = SPACES                                   
                    MOVE SPACES            TO WS-K830-FLAT                      
                 ELSE                                                           
                    MOVE K830-NUM-FLAT     TO WS-K830-FLAT                      
                 END-IF                                                         
                 MOVE K830-NME-STREET-BLDG(1:47) TO WS-K830-ADDR-L2             
                 IF K830-NUM-POSTAL  = SPACES OR LOW-VALUES OR ZEROES           
                    MOVE SPACES            TO WS-K830-ADDR-L3                   
                    DISPLAY ' RES POSTAL CDE IS ' K830-NUM-POSTAL               
                            ' FOR REC KEY-FLD ' K830-KEY-FLD                    
                 ELSE                                                           
                    STRING 'SINGAPORE '  K830-NUM-POSTAL                        
                       DELIMITED BY SIZE INTO WS-K830-ADDR-L3                   
                 END-IF                                                         
      *------ TO GET THE BAR CODE ------                                        
                 MOVE SPACES                    TO WS-LINK-AV02C015             
                 MOVE K830-NUM-POSTAL           TO AV02C015-IN-POSTCODE         
                 PERFORM 4850-CALL-AV02C015     THRU 4850-EXIT                  
                 MOVE AV02C015-OUT-POSTCODE-CHKSUM TO WS-BAR-CODE               
                                                                                
              ELSE                                                              
                 MOVE K830-NUM-MAIL-BLK        TO WS-K830-BLK                   
                 IF K830-NUM-MAIL-LVL-NUM = SPACES AND                          
                    K830-NUM-MAIL-HSEMAIN = SPACES                              
                    MOVE SPACES                TO WS-K830-FLAT                  
                 ELSE                                                           
                    MOVE K830-NUM-MAIL-FLAT    TO WS-K830-FLAT                  
                 END-IF                                                         
                 MOVE K830-NME-MAIL-STR-BLDG(1:47) TO WS-K830-ADDR-L2           
                 IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR ZEROS        
                    MOVE SPACES                TO WS-K830-ADDR-L3               
                    DISPLAY ' MAIL POSTAL CDE IS ' K830-NUM-POSTAL              
                            ' FOR REC KEY-FLD ' K830-KEY-FLD                    
                 ELSE                                                           
                    STRING 'SINGAPORE '      K830-NUM-MAIL-POSTAL               
                           DELIMITED BY SIZE INTO WS-K830-ADDR-L3               
                 END-IF                                                         
      *------ TO GET THE BAR CODE ------                                        
                 MOVE SPACES                    TO WS-LINK-AV02C015             
                 MOVE K830-NUM-MAIL-POSTAL      TO AV02C015-IN-POSTCODE         
                 PERFORM 4850-CALL-AV02C015     THRU 4850-EXIT                  
                 MOVE AV02C015-OUT-POSTCODE-CHKSUM TO WS-BAR-CODE               
              END-IF                                                            
                                                                                
           ELSE                                                                 
           IF WS-K830-STATUS = 23                                               
              MOVE SPACES    TO WS-K830-BLK      WS-K830-FLAT                   
                                WS-K830-ADDR-L2  WS-K830-ADDR-L3                
                                WS-BAR-CODE                                     
              DISPLAY 'BP13K830 RECORD NOT FOUND = ' WS-K830-STATUS             
                      ',  K830-KEY-FLD IS ' K830-NUM-REGN                       
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K830 = ' WS-K830-STATUS                
                      ',  K830-KEY-FLD IS ' K830-NUM-REGN                       
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT.                        
                                                                                
       4800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       4850-CALL-AV02C015.                                                      
      *=============================================================            
                                                                                
           CALL 'AV02C015'          USING                                       
                                    AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM.               
       4850-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       5000-READ-BP13KB20.                                                      
      *=============================================================            
                                                                                
           MOVE SPACES                         TO BP13KB20-REC.                 
           INITIALIZE                             BP13KB20-REC.                 
                                                                                
           MOVE K800-NUM-REGN                  TO KB20-NUM-REGN.                
                                                                                
           READ BP13KB20.                                                       
                                                                                
           EVALUATE WS-KB20-STATUS                                              
              WHEN 00                                                           
                 MOVE KB20-NUM-SERIAL          TO WS-NUM-SERIAL                 
              WHEN 23                                                           
                 MOVE SPACES                   TO WS-NUM-SERIAL                 
              WHEN OTHER                                                        
                 DISPLAY 'BP13KB20 - ERROR READING : ' WS-KB20-STATUS           
                 GO TO 9000-CLOSE-ROUTINE                                       
           END-EVALUATE.                                                        
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6000-READ-PIDB.                                                          
      *-------------------------------------------------------------            
                                                                                
           MOVE SPACES                         TO WS-PIDB-ADDRESS               
                                                  WS-PIDB-BLK                   
                                                  WS-PIDB-LEVEL                 
                                                  WS-PIDB-UNIT.                 
           MOVE F120-BLK-NO                   TO WS-PIDB-BLK                    
           MOVE F120-LEVEL-NO                 TO WS-PIDB-LEVEL                  
           MOVE F120-MAIN-UNIT                TO WS-PIDB-UNIT                   
           MOVE F120-STREET-NAME              TO WS-PIDB-STREET.                
           STRING 'BLK ' F120-BLK-NO                                            
                  ' #' F120-LEVEL-NO  '-' F120-MAIN-UNIT                        
                  ' BISHAN ST 24 SINGAPORE '                                    
                  F120-POSTAL-CODE                                              
                  ' (the "UNIT")'                                               
              DELIMITED BY SIZE INTO WS-PIDB-ADDRESS2.                          
                                                                                
      *    STRING 'BLK ' F120-BLK-NO                                            
      *           ' #' F120-LEVEL-NO  '-' F120-MAIN-UNIT                        
      *           'SIMEI LANE SINGAPORE '                                       
      *           F120-POSTAL-CODE                                              
      *       DELIMITED BY SIZE INTO PD56-ADD-BP13IN.                           
           MOVE SPACES   TO PD56-ADD-BP13IN.                                    
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       6100-GET-WEEK.                                                           
      *=============================================================            
                                                                                
           MOVE K800-DTE-SO-APPT      TO WS-IN-DATE.                            
           MOVE 'DW'                  TO WS-IN-OPTION.                          
                                                                                
           CALL 'AV02C001'          USING LINK-REC.                             
                                                                                
           MOVE WS-RETURN             TO WS-WEEK.                               
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7000-PRT-LETTER.                                                         
      *=============================================================            
                                                                                
            PERFORM 7500-MOVE-VALUES   THRU 7500-EXIT.                          
            ADD   1               TO    WS-PD56-WRT-CTR.                        
      * WRITE BP13IM                                                            
            MOVE WS-PD56-WRT-CTR  TO WS-RECORD-CNT.                             
            MOVE WS-RECORD-CNT    TO DJDE-LINE-IM(44:4).                        
            MOVE DJDE-LINE-IM     TO BP13PD56-PRTREC                            
            WRITE BP13PD56-PRTREC AFTER PAGE.                                   
            MOVE SPACES           TO BP13PD56-PRTREC.                           
            WRITE BP13PD56-PRTREC AFTER PAGE.                                   
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE01A AFTER 5.                   
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE01.                            
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE02A.                           
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE02-DATE AFTER 5                
            WRITE BP13PD56-PRTREC FROM  PD56-LINE02-DTE AFTER 1.                
            WRITE BP13PD56-PRTREC FROM  PD56-LINE01.                            
            WRITE BP13PD56-PRTREC FROM  PD56-LINE03 AFTER 4.                    
            WRITE BP13PD56-PRTREC FROM  PD56-LINE04.                            
            WRITE BP13PD56-PRTREC FROM  PD56-LINE05 AFTER 2.                    
            WRITE BP13PD56-PRTREC FROM  PD56-LINE06.                            
            WRITE BP13PD56-PRTREC FROM  PD56-LINE07.                            
            WRITE BP13PD56-PRTREC FROM  PD56-LINE08 AFTER 3.                    
            WRITE BP13PD56-PRTREC FROM  PD56-LINE09A AFTER 6.                   
      * WRITE BP13IN                                                            
            MOVE DJDE-LINE-IN     TO BP13PD56-PRTREC                            
            WRITE BP13PD56-PRTREC AFTER PAGE.                                   
            MOVE SPACES           TO BP13PD56-PRTREC.                           
            WRITE BP13PD56-PRTREC FROM  PD56-LINE10E AFTER 47.                  
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE10A AFTER 51.                  
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE10B AFTER 2.                   
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE10C AFTER 5.                   
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE10D AFTER 2.                   
      * WRITE BP13IP                                                            
      *     MOVE WS-PD56-WRT-CTR  TO WS-RECORD-CNT.                             
      *     MOVE WS-RECORD-CNT    TO DJDE-LINE-IP(44:4).                        
      *     MOVE DJDE-LINE-IP     TO BP13PD56-PRTREC.                           
      *     WRITE BP13PD56-PRTREC AFTER PAGE.                                   
      *     MOVE SPACES TO BP13PD56-PRTREC.                                     
      *     WRITE BP13PD56-PRTREC AFTER PAGE.                                   
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE01A AFTER 2.                   
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE01.                            
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE02A.                           
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE03 AFTER 2.                    
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE04.                            
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE05.                            
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE06.                            
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE07.                            
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE08 AFTER 4.                    
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE09 AFTER 6.                    
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE11A AFTER 5.                   
      *     WRITE BP13PD56-PRTREC FROM  PD56-LINE11B.                           
      * WRITE BP13IQ                                                            
      *     MOVE DJDE-LINE-IQ     TO BP13PD56-PRTREC                            
      *     WRITE BP13PD56-PRTREC AFTER PAGE.                                   
      *     MOVE SPACES           TO BP13PD56-PRTREC.                           
      *     WRITE BP13PD56-PRTREC AFTER 5.                                      
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       7500-MOVE-VALUES.                                                        
      *=============================================================            
                                                                                
           MOVE WS-NUM-REGN          TO PD56-NUM-REGN.                          
           MOVE WS-NUM-DATE          TO PD56-DATE                               
                                        PD56-DATEA.                             
           MOVE WS-NUM-SCH-ACC       TO PD56-NUM-SCH-ACC.                       
           MOVE WS-NUM-SERIAL        TO PD56-SERIAL.                            
           MOVE WS-NAME-HA1          TO PD56-NAME  PD56-HA1-NAME                
           MOVE WS-NRIC-HA1          TO PD56-HA1-NRIC                           
           MOVE WS-NAME-HA2          TO PD56-NAME2 PD56-HA2-NAME                
           MOVE WS-NRIC-HA2          TO PD56-HA2-NRIC                           
           MOVE WS-NAME-HA3          TO PD56-HA3-NAME PD56-NAME3                
           MOVE WS-NRIC-HA3          TO PD56-HA3-NRIC                           
           MOVE WS-NAME-HA4          TO PD56-HA4-NAME PD56-NAME4                
           MOVE WS-NRIC-HA4          TO PD56-HA4-NRIC                           
           MOVE WS-K830-BLK          TO PD56-BLK                                
           MOVE WS-K830-FLAT         TO PD56-UNIT                               
           MOVE WS-K830-ADDR-L2      TO PD56-ADDR-L2                            
           MOVE WS-K830-ADDR-L3      TO PD56-ADDR-L3                            
           MOVE WS-BAR-CODE          TO PD56-BAR-CODE                           
           MOVE WS-PIDB-BLK          TO PD56-PIDB-BLK                           
           MOVE WS-PIDB-LEVEL        TO PD56-PIDB-LEVEL                         
           MOVE WS-PIDB-UNIT         TO PD56-PIDB-UNIT                          
           MOVE WS-PIDB-ADDRESS2     TO PD56-PIDB-ADDR2.                        
           MOVE WS-DTE-SO-APPT       TO PD56-DTE-SO-APPT.                       
           MOVE WS-TME-SO-APPT       TO PD56-TME-SO-APPT.                       
                                                                                
       7500-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *=============================================================            
       8000-PRN-CNTRL-LIST.                                                     
      *=============================================================            
                                                                                
           INITIALIZE LD56-DTL.                                                 
                                                                                
           MOVE WS-NUM-REGN               TO LD56-NUM-REGN                      
           MOVE WS-PIDB-BLK               TO LD56-NUM-BLK                       
           MOVE WS-PIDB-STREET            TO LD56-NME-STREET                    
           MOVE WS-NAME-HA1               TO LD56-HA1-NAME                      
           MOVE WS-NRIC-HA1               TO LD56-HA1-NRIC                      
           STRING '#' WS-PIDB-LEVEL '-' WS-PIDB-UNIT                            
              DELIMITED BY SIZE INTO LD56-NUM-HSE-NO                            
                                                                                
           ADD 1                          TO WS-CNT-LINE-LD56.                  
           ADD 1                          TO WS-CNT-CUR-LINE.                   
           MOVE WS-CNT-LINE-LD56          TO LD56-SNO                           
           IF WS-CNT-CUR-LINE > 55                                              
              ADD 1                       TO WS-CNT-PAGE-LD56                   
              MOVE WS-CNT-PAGE-LD56       TO LD56-PAGE                          
              MOVE WS-NUM-DATE            TO LD56-DATE                          
              WRITE LD56-PRTREC FROM LD56-HDG1 AFTER PAGE                       
              WRITE LD56-PRTREC FROM LD56-HDG2 AFTER 2                          
              WRITE LD56-PRTREC FROM LD56-HDG3 AFTER 3                          
              WRITE LD56-PRTREC FROM LD56-HDG4                                  
              MOVE 7                      TO WS-CNT-CUR-LINE                    
           END-IF                                                               
                                                                                
           WRITE LD56-PRTREC FROM LD56-DTL.                                     
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **************************************************************            
       9000-CLOSE-ROUTINE.                                                      
      **************************************************************            
           DISPLAY ' '.                                                         
           DISPLAY ' ====  BP13CD56 CONTROL TOTALS  ======'.                    
           DISPLAY ' '.                                                         
           DISPLAY ' F120 RECORDS READ          : ' WS-F120-READ-CTR.           
           DISPLAY ' K800 RECORDS FOUND         : ' WS-K800-FND.                
           DISPLAY ' K800 RECORDS NOT FOUND     : ' WS-K800-NOTFND.             
           DISPLAY ' NO OF CASES FOR LETTER     : ' WS-PD56-WRT-CTR.            
           DISPLAY ' NO OF CASES WRITE          : ' WS-CNT-LINE-LD56.           
           DISPLAY ' NO OF CASES FOUND IN F120  : ' WS-F120-READ-CTR.           
           DISPLAY ' '.                                                         
           DISPLAY ' ====================================='.                    
                                                                                
           CLOSE BP13K800                                                       
                 SY02F001                                                       
                 BM06F120                                                       
                 BP13KB20                                                       
                 BP13K820                                                       
                 BP13K830                                                       
                 BP13PD56                                                       
                 BP13LD56.                                                      
                                                                                
           IF WS-K800-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K800-STAT ' WS-K800-STATUS.            
                                                                                
           IF WS-K820-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K820-STAT ' WS-K820-STATUS.            
                                                                                
           IF WS-KB20-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13KB20-STAT ' WS-KB20-STATUS.            
                                                                                
           IF WS-K830-STATUS NOT = 00                                           
              DISPLAY 'CLOSING ERROR BP13K830-STAT ' WS-K830-STATUS.            
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
