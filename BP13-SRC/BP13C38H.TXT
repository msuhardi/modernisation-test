       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C38H.                                                 
      *AUTHOR.        DEEPIKA NALLAM.                                           
      *DATE-WRITTEN.  01/02/2019.                                               
      * ========================================================== *            
      * SYSTEM OF COMMITMENT (BP13)                                *            
      * ========================================================== *            
      *  OBJECTIVE :                                               *            
      *                                                            *            
      *    TO SEND EMAIL TO CS   TEAM                              *            
      *    WITH BUY 1ST SELL LATER CASES WHICH approved by rsl/trf *            
      *                                                            *            
      * ---------------------------------------------------------- *            
      * CHG REF  DATE(YMD)  BY    DESCRIPTION                      *            
      * -------- ---------- ----- -------------------------------- *            
      * BP137665 2019-02-01 DN8   NEW PROGRAM                      *            
      * BP138618 2021-12-31 LJL   Change of e-mail recipient for   *            
      *                           Agreement e-reports              *            
      *                           LAU_HONG_HUAT to Bernice JH GAN  *            
      * BP139030 2022-01-07 ZAR7  REPLACE CHUA YEE MIEN TO LIM KOK CHUN         
      * BP139238 2022-06-30 KAC1  REPLACE ALL CC: WITH TO:         *            
      * BP139276 2024-04-05 KAC1  REPLACE LIM KOK CHUN BY          *            
      *                                   KATHIJAH_BEE_ALI_MOHAMED *            
      * BP139175 2024-04-29 KAC1  REPL Bernice_JH_GAN@hdb.gov.sg WITH *         
      *                                Iris_LL_KOR@hdb.gov.sg         *         
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
      *-------------------------------------------------------------            
           SELECT BP13F482 ASSIGN        TO BP13F482.                           
           SELECT BP13K800 ASSIGN        TO BP13K800                            
                           ACCESS MODE   IS RANDOM                              
                           ORGANIZATION  IS INDEXED                             
                           RECORD KEY    IS K800-NUM-REGN                       
                           FILE STATUS   IS BP13K800-STATUS.                    
           SELECT BB24K010 ASSIGN        TO BB24K010                            
                           ACCESS MODE   IS RANDOM                              
                           ORGANIZATION  IS INDEXED                             
                           RECORD KEY    IS K010-KEY-FLD                        
                                         OF BB24K010-REC                        
                           ALTERNATE KEY IS K010-ALT-KEY1                       
                           FILE STATUS   IS BB24K010-STATUS.                    
           SELECT BP13K022  ASSIGN       TO BP13K022                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K022-KEY-FLD                        
                            ALTERNATE RECORD KEY IS K022-NUM-REGN               
                            WITH DUPLICATES                                     
                            FILE STATUS  IS BP13K022-STATUS.                    
                                                                                
           SELECT BP13BUY ASSIGN         TO BP13BUY.                            
           SELECT BP13SELL ASSIGN        TO BP13SELL.                           
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
                                                                                
      *COPY SY02F001.                                                           
                                                                                
       FD   BP13F482                                                            
            RECORDING MODE IS F                                                 
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BP13F482.                                                           
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K022                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K022.                                                           
                                                                                
       FD   BB24K010                                                            
            RECORD CONTAINS 5000 CHARACTERS.                                    
       COPY BB24K010.                                                           
                                                                                
       FD  BP13BUY                                                              
           RECORD CONTAINS 200 CHARACTERS                                       
           RECORDING  MODE IS F.                                                
       01  BUY-PRTREC  PIC X(200).                                              
                                                                                
       FD  BP13SELL                                                             
           RECORD CONTAINS 200 CHARACTERS                                       
           RECORDING  MODE IS F.                                                
       01  SELL-PRTREC  PIC X(200).                                             
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
                                                                                
       01  WS-VARIABLES.                                                        
           05  CNT-F482-READ        PIC 9(05)  VALUE ZEROES.                    
           05  CNT-K800-NOTFND      PIC 9(05)  VALUE ZEROES.                    
           05  CNT-K022-NOTFND      PIC 9(05)  VALUE ZEROES.                    
           05  CNT-K010-NOTFND      PIC 9(05)  VALUE ZEROES.                    
           05  CNT-K800-NOTBUY1ST   PIC 9(05)  VALUE ZEROES.                    
           05  WS-I                 PIC 9(02)  VALUE ZEROES.                    
           05  WS-F482-EOF          PIC X(01)  VALUE SPACES.                    
               88  F482-EOF                    VALUE 'Y'.                       
           05  WS-K800-FND          PIC X(01)  VALUE SPACES.                    
               88  K800-FND                    VALUE 'Y'.                       
           05  WS-K022-FND          PIC X(01)  VALUE SPACES.                    
               88  K022-FND                    VALUE 'Y'.                       
           05  WS-BB24K010-FND      PIC X(01)  VALUE SPACES.                    
               88  BB24K010-FND                VALUE 'Y'.                       
           05  WS-BP13K022-FND      PIC X(01)  VALUE SPACES.                    
               88  BP13K022-FND                VALUE 'Y'.                       
           05  BP13K800-STATUS      PIC 9(02)  VALUE ZEROES.                    
           05  BP13K022-STATUS      PIC 9(02)  VALUE ZEROES.                    
           05  BB24K010-STATUS      PIC 9(02)  VALUE ZEROES.                    
           05  WS-SYS-DATE          PIC X(8)   VALUE SPACES.                    
           05  WS-BUY-HDR-WRITE     PIC X(1)   VALUE SPACES.                    
           05  WS-SELL-HDR-WRITE    PIC X(1)   VALUE SPACES.                    
           05  MAIL-DATE            PIC X(10)   VALUE SPACES.                   
                                                                                
      *-------------------------------------------------------------            
      * LAYOUT BP13MAIL  -  DATASET FOR EMAIL                                   
      *-------------------------------------------------------------            
       01 WS-MAIL-LAYOUT.                                                       
           05  WS-DATE-RPT-DTL.                                                 
               10 FILLER                PIC X(6)  VALUE 'DATE: '.               
               10 WS-DATE-RPT           PIC X(10) VALUE SPACES.                 
           05  WS-MAIL-RPT1             PIC X(12) VALUE 'HELO SGPHDB1'.         
           05  WS-MAIL-RPT2             PIC X(27)                               
               VALUE 'MAIL FROM:<OPCP@SGPHDB1>'.                                
           05  WS-MAIL-RPT3             PIC X(60)                               
               VALUE 'RCPT TO:<LOW_SOO_CHIEW@HDB.GOV.SG> '.                     
           05  WS-MAIL-RPT4             PIC X(60)                               
               VALUE 'RCPT TO:<HEE_WAN_MENG@HDB.GOV.SG>'.                       
           05  WS-MAIL-RPT5             PIC X(60)                               
               VALUE 'RCPT TO:<KATHIJAH_BEE_ALI_MOHAMED@hdb.gov.sg>'.           
           05  WS-MAIL-RPT6             PIC X(60)                               
               VALUE 'RCPT TO:<JAMILAH_BAHROM@HDB.GOV.SG>'.                     
           05  WS-MAIL-RPT7             PIC X(60)                               
               VALUE 'RCPT TO:<JUARIAH_ALI@HDB.GOV.SG>'.                        
           05  WS-MAIL-RPT8             PIC X(60)                               
               VALUE 'RCPT TO:<TOH_LAY_YEN@HDB.GOV.SG>'.                        
           05  WS-MAIL-RPT9             PIC X(60)                               
               VALUE 'RCPT TO:<TENG_SIEW_HONG@HDB.GOV.SG>'.                     
           05  WS-MAIL-RPT10            PIC X(60)                               
               VALUE 'RCPT TO:<Iris_LL_KOR@hdb.gov.sg>'.                        
      *                                                                         
           05  WS-MAIL2-RPT3             PIC X(60)                              
               VALUE 'RCPT TO:<LOW_SOO_CHIEW@HDB.GOV.SG> '.                     
           05  WS-MAIL2-RPT4             PIC X(60)                              
               VALUE 'RCPT TO:<HEE_WAN_MENG@HDB.GOV.SG>'.                       
           05  WS-MAIL2-RPT5             PIC X(60)                              
               VALUE 'RCPT TO:<JAMILAH_BAHROM@HDB.GOV.SG>'.                     
           05  WS-MAIL2-RPT6             PIC X(60)                              
               VALUE 'RCPT TO:<JUARIAH_ALI@HDB.GOV.SG>'.                        
           05  WS-MAIL2-RPT7             PIC X(60)                              
               VALUE 'RCPT TO:<TOH_LAY_YEN@HDB.GOV.SG>'.                        
           05  WS-MAIL2-RPT8             PIC X(60)                              
               VALUE 'RCPT TO:<KATHIJAH_BEE_ALI_MOHAMED@hdb.gov.sg>'.           
           05  WS-MAIL2-RPT9             PIC X(60)                              
               VALUE 'RCPT TO:<TENG_SIEW_HONG@HDB.GOV.SG>'.                     
           05  WS-MAIL2-RPT10            PIC X(60)                              
               VALUE 'RCPT TO:<Iris_LL_KOR@hdb.gov.sg>'.                        
           05  WS-MAIL-RPT11             PIC X(4)                               
               VALUE 'DATA'.                                                    
      *                                                                         
           05  WS-MAIL-RPT12            PIC X(29)                               
               VALUE 'FROM:Soc System - Email Alert'.                           
           05  WS-MAIL-RPT13            PIC X(60)                               
               VALUE 'TO:<LOW_SOO_CHIEW@HDB.GOV.SG>;'.                          
           05  WS-MAIL-RPT14            PIC X(60)                               
               VALUE 'TO:<HEE_WAN_MENG@HDB.GOV.SG>'.                            
           05  WS-MAIL-RPT15            PIC X(60)                               
               VALUE 'TO:<KATHIJAH_BEE_ALI_MOHAMED@hdb.gov.sg>'.                
           05  WS-MAIL-RPT16            PIC X(60)                               
               VALUE 'TO:<JAMILAH_BAHROM@HDB.GOV.SG>'.                          
           05  WS-MAIL-RPT17            PIC X(60)                               
               VALUE 'TO:<JUARIAH_ALI@HDB.GOV.SG>'.                             
           05  WS-MAIL-RPT18            PIC X(60)                               
               VALUE 'TO:<TOH_LAY_YEN@HDB.GOV.SG>'.                             
           05  WS-MAIL-RPT19            PIC X(60)                               
               VALUE 'TO:<TENG_SIEW_HONG@HDB.GOV.SG>'.                          
           05  WS-MAIL-RPT20            PIC X(60)                               
               VALUE 'TO:<Iris_LL_KOR@hdb.gov.sg>'.                             
      *                                                                         
           05  WS-MAIL2-RPT13             PIC X(60)                             
               VALUE 'TO:<LOW_SOO_CHIEW@HDB.GOV.SG> '.                          
           05  WS-MAIL2-RPT14             PIC X(60)                             
               VALUE 'TO:<HEE_WAN_MENG@HDB.GOV.SG>'.                            
           05  WS-MAIL2-RPT15             PIC X(60)                             
               VALUE 'TO:<JAMILAH_BAHROM@HDB.GOV.SG>'.                          
           05  WS-MAIL2-RPT16             PIC X(60)                             
               VALUE 'TO:<JUARIAH_ALI@HDB.GOV.SG>'.                             
           05  WS-MAIL2-RPT17             PIC X(60)                             
               VALUE 'TO:<TOH_LAY_YEN@HDB.GOV.SG>'.                             
           05  WS-MAIL2-RPT18             PIC X(60)                             
               VALUE 'TO:<KATHIJAH_BEE_ALI_MOHAMED@hdb.gov.sg>'.                
           05  WS-MAIL2-RPT19             PIC X(60)                             
               VALUE 'TO:<TENG_SIEW_HONG@HDB.GOV.SG>'.                          
           05  WS-MAIL2-RPT20             PIC X(60)                             
               VALUE 'TO:<Iris_LL_KOR@hdb.gov.sg>'.                             
      *                                                                         
           05  WS-MAIL-RPT21            PIC X(120)                              
               VALUE 'SUBJECT : DAILY REPORT ON BUY 1ST CASE WITH (a) CO        
      -        'MPLETED RESALE OR (b) APPT TP DATE ON/AFTER RESALE COMPL        
      -        'ETION DATE'.                                                    
           05  WS-MAIL-RPT21A           PIC X(120)                              
               VALUE 'SUBJECT : DAILY REPORT ON SELL 1ST CASE WITH APPT         
      -        'TP DATE WITHIN 14 DAYS FROM RESALE COMPLETION DATE'.            
           05  WS-MAIL-RPT22            PIC X(41)                               
               VALUE 'Mime-Version: 1.0                        '.               
           05  WS-MAIL-RPT23            PIC X(80)                               
               VALUE 'Content-type: multipart/mixed; boundary="Mime.Part        
      -         '.Boundary"'.                                                   
           05  WS-MAIL-RPT24            PIC X(80)                               
               VALUE 'This is a multi-part message in MIME format.'.            
           05  WS-MAIL-RPT25            PIC X(80)                               
               VALUE '--Mime.Part.Boundary                        '.            
           05  WS-MAIL-RPT26            PIC X(80)                               
               VALUE 'Content-Type: text/plain; charset="iso-8859-1"'.          
           05  WS-MAIL-RPT27            PIC X(80)                               
               VALUE 'Content-Transfer-Encoding: 7bit               '.          
           05  WS-MAIL-RPT28            PIC X(80)                               
               VALUE 'Content-disposition: attachment;              '.          
           05  WS-MAIL-RPT29            PIC X(80)                               
               VALUE '           FILENAME="BUY1STCASES.TXT"        '.           
           05  WS-MAIL-RPT29A           PIC X(80)                               
               VALUE '           FILENAME="SELL1STCASES.TXT"       '.           
                                                                                
           05  WS-HEADER1-RPT.                                                  
               10 FILLER                  PIC X(05) VALUE SPACES.               
               10 FILLER                  PIC X(08) VALUE 'REGN NO.'.           
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(21)                             
                           VALUE 'SCHEME ACCT(NEW FLAT)'.                       
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(12)                             
                           VALUE 'APPT TP DATE'.                                
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(05)                             
                           VALUE ' CRM '.                                       
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(18)                             
                           VALUE 'RESALE CASE NO/OIC'.                          
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(26)                             
                           VALUE 'SCHEME ACCT(DISPOSAL FLAT)'.                  
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(21)                             
                           VALUE 'RESALE EFFECTIVE DATE'.                       
               10 FILLER                  PIC X(01) VALUE SPACES.               
               10 FILLER                  PIC X(22)                             
                           VALUE 'RESALE COMPLETION DATE'.                      
               10 FILLER                  PIC X(04) VALUE SPACES.               
                                                                                
           05  WS-HEADER1-LINE.                                                 
               10 FILLER                  PIC X(05) VALUE SPACES.               
               10 FILLER                  PIC X(08) VALUE '========'.           
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(21)                             
                           VALUE '====================='.                       
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(12)                             
                           VALUE '============'.                                
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(05)                             
                           VALUE '====='.                                       
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(18)                             
                           VALUE '=================='.                          
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(26)                             
                           VALUE '=========================='.                  
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(21)                             
                           VALUE '====================='.                       
               10 FILLER                  PIC X(01) VALUE SPACES.               
               10 FILLER                  PIC X(22)                             
                           VALUE '======================'.                      
               10 FILLER                  PIC X(04) VALUE SPACES.               
                                                                                
           05  MAIL-DTL-1ST-BUY.                                                
               10 FILLER                  PIC X(05)  VALUE SPACES.              
               10 MAIL-BUY-REGN           PIC X(08)  VALUE SPACES.              
               10 FILLER                  PIC X(02)  VALUE SPACES.              
               10 MAIL-BUY-FLAT-NEW       PIC X(14)  VALUE SPACES.              
               10 FILLER                  PIC X(09)  VALUE SPACES.              
               10 MAIL-BUY-APPT-TP-DTE    PIC X(10)  VALUE SPACES.              
               10 FILLER                  PIC X(05)  VALUE SPACES.              
               10 MAIL-BUY-CRM            PIC X(04)  VALUE SPACES.              
               10 FILLER                  PIC X(03)  VALUE SPACES.              
               10 MAIL-BUY-CASE-NO-OIC    PIC X(12)  VALUE SPACES.              
               10 FILLER                  PIC X(08)  VALUE SPACES.              
               10 MAIL-BUY-FLAT-SOLD      PIC X(14)  VALUE SPACES.              
               10 FILLER                  PIC X(14)  VALUE SPACES.              
               10 MAIL-BUY-DTE-EFF        PIC X(10)  VALUE SPACES.              
               10 FILLER                  PIC X(12)  VALUE SPACES.              
               10 MAIL-BUY-DTE-COMPL      PIC X(10)  VALUE SPACES.              
                                                                                
           05  WS-HEADER2-RPT.                                                  
               10 FILLER                  PIC X(05) VALUE SPACES.               
               10 FILLER                  PIC X(08) VALUE 'REGN NO.'.           
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(21)                             
                           VALUE 'SCHEME ACCT(NEW FLAT)'.                       
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(12)                             
                           VALUE 'APPT TP DATE'.                                
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(05)                             
                           VALUE ' CRM '.                                       
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(18)                             
                           VALUE 'RESALE CASE NO/OIC'.                          
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(26)                             
                           VALUE 'SCHEME ACCT(DISPOSAL FLAT)'.                  
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(22)                             
                           VALUE 'RESALE COMPLETION DATE'.                      
               10 FILLER                  PIC X(04) VALUE SPACES.               
                                                                                
           05  WS-HEADER2-LINE.                                                 
               10 FILLER                  PIC X(05) VALUE SPACES.               
               10 FILLER                  PIC X(08) VALUE '========'.           
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(21)                             
                           VALUE '====================='.                       
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(12)                             
                           VALUE '============'.                                
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(05)                             
                           VALUE '====='.                                       
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(18)                             
                           VALUE '=================='.                          
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(26)                             
                           VALUE '=========================='.                  
               10 FILLER                  PIC X(02) VALUE SPACES.               
               10 FILLER                  PIC X(22)                             
                           VALUE '======================'.                      
               10 FILLER                  PIC X(04) VALUE SPACES.               
                                                                                
           05  MAIL-DTL-1ST-SELL.                                               
               10 FILLER                  PIC X(05)  VALUE SPACES.              
               10 MAIL-SELL-REGN          PIC X(08)  VALUE SPACES.              
               10 FILLER                  PIC X(02)  VALUE SPACES.              
               10 MAIL-SELL-FLAT-NEW      PIC X(14)  VALUE SPACES.              
               10 FILLLER                 PIC X(09)  VALUE SPACES.              
               10 MAIL-SELL-APPT-TP-DTE   PIC X(10)  VALUE SPACES.              
               10 FILLER                  PIC X(05)  VALUE SPACES.              
               10 MAIL-SELL-CRM           PIC X(04)  VALUE SPACES.              
               10 FILLER                  PIC X(03)  VALUE SPACES.              
               10 MAIL-SELL-CASE-NO-OIC   PIC X(12)  VALUE SPACES.              
               10 FILLER                  PIC X(08)  VALUE SPACES.              
               10 MAIL-SELL-FLAT-SOLD     PIC X(14)  VALUE SPACES.              
               10 FILLER                  PIC X(14)  VALUE SPACES.              
               10 MAIL-SELL-DTE-COMPL     PIC X(10)  VALUE SPACES.              
                                                                                
                                                                                
       01  MAIL-SPACES.                                                         
           05 FILLER                   PIC X(150)  VALUE SPACES.                
                                                                                
       01  MAIL-TXT1.                                                           
           05 FILLER                   PIC X(54)  VALUE                         
              'Action - To update Buy-Sell Tag and cash proceed.Check'.         
           05 FILLER                   PIC X(52)  VALUE                         
              ' to ensure Appt TP date on/after 14 days from Resale'.           
           05 FILLER                   PIC X(44)  VALUE                         
              ' Completion Date'.                                               
                                                                                
       01  MAIL-TXT2-FT1.                                                       
           05 FILLER                   PIC X(150)  VALUE                        
              'Action -'.                                                       
                                                                                
       01  MAIL-TXT2-FT2.                                                       
           05 FILLER                   PIC X(54)  VALUE                         
              '(a)To get CRM to check and ensure CPF monies refunded '.         
           05 FILLER                   PIC X(54)  VALUE                         
              'to account before TP date.Else,Appt TP date has to be '.         
           05 FILLER                   PIC X(45)  VALUE                         
              'postponed.'.                                                     
                                                                                
       01  MAIL-TXT2-FT3.                                                       
           05 FILLER                   PIC X(54)  VALUE                         
              '(b)Unless Journal and confirmed CPF monies refunded to'.         
           05 FILLER                   PIC X(54)  VALUE                         
              ' account before TP date.Otherwise on the actual TP dat'.         
           05 FILLER                   PIC X(42)  VALUE                         
           'e,to get CRE'.                                                      
                                                                                
       01  MAIL-TXT2-FT4.                                                       
           05 FILLER                   PIC X(54)  VALUE                         
              'to inform buyers to login their CPF account to show pr'.         
           05 FILLER                   PIC X(54)  VALUE                         
              'oof that the CPF monies from sale of flat has been ref'.         
           05 FILLER                   PIC X(42)  VALUE                         
              'unded back to their account'.                                    
                                                                                
       PROCEDURE DIVISION.                                                      
      *-------------------------------------------------------------            
       0000-MAIN-ROUTINE.                                                       
      *-------------------------------------------------------------            
            PERFORM 1000-OPEN-ROUTINE         THRU 1000-EXIT.                   
            PERFORM 2000-READ-BP13F482        THRU 2000-EXIT.                   
            PERFORM 3000-PROCESS-DETAIL       THRU 3000-EXIT                    
              UNTIL F482-EOF.                                                   
                                                                                
            IF WS-BUY-HDR-WRITE = 'Y'                                           
                  MOVE SPACES TO BUY-PRTREC                                     
                  WRITE BUY-PRTREC                                              
                  WRITE BUY-PRTREC FROM   MAIL-TXT1                             
            END-IF                                                              
                                                                                
            IF WS-SELL-HDR-WRITE = 'Y'                                          
                  MOVE SPACES TO SELL-PRTREC                                    
                  WRITE SELL-PRTREC                                             
                  WRITE SELL-PRTREC FROM  MAIL-TXT2-FT1                         
                  WRITE SELL-PRTREC FROM  MAIL-TXT2-FT2                         
                  WRITE SELL-PRTREC FROM  MAIL-TXT2-FT3                         
                  WRITE SELL-PRTREC FROM  MAIL-TXT2-FT4                         
            END-IF                                                              
                                                                                
            PERFORM 9000-CLOSE-ROUTINE        THRU  9000-EXIT.                  
                                                                                
       0000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------------            
       1000-OPEN-ROUTINE.                                                       
      *-------------------------------------------------------------            
           OPEN INPUT  BP13F482                                                 
                       BP13K800                                                 
                       BP13K022                                                 
                       BB24K010                                                 
                OUTPUT BP13BUY                                                  
                       BP13SELL.                                                
                                                                                
           IF BP13K800-STATUS NOT = 00 AND 97                                   
              DISPLAY 'BP13K800 - OPEN ERROR (' BP13K800-STATUS ')'             
              MOVE BP13K800-STATUS  TO RETURN-CODE                              
              GO TO 9000-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           IF BP13K022-STATUS NOT = 00 AND 97                                   
              DISPLAY 'BP13K022 - OPEN ERROR (' BP13K022-STATUS ')'             
              MOVE BP13K022-STATUS  TO RETURN-CODE                              
              GO TO 9000-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           IF BB24K010-STATUS NOT = 00 AND 97                                   
              DISPLAY 'BB24K010 - OPEN ERROR (' BB24K010-STATUS ')'             
              MOVE BB24K010-STATUS  TO RETURN-CODE                              
              GO TO 9000-CLOSE-ROUTINE                                          
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8)    TO WS-SYS-DATE                    
           STRING WS-SYS-DATE(7:2) '/'                                          
                  WS-SYS-DATE(5:2) '/'                                          
                  WS-SYS-DATE(1:4)                                              
                  DELIMITED BY SIZE INTO MAIL-DATE.                             
           PERFORM 3050-MAIL-1ST-BUY-HDR  THRU 3050-EXIT.                       
           PERFORM 3150-MAIL-1ST-SELL-HDR THRU 3150-EXIT.                       
                                                                                
       1000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------------            
       2000-READ-BP13F482.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13F482                                                        
             AT END                                                             
                MOVE 'Y'   TO WS-F482-EOF                                       
                GO         TO 2000-EXIT                                         
           END-READ.                                                            
                                                                                
           ADD 1           TO CNT-F482-READ.                                    
                                                                                
       2000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------------            
       3000-PROCESS-DETAIL.                                                     
      *-------------------------------------------------------------            
                                                                                
           MOVE F482-NUM-REGN                    TO K800-NUM-REGN               
           PERFORM 8001-READ-BP13K800          THRU 8001-EXIT                   
                                                                                
           IF K800-FND                                                          
              IF K800-NUM-BUY-SELL-TAG = 'B' AND                                
                (K800-NUM-LOAN-TAG NOT = 'B' AND 'N')                           
                 PERFORM 8002-READ-BB24K010     THRU 8002-EXIT                  
                 PERFORM 8010-READ-BP13K022     THRU 8010-EXIT                  
                 PERFORM 3100-MAIL-1ST-BUY      THRU 3100-EXIT                  
               ELSE                                                             
                IF K800-NUM-BUY-SELL-TAG = 'S' AND                              
                  (K800-NUM-LOAN-TAG NOT = 'B' AND 'N')                         
                 PERFORM 8002-READ-BB24K010     THRU 8002-EXIT                  
                 PERFORM 8010-READ-BP13K022     THRU 8010-EXIT                  
                 PERFORM 3200-MAIL-1ST-SELL     THRU 3200-EXIT                  
                END-IF                                                          
               END-IF.                                                          
                                                                                
           PERFORM 2000-READ-BP13F482                THRU 2000-EXIT.            
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3050-MAIL-1ST-BUY-HDR.                                                   
      *-------------------------------------------------------------            
                                                                                
           IF WS-BUY-HDR-WRITE NOT = 'Y'                                        
               WRITE BUY-PRTREC FROM WS-MAIL-RPT1                               
               WRITE BUY-PRTREC FROM WS-MAIL-RPT2                               
               WRITE BUY-PRTREC FROM WS-MAIL-RPT3                               
               WRITE BUY-PRTREC FROM WS-MAIL-RPT4                               
               WRITE BUY-PRTREC FROM WS-MAIL-RPT5                               
               WRITE BUY-PRTREC FROM WS-MAIL-RPT6                               
               WRITE BUY-PRTREC FROM WS-MAIL-RPT7                               
               WRITE BUY-PRTREC FROM WS-MAIL-RPT8                               
               WRITE BUY-PRTREC FROM WS-MAIL-RPT9                               
               WRITE BUY-PRTREC FROM WS-MAIL-RPT10                              
               WRITE BUY-PRTREC FROM WS-MAIL-RPT11                              
               WRITE BUY-PRTREC FROM WS-MAIL-RPT12                              
               WRITE BUY-PRTREC FROM WS-MAIL-RPT13                              
               WRITE BUY-PRTREC FROM WS-MAIL-RPT14                              
               WRITE BUY-PRTREC FROM WS-MAIL-RPT15                              
               WRITE BUY-PRTREC FROM WS-MAIL-RPT16                              
               WRITE BUY-PRTREC FROM WS-MAIL-RPT17                              
               WRITE BUY-PRTREC FROM WS-MAIL-RPT18                              
               WRITE BUY-PRTREC FROM WS-MAIL-RPT19                              
               WRITE BUY-PRTREC FROM WS-MAIL-RPT20                              
               WRITE BUY-PRTREC FROM WS-MAIL-RPT21                              
               WRITE BUY-PRTREC FROM MAIL-DATE                                  
               WRITE BUY-PRTREC FROM WS-MAIL-RPT22                              
               WRITE BUY-PRTREC FROM WS-MAIL-RPT23                              
               MOVE  SPACES     TO   BUY-PRTREC                                 
               WRITE BUY-PRTREC                                                 
               WRITE BUY-PRTREC FROM WS-MAIL-RPT24                              
               WRITE BUY-PRTREC FROM WS-MAIL-RPT25                              
               WRITE BUY-PRTREC FROM WS-MAIL-RPT26                              
               WRITE BUY-PRTREC FROM WS-MAIL-RPT27                              
               WRITE BUY-PRTREC FROM WS-MAIL-RPT28                              
               WRITE BUY-PRTREC FROM WS-MAIL-RPT29                              
               MOVE  SPACES     TO   BUY-PRTREC                                 
               WRITE BUY-PRTREC                                                 
               WRITE BUY-PRTREC FROM WS-HEADER1-RPT                             
               WRITE BUY-PRTREC FROM WS-HEADER1-LINE                            
               MOVE 'Y'                      TO WS-BUY-HDR-WRITE                
           END-IF.                                                              
                                                                                
       3050-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3100-MAIL-1ST-BUY.                                                       
      *-------------------------------------------------------------            
           INITIALIZE                    MAIL-DTL-1ST-BUY                       
           MOVE F482-NUM-REGN         TO MAIL-BUY-REGN                          
           STRING F482-NUM-HDBREF-NEW(1:4) '-'                                  
                  F482-NUM-HDBREF-NEW(5:4) '-'                                  
                  F482-NUM-HDBREF-NEW(9:1) '-'                                  
                  F482-NUM-HDBREF-NEW(10:2)                                     
                  DELIMITED BY SIZE INTO MAIL-BUY-FLAT-NEW                      
           IF K800-DTE-SO-APPT  NOT = SPACES AND LOW-VALUES                     
            STRING K800-DTE-SO-APPT(7:2) '/'                                    
                   K800-DTE-SO-APPT(5:2) '/'                                    
                   K800-DTE-SO-APPT(1:4) '/'                                    
                   DELIMITED BY SIZE INTO MAIL-BUY-APPT-TP-DTE                  
            ELSE                                                                
            MOVE SPACES                TO MAIL-BUY-APPT-TP-DTE                  
           END-IF                                                               
           MOVE K022-NUM-OIC           TO MAIL-BUY-CRM                          
           STRING F482-NUM-HDBREF-DISPOSAL(1:4) '-'                             
                  F482-NUM-HDBREF-DISPOSAL(5:4) '-'                             
                  F482-NUM-HDBREF-DISPOSAL(9:1) '-'                             
                  F482-NUM-HDBREF-DISPOSAL(10:2)                                
                  DELIMITED BY SIZE INTO MAIL-BUY-FLAT-SOLD                     
           IF K010-DTE-STATUS-UPDATE(6) NOT = LOW-VALUES AND SPACES             
            STRING K010-DTE-STATUS-UPDATE(6)(7:2) '/'                           
                   K010-DTE-STATUS-UPDATE(6)(5:2) '/'                           
                   K010-DTE-STATUS-UPDATE(6)(1:4)                               
                   DELIMITED BY SIZE INTO MAIL-BUY-DTE-EFF                      
            ELSE                                                                
             MOVE SPACES  TO MAIL-BUY-DTE-EFF                                   
            END-IF                                                              
           IF K010-DTE-RESL-EFF NOT = SPACES AND LOW-VALUES                     
              STRING K010-DTE-RESL-EFF(7:2) '/'                                 
                     K010-DTE-RESL-EFF(5:2) '/'                                 
                     K010-DTE-RESL-EFF(1:4)                                     
                     DELIMITED BY SIZE INTO MAIL-BUY-DTE-COMPL                  
           ELSE                                                                 
              MOVE SPACES TO MAIL-BUY-DTE-COMPL                                 
           END-IF                                                               
           STRING K010-NUM-CASE OF BB24K010-REC                                 
                     '/' K010-CDE-INIT-OIC1                                     
                     DELIMITED BY SIZE INTO MAIL-BUY-CASE-NO-OIC                
           WRITE BUY-PRTREC FROM MAIL-DTL-1ST-BUY.                              
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3150-MAIL-1ST-SELL-HDR.                                                  
      *-------------------------------------------------------------            
                                                                                
           IF WS-SELL-HDR-WRITE NOT = 'Y'                                       
               WRITE SELL-PRTREC FROM WS-MAIL-RPT1                              
               WRITE SELL-PRTREC FROM WS-MAIL-RPT2                              
               WRITE SELL-PRTREC FROM WS-MAIL2-RPT3                             
               WRITE SELL-PRTREC FROM WS-MAIL2-RPT4                             
               WRITE SELL-PRTREC FROM WS-MAIL2-RPT5                             
               WRITE SELL-PRTREC FROM WS-MAIL2-RPT6                             
               WRITE SELL-PRTREC FROM WS-MAIL2-RPT7                             
               WRITE SELL-PRTREC FROM WS-MAIL2-RPT8                             
               WRITE SELL-PRTREC FROM WS-MAIL2-RPT9                             
               WRITE SELL-PRTREC FROM WS-MAIL2-RPT10                            
               WRITE SELL-PRTREC FROM WS-MAIL-RPT11                             
               WRITE SELL-PRTREC FROM WS-MAIL-RPT12                             
               WRITE SELL-PRTREC FROM WS-MAIL2-RPT13                            
               WRITE SELL-PRTREC FROM WS-MAIL2-RPT14                            
               WRITE SELL-PRTREC FROM WS-MAIL2-RPT15                            
               WRITE SELL-PRTREC FROM WS-MAIL2-RPT16                            
               WRITE SELL-PRTREC FROM WS-MAIL2-RPT17                            
               WRITE SELL-PRTREC FROM WS-MAIL2-RPT18                            
               WRITE SELL-PRTREC FROM WS-MAIL2-RPT19                            
               WRITE SELL-PRTREC FROM WS-MAIL2-RPT20                            
               WRITE SELL-PRTREC FROM WS-MAIL-RPT21A                            
               WRITE SELL-PRTREC FROM MAIL-DATE                                 
               WRITE SELL-PRTREC FROM WS-MAIL-RPT22                             
               WRITE SELL-PRTREC FROM WS-MAIL-RPT23                             
               MOVE  SPACES     TO   SELL-PRTREC                                
               WRITE SELL-PRTREC                                                
               WRITE SELL-PRTREC FROM WS-MAIL-RPT24                             
               WRITE SELL-PRTREC FROM WS-MAIL-RPT25                             
               WRITE SELL-PRTREC FROM WS-MAIL-RPT26                             
               WRITE SELL-PRTREC FROM WS-MAIL-RPT27                             
               WRITE SELL-PRTREC FROM WS-MAIL-RPT28                             
               WRITE SELL-PRTREC FROM WS-MAIL-RPT29A                            
               MOVE  SPACES     TO   SELL-PRTREC                                
               WRITE SELL-PRTREC                                                
               WRITE SELL-PRTREC FROM WS-HEADER2-RPT                            
               WRITE SELL-PRTREC FROM WS-HEADER2-LINE                           
               MOVE 'Y'                      TO WS-SELL-HDR-WRITE               
           END-IF.                                                              
                                                                                
       3150-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3200-MAIL-1ST-SELL.                                                      
      *-------------------------------------------------------------            
                                                                                
           INITIALIZE                    MAIL-DTL-1ST-SELL                      
           MOVE F482-NUM-REGN         TO MAIL-SELL-REGN                         
           STRING F482-NUM-HDBREF-NEW(1:4) '-'                                  
                  F482-NUM-HDBREF-NEW(5:4) '-'                                  
                  F482-NUM-HDBREF-NEW(9:1) '-'                                  
                  F482-NUM-HDBREF-NEW(10:2)                                     
                  DELIMITED BY SIZE INTO MAIL-SELL-FLAT-NEW                     
           IF K800-DTE-SO-APPT NOT = SPACES AND LOW-VALUES                      
            STRING K800-DTE-SO-APPT(7:2) '/'                                    
                   K800-DTE-SO-APPT(5:2) '/'                                    
                   K800-DTE-SO-APPT(1:4) '/'                                    
                   DELIMITED BY SIZE INTO MAIL-SELL-APPT-TP-DTE                 
            ELSE                                                                
            MOVE SPACES               TO MAIL-SELL-APPT-TP-DTE                  
           END-IF                                                               
           MOVE K022-NUM-OIC          TO MAIL-SELL-CRM                          
           STRING F482-NUM-HDBREF-DISPOSAL(1:4) '-'                             
                  F482-NUM-HDBREF-DISPOSAL(5:4) '-'                             
                  F482-NUM-HDBREF-DISPOSAL(9:1) '-'                             
                  F482-NUM-HDBREF-DISPOSAL(10:2)                                
                  DELIMITED BY SIZE INTO MAIL-SELL-FLAT-SOLD                    
           IF K010-DTE-RESL-EFF NOT = SPACES AND LOW-VALUES                     
              STRING K010-DTE-RESL-EFF(7:2) '/'                                 
                     K010-DTE-RESL-EFF(5:2) '/'                                 
                     K010-DTE-RESL-EFF(1:4)                                     
                     DELIMITED BY SIZE INTO MAIL-SELL-DTE-COMPL                 
           ELSE                                                                 
              MOVE SPACES TO MAIL-SELL-DTE-COMPL                                
           END-IF                                                               
           STRING K010-NUM-CASE OF BB24K010-REC                                 
                     '/' K010-CDE-INIT-OIC1                                     
                     DELIMITED BY SIZE INTO MAIL-SELL-CASE-NO-OIC               
           WRITE SELL-PRTREC FROM MAIL-DTL-1ST-SELL.                            
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       8001-READ-BP13K800.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13K800.                                                       
                                                                                
           IF BP13K800-STATUS = 00 OR 02                                        
              MOVE 'Y'               TO WS-K800-FND                             
           ELSE                                                                 
              IF BP13K800-STATUS = 23                                           
                 ADD  1              TO CNT-K800-NOTFND                         
                 MOVE SPACES         TO BP13K800-MASTER                         
                 MOVE 'N'            TO WS-K800-FND                             
              ELSE                                                              
                 DISPLAY 'BP13K800 - READ ERROR (' BP13K800-STATUS ')'          
                 MOVE BP13K800-STATUS TO RETURN-CODE                            
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8001-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       8002-READ-BB24K010.                                                      
      *-------------------------------------------------------------            
                                                                                
           MOVE SPACES                      TO BB24K010-REC                     
           MOVE F482-NUM-HDBREF-DISPOSAL    TO K010-NUM-HDB-REF                 
           READ BB24K010 KEY IS K010-ALT-KEY1.                                  
                                                                                
           IF BB24K010-STATUS = 00 OR 02                                        
              MOVE 'Y'               TO WS-BB24K010-FND                         
           ELSE                                                                 
              IF BB24K010-STATUS = 23                                           
                 ADD  1              TO CNT-K010-NOTFND                         
                 MOVE SPACES         TO BB24K010-REC                            
                 MOVE 'N'            TO WS-BB24K010-FND                         
              ELSE                                                              
                 DISPLAY 'BB24K010 - READ ERROR (' BB24K010-STATUS ')'          
                 MOVE BB24K010-STATUS TO RETURN-CODE                            
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8002-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       8010-READ-BP13K022.                                                      
      *-------------------------------------------------------------            
                                                                                
           MOVE SPACES                      TO BP13K022-REC                     
           MOVE F482-NUM-REGN               TO K022-NUM-REGN                    
           READ BP13K022 KEY IS K022-NUM-REGN.                                  
                                                                                
           IF BP13K022-STATUS = 00 OR 02                                        
              CONTINUE                                                          
           ELSE                                                                 
              IF BP13K022-STATUS = 23                                           
                 ADD  1              TO CNT-K022-NOTFND                         
                 MOVE SPACES         TO K022-NUM-OIC K022-NUM-OIC-APPL          
                 MOVE SPACES         TO BP13K022-REC                            
              ELSE                                                              
                 DISPLAY 'BP13K022 - READ ERROR (' BP13K022-STATUS ')'          
                 MOVE BP13K022-STATUS TO RETURN-CODE                            
                 GO TO 9000-CLOSE-ROUTINE                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8010-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       9000-CLOSE-ROUTINE.                                                      
      *-------------------------------------------------------------            
                                                                                
           DISPLAY ' '.                                                         
           DISPLAY ' - BP13CD85 CONTROL TOTALS -----'.                          
           DISPLAY ' '.                                                         
           DISPLAY ' NO. OF BP13F482 RECS READ   = ' CNT-F482-READ.             
           DISPLAY ' NO. OF BP13K800 NOT FND     = ' CNT-K800-NOTFND.           
           DISPLAY ' NO. OF BP13K022 NOT FND     = ' CNT-K022-NOTFND.           
           DISPLAY ' NO. OF BB24K010 NOT FND     = ' CNT-K010-NOTFND.           
           DISPLAY ' '.                                                         
                                                                                
            CLOSE BP13F482                                                      
                  BP13K800                                                      
                  BP13K022                                                      
                  BB24K010                                                      
                  BP13BUY                                                       
                  BP13SELL                                                      
           IF BP13K800-STATUS NOT = 00                                          
              DISPLAY 'BP13K800 - OPEN ERROR (' BP13K800-STATUS ')'             
           END-IF.                                                              
           IF BP13K022-STATUS NOT = 00                                          
              DISPLAY 'BP13K022 - OPEN ERROR (' BP13K022-STATUS ')'             
           END-IF.                                                              
           IF BB24K010-STATUS NOT = 00                                          
              DISPLAY 'BB24K010 - CLOSE ERROR (' BB24K010-STATUS ')'            
           END-IF.                                                              
                                                                                
            STOP RUN.                                                           
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
