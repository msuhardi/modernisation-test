      *-----------------------*                                         00010000
       IDENTIFICATION DIVISION.                                         00020000
      *-----------------------*                                         00030000
       PROGRAM-ID.    BP13C314.                                         00040000
      *AUTHOR.        TAN M K.                                          00050000
      *DATE-WRITTEN.  01/09/89.                                         00060000
                                                                        00070000
      * =========================================================== *   00080000
      *                SYSTEM OF COMMITMENT (BP13)                  *   00090000
      * =========================================================== *   00100000
      *    OBJECTIVE :                                              *   00110000
      *      1.  THIS IS A PROGRAM TO PRINT A LIST OF PAYMENT       *   00120000
      *          FOR STAMPING AFTER SALES AGREEMENT                 *   00130000
      *          (FINAL PINK VOUCHER)                               *   00140000
      *                                                             *   00150000
      *    INPUT FILES :                                            *   00160000
      *      1.  BP13F315 - TRANSACTION FILE                        *   00170000
      *      2.  BP13K800 - SOC MASTER APPLN FILE                   *   00180000
      *      3.  BP13K330 - SOC AGREEMENT ORDER FILE                *   00190000
      *                                                             *   00200000
      *    OUTPUT FILE :                                            *   00210000
      *      1.  AG07F220 - VOUCHER STAMPING FILE                   *   00220000
      *      2.  BP13K625 - STAMP FEE MASTER FILE                   *   00230000
      *      3.  AG07F225 - VOUCHER FILE FOR STAMPFEE               *   00240000
      *                                                             *   00250000
      *    LISTING     :   1.  BP13L314 - CONTROL LISTING           *   00260000
      *                                                             *   00270000
      * ----------------------------------------------------------- *   00280000
      * CHG REF  BY   DATE   DESCRIPTION                            *   00290000
      * -------- ---- ------ -----------                            *   00300000
      * SOC-PH8  RML  931201 TO EXPAND REGN FROM 7 TO 8 BYTES       *   00310000
      * C931147  JEP  940110 TO CATER FOR PAYMENT SYSTEM            *   00320000
      * C940876  LJL  940819 TO INCLUDE 'PAYMENT FOR                *   00330000
      *                      LEASE/MORTGAGE STAMP FEES' TO          *   00340000
      *                      THE NARRATION FIELD.                   *   00350000
      * BP130020 SSS  951010 EXCHANGE HDG-01 WITH HDG-02            *   00360000
      * BP130453 SGK  980302 TO INCLUDE BANK INFO IN REPORT.        *   00370000
      * BP130418 SGK  980603 TO CATER FOR Y2K.                      *   00380000
      * BP130565 SRN  981216 PRINT TWO ADDDITIONAL COPIES OF        *   00390000
      *                      BP13L314                               *   00400000
      * BP130696 RAS  990715 CREATE BP13K625 FOR E-STAMPING         *   00410000
      * BP130696 LSB  990903 ELECTRONIC STAMPING VIA IDNET TO IRAS  *   00420000
      * BP130790 SCK  000202 TO ADD IN IN-SOURCE DOCUMENTATION      *   00430000
      * BP130806 RAS  000203 TO CONVERT NUM-LEASE-TERM FROM YEAR    *   00440000
      *                      TO MONTHS                              *   00450000
      * BP130821 RAS  030300 TO CATER FOR DUPLICATE RECORDS IN      *   00460000
      *                      WRITING BP13K625 BY ADDING A FIELD     *   00470000
      *                      CALLED NUM-DOC-CNT                     *   00480000
      * BP132037 MCC  161001 OFF BUDGET DISCOUNT 30%                *   00490000
      * BP132103 CLT  180201 AG07 8 DIGIT EXPANSION                 *   00500000
      * BP132185 MALC 310702 REMOVE VOUCHER PRTNG FOR STAMP OFC     *   00510000
      *                      MOVE DTE-AGRM-ORDER TO DOC-PREPARE     *   00520000
      *          MALC 190802 TO CHANGE PHONE NO TO 64903783         *   00530000
      * BP132208 MCC  240902 MOVE K800-DTE-RAISE-AO TO DOC-PREPARE  *   00540000
      * BP132270 MALC 311202 TO CATER FOR STAMP-FEE DISC AND NO DISC*   00550000
      * BP132660 JF4  310105 CHG K330-AMT-FLEXI-SELLPR TO           *   00560000
      *                      K330-AMT-CURR-SELLPR                   *   00570000
      * BP132729 JF4  260905 CATER FOR EARMARKING OF STAMP REG FEES *   00580000
      * BP132969 MTSR 130207 MOVE SFTT CODE TO F220-TXT-INFO        *   00590000
      * BP134218 JB8  110511 TO CATER FOR REMOVAL OF NOMINAL DUTIES *   00600000
      * BP134810 JGO1 050413 TO CREATE F235 FILE FOR ESTAMPING      *   00610000
      *                      AND REMOVE AG07F960 AND AG07F220       *   00620000
      * BP134810 JGO1 170613 CORRECT THE STAFF ID TO 29586H         *   00630000
      * BP134810 JGO1 260613 CHANGE OUTPUT TO F225 FROM F235        *   00640000
      *                      READ AG07K960 INSTEAD OF K962 FOR VR NO*   00650000
      * BP135096 JGO1 161013 UPDATE VOUCHER FROM 'SU' TO 'SS'       *   00660000
      * BP135017 JGO1 280414 PASS F315-USERID TO F225 STAFF-ID-PREP *   00670000
      * BP135247 JGO1 300414 PASS F315-USERID IF ID NOT = BP13P001  *   00680000
      * BP135650 JGO1 080415 USE PRINC SA DATE AS AO DATE FOR       *   00690000
      *                      CASES 2436081D & 2582915H 3073443B     *   00700000
      * BP135650 JGO1 150415 REMOVE HARD CODING OF DATE             *   00710000
      * BP135832 JGO1 190515 UPDATE VALUE PASSED TO F225 BANK       *   00720000
      * BP136830 KSJ3 060717 HARDCODE 2801109A FOR TOP-UP LEASE     *   00730000
      * BP137140 PCL4 191217 TO REDEFINE AG07 FILE ERROR CODE       *   00740000
      * BP138339 KR13 050820 UPDATE REPORT ID.                      *   00750000
      * BP138742 ZDD3 200521 TO CATER FOR STAMPING OF AGREEMENT FOR     00760000
      *                      LEASE FOR REINSTATED CASE (2716623G)   *   00770000
      * BP139164 KV8  040522 INCLUDED ADDRESS AND COMMENTED STREET  *   00771001
      * =========================================================== *   00780000
                                                                        00790000
      ************************                                          00800000
       ENVIRONMENT DIVISION.                                            00810000
      ************************                                          00820000
       CONFIGURATION SECTION.                                           00830000
       SOURCE-COMPUTER. IBM-3090.                                       00840000
       OBJECT-COMPUTER. IBM-3090.                                       00850000
                                                                        00860000
       INPUT-OUTPUT SECTION.                                            00870000
       FILE-CONTROL.                                                    00880000
                                                                        00890000
           SELECT BP13F315  ASSIGN       TO BP13F315.                   00900000
           SELECT BP13K800  ASSIGN       TO BP13K800                    00910000
                            ACCESS MODE  IS RANDOM                      00920000
                            ORGANIZATION IS INDEXED                     00930000
                            RECORD KEY   IS K800-NUM-REGN               00940000
                            FILE STATUS  IS BP13K800-STATUS.            00950000
           SELECT BP13K330  ASSIGN       TO BP13K330                    00960000
                            ACCESS MODE  IS RANDOM                      00970000
                            ORGANIZATION IS INDEXED                     00980000
                            RECORD KEY   IS K330-KEY-FLD                00990000
                            FILE STATUS  IS BP13K330-STATUS.            01000000
           SELECT BP13K625  ASSIGN       TO BP13K625                    01010000
                            ACCESS MODE  IS DYNAMIC                     01020000
                            ORGANIZATION IS INDEXED                     01030000
                            RECORD KEY   IS K625-KEY-FLD                01040000
                            FILE STATUS  IS BP13K625-STATUS.            01050000
                                                                        01060000
           SELECT AG07F225  ASSIGN       TO AG07F225.                   01070000
           SELECT BP13L314  ASSIGN       TO BP13L314.                   01080000
           SELECT P13L314B  ASSIGN       TO P13L314B.                   01090000
                                                                        01100000
      *****************                                                 01110000
       DATA DIVISION.                                                   01120000
      *****************                                                 01130000
       FILE SECTION.                                                    01140000
      *-------------*                                                   01150000
                                                                        01160000
       FD   BP13F315                                                    01170000
            RECORD CONTAINS 500 CHARACTERS                              01180000
            RECORDING MODE  IS  F.                                      01190000
       COPY BP13F315.                                                   01200000
                                                                        01210000
       FD   BP13K800                                                    01220000
            RECORD CONTAINS 2000 CHARACTERS.                            01230000
       COPY BP13K800.                                                   01240000
                                                                        01250000
       FD   BP13K330                                                    01260000
            RECORD CONTAINS 2000 CHARACTERS.                            01270000
       COPY BP13K330.                                                   01280000
                                                                        01290000
       FD   BP13L314                                                    01300000
            RECORD CONTAINS 132 CHARACTERS                              01310000
            RECORDING MODE  IS  F.                                      01320000
       01   L314-PRINT-REC                    PIC X(132).               01330000
                                                                        01340000
       FD   P13L314B                                                    01350000
            RECORD CONTAINS 132 CHARACTERS                              01360000
            RECORDING MODE  IS  F.                                      01370000
       01   L314B-PRINT-REC                   PIC X(132).               01380000
                                                                        01390000
       FD   BP13K625                                                    01400000
            RECORD CONTAINS 500 CHARACTERS.                             01410000
       COPY BP13K625.                                                   01420000
                                                                        01430000
       FD   AG07F225                                                    01440000
            RECORDING MODE  IS  F                                       01450000
            RECORD CONTAINS 600 CHARACTERS.                             01460000
       COPY AG07F225.                                                   01470000
                                                                        01480000
      *=======================*                                         01490000
       WORKING-STORAGE SECTION.                                         01500000
      *=======================*                                         01510000
       01  WS1-FILE-ACCESS-STATUS.                                      01520000
           05  BP13K800-STATUS         PIC 9(2)      VALUE ZEROS.       01530000
           05  BP13K330-STATUS         PIC 9(2)      VALUE ZEROS.       01540000
           05  BP13K625-STATUS         PIC 9(2)      VALUE ZEROS.       01550000
           05  WS-AG07-STATUS          PIC 9(2)      VALUE ZEROS.       01560000
           05  WS-AG07-STAT-X REDEFINES WS-AG07-STATUS PIC X(2).        01570000
       01  WS-COUNTERS.                                                 01580000
           05  WS-CNT-F315-READ        PIC 9(3)      VALUE ZEROS.       01590000
           05  WS-CNT-K800-READ        PIC 9(3)      VALUE ZEROS.       01600000
           05  WS-CNT-K330-READ        PIC 9(3)      VALUE ZEROS.       01610000
           05  WS-CNT-K625-WRITE       PIC 9(3)      VALUE ZEROS.       01620000
           05  WS-CNT-F225-WRITE       PIC 9(3)      VALUE ZEROS.       01630000
           05  WS-CNT-L314-WRITE       PIC 9(3)      VALUE ZEROS.       01640000
           05  WS-CNT-L314-DETLS       PIC 9(4)      VALUE ZEROS.       01650000
                                                                        01660000
           05  WS-L314B-PRINT-CNT      PIC 9(4)      VALUE ZEROS.       01670000
           05  WS-L314B-PAGE-CNT       PIC 9(5)      VALUE ZEROS.       01680000
           05  WS-L314B-REC-ON-PAGE-CNT  PIC 9(2)    VALUE 66.          01690000
                                                                        01700000
       01  WS-ACCUM-VARIABLES.                                          01710000
           05  WS-NO-OF-PAGE           PIC 9(5)      VALUE ZEROS.       01720000
           05  WS-TOTAL-ACTUAL-LEASE   PIC S9(6)V99  VALUE ZEROS.       01730000
           05  WS-TOTAL-DUP-LEASE      PIC S9(3)V99  VALUE ZEROS.       01740000
           05  WS-TOTAL-LEASE          PIC S9(7)V99  VALUE ZEROS.       01750000
           05  WS-COMP-TOT-LEASE       PIC S9(7)V99  VALUE ZEROS.       01760000
                                                                        01770000
       01  WS-SWITCHES.                                                 01780000
           05  WS-F315-EOF-IND         PIC X(1)      VALUE 'N'.         01790000
               88 WS-F315-EOF                        VALUE 'Y'.         01800000
           05  WS-NEW-VOUCHER-NO       PIC X(1)      VALUE 'Y'.         01810000
           05  WS-NEW-VOUCHER-F225     PIC X(1)      VALUE 'Y'.         01820000
           05  WS-NEW-BATCH-NO         PIC X(1)      VALUE 'Y'.         01830000
           05  WS-NEW-HEADER           PIC X(1)      VALUE 'Y'.         01840000
           05  WS-K625-EOF             PIC X(1)      VALUE 'N'.         01850000
                                                                        01860000
       01  WS-DATES-VARIABLES.                                          01870000
           05  WS-AO-DATE.                                              01880000
               10  WS-AO-YEAR          PIC 9(4)      VALUE 0.           01890000
               10  WS-AO-MM            PIC 99        VALUE 0.           01900000
               10  WS-AO-DD            PIC 99        VALUE 0.           01910000
           05  WS-DATE.                                                 01920000
               10 WS-DD                PIC 99        VALUE 00.          01930000
               10 FILLER               PIC X         VALUE '/'.         01940000
               10 WS-MM                PIC 99        VALUE 00.          01950000
               10 FILLER               PIC X         VALUE '/'.         01960000
               10 WS-YEAR              PIC 9(4)      VALUE 00.          01970000
           05  WS-PR-CUR-DATE.                                          01980000
               10 WS-PC-DD             PIC 99        VALUE 00.          01990000
               10 FILLER               PIC X         VALUE '/'.         02000000
               10 WS-PC-MM             PIC 99        VALUE 00.          02010000
               10 FILLER               PIC X         VALUE '/'.         02020000
               10 WS-PC-CCYY           PIC 9999      VALUE ZERO.        02030000
           05  WS-CURRENT-CCYYMMDD.                                     02040000
                   15 WS-CUR-CCYY      PIC 9999      VALUE ZERO.        02050000
                   15 WS-CUR-MM        PIC 99        VALUE 00.          02060000
                   15 WS-CUR-DD        PIC 99        VALUE 00.          02070000
                                                                        02080000
       01  WS-DEFAULT-VALUES.                                           02090000
           05  WS-DEF-DUP-LEASE        PIC 9(2)V99   VALUE  0.          02100000
           05  WS-DUP-LEASE            PIC 9(2)V99   VALUE  0.          02110000
           05  WS-MAX-LINES            PIC 9(2)      VALUE  2.          02120000
                                                                        02130000
       01  WS-SCH-ACC.                                                  02140000
           05  WS-SCH-1-4              PIC X(4)      VALUE SPACES.      02150000
           05  WS-SCH-5-8              PIC X(4)      VALUE SPACES.      02160000
           05  WS-SCH-9-9              PIC X(1)      VALUE SPACE.       02170000
           05  WS-SCH-10-11            PIC X(2)      VALUE SPACES.      02180000
                                                                        02190000
                                                                        02200000
       01  WS-NUM-VOUCHER              PIC X(11)     VALUE SPACES.      02210000
       01  WS-NUM-VOUCHER-F225         PIC X(11)     VALUE SPACES.      02220000
       01  WS-NUM-GL-ACCT              PIC X(13)     VALUE SPACES.      02230000
       01  WS-ANNUAL-RENT              PIC 9(7)V99   VALUE ZEROES.      02240000
       01  WS-NUM-BATCH-TYPE           PIC X(4)      VALUE SPACES.      02250000
       01  WS-NUM-FIN-YEAR             PIC 9(4)      VALUE ZEROES.      02260000
       01  WS-NUM-BATCH-SERIAL         PIC 9(5)      VALUE ZEROES.      02270000
       01  WS-SEQ-NO-F225              PIC 9(2)      VALUE ZEROES.      02280000
       01  WS-NUM-HDB-REF              PIC X(11)     VALUE SPACES.      02290000
       01  WS-NUM-DOC                  PIC X(3)      VALUE SPACES.      02300000
       01  WS-NUM-DOC-TYP              PIC X(1)      VALUE SPACES.      02310000
       01  WS-NUM-DOC-CNT              PIC 9(1)      VALUE ZEROES.      02320000
       01  WS-NET-AMT-F225             PIC 9(7)V99   VALUE ZEROS.       02330000
                                                                        02340000
       01  WS-AMT-EARMARK              PIC 9(10)V99  VALUE ZEROES.      02350000
       01  WS-OTHER-VARIABLES.                                          02360000
           05  WS-NUM-UNIT.                                             02370000
               10  WS-HSE-MAIN            PIC X(4)   VALUE SPACES.      02380000
               10  WS-HSE-SUB             PIC X(3)   VALUE SPACES.      02390000
           05  WS-NUM-BLK-HSE.                                          02400000
               10  WS-BLK-HSE-DESC        PIC X(4)   VALUE 'BLK '.      02410000
               10  WS-BLK-HSE-NO          PIC X(6)   VALUE SPACES.      02420000
           05  WS-STAFF-START             PIC X(9)   VALUE '29586H   '. 02430000
                                                                        02440000
      *----------------------------------------------------------*      02450000
      *    WS LINKAGE VARIABLES PASSED TO "AG07C907"             *      02460000
      *----------------------------------------------------------*      02470000
       COPY AG7C907C.                                                   02480000
      *----------------------------------------------------------*      02490000
      *    WS LINKAGE VARIABLES PASSED TO "BP13C906"             *      02500000
      *----------------------------------------------------------*      02510000
       COPY P13C906C.                                                   02520000
      *----------------------------------------------------------*      02530000
      *    WS LINKAGE VARIABLES PASSED TO "AB05C902"             *      02540000
      *----------------------------------------------------------*      02550000
       COPY AB05902C.                                                   02560000
                                                                        02570000
      *----------------------------------------------------------*      02580000
      *        WS FOR LIST OF PAYMENT  FOR STAMPING              *      02590000
      *----------------------------------------------------------*      02600000
       01  L314-PR-HDG-01.                                              02610000
           05  FILLER              PIC X(8)    VALUE 'BP13L314'.        02620000
           05  FILLER              PIC X(10)   VALUE '      HDB3'.      02630000
           05  FILLER              PIC X(28)   VALUE SPACES.            02640000
           05  FILLER              PIC X(39)   VALUE                    02650000
               'S Y S T E M   O F   C O M M I T M E N T'.               02660000
           05  FILLER              PIC X(12)   VALUE SPACES.            02670000
           05  FILLER              PIC X(7)    VALUE 'DATE : '.         02680000
           05  L314-CURRENT-DATE   PIC X(10)   VALUE SPACES.            02690000
           05  FILLER              PIC X(6)    VALUE SPACES.            02700000
           05  FILLER              PIC X(7)    VALUE 'PAGE : '.         02710000
           05  L314-PAGE           PIC ZZZZ9.                           02720000
                                                                        02730000
       01  L314-PR-HDG-02.                                              02740000
           05  FILLER              PIC X(30)   VALUE                    02750000
               'HOUSING AND DEVELOPMENT BOARD'.                         02760000
           05  FILLER              PIC X(21)   VALUE SPACES.            02770000
           05  FILLER              PIC X(30)   VALUE                    02780000
               'P A Y M E N T    V O U C H E R'.                        02790000
           05  FILLER              PIC X(25)   VALUE SPACES.            02800000
           05  L314-COPY-NAME      PIC X(20)   VALUE SPACES.            02810000
                                                                        02820000
       01  L314-PR-HDG-03.                                              02830000
           05  FILLER              PIC X(46)   VALUE SPACES.            02840000
           05  FILLER              PIC X(85)   VALUE ALL '-'.           02850000
                                                                        02860000
       01  L314-PR-HDG-04.                                              02870000
           05  FILLER              PIC X(46)   VALUE                    02880000
               'SALES UNIT (AGREEMENT TEAM)'.                           02890000
           05  FILLER              PIC X(1)    VALUE '¦'.               02900000
           05  FILLER              PIC X(27)   VALUE                    02910000
               ' FOR FINANCE DEPARTMENT USE'.                           02920000
           05  FILLER              PIC X(21)   VALUE SPACES.            02930000
           05  FILLER              PIC X(17)   VALUE                    02940000
               '¦  BATCH NO    : '.                                     02950000
           05  L314-BATCH-NO       PIC X(14)   VALUE SPACES.            02960000
           05  FILLER              PIC X(4)    VALUE SPACES.            02970000
           05  FILLER              PIC X(1)    VALUE '¦'.               02980000
                                                                        02990000
       01  L314-PR-HDG-05.                                              03000000
           05  FILLER              PIC X(46)   VALUE SPACES.            03010000
           05  FILLER              PIC X(1)    VALUE '¦'.               03020000
           05  FILLER              PIC X(48)   VALUE SPACES.            03030000
           05  FILLER              PIC X(1)    VALUE '¦'.               03040000
           05  FILLER              PIC X(34)   VALUE SPACES.            03050000
           05  FILLER              PIC X(1)    VALUE '¦'.               03060000
                                                                        03070000
       01  L314-PR-HDG-06.                                              03080000
           05  FILLER              PIC X(46)   VALUE 'SYSTEM CODE : 04'.03090000
           05  FILLER              PIC X(14)   VALUE '¦ CHECKED BY :'.  03100000
           05  FILLER              PIC X(35)   VALUE SPACES.            03110000
           05  FILLER              PIC X(17)   VALUE '¦  VOUCHER NO  :'.03120000
           05  L314-VOUCHER-NO     PIC X(11)   VALUE SPACES.            03130000
           05  FILLER              PIC X(7)    VALUE SPACES.            03140000
           05  FILLER              PIC X(1)    VALUE '¦'.               03150000
                                                                        03160000
       01  L314-PR-HDG-07.                                              03170000
           05  FILLER              PIC X(46)   VALUE                    03180000
              'GL CODE     : 0000000104250'.                            03190000
           05  FILLER              PIC X(85)   VALUE ALL '-'.           03200000
                                                                        03210000
       01  L314-PR-HDG-08.                                              03220000
           05  FILLER              PIC X(46)   VALUE                    03230000
              'DESCRIPTION : STAMP FEES'.                               03240000
                                                                        03250000
       01  L314-PR-HDG-09.                                              03260000
           05  FILLER              PIC X(53)   VALUE                    03270000
              'PAYABLE TO  : COMMISSIONER OF STAMP DUTIES         '.    03280000
           05  FILLER              PIC X(13)   VALUE  SPACES.           03290000
           05  FILLER              PIC X(20)   VALUE                    03300000
              'BANK   : DBS        '.                                   03310000
           05  FILLER              PIC X(11)   VALUE  SPACES.           03320000
           05  FILLER              PIC X(25)   VALUE                    03330000
              'BANK CODE   : DBSSSGSGXXX'.                              03340000
                                                                        03350000
       01  L314-PR-HDG-09A.                                             03360000
           05  FILLER              PIC X(24)   VALUE                    03370000
              'A/C NO      : 0010468600'.                               03380000
           05  FILLER              PIC X(42)   VALUE  SPACES.           03390000
                                                                        03400000
       01  L314-PR-HDG-10.                                              03410000
           05  FILLER              PIC X(11)   VALUE                    03420000
               'REMITTANCE '.                                           03430000
           05  FILLER              PIC X(55)   VALUE                    03440000
              'ADVICE  DESPATCH TO :  C/O SC(STAMPING) OF SALES UNIT'.  03450000
                                                                        03460000
       01  L314-PR-HDG-11.                                              03470000
           05  FILLER              PIC X(3)    VALUE 'NO.'.             03480000
           05  FILLER              PIC X(4)    VALUE SPACES.            03490000
           05  FILLER              PIC X(11)   VALUE                    03500000
               'SCH-ACCT-NO'.                                           03510000
           05  FILLER              PIC X(5)    VALUE SPACES.            03520000
           05  FILLER              PIC X(7)    VALUE 'REGN NO'.         03530000
           05  FILLER              PIC X(3)    VALUE SPACES.            03540000
           05  FILLER              PIC X(3)    VALUE 'BLK'.             03550000
           05  FILLER              PIC X(4)    VALUE SPACES.            03560000
           05  FILLER              PIC X(24)   VALUE                    03570000
               'FLAT ADDRESS/STREET NAME'.                              03580000
           05  FILLER              PIC X(3)    VALUE SPACES.            03590000
           05  FILLER              PIC X(7)    VALUE 'FLAT NO'.         03600000
           05  FILLER              PIC X(5)    VALUE SPACES.            03610000
           05  FILLER              PIC X(7)    VALUE 'DATE OF'.         03620000
           05  FILLER              PIC X(8)    VALUE SPACES.            03630000
           05  FILLER              PIC X(12)   VALUE 'ACTUAL LEASE'.    03640000
           05  FILLER              PIC X(8)    VALUE SPACES.            03650000
           05  FILLER              PIC X(3)    VALUE 'DUP'.             03660000
           05  FILLER              PIC X(10)   VALUE SPACES.            03670000
           05  FILLER              PIC X(10)   VALUE 'TOTAL'.           03680000
                                                                        03690000
       01  L314-PR-HDG-12.                                              03700000
           05  FILLER              PIC X(79)   VALUE SPACES.            03710000
           05  FILLER              PIC X(9)    VALUE 'AGR ORDER'.       03720000
           05  FILLER              PIC X(8)    VALUE SPACES.            03730000
           05  FILLER              PIC X(9)    VALUE 'STAMP FEE'.       03740000
           05  FILLER              PIC X(8)    VALUE SPACES.            03750000
           05  FILLER              PIC X(5)    VALUE 'LEASE'.           03760000
                                                                        03770000
       01  L314-PR-DETAIL.                                              03780000
           05  L314-NO             PIC ZZZ9.                            03790000
           05  FILLER              PIC X(2)    VALUE SPACES.            03800000
           05  L314-SCH-ACC.                                            03810000
               10 L314-SCH-1-4     PIC X(4)    VALUE SPACES.            03820000
               10 FILLER           PIC X(1)    VALUE '-'.               03830000
               10 L314-SCH-5-8     PIC X(4)    VALUE SPACES.            03840000
               10 FILLER           PIC X(1)    VALUE '-'.               03850000
               10 L314-SCH-9-9     PIC X(1)    VALUE SPACE.             03860000
               10 FILLER           PIC X(1)    VALUE '-'.               03870000
               10 L314-SCH-10-11   PIC X(2)    VALUE SPACES.            03880000
           05  FILLER              PIC X(2)    VALUE SPACES.            03890000
           05  L314-REGN-NO        PIC X(8)    VALUE SPACES.            03900000
           05  FILLER              PIC X(2)    VALUE SPACES.            03910000
           05  L314-BLK-NO         PIC X(5)    VALUE SPACES.            03920000
           05  FILLER              PIC X(3)    VALUE SPACES.            03930000
           05  L314-STREET         PIC X(23)   VALUE SPACES.            03940000
           05  FILLER              PIC X(4)    VALUE SPACES.            03950000
           05  L314-FLAT-NO.                                            03960000
               10  FILLER          PIC X(1)    VALUE '#'.               03970000
               10  L314-LEVEL-NO   PIC X(2)    VALUE SPACES.            03980000
               10  FILLER          PIC X(1)    VALUE '-'.               03990000
               10  L314-UNIT-NO    PIC X(4)    VALUE SPACES.            04000000
           05  FILLER              PIC X(4)    VALUE SPACES.            04010000
           05  L314-AGR-ORDER-DATE PIC X(12)   VALUE SPACES.            04020000
           05  FILLER              PIC X(4)    VALUE SPACES.            04030000
           05  L314-LEASE          PIC -$$$,$$9.99.                     04040000
           05  FILLER              PIC X(6)    VALUE SPACES.            04050000
           05  L314-DUP-LEASE      PIC $$9.99.                          04060000
           05  FILLER              PIC X(2)    VALUE SPACES.            04070000
           05  L314-DETL-TOTAL     PIC -$$$$,$$9.99.                    04080000
                                                                        04090000
       01  L314-PR-TOTAL-LINE.                                          04100000
           05  FILLER              PIC X(39)   VALUE SPACES.            04110000
           05  FILLER              PIC X(13)   VALUE '(SERIAL NO : '.   04120000
           05  L314-VR-NO-LOW      PIC X(4)    VALUE '0001'.            04130000
           05  FILLER              PIC X(4)    VALUE ' TO '.            04140000
           05  L314-VR-NO-HIGH     PIC X(4)    VALUE '0010'.            04150000
           05  FILLER              PIC X(1)    VALUE ')'.               04160000
           05  FILLER              PIC X(13)   VALUE SPACES.            04170000
           05  FILLER              PIC X(16)   VALUE 'TOTAL : '.        04180000
           05  L314-TOTAL-ACTUAL   PIC -$$$$,$$9.99.                    04190000
           05  FILLER              PIC X(5)    VALUE SPACES.            04200000
           05  L314-TOTAL-DUP      PIC $$$9.99.                         04210000
           05  L314-TOTAL-LEASE    PIC -$$,$$$,$$9.99.                  04220000
                                                                        04230000
       01  L314-PR-DASH-LINE.                                           04240000
           05  FILLER              PIC X(94)   VALUE SPACES.            04250000
           05  FILLER              PIC X(38)   VALUE ALL '-'.           04260000
                                                                        04270000
       01  L314-PR-FTG-01.                                              04280000
           05  FILLER              PIC X(15)   VALUE 'NET PAYABLE  : '. 04290000
           05  L314-AMT-WORDS.                                          04300000
               10  L314-AMT-DESC1  PIC X(60)   VALUE SPACES.            04310000
               10  L314-AMT-DESC2  PIC X(60)   VALUE SPACES.            04320000
                                                                        04330000
       01  L314-PR-FTG-02.                                              04340000
           05  FILLER              PIC X(39)   VALUE SPACES.            04350000
           05  FILLER              PIC X(14)   VALUE 'CHECKED BY : '.   04360000
           05  FILLER              PIC X(21)   VALUE ALL '_'.           04370000
           05  FILLER              PIC X(4)    VALUE SPACES.            04380000
           05  FILLER              PIC X(16)   VALUE 'CERTIFIED BY : '. 04390000
           05  FILLER              PIC X(21)   VALUE ALL '_'.           04400000
                                                                        04410000
      *-----------------------------------------------------------*     04420000
      *    DEFINE P13L314B REPORT LINES                           *     04430000
      *-----------------------------------------------------------*     04440000
       01  L314B-HEADER1.                                               04450000
           05  FILLER              PIC X(8)    VALUE 'P13L314B'.        04460000
           05  FILLER              PIC X(10)   VALUE '      HDB3'.      04470000
           05  FILLER              PIC X(28)   VALUE SPACES.            04480000
           05  FILLER              PIC X(39)   VALUE                    04490000
               'S Y S T E M   O F   C O M M I T M E N T'.               04500000
           05  FILLER              PIC X(12)   VALUE SPACES.            04510000
           05  FILLER              PIC X(7)    VALUE 'DATE : '.         04520000
           05  L314B-DATE          PIC X(10)   VALUE SPACES.            04530000
           05  FILLER              PIC X(6)    VALUE SPACES.            04540000
           05  FILLER              PIC X(7)    VALUE 'PAGE : '.         04550000
           05  L314B-PAGE          PIC ZZZZ9.                           04560000
                                                                        04570000
       01  L314B-HEADER2.                                               04580000
           05  FILLER                    PIC X(47) VALUE SPACES.        04590000
           05  FILLER                    PIC X(35)  VALUE               04600000
               'REPORT ON CASES WITH EARMARK ERROR'.                    04610000
                                                                        04620000
       01  L314B-HEADER3.                                               04630000
           05  FILLER               PIC X(4)  VALUE 'S/NO'.             04640000
           05  FILLER               PIC X(3)  VALUE SPACE.              04650000
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.       04660000
           05  FILLER               PIC X(9)  VALUE SPACES.             04670000
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.          04680000
           05  FILLER               PIC X(5)  VALUE SPACE.              04690000
           05  FILLER               PIC X(13) VALUE 'JR VOUCHER NO'.    04700000
           05  FILLER               PIC X(5)  VALUE SPACES.             04710000
           05  FILLER               PIC X(12) VALUE 'TOTAL AMOUNT'.     04720000
           05  FILLER               PIC X(4)  VALUE SPACES.             04730000
           05  FILLER               PIC X(17) VALUE 'ERROR DESCRIPTION'.04740000
                                                                        04750000
       01  L314B-REC-DETAIL.                                            04760000
           05  L314B-SERIAL-NO              PIC ZZZ9.                   04770000
           05  FILLER                       PIC X(3)  VALUE SPACE.      04780000
           05  L314B-SCH-ACC                PIC X(14) VALUE SPACES.     04790000
           05  FILLER                       PIC X(5)  VALUE SPACE.      04800000
           05  L314B-REGN-NO                PIC X(8)  VALUE SPACES.     04810000
           05  FILLER                       PIC X(5)  VALUE SPACE.      04820000
           05  L314B-JR-VCHR-NO             PIC X(13) VALUE SPACES.     04830000
           05  FILLER                       PIC X(5)  VALUE SPACES.     04840000
           05  L314B-AMT-TOTAL              PIC $$$$,$$9.99.            04850000
           05  FILLER                       PIC X(5)  VALUE SPACES.     04860000
           05  L314B-ERROR-DESC             PIC X(30).                  04870000
                                                                        04880000
       01  L314B-UNDERLINE                  PIC X(132) VALUE ALL '-'.   04890000
                                                                        04900000
      *----------------------------------------------------------*      04910000
      *    WS VARIABLES FOR CONVERTING AMOUNT TO WORDS           *      04920000
      *----------------------------------------------------------*      04930000
       01  WS-SUBSCRIPTS.                                               04940000
           05  WA-SUB              PIC 999   VALUE 0.                   04950000
           05  WF-SUB              PIC 999   VALUE 0.                   04960000
           05  WL-SUB              PIC 999   VALUE 0.                   04970000
           05  WS-SUB              PIC 999   VALUE 0.                   04980000
           05  WS-FIRST-SUB        PIC 999   VALUE 0.                   04990000
                                                                        05000000
       01  WA-NAMES.                                                    05010000
           05  FILLER              PIC X(10) VALUE '3ONE      '.        05020000
           05  FILLER              PIC X(10) VALUE '3TWO      '.        05030000
           05  FILLER              PIC X(10) VALUE '5THREE    '.        05040000
           05  FILLER              PIC X(10) VALUE '4FOUR     '.        05050000
           05  FILLER              PIC X(10) VALUE '4FIVE     '.        05060000
           05  FILLER              PIC X(10) VALUE '3SIX      '.        05070000
           05  FILLER              PIC X(10) VALUE '5SEVEN    '.        05080000
           05  FILLER              PIC X(10) VALUE '5EIGHT    '.        05090000
           05  FILLER              PIC X(10) VALUE '4NINE     '.        05100000
           05  FILLER              PIC X(10) VALUE '3TEN      '.        05110000
           05  FILLER              PIC X(10) VALUE '6ELEVEN   '.        05120000
           05  FILLER              PIC X(10) VALUE '6TWELVE   '.        05130000
           05  FILLER              PIC X(10) VALUE '8THIRTEEN '.        05140000
           05  FILLER              PIC X(10) VALUE '8FOURTEEN '.        05150000
           05  FILLER              PIC X(10) VALUE '7FIFTEEN  '.        05160000
           05  FILLER              PIC X(10) VALUE '7SIXTEEN  '.        05170000
           05  FILLER              PIC X(10) VALUE '9SEVENTEEN'.        05180000
           05  FILLER              PIC X(10) VALUE '8EIGHTEEN '.        05190000
           05  FILLER              PIC X(10) VALUE '8NINETEEN '.        05200000
           05  FILLER              PIC X(10) VALUE '6TWENTY   '.        05210000
           05  FILLER              PIC X(10) VALUE '6THIRTY   '.        05220000
           05  FILLER              PIC X(10) VALUE '5FORTY    '.        05230000
           05  FILLER              PIC X(10) VALUE '5FIFTY    '.        05240000
           05  FILLER              PIC X(10) VALUE '5SIXTY    '.        05250000
           05  FILLER              PIC X(10) VALUE '7SEVENTY  '.        05260000
           05  FILLER              PIC X(10) VALUE '6EIGHTY   '.        05270000
           05  FILLER              PIC X(10) VALUE '6NINETY   '.        05280000
       01  WA-NAMER REDEFINES WA-NAMES.                                 05290000
           05  WA-NAME             PIC X(10) OCCURS 27 TIMES.           05300000
                                                                        05310000
       01  WS-LITERALS.                                                 05320000
           05  L-CENT              PIC X(5)  VALUE '4CENT'.             05330000
           05  L-AND               PIC X(4)  VALUE '3AND'.              05340000
           05  L-X                 PIC X     VALUE '%'.                 05350000
           05  L-MILLION           PIC X(8)  VALUE '7MILLION'.          05360000
           05  L-THOUSAND          PIC X(9)  VALUE '8THOUSAND'.         05370000
           05  L-DOLLARS           PIC X(8)  VALUE '7DOLLARS'.          05380000
           05  L-CENTS             PIC X(6)  VALUE '6CENTS'.            05390000
           05  L-ONLY              PIC X(6)  VALUE '5ONLY '.            05400000
           05  L-HUNDRED           PIC X(8)  VALUE '7HUNDRED'.          05410000
           05  L-DOLLAR            PIC X(7)  VALUE '6DOLLAR'.           05420000
                                                                        05430000
       01  SWITCHES.                                                    05440000
           05  WS-SWITCH           PIC 9     VALUE 0.                   05450000
           05  WS-THO-SW           PIC 9     VALUE 0.                   05460000
           05  WS-CNT-SW           PIC 9     VALUE 0.                   05470000
           05  WS-LIT-SW           PIC 9     VALUE 0.                   05480000
           05  WS-TEN-SW           PIC 9     VALUE 0.                   05490000
           05  WS-AND-SW           PIC 9     VALUE 0.                   05500000
                                                                        05510000
       01  WS-PLACE-COUNTER        PIC 999   VALUE 0.                   05520000
       01  WL-AREA-SAVE            PIC X(12) VALUE SPACES.              05530000
       01  WS-L314-PR-HDG-01       PIC X(132) VALUE SPACES.             05540000
       01  WS-RESULT               PIC 999   VALUE 0.                   05550000
       01  WL-AREA.                                                     05560000
           05  WL-ITEM1            PIC 9     VALUE 0.                   05570000
           05  FILLER              PIC X(11) VALUE SPACE.               05580000
       01  WL-ITM REDEFINES WL-AREA.                                    05590000
           05  WL-ITEM             PIC X     OCCURS 12 TIMES.           05600000
                                                                        05610000
       01  WS-CHEQUE-DETAILS.                                           05620000
           05  WS-AMT              PIC 9(7)V99 VALUE 0.                 05630000
           05  WS-DIGIT REDEFINES  WS-AMT OCCURS 9 TIMES PIC 9.         05640000
           05  WF-DETAILS.                                              05650000
               10  WF-LINE-1       PIC X(60).                           05660000
               10  WF-LINE-2       PIC X(60).                           05670000
           05  WF-ITEM REDEFINES WF-DETAILS OCCURS 120 PIC X.           05680000
           05  WP-ITEM REDEFINES WF-DETAILS OCCURS 2 PIC X(60).         05690000
                                                                        05700000
      *----------------------------------------------------------*      05710000
      *      CONTROL FEILDS FOR HDB ASSESSMENT DATA FILE         *      05720000
      *----------------------------------------------------------*      05730000
       77  WS-LEASE                   PIC 9(13)V99 VALUE ZEROES.        05740000
                                                                        05750000
                                                                        05760000
      *------------------*                                              05770000
       PROCEDURE DIVISION.                                              05780000
      *------------------*                                              05790000
                                                                        05800000
      ******************************************************************05810000
       000-MAIN-ROUTINE.                                                05820000
      ******************************************************************05830000
                                                                        05840000
           PERFORM  100-OPEN-FILES     THRU  100-EXIT.                  05850000
           PERFORM  200-READ-BP13F315  THRU  200-EXIT.                  05860000
           PERFORM  300-MAIN-ROUTINE   THRU  300-EXIT UNTIL WS-F315-EOF.05870000
           IF WS-SEQ-NO-F225 NOT = ZEROES                               05880000
              PERFORM  770-WRITE-TRAILER-F225 THRU 770-EXIT             05890000
           END-IF.                                                      05900000
           PERFORM  900-CLOSE-FILES    THRU  900-EXIT.                  05910000
                                                                        05920000
       000-MAIN-EXIT.                                                   05930000
           EXIT.                                                        05940000
                                                                        05950000
                                                                        05960000
      ******************************************************************05970000
       100-OPEN-FILES.                                                  05980000
      ******************************************************************05990000
           OPEN INPUT  BP13F315                                         06000000
                       BP13K800                                         06010000
                       BP13K330                                         06020000
                I-O    BP13K625                                         06030000
                OUTPUT AG07F225                                         06040000
                       BP13L314                                         06050000
                       P13L314B.                                        06060000
                                                                        06070000
           IF BP13K800-STATUS NOT = 00 AND NOT = 97                     06080000
              DISPLAY 'OPENING ERROR, BP13K800-STATUS ' BP13K800-STATUS 06090000
              MOVE     BP13K800-STATUS    TO   RETURN-CODE              06100000
              PERFORM  900-CLOSE-FILES    THRU 900-EXIT                 06110000
           END-IF.                                                      06120000
                                                                        06130000
           IF BP13K330-STATUS NOT = 00 AND NOT = 97                     06140000
              DISPLAY 'OPENING ERROR, BP13K330-STATUS ' BP13K330-STATUS 06150000
              MOVE     BP13K330-STATUS    TO   RETURN-CODE              06160000
              PERFORM  900-CLOSE-FILES    THRU 900-EXIT                 06170000
           END-IF.                                                      06180000
                                                                        06190000
           IF BP13K625-STATUS NOT = 00 AND NOT = 97                     06200000
              DISPLAY 'OPENING ERROR, BP13K625-STATUS ' BP13K625-STATUS 06210000
              MOVE     BP13K625-STATUS    TO   RETURN-CODE              06220000
              PERFORM  900-CLOSE-FILES    THRU 900-EXIT                 06230000
           END-IF.                                                      06240000
                                                                        06250000
      * VOUCHER NUMBER                                                  06260000
           MOVE       'AG07K960'          TO   C907-NUM-FILENME.        06270000
                                                                        06280000
           CALL 'K960OPEN' USING AG07C907-AREA.                         06290000
                                                                        06300000
           IF C907-NUM-FILE-STATUS NOT = ('00' AND '97')                06310000
              DISPLAY 'ERROR OPENING AG07K960 = ' C907-NUM-FILE-STATUS  06320000
              MOVE     C907-NUM-FILE-STATUS  TO   WS-AG07-STAT-X        06330000
              MOVE     WS-AG07-STATUS        TO   RETURN-CODE           06340000
              PERFORM  900-CLOSE-FILES       THRU 900-EXIT              06350000
           END-IF.                                                      06360000
                                                                        06370000
      * BATCH NUMBER (14/07/1999-ROMAR)                                 06380000
           MOVE       'BP13K620'          TO   C906-NUM-FILENME.        06390000
                                                                        06400000
           CALL 'K620OPEN' USING BP13C906-AREA.                         06410000
                                                                        06420000
           IF C906-NUM-FILE-STATUS NOT = ('00' AND '97')                06430000
              DISPLAY 'ERROR OPENING BP13K620 = ' C906-NUM-FILE-STATUS  06440000
              MOVE     C906-NUM-FILE-STATUS  TO   RETURN-CODE           06450000
              PERFORM  900-CLOSE-FILES       THRU 900-EXIT              06460000
           END-IF.                                                      06470000
                                                                        06480000
      **CALL AB05C902 TO OPEN B05K006 AND AB05K009 FILES(CODE='O')      06490000
           MOVE SPACES              TO   WS-B902-AREA.                  06500000
           INITIALIZE                    WS-B902-AREA.                  06510000
           MOVE 'O'                 TO   B902-CDE-TYPE.                 06520000
           CALL 'AB05C902'  USING WS-B902-AREA.                         06530000
                                                                        06540000
           IF B902-CDE-ERROR NOT = ZEROES                               06550000
              MOVE B902-CDE-SYSERR  TO   RETURN-CODE                    06560000
              DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'             06570000
              PERFORM  900-CLOSE-FILES  THRU 900-EXIT                   06580000
           END-IF.                                                      06590000
                                                                        06600000
       100-EXIT.                                                        06610000
           EXIT.                                                        06620000
                                                                        06630000
                                                                        06640000
      ******************************************************************06650000
       200-READ-BP13F315.                                               06660000
      ******************************************************************06670000
                                                                        06680000
           READ BP13F315                                                06690000
                AT END MOVE 'Y' TO WS-F315-EOF-IND                      06700000
                GO TO  200-EXIT.                                        06710000
                                                                        06720000
           ADD 1 TO WS-CNT-F315-READ.                                   06730000
                                                                        06740000
       200-EXIT.                                                        06750000
           EXIT.                                                        06760000
                                                                        06770000
                                                                        06780000
      ******************************************************************06790000
       300-MAIN-ROUTINE.                                                06800000
      ******************************************************************06810000
      *------------------------------------------------------------*    06820000
      *    1. READ FILE BP13F315.                                  *    06830000
      *    2. RETRIEVE FLAT'S DETAIL FROM BP13F315.                *    06840000
      *    3. READ K800 SOC MASTER TO RETRIEVE K800-AMT-LEASE-FEE. *    06850000
      *    4. PRINT LIST OF PAYMENT FOR STAMPING.                  *    06860000
      *------------------------------------------------------------*    06870000
                                                                        06880000
           MOVE    F315-REGN-NO       TO    K800-NUM-REGN.              06890000
           PERFORM 400-READ-BP13K800  THRU  400-EXIT.                   06900000
           MOVE    F315-SCH-ACC       TO    WS-SCH-ACC.                 06910000
           MOVE    F315-NUM-BLK       TO    L314-BLK-NO.                06920000
           MOVE    F315-NME-STREET    TO    L314-STREET.                06930000
           MOVE    F315-NUM-MAIN      TO    L314-UNIT-NO.               06940000
           MOVE    F315-NUM-LEVEL     TO    L314-LEVEL-NO.              06950000
           MOVE    F315-REGN-NO       TO    L314-REGN-NO.               06960000
                                                                        06970000
           MOVE    WS-SCH-1-4         TO    L314-SCH-1-4.               06980000
           MOVE    WS-SCH-5-8         TO    L314-SCH-5-8.               06990000
           MOVE    WS-SCH-9-9         TO    L314-SCH-9-9.               07000000
           MOVE    WS-SCH-10-11       TO    L314-SCH-10-11.             07010000
                                                                        07020000
      ******** 14/07/1999 - ROMAR                                       07030000
                                                                        07040000
           IF WS-NEW-BATCH-NO = 'Y'                                     07050000
              MOVE  'SA  '      TO C906-NUM-BATCH-TYPE                  07060000
              MOVE  'BP13K620'  TO C906-NUM-FILENME                     07070000
                                                                        07080000
              CALL  'BP13C906'  USING BP13C906-AREA                     07090000
                                                                        07100000
              IF C906-NUM-FILE-STATUS =  '00'                           07110000
                 MOVE C906-NUM-BATCH-TYPE      TO  WS-NUM-BATCH-TYPE    07120000
                 MOVE C906-NUM-FIN-YEAR        TO  WS-NUM-FIN-YEAR      07130000
                 MOVE C906-NUM-BATCH-SERIAL    TO  WS-NUM-BATCH-SERIAL  07140000
                 MOVE       'N'                TO  WS-NEW-BATCH-NO      07150000
              ELSE                                                      07160000
                 DISPLAY 'ERROR CALLING BP13C906, '                     07170000
                         'FILE STATUS = '    C906-NUM-FILE-STATUS       07180000
                 MOVE     C906-NUM-FILE-STATUS TO RETURN-CODE           07190000
                 PERFORM  900-CLOSE-FILES                               07200000
              END-IF                                                    07210000
           END-IF.                                                      07220000
                                                                        07230000
           IF WS-NEW-VOUCHER-F225 = 'Y'                                 07240000
      *          MOVE  'SU '      TO C907-NUM-DDD                       07250000
                 MOVE  'SS '      TO C907-NUM-DDD                       07260000
                 MOVE  'AG07K960' TO C907-NUM-FILENME                   07270000
                                                                        07280000
                 CALL 'AG07C907'  USING AG07C907-AREA                   07290000
                                                                        07300000
                 IF C907-NUM-FILE-STATUS =  '00'                        07310000
                    PERFORM  750-WRITE-HEADER-F225 THRU 750-EXIT        07320000
                    MOVE 'N'           TO   WS-NEW-VOUCHER-F225         07330000
                 ELSE                                                   07340000
                    DISPLAY 'ERROR CALLING AG07C907, '                  07350000
                            'FILE STATUS = '    C907-NUM-FILE-STATUS    07360000
                    MOVE     C907-NUM-FILE-STATUS TO WS-AG07-STAT-X     07370000
                    MOVE     WS-AG07-STATUS       TO RETURN-CODE        07380000
                    PERFORM  900-CLOSE-FILES                            07390000
                 END-IF                                                 07400000
           END-IF.                                                      07410000
                                                                        07420000
           PERFORM  450-EARMARK-ACCOUNT      THRU 450-EXIT.             07430000
           IF B902-CDE-SYSERR NOT = ZEROES                              07440000
              DISPLAY 'ERROR CALLING AB05C902, STATUS = '               07450000
                       B902-CDE-SYSERR                                  07460000
              MOVE     '99'                 TO RETURN-CODE              07470000
              PERFORM  900-CLOSE-FILES                                  07480000
           END-IF.                                                      07490000
                                                                        07500000
           IF B902-CDE-ERROR-ACCT(1) = SPACES                           07510000
                                                                        07520000
              PERFORM 650-WRITE-STAMPING-FILE  THRU  650-EXIT           07530000
              PERFORM 760-WRITE-F225-DETAIL THRU 760-EXIT               07540000
                                                                        07550000
              IF WS-SEQ-NO-F225 = 25                                    07560000
                PERFORM 770-WRITE-TRAILER-F225 THRU 770-EXIT            07570000
                MOVE   'Y'                  TO    WS-NEW-VOUCHER-F225   07580000
                MOVE    ZEROES              TO    WS-SEQ-NO-F225        07590000
                MOVE    ZEROES              TO    WS-NET-AMT-F225       07600000
              END-IF                                                    07610000
           END-IF.                                                      07620000
                                                                        07630000
           PERFORM  200-READ-BP13F315        THRU  200-EXIT.            07640000
                                                                        07650000
       300-EXIT.                                                        07660000
           EXIT.                                                        07670000
                                                                        07680000
                                                                        07690000
      ******************************************************************07700000
       400-READ-BP13K800.                                               07710000
      ******************************************************************07720000
      *------------------------------------------------------------*    07730000
      *    READ APPLICATION MASTER TO GET ACTUAL LEASE STAMP FEE   *    07740000
      *------------------------------------------------------------*    07750000
           READ BP13K800.                                               07760000
                                                                        07770000
           IF BP13K800-STATUS = 00                                      07780000
              IF F315-REGN-NO = '2801109A'                              07790000
                 MOVE 343.00             TO   K800-AMT-LEASE-FEE        07800000
                 MOVE '20170428'         TO   K800-DTE-RAISE-AO         07810000
              END-IF                                                    07820000
      * TESTING ONLY                                                    07830000
      *       MOVE 'N' TO K800-NUM-RELEASE-PAYMENT                      07840000
              IF   K800-NUM-RELEASE-PAYMENT NOT = 'Y'                   07850000
                   PERFORM 660-READ-BP13K330  THRU  660-EXIT            07860000
                   PERFORM 665-MOVE-DUPLICATE THRU  665-EXIT            07870000
              ADD  1                     TO   WS-CNT-K800-READ          07880000
              MOVE K800-DTE-RAISE-AO     TO   WS-AO-DATE                07890000
              MOVE WS-AO-DD              TO   WS-DD                     07900000
              MOVE WS-AO-MM              TO   WS-MM                     07910000
              MOVE WS-AO-YEAR            TO   WS-YEAR                   07920000
              MOVE WS-DATE               TO   L314-AGR-ORDER-DATE       07930000
                                                                        07940000
              IF F315-AMT-LEASE-FEE NOT NUMERIC                         07950000
                 MOVE ZEROES TO F315-AMT-LEASE-FEE                      07960000
              END-IF                                                    07970000
                                                                        07980000
              IF F315-AMT-LEASE-FEE-DUP NOT NUMERIC                     07990000
                 MOVE ZEROES TO F315-AMT-LEASE-FEE-DUP                  08000000
              END-IF                                                    08010000
                                                                        08020000
              IF F315-NUM-ADHOC-SF = SPACES                             08030000
                 COMPUTE WS-COMP-TOT-LEASE = K800-AMT-LEASE-FEE -       08040000
                                             WS-DEF-DUP-LEASE           08050000
                 MOVE WS-COMP-TOT-LEASE     TO   L314-LEASE             08060000
                 ADD  WS-COMP-TOT-LEASE     TO   WS-TOTAL-ACTUAL-LEASE  08070000
                 MOVE WS-DEF-DUP-LEASE      TO   L314-DUP-LEASE         08080000
                 ADD  WS-DEF-DUP-LEASE      TO   WS-TOTAL-DUP-LEASE     08090000
                 MOVE K800-AMT-LEASE-FEE    TO   L314-DETL-TOTAL        08100000
                 ADD  K800-AMT-LEASE-FEE    TO   WS-TOTAL-LEASE         08110000
              ELSE                                                      08120000
                 COMPUTE WS-COMP-TOT-LEASE = F315-AMT-LEASE-FEE         08130000
                 MOVE WS-COMP-TOT-LEASE      TO   L314-LEASE            08140000
                 ADD  WS-COMP-TOT-LEASE      TO   WS-TOTAL-ACTUAL-LEASE 08150000
                 COMPUTE WS-DUP-LEASE  = F315-AMT-LEASE-FEE-DUP         08160000
                 MOVE WS-DUP-LEASE           TO   L314-DUP-LEASE        08170000
                 ADD  WS-DUP-LEASE           TO   WS-TOTAL-DUP-LEASE    08180000
                 COMPUTE L314-DETL-TOTAL = F315-AMT-LEASE-FEE +         08190000
                                           F315-AMT-LEASE-FEE-DUP       08200000
                 ADD  F315-AMT-LEASE-FEE     TO   WS-TOTAL-LEASE        08210000
                 ADD  F315-AMT-LEASE-FEE-DUP TO   WS-TOTAL-LEASE        08220000
              END-IF                                                    08230000
                                                                        08240000
              ELSE                                                      08250000
                 DISPLAY 'CASE ALREADY RELEASED, REGN NO = '            08260000
                          K800-NUM-REGN                                 08270000
                 MOVE     '99'               TO     RETURN-CODE         08280000
                 PERFORM  900-CLOSE-FILES    THRU   900-EXIT            08290000
           ELSE                                                         08300000
              IF BP13K800-STATUS = 23                                   08310000
                 DISPLAY 'K800 RECORD NOT FOUND. REGN NO = '            08320000
                          K800-NUM-REGN                                 08330000
                 MOVE ZEROES    TO  L314-LEASE                          08340000
                                    L314-DUP-LEASE                      08350000
                 MOVE     BP13K800-STATUS    TO     RETURN-CODE         08360000
                 PERFORM  900-CLOSE-FILES    THRU   900-EXIT            08370000
              ELSE                                                      08380000
                 DISPLAY 'ERROR READING, BP13K800 ' BP13K800-STATUS     08390000
                 MOVE     BP13K800-STATUS    TO     RETURN-CODE         08400000
                 PERFORM  900-CLOSE-FILES    THRU   900-EXIT.           08410000
                                                                        08420000
       400-EXIT.                                                        08430000
           EXIT.                                                        08440000
                                                                        08450000
                                                                        08460000
      ******************************************************************08470000
       450-EARMARK-ACCOUNT.                                             08480000
      ******************************************************************08490000
      **CALL AB05C902 TO EARMARK ACCOUNT(CODE='E')                      08500000
           MOVE SPACES              TO   WS-B902-AREA.                  08510000
           INITIALIZE                    WS-B902-AREA.                  08520000
                                                                        08530000
           STRING C907-NUM-DDD  C907-NUM-FIN-YR                         08540000
                  C907-NUM-VR-SERIAL                                    08550000
                  DELIMITED BY SIZE INTO B902-VR-NO                     08560000
           END-STRING.                                                  08570000
                                                                        08580000
           MOVE 'E'                     TO   B902-CDE-TYPE.             08590000
           MOVE 'BP13'                  TO   B902-CDE-SYSTEMID.         08600000
           MOVE FUNCTION CURRENT-DATE   TO   B902-DTE-TRANS.            08610000
           MOVE 'P13C314'               TO   B902-NUM-USERID-UPDATE.    08620000
           MOVE 'CV'                    TO   B902-CDE-EARMARK-REASON.   08630000
           MOVE 01                      TO   B902-NUM-HDB-REF-CNT.      08640000
           MOVE F315-SCH-ACC            TO   B902-NUM-HDB-REF(1).       08650000
           MOVE ZEROES                  TO   WS-AMT-EARMARK.            08660000
                                                                        08670000
           IF K800-AMT-LEASE-FEE NUMERIC                                08680000
              IF F315-NUM-ADHOC-SF = SPACES                             08690000
                 MOVE K800-AMT-LEASE-FEE TO  WS-AMT-EARMARK             08700000
              ELSE                                                      08710000
                 COMPUTE WS-AMT-EARMARK = F315-AMT-LEASE-FEE +          08720000
                                          F315-AMT-LEASE-FEE-DUP        08730000
              END-IF                                                    08740000
           ELSE                                                         08750000
              MOVE ZEROES             TO  WS-AMT-EARMARK                08760000
           END-IF.                                                      08770000
                                                                        08780000
           MOVE WS-AMT-EARMARK          TO   B902-AMT-EARMARK(1).       08790000
                                                                        08800000
           DISPLAY '----------------'.                                  08810000
           DISPLAY 'B902-VR-NO       = ' B902-VR-NO.                    08820000
           DISPLAY 'B902-CDE-TYPE    = ' B902-CDE-TYPE.                 08830000
           DISPLAY 'CDE-SYSTEMID     = ' B902-CDE-SYSTEMID.             08840000
           DISPLAY 'B902-DTE-TRANS   = ' B902-DTE-TRANS.                08850000
           DISPLAY 'NUM-USERID       = ' B902-NUM-USERID-UPDATE.        08860000
           DISPLAY 'HDB-REF-CNT      = ' B902-NUM-HDB-REF-CNT.          08870000
           DISPLAY 'NUM-HDB-REF      = ' B902-NUM-HDB-REF(1).           08880000
           DISPLAY 'B902-AMT-EARMARK = ' B902-AMT-EARMARK(1).           08890000
                                                                        08900000
           CALL 'AB05C902'  USING WS-B902-AREA.                         08910000
                                                                        08920000
           DISPLAY 'CDE-ERROR-ACCT   = ' B902-CDE-ERROR-ACCT(1).        08930000
                                                                        08940000
           EVALUATE B902-CDE-ERROR-ACCT(1)                              08950000
              WHEN SPACES                                               08960000
                 CONTINUE                                               08970000
              WHEN OTHER                                                08980000
                 COMPUTE WS-TOTAL-LEASE = WS-TOTAL-LEASE -              08990000
                                          WS-AMT-EARMARK                09000000
                 COMPUTE WS-TOTAL-ACTUAL-LEASE =                        09010000
                         WS-TOTAL-ACTUAL-LEASE - WS-AMT-EARMARK         09020000
                 PERFORM 850-PRINT-L314B-REPORT     THRU 850-EXIT       09030000
           END-EVALUATE.                                                09040000
                                                                        09050000
       450-EXIT.                                                        09060000
           EXIT.                                                        09070000
                                                                        09080000
                                                                        09090000
      ******************************************************************09100000
       520-PRINT-HEADING.                                               09110000
      ******************************************************************09120000
      *------------------------------------------------------------*    09130000
      *    PRINT HEADING LINE                                      *    09140000
      *------------------------------------------------------------*    09150000
           MOVE   SPACES            TO    L314-PRINT-REC.               09160000
           ADD    1                 TO    WS-NO-OF-PAGE.                09170000
           MOVE   WS-NO-OF-PAGE     TO    L314-PAGE.                    09180000
           MOVE   FUNCTION CURRENT-DATE(1:8)                            09190000
                                    TO    WS-CURRENT-CCYYMMDD.          09200000
           MOVE   WS-CUR-DD         TO    WS-PC-DD.                     09210000
           MOVE   WS-CUR-MM         TO    WS-PC-MM.                     09220000
           MOVE   WS-CUR-CCYY       TO    WS-PC-CCYY.                   09230000
           MOVE   WS-PR-CUR-DATE    TO    L314-CURRENT-DATE.            09240000
                                                                        09250000
           STRING WS-NUM-BATCH-TYPE   DELIMITED BY SPACE                09260000
                  WS-NUM-FIN-YEAR     DELIMITED BY SPACE                09270000
                  '-'                 DELIMITED BY SIZE                 09280000
                  WS-NUM-BATCH-SERIAL DELIMITED BY SPACE                09290000
                  INTO L314-BATCH-NO                                    09300000
           END-STRING.                                                  09310000
                                                                        09320000
           MOVE   WS-NUM-VOUCHER    TO    L314-VOUCHER-NO.              09330000
                                                                        09340000
           MOVE L314-PR-HDG-01    TO WS-L314-PR-HDG-01                  09350000
           IF F315-NUM-ADHOC-SF = 'Y'                                   09360000
              MOVE '-B'           TO WS-L314-PR-HDG-01(9:2)             09370000
           ELSE                                                         09380000
              MOVE '-A'           TO WS-L314-PR-HDG-01(9:2)             09390000
           END-IF                                                       09400000
           WRITE  L314-PRINT-REC  FROM WS-L314-PR-HDG-01 AFTER PAGE.    09410000
                                                                        09420000
           MOVE "FINANCE'S COPY" TO L314-COPY-NAME                      09430000
           WRITE  L314-PRINT-REC  FROM L314-PR-HDG-02 AFTER 2.          09440000
           WRITE  L314-PRINT-REC  FROM L314-PR-HDG-03 AFTER 2.          09450000
           WRITE  L314-PRINT-REC  FROM L314-PR-HDG-04 AFTER 1.          09460000
           WRITE  L314-PRINT-REC  FROM L314-PR-HDG-05 AFTER 1.          09470000
           WRITE  L314-PRINT-REC  FROM L314-PR-HDG-05 AFTER 1.          09480000
           WRITE  L314-PRINT-REC  FROM L314-PR-HDG-06 AFTER 1.          09490000
           WRITE  L314-PRINT-REC  FROM L314-PR-HDG-07 AFTER 1.          09500000
           WRITE  L314-PRINT-REC  FROM L314-PR-HDG-08 AFTER 1.          09510000
           WRITE  L314-PRINT-REC  FROM L314-PR-HDG-09 AFTER 1.          09520000
           WRITE  L314-PRINT-REC  FROM L314-PR-HDG-09A AFTER 1.         09530000
           WRITE  L314-PRINT-REC  FROM L314-PR-HDG-10 AFTER 1.          09540000
           WRITE  L314-PRINT-REC  FROM L314-PR-HDG-11 AFTER 2.          09550000
           WRITE  L314-PRINT-REC  FROM L314-PR-HDG-12 AFTER 1.          09560000
                                                                        09570000
           MOVE   SPACES TO  L314-PRINT-REC.                            09580000
                                                                        09590000
           WRITE L314-PRINT-REC  AFTER 1.                               09600000
                                                                        09610000
       520-EXIT.                                                        09620000
           EXIT.                                                        09630000
                                                                        09640000
      ******************************************************************09650000
       620-PRINT-DETAIL.                                                09660000
      ******************************************************************09670000
      *------------------------------------------------------------*    09680000
      *    PRINT LIST OF PAYMENT FOR STAMPING                      *    09690000
      *------------------------------------------------------------*    09700000
                                                                        09710000
           ADD   1                   TO    WS-CNT-L314-WRITE.           09720000
           MOVE  WS-CNT-L314-DETLS   TO    L314-NO.                     09730000
           WRITE L314-PRINT-REC      FROM  L314-PR-DETAIL AFTER 1.      09740000
                                                                        09750000
           MOVE  SPACES              TO    L314-PRINT-REC.              09760000
                                                                        09770000
       620-EXIT.                                                        09780000
           EXIT.                                                        09790000
                                                                        09800000
                                                                        09810000
                                                                        09820000
      ******************************************************************09830000
       650-WRITE-STAMPING-FILE.                                         09840000
      ******************************************************************09850000
            DISPLAY '650-WRITE-STAMPING-FILE' F315-SCH-ACC.             09860000
            INITIALIZE BP13K625-REC.                                    09870000
            MOVE SPACES                 TO BP13K625-REC.                09880000
                                                                        09890000
            MOVE F315-SCH-ACC           TO WS-NUM-HDB-REF.              09900000
            MOVE 'ALE'                  TO WS-NUM-DOC.                  09910000
                                                                        09920000
      ****  WRITE DETAIL PART FOR ORIGINAL AGREEMENT LEASE*******       09930000
            MOVE 'O'                    TO WS-NUM-DOC-TYP.              09940000
                                                                        09950000
            DISPLAY 'DOC-TYPE = ' WS-NUM-DOC-TYP.                       09960000
            PERFORM 670-CHK-EXSTNG-BP13K625  THRU 670-EXIT.             09970000
            PERFORM 690-MAIN-DETAILS-TO-K625 THRU 690-EXIT.             09980000
                                                                        09990000
            IF F315-NUM-ADHOC-SF = SPACES                               10000000
               COMPUTE WS-LEASE          = K800-AMT-LEASE-FEE -         10010000
                                           WS-DEF-DUP-LEASE             10020000
            ELSE                                                        10030000
               COMPUTE WS-LEASE          = F315-AMT-LEASE-FEE           10040000
            END-IF.                                                     10050000
                                                                        10060000
            MOVE WS-LEASE               TO K625-AMT-STAMP-DUTY.         10070000
            MOVE ZEROES                 TO K625-AMT-STAMP-DUTY-DUP.     10080000
            DISPLAY 'DOC-TYPE = ' K625-NUM-DOC-TYP.                     10090000
            DISPLAY 'AMT      = ' K625-AMT-STAMP-DUTY.                  10100000
            ADD 1                       TO WS-CNT-K625-WRITE.           10110000
            WRITE BP13K625-REC.                                         10120000
                                                                        10130000
      ****  WRITE DETAIL PART FOR DUPLICATE AGREEMENT LEASE*******      10140000
            MOVE 'D'                    TO WS-NUM-DOC-TYP.              10150000
                                                                        10160000
            DISPLAY 'DOC-TYPE = ' WS-NUM-DOC-TYP.                       10170000
            PERFORM 670-CHK-EXSTNG-BP13K625  THRU 670-EXIT.             10180000
            PERFORM 690-MAIN-DETAILS-TO-K625 THRU 690-EXIT.             10190000
            IF F315-NUM-ADHOC-SF = SPACES                               10200000
               MOVE WS-DEF-DUP-LEASE  TO K625-AMT-STAMP-DUTY-DUP        10210000
            ELSE                                                        10220000
               COMPUTE K625-AMT-STAMP-DUTY-DUP = F315-AMT-LEASE-FEE-DUP 10230000
            END-IF.                                                     10240000
                                                                        10250000
            MOVE ZEROES                 TO K625-AMT-STAMP-DUTY.         10260000
                                                                        10270000
            DISPLAY 'DOC-TYPE = ' K625-NUM-DOC-TYP.                     10280000
            DISPLAY 'AMT      = ' K625-AMT-STAMP-DUTY.                  10290000
            ADD 1                       TO WS-CNT-K625-WRITE.           10300000
            WRITE BP13K625-REC.                                         10310000
                                                                        10320000
       650-EXIT.                                                        10330000
           EXIT.                                                        10340000
                                                                        10350000
                                                                        10360000
      ******************************************************************10370000
       660-READ-BP13K330.                                               10380000
      ******************************************************************10390000
      *------------------------------------------------------------*    10400000
      *    READ ACCUM SO MASTER TO GET ANNUAL RENT, PURCHASE PRICE,*    10410000
      *    AMT LOAN.                                               *    10420000
      *------------------------------------------------------------*    10430000
           MOVE K800-NUM-REGN          TO K330-CURR-REG.                10440000
           MOVE '1'                    TO K330-SEQ-NO.                  10450000
           READ BP13K330.                                               10460000
                                                                        10470000
           IF BP13K330-STATUS = 00                                      10480000
              ADD  1           TO  WS-CNT-K330-READ                     10490000
              IF K330-AMT-SC-CC1-NET NOT NUMERIC                        10500000
                MOVE ZEROES TO WS-ANNUAL-RENT                           10510000
              ELSE                                                      10520000
                COMPUTE WS-ANNUAL-RENT = (K330-AMT-SC-CC1-NET * 12) + 1 10530000
              END-IF                                                    10540000
           ELSE                                                         10550000
              IF K800-NUM-REGN = '3073443B' OR '2716623G'               10560000
                 CONTINUE                                               10570000
              ELSE                                                      10580000
              IF BP13K330-STATUS = 23                                   10590000
                 DISPLAY 'K330 RECORD NOT FOUND. REGN NO = '            10600000
                          K330-CURR-REG                                 10610000
                 MOVE     BP13K330-STATUS    TO     RETURN-CODE         10620000
                 PERFORM  900-CLOSE-FILES    THRU   900-EXIT            10630000
              ELSE                                                      10640000
                 DISPLAY 'ERROR READING, BP13K330 ' BP13K330-STATUS     10650000
                 MOVE     BP13K330-STATUS    TO     RETURN-CODE         10660000
                 PERFORM  900-CLOSE-FILES    THRU   900-EXIT.           10670000
                                                                        10680000
       660-EXIT.                                                        10690000
           EXIT.                                                        10700000
                                                                        10710000
                                                                        10720000
      ******************************************************************10730000
       665-MOVE-DUPLICATE.                                              10740000
      ******************************************************************10750000
           IF K800-DTE-RAISE-AO <= '20110218'                           10760000
              IF K330-NUM-SF-DISC = 'N'                                 10770000
                 MOVE 2.00 TO WS-DEF-DUP-LEASE                          10780000
                              WS-DUP-LEASE                              10790000
              ELSE                                                      10800000
                 MOVE 1.40 TO WS-DEF-DUP-LEASE                          10810000
                              WS-DUP-LEASE                              10820000
              END-IF                                                    10830000
           ELSE                                                         10840000
              MOVE 0.00    TO WS-DEF-DUP-LEASE                          10850000
                              WS-DUP-LEASE                              10860000
           END-IF.                                                      10870000
                                                                        10880000
       665-EXIT.                                                        10890000
           EXIT.                                                        10900000
                                                                        10910000
                                                                        10920000
      ******************************************************************10930000
       670-CHK-EXSTNG-BP13K625.                                         10940000
      ******************************************************************10950000
           MOVE WS-NUM-HDB-REF          TO K625-NUM-HDB-REF.            10960000
           MOVE WS-NUM-DOC              TO K625-NUM-DOC.                10970000
           MOVE WS-NUM-DOC-TYP          TO K625-NUM-DOC-TYP.            10980000
           MOVE 1                       TO K625-NUM-DOC-CNT.            10990000
           MOVE 'N'                     TO WS-K625-EOF.                 11000000
                                                                        11010000
           START BP13K625 KEY = K625-KEY-FLD.                           11020000
                                                                        11030000
           EVALUATE BP13K625-STATUS                                     11040000
              WHEN '00'                                                 11050000
                    PERFORM 680-READNEXT-BP13K625 THRU 680-EXIT         11060000
                            UNTIL WS-K625-EOF = 'Y'                     11070000
                    ADD  1              TO WS-NUM-DOC-CNT               11080000
              WHEN '10'                                                 11090000
              WHEN '23'                                                 11100000
                    MOVE 1              TO WS-NUM-DOC-CNT               11110000
              WHEN OTHER                                                11120000
                    DISPLAY 'ERROR WHILE STARTING BROWSE-BP13K625 '     11130000
                    MOVE BP13K625-STATUS TO RETURN-CODE                 11140000
                    PERFORM 900-CLOSE-FILES THRU 900-EXIT               11150000
           END-EVALUATE.                                                11160000
                                                                        11170000
       670-EXIT.                                                        11180000
           EXIT.                                                        11190000
                                                                        11200000
                                                                        11210000
      ******************************************************************11220000
       680-READNEXT-BP13K625.                                           11230000
      ******************************************************************11240000
           READ BP13K625 NEXT AT END MOVE 'Y' TO WS-K625-EOF            11250000
              GO TO 680-EXIT.                                           11260000
                                                                        11270000
           IF (K625-NUM-HDB-REF NOT = WS-NUM-HDB-REF) OR                11280000
              (K625-NUM-DOC     NOT = WS-NUM-DOC)     OR                11290000
              (K625-NUM-DOC-TYP NOT = WS-NUM-DOC-TYP)                   11300000
              MOVE 'Y'                   TO WS-K625-EOF                 11310000
              GO TO 680-EXIT                                            11320000
           END-IF.                                                      11330000
                                                                        11340000
           MOVE K625-NUM-DOC-CNT         TO WS-NUM-DOC-CNT.             11350000
                                                                        11360000
       680-EXIT.                                                        11370000
           EXIT.                                                        11380000
                                                                        11390000
                                                                        11400000
      ******************************************************************11410000
       690-MAIN-DETAILS-TO-K625.                                        11420000
      ******************************************************************11430000
            MOVE  SPACES                TO BP13K625-REC.                11440000
            INITIALIZE                     BP13K625-REC.                11450000
                                                                        11460000
            MOVE  F315-SCH-ACC          TO K625-NUM-HDB-REF.            11470000
            MOVE  'ALE'                 TO K625-NUM-DOC                 11480000
            MOVE  WS-NUM-DOC-TYP        TO K625-NUM-DOC-TYP.            11490000
            MOVE  WS-NUM-DOC-CNT        TO K625-NUM-DOC-CNT.            11500000
            MOVE  C907-NUM-DDD          TO K625-NUM-DDD.                11510000
            MOVE  C907-NUM-FIN-YR       TO K625-NUM-FIN-YEAR.           11520000
            MOVE  C907-NUM-VR-SERIAL    TO K625-NUM-VR-SERIAL.          11530000
            MOVE  C906-NUM-BATCH-TYPE   TO K625-NUM-BATCH-TYPE.         11540000
            MOVE  C906-NUM-FIN-YEAR     TO K625-NUM-CAL-YEAR.           11550000
            MOVE  C906-NUM-BATCH-SERIAL TO K625-NUM-BATCH-SERIAL.       11560000
            MOVE  K800-NUM-REGN         TO K625-NUM-REGN.               11570000
            MOVE  K800-DTE-RAISE-AO     TO K625-DTE-DOC-PREPARE         11580000
                                                                        11590000
            IF K800-NUM-REGN = '2716623G'                               11600000
               MOVE  373740.00            TO K625-AMT-PURCHASE-PRICE    11610000
               MOVE  739.00               TO K625-AMT-ANNUAL-RENT       11620000
            ELSE                                                        11630000
            IF K800-NUM-REGN = '3073443B'                               11640000
               MOVE  469620.00            TO K625-AMT-PURCHASE-PRICE    11650000
               MOVE  685.00               TO K625-AMT-ANNUAL-RENT       11660000
            ELSE                                                        11670000
               MOVE  K330-AMT-CURR-SELLPR  TO K625-AMT-PURCHASE-PRICE   11680000
               MOVE  WS-ANNUAL-RENT        TO K625-AMT-ANNUAL-RENT      11690000
            END-IF.                                                     11700000
                                                                        11710000
      *     MOVE  K330-AMT-CURR-SELLPR  TO K625-AMT-PURCHASE-PRICE.     11720000
      *     MOVE  WS-ANNUAL-RENT        TO K625-AMT-ANNUAL-RENT.        11730000
            MOVE  SPACES                TO K625-NUM-INCREASE-SCCC.      11740000
            MOVE  ZEROES                TO K625-AMT-LOAN.               11750000
            MOVE  'BP13C314'            TO K625-NUM-SYSTEM.             11760000
            MOVE  WS-CURRENT-CCYYMMDD   TO K625-DTE-UPDATE.             11770000
                                                                        11780000
            IF K800-NUM-FLAT-TYPE = SPACES OR LOW-VALUES                11790000
               MOVE  ZEROES             TO K625-NUM-LEASE-TERM          11800000
            ELSE                                                        11810000
               IF K800-NUM-FLAT-TYPE = '1A' OR '2A'                     11820000
                  COMPUTE K625-NUM-LEASE-TERM = 30 * 12                 11830000
               ELSE                                                     11840000
                  COMPUTE K625-NUM-LEASE-TERM = 99 * 12                 11850000
               END-IF                                                   11860000
            END-IF.                                                     11870000
                                                                        11880000
       690-EXIT.                                                        11890000
           EXIT.                                                        11900000
                                                                        11910000
      ******************************************************************11920000
       720-PRINT-TOTAL-LINE.                                            11930000
      ******************************************************************11940000
      *------------------------------------------------------------*    11950000
      *    PRINT TOTAL LEASE LINE                                  *    11960000
      *------------------------------------------------------------*    11970000
           IF WS-CNT-F315-READ = 0                                      11980000
              GO TO 720-EXIT                                            11990000
           END-IF.                                                      12000000
                                                                        12010000
           WRITE L314-PRINT-REC        FROM  L314-PR-DASH-LINE AFTER 3. 12020000
                                                                        12030000
           MOVE  SPACES                TO    L314-PRINT-REC.            12040000
           MOVE  WS-CNT-L314-DETLS     TO    L314-VR-NO-HIGH.           12050000
           MOVE  WS-TOTAL-ACTUAL-LEASE TO    L314-TOTAL-ACTUAL.         12060000
           MOVE  WS-TOTAL-DUP-LEASE    TO    L314-TOTAL-DUP.            12070000
           MOVE  WS-TOTAL-LEASE        TO    L314-TOTAL-LEASE.          12080000
                                                                        12090000
           WRITE L314-PRINT-REC       FROM   L314-PR-TOTAL-LINE AFTER 1.12100000
                                                                        12110000
           MOVE  SPACES                TO    L314-PRINT-REC.            12120000
           WRITE L314-PRINT-REC       FROM   L314-PR-DASH-LINE AFTER 1. 12130000
                                                                        12140000
       720-EXIT.                                                        12150000
           EXIT.                                                        12160000
                                                                        12170000
                                                                        12180000
      ******************************************************************12190000
       750-WRITE-HEADER-F225.                                           12200000
      ******************************************************************12210000
           INITIALIZE    AG07F225-HEADER.                               12220000
           MOVE SPACES                    TO AG07F225-HEADER.           12230000
           MOVE C907-NUM-DDD              TO F225-NUM-DDD               12240000
           MOVE C907-NUM-FIN-YR           TO F225-NUM-FIN-YEAR          12250000
           MOVE C907-NUM-VR-SERIAL        TO F225-NUM-VR-SERIAL         12260000
           MOVE F225-NUM-VR               TO WS-NUM-VOUCHER-F225        12270000
           MOVE 00                        TO F225-NUM-REC-TYP.          12280000
           MOVE 'PV'                      TO F225-NUM-VR-TYP.           12290000
           MOVE 'TL'                      TO F225-NUM-VR-SUB-TYP.       12300000
           MOVE 'SOC     '                TO F225-NUM-TRANS-TYP.        12310000
           MOVE SPACES                    TO F225-NUM-ROOT-ACCT.        12320000
           MOVE  FUNCTION CURRENT-DATE(1:8) TO                          12330000
                                             WS-CURRENT-CCYYMMDD.       12340000
           MOVE WS-CURRENT-CCYYMMDD       TO F225-DTE-VR-CREATE         12350000
                                             F225-DTE-VR-PRT-FINAL      12360000
           MOVE 'BP13C314'                TO F225-NUM-VR-CREATE-USERID  12370000
                                          F225-NUM-VR-PRT-FINAL-USERID  12380000
           MOVE 'DBSSSGSGXXX'             TO F225-NUM-PAYEE-BANK        12390000
           MOVE SPACES                    TO F225-NUM-PAYEE-BANK-BRNCH  12400000
           MOVE '0010468600'              TO F225-NUM-PAYEE-IBG-ACCT.   12410000
           MOVE 'STPFEE  '                TO F225-NUM-DDD-FILE-REF.     12420000
           MOVE 'COMMISSIONER OF STAMP DUTIES'                          12430000
                                          TO F225-NME-PAYEE1.           12440000
           MOVE SPACES                    TO F225-NUM-PAYEE-UIN1.       12450000
           MOVE SPACES                    TO F225-NME-PAYEE2.           12460000
           MOVE SPACES                    TO F225-NUM-PAYEE-UIN2.       12470000
           MOVE SPACES                    TO F225-NUM-PAYEE-TAX-REGN.   12480000
           MOVE '55'                      TO F225-NUM-BLK-HSE.          12481001
           MOVE 'NEWTON ROAD'             TO F225-NME-STREET.           12482001
           MOVE 'REVENUE HOUSE'           TO F225-NME-BLDNG.            12483001
           MOVE '307987'                  TO F225-NUM-POSTAL.           12484001
      *    MOVE 'C/O SC(STAMPING) OF SALES UNIT'                        12490001
      *                                   TO F225-NME-STREET            12500001
           MOVE FUNCTION CURRENT-DATE(1:8) TO                           12510000
                                             WS-CURRENT-CCYYMMDD.       12520000
           MOVE 'SALES AGREEMENT TEAM'    TO F225-NME-COLL-OFFCR.       12530000
           MOVE '64903783'                TO F225-NUM-COLL-OFFCR-PHONE. 12540000
           MOVE 'SALES AGREEMENT TEAM'    TO F225-NME-CONTACT-OFFCR.    12550000
           MOVE '64903783'                TO F225-NUM-CONTACT-PHONE.    12560000
           MOVE SPACES                    TO F225-TXT-REJECT-HDR.       12570000
           MOVE 'STPFEE  '                TO F225-NUM-INTRFC-FR-HDR.    12580000
           MOVE 'CV'                      TO F225-NUM-ACTION-TYP.       12590000
           MOVE SPACES                    TO F225-NUM-PRCS-TERM.        12600000
           MOVE SPACES                    TO F225-NUM-ROUTE-FLAG.       12610000
           MOVE 'Y'                   TO F225-CDE-EARMARK-STAMP-FEE.    12620000
           IF F315-USERID   = 'BP13P001'                                12630000
              MOVE WS-STAFF-START         TO F225-NUM-STAFF-ID-PREP     12640000
                                             F225-NUM-USERID-START      12650000
           ELSE                                                         12660000
              MOVE F315-USERID            TO F225-NUM-STAFF-ID-PREP     12670000
                                             F225-NUM-USERID-START      12680000
           END-IF.                                                      12690000
           MOVE 'PREP'                    TO F225-NUM-VCHR-STATE-START. 12700000
           MOVE SPACES                    TO F225-DTE-PYMNT-DUE.        12710000
                                                                        12720000
           WRITE AG07F225-HEADER.                                       12730000
           ADD      1                     TO WS-CNT-F225-WRITE.         12740000
           PERFORM  520-PRINT-HEADING   THRU   520-EXIT.                12750000
                                                                        12760000
       750-EXIT.                                                        12770000
           EXIT.                                                        12780000
                                                                        12790000
      ******************************************************************12800000
       760-WRITE-F225-DETAIL.                                           12810000
      ******************************************************************12820000
           INITIALIZE  AG07F225-TRANS.                                  12830000
           MOVE        SPACES               TO AG07F225-TRANS.          12840000
           ADD         1                    TO WS-SEQ-NO-F225.          12850000
           ADD         1                    TO WS-CNT-L314-DETLS.       12860000
           MOVE        WS-NUM-VOUCHER-F225  TO F225-NUM-VR-T.           12870000
           MOVE        WS-SEQ-NO-F225       TO F225-NUM-TRANS-SERIAL.   12880000
           MOVE        '04'                 TO F225-NUM-SYS.            12890000
           MOVE        F315-SCH-ACC         TO F225-NUM-HDB-REF         12900000
           MOVE '0000000104250'             TO F225-NUM-GL-ACCT.        12910000
           MOVE SPACES                      TO F225-NUM-TAX-CDE.        12920000
                                                                        12930000
           IF F315-NUM-ADHOC-SF = SPACES                                12940000
                 MOVE K800-AMT-LEASE-FEE    TO F225-AMT-TRANS           12950000
              ELSE                                                      12960000
                COMPUTE     F225-AMT-TRANS = F315-AMT-LEASE-FEE +       12970000
                                           F315-AMT-LEASE-FEE-DUP       12980000
           END-IF                                                       12990000
           IF F225-AMT-TRANS NOT NUMERIC                                13000000
              DISPLAY 'F225-AMT-TRANS NOT NUMERIC:' F225-AMT-TRANS      13010000
              MOVE ZEROES TO F225-AMT-TRANS                             13020000
           END-IF.                                                      13030000
                                                                        13040000
           COMPUTE WS-NET-AMT-F225 = F225-AMT-TRANS + WS-NET-AMT-F225.  13050000
           MOVE        'D'                 TO  F225-NUM-TRANS-DR-CR.    13060000
           MOVE        ZEROS               TO  F225-AMT-TRANS-GST.      13070000
           MOVE        F315-REGN-NO        TO  F225-TXT-INFO.           13080000
           MOVE        SPACES              TO  F225-NUM-CPF.            13090000
           MOVE        SPACES              TO  F225-TXT-REJECT-DTL.     13100000
           MOVE        'STPFEE  '          TO  F225-NUM-INTRFC-FR-T.    13110000
           WRITE       AG07F225-TRANS.                                  13120000
                                                                        13130000
           ADD         1                   TO WS-CNT-F225-WRITE.        13140000
           PERFORM 620-PRINT-DETAIL   THRU  620-EXIT.                   13150000
                                                                        13160000
       760-EXIT.                                                        13170000
           EXIT.                                                        13180000
                                                                        13190000
      ******************************************************************13200000
       770-WRITE-TRAILER-F225.                                          13210000
      ******************************************************************13220000
                                                                        13230000
           IF WS-SEQ-NO-F225  = ZEROES                                  13240000
              GO TO 770-EXIT                                            13250000
           END-IF.                                                      13260000
                                                                        13270000
           INITIALIZE AG07F225-TRAILER.                                 13280000
           MOVE       SPACES              TO  AG07F225-TRAILER.         13290000
                                                                        13300000
           MOVE  WS-NUM-VOUCHER-F225      TO  F225-NUM-VR-R.            13310000
           MOVE       99                  TO  F225-NUM-TRAILER-SERIAL.  13320000
           MOVE 'PAYMENT FOR LEASE/MORTGAGE STAMP FEES'                 13330000
                                    TO  F225-TXT-VOUCHER-NARRATION      13340000
           MOVE       WS-SEQ-NO-F225      TO  F225-QTY-VR-TRANS.        13350000
           MOVE       WS-NET-AMT-F225     TO  F225-AMT-VR-DR-TOTAL.     13360000
           MOVE       ZEROES              TO  F225-AMT-VR-CR-TOTAL.     13370000
           MOVE       SPACES              TO  F225-TXT-REJECT-TLR.      13380000
           MOVE       'STPFEE  '          TO  F225-NUM-INTRFC-FR.       13390000
                                                                        13400000
           WRITE      AG07F225-TRAILER.                                 13410000
                                                                        13420000
           ADD        1                   TO       WS-CNT-F225-WRITE.   13430000
           MOVE      'Y'                  TO       WS-NEW-VOUCHER-F225. 13440000
           PERFORM  720-PRINT-TOTAL-LINE  THRU   720-EXIT.              13450000
           PERFORM  800-PRINT-FOOTING     THRU   800-EXIT.              13460000
           MOVE     0   TO WS-CNT-L314-DETLS                            13470000
                           WS-TOTAL-ACTUAL-LEASE                        13480000
                           WS-TOTAL-DUP-LEASE                           13490000
                           WS-TOTAL-LEASE.                              13500000
           MOVE    'Y'  TO WS-NEW-VOUCHER-F225                          13510000
                           WS-NEW-BATCH-NO                              13520000
                           WS-NEW-HEADER.                               13530000
                                                                        13540000
       770-EXIT.                                                        13550000
           EXIT.                                                        13560000
                                                                        13570000
      ******************************************************************13580000
       800-PRINT-FOOTING.                                               13590000
      ******************************************************************13600000
           MOVE    WS-TOTAL-LEASE       TO    WS-AMT.                   13610000
           PERFORM 9000-CONVT-AMT-WORD  THRU  9000-EXIT.                13620000
           MOVE    WP-ITEM (1)          TO    L314-AMT-DESC1.           13630000
           MOVE    WP-ITEM (2)          TO    L314-AMT-DESC2.           13640000
                                                                        13650000
           WRITE  L314-PRINT-REC        FROM  L314-PR-FTG-01   AFTER 2. 13660000
           WRITE  L314-PRINT-REC        FROM  L314-PR-FTG-02   AFTER 5. 13670000
                                                                        13680000
       800-EXIT.                                                        13690000
           EXIT.                                                        13700000
                                                                        13710000
                                                                        13720000
      ******************************************************************13730000
       850-PRINT-L314B-REPORT.                                          13740000
      ******************************************************************13750000
           IF WS-L314B-REC-ON-PAGE-CNT > 65                             13760000
              PERFORM 851-PRINT-L416-HEADER     THRU 851-EXIT           13770000
           END-IF.                                                      13780000
                                                                        13790000
           MOVE SPACES                TO L314B-REC-DETAIL.              13800000
           INITIALIZE                    L314B-REC-DETAIL.              13810000
           ADD  1                     TO WS-L314B-PRINT-CNT.            13820000
           MOVE WS-L314B-PRINT-CNT    TO L314B-SERIAL-NO.               13830000
                                                                        13840000
           STRING F315-SCH-ACC(1:4) '-'                                 13850000
                  F315-SCH-ACC(5:4) '-'                                 13860000
                  F315-SCH-ACC(9:1) '-'                                 13870000
                  F315-SCH-ACC(10:2)                                    13880000
                  DELIMITED BY SIZE INTO L314B-SCH-ACC                  13890000
           END-STRING.                                                  13900000
                                                                        13910000
           MOVE F315-REGN-NO      TO L314B-REGN-NO.                     13920000
           STRING C907-NUM-DDD    '-'                                   13930000
                  C907-NUM-FIN-YR   '-'                                 13940000
                  C907-NUM-VR-SERIAL                                    13950000
                  DELIMITED BY SIZE INTO L314B-JR-VCHR-NO               13960000
           END-STRING.                                                  13970000
           MOVE WS-AMT-EARMARK    TO L314B-AMT-TOTAL.                   13980000
                                                                        13990000
           EVALUATE B902-CDE-ERROR-ACCT(1)                              14000000
              WHEN 'S0045'                                              14010000
                 MOVE 'B05K006 FILE ERROR'         TO L314B-ERROR-DESC  14020000
              WHEN 'S0052'                                              14030000
                 MOVE 'INVALID INPUT      '        TO L314B-ERROR-DESC  14040000
              WHEN 'S0053'                                              14050000
                 MOVE 'AB05K009 FILE ERROR'        TO L314B-ERROR-DESC  14060000
              WHEN 'S0054'                                              14070000
                 MOVE 'B05K006 REC NOT FND'        TO L314B-ERROR-DESC  14080000
              WHEN 'S0055'                                              14090000
                 MOVE 'DOESN''T HAVE ENOUGH BALANCE'                    14100000
                                                   TO L314B-ERROR-DESC  14110000
              WHEN OTHER                                                14120000
                 MOVE 'AB05C902 SUBROUTINE ERROR'  TO L314B-ERROR-DESC  14130000
           END-EVALUATE.                                                14140000
                                                                        14150000
           WRITE L314B-PRINT-REC  FROM L314B-REC-DETAIL  AFTER 1.       14160000
                                                                        14170000
           ADD   1     TO  WS-L314B-REC-ON-PAGE-CNT.                    14180000
                                                                        14190000
       850-EXIT.                                                        14200000
           EXIT.                                                        14210000
                                                                        14220000
                                                                        14230000
      ******************************************************************14240000
       851-PRINT-L416-HEADER.                                           14250000
      ******************************************************************14260000
           MOVE   FUNCTION CURRENT-DATE(1:8)                            14270000
                                    TO    WS-CURRENT-CCYYMMDD.          14280000
           MOVE   WS-CUR-DD         TO    WS-PC-DD.                     14290000
           MOVE   WS-CUR-MM         TO    WS-PC-MM.                     14300000
           MOVE   WS-CUR-CCYY       TO    WS-PC-CCYY.                   14310000
           MOVE   WS-PR-CUR-DATE    TO    L314B-DATE.                   14320000
                                                                        14330000
           ADD  1      TO WS-L314B-PAGE-CNT.                            14340000
           MOVE WS-L314B-PAGE-CNT    TO  L314B-PAGE.                    14350000
           WRITE L314B-PRINT-REC  FROM L314B-HEADER1     AFTER PAGE.    14360000
           WRITE L314B-PRINT-REC  FROM L314B-HEADER2     AFTER 2.       14370000
           WRITE L314B-PRINT-REC  FROM L314B-HEADER3     AFTER 2.       14380000
           WRITE L314B-PRINT-REC  FROM L314B-UNDERLINE   AFTER 1.       14390000
           MOVE  6     TO  WS-L314B-REC-ON-PAGE-CNT.                    14400000
                                                                        14410000
       851-EXIT.                                                        14420000
           EXIT.                                                        14430000
                                                                        14440000
                                                                        14450000
      ******************************************************************14460000
       900-CLOSE-FILES.                                                 14470000
      ******************************************************************14480000
      *------------------------------------------------------------*    14490000
      *    CLOSE FILES AND END PROCESSING                          *    14500000
      *------------------------------------------------------------*    14510000
           CLOSE BP13F315                                               14520000
                 BP13K800                                               14530000
                 BP13K330                                               14540000
                 BP13K625                                               14550000
                 AG07F225                                               14560000
                 BP13L314                                               14570000
                 P13L314B.                                              14580000
                                                                        14590000
           IF BP13K800-STATUS NOT = 00                                  14600000
              DISPLAY 'CLOSING ERROR, BP13K800-STATUS ' BP13K800-STATUS 14610000
              MOVE     BP13K800-STATUS TO RETURN-CODE                   14620000
           END-IF.                                                      14630000
                                                                        14640000
           IF BP13K330-STATUS NOT = 00                                  14650000
              DISPLAY 'CLOSING ERROR, BP13K330-STATUS ' BP13K330-STATUS 14660000
              MOVE     BP13K330-STATUS TO RETURN-CODE                   14670000
           END-IF.                                                      14680000
                                                                        14690000
           IF BP13K625-STATUS NOT = 00                                  14700000
              DISPLAY 'CLOSING ERROR, BP13K625-STATUS ' BP13K625-STATUS 14710000
              MOVE     BP13K625-STATUS TO RETURN-CODE                   14720000
           END-IF.                                                      14730000
                                                                        14740000
           MOVE 'AG07K960' TO C907-NUM-FILENME.                         14750000
                                                                        14760000
           CALL 'K960CLSE' USING AG07C907-AREA.                         14770000
                                                                        14780000
           IF C907-NUM-FILE-STATUS NOT = ('00' AND '97')                14790000
              DISPLAY 'ERROR CLOSING AG07K960 = ' C907-NUM-FILE-STATUS  14800000
              MOVE     C907-NUM-FILE-STATUS TO WS-AG07-STAT-X           14810000
              MOVE     WS-AG07-STATUS       TO RETURN-CODE              14820000
           END-IF.                                                      14830000
                                                                        14840000
           MOVE 'BP13K620' TO C906-NUM-FILENME.                         14850000
                                                                        14860000
           CALL 'K620MCLS' USING BP13C906-AREA.                         14870000
                                                                        14880000
           IF C906-NUM-FILE-STATUS NOT = ('00' AND '97')                14890000
              DISPLAY 'ERROR CLOSING BP13K620 = ' C906-NUM-FILE-STATUS  14900000
              MOVE     C906-NUM-FILE-STATUS TO RETURN-CODE              14910000
           END-IF.                                                      14920000
                                                                        14930000
      **CALL AB05C902 TO CLOSE B05K006 AND AB05K009 FILES(CODE='C')     14940000
           MOVE SPACES              TO   WS-B902-AREA.                  14950000
           INITIALIZE                    WS-B902-AREA.                  14960000
           MOVE 'C'                 TO   B902-CDE-TYPE.                 14970000
           CALL 'AB05C902'  USING WS-B902-AREA.                         14980000
                                                                        14990000
           IF B902-CDE-ERROR NOT = ZEROES                               15000000
              MOVE B902-CDE-SYSERR  TO   RETURN-CODE                    15010000
              DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'             15020000
           END-IF.                                                      15030000
                                                                        15040000
                                                                        15050000
           DISPLAY '                                   '.               15060000
           DISPLAY '******   BP13C314 CONTROL TOTALS   ******'.         15070000
           DISPLAY '                                   '.               15080000
           DISPLAY 'NO OF RECORDS READ FROM DAILY TRANS (BP13F315)  = ' 15090000
                    WS-CNT-F315-READ.                                   15100000
           DISPLAY 'NO OF RECORDS READ FROM RFF MASTER  (BP13K800)  = ' 15110000
                    WS-CNT-K800-READ.                                   15120000
           DISPLAY 'NO OF RECORDS READ FROM ACCUMSO FILE(BP13K330)  = ' 15130000
                    WS-CNT-K330-READ.                                   15140000
           DISPLAY 'NO OF RECORDS WRITTEN  (BP13K625)               = ' 15150000
                    WS-CNT-K625-WRITE.                                  15160000
           DISPLAY 'NO OF PAYMENTS WRITTEN (BP13L314)               = ' 15170000
                    WS-CNT-L314-WRITE.                                  15180000
           DISPLAY 'NO OF PAYMENTS WRITTEN (AG07F225)               = ' 15190000
                    WS-CNT-F225-WRITE.                                  15200000
           DISPLAY 'NO OF RECS WITH ERROR IN EARMARK                = ' 15210000
                    WS-L314B-PRINT-CNT.                                 15220000
                                                                        15230000
           STOP RUN.                                                    15240000
                                                                        15250000
       900-EXIT.                                                        15260000
           EXIT.                                                        15270000
                                                                        15280000
                                                                        15290000
      ******************************************************************15300000
       9000-CONVT-AMT-WORD.                                             15310000
      ******************************************************************15320000
      *------------------------------------------------------------*    15330000
      *     OBJECTIVE  :  CONVERSION FROM AMOUNT IN DIGITS         *    15340000
      *                              INTO AMOUNT IN WORDS          *    15350000
      *------------------------------------------------------------*    15360000
            MOVE SPACES TO WF-DETAILS.                                  15370000
            MOVE ZERO   TO WS-SWITCH                                    15380000
                           WS-THO-SW                                    15390000
                           WS-CNT-SW                                    15400000
                           WS-LIT-SW                                    15410000
                           WS-TEN-SW                                    15420000
                           WS-AND-SW.                                   15430000
            MOVE 60     TO WS-PLACE-COUNTER.                            15440000
            MOVE 1      TO WF-SUB.                                      15450000
                                                                        15460000
            PERFORM B000-ROUTINE THRU B990-EXIT                         15470000
                         VARYING WS-SUB FROM 1 BY 1 UNTIL WS-SUB = 10.  15480000
                                                                        15490000
       9000-EXIT.                                                       15500000
            EXIT.                                                       15510000
                                                                        15520000
                                                                        15530000
      ******************************************************************15540000
       B000-ROUTINE SECTION.                                            15550000
      ******************************************************************15560000
       B000-GO.                                                         15570000
            IF WS-DIGIT (WS-SUB) = ZERO                                 15580000
                 IF WS-TEN-SW = ZERO                                    15590000
                    GO TO B800-MOVE-TYPE                                15600000
                 ELSE                                                   15610000
                    GO TO B010-PROCESS.                                 15620000
                                                                        15630000
            IF WS-FIRST-SUB = ZERO                                      15640000
               MOVE WS-SUB TO WS-FIRST-SUB.                             15650000
                                                                        15660000
            IF WS-SWITCH = ZERO                                         15670000
               MOVE 1 TO WS-SWITCH.                                     15680000
                                                                        15690000
       B010-PROCESS.                                                    15700000
            IF WS-SUB = 8                                               15710000
               MOVE 9 TO WS-CNT-SW.                                     15720000
                                                                        15730000
            IF WS-SUB = 9                                               15740000
               IF WS-CNT-SW = ZERO                                      15750000
                  MOVE WS-DIGIT (WS-SUB) TO WS-CNT-SW.                  15760000
                                                                        15770000
            IF WS-SUB = 2 OR 3 OR 4                                     15780000
               MOVE 1 TO WS-THO-SW.                                     15790000
                                                                        15800000
            MOVE WS-DIGIT (WS-SUB) TO WA-SUB.                           15810000
            IF WS-SUB = 3 OR 6 OR 8                                     15820000
               IF WS-DIGIT (WS-SUB) = 1                                 15830000
                  MOVE 1 TO WS-TEN-SW                                   15840000
                  GO TO B990-EXIT                                       15850000
               ELSE                                                     15860000
                  ADD 18 TO WA-SUB                                      15870000
            ELSE                                                        15880000
            IF WS-SUB = 1 OR 4 OR 7 OR 9                                15890000
               IF WS-TEN-SW = 1                                         15900000
                  MOVE 0 TO WS-TEN-SW                                   15910000
                  ADD 10 TO WA-SUB.                                     15920000
            MOVE WA-NAME (WA-SUB) TO WL-AREA.                           15930000
            PERFORM R000-LOAD-IN.                                       15940000
                                                                        15950000
       B300-TENS.                                                       15960000
            IF WS-SUB = 3 OR 6 OR 8                                     15970000
               GO TO B990-EXIT.                                         15980000
                                                                        15990000
       B400-MOVE-HUNDRED.                                               16000000
            IF WS-SUB = 2 OR 5                                          16010000
               MOVE L-HUNDRED TO WL-AREA                                16020000
               MOVE 1 TO WS-LIT-SW                                      16030000
               PERFORM R000-LOAD-IN                                     16040000
               MOVE 1 TO WS-AND-SW                                      16050000
               GO TO B990-EXIT.                                         16060000
                                                                        16070000
       B800-MOVE-TYPE.                                                  16080000
            IF WS-SWITCH = ZERO                                         16090000
               GO TO B990-EXIT.                                         16100000
                                                                        16110000
            IF WS-SUB = 1                                               16120000
               MOVE  L-MILLION TO WL-AREA                               16130000
               MOVE  1         TO WS-LIT-SW                             16140000
               MOVE  1         TO WS-AND-SW                             16150000
               GO TO B880-LOAD-IN.                                      16160000
                                                                        16170000
            IF WS-SUB = 7                                               16180000
               MOVE 1 TO WS-LIT-SW WS-AND-SW                            16190000
               IF WS-FIRST-SUB = 7  AND                                 16200000
                  WS-DIGIT (WS-SUB) = 1                                 16210000
                  MOVE L-DOLLAR TO WL-AREA                              16220000
                  GO TO B880-LOAD-IN                                    16230000
               ELSE                                                     16240000
                  MOVE L-DOLLARS TO WL-AREA                             16250000
                  GO TO B880-LOAD-IN.                                   16260000
                                                                        16270000
            IF WS-SUB = 4 AND WS-THO-SW = 1                             16280000
               MOVE 1 TO WS-AND-SW WS-LIT-SW                            16290000
               MOVE L-THOUSAND TO WL-AREA                               16300000
               GO TO B880-LOAD-IN.                                      16310000
                                                                        16320000
            IF WS-SUB = 9                                               16330000
               MOVE 1 TO WS-LIT-SW                                      16340000
               IF WS-CNT-SW = ZERO                                      16350000
                  MOVE L-ONLY TO WL-AREA                                16360000
                  GO TO B880-LOAD-IN                                    16370000
               ELSE                                                     16380000
               IF WS-CNT-SW = 1                                         16390000
                  MOVE L-CENT TO WL-AREA                                16400000
                  PERFORM R000-LOAD-IN                                  16410000
                  MOVE L-ONLY TO WL-AREA                                16420000
                  GO TO B880-LOAD-IN                                    16430000
               ELSE                                                     16440000
                  MOVE L-CENTS TO WL-AREA                               16450000
                  PERFORM R000-LOAD-IN                                  16460000
                  MOVE L-ONLY TO WL-AREA                                16470000
                  GO TO B880-LOAD-IN.                                   16480000
            GO TO B990-EXIT.                                            16490000
                                                                        16500000
       B880-LOAD-IN.                                                    16510000
            PERFORM R000-LOAD-IN.                                       16520000
                                                                        16530000
       B990-EXIT.                                                       16540000
            EXIT.                                                       16550000
                                                                        16560000
      ******************************************************************16570000
       R000-LOAD-IN SECTION.                                            16580000
      ******************************************************************16590000
      *------------------------------------------------------------*    16600000
      *     THIS SECTION LOADS THE WORDS INTO THE THREE LINES      *    16610000
      *     AND JUST KEEPS INCREMENTING A SUBSCRIPT.               *    16620000
      *------------------------------------------------------------*    16630000
                                                                        16640000
       R001-GO.                                                         16650000
            IF WS-LIT-SW = 1                                            16660000
               MOVE ZERO TO WS-LIT-SW                                   16670000
               GO TO R050-CONT.                                         16680000
                                                                        16690000
            IF WS-SUB = 2 OR 5                                          16700000
               GO TO R050-CONT.                                         16710000
                                                                        16720000
       R025-ADD-TEST.                                                   16730000
            IF WS-AND-SW NOT = 1                                        16740000
               GO TO R050-CONT.                                         16750000
                                                                        16760000
            MOVE ZERO TO WS-AND-SW.                                     16770000
            MOVE WL-AREA TO WL-AREA-SAVE.                               16780000
            MOVE L-AND TO WL-AREA.                                      16790000
            PERFORM R200-LOADUP.                                        16800000
            MOVE WL-AREA-SAVE TO WL-AREA.                               16810000
                                                                        16820000
       R050-CONT.                                                       16830000
            PERFORM R200-LOADUP.                                        16840000
                                                                        16850000
       R099-EXIT.                                                       16860000
            EXIT.                                                       16870000
                                                                        16880000
      ******************************************************************16890000
       R200-LOADUP SECTION.                                             16900000
      ******************************************************************16910000
       R201-GO.                                                         16920000
            ADD WL-ITEM1 WF-SUB GIVING WS-RESULT.                       16930000
            IF  WS-RESULT > WS-PLACE-COUNTER                            16940000
                ADD 1 WS-PLACE-COUNTER GIVING WF-SUB                    16950000
                ADD 60 TO WS-PLACE-COUNTER.                             16960000
                                                                        16970000
            PERFORM R500-LOAD VARYING WL-SUB FROM 2 BY 1 UNTIL          16980000
                    WL-ITEM (WL-SUB) = L-X.                             16990000
                                                                        17000000
       R490-EXIT.                                                       17010000
           EXIT.                                                        17020000
                                                                        17030000
      ******************************************************************17040000
       R500-LOAD SECTION.                                               17050000
      ******************************************************************17060000
       R501-GO.                                                         17070000
                                                                        17080000
            MOVE WL-ITEM (WL-SUB) TO WF-ITEM (WF-SUB).                  17090000
            ADD  1                TO WF-SUB.                            17100000
            IF WL-ITEM (WL-SUB) = SPACE                                 17110000
               ADD   1     TO     WL-SUB                                17120000
               MOVE  L-X   TO     WL-ITEM (WL-SUB)                      17130000
               SUBTRACT 1  FROM   WL-SUB.                               17140000
                                                                        17150000
       R990-EXIT.                                                       17160000
            EXIT.                                                       17170000
