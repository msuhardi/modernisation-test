      *--------------------------------------------------------------*  00010000
       IDENTIFICATION DIVISION.                                         00020000
      *--------------------------------------------------------------*  00030000
       PROGRAM-ID.    BP13C147.                                         00040000
      *AUTHOR.        SK                                                00050000
      *DATE-WRITTEN.  24JUN2003.                                        00060000
      * ====================================================== *        00070000
      *                                                        *        00080000
      *    SYSTEM NAME : SYSTEM OF COMMITMENT  (SOC)           *        00090000
      *                                                        *        00100000
      *    SYSTEM ID   : BP13                                  *        00110000
      *                                                        *        00120000
      *    OBJECTIVES :                                        *        00130000
      *                                                        *        00140000
      *    1. UPDATE OF OIC FILE.                              *        00150000
      *    2. TO ASSIGN REGN TO OIC'S                          *        00160000
      *                                                        *        00170000
      *    INPUT FILES  : NIL                                  *        00180000
      *    I-O            BP13K022 - OIC FILE                  *        00190000
      *                                                        *        00200000
      *--------------------------------------------------------*        00210000
      * CHG-NO  BY  DATE      DETAILS                          *        00220000
      *=======  === ========= =================================*        00230000
      *BP132352 SK  20030624  NEW PGM                          *        00240000
      *BP133671 ZDD 20090824  INITIALIZE BP13K022 BEFORE       *        00241000
      *                       WRITING A RECORD                 *        00242000
      *========================================================*        00250000
       ENVIRONMENT DIVISION.                                            00260000
       CONFIGURATION SECTION.                                           00270000
       SOURCE-COMPUTER. IBM-4341.                                       00280000
       OBJECT-COMPUTER. IBM-4341.                                       00290000
       INPUT-OUTPUT SECTION.                                            00300000
       FILE-CONTROL.                                                    00310000
                                                                        00320000
           SELECT BP13K022 ASSIGN TO BP13K022                           00330000
                  ACCESS MODE     IS DYNAMIC                            00340000
                  ORGANIZATION    IS INDEXED                            00350000
                  RECORD KEY      IS K022-KEY-FLD                       00360000
                  ALTERNATE KEY   IS K022-NUM-REGN                      00370000
                  FILE STATUS     IS WS-K022-STATUS.                    00380000
                                                                        00390000
           SELECT BP13L147 ASSIGN TO BP13L147.                          00400000
                                                                        00410000
      *--------------------------------------------------------------*  00420000
       DATA DIVISION.                                                   00430000
       FILE SECTION.                                                    00440000
      *--------------------------------------------------------------*  00450000
                                                                        00460000
       FD   BP13K022                                                    00470000
            RECORD CONTAINS 100 CHARACTERS.                             00480000
       COPY BP13K022.                                                   00490000
                                                                        00500000
       FD   BP13L147                                                    00510000
            RECORD CONTAINS 132 CHARACTERS                              00520000
            RECORDING MODE  IS F.                                       00530000
       01   BP13L147-REC    PIC X(132).                                 00540000
                                                                        00550000
      *--------------------------------------------------------------*  00560000
       WORKING-STORAGE SECTION.                                         00570000
      *--------------------------------------------------------------*  00580000
                                                                        00590000
       01  WS-FILE-CONTROLS.                                            00600000
           05  WS-K022-FOUND              PIC X(1)  VALUE 'N'.          00610000
           05  WS-K022-EOF                PIC X(1)  VALUE 'N'.          00620000
           05  WS-K022-STATUS             PIC 9(2)  VALUE 0.            00630000
           05  WS-K024-STATUS             PIC 9(2)  VALUE 0.            00640000
                                                                        00650000
       01  WS-MISCELLANEOUS-VARS.                                       00660000
           05  WS-COUNTER                 PIC 9(1)  VALUE 1.            00670000
           05  WS-FLAG                    PIC X(1)  VALUE 'N'.          00680000
                                                                        00690000
           05  WS-EDITED-DATE             PIC X(10) VALUE SPACES.       00700000
           05  WS-CNT-PAIR                PIC 9(2)  VALUE 0.            00710000
           05  WS-CNT-ALLOC-CTR           PIC 9(6)  VALUE 0.            00720000
                                                                        00730000
           05  WS-TO-OIC                  PIC X(5)  VALUE SPACES.       00740000
           05  WS-FROM-OIC                PIC X(5)  VALUE SPACES.       00750000
           05  WS-NUM-REGN                PIC X(8)  VALUE SPACES.       00760000
           05  WS-NUM-ALLO-CAT            PIC X(3)  VALUE SPACES.       00770000
           05  WS-BANK-LOAN               PIC X(1)  VALUE SPACES.       00780000
                                                                        00790000
           05  WS-LAST-ALLOCAT            PIC X(3)  VALUE SPACES.       00800000
           05  WS-LAST-BANKLOAN           PIC X(1)  VALUE SPACES.       00810000
                                                                        00820000
       01  WS-SYSTEM-DATE.                                              00830000
           05  WS-SYS-CCYY                PIC 9(4).                     00840000
           05  WS-SYS-MM                  PIC 9(2).                     00850000
           05  WS-SYS-DD                  PIC 9(2).                     00860000
                                                                        00870000
       01  WS-REGN-ODD                    PIC X(40) VALUE               00880000
           '0000000100000003000000050000000700000009'.                  00890000
       01  WS-REGN1 REDEFINES WS-REGN-ODD.                              00900000
           05 WS-REGN-FROM OCCURS 5 TIMES.                              00910000
              10 WS-ODD-REGN              PIC X(8).                     00920000
                                                                        00930000
       01  WS-REGN-EVEN                   PIC X(40) VALUE               00940000
           '0000000200000004000000060000000800000010'.                  00950000
       01  WS-REGN2 REDEFINES WS-REGN-EVEN.                             00960000
           05 WS-REGN-TO   OCCURS 5 TIMES.                              00970000
              10 WS-EVEN-REGN             PIC X(8).                     00980000
                                                                        00990000
       01  WS-L147-CONTROLS.                                            01000000
           05 WS-CNT-LINE-ON-PAGE      PIC 9(8)    VALUE 66.            01010000
           05 WS-CNT-PRINT-L147        PIC 9(8)    VALUE 1.             01020000
           05 WS-CNT-WRITE-L147        PIC 9(8)    VALUE 0.             01030000
           05 WS-NO-OF-PAGE            PIC 9(8)    VALUE 0.             01040000
                                                                        01050000
      *--------------------------------------------------------------*  01060000
      *         BP13L147  -  R E P O R T    L A Y O U T              *  01070000
      *--------------------------------------------------------------*  01080000
                                                                        01090000
       01  L147-HEADER-01.                                              01100000
           05  FILLER              PIC X(08)     VALUE 'BP13L147'.      01110000
           05  FILLER              PIC X(04)     VALUE SPACES.          01120000
           05  FILLER              PIC X(08)     VALUE 'HDBCAT 3'.      01130000
           05  FILLER              PIC X(25)     VALUE SPACES.          01140000
           05  FILLER              PIC X(41)     VALUE                  01150000
               'S Y S T E M    O F    C O M M I T M E N T'.             01160000
           05  FILLER              PIC X(12)     VALUE SPACES.          01170000
           05  FILLER              PIC X(07)     VALUE 'DATE :'.        01180000
           05  L147-RUN-DATE       PIC X(10)     VALUE SPACES.          01190000
           05  FILLER              PIC X(02)     VALUE SPACES.          01200000
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.       01210000
           05  L147-PAGE-NO        PIC ZZZZ9 .                          01220000
                                                                        01230000
       01  L147-HEADER-02.                                              01240000
           05  FILLER              PIC X(46)     VALUE SPACES.          01250000
           05  FILLER              PIC X(55)     VALUE                  01260000
           'RE-ASSIGN OF REGISTRATION NUMBERS TO OIC'.                  01270000
                                                                        01280000
       01  L147-HEADER-03.                                              01290000
           05  FILLER              PIC X(05)     VALUE SPACES.          01300000
           05  FILLER              PIC X(05)     VALUE ' S/N '.         01310000
           05  FILLER              PIC X(03)     VALUE SPACES.          01320000
           05  FILLER              PIC X(15)     VALUE 'DELETED FROM'.  01330000
           05  FILLER              PIC X(03)     VALUE SPACES.          01340000
           05  FILLER              PIC X(11)     VALUE 'ASSIGNED TO'.   01350000
           05  FILLER              PIC X(03)     VALUE SPACES.          01360000
           05  FILLER              PIC X(10)     VALUE 'REGNO'.         01370000
           05  FILLER              PIC X(03)     VALUE SPACES.          01380000
           05  FILLER              PIC X(10)     VALUE 'ALLOC CAT'.     01390000
           05  FILLER              PIC X(03)     VALUE SPACES.          01400000
           05  FILLER              PIC X(10)     VALUE 'BANK LOAN'.     01410000
           05  FILLER              PIC X(05)     VALUE SPACES.          01420000
                                                                        01430000
       01  L147-HEADER-04.                                              01440000
           05  FILLER              PIC X(130)    VALUE ALL '-'.         01450000
                                                                        01460000
       01  L147-PR-DETAIL.                                              01470000
           05  FILLER              PIC X(03)     VALUE SPACES.          01480000
           05  L147-SLNO           PIC ZZZZ9.                           01490000
           05  FILLER              PIC X(08)     VALUE SPACES.          01500000
           05  L147-DEL-OIC        PIC X(05).                           01510000
           05  FILLER              PIC X(11)     VALUE SPACES.          01520000
           05  L147-ADD-OIC        PIC X(05).                           01530000
           05  FILLER              PIC X(08)     VALUE SPACES.          01540000
           05  L147-REGNO          PIC X(08).                           01550000
           05  FILLER              PIC X(08)     VALUE SPACES.          01560000
           05  L147-ALLO-CAT       PIC X(03).                           01570000
           05  FILLER              PIC X(11)     VALUE SPACES.          01580000
           05  L147-BNK-LOAN       PIC X(01).                           01590000
                                                                        01600000
      *--------------------------------------------------------------*  01610000
       PROCEDURE DIVISION.                                              01620000
      *--------------------------------------------------------------*  01630000
                                                                        01640000
      *--------------------------------------------------------------*  01650000
       0000-MAIN-ROUTINE.                                               01660000
      *--------------------------------------------------------------*  01670000
                                                                        01680000
           PERFORM 1000-OPEN-ROUTINE      THRU 1000-EXIT.               01690000
                                                                        01700000
           PERFORM 2000-PROCESS-OIC  THRU 2000-EXIT                     01710000
                VARYING WS-COUNTER FROM 1 BY 1                          01720000
                UNTIL WS-COUNTER > 5.                                   01730000
                                                                        01740000
           PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT.               01750000
                                                                        01760000
       0000-EXIT.                                                       01770000
           EXIT.                                                        01780000
                                                                        01790000
      *--------------------------------------------------------------*  01800000
       1000-OPEN-ROUTINE.                                               01810000
      *--------------------------------------------------------------*  01820000
                                                                        01830000
           OPEN I-O    BP13K022                                         01840000
                OUTPUT BP13L147.                                        01850000
                                                                        01860000
           IF WS-K022-STATUS NOT = 00 AND 97                            01870000
              DISPLAY 'BP13K022 OPEN ERROR, STATUS IS ' WS-K022-STATUS  01880000
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT             01890000
           END-IF.                                                      01900000
                                                                        01910000
                                                                        01920000
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-SYSTEM-DATE.           01930000
                                                                        01940000
           STRING WS-SYS-DD '-' WS-SYS-MM '-' WS-SYS-CCYY               01950000
                  DELIMITED BY SIZE                                     01960000
                  INTO WS-EDITED-DATE                                   01970000
           END-STRING.                                                  01980000
                                                                        01990000
       1000-EXIT.                                                       02000000
           EXIT.                                                        02010000
                                                                        02020000
      *--------------------------------------------------------------*  02030000
       2000-PROCESS-OIC.                                                02040000
      *--------------------------------------------------------------*  02050000
                                                                        02060000
           MOVE LOW-VALUES              TO K022-NUM-REGN.               02070000
                                                                        02080000
           MOVE SPACES                  TO WS-FROM-OIC                  02090000
                                           WS-TO-OIC                    02100000
                                           WS-NUM-REGN                  02110000
                                           WS-LAST-ALLOCAT              02120000
                                           WS-LAST-BANKLOAN.            02130000
           MOVE 'N'                     TO WS-K022-FOUND                02140000
                                           WS-FLAG                      02150000
                                           WS-K022-EOF.                 02160000
           MOVE WS-ODD-REGN(WS-COUNTER) TO WS-NUM-REGN                  02170000
                                           K022-NUM-REGN.               02180000
           PERFORM 2100-READ-K021-AIX   THRU 2100-EXIT.                 02190000
                                                                        02200000
           IF WS-K022-FOUND = 'Y'                                       02210000
              MOVE 'N'                      TO WS-K022-FOUND            02220000
              MOVE K022-NUM-OIC             TO WS-FROM-OIC              02230000
              MOVE K022-CDE-ALLO-CAT        TO WS-LAST-ALLOCAT          02240000
              MOVE K022-CDE-BANKLOAN        TO WS-LAST-BANKLOAN         02250000
              MOVE WS-EVEN-REGN(WS-COUNTER) TO WS-NUM-REGN              02260000
                                               K022-NUM-REGN            02270000
              PERFORM 2100-READ-K021-AIX    THRU 2100-EXIT              02280000
                                                                        02290000
              IF WS-K022-FOUND = 'Y'                                    02300000
                 ADD 1                    TO WS-CNT-PAIR                02310000
                 MOVE K022-NUM-OIC        TO WS-TO-OIC                  02320000
                 MOVE 'Y'                 TO WS-FLAG                    02330000
                 PERFORM 6000-DELETE      THRU 6000-EXIT                02340000
                 MOVE LOW-VALUES          TO WS-NUM-REGN                02350000
                 MOVE 1                   TO WS-CNT-PRINT-L147          02360000
                 MOVE 66                  TO WS-CNT-LINE-ON-PAGE        02370000
                 PERFORM 2200-READ-NEXT   THRU 2200-EXIT                02380000
                         UNTIL WS-K022-EOF = 'Y'                        02390000
              ELSE                                                      02400000
                 DISPLAY 'TO REGN NOT FOUND. REGN = ' WS-NUM-REGN       02410000
              END-IF                                                    02420000
           ELSE                                                         02430000
              DISPLAY 'FROM REGN NOT FOUND. REGN = ' WS-NUM-REGN        02440000
           END-IF.                                                      02450000
                                                                        02460000
       2000-EXIT.                                                       02470000
           EXIT.                                                        02480000
                                                                        02490000
      *--------------------------------------------------------------*  02500000
       2100-READ-K021-AIX.                                              02510000
      *--------------------------------------------------------------*  02520000
                                                                        02530000
           START BP13K022 KEY >= K022-NUM-REGN.                         02540000
                                                                        02550000
           IF WS-K022-STATUS = 00 OR 02                                 02560000
              READ BP13K022 NEXT RECORD                                 02570000
              IF WS-K022-STATUS = 00 OR 02                              02580000
                 IF K022-NUM-REGN = WS-NUM-REGN                         02590000
                    MOVE 'Y' TO WS-K022-FOUND                           02600000
                 ELSE                                                   02610000
                    MOVE 'N' TO WS-K022-FOUND                           02620000
                 END-IF                                                 02630000
              ELSE                                                      02640000
                 IF WS-K022-STATUS = 23                                 02650000
                    MOVE 'N' TO WS-K022-FOUND                           02660000
                 ELSE                                                   02670000
                    DISPLAY 'ERROR IN READ OF BP13K022. STATUS IS '     02680000
                            WS-K022-STATUS                              02690000
                    PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT       02700000
                 END-IF                                                 02710000
              END-IF                                                    02720000
           ELSE                                                         02730000
           IF WS-K022-STATUS = 23                                       02740000
              MOVE 'N' TO WS-K022-FOUND                                 02750000
              CONTINUE                                                  02760000
           ELSE                                                         02770000
              DISPLAY 'ERROR WITH START READ OF BP13K022. STATUS IS '   02780000
                       WS-K022-STATUS                                   02790000
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT             02800000
           END-IF.                                                      02810000
                                                                        02820000
       2100-EXIT.                                                       02830000
           EXIT.                                                        02840000
                                                                        02850000
      *--------------------------------------------------------------*  02860000
       2200-READ-NEXT.                                                  02870000
      *--------------------------------------------------------------*  02880000
                                                                        02890000
           MOVE WS-FROM-OIC       TO K022-NUM-OIC.                      02900000
           MOVE WS-NUM-REGN       TO K022-NUM-REGN.                     02910000
                                                                        02920000
           START BP13K022 KEY > K022-KEY-FLD.                           02930000
                                                                        02940000
           IF WS-K022-STATUS = 00 OR 02                                 02950000
              IF (K022-NUM-OIC  = WS-FROM-OIC) AND                      02960000
                 (K022-NUM-REGN = WS-NUM-REGN)                          02970000
                                                                        02980000
                 READ BP13K022 NEXT RECORD                              02990000
                                                                        03000000
                 IF (K022-NUM-OIC  = WS-FROM-OIC) AND                   03010000
                    (K022-NUM-REGN NOT = WS-NUM-REGN)                   03020000
                    IF WS-K022-STATUS = 00 OR 02                        03030000
                       IF WS-ODD-REGN(WS-COUNTER) NOT = K022-NUM-REGN   03040000
                          PERFORM 2500-MOVE-DATA  THRU 2500-EXIT        03050000
                       ELSE                                             03060000
                          MOVE K022-NUM-REGN   TO WS-NUM-REGN           03070000
                       END-IF                                           03080000
                    ELSE                                                03090000
                       MOVE 'Y' TO WS-K022-EOF                          03100000
                    END-IF                                              03110000
                 ELSE                                                   03120000
                    MOVE 'Y' TO WS-K022-EOF                             03130000
                 END-IF                                                 03140000
              END-IF                                                    03150000
           ELSE                                                         03160000
              IF WS-K022-STATUS = 23                                    03170000
                 MOVE 'Y' TO WS-K022-EOF                                03180000
                 CONTINUE                                               03190000
              ELSE                                                      03200000
                 DISPLAY 'ERROR START READ OF BP13K022. STATUS IS '     03210000
                         WS-K022-STATUS                                 03220000
                 PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT          03230000
              END-IF                                                    03240000
           END-IF.                                                      03250000
                                                                        03260000
       2200-EXIT.                                                       03270000
           EXIT.                                                        03280000
                                                                        03290000
      *--------------------------------------------------------------*  03300000
       2500-MOVE-DATA.                                                  03310000
      *--------------------------------------------------------------*  03320000
                                                                        03330000
            MOVE K022-NUM-REGN      TO WS-NUM-REGN.                     03340000
                                                                        03350000
            IF (WS-LAST-ALLOCAT  = K022-CDE-ALLO-CAT) AND               03360000
               (WS-LAST-BANKLOAN = K022-CDE-BANKLOAN)                   03370000
                                                                        03380000
                MOVE K022-CDE-ALLO-CAT  TO WS-NUM-ALLO-CAT              03390000
                MOVE K022-CDE-BANKLOAN  TO WS-BANK-LOAN                 03400000
                                                                        03410000
                PERFORM 7000-WRITE-BP13L147 THRU 7000-EXIT              03420000
                PERFORM 6100-DELETE-K022    THRU 6100-EXIT              03430000
                PERFORM 5000-WRITE-K022     THRU 5000-EXIT              03440000
                                                                        03450000
            END-IF.                                                     03460000
                                                                        03470000
       2500-EXIT.                                                       03480000
           EXIT.                                                        03490000
                                                                        03500000
      *--------------------------------------------------------------*  03510000
       5000-WRITE-K022.                                                 03520000
      *--------------------------------------------------------------*  03530000
                                                                        03540000
            MOVE SPACES                TO BP13K022-REC.                 03541000
            INITIALIZE                    BP13K022-REC.                 03542000
                                                                        03543000
            MOVE WS-TO-OIC             TO K022-NUM-OIC.                 03550000
            MOVE WS-NUM-REGN           TO K022-NUM-REGN.                03560000
            MOVE WS-NUM-ALLO-CAT       TO K022-CDE-ALLO-CAT.            03570000
            MOVE WS-BANK-LOAN          TO K022-CDE-BANKLOAN.            03580000
            MOVE 'BP13C147'            TO K022-NUM-USERID               03590000
            MOVE WS-SYSTEM-DATE        TO K022-DTE-UPDATE.              03600000
                                                                        03610000
            WRITE BP13K022-REC.                                         03620000
                                                                        03630000
            EVALUATE WS-K022-STATUS                                     03640000
               WHEN 00                                                  03650000
               WHEN 02                                                  03660000
                    ADD 1 TO WS-CNT-ALLOC-CTR                           03670000
               WHEN OTHER                                               03680000
                    DISPLAY 'ERROR WRITING BP13K022. STATUS IS '        03690000
                            WS-K022-STATUS                              03700000
                    PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT          03710000
            END-EVALUATE.                                               03720000
                                                                        03730000
       5000-EXIT.                                                       03740000
           EXIT.                                                        03750000
                                                                        03760000
      *--------------------------------------------------------------*  03770000
       6000-DELETE.                                                     03780000
      *--------------------------------------------------------------*  03790000
                                                                        03800000
            MOVE LOW-VALUES               TO K022-NUM-REGN.             03810000
            MOVE WS-FROM-OIC              TO K022-NUM-OIC.              03820000
            MOVE WS-ODD-REGN(WS-COUNTER)  TO K022-NUM-REGN              03830000
                                             WS-NUM-REGN.               03840000
            PERFORM 2100-READ-K021-AIX    THRU 2100-EXIT                03850000
            PERFORM 6100-DELETE-K022      THRU 6100-EXIT                03860000
                                                                        03870000
            MOVE LOW-VALUES               TO K022-NUM-REGN.             03880000
            MOVE WS-TO-OIC                TO K022-NUM-OIC.              03890000
            MOVE WS-EVEN-REGN(WS-COUNTER) TO K022-NUM-REGN              03900000
                                             WS-NUM-REGN.               03910000
            PERFORM 2100-READ-K021-AIX    THRU 2100-EXIT.               03920000
            PERFORM 6100-DELETE-K022      THRU 6100-EXIT.               03930000
                                                                        03940000
       6000-EXIT.                                                       03950000
           EXIT.                                                        03960000
                                                                        03970000
      *--------------------------------------------------------------*  03980000
       6100-DELETE-K022.                                                03990000
      *--------------------------------------------------------------*  04000000
                                                                        04010000
            DELETE BP13K022.                                            04020000
                                                                        04030000
            EVALUATE WS-K022-STATUS                                     04040000
               WHEN 00                                                  04050000
                  CONTINUE                                              04060000
               WHEN OTHER                                               04070000
                  DISPLAY 'ERROR DELETING BP13K022. STATUS IS '         04080000
                          WS-K022-STATUS                                04090000
                  PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT             04100000
            END-EVALUATE.                                               04110000
                                                                        04120000
       6100-EXIT.                                                       04130000
           EXIT.                                                        04140000
                                                                        04150000
      *--------------------------------------------------------------*  04160000
       7000-WRITE-BP13L147.                                             04170000
      *--------------------------------------------------------------*  04180000
                                                                        04190000
           IF WS-CNT-LINE-ON-PAGE > 54                                  04200000
              PERFORM 7100-PRINT-HEADING THRU 7100-EXIT                 04210000
              MOVE 1  TO WS-CNT-LINE-ON-PAGE                            04220000
           END-IF.                                                      04230000
                                                                        04240000
           MOVE SPACES         TO BP13L147-REC.                         04250000
           INITIALIZE             BP13L147-REC.                         04260000
                                                                        04270000
           IF WS-FLAG = 'Y'                                             04280000
              MOVE WS-FROM-OIC       TO L147-DEL-OIC                    04290000
              MOVE WS-TO-OIC         TO L147-ADD-OIC                    04300000
              MOVE 'N'               TO WS-FLAG                         04310000
           ELSE                                                         04320000
              MOVE SPACES            TO L147-DEL-OIC                    04330000
                                        L147-ADD-OIC                    04340000
           END-IF.                                                      04350000
                                                                        04360000
           MOVE WS-CNT-PRINT-L147 TO L147-SLNO.                         04370000
           MOVE WS-NUM-REGN       TO L147-REGNO.                        04380000
           MOVE WS-NUM-ALLO-CAT   TO L147-ALLO-CAT.                     04390000
           MOVE WS-BANK-LOAN      TO L147-BNK-LOAN.                     04400000
                                                                        04410000
           WRITE BP13L147-REC     FROM L147-PR-DETAIL AFTER 1.          04420000
           ADD   1                TO WS-CNT-LINE-ON-PAGE.               04430000
           ADD   1                TO WS-CNT-PRINT-L147.                 04440000
           MOVE  SPACES           TO L147-PR-DETAIL.                    04450000
                                                                        04460000
       7000-EXIT.                                                       04470000
           EXIT.                                                        04480000
                                                                        04490000
      *--------------------------------------------------------------*  04500000
       7100-PRINT-HEADING.                                              04510000
      *--------------------------------------------------------------*  04520000
                                                                        04530000
           ADD  1                TO     WS-NO-OF-PAGE.                  04540000
           MOVE WS-NO-OF-PAGE    TO     L147-PAGE-NO.                   04550000
           MOVE WS-EDITED-DATE   TO     L147-RUN-DATE.                  04560000
                                                                        04570000
           MOVE SPACES           TO     BP13L147-REC.                   04580000
           INITIALIZE                   BP13L147-REC.                   04590000
                                                                        04600000
           WRITE BP13L147-REC    AFTER  PAGE.                           04610000
           WRITE BP13L147-REC    FROM   L147-HEADER-01 AFTER 1.         04620000
           WRITE BP13L147-REC    FROM   L147-HEADER-02 AFTER 1.         04630000
           WRITE BP13L147-REC    FROM   L147-HEADER-03 AFTER 2.         04640000
           WRITE BP13L147-REC    FROM   L147-HEADER-04 AFTER 1.         04650000
                                                                        04660000
       7100-EXIT.                                                       04670000
           EXIT.                                                        04680000
                                                                        04690000
      *--------------------------------------------------------------*  04700000
       9999-CLOSE-ROUTINE.                                              04710000
      *--------------------------------------------------------------*  04720000
                                                                        04730000
           CLOSE BP13K022                                               04740000
                 BP13L147.                                              04750000
                                                                        04760000
           DISPLAY SPACES.                                              04770000
           DISPLAY '********* BP13C147 CONTROL *********'.              04780000
           DISPLAY 'DATE : ' WS-EDITED-DATE.                            04790000
           DISPLAY SPACES.                                              04800000
           DISPLAY 'NO. OF PAIR READ       = ' WS-CNT-PAIR.             04810000
           DISPLAY 'NO OF REGN RE-ASSIGNED = ' WS-CNT-ALLOC-CTR.        04820000
           DISPLAY SPACES.                                              04830000
           DISPLAY '************************************'.              04840000
                                                                        04850000
           STOP RUN.                                                    04860000
                                                                        04870000
       9999-EXIT.                                                       04880000
           EXIT.                                                        04890000
