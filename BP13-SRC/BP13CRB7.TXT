       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CRB7.                                                 
      *AUTHOR.        KARL MAGALONA CABUG.                                      
      *DATE-WRITTEN.  17 JAN 2014.                                              
      *============================================================*            
      * BP13 - SYSTEM OF COMMITMENT                                *            
      *============================================================*            
      * OBJECTIVE :  TO CREATE AN XML FILE                         *            
      * INPUT     :  BP13F0B6  -  FILE GENERATED BY BP13CRB6       *            
      * OUTPUT    :  BP13L0B6  -  OUTPUT FILE                      *            
      *----------------------------------------------------------- *            
      * CHG REF  DATE     BY     DESCRIPTION                       *            
      * -------- -------- ----   ------------------------------    *            
      * BP135151 17012014 KAM4   NEW PROGRAM                       *            
      * BP135219 04032014 KAM4   CATER FOR DATE/AMOUNT INCOME      *            
      *                          AND BLANK THE OIC DETAILS         *            
      * BP135375 05062014 KAM4   CATER TO REPLACE NRIC PREFIX 'X'  *            
      *                          BY SPACE                          *            
      * BP135603 15122014 KAM4   REMOVE WHITE SPACE IN NRIC AND    *            
      *                          BLANK THE BK ADDRESS FLD WHEN NOTFND           
      * BP135198 22012015 KAM4   ADDED DTE-KEY-ISSUED, DTE-CANCEL &*            
      *                          NUM-SCH-ACC.                      *            
      * BP136142 15032016 KAM4   CHANGE "cancellationDate" to  -   *            
      *                                 "cancelledDate"            *            
      * BP136467 13092016 KAM4   FIXED CASE SENSITIVE ISSUE FOR -  *            
      *                            keyissueDate, cancelledDate and *            
      *                            hdbRefNumber.                   *            
      *============================================================*            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
      *-------------------------------------------------------------            
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
      *-------------------------------------------------------------            
                                                                                
           SELECT BP13F0B6 ASSIGN TO BP13F0B6.                                  
                                                                                
           SELECT BP13L0B6 ASSIGN TO BP13L0B6.                                  
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
                                                                                
       FD  BP13F0B6                                                             
           RECORDING  MODE  IS F                                                
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 20000 CHARACTERS                                     
           LABEL  RECORDS  ARE  STANDARD.                                       
       COPY BP13F0B6.                                                           
                                                                                
       FD  BP13L0B6                                                             
           RECORD CONTAINS 101 CHARACTERS                                       
           BLOCK CONTAINS 0 RECORDS                                             
           LABEL RECORD ARE STANDARD                                            
           RECORDING  MODE  IS F.                                               
       01  BP13L0B6-REC                   PIC X(101).                           
                                                                                
      *------------------------------------------------------------*            
       WORKING-STORAGE SECTION.                                                 
      *------------------------------------------------------------*            
                                                                                
       01  WS-OTHER-VARIABLES.                                                  
           05  WS-SYSTEM-DATE          PIC X(08) VALUE SPACES.                  
           05  WS-CHECK-FLD            PIC X(71) VALUE SPACES.                  
           05  WS-FLD-OK               PIC X(71) VALUE SPACES.                  
           05  WS-STOP                 PIC X(01) VALUE SPACES.                  
           05  WS-TMP-AMT              PIC X(05).                               
                                                                                
       01  WS-COUNTERS.                                                         
           05  IDX                       PIC 9(02)  VALUE ZEROES.               
           05  IDX1                      PIC 9(02)  VALUE ZEROES.               
           05  IDX2                      PIC 9(02)  VALUE ZEROES.               
           05  WS-READ                   PIC 9(06)  VALUE ZEROES.               
           05  WS-CTR                    PIC 9(02)  VALUE ZEROES.               
           05  WS-CTR2                   PIC 9(02)  VALUE ZEROES.               
           05  WS-READ-F0B6              PIC 9(06)  VALUE ZEROES.               
           05  WS-WRITE-L0B6             PIC 9(06)  VALUE ZEROES.               
           05  WS-READ-F740              PIC 9(06)  VALUE ZEROES.               
           05  WS-SPACES-CNT             PIC 9(02)  VALUE ZEROES.               
           05  WS-LEN                    PIC 9(02)  VALUE ZEROES.               
           05  WS-POS                    PIC 9(02)  VALUE ZEROES.               
                                                                                
       01  WS-SWITCH.                                                           
           05  WS-F0B6-EOF               PIC X(01)   VALUE 'N'.                 
                                                                                
       01  BP13L0B6-ROOT-OPEN.                                                  
           05  FILLER                    PIC X(06) VALUE                        
                                          '<ROOT>'.                             
       01  BP13L0B6-APP-OPEN.                                                   
           05  FILLER                    PIC X(13) VALUE                        
                                      '<Application>'.                          
       01  BP13L0B6-APP-DTL1.                                                   
           05  FILL-DTL1O                PIC X(11) VALUE                        
                                      '<RefNumber>'.                            
           05  L0B6-REFNO                PIC X(08).                             
           05  FILL-DTL1C                pic x(12) value                        
                                      '</RefNumber>'.                           
                                                                                
       01  BP13L0B6-APP-DTL2.                                                   
           05  FILL-DTL2O                PIC X(08) VALUE                        
                                     '<Status>'.                                
           05  L0B6-STATUS               PIC X(01).                             
           05  FILL-DTL2C                PIC X(09) VALUE                        
                                     '</Status>'.                               
       01  BP13L0B6-APP-DTL3.                                                   
           05  FILL-DTL3O                PIC X(15) VALUE                        
                                  '<BallotQuarter>'.                            
           05  L0B6-DTE-BALLOT           PIC X(07).                             
           05  FILL-DTL3C                PIC X(16) VALUE                        
                                 '</BallotQuarter>'.                            
       01  BP13L0B6-APP-DTL4.                                                   
           05  FILL-DTL4O                PIC X(15) VALUE                        
                                 '<HouseholdType>'.                             
           05  L0B6-HH-TYPE              PIC X(01).                             
           05  FILL-DTL4C                PIC X(16) VALUE                        
                                 '</HouseholdType>'.                            
                                                                                
       01  BP13L0B6-APP-DTL5.                                                   
           05  FILL-DTL5O                PIC X(16) VALUE                        
                                  '<AllocationMode>'.                           
           05  L0B6-ALLO-MODE            PIC X(03).                             
           05  FILL-DTL5C                PIC X(17) VALUE                        
                                  '</AllocationMode>'.                          
                                                                                
       01  BP13L0B6-APP-DTL6.                                                   
           05  FILL-DTL6O                PIC X(18) VALUE                        
                                '<AllocationScheme>'.                           
           05  L0B6-ALLO-SCH             PIC X(03).                             
           05  FILL-DTL6C                PIC X(19) VALUE                        
                                '</AllocationScheme>'.                          
                                                                                
       01  BP13L0B6-APP-DTL7.                                                   
           05  FILL-DTL7O                PIC X(19) VALUE                        
                                '<EligibilityScheme>'.                          
           05  L0B6-ELIG-SCH             PIC X(03).                             
           05  FILL-DTL7C                PIC X(20) VALUE                        
                                '</EligibilityScheme>'.                         
       01  BP13L0B6-APP-DTL8.                                                   
           05  FILL-DTL8O                PIC X(17) VALUE                        
                                '<HouseholdIncome>'.                            
           05  L0B6-HH-INCOME            PIC X(05).                             
           05  FILL-DTL8C                PIC X(18) VALUE                        
                                '</HouseholdIncome>'.                           
       01  BP13L0B6-APP-DTL9.                                                   
           05  FILL-DTL9O                PIC X(10) VALUE                        
                                '<FlatType>'.                                   
           05  L0B6-FT-TYPE              PIC X(02).                             
           05  FILL-DTL9C                PIC X(11) VALUE                        
                                '</FlatType>'.                                  
       01  BP13L0B6-APP-DTL10.                                                  
           05  FILL-DTL10O               PIC X(11) VALUE                        
                                '<AHGStatus>'.                                  
           05  L0B6-AHG-STAT             PIC X(01).                             
           05  FILL-DTL10C               PIC X(12) VALUE                        
                                '</AHGStatus>'.                                 
       01  BP13L0B6-APP-DTL11.                                                  
           05  FILL-DTL11O               PIC X(11) VALUE                        
                                '<SHGStatus>'.                                  
           05  L0B6-SHG-STAT             PIC X(01).                             
           05  FILL-DTL11C               PIC X(12) VALUE                        
                                '</SHGStatus>'.                                 
       01  BP13L0B6-APP-DTL12.                                                  
           05  FILL-DTL12O               PIC X(09) VALUE                        
                                '<LoanTag>'.                                    
           05  L0B6-LOAN-TAG             PIC X(01).                             
           05  FILL-DTL12C               PIC X(10) VALUE                        
                                '</LoanTag>'.                                   
       01  BP13L0B6-APP-DTL13.                                                  
           05  FILL-DTL13O               PIC X(15) VALUE                        
                                '<BookedAddress>'.                              
           05  L0B6-BK-ADDR              PIC X(70).                             
           05  FILL-DTL13C               PIC X(16) VALUE                        
                                '</BookedAddress>'.                             
       01  BP13L0B6-APP-DTL14.                                                  
           05  FILL-DTL14O               PIC X(12) VALUE                        
                                '<FlatDesign>'.                                 
           05  L0B6-FT-DSGN              PIC X(02).                             
           05  FILL-DTL14C               PIC X(13) VALUE                        
                                '</FlatDesign>'.                                
       01  BP13L0B6-APP-DTL15.                                                  
           05  FILL-DTL15O               PIC X(16) VALUE                        
                                '<ContactNumbers>'.                             
           05  L0B6-CONTACT-NO           PIC X(08).                             
           05  FILL-DTL15C               PIC X(17) VALUE                        
                                '</ContactNumbers>'.                            
       01  BP13L0B6-APP-DTL16.                                                  
           05  FILL-DTL16O               PIC X(14) VALUE                        
                                '<AffectedSERS>'.                               
           05  L0B6-AFFECTED-SERS        PIC X(01).                             
           05  FILL-DTL16C               PIC X(15) VALUE                        
                                '</AffectedSERS>'.                              
       01  BP13L0B6-APP-DTL17.                                                  
           05  FILL-DTL17O               PIC X(16) VALUE                        
                                '<AcceptanceDate>'.                             
           05  L0B6-DTE-ACCEPT           PIC X(10).                             
           05  FILL-DTL17C               PIC X(17) VALUE                        
                                '</AcceptanceDate>'.                            
       01  BP13L0B6-APP-DTL18.                                                  
           05  FILL-DTL18O               PIC X(15) VALUE                        
                                '<ForwardedDate>'.                              
           05  L0B6-DTE-FWD              PIC X(10).                             
           05  FILL-DTL18C               PIC X(16) VALUE                        
                                '</ForwardedDate>'.                             
       01  BP13L0B6-APP-DTL19.                                                  
           05  FILL-DTL19O               PIC X(06) VALUE                        
                                '<OIC1>'.                                       
           05  L0B6-NUM-OIC1             PIC X(05).                             
           05  FILL-DTL19C               PIC X(07) VALUE                        
                                '</OIC1>'.                                      
       01  BP13L0B6-APP-DTL20.                                                  
           05  FILL-DTL20O               PIC X(06) VALUE                        
                                '<OIC2>'.                                       
           05  L0B6-NUM-OIC2             PIC X(05).                             
           05  FILL-DTL20C               PIC X(07) VALUE                        
                                '</OIC2>'.                                      
       01  BP13L0B6-APP-DTL21.                                                  
           05  FILL-DTL21O               PIC X(27) VALUE                        
                                '<RefreshHouseholdStructure>'.                  
           05  L0B6-REF-HH-STRUC         PIC X(04).                             
           05  FILL-DTL21C               PIC X(28) VALUE                        
                                '</RefreshHouseholdStructure>'.                 
                                                                                
       01  BP13L0B6-APP-DTL22.                                                  
           05 FILL-DTL22O                PIC X(17) VALUE                        
                                '<ApplicationDate>'.                            
           05 L0B6-DTE-REGN              PIC X(10).                             
           05 FILL-DTL22C                PIC X(18) VALUE                        
                                '</ApplicationDate>'.                           
                                                                                
                                                                                
       01  BP13L0B6-KEYISSUED-DTL23.                                            
           05 FILL-DTL23O                PIC X(14) VALUE                        
                                 '<KeyIssueDate>'.                              
           05 L0B6-DTE-KEYISSUED         PIC X(10).                             
           05 FILL-DTL23C                PIC X(15) VALUE                        
                                 '</KeyIssueDate>'.                             
       01  BP13L0B6-DTE-CANCEL-DTL24.                                           
           05 FILL-DTL24O                PIC X(15) VALUE                        
                                 '<CancelledDate>'.                             
           05 L0B6-DTE-CANCEL            PIC X(10).                             
           05 FILL-DTL24C                PIC X(16) VALUE                        
                                 '</CancelledDate>'.                            
       01  BP13L0B6-SCH-ACC-DTL25.                                              
           05 FILL-DTL25O                PIC X(14) VALUE                        
                                  '<HdbRefNumber>'.                             
           05 L0B6-SCH-ACC               PIC X(11).                             
           05 FILL-DTL25C                PIC X(15) VALUE                        
                                  '</HdbRefNumber>'.                            
                                                                                
      ***Personal Details*****                                                  
       01  BP13L0B6-PRSN-OPEN.                                                  
           05  FILLER                    PIC X(10) VALUE                        
                                '<Personal>'.                                   
       01  BP13L0B6-PRSN-DTL2.                                                  
           05  FILL-DEL-O                PIC X(12) VALUE                        
                                '<IsDeletion>'.                                 
           05  L0B6-NUM-DEL              PIC X(05).                             
           05  FILL-DEL-C                PIC X(13) VALUE                        
                                '</IsDeletion>'.                                
       01  BP13L0B6-PRSN-DTL3.                                                  
           05  FILL-PRSN-O               PIC X(14) VALUE                        
                                '<PersonalType>'.                               
           05  L0B6-PERSNL-TYPE          PIC X(02).                             
           05  FILL-PRSN-C               PIC X(15) VALUE                        
                                '</PersonalType>'.                              
       01  BP13L0B6-PRSN-DTL4.                                                  
           05  FILL-CUST-O               PIC X(12) VALUE                        
                                '<CustomerId>'.                                 
           05  L0B6-CUTOMER-ID           PIC X(09).                             
           05  FILL-CUST-C               PIC X(13) VALUE                        
                                '</CustomerId>'.                                
       01  BP13L0B6-PRSN-DTL5.                                                  
           05  FILL-MAINAPP-O            PIC X(17) VALUE                        
                                '<IsMainApplicant>'.                            
           05  L0B6-MAIN-APPLNT          PIC X(05).                             
           05  FILL-MAINAPP-C            PIC X(18) VALUE                        
                                '</IsMainApplicant>'.                           
       01  BP13L0B6-PRSN-DTL6.                                                  
           05  FILL-NRIC-O               PIC X(06) VALUE                        
                                '<Nric>'.                                       
           05  L0B6-NUM-NRIC             PIC X(09).                             
           05  FILL-NRIC-C               PIC X(07) VALUE                        
                                '</Nric>'.                                      
       01  BP13L0B6-PRSN-DTL7.                                                  
           05  FILL-NAME-O               PIC X(06) VALUE                        
                                '<Name>'.                                       
           05  L0B6-NAME                 PIC X(66).                             
           05  FILL-NAME-C               PIC X(07) VALUE                        
                                '</Name>'.                                      
       01  BP13L0B6-PRSN-DTL8.                                                  
           05  FILL-MSTAT-O              PIC X(15) VALUE                        
                                '<MaritalStatus>'.                              
           05  L0B6-MARITAL-STAT         PIC X(01).                             
           05  FILL-MSTAT-C              PIC X(16) VALUE                        
                                '</MaritalStatus>'.                             
       01  BP13L0B6-PRSN-DTL9.                                                  
           05  FILL-DOB-O                PIC X(13) VALUE                        
                                '<DateOfBirth>'.                                
           05  L0B6-DTE-BIRTH            PIC X(10).                             
           05  FILL-DOB-C                PIC X(14) VALUE                        
                                '</DateOfBirth>'.                               
       01  BP13L0B6-PRSN-DTL10.                                                 
           05  FILL-REL-O                PIC X(14) VALUE                        
                                '<Relationship>'.                               
           05  L0B6-RELNTSHIP            PIC X(02).                             
           05  FILL-REL-C                PIC X(15) VALUE                        
                                '</Relationship>'.                              
       01  BP13L0B6-PRSN-DTL11.                                                 
           05  FILL-CITZN-O              PIC X(13) VALUE                        
                                '<Citizenship>'.                                
           05  L0B6-CITIZNSHP            PIC X(02).                             
           05  FILL-CITZN-C              PIC X(14) VALUE                        
                                '</Citizenship>'.                               
       01  BP13L0B6-PRSN-EMPLY-STATUS.                                          
           05  FILL-EMPLY-STAT-O         PIC X(18) VALUE                        
                                '<EmploymentStatus>'.                           
           05  L0B6-EMPLY-STATUS         PIC X(03).                             
           05  FILL-EMPLY-STAT-C         PIC X(19) VALUE                        
                                '</EmploymentStatus>'.                          
                                                                                
      **Income Details**                                                        
       01  BP13L0B6-PRSN-INCOME-OPEN.                                           
           05  FILL-INCOME-O             PIC X(15) VALUE                        
                                '<MonthlyIncome>'.                              
                                                                                
      ***                                                                       
       01  BP13L0B6-PRSN-DTL12A.                                                
           05  L06B-PRSN-INCOME-MON OCCURS 12 TIMES.                            
               10 FILL-YEAR-MON-O        PIC X(11) VALUE                        
                                '<YearMonth>'.                                  
               10 L0B6-YEAR-MONTH        PIC X(06).                             
               10 FILL-YEAR-MON-C        PIC X(12) VALUE                        
                                '</YearMonth>'.                                 
                                                                                
       01  BP13L0B6-PRSN-DTL12B.                                                
           05  L06B-PRSN-INCOME-AMT OCCURS 12 TIMES.                            
               10 FILL-INCOME-AMT-O      PIC X(08) VALUE                        
                                '<Amount>'.                                     
               10 L0B6-INCOME-AMOUNT     PIC X(5).                              
               10 FILL-INCOME-AMT-C      PIC X(09) VALUE                        
                                '</Amount>'.                                    
                                                                                
      ***                                                                       
       01  BP13L0B6-PRSN-DTL12A01.                                              
           05  FILL-DTE01-O              PIC X(13) VALUE                        
                                '<IncomeDte01>'.                                
           05  L0B6-INCOME-DTE01         PIC X(08).                             
           05  FILL-DTE01-C              PIC X(14) VALUE                        
                                '</IncomeDte01>'.                               
       01  BP13L0B6-PRSN-DTL12B01.                                              
           05  FILL-AMT01-O              PIC X(13) VALUE                        
                                '<IncomeAmt01>'.                                
           05  L0B6-INCOME-AMT01         PIC X(08).                             
           05  FILL-AMT01-C              PIC X(14) VALUE                        
                                '</IncomeAmt01>'.                               
       01  BP13L0B6-PRSN-DTL12A02.                                              
           05  FILL-DTE02-O              PIC X(13) VALUE                        
                                '<IncomeDte02>'.                                
           05  L0B6-INCOME-DTE02         PIC X(08).                             
           05  FILL-DTE02-C              PIC X(14) VALUE                        
                                '</IncomeDte02>'.                               
       01  BP13L0B6-PRSN-DTL12B02.                                              
           05  FILL-AMT02-O              PIC X(13) VALUE                        
                                '<IncomeAmt02>'.                                
           05  L0B6-INCOME-AMT02         PIC X(08).                             
           05  FILL-AMT02-C              PIC X(14) VALUE                        
                                '</IncomeAmt02>'.                               
       01  BP13L0B6-PRSN-DTL12A03.                                              
           05  FILL-DTE03-O              PIC X(13) VALUE                        
                                '<IncomeDte03>'.                                
           05  L0B6-INCOME-DTE03         PIC X(08).                             
           05  FILL-DTE03-C              PIC X(14) VALUE                        
                                '</IncomeDte03>'.                               
       01  BP13L0B6-PRSN-DTL12B03.                                              
           05  FILL-AMT03-O              PIC X(13) VALUE                        
                                '<IncomeAmt03>'.                                
           05  L0B6-INCOME-AMT03         PIC X(08).                             
           05  FILL-AMT03-C              PIC X(14) VALUE                        
                                '</IncomeAmt03>'.                               
       01  BP13L0B6-PRSN-DTL12A04.                                              
           05  FILL-DTE04-O              PIC X(13) VALUE                        
                                '<IncomeDte04>'.                                
           05  L0B6-INCOME-DTE04         PIC X(08).                             
           05  FILL-DTE04-C              PIC X(14) VALUE                        
                                '</IncomeDte04>'.                               
       01  BP13L0B6-PRSN-DTL12B04.                                              
           05  FILL-AMT04-O              PIC X(13) VALUE                        
                                '<IncomeAmt04>'.                                
           05  L0B6-INCOME-AMT04         PIC X(08).                             
           05  FILL-AMT04-C              PIC X(14) VALUE                        
                                '</IncomeAmt04>'.                               
       01  BP13L0B6-PRSN-DTL12A05.                                              
           05  FILL-DTE05-O              PIC X(13) VALUE                        
                                '<IncomeDte05>'.                                
           05  L0B6-INCOME-DTE05         PIC X(08).                             
           05  FILL-DTE05-C              PIC X(14) VALUE                        
                                '</IncomeDte05>'.                               
       01  BP13L0B6-PRSN-DTL12B05.                                              
           05  FILL-AMT05-O              PIC X(13) VALUE                        
                                '<IncomeAmt05>'.                                
           05  L0B6-INCOME-AMT05         PIC X(08).                             
           05  FILL-AMT05-C              PIC X(14) VALUE                        
                                '</IncomeAmt05>'.                               
       01  BP13L0B6-PRSN-DTL12A06.                                              
           05  FILL-DTE06-O              PIC X(13) VALUE                        
                                '<IncomeDte06>'.                                
           05  L0B6-INCOME-DTE06         PIC X(08).                             
           05  FILL-DTE06-C              PIC X(14) VALUE                        
                                '</IncomeDte06>'.                               
       01  BP13L0B6-PRSN-DTL12B06.                                              
           05  FILL-AMT06-O              PIC X(13) VALUE                        
                                '<IncomeAmt06>'.                                
           05  L0B6-INCOME-AMT06         PIC X(08).                             
           05  FILL-AMT06-C              PIC X(14) VALUE                        
                                '</IncomeAmt06>'.                               
       01  BP13L0B6-PRSN-DTL12A07.                                              
           05  FILL-DTE07-O              PIC X(13) VALUE                        
                                '<IncomeDte07>'.                                
           05  L0B6-INCOME-DTE07         PIC X(08).                             
           05  FILL-DTE07-C              PIC X(14) VALUE                        
                                '</IncomeDte07>'.                               
       01  BP13L0B6-PRSN-DTL12B07.                                              
           05  FILL-AMT07-O              PIC X(13) VALUE                        
                                '<IncomeAmt07>'.                                
           05  L0B6-INCOME-AMT07         PIC X(08).                             
           05  FILL-AMT07-C              PIC X(14) VALUE                        
                                '</IncomeAmt07>'.                               
       01  BP13L0B6-PRSN-DTL12A08.                                              
           05  FILL-DTE08-O              PIC X(13) VALUE                        
                                '<IncomeDte08>'.                                
           05  L0B6-INCOME-DTE08         PIC X(08).                             
           05  FILL-DTE08-C              PIC X(14) VALUE                        
                                '</IncomeDte08>'.                               
       01  BP13L0B6-PRSN-DTL12B08.                                              
           05  FILL-AMT08-O              PIC X(13) VALUE                        
                                '<IncomeAmt08>'.                                
           05  L0B6-INCOME-AMT08         PIC X(08).                             
           05  FILL-AMT08-C              PIC X(14) VALUE                        
                                '</IncomeAmt08>'.                               
       01  BP13L0B6-PRSN-DTL12A09.                                              
           05  FILL-DTE09-O              PIC X(13) VALUE                        
                                '<IncomeDte09>'.                                
           05  L0B6-INCOME-DTE09         PIC X(08).                             
           05  FILL-DTE09-C              PIC X(14) VALUE                        
                                '</IncomeDte09>'.                               
       01  BP13L0B6-PRSN-DTL12B09.                                              
           05  FILL-AMT09-O              PIC X(13) VALUE                        
                                '<IncomeAmt09>'.                                
           05  L0B6-INCOME-AMT09         PIC X(08).                             
           05  FILL-AMT09-C              PIC X(14) VALUE                        
                                '</IncomeAmt09>'.                               
       01  BP13L0B6-PRSN-DTL12A10.                                              
           05  FILL-DTE10-O              PIC X(13) VALUE                        
                                '<IncomeDte10>'.                                
           05  L0B6-INCOME-DTE10         PIC X(08).                             
           05  FILL-DTE10-C              PIC X(14) VALUE                        
                                '</IncomeDte10>'.                               
       01  BP13L0B6-PRSN-DTL12B10.                                              
           05  FILL-AMT10-O              PIC X(13) VALUE                        
                                '<IncomeAmt10>'.                                
           05  L0B6-INCOME-AMT10         PIC X(08).                             
           05  FILL-AMT10-C              PIC X(14) VALUE                        
                                '</IncomeAmt10>'.                               
       01  BP13L0B6-PRSN-DTL12A11.                                              
           05  FILL-DTE11-O              PIC X(13) VALUE                        
                                '<IncomeDte11>'.                                
           05  L0B6-INCOME-DTE11         PIC X(08).                             
           05  FILL-DTE11-C              PIC X(14) VALUE                        
                                '</IncomeDte11>'.                               
       01  BP13L0B6-PRSN-DTL12B11.                                              
           05  FILL-AMT11-O              PIC X(13) VALUE                        
                                '<IncomeAmt11>'.                                
           05  L0B6-INCOME-AMT11         PIC X(08).                             
           05  FILL-AMT11-C              PIC X(14) VALUE                        
                                '</IncomeAmt11>'.                               
       01  BP13L0B6-PRSN-DTL12A12.                                              
           05  FILL-DTE12-O              PIC X(13) VALUE                        
                                '<IncomeDte12>'.                                
           05  L0B6-INCOME-DTE12         PIC X(08).                             
           05  FILL-DTE12-C              PIC X(14) VALUE                        
                                '</IncomeDte12>'.                               
       01  BP13L0B6-PRSN-DTL12B12.                                              
           05  FILL-AMT12-O              PIC X(13) VALUE                        
                                '<IncomeAmt12>'.                                
           05  L0B6-INCOME-AMT12         PIC X(08).                             
           05  FILL-AMT12-C              PIC X(14) VALUE                        
                                '</IncomeAmt12>'.                               
       01  BP13L0B6-PRSN-INCOME-CLOSE.                                          
           05  FILL-INCOME-C             PIC X(16) VALUE                        
                                '</MonthlyIncome>'.                             
      **Income end**                                                            
                                                                                
       01  BP13L0B6-PRSN-DTL13.                                                 
           05  FILL-MCPS-O               PIC X(08) VALUE                        
                                '<IsMCPS>'.                                     
           05  L0B6-MCPS                 PIC X(02).                             
           05  FILL-MCPS-C               PIC X(09) VALUE                        
                                '</IsMCPS>'.                                    
       01  BP13L0B6-PRSN-DTL14.                                                 
           05  FILL-PPO-O                PIC X(07) VALUE                        
                                '<IsPPO>'.                                      
           05  L0B6-PPO                  PIC X(02).                             
           05  FILL-PPO-C                PIC X(08) VALUE                        
                                '</IsPPO>'.                                     
       01  BP13L0B6-PRSN-DTL15.                                                 
           05  FILL-NRICSOC-O            PIC X(09) VALUE                        
                                '<NRICSOC>'.                                    
           05  L0B6-NRIC-SOC             PIC X(09).                             
           05  FILL-NRICSOC-C            PIC X(10) VALUE                        
                                '</NRICSOC>'.                                   
       01  BP13L0B6-PRSN-DTL16.                                                 
           05  FILL-NAMESOC-O            PIC X(09) VALUE                        
                                '<NameSOC>'.                                    
           05  L0B6-NAME-SOC             PIC X(66).                             
           05  FILL-NAMESOC-C            PIC X(10) VALUE                        
                                '</NameSOC>'.                                   
       01  BP13L0B6-PRSN-DTL17.                                                 
           05  FILL-NOIM-O               PIC X(22) VALUE                        
                                '<NumberOfIncomeMonths>'.                       
           05  L0B6-income-mon3          PIC X(05).                             
           05  FILL-NOIM-C               PIC X(23) VALUE                        
                                '</NumberOfIncomeMonths>'.                      
       01  BP13L0B6-PRSN-CLOSE.                                                 
           05  FILLER                    PIC X(11) VALUE                        
                                '</Personal>'.                                  
       01  BP13L0B6-APP-CLOSE.                                                  
           05  FILLER                    PIC X(14) VALUE                        
                                      '</Application>'.                         
       01  BP13L0B6-ROOT-CLOSE.                                                 
           05  FILLER                    PIC X(07) VALUE                        
                                          '</ROOT>'.                            
                                                                                
      *------------------------------------------------------------*            
       PROCEDURE DIVISION.                                                      
      *------------------------------------------------------------*            
       0000-MAIN.                                                               
      *------------------------------------------------------------*            
           PERFORM 1000-OPEN-FILES    THRU 1000-EXIT.                           
           PERFORM 1500-READ-BP13F0B6 THRU 1500-EXIT.                           
           PERFORM 2000-PROCESS-DATA  THRU 2000-EXIT                            
                   UNTIL WS-F0B6-EOF = 'Y'.                                     
           PERFORM 9000-CLOSE-FILES.                                            
                                                                                
       0000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------------            
       1000-OPEN-FILES.                                                         
      *-------------------------------------------------------------            
           OPEN INPUT BP13F0B6                                                  
               OUTPUT BP13L0B6.                                                 
                                                                                
           WRITE BP13L0B6-REC   FROM BP13L0B6-ROOT-OPEN.                        
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       1500-READ-BP13F0B6.                                                      
      *-------------------------------------------------------------            
           READ BP13F0B6                                                        
             AT END                                                             
                MOVE 'Y'   TO WS-F0B6-EOF                                       
                MOVE SPACES            TO BP13L0B6-REC                          
                WRITE BP13L0B6-REC   FROM BP13L0B6-ROOT-CLOSE                   
                GO         TO 1500-EXIT.                                        
                                                                                
           ADD 1    TO WS-READ-F0B6.                                            
                                                                                
       1500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       2000-PROCESS-DATA.                                                       
      *-------------------------------------------------------------            
           IF F0B6-REFNO NOT = SPACES AND LOW-VALUES                            
              PERFORM 2100-FORMAT-TO-XML     THRU 2100-EXIT                     
           END-IF.                                                              
                                                                                
           PERFORM 1500-READ-BP13F0B6        THRU 1500-EXIT.                    
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       2100-FORMAT-TO-XML.                                                      
      *-------------------------------------------------------------            
           add 1 to WS-WRITE-L0B6.                                              
           WRITE BP13L0B6-REC   FROM BP13L0B6-APP-OPEN.                         
                                                                                
           MOVE F0B6-REFNO                  TO L0B6-REFNO.                      
           MoVE F0B6-STATUS                 TO L0B6-STATUS.                     
                                                                                
           IF F0B6-DTE-BALLOT = ZEROES OR SPACES OR LOW-VALUES                  
              MOVE '0001-01'                TO L0B6-DTE-BALLOT                  
           ELSE                                                                 
              STRING F0B6-DTE-BALLOT(1:4) '-'                                   
                     F0B6-DTE-BALLOT(5:2)                                       
                        DELIMITED BY SIZE INTO L0B6-DTE-BALLOT                  
           END-IF.                                                              
           MOVE F0B6-HH-TYPE                TO L0B6-HH-TYPE.                    
           MOVE F0B6-ALLOC-MODE             TO L0B6-ALLO-MODE.                  
           MOVE F0B6-ALLOC-SCH              TO L0B6-ALLO-SCH.                   
           MOVE F0B6-ELIG-SCH               TO L0B6-ELIG-SCH.                   
           MOVE F0B6-HH-INCOME              TO L0B6-HH-INCOME.                  
           MOVE F0B6-FLAT-TYPE              TO L0B6-FT-TYPE.                    
           MOVE F0B6-AHG-STATUS             TO L0B6-AHG-STAT.                   
           MOVE F0B6-SHG-STATUS             TO L0B6-SHG-STAT.                   
           MOVE F0B6-LOAN-TAG               TO L0B6-LOAN-TAG.                   
           MOVE F0B6-BK-ADDRESS             TO L0B6-BK-ADDR.                    
           MOVE F0B6-FLAT-DESIGN            TO L0B6-FT-DSGN.                    
           MOVE F0B6-CONTACT-NO             TO L0B6-CONTACT-NO.                 
           MOVE F0B6-AFFECTED-SERS          TO L0B6-AFFECTED-SERS.              
                                                                                
           MOVE F0B6-DTE-ACCEPTANCE         TO L0B6-DTE-ACCEPT.                 
           MOVE F0B6-DTE-FORWARDED          TO L0B6-DTE-FWD.                    
                                                                                
      **20140417 - move spaces to oic**                                         
      *    MOVE F0B6-OIC1                   TO L0B6-NUM-OIC1.                   
      *    MOVE F0B6-OIC2                   TO L0B6-NUM-OIC2.                   
           MOVE SPACES                      TO L0B6-NUM-OIC1                    
                                               L0B6-NUM-OIC2.                   
           MOVE F0B6-REF-HH-STRUCT          TO L0B6-REF-HH-STRUC.               
           move F0B6-DTE-REGN               TO L0B6-DTE-REGN.                   
                                                                                
           STRING F0B6-DTE-KEY-ISSUE(1:4) '-' F0B6-DTE-KEY-ISSUE(5:2)           
              '-' F0B6-DTE-KEY-ISSUE(7:2) DELIMITED BY SIZE INTO                
                                          L0B6-DTE-KEYISSUED                    
           END-STRING.                                                          
                                                                                
           STRING F0B6-DTE-CANCEL(1:4) '-' F0B6-DTE-CANCEL(5:2)                 
              '-' F0B6-DTE-CANCEL(7:2) DELIMITED BY SIZE INTO                   
                                       L0B6-DTE-CANCEL                          
           END-STRING.                                                          
                                                                                
           MOVE F0B6-NUM-SCH-ACCT           TO L0B6-SCH-ACC.                    
                                                                                
           PERFORM 2200-WRITE-APPLICATION THRU 2200-EXIT.                       
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       2200-WRITE-APPLICATION.                                                  
      *-------------------------------------------------------------            
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL1O  L0B6-REFNO  FILL-DTL1C                            
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL2O  L0B6-STATUS  FILL-DTL2C                           
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL3O  L0B6-DTE-BALLOT  FILL-DTL3C                       
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL4O  L0B6-HH-TYPE  FILL-DTL4C                          
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL5O  L0B6-ALLO-MODE  FILL-DTL5C                        
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL6O  L0B6-ALLO-SCH  FILL-DTL6C                         
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL7O  L0B6-ELIG-SCH  FILL-DTL7C                         
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL8O  L0B6-HH-INCOME  FILL-DTL8C                        
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL9O  L0B6-FT-TYPE  FILL-DTL9C                          
                 DELIMITED BY SPACES INTO  BP13L0B6-REC.                        
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL10O  L0B6-AHG-STAT  FILL-DTL10C                       
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL11O  L0B6-SHG-STAT  FILL-DTL11C                       
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL12O  L0B6-LOAN-TAG  FILL-DTL12C                       
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
      ***MANAGE THE WHITE SPACE***                                              
           MOVE SPACES                   TO BP13L0B6-REC                        
           IF L0B6-BK-ADDR = SPACES OR LOW-VALUES                               
              MOVE SPACES                TO L0B6-BK-ADDR                        
              STRING FILL-DTL13O  L0B6-BK-ADDR  FILL-DTL13C                     
                    DELIMITED BY SPACE INTO BP13L0B6-REC                        
           ELSE                                                                 
              MOVE  L0B6-BK-ADDR         TO WS-CHECK-FLD                        
              PERFORM 2501-RTRIM       THRU 2501-EXIT                           
              STRING FILL-DTL13O  WS-CHECK-FLD(1:IDX1)  FILL-DTL13C             
                    DELIMITED BY SIZE  INTO BP13L0B6-REC                        
           END-IF.                                                              
           WRITE BP13L0B6-REC.                                                  
      **********                                                                
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL14O  L0B6-FT-DSGN  FILL-DTL14C                        
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL15O  L0B6-CONTACT-NO  FILL-DTL15C                     
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL16O  L0B6-AFFECTED-SERS  FILL-DTL16C                  
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL17O  L0B6-DTE-ACCEPT  FILL-DTL17C                     
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL18O  L0B6-DTE-FWD  FILL-DTL18C                        
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL19O  L0B6-NUM-OIC1  FILL-DTL19C                       
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL20O  L0B6-NUM-OIC2  FILL-DTL20C                       
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DTL21O  L0B6-REF-HH-STRUC  FILL-DTL21C                   
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC.                                 
           STRING FILL-DTL22O L0B6-DTE-REGN(1:4) '-'                            
                  L0B6-DTE-REGN(5:2) '-' L0B6-DTE-REGN(7:2)                     
                  FILL-DTL22C                                                   
                  DELIMITED BY SPACES INTO BP13L0B6-REC.                        
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES          TO BP13L0B6-REC.                                
           STRING FILL-DTL23O L0B6-DTE-KEYISSUED                                
                  FILL-DTL23C                                                   
                  DELIMITED BY SPACES INTO BP13L0B6-REC.                        
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES          TO BP13L0B6-REC.                                
           STRING FILL-DTL24O L0B6-DTE-CANCEL                                   
                  FILL-DTL24C                                                   
                  DELIMITED BY SPACES INTO BP13L0B6-REC.                        
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES          TO BP13L0B6-REC.                                
           STRING FILL-DTL25O L0B6-SCH-ACC                                      
                  FILL-DTL25C                                                   
                  DELIMITED BY SPACES INTO BP13L0B6-REC.                        
           WRITE BP13L0B6-REC.                                                  
                                                                                
                                                                                
           PERFORM VARYING WS-CTR FROM 1 BY 1                                   
              UNTIL WS-CTR > 8                                                  
              IF F0B6-NUM-NRIC(WS-CTR) NOT = SPACES AND LOW-VALUES              
                 PERFORM 2300-MOVE-PERSONAL-DTLS  THRU 2300-EXIT                
                 MOVE  SPACES           TO BP13L0B6-REC                         
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
           WRITE BP13L0B6-REC   FROM BP13L0B6-APP-CLOSE.                        
                                                                                
       2200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       2300-MOVE-PERSONAL-DTLS.                                                 
      *-------------------------------------------------------------            
           MOVE 'FALSE'                      TO L0B6-NUM-DEL.                   
           MOVE F0B6-PERSONAL-TYPE(WS-CTR)   TO L0B6-PERSNL-TYPE.               
           MOVE F0B6-CUSTOMER-ID  (WS-CTR)   TO L0B6-CUTOMER-ID.                
           MOVE F0B6-MAIN-APPLNT  (WS-CTR)   TO L0B6-MAIN-APPLNT.               
           MOVE F0B6-NUM-NRIC     (WS-CTR)   TO L0B6-NUM-NRIC.                  
           MOVE F0B6-NAME         (WS-CTR)   TO L0B6-NAME.                      
           MOVE F0B6-MARITAL-STAT (WS-CTR)   TO L0B6-MARITAL-STAT.              
           MOVE F0B6-DTE-BIRTH    (WS-CTR)   TO L0B6-DTE-BIRTH.                 
           MOVE F0B6-RELTNSHP     (WS-CTR)   TO L0B6-RELNTSHIP.                 
           MOVE F0B6-CITIZENSHIP  (WS-CTR)   TO L0B6-CITIZNSHP.                 
           MOVE F0B6-EMPLY-STATUS (WS-CTR)   TO L0B6-EMPLY-STATUS.              
                                                                                
      **********                                                                
           PERFORM VARYING IDX2 FROM 1 BY 1 UNTIL                               
                   IDX2 > 12                                                    
                IF L0B6-YEAR-MONTH(IDX2) NOT = SPACES AND LOW-VALUES            
                   MOVE SPACES         TO L0B6-YEAR-MONTH(IDX2)                 
                                          L0B6-INCOME-AMOUNT(IDX2)              
                END-IF                                                          
           END-PERFORM.                                                         
                                                                                
           PERFORM VARYING IDX2 FROM 1 BY 1 UNTIL                               
             IDX2 > 12 OR F0B6-DTE-INCOME(WS-CTR, IDX2) = SPACES OR             
                                                          LOW-VALUES            
             IF F0B6-DTE-INCOME(WS-CTR, IDX2) NOT = SPACES AND                  
                                              LOW-VALUES                        
                MOVE F0B6-DTE-INCOME(WS-CTR, IDX2)                              
                  TO L0B6-YEAR-MONTH(IDX2)                                      
                                                                                
                MOVE F0B6-NUM-INCOME(WS-CTR, IDX2)                              
                  TO L0B6-INCOME-AMOUNT(IDX2)                                   
                DISPLAY '1INCOME-AMOUNT : ' L0B6-INCOME-AMOUNT(IDX2)            
             END-IF                                                             
           END-PERFORM.                                                         
                                                                                
           MOVE F0B6-MCPS         (WS-CTR)   TO L0B6-MCPS.                      
           MOVE F0B6-PPO          (WS-CTR)   TO L0B6-PPO.                       
           MOVE F0B6-NIRC-SOC     (WS-CTR)   TO L0B6-NRIC-SOC.                  
           MOVE F0B6-NME-SOC      (WS-CTR)   TO L0B6-NAME-SOC.                  
           MOVE F0B6-INCOME-MON   (WS-CTR)   TO L0B6-INCOME-MON3.               
                                                                                
           PERFORM 2400-WRITE-PERSONAL-DTLS   THRU 2400-EXIT.                   
                                                                                
       2300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       2400-WRITE-PERSONAL-DTLS.                                                
      *-------------------------------------------------------------            
           WRITE BP13L0B6-REC   FROM BP13L0B6-PRSN-OPEN.                        
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DEL-O  L0B6-NUM-DEL  FILL-DEL-C                          
                 DELIMITED BY SPACES INTO BP13L0B6-REC                          
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-PRSN-O  L0B6-PERSNL-TYPE  FILL-PRSN-C                    
                 DELIMITED BY SPACES INTO BP13L0B6-REC                          
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-CUST-O  L0B6-CUTOMER-ID  FILL-CUST-C                     
                 DELIMITED BY SPACES INTO BP13L0B6-REC                          
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-MAINAPP-O  L0B6-MAIN-APPLNT  FILL-MAINAPP-C              
                 DELIMITED BY SPACES INTO BP13L0B6-REC                          
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
                                                                                
      **To replace the X with space and to remove the white space.              
           IF L0B6-NUM-NRIC(1:1) = 'X'                                          
              STRING FILL-NRIC-O  L0B6-NUM-NRIC(2:8)  FILL-NRIC-C               
                     DELIMITED BY SPACES INTO BP13L0B6-REC                      
           ELSE                                                                 
              STRING FILL-NRIC-O  L0B6-NUM-NRIC  FILL-NRIC-C                    
                     DELIMITED BY SPACES INTO BP13L0B6-REC                      
           END-IF.                                                              
           WRITE BP13L0B6-REC.                                                  
                                                                                
      **TRIM WHITE SPACE(S) AFTER THE NAME**                                    
           MOVE SPACES                   TO BP13L0B6-REC                        
           IF L0B6-NAME = SPACES OR LOW-VALUES                                  
              MOVE SPACES                TO L0B6-NAME                           
              STRING FILL-NAME-O  L0B6-NAME  FILL-NAME-C                        
                     DELIMITED BY SIZE INTO BP13L0B6-REC                        
           ELSE                                                                 
              MOVE  L0B6-NAME            TO WS-CHECK-FLD                        
              PERFORM 2501-RTRIM       THRU 2501-EXIT                           
                                                                                
              STRING FILL-NAME-O  WS-CHECK-FLD(1:IDX1)  FILL-NAME-C             
                     DELIMITED BY SIZE INTO BP13L0B6-REC                        
           END-IF.                                                              
           WRITE BP13L0B6-REC.                                                  
      ***********                                                               
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-MSTAT-O  L0B6-MARITAL-STAT  FILL-MSTAT-C                 
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-DOB-O  L0B6-DTE-BIRTH  FILL-DOB-C                        
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-REL-O  L0B6-RELNTSHIP  FILL-REL-C                        
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-CITZN-O  L0B6-CITIZNSHP  FILL-CITZN-C                    
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-EMPLY-STAT-O L0B6-EMPLY-STATUS                           
                  FILL-EMPLY-STAT-C                                             
                 DELIMITED BY SPACES INTO BP13L0B6-REC.                         
           WRITE BP13L0B6-REC.                                                  
                                                                                
      ***12 MONTHS INCOME***                                                    
           MOVE SPACES         TO BP13L0B6-REC                                  
           WRITE BP13L0B6-REC  FROM BP13L0B6-PRSN-INCOME-OPEN.                  
                                                                                
           PERFORM VARYING IDX2 FROM 1 BY 1                                     
             UNTIL IDX2 > 12 OR L0B6-YEAR-MONTH(IDX2) = SPACES OR               
                                                        LOW-VALUES              
             MOVE SPACES               TO BP13L0B6-REC                          
             STRING FILL-YEAR-MON-O(IDX2) L0B6-YEAR-MONTH(IDX2)                 
                    FILL-YEAR-MON-C(IDX2) DELIMITED BY SPACES                   
                                     INTO BP13L0B6-REC                          
             WRITE BP13L0B6-REC                                                 
                                                                                
             MOVE SPACES               TO   BP13L0B6-REC                        
                                                                                
             IF (L0B6-INCOME-AMOUNT(IDX2) = '00000') OR                         
                (L0B6-INCOME-AMOUNT(IDX2) (1:1) NOT = '0')                      
                STRING FILL-INCOME-AMT-O(IDX2)                                  
                       L0B6-INCOME-AMOUNT(IDX2)                                 
                       FILL-INCOME-AMT-C(IDX2) DELIMITED BY SIZE                
                                          INTO BP13L0B6-REC                     
             ELSE                                                               
                MOVE ZEROES TO WS-POS WS-LEN                                    
                MOVE L0B6-INCOME-AMOUNT(IDX2)   TO WS-TMP-AMT                   
                PERFORM VARYING IDX1 FROM 1 BY 1 UNTIL IDX1 > 5                 
                   IF WS-TMP-AMT(IDX1:1) NOT = ZERO                             
                      COMPUTE WS-LEN = (5 - IDX1)                               
                      ADD 1       TO WS-LEN                                     
                      MOVE  IDX1  TO WS-POS                                     
                      MOVE  6     TO IDX1                                       
                   END-IF                                                       
                END-PERFORM                                                     
                STRING FILL-INCOME-AMT-O(IDX2)                                  
                       WS-TMP-AMT(WS-POS:WS-LEN)                                
                       FILL-INCOME-AMT-C(IDX2) DELIMITED BY SIZE                
                                          INTO BP13L0B6-REC                     
             END-IF                                                             
             WRITE BP13L0B6-REC                                                 
           END-PERFORM.                                                         
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           WRITE BP13L0B6-REC  FROM BP13L0B6-PRSN-INCOME-CLOSE.                 
      ****************************                                              
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-MCPS-O  L0B6-MCPS  FILL-MCPS-C                           
                 DELIMITED BY SPACES INTO BP13L0B6-REC                          
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-PPO-O  L0B6-PPO  FILL-PPO-C                              
                 DELIMITED BY SPACES INTO BP13L0B6-REC                          
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           IF L0B6-NRIC-SOC(1:1) = 'X'                                          
              STRING FILL-NRICSOC-O L0B6-NRIC-SOC(2:8)                          
                 FILL-NRICSOC-C  DELIMITED BY SPACES INTO BP13L0B6-REC          
           ELSE                                                                 
              STRING FILL-NRICSOC-O  L0B6-NRIC-SOC  FILL-NRICSOC-C              
                     DELIMITED BY SPACES INTO BP13L0B6-REC                      
           END-IF.                                                              
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-NAMESOC-O  L0B6-NAME-SOC  FILL-NAMESOC-C                 
                 DELIMITED BY SPACES INTO BP13L0B6-REC                          
           WRITE BP13L0B6-REC.                                                  
                                                                                
           MOVE SPACES         TO BP13L0B6-REC                                  
           STRING FILL-NOIM-O  L0B6-INCOME-MON3  FILL-NOIM-C                    
                 DELIMITED BY SPACES INTO BP13L0B6-REC                          
           WRITE BP13L0B6-REC.                                                  
                                                                                
           WRITE BP13L0B6-REC   FROM BP13L0B6-PRSN-CLOSE.                       
                                                                                
       2400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       2501-RTRIM.                                                              
      *-------------------------------------------------------------            
           MOVE ZERO      TO WS-SPACES-CNT                                      
           MOVE SPACES    TO WS-FLD-OK                                          
           MOVE 'N'       TO WS-STOP                                            
                                                                                
           PERFORM VARYING IDX1 FROM 1 BY 1                                     
              UNTIL IDX1 > 71 OR WS-STOP = 'Y'                                  
                 IF WS-CHECK-FLD(IDX1:1) = SPACE                                
                    ADD 1               TO WS-SPACES-CNT                        
                    IF WS-SPACES-CNT > 1                                        
                       SUBTRACT 3 FROM IDX1                                     
                       MOVE 'Y'     TO WS-STOP                                  
                    END-IF                                                      
                 ELSE                                                           
                    MOVE ZEROES  TO WS-SPACES-CNT                               
                 END-IF                                                         
           END-PERFORM.                                                         
                                                                                
       2501-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       9000-CLOSE-FILES.                                                        
      *-------------------------------------------------------------            
           DISPLAY '*************************************'.                     
           DISPLAY '*----- BP13CRB7 CONTROL TOTALS -----*'.                     
           DISPLAY '*************************************'.                     
           DISPLAY '*NO OF RECS READ    IN F0B6: ' WS-READ-F0B6                 
           DISPLAY '*NO OF RECS WRITE   IN L0B6: ' WS-WRITE-L0B6                
           DISPLAY '****************************************'.                  
                                                                                
           CLOSE BP13F0B6                                                       
                 BP13L0B6.                                                      
           STOP RUN.                                                            
       9000-EXIT.                                                               
