       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CZ2G.                                                 
      *AUTHOR.        LIZ PATIAG.                                               
      *DATE-WRITTEN.  02/07/2015.                                               
      * ========================================================== *            
      * SYSTEM OF COMMITMENT (BP13)                                *            
      * ========================================================== *            
      *                                                            *            
      * OBJECTIVE    : CREATE REPORT OF SINGLE ELIGIBLE AND        *            
      *                FAMILY ELIGIBLE WITH AGE >= 55              *            
      * INPUT  FILE  : BP13F730 - CASES PER REGN                   *            
      *                BP13K825 - CHECK IF NRIC1 IS FOUND          *            
      * OUTPUT FILE  : BP13LCZA - SINGLE ELIGIBLE - BTO            *            
      *                BP13LCZB - FAMILY ELIGIBLE - BTO            *            
      *                BP13LCZC - EXCEPTIONAL CASES - BTO          *            
      *                BP13LCZD - SINGLE ELIGIBLE - SBF            *            
      *                BP13LCZE - FAMILY ELIGIBLE - SBF            *            
      *                BP13LCZF - EXCEPTIONAL CASES - SBF          *            
      *                BP13LCZG - SINGLE ELIGIBLE - ROF            *            
      *                BP13LCZH - FAMILY ELIGIBLE - ROF            *            
      *                BP13LCZI - EXCEPTIONAL CASES - ROF          *            
      *                BP13F740 - BP13F730 WITH ELDERLY TAG,       *            
      *                           ALLOC AND ELIG SCHEME            *            
      * ========================================================== *            
      * CHG-REF#  BY    DDMMCCYY  DESCRIPTION                      *            
      * --------  ----  --------  -------------------------------- *            
      * BP135921  FNP1  02072015  NEW PROGRAM                      *            
      * BP136239  SMR2  26052016  ADD ALLO-CAT                     *            
      * BP136404  SMR2  23082016  CATER FOR DATE ON THE REPORT     *            
      * BP136404  SMR2  05102016  SEPARATE BTO AND SBF REPORTS     *            
      * BP136762  SMR2  06062017  CATER FOR FIANCE/FIANCEE ELIG-SCH*            
      * BP136852  SMR2  20072017  CATER FOR ROF REPORTS            *            
      * BP137208  YCH2  02022018  TO TAG ELDERLY FLAG FOR SERS CASE*            
      * BP137439  AM25  04092018  CORRECT PAGINATION ISSUE         *            
      * BP138285  AM25  18052020  CHANGE REPORT ID                 *            
      * BP139780  AM25  20122023  CORRECT CHECKING OF MS WHEN      *            
      *                           COUNTING CHILD AND INITIALIZATION*            
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F730 ASSIGN       TO BP13F730.                            
                                                                                
           SELECT BP13K825 ASSIGN       TO BP13K825                             
                           ACCESS MODE  IS DYNAMIC                              
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K825-KEY-FLD                         
                           FILE STATUS  IS WS-K825-STATUS.                      
                                                                                
           SELECT BP13K730  ASSIGN        TO BP13K730                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS K730-KEY-NEW                       
                            FILE STATUS   IS WS-K730-STATUS.                    
                                                                                
           SELECT P13LZ2GA ASSIGN       TO P13LZ2GA.                            
                                                                                
           SELECT P13LZ2GB ASSIGN       TO P13LZ2GB.                            
                                                                                
           SELECT P13LZ2GC ASSIGN       TO P13LZ2GC.                            
                                                                                
           SELECT P13LZ2GD ASSIGN       TO P13LZ2GD.                            
                                                                                
           SELECT P13LZ2GE ASSIGN       TO P13LZ2GE.                            
                                                                                
           SELECT P13LZ2GF ASSIGN       TO P13LZ2GF.                            
                                                                                
           SELECT P13LZ2GG ASSIGN       TO P13LZ2GG.                            
                                                                                
           SELECT P13LZ2GH ASSIGN       TO P13LZ2GH.                            
                                                                                
           SELECT P13LZ2GI ASSIGN       TO P13LZ2GI.                            
                                                                                
           SELECT BP13F740 ASSIGN       TO BP13F740.                            
                                                                                
           SELECT BP17F100 ASSIGN       TO BP17F100.                            
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD   BP13F730                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS  500 CHARACTERS                                     
            RECORDING MODE    IS F                                              
            LABEL RECORD      IS STANDARD.                                      
       COPY BP13F730.                                                           
                                                                                
       FD   BP13K825                                                            
            RECORD CONTAINS  200 CHARACTERS.                                    
       COPY BP13K825.                                                           
                                                                                
       FD   BP13K730                                                            
            RECORD CONTAINS  500 CHARACTERS.                                    
       COPY BP13K730.                                                           
                                                                                
       FD   P13LZ2GA                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS   99 CHARACTERS                                     
            RECORDING MODE    IS F                                              
            LABEL RECORD      IS STANDARD.                                      
       01   BP13LCZA-REC                   PIC X(99).                           
                                                                                
       FD   P13LZ2GB                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS   99 CHARACTERS                                     
            RECORDING MODE    IS F                                              
            LABEL RECORD      IS STANDARD.                                      
       01   BP13LCZB-REC                   PIC X(99).                           
                                                                                
       FD   P13LZ2GC                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS   99 CHARACTERS                                     
            RECORDING MODE    IS F                                              
            LABEL RECORD      IS STANDARD.                                      
       01   BP13LCZC-REC                   PIC X(99).                           
                                                                                
       FD   P13LZ2GD                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS   99 CHARACTERS                                     
            RECORDING MODE    IS F                                              
            LABEL RECORD      IS STANDARD.                                      
       01   BP13LCZD-REC                   PIC X(99).                           
                                                                                
       FD   P13LZ2GE                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS   99 CHARACTERS                                     
            RECORDING MODE    IS F                                              
            LABEL RECORD      IS STANDARD.                                      
       01   BP13LCZE-REC                   PIC X(99).                           
                                                                                
       FD   P13LZ2GF                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS   99 CHARACTERS                                     
            RECORDING MODE    IS F                                              
            LABEL RECORD      IS STANDARD.                                      
       01   BP13LCZF-REC                   PIC X(99).                           
                                                                                
       FD   P13LZ2GG                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS   99 CHARACTERS                                     
            RECORDING MODE    IS F                                              
            LABEL RECORD      IS STANDARD.                                      
       01   BP13LCZG-REC                   PIC X(99).                           
                                                                                
       FD   P13LZ2GH                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS   99 CHARACTERS                                     
            RECORDING MODE    IS F                                              
            LABEL RECORD      IS STANDARD.                                      
       01   BP13LCZH-REC                   PIC X(99).                           
                                                                                
       FD   P13LZ2GI                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS   99 CHARACTERS                                     
            RECORDING MODE    IS F                                              
            LABEL RECORD      IS STANDARD.                                      
       01   BP13LCZI-REC                   PIC X(99).                           
                                                                                
       FD   BP13F740                                                            
            BLOCK CONTAINS     0 RECORDS                                        
            RECORD CONTAINS  500 CHARACTERS                                     
            RECORDING MODE    IS F                                              
            LABEL RECORD      IS STANDARD.                                      
       COPY BP13F740.                                                           
                                                                                
       FD  BP17F100                                                             
           BLOCK  CONTAINS 0   RECORDS                                          
           RECORD CONTAINS 400 CHARACTERS                                       
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD.                                          
       COPY BP17F100.                                                           
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-FILE-STATUS.                                                      
           05  WS-K730-STATUS              PIC 9(02)   VALUE ZEROES.            
           05  WS-K757-STATUS              PIC 9(02)   VALUE ZEROES.            
           05  WS-K825-STATUS              PIC 9(02)   VALUE ZEROES.            
           05  WS-K030-STATUS              PIC 9(02)   VALUE ZEROES.            
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-F730-READ                PIC 9(08)   VALUE ZEROES.            
           05  WS-SERS-CNT                 PIC 9(01)   VALUE ZEROES.            
           05  K730-FND-CNT                PIC 9(08)   VALUE ZEROES.            
           05  K730-NFND-CNT               PIC 9(08)   VALUE ZEROES.            
           05  WS-K730-UPD                 PIC 9(08)   VALUE ZEROES.            
           05  WS-LCZA-WRITE               PIC 9(08)   VALUE ZEROES.            
           05  WS-LCZB-WRITE               PIC 9(08)   VALUE ZEROES.            
           05  WS-LCZC-WRITE               PIC 9(08)   VALUE ZEROES.            
           05  WS-LCZD-WRITE               PIC 9(08)   VALUE ZEROES.            
           05  WS-LCZE-WRITE               PIC 9(08)   VALUE ZEROES.            
           05  WS-LCZF-WRITE               PIC 9(08)   VALUE ZEROES.            
           05  WS-LCZG-WRITE               PIC 9(08)   VALUE ZEROES.            
           05  WS-LCZH-WRITE               PIC 9(08)   VALUE ZEROES.            
           05  WS-LCZI-WRITE               PIC 9(08)   VALUE ZEROES.            
           05  WS-F730-WRITE               PIC 9(08)   VALUE ZEROES.            
           05  WS-CNT-CHILD                PIC 9(02)   VALUE ZEROES.            
           05  WS-SN-LCZA                  PIC 9(07)   VALUE ZEROES.            
           05  WS-SN-LCZB                  PIC 9(07)   VALUE ZEROES.            
           05  WS-SN-LCZC                  PIC 9(07)   VALUE ZEROES.            
           05  WS-SN-LCZD                  PIC 9(07)   VALUE ZEROES.            
           05  WS-SN-LCZE                  PIC 9(07)   VALUE ZEROES.            
           05  WS-SN-LCZF                  PIC 9(07)   VALUE ZEROES.            
           05  WS-SN-LCZG                  PIC 9(07)   VALUE ZEROES.            
           05  WS-SN-LCZH                  PIC 9(07)   VALUE ZEROES.            
           05  WS-SN-LCZI                  PIC 9(07)   VALUE ZEROES.            
           05  WS-CNT                      PIC 9(01)   VALUE ZEROES.            
           05  WS-CNT2                     PIC 9(01)   VALUE ZEROES.            
           05  WS-PAGE-CNT-A               PIC 9(04)   VALUE ZEROES.            
           05  WS-PAGE-CNT-B               PIC 9(04)   VALUE ZEROES.            
           05  WS-PAGE-CNT-C               PIC 9(04)   VALUE ZEROES.            
           05  WS-PAGE-CNT-D               PIC 9(04)   VALUE ZEROES.            
           05  WS-PAGE-CNT-E               PIC 9(04)   VALUE ZEROES.            
           05  WS-PAGE-CNT-F               PIC 9(04)   VALUE ZEROES.            
           05  WS-PAGE-CNT-G               PIC 9(04)   VALUE ZEROES.            
           05  WS-PAGE-CNT-H               PIC 9(04)   VALUE ZEROES.            
           05  WS-PAGE-CNT-I               PIC 9(04)   VALUE ZEROES.            
           05  WS-LINE-CNT-A               PIC 9(02)   VALUE ZEROES.            
           05  WS-LINE-CNT-B               PIC 9(02)   VALUE ZEROES.            
           05  WS-LINE-CNT-C               PIC 9(02)   VALUE ZEROES.            
           05  WS-LINE-CNT-D               PIC 9(02)   VALUE ZEROES.            
           05  WS-LINE-CNT-E               PIC 9(02)   VALUE ZEROES.            
           05  WS-LINE-CNT-F               PIC 9(02)   VALUE ZEROES.            
           05  WS-LINE-CNT-G               PIC 9(02)   VALUE ZEROES.            
           05  WS-LINE-CNT-H               PIC 9(02)   VALUE ZEROES.            
           05  WS-LINE-CNT-I               PIC 9(02)   VALUE ZEROES.            
                                                                                
       01  WS-SWITCHES.                                                         
           05  WS-STS-ELIG                 PIC X(01)   VALUE 'N'.               
           05  WS-EPA-ELIG                 PIC X(01)   VALUE 'N'.               
           05  WS-BP17F100-EOF             PIC X(01)   VALUE 'N'.               
           05  WS-F730-EOF                 PIC X(01)   VALUE 'N'.               
           05  WS-K825-EOF                 PIC X(01)   VALUE 'N'.               
           05  WS-K825-FND                 PIC X(01)   VALUE 'N'.               
           05  WS-K730-FND                 PIC X(01)   VALUE 'N'.               
           05  WS-LCZA-HDR                 PIC X(01)   VALUE 'N'.               
           05  WS-LCZB-HDR                 PIC X(01)   VALUE 'N'.               
           05  WS-LCZC-HDR                 PIC X(01)   VALUE 'N'.               
           05  WS-LCZD-HDR                 PIC X(01)   VALUE 'N'.               
           05  WS-LCZE-HDR                 PIC X(01)   VALUE 'N'.               
           05  WS-LCZF-HDR                 PIC X(01)   VALUE 'N'.               
           05  WS-LCZG-HDR                 PIC X(01)   VALUE 'N'.               
           05  WS-LCZH-HDR                 PIC X(01)   VALUE 'N'.               
           05  WS-LCZI-HDR                 PIC X(01)   VALUE 'N'.               
                                                                                
       01  WS-DATE-VARIABLES.                                                   
           05  WS-NUM-BIRTH                PIC 9(08)   VALUE ZEROES.            
           05  WS-DTE-REQUEST              PIC 9(08)   VALUE ZEROES.            
           05  WS-SYSTEM-DATE              PIC 9(08)   VALUE ZEROES.            
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-SN                       PIC 9(04)   VALUE ZEROES.            
           05  WS-NUM-REGN                 PIC X(08)   VALUE SPACES.            
           05  WS-NUM-NRIC                 PIC X(09)   VALUE SPACES.            
           05  WS-NUM-NRIC-PROC            PIC X(09)   VALUE SPACES.            
           05  WS-NUM-NRIC-SP              PIC X(09)   VALUE SPACES.            
           05  WS-SERS-DTE-ANNOUNCE        PIC X(08)   VALUE SPACES.            
           05  WS-NUM-AGE                  PIC 9(08)   VALUE ZEROES.            
           05  WS-CHILD-AGE REDEFINES WS-NUM-AGE.                               
               10  WS-AGE-CY               PIC 9(04).                           
               10  WS-AGE-MM               PIC 9(02).                           
               10  WS-AGE-DD               PIC 9(02).                           
           05  WS-ELDERLY                  PIC X(1)    VALUE SPACES.            
           05  WS-ELDERLY-PREMIUM          PIC X(1)    VALUE SPACES.            
           05  WS-HH-INCOME                PIC 9(6)    VALUE ZEROES.            
           05  WS-NRIC-INFO OCCURS 4 TIMES.                                     
               07  WS-NRIC              PIC X(09)      VALUE SPACES.            
               07  WS-NRIC-AGE          PIC 9(02)      VALUE ZEROES.            
               07  WS-NRIC-RL           PIC X(02)      VALUE SPACES.            
               07  WS-NRIC-MS           PIC X(01)      VALUE SPACES.            
               07  WS-NRIC-CHILD        PIC 9(02)      VALUE ZEROES.            
               07  WS-NRIC-INCOME       PIC 9(05)      VALUE ZEROES.            
               07  WS-NRIC-SP           PIC X(09)      VALUE SPACES.            
               07  WS-NRIC-SP-CTZ       PIC X(02)      VALUE SPACES.            
               07  WS-NRIC-SP-AGE       PIC X(02)      VALUE SPACES.            
               07  WS-NRIC-SP-MS        PIC X(01)      VALUE SPACES.            
               07  WS-NRIC-SP-RL        PIC X(02)      VALUE SPACES.            
               07  WS-NRIC-SP-CHILD     PIC 9(02)      VALUE ZEROES.            
               07  WS-NRIC-SP-INCOME    PIC 9(05)      VALUE ZEROES.            
                                                                                
       01  LZ2G-HEADER01.                                                       
           05  LZ2G-TITLE-HDR      PIC X(08)     VALUE 'BP13LZ2G'.              
           05  FILLER              PIC X(01)     VALUE '_'.                     
           05  LZ2G-SMODE-HDR      PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(13)     VALUE SPACES.                  
           05  FILLER              PIC X(20)     VALUE                          
               'SYSTEM OF COMMITMENT'.                                          
           05  FILLER              PIC X(28)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE : '.               
           05  LZ2G-DATE-HDR       PIC X(10)     VALUE SPACES.                  
                                                                                
       01  LZ2G-HEADER02-SINGLE-BTO.                                            
           05  FILLER              PIC X(20)     VALUE SPACES.                  
           05  FILLER              PIC X(48)     VALUE                          
               'REPORT ON ELIGIBLE CASES FOR SINGLE SCHEME (BTO)'.              
           05  FILLER              PIC X(14)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LZ2G-PAGE-HDR-SBTO  PIC ZZZ9      VALUE ZEROES.                  
           05  FILLER              PIC X(6)      VALUE SPACES.                  
                                                                                
       01  LZ2G-HEADER02-FAMILY-BTO.                                            
           05  FILLER              PIC X(20)     VALUE SPACES.                  
           05  FILLER              PIC X(48)     VALUE                          
               'REPORT ON ELIGIBLE CASES FOR FAMILY SCHEME (BTO)'.              
           05  FILLER              PIC X(14)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LZ2G-PAGE-HDR-FBTO  PIC ZZZ9      VALUE ZEROES.                  
           05  FILLER              PIC X(6)      VALUE SPACES.                  
                                                                                
       01  LZ2G-HEADER02-EXCEPTIONAL-BTO.                                       
           05  FILLER              PIC X(27)     VALUE SPACES.                  
           05  FILLER              PIC X(33)     VALUE                          
               'REPORT ON EXCEPTIONAL CASES (BTO)'.                             
           05  FILLER              PIC X(22)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LZ2G-PAGE-HDR-EBTO  PIC ZZZ9      VALUE ZEROES.                  
           05  FILLER              PIC X(6)      VALUE SPACES.                  
                                                                                
       01  LZ2G-HEADER02-SINGLE-SER.                                            
           05  FILLER              PIC X(20)     VALUE SPACES.                  
           05  FILLER              PIC X(48)     VALUE                          
               'REPORT ON ELIGIBLE CASES FOR SINGLE SCHEME (SER)'.              
           05  FILLER              PIC X(14)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LZ2G-PAGE-HDR-SSER  PIC ZZZ9      VALUE ZEROES.                  
           05  FILLER              PIC X(6)      VALUE SPACES.                  
                                                                                
       01  LZ2G-HEADER02-FAMILY-SER.                                            
           05  FILLER              PIC X(20)     VALUE SPACES.                  
           05  FILLER              PIC X(48)     VALUE                          
               'REPORT ON ELIGIBLE CASES FOR FAMILY SCHEME (SER)'.              
           05  FILLER              PIC X(14)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LZ2G-PAGE-HDR-FSER  PIC ZZZ9      VALUE ZEROES.                  
           05  FILLER              PIC X(6)      VALUE SPACES.                  
                                                                                
       01  LZ2G-HEADER02-EXCEPTIONAL-SER.                                       
           05  FILLER              PIC X(27)     VALUE SPACES.                  
           05  FILLER              PIC X(33)     VALUE                          
               'REPORT ON EXCEPTIONAL CASES (SER)'.                             
           05  FILLER              PIC X(22)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LZ2G-PAGE-HDR-ESER  PIC ZZZ9      VALUE ZEROES.                  
           05  FILLER              PIC X(6)      VALUE SPACES.                  
                                                                                
       01  LZ2G-HEADER02-SINGLE-SBF.                                            
           05  FILLER              PIC X(20)     VALUE SPACES.                  
           05  FILLER              PIC X(48)     VALUE                          
               'REPORT ON ELIGIBLE CASES FOR SINGLE SCHEME (SBF)'.              
           05  FILLER              PIC X(14)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LZ2G-PAGE-HDR-SSBF  PIC ZZZ9      VALUE ZEROES.                  
           05  FILLER              PIC X(6)      VALUE SPACES.                  
                                                                                
       01  LZ2G-HEADER02-FAMILY-SBF.                                            
           05  FILLER              PIC X(20)     VALUE SPACES.                  
           05  FILLER              PIC X(48)     VALUE                          
               'REPORT ON ELIGIBLE CASES FOR FAMILY SCHEME (SBF)'.              
           05  FILLER              PIC X(14)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LZ2G-PAGE-HDR-FSBF  PIC ZZZ9      VALUE ZEROES.                  
           05  FILLER              PIC X(6)      VALUE SPACES.                  
                                                                                
       01  LZ2G-HEADER02-EXCEPTIONAL-SBF.                                       
           05  FILLER              PIC X(27)     VALUE SPACES.                  
           05  FILLER              PIC X(33)     VALUE                          
               'REPORT ON EXCEPTIONAL CASES (SBF)'.                             
           05  FILLER              PIC X(22)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LZ2G-PAGE-HDR-ESBF  PIC ZZZ9      VALUE ZEROES.                  
           05  FILLER              PIC X(6)      VALUE SPACES.                  
                                                                                
       01  LZ2G-HEADER02-SINGLE-ROF.                                            
           05  FILLER              PIC X(20)     VALUE SPACES.                  
           05  FILLER              PIC X(48)     VALUE                          
               'REPORT ON ELIGIBLE CASES FOR SINGLE SCHEME (ROF)'.              
           05  FILLER              PIC X(14)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LZ2G-PAGE-HDR-SROF  PIC ZZZ9      VALUE ZEROES.                  
           05  FILLER              PIC X(6)      VALUE SPACES.                  
                                                                                
       01  LZ2G-HEADER02-FAMILY-ROF.                                            
           05  FILLER              PIC X(20)     VALUE SPACES.                  
           05  FILLER              PIC X(48)     VALUE                          
               'REPORT ON ELIGIBLE CASES FOR FAMILY SCHEME (ROF)'.              
           05  FILLER              PIC X(14)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LZ2G-PAGE-HDR-FROF  PIC ZZZ9      VALUE ZEROES.                  
           05  FILLER              PIC X(6)      VALUE SPACES.                  
                                                                                
       01  LZ2G-HEADER02-EXCEPTIONAL-ROF.                                       
           05  FILLER              PIC X(27)     VALUE SPACES.                  
           05  FILLER              PIC X(33)     VALUE                          
               'REPORT ON EXCEPTIONAL CASES (ROF)'.                             
           05  FILLER              PIC X(22)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  LZ2G-PAGE-HDR-EROF  PIC ZZZ9      VALUE ZEROES.                  
           05  FILLER              PIC X(6)      VALUE SPACES.                  
                                                                                
       01  LZ2G-BLANK.                                                          
           05  FILLER              PIC X(99)    VALUE SPACES.                   
                                                                                
       01  LZ2G-HEADER03.                                                       
           05  FILLER              PIC X(01)    VALUE SPACES.                   
           05  FILLER              PIC X(07)    VALUE '    S/N'.                
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(08)    VALUE 'REGN NO '.               
           05  FILLER              PIC X(01)    VALUE SPACES.                   
           05  FILLER              PIC X(09)    VALUE 'NRIC'.                   
           05  FILLER              PIC X(01)    VALUE SPACES.                   
           05  FILLER              PIC X(05)    VALUE 'SMODE'.                  
           05  FILLER              PIC X(01)    VALUE SPACES.                   
           05  FILLER              PIC X(02)    VALUE 'MS'.                     
           05  FILLER              PIC X(01)    VALUE SPACES.                   
           05  FILLER              PIC X(03)    VALUE 'AGE'.                    
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(05)    VALUE 'CHILD'.                  
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(02)    VALUE 'RL'.                     
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(02)    VALUE 'NT'.                     
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(02)    VALUE 'FT'.                     
           05  FILLER              PIC X(03)    VALUE SPACES.                   
           05  FILLER              PIC X(02)    VALUE 'HH'.                     
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(04)    VALUE 'B-HH'.                   
           05  FILLER              PIC X(02)    VALUE SPACES.                   
           05  FILLER              PIC X(04)    VALUE 'ELIG'.                   
           05  FILLER              PIC X(01)    VALUE SPACES.                   
           05  FILLER              PIC X(06)    VALUE 'ALLO'.                   
           05  FILLER              PIC X(03)    VALUE 'PPO'.                    
                                                                                
       01  LZ2G-DETAIL01.                                                       
           05  FILLER              PIC X(01)        VALUE SPACES.               
           05  LZ2G-SN             PIC X(07)        VALUE ZEROES.               
           05  FILLER              PIC X(02)        VALUE SPACES.               
           05  LZ2G-REGN           PIC X(08)        VALUE SPACES.               
           05  FILLER              PIC X(01)        VALUE SPACES.               
           05  LZ2G-NRIC           PIC X(09)        VALUE SPACES.               
           05  FILLER              PIC X(02)        VALUE SPACES.               
           05  LZ2G-SMODE          PIC X(03)        VALUE SPACES.               
           05  FILLER              PIC X(03)        VALUE SPACES.               
           05  LZ2G-MARITAL-STATUS PIC X(01)        VALUE SPACES.               
           05  FILLER              PIC X(01)        VALUE SPACES.               
           05  LZ2G-NUM-AGE        PIC 9(02)        VALUE ZEROES.               
           05  FILLER              PIC X(03)        VALUE SPACES.               
           05  LZ2G-CNT-CHILD      PIC X(02)        VALUE SPACES.               
           05  FILLER              PIC X(05)        VALUE SPACES.               
           05  LZ2G-NUM-RELATION   PIC X(02)        VALUE SPACES.               
           05  FILLER              PIC X(02)        VALUE SPACES.               
           05  LZ2G-NUM-NEW-TOWN   PIC X(03)        VALUE SPACES.               
           05  FILLER              PIC X(02)        VALUE SPACES.               
           05  LZ2G-NUM-FLAT-TYPE  PIC X(02)        VALUE SPACES.               
           05  FILLER              PIC X(02)        VALUE SPACES.               
           05  LZ2G-NUM-HOUSEHOLD  PIC X(02)        VALUE SPACES.               
           05  FILLER              PIC X(03)        VALUE SPACES.               
           05  LZ2G-NUM-BALLOT-HH  PIC X(02)        VALUE SPACES.               
           05  FILLER              PIC X(04)        VALUE SPACES.               
           05  LZ2G-NUM-ELIG-SCH   PIC X(03)        VALUE SPACES.               
           05  FILLER              PIC X(02)        VALUE SPACES.               
           05  LZ2G-NUM-ALLO-SCH   PIC X(03)        VALUE SPACES.               
           05  FILLER              PIC X(02)        VALUE SPACES.               
           05  LZ2G-NUM-PPO        PIC X(01)        VALUE SPACES.               
                                                                                
                                                                                
      ******************************************************************        
       PROCEDURE DIVISION.                                                      
      ******************************************************************        
                                                                                
      ********************                                                      
       0000-MAIN-ROUTINE.                                                       
      ********************                                                      
                                                                                
           PERFORM 1000-OPEN-FILES         THRU 1000-EXIT.                      
           PERFORM 2000-READ-BP13F730      THRU 2000-EXIT.                      
           PERFORM 2100-READ-BP17F100      THRU 2100-EXIT                       
             UNTIL WS-BP17F100-EOF = 'Y'.                                       
           PERFORM 3000-PROCESS-RECS       THRU 3000-EXIT                       
             UNTIL WS-F730-EOF = 'Y'.                                           
           PERFORM 9000-CLOSE-FILES        THRU 9000-EXIT.                      
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************                                                        
       1000-OPEN-FILES.                                                         
      ******************                                                        
                                                                                
           OPEN INPUT  BP13F730                                                 
                       BP13K825                                                 
                       BP17F100                                                 
                I-O    BP13K730                                                 
                OUTPUT P13LZ2GA                                                 
                       P13LZ2GB                                                 
                       P13LZ2GC                                                 
                       P13LZ2GD                                                 
                       P13LZ2GE                                                 
                       P13LZ2GF                                                 
                       P13LZ2GG                                                 
                       P13LZ2GH                                                 
                       P13LZ2GI                                                 
                       BP13F740.                                                
                                                                                
           IF WS-K825-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'OPENING BP13K825 FILE ERROR ' WS-K825-STATUS             
              MOVE WS-K825-STATUS          TO RETURN-CODE                       
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K730-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'OPENING BP13K730 FILE ERROR ' WS-K730-STATUS             
              MOVE WS-K730-STATUS          TO RETURN-CODE                       
              PERFORM 9000-CLOSE-FILES     THRU 9000-EXIT                       
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-SYSTEM-DATE.                   
                                                                                
           STRING WS-SYSTEM-DATE(7:2) '/'                                       
                  WS-SYSTEM-DATE(5:2) '/'                                       
                  WS-SYSTEM-DATE(1:4)                                           
                  DELIMITED BY SIZE INTO LZ2G-DATE-HDR.                         
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       1100-PRINT-HDR-SBTO.                                                     
      *********************                                                     
                                                                                
           ADD 1                       TO WS-PAGE-CNT-A.                        
                                                                                
           IF F730-NUM-ALLO-CAT = 'SER'                                         
              MOVE WS-PAGE-CNT-A       TO LZ2G-PAGE-HDR-SSER                    
              MOVE 'SER'               TO LZ2G-SMODE-HDR                        
              WRITE BP13LCZA-REC FROM LZ2G-HEADER01 AFTER PAGE                  
              WRITE BP13LCZA-REC FROM LZ2G-HEADER02-SINGLE-SER AFTER 2          
           ELSE                                                                 
              MOVE WS-PAGE-CNT-A       TO LZ2G-PAGE-HDR-SBTO                    
              MOVE 'BTO'               TO LZ2G-SMODE-HDR                        
              WRITE BP13LCZA-REC FROM LZ2G-HEADER01 AFTER PAGE                  
              WRITE BP13LCZA-REC FROM LZ2G-HEADER02-SINGLE-BTO AFTER 2          
           END-IF.                                                              
           WRITE BP13LCZA-REC FROM LZ2G-BLANK.                                  
           WRITE BP13LCZA-REC FROM LZ2G-HEADER03.                               
           WRITE BP13LCZA-REC FROM LZ2G-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT-A.                        
                                                                                
       1100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       1200-PRINT-HDR-FBTO.                                                     
      *********************                                                     
                                                                                
           ADD 1                       TO WS-PAGE-CNT-B.                        
                                                                                
           IF F730-NUM-ALLO-CAT = 'SER'                                         
              MOVE WS-PAGE-CNT-B       TO LZ2G-PAGE-HDR-FSER                    
              MOVE 'SER'               TO LZ2G-SMODE-HDR                        
              WRITE BP13LCZB-REC FROM LZ2G-HEADER01 AFTER PAGE                  
              WRITE BP13LCZB-REC FROM LZ2G-HEADER02-FAMILY-SER AFTER 2          
           ELSE                                                                 
              MOVE WS-PAGE-CNT-B       TO LZ2G-PAGE-HDR-FBTO                    
              MOVE 'BTO'               TO LZ2G-SMODE-HDR                        
              WRITE BP13LCZB-REC FROM LZ2G-HEADER01 AFTER PAGE                  
              WRITE BP13LCZB-REC FROM LZ2G-HEADER02-FAMILY-BTO AFTER 2          
           END-IF.                                                              
           WRITE BP13LCZB-REC FROM LZ2G-BLANK.                                  
           WRITE BP13LCZB-REC FROM LZ2G-HEADER03.                               
           WRITE BP13LCZB-REC FROM LZ2G-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT-B.                        
                                                                                
       1200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       1300-PRINT-HDR-EBTO.                                                     
      *********************                                                     
                                                                                
           ADD 1                       TO WS-PAGE-CNT-C.                        
                                                                                
           IF F730-NUM-ALLO-CAT = 'SER'                                         
              MOVE WS-PAGE-CNT-C       TO LZ2G-PAGE-HDR-ESER                    
              MOVE 'SER'               TO LZ2G-SMODE-HDR                        
              WRITE BP13LCZC-REC FROM LZ2G-HEADER01 AFTER PAGE                  
              WRITE BP13LCZC-REC FROM LZ2G-HEADER02-EXCEPTIONAL-SER             
                                                           AFTER 2              
           ELSE                                                                 
              MOVE WS-PAGE-CNT-C       TO LZ2G-PAGE-HDR-EBTO                    
              MOVE 'BTO'               TO LZ2G-SMODE-HDR                        
              WRITE BP13LCZC-REC FROM LZ2G-HEADER01 AFTER PAGE                  
              WRITE BP13LCZC-REC FROM LZ2G-HEADER02-EXCEPTIONAL-BTO             
                                                           AFTER 2              
           END-IF.                                                              
           WRITE BP13LCZC-REC FROM LZ2G-BLANK.                                  
           WRITE BP13LCZC-REC FROM LZ2G-HEADER03.                               
           WRITE BP13LCZC-REC FROM LZ2G-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT-C.                        
                                                                                
       1300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       1400-PRINT-HDR-SSBF.                                                     
      *********************                                                     
                                                                                
           ADD 1                       TO WS-PAGE-CNT-D.                        
           MOVE WS-PAGE-CNT-D          TO LZ2G-PAGE-HDR-SSBF.                   
           MOVE 'SBF'                  TO LZ2G-SMODE-HDR.                       
                                                                                
           WRITE BP13LCZD-REC FROM LZ2G-HEADER01 AFTER PAGE.                    
           WRITE BP13LCZD-REC FROM LZ2G-HEADER02-SINGLE-SBF AFTER 2.            
           WRITE BP13LCZD-REC FROM LZ2G-BLANK.                                  
           WRITE BP13LCZD-REC FROM LZ2G-HEADER03.                               
           WRITE BP13LCZD-REC FROM LZ2G-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT-D.                        
                                                                                
       1400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       1500-PRINT-HDR-FSBF.                                                     
      *********************                                                     
                                                                                
           ADD 1                       TO WS-PAGE-CNT-E.                        
           MOVE WS-PAGE-CNT-E          TO LZ2G-PAGE-HDR-FSBF.                   
           MOVE 'SBF'                  TO LZ2G-SMODE-HDR.                       
                                                                                
           WRITE BP13LCZE-REC FROM LZ2G-HEADER01 AFTER PAGE.                    
           WRITE BP13LCZE-REC FROM LZ2G-HEADER02-FAMILY-SBF AFTER 2.            
           WRITE BP13LCZE-REC FROM LZ2G-BLANK.                                  
           WRITE BP13LCZE-REC FROM LZ2G-HEADER03.                               
           WRITE BP13LCZE-REC FROM LZ2G-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT-E.                        
                                                                                
       1500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       1600-PRINT-HDR-ESBF.                                                     
      *********************                                                     
                                                                                
           ADD 1                       TO WS-PAGE-CNT-F.                        
           MOVE WS-PAGE-CNT-F          TO LZ2G-PAGE-HDR-ESBF.                   
           MOVE 'SBF'                  TO LZ2G-SMODE-HDR.                       
                                                                                
           WRITE BP13LCZF-REC FROM LZ2G-HEADER01 AFTER PAGE.                    
           WRITE BP13LCZF-REC FROM LZ2G-HEADER02-EXCEPTIONAL-SBF                
                                                           AFTER 2.             
           WRITE BP13LCZF-REC FROM LZ2G-BLANK.                                  
           WRITE BP13LCZF-REC FROM LZ2G-HEADER03.                               
           WRITE BP13LCZF-REC FROM LZ2G-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT-F.                        
                                                                                
       1600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       1700-PRINT-HDR-SROF.                                                     
      *********************                                                     
                                                                                
           ADD 1                       TO WS-PAGE-CNT-G.                        
           MOVE WS-PAGE-CNT-G          TO LZ2G-PAGE-HDR-SROF.                   
           MOVE 'ROF'                  TO LZ2G-SMODE-HDR.                       
                                                                                
           WRITE BP13LCZG-REC FROM LZ2G-HEADER01 AFTER PAGE.                    
           WRITE BP13LCZG-REC FROM LZ2G-HEADER02-SINGLE-ROF AFTER 2.            
           WRITE BP13LCZG-REC FROM LZ2G-BLANK.                                  
           WRITE BP13LCZG-REC FROM LZ2G-HEADER03.                               
           WRITE BP13LCZG-REC FROM LZ2G-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT-G.                        
                                                                                
       1700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       1800-PRINT-HDR-FROF.                                                     
      *********************                                                     
                                                                                
           ADD 1                       TO WS-PAGE-CNT-H.                        
           MOVE WS-PAGE-CNT-H          TO LZ2G-PAGE-HDR-FROF.                   
           MOVE 'ROF'                  TO LZ2G-SMODE-HDR.                       
                                                                                
           WRITE BP13LCZH-REC FROM LZ2G-HEADER01 AFTER PAGE.                    
           WRITE BP13LCZH-REC FROM LZ2G-HEADER02-FAMILY-ROF AFTER 2.            
           WRITE BP13LCZH-REC FROM LZ2G-BLANK.                                  
           WRITE BP13LCZH-REC FROM LZ2G-HEADER03.                               
           WRITE BP13LCZH-REC FROM LZ2G-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT-H.                        
                                                                                
       1800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       1900-PRINT-HDR-EROF.                                                     
      *********************                                                     
                                                                                
           ADD 1                       TO WS-PAGE-CNT-I.                        
           MOVE WS-PAGE-CNT-I          TO LZ2G-PAGE-HDR-EROF.                   
           MOVE 'ROF'                  TO LZ2G-SMODE-HDR.                       
                                                                                
           WRITE BP13LCZI-REC FROM LZ2G-HEADER01 AFTER PAGE.                    
           WRITE BP13LCZI-REC FROM LZ2G-HEADER02-EXCEPTIONAL-ROF                
                                                           AFTER 2.             
           WRITE BP13LCZI-REC FROM LZ2G-BLANK.                                  
           WRITE BP13LCZI-REC FROM LZ2G-HEADER03.                               
           WRITE BP13LCZI-REC FROM LZ2G-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT-I.                        
                                                                                
       1900-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       2000-READ-BP13F730.                                                      
      *********************                                                     
                                                                                
           READ BP13F730 AT END                                                 
                MOVE 'Y'                   TO WS-F730-EOF                       
                GO TO 2000-EXIT.                                                
                                                                                
           ADD 1                           TO WS-F730-READ.                     
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *********************                                                     
       2100-READ-BP17F100.                                                      
      *********************                                                     
                                                                                
           READ BP17F100 AT END                                                 
                MOVE 'Y' TO WS-BP17F100-EOF                                     
                GO TO 2100-EXIT.                                                
                                                                                
           MOVE SPACES                  TO WS-SERS-DTE-ANNOUNCE                 
           MOVE F100-DTE-ANNOUNCE       TO WS-SERS-DTE-ANNOUNCE.                
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ********************                                                      
       3000-PROCESS-RECS.                                                       
      ********************                                                      
                                                                                
           PERFORM VARYING WS-CNT FROM 1 BY 1 UNTIL WS-CNT > 4                  
              MOVE SPACES          TO WS-NRIC(WS-CNT)                           
                                      WS-NRIC-RL(WS-CNT)                        
                                      WS-NRIC-MS(WS-CNT)                        
                                      WS-NRIC-SP(WS-CNT)                        
                                      WS-NRIC-SP-CTZ(WS-CNT)                    
                                      WS-NRIC-SP-AGE(WS-CNT)                    
                                      WS-NRIC-SP-MS(WS-CNT)                     
                                      WS-NRIC-SP-RL(WS-CNT)                     
              MOVE ZEROES          TO WS-NRIC-AGE(WS-CNT)                       
                                      WS-NRIC-CHILD(WS-CNT)                     
                                      WS-NRIC-INCOME(WS-CNT)                    
                                      WS-NRIC-SP-CHILD(WS-CNT)                  
                                      WS-NRIC-SP-INCOME(WS-CNT)                 
           END-PERFORM.                                                         
                                                                                
           INITIALIZE                      BP13K825-REC.                        
           MOVE SPACES                  TO WS-NUM-REGN                          
                                           WS-NUM-NRIC.                         
           MOVE ZEROES                  TO WS-NUM-AGE                           
                                           WS-SERS-CNT                          
                                           WS-CNT-CHILD                         
                                           WS-HH-INCOME.                        
           MOVE 'Y'                     TO WS-STS-ELIG.                         
           MOVE 'Y'                     TO WS-EPA-ELIG.                         
           MOVE 'N'                     TO WS-K825-FND.                         
           MOVE 1                       TO WS-CNT.                              
           MOVE 'N'                     TO WS-ELDERLY.                          
                                                                                
      *    IF F730-CDE-FLAT-TYPE  = '2'                                         
              PERFORM 3100-GET-NRIC-INFO   THRU 3100-EXIT                       
              MOVE 1 TO WS-CNT                                                  
              PERFORM 4100-CHECK-ELIG        THRU 4100-EXIT                     
                UNTIL WS-NRIC(WS-CNT) = SPACES                                  
                   OR WS-CNT > 4                                                
                                                                                
              IF WS-STS-ELIG = 'Y' AND F730-NUM-ALLO-CAT = 'SER' AND            
                 WS-SERS-CNT > 1                                                
                 MOVE 'N' TO WS-STS-ELIG                                        
              END-IF                                                            
                                                                                
              MOVE 1       TO WS-CNT                                            
              PERFORM 4120-CHECK-NC-SPOUSE-ELIG THRU 4120-EXIT                  
                UNTIL WS-NRIC(WS-CNT) = SPACES                                  
                   OR WS-CNT > 4                                                
                                                                                
              IF WS-STS-ELIG = 'Y'                                              
                 MOVE 'S' TO WS-ELDERLY                                         
              ELSE                                                              
                 MOVE 1       TO WS-CNT                                         
                 PERFORM 4150-CHECK-FAMILY-ELIG THRU 4150-EXIT                  
                    UNTIL WS-NRIC(WS-CNT) = SPACES                              
                    OR WS-CNT > 4                                               
                 IF WS-EPA-ELIG = 'Y'                                           
                    MOVE 'F' TO WS-ELDERLY                                      
                 END-IF                                                         
              END-IF.                                                           
      *    END-IF.                                                              
                                                                                
           PERFORM 6000-READ-BP13K730        THRU 6000-EXIT.                    
           IF WS-ELDERLY = 'S'                                                  
              MOVE 1       TO WS-CNT                                            
              IF F730-NUM-ALLO-CAT = 'BTO'                                      
                 PERFORM 7000-WRITE-BP13LCZA THRU 7000-EXIT                     
                      UNTIL WS-NRIC(WS-CNT) = SPACES                            
                         OR WS-CNT > 4                                          
              ELSE                                                              
                 IF F730-NUM-ALLO-CAT = 'SBF'                                   
                    PERFORM 7300-WRITE-BP13LCZD THRU 7300-EXIT                  
                         UNTIL WS-NRIC(WS-CNT) = SPACES                         
                            OR WS-CNT > 4                                       
                 ELSE                                                           
                    IF F730-NUM-ALLO-CAT = 'ROF'                                
                       PERFORM 7600-WRITE-BP13LCZG THRU 7600-EXIT               
                            UNTIL WS-NRIC(WS-CNT) = SPACES                      
                               OR WS-CNT > 4                                    
                    ELSE                                                        
                       IF F730-NUM-ALLO-CAT = 'SER'                             
                          PERFORM 7000-WRITE-BP13LCZA THRU 7000-EXIT            
                          UNTIL WS-NRIC(WS-CNT) = SPACES                        
                          OR WS-CNT > 4                                         
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
               IF WS-ELDERLY = 'F'                                              
                  MOVE 1 TO WS-CNT                                              
                  IF F730-NUM-ALLO-CAT = 'BTO'                                  
                     PERFORM 7100-WRITE-BP13LCZB THRU 7100-EXIT                 
                         UNTIL WS-NRIC(WS-CNT) = SPACES                         
                            OR WS-CNT > 4                                       
                  ELSE                                                          
                     IF F730-NUM-ALLO-CAT = 'SBF'                               
                        PERFORM 7400-WRITE-BP13LCZE THRU 7400-EXIT              
                            UNTIL WS-NRIC(WS-CNT) = SPACES                      
                               OR WS-CNT > 4                                    
                     ELSE                                                       
                        IF F730-NUM-ALLO-CAT = 'ROF'                            
                           PERFORM 7700-WRITE-BP13LCZH THRU 7700-EXIT           
                               UNTIL WS-NRIC(WS-CNT) = SPACES                   
                                  OR WS-CNT > 4                                 
                        ELSE                                                    
                           IF F730-NUM-ALLO-CAT = 'SER'                         
                             PERFORM 7100-WRITE-BP13LCZB THRU 7100-EXIT         
                             UNTIL WS-NRIC(WS-CNT) = SPACES                     
                             OR WS-CNT > 4                                      
                           END-IF                                               
                        END-IF                                                  
                     END-IF                                                     
                  END-IF                                                        
               ELSE                                                             
                    MOVE 1       TO WS-CNT                                      
                    IF F730-NUM-ALLO-CAT = 'BTO'                                
                       PERFORM 7200-WRITE-BP13LCZC THRU 7200-EXIT               
                         UNTIL WS-NRIC(WS-CNT) = SPACES                         
                            OR WS-CNT > 4                                       
                    ELSE                                                        
                       IF F730-NUM-ALLO-CAT = 'SBF'                             
                          PERFORM 7500-WRITE-BP13LCZF THRU 7500-EXIT            
                            UNTIL WS-NRIC(WS-CNT) = SPACES                      
                               OR WS-CNT > 4                                    
                       ELSE                                                     
                          IF F730-NUM-ALLO-CAT = 'ROF'                          
                             PERFORM 7800-WRITE-BP13LCZI THRU 7800-EXIT         
                               UNTIL WS-NRIC(WS-CNT) = SPACES                   
                                  OR WS-CNT > 4                                 
                          ELSE                                                  
                             IF F730-NUM-ALLO-CAT = 'SER'                       
                                PERFORM 7200-WRITE-BP13LCZC THRU                
                                                            7200-EXIT           
                                UNTIL WS-NRIC(WS-CNT) = SPACES                  
                                   OR WS-CNT > 4                                
                             END-IF                                             
                          END-IF                                                
                       END-IF                                                   
                    END-IF                                                      
               END-IF                                                           
            END-IF.                                                             
                                                                                
           PERFORM 2000-READ-BP13F730        THRU 2000-EXIT.                    
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ********************                                                      
       3100-GET-NRIC-INFO.                                                      
      ********************                                                      
                                                                                
                                                                                
           MOVE F730-NUM-REGN                TO WS-NUM-REGN.                    
           MOVE F730-NUM-NRIC1               TO WS-NUM-NRIC                     
                                                WS-NRIC(WS-CNT).                
                                                                                
           ADD 1 TO WS-SERS-CNT.                                                
                                                                                
           PERFORM 4000-PROCESS-NRIC       THRU 4000-EXIT.                      
           IF F730-CDE-ELIG-SCH = 'FS '                                         
              PERFORM 5000-READ-OCCUP-FS   THRU 5000-EXIT                       
           END-IF.                                                              
                                                                                
           IF F730-NUM-NRIC2(1:1) NOT = '#' AND SPACES                          
              ADD 1 TO WS-SERS-CNT                                              
              MOVE 2                         TO WS-CNT                          
              MOVE F730-NUM-NRIC2            TO WS-NUM-NRIC                     
                                                WS-NRIC(WS-CNT)                 
              PERFORM 4000-PROCESS-NRIC    THRU 4000-EXIT                       
           END-IF                                                               
                                                                                
           IF F730-NUM-NRIC3(1:1) NOT = '#' AND SPACES                          
              ADD 1 TO WS-SERS-CNT                                              
              MOVE 3                         TO WS-CNT                          
              MOVE F730-NUM-NRIC3            TO WS-NUM-NRIC                     
                                                WS-NRIC(WS-CNT)                 
              PERFORM 4000-PROCESS-NRIC    THRU 4000-EXIT                       
           END-IF                                                               
                                                                                
           IF F730-NUM-NRIC4(1:1) NOT = '#' AND SPACES                          
              ADD 1 TO WS-SERS-CNT                                              
              MOVE 4                         TO WS-CNT                          
              MOVE F730-NUM-NRIC4            TO WS-NUM-NRIC                     
                                                WS-NRIC(WS-CNT)                 
              PERFORM 4000-PROCESS-NRIC    THRU 4000-EXIT                       
           END-IF.                                                              
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       4000-PROCESS-NRIC.                                                       
      **********************                                                    
                                                                                
           PERFORM 4050-READ-BP13K825   THRU 4050-EXIT.                         
                                                                                
           MOVE K825-NUM-MARITAL-STATUS TO WS-NRIC-MS(WS-CNT).                  
           MOVE K825-NUM-RELATIONSHIP   TO WS-NRIC-RL(WS-CNT).                  
           MOVE K825-AMT-INCOME         TO WS-NRIC-INCOME(WS-CNT).              
                                                                                
           ADD WS-NRIC-INCOME(WS-CNT)   TO WS-HH-INCOME.                        
                                                                                
           PERFORM 4400-COMPUTE-AGE     THRU 4400-EXIT.                         
                                                                                
           MOVE WS-AGE-CY(3:2)          TO WS-NRIC-AGE(WS-CNT).                 
                                                                                
           IF K825-NUM-MARITAL-STATUS = '2'                                     
              PERFORM 4200-GET-SPOUSE-DTLS  THRU 4200-EXIT                      
           END-IF                                                               
                                                                                
           IF WS-NRIC-MS(WS-CNT) NOT = '1'                                      
              PERFORM 4500-READ-OCCUPIERS   THRU 4500-EXIT                      
           END-IF.                                                              
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ********************                                                      
       4050-READ-BP13K825.                                                      
      ********************                                                      
                                                                                
           MOVE SPACES                               TO BP13K825-REC.           
           INITIALIZE                                   BP13K825-REC.           
                                                                                
           MOVE WS-NUM-REGN                          TO K825-NUM-REGN.          
           MOVE WS-NUM-NRIC                          TO K825-NUM-NRIC.          
                                                                                
           READ BP13K825.                                                       
                                                                                
           EVALUATE WS-K825-STATUS                                              
              WHEN  00                                                          
                    MOVE 'Y'              TO WS-K825-FND                        
              WHEN  23                                                          
                    MOVE 'N'              TO WS-STS-ELIG                        
                    MOVE 'N'              TO WS-EPA-ELIG                        
                    MOVE 'N'              TO WS-K825-FND                        
                    DISPLAY 'BP13K825 REC NOT FND: ' K825-KEY-FLD               
              WHEN  OTHER                                                       
                    DISPLAY 'NEXT BP13K825 ERROR ' WS-K825-STATUS               
                    MOVE WS-K825-STATUS TO RETURN-CODE                          
                    PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       4050-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       4100-CHECK-ELIG.                                                         
      **********************                                                    
                                                                                
           EVALUATE TRUE                                                        
                                                                                
              WHEN WS-NRIC-MS(WS-CNT) = '1'                                     
                   IF F730-CDE-ELIG-SCH NOT = 'OR'                              
                      IF WS-NRIC-AGE(WS-CNT) < 55                               
                         MOVE 'N'       TO WS-STS-ELIG                          
                      END-IF                                                    
                   END-IF                                                       
                                                                                
              WHEN WS-NRIC-MS(WS-CNT) = '2'                                     
                   IF WS-NRIC-AGE(WS-CNT)        <  55 OR                       
                      WS-NRIC-SP-CTZ(WS-CNT) = '10' OR                          
                      WS-NRIC-CHILD(WS-CNT)      > 0                            
                      MOVE 'N'       TO WS-STS-ELIG                             
                   ELSE                                                         
                      CONTINUE                                                  
                   END-IF                                                       
                                                                                
      * WIDOWED                                                                 
              WHEN WS-NRIC-MS(WS-CNT) = '3'                                     
                   IF WS-NRIC-AGE(WS-CNT)   < 55 OR                             
                      WS-NRIC-CHILD(WS-CNT) > 0                                 
                      MOVE 'N'       TO WS-STS-ELIG                             
                   ELSE                                                         
                      CONTINUE                                                  
                   END-IF                                                       
                                                                                
      * DIVORCED                                                                
              WHEN WS-NRIC-MS(WS-CNT) = '4'                                     
                   IF WS-NRIC-AGE(WS-CNT)   < 55 OR                             
                      WS-NRIC-CHILD(WS-CNT) > 0                                 
                      MOVE 'N'       TO WS-STS-ELIG                             
                   ELSE                                                         
                      CONTINUE                                                  
                   END-IF                                                       
      * SEPARATED                                                               
              WHEN WS-NRIC-MS(WS-CNT) = '5'                                     
                   IF WS-NRIC-AGE(WS-CNT)   < 55 OR                             
                      WS-NRIC-CHILD(WS-CNT) > 0                                 
                      MOVE 'N'       TO WS-STS-ELIG                             
                   ELSE                                                         
                      CONTINUE                                                  
                   END-IF                                                       
                                                                                
           END-EVALUATE.                                                        
                                                                                
           IF F730-NUM-ALLO-CAT = 'SER'                                         
              CONTINUE                                                          
           ELSE                                                                 
              IF F730-CDE-ALLOC-SCH NOT = 'FTS' AND 'STS'                       
                 MOVE 'N'   TO WS-STS-ELIG                                      
              END-IF                                                            
           END-IF.                                                              
                                                                                
           ADD 1   TO WS-CNT.                                                   
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       4120-CHECK-NC-SPOUSE-ELIG.                                               
      **********************                                                    
                                                                                
           IF WS-NRIC-MS(WS-CNT) = '2'                                          
              IF WS-NRIC-AGE(WS-CNT)  < 55 OR                                   
                 WS-NRIC-SP-AGE(WS-CNT) < 55                                    
                 MOVE 'N' TO WS-STS-ELIG                                        
              END-IF                                                            
           END-IF.                                                              
                                                                                
           ADD 1   TO WS-CNT.                                                   
                                                                                
       4120-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       4150-CHECK-FAMILY-ELIG.                                                  
      **********************                                                    
                                                                                
           IF WS-NRIC-MS(WS-CNT) = '2'                                          
              IF WS-NRIC-AGE(WS-CNT)  < 55 OR                                   
                 WS-NRIC-SP-AGE(WS-CNT) < 55                                    
                 MOVE 'N' TO WS-EPA-ELIG                                        
              END-IF                                                            
           ELSE                                                                 
              IF F730-CDE-ELIG-SCH = 'FS '                                      
                 IF (WS-NRIC-AGE(WS-CNT) < 55) OR                               
                    ((WS-NRIC-SP-AGE(WS-CNT) NOT = SPACES AND LOW-VALUES        
                                                   AND ZEROES) AND              
                     (WS-NRIC-SP-AGE(WS-CNT) < 55))                             
                    MOVE 'N'   TO WS-EPA-ELIG                                   
                 END-IF                                                         
              ELSE                                                              
                 IF WS-NRIC-AGE(WS-CNT)  < 55                                   
                    MOVE 'N' TO WS-EPA-ELIG                                     
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           ADD 1   TO WS-CNT.                                                   
                                                                                
       4150-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************                                                  
       4200-GET-SPOUSE-DTLS.                                                    
      ************************                                                  
                                                                                
           MOVE K825-NUM-NRIC-SPOUSE    TO WS-NUM-NRIC                          
                                           WS-NRIC-SP(WS-CNT).                  
                                                                                
           PERFORM 4050-READ-BP13K825   THRU 4050-EXIT.                         
                                                                                
           IF WS-K825-FND = 'Y'                                                 
              MOVE K825-NUM-CITIZENSHIP   TO WS-NRIC-SP-CTZ(WS-CNT)             
              MOVE K825-NUM-RELATIONSHIP  TO WS-NRIC-SP-RL(WS-CNT)              
              MOVE K825-NUM-MARITAL-STATUS TO WS-NRIC-SP-MS(WS-CNT)             
              MOVE K825-AMT-INCOME        TO WS-NRIC-SP-INCOME(WS-CNT)          
              PERFORM 4400-COMPUTE-AGE  THRU 4400-EXIT                          
              MOVE WS-AGE-CY(3:2)         TO WS-NRIC-SP-AGE(WS-CNT)             
           ELSE                                                                 
              DISPLAY 'K825 SPOUSE NOT FND: ' K825-KEY-FLD                      
           END-IF.                                                              
                                                                                
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       4400-COMPUTE-AGE.                                                        
      **********************                                                    
                                                                                
           IF F730-DTE-REQUEST NOT NUMERIC                                      
              MOVE ZEROES                         TO WS-DTE-REQUEST             
           ELSE                                                                 
              MOVE F730-DTE-REQUEST               TO WS-DTE-REQUEST             
           END-IF.                                                              
                                                                                
           IF F730-NUM-ALLO-CAT = 'SER'                                         
              IF WS-SERS-DTE-ANNOUNCE NOT NUMERIC                               
                 MOVE ZEROES                      TO WS-DTE-REQUEST             
              ELSE                                                              
                 MOVE WS-SERS-DTE-ANNOUNCE        TO WS-DTE-REQUEST             
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K825-DTE-BIRTH NOT NUMERIC                                        
              MOVE ZEROES                         TO WS-NUM-BIRTH               
           ELSE                                                                 
              MOVE K825-DTE-BIRTH                 TO WS-NUM-BIRTH               
           END-IF.                                                              
                                                                                
           IF WS-DTE-REQUEST > WS-NUM-BIRTH                                     
              COMPUTE WS-NUM-AGE = WS-DTE-REQUEST - WS-NUM-BIRTH                
           ELSE                                                                 
              COMPUTE WS-NUM-AGE = 0                                            
           END-IF.                                                              
                                                                                
       4400-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *===============================================================*         
       4500-READ-OCCUPIERS.                                                     
      *===============================================================*         
                                                                                
           INITIALIZE WS-CNT-CHILD                                              
                      WS-NRIC-CHILD(WS-CNT).                                    
                                                                                
           PERFORM 4600-START-BP13K825            THRU 4600-EXIT.               
           IF WS-K825-FND = 'Y'                                                 
              PERFORM 4800-COMPUTE-CHILD THRU 4800-EXIT                         
                UNTIL WS-K825-EOF = 'Y' OR                                      
                      K825-NUM-REGN NOT = F730-NUM-REGN                         
           END-IF.                                                              
                                                                                
           MOVE WS-CNT-CHILD              TO WS-NRIC-CHILD(WS-CNT).             
                                                                                
       4500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4600-START-BP13K825.                                                     
      *===============================================================*         
                                                                                
           MOVE SPACES                            TO BP13K825-REC               
           INITIALIZE                                BP13K825-REC.              
           MOVE 'N'                               TO WS-K825-EOF                
                                                     WS-K825-FND.               
                                                                                
           MOVE F730-NUM-REGN                     TO K825-NUM-REGN.             
                                                                                
           START BP13K825 KEY >= K825-KEY-FLD.                                  
                                                                                
           IF WS-K825-STATUS = 00 OR 02                                         
              MOVE 'Y'                            TO WS-K825-FND                
           ELSE                                                                 
              IF WS-K825-STATUS = 23 OR 10                                      
                 MOVE 'N'                         TO WS-K825-FND                
              ELSE                                                              
                 DISPLAY 'BP13K825 - ERROR STARTING : ' WS-K825-STATUS          
                 GO TO 9000-CLOSE-FILES                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       4600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4700-READNEXT-BP13K825.                                                  
      *===============================================================*         
                                                                                
           READ BP13K825 NEXT RECORD                                            
             AT END                                                             
                MOVE 'Y'    TO WS-K825-EOF                                      
                GO          TO 4700-EXIT                                        
           END-READ.                                                            
                                                                                
       4700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       4800-COMPUTE-CHILD.                                                      
      *===============================================================*         
                                                                                
           IF K825-NUM-REGN = F730-NUM-REGN                                     
              IF K825-NUM-RELATIONSHIP = 41                                     
                 ADD 1                        TO WS-CNT-CHILD                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
           PERFORM 4700-READNEXT-BP13K825   THRU 4700-EXIT.                     
                                                                                
       4800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       5000-READ-OCCUP-FS.                                                      
      *===============================================================*         
                                                                                
           PERFORM 4600-START-BP13K825            THRU 4600-EXIT.               
           IF WS-K825-FND = 'Y'                                                 
              PERFORM 5100-GET-FS-DTLS   THRU 5100-EXIT                         
                UNTIL WS-K825-EOF = 'Y'                                         
                   OR K825-NUM-REGN NOT = F730-NUM-REGN                         
           END-IF.                                                              
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *===============================================================*         
       5100-GET-FS-DTLS.                                                        
      *===============================================================*         
                                                                                
           IF K825-NUM-REGN = F730-NUM-REGN                                     
              IF (K825-NUM-RELATIONSHIP = '09') AND                             
                 (K825-NUM-NRIC NOT = F730-NUM-NRIC1 AND                        
                                      F730-NUM-NRIC2 AND                        
                                      F730-NUM-NRIC3 AND                        
                                      F730-NUM-NRIC4)                           
                 MOVE K825-NUM-NRIC         TO WS-NRIC-SP(WS-CNT)               
                 MOVE K825-NUM-CITIZENSHIP  TO WS-NRIC-SP-CTZ(WS-CNT)           
                 MOVE K825-NUM-RELATIONSHIP TO WS-NRIC-SP-RL(WS-CNT)            
                 MOVE K825-NUM-MARITAL-STATUS                                   
                                            TO WS-NRIC-SP-MS(WS-CNT)            
                 MOVE K825-AMT-INCOME       TO WS-NRIC-SP-INCOME(WS-CNT)        
                 PERFORM 4400-COMPUTE-AGE   THRU 4400-EXIT                      
                 MOVE WS-AGE-CY(3:2)        TO WS-NRIC-SP-AGE(WS-CNT)           
              END-IF                                                            
           ELSE                                                                 
              MOVE 'Y'                      TO WS-K825-EOF                      
           END-IF.                                                              
                                                                                
           PERFORM 4700-READNEXT-BP13K825   THRU 4700-EXIT.                     
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       6000-READ-BP13K730.                                                      
      *--------------------------------------------------------*                
                                                                                
           MOVE SPACES                TO K730-NUM-REGN.                         
           MOVE F730-NUM-REGN         TO K730-NUM-REGN.                         
                                                                                
           READ BP13K730.                                                       
                                                                                
           EVALUATE WS-K730-STATUS                                              
              WHEN 00                                                           
                 PERFORM 6500-REWRITE-BP13K730  THRU 6500-EXIT                  
                 PERFORM 6600-WRITE-BP13F740    THRU 6600-EXIT                  
                 ADD 1 TO K730-FND-CNT                                          
             WHEN 23                                                            
                 ADD 1 TO K730-NFND-CNT                                         
                 DISPLAY 'RECORD NOT FOUND IN BP13K730: ' K730-NUM-REGN         
             WHEN OTHER                                                         
                 DISPLAY 'ERROR WITH READ OF BP13K730. STATUS IS '              
                      WS-K730-STATUS                                            
                 MOVE WS-K730-STATUS               TO RETURN-CODE               
                 PERFORM 9000-CLOSE-FILES         THRU 9000-EXIT                
             END-EVALUATE.                                                      
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       6500-REWRITE-BP13K730.                                                   
      *--------------------------------------------------------*                
                                                                                
           MOVE WS-ELDERLY TO K730-NUM-ELDERLY.                                 
                                                                                
           IF F730-NUM-ALLO-CAT = 'SER'                                         
              MOVE 'N' TO K730-NUM-PPO                                          
                          K730-NUM-NTIMER                                       
           ELSE                                                                 
              IF (K730-NUM-ELDERLY = 'S') AND                                   
                 (K730-CDE-HOUSEHOLD = 'G') AND                                 
                 (K730-NUM-FT2T NOT = 'Y')                                      
                 IF K730-CDE-ALLOC-SCH = 'FTS'                                  
                    MOVE 'STS'        TO  K730-CDE-ALLOC-SCH                    
                 END-IF                                                         
                 IF K730-CDE-ELIG-SCH = 'SSC'                                   
                    MOVE 'SSE'        TO K730-CDE-ELIG-SCH                      
                 ELSE                                                           
                    IF K730-CDE-ELIG-SCH = 'JSS'                                
                       MOVE 'JSE'     TO K730-CDE-ELIG-SCH                      
                    ELSE                                                        
                       IF K730-CDE-ELIG-SCH = 'NCS'                             
                          MOVE 'NSE'  TO K730-CDE-ELIG-SCH                      
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           REWRITE BP13K730-REC.                                                
                                                                                
           EVALUATE WS-K730-STATUS                                              
              WHEN 00                                                           
                 ADD 1 TO WS-K730-UPD                                           
              WHEN OTHER                                                        
                 DISPLAY 'ERROR WITH UPDATING OF BP13K730. STATUS IS '          
                     WS-K730-STATUS                                             
                 MOVE WS-K730-STATUS              TO RETURN-CODE                
                 PERFORM 9000-CLOSE-FILES         THRU 9000-EXIT                
           END-EVALUATE.                                                        
                                                                                
       6500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       6600-WRITE-BP13F740.                                                     
      **********************                                                    
                                                                                
           MOVE SPACES TO   BP13F740-REC.                                       
           INITIALIZE       BP13F740-REC.                                       
           WRITE BP13F740-REC    FROM BP13K730-REC.                             
           ADD 1 TO WS-F730-WRITE.                                              
                                                                                
       6600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       7000-WRITE-BP13LCZA.                                                     
      **********************                                                    
      *    SINGLE-ELIGIBLE - BTO OR SER                                         
                                                                                
           INITIALIZE BP13LCZA-REC                                              
                      LZ2G-DETAIL01.                                            
                                                                                
           IF WS-LCZA-HDR = 'N'                                                 
              MOVE 'Y'                TO WS-LCZA-HDR                            
              PERFORM 1100-PRINT-HDR-SBTO THRU 1100-EXIT                        
           ELSE                                                                 
              IF WS-LINE-CNT-A > 59                                             
                 MOVE ZEROES          TO WS-LINE-CNT-A                          
                 PERFORM 1100-PRINT-HDR-SBTO THRU 1100-EXIT                     
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-CNT = 1                                                        
              ADD 1                        TO   WS-SN-LCZA                      
              MOVE WS-SN-LCZA              TO   LZ2G-SN                         
              MOVE K730-NUM-REGN           TO   LZ2G-REGN                       
           END-IF.                                                              
                                                                                
           MOVE WS-NRIC(WS-CNT)            TO   LZ2G-NRIC                       
           MOVE K730-NUM-ALLO-CAT          TO   LZ2G-SMODE                      
           MOVE WS-NRIC-AGE(WS-CNT)        TO   LZ2G-NUM-AGE                    
           MOVE K730-CDE-NT1               TO   LZ2G-NUM-NEW-TOWN               
           MOVE K730-CDE-FLAT-TYPE         TO   LZ2G-NUM-FLAT-TYPE              
           MOVE WS-NRIC-RL(WS-CNT)         TO   LZ2G-NUM-RELATION               
           MOVE WS-NRIC-CHILD(WS-CNT)      TO   LZ2G-CNT-CHILD                  
           MOVE K730-CDE-HOUSEHOLD         TO   LZ2G-NUM-HOUSEHOLD              
           MOVE K730-CDE-BALLOT-HOUSEHOLD  TO   LZ2G-NUM-BALLOT-HH              
           MOVE K730-CDE-ELIG-SCH          TO   LZ2G-NUM-ELIG-SCH               
           MOVE K730-CDE-ALLOC-SCH         TO   LZ2G-NUM-ALLO-SCH               
           MOVE K730-NUM-PPO               TO   LZ2G-NUM-PPO                    
                                                                                
           EVALUATE TRUE                                                        
           WHEN WS-NRIC-MS(WS-CNT) = '1'                                        
                MOVE 'S'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '2'                                        
                MOVE 'M'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '3'                                        
                MOVE 'W'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '4'                                        
                MOVE 'D'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '5'                                        
                MOVE 'P'                   TO   LZ2G-MARITAL-STATUS             
           END-EVALUATE.                                                        
                                                                                
           WRITE BP13LCZA-REC              FROM LZ2G-DETAIL01.                  
           ADD 1                           TO WS-LCZA-WRITE                     
                                              WS-CNT                            
                                              WS-LINE-CNT-A.                    
           MOVE SPACES                     TO BP13LCZA-REC.                     
           INITIALIZE                         BP13LCZA-REC.                     
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       7100-WRITE-BP13LCZB.                                                     
      **********************                                                    
      *    FAMILY-ELIGIBLE - BTO OR SER                                         
                                                                                
           INITIALIZE BP13LCZB-REC                                              
                      LZ2G-DETAIL01.                                            
                                                                                
           IF WS-LCZB-HDR = 'N'                                                 
              MOVE 'Y'                TO WS-LCZB-HDR                            
              PERFORM 1200-PRINT-HDR-FBTO THRU 1200-EXIT                        
           ELSE                                                                 
              IF WS-LINE-CNT-B > 59                                             
                 MOVE ZEROES          TO WS-LINE-CNT-B                          
                 PERFORM 1200-PRINT-HDR-FBTO THRU 1200-EXIT                     
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-CNT = 1                                                        
              ADD 1   TO WS-SN-LCZB                                             
              MOVE WS-SN-LCZB                 TO   LZ2G-SN                      
              MOVE K730-NUM-REGN              TO   LZ2G-REGN                    
           END-IF                                                               
                                                                                
           MOVE WS-NRIC(WS-CNT)            TO   LZ2G-NRIC                       
           MOVE K730-NUM-ALLO-CAT          TO   LZ2G-SMODE                      
           MOVE WS-NRIC-AGE(WS-CNT)        TO   LZ2G-NUM-AGE                    
           MOVE K730-CDE-NT1               TO   LZ2G-NUM-NEW-TOWN               
           MOVE K730-CDE-FLAT-TYPE         TO   LZ2G-NUM-FLAT-TYPE              
           MOVE WS-NRIC-RL(WS-CNT)         TO   LZ2G-NUM-RELATION               
           MOVE WS-NRIC-CHILD(WS-CNT)      TO   LZ2G-CNT-CHILD                  
           MOVE K730-CDE-HOUSEHOLD         TO   LZ2G-NUM-HOUSEHOLD              
           MOVE K730-CDE-BALLOT-HOUSEHOLD  TO   LZ2G-NUM-BALLOT-HH              
           MOVE K730-CDE-ELIG-SCH          TO   LZ2G-NUM-ELIG-SCH               
           MOVE K730-CDE-ALLOC-SCH         TO   LZ2G-NUM-ALLO-SCH               
           MOVE K730-NUM-PPO               TO   LZ2G-NUM-PPO                    
                                                                                
           EVALUATE TRUE                                                        
           WHEN WS-NRIC-MS(WS-CNT) = '1'                                        
                MOVE 'S'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '2'                                        
                MOVE 'M'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '3'                                        
                MOVE 'W'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '4'                                        
                MOVE 'D'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '5'                                        
                MOVE 'P'                   TO   LZ2G-MARITAL-STATUS             
           END-EVALUATE.                                                        
                                                                                
           WRITE BP13LCZB-REC              FROM LZ2G-DETAIL01.                  
           ADD 1                           TO WS-LCZB-WRITE                     
                                              WS-LINE-CNT-B.                    
           MOVE SPACES                     TO BP13LCZB-REC.                     
           INITIALIZE                         BP13LCZB-REC.                     
                                                                                
           PERFORM 7150-WRITE-BP13LCZB-SPOUSE THRU 7150-EXIT.                   
                                                                                
           ADD 1                           TO WS-CNT.                           
                                                                                
       7100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       7150-WRITE-BP13LCZB-SPOUSE.                                              
      **********************                                                    
      *    FAMILY-ELIGIBLE - BTO OR SER                                         
                                                                                
           INITIALIZE BP13LCZB-REC                                              
                      LZ2G-DETAIL01.                                            
                                                                                
           IF (WS-NRIC-SP(WS-CNT) NOT = SPACES AND LOW-VALUES) AND              
              (WS-NRIC-SP-RL(WS-CNT) = '20' OR '09')                            
              CONTINUE                                                          
           ELSE                                                                 
              GO TO 7150-EXIT                                                   
           END-IF.                                                              
                                                                                
           PERFORM VARYING WS-CNT2 FROM 1 BY 1 UNTIL WS-CNT2 > 4                
                  OR WS-NRIC(WS-CNT2) = SPACES                                  
              IF (WS-NRIC-SP(WS-CNT) = WS-NRIC(WS-CNT2))                        
                 GO TO 7150-EXIT                                                
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
           ADD WS-NRIC-SP-INCOME(WS-CNT) TO WS-HH-INCOME.                       
                                                                                
           MOVE WS-NRIC-SP(WS-CNT)         TO   LZ2G-NRIC                       
           MOVE K730-NUM-ALLO-CAT          TO   LZ2G-SMODE                      
           MOVE WS-NRIC-SP-AGE(WS-CNT) TO       LZ2G-NUM-AGE                    
           MOVE K730-CDE-NT1               TO   LZ2G-NUM-NEW-TOWN               
           MOVE K730-CDE-FLAT-TYPE         TO   LZ2G-NUM-FLAT-TYPE              
           MOVE WS-NRIC-SP-RL(WS-CNT)      TO   LZ2G-NUM-RELATION               
           MOVE WS-NRIC-CHILD(WS-CNT)      TO   LZ2G-CNT-CHILD                  
           MOVE K730-CDE-HOUSEHOLD         TO   LZ2G-NUM-HOUSEHOLD              
           MOVE K730-CDE-BALLOT-HOUSEHOLD  TO   LZ2G-NUM-BALLOT-HH              
           MOVE K730-CDE-ELIG-SCH          TO   LZ2G-NUM-ELIG-SCH               
           MOVE K730-CDE-ALLOC-SCH         TO   LZ2G-NUM-ALLO-SCH               
           MOVE K730-NUM-PPO               TO   LZ2G-NUM-PPO                    
                                                                                
           EVALUATE TRUE                                                        
           WHEN WS-NRIC-SP-MS(WS-CNT) = '1'                                     
                MOVE 'S'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '2'                                     
                MOVE 'M'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '3'                                     
                MOVE 'W'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '4'                                     
                MOVE 'D'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '5'                                     
                MOVE 'P'                   TO   LZ2G-MARITAL-STATUS             
           END-EVALUATE.                                                        
                                                                                
           WRITE BP13LCZB-REC              FROM LZ2G-DETAIL01.                  
           ADD 1                           TO WS-LCZB-WRITE                     
                                              WS-LINE-CNT-B.                    
      *                                       WS-CNT.                           
           MOVE SPACES                     TO BP13LCZB-REC.                     
           INITIALIZE                         BP13LCZB-REC.                     
                                                                                
       7150-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       7200-WRITE-BP13LCZC.                                                     
      **********************                                                    
      *    EXCEPTIONAL CASES - BTO OR SER                                       
                                                                                
           INITIALIZE BP13LCZC-REC                                              
                      LZ2G-DETAIL01.                                            
                                                                                
           IF WS-LCZC-HDR = 'N'                                                 
              MOVE 'Y'                TO WS-LCZC-HDR                            
              PERFORM 1300-PRINT-HDR-EBTO THRU 1300-EXIT                        
           ELSE                                                                 
              IF WS-LINE-CNT-C > 59                                             
                 MOVE ZEROES          TO WS-LINE-CNT-C                          
                 PERFORM 1300-PRINT-HDR-EBTO THRU 1300-EXIT                     
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-CNT = 1                                                        
              ADD 1   TO WS-SN-LCZC                                             
              MOVE WS-SN-LCZC                 TO   LZ2G-SN                      
              MOVE F730-NUM-REGN              TO   LZ2G-REGN                    
           END-IF                                                               
                                                                                
           MOVE WS-NRIC(WS-CNT)            TO   LZ2G-NRIC                       
           MOVE F730-NUM-ALLO-CAT          TO   LZ2G-SMODE                      
           MOVE WS-NRIC-AGE(WS-CNT)        TO   LZ2G-NUM-AGE                    
           MOVE F730-CDE-NT1               TO   LZ2G-NUM-NEW-TOWN               
           MOVE F730-CDE-FLAT-TYPE         TO   LZ2G-NUM-FLAT-TYPE              
           MOVE WS-NRIC-RL(WS-CNT)         TO   LZ2G-NUM-RELATION               
           MOVE WS-NRIC-CHILD(WS-CNT)      TO   LZ2G-CNT-CHILD                  
           MOVE F730-CDE-HOUSEHOLD         TO   LZ2G-NUM-HOUSEHOLD              
           MOVE F730-CDE-BALLOT-HOUSEHOLD  TO   LZ2G-NUM-BALLOT-HH              
           MOVE F730-CDE-ELIG-SCH          TO   LZ2G-NUM-ELIG-SCH               
           MOVE F730-CDE-ALLOC-SCH         TO   LZ2G-NUM-ALLO-SCH               
                                                                                
           EVALUATE TRUE                                                        
           WHEN WS-NRIC-MS(WS-CNT) = '1'                                        
                MOVE 'S'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '2'                                        
                MOVE 'M'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '3'                                        
                MOVE 'W'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '4'                                        
                MOVE 'D'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '5'                                        
                MOVE 'P'                   TO   LZ2G-MARITAL-STATUS             
           END-EVALUATE.                                                        
                                                                                
           WRITE BP13LCZC-REC              FROM LZ2G-DETAIL01.                  
           ADD 1                           TO WS-LCZC-WRITE                     
                                              WS-LINE-CNT-C.                    
           MOVE SPACES                     TO BP13LCZC-REC.                     
           INITIALIZE                         BP13LCZC-REC.                     
                                                                                
           PERFORM 7250-WRITE-BP13LCZC-SPOUSE THRU 7250-EXIT.                   
                                                                                
           ADD 1                           TO WS-CNT.                           
                                                                                
       7200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       7250-WRITE-BP13LCZC-SPOUSE.                                              
      **********************                                                    
      *    EXCEPTION - BTO OR SER                                               
                                                                                
           INITIALIZE BP13LCZC-REC                                              
                      LZ2G-DETAIL01.                                            
                                                                                
           IF (WS-NRIC-SP(WS-CNT) NOT = SPACES AND LOW-VALUES) AND              
              (WS-NRIC-SP-RL(WS-CNT) = '20' OR '09')                            
              CONTINUE                                                          
           ELSE                                                                 
              GO TO 7250-EXIT                                                   
           END-IF.                                                              
                                                                                
           PERFORM VARYING WS-CNT2 FROM 1 BY 1 UNTIL WS-CNT2 > 4                
                  OR WS-NRIC(WS-CNT2) = SPACES                                  
              IF (WS-NRIC-SP(WS-CNT) = WS-NRIC(WS-CNT2))                        
                 GO TO 7250-EXIT                                                
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
           ADD WS-NRIC-SP-INCOME(WS-CNT) TO WS-HH-INCOME.                       
                                                                                
           MOVE WS-NRIC-SP(WS-CNT)         TO   LZ2G-NRIC                       
           MOVE F730-NUM-ALLO-CAT          TO   LZ2G-SMODE                      
           MOVE WS-NRIC-SP-AGE(WS-CNT) TO       LZ2G-NUM-AGE                    
           MOVE F730-CDE-NT1               TO   LZ2G-NUM-NEW-TOWN               
           MOVE F730-CDE-FLAT-TYPE         TO   LZ2G-NUM-FLAT-TYPE              
           MOVE WS-NRIC-SP-RL(WS-CNT)      TO   LZ2G-NUM-RELATION               
           MOVE WS-NRIC-CHILD(WS-CNT)      TO   LZ2G-CNT-CHILD                  
           MOVE F730-CDE-HOUSEHOLD         TO   LZ2G-NUM-HOUSEHOLD              
           MOVE F730-CDE-BALLOT-HOUSEHOLD  TO   LZ2G-NUM-BALLOT-HH              
           MOVE F730-CDE-ELIG-SCH          TO   LZ2G-NUM-ELIG-SCH               
           MOVE F730-CDE-ALLOC-SCH         TO   LZ2G-NUM-ALLO-SCH               
                                                                                
           EVALUATE TRUE                                                        
           WHEN WS-NRIC-SP-MS(WS-CNT) = '1'                                     
                MOVE 'S'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '2'                                     
                MOVE 'M'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '3'                                     
                MOVE 'W'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '4'                                     
                MOVE 'D'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '5'                                     
                MOVE 'P'                   TO   LZ2G-MARITAL-STATUS             
           END-EVALUATE.                                                        
                                                                                
           WRITE BP13LCZC-REC              FROM LZ2G-DETAIL01.                  
           ADD 1                           TO WS-LCZC-WRITE                     
                                              WS-LINE-CNT-C.                    
      *                                       WS-CNT.                           
           MOVE SPACES                     TO BP13LCZC-REC.                     
           INITIALIZE                         BP13LCZC-REC.                     
                                                                                
       7250-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       7300-WRITE-BP13LCZD.                                                     
      **********************                                                    
      *    SINGLE-ELIGIBLE - SBF                                                
                                                                                
           INITIALIZE BP13LCZD-REC                                              
                      LZ2G-DETAIL01.                                            
                                                                                
           IF WS-LCZD-HDR = 'N'                                                 
              MOVE 'Y'                TO WS-LCZD-HDR                            
              PERFORM 1400-PRINT-HDR-SSBF THRU 1400-EXIT                        
           ELSE                                                                 
              IF WS-LINE-CNT-D > 59                                             
                 MOVE ZEROES          TO WS-LINE-CNT-D                          
                 PERFORM 1400-PRINT-HDR-SSBF THRU 1400-EXIT                     
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-CNT = 1                                                        
              ADD 1                        TO   WS-SN-LCZD                      
              MOVE WS-SN-LCZD              TO   LZ2G-SN                         
              MOVE K730-NUM-REGN           TO   LZ2G-REGN                       
           END-IF.                                                              
                                                                                
           MOVE WS-NRIC(WS-CNT)            TO   LZ2G-NRIC                       
           MOVE K730-NUM-ALLO-CAT          TO   LZ2G-SMODE                      
           MOVE WS-NRIC-AGE(WS-CNT)        TO   LZ2G-NUM-AGE                    
           MOVE K730-CDE-NT1               TO   LZ2G-NUM-NEW-TOWN               
           MOVE K730-CDE-FLAT-TYPE         TO   LZ2G-NUM-FLAT-TYPE              
           MOVE WS-NRIC-RL(WS-CNT)         TO   LZ2G-NUM-RELATION               
           MOVE WS-NRIC-CHILD(WS-CNT)      TO   LZ2G-CNT-CHILD                  
           MOVE K730-CDE-HOUSEHOLD         TO   LZ2G-NUM-HOUSEHOLD              
           MOVE K730-CDE-BALLOT-HOUSEHOLD  TO   LZ2G-NUM-BALLOT-HH              
           MOVE K730-CDE-ELIG-SCH          TO   LZ2G-NUM-ELIG-SCH               
           MOVE K730-CDE-ALLOC-SCH         TO   LZ2G-NUM-ALLO-SCH               
           MOVE K730-NUM-PPO               TO   LZ2G-NUM-PPO                    
                                                                                
           EVALUATE TRUE                                                        
           WHEN WS-NRIC-MS(WS-CNT) = '1'                                        
                MOVE 'S'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '2'                                        
                MOVE 'M'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '3'                                        
                MOVE 'W'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '4'                                        
                MOVE 'D'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '5'                                        
                MOVE 'P'                   TO   LZ2G-MARITAL-STATUS             
           END-EVALUATE.                                                        
                                                                                
           WRITE BP13LCZD-REC              FROM LZ2G-DETAIL01.                  
           ADD 1                           TO WS-LCZD-WRITE                     
                                              WS-CNT                            
                                              WS-LINE-CNT-D.                    
           MOVE SPACES                     TO BP13LCZD-REC.                     
           INITIALIZE                         BP13LCZD-REC.                     
                                                                                
       7300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       7400-WRITE-BP13LCZE.                                                     
      **********************                                                    
      *    FAMILY-ELIGIBLE - SBF                                                
                                                                                
           INITIALIZE BP13LCZE-REC                                              
                      LZ2G-DETAIL01.                                            
                                                                                
           IF WS-LCZE-HDR = 'N'                                                 
              MOVE 'Y'                TO WS-LCZE-HDR                            
              PERFORM 1500-PRINT-HDR-FSBF THRU 1500-EXIT                        
           ELSE                                                                 
              IF WS-LINE-CNT-E > 59                                             
                 MOVE ZEROES           TO WS-LINE-CNT-E                         
                 PERFORM 1500-PRINT-HDR-FSBF THRU 1500-EXIT                     
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-CNT = 1                                                        
              ADD 1   TO WS-SN-LCZE                                             
              MOVE WS-SN-LCZE                 TO   LZ2G-SN                      
              MOVE K730-NUM-REGN              TO   LZ2G-REGN                    
           END-IF                                                               
                                                                                
           MOVE WS-NRIC(WS-CNT)            TO   LZ2G-NRIC                       
           MOVE K730-NUM-ALLO-CAT          TO   LZ2G-SMODE                      
           MOVE WS-NRIC-AGE(WS-CNT)        TO   LZ2G-NUM-AGE                    
           MOVE K730-CDE-NT1               TO   LZ2G-NUM-NEW-TOWN               
           MOVE K730-CDE-FLAT-TYPE         TO   LZ2G-NUM-FLAT-TYPE              
           MOVE WS-NRIC-RL(WS-CNT)         TO   LZ2G-NUM-RELATION               
           MOVE WS-NRIC-CHILD(WS-CNT)      TO   LZ2G-CNT-CHILD                  
           MOVE K730-CDE-HOUSEHOLD         TO   LZ2G-NUM-HOUSEHOLD              
           MOVE K730-CDE-BALLOT-HOUSEHOLD  TO   LZ2G-NUM-BALLOT-HH              
           MOVE K730-CDE-ELIG-SCH          TO   LZ2G-NUM-ELIG-SCH               
           MOVE K730-CDE-ALLOC-SCH         TO   LZ2G-NUM-ALLO-SCH               
           MOVE K730-NUM-PPO               TO   LZ2G-NUM-PPO                    
                                                                                
           EVALUATE TRUE                                                        
           WHEN WS-NRIC-MS(WS-CNT) = '1'                                        
                MOVE 'S'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '2'                                        
                MOVE 'M'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '3'                                        
                MOVE 'W'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '4'                                        
                MOVE 'D'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '5'                                        
                MOVE 'P'                   TO   LZ2G-MARITAL-STATUS             
           END-EVALUATE.                                                        
                                                                                
           WRITE BP13LCZE-REC              FROM LZ2G-DETAIL01.                  
           ADD 1                           TO WS-LCZE-WRITE                     
                                              WS-LINE-CNT-E.                    
           MOVE SPACES                     TO BP13LCZE-REC.                     
           INITIALIZE                         BP13LCZE-REC.                     
                                                                                
           PERFORM 7450-WRITE-BP13LCZE-SPOUSE THRU 7450-EXIT.                   
                                                                                
           ADD 1                           TO WS-CNT.                           
                                                                                
       7400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       7450-WRITE-BP13LCZE-SPOUSE.                                              
      **********************                                                    
      *    FAMILY-ELIGIBLE - SBF                                                
                                                                                
           INITIALIZE BP13LCZE-REC                                              
                      LZ2G-DETAIL01.                                            
                                                                                
           IF (WS-NRIC-SP(WS-CNT) NOT = SPACES AND LOW-VALUES) AND              
              (WS-NRIC-SP-RL(WS-CNT) = '20' OR '09')                            
              CONTINUE                                                          
           ELSE                                                                 
              GO TO 7450-EXIT                                                   
           END-IF.                                                              
                                                                                
           PERFORM VARYING WS-CNT2 FROM 1 BY 1 UNTIL WS-CNT2 > 4                
                  OR WS-NRIC(WS-CNT2) = SPACES                                  
              IF (WS-NRIC-SP(WS-CNT) = WS-NRIC(WS-CNT2))                        
                 GO TO 7450-EXIT                                                
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
           ADD WS-NRIC-SP-INCOME(WS-CNT) TO WS-HH-INCOME.                       
                                                                                
           MOVE WS-NRIC-SP(WS-CNT)         TO   LZ2G-NRIC                       
           MOVE K730-NUM-ALLO-CAT          TO   LZ2G-SMODE                      
           MOVE WS-NRIC-SP-AGE(WS-CNT) TO       LZ2G-NUM-AGE                    
           MOVE K730-CDE-NT1               TO   LZ2G-NUM-NEW-TOWN               
           MOVE K730-CDE-FLAT-TYPE         TO   LZ2G-NUM-FLAT-TYPE              
           MOVE WS-NRIC-SP-RL(WS-CNT)      TO   LZ2G-NUM-RELATION               
           MOVE WS-NRIC-CHILD(WS-CNT)      TO   LZ2G-CNT-CHILD                  
           MOVE K730-CDE-HOUSEHOLD         TO   LZ2G-NUM-HOUSEHOLD              
           MOVE K730-CDE-BALLOT-HOUSEHOLD  TO   LZ2G-NUM-BALLOT-HH              
           MOVE K730-CDE-ELIG-SCH          TO   LZ2G-NUM-ELIG-SCH               
           MOVE K730-CDE-ALLOC-SCH         TO   LZ2G-NUM-ALLO-SCH               
           MOVE K730-NUM-PPO               TO   LZ2G-NUM-PPO                    
                                                                                
           EVALUATE TRUE                                                        
           WHEN WS-NRIC-SP-MS(WS-CNT) = '1'                                     
                MOVE 'S'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '2'                                     
                MOVE 'M'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '3'                                     
                MOVE 'W'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '4'                                     
                MOVE 'D'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '5'                                     
                MOVE 'P'                   TO   LZ2G-MARITAL-STATUS             
           END-EVALUATE.                                                        
                                                                                
           WRITE BP13LCZE-REC              FROM LZ2G-DETAIL01.                  
           ADD 1                           TO WS-LCZE-WRITE                     
                                              WS-LINE-CNT-E.                    
           MOVE SPACES                     TO BP13LCZE-REC.                     
           INITIALIZE                         BP13LCZE-REC.                     
                                                                                
       7450-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       7500-WRITE-BP13LCZF.                                                     
      **********************                                                    
      *    EXCEPTIONAL CASES - SBF                                              
                                                                                
           INITIALIZE BP13LCZF-REC                                              
                      LZ2G-DETAIL01.                                            
                                                                                
           IF WS-LCZF-HDR = 'N'                                                 
              MOVE 'Y'                TO WS-LCZF-HDR                            
              PERFORM 1600-PRINT-HDR-ESBF THRU 1600-EXIT                        
           ELSE                                                                 
              IF WS-LINE-CNT-F > 59                                             
                 MOVE ZEROES          TO WS-LINE-CNT-F                          
                 PERFORM 1600-PRINT-HDR-ESBF THRU 1600-EXIT                     
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-CNT = 1                                                        
              ADD 1   TO WS-SN-LCZF                                             
              MOVE WS-SN-LCZF                 TO   LZ2G-SN                      
              MOVE F730-NUM-REGN              TO   LZ2G-REGN                    
           END-IF                                                               
                                                                                
           MOVE WS-NRIC(WS-CNT)            TO   LZ2G-NRIC                       
           MOVE F730-NUM-ALLO-CAT          TO   LZ2G-SMODE                      
           MOVE WS-NRIC-AGE(WS-CNT)        TO   LZ2G-NUM-AGE                    
           MOVE F730-CDE-NT1               TO   LZ2G-NUM-NEW-TOWN               
           MOVE F730-CDE-FLAT-TYPE         TO   LZ2G-NUM-FLAT-TYPE              
           MOVE WS-NRIC-RL(WS-CNT)         TO   LZ2G-NUM-RELATION               
           MOVE WS-NRIC-CHILD(WS-CNT)      TO   LZ2G-CNT-CHILD                  
           MOVE F730-CDE-HOUSEHOLD         TO   LZ2G-NUM-HOUSEHOLD              
           MOVE F730-CDE-BALLOT-HOUSEHOLD  TO   LZ2G-NUM-BALLOT-HH              
           MOVE F730-CDE-ELIG-SCH          TO   LZ2G-NUM-ELIG-SCH               
           MOVE F730-CDE-ALLOC-SCH         TO   LZ2G-NUM-ALLO-SCH               
                                                                                
           EVALUATE TRUE                                                        
           WHEN WS-NRIC-MS(WS-CNT) = '1'                                        
                MOVE 'S'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '2'                                        
                MOVE 'M'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '3'                                        
                MOVE 'W'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '4'                                        
                MOVE 'D'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '5'                                        
                MOVE 'P'                   TO   LZ2G-MARITAL-STATUS             
           END-EVALUATE.                                                        
                                                                                
           WRITE BP13LCZF-REC              FROM LZ2G-DETAIL01.                  
           ADD 1                           TO WS-LCZF-WRITE                     
                                              WS-LINE-CNT-F.                    
           MOVE SPACES                     TO BP13LCZF-REC.                     
           INITIALIZE                         BP13LCZF-REC.                     
                                                                                
           PERFORM 7550-WRITE-BP13LCZF-SPOUSE THRU 7550-EXIT.                   
                                                                                
           ADD 1                           TO WS-CNT.                           
                                                                                
       7500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       7550-WRITE-BP13LCZF-SPOUSE.                                              
      **********************                                                    
      *    EXCEPTION - SBF                                                      
                                                                                
           INITIALIZE BP13LCZF-REC                                              
                      LZ2G-DETAIL01.                                            
                                                                                
           IF (WS-NRIC-SP(WS-CNT) NOT = SPACES AND LOW-VALUES) AND              
              (WS-NRIC-SP-RL(WS-CNT) = '20' OR '09')                            
              CONTINUE                                                          
           ELSE                                                                 
              GO TO 7550-EXIT                                                   
           END-IF.                                                              
                                                                                
           PERFORM VARYING WS-CNT2 FROM 1 BY 1 UNTIL WS-CNT2 > 4                
                  OR WS-NRIC(WS-CNT2) = SPACES                                  
              IF (WS-NRIC-SP(WS-CNT) = WS-NRIC(WS-CNT2))                        
                 GO TO 7550-EXIT                                                
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
           ADD WS-NRIC-SP-INCOME(WS-CNT) TO WS-HH-INCOME.                       
                                                                                
           MOVE WS-NRIC-SP(WS-CNT)         TO   LZ2G-NRIC                       
           MOVE F730-NUM-ALLO-CAT          TO   LZ2G-SMODE                      
           MOVE WS-NRIC-SP-AGE(WS-CNT) TO       LZ2G-NUM-AGE                    
           MOVE F730-CDE-NT1               TO   LZ2G-NUM-NEW-TOWN               
           MOVE F730-CDE-FLAT-TYPE         TO   LZ2G-NUM-FLAT-TYPE              
           MOVE WS-NRIC-SP-RL(WS-CNT)      TO   LZ2G-NUM-RELATION               
           MOVE WS-NRIC-CHILD(WS-CNT)      TO   LZ2G-CNT-CHILD                  
           MOVE F730-CDE-HOUSEHOLD         TO   LZ2G-NUM-HOUSEHOLD              
           MOVE F730-CDE-BALLOT-HOUSEHOLD  TO   LZ2G-NUM-BALLOT-HH              
           MOVE F730-CDE-ELIG-SCH          TO   LZ2G-NUM-ELIG-SCH               
           MOVE F730-CDE-ALLOC-SCH         TO   LZ2G-NUM-ALLO-SCH               
                                                                                
           EVALUATE TRUE                                                        
           WHEN WS-NRIC-SP-MS(WS-CNT) = '1'                                     
                MOVE 'S'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '2'                                     
                MOVE 'M'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '3'                                     
                MOVE 'W'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '4'                                     
                MOVE 'D'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '5'                                     
                MOVE 'P'                   TO   LZ2G-MARITAL-STATUS             
           END-EVALUATE.                                                        
                                                                                
           WRITE BP13LCZF-REC              FROM LZ2G-DETAIL01.                  
           ADD 1                           TO WS-LCZF-WRITE                     
                                              WS-LINE-CNT-F.                    
           MOVE SPACES                     TO BP13LCZF-REC.                     
           INITIALIZE                         BP13LCZF-REC.                     
                                                                                
       7550-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       7600-WRITE-BP13LCZG.                                                     
      **********************                                                    
      *    SINGLE-ELIGIBLE - ROF                                                
                                                                                
           INITIALIZE BP13LCZG-REC                                              
                      LZ2G-DETAIL01.                                            
                                                                                
           IF WS-LCZG-HDR = 'N'                                                 
              MOVE 'Y'                TO WS-LCZG-HDR                            
              PERFORM 1700-PRINT-HDR-SROF THRU 1700-EXIT                        
           ELSE                                                                 
              IF WS-LINE-CNT-G > 59                                             
                 MOVE ZEROES          TO WS-LINE-CNT-G                          
                 PERFORM 1700-PRINT-HDR-SROF THRU 1700-EXIT                     
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-CNT = 1                                                        
              ADD 1                        TO   WS-SN-LCZG                      
              MOVE WS-SN-LCZG              TO   LZ2G-SN                         
              MOVE K730-NUM-REGN           TO   LZ2G-REGN                       
           END-IF.                                                              
                                                                                
           MOVE WS-NRIC(WS-CNT)            TO   LZ2G-NRIC                       
           MOVE K730-NUM-ALLO-CAT          TO   LZ2G-SMODE                      
           MOVE WS-NRIC-AGE(WS-CNT)        TO   LZ2G-NUM-AGE                    
           MOVE K730-CDE-NT1               TO   LZ2G-NUM-NEW-TOWN               
           MOVE K730-CDE-FLAT-TYPE         TO   LZ2G-NUM-FLAT-TYPE              
           MOVE WS-NRIC-RL(WS-CNT)         TO   LZ2G-NUM-RELATION               
           MOVE WS-NRIC-CHILD(WS-CNT)      TO   LZ2G-CNT-CHILD                  
           MOVE K730-CDE-HOUSEHOLD         TO   LZ2G-NUM-HOUSEHOLD              
           MOVE K730-CDE-BALLOT-HOUSEHOLD  TO   LZ2G-NUM-BALLOT-HH              
           MOVE K730-CDE-ELIG-SCH          TO   LZ2G-NUM-ELIG-SCH               
           MOVE K730-CDE-ALLOC-SCH         TO   LZ2G-NUM-ALLO-SCH               
           MOVE K730-NUM-PPO               TO   LZ2G-NUM-PPO                    
                                                                                
           EVALUATE TRUE                                                        
           WHEN WS-NRIC-MS(WS-CNT) = '1'                                        
                MOVE 'S'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '2'                                        
                MOVE 'M'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '3'                                        
                MOVE 'W'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '4'                                        
                MOVE 'D'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '5'                                        
                MOVE 'P'                   TO   LZ2G-MARITAL-STATUS             
           END-EVALUATE.                                                        
                                                                                
           WRITE BP13LCZG-REC              FROM LZ2G-DETAIL01.                  
           ADD 1                           TO WS-LCZG-WRITE                     
                                              WS-CNT                            
                                              WS-LINE-CNT-G.                    
           MOVE SPACES                     TO BP13LCZG-REC.                     
           INITIALIZE                         BP13LCZG-REC.                     
                                                                                
       7600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       7700-WRITE-BP13LCZH.                                                     
      **********************                                                    
      *    FAMILY-ELIGIBLE - ROF                                                
                                                                                
           INITIALIZE BP13LCZH-REC                                              
                      LZ2G-DETAIL01.                                            
                                                                                
           IF WS-LCZH-HDR = 'N'                                                 
              MOVE 'Y'                TO WS-LCZH-HDR                            
              PERFORM 1800-PRINT-HDR-FROF THRU 1800-EXIT                        
           ELSE                                                                 
              IF WS-LINE-CNT-H > 59                                             
                 MOVE ZEROES          TO WS-LINE-CNT-H                          
                 PERFORM 1800-PRINT-HDR-FROF THRU 1800-EXIT                     
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-CNT = 1                                                        
              ADD 1   TO WS-SN-LCZH                                             
              MOVE WS-SN-LCZH                 TO   LZ2G-SN                      
              MOVE K730-NUM-REGN              TO   LZ2G-REGN                    
           END-IF                                                               
                                                                                
           MOVE WS-NRIC(WS-CNT)            TO   LZ2G-NRIC                       
           MOVE K730-NUM-ALLO-CAT          TO   LZ2G-SMODE                      
           MOVE WS-NRIC-AGE(WS-CNT)        TO   LZ2G-NUM-AGE                    
           MOVE K730-CDE-NT1               TO   LZ2G-NUM-NEW-TOWN               
           MOVE K730-CDE-FLAT-TYPE         TO   LZ2G-NUM-FLAT-TYPE              
           MOVE WS-NRIC-RL(WS-CNT)         TO   LZ2G-NUM-RELATION               
           MOVE WS-NRIC-CHILD(WS-CNT)      TO   LZ2G-CNT-CHILD                  
           MOVE K730-CDE-HOUSEHOLD         TO   LZ2G-NUM-HOUSEHOLD              
           MOVE K730-CDE-BALLOT-HOUSEHOLD  TO   LZ2G-NUM-BALLOT-HH              
           MOVE K730-CDE-ELIG-SCH          TO   LZ2G-NUM-ELIG-SCH               
           MOVE K730-CDE-ALLOC-SCH         TO   LZ2G-NUM-ALLO-SCH               
           MOVE K730-NUM-PPO               TO   LZ2G-NUM-PPO                    
                                                                                
           EVALUATE TRUE                                                        
           WHEN WS-NRIC-MS(WS-CNT) = '1'                                        
                MOVE 'S'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '2'                                        
                MOVE 'M'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '3'                                        
                MOVE 'W'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '4'                                        
                MOVE 'D'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '5'                                        
                MOVE 'P'                   TO   LZ2G-MARITAL-STATUS             
           END-EVALUATE.                                                        
                                                                                
           WRITE BP13LCZH-REC              FROM LZ2G-DETAIL01.                  
           ADD 1                           TO WS-LCZH-WRITE                     
                                              WS-LINE-CNT-H.                    
           MOVE SPACES                     TO BP13LCZH-REC.                     
           INITIALIZE                         BP13LCZH-REC.                     
                                                                                
           PERFORM 7750-WRITE-BP13LCZH-SPOUSE THRU 7750-EXIT.                   
                                                                                
           ADD 1                           TO WS-CNT.                           
                                                                                
       7700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       7750-WRITE-BP13LCZH-SPOUSE.                                              
      **********************                                                    
      *    FAMILY-ELIGIBLE - ROF                                                
                                                                                
           INITIALIZE BP13LCZH-REC                                              
                      LZ2G-DETAIL01.                                            
                                                                                
           IF (WS-NRIC-SP(WS-CNT) NOT = SPACES AND LOW-VALUES) AND              
              (WS-NRIC-SP-RL(WS-CNT) = '20' OR '09')                            
              CONTINUE                                                          
           ELSE                                                                 
              GO TO 7750-EXIT                                                   
           END-IF.                                                              
                                                                                
           PERFORM VARYING WS-CNT2 FROM 1 BY 1 UNTIL WS-CNT2 > 4                
                  OR WS-NRIC(WS-CNT2) = SPACES                                  
              IF (WS-NRIC-SP(WS-CNT) = WS-NRIC(WS-CNT2))                        
                 GO TO 7750-EXIT                                                
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
           ADD WS-NRIC-SP-INCOME(WS-CNT) TO WS-HH-INCOME.                       
                                                                                
           MOVE WS-NRIC-SP(WS-CNT)         TO   LZ2G-NRIC                       
           MOVE K730-NUM-ALLO-CAT          TO   LZ2G-SMODE                      
           MOVE WS-NRIC-SP-AGE(WS-CNT) TO       LZ2G-NUM-AGE                    
           MOVE K730-CDE-NT1               TO   LZ2G-NUM-NEW-TOWN               
           MOVE K730-CDE-FLAT-TYPE         TO   LZ2G-NUM-FLAT-TYPE              
           MOVE WS-NRIC-SP-RL(WS-CNT)      TO   LZ2G-NUM-RELATION               
           MOVE WS-NRIC-CHILD(WS-CNT)      TO   LZ2G-CNT-CHILD                  
           MOVE K730-CDE-HOUSEHOLD         TO   LZ2G-NUM-HOUSEHOLD              
           MOVE K730-CDE-BALLOT-HOUSEHOLD  TO   LZ2G-NUM-BALLOT-HH              
           MOVE K730-CDE-ELIG-SCH          TO   LZ2G-NUM-ELIG-SCH               
           MOVE K730-CDE-ALLOC-SCH         TO   LZ2G-NUM-ALLO-SCH               
           MOVE K730-NUM-PPO               TO   LZ2G-NUM-PPO                    
                                                                                
           EVALUATE TRUE                                                        
           WHEN WS-NRIC-SP-MS(WS-CNT) = '1'                                     
                MOVE 'S'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '2'                                     
                MOVE 'M'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '3'                                     
                MOVE 'W'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '4'                                     
                MOVE 'D'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '5'                                     
                MOVE 'P'                   TO   LZ2G-MARITAL-STATUS             
           END-EVALUATE.                                                        
                                                                                
           WRITE BP13LCZH-REC              FROM LZ2G-DETAIL01.                  
           ADD 1                           TO WS-LCZH-WRITE                     
                                              WS-LINE-CNT-H.                    
           MOVE SPACES                     TO BP13LCZH-REC.                     
           INITIALIZE                         BP13LCZH-REC.                     
                                                                                
       7750-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       7800-WRITE-BP13LCZI.                                                     
      **********************                                                    
      *    EXCEPTIONAL CASES - ROF                                              
                                                                                
           INITIALIZE BP13LCZI-REC                                              
                      LZ2G-DETAIL01.                                            
                                                                                
           IF WS-LCZI-HDR = 'N'                                                 
              MOVE 'Y'                TO WS-LCZI-HDR                            
              PERFORM 1900-PRINT-HDR-EROF THRU 1900-EXIT                        
           ELSE                                                                 
              IF WS-LINE-CNT-I > 59                                             
                 MOVE ZEROES          TO WS-LINE-CNT-I                          
                 PERFORM 1900-PRINT-HDR-EROF THRU 1900-EXIT                     
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-CNT = 1                                                        
              ADD 1   TO WS-SN-LCZI                                             
              MOVE WS-SN-LCZI                 TO   LZ2G-SN                      
              MOVE F730-NUM-REGN              TO   LZ2G-REGN                    
           END-IF                                                               
                                                                                
           MOVE WS-NRIC(WS-CNT)            TO   LZ2G-NRIC                       
           MOVE F730-NUM-ALLO-CAT          TO   LZ2G-SMODE                      
           MOVE WS-NRIC-AGE(WS-CNT)        TO   LZ2G-NUM-AGE                    
           MOVE F730-CDE-NT1               TO   LZ2G-NUM-NEW-TOWN               
           MOVE F730-CDE-FLAT-TYPE         TO   LZ2G-NUM-FLAT-TYPE              
           MOVE WS-NRIC-RL(WS-CNT)         TO   LZ2G-NUM-RELATION               
           MOVE WS-NRIC-CHILD(WS-CNT)      TO   LZ2G-CNT-CHILD                  
           MOVE F730-CDE-HOUSEHOLD         TO   LZ2G-NUM-HOUSEHOLD              
           MOVE F730-CDE-BALLOT-HOUSEHOLD  TO   LZ2G-NUM-BALLOT-HH              
           MOVE F730-CDE-ELIG-SCH          TO   LZ2G-NUM-ELIG-SCH               
           MOVE F730-CDE-ALLOC-SCH         TO   LZ2G-NUM-ALLO-SCH               
                                                                                
           EVALUATE TRUE                                                        
           WHEN WS-NRIC-MS(WS-CNT) = '1'                                        
                MOVE 'S'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '2'                                        
                MOVE 'M'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '3'                                        
                MOVE 'W'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '4'                                        
                MOVE 'D'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-MS(WS-CNT) = '5'                                        
                MOVE 'P'                   TO   LZ2G-MARITAL-STATUS             
           END-EVALUATE.                                                        
                                                                                
           WRITE BP13LCZI-REC              FROM LZ2G-DETAIL01.                  
           ADD 1                           TO WS-LCZI-WRITE                     
                                              WS-LINE-CNT-I.                    
           MOVE SPACES                     TO BP13LCZI-REC.                     
           INITIALIZE                         BP13LCZI-REC.                     
                                                                                
           PERFORM 7850-WRITE-BP13LCZI-SPOUSE THRU 7850-EXIT.                   
                                                                                
           ADD 1                           TO WS-CNT.                           
                                                                                
       7800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      **********************                                                    
       7850-WRITE-BP13LCZI-SPOUSE.                                              
      **********************                                                    
      *    EXCEPTION - ROF                                                      
                                                                                
           INITIALIZE BP13LCZI-REC                                              
                      LZ2G-DETAIL01.                                            
                                                                                
           IF (WS-NRIC-SP(WS-CNT) NOT = SPACES AND LOW-VALUES) AND              
              (WS-NRIC-SP-RL(WS-CNT) = '20' OR '09')                            
              CONTINUE                                                          
           ELSE                                                                 
              GO TO 7850-EXIT                                                   
           END-IF.                                                              
                                                                                
           PERFORM VARYING WS-CNT2 FROM 1 BY 1 UNTIL WS-CNT2 > 4                
                  OR WS-NRIC(WS-CNT2) = SPACES                                  
              IF (WS-NRIC-SP(WS-CNT) = WS-NRIC(WS-CNT2))                        
                 GO TO 7850-EXIT                                                
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
           ADD WS-NRIC-SP-INCOME(WS-CNT) TO WS-HH-INCOME.                       
                                                                                
           MOVE WS-NRIC-SP(WS-CNT)         TO   LZ2G-NRIC                       
           MOVE F730-NUM-ALLO-CAT          TO   LZ2G-SMODE                      
           MOVE WS-NRIC-SP-AGE(WS-CNT) TO       LZ2G-NUM-AGE                    
           MOVE F730-CDE-NT1               TO   LZ2G-NUM-NEW-TOWN               
           MOVE F730-CDE-FLAT-TYPE         TO   LZ2G-NUM-FLAT-TYPE              
           MOVE WS-NRIC-SP-RL(WS-CNT)      TO   LZ2G-NUM-RELATION               
           MOVE WS-NRIC-CHILD(WS-CNT)      TO   LZ2G-CNT-CHILD                  
           MOVE F730-CDE-HOUSEHOLD         TO   LZ2G-NUM-HOUSEHOLD              
           MOVE F730-CDE-BALLOT-HOUSEHOLD  TO   LZ2G-NUM-BALLOT-HH              
           MOVE F730-CDE-ELIG-SCH          TO   LZ2G-NUM-ELIG-SCH               
           MOVE F730-CDE-ALLOC-SCH         TO   LZ2G-NUM-ALLO-SCH               
                                                                                
           EVALUATE TRUE                                                        
           WHEN WS-NRIC-SP-MS(WS-CNT) = '1'                                     
                MOVE 'S'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '2'                                     
                MOVE 'M'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '3'                                     
                MOVE 'W'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '4'                                     
                MOVE 'D'                   TO   LZ2G-MARITAL-STATUS             
           WHEN WS-NRIC-SP-MS(WS-CNT) = '5'                                     
                MOVE 'P'                   TO   LZ2G-MARITAL-STATUS             
           END-EVALUATE.                                                        
                                                                                
           WRITE BP13LCZI-REC              FROM LZ2G-DETAIL01.                  
           ADD 1                           TO WS-LCZI-WRITE                     
                                              WS-LINE-CNT-I.                    
           MOVE SPACES                     TO BP13LCZI-REC.                     
           INITIALIZE                         BP13LCZI-REC.                     
                                                                                
       7850-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *******************                                                       
       9000-CLOSE-FILES.                                                        
      *******************                                                       
                                                                                
           DISPLAY SPACES.                                                      
           DISPLAY '*================ BP13CZ2G ================*'.              
           DISPLAY '  NO OF F730 RECORDS READ     = ' WS-F730-READ.             
           DISPLAY '  NO OF K730 RECORDS FOUND    = ' K730-FND-CNT.             
           DISPLAY '  NO OF K730 RECORDS NFND     = ' K730-NFND-CNT.            
           DISPLAY '  NO OF K730 RECORDS UPDTD    = ' WS-K730-UPD.              
           DISPLAY '  NO OF LCZA RECORDS WRITTEN  = ' WS-SN-LCZA.               
           DISPLAY '  NO OF LCZB RECORDS WRITTEN  = ' WS-SN-LCZB.               
           DISPLAY '  NO OF LCZC RECORDS WRITTEN  = ' WS-SN-LCZC.               
           DISPLAY '  NO OF LCZD RECORDS WRITTEN  = ' WS-SN-LCZD.               
           DISPLAY '  NO OF LCZE RECORDS WRITTEN  = ' WS-SN-LCZE.               
           DISPLAY '  NO OF LCZF RECORDS WRITTEN  = ' WS-SN-LCZF.               
           DISPLAY '  NO OF LCZG RECORDS WRITTEN  = ' WS-SN-LCZG.               
           DISPLAY '  NO OF LCZH RECORDS WRITTEN  = ' WS-SN-LCZH.               
           DISPLAY '  NO OF LCZI RECORDS WRITTEN  = ' WS-SN-LCZI.               
           DISPLAY '  NO OF F730 RECORDS WRITTEN  = ' WS-F730-WRITE.            
           DISPLAY '*==========================================*'.              
                                                                                
           CLOSE BP13F730                                                       
                 BP13K825                                                       
                 BP17F100                                                       
                 BP13K730                                                       
                 P13LZ2GA                                                       
                 P13LZ2GB                                                       
                 P13LZ2GC                                                       
                 P13LZ2GD                                                       
                 P13LZ2GE                                                       
                 P13LZ2GF                                                       
                 P13LZ2GG                                                       
                 P13LZ2GH                                                       
                 P13LZ2GI                                                       
                 BP13F740.                                                      
                                                                                
           IF WS-K825-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'CLOSING BP13K825 FILE ERROR ' WS-K825-STATUS             
              MOVE WS-K825-STATUS          TO RETURN-CODE                       
           END-IF.                                                              
                                                                                
           IF WS-K730-STATUS NOT = ZEROES AND 97                                
              DISPLAY 'CLOSING BP13K730 FILE ERROR ' WS-K730-STATUS             
              MOVE WS-K730-STATUS          TO RETURN-CODE                       
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
        9000-EXIT.                                                              
            EXIT.                                                               
                                                                                
