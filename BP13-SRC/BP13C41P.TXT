      *-----------------------*                                         00010000
       IDENTIFICATION DIVISION.                                         00020000
      *-----------------------*                                         00030000
       PROGRAM-ID.    BP13C41P.                                         00040000
      *AUTHOR.        TOH SHIOK KUAN.                                   00050000
      *DATE-WRITTEN.  11/10/89.                                         00060000
                                                                        00070000
      * ========================================================= *     00080000
      * SYSTEM OF COMMITMENT  (BP13)                              *     00090000
      * ========================================================= *     00100000
      *    OBJECTIVE :                                            *     00110000
      *      1. TO PRINT PAYMENT SCHEDULE FOR STAMPIMG OF         *     00120000
      *         DEED OF ASSIGNMENT (BP13L41PA)                    *     00130000
      *         (FINAL PINK VOUCHER FOR TP AND SA/TP)             *     00140000
      *                                                           *     00150000
      *    I/O FILES :                                            *     00160000
      *       INPUT  :  BP13F315 - TRANSACTION FILE (SEQ)         *     00170000
      *                 BP13K413 - ACCUMSO FILE     (VSAM)        *     00180000
      *      OUTPUT  :  BP13K625 - STAMP FEE MASTER (SEQ)         *     00190000
      *                 AG07F225 - STAMPING FILE    (SEQ)         *     00200000
      *                 BP1341PA - STAMPING DOA FOR SOC FLAT      *     00210000
      *                                                           *     00220000
      *    FUNCTION :                                             *     00230000
      *      1. BATCH PROGRAMMING IN COBOL                        *     00240000
      *      2. PRINT LISTINGS OF PAYMENT SCHEDULE AND/OR         *     00250000
      *         REFUND SCHEDULE DEPENDING ON F315-CDE-TRANS,      *     00260000
      *         F315-CDE-SALES-TYPE AND K413-DTE-KEY-ISSUE        *     00270000
      *                                                           *     00280000
      * --------------------------------------------------------- *     00290000
      * CHG REF  DATE   BY   DESCRIPTIONS                         *     00300000
      * -------- ------ ---  ------------                         *     00310000
      * C910262  910326 YPH  TO ADD 'DATE OF SALES ORDER' ON      *     00320000
      *                      BP13L41PA LISTING.                   *     00330000
      * BP138339 200807 KR13 REMOVED DUPL VOUCH COPIES-IOM8 CNVRSN*     00340000
      * BP138863 210917 ZDD  TO CATER FOR SERS CASE 1557805Z.     *     00350000
      * BP139092 220314 ZDD  TO CATER FOR SERS CASE 1557906D.     *     00360000
      * BP139164 040522 KV8  INCLUDED ADDRESS AND COMMENTED STREET*     00361000
      * ========================================================= *     00370000
                                                                        00380000
      ************************                                          00390000
       ENVIRONMENT DIVISION.                                            00400000
      ************************                                          00410000
       CONFIGURATION SECTION.                                           00420000
       SOURCE-COMPUTER.   IBM-3090.                                     00430000
       OBJECT-COMPUTER.   IBM-3090.                                     00440000
                                                                        00450000
       INPUT-OUTPUT SECTION.                                            00460000
       FILE-CONTROL.                                                    00470000
                                                                        00480000
           SELECT B05K006   ASSIGN       TO B05K006                     00490000
                            ACCESS MODE  IS RANDOM                      00500000
                            ORGANIZATION IS INDEXED                     00510000
                            RECORD KEY   IS K006-HDB-REF-SF             00520000
                            FILE STATUS  IS WS-K006-STATUS.             00530000
                                                                        00540000
           SELECT BP13K413  ASSIGN       TO BP13K413                    00550000
                            ACCESS MODE  IS RANDOM                      00560000
                            ORGANIZATION IS INDEXED                     00570000
                            RECORD KEY   IS K413-KEY-FLD                00580000
                            FILE STATUS  IS WS-K413-STATUS.             00590000
                                                                        00600000
           SELECT BP13K625  ASSIGN       TO BP13K625                    00610000
                            ACCESS MODE  IS DYNAMIC                     00620000
                            ORGANIZATION IS INDEXED                     00630000
                            RECORD KEY   IS K625-KEY-FLD                00640000
                            FILE STATUS  IS WS-K625-STATUS.             00650000
                                                                        00660000
           SELECT BP13F315  ASSIGN       TO BP13F315.                   00670000
           SELECT BP13F316  ASSIGN       TO BP13F316.                   00680000
           SELECT AG07F225  ASSIGN       TO AG07F225.                   00690000
                                                                        00700000
           SELECT BP1341PA  ASSIGN       TO BP1341PA.                   00710000
                                                                        00720000
           SELECT BP1341PD  ASSIGN       TO BP1341PD.                   00730000
                                                                        00740000
           SELECT BP1341PE  ASSIGN       TO BP1341PE.                   00750000
                                                                        00760000
           SELECT BP1341PG  ASSIGN       TO BP1341PG.                   00770000
                                                                        00780000
           SELECT BP1341PH  ASSIGN       TO BP1341PH.                   00790000
                                                                        00800000
           SELECT BP1341PI  ASSIGN       TO BP1341PI.                   00810000
                                                                        00820000
           SELECT BP1341PJ  ASSIGN       TO BP1341PJ.                   00830000
                                                                        00840000
           SELECT BP1341PK  ASSIGN       TO BP1341PK.                   00850000
                                                                        00860000
      *****************                                                 00870000
       DATA DIVISION.                                                   00880000
      *****************                                                 00890000
                                                                        00900000
       FILE SECTION.                                                    00910000
      *============*                                                    00920000
      * SFMAST  FILE                                                    00930000
      *--------------                                                   00940000
       FD   B05K006.                                                    00950000
       COPY B05K006.                                                    00960000
                                                                        00970000
      * ACCUMSO FILE                                                    00980000
      *--------------                                                   00990000
       FD   BP13K413                                                    01000000
            RECORD CONTAINS 2000 CHARACTERS.                            01010000
       COPY BP13K413.                                                   01020000
                                                                        01030000
      * STAMP FEE MASTER FILE                                           01040000
      *--------------                                                   01050000
       FD   BP13K625                                                    01060000
            RECORD CONTAINS 500  CHARACTERS.                            01070000
       COPY BP13K625.                                                   01080000
                                                                        01090000
      *------------------                                               01100000
      * TRANSACTION FILE                                                01110000
      *------------------                                               01120000
       FD   BP13F315                                                    01130000
            BLOCK  CONTAINS 0    RECORDS                                01140000
            RECORD CONTAINS 500  CHARACTERS                             01150000
            LABEL  RECORDS  ARE  STANDARD                               01160000
            RECORDING MODE  IS   F.                                     01170000
       COPY BP13F315.                                                   01180000
                                                                        01190000
      *------------------                                               01200000
      * OUTPUT FILE FOR PRINTING OF SUPPLEMENTARY LIST.                 01210000
      *------------------                                               01220000
       FD   BP13F316                                                    01230000
            BLOCK  CONTAINS 0    RECORDS                                01240000
            RECORD CONTAINS 500  CHARACTERS                             01250000
            LABEL  RECORDS  ARE  STANDARD                               01260000
            RECORDING MODE  IS   F.                                     01270000
                                                                        01280000
       01   BP13F316-REC.                                               01290000
            05 FILLER            PIC X(468).                            01300000
            05 F316-VOUCHER-NO   PIC X(12).                             01310000
            05 F316-SERIAL-NO    PIC 9(04).                             01320000
            05 FILLER            PIC X(16).                             01330000
                                                                        01340000
      *------------------                                               01350000
      * VOUCHER FILE                                                    01360000
      *------------------                                               01370000
       FD   AG07F225                                                    01380000
            RECORDING MODE  IS  F                                       01390000
            RECORD CONTAINS 600 CHARACTERS.                             01400000
       COPY AG07F225.                                                   01410000
                                                                        01420000
      *---------------------------------------                          01430000
      * LISTING FOR STAMPING DOA FOR SOC FLAT                           01440000
      *---------------------------------------                          01450000
       FD   BP1341PA                                                    01460000
            RECORD CONTAINS 132 CHARACTERS                              01470000
            LABEL  RECORDS  ARE OMITTED                                 01480000
            RECORDING MODE  IS  F.                                      01490000
       01   L41PA-PRINT-REC          PIC X(132).                        01500000
                                                                        01510000
      *---------------------------------------                          01520000
      * AGREEMENT OF LEASE & DOA OF SOC FLAT                            01530000
      *---------------------------------------                          01540000
       FD   BP1341PD                                                    01550000
            RECORD CONTAINS 132 CHARACTERS                              01560000
            LABEL  RECORDS  ARE OMITTED                                 01570000
            RECORDING MODE  IS  F.                                      01580000
       01   L41PD-PRINT-REC          PIC X(132).                        01590000
                                                                        01600000
       FD   BP1341PE                                                    01610000
            RECORD CONTAINS 132 CHARACTERS                              01620000
            LABEL  RECORDS  ARE OMITTED                                 01630000
            RECORDING MODE  IS  F.                                      01640000
       01   L41PE-PRINT-REC          PIC X(132).                        01650000
                                                                        01660000
       FD   BP1341PG                                                    01670000
            RECORD CONTAINS 132 CHARACTERS                              01680000
            LABEL  RECORDS  ARE OMITTED                                 01690000
            RECORDING MODE  IS  F.                                      01700000
       01   L41PG-PRINT-REC          PIC X(132).                        01710000
                                                                        01720000
       FD   BP1341PH                                                    01730000
            RECORD CONTAINS 132 CHARACTERS                              01740000
            LABEL  RECORDS  ARE OMITTED                                 01750000
            RECORDING MODE  IS  F.                                      01760000
       01   L41PH-PRINT-REC          PIC X(132).                        01770000
                                                                        01780000
       FD   BP1341PI                                                    01790000
            RECORD CONTAINS 132 CHARACTERS                              01800000
            LABEL  RECORDS  ARE OMITTED                                 01810000
            RECORDING MODE  IS  F.                                      01820000
       01   L41PI-PRINT-REC          PIC X(132).                        01830000
                                                                        01840000
       FD   BP1341PJ                                                    01850000
            RECORD CONTAINS 132 CHARACTERS                              01860000
            LABEL  RECORDS  ARE OMITTED                                 01870000
            RECORDING MODE  IS  F.                                      01880000
       01   L41PJ-PRINT-REC          PIC X(132).                        01890000
                                                                        01900000
       FD   BP1341PK                                                    01910000
            RECORD CONTAINS 132 CHARACTERS                              01920000
            LABEL  RECORDS  ARE OMITTED                                 01930000
            RECORDING MODE  IS  F.                                      01940000
       01   L41PK-PRINT-REC          PIC X(132).                        01950000
                                                                        01960000
       WORKING-STORAGE SECTION.                                         01970000
       COPY SERSCH.                                                     01980000
                                                                        01990000
       01 WS-SERS-VARIABLES.                                            02000000
           05 WS-ALLOC-SCH          PIC X(03).                          02010000
           05 WS-SCH-FND            PIC X(01).                          02020000
                                                                        02030000
      *-----------------------------------------------------------*     02040000
      *    DEFINE HEADING LINES                                   *     02050000
      *-----------------------------------------------------------*     02060000
       01  PRT-L41P-HDG-1.                                              02070000
           05  L41P-REPORT-ID       PIC X(8)  VALUE SPACES.             02080000
           05  FILLER               PIC X(10) VALUE '      HDB3'.       02090000
           05  FILLER               PIC X(27) VALUE SPACES.             02100000
           05  FILLER               PIC X(39) VALUE                     02110000
               'S Y S T E M   O F   C O M M I T M E N T'.               02120000
           05  FILLER               PIC X(14) VALUE SPACES.             02130000
           05  FILLER               PIC X(7)  VALUE 'DATE : '.          02140000
           05  L41P-CURRENT-DATE    PIC X(10) VALUE SPACES.             02150000
           05  FILLER               PIC X(4)  VALUE SPACES.             02160000
           05  FILLER               PIC X(7)  VALUE 'PAGE : '.          02170000
           05  L41P-PAGE            PIC ZZZZ9.                          02180000
                                                                        02190000
       01  PRT-L41P-HDG-2.                                              02200000
           05  FILLER               PIC X(30) VALUE                     02210000
               'HOUSING AND DEVELOPMENT BOARD'.                         02220000
           05  FILLER               PIC X(20) VALUE SPACES.             02230000
           05  FILLER               PIC X(30) VALUE                     02240000
               'P A Y M E N T    V O U C H E R'.                        02250000
           05  FILLER               PIC X(25) VALUE SPACES.             02260000
           05  L41P-COPY-NAME       PIC X(20) VALUE SPACES.             02270000
                                                                        02280000
       01  PRT-L41P-HDG-3.                                              02290000
           05  L41P-REPORT-ID-DESC  PIC X(132).                         02300000
                                                                        02310000
       01  PRT-L41P-HDG-4.                                              02320000
           05  FILLER               PIC X(46) VALUE SPACES.             02330000
           05  FILLER               PIC X(85) VALUE ALL '-'.            02340000
                                                                        02350000
       01  PRT-L41P-HDG-5.                                              02360000
           05  FILLER               PIC X(46) VALUE                     02370000
               'SALES UNIT (AGREEMENT TEAM)'.                           02380000
           05  FILLER               PIC X(1)  VALUE '¦'.                02390000
           05  FILLER               PIC X(27) VALUE                     02400000
               ' FOR FINANCE DEPARTMENT USE'.                           02410000
           05  FILLER               PIC X(21) VALUE SPACES.             02420000
           05  FILLER               PIC X(17) VALUE                     02430000
               '¦  BATCH NO    : '.                                     02440000
           05  L41P-BATCH-NO        PIC X(14) VALUE SPACES.             02450000
           05  FILLER               PIC X(4)  VALUE SPACES.             02460000
           05  FILLER               PIC X(1)  VALUE '¦'.                02470000
                                                                        02480000
       01  PRT-L41P-HDG-6.                                              02490000
           05  FILLER               PIC X(46) VALUE SPACES.             02500000
           05  FILLER               PIC X(1)  VALUE '¦'.                02510000
           05  FILLER               PIC X(48) VALUE SPACES.             02520000
           05  FILLER               PIC X(1)  VALUE '¦'.                02530000
           05  FILLER               PIC X(34) VALUE SPACES.             02540000
           05  FILLER               PIC X(1)  VALUE '¦'.                02550000
                                                                        02560000
       01  PRT-L41P-HDG-7.                                              02570000
           05  FILLER               PIC X(46) VALUE 'SYSTEM CODE : 04'. 02580000
           05  FILLER               PIC X(14) VALUE '¦ CHECKED BY :'.   02590000
           05  FILLER               PIC X(35) VALUE SPACES.             02600000
           05  FILLER               PIC X(17) VALUE '¦  VOUCHER NO  :'. 02610000
           05  L41P-VOUCHER-NO      PIC X(14) VALUE SPACES.             02620000
           05  FILLER               PIC X(4)  VALUE SPACES.             02630000
           05  FILLER               PIC X(1)  VALUE '¦'.                02640000
                                                                        02650000
       01  PRT-L41P-HDG-8.                                              02660000
           05  FILLER               PIC X(46) VALUE                     02670000
              'GL CODE     : 0000000104250'.                            02680000
           05  FILLER               PIC X(85) VALUE ALL '-'.            02690000
                                                                        02700000
       01  PRT-L41P-HDG-9.                                              02710000
           05  FILLER               PIC X(46) VALUE                     02720000
              'DESCRIPTION : STAMP FEES'.                               02730000
                                                                        02740000
       01  PRT-L41P-HDG-10.                                             02750000
           05  FILLER               PIC X(53)   VALUE                   02760000
              'PAYABLE TO  : COMMISSIONER OF STAMP DUTIES         '.    02770000
           05  FILLER               PIC X(13)   VALUE  SPACES.          02780000
           05  FILLER               PIC X(20)   VALUE                   02790000
              'BANK   : DBS        '.                                   02800000
           05  FILLER               PIC X(11)   VALUE  SPACES.          02810000
           05  FILLER               PIC X(25)   VALUE                   02820000
              'BANK CODE   : DBSSSGSGXXX'.                              02830000
                                                                        02840000
       01  PRT-L41P-HDG-10A.                                            02850000
           05  FILLER               PIC X(24)   VALUE                   02860000
              'A/C NO      : 0010468600'.                               02870000
           05  FILLER               PIC X(42)   VALUE  SPACES.          02880000
                                                                        02890000
       01  PRT-L41P-HDG-11.                                             02900000
           05  FILLER               PIC X(11)   VALUE                   02910000
               'REMITTANCE '.                                           02920000
           05  FILLER               PIC X(55)   VALUE                   02930000
              'ADVICE  DESPATCH TO :  C/O SC(STAMPING) OF SALES UNIT'.  02940000
                                                                        02950000
      *-----------------------------------------------------------*     02960000
      *    DEFINE BP13L41PA & BP13L41PD SUB-HEADING LINES         *     02970000
      *-----------------------------------------------------------*     02980000
       01  PRT-L41P-SUBHDG-1.                                           02990000
           05  FILLER               PIC X(69) VALUE SPACES.             03000000
           05  FILLER               PIC X(19) VALUE                     03010000
               'DATE OF    MORTGAGE'.                                   03020000
           05  FILLER               PIC X(4)  VALUE SPACES.             03030000
           05  FILLER               PIC X(7)  VALUE 'DUP'.              03040000
           05  L41P-SUP-LEASE-DESC  PIC X(10) VALUE SPACES.             03050000
           05  FILLER               PIC X(2)  VALUE SPACES.             03060000
           05  FILLER               PIC X(8)  VALUE 'DUP'.              03070000
                                                                        03080000
       01  PRT-L41P-SUBHDG-2.                                           03090000
           05  FILLER               PIC X(4)  VALUE 'S/NO'.             03100000
           05  FILLER               PIC X     VALUE SPACE.              03110000
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.       03120000
           05  FILLER               PIC X(5)  VALUE SPACES.             03130000
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.          03140000
           05  FILLER               PIC X     VALUE SPACE.              03150000
           05  FILLER               PIC X(5)  VALUE 'BLOCK'.            03160000
           05  FILLER               PIC X     VALUE SPACE.              03170000
           05  FILLER               PIC X(25) VALUE                     03180000
               'FLAT ADDRESS/STREET NAME'.                              03190000
           05  FILLER               PIC X(1)  VALUE SPACE.              03200000
           05  FILLER               PIC X(8)  VALUE 'FLAT NO'.          03210000
           05  FILLER               PIC X(9)  VALUE 'SALES ORD'.        03220000
           05  FILLER               PIC X(2)  VALUE SPACES.             03230000
           05  FILLER               PIC X(9)  VALUE 'STAMP FEE'.        03240000
           05  FILLER               PIC X(3)  VALUE SPACES.             03250000
           05  FILLER               PIC X(3)  VALUE 'DOA'.              03260000
           05  FILLER               PIC X(4)  VALUE SPACES.             03270000
           05  FILLER               PIC X(9)  VALUE 'STAMP FEE'.        03280000
           05  FILLER               PIC X(3)  VALUE SPACES.             03290000
           05  FILLER               PIC X(2)  VALUE 'SA'.               03300000
           05  FILLER               PIC X(5)  VALUE SPACES.             03310000
           05  L41P-TAG-DESC        PIC X(3)  VALUE 'TAG'.              03320000
           05  FILLER               PIC X(6)  VALUE SPACES.             03330000
           05  FILLER               PIC X(5)  VALUE 'TOTAL'.            03340000
                                                                        03350000
       01  PRT-L41P-SUBHDG-3.                                           03360000
           05  FILLER               PIC X(4)  VALUE ALL '-'.            03370000
           05  FILLER               PIC X     VALUE SPACES.             03380000
           05  FILLER               PIC X(14) VALUE ALL '-'.            03390000
           05  FILLER               PIC X     VALUE SPACES.             03400000
           05  FILLER               PIC X(8)  VALUE ALL '-'.            03410000
           05  FILLER               PIC X     VALUE SPACES.             03420000
           05  FILLER               PIC X(5)  VALUE ALL '-'.            03430000
           05  FILLER               PIC X     VALUE SPACES.             03440000
           05  FILLER               PIC X(25) VALUE ALL '-'.            03450000
           05  FILLER               PIC X(1)  VALUE SPACES.             03460000
           05  FILLER               PIC X(7)  VALUE ALL '-'.            03470000
           05  FILLER               PIC X(1)  VALUE SPACES.             03480000
           05  FILLER               PIC X(9)  VALUE ALL '-'.            03490000
           05  FILLER               PIC X(2)  VALUE SPACES.             03500000
           05  FILLER               PIC X(10) VALUE ALL '-'.            03510000
           05  FILLER               PIC X(2)  VALUE SPACES.             03520000
           05  FILLER               PIC X(5)  VALUE ALL '-'.            03530000
           05  FILLER               PIC X(2)  VALUE SPACES.             03540000
           05  FILLER               PIC X(10) VALUE ALL '-'.            03550000
           05  FILLER               PIC X(2)  VALUE SPACES.             03560000
           05  FILLER               PIC X(5)  VALUE ALL '-'.            03570000
           05  FILLER               PIC X(2)  VALUE SPACES.             03580000
           05  FILLER               PIC X(14) VALUE ALL '-'.            03590000
                                                                        03600000
      *-----------------------------------------------------------*     03610000
      *    DEFINE BP13L41PA & BP13L41PD DETAIL LINES              *     03620000
      *-----------------------------------------------------------*     03630000
       01  L41P-REC-DETAIL.                                             03640000
           05  L41P-SERIAL-NO               PIC ZZZ9.                   03650000
           05  FILLER                       PIC X     VALUE SPACE.      03660000
           05  L41P-SCH-ACC                 PIC X(14) VALUE SPACES.     03670000
           05  FILLER                       PIC X     VALUE SPACE.      03680000
           05  L41P-REGN-NO                 PIC X(8)  VALUE SPACES.     03690000
           05  FILLER                       PIC X     VALUE SPACE.      03700000
           05  L41P-BLKNO                   PIC X(5)  VALUE SPACES.     03710000
           05  FILLER                       PIC X     VALUE SPACE.      03720000
           05  L41P-STREET                  PIC X(25) VALUE SPACES.     03730000
           05  FILLER                       PIC X     VALUE SPACE.      03740000
           05  L41P-FLATNO                  PIC X(7)  VALUE SPACES.     03750000
           05  FILLER                       PIC X     VALUE SPACE.      03760000
           05  L41P-SALE-DD                 PIC X(2)  VALUE SPACES.     03770000
           05  L41P-DASH1                   PIC X     VALUE SPACE.      03780000
           05  L41P-SALE-MM                 PIC X(2)  VALUE SPACES.     03790000
           05  L41P-DASH2                   PIC X     VALUE SPACE.      03800000
           05  L41P-SALE-CC                 PIC X(2)  VALUE SPACES.     03810000
           05  L41P-SALE-YY                 PIC X(2)  VALUE SPACES.     03820000
           05  FILLER                       PIC X(1)  VALUE SPACES.     03830000
           05  L41P-MORT-SF                 PIC $$$,$$9.99.             03840000
           05  FILLER                       PIC X(2)  VALUE SPACES.     03850000
           05  L41P-DUP-DOA                 PIC $9.99.                  03860000
           05  FILLER                       PIC X(2)  VALUE SPACES.     03870000
           05  L41P-SUP-LEASE-STAMP         PIC $$$,$$9.99.             03880000
           05  FILLER                       PIC X(2)  VALUE SPACES.     03890000
           05  L41P-DUP-SA                  PIC $9.99.                  03900000
           05  FILLER                       PIC X(2)  VALUE SPACES.     03910000
           05  L41P-TAG                     PIC X.                      03920000
           05  FILLER                       PIC X(2)  VALUE SPACES.     03930000
           05  L41P-DETL-AMT-TOTAL          PIC $$$$,$$9.99.            03940000
                                                                        03950000
      *-----------------------------------------------------------*     03960000
      *    DEFINE BP13L41PA & BP13L41PD TOTAL LINES               *     03970000
      *-----------------------------------------------------------*     03980000
       01  PRT-L41P-DASH-LINE.                                          03990000
           05  FILLER                       PIC X(78)   VALUE SPACES.   04000000
           05  FILLER                       PIC X(54)   VALUE ALL '='.  04010000
                                                                        04020000
       01  PRT-L41P-TOTAL-LINE.                                         04030000
           05  FILLER                       PIC X(35) VALUE SPACES.     04040000
           05  FILLER                       PIC X(13) VALUE             04050000
               'SERIAL NO : ('.                                         04060000
           05  L41P-VR-NO-LOW               PIC X(4)  VALUE '0001'.     04070000
           05  FILLER                       PIC X(4)  VALUE ' TO '.     04080000
           05  L41P-VR-NO-HIGH              PIC X(4)  VALUE '0025'.     04090000
           05  FILLER                       PIC X(4)  VALUE ')'.        04100000
           05  FILLER                       PIC X(14) VALUE 'TOTAL :'.  04110000
           05  L41P-TOTAL-MORT-SF           PIC $,$$$,$$9.99.           04120000
           05  FILLER                       PIC X(1)  VALUE SPACES.     04130000
           05  L41P-TOTAL-DUP-DOA           PIC $$9.99.                 04140000
           05  L41P-TOTAL-SUP-LEASE-SF      PIC $,$$$,$$9.99.           04150000
           05  FILLER                       PIC X(1)  VALUE SPACES.     04160000
           05  L41P-TOTAL-DUP-SA            PIC $$9.99.                 04170000
           05  FILLER                       PIC X(4)  VALUE SPACES.     04180000
           05  L41P-TOTAL-AMT               PIC $,$$$,$$9.99.           04190000
                                                                        04200000
      *-----------------------------------------------------------*     04210000
      *    DEFINE FOOTING LINES                                   *     04220000
      *-----------------------------------------------------------*     04230000
       01  PRT-L41P-FTG-1.                                              04240000
           05  FILLER              PIC X(15)   VALUE 'NET PAYABLE  : '. 04250000
           05  L41P-AMT-WORDS.                                          04260000
               10  L41P-AMT-DESC1  PIC X(60)   VALUE SPACES.            04270000
               10  L41P-AMT-DESC2  PIC X(60)   VALUE SPACES.            04280000
                                                                        04290000
       01  PRT-L41P-FTG-2.                                              04300000
           05  FILLER              PIC X(35)   VALUE SPACES.            04310000
           05  FILLER              PIC X(14)   VALUE 'CHECKED BY :'.    04320000
           05  FILLER              PIC X(15)   VALUE ALL '_'.           04330000
           05  FILLER              PIC X(10)   VALUE SPACES.            04340000
           05  FILLER              PIC X(16)   VALUE 'CERTIFIED BY :'.  04350000
           05  FILLER              PIC X(15)   VALUE ALL '_'.           04360000
                                                                        04370000
      *-----------------------------------------------------------*     04380000
      *    DEFINE BP13L41P  HEADING LINES                         *     04390000
      *-----------------------------------------------------------*     04400000
       01  MAIN-HEADER.                                                 04410000
           05  HEADER-LISTID             PIC X(8)  VALUE SPACES.        04420000
           05  FILLER                    PIC X(16) VALUE SPACES.        04430000
           05  FILLER                    PIC X(4)  VALUE 'HDB3'.        04440000
           05  FILLER                    PIC X(16) VALUE SPACES.        04450000
           05  FILLER                    PIC X(39) VALUE                04460000
               'S Y S T E M   O F   C O M M I T M E N T'.               04470000
           05  FILLER                    PIC X(16) VALUE SPACES.        04480000
           05  FILLER                    PIC X(7)  VALUE 'DATE : '.     04490000
           05  HEADER-DATE               PIC X(10).                     04500000
           05  FILLER                    PIC X(4)  VALUE SPACES.        04510000
           05  FILLER                    PIC X(7)  VALUE 'PAGE : '.     04520000
           05  HEADER-PAGE               PIC ZZZZ9.                     04530000
                                                                        04540000
      *-----------------------------------------------------------*     04550000
      *    DEFINE BP1341PK REPORT LINES                           *     04560000
      *-----------------------------------------------------------*     04570000
       01  L41PK-HEADER2.                                               04580000
           05  FILLER                    PIC X(47) VALUE SPACES.        04590000
           05  FILLER                    PIC X(35)  VALUE               04600000
               'REPORT ON CASES WITH EARMARK ERROR'.                    04610000
                                                                        04620000
       01  L41PK-HEADER3.                                               04630000
           05  FILLER               PIC X(4)  VALUE 'S/NO'.             04640000
           05  FILLER               PIC X(3)  VALUE SPACE.              04650000
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.       04660000
           05  FILLER               PIC X(9)  VALUE SPACES.             04670000
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.          04680000
           05  FILLER               PIC X(5)  VALUE SPACE.              04690000
           05  FILLER               PIC X(13) VALUE 'JR VOUCHER NO'.    04700000
           05  FILLER               PIC X(5)  VALUE SPACES.             04710000
           05  FILLER               PIC X(12) VALUE 'TOTAL AMOUNT'.     04720000
           05  FILLER               PIC X(4)  VALUE SPACES.             04730000
           05  FILLER               PIC X(17) VALUE 'ERROR DESCRIPTION'.04740000
                                                                        04750000
       01  L41PK-REC-DETAIL.                                            04760000
           05  L41PK-SERIAL-NO              PIC ZZZ9.                   04770000
           05  FILLER                       PIC X(3)  VALUE SPACE.      04780000
           05  L41PK-SCH-ACC                PIC X(14) VALUE SPACES.     04790000
           05  FILLER                       PIC X(5)  VALUE SPACE.      04800000
           05  L41PK-REGN-NO                PIC X(8)  VALUE SPACES.     04810000
           05  FILLER                       PIC X(5)  VALUE SPACE.      04820000
           05  L41PK-JR-VCHR-NO             PIC X(13) VALUE SPACES.     04830000
           05  FILLER                       PIC X(5)  VALUE SPACES.     04840000
           05  L41PK-AMT-TOTAL              PIC $$$$,$$9.99.            04850000
           05  FILLER                       PIC X(5)  VALUE SPACES.     04860000
           05  L41PK-ERROR-DESC             PIC X(30).                  04870000
                                                                        04880000
       01  L41PK-UNDERLINE                  PIC X(132) VALUE ALL '-'.   04890000
                                                                        04900000
      *-----------------------------------------------------------*     04910000
      *    DEFINE ERROR MESSAGE FORMAT                            *     04920000
      *-----------------------------------------------------------*     04930000
       01  WS-ERRMSG-HEADER.                                            04940000
           05  FILLER                       PIC X(46) VALUE             04950000
               ' *************   ERROR MESSAGE   *************'.        04960000
                                                                        04970000
       01  WS-ERROR.                                                    04980000
           05  FILLER                       PIC X(24) VALUE             04990000
               ' ERROR ENCOUNTERED WHEN '.                              05000000
           05  WS-CUR-PROC                  PIC X(21).                  05010000
                                                                        05020000
       01  WS-FILE-STATUS.                                              05030000
           05  FILLER                       PIC X(15) VALUE             05040000
               ' STATUS CODE = '.                                       05050000
           05  WS-CUR-STATUS                PIC X(2).                   05060000
                                                                        05070000
      *-----------------------------------------------------------*     05080000
      *    DEFINE SUMMARY FORMAT                                  *     05090000
      *-----------------------------------------------------------*     05100000
       01  WS-SUMMARY-HEADER.                                           05110000
           05  FILLER                       PIC X     VALUE SPACES.     05120000
           05  FILLER                       PIC X(16) VALUE ALL '*'.    05130000
           05  FILLER                       PIC X(20) VALUE             05140000
               'BP13C41P SUMMARY RPT'.                                  05150000
           05  FILLER                       PIC X(19) VALUE ALL '*'.    05160000
                                                                        05170000
       01  WS-READ-CASES.                                               05180000
           05  FILLER                       PIC X(52) VALUE             05190000
               ' NO OF RECORDS READ FROM TRANS FILE  (BP13F315) = '.    05200000
           05  WS-EDIT-BP13F315-READ        PIC ZZZ9.                   05210000
                                                                        05220000
       01  WS-DOA-PAYMENT-PRINTED.                                      05230000
           05  FILLER                       PIC X(52) VALUE             05240000
               ' NO OF DOA PAYMENTS   (BP13L41PA)               = '.    05250000
           05  WS-EDIT-L41PA-PRINT          PIC ZZZ9.                   05260000
                                                                        05270000
       01  WS-L41PD-PRINTED.                                            05280000
           05  FILLER                       PIC X(52) VALUE             05290000
               ' NO OF                (BP13L41PD)               = '.    05300000
           05  WS-EDIT-L41PD-PRINT          PIC ZZZ9.                   05310000
                                                                        05320000
       01  WS-L41PE-PRINTED.                                            05330000
           05  FILLER                       PIC X(52) VALUE             05340000
               ' NO OF                (BP13L41PE)               = '.    05350000
           05  WS-EDIT-L41PE-PRINT          PIC ZZZ9.                   05360000
                                                                        05370000
       01  WS-L41PG-PRINTED.                                            05380000
           05  FILLER                       PIC X(52) VALUE             05390000
               ' NO OF                (BP13L41PG)               = '.    05400000
           05  WS-EDIT-L41PG-PRINT          PIC ZZZ9.                   05410000
                                                                        05420000
       01  WS-L41PH-PRINTED.                                            05430000
           05  FILLER                       PIC X(52) VALUE             05440000
               ' NO OF                (BP13L41PH)               = '.    05450000
           05  WS-EDIT-L41PH-PRINT          PIC ZZZ9.                   05460000
                                                                        05470000
       01  WS-L41PI-PRINTED.                                            05480000
           05  FILLER                       PIC X(52) VALUE             05490000
               ' NO OF                (BP13L41PI)               = '.    05500000
           05  WS-EDIT-L41PI-PRINT          PIC ZZZ9.                   05510000
                                                                        05520000
       01  WS-L41PJ-PRINTED.                                            05530000
           05  FILLER                       PIC X(52) VALUE             05540000
               ' NO OF                (BP13L41PJ)               = '.    05550000
           05  WS-EDIT-L41PJ-PRINT          PIC ZZZ9.                   05560000
                                                                        05570000
       01  WS-STAMP-FEES-REC-WRITTEN.                                   05580000
           05  FILLER                       PIC X(52) VALUE             05590000
               ' NO OF RECORDS WRITTEN TO STAMP FILE (AG07F225) = '.    05600000
           05  WS-EDIT-AG07F225-WRITE       PIC ZZZ9.                   05610000
                                                                        05620000
       01  WS-F316-REC-WRITTEN.                                         05630000
           05  FILLER                       PIC X(52) VALUE             05640000
               ' NO OF RECORDS WRITTEN TO STAMP FILE (BP13F316) = '.    05650000
           05  WS-EDIT-BP13F316-WRITE       PIC ZZZ9.                   05660000
                                                                        05670000
       01  WS-SUMMARY-TRAILER.                                          05680000
           05  FILLER                       PIC X     VALUE SPACES.     05690000
           05  FILLER                       PIC X(55) VALUE ALL '*'.    05700000
                                                                        05710000
      *-----------------------------------------------------------*     05720000
      *    CONSTANTS LIST                                         *     05730000
      *-----------------------------------------------------------*     05740000
       01  WS-ERROR-PROCEDURE-NAMES.                                    05750000
           05  CLOSE-K006                   PIC X(21) VALUE             05760000
                   'CLOSING FILE  B05K006'.                             05770000
           05  CLOSE-K413                   PIC X(21) VALUE             05780000
                   'CLOSING FILE BP13K413'.                             05790000
           05  CLOSE-K625                   PIC X(21) VALUE             05800000
                   'CLOSING FILE BP13K625'.                             05810000
           05  NOTFND-IN-FIS                PIC X(23) VALUE             05820000
                   'REC NOT FOUND IN K310'.                             05830000
           05  NOTFND-IN-MST                PIC X(23) VALUE             05840000
                   'REC NOT FOUND IN K006'.                             05850000
           05  NOTFND-IN-SO                 PIC X(23) VALUE             05860000
                   'REC NOT FOUND IN K413'.                             05870000
           05  NOTFND-IN-SMF                PIC X(23) VALUE             05880000
                   'REC NOT FOUND IN K413'.                             05890000
           05  OPEN-K006                    PIC X(21) VALUE             05900000
                   'OPENING FILE  B05K006'.                             05910000
           05  OPEN-K413                    PIC X(21) VALUE             05920000
                   'OPENING FILE BP13K413'.                             05930000
           05  OPEN-K625                    PIC X(21) VALUE             05940000
                   'OPENING FILE BP13K625'.                             05950000
           05  READ-F315                    PIC X(21) VALUE             05960000
                   'READING FILE BP13F315'.                             05970000
           05  WRITE-K625                   PIC X(21) VALUE             05980000
                   'WRITING FILE BP13K625'.                             05990000
           05  READ-K006                    PIC X(21) VALUE             06000000
                   'READING FILE  B05K006'.                             06010000
           05  READ-K413                    PIC X(21) VALUE             06020000
                   'READING FILE BP13K413'.                             06030000
           05  READ-K625                    PIC X(21) VALUE             06040000
                   'READING FILE BP13K625'.                             06050000
                                                                        06060000
       01  DUP-DOA-AMT                      PIC 9V99  VALUE 0.          06070000
       01  DUP-SA-AMT                       PIC 9V99  VALUE 0.          06080000
       01  HYPHEN                           PIC X     VALUE '-'.        06090000
       01  MAX-REC-PER-PAGE                 PIC 9(2)  VALUE 39.         06100000
       01  MAX-DETLS-PER-PAGE               PIC 9(3)  VALUE 25.         06110000
                                                                        06120000
      *-----------------------------------------------------------*     06130000
      *    LEVEL-88 VARIABLES                                     *     06140000
      *-----------------------------------------------------------*     06150000
       01  WS-EOF                           PIC X     VALUE 'N'.        06160000
           88  END-OF-BP13F315                        VALUE 'Y'.        06170000
       01  WS-REPORT-ID-SW                  PIC X(1)  VALUE SPACE.      06180000
       01  WS-PREV-REPORT-ID                PIC X(1)  VALUE SPACE.      06190000
           88  REPORT-L41PA                           VALUE 'A'.        06200000
           88  REPORT-L41PD                           VALUE 'D'.        06210000
           88  REPORT-L41PE                           VALUE 'E'.        06220000
           88  REPORT-L41PG                           VALUE 'G'.        06230000
           88  REPORT-L41PH                           VALUE 'H'.        06240000
           88  REPORT-L41PI                           VALUE 'I'.        06250000
           88  REPORT-L41PJ                           VALUE 'J'.        06260000
                                                                        06270000
      *-----------------------------------------------------------*     06280000
      *    OTHER VARIABLES                                        *     06290000
      *-----------------------------------------------------------*     06300000
       01  WS-COUNTERS.                                                 06310000
           05  WS-BP13F315-READ-CNT         PIC 9(4)    VALUE ZEROS.    06320000
           05  WS-BP13K625-WRITE-CNT        PIC 9(4)    VALUE ZEROES.   06330000
           05  WS-BP13F316-WRITE-CNT        PIC 9(4)    VALUE ZEROS.    06340000
           05  WS-AG07F225-WRITE-CNT        PIC 9(4)    VALUE ZEROES.   06350000
      *    -----------------------                                      06360000
      *    FOR L41PA - DOA LISTING                                      06370000
      *    -----------------------                                      06380000
           05  WS-L41PA-PRINT-CNT           PIC 9(4)    VALUE ZEROS.    06390000
           05  WS-L41PA-PAGE-CNT            PIC 9(5)    VALUE ZEROS.    06400000
           05  WS-L41PA-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.       06410000
           05  WS-L41PA-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.    06420000
           05  WS-L41PA-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.    06430000
           05  WS-L41PA-SUP-CNT             PIC 9(7)V99 VALUE ZEROS.    06440000
           05  WS-L41PA-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.    06450000
           05  WS-L41PA-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.    06460000
      *    -----------------------                                      06470000
      *    FOR L41PD -     LISTING                                      06480000
      *    -----------------------                                      06490000
           05  WS-L41PD-PRINT-CNT           PIC 9(4)    VALUE ZEROS.    06500000
           05  WS-L41PD-PAGE-CNT            PIC 9(5)    VALUE ZEROS.    06510000
           05  WS-L41PD-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.       06520000
           05  WS-L41PD-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.    06530000
           05  WS-L41PD-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.    06540000
           05  WS-L41PD-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.    06550000
           05  WS-L41PD-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.    06560000
           05  WS-L41PD-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.    06570000
      *    -----------------------                                      06580000
      *    FOR L41PE -     LISTING                                      06590000
      *    -----------------------                                      06600000
           05  WS-L41PE-PRINT-CNT           PIC 9(4)    VALUE ZEROS.    06610000
           05  WS-L41PE-PAGE-CNT            PIC 9(5)    VALUE ZEROS.    06620000
           05  WS-L41PE-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.       06630000
           05  WS-L41PE-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.    06640000
           05  WS-L41PE-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.    06650000
           05  WS-L41PE-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.    06660000
           05  WS-L41PE-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.    06670000
           05  WS-L41PE-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.    06680000
      *    -----------------------                                      06690000
      *    FOR L41PG -     LISTING                                      06700000
      *    -----------------------                                      06710000
           05  WS-L41PG-PRINT-CNT           PIC 9(4)    VALUE ZEROS.    06720000
           05  WS-L41PG-PAGE-CNT            PIC 9(5)    VALUE ZEROS.    06730000
           05  WS-L41PG-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.       06740000
           05  WS-L41PG-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.    06750000
           05  WS-L41PG-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.    06760000
           05  WS-L41PG-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.    06770000
           05  WS-L41PG-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.    06780000
           05  WS-L41PG-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.    06790000
      *    -----------------------                                      06800000
      *    FOR L41PH -     LISTING                                      06810000
      *    -----------------------                                      06820000
           05  WS-L41PH-PRINT-CNT           PIC 9(4)    VALUE ZEROS.    06830000
           05  WS-L41PH-PAGE-CNT            PIC 9(5)    VALUE ZEROS.    06840000
           05  WS-L41PH-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.       06850000
           05  WS-L41PH-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.    06860000
           05  WS-L41PH-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.    06870000
           05  WS-L41PH-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.    06880000
           05  WS-L41PH-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.    06890000
           05  WS-L41PH-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.    06900000
      *    -----------------------                                      06910000
      *    FOR L41PI -     LISTING                                      06920000
      *    -----------------------                                      06930000
           05  WS-L41PI-PRINT-CNT           PIC 9(4)    VALUE ZEROS.    06940000
           05  WS-L41PI-PAGE-CNT            PIC 9(5)    VALUE ZEROS.    06950000
           05  WS-L41PI-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.       06960000
           05  WS-L41PI-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.    06970000
           05  WS-L41PI-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.    06980000
           05  WS-L41PI-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.    06990000
           05  WS-L41PI-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.    07000000
           05  WS-L41PI-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.    07010000
      *    -----------------------                                      07020000
      *    FOR L41PJ -     LISTING                                      07030000
      *    -----------------------                                      07040000
           05  WS-L41PJ-PRINT-CNT           PIC 9(4)    VALUE ZEROS.    07050000
           05  WS-L41PJ-PAGE-CNT            PIC 9(5)    VALUE ZEROS.    07060000
           05  WS-L41PJ-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.       07070000
           05  WS-L41PJ-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.    07080000
           05  WS-L41PJ-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.    07090000
           05  WS-L41PJ-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.    07100000
           05  WS-L41PJ-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.    07110000
           05  WS-L41PJ-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.    07120000
                                                                        07130000
      *    --------------------------                                   07140000
      *    FOR L41PK - ERROR LISTING                                    07150000
      *    --------------------------                                   07160000
           05  WS-L41PK-PRINT-CNT           PIC 9(4)    VALUE ZEROS.    07170000
           05  WS-L41PK-PAGE-CNT            PIC 9(5)    VALUE ZEROS.    07180000
           05  WS-L41PK-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.       07190000
                                                                        07200000
       01  WS-FLATNO.                                                   07210000
           05  WS-NUM-LEVEL                 PIC X(2).                   07220000
           05  FILLER                       PIC X       VALUE '-'.      07230000
           05  WS-NUM-MAIN                  PIC X(5).                   07240000
                                                                        07250000
       01  WS-SCH-ACC.                                                  07260000
           05  WS-SCH                       PIC X(4).                   07270000
           05  WS-SCH-SEP1                  PIC X.                      07280000
           05  WS-ACC                       PIC X(4).                   07290000
           05  WS-SCH-SEP2                  PIC X.                      07300000
           05  WS-CHK                       PIC X.                      07310000
           05  WS-SCH-SEP3                  PIC X.                      07320000
           05  WS-LESCDE                    PIC X(2).                   07330000
                                                                        07340000
       01  WS-F315-ACC-CHK.                                             07350000
           05  WS-F315-ACC                  PIC X(4).                   07360000
           05  WS-F315-CHK                  PIC X(1).                   07370000
                                                                        07380000
       01  WS-SO-DATE.                                                  07390000
           05  WS-SO-CC                     PIC X(2).                   07400000
           05  WS-SO-YY                     PIC X(2).                   07410000
           05  WS-SO-MM                     PIC X(2).                   07420000
           05  WS-SO-DD                     PIC X(2).                   07430000
                                                                        07440000
       01  WS-SALE-DATE.                                                07450000
           05  WS-SALE-CC                   PIC X(2).                   07460000
           05  WS-SALE-YY                   PIC X(2).                   07470000
           05  WS-SALE-MM                   PIC X(2).                   07480000
           05  WS-SALE-DD                   PIC X(2).                   07490000
                                                                        07500000
       01  WS-TEMPORARY-BUFFER.                                         07510000
           05  WS-TEMP-TOTAL                PIC 9(7)V99.                07520000
           05  WS-TEMP-DIFF                 PIC 9(7)V99.                07530000
                                                                        07540000
       01  WS-BLANK-LINE                    PIC X     VALUE SPACES.     07550000
       01  WS-F315-STATUS                   PIC 9(2)  VALUE ZEROS.      07560000
       01  WS-K006-STATUS                   PIC 9(2)  VALUE ZEROS.      07570000
       01  WS-K413-STATUS                   PIC 9(2)  VALUE ZEROS.      07580000
       01  WS-K625-STATUS                   PIC 9(2)  VALUE ZEROS.      07590000
       01  WS-K625-EOF                      PIC X(1)  VALUE 'N'.        07600000
       01  WS-DEF-DUP-LEASE                 PIC 99V99 VALUE ZEROS.      07610000
       01  WS-LEASE-SF                      PIC S9(5)V99.               07620000
       01  WS-LEASE-STAMP                   PIC S9(5)V99 VALUE ZEROS.   07630000
       01  WS-MORT-SF                       PIC S9(5)V99.               07640000
       01  WS-SUP-SF                        PIC S9(5)V99.               07650000
       01  WS-DUP-DOA                       PIC 9(2)V99.                07660000
       01  WS-DUP-SA                        PIC 9(2)V99.                07670000
       01  WS-ANNUAL-RENT                   PIC 9(7)V99.                07680000
       01  WS-NUM-HDB-REF                   PIC X(11) VALUE SPACES.     07690000
       01  WS-NUM-DOC                       PIC X(3)  VALUE SPACES.     07700000
       01  WS-NUM-DOC-TYP                   PIC X(1)  VALUE SPACES.     07710000
       01  WS-NUM-DOC-CNT                   PIC 9(1)  VALUE ZEROES.     07720000
       01  WS-AMT-STAMP-DUTY                PIC 9(13)V99 VALUE ZEROES.  07730000
       01  WS-AMT-STAMP-DUTY-DUP            PIC 9(13)V99 VALUE ZEROES.  07740000
       01  WS-AMT-EARMARK                   PIC 9(10)V99 VALUE ZEROES.  07750000
       01  WS-EM-LEASE-STAMP                PIC S9(5)V99 VALUE ZEROS.   07760000
       01  WS-EM-MORT-SF                    PIC S9(5)V99 VALUE ZEROS.   07770000
       01  WS-EM-SUP-SF                     PIC S9(5)V99 VALUE ZEROS.   07780000
       01  WS-EM-DUP-DOA                    PIC 9(2)V99  VALUE ZEROS.   07790000
       01  WS-EM-DUP-SA                     PIC 9(2)V99  VALUE ZEROS.   07800000
                                                                        07810000
      *----------------------------------------------------------*      07820000
      *    WS VARIABLES USED BY F225                             *      07830000
      *----------------------------------------------------------*      07840000
       01  WS-NEW-VOUCHER                   PIC X      VALUE 'Y'.       07850000
       01  WS-NEW-BATCH                     PIC X      VALUE 'Y'.       07860000
       01  WS-NEW-HEADER                    PIC X      VALUE 'Y'.       07870000
       01  WS-NUM-VOUCHER                   PIC X(11)  VALUE SPACES.    07880000
       01  WS-NUM-BATCH-TYPE                PIC X(4)   VALUE SPACES.    07890000
       01  WS-NUM-FIN-YEAR                  PIC 9(4)   VALUE ZEROES.    07900000
       01  WS-NUM-BATCH-SERIAL              PIC 9(5)   VALUE ZEROES.    07910000
       01  WS-SCH-ACCT-NO                   PIC X(11)  VALUE SPACES.    07920000
       01  WS-TXT-INFO                      PIC X(50)  VALUE SPACES.    07930000
       01  WS-CNT-DETAILS                   PIC 9(4)   VALUE ZEROES.    07940000
       01  WS-AMT-TRANS                     PIC 9(7)V99 VALUE ZEROES.   07950000
       01  WS-AMT-TOTAL                     PIC 9(7)V99 VALUE ZEROES.   07960000
       01  WS-PREV-SA-TP-TAG                PIC X(1)   VALUE SPACE.     07970000
       01  WS-STAFF-START                   PIC X(9) VALUE '29586H   '. 07980000
       01  WS-EDITED-VOUCHER-NO.                                        07990000
           05  WS-EDITED-NUM-DDD            PIC X(3)   VALUE SPACES.    08000000
           05  FILLER                       PIC X(1)   VALUE '-'.       08010000
           05  WS-EDITED-NUM-FIN-YEAR       PIC X(2)   VALUE SPACES.    08020000
           05  FILLER                       PIC X(1)   VALUE '-'.       08030000
           05  WS-EDITED-NUM-VR-SERIAL      PIC X(6)   VALUE SPACES.    08040000
       01  WS-L41PA-DESC.                                               08050000
           05  FILLER                       PIC X(35)  VALUE SPACES.    08060000
           05  FILLER                       PIC X(46)  VALUE            08070000
              'DEED OF ASSIGNMENT AND SUPPLEMENTAL AGREEMENT'.          08080000
           05  FILLER                       PIC X(12)  VALUE            08090000
              'FOR SOC FLAT'.                                           08100000
       01  WS-L41PD-DESC.                                               08110000
           05  FILLER                       PIC X(38)  VALUE SPACES.    08120000
           05  FILLER                       PIC X(55)  VALUE            08130000
              'AGREEMENT OF LEASE AND DEED OF ASSIGNMENT OF SOC FLAT'.  08140000
       01  WS-L41PE-DESC.                                               08150000
           05  FILLER                       PIC X(38)  VALUE SPACES.    08160000
           05  FILLER                       PIC X(57)  VALUE            08170000
            'AGREEMENT OF LEASE AND DEED OF ASSIGNMENT OF SOC FLAT(01)'.08180000
       01  WS-L41PG-DESC.                                               08190000
           05  FILLER                       PIC X(38)  VALUE SPACES.    08200000
           05  FILLER                       PIC X(57)  VALUE            08210000
            'AGREEMENT OF LEASE AND DEED OF ASSIGNMENT OF SOC FLAT(2B)'.08220000
       01  WS-L41PH-DESC.                                               08230000
           05  FILLER                       PIC X(38)  VALUE SPACES.    08240000
           05  FILLER                       PIC X(57)  VALUE            08250000
            'AGREEMENT OF LEASE AND DEED OF ASSIGNMENT OF SOC FLAT(03)'.08260000
       01  WS-L41PI-DESC.                                               08270000
           05  FILLER                       PIC X(38)  VALUE SPACES.    08280000
           05  FILLER                       PIC X(57)  VALUE            08290000
            'AGREEMENT OF LEASE AND DEED OF ASSIGNMENT OF SOC FLAT(3A)'.08300000
       01  WS-L41PJ-DESC.                                               08310000
           05  FILLER                       PIC X(38)  VALUE SPACES.    08320000
           05  FILLER                       PIC X(42)  VALUE            08330000
              'AGREEMENT OF LEASE AND DEED OF ASSIGNMENT '.             08340000
           05  FILLER                       PIC X(17)  VALUE            08350000
              'OF SOC FLAT(SERS)'.                                      08360000
                                                                        08370000
      *----------------------------------------------------------*      08380000
      *    WS VARIABLES PASSED FROM SUB-PROGRAM "AG07C907"       *      08390000
      *----------------------------------------------------------*      08400000
       COPY AG7C907C.                                                   08410000
                                                                        08420000
      *----------------------------------------------------------*      08430000
      *    WS VARIABLES PASSED FROM SUB-PROGRAM "BP13C906"       *      08440000
      *----------------------------------------------------------*      08450000
       COPY P13C906C.                                                   08460000
                                                                        08470000
      *----------------------------------------------------------*      08480000
      *    WS VARIABLES PASSED FROM SUB-PROGRAM "AB05C902"       *      08490000
      *----------------------------------------------------------*      08500000
       COPY AB05902C.                                                   08510000
                                                                        08520000
      *----------------------------------------------------------*      08530000
      *    WS VARIABLES FOR CONVERTING AMOUNT TO WORDS           *      08540000
      *----------------------------------------------------------*      08550000
       01  WS-SUBSCRIPTS.                                               08560000
           05  WA-SUB              PIC 999   VALUE 0.                   08570000
           05  WF-SUB              PIC 999   VALUE 0.                   08580000
           05  WL-SUB              PIC 999   VALUE 0.                   08590000
           05  WS-SUB              PIC 999   VALUE 0.                   08600000
           05  WS-FIRST-SUB        PIC 999   VALUE 0.                   08610000
                                                                        08620000
       01  WA-NAMES.                                                    08630000
           05  FILLER              PIC X(10) VALUE '3ONE      '.        08640000
           05  FILLER              PIC X(10) VALUE '3TWO      '.        08650000
           05  FILLER              PIC X(10) VALUE '5THREE    '.        08660000
           05  FILLER              PIC X(10) VALUE '4FOUR     '.        08670000
           05  FILLER              PIC X(10) VALUE '4FIVE     '.        08680000
           05  FILLER              PIC X(10) VALUE '3SIX      '.        08690000
           05  FILLER              PIC X(10) VALUE '5SEVEN    '.        08700000
           05  FILLER              PIC X(10) VALUE '5EIGHT    '.        08710000
           05  FILLER              PIC X(10) VALUE '4NINE     '.        08720000
           05  FILLER              PIC X(10) VALUE '3TEN      '.        08730000
           05  FILLER              PIC X(10) VALUE '6ELEVEN   '.        08740000
           05  FILLER              PIC X(10) VALUE '6TWELVE   '.        08750000
           05  FILLER              PIC X(10) VALUE '8THIRTEEN '.        08760000
           05  FILLER              PIC X(10) VALUE '8FOURTEEN '.        08770000
           05  FILLER              PIC X(10) VALUE '7FIFTEEN  '.        08780000
           05  FILLER              PIC X(10) VALUE '7SIXTEEN  '.        08790000
           05  FILLER              PIC X(10) VALUE '9SEVENTEEN'.        08800000
           05  FILLER              PIC X(10) VALUE '8EIGHTEEN '.        08810000
           05  FILLER              PIC X(10) VALUE '8NINETEEN '.        08820000
           05  FILLER              PIC X(10) VALUE '6TWENTY   '.        08830000
           05  FILLER              PIC X(10) VALUE '6THIRTY   '.        08840000
           05  FILLER              PIC X(10) VALUE '5FORTY    '.        08850000
           05  FILLER              PIC X(10) VALUE '5FIFTY    '.        08860000
           05  FILLER              PIC X(10) VALUE '5SIXTY    '.        08870000
           05  FILLER              PIC X(10) VALUE '7SEVENTY  '.        08880000
           05  FILLER              PIC X(10) VALUE '6EIGHTY   '.        08890000
           05  FILLER              PIC X(10) VALUE '6NINETY   '.        08900000
       01  WA-NAMER REDEFINES WA-NAMES.                                 08910000
           05  WA-NAME             PIC X(10) OCCURS 27 TIMES.           08920000
                                                                        08930000
       01  WS-LITERALS.                                                 08940000
           05  L-CENT              PIC X(5)  VALUE '4CENT'.             08950000
           05  L-AND               PIC X(4)  VALUE '3AND'.              08960000
           05  L-X                 PIC X     VALUE '%'.                 08970000
           05  L-MILLION           PIC X(8)  VALUE '7MILLION'.          08980000
           05  L-THOUSAND          PIC X(9)  VALUE '8THOUSAND'.         08990000
           05  L-DOLLARS           PIC X(8)  VALUE '7DOLLARS'.          09000000
           05  L-CENTS             PIC X(6)  VALUE '6CENTS'.            09010000
           05  L-ONLY              PIC X(6)  VALUE '5ONLY '.            09020000
           05  L-HUNDRED           PIC X(8)  VALUE '7HUNDRED'.          09030000
           05  L-DOLLAR            PIC X(7)  VALUE '6DOLLAR'.           09040000
                                                                        09050000
       01  SWITCHES.                                                    09060000
           05  WS-SWITCH           PIC 9     VALUE 0.                   09070000
           05  WS-THO-SW           PIC 9     VALUE 0.                   09080000
           05  WS-CNT-SW           PIC 9     VALUE 0.                   09090000
           05  WS-LIT-SW           PIC 9     VALUE 0.                   09100000
           05  WS-TEN-SW           PIC 9     VALUE 0.                   09110000
           05  WS-AND-SW           PIC 9     VALUE 0.                   09120000
                                                                        09130000
       01  WS-PLACE-COUNTER        PIC 999   VALUE 0.                   09140000
       01  WL-AREA-SAVE            PIC X(12) VALUE SPACES.              09150000
       01  WS-RESULT               PIC 999   VALUE 0.                   09160000
       01  WL-AREA.                                                     09170000
           05  WL-ITEM1            PIC 9     VALUE 0.                   09180000
           05  FILLER              PIC X(11) VALUE SPACE.               09190000
       01  WL-ITM REDEFINES WL-AREA.                                    09200000
           05  WL-ITEM             PIC X     OCCURS 12 TIMES.           09210000
                                                                        09220000
       01  WS-CHEQUE-DETAILS.                                           09230000
           05  WS-AMT              PIC 9(7)V99 VALUE 0.                 09240000
           05  WS-DIGIT REDEFINES  WS-AMT OCCURS 9 TIMES PIC 9.         09250000
           05  WF-DETAILS.                                              09260000
               10  WF-LINE-1       PIC X(60).                           09270000
               10  WF-LINE-2       PIC X(60).                           09280000
           05  WF-ITEM REDEFINES WF-DETAILS OCCURS 120 PIC X.           09290000
           05  WP-ITEM REDEFINES WF-DETAILS OCCURS 2 PIC X(60).         09300000
                                                                        09310000
                                                                        09320000
      ********************                                              09330000
       PROCEDURE DIVISION.                                              09340000
      ******************************************************************09350000
       0000-CONTROL.                                                    09360000
      ******************************************************************09370000
            PERFORM  0100-SET-DATE               THRU  0100-EXIT.       09380000
            PERFORM  0200-OPEN-FILES             THRU  0200-EXIT.       09390000
            PERFORM  1100-READ-BP13F315          THRU  1100-EXIT.       09400000
            PERFORM  0900-CHECK-SALES-TYPE       THRU  0900-EXIT.       09410000
            MOVE     WS-REPORT-ID-SW             TO    WS-PREV-REPORT-ID09420000
            MOVE     F315-CDE-SA-TP-TAG          TO    WS-PREV-SA-TP-TAG09430000
            PERFORM  1000-READ-AND-PRINT-LOOP    THRU  1000-EXIT        09440000
                          UNTIL END-OF-BP13F315.                        09450000
            PERFORM  8000-DISPLAY-STATISTICS     THRU  8000-EXIT.       09460000
            PERFORM  9000-CLOSE-FILES            THRU  9000-EXIT.       09470000
                                                                        09480000
       0000-EXIT.                                                       09490000
            EXIT.                                                       09500000
                                                                        09510000
                                                                        09520000
      ******************************************************************09530000
       0100-SET-DATE.                                                   09540000
      ******************************************************************09550000
            STRING  FUNCTION CURRENT-DATE(7:2) '/'                      09560000
                    FUNCTION CURRENT-DATE(5:2) '/'                      09570000
                    FUNCTION CURRENT-DATE(1:4)                          09580000
            DELIMITED BY SIZE INTO HEADER-DATE.                         09590000
                                                                        09600000
            MOVE HEADER-DATE           TO   L41P-CURRENT-DATE.          09610000
                                                                        09620000
       0100-EXIT.                                                       09630000
            EXIT.                                                       09640000
                                                                        09650000
                                                                        09660000
      ******************************************************************09670000
       0200-OPEN-FILES.                                                 09680000
      ******************************************************************09690000
      *     OPEN INPUT  B05K006                                         09700000
            OPEN INPUT  BP13F315                                        09710000
                        BP13K413                                        09720000
                 I-O    BP13K625                                        09730000
                 OUTPUT AG07F225                                        09740000
                        BP13F316                                        09750000
                                                                        09760000
                        BP1341PA BP1341PD BP1341PE                      09770000
                                                                        09780000
                        BP1341PG BP1341PH BP1341PI BP1341PJ             09790000
                        BP1341PK.                                       09800000
                                                                        09810000
            IF WS-K006-STATUS NOT = 00 AND 97                           09820000
               MOVE    OPEN-K006                  TO   WS-CUR-PROC      09830000
               MOVE    WS-K006-STATUS             TO   WS-CUR-STATUS    09840000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT        09850000
               PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT.       09860000
                                                                        09870000
            IF WS-K413-STATUS NOT = 00 AND 97                           09880000
               MOVE    OPEN-K413                  TO    WS-CUR-PROC     09890000
               MOVE    WS-K413-STATUS             TO    WS-CUR-STATUS   09900000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT       09910000
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.      09920000
                                                                        09930000
            IF WS-K625-STATUS NOT = 00 AND 97                           09940000
               MOVE    OPEN-K625                TO    WS-CUR-PROC       09950000
               MOVE    WS-K625-STATUS           TO    WS-CUR-STATUS     09960000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT       09970000
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.      09980000
                                                                        09990000
      * VOUCHER NUMBER                                                  10000000
            MOVE 'AG07K960' TO    C907-NUM-FILENME.                     10010000
            CALL 'K960OPEN' USING AG07C907-AREA.                        10020000
                                                                        10030000
            IF C907-NUM-FILE-STATUS NOT = ('00' AND '97')               10040000
               DISPLAY 'ERROR OPENING AG07K960, STATUS = '              10050000
                        C907-NUM-FILE-STATUS                            10060000
               MOVE     C907-NUM-FILE-STATUS    TO     RETURN-CODE      10070000
               PERFORM  9000-CLOSE-FILES        THRU   9000-EXIT        10080000
            END-IF.                                                     10090000
                                                                        10100000
      * BATCH NUMBER (17/07/1999 - ROMAR)                               10110000
            MOVE 'BP13K620' TO    C906-NUM-FILENME.                     10120000
            CALL 'K620OPEN' USING BP13C906-AREA.                        10130000
                                                                        10140000
            IF C906-NUM-FILE-STATUS NOT = ('00' AND '97')               10150000
               DISPLAY 'ERROR OPENING BP13K620, STATUS = '              10160000
                        C906-NUM-FILE-STATUS                            10170000
               MOVE     C906-NUM-FILE-STATUS    TO     RETURN-CODE      10180000
               PERFORM  9000-CLOSE-FILES        THRU   9000-EXIT        10190000
            END-IF.                                                     10200000
                                                                        10210000
      **CALL AB05C902 TO OPEN B05K006 AND AB05K009 FILES(CODE='O')      10220000
            MOVE SPACES              TO   WS-B902-AREA.                 10230000
            INITIALIZE                    WS-B902-AREA.                 10240000
            MOVE 'O'                 TO   B902-CDE-TYPE.                10250000
            CALL 'AB05C902'  USING WS-B902-AREA.                        10260000
                                                                        10270000
            IF B902-CDE-ERROR NOT = ZEROES                              10280000
               MOVE B902-CDE-SYSERR  TO   RETURN-CODE                   10290000
               DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'            10300000
               PERFORM  9000-CLOSE-FILES  THRU 9000-EXIT                10310000
            END-IF.                                                     10320000
                                                                        10330000
       0200-EXIT.                                                       10340000
            EXIT.                                                       10350000
                                                                        10360000
                                                                        10370000
      ******************************************************************10380000
       0300-CHK-SERS.                                                   10390000
      ******************************************************************10400000
      *-----------------------------------*                             10410000
      * SEARCH SCHEME IN ALLOC SCH TABLE  *                             10420000
      *-----------------------------------*                             10430000
           IF WS-ALLOC-SCH  NOT =  LOW-VALUES AND SPACES                10440000
               SET WS-SERS-PTR  TO 1                                    10450000
               SEARCH WS-SERS-SCH                                       10460000
                   AT END                                               10470000
                   MOVE 'N' TO WS-SCH-FND                               10480000
                   WHEN WS-SERS-SCHEME(WS-SERS-PTR) = WS-ALLOC-SCH      10490000
                   MOVE 'Y' TO WS-SCH-FND                               10500000
               END-SEARCH                                               10510000
           ELSE                                                         10520000
               MOVE 'N' TO WS-SCH-FND                                   10530000
           END-IF.                                                      10540000
                                                                        10550000
       0300-EXIT.                                                       10560000
            EXIT.                                                       10570000
                                                                        10580000
                                                                        10590000
      ******************************************************************10600000
       0900-CHECK-SALES-TYPE.                                           10610000
      ******************************************************************10620000
            MOVE F315-NUM-ALLOC-SCH  TO    WS-ALLOC-SCH.                10630000
            PERFORM 0300-CHK-SERS    THRU  0300-EXIT.                   10640000
                                                                        10650000
            IF  WS-SCH-FND = 'Y'                                        10660000
                MOVE  'J'           TO     WS-REPORT-ID-SW              10670000
                MOVE  'SERS'        TO     WS-NUM-BATCH-TYPE            10680000
                GO TO 0900-EXIT                                         10690000
            END-IF.                                                     10700000
                                                                        10710000
            IF F315-CDE-SA-TP-TAG = 'Y'                                 10720000
               EVALUATE F315-CDE-SALES-TYPE                             10730000
               WHEN     '01'                                            10740000
               WHEN     '02'                                            10750000
                        MOVE    'E'    TO     WS-REPORT-ID-SW           10760000
                        MOVE    'SOS ' TO     WS-NUM-BATCH-TYPE         10770000
               WHEN     '2B'                                            10780000
                        MOVE    'G'    TO     WS-REPORT-ID-SW           10790000
                        MOVE    'STD ' TO     WS-NUM-BATCH-TYPE         10800000
               WHEN     '03'                                            10810000
                        MOVE    'H'    TO     WS-REPORT-ID-SW           10820000
                        MOVE    'RP  ' TO     WS-NUM-BATCH-TYPE         10830000
               WHEN     '3A'                                            10840000
                        MOVE    'I'    TO     WS-REPORT-ID-SW           10850000
                        MOVE    'BB  ' TO     WS-NUM-BATCH-TYPE         10860000
               WHEN     '10'                                            10870000
                        MOVE    'D'    TO     WS-REPORT-ID-SW           10880000
                        MOVE    'SATP' TO     WS-NUM-BATCH-TYPE         10890000
               WHEN     '13'                                            10900000
                        MOVE    'D'    TO     WS-REPORT-ID-SW           10910000
                        MOVE    'SATP' TO     WS-NUM-BATCH-TYPE         10920000
               WHEN     '18'                                            10930000
                        MOVE    'D'    TO     WS-REPORT-ID-SW           10940000
                        MOVE    'SATP' TO     WS-NUM-BATCH-TYPE         10950000
               WHEN     '19'                                            10960000
                        MOVE    'D'    TO     WS-REPORT-ID-SW           10970000
                        MOVE    'SATP' TO     WS-NUM-BATCH-TYPE         10980000
               WHEN     OTHER                                           10990000
                        MOVE    ' '    TO     WS-REPORT-ID-SW           11000000
                        MOVE    '    ' TO     WS-NUM-BATCH-TYPE         11010000
               END-EVALUATE                                             11020000
            ELSE                                                        11030000
               EVALUATE F315-CDE-SALES-TYPE                             11040000
               WHEN     '01'                                            11050000
               WHEN     '02'                                            11060000
                        MOVE    'E'    TO     WS-REPORT-ID-SW           11070000
                        MOVE    'SOS ' TO     WS-NUM-BATCH-TYPE         11080000
               WHEN     '2B'                                            11090000
                        MOVE    'G'    TO     WS-REPORT-ID-SW           11100000
                        MOVE    'STD ' TO     WS-NUM-BATCH-TYPE         11110000
               WHEN     '03'                                            11120000
                        MOVE    'H'    TO     WS-REPORT-ID-SW           11130000
                        MOVE    'RP  ' TO     WS-NUM-BATCH-TYPE         11140000
               WHEN     '3A'                                            11150000
                        MOVE    'I'    TO     WS-REPORT-ID-SW           11160000
                        MOVE    'BB  ' TO     WS-NUM-BATCH-TYPE         11170000
               WHEN     '10'                                            11180000
                        MOVE    'A'    TO     WS-REPORT-ID-SW           11190000
                        MOVE    'TP  ' TO     WS-NUM-BATCH-TYPE         11200000
               WHEN     '13'                                            11210000
                        MOVE    'A'    TO     WS-REPORT-ID-SW           11220000
                        MOVE    'TP  ' TO     WS-NUM-BATCH-TYPE         11230000
               WHEN     '18'                                            11240000
                        MOVE    'A'    TO     WS-REPORT-ID-SW           11250000
                        MOVE    'TP  ' TO     WS-NUM-BATCH-TYPE         11260000
               WHEN     '19'                                            11270000
                        MOVE    'A'    TO     WS-REPORT-ID-SW           11280000
                        MOVE    'TP  ' TO     WS-NUM-BATCH-TYPE         11290000
               WHEN     OTHER                                           11300000
                        MOVE    ' '    TO     WS-REPORT-ID-SW           11310000
                        MOVE    '    ' TO     WS-NUM-BATCH-TYPE         11320000
               END-EVALUATE                                             11330000
            END-IF.                                                     11340000
                                                                        11350000
       0900-EXIT.                                                       11360000
            EXIT.                                                       11370000
                                                                        11380000
                                                                        11390000
      ******************************************************************11400000
       1000-READ-AND-PRINT-LOOP.                                        11410000
      ******************************************************************11420000
            MOVE F315-NUM-ALLOC-SCH TO WS-ALLOC-SCH.                    11430000
            PERFORM 0300-CHK-SERS   THRU 0300-EXIT.                     11440000
                                                                        11450000
            IF F315-CDE-TRANS = 'ST'                                    11460000
               IF (WS-REPORT-ID-SW    NOT = WS-PREV-REPORT-ID) OR       11470000
                  (F315-CDE-SA-TP-TAG NOT = WS-PREV-SA-TP-TAG AND       11480000
                   WS-SCH-FND NOT = 'Y')                                11490000
                   PERFORM  5000-WRITE-TRAILER-F225                     11500000
                      THRU  5000-TRAILER-EXIT                           11510000
                   MOVE     ZEROES               TO  WS-CNT-DETAILS     11520000
                   MOVE     ZEROES               TO  WS-TEMP-TOTAL      11530000
                   MOVE     'Y'                  TO  WS-NEW-BATCH       11540000
                                                     WS-NEW-VOUCHER     11550000
                                                     WS-NEW-HEADER      11560000
                   MOVE     WS-REPORT-ID-SW      TO  WS-PREV-REPORT-ID  11570000
                   MOVE     F315-CDE-SA-TP-TAG   TO  WS-PREV-SA-TP-TAG  11580000
               END-IF                                                   11590000
                                                                        11600000
               PERFORM  1050-PROCESS-RECORD      THRU 1050-EXIT         11610000
               PERFORM  1055-EARMARK-ACCOUNT     THRU 1055-EXIT         11620000
                                                                        11630000
               IF B902-CDE-SYSERR NOT = ZEROES                          11640000
                  DISPLAY 'ERROR CALLING AB05C902, STATUS = '           11650000
                           B902-CDE-SYSERR                              11660000
                  MOVE     '99'                 TO RETURN-CODE          11670000
                  PERFORM  9000-CLOSE-FILES                             11680000
               END-IF                                                   11690000
                                                                        11700000
               IF B902-CDE-ERROR-ACCT(1) = SPACES                       11710000
                  IF WS-NEW-HEADER = 'Y'                                11720000
                     PERFORM  5000-WRITE-HEADER-F225                    11730000
                              THRU 5000-HEADER-EXIT                     11740000
                     MOVE  'N'             TO   WS-NEW-HEADER           11750000
                  END-IF                                                11760000
                  PERFORM  1060-PRINT-RECORD        THRU 1060-EXIT      11770000
                  MOVE F315-CDE-SA-TP-TAG  TO   WS-PREV-SA-TP-TAG       11780000
                  PERFORM  6000-WRITE-STAMPING-FILE THRU 6000-EXIT      11790000
               END-IF                                                   11800000
                                                                        11810000
            END-IF.                                                     11820000
                                                                        11830000
            PERFORM 1100-READ-BP13F315       THRU 1100-EXIT.            11840000
                                                                        11850000
            IF NOT END-OF-BP13F315                                      11860000
               PERFORM 0900-CHECK-SALES-TYPE THRU 0900-EXIT             11870000
            END-IF.                                                     11880000
                                                                        11890000
       1000-EXIT.                                                       11900000
            EXIT.                                                       11910000
                                                                        11920000
                                                                        11930000
      ******************************************************************11940000
       1050-PROCESS-RECORD.                                             11950000
      ******************************************************************11960000
            MOVE F315-REGN-NO           TO K413-NUM-REGN.               11970000
            MOVE '1'                    TO K413-SEQ-NUMBER.             11980000
            PERFORM 1400-READ-K413 THRU 1400-EXIT.                      11990000
                                                                        12000000
            IF K413-NUM-REGN = '1557906D'                               12010000
            MOVE ZEROES TO K413-AMT-LEASE-STAMP                         12020000
            ELSE                                                        12030000
            IF K413-AMT-LEASE-STAMP       NOT NUMERIC                   12040000
               MOVE ZEROES TO K413-AMT-LEASE-STAMP.                     12050000
                                                                        12060000
            IF K413-AMT-LOAN              NOT NUMERIC                   12070000
               MOVE ZEROS  TO K413-AMT-LOAN.                            12080000
                                                                        12090000
            IF K413-NUM-PREMIUM-RATE      NOT NUMERIC                   12100000
               MOVE ZEROS  TO K413-NUM-PREMIUM-RATE.                    12110000
                                                                        12120000
            IF K413-AMT-PREMIUM-STAMP-FEE NOT NUMERIC                   12130000
               MOVE ZEROS  TO K413-AMT-PREMIUM-STAMP-FEE.               12140000
                                                                        12150000
      * GENERATE BATCH NUMBER.                                          12160000
            IF WS-NEW-BATCH = 'Y'                                       12170000
               MOVE WS-NUM-BATCH-TYPE TO C906-NUM-BATCH-TYPE            12180000
               MOVE  'BP13K620'       TO C906-NUM-FILENME               12190000
                                                                        12200000
               CALL 'BP13C906'  USING BP13C906-AREA                     12210000
                                                                        12220000
               IF C906-NUM-FILE-STATUS =  '00'                          12230000
                  MOVE C906-NUM-BATCH-TYPE      TO  WS-NUM-BATCH-TYPE   12240000
                  MOVE C906-NUM-FIN-YEAR        TO  WS-NUM-FIN-YEAR     12250000
                  MOVE C906-NUM-BATCH-SERIAL    TO  WS-NUM-BATCH-SERIAL 12260000
                  MOVE    'N'                   TO  WS-NEW-BATCH        12270000
               ELSE                                                     12280000
                  DISPLAY 'ERROR CALLING BP13C906, FILE STATUS = '      12290000
                           C906-NUM-FILE-STATUS                         12300000
                  MOVE     C906-NUM-FILE-STATUS TO RETURN-CODE          12310000
                  PERFORM  9000-CLOSE-FILES                             12320000
            END-IF.                                                     12330000
                                                                        12340000
      * GENERATE VOUCHER NUMBER.                                        12350000
            IF WS-NEW-VOUCHER = 'Y'                                     12360000
      *        MOVE  'SU '      TO C907-NUM-DDD                         12370000
               MOVE  'SS '      TO C907-NUM-DDD                         12380000
               MOVE  'AG07K960' TO C907-NUM-FILENME                     12390000
                                                                        12400000
               CALL 'AG07C907'  USING AG07C907-AREA                     12410000
                                                                        12420000
               IF C907-NUM-FILE-STATUS =  '00'                          12430000
                  MOVE    'N'   TO    WS-NEW-VOUCHER                    12440000
               ELSE                                                     12450000
                  DISPLAY 'ERROR CALLING AG07C907, FILE STATUS = '      12460000
                           C907-NUM-FILE-STATUS                         12470000
                  MOVE     C907-NUM-FILE-STATUS TO RETURN-CODE          12480000
                  PERFORM  9000-CLOSE-FILES                             12490000
            END-IF.                                                     12500000
                                                                        12510000
       1050-EXIT.                                                       12520000
            EXIT.                                                       12530000
                                                                        12540000
                                                                        12550000
      ******************************************************************12560000
       1055-EARMARK-ACCOUNT.                                            12570000
      ******************************************************************12580000
      **CALL AB05C902 TO EARMARK ACCOUNT(CODE='E')                      12590000
            MOVE SPACES              TO   WS-B902-AREA.                 12600000
            INITIALIZE                    WS-B902-AREA.                 12610000
                                                                        12620000
            STRING C907-NUM-DDD  C907-NUM-FIN-YR                        12630000
                   C907-NUM-VR-SERIAL                                   12640000
                   DELIMITED BY SIZE INTO B902-VR-NO                    12650000
            END-STRING.                                                 12660000
                                                                        12670000
            MOVE 'E'                     TO   B902-CDE-TYPE.            12680000
            MOVE 'BP13'                  TO   B902-CDE-SYSTEMID.        12690000
            MOVE FUNCTION CURRENT-DATE   TO   B902-DTE-TRANS.           12700000
            MOVE 'P13C41P'               TO   B902-NUM-USERID-UPDATE.   12710000
            MOVE 'CV'                    TO   B902-CDE-EARMARK-REASON.  12720000
            MOVE 01                      TO   B902-NUM-HDB-REF-CNT.     12730000
            MOVE F315-SCH-ACC            TO   B902-NUM-HDB-REF(1).      12740000
            MOVE ZEROES                  TO   WS-AMT-EARMARK.           12750000
                                                                        12760000
            PERFORM 1057-COMP-TRANS-AMT  THRU 1057-EXIT.                12770000
            MOVE WS-AMT-EARMARK          TO   B902-AMT-EARMARK(1).      12780000
                                                                        12790000
            DISPLAY '----------------'.                                 12800000
            DISPLAY 'B902-VR-NO       = ' B902-VR-NO.                   12810000
            DISPLAY 'B902-CDE-TYPE    = ' B902-CDE-TYPE.                12820000
            DISPLAY 'CDE-SYSTEMID     = ' B902-CDE-SYSTEMID.            12830000
            DISPLAY 'B902-DTE-TRANS   = ' B902-DTE-TRANS.               12840000
            DISPLAY 'NUM-USERID       = ' B902-NUM-USERID-UPDATE.       12850000
            DISPLAY 'HDB-REF-CNT      = ' B902-NUM-HDB-REF-CNT.         12860000
            DISPLAY 'NUM-HDB-REF      = ' B902-NUM-HDB-REF(1).          12870000
            DISPLAY 'B902-AMT-EARMARK = ' B902-AMT-EARMARK(1).          12880000
                                                                        12890000
            CALL 'AB05C902'  USING WS-B902-AREA.                        12900000
                                                                        12910000
            DISPLAY 'CDE-ERROR-ACCT   = ' B902-CDE-ERROR-ACCT(1).       12920000
            DISPLAY '----------------'.                                 12930000
                                                                        12940000
            EVALUATE B902-CDE-ERROR-ACCT(1)                             12950000
               WHEN SPACES                                              12960000
                  CONTINUE                                              12970000
               WHEN OTHER                                               12980000
                  PERFORM 6500-PRINT-L41PK-REPORT     THRU 6500-EXIT    12990000
            END-EVALUATE.                                               13000000
                                                                        13010000
       1055-EXIT.                                                       13020000
            EXIT.                                                       13030000
                                                                        13040000
                                                                        13050000
      ******************************************************************13060000
       1057-COMP-TRANS-AMT.                                             13070000
      ******************************************************************13080000
            IF K413-AMT-LOAN = ZEROS                                    13090000
               MOVE     ZEROES            TO  WS-EM-MORT-SF             13100000
               MOVE     ZEROES            TO  WS-EM-DUP-DOA             13110000
            ELSE                                                        13120000
               IF F315-NUM-ADHOC-SF = SPACES                            13130000
                  MOVE     K413-AMT-MORT-STAMP-FEE   TO  WS-EM-MORT-SF  13140000
                  SUBTRACT DUP-DOA-AMT             FROM  WS-EM-MORT-SF  13150000
                  MOVE     DUP-DOA-AMT               TO  WS-EM-DUP-DOA  13160000
               ELSE                                                     13170000
                  MOVE     F315-AMT-MORT-SF          TO  WS-EM-MORT-SF  13180000
                  SUBTRACT DUP-DOA-AMT             FROM  WS-EM-MORT-SF  13190000
                  MOVE     F315-AMT-MORT-SF-DUP      TO  WS-EM-DUP-DOA  13200000
               END-IF                                                   13210000
            END-IF.                                                     13220000
                                                                        13230000
            IF F315-NUM-ADHOC-SF = SPACES                               13240000
               IF K413-AMT-LEASE-STAMP       = ZEROES AND               13250000
                  K413-AMT-PREMIUM-STAMP-FEE = ZEROES                   13260000
                  INITIALIZE   WS-EM-LEASE-STAMP WS-EM-DUP-SA           13270000
               ELSE                                                     13280000
                  IF K413-CDE-SA-TP = 'Y'                               13290000
                     MOVE  WS-DEF-DUP-LEASE  TO  WS-EM-DUP-SA           13300000
                     COMPUTE WS-EM-LEASE-STAMP =                        13310000
                                           K413-AMT-PREMIUM-STAMP-FEE + 13320000
                                           K413-AMT-LEASE-STAMP -       13330000
                                           WS-DEF-DUP-LEASE             13340000
                  ELSE                                                  13350000
                     COMPUTE WS-EM-LEASE-STAMP =                        13360000
                                           K413-AMT-PREMIUM-STAMP-FEE   13370000
                  END-IF                                                13380000
               END-IF                                                   13390000
            ELSE                                                        13400000
               IF F315-AMT-LEASE-FEE      NOT =  ZEROES                 13410000
               OR F315-AMT-SUPP-AGRM-SF   NOT =  ZEROES                 13420000
                  MOVE F315-AMT-LEASE-FEE-DUP TO   WS-EM-DUP-SA         13430000
                  COMPUTE WS-EM-LEASE-STAMP = F315-AMT-SUPP-AGRM-SF +   13440000
                                              F315-AMT-LEASE-FEE        13450000
               ELSE                                                     13460000
                  INITIALIZE   WS-EM-DUP-SA   WS-EM-LEASE-STAMP         13470000
               END-IF                                                   13480000
            END-IF.                                                     13490000
                                                                        13500000
            DISPLAY 'NUM-REGN            = ' K413-NUM-REGN.             13510000
            DISPLAY 'WS-EM-MORT-SF       = ' WS-EM-MORT-SF.             13520000
            DISPLAY 'WS-EM-LEASE-STAMP   = ' WS-EM-LEASE-STAMP.         13530000
            DISPLAY 'PREMIUM-STAMP-FEE   = ' K413-AMT-PREMIUM-STAMP-FEE.13540000
            DISPLAY 'K413-AMT-LEASE-STAMP= ' K413-AMT-LEASE-STAMP.      13550000
                                                                        13560000
            COMPUTE WS-AMT-EARMARK = (WS-EM-MORT-SF + WS-EM-DUP-DOA +   13570000
                                     WS-EM-LEASE-STAMP + WS-EM-DUP-SA). 13580000
            DISPLAY 'WS-AMT-EARMARK     = ' WS-AMT-EARMARK.             13590000
                                                                        13600000
       1057-EXIT.                                                       13610000
           EXIT.                                                        13620000
                                                                        13630000
                                                                        13640000
      ******************************************************************13650000
       1060-PRINT-RECORD.                                               13660000
      ******************************************************************13670000
            IF  WS-SCH-FND = 'Y'                                        13680000
                PERFORM 2150-HANDLE-SER  THRU  2150-EXIT                13690000
                GO  TO   1060-EXIT                                      13700000
            END-IF.                                                     13710000
                                                                        13720000
            IF F315-CDE-SALES-TYPE = '01' OR '2B' OR '02' OR            13730000
                                     '03' OR '3A'                       13740000
               PERFORM 2100-HANDLE-SALES-TYPE-TP        THRU 2100-EXIT  13750000
            ELSE                                                        13760000
               IF  F315-CDE-SALES-TYPE = '10' OR '13' OR '18' OR '19'   13770000
                   IF F315-CDE-SA-TP-TAG = ' '                          13780000
                      PERFORM 2300-HANDLE-SALES-TYPE-10 THRU 2300-EXIT  13790000
                   ELSE                                                 13800000
                      IF  F315-CDE-SA-TP-TAG = 'Y'                      13810000
                          PERFORM  2100-HANDLE-SALES-TYPE-TP            13820000
                             THRU  2100-EXIT                            13830000
                      END-IF                                            13840000
                   END-IF                                               13850000
               END-IF                                                   13860000
            END-IF.                                                     13870000
                                                                        13880000
       1060-EXIT.                                                       13890000
            EXIT.                                                       13900000
                                                                        13910000
                                                                        13920000
      ******************************************************************13930000
       1100-READ-BP13F315.                                              13940000
      ******************************************************************13950000
            READ BP13F315                                               13960000
              AT END                                                    13970000
                 MOVE    'Y'  TO WS-EOF                                 13980000
                 PERFORM 4200-PRINT-LAST-LINES THRU 4200-EXIT           13990000
                 GO TO   1100-EXIT.                                     14000000
                                                                        14010000
            IF F315-CDE-TRANS = 'ST'                                    14020000
               ADD  1                 TO  WS-BP13F315-READ-CNT          14030000
      *        MOVE F315-REGN-NO      TO  K413-KEY-FLD.                 14040000
               MOVE F315-REGN-NO      TO  K413-NUM-REGN                 14050000
               MOVE '1'               TO  K413-SEQ-NUMBER               14060000
                                                                        14070000
            MOVE    F315-SCH          TO  WS-SCH.                       14080000
            MOVE    F315-ACC          TO  WS-F315-ACC-CHK.              14090000
            MOVE    WS-F315-ACC       TO  WS-ACC.                       14100000
            MOVE    WS-F315-CHK       TO  WS-CHK.                       14110000
            MOVE    F315-LESSEE-CODE  TO  WS-LESCDE.                    14120000
            MOVE    HYPHEN            TO  WS-SCH-SEP1.                  14130000
            MOVE    HYPHEN            TO  WS-SCH-SEP2.                  14140000
            MOVE    HYPHEN            TO  WS-SCH-SEP3.                  14150000
            MOVE    F315-NUM-LEVEL    TO  WS-NUM-LEVEL.                 14160000
            MOVE    F315-NUM-MAIN     TO  WS-NUM-MAIN.                  14170000
                                                                        14180000
            IF F315-CDE-SA-TP-TAG  =  LOW-VALUE                         14190000
               MOVE SPACE             TO  F315-CDE-SA-TP-TAG            14200000
            END-IF.                                                     14210000
                                                                        14220000
       1100-EXIT.                                                       14230000
            EXIT.                                                       14240000
                                                                        14250000
                                                                        14260000
      ******************************************************************14270000
       1400-READ-K413.                                                  14280000
      ******************************************************************14290000
      *---------------------------------------------------------------* 14300000
      *     USE F315-REGN-NO TO ACCESS BP13K413 (GET DATE, FEES ETC)  * 14310000
      *---------------------------------------------------------------* 14320000
            MOVE F315-REGN-NO           TO K413-NUM-REGN.               14330000
            MOVE '1'                    TO K413-SEQ-NUMBER.             14340000
                                                                        14350000
            READ BP13K413.                                              14360000
                                                                        14370000
            IF WS-K413-STATUS = 00                                      14380000
               IF    K413-CDE-RELEASE-PAYMENT NOT = 'Y'                 14390000
                     DISPLAY ' REGN ' K413-KEY-FLD                      14400000
                     DISPLAY ' RELEASE TAG ' K413-CDE-RELEASE-PAYMENT   14410000
               END-IF                                                   14420000
               IF     F315-NUM-ADHOC-SF = SPACES                        14430000
                      IF K413-DTE-SO-EXECUTION <= '20110218'            14440000
                         IF K413-NUM-SF-DISC = 'N'                      14450000
                            MOVE 2.00     TO DUP-DOA-AMT                14460000
                                             DUP-SA-AMT                 14470000
                                             WS-DEF-DUP-LEASE           14480000
                         ELSE                                           14490000
                            MOVE 1.40     TO DUP-DOA-AMT                14500000
                                             DUP-SA-AMT                 14510000
                                             WS-DEF-DUP-LEASE           14520000
                         END-IF                                         14530000
                      ELSE                                              14540000
                         MOVE 0.00        TO DUP-DOA-AMT                14550000
                                             DUP-SA-AMT                 14560000
                                             WS-DEF-DUP-LEASE           14570000
                      END-IF                                            14580000
                      MOVE  K413-AMT-LEASE-STAMP       TO   WS-LEASE-SF 14590000
                      MOVE  K413-AMT-MORT-STAMP-FEE    TO   WS-MORT-SF  14600000
                      MOVE  K413-AMT-PREMIUM-STAMP-FEE TO   WS-SUP-SF   14610000
               ELSE                                                     14620000
                      MOVE  F315-AMT-LEASE-FEE         TO   WS-LEASE-SF 14630000
                      MOVE  F315-AMT-MORT-SF           TO   WS-MORT-SF  14640000
                      MOVE  F315-AMT-SUPP-AGRM-SF      TO   WS-SUP-SF   14650000
               END-IF                                                   14660000
                                                                        14670000
               MOVE    K413-DTE-SO-EXECUTION      TO   WS-SO-DATE       14680000
               COMPUTE WS-ANNUAL-RENT = (K413-AMT-SC-CC1-NET * 12) + 1  14690000
            ELSE                                                        14700000
            IF WS-K413-STATUS = 23                                      14710000
               MOVE    ZEROES                     TO   WS-LEASE-SF      14720000
               MOVE    ZEROES                     TO   WS-MORT-SF       14730000
               MOVE    ZEROES                     TO   WS-SUP-SF        14740000
               MOVE    ZEROES                     TO   WS-DUP-DOA       14750000
               MOVE    ZEROES                     TO   WS-DUP-SA        14760000
               MOVE    SPACES                     TO   WS-SO-DATE       14770000
               MOVE    WS-K413-STATUS             TO   WS-CUR-STATUS    14780000
               MOVE    READ-K413                  TO   WS-CUR-PROC      14790000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT        14800000
               PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT        14810000
            ELSE                                                        14820000
               MOVE    READ-K413                  TO WS-CUR-PROC        14830000
               MOVE    WS-K413-STATUS             TO WS-CUR-STATUS      14840000
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT        14850000
               PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT.       14860000
                                                                        14870000
       1400-EXIT.                                                       14880000
            EXIT.                                                       14890000
                                                                        14900000
                                                                        14910000
      ******************************************************************14920000
       1800-READ-B05K006.                                               14930000
      ******************************************************************14940000
            MOVE  ' '                TO L41P-TAG.                       14950000
            MOVE  SPACES             TO K006-HDB-REF-SF.                14960000
            MOVE  K413-NUM-SCH-ACC   TO K006-HDB-REF-SF.                14970000
                                                                        14980000
            READ  B05K006.                                              14990000
                                                                        15000000
            IF WS-K006-STATUS = 00                                      15010000
               IF F315-NUM-ADHOC-SF = SPACES                            15020000
                  PERFORM 1810-CHECK-ADHOC-BLANK-CASES THRU 1810-EXIT   15030000
               ELSE                                                     15040000
                  PERFORM 1820-CHECK-ADHOC-Y-CASES     THRU 1820-EXIT   15050000
               END-IF                                                   15060000
            END-IF.                                                     15070000
                                                                        15080000
       1800-EXIT.                                                       15090000
            EXIT.                                                       15100000
                                                                        15110000
                                                                        15120000
      ******************************************************************15130000
       1810-CHECK-ADHOC-BLANK-CASES.                                    15140000
      ******************************************************************15150000
           IF (K006-BALANCES > K413-AMT-LEASE-STAMP) OR                 15160000
              (K006-BALANCES = K413-AMT-LEASE-STAMP)                    15170000
               NEXT SENTENCE                                            15180000
           ELSE                                                         15190000
               MOVE '*'          TO L41P-TAG.                           15200000
                                                                        15210000
       1810-EXIT.                                                       15220000
            EXIT.                                                       15230000
                                                                        15240000
                                                                        15250000
      ******************************************************************15260000
       1820-CHECK-ADHOC-Y-CASES.                                        15270000
      ******************************************************************15280000
           IF (K006-BALANCES > F315-AMT-LEASE-FEE) OR                   15290000
              (K006-BALANCES = F315-AMT-LEASE-FEE)                      15300000
               NEXT SENTENCE                                            15310000
           ELSE                                                         15320000
               MOVE '*'          TO L41P-TAG.                           15330000
                                                                        15340000
       1820-EXIT.                                                       15350000
            EXIT.                                                       15360000
                                                                        15370000
                                                                        15380000
      ******************************************************************15390000
       2000-DISPLAY-ERROR-MESSAGE.                                      15400000
      ******************************************************************15410000
            DISPLAY ' *************   ERROR MESSAGE   *************'.   15420000
            DISPLAY 'ERROR ENCOUNTERED WHEN ' WS-CUR-PROC.              15430000
            DISPLAY 'STATUS CODE = ' WS-CUR-STATUS.                     15440000
                                                                        15450000
       2000-EXIT.                                                       15460000
            EXIT.                                                       15470000
                                                                        15480000
                                                                        15490000
      ******************************************************************15500000
       2100-HANDLE-SALES-TYPE-TP.                                       15510000
      ******************************************************************15520000
      *--------------------------------*                                15530000
      *     PRINT  L41PX-RECORD (DOA)  *                                15540000
      *--------------------------------*                                15550000
            ADD    1                      TO  WS-CNT-DETAILS.           15560000
                                                                        15570000
      *     -----------------------                                     15580000
      *     SET UP L41PX-REC-DETAIL                                     15590000
      *     -----------------------                                     15600000
            MOVE   WS-CNT-DETAILS         TO  L41P-SERIAL-NO.           15610000
            MOVE   WS-SCH-ACC             TO  L41P-SCH-ACC.             15620000
            MOVE   K413-KEY-FLD           TO  L41P-REGN-NO.             15630000
            MOVE   F315-NUM-BLK           TO  L41P-BLKNO.               15640000
            MOVE   F315-NME-STREET        TO  L41P-STREET.              15650000
            MOVE   K413-DTE-SO-EXECUTION  TO  WS-SALE-DATE.             15660000
            MOVE   WS-SALE-CC             TO  L41P-SALE-CC.             15670000
            MOVE   WS-SALE-YY             TO  L41P-SALE-YY.             15680000
            MOVE   WS-SALE-MM             TO  L41P-SALE-MM.             15690000
            MOVE   WS-SALE-DD             TO  L41P-SALE-DD.             15700000
            MOVE   '/'                    TO  L41P-DASH1  L41P-DASH2.   15710000
            MOVE   WS-FLATNO              TO  L41P-FLATNO.              15720000
                                                                        15730000
            IF K413-AMT-LOAN = ZEROS                                    15740000
               MOVE     ZEROES            TO  L41P-MORT-SF              15750000
               MOVE     ZEROES            TO  L41P-TOTAL-MORT-SF        15760000
               MOVE     ZEROES            TO  L41P-DUP-DOA              15770000
               MOVE     ZEROES            TO  WS-MORT-SF                15780000
               MOVE     ZEROES            TO  WS-DUP-DOA                15790000
            ELSE                                                        15800000
               IF F315-NUM-ADHOC-SF = SPACES                            15810000
                  SUBTRACT DUP-DOA-AMT    FROM  WS-MORT-SF              15820000
                  MOVE     WS-MORT-SF     TO    L41P-MORT-SF            15830000
                  MOVE     DUP-DOA-AMT    TO    WS-DUP-DOA              15840000
                  MOVE     DUP-DOA-AMT    TO    L41P-DUP-DOA            15850000
               ELSE                                                     15860000
                  MOVE     WS-MORT-SF           TO L41P-MORT-SF         15870000
                  MOVE     F315-AMT-MORT-SF-DUP TO WS-DUP-DOA           15880000
                  MOVE     F315-AMT-MORT-SF-DUP TO L41P-DUP-DOA         15890000
               END-IF                                                   15900000
            END-IF.                                                     15910000
                                                                        15920000
            IF F315-NUM-ADHOC-SF = SPACES                               15930000
             IF K413-AMT-LEASE-STAMP    NOT =  ZEROES                   15940000
                PERFORM  1800-READ-B05K006 THRU  1800-EXIT              15950000
                MOVE     WS-DEF-DUP-LEASE  TO    L41P-DUP-SA            15960000
                MOVE     WS-DEF-DUP-LEASE  TO    WS-DUP-SA              15970000
                                                                        15980000
                COMPUTE WS-LEASE-STAMP = K413-AMT-PREMIUM-STAMP-FEE +   15990000
                                         K413-AMT-LEASE-STAMP -         16000000
                                         WS-DEF-DUP-LEASE               16010000
                MOVE    WS-LEASE-STAMP   TO  L41P-SUP-LEASE-STAMP       16020000
             ELSE                                                       16030000
                INITIALIZE   WS-DUP-SA       WS-LEASE-STAMP             16040000
                MOVE    WS-DUP-SA        TO  L41P-DUP-SA                16050000
                MOVE    WS-LEASE-STAMP   TO  L41P-SUP-LEASE-STAMP       16060000
             END-IF                                                     16070000
            ELSE                                                        16080000
             IF F315-AMT-LEASE-FEE      NOT =  ZEROES                   16090000
                PERFORM  1800-READ-B05K006      THRU 1800-EXIT          16100000
                MOVE     F315-AMT-LEASE-FEE-DUP TO   L41P-DUP-SA        16110000
                MOVE     F315-AMT-LEASE-FEE-DUP TO   WS-DUP-SA          16120000
                                                                        16130000
                COMPUTE WS-LEASE-STAMP = F315-AMT-SUPP-AGRM-SF +        16140000
                                         F315-AMT-LEASE-FEE             16150000
                MOVE    WS-LEASE-STAMP   TO  L41P-SUP-LEASE-STAMP       16160000
             ELSE                                                       16170000
                INITIALIZE   WS-DUP-SA       WS-LEASE-STAMP             16180000
                MOVE    WS-DUP-SA        TO  L41P-DUP-SA                16190000
                MOVE    WS-LEASE-STAMP   TO  L41P-SUP-LEASE-STAMP       16200000
             END-IF                                                     16210000
            END-IF.                                                     16220000
                                                                        16230000
            COMPUTE WS-TEMP-TOTAL = (WS-MORT-SF     + WS-DUP-DOA +      16240000
                                     WS-LEASE-STAMP + WS-DUP-SA ).      16250000
                                                                        16260000
            MOVE    WS-TEMP-TOTAL         TO  L41P-DETL-AMT-TOTAL.      16270000
                                                                        16280000
            MOVE    F315-SCH-ACC          TO  WS-SCH-ACCT-NO.           16290000
            MOVE    WS-TEMP-TOTAL         TO  WS-AMT-TRANS.             16300000
            MOVE   'NS PAYMENT FOR LEASE/MORTGAGE STAMP FEES'           16310000
                                          TO  WS-TXT-INFO.              16320000
            PERFORM 5000-WRITE-TRANS-DETAIL-F225 THRU  5000-DETAIL-EXIT.16330000
                                                                        16340000
      *---------------------------------------------------------------* 16350000
            MOVE    WS-REPORT-ID-SW       TO  WS-PREV-REPORT-ID.        16360000
            PERFORM 2120-CLASSIFY-SALES-TYPE-TP THRU 2120-EXIT.         16370000
      *---------------------------------------------------------------* 16380000
                                                                        16390000
            IF (WS-CNT-DETAILS = MAX-DETLS-PER-PAGE)                    16400000
                PERFORM 5000-WRITE-TRAILER-F225  THRU 5000-TRAILER-EXIT 16410000
                MOVE    ZEROES                   TO   WS-CNT-DETAILS    16420000
                MOVE    'Y'                      TO   WS-NEW-BATCH      16430000
                                                      WS-NEW-VOUCHER    16440000
                                                      WS-NEW-HEADER     16450000
            END-IF.                                                     16460000
                                                                        16470000
       2100-EXIT.                                                       16480000
            EXIT.                                                       16490000
                                                                        16500000
                                                                        16510000
      ******************************************************************16520000
       2150-HANDLE-SER.                                                 16530000
      ******************************************************************16540000
      *--------------------------------*                                16550000
      *     PRINT  L41PJ-RECORD (DOA)  *                                16560000
      *--------------------------------*                                16570000
            ADD    1                      TO  WS-CNT-DETAILS.           16580000
                                                                        16590000
      *     -----------------------                                     16600000
      *     SET UP L41PJ-REC-DETAIL                                     16610000
      *     -----------------------                                     16620000
            MOVE   WS-CNT-DETAILS         TO  L41P-SERIAL-NO.           16630000
            MOVE   WS-SCH-ACC             TO  L41P-SCH-ACC.             16640000
            MOVE   K413-KEY-FLD           TO  L41P-REGN-NO.             16650000
            MOVE   F315-NUM-BLK           TO  L41P-BLKNO.               16660000
            MOVE   F315-NME-STREET        TO  L41P-STREET.              16670000
            MOVE   K413-DTE-SO-EXECUTION  TO  WS-SALE-DATE.             16680000
            MOVE   WS-SALE-CC             TO  L41P-SALE-CC.             16690000
            MOVE   WS-SALE-YY             TO  L41P-SALE-YY.             16700000
            MOVE   WS-SALE-MM             TO  L41P-SALE-MM.             16710000
            MOVE   WS-SALE-DD             TO  L41P-SALE-DD.             16720000
            MOVE   '/'                    TO  L41P-DASH1  L41P-DASH2.   16730000
            MOVE   WS-FLATNO              TO  L41P-FLATNO.              16740000
                                                                        16750000
            IF K413-AMT-LOAN = ZEROS                                    16760000
               MOVE     ZEROES            TO  L41P-MORT-SF              16770000
               MOVE     ZEROES            TO  L41P-TOTAL-MORT-SF        16780000
               MOVE     ZEROES            TO  L41P-DUP-DOA              16790000
               MOVE     ZEROES            TO  WS-MORT-SF                16800000
               MOVE     ZEROES            TO  WS-DUP-DOA                16810000
            ELSE                                                        16820000
               IF F315-NUM-ADHOC-SF = SPACES                            16830000
                  SUBTRACT DUP-DOA-AMT    FROM  WS-MORT-SF              16840000
                  MOVE     WS-MORT-SF     TO    L41P-MORT-SF            16850000
                  MOVE     DUP-DOA-AMT    TO    WS-DUP-DOA              16860000
                  MOVE     DUP-DOA-AMT    TO    L41P-DUP-DOA            16870000
               ELSE                                                     16880000
                  MOVE     WS-MORT-SF           TO L41P-MORT-SF         16890000
                  MOVE     F315-AMT-MORT-SF-DUP TO WS-DUP-DOA           16900000
                  MOVE     F315-AMT-MORT-SF-DUP TO L41P-DUP-DOA         16910000
               END-IF                                                   16920000
            END-IF.                                                     16930000
                                                                        16940000
            IF F315-NUM-ADHOC-SF = SPACES                               16950000
             IF K413-AMT-LEASE-STAMP    NOT =  ZEROES                   16960000
                PERFORM  1800-READ-B05K006 THRU 1800-EXIT               16970000
                MOVE     WS-DEF-DUP-LEASE  TO  L41P-DUP-SA              16980000
                MOVE     WS-DEF-DUP-LEASE  TO  WS-DUP-SA                16990000
                                                                        17000000
                COMPUTE WS-LEASE-STAMP = K413-AMT-PREMIUM-STAMP-FEE +   17010000
                                         K413-AMT-LEASE-STAMP -         17020000
                                         WS-DEF-DUP-LEASE               17030000
                MOVE    WS-LEASE-STAMP   TO  L41P-SUP-LEASE-STAMP       17040000
             ELSE                                                       17050000
                INITIALIZE   WS-DUP-SA       WS-LEASE-STAMP             17060000
                MOVE    WS-DUP-SA        TO  L41P-DUP-SA                17070000
                MOVE    WS-LEASE-STAMP   TO  L41P-SUP-LEASE-STAMP       17080000
             END-IF                                                     17090000
            ELSE                                                        17100000
             IF F315-AMT-LEASE-FEE      NOT =  ZEROES                   17110000
                PERFORM  1800-READ-B05K006 THRU 1800-EXIT               17120000
                MOVE     F315-AMT-LEASE-FEE-DUP TO L41P-DUP-SA          17130000
                MOVE     F315-AMT-LEASE-FEE-DUP TO WS-DUP-SA            17140000
                                                                        17150000
                COMPUTE WS-LEASE-STAMP = F315-AMT-SUPP-AGRM-SF +        17160000
                                         F315-AMT-LEASE-FEE             17170000
                MOVE    WS-LEASE-STAMP   TO  L41P-SUP-LEASE-STAMP       17180000
             ELSE                                                       17190000
                INITIALIZE   WS-DUP-SA       WS-LEASE-STAMP             17200000
                MOVE    WS-DUP-SA        TO  L41P-DUP-SA                17210000
                MOVE    WS-LEASE-STAMP   TO  L41P-SUP-LEASE-STAMP       17220000
             END-IF                                                     17230000
            END-IF.                                                     17240000
                                                                        17250000
            COMPUTE WS-TEMP-TOTAL = (WS-MORT-SF     + WS-DUP-DOA +      17260000
                                     WS-LEASE-STAMP + WS-DUP-SA ).      17270000
                                                                        17280000
            MOVE    WS-TEMP-TOTAL         TO  L41P-DETL-AMT-TOTAL.      17290000
                                                                        17300000
            MOVE    F315-SCH-ACC          TO  WS-SCH-ACCT-NO.           17310000
            MOVE    WS-TEMP-TOTAL         TO  WS-AMT-TRANS.             17320000
            ADD     1                     TO  WS-L41PJ-PRINT-CNT        17330000
            ADD     WS-MORT-SF            TO  WS-L41PJ-MORT-CNT         17340000
            ADD     WS-DUP-SA             TO  WS-L41PJ-DUP-SA-CNT       17350000
            ADD     WS-DUP-DOA            TO  WS-L41PJ-DUP-DOA-CNT      17360000
            ADD     WS-LEASE-STAMP        TO  WS-L41PJ-LEASE-CNT        17370000
            ADD     WS-TEMP-TOTAL         TO  WS-L41PJ-IND-TOT-CNT      17380000
            MOVE    WS-L41PJ-IND-TOT-CNT  TO  WS-AMT-TOTAL              17390000
            WRITE   L41PJ-PRINT-REC       FROM  L41P-REC-DETAIL AFTER 1.17400000
            MOVE    'J'                   TO  WS-PREV-REPORT-ID.        17410000
            MOVE   'NS PAYMENT FOR LEASE/MORTGAGE STAMP FEES'           17420000
                                          TO  WS-TXT-INFO.              17430000
            PERFORM 5000-WRITE-TRANS-DETAIL-F225 THRU  5000-DETAIL-EXIT.17440000
                                                                        17450000
            IF (WS-CNT-DETAILS = MAX-DETLS-PER-PAGE)                    17460000
                PERFORM 5000-WRITE-TRAILER-F225  THRU 5000-TRAILER-EXIT 17470000
                MOVE    ZEROES                   TO   WS-CNT-DETAILS    17480000
                MOVE    'Y'                      TO   WS-NEW-BATCH      17490000
                                                      WS-NEW-VOUCHER    17500000
                                                      WS-NEW-HEADER     17510000
            END-IF.                                                     17520000
                                                                        17530000
       2150-EXIT.                                                       17540000
            EXIT.                                                       17550000
                                                                        17560000
                                                                        17570000
      ******************************************************************17580000
       2120-CLASSIFY-SALES-TYPE-TP.                                     17590000
      ******************************************************************17600000
            EVALUATE TRUE                                               17610000
            WHEN     REPORT-L41PD                                       17620000
                  ADD    1                TO  WS-L41PD-PRINT-CNT        17630000
                  ADD   WS-MORT-SF        TO  WS-L41PD-MORT-CNT         17640000
                  ADD   WS-DUP-SA         TO  WS-L41PD-DUP-SA-CNT       17650000
                  ADD   WS-DUP-DOA        TO  WS-L41PD-DUP-DOA-CNT      17660000
                  ADD   WS-LEASE-STAMP    TO  WS-L41PD-LEASE-CNT        17670000
                  ADD   WS-TEMP-TOTAL     TO  WS-L41PD-IND-TOT-CNT      17680000
                  MOVE  WS-L41PD-IND-TOT-CNT TO   WS-AMT-TOTAL          17690000
                  WRITE L41PD-PRINT-REC  FROM L41P-REC-DETAIL AFTER 1   17700000
            WHEN     REPORT-L41PE                                       17710000
                  ADD    1                TO  WS-L41PE-PRINT-CNT        17720000
                  ADD   WS-MORT-SF        TO  WS-L41PE-MORT-CNT         17730000
                  ADD   WS-DUP-SA         TO  WS-L41PE-DUP-SA-CNT       17740000
                  ADD   WS-DUP-DOA        TO  WS-L41PE-DUP-DOA-CNT      17750000
                  ADD   WS-LEASE-STAMP    TO  WS-L41PE-LEASE-CNT        17760000
                  ADD   WS-TEMP-TOTAL     TO  WS-L41PE-IND-TOT-CNT      17770000
                  MOVE  WS-L41PE-IND-TOT-CNT TO   WS-AMT-TOTAL          17780000
                  WRITE L41PE-PRINT-REC  FROM L41P-REC-DETAIL AFTER 1   17790000
            WHEN     REPORT-L41PG                                       17800000
                  ADD    1                TO  WS-L41PG-PRINT-CNT        17810000
                  ADD   WS-MORT-SF        TO  WS-L41PG-MORT-CNT         17820000
                  ADD   WS-DUP-SA         TO  WS-L41PG-DUP-SA-CNT       17830000
                  ADD   WS-DUP-DOA        TO  WS-L41PG-DUP-DOA-CNT      17840000
                  ADD   WS-LEASE-STAMP    TO  WS-L41PG-LEASE-CNT        17850000
                  ADD   WS-TEMP-TOTAL     TO  WS-L41PG-IND-TOT-CNT      17860000
                  MOVE  WS-L41PG-IND-TOT-CNT TO   WS-AMT-TOTAL          17870000
                  WRITE L41PG-PRINT-REC  FROM L41P-REC-DETAIL AFTER 1   17880000
            WHEN     REPORT-L41PH                                       17890000
                  ADD    1                TO  WS-L41PH-PRINT-CNT        17900000
                  ADD   WS-MORT-SF        TO  WS-L41PH-MORT-CNT         17910000
                  ADD   WS-DUP-SA         TO  WS-L41PH-DUP-SA-CNT       17920000
                  ADD   WS-DUP-DOA        TO  WS-L41PH-DUP-DOA-CNT      17930000
                  ADD   WS-LEASE-STAMP    TO  WS-L41PH-LEASE-CNT        17940000
                  ADD   WS-TEMP-TOTAL     TO  WS-L41PH-IND-TOT-CNT      17950000
                  MOVE  WS-L41PH-IND-TOT-CNT TO   WS-AMT-TOTAL          17960000
                  WRITE L41PH-PRINT-REC  FROM L41P-REC-DETAIL AFTER 1   17970000
            WHEN     REPORT-L41PI                                       17980000
                  ADD    1                TO  WS-L41PI-PRINT-CNT        17990000
                  ADD   WS-MORT-SF        TO  WS-L41PI-MORT-CNT         18000000
                  ADD   WS-DUP-SA         TO  WS-L41PI-DUP-SA-CNT       18010000
                  ADD   WS-DUP-DOA        TO  WS-L41PI-DUP-DOA-CNT      18020000
                  ADD   WS-LEASE-STAMP    TO  WS-L41PI-LEASE-CNT        18030000
                  ADD   WS-TEMP-TOTAL     TO  WS-L41PI-IND-TOT-CNT      18040000
                  MOVE  WS-L41PI-IND-TOT-CNT TO   WS-AMT-TOTAL          18050000
                  WRITE L41PI-PRINT-REC  FROM L41P-REC-DETAIL AFTER 1   18060000
            END-EVALUATE.                                               18070000
                                                                        18080000
       2120-EXIT.                                                       18090000
            EXIT.                                                       18100000
                                                                        18110000
                                                                        18120000
      ******************************************************************18130000
       2300-HANDLE-SALES-TYPE-10.                                       18140000
      ******************************************************************18150000
      *--------------------------------*                                18160000
      *     PRINT  L41PA-RECORD (DOA)  *                                18170000
      *--------------------------------*                                18180000
                                                                        18190000
            ADD    1                      TO  WS-L41PA-PRINT-CNT.       18200000
            ADD    1                      TO  WS-CNT-DETAILS.           18210000
                                                                        18220000
      *     -----------------------                                     18230000
      *     SET UP L41PA-REC-DETAIL                                     18240000
      *     -----------------------                                     18250000
            MOVE   WS-CNT-DETAILS         TO  L41P-SERIAL-NO.           18260000
            MOVE   WS-SCH-ACC             TO  L41P-SCH-ACC.             18270000
            MOVE   K413-KEY-FLD           TO  L41P-REGN-NO.             18280000
            MOVE   F315-NUM-BLK           TO  L41P-BLKNO.               18290000
            MOVE   F315-NME-STREET        TO  L41P-STREET.              18300000
            MOVE   K413-DTE-SO-EXECUTION  TO  WS-SALE-DATE.             18310000
            MOVE   WS-SALE-CC             TO  L41P-SALE-CC.             18320000
            MOVE   WS-SALE-YY             TO  L41P-SALE-YY.             18330000
            MOVE   WS-SALE-MM             TO  L41P-SALE-MM.             18340000
            MOVE   WS-SALE-DD             TO  L41P-SALE-DD.             18350000
            MOVE   '/'                    TO  L41P-DASH1  L41P-DASH2.   18360000
            MOVE   WS-FLATNO              TO  L41P-FLATNO.              18370000
                                                                        18380000
            IF K413-AMT-LOAN = ZEROS                                    18390000
               MOVE     ZEROES            TO  L41P-MORT-SF              18400000
               MOVE     ZEROES            TO  L41P-TOTAL-MORT-SF        18410000
               MOVE     ZEROES            TO  L41P-DUP-DOA              18420000
               MOVE     ZEROES            TO  WS-MORT-SF                18430000
               MOVE     ZEROES            TO  WS-DUP-DOA                18440000
            ELSE                                                        18450000
               IF F315-NUM-ADHOC-SF = SPACES                            18460000
                  SUBTRACT DUP-DOA-AMT     FROM  WS-MORT-SF             18470000
                  MOVE     WS-MORT-SF        TO  L41P-MORT-SF           18480000
                  ADD      WS-MORT-SF        TO  WS-L41PA-MORT-CNT      18490000
                                                                        18500000
                  MOVE     DUP-DOA-AMT       TO  WS-DUP-DOA             18510000
                  MOVE     DUP-DOA-AMT       TO  L41P-DUP-DOA           18520000
                  ADD      DUP-DOA-AMT       TO  WS-L41PA-DUP-DOA-CNT   18530000
               ELSE                                                     18540000
                  MOVE    WS-MORT-SF           TO  L41P-MORT-SF         18550000
                  ADD     WS-MORT-SF           TO  WS-L41PA-MORT-CNT    18560000
                                                                        18570000
                  MOVE    F315-AMT-MORT-SF-DUP TO  WS-DUP-DOA           18580000
                  MOVE    F315-AMT-MORT-SF-DUP TO  L41P-DUP-DOA         18590000
                  ADD     F315-AMT-MORT-SF-DUP TO  WS-L41PA-DUP-DOA-CNT 18600000
               END-IF                                                   18610000
            END-IF.                                                     18620000
                                                                        18630000
            IF F315-NUM-ADHOC-SF = SPACES                               18640000
             IF K413-AMT-PREMIUM-STAMP-FEE =   ZEROS                    18650000
                MOVE     ZEROS           TO    L41P-SUP-LEASE-STAMP     18660000
                MOVE     ZEROS           TO    L41P-DUP-SA              18670000
                MOVE     ZEROS           TO    WS-DUP-SA                18680000
             ELSE                                                       18690000
      * TO CREATE A RECORD FOR PRINTING OF LIST FOR STAMPING OF         18700000
      * SUPPLEMENTARY AGREEMENT.                                        18710000
                PERFORM 5100-WRITE-BP13F316   THRU 5100-EXIT            18720000
                SUBTRACT DUP-SA-AMT      FROM  WS-SUP-SF                18730000
                MOVE     WS-SUP-SF       TO    L41P-SUP-LEASE-STAMP     18740000
                ADD      WS-SUP-SF       TO    WS-L41PA-SUP-CNT         18750000
                                                                        18760000
                MOVE     DUP-DOA-AMT     TO    WS-DUP-SA                18770000
                MOVE     DUP-DOA-AMT     TO    L41P-DUP-SA              18780000
                ADD      DUP-DOA-AMT     TO    WS-L41PA-DUP-SA-CNT      18790000
             END-IF                                                     18800000
            ELSE                                                        18810000
             IF F315-AMT-SUPP-AGRM-SF =   ZEROS                         18820000
                MOVE  ZEROS             TO  L41P-SUP-LEASE-STAMP        18830000
                MOVE  ZEROS             TO  L41P-DUP-SA                 18840000
                MOVE  ZEROS             TO  WS-DUP-SA                   18850000
             ELSE                                                       18860000
      * TO CREATE A RECORD FOR PRINTING OF LIST FOR STAMPING OF         18870000
      * SUPPLEMENTARY AGREEMENT.                                        18880000
                PERFORM 5100-WRITE-BP13F316   THRU 5100-EXIT            18890000
                MOVE  WS-SUP-SF         TO  L41P-SUP-LEASE-STAMP        18900000
                ADD   WS-SUP-SF         TO  WS-L41PA-SUP-CNT            18910000
                                                                        18920000
                MOVE  F315-AMT-SUPP-AGRM-SF-DUP TO WS-DUP-SA            18930000
                MOVE  F315-AMT-SUPP-AGRM-SF-DUP TO L41P-DUP-SA          18940000
                ADD   F315-AMT-SUPP-AGRM-SF-DUP TO WS-L41PA-DUP-SA-CNT  18950000
             END-IF                                                     18960000
            END-IF.                                                     18970000
                                                                        18980000
            COMPUTE WS-TEMP-TOTAL  =  (WS-MORT-SF + WS-DUP-DOA +        18990000
                                       WS-SUP-SF  + WS-DUP-SA ).        19000000
                                                                        19010000
            MOVE    WS-TEMP-TOTAL         TO  L41P-DETL-AMT-TOTAL.      19020000
            ADD     WS-TEMP-TOTAL         TO  WS-L41PA-IND-TOT-CNT.     19030000
                                                                        19040000
      *** PRINT FINANCES COPY                                           19050000
            WRITE   L41PA-PRINT-REC     FROM  L41P-REC-DETAIL AFTER 1.  19060000
                                                                        19070000
            MOVE   'A'                    TO  WS-PREV-REPORT-ID.        19080000
                                                                        19090000
            MOVE    F315-SCH-ACC          TO  WS-SCH-ACCT-NO.           19100000
            MOVE    WS-TEMP-TOTAL         TO  WS-AMT-TRANS.             19110000
            MOVE   'NS PAYMENT FOR LEASE/MORTGAGE STAMP FEES         '  19120000
                                          TO   WS-TXT-INFO.             19130000
            PERFORM 5000-WRITE-TRANS-DETAIL-F225 THRU  5000-DETAIL-EXIT.19140000
                                                                        19150000
            IF (WS-CNT-DETAILS = MAX-DETLS-PER-PAGE)                    19160000
                MOVE    WS-L41PA-IND-TOT-CNT     TO   WS-AMT-TOTAL      19170000
                PERFORM 5000-WRITE-TRAILER-F225  THRU 5000-TRAILER-EXIT 19180000
                MOVE    ZEROES                   TO   WS-CNT-DETAILS    19190000
                MOVE    'Y'                      TO   WS-NEW-BATCH      19200000
                                                      WS-NEW-VOUCHER    19210000
                                                      WS-NEW-HEADER     19220000
            END-IF.                                                     19230000
                                                                        19240000
       2300-EXIT.                                                       19250000
            EXIT.                                                       19260000
                                                                        19270000
                                                                        19280000
      ******************************************************************19290000
       4200-PRINT-LAST-LINES.                                           19300000
      ******************************************************************19310000
            PERFORM 5000-WRITE-TRAILER-F225                             19320000
               THRU 5000-TRAILER-EXIT.                                  19330000
                                                                        19340000
       4200-EXIT.                                                       19350000
            EXIT.                                                       19360000
                                                                        19370000
                                                                        19380000
      ******************************************************************19390000
       4210-PRINT-L41PA-GRAND-TOTAL.                                    19400000
      ******************************************************************19410000
            IF WS-CNT-DETAILS = ZEROES                                  19420000
               GO TO 4210-EXIT                                          19430000
            END-IF.                                                     19440000
                                                                        19450000
            MOVE  WS-CNT-DETAILS       TO  L41P-VR-NO-HIGH.             19460000
            MOVE  WS-L41PA-MORT-CNT    TO  L41P-TOTAL-MORT-SF.          19470000
            MOVE  WS-L41PA-DUP-DOA-CNT TO  L41P-TOTAL-DUP-DOA.          19480000
            MOVE  WS-L41PA-SUP-CNT     TO  L41P-TOTAL-SUP-LEASE-SF.     19490000
            MOVE  WS-L41PA-DUP-SA-CNT  TO  L41P-TOTAL-DUP-SA.           19500000
            MOVE  WS-L41PA-IND-TOT-CNT TO  L41P-TOTAL-AMT.              19510000
                                                                        19520000
      *** PRINT FINANCES COPY                                           19530000
                                                                        19540000
            WRITE L41PA-PRINT-REC FROM PRT-L41P-DASH-LINE  AFTER 2.     19550000
            WRITE L41PA-PRINT-REC FROM PRT-L41P-TOTAL-LINE AFTER 1.     19560000
            WRITE L41PA-PRINT-REC FROM PRT-L41P-DASH-LINE  AFTER 1.     19570000
                                                                        19580000
            MOVE     WS-L41PA-IND-TOT-CNT  TO   WS-AMT.                 19590000
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.              19600000
            MOVE     WP-ITEM (1)           TO   L41P-AMT-DESC1.         19610000
            MOVE     WP-ITEM (2)           TO   L41P-AMT-DESC2.         19620000
                                                                        19630000
      *** FINANCES COPY                                                 19640000
            WRITE    L41PA-PRINT-REC       FROM PRT-L41P-FTG-1 AFTER 3. 19650000
            WRITE    L41PA-PRINT-REC       FROM PRT-L41P-FTG-2 AFTER 6. 19660000
                                                                        19670000
            MOVE     ZEROES                TO   WS-L41PA-MORT-CNT       19680000
                                                WS-L41PA-DUP-DOA-CNT    19690000
                                                WS-L41PA-SUP-CNT        19700000
                                                WS-L41PA-DUP-SA-CNT     19710000
                                                WS-L41PA-IND-TOT-CNT.   19720000
       4210-EXIT.                                                       19730000
            EXIT.                                                       19740000
                                                                        19750000
                                                                        19760000
      ******************************************************************19770000
       4240-PRINT-L41PD-GRAND-TOTAL.                                    19780000
      ******************************************************************19790000
            IF WS-CNT-DETAILS = ZEROES                                  19800000
               GO TO 4240-EXIT                                          19810000
            END-IF.                                                     19820000
                                                                        19830000
            MOVE  WS-CNT-DETAILS        TO L41P-VR-NO-HIGH.             19840000
            MOVE  WS-L41PD-MORT-CNT     TO L41P-TOTAL-MORT-SF.          19850000
            MOVE  WS-L41PD-DUP-DOA-CNT  TO L41P-TOTAL-DUP-DOA.          19860000
            MOVE  WS-L41PD-LEASE-CNT    TO L41P-TOTAL-SUP-LEASE-SF.     19870000
            MOVE  WS-L41PD-DUP-SA-CNT   TO L41P-TOTAL-DUP-SA.           19880000
            MOVE  WS-L41PD-IND-TOT-CNT  TO L41P-TOTAL-AMT.              19890000
                                                                        19900000
            WRITE L41PD-PRINT-REC  FROM PRT-L41P-DASH-LINE  AFTER 2.    19910000
            WRITE L41PD-PRINT-REC  FROM PRT-L41P-TOTAL-LINE AFTER 1.    19920000
            WRITE L41PD-PRINT-REC  FROM PRT-L41P-DASH-LINE  AFTER 1.    19930000
            MOVE     WS-L41PD-IND-TOT-CNT  TO   WS-AMT.                 19940000
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.              19950000
            MOVE     WP-ITEM (1)           TO   L41P-AMT-DESC1.         19960000
            MOVE     WP-ITEM (2)           TO   L41P-AMT-DESC2.         19970000
            WRITE    L41PD-PRINT-REC       FROM PRT-L41P-FTG-1 AFTER 3. 19980000
            WRITE    L41PD-PRINT-REC       FROM PRT-L41P-FTG-2 AFTER 6. 19990000
            MOVE     ZEROES                TO   WS-L41PD-MORT-CNT       20000000
                                                WS-L41PD-DUP-DOA-CNT    20010000
                                                WS-L41PD-LEASE-CNT      20020000
                                                WS-L41PD-DUP-SA-CNT     20030000
                                                WS-L41PD-IND-TOT-CNT.   20040000
       4240-EXIT.                                                       20050000
            EXIT.                                                       20060000
                                                                        20070000
                                                                        20080000
      ******************************************************************20090000
       4250-PRINT-L41PE-GRAND-TOTAL.                                    20100000
      ******************************************************************20110000
            IF WS-CNT-DETAILS = ZEROES                                  20120000
               GO TO 4250-EXIT                                          20130000
            END-IF.                                                     20140000
                                                                        20150000
            MOVE  WS-CNT-DETAILS        TO L41P-VR-NO-HIGH.             20160000
            MOVE  WS-L41PE-MORT-CNT     TO L41P-TOTAL-MORT-SF.          20170000
            MOVE  WS-L41PE-DUP-DOA-CNT  TO L41P-TOTAL-DUP-DOA.          20180000
            MOVE  WS-L41PE-LEASE-CNT    TO L41P-TOTAL-SUP-LEASE-SF.     20190000
            MOVE  WS-L41PE-DUP-SA-CNT   TO L41P-TOTAL-DUP-SA.           20200000
            MOVE  WS-L41PE-IND-TOT-CNT  TO L41P-TOTAL-AMT.              20210000
                                                                        20220000
            WRITE L41PE-PRINT-REC  FROM PRT-L41P-DASH-LINE  AFTER 2.    20230000
            WRITE L41PE-PRINT-REC  FROM PRT-L41P-TOTAL-LINE AFTER 1.    20240000
            WRITE L41PE-PRINT-REC  FROM PRT-L41P-DASH-LINE AFTER 1.     20250000
            MOVE     WS-L41PE-IND-TOT-CNT  TO   WS-AMT.                 20260000
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.              20270000
            MOVE     WP-ITEM (1)           TO   L41P-AMT-DESC1.         20280000
            MOVE     WP-ITEM (2)           TO   L41P-AMT-DESC2.         20290000
                                                                        20300000
            WRITE    L41PE-PRINT-REC       FROM PRT-L41P-FTG-1 AFTER 3. 20310000
            WRITE    L41PE-PRINT-REC       FROM PRT-L41P-FTG-2 AFTER 6. 20320000
            MOVE     ZEROES                TO   WS-L41PE-MORT-CNT       20330000
                                                WS-L41PE-DUP-DOA-CNT    20340000
                                                WS-L41PE-LEASE-CNT      20350000
                                                WS-L41PE-DUP-SA-CNT     20360000
                                                WS-L41PE-IND-TOT-CNT.   20370000
       4250-EXIT.                                                       20380000
            EXIT.                                                       20390000
                                                                        20400000
                                                                        20410000
      ******************************************************************20420000
       4270-PRINT-L41PG-GRAND-TOTAL.                                    20430000
      ******************************************************************20440000
            IF WS-CNT-DETAILS = ZEROES                                  20450000
               GO TO 4270-EXIT                                          20460000
            END-IF.                                                     20470000
                                                                        20480000
            MOVE  WS-CNT-DETAILS        TO L41P-VR-NO-HIGH.             20490000
            MOVE  WS-L41PG-MORT-CNT     TO L41P-TOTAL-MORT-SF.          20500000
            MOVE  WS-L41PG-DUP-DOA-CNT  TO L41P-TOTAL-DUP-DOA.          20510000
            MOVE  WS-L41PG-LEASE-CNT    TO L41P-TOTAL-SUP-LEASE-SF.     20520000
            MOVE  WS-L41PG-DUP-SA-CNT   TO L41P-TOTAL-DUP-SA.           20530000
            MOVE  WS-L41PG-IND-TOT-CNT  TO L41P-TOTAL-AMT.              20540000
                                                                        20550000
            WRITE L41PG-PRINT-REC  FROM PRT-L41P-DASH-LINE  AFTER 2.    20560000
            WRITE L41PG-PRINT-REC  FROM PRT-L41P-TOTAL-LINE AFTER 1.    20570000
            WRITE L41PG-PRINT-REC  FROM PRT-L41P-DASH-LINE  AFTER 1.    20580000
                                                                        20590000
            MOVE     WS-L41PG-IND-TOT-CNT  TO   WS-AMT.                 20600000
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.              20610000
            MOVE     WP-ITEM (1)           TO   L41P-AMT-DESC1.         20620000
            MOVE     WP-ITEM (2)           TO   L41P-AMT-DESC2.         20630000
            WRITE    L41PG-PRINT-REC       FROM PRT-L41P-FTG-1 AFTER 3. 20640000
            WRITE    L41PG-PRINT-REC       FROM PRT-L41P-FTG-2 AFTER 6. 20650000
            MOVE     ZEROES                TO   WS-L41PG-MORT-CNT       20660000
                                                WS-L41PG-DUP-DOA-CNT    20670000
                                                WS-L41PG-LEASE-CNT      20680000
                                                WS-L41PG-DUP-SA-CNT     20690000
                                                WS-L41PG-IND-TOT-CNT.   20700000
       4270-EXIT.                                                       20710000
            EXIT.                                                       20720000
                                                                        20730000
                                                                        20740000
      ******************************************************************20750000
       4280-PRINT-L41PH-GRAND-TOTAL.                                    20760000
      ******************************************************************20770000
            IF WS-CNT-DETAILS = ZEROES                                  20780000
               GO TO 4280-EXIT                                          20790000
            END-IF.                                                     20800000
                                                                        20810000
            MOVE  WS-CNT-DETAILS        TO L41P-VR-NO-HIGH.             20820000
            MOVE  WS-L41PH-MORT-CNT     TO L41P-TOTAL-MORT-SF.          20830000
            MOVE  WS-L41PH-DUP-DOA-CNT  TO L41P-TOTAL-DUP-DOA.          20840000
            MOVE  WS-L41PH-LEASE-CNT    TO L41P-TOTAL-SUP-LEASE-SF.     20850000
            MOVE  WS-L41PH-DUP-SA-CNT   TO L41P-TOTAL-DUP-SA.           20860000
            MOVE  WS-L41PH-IND-TOT-CNT  TO L41P-TOTAL-AMT.              20870000
                                                                        20880000
            WRITE L41PH-PRINT-REC  FROM PRT-L41P-DASH-LINE  AFTER 2.    20890000
            WRITE L41PH-PRINT-REC  FROM PRT-L41P-TOTAL-LINE AFTER 1.    20900000
            WRITE L41PH-PRINT-REC  FROM PRT-L41P-DASH-LINE  AFTER 1.    20910000
                                                                        20920000
            MOVE     WS-L41PH-IND-TOT-CNT  TO   WS-AMT.                 20930000
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.              20940000
            MOVE     WP-ITEM (1)           TO   L41P-AMT-DESC1.         20950000
            MOVE     WP-ITEM (2)           TO   L41P-AMT-DESC2.         20960000
            WRITE    L41PH-PRINT-REC       FROM PRT-L41P-FTG-1 AFTER 3. 20970000
            WRITE    L41PH-PRINT-REC       FROM PRT-L41P-FTG-2 AFTER 6. 20980000
                                                                        20990000
            MOVE     ZEROES                TO   WS-L41PH-MORT-CNT       21000000
                                                WS-L41PH-DUP-DOA-CNT    21010000
                                                WS-L41PH-LEASE-CNT      21020000
                                                WS-L41PH-DUP-SA-CNT     21030000
                                                WS-L41PH-IND-TOT-CNT.   21040000
       4280-EXIT.                                                       21050000
            EXIT.                                                       21060000
                                                                        21070000
                                                                        21080000
      ******************************************************************21090000
       4290-PRINT-L41PI-GRAND-TOTAL.                                    21100000
      ******************************************************************21110000
            IF WS-CNT-DETAILS = ZEROES                                  21120000
               GO TO 4290-EXIT                                          21130000
            END-IF.                                                     21140000
                                                                        21150000
            MOVE  WS-CNT-DETAILS        TO L41P-VR-NO-HIGH.             21160000
            MOVE  WS-L41PI-MORT-CNT     TO L41P-TOTAL-MORT-SF.          21170000
            MOVE  WS-L41PI-DUP-DOA-CNT  TO L41P-TOTAL-DUP-DOA.          21180000
            MOVE  WS-L41PI-LEASE-CNT    TO L41P-TOTAL-SUP-LEASE-SF.     21190000
            MOVE  WS-L41PI-DUP-SA-CNT   TO L41P-TOTAL-DUP-SA.           21200000
            MOVE  WS-L41PI-IND-TOT-CNT  TO L41P-TOTAL-AMT.              21210000
                                                                        21220000
            WRITE L41PI-PRINT-REC  FROM PRT-L41P-DASH-LINE  AFTER 2.    21230000
            WRITE L41PI-PRINT-REC  FROM PRT-L41P-TOTAL-LINE AFTER 1.    21240000
            WRITE L41PI-PRINT-REC  FROM PRT-L41P-DASH-LINE  AFTER 1.    21250000
                                                                        21260000
            MOVE     WS-L41PI-IND-TOT-CNT  TO   WS-AMT.                 21270000
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.              21280000
            MOVE     WP-ITEM (1)           TO   L41P-AMT-DESC1.         21290000
            MOVE     WP-ITEM (2)           TO   L41P-AMT-DESC2.         21300000
                                                                        21310000
            WRITE    L41PI-PRINT-REC       FROM PRT-L41P-FTG-1 AFTER 3. 21320000
            WRITE    L41PI-PRINT-REC       FROM PRT-L41P-FTG-2 AFTER 6. 21330000
                                                                        21340000
            MOVE     ZEROES                TO   WS-L41PI-MORT-CNT       21350000
                                                WS-L41PI-DUP-DOA-CNT    21360000
                                                WS-L41PI-LEASE-CNT      21370000
                                                WS-L41PI-DUP-SA-CNT     21380000
                                                WS-L41PI-IND-TOT-CNT.   21390000
       4290-EXIT.                                                       21400000
            EXIT.                                                       21410000
                                                                        21420000
                                                                        21430000
      ******************************************************************21440000
       4295-PRINT-L41PJ-GRAND-TOTAL.                                    21450000
      ******************************************************************21460000
            IF WS-CNT-DETAILS = ZEROES                                  21470000
               GO TO 4295-EXIT                                          21480000
            END-IF.                                                     21490000
                                                                        21500000
            MOVE  WS-CNT-DETAILS        TO L41P-VR-NO-HIGH.             21510000
            MOVE  WS-L41PJ-MORT-CNT     TO L41P-TOTAL-MORT-SF.          21520000
            MOVE  WS-L41PJ-DUP-DOA-CNT  TO L41P-TOTAL-DUP-DOA.          21530000
            MOVE  WS-L41PJ-LEASE-CNT    TO L41P-TOTAL-SUP-LEASE-SF.     21540000
            MOVE  WS-L41PJ-DUP-SA-CNT   TO L41P-TOTAL-DUP-SA.           21550000
            MOVE  WS-L41PJ-IND-TOT-CNT  TO L41P-TOTAL-AMT.              21560000
                                                                        21570000
            WRITE L41PJ-PRINT-REC  FROM PRT-L41P-DASH-LINE  AFTER 2.    21580000
            WRITE L41PJ-PRINT-REC  FROM PRT-L41P-TOTAL-LINE AFTER 1.    21590000
            WRITE L41PJ-PRINT-REC  FROM PRT-L41P-DASH-LINE  AFTER 1.    21600000
                                                                        21610000
            MOVE     WS-L41PJ-IND-TOT-CNT  TO   WS-AMT.                 21620000
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.              21630000
            MOVE     WP-ITEM (1)           TO   L41P-AMT-DESC1.         21640000
            MOVE     WP-ITEM (2)           TO   L41P-AMT-DESC2.         21650000
                                                                        21660000
            WRITE    L41PJ-PRINT-REC       FROM PRT-L41P-FTG-1 AFTER 3. 21670000
            WRITE    L41PJ-PRINT-REC       FROM PRT-L41P-FTG-2 AFTER 6. 21680000
                                                                        21690000
            MOVE     ZEROES                TO   WS-L41PJ-MORT-CNT       21700000
                                                WS-L41PJ-DUP-DOA-CNT    21710000
                                                WS-L41PJ-LEASE-CNT      21720000
                                                WS-L41PJ-DUP-SA-CNT     21730000
                                                WS-L41PJ-IND-TOT-CNT.   21740000
       4295-EXIT.                                                       21750000
            EXIT.                                                       21760000
                                                                        21770000
                                                                        21780000
      ******************************************************************21790000
       4620-PRINT-L41PA-HEADER.                                         21800000
      ******************************************************************21810000
            MOVE 'P13L41PA'          TO L41P-REPORT-ID.                 21820000
            MOVE  WS-L41PA-DESC      TO L41P-REPORT-ID-DESC.            21830000
            MOVE 'SUPP. AGMT'        TO L41P-SUP-LEASE-DESC.            21840000
            MOVE  SPACES             TO L41P-TAG-DESC.                  21850000
            ADD   1                  TO WS-L41PA-PAGE-CNT.              21860000
            MOVE  WS-L41PA-PAGE-CNT  TO L41P-PAGE.                      21870000
                                                                        21880000
      ***** PRINT FINACES COPY HEADER                                   21890000
                                                                        21900000
            MOVE "FINANCE'S COPY"           TO L41P-COPY-NAME.          21910000
                                                                        21920000
            WRITE L41PA-PRINT-REC  FROM PRT-L41P-HDG-1    AFTER PAGE.   21930000
            WRITE L41PA-PRINT-REC  FROM PRT-L41P-HDG-2    AFTER 2.      21940000
            WRITE L41PA-PRINT-REC  FROM PRT-L41P-HDG-3    AFTER 1.      21950000
            WRITE L41PA-PRINT-REC  FROM PRT-L41P-HDG-4    AFTER 2.      21960000
            WRITE L41PA-PRINT-REC  FROM PRT-L41P-HDG-5    AFTER 1.      21970000
            WRITE L41PA-PRINT-REC  FROM PRT-L41P-HDG-6    AFTER 1.      21980000
            WRITE L41PA-PRINT-REC  FROM PRT-L41P-HDG-7    AFTER 1.      21990000
            WRITE L41PA-PRINT-REC  FROM PRT-L41P-HDG-8    AFTER 1.      22000000
            WRITE L41PA-PRINT-REC  FROM PRT-L41P-HDG-9    AFTER 1.      22010000
            WRITE L41PA-PRINT-REC  FROM PRT-L41P-HDG-10   AFTER 1.      22020000
            WRITE L41PA-PRINT-REC  FROM PRT-L41P-HDG-10A  AFTER 1.      22030000
            WRITE L41PA-PRINT-REC  FROM PRT-L41P-HDG-11   AFTER 1.      22040000
            WRITE L41PA-PRINT-REC  FROM PRT-L41P-SUBHDG-1 AFTER 3.      22050000
            WRITE L41PA-PRINT-REC  FROM PRT-L41P-SUBHDG-2 AFTER 1.      22060000
            WRITE L41PA-PRINT-REC  FROM PRT-L41P-SUBHDG-3 AFTER 1.      22070000
            MOVE  SPACES             TO L41PA-PRINT-REC.                22080000
            WRITE L41PA-PRINT-REC AFTER 1.                              22090000
                                                                        22100000
       4620-EXIT.                                                       22110000
            EXIT.                                                       22120000
                                                                        22130000
                                                                        22140000
      ******************************************************************22150000
       4710-PRINT-L41PD-HEADER.                                         22160000
      ******************************************************************22170000
            MOVE 'P13L41PD'          TO L41P-REPORT-ID.                 22180000
            MOVE  WS-L41PD-DESC      TO L41P-REPORT-ID-DESC.            22190000
            MOVE 'LEASE     '        TO L41P-SUP-LEASE-DESC.            22200000
            MOVE 'TAG'               TO L41P-TAG-DESC.                  22210000
            ADD   1                  TO WS-L41PD-PAGE-CNT.              22220000
            MOVE  WS-L41PD-PAGE-CNT  TO L41P-PAGE.                      22230000
                                                                        22240000
            MOVE "FINANCE'S COPY"           TO L41P-COPY-NAME.          22250000
            WRITE L41PD-PRINT-REC  FROM PRT-L41P-HDG-1    AFTER PAGE.   22260000
            WRITE L41PD-PRINT-REC  FROM PRT-L41P-HDG-2    AFTER 2.      22270000
            WRITE L41PD-PRINT-REC  FROM PRT-L41P-HDG-3    AFTER 1.      22280000
            WRITE L41PD-PRINT-REC  FROM PRT-L41P-HDG-4    AFTER 2.      22290000
            WRITE L41PD-PRINT-REC  FROM PRT-L41P-HDG-5    AFTER 1.      22300000
            WRITE L41PD-PRINT-REC  FROM PRT-L41P-HDG-6    AFTER 1.      22310000
            WRITE L41PD-PRINT-REC  FROM PRT-L41P-HDG-7    AFTER 1.      22320000
            WRITE L41PD-PRINT-REC  FROM PRT-L41P-HDG-8    AFTER 1.      22330000
            WRITE L41PD-PRINT-REC  FROM PRT-L41P-HDG-9    AFTER 1.      22340000
            WRITE L41PD-PRINT-REC  FROM PRT-L41P-HDG-10   AFTER 1.      22350000
            WRITE L41PD-PRINT-REC  FROM PRT-L41P-HDG-10A  AFTER 1.      22360000
            WRITE L41PD-PRINT-REC  FROM PRT-L41P-HDG-11   AFTER 1.      22370000
            WRITE L41PD-PRINT-REC  FROM PRT-L41P-SUBHDG-1 AFTER 3.      22380000
            WRITE L41PD-PRINT-REC  FROM PRT-L41P-SUBHDG-2 AFTER 1.      22390000
            WRITE L41PD-PRINT-REC  FROM PRT-L41P-SUBHDG-3 AFTER 1.      22400000
            MOVE  SPACES             TO L41PD-PRINT-REC.                22410000
            WRITE L41PD-PRINT-REC AFTER 1.                              22420000
                                                                        22430000
       4710-EXIT.                                                       22440000
            EXIT.                                                       22450000
                                                                        22460000
                                                                        22470000
      ******************************************************************22480000
       4720-PRINT-L41PE-HEADER.                                         22490000
      ******************************************************************22500000
            MOVE 'P13L41PE'          TO L41P-REPORT-ID.                 22510000
            MOVE  WS-L41PE-DESC      TO L41P-REPORT-ID-DESC.            22520000
            MOVE 'LEASE     '        TO L41P-SUP-LEASE-DESC.            22530000
            MOVE 'TAG'               TO L41P-TAG-DESC.                  22540000
            ADD   1                  TO WS-L41PE-PAGE-CNT.              22550000
            MOVE  WS-L41PE-PAGE-CNT  TO L41P-PAGE.                      22560000
                                                                        22570000
            MOVE "FINANCE'S COPY"           TO L41P-COPY-NAME.          22580000
            WRITE L41PE-PRINT-REC  FROM PRT-L41P-HDG-1    AFTER PAGE.   22590000
            WRITE L41PE-PRINT-REC  FROM PRT-L41P-HDG-2    AFTER 2.      22600000
            WRITE L41PE-PRINT-REC  FROM PRT-L41P-HDG-3    AFTER 1.      22610000
            WRITE L41PE-PRINT-REC  FROM PRT-L41P-HDG-4    AFTER 2.      22620000
            WRITE L41PE-PRINT-REC  FROM PRT-L41P-HDG-5    AFTER 1.      22630000
            WRITE L41PE-PRINT-REC  FROM PRT-L41P-HDG-6    AFTER 1.      22640000
            WRITE L41PE-PRINT-REC  FROM PRT-L41P-HDG-7    AFTER 1.      22650000
            WRITE L41PE-PRINT-REC  FROM PRT-L41P-HDG-8    AFTER 1.      22660000
            WRITE L41PE-PRINT-REC  FROM PRT-L41P-HDG-9    AFTER 1.      22670000
            WRITE L41PE-PRINT-REC  FROM PRT-L41P-HDG-10   AFTER 1.      22680000
            WRITE L41PE-PRINT-REC  FROM PRT-L41P-HDG-10A  AFTER 1.      22690000
            WRITE L41PE-PRINT-REC  FROM PRT-L41P-HDG-11   AFTER 1.      22700000
            WRITE L41PE-PRINT-REC  FROM PRT-L41P-SUBHDG-1 AFTER 3.      22710000
            WRITE L41PE-PRINT-REC  FROM PRT-L41P-SUBHDG-2 AFTER 1.      22720000
            WRITE L41PE-PRINT-REC  FROM PRT-L41P-SUBHDG-3 AFTER 1.      22730000
            MOVE  SPACES             TO L41PE-PRINT-REC.                22740000
            WRITE L41PE-PRINT-REC AFTER 1.                              22750000
                                                                        22760000
       4720-EXIT.                                                       22770000
            EXIT.                                                       22780000
                                                                        22790000
                                                                        22800000
      ******************************************************************22810000
       4740-PRINT-L41PG-HEADER.                                         22820000
      ******************************************************************22830000
            MOVE 'P13L41PG'          TO L41P-REPORT-ID.                 22840000
            MOVE  WS-L41PG-DESC      TO L41P-REPORT-ID-DESC.            22850000
            MOVE 'LEASE     '        TO L41P-SUP-LEASE-DESC.            22860000
            MOVE 'TAG'               TO L41P-TAG-DESC.                  22870000
            ADD   1                  TO WS-L41PG-PAGE-CNT.              22880000
            MOVE  WS-L41PG-PAGE-CNT  TO L41P-PAGE.                      22890000
                                                                        22900000
            MOVE "FINANCE'S COPY"           TO L41P-COPY-NAME.          22910000
            WRITE L41PG-PRINT-REC  FROM PRT-L41P-HDG-1    AFTER PAGE.   22920000
            WRITE L41PG-PRINT-REC  FROM PRT-L41P-HDG-2    AFTER 2.      22930000
            WRITE L41PG-PRINT-REC  FROM PRT-L41P-HDG-3    AFTER 1.      22940000
            WRITE L41PG-PRINT-REC  FROM PRT-L41P-HDG-4    AFTER 2.      22950000
            WRITE L41PG-PRINT-REC  FROM PRT-L41P-HDG-5    AFTER 1.      22960000
            WRITE L41PG-PRINT-REC  FROM PRT-L41P-HDG-6    AFTER 1.      22970000
            WRITE L41PG-PRINT-REC  FROM PRT-L41P-HDG-7    AFTER 1.      22980000
            WRITE L41PG-PRINT-REC  FROM PRT-L41P-HDG-8    AFTER 1.      22990000
            WRITE L41PG-PRINT-REC  FROM PRT-L41P-HDG-9    AFTER 1.      23000000
            WRITE L41PG-PRINT-REC  FROM PRT-L41P-HDG-10   AFTER 1.      23010000
            WRITE L41PG-PRINT-REC  FROM PRT-L41P-HDG-10A  AFTER 1.      23020000
            WRITE L41PG-PRINT-REC  FROM PRT-L41P-HDG-11   AFTER 1.      23030000
            WRITE L41PG-PRINT-REC  FROM PRT-L41P-SUBHDG-1 AFTER 3.      23040000
            WRITE L41PG-PRINT-REC  FROM PRT-L41P-SUBHDG-2 AFTER 1.      23050000
            WRITE L41PG-PRINT-REC  FROM PRT-L41P-SUBHDG-3 AFTER 1.      23060000
            MOVE  SPACES             TO L41PG-PRINT-REC.                23070000
            WRITE L41PG-PRINT-REC AFTER 1.                              23080000
                                                                        23090000
       4740-EXIT.                                                       23100000
            EXIT.                                                       23110000
                                                                        23120000
                                                                        23130000
      ******************************************************************23140000
       4750-PRINT-L41PH-HEADER.                                         23150000
      ******************************************************************23160000
            MOVE 'P13L41PH'          TO L41P-REPORT-ID.                 23170000
            MOVE  WS-L41PH-DESC      TO L41P-REPORT-ID-DESC.            23180000
            MOVE 'LEASE     '        TO L41P-SUP-LEASE-DESC.            23190000
            MOVE 'TAG'               TO L41P-TAG-DESC.                  23200000
            ADD   1                  TO WS-L41PH-PAGE-CNT.              23210000
            MOVE  WS-L41PH-PAGE-CNT  TO L41P-PAGE.                      23220000
                                                                        23230000
            MOVE "FINANCE'S COPY"           TO L41P-COPY-NAME.          23240000
            WRITE L41PH-PRINT-REC  FROM PRT-L41P-HDG-1    AFTER PAGE.   23250000
            WRITE L41PH-PRINT-REC  FROM PRT-L41P-HDG-2    AFTER 2.      23260000
            WRITE L41PH-PRINT-REC  FROM PRT-L41P-HDG-3    AFTER 1.      23270000
            WRITE L41PH-PRINT-REC  FROM PRT-L41P-HDG-4    AFTER 2.      23280000
            WRITE L41PH-PRINT-REC  FROM PRT-L41P-HDG-5    AFTER 1.      23290000
            WRITE L41PH-PRINT-REC  FROM PRT-L41P-HDG-6    AFTER 1.      23300000
            WRITE L41PH-PRINT-REC  FROM PRT-L41P-HDG-7    AFTER 1.      23310000
            WRITE L41PH-PRINT-REC  FROM PRT-L41P-HDG-8    AFTER 1.      23320000
            WRITE L41PH-PRINT-REC  FROM PRT-L41P-HDG-9    AFTER 1.      23330000
            WRITE L41PH-PRINT-REC  FROM PRT-L41P-HDG-10   AFTER 1.      23340000
            WRITE L41PH-PRINT-REC  FROM PRT-L41P-HDG-10A  AFTER 1.      23350000
            WRITE L41PH-PRINT-REC  FROM PRT-L41P-HDG-11   AFTER 1.      23360000
            WRITE L41PH-PRINT-REC  FROM PRT-L41P-SUBHDG-1 AFTER 3.      23370000
            WRITE L41PH-PRINT-REC  FROM PRT-L41P-SUBHDG-2 AFTER 1.      23380000
            WRITE L41PH-PRINT-REC  FROM PRT-L41P-SUBHDG-3 AFTER 1.      23390000
            MOVE  SPACES             TO L41PH-PRINT-REC.                23400000
            WRITE L41PH-PRINT-REC AFTER 1.                              23410000
                                                                        23420000
       4750-EXIT.                                                       23430000
            EXIT.                                                       23440000
                                                                        23450000
                                                                        23460000
      ******************************************************************23470000
       4760-PRINT-L41PI-HEADER.                                         23480000
      ******************************************************************23490000
            MOVE 'P13L41PI'          TO L41P-REPORT-ID.                 23500000
            MOVE  WS-L41PI-DESC      TO L41P-REPORT-ID-DESC.            23510000
            MOVE 'LEASE     '        TO L41P-SUP-LEASE-DESC.            23520000
            MOVE 'TAG'               TO L41P-TAG-DESC.                  23530000
            ADD   1                  TO WS-L41PI-PAGE-CNT.              23540000
            MOVE  WS-L41PI-PAGE-CNT  TO L41P-PAGE.                      23550000
                                                                        23560000
            MOVE "FINANCE'S COPY"           TO L41P-COPY-NAME.          23570000
            WRITE L41PI-PRINT-REC  FROM PRT-L41P-HDG-1    AFTER PAGE.   23580000
            WRITE L41PI-PRINT-REC  FROM PRT-L41P-HDG-2    AFTER 2.      23590000
            WRITE L41PI-PRINT-REC  FROM PRT-L41P-HDG-3    AFTER 1.      23600000
            WRITE L41PI-PRINT-REC  FROM PRT-L41P-HDG-4    AFTER 2.      23610000
            WRITE L41PI-PRINT-REC  FROM PRT-L41P-HDG-5    AFTER 1.      23620000
            WRITE L41PI-PRINT-REC  FROM PRT-L41P-HDG-6    AFTER 1.      23630000
            WRITE L41PI-PRINT-REC  FROM PRT-L41P-HDG-7    AFTER 1.      23640000
            WRITE L41PI-PRINT-REC  FROM PRT-L41P-HDG-8    AFTER 1.      23650000
            WRITE L41PI-PRINT-REC  FROM PRT-L41P-HDG-9    AFTER 1.      23660000
            WRITE L41PI-PRINT-REC  FROM PRT-L41P-HDG-10   AFTER 1.      23670000
            WRITE L41PI-PRINT-REC  FROM PRT-L41P-HDG-10A  AFTER 1.      23680000
            WRITE L41PI-PRINT-REC  FROM PRT-L41P-HDG-11   AFTER 1.      23690000
            WRITE L41PI-PRINT-REC  FROM PRT-L41P-SUBHDG-1 AFTER 3.      23700000
            WRITE L41PI-PRINT-REC  FROM PRT-L41P-SUBHDG-2 AFTER 1.      23710000
            WRITE L41PI-PRINT-REC  FROM PRT-L41P-SUBHDG-3 AFTER 1.      23720000
            MOVE  SPACES             TO L41PI-PRINT-REC.                23730000
            WRITE L41PI-PRINT-REC AFTER 1.                              23740000
                                                                        23750000
       4760-EXIT.                                                       23760000
            EXIT.                                                       23770000
                                                                        23780000
                                                                        23790000
      ******************************************************************23800000
       4770-PRINT-L41PJ-HEADER.                                         23810000
      ******************************************************************23820000
            MOVE 'P13L41PJ'          TO L41P-REPORT-ID.                 23830000
            MOVE  WS-L41PJ-DESC      TO L41P-REPORT-ID-DESC.            23840000
            MOVE 'LEASE     '        TO L41P-SUP-LEASE-DESC.            23850000
            MOVE 'TAG'               TO L41P-TAG-DESC.                  23860000
            ADD   1                  TO WS-L41PJ-PAGE-CNT.              23870000
            MOVE  WS-L41PJ-PAGE-CNT  TO L41P-PAGE.                      23880000
                                                                        23890000
            MOVE "FINANCE'S COPY"          TO L41P-COPY-NAME.           23900000
            WRITE L41PJ-PRINT-REC  FROM PRT-L41P-HDG-1    AFTER PAGE.   23910000
            WRITE L41PJ-PRINT-REC  FROM PRT-L41P-HDG-2    AFTER 2.      23920000
            WRITE L41PJ-PRINT-REC  FROM PRT-L41P-HDG-3    AFTER 1.      23930000
            WRITE L41PJ-PRINT-REC  FROM PRT-L41P-HDG-4    AFTER 2.      23940000
            WRITE L41PJ-PRINT-REC  FROM PRT-L41P-HDG-5    AFTER 1.      23950000
            WRITE L41PJ-PRINT-REC  FROM PRT-L41P-HDG-6    AFTER 1.      23960000
            WRITE L41PJ-PRINT-REC  FROM PRT-L41P-HDG-7    AFTER 1.      23970000
            WRITE L41PJ-PRINT-REC  FROM PRT-L41P-HDG-8    AFTER 1.      23980000
            WRITE L41PJ-PRINT-REC  FROM PRT-L41P-HDG-9    AFTER 1.      23990000
            WRITE L41PJ-PRINT-REC  FROM PRT-L41P-HDG-10   AFTER 1.      24000000
            WRITE L41PJ-PRINT-REC  FROM PRT-L41P-HDG-10A  AFTER 1.      24010000
            WRITE L41PJ-PRINT-REC  FROM PRT-L41P-HDG-11   AFTER 1.      24020000
            WRITE L41PJ-PRINT-REC  FROM PRT-L41P-SUBHDG-1 AFTER 3.      24030000
            WRITE L41PJ-PRINT-REC  FROM PRT-L41P-SUBHDG-2 AFTER 1.      24040000
            WRITE L41PJ-PRINT-REC  FROM PRT-L41P-SUBHDG-3 AFTER 1.      24050000
            MOVE  SPACES             TO L41PJ-PRINT-REC.                24060000
            WRITE L41PJ-PRINT-REC AFTER 1.                              24070000
                                                                        24080000
       4770-EXIT.                                                       24090000
            EXIT.                                                       24100000
                                                                        24110000
                                                                        24120000
      ******************************************************************24130000
       5000-WRITE-HEADER-F225.                                          24140000
      ******************************************************************24150000
            INITIALIZE    AG07F225-HEADER.                              24160000
            MOVE SPACES TO     AG07F225-HEADER.                         24170000
                                                                        24180000
            MOVE    C907-NUM-DDD          TO   F225-NUM-DDD.            24190000
            MOVE    C907-NUM-FIN-YR       TO   F225-NUM-FIN-YEAR.       24200000
            MOVE    C907-NUM-VR-SERIAL    TO   F225-NUM-VR-SERIAL.      24210000
            MOVE    F225-NUM-VR           TO   WS-NUM-VOUCHER.          24220000
            MOVE    00                    TO   F225-NUM-REC-TYP.        24230000
            MOVE   'PV'                   TO   F225-NUM-VR-TYP.         24240000
            MOVE   'TL'                   TO   F225-NUM-VR-SUB-TYP.     24250000
            MOVE   'SOC'                  TO   F225-NUM-TRANS-TYP.      24260000
            MOVE  FUNCTION CURRENT-DATE   TO   F225-DTE-VR-CREATE       24270000
                                               F225-DTE-VR-PRT-FINAL    24280000
            MOVE   'BP13C41P'      TO   F225-NUM-VR-CREATE-USERID       24290000
                                        F225-NUM-VR-PRT-FINAL-USERID    24300000
            MOVE   'STPFEE  '             TO   F225-NUM-DDD-FILE-REF.   24310000
            MOVE   'COMMISSIONER OF STAMP DUTIES'   TO  F225-NME-PAYEE1.24320000
      *     MOVE   'C/O SC(STAMPING) OF SALES UNIT' TO  F225-NME-STREET.24330000
      *     MOVE   'NG CHOO HONG  '     TO   F225-NME-COLL-OFFCR.       24340000
            MOVE   'SALES AGREEMENT TEAM'  TO   F225-NME-COLL-OFFCR.    24350000
            MOVE   '64903781'           TO   F225-NUM-COLL-OFFCR-PHONE. 24360000
            MOVE   'SALES AGREEMENT TEAM' TO   F225-NME-CONTACT-OFFCR.  24370000
      *     MOVE   '64903783'           TO   F225-NUM-CONTACT-PHONE.    24380000
            MOVE   '64903781'           TO   F225-NUM-CONTACT-PHONE.    24390000
            MOVE   'DBSSSGSGXXX'        TO   F225-NUM-PAYEE-BANK.       24400000
            MOVE   SPACES               TO   F225-NUM-PAYEE-BANK-BRNCH. 24410000
            MOVE   '0010468600'         TO   F225-NUM-PAYEE-IBG-ACCT.   24420000
            MOVE   SPACES               TO   F225-NUM-ROOT-ACCT.        24430000
            MOVE   SPACES               TO   F225-NUM-PAYEE-UIN1.       24440000
            MOVE   SPACES               TO   F225-NME-PAYEE2.           24450000
            MOVE   SPACES               TO   F225-NUM-PAYEE-UIN2.       24460000
            MOVE   SPACES               TO   F225-NUM-PAYEE-TAX-REGN.   24470000
            MOVE   '55'                 TO   F225-NUM-BLK-HSE.          24471000
            MOVE   'NEWTON ROAD'        TO   F225-NME-STREET.           24472000
            MOVE   'REVENUE HOUSE'      TO   F225-NME-BLDNG.            24473000
            MOVE   '307987'             TO   F225-NUM-POSTAL.           24474000
            MOVE   SPACES               TO   F225-TXT-REJECT-HDR.       24480000
            MOVE   'STPFEE  '           TO   F225-NUM-INTRFC-FR-HDR.    24490000
            MOVE   'CV'                 TO   F225-NUM-ACTION-TYP.       24500000
            MOVE   SPACES               TO   F225-NUM-PRCS-TERM.        24510000
            MOVE   SPACES               TO   F225-NUM-ROUTE-FLAG.       24520000
            IF F315-USERID   = 'BP13P001'                               24530000
              MOVE WS-STAFF-START         TO F225-NUM-STAFF-ID-PREP     24540000
                                             F225-NUM-USERID-START      24550000
            ELSE                                                        24560000
              IF F315-USERID(1:7)   = 'EA29418'                         24570000
                 MOVE '29418G'            TO F225-NUM-STAFF-ID-PREP     24580000
                                             F225-NUM-USERID-START      24590000
              ELSE                                                      24600000
                 MOVE F315-USERID         TO F225-NUM-STAFF-ID-PREP     24610000
                                             F225-NUM-USERID-START      24620000
              END-IF                                                    24630000
            END-IF.                                                     24640000
            MOVE   'PREP'               TO   F225-NUM-VCHR-STATE-START. 24650000
            MOVE   SPACES               TO   F225-DTE-PYMNT-DUE.        24660000
                                                                        24670000
                                                                        24680000
            WRITE AG07F225-HEADER.                                      24690000
                                                                        24700000
            ADD     1                     TO   WS-AG07F225-WRITE-CNT.   24710000
            MOVE    C907-NUM-DDD          TO   WS-EDITED-NUM-DDD.       24720000
            MOVE    C907-NUM-FIN-YR       TO   WS-EDITED-NUM-FIN-YEAR.  24730000
            MOVE    C907-NUM-VR-SERIAL    TO   WS-EDITED-NUM-VR-SERIAL. 24740000
            MOVE    WS-EDITED-VOUCHER-NO  TO   L41P-VOUCHER-NO.         24750000
                                                                        24760000
            MOVE    SPACES                TO   L41P-BATCH-NO.           24770000
                                                                        24780000
            STRING WS-NUM-BATCH-TYPE   DELIMITED BY SPACE               24790000
                   WS-NUM-FIN-YEAR     DELIMITED BY SPACE               24800000
                   '-'                 DELIMITED BY SIZE                24810000
                   WS-NUM-BATCH-SERIAL DELIMITED BY SPACE               24820000
                   INTO L41P-BATCH-NO                                   24830000
            END-STRING.                                                 24840000
                                                                        24850000
            EVALUATE TRUE                                               24860000
            WHEN     REPORT-L41PA                                       24870000
               PERFORM 4620-PRINT-L41PA-HEADER   THRU 4620-EXIT         24880000
            WHEN     REPORT-L41PD                                       24890000
               PERFORM 4710-PRINT-L41PD-HEADER   THRU 4710-EXIT         24900000
            WHEN     REPORT-L41PE                                       24910000
               PERFORM 4720-PRINT-L41PE-HEADER   THRU 4720-EXIT         24920000
            WHEN     REPORT-L41PG                                       24930000
               PERFORM 4740-PRINT-L41PG-HEADER   THRU 4740-EXIT         24940000
            WHEN     REPORT-L41PH                                       24950000
               PERFORM 4750-PRINT-L41PH-HEADER   THRU 4750-EXIT         24960000
            WHEN     REPORT-L41PI                                       24970000
               PERFORM 4760-PRINT-L41PI-HEADER   THRU 4760-EXIT         24980000
            WHEN     REPORT-L41PJ                                       24990000
               PERFORM 4770-PRINT-L41PJ-HEADER   THRU 4770-EXIT         25000000
            END-EVALUATE.                                               25010000
                                                                        25020000
       5000-HEADER-EXIT.                                                25030000
            EXIT.                                                       25040000
                                                                        25050000
                                                                        25060000
      ******************************************************************25070000
       5000-WRITE-TRANS-DETAIL-F225.                                    25080000
      ******************************************************************25090000
            INITIALIZE  AG07F225-TRANS.                                 25100000
            MOVE    SPACES             TO    AG07F225-TRANS.            25110000
            MOVE    WS-NUM-VOUCHER     TO    F225-NUM-VR-T.             25120000
            MOVE    WS-CNT-DETAILS     TO    F225-NUM-TRANS-SERIAL.     25130000
            MOVE   '04'                TO    F225-NUM-SYS.              25140000
            MOVE    WS-SCH-ACCT-NO     TO    F225-NUM-HDB-REF.          25150000
            MOVE   '0000000104250'     TO    F225-NUM-GL-ACCT.          25160000
            MOVE    WS-AMT-TRANS       TO    F225-AMT-TRANS.            25170000
            MOVE   'D'                 TO    F225-NUM-TRANS-DR-CR.      25180000
            MOVE    ZEROES             TO    F225-AMT-TRANS-GST.        25190000
            MOVE    F315-REGN-NO       TO    F225-TXT-INFO.             25200000
            MOVE    SPACES             TO    F225-NUM-TAX-CDE.          25210000
            MOVE    SPACES             TO    F225-NUM-CPF.              25220000
            MOVE    SPACES             TO    F225-TXT-REJECT-DTL.       25230000
            MOVE    'STPFEE  '          TO  F225-NUM-INTRFC-FR-T.       25240000
                                                                        25250000
            WRITE       AG07F225-TRANS.                                 25260000
                                                                        25270000
            ADD     1                  TO    WS-AG07F225-WRITE-CNT.     25280000
                                                                        25290000
       5000-DETAIL-EXIT.                                                25300000
            EXIT.                                                       25310000
                                                                        25320000
                                                                        25330000
      ******************************************************************25340000
       5000-WRITE-TRAILER-F225.                                         25350000
      ******************************************************************25360000
            IF WS-CNT-DETAILS = ZEROES                                  25370000
               GO TO 5000-TRAILER-EXIT                                  25380000
            END-IF.                                                     25390000
                                                                        25400000
            EVALUATE TRUE                                               25410000
            WHEN     REPORT-L41PA                                       25420000
               PERFORM 4210-PRINT-L41PA-GRAND-TOTAL THRU 4210-EXIT      25430000
               MOVE    WS-AMT                TO   WS-AMT-TOTAL          25440000
               DISPLAY ' A     '       WS-AMT-TOTAL                     25450000
            WHEN     REPORT-L41PD                                       25460000
               PERFORM 4240-PRINT-L41PD-GRAND-TOTAL THRU 4240-EXIT      25470000
               MOVE    WS-AMT                TO   WS-AMT-TOTAL          25480000
               DISPLAY ' D     '       WS-AMT-TOTAL                     25490000
            WHEN     REPORT-L41PE                                       25500000
               PERFORM 4250-PRINT-L41PE-GRAND-TOTAL THRU 4250-EXIT      25510000
               MOVE    WS-AMT                TO   WS-AMT-TOTAL          25520000
               DISPLAY ' E     '       WS-AMT-TOTAL                     25530000
            WHEN     REPORT-L41PG                                       25540000
               PERFORM 4270-PRINT-L41PG-GRAND-TOTAL THRU 4270-EXIT      25550000
               MOVE    WS-AMT                TO   WS-AMT-TOTAL          25560000
               DISPLAY ' G     '       WS-AMT-TOTAL                     25570000
            WHEN     REPORT-L41PH                                       25580000
               PERFORM 4280-PRINT-L41PH-GRAND-TOTAL THRU 4280-EXIT      25590000
               MOVE    WS-AMT                TO   WS-AMT-TOTAL          25600000
               DISPLAY ' H     '       WS-AMT-TOTAL                     25610000
            WHEN     REPORT-L41PI                                       25620000
               PERFORM 4290-PRINT-L41PI-GRAND-TOTAL THRU 4290-EXIT      25630000
               MOVE    WS-AMT                TO   WS-AMT-TOTAL          25640000
               DISPLAY ' I     '       WS-AMT-TOTAL                     25650000
            WHEN     REPORT-L41PJ                                       25660000
               PERFORM 4295-PRINT-L41PJ-GRAND-TOTAL THRU 4295-EXIT      25670000
               MOVE    WS-AMT                TO   WS-AMT-TOTAL          25680000
               DISPLAY ' J     '       WS-AMT-TOTAL                     25690000
            END-EVALUATE.                                               25700000
                                                                        25710000
            INITIALIZE AG07F225-TRAILER.                                25720000
            MOVE       SPACES             TO  AG07F225-TRAILER.         25730000
            MOVE       WS-NUM-VOUCHER     TO  F225-NUM-VR-R.            25740000
            MOVE       99                 TO  F225-NUM-TRAILER-SERIAL.  25750000
            MOVE       'PAYMENT FOR LEASE/MORTGAGE STAMP FEES'          25760000
                                          TO  F225-TXT-VOUCHER-NARRATION25770000
            MOVE       WS-CNT-DETAILS     TO  F225-QTY-VR-TRANS.        25780000
            MOVE       WS-AMT-TOTAL       TO  F225-AMT-VR-DR-TOTAL.     25790000
            MOVE       ZEROES             TO  F225-AMT-VR-CR-TOTAL.     25800000
            MOVE       SPACES             TO  F225-TXT-REJECT-TLR.      25810000
            MOVE       'STPFEE  '         TO  F225-NUM-INTRFC-FR.       25820000
                                                                        25830000
            WRITE      AG07F225-TRAILER.                                25840000
                                                                        25850000
            ADD        1                  TO    WS-AG07F225-WRITE-CNT.  25860000
                                                                        25870000
       5000-TRAILER-EXIT.                                               25880000
            EXIT.                                                       25890000
                                                                        25900000
                                                                        25910000
      ******************************************************************25920000
       5100-WRITE-BP13F316.                                             25930000
      ******************************************************************25940000
            MOVE BP13F315-TRANS-REC       TO BP13F316-REC.              25950000
            STRING  C907-NUM-DDD          DELIMITED BY SIZE             25960000
                    C907-NUM-FIN-YR       DELIMITED BY SIZE             25970000
                    C907-NUM-VR-SERIAL    DELIMITED BY SIZE             25980000
                                          INTO F316-VOUCHER-NO.         25990000
            MOVE    WS-CNT-DETAILS        TO   F316-SERIAL-NO.          26000000
            WRITE  BP13F316-REC.                                        26010000
            ADD    1                      TO WS-BP13F316-WRITE-CNT.     26020000
                                                                        26030000
       5100-EXIT.                                                       26040000
            EXIT.                                                       26050000
                                                                        26060000
                                                                        26070000
      ******************************************************************26080000
       6000-WRITE-STAMPING-FILE.                                        26090000
      ******************************************************************26100000
            DISPLAY '6000-WRITE-STAMPING-FILE'.                         26110000
            INITIALIZE BP13K625-REC.                                    26120000
            MOVE  SPACES                TO BP13K625-REC.                26130000
                                                                        26140000
      *     MOVE F315-REGN-NO           TO K413-NUM-REGN.               26150000
            PERFORM 1400-READ-K413      THRU 1400-EXIT.                 26160000
                                                                        26170000
            MOVE F315-SCH-ACC           TO WS-NUM-HDB-REF.              26180000
            MOVE 'DAS'                  TO WS-NUM-DOC.                  26190000
                                                                        26200000
      ****  WRITE DETAIL PART FOR ORIGINAL MORTGAGE STAMP FEE*******    26210000
            MOVE  'O'                   TO WS-NUM-DOC-TYP.              26220000
                                                                        26230000
            IF F315-NUM-ADHOC-SF = SPACES                               26240000
               IF WS-MORT-SF > 0                                        26250000
                  COMPUTE WS-MORT-SF = WS-MORT-SF - DUP-DOA-AMT         26260000
               END-IF                                                   26270000
            END-IF.                                                     26280000
                                                                        26290000
            MOVE  WS-MORT-SF             TO WS-AMT-STAMP-DUTY.          26300000
            MOVE  ZEROES                 TO WS-AMT-STAMP-DUTY-DUP.      26310000
                                                                        26320000
            IF WS-AMT-STAMP-DUTY > 0                                    26330000
               PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT        26340000
               PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT        26350000
               MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY        26360000
               MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP    26370000
               WRITE BP13K625-REC                                       26380000
               ADD   1   TO  WS-BP13K625-WRITE-CNT                      26390000
            ELSE                                                        26400000
               NEXT SENTENCE                                            26410000
            END-IF.                                                     26420000
                                                                        26430000
      ****  WRITE DETAIL PART FOR DUPLICATE MORTGAGE STAMP FEE*******   26440000
            MOVE  'D'                    TO WS-NUM-DOC-TYP.             26450000
            MOVE  ZEROES                 TO WS-AMT-STAMP-DUTY.          26460000
            MOVE  WS-DUP-DOA             TO WS-AMT-STAMP-DUTY-DUP.      26470000
                                                                        26480000
            IF WS-AMT-STAMP-DUTY-DUP > 0                                26490000
               PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT        26500000
               PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT        26510000
               MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY        26520000
               MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP    26530000
               WRITE BP13K625-REC                                       26540000
               ADD   1   TO  WS-BP13K625-WRITE-CNT                      26550000
            ELSE                                                        26560000
               NEXT SENTENCE                                            26570000
            END-IF.                                                     26580000
                                                                        26590000
      ****  MOVE MAIN DETAILS OF SUPPLEMENTAL AGREEMENT / LEASE STAMP   26600000
      ****  FEE (SUA / ALE)                                             26610000
      ****  ONLY REPORT-L41PA HAS SUPPLEMENTARY SA                      26620000
                                                                        26630000
            IF REPORT-L41PA                                             26640000
               MOVE  'SUA'               TO WS-NUM-DOC                  26650000
               MOVE  'O'                 TO WS-NUM-DOC-TYP              26660000
                                                                        26670000
               IF F315-NUM-ADHOC-SF = SPACES                            26680000
                  IF WS-SUP-SF > 0                                      26690000
                     COMPUTE WS-SUP-SF = WS-SUP-SF - DUP-SA-AMT         26700000
                  END-IF                                                26710000
               END-IF                                                   26720000
                                                                        26730000
               MOVE  WS-SUP-SF           TO WS-AMT-STAMP-DUTY           26740000
               MOVE  ZEROES              TO WS-AMT-STAMP-DUTY-DUP       26750000
                                                                        26760000
               IF WS-AMT-STAMP-DUTY > 0                                 26770000
                  PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT     26780000
                  PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT     26790000
                  MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY     26800000
                  MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP 26810000
                  WRITE BP13K625-REC                                    26820000
                  ADD   1   TO  WS-BP13K625-WRITE-CNT                   26830000
               ELSE                                                     26840000
                  NEXT SENTENCE                                         26850000
               END-IF                                                   26860000
                                                                        26870000
               MOVE  'D'                 TO WS-NUM-DOC-TYP              26880000
               MOVE  ZEROES              TO WS-AMT-STAMP-DUTY           26890000
               MOVE  WS-DUP-SA           TO WS-AMT-STAMP-DUTY-DUP       26900000
                                                                        26910000
               IF WS-AMT-STAMP-DUTY-DUP > 0                             26920000
                  PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT     26930000
                  PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT     26940000
                  MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY     26950000
                  MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP 26960000
                  WRITE BP13K625-REC                                    26970000
                  ADD   1   TO  WS-BP13K625-WRITE-CNT                   26980000
               ELSE                                                     26990000
                  NEXT SENTENCE                                         27000000
               END-IF                                                   27010000
                                                                        27020000
            ELSE                                                        27030000
               MOVE  'ALE'               TO WS-NUM-DOC                  27040000
               MOVE  'O'                 TO WS-NUM-DOC-TYP              27050000
               PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT        27060000
               PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT        27070000
               MOVE  WS-LEASE-STAMP      TO K625-AMT-STAMP-DUTY         27080000
               MOVE  ZEROES              TO K625-AMT-STAMP-DUTY-DUP     27090000
               WRITE BP13K625-REC                                       27100000
               ADD   1                   TO WS-BP13K625-WRITE-CNT       27110000
                                                                        27120000
               MOVE  'D'                 TO WS-NUM-DOC-TYP              27130000
               PERFORM 6100-CHK-EXISTING-BP13K625 THRU 6100-EXIT        27140000
               PERFORM 6300-MAIN-DETAILS-TO-K625  THRU 6300-EXIT        27150000
               MOVE  ZEROES              TO K625-AMT-STAMP-DUTY         27160000
               MOVE  WS-DUP-SA           TO K625-AMT-STAMP-DUTY-DUP     27170000
               WRITE BP13K625-REC                                       27180000
               ADD   1                   TO WS-BP13K625-WRITE-CNT       27190000
            END-IF.                                                     27200000
                                                                        27210000
       6000-EXIT.                                                       27220000
           EXIT.                                                        27230000
                                                                        27240000
                                                                        27250000
      ******************************************************************27260000
       6100-CHK-EXISTING-BP13K625.                                      27270000
      ******************************************************************27280000
           MOVE WS-NUM-HDB-REF          TO K625-NUM-HDB-REF.            27290000
           MOVE WS-NUM-DOC              TO K625-NUM-DOC.                27300000
           MOVE WS-NUM-DOC-TYP          TO K625-NUM-DOC-TYP.            27310000
           MOVE 1                       TO K625-NUM-DOC-CNT.            27320000
           MOVE 'N'                     TO WS-K625-EOF.                 27330000
                                                                        27340000
           START BP13K625 KEY = K625-KEY-FLD.                           27350000
                                                                        27360000
           EVALUATE  WS-K625-STATUS                                     27370000
              WHEN '00'                                                 27380000
                    PERFORM 6200-READNEXT-BP13K625 THRU 6200-EXIT       27390000
                            UNTIL WS-K625-EOF = 'Y'                     27400000
                    ADD  1              TO WS-NUM-DOC-CNT               27410000
              WHEN '10'                                                 27420000
              WHEN '23'                                                 27430000
                    MOVE 1              TO WS-NUM-DOC-CNT               27440000
              WHEN OTHER                                                27450000
                    DISPLAY 'ERROR WHILE STARTING BROWSE-BP13K625 '     27460000
                    MOVE WS-K625-STATUS TO RETURN-CODE                  27470000
                    PERFORM 9000-CLOSE-FILES THRU 9000-EXIT             27480000
           END-EVALUATE.                                                27490000
                                                                        27500000
       6100-EXIT.                                                       27510000
           EXIT.                                                        27520000
                                                                        27530000
                                                                        27540000
      ******************************************************************27550000
       6200-READNEXT-BP13K625.                                          27560000
      ******************************************************************27570000
           READ BP13K625 NEXT AT END MOVE 'Y' TO WS-K625-EOF            27580000
              GO TO 6200-EXIT.                                          27590000
                                                                        27600000
           IF (K625-NUM-HDB-REF NOT = WS-NUM-HDB-REF) OR                27610000
              (K625-NUM-DOC     NOT = WS-NUM-DOC)     OR                27620000
              (K625-NUM-DOC-TYP NOT = WS-NUM-DOC-TYP)                   27630000
              MOVE 'Y'                  TO WS-K625-EOF                  27640000
              GO TO 6200-EXIT                                           27650000
           END-IF.                                                      27660000
                                                                        27670000
           MOVE K625-NUM-DOC-CNT        TO WS-NUM-DOC-CNT.              27680000
                                                                        27690000
       6200-EXIT.                                                       27700000
           EXIT.                                                        27710000
                                                                        27720000
                                                                        27730000
      ******************************************************************27740000
       6300-MAIN-DETAILS-TO-K625.                                       27750000
      ******************************************************************27760000
            MOVE  SPACES                 TO BP13K625-REC.               27770000
            INITIALIZE                      BP13K625-REC.               27780000
                                                                        27790000
            MOVE  F315-SCH-ACC           TO K625-NUM-HDB-REF.           27800000
            MOVE  WS-NUM-DOC             TO K625-NUM-DOC.               27810000
            MOVE  WS-NUM-DOC-TYP         TO K625-NUM-DOC-TYP.           27820000
            MOVE  WS-NUM-DOC-CNT         TO K625-NUM-DOC-CNT.           27830000
            MOVE  C907-NUM-DDD           TO K625-NUM-DDD.               27840000
            MOVE  C907-NUM-FIN-YR        TO K625-NUM-FIN-YEAR.          27850000
            MOVE  C907-NUM-VR-SERIAL     TO K625-NUM-VR-SERIAL.         27860000
            MOVE  C906-NUM-BATCH-TYPE    TO K625-NUM-BATCH-TYPE.        27870000
            MOVE  C906-NUM-FIN-YEAR      TO K625-NUM-CAL-YEAR.          27880000
            MOVE  C906-NUM-BATCH-SERIAL  TO K625-NUM-BATCH-SERIAL.      27890000
            MOVE  F315-REGN-NO           TO K625-NUM-REGN.              27900000
            MOVE  K413-DTE-KEY-ISSUE     TO K625-DTE-DOC-PREPARE.       27910000
            MOVE  K413-AMT-SELLING-PRICE TO K625-AMT-PURCHASE-PRICE.    27920000
            MOVE  WS-ANNUAL-RENT         TO K625-AMT-ANNUAL-RENT.       27930000
            MOVE  SPACES                 TO K625-NUM-INCREASE-SCCC.     27940000
            MOVE  K413-AMT-LOAN          TO K625-AMT-LOAN.              27950000
            MOVE  'BP13C41P'             TO K625-NUM-SYSTEM.            27960000
            MOVE  FUNCTION CURRENT-DATE  TO K625-DTE-UPDATE.            27970000
                                                                        27980000
      ****  STUDIO APT ARE OF 30 YRS LEASE  *******                     27990000
      ****  IT IS OF CDE-MODL-DESG OF 80 OR 89  *******                 28000000
            IF F315-CDE-MODL-DESG = '80' OR '89' OR '92'                28010000
               COMPUTE K625-NUM-LEASE-TERM = 30 * 12                    28020000
            ELSE                                                        28030000
               COMPUTE K625-NUM-LEASE-TERM = 99 * 12                    28040000
            END-IF.                                                     28050000
                                                                        28060000
       6300-EXIT.                                                       28070000
           EXIT.                                                        28080000
                                                                        28090000
                                                                        28100000
      ******************************************************************28110000
       6500-PRINT-L41PK-REPORT.                                         28120000
      ******************************************************************28130000
           IF WS-L41PK-REC-ON-PAGE-CNT > 65                             28140000
              PERFORM 6510-PRINT-L41P-HEADER     THRU 6510-EXIT         28150000
           END-IF.                                                      28160000
                                                                        28170000
           MOVE SPACES                TO L41PK-REC-DETAIL.              28180000
           INITIALIZE                    L41PK-REC-DETAIL.              28190000
                                                                        28200000
           ADD  1                     TO WS-L41PK-PRINT-CNT.            28210000
           MOVE WS-L41PK-PRINT-CNT    TO L41PK-SERIAL-NO.               28220000
           MOVE F315-REGN-NO          TO L41PK-REGN-NO.                 28230000
                                                                        28240000
           STRING F315-SCH-ACC(1:4) '-'                                 28250000
                  F315-SCH-ACC(5:4) '-'                                 28260000
                  F315-SCH-ACC(9:1) '-'                                 28270000
                  F315-SCH-ACC(10:2)                                    28280000
                  DELIMITED BY SIZE INTO L41PK-SCH-ACC                  28290000
           END-STRING.                                                  28300000
                                                                        28310000
           STRING C907-NUM-DDD    '-'                                   28320000
                  C907-NUM-FIN-YR '-'                                   28330000
                  C907-NUM-VR-SERIAL                                    28340000
                  DELIMITED BY SIZE INTO L41PK-JR-VCHR-NO               28350000
           END-STRING.                                                  28360000
                                                                        28370000
           MOVE WS-AMT-EARMARK    TO L41PK-AMT-TOTAL.                   28380000
                                                                        28390000
           EVALUATE B902-CDE-ERROR-ACCT(1)                              28400000
              WHEN 'S0045'                                              28410000
                 MOVE 'B05K006 FILE ERROR'         TO L41PK-ERROR-DESC  28420000
              WHEN 'S0052'                                              28430000
                 MOVE 'INVALID INPUT      '        TO L41PK-ERROR-DESC  28440000
              WHEN 'S0053'                                              28450000
                 MOVE 'AB05K009 FILE ERROR'        TO L41PK-ERROR-DESC  28460000
              WHEN 'S0054'                                              28470000
                 MOVE 'B05K006 REC NOT FND'        TO L41PK-ERROR-DESC  28480000
              WHEN 'S0055'                                              28490000
                 MOVE 'NOT ENOUGH BALANCE'         TO L41PK-ERROR-DESC  28500000
              WHEN OTHER                                                28510000
                 MOVE 'AB05C902 SUBROUTINE ERROR'  TO L41PK-ERROR-DESC  28520000
           END-EVALUATE.                                                28530000
                                                                        28540000
           WRITE L41PK-PRINT-REC  FROM L41PK-REC-DETAIL  AFTER 1.       28550000
                                                                        28560000
           ADD   1     TO  WS-L41PK-REC-ON-PAGE-CNT.                    28570000
                                                                        28580000
       6500-EXIT.                                                       28590000
           EXIT.                                                        28600000
                                                                        28610000
                                                                        28620000
      ******************************************************************28630000
       6510-PRINT-L41P-HEADER.                                          28640000
      ******************************************************************28650000
           ADD  1      TO WS-L41PK-PAGE-CNT.                            28660000
           MOVE WS-L41PK-PAGE-CNT    TO  L41P-PAGE.                     28670000
           MOVE 'P13L41PK'           TO  L41P-REPORT-ID.                28680000
           WRITE L41PK-PRINT-REC  FROM PRT-L41P-HDG-1    AFTER PAGE.    28690000
           WRITE L41PK-PRINT-REC  FROM L41PK-HEADER2     AFTER 2.       28700000
           WRITE L41PK-PRINT-REC  FROM L41PK-HEADER3     AFTER 2.       28710000
           WRITE L41PK-PRINT-REC  FROM L41PK-UNDERLINE   AFTER 1.       28720000
           MOVE  6     TO  WS-L41PK-REC-ON-PAGE-CNT.                    28730000
                                                                        28740000
       6510-EXIT.                                                       28750000
           EXIT.                                                        28760000
                                                                        28770000
                                                                        28780000
      ******************************************************************28790000
       8000-DISPLAY-STATISTICS.                                         28800000
      ******************************************************************28810000
            MOVE    WS-BP13F315-READ-CNT  TO  WS-EDIT-BP13F315-READ.    28820000
            MOVE    WS-L41PA-PRINT-CNT    TO  WS-EDIT-L41PA-PRINT.      28830000
            MOVE    WS-L41PD-PRINT-CNT    TO  WS-EDIT-L41PD-PRINT.      28840000
            MOVE    WS-L41PE-PRINT-CNT    TO  WS-EDIT-L41PE-PRINT.      28850000
            MOVE    WS-L41PG-PRINT-CNT    TO  WS-EDIT-L41PG-PRINT.      28860000
            MOVE    WS-L41PH-PRINT-CNT    TO  WS-EDIT-L41PH-PRINT.      28870000
            MOVE    WS-L41PI-PRINT-CNT    TO  WS-EDIT-L41PI-PRINT.      28880000
            MOVE    WS-L41PJ-PRINT-CNT    TO  WS-EDIT-L41PJ-PRINT.      28890000
            MOVE    WS-AG07F225-WRITE-CNT TO  WS-EDIT-AG07F225-WRITE.   28900000
            MOVE    WS-BP13F316-WRITE-CNT TO  WS-EDIT-BP13F316-WRITE.   28910000
                                                                        28920000
            DISPLAY WS-BLANK-LINE.                                      28930000
            DISPLAY WS-SUMMARY-HEADER.                                  28940000
            DISPLAY WS-BLANK-LINE.                                      28950000
            DISPLAY WS-READ-CASES.                                      28960000
            DISPLAY WS-DOA-PAYMENT-PRINTED.                             28970000
            DISPLAY WS-L41PD-PRINTED.                                   28980000
            DISPLAY WS-L41PE-PRINTED.                                   28990000
            DISPLAY WS-L41PG-PRINTED.                                   29000000
            DISPLAY WS-L41PH-PRINTED.                                   29010000
            DISPLAY WS-L41PI-PRINTED.                                   29020000
            DISPLAY WS-L41PJ-PRINTED.                                   29030000
            DISPLAY WS-STAMP-FEES-REC-WRITTEN.                          29040000
            DISPLAY WS-F316-REC-WRITTEN.                                29050000
            DISPLAY WS-BLANK-LINE.                                      29060000
            DISPLAY WS-SUMMARY-TRAILER.                                 29070000
            DISPLAY 'NO OF RECORDS WRITTEN TO             (BP13K625) = '29080000
                    WS-BP13K625-WRITE-CNT.                              29090000
            DISPLAY 'NO OF RECS WITH ERROR IN EARMARK                = '29100000
                    WS-L41PK-PRINT-CNT.                                 29110000
                                                                        29120000
       8000-EXIT.                                                       29130000
            EXIT.                                                       29140000
                                                                        29150000
                                                                        29160000
      ******************************************************************29170000
       9000-CLOSE-FILES.                                                29180000
      ******************************************************************29190000
      *     CLOSE  B05K006                                              29200000
            CLOSE  BP13F315                                             29210000
                   BP13F316                                             29220000
                   AG07F225                                             29230000
                   BP13K413                                             29240000
                   BP1341PA                                             29250000
                   BP1341PD                                             29260000
                   BP1341PE                                             29270000
                   BP1341PG                                             29280000
                   BP1341PH                                             29290000
                   BP1341PI                                             29300000
                   BP1341PJ                                             29310000
                   BP1341PK                                             29320000
                   BP13K625.                                            29330000
                                                                        29340000
            IF WS-K006-STATUS NOT = 00 AND 97                           29350000
               DISPLAY 'ERROR CLOSING B05K006, STAT = ' WS-K006-STATUS  29360000
               MOVE     WS-K006-STATUS     TO  RETURN-CODE              29370000
            END-IF.                                                     29380000
                                                                        29390000
            IF WS-K413-STATUS NOT = 00 AND 97                           29400000
               DISPLAY 'ERROR CLOSING BP13K413, STAT = ' WS-K413-STATUS 29410000
               MOVE     WS-K413-STATUS      TO  RETURN-CODE             29420000
            END-IF.                                                     29430000
                                                                        29440000
            IF WS-K625-STATUS NOT = 00 AND 97                           29450000
              DISPLAY 'ERROR CLOSING BP13K625, STAT = ' WS-K625-STATUS  29460000
              MOVE     WS-K625-STATUS      TO  RETURN-CODE              29470000
            END-IF.                                                     29480000
                                                                        29490000
            MOVE 'AG07K960'  TO     C907-NUM-FILENME.                   29500000
            CALL 'K960CLSE'  USING  AG07C907-AREA.                      29510000
                                                                        29520000
            IF C907-NUM-FILE-STATUS NOT = ('00' AND '97')               29530000
               DISPLAY 'ERROR CLOSING AG07K960, STATUS = '              29540000
                        C907-NUM-FILE-STATUS                            29550000
               MOVE     C907-NUM-FILE-STATUS    TO     RETURN-CODE      29560000
            END-IF.                                                     29570000
                                                                        29580000
            MOVE 'BP13K620'  TO     C906-NUM-FILENME.                   29590000
            CALL 'K620MCLS'  USING  BP13C906-AREA.                      29600000
                                                                        29610000
            IF C906-NUM-FILE-STATUS NOT = ('00' AND '97')               29620000
               DISPLAY 'ERROR CLOSING BP13K620, STATUS = '              29630000
                        C906-NUM-FILE-STATUS                            29640000
               MOVE     C906-NUM-FILE-STATUS    TO     RETURN-CODE      29650000
            END-IF.                                                     29660000
                                                                        29670000
      **CALL AB05C902 TO CLOSE B05K006 AND AB05K009 FILES(CODE='C')     29680000
            MOVE SPACES              TO   WS-B902-AREA.                 29690000
            INITIALIZE                    WS-B902-AREA.                 29700000
            MOVE 'C'                 TO   B902-CDE-TYPE.                29710000
            CALL 'AB05C902'  USING WS-B902-AREA.                        29720000
                                                                        29730000
            IF B902-CDE-ERROR NOT = ZEROES                              29740000
               MOVE B902-CDE-SYSERR  TO   RETURN-CODE                   29750000
               DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'            29760000
            END-IF.                                                     29770000
                                                                        29780000
            STOP RUN.                                                   29790000
                                                                        29800000
       9000-EXIT.                                                       29810000
            EXIT.                                                       29820000
                                                                        29830000
                                                                        29840000
      ******************************************************************29850000
       9500-CONVT-AMT-WORD.                                             29860000
      ******************************************************************29870000
      *------------------------------------------------------------*    29880000
      *                                                            *    29890000
      *     OBJECTIVE  :  CONVERSION FROM AMOUNT IN DIGITS         *    29900000
      *                              INTO AMOUNT IN WORDS          *    29910000
      *                                                            *    29920000
      *------------------------------------------------------------*    29930000
            MOVE SPACES TO WF-DETAILS.                                  29940000
            MOVE ZERO   TO WS-SWITCH                                    29950000
                           WS-THO-SW                                    29960000
                           WS-CNT-SW                                    29970000
                           WS-LIT-SW                                    29980000
                           WS-TEN-SW                                    29990000
                           WS-AND-SW.                                   30000000
            MOVE 60     TO WS-PLACE-COUNTER.                            30010000
            MOVE 1      TO WF-SUB.                                      30020000
                                                                        30030000
            PERFORM B000-ROUTINE THRU B990-EXIT                         30040000
                         VARYING WS-SUB FROM 1 BY 1 UNTIL WS-SUB = 10.  30050000
                                                                        30060000
       9500-EXIT.                                                       30070000
            EXIT.                                                       30080000
                                                                        30090000
                                                                        30100000
      ******************************************************************30110000
       B000-ROUTINE SECTION.                                            30120000
      ******************************************************************30130000
       B000-GO.                                                         30140000
            IF WS-DIGIT (WS-SUB) = ZERO                                 30150000
                 IF WS-TEN-SW = ZERO                                    30160000
                    GO TO B800-MOVE-TYPE                                30170000
                 ELSE                                                   30180000
                    GO TO B010-PROCESS.                                 30190000
                                                                        30200000
            IF WS-FIRST-SUB = ZERO                                      30210000
               MOVE WS-SUB TO WS-FIRST-SUB.                             30220000
                                                                        30230000
            IF WS-SWITCH = ZERO                                         30240000
               MOVE 1 TO WS-SWITCH.                                     30250000
                                                                        30260000
       B010-PROCESS.                                                    30270000
            IF WS-SUB = 8                                               30280000
               MOVE 9 TO WS-CNT-SW.                                     30290000
                                                                        30300000
            IF WS-SUB = 9                                               30310000
               IF WS-CNT-SW = ZERO                                      30320000
                  MOVE WS-DIGIT (WS-SUB) TO WS-CNT-SW.                  30330000
                                                                        30340000
            IF WS-SUB = 2 OR 3 OR 4                                     30350000
               MOVE 1 TO WS-THO-SW.                                     30360000
                                                                        30370000
            MOVE WS-DIGIT (WS-SUB) TO WA-SUB.                           30380000
            IF WS-SUB = 3 OR 6 OR 8                                     30390000
               IF WS-DIGIT (WS-SUB) = 1                                 30400000
                  MOVE 1 TO WS-TEN-SW                                   30410000
                  GO TO B990-EXIT                                       30420000
               ELSE                                                     30430000
                  ADD 18 TO WA-SUB                                      30440000
            ELSE                                                        30450000
            IF WS-SUB = 1 OR 4 OR 7 OR 9                                30460000
               IF WS-TEN-SW = 1                                         30470000
                  MOVE 0 TO WS-TEN-SW                                   30480000
                  ADD 10 TO WA-SUB.                                     30490000
            MOVE WA-NAME (WA-SUB) TO WL-AREA.                           30500000
            PERFORM R000-LOAD-IN.                                       30510000
                                                                        30520000
       B300-TENS.                                                       30530000
            IF WS-SUB = 3 OR 6 OR 8                                     30540000
               GO TO B990-EXIT.                                         30550000
                                                                        30560000
       B400-MOVE-HUNDRED.                                               30570000
            IF WS-SUB = 2 OR 5                                          30580000
               MOVE L-HUNDRED TO WL-AREA                                30590000
               MOVE 1 TO WS-LIT-SW                                      30600000
               PERFORM R000-LOAD-IN                                     30610000
               MOVE 1 TO WS-AND-SW                                      30620000
               GO TO B990-EXIT.                                         30630000
                                                                        30640000
       B800-MOVE-TYPE.                                                  30650000
            IF WS-SWITCH = ZERO                                         30660000
               GO TO B990-EXIT.                                         30670000
                                                                        30680000
            IF WS-SUB = 1                                               30690000
               MOVE  L-MILLION TO WL-AREA                               30700000
               MOVE  1         TO WS-LIT-SW                             30710000
               MOVE  1         TO WS-AND-SW                             30720000
               GO TO B880-LOAD-IN.                                      30730000
                                                                        30740000
            IF WS-SUB = 7                                               30750000
               MOVE 1 TO WS-LIT-SW WS-AND-SW                            30760000
               IF WS-FIRST-SUB = 7  AND                                 30770000
                  WS-DIGIT (WS-SUB) = 1                                 30780000
                  MOVE L-DOLLAR TO WL-AREA                              30790000
                  GO TO B880-LOAD-IN                                    30800000
               ELSE                                                     30810000
                  MOVE L-DOLLARS TO WL-AREA                             30820000
                  GO TO B880-LOAD-IN.                                   30830000
                                                                        30840000
            IF WS-SUB = 4 AND WS-THO-SW = 1                             30850000
               MOVE 1 TO WS-AND-SW WS-LIT-SW                            30860000
               MOVE L-THOUSAND TO WL-AREA                               30870000
               GO TO B880-LOAD-IN.                                      30880000
                                                                        30890000
            IF WS-SUB = 9                                               30900000
               MOVE 1 TO WS-LIT-SW                                      30910000
               IF WS-CNT-SW = ZERO                                      30920000
                  MOVE L-ONLY TO WL-AREA                                30930000
                  GO TO B880-LOAD-IN                                    30940000
               ELSE                                                     30950000
               IF WS-CNT-SW = 1                                         30960000
                  MOVE L-CENT TO WL-AREA                                30970000
                  PERFORM R000-LOAD-IN                                  30980000
                  MOVE L-ONLY TO WL-AREA                                30990000
                  GO TO B880-LOAD-IN                                    31000000
               ELSE                                                     31010000
                  MOVE L-CENTS TO WL-AREA                               31020000
                  PERFORM R000-LOAD-IN                                  31030000
                  MOVE L-ONLY TO WL-AREA                                31040000
                  GO TO B880-LOAD-IN.                                   31050000
            GO TO B990-EXIT.                                            31060000
                                                                        31070000
       B880-LOAD-IN.                                                    31080000
            PERFORM R000-LOAD-IN.                                       31090000
                                                                        31100000
       B990-EXIT.                                                       31110000
            EXIT.                                                       31120000
                                                                        31130000
                                                                        31140000
      ******************************************************************31150000
       R000-LOAD-IN SECTION.                                            31160000
      ******************************************************************31170000
      *------------------------------------------------------------*    31180000
      *                                                            *    31190000
      *     THIS SECTION LOADS THE WORDS INTO THE THREE LINES      *    31200000
      *     AND JUST KEEPS INCREMENTING A SUBSCRIPT.               *    31210000
      *                                                            *    31220000
      *------------------------------------------------------------*    31230000
                                                                        31240000
       R001-GO.                                                         31250000
            IF WS-LIT-SW = 1                                            31260000
               MOVE ZERO TO WS-LIT-SW                                   31270000
               GO TO R050-CONT.                                         31280000
                                                                        31290000
            IF WS-SUB = 2 OR 5                                          31300000
               GO TO R050-CONT.                                         31310000
                                                                        31320000
       R025-ADD-TEST.                                                   31330000
            IF WS-AND-SW NOT = 1                                        31340000
               GO TO R050-CONT.                                         31350000
                                                                        31360000
            MOVE ZERO TO WS-AND-SW.                                     31370000
            MOVE WL-AREA TO WL-AREA-SAVE.                               31380000
            MOVE L-AND TO WL-AREA.                                      31390000
            PERFORM R200-LOADUP.                                        31400000
            MOVE WL-AREA-SAVE TO WL-AREA.                               31410000
                                                                        31420000
       R050-CONT.                                                       31430000
            PERFORM R200-LOADUP.                                        31440000
                                                                        31450000
       R099-EXIT.                                                       31460000
            EXIT.                                                       31470000
                                                                        31480000
                                                                        31490000
      ******************************************************************31500000
       R200-LOADUP SECTION.                                             31510000
      ******************************************************************31520000
       R201-GO.                                                         31530000
            ADD WL-ITEM1 WF-SUB GIVING WS-RESULT.                       31540000
            IF  WS-RESULT > WS-PLACE-COUNTER                            31550000
                ADD 1 WS-PLACE-COUNTER GIVING WF-SUB                    31560000
                ADD 60 TO WS-PLACE-COUNTER.                             31570000
                                                                        31580000
            PERFORM R500-LOAD VARYING WL-SUB FROM 2 BY 1 UNTIL          31590000
                    WL-ITEM (WL-SUB) = L-X.                             31600000
                                                                        31610000
       R490-EXIT.                                                       31620000
           EXIT.                                                        31630000
                                                                        31640000
                                                                        31650000
      ******************************************************************31660000
       R500-LOAD SECTION.                                               31670000
      ******************************************************************31680000
       R501-GO.                                                         31690000
                                                                        31700000
            MOVE WL-ITEM (WL-SUB) TO WF-ITEM (WF-SUB).                  31710000
            ADD  1                TO WF-SUB.                            31720000
            IF WL-ITEM (WL-SUB) = SPACE                                 31730000
               ADD   1     TO     WL-SUB                                31740000
               MOVE  L-X   TO     WL-ITEM (WL-SUB)                      31750000
               SUBTRACT 1  FROM   WL-SUB.                               31760000
                                                                        31770000
       R990-EXIT.                                                       31780000
            EXIT.                                                       31790000
