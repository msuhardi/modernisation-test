       IDENTIFICATION DIVISION.                                         00010000
       PROGRAM-ID.    BP13C986.                                         00020000
      *AUTHOR.        SATHAPPAN.                                        00030000
      *DATE-WRITTEN.  01/09/01.                                         00040000
      *===============================================================* 00050000
      *               SYSTEM OF COMMITMENT (BP13) *                   * 00060000
      *===============================================================* 00070000
      *                                                               * 00080000
      * OBJECTIVE :  TO UPDATE CDB TABLE BASED ON SOC TRANSACTION FILE* 00090000
      *              BP13F915 OUTPUT FROM :                           * 00100000
      *              . BP13C987 (AT TIME OF TP)                       * 00110000
      *              . BP13C989 (NEW APPLN)                           * 00120000
      *              . BP13C301, C302, C303, C358 ( UPDATE APPLN)     * 00130000
      *                                                               * 00140000
      *1. FILE DETAILS :                                              * 00150000
      *    INPUT   :  BE01KMSG  ( CDB ERROR FILE )                    * 00160000
      *    OUTPUT  :  P13F915A  ( CDB TRANSACTION FILE )              * 00170000
      *               P13F915B  ( CDB TRANSACTION FILE)               * 00180000
      *               BP13L986  ( PRINT CONTROL )                     * 00190000
      *               BP13F820  ( OCCUPIER FILE )                     * 00200000
      *                                                               * 00210000
      *2. WHEN RUNNING THIS PGOGRAM, YOU HAVE TO INCLUDE              * 00220000
      *   THE FOLLOWING FLAT FILES IN YOUR RUN JCL.                   * 00230000
      *---------------------------------------------------------------* 00240000
      *   CALL BE01C808 - UPDATING THE PERSON TABLE                   * 00250000
      *---------------------------------------------------------------* 00260000
      *     1. BE01F003 -  RECORD LENGTH - 570                        * 00270000
      *     2. BE01F903 -  RECORD LENGTH - 800                        * 00280000
      *     3. BE01F400 -  RECORD LENGTH - 160                        * 00290000
      *                                                               * 00300000
      *---------------------------------------------------------------* 00310000
      *   CALL BE01C809 - UPDATING THE MARRIAGE (MRG) TABLE           * 00320000
      *---------------------------------------------------------------* 00330000
      *     1. BE01F004 -  RECORD LENGTH - 440                        * 00340000
      *     2. BE01F904 -  RECORD LENGTH - 600                        * 00350000
      *     3. BE01F401 -  RECORD LENGTH - 160                        * 00360000
      *     4. BE01F620 -  RECORD LENGTH - 500                        * 00370000
      *                                                               * 00380000
      *     BE01F003   }-  LOG DOWN RECORDS UPDATED TO DATABASE       * 00390000
      *     BE01F004   }                                              * 00400000
      *                                                               * 00410000
      *     BE01F903   }-  LOG RECORDS WITH REJECTION (OR)            * 00420000
      *     BE01F904   }   WARNING STATUS.                            * 00430000
      *                                                               * 00440000
      *     BE01F400   }-  LOG NEW IDENTITY NO. OF SPOUSE ADDED TO    * 00450000
      *     BE01F401   }   OBTAIN:                                    * 00460000
      *                    A. PARTICULAR FROM MHA(FOR UNI/FIN)        * 00470000
      *                    B. MARRIAGE RECORDS FROM MCD               * 00480000
      *                    C. DIVORCE RECORDS FROM COURT              * 00490000
      *                                                               * 00500000
      *     BE01F620   }-   LOG FILE FOR INDIRECT UPDATES             * 00510000
      *                     CAUSED BY SOURCE SYSTEM.                  * 00520000
      *                                                               * 00530000
      *                     EXAMPLE :                                 * 00540000
      *                     DEL OF EXISTING RECORD WITH DEFAULT       * 00550000
      *                     MARRIAGE DATE IF SOURCE SYSTEM PASS       * 00560000
      *                     MARRIAGE RECORD WITH VALID DATE           * 00570000
      *                                                               * 00580000
      *---------------------------------------------------------------* 00590000
      *    TRANSACTION CODE TYPES.  ¦         DESCRIPTION.            * 00600000
      *---------------------------------------------------------------* 00610000
      * 1.      AR                  ¦ ADD CUSTOMER RECORD IN CDB      * 00620000
      * 2.      UA                  ¦ UPDATE CUSTOMER RECORD IN CDB   * 00630000
      * 3.      DE                  ¦ DELETE CUSTOMER RECORD IN CDB   * 00640000
      * 4.      CR                  ¦ CHANGE OF ROW OF EXISTING CSTMR * 00650000
      * 5.      AM                  ¦ ADD MARRIAGE RECORD IN CDB      * 00660000
      * --------------------------------------------------------------* 00670000
      *                                                               * 00680000
      * --------------------------------------------------------------* 00690000
      * CHG-NO    CHG-DATE     BY   DESCRIPTION                       * 00700000
      * ------    --------     --   -----------                       * 00710000
      * BP130850  01/09/2001   AS1  NEW PROGRAM                       * 00720000
      * BP137007  01/11/2017   SMR2 TAG NATIONALITY 'UN' WHEN BLANK   * 00730000
      * BP137326  10/05/2019   FNP1 BLANK OFF OTHER DETAILS FOR TE IN * 00740000
      *                             F915 WHEN PASSING TO CDB          * 00750000
      * BP138971  15/12/2021   KR13 CATER FOR NEW FIN SERIES 'M'      * 00751002
      ***************************************************************** 00760000
      **********************                                            00770000
       ENVIRONMENT DIVISION.                                            00780000
      **********************                                            00790000
      *----------------------*                                          00800000
       CONFIGURATION SECTION.                                           00810000
      *----------------------*                                          00820000
       SOURCE-COMPUTER. IBM-3090.                                       00830000
       OBJECT-COMPUTER. IBM-3090.                                       00840000
                                                                        00850000
      *----------------------*                                          00860000
       INPUT-OUTPUT SECTION.                                            00870000
      *----------------------*                                          00880000
                                                                        00890000
       FILE-CONTROL.                                                    00900000
                                                                        00910000
           SELECT BP13F915 ASSIGN TO BP13F915.                          00920000
                                                                        00930000
           SELECT BP13K060 ASSIGN TO BP13K060                           00940000
                  ACCESS MODE     IS DYNAMIC                            00950000
                  ORGANIZATION    IS INDEXED                            00960000
                  RECORD KEY      IS K060-KEY-FLD                       00970000
                  FILE STATUS     IS WS-K060-STATUS.                    00980000
                                                                        00990000
           SELECT BE01KMSG ASSIGN TO BE01KMSG                           01000000
                  ACCESS MODE     IS DYNAMIC                            01010000
                  ORGANIZATION    IS INDEXED                            01020000
                  RECORD KEY      IS KMSG-KEY                           01030000
                  FILE STATUS     IS WS-KMSG-STATUS.                    01040000
                                                                        01050000
           SELECT BP13F820 ASSIGN TO BP13F820.                          01060000
                                                                        01070000
           SELECT P13F915A ASSIGN TO P13F915A.                          01080000
                                                                        01090000
           SELECT P13F915B ASSIGN TO P13F915B.                          01100000
                                                                        01110000
           SELECT BP13L986 ASSIGN TO BP13L986.                          01120000
                                                                        01130000
           SELECT P13L986A ASSIGN TO P13L986A.                          01140000
                                                                        01150000
      ***************                                                   01160000
       DATA DIVISION.                                                   01170000
      ***************                                                   01180000
      *-------------*                                                   01190000
       FILE SECTION.                                                    01200000
      *-------------*                                                   01210000
                                                                        01220000
       FD  BP13F915                                                     01230000
           RECORD    CONTAINS 800 CHARACTERS                            01240000
           BLOCK     CONTAINS   0 RECORDS                               01250000
           LABEL     RECORDS  ARE STANDARD                              01260000
           RECORDING MODE     IS  F.                                    01270000
       COPY BP13F915.                                                   01280000
                                                                        01290000
       FD  BP13K060                                                     01300000
           RECORD    CONTAINS 25  CHARACTERS.                           01310000
       COPY BP13K060.                                                   01320000
                                                                        01330000
       FD  BP13F820                                                     01340000
           RECORD    CONTAINS 400 CHARACTERS                            01350000
           BLOCK     CONTAINS   0 RECORDS                               01360000
           LABEL     RECORDS  ARE STANDARD                              01370000
           RECORDING MODE     IS  F.                                    01380000
       COPY BP13F820.                                                   01390000
                                                                        01400000
       FD  BE01KMSG                                                     01410000
           RECORD    CONTAINS  75 CHARACTERS.                           01420000
       COPY BE01KMSG.                                                   01430000
                                                                        01440000
       FD  P13F915A                                                     01450000
           RECORD    CONTAINS 800 CHARACTERS                            01460000
           BLOCK     CONTAINS   0 RECORDS                               01470000
           LABEL     RECORDS  ARE STANDARD                              01480000
           RECORDING MODE     IS  F.                                    01490000
       01  WS-P13F915A-REC             PIC X(800).                      01500000
                                                                        01510000
       FD  P13F915B                                                     01520000
           RECORD    CONTAINS 800 CHARACTERS                            01530000
           BLOCK     CONTAINS   0 RECORDS                               01540000
           LABEL     RECORDS  ARE STANDARD                              01550000
           RECORDING MODE     IS  F.                                    01560000
       01  WS-P13F915B-REC             PIC X(800).                      01570000
                                                                        01580000
       FD  BP13L986                                                     01590000
           RECORD    CONTAINS 85  CHARACTERS                            01600000
           BLOCK     CONTAINS   0 RECORDS                               01610000
           LABEL     RECORDS  ARE OMITTED                               01620000
           RECORDING MODE     IS  F.                                    01630000
       01  WS-BP13L986-REC             PIC X(85).                       01640000
                                                                        01650000
       FD  P13L986A                                                     01660000
           RECORD    CONTAINS 132 CHARACTERS                            01670000
           BLOCK     CONTAINS   0 RECORDS                               01680000
           LABEL     RECORDS  ARE OMITTED                               01690000
           RECORDING MODE     IS  F.                                    01700000
       01  WS-P13L986A-REC             PIC X(132).                      01710000
                                                                        01720000
      *-------------------------*                                       01730000
       WORKING-STORAGE SECTION.                                         01740000
      *------------------------*                                        01750000
                                                                        01760000
       01  FILE-STATUS.                                                 01770000
           03  WS-K060-STATUS          PIC 9(02)  VALUE 0.              01780000
           03  WS-KMSG-STATUS          PIC 9(02)  VALUE ZEROES.         01790000
                                                                        01800000
       01  WS-SWITCHES.                                                 01810000
           03  F915-EOF-IND            PIC X       VALUE SPACES.        01820000
               88 F915-EOF             VALUE 'Y'.                       01830000
                                                                        01840000
       01  WS-ACCUMULATORS.                                             01850000
           03  WS-NO-WRT-F820          PIC 9(6)    VALUE ZEROES.        01860000
           03  WS-NO-READ-F915         PIC 9(10)   VALUE ZEROES.        01870000
           03  WS-AR-INPUT             PIC 9(10)   VALUE ZEROES.        01880000
           03  WS-AM-INPUT             PIC 9(10)   VALUE ZEROES.        01890000
           03  WS-UA-INPUT             PIC 9(10)   VALUE ZEROES.        01900000
           03  WS-DE-INPUT             PIC 9(10)   VALUE ZEROES.        01910000
           03  WS-TE-INPUT             PIC 9(10)   VALUE ZEROES.        01920000
           03  WS-NO-WRT-CDB-PERSON    PIC 9(10)   VALUE ZEROES.        01930000
           03  WS-NO-UPD-CDB-PERSON    PIC 9(10)   VALUE ZEROES.        01940000
           03  WS-NO-DEL-CDB-PERSON    PIC 9(10)   VALUE ZEROES.        01950000
           03  WS-NO-TE-CDB-PERSON     PIC 9(10)   VALUE ZEROES.        01960000
           03  WS-NO-EXIST-CDB-PERSON  PIC 9(10)   VALUE ZEROES.        01970000
           03  WS-NO-WRT-CDB-MARRIAGE  PIC 9(10)   VALUE ZEROES.        01980000
           03  WS-NO-EXIST-CDB-MRG     PIC 9(10)   VALUE ZEROES.        01990000
           03  WS-NO-WRT-F915A-REC     PIC 9(10)   VALUE ZEROES.        02000000
           03  WS-NO-WRT-F915B-REC     PIC 9(10)   VALUE ZEROES.        02010000
           03  WS-NO-WRT-L986A-REC     PIC 9(10)   VALUE ZEROES.        02020000
           03  WS-NO-AR-FAIL-REC       PIC 9(10)   VALUE ZEROES.        02030000
           03  WS-NO-AM-FAIL-REC       PIC 9(10)   VALUE ZEROES.        02040000
                                                                        02050000
       01  WS-TEMP.                                                     02060000
           05  WS-DTE                  PIC X(15) VALUE SPACES.          02070000
           05  WS-SYS-DATE             PIC 9(08) VALUE ZEROES.          02080000
           05  WS-ERROR-PGM            PIC X(30) VALUE SPACES.          02090000
           05  WS-MSG.                                                  02100000
               10 FILLER               PIC X(02) VALUE SPACES.          02110000
               10 WS-MSGNO             PIC X(04).                       02120000
               10 FILLER               PIC X(03) VALUE SPACES.          02130000
               10 WS-MSG-TEXT          PIC X(70).                       02140000
           05  WS-NUM-TRANS-CODE       PIC X(02) VALUE SPACES.          02150000
           05  WS-NUM-NRIC             PIC X(09) VALUE SPACES.          02160000
           05  WS-PREV-REGN            PIC X(08) VALUE SPACES.          02170000
           05  WS-NUM-IDNTY-NO-TYPE    PIC X(03) VALUE SPACES.          02180000
           05  WS-C993-OK              PIC X(01) VALUE 'Y'.             02190000
           05  WS-C808-OK              PIC X(01) VALUE 'Y'.             02200000
           05  WS-C809-OK              PIC X(01) VALUE 'Y'.             02210000
           05  WS-COMMIT-OK            PIC X(01) VALUE 'Y'.             02220000
           05  WS-F915A-OK             PIC X(01) VALUE 'Y'.             02230000
           05  WS-AR-REGN-NO           PIC X(08) VALUE SPACES.          02240000
           05  WS-AR-NRIC-NO           PIC X(09) VALUE SPACES.          02250000
           05  WS-NUM-CSTMR            PIC X(09) VALUE SPACES.          02260000
                                                                        02270000
       01  WS-ERROR-REPORT.                                             02280000
           05 WS-LINE-CTR              PIC 9(6) VALUE 65.               02290000
           05 WS-PAGE-CTR              PIC 9(5) VALUE ZEROES.           02300000
           05 WS-SEQN-CTR              PIC 9(6) VALUE ZEROES.           02310000
                                                                        02320000
       01  WS-PRINT-HDG1.                                               02330000
           05 FILLER                   PIC X(8)  VALUE 'BP13L986'.      02340000
           05 FILLER                   PIC X(3)  VALUE SPACES.          02350000
           05 FILLER                   PIC X(51) VALUE                  02360000
              'CONTROL LIST FOR CDB PERSON & MARRIAGE TABLES  '.        02370000
           05 FILLER                   PIC X(7)  VALUE 'DATE : '.       02380000
           05 WS-PRINT-DATE            PIC X(10) VALUE SPACES.          02390000
                                                                        02400000
       01  WS-PRINT-REC.                                                02410000
           05 FILLER                   PIC X(10) VALUE SPACES.          02420000
           05 WS-PRINT-DESC            PIC X(53) VALUE SPACES.          02430000
           05 WS-PRINT-TOTAL           PIC Z,ZZZ,ZZZ,ZZ9.               02440000
                                                                        02450000
       01  WS-BP13F915-REC.                                             02460000
           05 WS-F915-TXN-TYPE         PIC X(02)  VALUE SPACES.         02470000
           05 WS-F915-NUM-BSNS-REF     PIC X(15)  VALUE SPACES.         02480000
           05 WS-F915-NUM-IDNTY-NO     PIC X(20)  VALUE SPACES.         02490000
           05 FILLER                   PIC X(178) VALUE SPACES.         02500000
           05 WS-F915-NUM-IDNTY-NO-SP  PIC X(20)  VALUE SPACES.         02510000
           05 FILLER                   PIC X(12)  VALUE SPACES.         02520000
           05 WS-F915-NME-SP           PIC X(66)  VALUE SPACES.         02530000
           05 FILLER                   PIC X(487) VALUE SPACES.         02540000
                                                                        02550000
       01  WS-F915-TEMP.                                                02560000
           05 WS-TXN-TYPE              PIC X(02)  VALUE SPACES.         02570000
           05 WS-NUM-BSNS-REF          PIC X(15)  VALUE SPACES.         02580000
           05 WS-NUM-IDNTY-NO          PIC X(20)  VALUE SPACES.         02590000
           05 WS-NUM-IDNTY-NO-SP       PIC X(20)  VALUE SPACES.         02600000
           05 WS-NME-SP                PIC X(66)  VALUE SPACES.         02610000
                                                                        02620000
      *----------------------*                                          02630000
      *   ERROR REPORT LAYOUT                                           02640000
      *----------------------*                                          02650000
                                                                        02660000
       01  L986A-PR-HEAD-01.                                            02670000
           05  FILLER              PIC X(8)      VALUE 'P13L986A'.      02680000
           05  FILLER              PIC X(5)      VALUE SPACES .         02690000
           05  FILLER              PIC X(8)      VALUE 'HDBCAT 3'.      02700000
           05  FILLER              PIC X(24)     VALUE SPACES.          02710000
           05  FILLER              PIC X(20)     VALUE                  02720000
                                    'S Y S T E M   O F   '.             02730000
           05  FILLER              PIC X(19)     VALUE                  02740000
                                    'C O M M I T M E N T'.              02750000
           05  FILLER              PIC X(15)     VALUE SPACES.          02760000
           05  FILLER              PIC X(7)      VALUE 'DATE :'.        02770000
           05  L986A-DATE-RUN      PIC X(10).                           02780000
           05  FILLER              PIC X(4)      VALUE SPACES.          02790000
           05  FILLER              PIC X(7)      VALUE 'PAGE : '.       02800000
           05  L986A-PAGENO        PIC ZZZZ9 .                          02810000
                                                                        02820000
       01  L986A-PR-HEAD-02.                                            02830000
           05  FILLER              PIC X(20)     VALUE SPACES .         02840000
           05  FILLER              PIC X(100)    VALUE                  02850000
               'PRINT ERROR REPORT OF   ADD MARRIAGE W/O NEW ROLE  AND  02860000
      -        'MARRIED WITH INCOMPLETE SPOUSE INFO'.                   02870000
                                                                        02880000
       01  L986A-PR-HEAD-03.                                            02890000
           05  FILLER              PIC X(06)   VALUE 'S/NO'.            02900000
           05  FILLER              PIC X(02)   VALUE SPACES.            02910000
           05  FILLER              PIC X(07)   VALUE 'REGN NO'.         02920000
           05  FILLER              PIC X(03)   VALUE SPACES.            02930000
           05  FILLER              PIC X(07)   VALUE 'TRAN ID'.         02940000
           05  FILLER              PIC X(02)   VALUE SPACES.            02950000
           05  FILLER              PIC X(04)   VALUE 'NRIC'.            02960000
           05  FILLER              PIC X(07)   VALUE SPACES.            02970000
           05  FILLER              PIC X(07)   VALUE 'SP NRIC'.         02980000
           05  FILLER              PIC X(04)   VALUE SPACES.            02990000
           05  FILLER              PIC X(50)   VALUE 'SPNAME'.          03000000
           05  FILLER              PIC X(02)   VALUE SPACES.            03010000
           05  FILLER              PIC X(06)   VALUE 'REASON'.          03020000
           05  FILLER              PIC X(31)   VALUE SPACES.            03030000
                                                                        03040000
       01  L986A-PR-DTL-01.                                             03050000
           05  L986A-SNO           PIC ZZZZZZ  VALUE ZEROES.            03060000
           05  FILLER              PIC X(02)   VALUE SPACES.            03070000
           05  L986A-REGN-NO       PIC X(08)   VALUE SPACES.            03080000
           05  FILLER              PIC X(02)   VALUE SPACES.            03090000
           05  L966A-TRANS-ID      PIC X(02)   VALUE SPACES.            03100000
           05  FILLER              PIC X(07)   VALUE SPACES.            03110000
           05  L986A-NRIC-NO       PIC X(09)   VALUE SPACES.            03120000
           05  FILLER              PIC X(02)   VALUE SPACES.            03130000
           05  L986A-SP-NRIC-NO    PIC X(09)   VALUE SPACES.            03140000
           05  FILLER              PIC X(02)   VALUE SPACES.            03150000
           05  L986A-SP-NAME       PIC X(50)   VALUE SPACES.            03160000
           05  FILLER              PIC X(02)   VALUE SPACES.            03170000
           05  L986A-REASON        PIC X(31)   VALUE SPACES.            03180000
           05  FILLER              PIC X(05)   VALUE SPACES.            03190000
                                                                        03200000
       01  L986A-PR-LINE           PIC X(132)  VALUE ALL '-'.           03210000
                                                                        03220000
       01  L986A-PR-FOOTER.                                             03230000
           05  FILLER              PIC X(32)     VALUE SPACES .         03240000
           05  FILLER              PIC X(45)     VALUE                  03250000
               ' ********  NO RECORD FOUND  ********'.                  03260000
                                                                        03270000
       COPY BE01W808.                                                   03280000
       COPY BE01W809.                                                   03290000
       COPY BE01W993.                                                   03300000
       COPY TABCITZ.                                                    03310000
                                                                        03320000
            EXEC SQL INCLUDE SQLCA     END-EXEC.                        03330000
            EXEC SQL INCLUDE P13PERSN  END-EXEC.                        03340000
                                                                        03350000
      ********************                                              03360000
       PROCEDURE DIVISION.                                              03370000
      ********************                                              03380000
      *----------------*                                                03390000
       0000-MAIN-PROCESS.                                               03400000
      *----------------*                                                03410000
                                                                        03420000
             PERFORM 1000-OPEN-ROUTINE        THRU 1000-EXIT.           03430000
             PERFORM 2000-READ-BP13F915       THRU 2000-EXIT.           03440000
             PERFORM 3000-CALL-CDB-ROUTINE    THRU 3000-EXIT            03450000
               UNTIL F915-EOF.                                          03460000
             PERFORM 7500-CHECK-PRINT-REPORT  THRU 7500-EXIT.           03470000
             PERFORM 9020-PRINT-CONTROL       THRU 9020-EXIT.           03480000
             PERFORM 9999-CLOSE-ROUTINE       THRU 9999-EXIT.           03490000
                                                                        03500000
       0000-EXIT.                                                       03510000
           EXIT.                                                        03520000
                                                                        03530000
      *----------------*                                                03540000
       1000-OPEN-ROUTINE.                                               03550000
      *----------------*                                                03560000
                                                                        03570000
           OPEN       INPUT   BE01KMSG                                  03580000
                              BP13F915                                  03590000
                              BP13K060                                  03600000
                      OUTPUT  BP13F820                                  03610000
                              BP13L986                                  03620000
                              P13F915A                                  03630000
                              P13F915B                                  03640000
                              P13L986A.                                 03650000
                                                                        03660000
           IF WS-KMSG-STATUS NOT = ZEROS AND '97'                       03670000
              DISPLAY ' ERROR OPENING BE01KMSG  FILE, STATUS '          03680000
                                                  WS-KMSG-STATUS        03690000
              MOVE WS-KMSG-STATUS            TO   RETURN-CODE           03700000
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT             03710000
           END-IF.                                                      03720000
                                                                        03730000
           IF WS-K060-STATUS NOT = ZEROS AND '97'                       03740000
              DISPLAY ' ERROR OPENING BP13K060  FILE, STATUS '          03750000
                                                  WS-K060-STATUS        03760000
              MOVE WS-K060-STATUS            TO   RETURN-CODE           03770000
              PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT             03780000
           END-IF.                                                      03790000
                                                                        03800000
           PERFORM 1100-OPEN-CDB-ROUTINE     THRU 1100-EXIT.            03810000
                                                                        03820000
           MOVE   FUNCTION CURRENT-DATE(1:8) TO   WS-SYS-DATE.          03830000
           STRING WS-SYS-DATE(7:2) '/'                                  03840000
                  WS-SYS-DATE(5:2) '/'                                  03850000
                  WS-SYS-DATE(1:4)                                      03860000
                  DELIMITED BY SIZE          INTO L986A-DATE-RUN.       03870000
                                                                        03880000
       1000-EXIT.                                                       03890000
           EXIT.                                                        03900000
                                                                        03910000
      *---------------------*                                           03920000
       1100-OPEN-CDB-ROUTINE.                                           03930000
      *---------------------*                                           03940000
                                                                        03950000
           MOVE 'OPENS'                      TO   BE01W808-IN-RTN-FXN.  03960000
           CALL 'BE01C808' USING BE01W808-COMMAREA.                     03970000
                                                                        03980000
           IF  BE01W808-OUT-RTN-ACTION = 'S'                            03990000
               MOVE    'BE01C808 - FILE OPEN ERROR'                     04000000
                                             TO   WS-ERROR-PGM          04010000
               PERFORM 9900-DISPLAY-CDB-ERROR THRU 9900-EXIT            04020000
               PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT            04030000
           END-IF.                                                      04040000
                                                                        04050000
                                                                        04060000
           MOVE 'OPENS'                      TO   BE01W809-IN-RTN-FXN.  04070000
           CALL 'BE01C809' USING BE01W809-COMMAREA.                     04080000
                                                                        04090000
           IF  BE01W809-OUT-RTN-ACTION = 'S'                            04100000
               MOVE    'BE01C809 - FILE OPEN ERROR'                     04110000
                                             TO   WS-ERROR-PGM          04120000
               PERFORM 9900-DISPLAY-CDB-ERROR THRU 9900-EXIT            04130000
               PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT            04140000
           END-IF.                                                      04150000
                                                                        04160000
       1100-EXIT.                                                       04170000
            EXIT.                                                       04180000
                                                                        04190000
      *-----------------*                                               04200000
       2000-READ-BP13F915.                                              04210000
      *-----------------*                                               04220000
                                                                        04230000
           READ BP13F915 AT END  MOVE 'Y' TO F915-EOF-IND               04240000
                         GO TO 2000-EXIT.                               04250000
                                                                        04260000
           ADD 1 TO WS-NO-READ-F915.                                    04270000
                                                                        04280000
           EVALUATE F915-TXN-TYPE                                       04290000
              WHEN  'AR'                                                04300000
                     ADD 1 TO WS-AR-INPUT                               04310000
              WHEN  'AM'                                                04320000
                     ADD 1 TO WS-AM-INPUT                               04330000
              WHEN  'UA'                                                04340000
                     ADD 1 TO WS-UA-INPUT                               04350000
              WHEN  'DE'                                                04360000
                     ADD 1 TO WS-DE-INPUT                               04370000
              WHEN  'TE'                                                04380000
                     ADD 1 TO WS-TE-INPUT                               04390000
           END-EVALUATE.                                                04400000
                                                                        04410000
       2000-EXIT.                                                       04420000
           EXIT.                                                        04430000
                                                                        04440000
      *---------------------*                                           04450000
       3000-CALL-CDB-ROUTINE.                                           04460000
      *---------------------*                                           04470000
                                                                        04480000
           PERFORM  3010-INITIALIZE-PARA        THRU  3010-EXIT.        04490000
           PERFORM  3020-INITZE-CDB-ROUTINE     THRU  3020-EXIT.        04500000
                                                                        04510000
           MOVE  F915-NUM-BSNS-REF          TO   WS-AR-REGN-NO.         04520000
           MOVE  F915-NUM-IDNTY-NO          TO   WS-AR-NRIC-NO.         04530000
                                                                        04540000
           EVALUATE F915-TXN-TYPE                                       04550000
               WHEN 'AR'                                                04560000
                                                                        04570000
                    PERFORM 4000-AR-PERSON-DETAIL  THRU  4000-EXIT      04580000
                      UNTIL F915-NUM-BSNS-REF NOT = WS-AR-REGN-NO       04590000
                         OR F915-EOF                                    04600000
                         OR (F915-TXN-TYPE NOT = 'AR' AND 'AM')         04610000
                         OR WS-COMMIT-OK = 'N'                          04620000
                                                                        04630000
                    IF  WS-COMMIT-OK = 'Y'                              04640000
                        PERFORM 9100-COMMIT-RECORDS THRU 9100-EXIT      04650000
                    ELSE                                                04660000
                        PERFORM 8500-WRITE-P13F915A   THRU 8500-EXIT    04670000
                        PERFORM 9200-ROLLBACK-RECORDS THRU 9200-EXIT    04680000
                        PERFORM 2000-READ-BP13F915    THRU 2000-EXIT    04690000
                          UNTIL F915-NUM-BSNS-REF NOT = WS-AR-REGN-NO   04700000
                             OR F915-EOF                                04710000
                    END-IF                                              04720000
                                                                        04730000
               WHEN 'UA'                                                04740000
                                                                        04750000
                    PERFORM 5000-UA-PERSON-DETAIL    THRU  5000-EXIT    04760000
                                                                        04770000
                    IF WS-C993-OK = 'Y' AND WS-C808-OK = 'Y'            04780000
                       PERFORM 9100-COMMIT-RECORDS   THRU 9100-EXIT     04790000
                       ADD  1    TO    WS-NO-UPD-CDB-PERSON             04800000
                    ELSE                                                04810000
                       PERFORM 8500-WRITE-P13F915A   THRU 8500-EXIT     04820000
                       PERFORM 9200-ROLLBACK-RECORDS THRU 9200-EXIT     04830000
                    END-IF                                              04840000
                                                                        04850000
                    PERFORM  2000-READ-BP13F915 THRU 2000-EXIT          04860000
                                                                        04870000
               WHEN 'DE'                                                04880000
                                                                        04890000
                    PERFORM 6000-DE-F915-TO-CDB    THRU  6000-EXIT      04900000
                                                                        04910000
                    IF WS-C808-OK = 'Y'                                 04920000
                       PERFORM 9100-COMMIT-RECORDS THRU  9100-EXIT      04930000
                       ADD  1    TO    WS-NO-DEL-CDB-PERSON             04940000
                    ELSE                                                04950000
                       PERFORM 8500-WRITE-P13F915A   THRU 8500-EXIT     04960000
                       PERFORM 9200-ROLLBACK-RECORDS THRU 9200-EXIT     04970000
                    END-IF                                              04980000
                                                                        04990000
                    PERFORM  2000-READ-BP13F915 THRU 2000-EXIT          05000000
                                                                        05010000
               WHEN 'TE'                                                05020000
                                                                        05030000
                    PERFORM 7000-TE-F915-TO-CDB      THRU  7000-EXIT    05040000
                                                                        05050000
                    IF WS-C808-OK = 'Y'                                 05060000
                       PERFORM 9100-COMMIT-RECORDS THRU  9100-EXIT      05070000
                       ADD  1    TO    WS-NO-TE-CDB-PERSON              05080000
                    ELSE                                                05090000
                       PERFORM 8500-WRITE-P13F915A   THRU 8500-EXIT     05100000
                       PERFORM 9200-ROLLBACK-RECORDS THRU 9200-EXIT     05110000
                    END-IF                                              05120000
                                                                        05130000
                    PERFORM  2000-READ-BP13F915 THRU 2000-EXIT          05140000
                                                                        05150000
               WHEN 'AM'                                                05160000
                                                                        05170000
                     MOVE SPACES                 TO  WS-BP13F915-REC    05180000
                     MOVE BP13F915-REC           TO  WS-BP13F915-REC    05190000
                                                                        05200000
                     MOVE WS-F915-TXN-TYPE        TO WS-TXN-TYPE        05210000
                     MOVE WS-F915-NUM-BSNS-REF    TO WS-NUM-BSNS-REF    05220000
                     MOVE WS-F915-NUM-IDNTY-NO    TO WS-NUM-IDNTY-NO    05230000
                     MOVE WS-F915-NUM-IDNTY-NO-SP TO WS-NUM-IDNTY-NO-SP 05240000
                     MOVE WS-F915-NME-SP          TO WS-NME-SP          05250000
                                                                        05260000
                     MOVE 'ADD MARRIAGE W/O NEW ROLE ' TO L986A-REASON  05270000
                     PERFORM 8100-PRINT-ERROR-REPORT THRU 8100-EXIT     05280000
                                                                        05290000
                     PERFORM 2000-READ-BP13F915   THRU 2000-EXIT        05300000
                                                                        05310000
           END-EVALUATE.                                                05320000
                                                                        05330000
                                                                        05340000
       3000-EXIT.                                                       05350000
           EXIT.                                                        05360000
                                                                        05370000
      *--------------------*                                            05380000
       3010-INITIALIZE-PARA.                                            05390000
      *--------------------*                                            05400000
                                                                        05410000
           MOVE    'Y'         TO   WS-C993-OK.                         05420000
           MOVE    'Y'         TO   WS-C808-OK.                         05430000
           MOVE    'Y'         TO   WS-C809-OK.                         05440000
                                                                        05450000
           MOVE    'Y'         TO   WS-COMMIT-OK.                       05460000
           MOVE    'Y'         TO   WS-F915A-OK.                        05470000
                                                                        05480000
       3010-EXIT.                                                       05490000
            EXIT.                                                       05500000
                                                                        05510000
      *------------------------*                                        05520000
       3020-INITZE-CDB-ROUTINE.                                         05530000
      *------------------------*                                        05540000
                                                                        05550000
           MOVE    SPACES      TO   BE01W993-COMMAREA.                  05560000
           MOVE    SPACES      TO   BE01W808-COMMAREA.                  05570000
           MOVE    SPACES      TO   BE01W809-COMMAREA.                  05580000
                                                                        05590000
           INITIALIZE BE01W993-COMMAREA.                                05600000
           INITIALIZE BE01W808-COMMAREA.                                05610000
           INITIALIZE BE01W809-COMMAREA.                                05620000
                                                                        05630000
       3020-EXIT.                                                       05640000
            EXIT.                                                       05650000
                                                                        05660000
      *------------------*                                              05670000
       3030-GET-DATETIME.                                               05680000
      *------------------*                                              05690000
                                                                        05700000
           MOVE SPACES                   TO WS-MSGNO.                   05710000
           MOVE FUNCTION CURRENT-DATE    TO WS-DTE .                    05720000
                                                                        05730000
           IF F915-TXN-TYPE = 'AR' OR 'UA' OR 'DE' OR 'TE'              05740000
              STRING WS-DTE(1:4) '-' WS-DTE(5:2) '-'                    05750000
                     WS-DTE(7:2) DELIMITED BY SIZE                      05760000
                     INTO  BE01W808-IN-DTE-UPDATE-SOURCE                05770000
                                                                        05780000
              STRING WS-DTE(9:2) '.' WS-DTE(11:2) '.' WS-DTE(13:2)      05790000
                     DELIMITED BY SIZE INTO                             05800000
                     BE01W808-IN-TME-UPDATE-SOURCE                      05810000
           END-IF.                                                      05820000
                                                                        05830000
           IF F915-TXN-TYPE = 'AM'                                      05840000
              STRING WS-DTE(1:4) '-' WS-DTE(5:2) '-'                    05850000
                     WS-DTE(7:2) DELIMITED BY SIZE                      05860000
                     INTO  BE01W809-IN-DTE-UPDATE-SOURCE                05870000
                                                                        05880000
              STRING WS-DTE(9:2) '.' WS-DTE(11:2) '.' WS-DTE(13:2)      05890000
                     DELIMITED BY SIZE INTO                             05900000
                     BE01W809-IN-TME-UPDATE-SOURCE                      05910000
           END-IF.                                                      05920000
                                                                        05930000
       3030-EXIT.                                                       05940000
           EXIT.                                                        05950000
                                                                        05960000
      *----------------------*                                          05970000
       3040-CONVERT-ID-TYPE.                                            05980000
      *----------------------*                                          05990000
                                                                        06000000
           MOVE F915-NUM-IDNTY-NO    TO  WS-NUM-NRIC                    06010000
                                                                        06020000
           IF WS-NUM-NRIC(1:1) = 'S' OR 'T'                             06030000
              MOVE 'UIN'            TO   WS-NUM-IDNTY-NO-TYPE           06040000
           ELSE                                                         06050000
              IF WS-NUM-NRIC(1:1) = 'G' OR 'F' OR 'M'                   06060001
                 MOVE 'FIN'         TO   WS-NUM-IDNTY-NO-TYPE           06070000
              ELSE                                                      06080000
                 MOVE 'XIN'         TO   WS-NUM-IDNTY-NO-TYPE           06090000
              END-IF                                                    06100000
           END-IF.                                                      06110000
                                                                        06120000
           MOVE WS-NUM-IDNTY-NO-TYPE TO  BE01W993-IN-NUM-IDNTY-NO-TYPE  06130000
                                         BE01W808-IN-NUM-IDNTY-NO-TYPE  06140000
                                         BE01W809-IN-CSTMR-IDNTY-TYPE   06150000
                                         F915-NUM-IDNTY-NO-TYPE         06160000
                                                                        06170000
           IF F915-NUM-IDNTY-NO (1:1) = 'S' OR 'T' OR 'F' OR 'G' OR 'M' 06180001
              MOVE F915-NUM-IDNTY-NO      TO BE01W993-IN-NUM-IDNTY-NO   06190000
                                             BE01W808-IN-NUM-IDNTY-NO   06200000
                                             BE01W809-IN-CSTMR-IDNTY-NO 06210000
           ELSE                                                         06220000
              MOVE F915-NUM-IDNTY-NO(2:8) TO BE01W993-IN-NUM-IDNTY-NO   06230000
                                             BE01W808-IN-NUM-IDNTY-NO   06240000
                                             BE01W809-IN-CSTMR-IDNTY-NO 06250000
                                                                        06260000
              MOVE F915-NME-PERSON      TO BE01W993-IN-NME-PERSON       06270000
                                           BE01W808-IN-NME-PERSON       06280000
                                           BE01W809-IN-CSTMR-NME-PERSON 06290000
           END-IF.                                                      06300000
                                                                        06310000
       3040-EXIT.                                                       06320000
            EXIT.                                                       06330000
                                                                        06340000
      *------------------*                                              06350000
       3050-READ-BE01KMSG.                                              06360000
      *------------------*                                              06370000
                                                                        06380000
            INITIALIZE KMSG-INFO.                                       06390000
            MOVE    WS-MSGNO             TO  KMSG-KEY.                  06400000
            READ BE01KMSG.                                              06410000
            EVALUATE  WS-KMSG-STATUS                                    06420000
                WHEN '00'                                               06430000
                     MOVE KMSG-KEY       TO  WS-MSGNO                   06440000
                     MOVE KMSG-TXT-MSG   TO  WS-MSG-TEXT                06450000
                WHEN '23'                                               06460000
                     MOVE 'MSG NO NOT FOUND - BE01KMSG'  TO KMSG-KEY    06470000
                WHEN  OTHER                                             06480000
                     MOVE 'READING ERROR IN BE01KMSG'    TO KMSG-KEY    06490000
            END-EVALUATE.                                               06500000
                                                                        06510000
       3050-EXIT.                                                       06520000
            EXIT.                                                       06530000
                                                                        06540000
      *---------------------*                                           06550000
       4000-AR-PERSON-DETAIL.                                           06560000
      *---------------------*                                           06570000
                                                                        06580000
           MOVE     F915-NUM-BSNS-REF       TO   WS-AR-REGN-NO.         06590000
           MOVE     F915-NUM-IDNTY-NO       TO   WS-AR-NRIC-NO.         06600000
                                                                        06610000
           PERFORM  3020-INITZE-CDB-ROUTINE THRU 3020-EXIT.             06620000
           PERFORM  4100-CALL-BE01C993      THRU 4100-EXIT.             06630000
           PERFORM  4200-AR-F915-TO-CDB     THRU 4200-EXIT.             06640000
           PERFORM  4300-CALL-BE01C809      THRU 4300-EXIT.             06650000
                                                                        06660000
           IF WS-C993-OK = 'Y' AND WS-C808-OK = 'Y' AND WS-C809-OK = 'Y'06670000
              PERFORM 4500-WRITE-BP13F820 THRU 4500-EXIT                06680000
              PERFORM 2000-READ-BP13F915  THRU 2000-EXIT                06690000
              ADD  1   TO WS-NO-WRT-CDB-PERSON                          06700000
           ELSE                                                         06710000
              MOVE 'N' TO WS-COMMIT-OK                                  06720000
           END-IF.                                                      06730000
                                                                        06740000
       4000-EXIT.                                                       06750000
            EXIT.                                                       06760000
                                                                        06770000
      *----------------------------------------------------------------*06780000
      * RTN-ACTION ¦   MSG NO. AND MSG TEXT                            *06790000
      *----------------------------------------------------------------*06800000
      *   'R'      ¦   0008 - INVALID OPTION                           *06810000
      *            ¦   0068 - INPUT REQUIRED IDENTITY NUMBER           *06820000
      *            ¦   0020 - INPUT REQUIRED IDENTITY TYPE             *06830000
      *            ¦   0021 - INPUT REQUIRED NAME                      *06840000
      *-----------------------------------------------------------------06850000
      *-----------------*                                               06860000
       4100-CALL-BE01C993.                                              06870000
      *-----------------*                                               06880000
                                                                        06890000
           PERFORM 3040-CONVERT-ID-TYPE    THRU 3040-EXIT.              06900000
                                                                        06910000
           MOVE    'OBTID'            TO  BE01W993-IN-RTN-FXN.          06920000
                                                                        06930000
           CALL 'BE01C993' USING  BE01W993-COMMAREA.                    06940000
                                                                        06950000
           IF BE01W993-OUT-RTN-ACTION = 'S'                             06960000
              PERFORM 9000-SQL-ERROR      THRU 9000-EXIT                06970000
           END-IF.                                                      06980000
                                                                        06990000
           IF BE01W993-OUT-RTN-ACTION = 'R'                             07000000
              MOVE BE01W993-OUT-RTN-MSGNO   TO   WS-MSGNO               07010000
              MOVE 'N'                      TO   WS-C993-OK             07020000
                                                                        07030000
              PERFORM 3050-READ-BE01KMSG    THRU 3050-EXIT              07040000
              DISPLAY 'CALLING BE01C993 - ERROR'                        07050000
              DISPLAY 'ERROR TYPE       : ' BE01W993-OUT-RTN-ACTION     07060000
              DISPLAY 'PROGRAM ID       : ' BE01W993-OUT-RTN-PGMID      07070000
              DISPLAY 'ERROR MESSAGE NO : ' WS-MSGNO   '-' WS-MSG-TEXT  07080000
              DISPLAY 'ERROR STATUS CODE: ' BE01W993-OUT-RTN-STATCDE    07090000
              DISPLAY 'HDBREF           : ' F915-NUM-REGN               07100000
              DISPLAY 'IDNTY NO         : ' F915-NUM-NRIC               07110000
                                                                        07120000
           ELSE                                                         07130000
      *                                                                 07140000
      *    CUSTOMER ALREADY EXIST                                       07150000
      *                                                                 07160000
              IF BE01W993-OUT-NUM-CSTMR-TAG = 'E'                       07170000
                 MOVE BE01W993-OUT-NUM-CSTMR TO WS-NUM-CSTMR            07180000
                 PERFORM 4110-RETRIEVE-PERSON-TBL THRU 4110-EXIT        07190000
              ELSE                                                      07200000
                 PERFORM 4120-MOVE-PERSON-INFO THRU 4120-EXIT           07210000
              END-IF                                                    07220000
           END-IF.                                                      07230000
                                                                        07240000
       4100-EXIT.                                                       07250000
            EXIT.                                                       07260000
                                                                        07270000
      *------------------------*                                        07280000
       4110-RETRIEVE-PERSON-TBL.                                        07290000
      *------------------------*                                        07300000
                                                                        07310000
            EXEC SQL                                                    07320000
                 SELECT  NME_PERSON ,                                   07330000
                         NUM_NTNLTY ,                                   07340000
                         NUM_PR_STATUS ,                                07350000
                         NUM_SEX ,                                      07360000
                         NUM_ETHNIC_GROUP ,                             07370000
                         NUM_MRTL_STATUS ,                              07380000
                         DTE_BIRTH ,                                    07390000
                         NUM_CSTMR ,                                    07400000
                         NUM_PRTCLR_LOCK                                07410000
                   INTO  :DCLPERSONS.NME-PERSON ,                       07420000
                         :DCLPERSONS.NUM-NTNLTY ,                       07430000
                         :DCLPERSONS.NUM-PR-STATUS ,                    07440000
                         :DCLPERSONS.NUM-SEX ,                          07450000
                         :DCLPERSONS.NUM-ETHNIC-GROUP ,                 07460000
                         :DCLPERSONS.NUM-MRTL-STATUS ,                  07470000
                         :DCLPERSONS.DTE-BIRTH ,                        07480000
                         :DCLPERSONS.NUM-CSTMR  ,                       07490000
                         :DCLPERSONS.NUM-PRTCLR-LOCK                    07500000
                   FROM  PERSONS                                        07510000
                   WHERE NUM_CSTMR = :WS-NUM-CSTMR                      07520000
            END-EXEC.                                                   07530000
                                                                        07540000
            EVALUATE SQLCODE                                            07550000
             WHEN 000                                                   07560000
                  IF NUM-PRTCLR-LOCK OF DCLPERSONS = 'L'                07570000
                     IF F915-NUM-MRTL-STATUS > SPACES                   07580000
                        PERFORM 4410-CONVERT-MARITAL-CODE THRU 4410-EXIT07590000
                     END-IF                                             07600000
                  ELSE                                                  07610000
                     PERFORM 4120-MOVE-PERSON-INFO THRU 4120-EXIT       07620000
                  END-IF                                                07630000
             WHEN 100                                                   07640000
                  DISPLAY 'REC NOT IN PERSONS TABLE ' WS-NUM-CSTMR      07650000
                          ' ' F915-KEY-FLD                              07660000
             WHEN OTHER                                                 07670000
                  PERFORM  9000-SQL-ERROR  THRU  9000-EXIT              07680000
            END-EVALUATE.                                               07690000
                                                                        07700000
       4110-EXIT.                                                       07710000
            EXIT.                                                       07720000
                                                                        07730000
      *---------------------*                                           07740000
       4120-MOVE-PERSON-INFO.                                           07750000
      *---------------------*                                           07760000
                                                                        07770000
           IF F915-TXN-TYPE = 'UA'                                      07780000
              IF F915-NUM-NEW-NME-PERSON NOT = SPACES                   07790000
                 MOVE F915-NUM-NEW-NME-PERSON TO                        07800000
                                             BE01W808-IN-NEW-NME-PERSON 07810000
              END-IF                                                    07820000
           ELSE                                                         07830000
              MOVE F915-NME-PERSON       TO BE01W808-IN-NME-PERSON      07840000
           END-IF.                                                      07850000
                                                                        07860000
           IF F915-NUM-NTNLTY = SPACES OR LOW-VALUES                    07870000
              MOVE 'UN'                  TO BE01W808-IN-NUM-NTNLTY      07880000
           ELSE                                                         07890000
              MOVE F915-NUM-NTNLTY       TO BE01W808-IN-NUM-NTNLTY      07900000
           END-IF.                                                      07910000
                                                                        07920000
           MOVE F915-DTE-BIRTH           TO BE01W808-IN-DTE-BIRTH.      07930000
                                                                        07940000
           PERFORM 4400-CONVERT-DATA THRU 4400-EXIT.                    07950000
                                                                        07960000
       4120-EXIT.                                                       07970000
            EXIT.                                                       07980000
                                                                        07990000
      *---------------------*                                           08000000
       4200-AR-F915-TO-CDB.                                             08010000
      *---------------------*                                           08020000
                                                                        08030000
           IF WS-C993-OK = 'N'                                          08040000
              GO TO 4200-EXIT                                           08050000
           END-IF                                                       08060000
                                                                        08070000
           MOVE '0001-01-01'          TO BE01W808-IN-DTE-ACPTNC.        08080000
           PERFORM 4210-PASS-BE01W808 THRU 4210-EXIT.                   08090000
           PERFORM 4220-LINK-BE01C808 THRU 4220-EXIT.                   08100000
                                                                        08110000
       4200-EXIT.                                                       08120000
            EXIT.                                                       08130000
                                                                        08140000
      *---------------------*                                           08150000
       4210-PASS-BE01W808.                                              08160000
      *---------------------*                                           08170000
                                                                        08180000
           PERFORM  3030-GET-DATETIME  THRU 3030-EXIT.                  08190000
                                                                        08200000
           MOVE 'WRITE'                TO BE01W808-IN-RTN-FXN.          08210000
           MOVE F915-TXN-TYPE          TO BE01W808-IN-TXN-TYPE.         08220000
           MOVE F915-CSTMR-TYPE        TO BE01W808-IN-CSTMR-TYPE.       08230000
           MOVE F915-NUM-UPDATE-SOURCE TO BE01W808-IN-NUM-UPDATE-SOURCE.08240000
           MOVE SPACES                 TO BE01W808-IN-NUM-UPDATE-USERID.08250000
                                                                        08260000
           MOVE F915-NUM-ROLE          TO BE01W808-IN-NUM-ROLE.         08270000
           MOVE F915-NUM-BSNS-REF      TO BE01W808-IN-NUM-BSNS-REF.     08280000
                                                                        08290000
           IF F915-DTE-ROLE-START > SPACES                              08300000
              MOVE F915-DTE-ROLE-START TO BE01W808-IN-DTE-ROLE-START    08310000
           ELSE                                                         08320000
              MOVE SPACES              TO BE01W808-IN-DTE-ROLE-START    08330000
           END-IF.                                                      08340000
                                                                        08350000
       4210-EXIT.                                                       08360000
            EXIT.                                                       08370000
                                                                        08380000
      *---------------------*                                           08390000
       4220-LINK-BE01C808.                                              08400000
      *---------------------*                                           08410000
                                                                        08420000
           CALL 'BE01C808'  USING BE01W808-COMMAREA.                    08430000
                                                                        08440000
           IF  BE01W808-OUT-RTN-ACTION     = 'S'                        08450000
               PERFORM 9010-DISP-SEVEAR-ERR-C808   THRU 9010-EXIT       08460000
           ELSE                                                         08470000
             IF BE01W808-OUT-RTN-ACTION    = 'R'                        08480000
                PERFORM 4230-DISP-REJECT-ERR-C808  THRU 4230-EXIT       08490000
             ELSE                                                       08500000
               IF BE01W808-OUT-RTN-ACTION  = 'W' OR SPACES              08510000
                  PERFORM 4240-UPD-C808-BP13F915 THRU 4240-EXIT         08520000
               END-IF                                                   08530000
             END-IF                                                     08540000
           END-IF.                                                      08550000
                                                                        08560000
       4220-EXIT.                                                       08570000
            EXIT.                                                       08580000
                                                                        08590000
      ******************************************************************08600000
      * THE MESSAGE NO.'0075' MEANS , RECORD IS ALREDAY EXISTED IN CDB *08610000
      * IF RECORD IS ALREADY EXISTED, JUSY WRITE  CSTMR-SOURCE IN F820 *08620000
      ******************************************************************08630000
      *-------------------------*                                       08640000
       4230-DISP-REJECT-ERR-C808.                                       08650000
      *-------------------------*                                       08660000
                                                                        08670000
            IF BE01W808-OUT-RTN-MSGNO  = '0075'                         08680000
               PERFORM 4240-UPD-C808-BP13F915  THRU 4240-EXIT           08690000
               ADD  1  TO WS-NO-EXIST-CDB-PERSON                        08700000
                                                                        08710000
            ELSE                                                        08720000
                                                                        08730000
               MOVE BE01W808-OUT-RTN-MSGNO      TO   WS-MSGNO           08740000
               PERFORM  3050-READ-BE01KMSG      THRU 3050-EXIT          08750000
               DISPLAY  SPACES                                          08760000
               DISPLAY "F915-KEY-FLD            : "  F915-KEY-FLD       08770000
               DISPLAY "BE01W808-OUT-RTN-MSGNO  : "  WS-MSGNO           08780000
               DISPLAY "REASON FOR ERROR MSG    : "  WS-MSG-TEXT        08790000
                                                                        08800000
               ADD     1                        TO   WS-NO-AR-FAIL-REC  08810000
               MOVE   'N'                       TO   WS-C808-OK         08820000
            END-IF.                                                     08830000
                                                                        08840000
       4230-EXIT.                                                       08850000
            EXIT.                                                       08860000
                                                                        08870000
      *---------------------*                                           08880000
       4240-UPD-C808-BP13F915.                                          08890000
      *---------------------*                                           08900000
                                                                        08910000
           MOVE BE01W808-OUT-NUM-CSTMR        TO F915-NUM-CSTMR-SOURCE. 08920000
           MOVE BE01W808-IN-DTE-UPDATE-SOURCE TO F915-DTE-UPDATE-SOURCE.08930000
           MOVE BE01W808-IN-TME-UPDATE-SOURCE TO F915-TME-UPDATE-SOURCE.08940000
                                                                        08950000
           PERFORM  8600-WRITE-P13F915B   THRU  8600-EXIT.              08960000
                                                                        08970000
       4240-EXIT.                                                       08980000
            EXIT.                                                       08990000
                                                                        09000000
      *------------------*                                              09010000
       4300-CALL-BE01C809.                                              09020000
      *------------------*                                              09030000
                                                                        09040000
           IF WS-C808-OK = 'N'                                          09050000
              GO TO 4300-EXIT                                           09060000
           END-IF                                                       09070000
                                                                        09080000
           IF F915-TXN-TYPE = 'AR'                                      09090000
              IF (F915-NUM-MRTL-STATUS = 'M' OR '2')                    09100000
                  MOVE SPACES              TO WS-BP13F915-REC           09110000
                  MOVE BP13F915-REC        TO WS-BP13F915-REC           09120000
                  PERFORM 2000-READ-BP13F915 THRU 2000-EXIT             09130000
                  IF (F915-TXN-TYPE = 'AM')                             09140000
                     IF (F915-NUM-BSNS-REF = WS-AR-REGN-NO) AND         09150000
                        (F915-NUM-IDNTY-NO = WS-AR-NRIC-NO) AND         09160000
                        (F915-NUM-IDNTY-NO-SP NOT = SPACES) AND         09170000
                        (F915-NME-SP          NOT = SPACES)             09180000
                         CONTINUE                                       09190000
                     ELSE                                               09200000
                        MOVE F915-TXN-TYPE        TO WS-TXN-TYPE        09210000
                        MOVE F915-NUM-BSNS-REF    TO WS-NUM-BSNS-REF    09220000
                        MOVE F915-NUM-IDNTY-NO    TO WS-NUM-IDNTY-NO    09230000
                        MOVE F915-NUM-IDNTY-NO-SP TO WS-NUM-IDNTY-NO-SP 09240000
                        MOVE F915-NME-SP          TO WS-NME-SP          09250000
                                                                        09260000
                        MOVE 'MARRIED WITH INCOMPLETE SPOUSE INFO'      09270000
                          TO  L986A-REASON                              09280000
                        PERFORM 8100-PRINT-ERROR-REPORT THRU 8100-EXIT  09290000
                        MOVE 'N' TO WS-C809-OK                          09300000
                        GO TO 4300-EXIT                                 09310000
                     END-IF                                             09320000
                  ELSE                                                  09330000
                     MOVE WS-F915-TXN-TYPE        TO WS-TXN-TYPE        09340000
                     MOVE WS-F915-NUM-BSNS-REF    TO WS-NUM-BSNS-REF    09350000
                     MOVE WS-F915-NUM-IDNTY-NO    TO WS-NUM-IDNTY-NO    09360000
                     MOVE WS-F915-NUM-IDNTY-NO-SP TO WS-NUM-IDNTY-NO-SP 09370000
                     MOVE WS-F915-NME-SP          TO WS-NME-SP          09380000
                                                                        09390000
                     MOVE 'MARRIED WITH INCOMPLETE SPOUSE INFO'         09400000
                       TO  L986A-REASON                                 09410000
                     PERFORM 8100-PRINT-ERROR-REPORT THRU 8100-EXIT     09420000
                     MOVE  'N'                    TO WS-C809-OK         09430000
                     MOVE  'N'                    TO WS-F915A-OK        09440000
                     GO TO 4300-EXIT                                    09450000
              ELSE                                                      09460000
                 GO TO 4300-EXIT                                        09470000
              END-IF                                                    09480000
           END-IF.                                                      09490000
                                                                        09500000
           PERFORM 4310-PASS-BE01W809 THRU 4310-EXIT.                   09510000
                                                                        09520000
           CALL 'BE01C809'          USING BE01W809-COMMAREA.            09530000
                                                                        09540000
           IF  BE01W809-OUT-RTN-ACTION = 'S'                            09550000
               PERFORM 4320-DISP-SEVEAR-ERR-C809  THRU 4320-EXIT        09560000
           END-IF.                                                      09570000
                                                                        09580000
           IF  BE01W809-OUT-RTN-ACTION  NOT = SPACES                    09590000
               PERFORM 4350-DISP-NORMAL-ERR-C809  THRU 4350-EXIT        09600000
           ELSE                                                         09610000
               PERFORM 4360-UPD-C809-BP13F915     THRU 4360-EXIT        09620000
               ADD  1  TO   WS-NO-WRT-CDB-MARRIAGE                      09630000
           END-IF.                                                      09640000
                                                                        09650000
       4300-EXIT.                                                       09660000
            EXIT.                                                       09670000
                                                                        09680000
      *------------------*                                              09690000
       4310-PASS-BE01W809.                                              09700000
      *------------------*                                              09710000
                                                                        09720000
           PERFORM  3030-GET-DATETIME  THRU 3030-EXIT.                  09730000
                                                                        09740000
           MOVE 'WRITE'                TO BE01W809-IN-RTN-FXN.          09750000
           MOVE F915-TXN-TYPE          TO BE01W809-IN-TXN-TYPE.         09760000
           MOVE F915-NUM-UPDATE-SOURCE TO BE01W809-IN-NUM-UPDATE-SOURCE.09770000
           MOVE SPACES                 TO BE01W809-IN-NUM-UPDATE-USERID.09780000
                                                                        09790000
           MOVE F915-NME-PSN           TO BE01W809-IN-CSTMR-NME-PERSON. 09800000
           MOVE F915-NUM-CSTMR-SOURCE-PSN TO BE01W809-IN-CSTMR-NUM-CSTMR09810000
                                                                        09820000
      *******  TO GET THE IDENFICATION TYPE OF SPOUSE   ******          09830000
           MOVE F915-NUM-IDNTY-NO-SP     TO  WS-NUM-NRIC                09840000
                                                                        09850000
           IF WS-NUM-NRIC(1:1) = 'S' OR 'T'                             09860000
              MOVE 'UIN'            TO   WS-NUM-IDNTY-NO-TYPE           09870000
           ELSE                                                         09880000
              IF WS-NUM-NRIC(1:1) = 'G' OR 'F' OR 'M'                   09890001
                 MOVE 'FIN'         TO   WS-NUM-IDNTY-NO-TYPE           09900000
              ELSE                                                      09910000
                 MOVE 'XIN'         TO   WS-NUM-IDNTY-NO-TYPE           09920000
              END-IF                                                    09930000
           END-IF.                                                      09940000
                                                                        09950000
           MOVE WS-NUM-IDNTY-NO-TYPE TO  BE01W809-IN-SPOUSE-IDNTY-TYPE  09960000
                                         F915-NUM-IDNTY-NO-TYPE-SP.     09970000
                                                                        09980000
           IF WS-NUM-IDNTY-NO-TYPE = 'XIN'                              09990000
              MOVE F915-NUM-IDNTY-NO-SP(2:8) TO                         10000000
                                         BE01W809-IN-SPOUSE-IDNTY-NO    10010000
           ELSE                                                         10020000
              IF WS-NUM-IDNTY-NO-TYPE = 'UIN' OR 'FIN'                  10030000
                 MOVE F915-NUM-IDNTY-NO-SP TO                           10040000
                                         BE01W809-IN-SPOUSE-IDNTY-NO    10050000
              END-IF                                                    10060000
           END-IF.                                                      10070000
                                                                        10080000
           MOVE  F915-NME-SP        TO  BE01W809-IN-SPOUSE-NME-PERSON.  10090000
           MOVE  '0001-01-01'       TO  BE01W809-IN-DTE-MRG.            10100000
                                                                        10110000
       4310-EXIT.                                                       10120000
            EXIT.                                                       10130000
                                                                        10140000
      *-------------------------*                                       10150000
       4320-DISP-SEVEAR-ERR-C809.                                       10160000
      *-------------------------*                                       10170000
                                                                        10180000
            MOVE    BE01W809-OUT-RTN-MSGNO     TO   WS-MSGNO.           10190000
            PERFORM 3050-READ-BE01KMSG         THRU 3050-EXIT.          10200000
            DISPLAY 'CALLING BE01C809 - SEVEAR ERROR'.                  10210000
            DISPLAY 'ERROR TYPE        : ' BE01W809-OUT-RTN-ACTION.     10220000
            DISPLAY 'PROGRAM ID        : ' BE01W809-OUT-RTN-PGMID.      10230000
            DISPLAY 'ERROR MESSAGE NO  : ' WS-MSGNO.                    10240000
            DISPLAY 'ERROR MESSAGE NO  : ' WS-MSG-TEXT.                 10250000
            DISPLAY 'ERROR STATUS CODE : ' BE01W809-OUT-RTN-STATCDE.    10260000
                                                                        10270000
            DISPLAY 'TRANSACTION TYPE  : ' F915-TXN-TYPE.               10280000
            DISPLAY 'IDNTY NO OF CSTMR : ' F915-NUM-IDNTY-NO-PSN        10290000
            DISPLAY 'NAME OF CSTMR     : ' F915-NME-PSN.                10300000
                                                                        10310000
            DISPLAY 'IDNTY NO OF SPOUSE:'  F915-NUM-IDNTY-NO-SP.        10320000
            DISPLAY 'NAME OF SPOUSE    :'  F915-NME-SP.                 10330000
            PERFORM 9000-SQL-ERROR             THRU 9000-EXIT.          10340000
                                                                        10350000
       4320-EXIT.                                                       10360000
            EXIT.                                                       10370000
                                                                        10380000
      ******************************************************************10390000
      *  THE ERROR MESSAGE "0175" MEANS , MARRIAGE DATE IS ALREADY     *10400000
      *  EXISTED IN CDB MARRIAGE TABLE AND DEFAULT DATE IS NOT ALLOWED *10410000
      *  TO UPDATE TO CDB. SO, HERE WE ARE BYPASSING THE ERROR "0175". *10420000
      ******************************************************************10430000
      *-------------------------*                                       10440000
       4350-DISP-NORMAL-ERR-C809.                                       10450000
      *-------------------------*                                       10460000
                                                                        10470000
           IF BE01W809-OUT-RTN-MSGNO = '0175' OR '0171' OR '0176'       10480000
              PERFORM 4360-UPD-C809-BP13F915  THRU 4360-EXIT            10490000
              ADD  1  TO  WS-NO-EXIST-CDB-MRG                           10500000
           ELSE                                                         10510000
              MOVE BE01W809-OUT-RTN-MSGNO       TO   WS-MSGNO           10520000
              PERFORM 3050-READ-BE01KMSG        THRU 3050-EXIT          10530000
              DISPLAY SPACES                                            10540000
              DISPLAY "F915-KEY-FLD             : "  F915-KEY-FLD       10550000
              DISPLAY "BE01W809-OUT-RTN-MSGNO   : "  WS-MSGNO           10560000
              DISPLAY "REASON FOR ERROR MSG     : "  WS-MSG-TEXT        10570000
                                                                        10580000
              MOVE      'N'                      TO  WS-C809-OK         10590000
              ADD        1                       TO  WS-NO-AM-FAIL-REC  10600000
           END-IF.                                                      10610000
                                                                        10620000
       4350-EXIT.                                                       10630000
            EXIT.                                                       10640000
                                                                        10650000
      *----------------------*                                          10660000
       4360-UPD-C809-BP13F915.                                          10670000
      *----------------------*                                          10680000
                                                                        10690000
                                                                        10700000
           MOVE BE01W809-OUT-SPOUSE-NUM-CSTMR                           10710000
                                   TO    F915-NUM-CSTMR-SOURCE-SP       10720000
           MOVE BE01W809-IN-DTE-UPDATE-SOURCE                           10730000
                                   TO    F915-DTE-UPDATE-SOURCE         10740000
           MOVE BE01W809-IN-TME-UPDATE-SOURCE                           10750000
                                   TO    F915-TME-UPDATE-SOURCE         10760000
           PERFORM  8600-WRITE-P13F915B  THRU   8600-EXIT.              10770000
                                                                        10780000
       4360-EXIT.                                                       10790000
            EXIT.                                                       10800000
                                                                        10810000
      *-------------------*                                             10820000
       4400-CONVERT-DATA.                                               10830000
      *-------------------*                                             10840000
                                                                        10850000
           IF F915-NUM-MRTL-STATUS > SPACES                             10860000
              PERFORM 4410-CONVERT-MARITAL-CODE    THRU 4410-EXIT       10870000
           END-IF.                                                      10880000
                                                                        10890000
           IF F915-NUM-SEX > SPACES                                     10900000
              PERFORM 4420-CONVERT-SEX-CODE        THRU 4420-EXIT       10910000
           END-IF.                                                      10920000
                                                                        10930000
           IF F915-NUM-ETHNIC-GROUP > SPACES                            10940000
              PERFORM 4430-CONVERT-ETHNIC-CODE     THRU 4430-EXIT       10950000
           END-IF.                                                      10960000
                                                                        10970000
           IF F915-NUM-PR-STATUS > SPACES                               10980000
              PERFORM 4440-CONVERT-PRSTATUS-TO-CDB THRU 4440-EXIT       10990000
           END-IF.                                                      11000000
                                                                        11010000
       4400-EXIT.                                                       11020000
            EXIT.                                                       11030000
                                                                        11040000
      *-------------------------*                                       11050000
       4410-CONVERT-MARITAL-CODE.                                       11060000
      *-------------------------*                                       11070000
                                                                        11080000
            MOVE    SPACES               TO    K060-KEY-FLD.            11090000
            MOVE    44                   TO    K060-SERIAL-NO.          11100000
            MOVE    F915-NUM-MRTL-STATUS TO    K060-CODE.               11110000
            PERFORM 4450-CHECK-BP13K060  THRU  4450-EXIT.               11120000
                                                                        11130000
            IF WS-K060-STATUS = 00                                      11140000
               MOVE  K060-DESC1          TO BE01W808-IN-NUM-MRTL-STATUS 11150000
            END-IF.                                                     11160000
                                                                        11170000
       4410-EXIT.                                                       11180000
            EXIT.                                                       11190000
                                                                        11200000
      *---------------------*                                           11210000
       4420-CONVERT-SEX-CODE.                                           11220000
      *---------------------*                                           11230000
                                                                        11240000
            MOVE    SPACES               TO    K060-KEY-FLD.            11250000
            MOVE    43                   TO    K060-SERIAL-NO.          11260000
            MOVE    F915-NUM-SEX         TO    K060-CODE.               11270000
            PERFORM 4450-CHECK-BP13K060  THRU  4450-EXIT.               11280000
                                                                        11290000
            IF WS-K060-STATUS = 00                                      11300000
               MOVE    K060-DESC1        TO    BE01W808-IN-NUM-SEX      11310000
            END-IF.                                                     11320000
                                                                        11330000
       4420-EXIT.                                                       11340000
            EXIT.                                                       11350000
                                                                        11360000
      *------------------------*                                        11370000
       4430-CONVERT-ETHNIC-CODE.                                        11380000
      *------------------------*                                        11390000
                                                                        11400000
            MOVE    SPACES                TO    K060-KEY-FLD.           11410000
            MOVE    42                    TO    K060-SERIAL-NO.         11420000
            MOVE    F915-NUM-ETHNIC-GROUP TO    K060-CODE.              11430000
            PERFORM 4450-CHECK-BP13K060   THRU  4450-EXIT.              11440000
                                                                        11450000
            IF WS-K060-STATUS = 00                                      11460000
               MOVE  K060-DESC1         TO BE01W808-IN-NUM-ETHNIC-GROUP 11470000
            END-IF.                                                     11480000
                                                                        11490000
       4430-EXIT.                                                       11500000
            EXIT.                                                       11510000
                                                                        11520000
      *--------------------------*                                      11530000
       4440-CONVERT-PRSTATUS-TO-CDB.                                    11540000
      *--------------------------*                                      11550000
                                                                        11560000
           SET CITZ TO 1.                                               11570000
           SEARCH CITZ-TYPE-TABLE                                       11580000
              AT  END MOVE SPACES       TO  BE01W808-IN-NUM-PR-STATUS   11590000
              WHEN F915-NUM-PR-STATUS   = CITZ-CODE(CITZ)               11600000
                   MOVE CITZ-DESC(CITZ) TO  BE01W808-IN-NUM-PR-STATUS   11610000
           END-SEARCH.                                                  11620000
                                                                        11630000
       4440-EXIT.                                                       11640000
            EXIT.                                                       11650000
                                                                        11660000
      *--------------------*                                            11670000
       4450-CHECK-BP13K060.                                             11680000
      *--------------------*                                            11690000
                                                                        11700000
            READ BP13K060.                                              11710000
                                                                        11720000
            EVALUATE WS-K060-STATUS                                     11730000
                WHEN 00                                                 11740000
                     CONTINUE                                           11750000
                WHEN 23                                                 11760000
                     DISPLAY 'NOT FND IN BP13K060 : ' WS-K060-STATUS    11770000
                             '  K060-KEY-FLD  : ' K060-KEY-FLD          11780000
                             '  F915-KEY-FLD  : ' F915-KEY-FLD          11790000
                WHEN OTHER                                              11800000
                     DISPLAY 'ERROR IN BP13K060 : ' WS-K060-STATUS      11810000
                             '  K060-KEY-FLD  :  ' K060-KEY-FLD         11820000
                     DISPLAY 'F915-KEY-FLD    :  ' F915-KEY-FLD         11830000
                     PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT         11840000
            END-EVALUATE.                                               11850000
                                                                        11860000
       4450-EXIT.                                                       11870000
            EXIT.                                                       11880000
                                                                        11890000
      *-------------------*                                             11900000
       4500-WRITE-BP13F820.                                             11910000
      *-------------------*                                             11920000
                                                                        11930000
            MOVE SPACES TO BP13F820-REC.                                11940000
            INITIALIZE BP13F820-REC.                                    11950000
                                                                        11960000
            MOVE F915-NUM-BSNS-REF(1:8)  TO  F820-NUM-REGN.             11970000
            MOVE F915-NUM-IDNTY-NO       TO  F820-NUM-NRIC.             11980000
            MOVE BE01W808-OUT-NUM-CSTMR  TO  F820-NUM-CSTMR-SOURCE.     11990000
                                                                        12000000
            WRITE BP13F820-REC.                                         12010000
            ADD   1                      TO  WS-NO-WRT-F820.            12020000
                                                                        12030000
       4500-EXIT.                                                       12040000
            EXIT.                                                       12050000
                                                                        12060000
      *---------------------*                                           12070000
       5000-UA-PERSON-DETAIL.                                           12080000
      *---------------------*                                           12090000
                                                                        12100000
           PERFORM 4100-CALL-BE01C993       THRU  4100-EXIT.            12110000
                                                                        12120000
           IF WS-C993-OK = 'N'                                          12130000
              GO TO 5000-EXIT                                           12140000
           END-IF.                                                      12150000
                                                                        12160000
           MOVE F915-NUM-CSTMR-SOURCE TO BE01W808-IN-NUM-CSTMR-SOURCE.  12170000
                                                                        12180000
           PERFORM 4210-PASS-BE01W808 THRU 4210-EXIT.                   12190000
           PERFORM 4220-LINK-BE01C808 THRU 4220-EXIT.                   12200000
                                                                        12210000
       5000-EXIT.                                                       12220000
            EXIT.                                                       12230000
                                                                        12240000
                                                                        12250000
      *-------------------*                                             12260000
       6000-DE-F915-TO-CDB.                                             12270000
      *-------------------*                                             12280000
                                                                        12290000
           MOVE F915-NUM-IDNTY-NO     TO BE01W808-IN-NUM-IDNTY-NO.      12300000
           MOVE F915-NUM-CSTMR-SOURCE TO BE01W808-IN-NUM-CSTMR-SOURCE.  12310000
           MOVE '0001-01-01'          TO BE01W808-IN-DTE-ACPTNC.        12320000
                                                                        12330000
           PERFORM 4210-PASS-BE01W808 THRU 4210-EXIT.                   12340000
           PERFORM 4220-LINK-BE01C808 THRU 4220-EXIT.                   12350000
                                                                        12360000
       6000-EXIT.                                                       12370000
            EXIT.                                                       12380000
                                                                        12390000
      *-------------------*                                             12400000
       7000-TE-F915-TO-CDB.                                             12410000
      *-------------------*                                             12420000
                                                                        12430000
           MOVE F915-NUM-IDNTY-NO     TO BE01W808-IN-NUM-IDNTY-NO.      12440000
                                                                        12450000
           MOVE F915-NUM-CSTMR-SOURCE TO BE01W808-IN-NUM-CSTMR-SOURCE   12460000
      *    IF F915-NUM-NTNLTY = SPACES OR LOW-VALUES                    12470000
      *       MOVE 'UN'               TO BE01W808-IN-NUM-NTNLTY         12480000
      *    ELSE                                                         12490000
      *       MOVE F915-NUM-NTNLTY    TO BE01W808-IN-NUM-NTNLTY         12500000
      *    END-IF.                                                      12510000
      *    MOVE F915-DTE-BIRTH        TO BE01W808-IN-DTE-BIRTH.         12520000
           MOVE F915-NUM-ROLE         TO BE01W808-IN-NUM-ROLE.          12530000
           MOVE F915-NUM-BSNS-REF     TO BE01W808-IN-NUM-BSNS-REF.      12540000
           MOVE F915-DTE-ROLE-END     TO BE01W808-IN-DTE-ROLE-END.      12550000
                                                                        12560000
      *    IF F915-NUM-NEW-NME-PERSON NOT = SPACES                      12570000
      *       MOVE F915-NUM-NEW-NME-PERSON TO BE01W808-IN-NEW-NME-PERSON12580000
      *    END-IF.                                                      12590000
                                                                        12600000
      *    PERFORM 4400-CONVERT-DATA  THRU 4400-EXIT.                   12610000
           PERFORM 4210-PASS-BE01W808 THRU 4210-EXIT.                   12620000
           PERFORM 4220-LINK-BE01C808 THRU 4220-EXIT.                   12630000
                                                                        12640000
       7000-EXIT.                                                       12650000
            EXIT.                                                       12660000
                                                                        12670000
      *-----------------------*                                         12680000
       7500-CHECK-PRINT-REPORT.                                         12690000
      *-----------------------*                                         12700000
                                                                        12710000
           IF WS-NO-WRT-L986A-REC = ZEROES                              12720000
             ADD  1              TO   WS-PAGE-CTR                       12730000
             MOVE WS-PAGE-CTR    TO   L986A-PAGENO                      12740000
             WRITE WS-P13L986A-REC FROM L986A-PR-HEAD-01 AFTER PAGE     12750000
             WRITE WS-P13L986A-REC FROM L986A-PR-HEAD-02                12760000
             WRITE WS-P13L986A-REC FROM L986A-PR-LINE   AFTER 2         12770000
             WRITE WS-P13L986A-REC FROM L986A-PR-HEAD-03                12780000
             WRITE WS-P13L986A-REC FROM L986A-PR-LINE                   12790000
             WRITE WS-P13L986A-REC FROM L986A-PR-FOOTER AFTER 2         12800000
             WRITE WS-P13L986A-REC FROM L986A-PR-LINE   AFTER 2         12810000
           END-IF.                                                      12820000
                                                                        12830000
       7500-EXIT.                                                       12840000
            EXIT.                                                       12850000
                                                                        12860000
      *-----------------------*                                         12870000
       8100-PRINT-ERROR-REPORT.                                         12880000
      *-----------------------*                                         12890000
                                                                        12900000
           IF WS-LINE-CTR > 55                                          12910000
              ADD       1             TO     WS-PAGE-CTR                12920000
              MOVE  WS-PAGE-CTR       TO     L986A-PAGENO               12930000
              MOVE      6             TO     WS-LINE-CTR                12940000
                                                                        12950000
              WRITE WS-P13L986A-REC   FROM   L986A-PR-HEAD-01 AFTER PAGE12960000
              WRITE WS-P13L986A-REC   FROM   L986A-PR-HEAD-02           12970000
              WRITE WS-P13L986A-REC   FROM   L986A-PR-LINE    AFTER 2   12980000
              WRITE WS-P13L986A-REC   FROM   L986A-PR-HEAD-03           12990000
              WRITE WS-P13L986A-REC   FROM   L986A-PR-LINE              13000000
           END-IF.                                                      13010000
                                                                        13020000
           IF WS-NUM-BSNS-REF            NOT =  WS-PREV-REGN            13030000
              ADD      1                 TO     WS-SEQN-CTR             13040000
              MOVE WS-SEQN-CTR           TO     L986A-SNO               13050000
              MOVE WS-NUM-BSNS-REF       TO     L986A-REGN-NO           13060000
           ELSE                                                         13070000
              MOVE ZEROES                TO     L986A-SNO               13080000
              MOVE SPACES                TO     L986A-REGN-NO           13090000
           END-IF.                                                      13100000
                                                                        13110000
           MOVE  WS-TXN-TYPE             TO     L966A-TRANS-ID.         13120000
           MOVE  WS-NUM-IDNTY-NO         TO     L986A-NRIC-NO.          13130000
           MOVE  WS-NUM-IDNTY-NO-SP      TO     L986A-SP-NRIC-NO.       13140000
           MOVE  WS-NME-SP               TO     L986A-SP-NAME.          13150000
                                                                        13160000
           WRITE WS-P13L986A-REC         FROM   L986A-PR-DTL-01.        13170000
           MOVE  SPACES                  TO     L986A-PR-DTL-01.        13180000
           ADD          1                TO     WS-NO-WRT-L986A-REC.    13190000
           ADD          1                TO     WS-LINE-CTR.            13200000
                                                                        13210000
           MOVE WS-NUM-BSNS-REF          TO     WS-PREV-REGN.           13220000
                                                                        13230000
       8100-EXIT.                                                       13240000
            EXIT.                                                       13250000
                                                                        13260000
      *---------------------*                                           13270000
       8500-WRITE-P13F915A.                                             13280000
      *---------------------*                                           13290000
                                                                        13300000
            IF WS-F915A-OK = 'Y'                                        13310000
               WRITE WS-P13F915A-REC FROM BP13F915-REC                  13320000
            ELSE                                                        13330000
               WRITE WS-P13F915A-REC FROM WS-BP13F915-REC               13340000
            END-IF.                                                     13350000
                                                                        13360000
            ADD     1              TO  WS-NO-WRT-F915A-REC.             13370000
                                                                        13380000
       8500-EXIT.                                                       13390000
            EXIT.                                                       13400000
                                                                        13410000
      *-------------------*                                             13420000
       8600-WRITE-P13F915B.                                             13430000
      *-------------------*                                             13440000
                                                                        13450000
            WRITE WS-P13F915B-REC FROM BP13F915-REC.                    13460000
            ADD     1              TO  WS-NO-WRT-F915B-REC.             13470000
                                                                        13480000
       8600-EXIT.                                                       13490000
            EXIT.                                                       13500000
                                                                        13510000
      ***************************************************************** 13520000
      *   ABORT PROCESSING DUE TO SQL ERRORS                          * 13530000
      ***************************************************************** 13540000
      *--------------*                                                  13550000
       9000-SQL-ERROR.                                                  13560000
      *--------------*                                                  13570000
                                                                        13580000
           DISPLAY ' *****   YYC986 ABEND   *****'.                     13590000
                                                                        13600000
           CALL 'DBATIAR'  USING SQLCA.                                 13610000
           EXEC SQL   ROLLBACK   END-EXEC.                              13620000
           EVALUATE SQLCODE                                             13630000
               WHEN 0                                                   13640000
                    CONTINUE                                            13650000
               WHEN OTHER                                               13660000
                    DISPLAY 'ROLLBACK FAILED, SQLCODE IS : ' SQLCODE    13670000
           END-EVALUATE.                                                13680000
                                                                        13690000
           MOVE 12                        TO   RETURN-CODE.             13700000
           PERFORM 9999-CLOSE-ROUTINE     THRU 9999-EXIT.               13710000
                                                                        13720000
       9000-EXIT.                                                       13730000
            EXIT.                                                       13740000
                                                                        13750000
      *-------------------------*                                       13760000
       9010-DISP-SEVEAR-ERR-C808.                                       13770000
      *-------------------------*                                       13780000
                                                                        13790000
           MOVE    BE01W808-OUT-RTN-MSGNO     TO    WS-MSGNO.           13800000
           PERFORM 3050-READ-BE01KMSG         THRU  3050-EXIT.          13810000
                                                                        13820000
           DISPLAY 'C808 SEVEAR ERROR  '.                               13830000
           DISPLAY 'ERROR TYPE       : ' BE01W808-OUT-RTN-ACTION.       13840000
           DISPLAY 'PROGRAM ID       : ' BE01W808-OUT-RTN-PGMID.        13850000
           DISPLAY 'ERROR MESSAGE NO : ' WS-MSGNO.                      13860000
           DISPLAY 'ERROR MESSAGE TXT: ' WS-MSG-TEXT.                   13870000
           DISPLAY 'ERROR STATUS CODE: ' BE01W808-OUT-RTN-STATCDE.      13880000
                                                                        13890000
           DISPLAY 'TRANSACTION TYPE : ' F915-TXN-TYPE.                 13900000
           DISPLAY 'HDBREF           : ' F915-NUM-BSNS-REF.             13910000
           DISPLAY 'IDNTY NO         : ' F915-NUM-IDNTY-NO.             13920000
           DISPLAY 'IDNTY NO TYPE    : ' F915-NUM-IDNTY-NO-TYPE         13930000
           DISPLAY 'NAME             : ' F915-NME-PERSON.               13940000
                                                                        13950000
           PERFORM 9000-SQL-ERROR   THRU  9000-EXIT.                    13960000
                                                                        13970000
       9010-EXIT.                                                       13980000
            EXIT.                                                       13990000
                                                                        14000000
      *--------------------*                                            14010000
       9020-PRINT-CONTROL.                                              14020000
      *-------------------*                                             14030000
                                                                        14040000
           MOVE   FUNCTION CURRENT-DATE   TO   WS-DTE                   14050000
           STRING WS-DTE(7:2) '/' WS-DTE(5:2) '/' WS-DTE(1:4)           14060000
                  DELIMITED BY SIZE       INTO WS-PRINT-DATE.           14070000
                                                                        14080000
           WRITE  WS-BP13L986-REC FROM WS-PRINT-HDG1 AFTER PAGE.        14090000
                                                                        14100000
           MOVE   SPACES                  TO   WS-BP13L986-REC.         14110000
           WRITE  WS-BP13L986-REC AFTER 2.                              14120000
                                                                        14130000
           MOVE   ' 1) NO. OF REC READ    FROM F915                  =' 14140000
                                          TO WS-PRINT-DESC              14150000
           MOVE    WS-NO-READ-F915        TO WS-PRINT-TOTAL             14160000
           WRITE   WS-BP13L986-REC        FROM WS-PRINT-REC  AFTER 2.   14170000
                                                                        14180000
           MOVE   '    1A) AR REC READ    FROM F915                  =' 14190000
                                          TO WS-PRINT-DESC              14200000
           MOVE    WS-AR-INPUT            TO WS-PRINT-TOTAL             14210000
           WRITE   WS-BP13L986-REC        FROM WS-PRINT-REC  AFTER 2.   14220000
                                                                        14230000
           MOVE   '    1B) AM REC READ    FROM F915                  =' 14240000
                                          TO WS-PRINT-DESC              14250000
           MOVE    WS-AM-INPUT            TO WS-PRINT-TOTAL             14260000
           WRITE   WS-BP13L986-REC        FROM WS-PRINT-REC  AFTER 2.   14270000
                                                                        14280000
           MOVE   '    1C) UA REC READ    FROM F915                  =' 14290000
                                          TO WS-PRINT-DESC              14300000
           MOVE    WS-UA-INPUT            TO WS-PRINT-TOTAL             14310000
           WRITE   WS-BP13L986-REC        FROM WS-PRINT-REC  AFTER 1.   14320000
                                                                        14330000
           MOVE   '    1D) DE REC READ    FROM F915                  =' 14340000
                                          TO WS-PRINT-DESC              14350000
           MOVE    WS-DE-INPUT            TO WS-PRINT-TOTAL             14360000
           WRITE   WS-BP13L986-REC        FROM WS-PRINT-REC  AFTER 1.   14370000
                                                                        14380000
           MOVE   '    1E) TE REC READ    FROM F915                  =' 14390000
                                          TO WS-PRINT-DESC              14400000
           MOVE    WS-TE-INPUT            TO WS-PRINT-TOTAL             14410000
           WRITE   WS-BP13L986-REC        FROM WS-PRINT-REC  AFTER 1.   14420000
                                                                        14430000
           MOVE   ' 2) NO. OF REC WRITTEN INTO P13F915A              =' 14440000
                                          TO WS-PRINT-DESC              14450000
           MOVE    WS-NO-WRT-F915A-REC    TO WS-PRINT-TOTAL             14460000
           WRITE   WS-BP13L986-REC        FROM WS-PRINT-REC  AFTER 2.   14470000
                                                                        14480000
           MOVE   ' 3) NO. OF REC WRITTEN INTO P13F915B              =' 14490000
                                          TO WS-PRINT-DESC              14500000
           MOVE    WS-NO-WRT-F915B-REC    TO WS-PRINT-TOTAL             14510000
           WRITE   WS-BP13L986-REC        FROM WS-PRINT-REC  AFTER 2.   14520000
                                                                        14530000
           MOVE   ' 4) NO. OF REC WRITTEN INTO P13L986A              =' 14540000
                                          TO WS-PRINT-DESC              14550000
           MOVE    WS-NO-WRT-L986A-REC    TO WS-PRINT-TOTAL             14560000
           WRITE   WS-BP13L986-REC        FROM WS-PRINT-REC  AFTER 2.   14570000
                                                                        14580000
           MOVE   ' 5) NO. OF REC WRITTEN INTO F820                  =' 14590000
                                          TO WS-PRINT-DESC              14600000
           MOVE    WS-NO-WRT-F820         TO  WS-PRINT-TOTAL            14610000
           WRITE   WS-BP13L986-REC        FROM WS-PRINT-REC  AFTER 2.   14620000
                                                                        14630000
           MOVE   ' 6) NO. OF REC WRITTEN INTO CDB PERSONS  TABLE(AR)=' 14640000
                                          TO WS-PRINT-DESC              14650000
           MOVE    WS-NO-WRT-CDB-PERSON   TO  WS-PRINT-TOTAL            14660000
           WRITE   WS-BP13L986-REC        FROM WS-PRINT-REC  AFTER 2.   14670000
                                                                        14680000
           MOVE   ' 7) NO. OF REC UPDATED INTO CDB PERSONS  TABLE(UA)=' 14690000
                                          TO WS-PRINT-DESC              14700000
           MOVE    WS-NO-UPD-CDB-PERSON   TO  WS-PRINT-TOTAL            14710000
           WRITE   WS-BP13L986-REC        FROM WS-PRINT-REC  AFTER 2.   14720000
                                                                        14730000
           MOVE   ' 8) NO. OF REC DELETED FROM CDB PERSONS  TABLE(DE)=' 14740000
                                          TO WS-PRINT-DESC              14750000
           MOVE    WS-NO-DEL-CDB-PERSON   TO WS-PRINT-TOTAL             14760000
           WRITE   WS-BP13L986-REC        FROM WS-PRINT-REC  AFTER 2.   14770000
                                                                        14780000
           MOVE   ' 9) NO. OF REC TRMTED  FROM CDB PERSONS  TABLE(TE)=' 14790000
                                          TO WS-PRINT-DESC              14800000
           MOVE    WS-NO-TE-CDB-PERSON    TO WS-PRINT-TOTAL             14810000
           WRITE   WS-BP13L986-REC        FROM WS-PRINT-REC  AFTER 2.   14820000
                                                                        14830000
           MOVE   '10) NO. OF REC WRITTEN INTO CDB MARRIAGE TABLE(AM)=' 14840000
                                          TO WS-PRINT-DESC              14850000
           MOVE    WS-NO-WRT-CDB-MARRIAGE TO WS-PRINT-TOTAL             14860000
           WRITE   WS-BP13L986-REC        FROM WS-PRINT-REC  AFTER 2.   14870000
                                                                        14880000
           MOVE   '11) NO. OF REC ALREADY EXISTED IN CDB    TABLE    =' 14890000
                                          TO WS-PRINT-DESC              14900000
           MOVE    WS-NO-EXIST-CDB-PERSON TO WS-PRINT-TOTAL             14910000
           WRITE   WS-BP13L986-REC        FROM WS-PRINT-REC  AFTER 2.   14920000
                                                                        14930000
           MOVE   '12) NO. OF REC EXISTED IN MARRIAGE TBL WITH DATE  =' 14940000
                                          TO WS-PRINT-DESC              14950000
           MOVE    WS-NO-EXIST-CDB-MRG    TO WS-PRINT-TOTAL             14960000
           WRITE   WS-BP13L986-REC        FROM WS-PRINT-REC  AFTER 2.   14970000
                                                                        14980000
           MOVE   '13) NO. OF REC FAILURE RECORDS (AR/UA/TE/DE)      =' 14990000
                                          TO WS-PRINT-DESC              15000000
           MOVE    WS-NO-AR-FAIL-REC      TO WS-PRINT-TOTAL             15010000
           WRITE   WS-BP13L986-REC        FROM WS-PRINT-REC  AFTER 2.   15020000
                                                                        15030000
           MOVE   '14) NO. OF REC FAILURE RECORDS (AM)               =' 15040000
                                          TO WS-PRINT-DESC              15050000
           MOVE    WS-NO-AM-FAIL-REC      TO WS-PRINT-TOTAL             15060000
           WRITE   WS-BP13L986-REC        FROM WS-PRINT-REC  AFTER 2.   15070000
                                                                        15080000
       9020-EXIT.                                                       15090000
            EXIT.                                                       15100000
                                                                        15110000
      *----------------------*                                          15120000
       9100-COMMIT-RECORDS.                                             15130000
      *----------------------*                                          15140000
                                                                        15150000
           EXEC SQL   COMMIT     END-EXEC.                              15160000
           EVALUATE SQLCODE                                             15170000
               WHEN 0                                                   15180000
                    CONTINUE                                            15190000
               WHEN OTHER                                               15200000
                    DISPLAY 'COMMIT ERROR - BP13I005  IS : '            15210000
                    PERFORM 9000-SQL-ERROR  THRU  9000-EXIT             15220000
           END-EVALUATE.                                                15230000
                                                                        15240000
       9100-EXIT.                                                       15250000
            EXIT.                                                       15260000
                                                                        15270000
      *-------------------------*                                       15280000
       9200-ROLLBACK-RECORDS.                                           15290000
      *-------------------------*                                       15300000
                                                                        15310000
           EXEC SQL   ROLLBACK   END-EXEC.                              15320000
           EVALUATE SQLCODE                                             15330000
               WHEN 0                                                   15340000
                    CONTINUE                                            15350000
               WHEN OTHER                                               15360000
                    DISPLAY 'ROLLBACK FAILED, SQLCODE IS : ' SQLCODE    15370000
                    PERFORM 9000-SQL-ERROR  THRU  9000-EXIT             15380000
           END-EVALUATE.                                                15390000
                                                                        15400000
       9200-EXIT.                                                       15410000
            EXIT.                                                       15420000
                                                                        15430000
      *---------------------*                                           15440000
       9900-DISPLAY-CDB-ERROR.                                          15450000
      *---------------------*                                           15460000
                                                                        15470000
            IF BE01W808-OUT-RTN-ACTION = 'S'                            15480000
               DISPLAY WS-ERROR-PGM                                     15490000
               DISPLAY 'PROGRAM ID       : ' BE01W808-OUT-RTN-PGMID     15500000
               DISPLAY 'ERROR MESSAGE NO : ' BE01W808-OUT-RTN-MSGNO     15510000
               DISPLAY 'ERROR STATUS CODE: ' BE01W808-OUT-RTN-STATCDE   15520000
               MOVE  12                    TO   RETURN-CODE             15530000
            END-IF.                                                     15540000
                                                                        15550000
            IF BE01W809-OUT-RTN-ACTION = 'S'                            15560000
               DISPLAY WS-ERROR-PGM                                     15570000
               DISPLAY 'PROGRAM ID       : ' BE01W809-OUT-RTN-PGMID     15580000
               DISPLAY 'ERROR MESSAGE NO : ' BE01W809-OUT-RTN-MSGNO     15590000
               DISPLAY 'ERROR STATUS CODE: ' BE01W809-OUT-RTN-STATCDE   15600000
               MOVE  12                    TO   RETURN-CODE             15610000
            END-IF.                                                     15620000
                                                                        15630000
       9900-EXIT.                                                       15640000
            EXIT.                                                       15650000
                                                                        15660000
      *---------------------*                                           15670000
       9990-CLOSE-CDB-ROUTINE.                                          15680000
      *---------------------*                                           15690000
                                                                        15700000
           MOVE 'CLOSE'     TO   BE01W808-IN-RTN-FXN.                   15710000
           CALL 'BE01C808' USING BE01W808-COMMAREA.                     15720000
                                                                        15730000
           IF  BE01W808-OUT-RTN-ACTION = 'S'                            15740000
               MOVE 'BE01C808 - FILE CLOSE ERROR' TO WS-ERROR-PGM       15750000
               PERFORM 9900-DISPLAY-CDB-ERROR THRU 9900-EXIT            15760000
           END-IF.                                                      15770000
                                                                        15780000
           MOVE 'CLOSE'     TO   BE01W809-IN-RTN-FXN.                   15790000
           CALL 'BE01C809' USING BE01W809-COMMAREA.                     15800000
                                                                        15810000
           IF  BE01W809-OUT-RTN-ACTION = 'S'                            15820000
               MOVE 'BE01C809 - FILE CLOSE ERROR' TO WS-ERROR-PGM       15830000
               PERFORM 9900-DISPLAY-CDB-ERROR THRU 9900-EXIT            15840000
           END-IF.                                                      15850000
                                                                        15860000
       9990-EXIT.                                                       15870000
            EXIT.                                                       15880000
                                                                        15890000
      *------------------*                                              15900000
       9999-CLOSE-ROUTINE.                                              15910000
      *------------------*                                              15920000
                                                                        15930000
           CLOSE BP13F915                                               15940000
                 BP13K060                                               15950000
                 BP13F820                                               15960000
                 BE01KMSG                                               15970000
                 BP13L986                                               15980000
                 P13F915A                                               15990000
                 P13F915B                                               16000000
                 P13L986A.                                              16010000
                                                                        16020000
           IF WS-K060-STATUS NOT = 00 AND 97                            16030000
              DISPLAY ' ERROR CLOSING BP13K060  FILE, STATUS '          16040000
              WS-K060-STATUS.                                           16050000
                                                                        16060000
           IF WS-KMSG-STATUS NOT = 00 AND 97                            16070000
              DISPLAY ' ERROR CLOSING BE01KMSG  FILE, STATUS '          16080000
              WS-KMSG-STATUS.                                           16090000
                                                                        16100000
           PERFORM 9990-CLOSE-CDB-ROUTINE    THRU   9990-EXIT.          16110000
                                                                        16120000
           STOP RUN.                                                    16130000
                                                                        16140000
       9999-EXIT.                                                       16150000
           EXIT.                                                        16160000
