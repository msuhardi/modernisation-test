       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C966.                                                 
      *AUTHOR.        KSJ3.                                                     
      *DATE-WRITTEN.  06/02/2017.                                               
      * ========================================================== *            
      * OBJECTIVE    : TO FORMAT INTO EMAIL ALERT ALL GENERATED    *            
      * OBJECTIVE    : CONFLICT IN THE DATA BETWEEN MHA AND SOC    *            
      * ========================================================== *            
      * INPUT  FILES :  1.) BP13FIN  - BP13C965 OUTPUT             *            
      * OUTPUT FILES :  1.) P13L966A - INDIV EMAIL TO CRM          *            
      *                 2.) P13L966B - SUMMARY EMAIL               *            
      * ========================================================== *            
      * CHG-NO   BY   DATE       DESCRIPTION                       *            
      * -------- ---  ------     -----------                       *            
      * BP136627 KSJ3 06/02/2016 NEW PROGRAM                       *            
      * BP136627 PCL4 17/19/2017 TO UPDATE THE REPORT SIZE (100 CHARS)          
      * BP137269 FNP1 22/06/2018 STOP SENDING EMAIL TO SCISMAIL    *            
      * BP137269 KV6  01/07/2019 REMOVE 'CSTMR ID' IN HEADER       *            
      * BP137957 KV5  16/03/2020 REMOVE GRACE, MOVE CHUA AND WEE   *            
      *                          FROM 'CC' TO 'TO'                 *            
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13FIN   ASSIGN        TO BP13FIN.                           
                                                                                
           SELECT P13L966A  ASSIGN        TO P13L966A.                          
                                                                                
           SELECT P13L966B  ASSIGN        TO P13L966B.                          
                                                                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  BP13FIN                                                              
           RECORDING MODE IS F                                                  
           RECORD CONTAINS 230 CHARACTERS.                                      
       01  BP13FIN-REC.                                                         
           05  FIN-REGN-NO             PIC X(08).                               
           05  FIN-CSTMR-ID            PIC X(09).                               
           05  FIN-OIC                 PIC X(05).                               
           05  FIN-AST-NRIC            PIC X(01).                               
           05  FIN-BEFORE-NRIC         PIC X(09).                               
           05  FIN-AST-PRST            PIC X(01).                               
           05  FIN-BEFORE-PRST         PIC X(03).                               
           05  FIN-AST-NTNLTY          PIC X(01).                               
           05  FIN-BEFORE-NTNLTY       PIC X(04).                               
           05  FIN-AST-SEX             PIC X(01).                               
           05  FIN-BEFORE-SEX          PIC X(03).                               
           05  FIN-AST-MRTL            PIC X(01).                               
           05  FIN-BEFORE-MRTL         PIC X(04).                               
           05  FIN-AST-NAME            PIC X(01).                               
           05  FIN-BEFORE-NAME         PIC X(64).                               
           05  FIN-AFTER-NRIC          PIC X(09).                               
           05  FIN-AFTER-PRST          PIC X(03).                               
           05  FIN-AFTER-NTNLTY        PIC X(04).                               
           05  FIN-AFTER-SEX           PIC X(03).                               
           05  FIN-AFTER-MRTL          PIC X(04).                               
           05  FIN-AFTER-NAME          PIC X(64).                               
                                                                                
       FD  P13L966A                                                             
           RECORDING MODE IS F                                                  
           RECORD CONTAINS 100 CHARACTERS.                                      
       01  P13L966A-REC                PIC X(100).                              
                                                                                
       FD  P13L966B                                                             
           RECORDING MODE IS F                                                  
           RECORD CONTAINS 100 CHARACTERS.                                      
       01  P13L966B-REC                PIC X(100).                              
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
                                                                                
      *---------------------------------------------------------------*         
      *        LINKAGE FOR BP13CCNT                                   *         
      *---------------------------------------------------------------*         
       01  WS-LINK-REC-CCNT.                                                    
           05  WS-LINK-CNTCT-TYPE        PIC X(3).                              
           05  WS-LINK-STAFF-NICK        PIC X(6).                              
           05  WS-LINK-STAFF-NUM         PIC X(6).                              
           05  WS-LINK-STAFF-CNTCT       PIC X(50).                             
           05  WS-LINK-SYSERR            PIC 9(4).                              
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-CNT-FIN-READ           PIC 9(6)   VALUE ZEROES.               
           05  WS-CNT-FIN-SKIP           PIC 9(6)   VALUE ZEROES.               
           05  WS-CNT-L966A-WRITE        PIC 9(6)   VALUE ZEROES.               
           05  WS-CNT-L966B-WRITE        PIC 9(6)   VALUE ZEROES.               
                                                                                
       01  WS-FLAGS.                                                            
           05  WS-FIN-EOF                PIC X(1)   VALUE 'N'.                  
                                                                                
       01  WS-DATE.                                                             
           05  WS-DTE-FMT8.                                                     
               10  WS-DTE-CCYY.                                                 
                   15  WS-DTE-CC         PIC 9(2)   VALUE ZEROES.               
                   15  WS-DTE-YY         PIC 9(2)   VALUE ZEROES.               
               10  WS-DTE-MM             PIC 9(2)   VALUE ZEROES.               
               10  WS-DTE-DD             PIC 9(2)   VALUE ZEROES.               
           05  WS-DTE-FMT10.                                                    
               10  WS-DTE-DD             PIC 9(2)   VALUE ZEROES.               
               10  FILLER                PIC X      VALUE '/'.                  
               10  WS-DTE-MM             PIC 9(2)   VALUE ZEROES.               
               10  FILLER                PIC X      VALUE '/'.                  
               10  WS-DTE-CCYY.                                                 
                   15  WS-DTE-CC         PIC 9(2)   VALUE ZEROES.               
                   15  WS-DTE-YY         PIC 9(2)   VALUE ZEROES.               
           05  WS-DTE-CURR-8             PIC 9(8)   VALUE ZEROES.               
           05  WS-DTE-CURR-10            PIC X(10)  VALUE ZEROES.               
                                                                                
       01  WS-OTHERS.                                                           
           05  WS-PREV-OIC               PIC X(5)   VALUE SPACES.               
           05  WS-NUM-SNO-L966A          PIC 9(4)   VALUE ZEROES.               
           05  WS-NUM-SNO-L966B          PIC 9(4)   VALUE ZEROES.               
                                                                                
      *---------------------------------------------------------------*         
      *        MAIL HEADER                                            *         
      *---------------------------------------------------------------*         
       01  MAIL-HDR-HELO.                                                       
           05  FILLER PIC X(100) VALUE 'HELO SGPHDB1'.                          
                                                                                
       01  MAIL-HDR-MAIL-FROM.                                                  
           05  FILLER PIC X(100) VALUE 'MAIL FROM:<OPCP@SGPHDB1>'.              
                                                                                
       01  MAIL-HDR-MAIL-RCPT-TO.                                               
           05  FILLER PIC X(100) VALUE SPACES.                                  
                                                                                
      *01  MAIL-HDR-MAIL-RCPT-GRACE.                                            
      *    05  FILLER PIC X(100) VALUE 'RCPT TO:<GRACE_JL_SOH@HDB.GOV.SG        
      *-        '>'.                                                            
                                                                                
       01  MAIL-HDR-MAIL-RCPT1.                                                 
           05  FILLER PIC X(100) VALUE 'RCPT TO:<CHUA_YUH_MIIN@HDB.GOV.S        
      -        'G>'.                                                            
                                                                                
       01  MAIL-HDR-MAIL-RCPT1A.                                                
           05  FILLER PIC X(100) VALUE 'RCPT TO:<WEE_LEE_YEAN@HDB.GOV.SG        
      -        '>'.                                                             
                                                                                
       01  MAIL-HDR-MAIL-RCPT2.                                                 
           05  FILLER PIC X(100) VALUE 'RCPT TO:<SCISMAIL@MAILBOX.HDB.GO        
      -        'V.SG>'.                                                         
                                                                                
       01  MAIL-HDR-DATA.                                                       
           05  FILLER PIC X(100) VALUE 'DATA'.                                  
                                                                                
       01  MAIL-HDR-FROM.                                                       
           05  FILLER PIC X(100) VALUE 'FROM:Soc System - Email Alert'.         
                                                                                
       01  MAIL-HDR-MAIL-TO.                                                    
           05  FILLER PIC X(100) VALUE SPACES.                                  
                                                                                
      *01  MAIL-HDR-MAIL-TO-GRACE.                                              
      *    05  FILLER PIC X(80)                                                 
      *        VALUE 'TO:<GRACE_JL_SOH@HDB.GOV.SG>'.                            
                                                                                
       01  MAIL-HDR-MAIL-TO-CC1.                                                
           05  FILLER PIC X(80)                                                 
               VALUE 'TO:<CHUA_YUH_MIIN@HDB.GOV.SG>'.                           
      *        VALUE 'CC:<CHUA_YUH_MIIN@HDB.GOV.SG>'.                           
                                                                                
       01  MAIL-HDR-MAIL-TO-CC1A.                                               
           05  FILLER PIC X(80)                                                 
               VALUE 'TO:<WEE_LEE_YEAN@HDB.GOV.SG>'.                            
      *        VALUE 'CC:<WEE_LEE_YEAN@HDB.GOV.SG>'.                            
                                                                                
       01  MAIL-HDR-MAIL-TO-CC2.                                                
           05  FILLER PIC X(80)                                                 
               VALUE 'CC:<SCISMAIL@MAILBOX.HDB.GOV.SG>'.                        
                                                                                
       01  MAIL-SUBJECT-L966A.                                                  
           05  FILLER PIC X(100) VALUE 'SUBJECT : Daily Report for Confl        
      -        'ict Data Between SOC and MHA'.                                  
                                                                                
       01  MAIL-SUBJECT-L966B.                                                  
           05  FILLER PIC X(100) VALUE 'SUBJECT : Daily Summary Report f        
      -        'or Conflict Data Between SOC and MHA'.                          
                                                                                
       01  MAIL-BODY-L966A  PIC X(100) VALUE SPACES.                            
                                                                                
       01  MAIL-END-L966A              PIC X(100) VALUE SPACES.                 
                                                                                
       01  MAIL-HDR-DATE.                                                       
           05  FILLER                  PIC X(6)   VALUE 'DATE: '.               
           05  MAIL-DATE               PIC X(10)  VALUE SPACES.                 
                                                                                
       01  MAIL-END.                                                            
           05 FILLER                   PIC X      VALUE '.'.                    
                                                                                
       01  MAIL-SPACES.                                                         
           05 FILLER                   PIC X(100) VALUE SPACES.                 
                                                                                
      *---------------------------------------------------------------*         
      *        CRM REPORT DETAILS                                     *         
      *---------------------------------------------------------------*         
       01  L966A-PR-HEAD-01.                                                    
           05  FILLER                  PIC X(8)  VALUE 'P13L966A'.              
           05  FILLER                  PIC X(5)  VALUE SPACES .                 
           05  FILLER                  PIC X(8)  VALUE 'HDBCAT 3'.              
           05  FILLER                  PIC X(10) VALUE SPACES.                  
           05  FILLER                  PIC X(20) VALUE                          
              'SYSTEM OF COMMITMENT'.                                           
           05  FILLER                  PIC X(10) VALUE SPACES.                  
           05  FILLER                  PIC X(7)  VALUE 'DATE :'.                
           05  L966A-DATE-RUN          PIC X(10).                               
           05  FILLER                  PIC X(4)  VALUE SPACES.                  
           05  FILLER                  PIC X(7)  VALUE 'PAGE : '.               
           05  L966A-PAGENO            PIC ZZZZ9.                               
                                                                                
       01  L966A-PR-HEAD-02.                                                    
           05  FILLER                  PIC X(26)  VALUE SPACES.                 
           05  FILLER                  PIC X(50)  VALUE                         
               'DAILY REPORT FOR CONFLICT DATA BETWEEN SOC AND MHA'.            
                                                                                
       01  L966A-PR-HEAD-03.                                                    
           05  FILLER               PIC X(35) VALUE SPACES.                     
           05  FILER                PIC X(14) VALUE 'SOC / MHA DATA'.           
                                                                                
       01  L966A-PR-HEAD-04.                                                    
           05  FILLER                  PIC X(05) VALUE SPACES.                  
           05  FILLER                  PIC X(04) VALUE 'S/NO'.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(08) VALUE 'REGN NO/'.              
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(09) VALUE 'NRIC'.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE 'CTZ'.                   
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(04) VALUE 'NATL'.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(03) VALUE 'SEX'.                   
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(04) VALUE 'MRTL'.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(04) VALUE 'NAME'.                  
           05  FILLER                  PIC X(60) VALUE SPACES.                  
                                                                                
       01  L966A-PR-DTL-01.                                                     
           05  FILLER                  PIC X(03) VALUE 'SOC'.                   
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966A-SNO               PIC Z(4)  VALUE ZEROES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966A-REGN-NO           PIC X(08) VALUE SPACES.                  
           05  FILLER                  PIC X(01) VALUE SPACES.                  
           05  L966A-AST-NRIC          PIC X(01) VALUE SPACES.                  
           05  L966A-BEFORE-NRIC       PIC X(09) VALUE SPACES.                  
           05  FILLER                  PIC X(01) VALUE SPACES.                  
           05  L966A-AST-PRST          PIC X(01) VALUE SPACES.                  
           05  L966A-BEFORE-PRST       PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(01) VALUE SPACES.                  
           05  L966A-AST-NTNLTY        PIC X(01) VALUE SPACES.                  
           05  L966A-BEFORE-NTNLTY     PIC X(04) VALUE SPACES.                  
           05  FILLER                  PIC X(01) VALUE SPACES.                  
           05  L966A-AST-SEX           PIC X(01) VALUE SPACES.                  
           05  L966A-BEFORE-SEX        PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(01) VALUE SPACES.                  
           05  L966A-AST-MRTL          PIC X(01) VALUE SPACES.                  
           05  L966A-BEFORE-MRTL       PIC X(04) VALUE SPACES.                  
           05  FILLER                  PIC X(01) VALUE SPACES.                  
           05  L966A-AST-NAME          PIC X(01) VALUE SPACES.                  
           05  L966A-BEFORE-NAME       PIC X(46) VALUE SPACES.                  
                                                                                
                                                                                
       01  L966A-PR-DTL-02.                                                     
           05  FILLER                  PIC X(03) VALUE 'EXT'.                   
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(06) VALUE SPACES.                  
           05  L966A-CSTMR-ID          PIC X(09) VALUE SPACES.                  
           05  FILLER                  PIC X(01) VALUE SPACES.                  
           05  L966A-AFTER-NRIC        PIC X(09) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966A-AFTER-PRST        PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966A-AFTER-NTNLTY      PIC X(04) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966A-AFTER-SEX         PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966A-AFTER-MRTL        PIC X(04) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966A-AFTER-NAME        PIC X(46) VALUE SPACES.                  
                                                                                
       01  L966A-PR-LINE               PIC X(100) VALUE ALL '-'.                
                                                                                
      *---------------------------------------------------------------*         
      *        SUMMARY REPORT DETAILS                                 *         
      *---------------------------------------------------------------*         
       01  L966B-PR-HEAD-01.                                                    
           05  FILLER                  PIC X(8)  VALUE 'P13L966B'.              
           05  FILLER                  PIC X(5)  VALUE SPACES .                 
           05  FILLER                  PIC X(8)  VALUE 'HDBCAT 3'.              
           05  FILLER                  PIC X(10) VALUE SPACES.                  
           05  FILLER                  PIC X(20) VALUE                          
              'SYSTEM OF COMMITMENT'.                                           
           05  FILLER                  PIC X(10) VALUE SPACES.                  
           05  FILLER                  PIC X(7)  VALUE 'DATE :'.                
           05  L966B-DATE-RUN          PIC X(10).                               
           05  FILLER                  PIC X(4)  VALUE SPACES.                  
           05  FILLER                  PIC X(7)  VALUE 'PAGE : '.               
           05  L966B-PAGENO            PIC ZZZZ9.                               
                                                                                
       01  L966B-PR-HEAD-02.                                                    
           05  FILLER                  PIC X(25)  VALUE SPACES.                 
           05  FILLER                  PIC X(52)  VALUE                         
               'SUMMARY REPORT FOR CONFLICT DATA BETWEEN SOC AND MHA'.          
                                                                                
       01  L966B-PR-HEAD-03.                                                    
           05  FILLER                 PIC X(35) VALUE SPACES.                   
           05  FILER                  PIC X(14) VALUE 'SOC / MHA DATA'.         
                                                                                
       01  L966B-PR-HEAD-04.                                                    
           05  FILLER                  PIC X(43) VALUE                          
                 '     S/NO  REGN NO   NRIC       CTZ  NATL  '.                 
           05  FILLER                  PIC X(15) VALUE                          
                 'SEX  MRTL  NAME'.                                             
           05  FILLER                  PIC X(35) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(05) VALUE 'OIC'.                   
                                                                                
       01  L966B-PR-DTL-01.                                                     
           05  FILLER                  PIC X(03) VALUE 'SOC'.                   
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966B-SNO               PIC Z(4)  VALUE ZEROES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966B-REGN-NO           PIC X(08) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966B-BEFORE-NRIC       PIC X(09) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966B-BEFORE-PRST       PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966B-BEFORE-NTNLTY     PIC X(04) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966B-BEFORE-SEX        PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966B-BEFORE-MRTL       PIC X(04) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966B-BEFORE-NAME       PIC X(39) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966B-OIC               PIC X(05) VALUE SPACES.                  
                                                                                
       01  L966B-PR-DTL-02.                                                     
           05  FILLER                  PIC X(03) VALUE 'MHA'.                   
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  FILLER                  PIC X(06) VALUE SPACES.                  
           05  L966B-CSTMR-ID          PIC X(09) VALUE SPACES.                  
           05  FILLER                  PIC X(01) VALUE SPACES.                  
           05  L966B-AFTER-NRIC        PIC X(09) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966B-AFTER-PRST        PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966B-AFTER-NTNLTY      PIC X(04) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966B-AFTER-SEX         PIC X(03) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966B-AFTER-MRTL        PIC X(04) VALUE SPACES.                  
           05  FILLER                  PIC X(02) VALUE SPACES.                  
           05  L966B-AFTER-NAME        PIC X(46) VALUE SPACES.                  
                                                                                
       01  L966B-PR-LINE               PIC X(100) VALUE ALL '-'.                
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
      *=============================================================            
       0000-CONTROL.                                                            
      *=============================================================            
                                                                                
           PERFORM 1000-OPEN-ROUTINE       THRU 1000-EXIT.                      
           PERFORM 1100-GET-DATE           THRU 1100-EXIT.                      
           PERFORM 1300-PRINT-L966B-HEADER THRU 1300-EXIT.                      
           PERFORM 2000-BP13FIN-READ       THRU 2000-EXIT.                      
           PERFORM 3000-MAIN-ROUTINE       THRU 3000-EXIT                       
                   UNTIL WS-FIN-EOF = 'Y'.                                      
           PERFORM 9000-CLOSE-ROUTINE      THRU 9000-EXIT.                      
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *=============================================================            
       1000-OPEN-ROUTINE.                                                       
      *=============================================================            
                                                                                
           OPEN INPUT  BP13FIN                                                  
                OUTPUT P13L966A                                                 
                       P13L966B.                                                
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *=============================================================            
       1100-GET-DATE.                                                           
      *=============================================================            
                                                                                
      *-------------------------------------------------------------            
      *    GET CURRENT DATE                                                     
      *-------------------------------------------------------------            
           MOVE FUNCTION CURRENT-DATE(1:8) TO   WS-DTE-CURR-8.                  
           MOVE WS-DTE-CURR-8              TO   WS-DTE-FMT8.                    
           MOVE CORR WS-DTE-FMT8           TO   WS-DTE-FMT10.                   
           MOVE WS-DTE-FMT10               TO   WS-DTE-CURR-10.                 
                                                                                
       1100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *=============================================================            
       1200-PRINT-L966A-HEADER.                                                 
      *=============================================================            
                                                                                
           MOVE SPACES                     TO   WS-LINK-REC-CCNT.               
           MOVE FIN-OIC                    TO   WS-LINK-STAFF-NICK.             
           MOVE 'EML'                      TO   WS-LINK-CNTCT-TYPE.             
                                                                                
           PERFORM 8000-CALL-BP13CCNT      THRU 8000-EXIT.                      
                                                                                
           MOVE SPACES                     TO   MAIL-HDR-MAIL-RCPT-TO           
                                                MAIL-HDR-MAIL-TO.               
                                                                                
           STRING 'RCPT TO:<'          DELIMITED BY SIZE                        
                   WS-LINK-STAFF-CNTCT DELIMITED BY SPACE                       
                  '>'                  DELIMITED BY SIZE                        
                   INTO MAIL-HDR-MAIL-RCPT-TO.                                  
                                                                                
           STRING 'TO:<'               DELIMITED BY SIZE                        
                   WS-LINK-STAFF-CNTCT DELIMITED BY SPACE                       
                  '>'                  DELIMITED BY SIZE                        
                   INTO MAIL-HDR-MAIL-TO.                                       
                                                                                
           MOVE WS-DTE-CURR-10             TO   MAIL-DATE                       
                                                L966A-DATE-RUN.                 
           MOVE 1                          TO   L966A-PAGENO.                   
                                                                                
           WRITE P13L966A-REC              FROM MAIL-HDR-HELO.                  
           WRITE P13L966A-REC              FROM MAIL-HDR-MAIL-FROM.             
           WRITE P13L966A-REC              FROM MAIL-HDR-MAIL-RCPT-TO.          
      *    WRITE P13L966A-REC              FROM MAIL-HDR-MAIL-RCPT2.            
           WRITE P13L966A-REC              FROM MAIL-HDR-DATA.                  
           WRITE P13L966A-REC              FROM MAIL-HDR-FROM.                  
           WRITE P13L966A-REC              FROM MAIL-HDR-MAIL-TO.               
      *    WRITE P13L966A-REC              FROM MAIL-HDR-MAIL-TO-CC2.           
           WRITE P13L966A-REC              FROM MAIL-SUBJECT-L966A.             
           WRITE P13L966A-REC              FROM MAIL-HDR-DATE.                  
           WRITE P13L966A-REC              FROM MAIL-SPACES.                    
                                                                                
           MOVE SPACES                       TO MAIL-BODY-L966A.                
           STRING 'The following booked flat application(s) '                   
                  'have mis-matching data between our SOC records '             
               DELIMITED BY SIZE INTO MAIL-BODY-L966A.                          
                                                                                
           WRITE P13L966A-REC              FROM MAIL-BODY-L966A.                
                                                                                
           MOVE SPACES                       TO MAIL-BODY-L966A.                
           STRING 'and MHAs records. Please check on the case(s) '              
                  'and determine if any follow-up action is needed:'            
               DELIMITED BY SIZE INTO MAIL-BODY-L966A.                          
                                                                                
           WRITE P13L966A-REC              FROM MAIL-BODY-L966A.                
                                                                                
           WRITE P13L966A-REC              FROM MAIL-SPACES.                    
                                                                                
           WRITE P13L966A-REC              FROM L966A-PR-HEAD-01.               
           WRITE P13L966A-REC              FROM L966A-PR-HEAD-02.               
           WRITE P13L966A-REC              FROM MAIL-SPACES.                    
                                                                                
           WRITE P13L966A-REC              FROM L966A-PR-HEAD-03.               
           WRITE P13L966A-REC              FROM L966A-PR-HEAD-04.               
           WRITE P13L966A-REC              FROM L966A-PR-LINE.                  
           WRITE P13L966A-REC              FROM MAIL-SPACES.                    
                                                                                
           MOVE ZEROES                     TO   WS-NUM-SNO-L966A.               
                                                                                
       1200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *=============================================================            
       1300-PRINT-L966B-HEADER.                                                 
      *=============================================================            
                                                                                
           MOVE WS-DTE-CURR-10             TO   MAIL-DATE                       
                                                L966B-DATE-RUN.                 
           MOVE 1                          TO   L966B-PAGENO.                   
                                                                                
           WRITE P13L966B-REC              FROM MAIL-HDR-HELO.                  
           WRITE P13L966B-REC              FROM MAIL-HDR-MAIL-FROM.             
      *    WRITE P13L966B-REC              FROM MAIL-HDR-MAIL-RCPT-GRACE        
           WRITE P13L966B-REC              FROM MAIL-HDR-MAIL-RCPT1.            
           WRITE P13L966B-REC              FROM MAIL-HDR-MAIL-RCPT1A.           
           WRITE P13L966B-REC              FROM MAIL-HDR-DATA.                  
           WRITE P13L966B-REC              FROM MAIL-HDR-FROM.                  
      *    WRITE P13L966B-REC              FROM MAIL-HDR-MAIL-TO-GRACE.         
           WRITE P13L966B-REC              FROM MAIL-HDR-MAIL-TO-CC1.           
           WRITE P13L966B-REC              FROM MAIL-HDR-MAIL-TO-CC1A.          
           WRITE P13L966B-REC              FROM MAIL-SUBJECT-L966B.             
           WRITE P13L966B-REC              FROM MAIL-HDR-DATE.                  
           WRITE P13L966B-REC              FROM MAIL-SPACES.                    
                                                                                
           WRITE P13L966B-REC              FROM L966B-PR-HEAD-01.               
           WRITE P13L966B-REC              FROM L966B-PR-HEAD-02.               
           WRITE P13L966B-REC              FROM MAIL-SPACES.                    
                                                                                
           WRITE P13L966B-REC              FROM L966B-PR-HEAD-03.               
           WRITE P13L966B-REC              FROM L966B-PR-HEAD-04.               
           WRITE P13L966B-REC              FROM L966B-PR-LINE.                  
           WRITE P13L966B-REC              FROM MAIL-SPACES.                    
                                                                                
       1300-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *=============================================================            
       2000-BP13FIN-READ.                                                       
      *=============================================================            
                                                                                
           READ BP13FIN                                                         
              AT END MOVE 'Y'              TO   WS-FIN-EOF.                     
                                                                                
           IF WS-FIN-EOF NOT = 'Y'                                              
              ADD 1                        TO   WS-CNT-FIN-READ                 
           ELSE                                                                 
              WRITE P13L966A-REC           FROM MAIL-SPACES                     
              WRITE P13L966A-REC           FROM MAIL-SPACES                     
                                                                                
              PERFORM 2001-WRITE-MAIL-END-L966A  THRU 2001-EXIT                 
           END-IF.                                                              
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *=============================================================            
       2001-WRITE-MAIL-END-L966A.                                               
      *=============================================================            
                                                                                
           MOVE SPACES                       TO MAIL-END-L966A.                 
           STRING '*If you need to contact HAs to clarify, '                    
                  'please refrain from informing them about the '               
                  'data sharing '                                               
                 DELIMITED BY SIZE INTO MAIL-END-L966A.                         
                                                                                
           WRITE P13L966A-REC           FROM MAIL-END-L966A.                    
                                                                                
           MOVE SPACES                       TO MAIL-END-L966A.                 
           STRING 'arrangement between HDB and MHA. You could consider' r '     
                  ' simply stating that, "Based on our records, '               
                 DELIMITED BY SIZE INTO MAIL-END-L966A.                         
                                                                                
           WRITE P13L966A-REC           FROM MAIL-END-L966A.                    
                                                                                
           MOVE SPACES                       TO MAIL-END-L966A.                 
           STRING 'we understand that there was a recent update '               
                  'to your XXXX ..."'                                           
                 DELIMITED BY SIZE INTO MAIL-END-L966A.                         
                                                                                
           WRITE P13L966A-REC           FROM MAIL-END-L966A.                    
           WRITE P13L966A-REC           FROM MAIL-END.                          
                                                                                
       2001-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *=============================================================            
       3000-MAIN-ROUTINE.                                                       
      *=============================================================            
                                                                                
           IF FIN-OIC NOT = SPACES AND LOW-VALUES AND ZEROES                    
              IF FIN-OIC NOT = WS-PREV-OIC                                      
                 IF WS-PREV-OIC NOT = SPACES                                    
                    WRITE P13L966A-REC           FROM MAIL-SPACES               
                    WRITE P13L966A-REC           FROM MAIL-SPACES               
                                                                                
                    PERFORM 2001-WRITE-MAIL-END-L966A  THRU 2001-EXIT           
                                                                                
                 END-IF                                                         
                 PERFORM 1200-PRINT-L966A-HEADER THRU 1200-EXIT                 
                 MOVE FIN-OIC                    TO   WS-PREV-OIC               
              END-IF                                                            
                                                                                
              PERFORM 3100-WRITE-L966A-REPORT    THRU 3100-EXIT                 
           END-IF.                                                              
                                                                                
           PERFORM 3200-WRITE-L966B-REPORT       THRU 3200-EXIT.                
                                                                                
           PERFORM 2000-BP13FIN-READ             THRU 2000-EXIT.                
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *=============================================================            
       3100-WRITE-L966A-REPORT.                                                 
      *=============================================================            
                                                                                
           ADD 1                           TO   WS-NUM-SNO-L966A                
                                                WS-CNT-L966A-WRITE.             
                                                                                
           MOVE WS-NUM-SNO-L966A           TO   L966A-SNO                       
           MOVE FIN-REGN-NO                TO   L966A-REGN-NO                   
           MOVE FIN-AST-NRIC               TO   L966A-AST-NRIC                  
           MOVE FIN-BEFORE-NRIC            TO   L966A-BEFORE-NRIC               
           MOVE FIN-AST-PRST               TO   L966A-AST-PRST                  
           MOVE FIN-BEFORE-PRST            TO   L966A-BEFORE-PRST               
           MOVE FIN-AST-NTNLTY             TO   L966A-AST-NTNLTY                
           MOVE FIN-BEFORE-NTNLTY          TO   L966A-BEFORE-NTNLTY             
           MOVE FIN-AST-SEX                TO   L966A-AST-SEX                   
           MOVE FIN-BEFORE-SEX             TO   L966A-BEFORE-SEX                
           MOVE FIN-AST-MRTL               TO   L966A-AST-MRTL                  
           MOVE FIN-BEFORE-MRTL            TO   L966A-BEFORE-MRTL               
           MOVE FIN-AST-NAME               TO   L966A-AST-NAME                  
           MOVE FIN-BEFORE-NAME            TO   L966A-BEFORE-NAME               
                                                                                
           WRITE P13L966A-REC              FROM L966A-PR-DTL-01.                
                                                                                
           MOVE FIN-AFTER-NRIC             TO   L966A-AFTER-NRIC                
           MOVE FIN-AFTER-PRST             TO   L966A-AFTER-PRST                
           MOVE FIN-AFTER-NTNLTY           TO   L966A-AFTER-NTNLTY              
           MOVE FIN-AFTER-SEX              TO   L966A-AFTER-SEX                 
           MOVE FIN-AFTER-MRTL             TO   L966A-AFTER-MRTL                
           MOVE FIN-AFTER-NAME             TO   L966A-AFTER-NAME                
                                                                                
           WRITE P13L966A-REC              FROM L966A-PR-DTL-02.                
                                                                                
           WRITE P13L966A-REC              FROM MAIL-SPACES.                    
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *=============================================================            
       3200-WRITE-L966B-REPORT.                                                 
      *=============================================================            
                                                                                
           ADD 1                           TO   WS-NUM-SNO-L966B                
                                                WS-CNT-L966B-WRITE.             
                                                                                
           MOVE WS-NUM-SNO-L966B           TO   L966B-SNO                       
           MOVE FIN-REGN-NO                TO   L966B-REGN-NO                   
           MOVE FIN-BEFORE-NRIC            TO   L966B-BEFORE-NRIC               
           MOVE FIN-BEFORE-PRST            TO   L966B-BEFORE-PRST               
           MOVE FIN-BEFORE-NTNLTY          TO   L966B-BEFORE-NTNLTY             
           MOVE FIN-BEFORE-SEX             TO   L966B-BEFORE-SEX                
           MOVE FIN-BEFORE-MRTL            TO   L966B-BEFORE-MRTL               
           MOVE FIN-BEFORE-NAME            TO   L966B-BEFORE-NAME               
           MOVE FIN-OIC                    TO   L966B-OIC.                      
                                                                                
           WRITE P13L966B-REC              FROM L966B-PR-DTL-01.                
                                                                                
           MOVE FIN-AFTER-NRIC             TO   L966B-AFTER-NRIC                
           MOVE FIN-AFTER-PRST             TO   L966B-AFTER-PRST                
           MOVE FIN-AFTER-NTNLTY           TO   L966B-AFTER-NTNLTY              
           MOVE FIN-AFTER-SEX              TO   L966B-AFTER-SEX                 
           MOVE FIN-AFTER-MRTL             TO   L966B-AFTER-MRTL                
           MOVE FIN-AFTER-NAME             TO   L966B-AFTER-NAME                
                                                                                
           WRITE P13L966B-REC              FROM L966B-PR-DTL-02.                
                                                                                
           WRITE P13L966B-REC              FROM MAIL-SPACES.                    
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *=============================================================            
       8000-CALL-BP13CCNT.                                                      
      *=============================================================            
                                                                                
           CALL 'BP13CCNT' USING  WS-LINK-REC-CCNT.                             
                                                                                
           EVALUATE WS-LINK-SYSERR                                              
           WHEN 000                                                             
              CONTINUE                                                          
                                                                                
           WHEN 100                                                             
              DISPLAY 'EMAIL ADDRESS NOT FOUND FOR ' FIN-OIC                    
              STRING  FIN-OIC      DELIMITED BY SPACE                           
                     '@hdb.gov.sg' DELIMITED BY SIZE                            
                                           INTO WS-LINK-STAFF-CNTCT             
                                                                                
           WHEN OTHER                                                           
              DISPLAY 'BP13CCNT ERROR STATUS : ' WS-LINK-SYSERR                 
              PERFORM 9000-CLOSE-ROUTINE   THRU 9000-EXIT                       
           END-EVALUATE.                                                        
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *=============================================================            
       9000-CLOSE-ROUTINE.                                                      
      *=============================================================            
                                                                                
           CLOSE BP13FIN                                                        
                 P13L966A                                                       
                 P13L966B.                                                      
                                                                                
           DISPLAY '   '.                                                       
           DISPLAY '*------- BP13C966 CONTROL TOTAL -------*'.                  
           DISPLAY '   '.                                                       
           DISPLAY ' 1. NO OF BP13FIN READ       : ' WS-CNT-FIN-READ.           
           DISPLAY ' 2. NO OF P13L966A WRITTEN   : ' WS-CNT-L966A-WRITE.        
           DISPLAY ' 3. NO OF P13L966B WRITTEN   : ' WS-CNT-L966B-WRITE.        
           DISPLAY '  '.                                                        
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
