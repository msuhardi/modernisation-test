       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C028.                                                 
      *AUTHOR.        MICHAEL ARRIOLA.                                          
      *DATE-WRITTEN.  02/10/2008.                                               
      * ========================================================== *            
      * SYSTEM OF COMMITMENT (BP13)                                             
      * ========================================================== *            
      *                                                            *            
      * OBJECTIVES: MATCH VALID BOOKED UNIT FROM DEVELOPER, CREATE *            
      *             E-APPLICATION RECORD, UPDATE REGN-NO.          *            
      *                                                            *            
      * FILE DESCRIPTION :-                                        *            
      *                                                            *            
      * DD NAME   I/O/E ACCESSMODE  RECLEN KEY          REMARKS    *            
      *------------------------------------------------------------*            
      * BP13FB60  I     SEQUENTIAL  2843                           *            
      * BP13FA30  I     SEQUENTIAL   200                           *            
      * BP13KB78  I/O   KSDS        3300          REQUEST FILE     *            
      * BP13KB20  I/O   KSDS        3300          BOOKED  FILE     *            
      * ---------------------------------------------------------- *            
      * CHG REF   BY    DATE      DETAILS                          *            
      * -------   ====  ========= ================================ *            
      * BP133452  MSD1  20081002  NEW PGM                          *            
      * BP133388  MSD1  20081028  POPULATE DTE-UPDATE FROM DTE-REQ *            
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
                                                                                
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
      *-------------------------------------------------------------            
           SELECT BP13FB60  ASSIGN        TO BP13FB60.                          
           SELECT BP13FA30  ASSIGN        TO BP13FA30.                          
                                                                                
           SELECT BP13KB78  ASSIGN        TO BP13KB78                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS KB78-KEY-FLD                       
                            FILE STATUS   IS BP13KB78-STATUS.                   
                                                                                
           SELECT BP13KB20  ASSIGN        TO BP13KB20                           
                            ACCESS MODE   IS RANDOM                             
                            ORGANIZATION  IS INDEXED                            
                            RECORD KEY    IS KB20-KEY-FLD                       
                            FILE STATUS   IS BP13KB20-STATUS.                   
                                                                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       FD   BP13FB60                                                            
            RECORD CONTAINS 2843 CHARACTERS                                     
            BLOCK CONTAINS 0 RECORDS                                            
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13FB60.                                                           
                                                                                
       FD   BP13FA30                                                            
            RECORD CONTAINS 200 CHARACTERS                                      
            BLOCK CONTAINS 0 RECORDS                                            
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13FA30.                                                           
                                                                                
       FD   BP13KB78                                                            
            RECORD CONTAINS 3300 CHARACTERS.                                    
       COPY BP13KB78.                                                           
                                                                                
       FD   BP13KB20                                                            
            RECORD CONTAINS 3300 CHARACTERS.                                    
       COPY BP13KB20.                                                           
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
       01 WS-FILE-STATUS.                                                       
          05 BP13KB78-STATUS       PIC 9(02) VALUE ZEROES.                      
          05 BP13KB20-STATUS       PIC 9(02) VALUE ZEROES.                      
                                                                                
       01 WS-COUNTERS.                                                          
          05 WS-FB60-READ          PIC 9(08) VALUE ZEROES.                      
          05 WS-FA30-READ          PIC 9(08) VALUE ZEROES.                      
          05 WS-MATCHED            PIC 9(08) VALUE ZEROES.                      
          05 WS-FA30-NFND          PIC 9(08) VALUE ZEROES.                      
          05 WS-FB60-NFND          PIC 9(08) VALUE ZEROES.                      
          05 WS-KB78-WRITE         PIC 9(08) VALUE ZEROES.                      
          05 WS-KB78-DUPKEY        PIC 9(08) VALUE ZEROES.                      
          05 WS-KB20-WRITE         PIC 9(08) VALUE ZEROES.                      
          05 WS-KB20-DUPKEY        PIC 9(08) VALUE ZEROES.                      
          05 WS-CNT-APPLT          PIC 9(02) VALUE ZEROES.                      
          05 WS-CNT                PIC 9(01) VALUE ZEROES.                      
                                                                                
       01 WS-VARIABLES.                                                         
          05 WS-CURRENT-TIME       PIC 9(08) VALUE ZEROES.                      
          05 WS-CURRENT-DATE       PIC X(08) VALUE SPACES.                      
          05 WS-CUR-DATE REDEFINES WS-CURRENT-DATE.                             
             15 WS-CUR-CCYY        PIC 9(04).                                   
             15 WS-CUR-MM          PIC 9(02).                                   
             15 WS-CUR-DD          PIC 9(02).                                   
          05 WS-TAB-OCCUP-DET.                                                  
             10 WS-REL-AGE OCCURS 8 TIMES.                                      
                15 WS-REL          PIC X(02) VALUE SPACES.                      
                15 WS-DTE-BIRTH.                                                
                   20 WS-DTE-CCYY  PIC 9(04) VALUE ZEROES.                      
                   20 WS-DTE-MM    PIC 9(02) VALUE ZEROES.                      
                   20 WS-DTE-DD    PIC 9(02) VALUE ZEROES.                      
                15 WS-MRTL         PIC X(01) VALUE SPACES.                      
          05 WS-DOB                PIC X(08) VALUE SPACES.                      
          05 WS-NUM-DOB REDEFINES WS-DOB.                                       
               10 WS-DOB-CCYY      PIC 9(04).                                   
               10 WS-DOB-MM        PIC 9(02).                                   
               10 WS-DOB-DD        PIC 9(02).                                   
          05 WS-CNT-MONTHS         PIC 9(04) VALUE ZEROES.                      
          05 WS-CONTROL-MONTH      PIC 9(03) VALUE 252.                         
                                                                                
       01 WS-SWITCHES.                                                          
          05 APP1-MARITAL-FLAG     PIC X(01).                                   
             88 APP1-SINGLE                  VALUE '1', 'S',                    
                                                   '3', 'W',                    
                                                   '4', 'D',                    
                                                   '5', 'P'.                    
             88 APP1-SINGLE-PAS              VALUE '1', 'S'.                    
             88 APP1-MARRIED                 VALUE '2', 'M'.                    
             88 APP1-OTHERS                  VALUE '3', 'W',                    
                                                   '4', 'D',                    
                                                   '5', 'P'.                    
             88 APP1-ORPHAN                  VALUE 'O'.                         
          05 SPOUSE-YES-FLAG       PIC X(01).                                   
             88 SPOUSE-YES                   VALUE 'Y'.                         
          05 NON-CITI-SPOUSE-FLAG  PIC X(01).                                   
             88 NON-CITI-SPOUSE              VALUE 'Y'.                         
          05 PARENTS-YES-FLAG      PIC X(01).                                   
             88 PARENTS-YES                  VALUE 'Y'.                         
          05 NON-CITI-PARENT-FLAG  PIC X(01).                                   
             88 NON-CITI-PARENT              VALUE 'Y'.                         
          05 CITIZEN-PARENT-FLAG   PIC X(01).                                   
             88 CITIZEN-PARENT               VALUE 'Y'.                         
          05 BRO-SIS-YES-FLAG      PIC X(01).                                   
             88 BRO-SIS-YES                  VALUE 'Y'.                         
          05 CITIZEN-BRO-SIS-FLAG  PIC X(01).                                   
             88 CITIZEN-BRO-SIS              VALUE 'Y'.                         
          05 CHILD-YES-FLAG        PIC X(01).                                   
             88 CHILD-YES                    VALUE 'Y'.                         
          05 CITIZEN-CHILD-FLAG    PIC X(01).                                   
             88 CITIZEN-CHILD                VALUE 'Y'.                         
          05 GCHILD-YES-FLAG       PIC X(01).                                   
             88 GCHILD-YES                   VALUE 'Y'.                         
          05 ABOVE-21-FLAG         PIC X(01).                                   
             88 ABOVE-21                     VALUE 'Y'.                         
      *---------------------------------------------------------------*         
      * FLAGS TO DETERMINED THE SCHEME                                *         
      *---------------------------------------------------------------*         
          05 SINGLE-APP2-OCC-FIANCE-FLAG    PIC X(01).                          
             88 SINGLE-APP2-OCC-FIANCE       VALUE 'Y'.                         
          05 APP2-OCC-SINGLE-SIB-FLAG       PIC X(01).                          
             88 APP2-OCC-SINGLE-SIB          VALUE 'Y'.                         
          05 YES-PARENT-IN-APPS-FLAG        PIC X(01).                          
             88 YES-PARENT-IN-APPS           VALUE 'Y'.                         
          05 CHILD-IN-OCC-FLAG              PIC X(01).                          
             88 CHILD-IN-OCC                 VALUE 'Y'.                         
          05 APP1-CHILD-GRANDCH-SINGLE-FLAG PIC X(01).                          
             88 APP1-CHILD-GRANDCH-SINGLE    VALUE 'Y'.                         
          05 APP2-OCC-CHILD-SINGLE-FLAG     PIC X(01).                          
             88 APP2-OCC-CHILD-SINGLE        VALUE 'Y'.                         
          05 APP2-OCC-CHILD-SINGLE-B21-FLAG PIC X(01).                          
             88 APP2-OCC-CHILD-SINGLE-B21    VALUE 'Y'.                         
          05 APP1-SINGLE-CHILD-FLAG         PIC X(01).                          
             88 APP1-SINGLE-CHILD            VALUE 'Y'.                         
          05 APP2-OCC-SINGLE-PARENT-FLAG    PIC X(01).                          
             88 APP2-OCC-SINGLE-PARENT       VALUE 'Y'.                         
          05 APP2-OCC-ADOPT-PARENTS-FLAG    PIC X(01).                          
             88 APP2-OCC-ADOPT-PARENTS       VALUE 'Y'.                         
          05 APP2-OCC-ADOPT-CHILD-FLAG      PIC X(01).                          
             88 APP2-OCC-ADOPT-CHILD         VALUE 'Y'.                         
          05 OCC-MARRIED-NON-CITIZEN-FLAG   PIC X(01).                          
             88 OCC-MARRIED-NON-CITIZEN      VALUE 'Y'.                         
          05 WS-SA-IND                      PIC X(01) VALUE 'N'.                
                                                                                
                                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       PROCEDURE DIVISION.                                                      
      *-------------------------------------------------------------            
       0000-MAIN.                                                               
      *-------------------------------------------------------------            
                                                                                
           PERFORM 1000-OPEN-FILES     THRU 1000-EXIT.                          
           PERFORM 2000-READ-BP13FB60  THRU 2000-EXIT.                          
           PERFORM 3000-READ-BP13FA30  THRU 3000-EXIT.                          
           PERFORM 4000-MATCH-RECORD   THRU 4000-EXIT                           
              UNTIL FB60-NUM-REGN        = HIGH-VALUES                          
                AND FA30-NUM-DVLP-CASENO = HIGH-VALUES.                         
           PERFORM 9000-CLOSE-ROUTINE  THRU 9000-EXIT.                          
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       1000-OPEN-FILES.                                                         
      *-------------------------------------------------------------            
                                                                                
           OPEN INPUT  BP13FB60                                                 
                       BP13FA30                                                 
                  I-O  BP13KB78                                                 
                       BP13KB20.                                                
                                                                                
           IF BP13KB78-STATUS  NOT =  00 AND 97                                 
              DISPLAY 'ERROR OPENING - BP13KB78 : ' BP13KB78-STATUS             
              MOVE     BP13KB78-STATUS      TO RETURN-CODE                      
              PERFORM  9000-CLOSE-ROUTINE THRU 9000-EXIT.                       
                                                                                
           IF BP13KB20-STATUS  NOT =  00 AND 97                                 
              DISPLAY 'ERROR OPENING - BP13KB20 : ' BP13KB20-STATUS             
              MOVE     BP13KB20-STATUS      TO RETURN-CODE                      
              PERFORM  9000-CLOSE-ROUTINE THRU 9000-EXIT.                       
                                                                                
           MOVE FUNCTION CURRENT-DATE       TO WS-CURRENT-DATE.                 
           ACCEPT        WS-CURRENT-TIME  FROM TIME.                            
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       2000-READ-BP13FB60.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13FB60 AT END                                                 
                MOVE HIGH-VALUES TO FB60-NUM-REGN                               
                GO TO 2000-EXIT.                                                
                                                                                
           ADD 1   TO WS-FB60-READ.                                             
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3000-READ-BP13FA30.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13FA30 AT END                                                 
                MOVE HIGH-VALUES TO FA30-NUM-DVLP-CASENO                        
                GO TO 3000-EXIT.                                                
                                                                                
           ADD 1   TO WS-FA30-READ.                                             
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       4000-MATCH-RECORD.                                                       
      *-------------------------------------------------------------            
                                                                                
           EVALUATE TRUE                                                        
              WHEN FA30-NUM-DVLP-CASENO =  FB60-NUM-REGN                        
                 ADD                         1 TO WS-MATCHED                    
                 PERFORM 5000-PROCESS-DATA     THRU 5000-EXIT                   
                                                                                
              WHEN FA30-NUM-DVLP-CASENO >  FB60-NUM-REGN                        
                 ADD                         1 TO WS-FB60-NFND                  
                 PERFORM 2000-READ-BP13FB60    THRU 2000-EXIT                   
                                                                                
              WHEN FA30-NUM-DVLP-CASENO <  FB60-NUM-REGN                        
                 ADD                         1 TO WS-FA30-NFND                  
                 PERFORM 3000-READ-BP13FA30    THRU 3000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       5000-PROCESS-DATA.                                                       
      *-------------------------------------------------------------            
                                                                                
           PERFORM 5100-POPULATE-KB78    THRU 5100-EXIT                         
           PERFORM 6000-DETERMINE-ELIG   THRU 6000-EXIT                         
           PERFORM 5200-WRITE-BP13KB78   THRU 5200-EXIT                         
                                                                                
           MOVE BP13KB78-REC             TO BP13KB20-REC.                       
           MOVE KB78-NUM-APPLT1-RACE     TO KB20-NUM-RACE.                      
           PERFORM 8000-WRITE-BP13KB20   THRU 8000-EXIT                         
                                                                                
           PERFORM 2000-READ-BP13FB60    THRU 2000-EXIT.                        
           PERFORM 3000-READ-BP13FA30    THRU 3000-EXIT.                        
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       5100-POPULATE-KB78.                                                      
      *-------------------------------------------------------------            
                                                                                
           MOVE SPACES                 TO BP13KB78-REC.                         
           INITIALIZE                     BP13KB78-REC.                         
                                                                                
           MOVE FB60-NUM-PROJECT       TO KB78-NUM-PROJECT.                     
           MOVE FA30-NUM-REGN          TO KB78-NUM-REGN.                        
           MOVE FB60-NUM-NEW-TOWN      TO KB78-NUM-NEW-TOWN                     
           MOVE FB60-NUM-FLAT-TYPE     TO KB78-NUM-FLAT-TYPE                    
                                                                                
           MOVE FB60-NUM-APPLT1-UIN    TO KB78-NUM-APPLT1-UIN                   
           MOVE FB60-NME-APPLT1        TO KB78-NME-APPLT1                       
           MOVE FB60-DTE-APPLT1-BIRTH  TO KB78-DTE-APPLT1-BIRTH                 
           MOVE FB60-NUM-APPLT1-RACE   TO KB78-NUM-APPLT1-RACE                  
           MOVE FB60-NUM-APPLT1-SEX    TO KB78-NUM-APPLT1-SEX                   
           MOVE FB60-NUM-APPLT1-MARITAL-STATUS                                  
                                       TO KB78-NUM-APPLT1-MARITAL-STATUS        
           MOVE FB60-NUM-APPLT1-SPOUSE-UIN                                      
                                       TO KB78-NUM-APPLT1-SPOUSE-UIN            
           MOVE FB60-AMT-APPLT1-INCOME TO KB78-AMT-APPLT1-INCOME                
           MOVE FB60-NUM-APPLT1-EMPLY-STATUS                                    
                                       TO KB78-NUM-APPLT1-EMPLY-STATUS          
           MOVE FB60-NME-APPLT1-OCCUPATION                                      
                                       TO KB78-NME-APPLT1-OCCUPATION            
           MOVE FB60-NUM-APPLT1-PHONE  TO KB78-NUM-APPLT1-PHONE                 
           MOVE FB60-NUM-APPLT1-HP-PAGER                                        
                                       TO KB78-NUM-APPLT1-HP-PAGER              
           MOVE FB60-NUM-APPLT1-EDN-LVL                                         
                                       TO KB78-NUM-APPLT1-EDN-LVL               
                                                                                
           MOVE FB60-NUM-APPLT2-UIN    TO KB78-NUM-APPLT2-UIN                   
           MOVE FB60-NME-APPLT2        TO KB78-NME-APPLT2                       
           MOVE FB60-NUM-APPLT2-CITIZENSHIP                                     
                                       TO KB78-NUM-APPLT2-CITIZENSHIP           
           MOVE FB60-DTE-APPLT2-BIRTH  TO KB78-DTE-APPLT2-BIRTH                 
           MOVE FB60-NUM-APPLT2-RACE   TO KB78-NUM-APPLT2-RACE                  
           MOVE FB60-NUM-APPLT2-SEX    TO KB78-NUM-APPLT2-SEX                   
           MOVE FB60-NUM-APPLT2-MARITAL-STATUS                                  
                                       TO KB78-NUM-APPLT2-MARITAL-STATUS        
           MOVE FB60-NUM-APPLT2-SPOUSE-UIN                                      
                                       TO KB78-NUM-APPLT2-SPOUSE-UIN            
           MOVE FB60-NUM-APPLT2-RLTNSP-APPLT1                                   
                                       TO KB78-NUM-APPLT2-RLTNSP-APPLT1         
           MOVE FB60-AMT-APPLT2-INCOME TO KB78-AMT-APPLT2-INCOME                
           MOVE FB60-NUM-APPLT2-EMPLY-STATUS                                    
                                       TO KB78-NUM-APPLT2-EMPLY-STATUS          
           MOVE FB60-NME-APPLT2-OCCUPATION                                      
                                       TO KB78-NME-APPLT2-OCCUPATION            
           MOVE FB60-NUM-APPLT2-PHONE  TO KB78-NUM-APPLT2-PHONE                 
           MOVE FB60-NUM-APPLT2-HP-PAGER                                        
                                       TO KB78-NUM-APPLT2-HP-PAGER              
           MOVE FB60-NUM-APPLT2-EDN-LVL                                         
                                       TO KB78-NUM-APPLT2-EDN-LVL               
                                                                                
           MOVE FB60-NUM-APPLT3-UIN    TO KB78-NUM-APPLT3-UIN                   
           MOVE FB60-NME-APPLT3        TO KB78-NME-APPLT3                       
           MOVE FB60-NUM-APPLT3-CITIZENSHIP                                     
                                       TO KB78-NUM-APPLT3-CITIZENSHIP           
           MOVE FB60-DTE-APPLT3-BIRTH  TO KB78-DTE-APPLT3-BIRTH                 
           MOVE FB60-NUM-APPLT3-RACE   TO KB78-NUM-APPLT3-RACE                  
           MOVE FB60-NUM-APPLT3-SEX    TO KB78-NUM-APPLT3-SEX                   
           MOVE FB60-NUM-APPLT3-MARITAL-STATUS                                  
                                       TO KB78-NUM-APPLT3-MARITAL-STATUS        
           MOVE FB60-NUM-APPLT3-SPOUSE-UIN                                      
                                       TO KB78-NUM-APPLT3-SPOUSE-UIN            
           MOVE FB60-NUM-APPLT3-RLTNSP-APPLT1                                   
                                       TO KB78-NUM-APPLT3-RLTNSP-APPLT1         
           MOVE FB60-AMT-APPLT3-INCOME TO KB78-AMT-APPLT3-INCOME                
           MOVE FB60-NUM-APPLT3-EMPLY-STATUS                                    
                                       TO KB78-NUM-APPLT3-EMPLY-STATUS          
           MOVE FB60-NME-APPLT3-OCCUPATION                                      
                                       TO KB78-NME-APPLT3-OCCUPATION            
           MOVE FB60-NUM-APPLT3-PHONE  TO KB78-NUM-APPLT3-PHONE                 
           MOVE FB60-NUM-APPLT3-HP-PAGER                                        
                                       TO KB78-NUM-APPLT3-HP-PAGER              
           MOVE FB60-NUM-APPLT3-EDN-LVL                                         
                                       TO KB78-NUM-APPLT3-EDN-LVL               
                                                                                
           MOVE FB60-NUM-APPLT4-UIN    TO KB78-NUM-APPLT4-UIN                   
           MOVE FB60-NME-APPLT4        TO KB78-NME-APPLT4                       
           MOVE FB60-NUM-APPLT4-CITIZENSHIP                                     
                                       TO KB78-NUM-APPLT4-CITIZENSHIP           
           MOVE FB60-DTE-APPLT4-BIRTH  TO KB78-DTE-APPLT4-BIRTH                 
           MOVE FB60-NUM-APPLT4-RACE   TO KB78-NUM-APPLT4-RACE                  
           MOVE FB60-NUM-APPLT4-SEX    TO KB78-NUM-APPLT4-SEX                   
           MOVE FB60-NUM-APPLT4-MARITAL-STATUS                                  
                                       TO KB78-NUM-APPLT4-MARITAL-STATUS        
           MOVE FB60-NUM-APPLT4-SPOUSE-UIN                                      
                                       TO KB78-NUM-APPLT4-SPOUSE-UIN            
           MOVE FB60-NUM-APPLT4-RLTNSP-APPLT1                                   
                                       TO KB78-NUM-APPLT4-RLTNSP-APPLT1         
           MOVE FB60-AMT-APPLT4-INCOME TO KB78-AMT-APPLT4-INCOME                
           MOVE FB60-NUM-APPLT4-EMPLY-STATUS                                    
                                       TO KB78-NUM-APPLT4-EMPLY-STATUS          
           MOVE FB60-NME-APPLT4-OCCUPATION                                      
                                       TO KB78-NME-APPLT4-OCCUPATION            
           MOVE FB60-NUM-APPLT4-PHONE  TO KB78-NUM-APPLT4-PHONE                 
           MOVE FB60-NUM-APPLT4-HP-PAGER                                        
                                       TO KB78-NUM-APPLT4-HP-PAGER              
           MOVE FB60-NUM-APPLT4-EDN-LVL                                         
                                       TO KB78-NUM-APPLT4-EDN-LVL               
                                                                                
           MOVE FB60-NUM-OCCUP1-UIN    TO KB78-NUM-OCCUP1-UIN                   
           MOVE FB60-NME-OCCUP1        TO KB78-NME-OCCUP1                       
           MOVE FB60-NUM-OCCUP1-CITIZENSHIP                                     
                                       TO KB78-NUM-OCCUP1-CITIZENSHIP           
           MOVE FB60-DTE-OCCUP1-BIRTH  TO KB78-DTE-OCCUP1-BIRTH                 
           MOVE FB60-NUM-OCCUP1-RACE   TO KB78-NUM-OCCUP1-RACE                  
           MOVE FB60-NUM-OCCUP1-SEX    TO KB78-NUM-OCCUP1-SEX                   
           MOVE FB60-NUM-OCCUP1-MARITAL-STATUS                                  
                                       TO KB78-NUM-OCCUP1-MARITAL-STATUS        
           MOVE FB60-NUM-OCCUP1-SPOUSE-UIN                                      
                                       TO KB78-NUM-OCCUP1-SPOUSE-UIN            
           MOVE FB60-NUM-OCCUP1-RLTNSP-APPLT1                                   
                                       TO KB78-NUM-OCCUP1-RLTNSP-APPLT1         
           MOVE FB60-AMT-OCCUP1-INCOME TO KB78-AMT-OCCUP1-INCOME                
           MOVE FB60-NUM-OCCUP1-EMPLY-STATUS                                    
                                       TO KB78-NUM-OCCUP1-EMPLY-STATUS          
           MOVE FB60-NME-OCCUP1-OCCUPATION                                      
                                       TO KB78-NME-OCCUP1-OCCUPATION            
           MOVE FB60-NUM-OCCUP1-PHONE  TO KB78-NUM-OCCUP1-PHONE                 
           MOVE FB60-NUM-OCCUP1-HP-PAGER                                        
                                       TO KB78-NUM-OCCUP1-HP-PAGER              
           MOVE FB60-NUM-OCCUP1-EDN-LVL                                         
                                       TO KB78-NUM-OCCUP1-EDN-LVL               
                                                                                
           MOVE FB60-NUM-OCCUP2-UIN    TO KB78-NUM-OCCUP2-UIN                   
           MOVE FB60-NME-OCCUP2        TO KB78-NME-OCCUP2                       
           MOVE FB60-NUM-OCCUP2-CITIZENSHIP                                     
                                       TO KB78-NUM-OCCUP2-CITIZENSHIP           
           MOVE FB60-DTE-OCCUP2-BIRTH  TO KB78-DTE-OCCUP2-BIRTH                 
           MOVE FB60-NUM-OCCUP2-RACE   TO KB78-NUM-OCCUP2-RACE                  
           MOVE FB60-NUM-OCCUP2-SEX    TO KB78-NUM-OCCUP2-SEX                   
           MOVE FB60-NUM-OCCUP2-MARITAL-STATUS                                  
                                       TO KB78-NUM-OCCUP2-MARITAL-STATUS        
           MOVE FB60-NUM-OCCUP2-SPOUSE-UIN                                      
                                       TO KB78-NUM-OCCUP2-SPOUSE-UIN            
           MOVE FB60-NUM-OCCUP2-RLTNSP-APPLT1                                   
                                       TO KB78-NUM-OCCUP2-RLTNSP-APPLT1         
           MOVE FB60-AMT-OCCUP2-INCOME TO KB78-AMT-OCCUP2-INCOME                
           MOVE FB60-NUM-OCCUP2-EMPLY-STATUS                                    
                                       TO KB78-NUM-OCCUP2-EMPLY-STATUS          
           MOVE FB60-NME-OCCUP2-OCCUPATION                                      
                                       TO KB78-NME-OCCUP2-OCCUPATION            
           MOVE FB60-NUM-OCCUP2-PHONE  TO KB78-NUM-OCCUP2-PHONE                 
           MOVE FB60-NUM-OCCUP2-HP-PAGER                                        
                                       TO KB78-NUM-OCCUP2-HP-PAGER              
           MOVE FB60-NUM-OCCUP2-EDN-LVL                                         
                                       TO KB78-NUM-OCCUP2-EDN-LVL               
                                                                                
           MOVE FB60-NUM-OCCUP3-UIN    TO KB78-NUM-OCCUP3-UIN                   
           MOVE FB60-NME-OCCUP3        TO KB78-NME-OCCUP3                       
           MOVE FB60-NUM-OCCUP3-CITIZENSHIP                                     
                                       TO KB78-NUM-OCCUP3-CITIZENSHIP           
           MOVE FB60-DTE-OCCUP3-BIRTH  TO KB78-DTE-OCCUP3-BIRTH                 
           MOVE FB60-NUM-OCCUP3-RACE   TO KB78-NUM-OCCUP3-RACE                  
           MOVE FB60-NUM-OCCUP3-SEX    TO KB78-NUM-OCCUP3-SEX                   
           MOVE FB60-NUM-OCCUP3-MARITAL-STATUS                                  
                                       TO KB78-NUM-OCCUP3-MARITAL-STATUS        
           MOVE FB60-NUM-OCCUP3-SPOUSE-UIN                                      
                                       TO KB78-NUM-OCCUP3-SPOUSE-UIN            
           MOVE FB60-NUM-OCCUP3-RLTNSP-APPLT1                                   
                                       TO KB78-NUM-OCCUP3-RLTNSP-APPLT1         
           MOVE FB60-AMT-OCCUP3-INCOME TO KB78-AMT-OCCUP3-INCOME                
           MOVE FB60-NUM-OCCUP3-EMPLY-STATUS                                    
                                       TO KB78-NUM-OCCUP3-EMPLY-STATUS          
           MOVE FB60-NME-OCCUP3-OCCUPATION                                      
                                       TO KB78-NME-OCCUP3-OCCUPATION            
           MOVE FB60-NUM-OCCUP3-PHONE  TO KB78-NUM-OCCUP3-PHONE                 
           MOVE FB60-NUM-OCCUP3-HP-PAGER                                        
                                       TO KB78-NUM-OCCUP3-HP-PAGER              
           MOVE FB60-NUM-OCCUP3-EDN-LVL                                         
                                       TO KB78-NUM-OCCUP3-EDN-LVL               
                                                                                
           MOVE FB60-NUM-OCCUP4-UIN    TO KB78-NUM-OCCUP4-UIN                   
           MOVE FB60-NME-OCCUP4        TO KB78-NME-OCCUP4                       
           MOVE FB60-NUM-OCCUP4-CITIZENSHIP                                     
                                       TO KB78-NUM-OCCUP4-CITIZENSHIP           
           MOVE FB60-DTE-OCCUP4-BIRTH  TO KB78-DTE-OCCUP4-BIRTH                 
           MOVE FB60-NUM-OCCUP4-RACE   TO KB78-NUM-OCCUP4-RACE                  
           MOVE FB60-NUM-OCCUP4-SEX    TO KB78-NUM-OCCUP4-SEX                   
           MOVE FB60-NUM-OCCUP4-MARITAL-STATUS                                  
                                       TO KB78-NUM-OCCUP4-MARITAL-STATUS        
           MOVE FB60-NUM-OCCUP4-SPOUSE-UIN                                      
                                       TO KB78-NUM-OCCUP4-SPOUSE-UIN            
           MOVE FB60-NUM-OCCUP4-RLTNSP-APPLT1                                   
                                       TO KB78-NUM-OCCUP4-RLTNSP-APPLT1         
           MOVE FB60-AMT-OCCUP4-INCOME TO KB78-AMT-OCCUP4-INCOME                
           MOVE FB60-NUM-OCCUP4-EMPLY-STATUS                                    
                                       TO KB78-NUM-OCCUP4-EMPLY-STATUS          
           MOVE FB60-NME-OCCUP4-OCCUPATION                                      
                                       TO KB78-NME-OCCUP4-OCCUPATION            
           MOVE FB60-NUM-OCCUP4-PHONE  TO KB78-NUM-OCCUP4-PHONE                 
           MOVE FB60-NUM-OCCUP4-HP-PAGER                                        
                                       TO KB78-NUM-OCCUP4-HP-PAGER              
           MOVE FB60-NUM-OCCUP4-EDN-LVL                                         
                                       TO KB78-NUM-OCCUP4-EDN-LVL               
                                                                                
           MOVE FB60-NUM-OCCUP5-UIN    TO KB78-NUM-OCCUP5-UIN                   
           MOVE FB60-NME-OCCUP5        TO KB78-NME-OCCUP5                       
           MOVE FB60-NUM-OCCUP5-CITIZENSHIP                                     
                                       TO KB78-NUM-OCCUP5-CITIZENSHIP           
           MOVE FB60-DTE-OCCUP5-BIRTH  TO KB78-DTE-OCCUP5-BIRTH                 
           MOVE FB60-NUM-OCCUP5-RACE   TO KB78-NUM-OCCUP5-RACE                  
           MOVE FB60-NUM-OCCUP5-SEX    TO KB78-NUM-OCCUP5-SEX                   
           MOVE FB60-NUM-OCCUP5-MARITAL-STATUS                                  
                                       TO KB78-NUM-OCCUP5-MARITAL-STATUS        
           MOVE FB60-NUM-OCCUP5-SPOUSE-UIN                                      
                                       TO KB78-NUM-OCCUP5-SPOUSE-UIN            
           MOVE FB60-NUM-OCCUP5-RLTNSP-APPLT1                                   
                                       TO KB78-NUM-OCCUP5-RLTNSP-APPLT1         
           MOVE FB60-AMT-OCCUP5-INCOME TO KB78-AMT-OCCUP5-INCOME                
           MOVE FB60-NUM-OCCUP5-EMPLY-STATUS                                    
                                       TO KB78-NUM-OCCUP5-EMPLY-STATUS          
           MOVE FB60-NME-OCCUP5-OCCUPATION                                      
                                       TO KB78-NME-OCCUP5-OCCUPATION            
           MOVE FB60-NUM-OCCUP5-PHONE  TO KB78-NUM-OCCUP5-PHONE                 
           MOVE FB60-NUM-OCCUP5-HP-PAGER                                        
                                       TO KB78-NUM-OCCUP5-HP-PAGER              
           MOVE FB60-NUM-OCCUP5-EDN-LVL                                         
                                       TO KB78-NUM-OCCUP5-EDN-LVL               
                                                                                
           MOVE FB60-NUM-OCCUP6-UIN    TO KB78-NUM-OCCUP6-UIN                   
           MOVE FB60-NME-OCCUP6        TO KB78-NME-OCCUP6                       
           MOVE FB60-NUM-OCCUP6-CITIZENSHIP                                     
                                       TO KB78-NUM-OCCUP6-CITIZENSHIP           
           MOVE FB60-DTE-OCCUP6-BIRTH  TO KB78-DTE-OCCUP6-BIRTH                 
           MOVE FB60-NUM-OCCUP6-RACE   TO KB78-NUM-OCCUP6-RACE                  
           MOVE FB60-NUM-OCCUP6-SEX    TO KB78-NUM-OCCUP6-SEX                   
           MOVE FB60-NUM-OCCUP6-MARITAL-STATUS                                  
                                       TO KB78-NUM-OCCUP6-MARITAL-STATUS        
           MOVE FB60-NUM-OCCUP6-SPOUSE-UIN                                      
                                       TO KB78-NUM-OCCUP6-SPOUSE-UIN            
           MOVE FB60-NUM-OCCUP6-RLTNSP-APPLT1                                   
                                       TO KB78-NUM-OCCUP6-RLTNSP-APPLT1         
           MOVE FB60-AMT-OCCUP6-INCOME TO KB78-AMT-OCCUP6-INCOME                
           MOVE FB60-NUM-OCCUP6-EMPLY-STATUS                                    
                                       TO KB78-NUM-OCCUP6-EMPLY-STATUS          
           MOVE FB60-NME-OCCUP6-OCCUPATION                                      
                                       TO KB78-NME-OCCUP6-OCCUPATION            
           MOVE FB60-NUM-OCCUP6-PHONE  TO KB78-NUM-OCCUP6-PHONE                 
           MOVE FB60-NUM-OCCUP6-HP-PAGER                                        
                                       TO KB78-NUM-OCCUP6-HP-PAGER              
           MOVE FB60-NUM-OCCUP6-EDN-LVL                                         
                                       TO KB78-NUM-OCCUP6-EDN-LVL               
                                                                                
           MOVE FB60-NUM-OCCUP7-UIN    TO KB78-NUM-OCCUP7-UIN                   
           MOVE FB60-NME-OCCUP7        TO KB78-NME-OCCUP7                       
           MOVE FB60-NUM-OCCUP7-CITIZENSHIP                                     
                                       TO KB78-NUM-OCCUP7-CITIZENSHIP           
           MOVE FB60-DTE-OCCUP7-BIRTH  TO KB78-DTE-OCCUP7-BIRTH                 
           MOVE FB60-NUM-OCCUP7-RACE   TO KB78-NUM-OCCUP7-RACE                  
           MOVE FB60-NUM-OCCUP7-SEX    TO KB78-NUM-OCCUP7-SEX                   
           MOVE FB60-NUM-OCCUP7-MARITAL-STATUS                                  
                                       TO KB78-NUM-OCCUP7-MARITAL-STATUS        
           MOVE FB60-NUM-OCCUP7-SPOUSE-UIN                                      
                                       TO KB78-NUM-OCCUP7-SPOUSE-UIN            
           MOVE FB60-NUM-OCCUP7-RLTNSP-APPLT1                                   
                                       TO KB78-NUM-OCCUP7-RLTNSP-APPLT1         
           MOVE FB60-AMT-OCCUP7-INCOME TO KB78-AMT-OCCUP7-INCOME                
           MOVE FB60-NUM-OCCUP7-EMPLY-STATUS                                    
                                       TO KB78-NUM-OCCUP7-EMPLY-STATUS          
           MOVE FB60-NME-OCCUP7-OCCUPATION                                      
                                       TO KB78-NME-OCCUP7-OCCUPATION            
           MOVE FB60-NUM-OCCUP7-PHONE  TO KB78-NUM-OCCUP7-PHONE                 
           MOVE FB60-NUM-OCCUP7-HP-PAGER                                        
                                       TO KB78-NUM-OCCUP7-HP-PAGER              
           MOVE FB60-NUM-OCCUP7-EDN-LVL                                         
                                       TO KB78-NUM-OCCUP7-EDN-LVL               
                                                                                
           MOVE FB60-NUM-OCCUP8-UIN    TO KB78-NUM-OCCUP8-UIN                   
           MOVE FB60-NME-OCCUP8        TO KB78-NME-OCCUP8                       
           MOVE FB60-NUM-OCCUP8-CITIZENSHIP                                     
                                       TO KB78-NUM-OCCUP8-CITIZENSHIP           
           MOVE FB60-DTE-OCCUP8-BIRTH  TO KB78-DTE-OCCUP8-BIRTH                 
           MOVE FB60-NUM-OCCUP8-RACE   TO KB78-NUM-OCCUP8-RACE                  
           MOVE FB60-NUM-OCCUP8-SEX    TO KB78-NUM-OCCUP8-SEX                   
           MOVE FB60-NUM-OCCUP8-MARITAL-STATUS                                  
                                       TO KB78-NUM-OCCUP8-MARITAL-STATUS        
           MOVE FB60-NUM-OCCUP8-SPOUSE-UIN                                      
                                       TO KB78-NUM-OCCUP8-SPOUSE-UIN            
           MOVE FB60-NUM-OCCUP8-RLTNSP-APPLT1                                   
                                       TO KB78-NUM-OCCUP8-RLTNSP-APPLT1         
           MOVE FB60-AMT-OCCUP8-INCOME TO KB78-AMT-OCCUP8-INCOME                
           MOVE FB60-NUM-OCCUP8-EMPLY-STATUS                                    
                                       TO KB78-NUM-OCCUP8-EMPLY-STATUS          
           MOVE FB60-NME-OCCUP8-OCCUPATION                                      
                                       TO KB78-NME-OCCUP8-OCCUPATION            
           MOVE FB60-NUM-OCCUP8-PHONE  TO KB78-NUM-OCCUP8-PHONE                 
           MOVE FB60-NUM-OCCUP8-HP-PAGER                                        
                                       TO KB78-NUM-OCCUP8-HP-PAGER              
           MOVE FB60-NUM-OCCUP8-EDN-LVL                                         
                                       TO KB78-NUM-OCCUP8-EDN-LVL               
                                                                                
           MOVE FB60-NUM-FLAT-INHERIT  TO KB78-NUM-FLAT-INHERIT                 
           MOVE FB60-NME-PRSN1-INHERIT TO KB78-NME-PRSN1-INHERIT                
           MOVE FB60-NUM-PRSN1-UIN-INHERIT                                      
                                       TO KB78-NUM-PRSN1-UIN-INHERIT            
           MOVE FB60-TXT-PRSN1-ADDR-INHERIT                                     
                                       TO KB78-TXT-PRSN1-ADDR-INHERIT           
           MOVE FB60-NME-PRSN2-INHERIT TO KB78-NME-PRSN2-INHERIT                
           MOVE FB60-NUM-PRSN2-UIN-INHERIT                                      
                                       TO KB78-NUM-PRSN2-UIN-INHERIT            
           MOVE FB60-TXT-PRSN2-ADDR-INHERIT                                     
                                       TO KB78-TXT-PRSN2-ADDR-INHERIT           
                                                                                
           MOVE FB60-NUM-OWN-PTE-PRTY  TO KB78-NUM-OWN-PTE-PRTY                 
           MOVE FB60-NUM-DISPOSED-PTE-PRTY                                      
                                       TO KB78-NUM-DISPOSED-PTE-PRTY            
                                                                                
           MOVE FB60-NUM-MAIN-BLK      TO KB78-NUM-MAIN-BLK                     
           MOVE FB60-NUM-SUB-BLK       TO KB78-NUM-SUB-BLK                      
           MOVE FB60-NUM-LEVEL         TO KB78-NUM-LEVEL                        
           MOVE FB60-NUM-MAIN-UNIT     TO KB78-NUM-MAIN-UNIT                    
           MOVE FB60-NUM-SUB-UNIT      TO KB78-NUM-SUB-UNIT                     
           MOVE FB60-NUM-CORRESP-STREET                                         
                                       TO KB78-NUM-CORRESP-STREET               
           MOVE FB60-CDE-CORRESP-POST  TO KB78-CDE-CORRESP-POST                 
                                                                                
           MOVE FB60-NUM-CHILD-PARENT-TAG                                       
                                       TO KB78-NUM-CHILD-PARENT-TAG             
           MOVE FB60-NME-CHILD1-PARENT TO KB78-NME-CHILD1-PARENT                
           MOVE FB60-NUM-CHILD1-PARENT-UIN                                      
                                       TO KB78-NUM-CHILD1-PARENT-UIN            
           MOVE FB60-NUM-CHILD1-PARENT-MARSTAT                                  
                                       TO KB78-NUM-CHILD1-PARENT-MARSTAT        
           MOVE FB60-NUM-CHILD1-PARENT-RLTNSP                                   
                                       TO KB78-NUM-CHILD1-PARENT-RLTNSP         
           MOVE FB60-NME-CHILD2-PARENT TO KB78-NME-CHILD2-PARENT                
           MOVE FB60-NUM-CHILD2-PARENT-UIN                                      
                                       TO KB78-NUM-CHILD2-PARENT-UIN            
           MOVE FB60-NUM-CHILD2-PARENT-MARSTAT                                  
                                       TO KB78-NUM-CHILD2-PARENT-MARSTAT        
           MOVE FB60-NUM-CHILD2-PARENT-RLTNSP                                   
                                       TO KB78-NUM-CHILD2-PARENT-RLTNSP         
           MOVE FB60-NUM-CP-BLK-MAIN   TO KB78-NUM-CP-BLK-MAIN                  
           MOVE FB60-NUM-CP-BLK-SUB    TO KB78-NUM-CP-BLK-SUB                   
           MOVE FB60-NUM-CP-LEVEL      TO KB78-NUM-CP-LEVEL                     
           MOVE FB60-NUM-CP-MAIN-UNIT  TO KB78-NUM-CP-MAIN-UNIT                 
           MOVE FB60-NUM-CP-SUB-UNIT   TO KB78-NUM-CP-SUB-UNIT                  
           MOVE FB60-NME-CP-STREET     TO KB78-NME-CP-STREET                    
           MOVE FB60-NUM-CP-POST       TO KB78-NUM-CP-POST                      
                                                                                
           MOVE 'PA '                  TO KB78-CDE-ALLOC-SCH                    
      *                                   KB78-CDE-ELIG-SCH.                    
                                                                                
           MOVE FB60-NUM-STATUS        TO KB78-NUM-STATUS(1:1)                  
                                                                                
           MOVE FB60-NUM-CHILD1-PARENT-CITIZEN                                  
                                       TO KB78-NUM-CHILD1-PARENT-CITIZEN        
           MOVE FB60-NUM-CHILD2-PARENT-CITIZEN                                  
                                       TO KB78-NUM-CHILD2-PARENT-CITIZEN        
                                                                                
           MOVE FB60-NUM-AHG-REQ       TO KB78-NUM-AHG-REQ                      
           MOVE FB60-NUM-ETHNIC        TO KB78-NUM-RACE                         
           MOVE FB60-NUM-TCP-REQ       TO KB78-NUM-TCP-REQ                      
           MOVE FB60-NUM-CPFHG-REQ     TO KB78-NUM-CPFHG-REQ                    
           MOVE FB60-NUM-CHILD-PARENT-TAG                                       
                                       TO KB78-NUM-MCP-PRIORITY                 
                                                                                
           MOVE FB60-DTE-CHILD-BIRTH   TO KB78-DTE-CHILD-BIRTH                  
           MOVE FB60-CDE-SUCC-STATUS   TO KB78-CDE-SUCC-STATUS                  
                                                                                
           IF FB60-NUM-HDB-LOAN-REQ  = 'Y' AND                                  
              FB60-NUM-BANK-LOAN-REQ = 'N'                                      
              MOVE 'H'                 TO KB78-NUM-APPL-LOAN-REQ                
           END-IF.                                                              
           IF FB60-NUM-HDB-LOAN-REQ  = 'N' AND                                  
              FB60-NUM-BANK-LOAN-REQ = 'Y'                                      
              MOVE 'B'                 TO KB78-NUM-APPL-LOAN-REQ                
           END-IF.                                                              
           IF FB60-NUM-HDB-LOAN-REQ  = 'N' AND                                  
              FB60-NUM-BANK-LOAN-REQ = 'N'                                      
              MOVE 'N'                 TO KB78-NUM-APPL-LOAN-REQ                
           END-IF.                                                              
                                                                                
           MOVE FB60-NUM-EMAIL     TO KB78-NUM-EMAIL                            
           MOVE FB60-NUM-PROJECT   TO KB78-NUM-PROJECT-SUCC.                    
           STRING '#' FA30-NUM-REGN(4:4) DELIMITED BY SIZE                      
                                 INTO KB78-NUM-QUEUE.                           
                                                                                
           MOVE FB60-ELIG-TO-BUY   TO KB78-NUM-DBSS-ELIG                        
           MOVE FB60-NUM-HDB-ACTING TO KB78-NUM-HDB-ACT                         
                                                                                
           MOVE FB60-DTE-REQUESTED TO KB78-DTE-REQUESTED KB78-DTE-UPDATE        
           MOVE FB60-TME-REQUESTED TO KB78-TME-REQUESTED KB78-TME-UPDATE        
                                                                                
           MOVE FA30-NUM-SCH-ACC   TO KB78-NUM-SCH-ACC.                         
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       5200-WRITE-BP13KB78.                                                     
      *-------------------------------------------------------------            
                                                                                
           WRITE BP13KB78-REC.                                                  
                                                                                
           EVALUATE BP13KB78-STATUS                                             
           WHEN 00                                                              
                ADD   1              TO WS-KB78-WRITE                           
           WHEN 02                                                              
                ADD   1              TO WS-KB78-WRITE                           
                ADD   1              TO WS-KB78-DUPKEY                          
           WHEN 22                                                              
                DISPLAY 'BP13KB78 DUP REC ERROR - ' KB78-KEY-FLD                
           WHEN OTHER                                                           
                MOVE BP13KB78-STATUS TO RETURN-CODE                             
                DISPLAY 'BP13KB78 WRITE ERROR, STATUS : '                       
                         BP13KB78-STATUS ' KEY : ' KB78-KEY-FLD                 
                        ' ALT KEY : ' KB78-ALT-KEY                              
                PERFORM  9000-CLOSE-ROUTINE THRU 9000-EXIT                      
           END-EVALUATE.                                                        
                                                                                
       5200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6000-DETERMINE-ELIG.                                                     
      *-------------------------------------------------------------            
                                                                                
           PERFORM 6100-STORE-STATUS              THRU 6100-EXIT.               
                                                                                
           PERFORM 6200-SINGLE-APP2-OR-OCC-FIANCE THRU 6200-EXIT.               
           PERFORM 6300-APP2-OR-OCC-SINGLE-SIB    THRU 6300-EXIT.               
           PERFORM 6400-YES-PARENT-IN-APP         THRU 6400-EXIT.               
           PERFORM 6500-CHILD-IN-OCC              THRU 6500-EXIT.               
           PERFORM 6600-APP2-OR-OCC-CHILD-SINGLE  THRU 6600-EXIT.               
           PERFORM 6700-APP1-SINGLE-CHILD         THRU 6700-EXIT.               
           PERFORM 6800-APP2-OR-OCC-SINGLE-PARENT THRU 6800-EXIT.               
           PERFORM 6900-APP1-CHILD-GRANDCH-SINGLE THRU 6900-EXIT.               
           PERFORM 7100-APP2-OCC-ADOPT-PARENTS    THRU 7100-EXIT.               
           PERFORM 7200-APP2-OCC-ADOPT-CHILD      THRU 7200-EXIT.               
           PERFORM 7300-OCC-MARRIED-NON-CITIZEN   THRU 7300-EXIT.               
                                                                                
      * +------------------+-----------------------------------------+          
      *  MARITAL STATUS    RELATIONSHIP                                      
      * +------------------+-----------------------------------------+          
      *  1 OR S - SINGLE   06 - BROTHER/SISTERS                              
      *  2 OR M - MARRIED  09 - FIANCE                                       
      *                    02 - FATHER  12 - MOTHER                          
      *                    41 - CHILD                                        
      * +------------------+-----------------------------------------+          
           EVALUATE TRUE                                                        
      *  ~ NON CITIZEN SPOUSE ~  ~ WITH CITIZEN CHILD ~                         
           WHEN APP1-MARRIED AND NON-CITI-SPOUSE AND CITIZEN-CHILD              
             MOVE 'PA ' TO KB78-CDE-ELIG-SCH                                    
                                                                                
      *  ~ NON CITIZEN SPOUSE ~                                                 
           WHEN APP1-MARRIED AND NON-CITI-SPOUSE AND CITIZEN-PARENT             
           WHEN APP1-MARRIED AND NON-CITI-SPOUSE AND CITIZEN-BRO-SIS            
           WHEN OCC-MARRIED-NON-CITIZEN AND CITIZEN-BRO-SIS AND                 
                APP1-SINGLE                                                     
             MOVE 'NCS' TO KB78-CDE-ELIG-SCH                                    
                                                                                
      *  ~ NON CITIZEN PARENT ~                                                 
      **-- THERE IS 1 NON-CITIZEN PARENT OR BOTH NON-CITIZEN PARENTS--*         
           WHEN APP1-SINGLE AND APP2-OCC-SINGLE-SIB AND NON-CITI-PARENT         
                            AND NOT CITIZEN-PARENT                              
             MOVE 'NCP' TO KB78-CDE-ELIG-SCH                                    
                                                                                
      *  ~ PUBLIC APPLICATION WITH SINGLE CHILD ~                               
           WHEN APP1-SINGLE-PAS   AND APP2-OCC-CHILD-SINGLE                     
           WHEN APP1-SINGLE-CHILD AND APP2-OCC-SINGLE-PARENT                    
             MOVE 'PAS' TO KB78-CDE-ELIG-SCH                                    
                                                                                
      *  ~ SINGLE MOTHER WITH PARENT ~                                          
           WHEN APP1-SINGLE-PAS AND CITIZEN-PARENT AND                          
                APP2-OCC-CHILD-SINGLE-B21                                       
           WHEN APP1-CHILD-GRANDCH-SINGLE                                       
             MOVE 'SMP' TO KB78-CDE-ELIG-SCH                                    
                                                                                
      *  ~ PUBLIC APPLICATION WITH ADOPTIVE CHILD ~                             
           WHEN APP1-SINGLE AND APP2-OCC-ADOPT-PARENTS                          
           WHEN APP1-SINGLE AND APP2-OCC-ADOPT-CHILD                            
             MOVE 'PAA' TO KB78-CDE-ELIG-SCH                                    
                                                                                
      *  ~ ORPHAN SCHEME ~                                                      
           WHEN APP1-ORPHAN                                                     
             MOVE 'OR'  TO KB78-CDE-ELIG-SCH                                    
                                                                                
      *  ~ FIANCE/FIANCEE SCHEME ~                                              
           WHEN APP1-SINGLE AND SINGLE-APP2-OCC-FIANCE                          
             MOVE 'FS'  TO KB78-CDE-ELIG-SCH                                    
                                                                                
      *  ~ PUBLIC APPLICATION ~                                                 
           WHEN APP1-MARRIED AND SPOUSE-YES                                     
           WHEN APP1-SINGLE  AND PARENTS-YES AND BRO-SIS-YES                    
           WHEN APP1-SINGLE  AND PARENTS-YES AND NOT CHILD-YES                  
           WHEN APP1-OTHERS  AND CHILD-YES                                      
             MOVE 'PA'  TO KB78-CDE-ELIG-SCH                                    
           END-EVALUATE.                                                        
                                                                                
           IF KB78-NUM-FLAT-TYPE = '1A'                                         
              PERFORM 7400-CNT-APPLTS THRU 7400-EXIT                            
              IF WS-CNT-APPLT = 1                                               
                 MOVE 'SS'            TO   KB78-CDE-ELIG-SCH                    
              ELSE                                                              
                 IF WS-SA-IND = 'Y'                                             
                    MOVE 'PA'         TO   KB78-CDE-ELIG-SCH                    
                 ELSE                                                           
                    MOVE 'SS'         TO   KB78-CDE-ELIG-SCH                    
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       6100-STORE-STATUS.                                                       
      *-------------------------------------------------------------            
           INITIALIZE WS-TAB-OCCUP-DET.                                         
                                                                                
           MOVE KB78-NUM-OCCUP1-RLTNSP-APPLT1   TO WS-REL(1)                    
           MOVE KB78-NUM-OCCUP2-RLTNSP-APPLT1   TO WS-REL(2)                    
           MOVE KB78-NUM-OCCUP3-RLTNSP-APPLT1   TO WS-REL(3)                    
           MOVE KB78-NUM-OCCUP4-RLTNSP-APPLT1   TO WS-REL(4)                    
           MOVE KB78-NUM-OCCUP5-RLTNSP-APPLT1   TO WS-REL(5)                    
           MOVE KB78-NUM-OCCUP6-RLTNSP-APPLT1   TO WS-REL(6)                    
           MOVE KB78-NUM-OCCUP7-RLTNSP-APPLT1   TO WS-REL(7)                    
           MOVE KB78-NUM-OCCUP8-RLTNSP-APPLT1   TO WS-REL(8)                    
                                                                                
           MOVE KB78-DTE-OCCUP1-BIRTH     TO WS-DTE-BIRTH(1)                    
           MOVE KB78-DTE-OCCUP2-BIRTH     TO WS-DTE-BIRTH(2)                    
           MOVE KB78-DTE-OCCUP3-BIRTH     TO WS-DTE-BIRTH(3)                    
           MOVE KB78-DTE-OCCUP4-BIRTH     TO WS-DTE-BIRTH(4)                    
           MOVE KB78-DTE-OCCUP5-BIRTH     TO WS-DTE-BIRTH(5)                    
           MOVE KB78-DTE-OCCUP6-BIRTH     TO WS-DTE-BIRTH(6)                    
           MOVE KB78-DTE-OCCUP7-BIRTH     TO WS-DTE-BIRTH(7)                    
           MOVE KB78-DTE-OCCUP8-BIRTH     TO WS-DTE-BIRTH(8)                    
                                                                                
           MOVE KB78-NUM-OCCUP1-MARITAL-STATUS TO WS-MRTL(1)                    
           MOVE KB78-NUM-OCCUP2-MARITAL-STATUS TO WS-MRTL(2)                    
           MOVE KB78-NUM-OCCUP3-MARITAL-STATUS TO WS-MRTL(3)                    
           MOVE KB78-NUM-OCCUP4-MARITAL-STATUS TO WS-MRTL(4)                    
           MOVE KB78-NUM-OCCUP5-MARITAL-STATUS TO WS-MRTL(5)                    
           MOVE KB78-NUM-OCCUP6-MARITAL-STATUS TO WS-MRTL(6)                    
           MOVE KB78-NUM-OCCUP7-MARITAL-STATUS TO WS-MRTL(7)                    
           MOVE KB78-NUM-OCCUP8-MARITAL-STATUS TO WS-MRTL(8)                    
                                                                                
      **-- TO DETERMINE APP1 MARITAL STATUS --**                                
           MOVE KB78-NUM-APPLT1-MARITAL-STATUS TO APP1-MARITAL-FLAG.            
                                                                                
      **-- TO DETERMINE WHETHER APP1 HAS SPOUSE --**                            
           MOVE SPACES TO SPOUSE-YES-FLAG                                       
           IF KB78-NUM-APPLT2-RLTNSP-APPLT1 = '20' OR                           
              KB78-NUM-APPLT3-RLTNSP-APPLT1 = '20' OR                           
              KB78-NUM-APPLT4-RLTNSP-APPLT1 = '20' OR                           
              KB78-NUM-OCCUP1-RLTNSP-APPLT1 = '20' OR                           
              KB78-NUM-OCCUP2-RLTNSP-APPLT1 = '20' OR                           
              KB78-NUM-OCCUP3-RLTNSP-APPLT1 = '20' OR                           
              KB78-NUM-OCCUP4-RLTNSP-APPLT1 = '20' OR                           
              KB78-NUM-OCCUP5-RLTNSP-APPLT1 = '20' OR                           
              KB78-NUM-OCCUP6-RLTNSP-APPLT1 = '20' OR                           
              KB78-NUM-OCCUP7-RLTNSP-APPLT1 = '20' OR                           
              KB78-NUM-OCCUP8-RLTNSP-APPLT1 = '20'                              
              MOVE 'Y' TO SPOUSE-YES-FLAG                                       
           END-IF.                                                              
                                                                                
      **-- DETERMINE WHETHER APP1 HAS NON CITIZEN SPOUSE --**                   
           MOVE SPACES TO NON-CITI-SPOUSE-FLAG                                  
           IF ((KB78-NUM-OCCUP1-RLTNSP-APPLT1 = '20' AND                        
               (KB78-NUM-OCCUP1-CITIZENSHIP NOT = '10' AND '20')) OR            
               (KB78-NUM-OCCUP2-RLTNSP-APPLT1 = '20' AND                        
               (KB78-NUM-OCCUP2-CITIZENSHIP NOT = '10' AND '20')) OR            
               (KB78-NUM-OCCUP3-RLTNSP-APPLT1 = '20' AND                        
               (KB78-NUM-OCCUP3-CITIZENSHIP NOT = '10' AND '20')) OR            
               (KB78-NUM-OCCUP4-RLTNSP-APPLT1 = '20' AND                        
               (KB78-NUM-OCCUP4-CITIZENSHIP NOT = '10' AND '20')) OR            
               (KB78-NUM-OCCUP5-RLTNSP-APPLT1 = '20' AND                        
               (KB78-NUM-OCCUP5-CITIZENSHIP NOT = '10' AND '20')))              
              MOVE 'Y' TO NON-CITI-SPOUSE-FLAG                                  
           END-IF.                                                              
                                                                                
      **-- DETERMINE WHETHER APP1 HAS PARENT --**                               
           MOVE SPACES TO PARENTS-YES-FLAG                                      
           IF ((KB78-NUM-APPLT2-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-APPLT3-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-APPLT4-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-OCCUP1-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-OCCUP2-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-OCCUP3-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-OCCUP4-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-OCCUP5-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-OCCUP6-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-OCCUP7-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-OCCUP8-RLTNSP-APPLT1 = '02' OR  '12'))                 
              MOVE 'Y' TO PARENTS-YES-FLAG                                      
           END-IF.                                                              
                                                                                
      **-- DETERMINE WHETHER APP1 HAS NON CITIZEN PARENT AS AN OCCUPIER         
           MOVE SPACES TO NON-CITI-PARENT-FLAG.                                 
           IF (((KB78-NUM-OCCUP1-RLTNSP-APPLT1 = '02' OR  '12') AND             
                (KB78-NUM-OCCUP1-CITIZENSHIP NOT = '10' AND '20'))  OR          
               ((KB78-NUM-OCCUP2-RLTNSP-APPLT1 = '02' OR  '12') AND             
                (KB78-NUM-OCCUP2-CITIZENSHIP NOT = '10' AND '20'))  OR          
               ((KB78-NUM-OCCUP3-RLTNSP-APPLT1 = '02' OR  '12') AND             
                (KB78-NUM-OCCUP3-CITIZENSHIP NOT = '10' AND '20'))  OR          
               ((KB78-NUM-OCCUP4-RLTNSP-APPLT1 = '02' OR  '12') AND             
                (KB78-NUM-OCCUP4-CITIZENSHIP NOT = '10' AND '20'))  OR          
               ((KB78-NUM-OCCUP5-RLTNSP-APPLT1 = '02' OR  '12') AND             
                (KB78-NUM-OCCUP5-CITIZENSHIP NOT = '10' AND '20')))             
                 MOVE 'Y' TO NON-CITI-PARENT-FLAG                               
           END-IF.                                                              
                                                                                
      **-- DETERMINE WHETHER APP1 HAS CITIZEN PARENT --**                       
           MOVE SPACES TO CITIZEN-PARENT-FLAG.                                  
           IF (((KB78-NUM-APPLT2-RLTNSP-APPLT1 = '02' OR  '12') AND             
                (KB78-NUM-APPLT2-CITIZENSHIP   = '10' OR  '20'))  OR            
               ((KB78-NUM-APPLT3-RLTNSP-APPLT1 = '02' OR  '12') AND             
                (KB78-NUM-APPLT3-CITIZENSHIP   = '10' OR  '20'))  OR            
               ((KB78-NUM-APPLT4-RLTNSP-APPLT1 = '02' OR  '12') AND             
                (KB78-NUM-APPLT4-CITIZENSHIP   = '10' OR  '20'))  OR            
               ((KB78-NUM-OCCUP1-RLTNSP-APPLT1 = '02' OR  '12') AND             
                (KB78-NUM-OCCUP1-CITIZENSHIP   = '10' OR  '20'))  OR            
               ((KB78-NUM-OCCUP2-RLTNSP-APPLT1 = '02' OR  '12') AND             
                (KB78-NUM-OCCUP2-CITIZENSHIP   = '10' OR  '20'))  OR            
               ((KB78-NUM-OCCUP3-RLTNSP-APPLT1 = '02' OR  '12') AND             
                (KB78-NUM-OCCUP3-CITIZENSHIP   = '10' OR  '20'))  OR            
               ((KB78-NUM-OCCUP4-RLTNSP-APPLT1 = '02' OR  '12') AND             
                (KB78-NUM-OCCUP4-CITIZENSHIP   = '10' OR  '20'))  OR            
               ((KB78-NUM-OCCUP5-RLTNSP-APPLT1 = '02' OR  '12') AND             
                (KB78-NUM-OCCUP5-CITIZENSHIP   = '10' OR  '20')))               
                 MOVE 'Y' TO CITIZEN-PARENT-FLAG                                
           END-IF.                                                              
                                                                                
      **-- DETERMINE WHETHER APP1 HAS BROTHER/SISTER --**                       
           MOVE SPACES TO BRO-SIS-YES-FLAG.                                     
           IF KB78-NUM-APPLT2-RLTNSP-APPLT1 = '06' OR                           
              KB78-NUM-APPLT3-RLTNSP-APPLT1 = '06' OR                           
              KB78-NUM-APPLT4-RLTNSP-APPLT1 = '06' OR                           
              KB78-NUM-OCCUP1-RLTNSP-APPLT1 = '06' OR                           
              KB78-NUM-OCCUP2-RLTNSP-APPLT1 = '06' OR                           
              KB78-NUM-OCCUP3-RLTNSP-APPLT1 = '06' OR                           
              KB78-NUM-OCCUP4-RLTNSP-APPLT1 = '06' OR                           
              KB78-NUM-OCCUP5-RLTNSP-APPLT1 = '06' OR                           
              KB78-NUM-OCCUP6-RLTNSP-APPLT1 = '06' OR                           
              KB78-NUM-OCCUP7-RLTNSP-APPLT1 = '06' OR                           
              KB78-NUM-OCCUP8-RLTNSP-APPLT1 = '06'                              
              MOVE 'Y' TO BRO-SIS-YES-FLAG                                      
           END-IF.                                                              
                                                                                
      **-- DETERMINE WHETHER APP1 HAS CITIZEN BROTHER/SISTER --**               
           MOVE SPACES TO CITIZEN-BRO-SIS-FLAG.                                 
           IF ((KB78-NUM-APPLT2-RLTNSP-APPLT1 = '06' AND                        
               (KB78-NUM-APPLT2-CITIZENSHIP  = '10' OR '20')) OR                
               (KB78-NUM-APPLT3-RLTNSP-APPLT1 = '06' AND                        
               (KB78-NUM-APPLT3-CITIZENSHIP  = '10' OR '20')) OR                
               (KB78-NUM-APPLT4-RLTNSP-APPLT1 = '06' AND                        
               (KB78-NUM-APPLT4-CITIZENSHIP  = '10' OR '20')) OR                
               (KB78-NUM-OCCUP1-RLTNSP-APPLT1 = '06' AND                        
               (KB78-NUM-OCCUP1-CITIZENSHIP  = '10' OR '20')) OR                
               (KB78-NUM-OCCUP2-RLTNSP-APPLT1 = '06' AND                        
               (KB78-NUM-OCCUP2-CITIZENSHIP  = '10' OR '20')) OR                
               (KB78-NUM-OCCUP3-RLTNSP-APPLT1 = '06' AND                        
               (KB78-NUM-OCCUP3-CITIZENSHIP  = '10' OR '20')) OR                
               (KB78-NUM-OCCUP4-RLTNSP-APPLT1 = '06' AND                        
               (KB78-NUM-OCCUP4-CITIZENSHIP  = '10' OR '20')) OR                
               (KB78-NUM-OCCUP5-RLTNSP-APPLT1 = '06' AND                        
               (KB78-NUM-OCCUP5-CITIZENSHIP  = '10' OR '20')))                  
              MOVE 'Y' TO CITIZEN-BRO-SIS-FLAG                                  
           END-IF.                                                              
                                                                                
      **-- DETERMINE WHETHER APP1 HAS CHILD --**                                
           MOVE SPACES TO CHILD-YES-FLAG.                                       
           IF KB78-NUM-APPLT2-RLTNSP-APPLT1 = '41' OR                           
              KB78-NUM-APPLT3-RLTNSP-APPLT1 = '41' OR                           
              KB78-NUM-APPLT4-RLTNSP-APPLT1 = '41' OR                           
              KB78-NUM-OCCUP1-RLTNSP-APPLT1 = '41' OR                           
              KB78-NUM-OCCUP2-RLTNSP-APPLT1 = '41' OR                           
              KB78-NUM-OCCUP3-RLTNSP-APPLT1 = '41' OR                           
              KB78-NUM-OCCUP4-RLTNSP-APPLT1 = '41' OR                           
              KB78-NUM-OCCUP5-RLTNSP-APPLT1 = '41' OR                           
              KB78-NUM-OCCUP6-RLTNSP-APPLT1 = '41' OR                           
              KB78-NUM-OCCUP7-RLTNSP-APPLT1 = '41' OR                           
              KB78-NUM-OCCUP8-RLTNSP-APPLT1 = '41'                              
              MOVE 'Y' TO CHILD-YES-FLAG                                        
           END-IF.                                                              
                                                                                
      **-- DETERMINE WHETHER APP1 HAS CITIZEN CHILD --**                        
           MOVE SPACES TO CITIZEN-CHILD-FLAG.                                   
           IF ((KB78-NUM-APPLT2-RLTNSP-APPLT1 = '41' AND                        
               (KB78-NUM-APPLT2-CITIZENSHIP  = '10' OR '20')) OR                
               (KB78-NUM-APPLT3-RLTNSP-APPLT1 = '41' AND                        
               (KB78-NUM-APPLT3-CITIZENSHIP  = '10' OR '20')) OR                
               (KB78-NUM-APPLT4-RLTNSP-APPLT1 = '41' AND                        
               (KB78-NUM-APPLT4-CITIZENSHIP  = '10' OR '20')) OR                
               (KB78-NUM-OCCUP1-RLTNSP-APPLT1 = '41' AND                        
               (KB78-NUM-OCCUP1-CITIZENSHIP  = '10' OR '20')) OR                
               (KB78-NUM-OCCUP2-RLTNSP-APPLT1 = '41' AND                        
               (KB78-NUM-OCCUP2-CITIZENSHIP  = '10' OR '20')) OR                
               (KB78-NUM-OCCUP3-RLTNSP-APPLT1 = '41' AND                        
               (KB78-NUM-OCCUP3-CITIZENSHIP  = '10' OR '20')) OR                
               (KB78-NUM-OCCUP4-RLTNSP-APPLT1 = '41' AND                        
               (KB78-NUM-OCCUP4-CITIZENSHIP  = '10' OR '20')) OR                
               (KB78-NUM-OCCUP5-RLTNSP-APPLT1 = '41' AND                        
               (KB78-NUM-OCCUP5-CITIZENSHIP  = '10' OR '20')))                  
              MOVE 'Y' TO CITIZEN-CHILD-FLAG                                    
           END-IF.                                                              
                                                                                
      **-- DETERMINE WHETHER APP1 HAS GRAND CHILD --**                          
           MOVE SPACES TO GCHILD-YES-FLAG.                                      
           IF KB78-NUM-APPLT2-RLTNSP-APPLT1 = '43' OR                           
              KB78-NUM-APPLT3-RLTNSP-APPLT1 = '43' OR                           
              KB78-NUM-APPLT4-RLTNSP-APPLT1 = '43' OR                           
              KB78-NUM-OCCUP1-RLTNSP-APPLT1 = '43' OR                           
              KB78-NUM-OCCUP2-RLTNSP-APPLT1 = '43' OR                           
              KB78-NUM-OCCUP3-RLTNSP-APPLT1 = '43' OR                           
              KB78-NUM-OCCUP4-RLTNSP-APPLT1 = '43' OR                           
              KB78-NUM-OCCUP5-RLTNSP-APPLT1 = '43' OR                           
              KB78-NUM-OCCUP6-RLTNSP-APPLT1 = '43' OR                           
              KB78-NUM-OCCUP7-RLTNSP-APPLT1 = '43' OR                           
              KB78-NUM-OCCUP8-RLTNSP-APPLT1 = '43'                              
              MOVE 'Y' TO GCHILD-YES-FLAG                                       
           END-IF.                                                              
                                                                                
       6100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *==============================================================*          
       6200-SINGLE-APP2-OR-OCC-FIANCE.                                          
      *==============================================================*          
      *--------------------------------------------------------------*          
      * APP2 OR OCCUPIER SHOULD BE SINGLE WHERE THE REL IS FIANCE.   *          
      *--------------------------------------------------------------*          
           MOVE SPACES TO SINGLE-APP2-OCC-FIANCE-FLAG.                          
                                                                                
           IF ((KB78-NUM-APPLT2-MARITAL-STATUS = '1' OR 'S'                     
                  OR '3' OR 'W' OR '4' OR 'D' OR '5' OR 'P')                    
                  AND (KB78-NUM-APPLT2-RLTNSP-APPLT1  = '09')) OR               
              ((KB78-NUM-APPLT3-MARITAL-STATUS = '1' OR 'S'                     
                  OR '3' OR 'W' OR '4' OR 'D' OR '5' OR 'P')                    
                  AND (KB78-NUM-APPLT3-RLTNSP-APPLT1  = '09')) OR               
              ((KB78-NUM-APPLT4-MARITAL-STATUS = '1' OR 'S'                     
                  OR '3' OR 'W' OR '4' OR 'D' OR '5' OR 'P')                    
                  AND (KB78-NUM-APPLT4-RLTNSP-APPLT1  = '09')) OR               
              ((KB78-NUM-OCCUP1-MARITAL-STATUS = '1' OR 'S'                     
                  OR '3' OR 'W' OR '4' OR 'D' OR '5' OR 'P')                    
                  AND (KB78-NUM-OCCUP1-RLTNSP-APPLT1  = '09')) OR               
              ((KB78-NUM-OCCUP2-MARITAL-STATUS = '1' OR 'S'                     
                  OR '3' OR 'W' OR '4' OR 'D' OR '5' OR 'P')                    
                  AND (KB78-NUM-OCCUP2-RLTNSP-APPLT1  = '09')) OR               
              ((KB78-NUM-OCCUP3-MARITAL-STATUS = '1' OR 'S'                     
                  OR '3' OR 'W' OR '4' OR 'D' OR '5' OR 'P')                    
                  AND (KB78-NUM-OCCUP3-RLTNSP-APPLT1  = '09')) OR               
              ((KB78-NUM-OCCUP4-MARITAL-STATUS = '1' OR 'S'                     
                  OR '3' OR 'W' OR '4' OR 'D' OR '5' OR 'P')                    
                  AND (KB78-NUM-OCCUP4-RLTNSP-APPLT1  = '09')) OR               
              ((KB78-NUM-OCCUP5-MARITAL-STATUS = '1' OR 'S'                     
                  OR '3' OR 'W' OR '4' OR 'D' OR '5' OR 'P')                    
                  AND (KB78-NUM-OCCUP5-RLTNSP-APPLT1  = '09')) OR               
              ((KB78-NUM-OCCUP6-MARITAL-STATUS = '1' OR 'S'                     
                  OR '3' OR 'W' OR '4' OR 'D' OR '5' OR 'P')                    
                  AND (KB78-NUM-OCCUP6-RLTNSP-APPLT1  = '09')) OR               
              ((KB78-NUM-OCCUP7-MARITAL-STATUS = '1' OR 'S'                     
                  OR '3' OR 'W' OR '4' OR 'D' OR '5' OR 'P')                    
                  AND (KB78-NUM-OCCUP7-RLTNSP-APPLT1  = '09')) OR               
              ((KB78-NUM-OCCUP8-MARITAL-STATUS = '1' OR 'S'                     
                  OR '3' OR 'W' OR '4' OR 'D' OR '5' OR 'P')                    
                  AND (KB78-NUM-OCCUP8-RLTNSP-APPLT1  = '09'))                  
              MOVE 'Y' TO SINGLE-APP2-OCC-FIANCE-FLAG                           
           END-IF.                                                              
                                                                                
       6200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *==============================================================*          
       6300-APP2-OR-OCC-SINGLE-SIB.                                             
      *==============================================================*          
      *--------------------------------------------------------------*          
      * APPL2 OR OCCUPIER SHOULD BE SINGLE WHERE THE REL IS SIBILING *          
      * CODE BROTHER/SISTER                                          *          
      *--------------------------------------------------------------*          
           MOVE SPACES TO APP2-OCC-SINGLE-SIB-FLAG.                             
                                                                                
           IF ((KB78-NUM-APPLT2-MARITAL-STATUS = '1' OR 'S')                    
                  AND (KB78-NUM-APPLT2-RLTNSP-APPLT1  = '06')) OR               
              ((KB78-NUM-APPLT3-MARITAL-STATUS = '1' OR 'S')                    
                  AND (KB78-NUM-APPLT3-RLTNSP-APPLT1  = '06')) OR               
              ((KB78-NUM-APPLT4-MARITAL-STATUS = '1' OR 'S')                    
                  AND (KB78-NUM-APPLT4-RLTNSP-APPLT1  = '06')) OR               
              ((KB78-NUM-OCCUP1-MARITAL-STATUS = '1' OR 'S')                    
                  AND (KB78-NUM-OCCUP1-RLTNSP-APPLT1  = '06')) OR               
              ((KB78-NUM-OCCUP2-MARITAL-STATUS = '1' OR 'S')                    
                  AND (KB78-NUM-OCCUP2-RLTNSP-APPLT1  = '06')) OR               
              ((KB78-NUM-OCCUP3-MARITAL-STATUS = '1' OR 'S')                    
                  AND (KB78-NUM-OCCUP3-RLTNSP-APPLT1  = '06')) OR               
              ((KB78-NUM-OCCUP4-MARITAL-STATUS = '1' OR 'S')                    
                  AND (KB78-NUM-OCCUP4-RLTNSP-APPLT1  = '06')) OR               
              ((KB78-NUM-OCCUP5-MARITAL-STATUS = '1' OR 'S')                    
                  AND (KB78-NUM-OCCUP5-RLTNSP-APPLT1  = '06')) OR               
              ((KB78-NUM-OCCUP6-MARITAL-STATUS = '1' OR 'S')                    
                  AND (KB78-NUM-OCCUP6-RLTNSP-APPLT1  = '06')) OR               
              ((KB78-NUM-OCCUP7-MARITAL-STATUS = '1' OR 'S')                    
                  AND (KB78-NUM-OCCUP7-RLTNSP-APPLT1  = '06')) OR               
              ((KB78-NUM-OCCUP8-MARITAL-STATUS = '1' OR 'S')                    
                  AND (KB78-NUM-OCCUP8-RLTNSP-APPLT1  = '06'))                  
              MOVE 'Y' TO APP2-OCC-SINGLE-SIB-FLAG                              
           END-IF.                                                              
                                                                                
       6300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *==============================================================*          
       6400-YES-PARENT-IN-APP.                                                  
      *==============================================================*          
      *--------------------------------------------------------------*          
      * IF THERE ARE PARENTS IN APPLICATIONS.                        *          
      *--------------------------------------------------------------*          
           MOVE SPACES TO YES-PARENT-IN-APPS-FLAG.                              
                                                                                
           IF ((KB78-NUM-APPLT2-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-APPLT3-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-APPLT4-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-OCCUP1-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-OCCUP2-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-OCCUP3-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-OCCUP4-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-OCCUP5-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-OCCUP6-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-OCCUP7-RLTNSP-APPLT1 = '02' OR  '12') OR               
               (KB78-NUM-OCCUP8-RLTNSP-APPLT1 = '02' OR  '12'))                 
              MOVE 'Y' TO YES-PARENT-IN-APPS-FLAG                               
           END-IF.                                                              
                                                                                
       6400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *==============================================================*          
       6500-CHILD-IN-OCC.                                                       
      *==============================================================*          
      *--------------------------------------------------------------*          
      * LOOK FOR IS THERE ANY CHILD ONLY IN OCCUPIERS.               *          
      *--------------------------------------------------------------*          
           MOVE SPACES TO CHILD-IN-OCC-FLAG.                                    
                                                                                
           IF (KB78-NUM-OCCUP1-RLTNSP-APPLT1 = '41') OR                         
              (KB78-NUM-OCCUP2-RLTNSP-APPLT1 = '41') OR                         
              (KB78-NUM-OCCUP3-RLTNSP-APPLT1 = '41') OR                         
              (KB78-NUM-OCCUP4-RLTNSP-APPLT1 = '41') OR                         
              (KB78-NUM-OCCUP5-RLTNSP-APPLT1 = '41') OR                         
              (KB78-NUM-OCCUP6-RLTNSP-APPLT1 = '41') OR                         
              (KB78-NUM-OCCUP7-RLTNSP-APPLT1 = '41') OR                         
              (KB78-NUM-OCCUP8-RLTNSP-APPLT1 = '41')                            
              MOVE 'Y' TO CHILD-IN-OCC-FLAG                                     
           END-IF.                                                              
                                                                                
       6500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *==============================================================*          
       6600-APP2-OR-OCC-CHILD-SINGLE.                                           
      *==============================================================*          
      *--------------------------------------------------------------*          
      * APP2 OR OCCUPIER IS SINGLE CHILD ABOVE 21 YEARS OLD          *          
      *--------------------------------------------------------------*          
           MOVE SPACES TO APP2-OCC-CHILD-SINGLE-FLAG.                           
           MOVE SPACES TO APP2-OCC-CHILD-SINGLE-B21-FLAG.                       
                                                                                
           IF NOT CHILD-YES                                                     
              GO TO 6600-EXIT                                                   
           END-IF.                                                              
                                                                                
      **-- CHECK WHETHER APP2 IS SINGLE AND AGE IS ABOVE 21.                    
           IF (KB78-NUM-APPLT2-MARITAL-STATUS = '1' OR 'S') AND                 
               KB78-NUM-APPLT2-RLTNSP-APPLT1 = '41'                             
              MOVE KB78-DTE-APPLT2-BIRTH     TO WS-DOB                          
              PERFORM 7900-COMPUTE-AGE       THRU 7900-EXIT                     
                                                                                
              IF ABOVE-21                                                       
                 MOVE 'Y' TO APP2-OCC-CHILD-SINGLE-FLAG                         
                 GO TO 6600-EXIT                                                
              END-IF                                                            
           END-IF.                                                              
                                                                                
      **-- CHECK WHETHER APP3 IS SINGLE AND AGE IS ABOVE 21.                    
           IF (KB78-NUM-APPLT3-MARITAL-STATUS = '1' OR 'S') AND                 
               KB78-NUM-APPLT2-RLTNSP-APPLT1 = '41'                             
              MOVE KB78-DTE-APPLT3-BIRTH     TO WS-DOB                          
                                                                                
              PERFORM 7900-COMPUTE-AGE       THRU 7900-EXIT                     
                                                                                
              IF ABOVE-21                                                       
                 MOVE 'Y' TO APP2-OCC-CHILD-SINGLE-FLAG                         
                 GO TO 6600-EXIT                                                
              END-IF                                                            
           END-IF.                                                              
                                                                                
      **-- CHECK WHETHER APP4 IS SINGLE AND AGE IS ABOVE 21.                    
           IF (KB78-NUM-APPLT4-MARITAL-STATUS = '1' OR 'S') AND                 
               KB78-NUM-APPLT2-RLTNSP-APPLT1 = '41'                             
              MOVE KB78-DTE-APPLT4-BIRTH     TO WS-DOB                          
              PERFORM 7900-COMPUTE-AGE       THRU 7900-EXIT                     
                                                                                
              IF ABOVE-21                                                       
                 MOVE 'Y' TO APP2-OCC-CHILD-SINGLE-FLAG                         
                 GO TO 6600-EXIT                                                
              END-IF                                                            
           END-IF.                                                              
                                                                                
      **-- CHECK WHETHER OCCP IS SINGLE AND AGE IS ABOVE 21.                    
           PERFORM VARYING WS-CNT FROM 1 BY 1 UNTIL WS-CNT > 8                  
              IF WS-REL(WS-CNT) = '41' AND                                      
                 ( WS-MRTL(WS-CNT) = 'S' OR '1')                                
                 MOVE WS-DTE-BIRTH(WS-CNT)      TO WS-DOB                       
                 PERFORM 7900-COMPUTE-AGE       THRU 7900-EXIT                  
                                                                                
                 IF ABOVE-21                                                    
                    MOVE 'Y' TO APP2-OCC-CHILD-SINGLE-FLAG                      
                    GO TO 6600-EXIT                                             
                 ELSE                                                           
                    MOVE 'Y' TO APP2-OCC-CHILD-SINGLE-B21-FLAG                  
                    GO TO 6600-EXIT                                             
                 END-IF                                                         
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
       6600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *==============================================================*          
       6700-APP1-SINGLE-CHILD.                                                  
      *==============================================================*          
      *--------------------------------------------------------------*          
      * APPLICANT 1 IS SINGLE CHILD ABOVE 21 YEARS OLD.              *          
      *--------------------------------------------------------------*          
           MOVE SPACES TO APP1-SINGLE-CHILD-FLAG.                               
                                                                                
           MOVE KB78-DTE-APPLT1-BIRTH     TO WS-DOB.                            
           PERFORM 7900-COMPUTE-AGE       THRU 7900-EXIT.                       
                                                                                
           IF APP1-SINGLE AND ABOVE-21                                          
              MOVE 'Y' TO APP1-SINGLE-CHILD-FLAG                                
           END-IF.                                                              
                                                                                
       6700-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *==============================================================*          
       6800-APP2-OR-OCC-SINGLE-PARENT.                                          
      *==============================================================*          
      *--------------------------------------------------------------*          
      * SINGLE PARENT OF APPLICANT1 IN APP2 OR OCCUPIERS.            *          
      *--------------------------------------------------------------*          
           MOVE SPACES TO APP2-OCC-SINGLE-PARENT-FLAG.                          
                                                                                
           IF ((KB78-NUM-APPLT2-MARITAL-STATUS = '1' OR 'S')                    
                AND (KB78-NUM-APPLT2-RLTNSP-APPLT1  = '02' OR '12')) OR         
              ((KB78-NUM-APPLT3-MARITAL-STATUS = '1' OR 'S')                    
                AND (KB78-NUM-APPLT3-RLTNSP-APPLT1  = '02' OR '12')) OR         
              ((KB78-NUM-APPLT4-MARITAL-STATUS = '1' OR 'S')                    
                AND (KB78-NUM-APPLT4-RLTNSP-APPLT1  = '02' OR '12')) OR         
              ((KB78-NUM-OCCUP1-MARITAL-STATUS = '1' OR 'S')                    
                AND (KB78-NUM-OCCUP1-RLTNSP-APPLT1  = '02' OR '12')) OR         
              ((KB78-NUM-OCCUP2-MARITAL-STATUS = '1' OR 'S')                    
                AND (KB78-NUM-OCCUP2-RLTNSP-APPLT1  = '02' OR '12')) OR         
              ((KB78-NUM-OCCUP3-MARITAL-STATUS = '1' OR 'S')                    
                AND (KB78-NUM-OCCUP3-RLTNSP-APPLT1  = '02' OR '12')) OR         
              ((KB78-NUM-OCCUP4-MARITAL-STATUS = '1' OR 'S')                    
                AND (KB78-NUM-OCCUP4-RLTNSP-APPLT1  = '02' OR '12')) OR         
              ((KB78-NUM-OCCUP5-MARITAL-STATUS = '1' OR 'S')                    
                AND (KB78-NUM-OCCUP5-RLTNSP-APPLT1  = '02' OR '12')) OR         
              ((KB78-NUM-OCCUP6-MARITAL-STATUS = '1' OR 'S')                    
                AND (KB78-NUM-OCCUP6-RLTNSP-APPLT1  = '02' OR '12')) OR         
              ((KB78-NUM-OCCUP7-MARITAL-STATUS = '1' OR 'S')                    
                AND (KB78-NUM-OCCUP7-RLTNSP-APPLT1  = '02' OR '12')) OR         
              ((KB78-NUM-OCCUP8-MARITAL-STATUS = '1' OR 'S')                    
                AND (KB78-NUM-OCCUP8-RLTNSP-APPLT1  = '02' OR '12'))            
              MOVE 'Y' TO APP2-OCC-SINGLE-PARENT-FLAG                           
           END-IF.                                                              
                                                                                
       6800-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *==============================================================*          
       6900-APP1-CHILD-GRANDCH-SINGLE.                                          
      *==============================================================*          
                                                                                
      * HA1     - APP1 MARRIED/WIDOW/DIVERSED,IF MARRIED SPOUSE SHOULD          
      *           NOT BE THERE. THATS MEAN SINGLE PARENT OF HA2/OCC.            
      * HA2/OCC - CHILD OF HA1                                                  
      * OCCUPIER- CHILD OF HA2 / GRAND CHILD OF HA1.                            
                                                                                
      * NOTE : THIS PARA SHOULD BE AFTER 6600- PARA                             
      *        LOOKING FOR APP2-OCC-CHILD-SINGLE-FLAG = YES                     
                                                                                
           MOVE SPACES TO APP1-CHILD-GRANDCH-SINGLE-FLAG.                       
                                                                                
           MOVE KB78-DTE-APPLT1-BIRTH     TO WS-DOB.                            
           PERFORM 7900-COMPUTE-AGE       THRU 7900-EXIT.                       
                                                                                
           IF (KB78-NUM-APPLT1-MARITAL-STATUS = '2' OR 'M'                      
                                             OR '3' OR 'W'                      
                                             OR '4' OR 'D'                      
                                             OR '5' OR 'P') AND                 
                                             ABOVE-21                           
                                                                                
              IF GCHILD-YES AND APP2-OCC-CHILD-SINGLE                           
                 MOVE 'Y' TO APP1-CHILD-GRANDCH-SINGLE-FLAG                     
              END-IF                                                            
           END-IF.                                                              
                                                                                
       6900-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *==============================================================*          
       7100-APP2-OCC-ADOPT-PARENTS.                                             
      *==============================================================*          
      *--------------------------------------------------------------*          
      * IF THERE ARE ADOPTIVE PARENTS IN APPLICATIONS.               *          
      *--------------------------------------------------------------*          
           MOVE SPACES TO APP2-OCC-ADOPT-PARENTS-FLAG.                          
                                                                                
           IF ((KB78-NUM-APPLT2-RLTNSP-APPLT1 = '38') OR                        
               (KB78-NUM-APPLT3-RLTNSP-APPLT1 = '38') OR                        
               (KB78-NUM-APPLT4-RLTNSP-APPLT1 = '38') OR                        
               (KB78-NUM-OCCUP1-RLTNSP-APPLT1 = '38') OR                        
               (KB78-NUM-OCCUP2-RLTNSP-APPLT1 = '38') OR                        
               (KB78-NUM-OCCUP3-RLTNSP-APPLT1 = '38') OR                        
               (KB78-NUM-OCCUP4-RLTNSP-APPLT1 = '38') OR                        
               (KB78-NUM-OCCUP5-RLTNSP-APPLT1 = '38'))                          
              MOVE 'Y' TO APP2-OCC-ADOPT-PARENTS-FLAG                           
           END-IF.                                                              
                                                                                
       7100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *==============================================================*          
       7200-APP2-OCC-ADOPT-CHILD.                                               
      *==============================================================*          
      *--------------------------------------------------------------*          
      * IF THERE ARE ADOPTIVE CHILD IN APPLICATIONS.                 *          
      *--------------------------------------------------------------*          
           MOVE SPACES TO APP2-OCC-ADOPT-CHILD-FLAG.                            
                                                                                
           IF (((KB78-NUM-APPLT2-MARITAL-STATUS = '1' OR 'S') AND               
               (KB78-NUM-APPLT2-RLTNSP-APPLT1 = '39'))       OR                 
              ((KB78-NUM-APPLT3-MARITAL-STATUS = '1' OR 'S') AND                
               (KB78-NUM-APPLT3-RLTNSP-APPLT1 = '39'))       OR                 
              ((KB78-NUM-APPLT4-MARITAL-STATUS = '1' OR 'S') AND                
               (KB78-NUM-APPLT4-RLTNSP-APPLT1 = '39'))       OR                 
              ((KB78-NUM-OCCUP1-MARITAL-STATUS = '1' OR 'S') AND                
               (KB78-NUM-OCCUP1-RLTNSP-APPLT1 = '39'))       OR                 
              ((KB78-NUM-OCCUP2-MARITAL-STATUS = '1' OR 'S') AND                
               (KB78-NUM-OCCUP2-RLTNSP-APPLT1 = '39'))       OR                 
              ((KB78-NUM-OCCUP3-MARITAL-STATUS = '1' OR 'S') AND                
               (KB78-NUM-OCCUP3-RLTNSP-APPLT1 = '39'))       OR                 
              ((KB78-NUM-OCCUP4-MARITAL-STATUS = '1' OR 'S') AND                
               (KB78-NUM-OCCUP4-RLTNSP-APPLT1 = '39'))       OR                 
              ((KB78-NUM-OCCUP5-MARITAL-STATUS = '1' OR 'S') AND                
               (KB78-NUM-OCCUP5-RLTNSP-APPLT1 = '39')))                         
              MOVE 'Y' TO APP2-OCC-ADOPT-CHILD-FLAG                             
           END-IF.                                                              
                                                                                
       7200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *==============================================================*          
       7300-OCC-MARRIED-NON-CITIZEN.                                            
      *==============================================================*          
      *--------------------------------------------------------------*          
      * IF THERE ARE MARRIED NON CITIZENS IN APPLICATION.            *          
      *--------------------------------------------------------------*          
           MOVE SPACES TO OCC-MARRIED-NON-CITIZEN-FLAG.                         
                                                                                
           IF (((KB78-NUM-OCCUP1-MARITAL-STATUS = '2' OR 'M') AND               
                (KB78-NUM-OCCUP1-CITIZENSHIP NOT = '10' AND '20')) OR           
               ((KB78-NUM-OCCUP2-MARITAL-STATUS = '2' OR 'M') AND               
                (KB78-NUM-OCCUP2-CITIZENSHIP NOT = '10' AND '20')) OR           
               ((KB78-NUM-OCCUP3-MARITAL-STATUS = '2' OR 'M') AND               
                (KB78-NUM-OCCUP3-CITIZENSHIP NOT = '10' AND '20')) OR           
               ((KB78-NUM-OCCUP4-MARITAL-STATUS = '2' OR 'M') AND               
                (KB78-NUM-OCCUP4-CITIZENSHIP NOT = '10' AND '20')) OR           
               ((KB78-NUM-OCCUP5-MARITAL-STATUS = '2' OR 'M') AND               
                (KB78-NUM-OCCUP5-CITIZENSHIP NOT = '10' AND '20')))             
              MOVE 'Y' TO OCC-MARRIED-NON-CITIZEN-FLAG                          
           END-IF.                                                              
                                                                                
       7300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *==============================================================*          
       7400-CNT-APPLTS.                                                         
      *==============================================================*          
           MOVE 'N'           TO WS-SA-IND.                                     
           INITIALIZE            WS-CNT-APPLT.                                  
                                                                                
           IF KB78-NUM-APPLT1-UIN NOT = SPACES AND LOW-VALUES                   
              ADD 1           TO WS-CNT-APPLT                                   
           END-IF.                                                              
                                                                                
           IF KB78-NUM-APPLT2-UIN NOT = SPACES AND LOW-VALUES                   
              ADD 1           TO WS-CNT-APPLT                                   
           END-IF.                                                              
                                                                                
           IF KB78-NUM-APPLT3-UIN NOT = SPACES AND LOW-VALUES                   
              ADD 1           TO WS-CNT-APPLT                                   
           END-IF.                                                              
                                                                                
           IF KB78-NUM-APPLT4-UIN NOT = SPACES AND LOW-VALUES                   
              ADD 1           TO WS-CNT-APPLT                                   
           END-IF.                                                              
                                                                                
           IF KB78-NUM-OCCUP1-UIN NOT = SPACES AND LOW-VALUES                   
              ADD 1           TO WS-CNT-APPLT                                   
           END-IF.                                                              
                                                                                
           IF KB78-NUM-OCCUP2-UIN NOT = SPACES AND LOW-VALUES                   
              ADD 1           TO WS-CNT-APPLT                                   
           END-IF.                                                              
                                                                                
           IF KB78-NUM-OCCUP3-UIN NOT = SPACES AND LOW-VALUES                   
              ADD 1           TO WS-CNT-APPLT                                   
           END-IF.                                                              
                                                                                
           IF KB78-NUM-OCCUP4-UIN NOT = SPACES AND LOW-VALUES                   
              ADD 1           TO WS-CNT-APPLT                                   
           END-IF.                                                              
                                                                                
           IF KB78-NUM-OCCUP5-UIN NOT = SPACES AND LOW-VALUES                   
              ADD 1           TO WS-CNT-APPLT                                   
           END-IF.                                                              
                                                                                
           IF WS-CNT-APPLT > 1                                                  
              IF ((KB78-NUM-APPLT2-RLTNSP-APPLT1 = '20' OR                      
                 '41' OR '09' OR '02' OR '12' OR '38' OR '39') OR               
                 (KB78-NUM-APPLT3-RLTNSP-APPLT1 = '20' OR                       
                 '41' OR '09' OR '02' OR '12' OR '38' OR '39') OR               
                 (KB78-NUM-APPLT4-RLTNSP-APPLT1 = '20' OR                       
                 '41' OR '09' OR '02' OR '12' OR '38' OR '39') OR               
                 (KB78-NUM-OCCUP1-RLTNSP-APPLT1 = '20' OR                       
                 '41' OR '09' OR '02' OR '12' OR '38' OR '39') OR               
                 (KB78-NUM-OCCUP2-RLTNSP-APPLT1 = '20' OR                       
                 '41' OR '09' OR '02' OR '12' OR '38' OR '39') OR               
                 (KB78-NUM-OCCUP3-RLTNSP-APPLT1 = '20' OR                       
                 '41' OR '09' OR '02' OR '12' OR '38' OR '39') OR               
                 (KB78-NUM-OCCUP4-RLTNSP-APPLT1 = '20' OR                       
                 '41' OR '09' OR '02' OR '12' OR '38' OR '39') OR               
                 (KB78-NUM-OCCUP5-RLTNSP-APPLT1 = '20' OR                       
                 '41' OR '09' OR '02' OR '12' OR '38' OR '39'))                 
                    MOVE 'Y' TO WS-SA-IND                                       
              END-IF                                                            
           END-IF.                                                              
                                                                                
       7400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *==============================================================*          
       7900-COMPUTE-AGE.                                                        
      *==============================================================*          
                                                                                
           IF WS-NUM-DOB IS NOT NUMERIC                                         
              MOVE ZEROES TO WS-NUM-DOB                                         
              DISPLAY "INVALID DATE OF BIRTH,REGN " KB78-NUM-REGN               
              GO TO 7900-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE SPACES TO ABOVE-21-FLAG.                                        
           MOVE ZEROES TO WS-CNT-MONTHS.                                        
                                                                                
           COMPUTE WS-CNT-MONTHS = (WS-CUR-CCYY - WS-DOB-CCYY) * 12 +           
                                         (WS-CUR-MM - WS-DOB-MM).               
                                                                                
                                                                                
           IF WS-CUR-DD <= WS-DOB-DD                                            
              SUBTRACT 1 FROM WS-CNT-MONTHS                                     
           ELSE                                                                 
              ADD      1 TO   WS-CNT-MONTHS                                     
           END-IF.                                                              
                                                                                
           IF WS-CNT-MONTHS > WS-CONTROL-MONTH                                  
              MOVE 'Y' TO ABOVE-21-FLAG                                         
           END-IF.                                                              
                                                                                
       7900-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       8000-WRITE-BP13KB20.                                                     
      *-------------------------------------------------------------            
                                                                                
           WRITE BP13KB20-REC.                                                  
                                                                                
           EVALUATE BP13KB20-STATUS                                             
           WHEN 00                                                              
                ADD   1              TO WS-KB20-WRITE                           
           WHEN 02                                                              
                ADD   1              TO WS-KB20-WRITE                           
                ADD   1              TO WS-KB20-DUPKEY                          
           WHEN 22                                                              
                DISPLAY 'BP13KB20 DUP REC ERROR - ' KB20-KEY-FLD                
           WHEN OTHER                                                           
                MOVE BP13KB20-STATUS TO RETURN-CODE                             
                DISPLAY 'BP13KB20 WRITE ERROR, STATUS : '                       
                         BP13KB20-STATUS ' KEY : ' KB20-KEY-FLD                 
                PERFORM  9000-CLOSE-ROUTINE THRU 9000-EXIT                      
           END-EVALUATE.                                                        
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       9000-CLOSE-ROUTINE.                                                      
      *-------------------------------------------------------------            
                                                                                
           DISPLAY ' BP13C028 CONTROL TOTAL '.                                  
           DISPLAY '------------------------------------------'.                
           DISPLAY SPACES.                                                      
           DISPLAY 'NO OF RECS READ  FROM BP13FB60 : ' WS-FB60-READ.            
           DISPLAY 'NO OF RECS READ  FROM BP13FA30 : ' WS-FA30-READ.            
           DISPLAY 'NO OF RECS MATCH               : ' WS-MATCHED.              
           DISPLAY 'NO OF FB60 NOT FOUND           : ' WS-FB60-NFND.            
           DISPLAY 'NO OF FA30 NOT FOUND           : ' WS-FA30-NFND.            
           DISPLAY 'NO OF RECS WRITTEN TO BP13KB78 : ' WS-KB78-WRITE.           
           DISPLAY 'NO OF DUPLICATE ALT-KEY KB78   : ' WS-KB78-DUPKEY.          
           DISPLAY 'NO OF RECS WRITTEN TO BP13KB20 : ' WS-KB20-WRITE.           
           DISPLAY 'NO OF DUPLICATE ALT-KEY KB20   : ' WS-KB20-DUPKEY.          
                                                                                
           CLOSE BP13FB60                                                       
                 BP13FA30                                                       
                 BP13KB78                                                       
                 BP13KB20.                                                      
                                                                                
           IF BP13KB78-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR CLOSING - BP13KB78 : ' BP13KB78-STATUS             
              MOVE BP13KB78-STATUS TO RETURN-CODE.                              
                                                                                
           IF BP13KB20-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR CLOSING - BP13KB20 : ' BP13KB20-STATUS             
              MOVE BP13KB20-STATUS TO RETURN-CODE.                              
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
