      *--------------------------------------------------------*                
       IDENTIFICATION DIVISION.                                                 
      *--------------------------------------------------------*                
       PROGRAM-ID.    BP13C357.                                                 
      *AUTHOR. SK.                                                              
      *DATE-WRITTEN.  05/03/2003.                                               
                                                                                
      **********************************************************                
      *                                                        *                
      *    SYSTEM NAME : SYSTEM OF COMMITMENT                  *                
      *                                                        *                
      *    SYSTEM ID : BP13                                    *                
      *                                                        *                
      *    OBJECTIVE  : AGREEMENT ORDER FILE                   *                
      *                 TO CREATE CPF TRANSACTION ON SOC CPF   *                
      *                 FOR THE BANK LOAN CASES                *                
      *     INPUT FILES:                                       *                
      *           1. BP13F300                                  *                
      *           2. SY02F001                                  *                
      *                                                        *                
      *     I-O   FILES:                                       *                
      *           1. BP13K671                                  *                
      *                                                        *                
      *     OUTPUT FILES:                                      *                
      *           1. BP13F121 (CPF TRANSACTIONS FILE)          *                
      *           2. BP13L357 (CONTROL LISTING)                *                
      *                                                        *                
      * BP132309 SK  05032002  WRITE  TO BP13F121              *                
      *          MCC 07042003  WRITE     BP13L357              *                
      * BP132526 SK  18062004  INCREASE BP13K671 TO 3000       *                
      **********************************************************                
                                                                                
      *--------------------------------------------------------*                
       ENVIRONMENT DIVISION.                                                    
      *--------------------------------------------------------*                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F300 ASSIGN TO BP13F300.                                  
           SELECT BP13F121 ASSIGN TO BP13F121.                                  
           SELECT SY02F001 ASSIGN TO SY02F001.                                  
                                                                                
           SELECT BP13K671 ASSIGN TO BP13K671                                   
                  ACCESS MODE     IS RANDOM                                     
                  ORGANIZATION    IS INDEXED                                    
                  RECORD KEY      IS K671-NUM-REGN                              
                  FILE STATUS     IS WS-K671-STATUS.                            
                                                                                
           SELECT BP13L357 ASSIGN TO BP13L357.                                  
                                                                                
      *--------------------------------------------------------*                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *--------------------------------------------------------*                
                                                                                
       FD  BP13F300                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 2000 CHARACTERS                                      
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F.                                                 
       COPY BP13F300.                                                           
                                                                                
       COPY SY02F001.                                                           
                                                                                
       FD   BP13K671                                                            
            RECORD CONTAINS 3000 CHARACTERS.                                    
       COPY BP13K671.                                                           
                                                                                
       FD  BP13F121                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 150 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F.                                                 
       COPY BP13F121.                                                           
                                                                                
       FD  BP13L357                                                             
           LABEL RECORDS ARE OMITTED                                            
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       01 L357-REC              PIC X(132).                                     
                                                                                
      *--------------------------------------------------------*                
       WORKING-STORAGE SECTION.                                                 
      *--------------------------------------------------------*                
                                                                                
       01  WS-SWITCHES.                                                         
           05  WS-F300-EOF                PIC X       VALUE 'N'.                
           05  WS-K671-FOUND              PIC X       VALUE 'N'.                
           05  WS-F001-EOF                PIC X       VALUE 'N'.                
               88 EOF-F001                            VALUE 'Y'.                
                                                                                
       01  WS-COUNTERS.                                                         
           05 WS-CNT-F300-READ            PIC 9(8)    VALUE ZEROES.             
           05 WS-CNT-F121-WRITE           PIC 9(8)    VALUE ZEROES.             
           05 WS-CNT-K671-FND             PIC 9(8)    VALUE ZEROES.             
           05 WS-CNT-K671-NFND            PIC 9(8)    VALUE ZEROES.             
           05 WS-CNT-K671-REWR            PIC 9(8)    VALUE ZEROES.             
           05 WS-CNT-CASES                PIC 9(2)    VALUE 55.                 
           05 WS-CNT-PAGE                 PIC 9(5)    VALUE ZEROES.             
           05 WS-CNT-PRINTED              PIC 9(5)    VALUE ZEROES.             
                                                                                
       01  WS-VARIABLES.                                                        
           05 WS-NRIC                     PIC X(9)    VALUE SPACES.             
           05 WS-SOC-CPF                  PIC 9(7)V99 VALUE ZEROES.             
           05 WS-K671-STATUS              PIC 9(2)    VALUE ZEROES.             
           05 WS-DTE-CPF-POST             PIC X(8)    VALUE SPACES.             
           05 WS-DTE-CPF1                 PIC X(8)    VALUE SPACES.             
           05 WS-DTE-CPF2                 PIC X(8)    VALUE SPACES.             
           05 WS-DTE-CPF3                 PIC X(8)    VALUE SPACES.             
           05 WS-DTE-CPF4                 PIC X(8)    VALUE SPACES.             
           05 WS-CDE-APPLT-CPF            PIC X(1)    VALUE SPACES.             
                                                                                
       01  WS-DETAIL-VARIABLES.                                                 
           05 WS-CPF-NO                   PIC X(9)    VALUE SPACES.             
           05 WS-AMT-BALANCE              PIC 9(7)V99 VALUE ZEROES.             
           05 WS-AMT-RECEIVED             PIC 9(7)V99 VALUE ZEROES.             
           05 WS-AMT-COLLECTED            PIC 9(7)V99 VALUE ZEROES.             
           05 WS-CPF-TYPE                 PIC 9(1)    VALUE ZERO.               
                                                                                
       01  WS-SYSTEM-DATE.                                                      
           05  WS-SYS-CCYY                PIC 9(4).                             
           05  WS-SYS-MM                  PIC 9(2).                             
           05  WS-SYS-DD                  PIC 9(2).                             
                                                                                
       01  WS-EDITED-DATE.                                                      
           05  WS-EDITED-DD               PIC 9(2).                             
           05  FILLER                     PIC X(1)  VALUE '/'.                  
           05  WS-EDITED-MM               PIC 9(2).                             
           05  FILLER                     PIC X(1)  VALUE '/'.                  
           05  WS-EDITED-CCYY             PIC 9(4).                             
                                                                                
                                                                                
      *  REPORT LAYOUT FOR CONTROL LISTING (BP13L357).                          
      *--------------------------------------------------------------           
       01  L357-HEADER1.                                                        
           05  FILLER              PIC X(8)      VALUE 'BP13L357'.              
           05  FILLER              PIC X(5)      VALUE SPACES .                 
           05  FILLER              PIC X(8)      VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(24)     VALUE SPACES.                  
           05  FILLER              PIC X(39)     VALUE                          
                         'S Y S T E M   O F   C O M M I T M E N T'.             
           05  FILLER              PIC X(17)     VALUE SPACES.                  
           05  FILLER              PIC X(7)      VALUE 'DATE : '.               
           05  L357-DATE           PIC X(10).                                   
           05  FILLER              PIC X(9)      VALUE '  PAGE : '.             
           05  L357-PAGE-NO        PIC ZZZZ9 .                                  
                                                                                
       01  L357-HEADER2.                                                        
           05  FILLER              PIC X(40)     VALUE SPACES .                 
           05  FILLER              PIC X(53)     VALUE                          
                'CONTROL LISTING FOR BO TRANSACTIONS WITH CPF BALANCE'.         
           05  FILLER              PIC X(40)     VALUE SPACES.                  
                                                                                
       01  L357-HEADER3.                                                        
           05  FILLER              PIC X(08)                                    
                  VALUE '    SNO '.                                             
           05  FILLER              PIC X(11)                                    
                  VALUE '   REGN-NO '.                                          
           05  FILLER              PIC X(12)                                    
                  VALUE '    CPF NO  '.                                         
           05  FILLER              PIC X(14)                                    
                  VALUE '    CPF TYPE  '.                                       
           05  FILLER              PIC X(15)                                    
                  VALUE '   AMT RECEIVED'.                                      
           05  FILLER              PIC X(16)                                    
                  VALUE '   AMT COLLECTED'.                                     
           05  FILLER              PIC X(15)                                    
                  VALUE '   AMT BALANCE '.                                      
                                                                                
       01  L357-DETAILS.                                                        
           05  FILLER              PIC X(03)     VALUE SPACES .                 
           05  L357-SNO            PIC ZZZZ9.                                   
           05  FILLER              PIC X(03)     VALUE SPACES .                 
           05  L357-REGN-NO        PIC X(08).                                   
           05  FILLER              PIC X(03)     VALUE SPACES .                 
           05  L357-CPF-NO         PIC X(09).                                   
           05  FILLER              PIC X(03)     VALUE SPACES .                 
           05  L357-CPF-TYPE       PIC X(11).                                   
           05  FILLER              PIC X(03)     VALUE SPACES .                 
           05  L357-AMT-RECEIVED   PIC Z,ZZZ,ZZ9.99.                            
           05  FILLER              PIC X(03)     VALUE SPACES .                 
           05  L357-AMT-COLLECTED  PIC Z,ZZZ,ZZ9.99.                            
           05  FILLER              PIC X(04)     VALUE SPACES .                 
           05  L357-AMT-BALANCE    PIC Z,ZZZ,ZZ9.99.                            
                                                                                
       01  L357-EMPTY.                                                          
           05  FILLER              PIC X(55)     VALUE SPACES .                 
           05  FILLER              PIC X(22)     VALUE                          
                                   '***  EMPTY REPORT  ***'.                    
                                                                                
      *--------------------------------------------------------*                
       PROCEDURE DIVISION.                                                      
      *--------------------------------------------------------*                
                                                                                
      *--------------------------------------------------------*                
       0000-MAIN.                                                               
      *--------------------------------------------------------*                
           PERFORM 1000-OPEN-FILE       THRU 1000-EXIT.                         
           PERFORM 2000-READ-F300       THRU 2000-EXIT.                         
           PERFORM 3000-PROCESS         THRU 3000-EXIT                          
                   UNTIL WS-F300-EOF = 'Y'.                                     
           PERFORM 9000-CLOSE-ROUTINE   THRU 9000-EXIT.                         
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------*                
       1000-OPEN-FILE.                                                          
      *--------------------------------------------------------*                
           OPEN INPUT  BP13F300                                                 
                       SY02F001                                                 
                I-O    BP13K671                                                 
                OUTPUT BP13F121                                                 
                       BP13L357.                                                
                                                                                
           EVALUATE WS-K671-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                   CONTINUE                                                     
              WHEN OTHER                                                        
                   MOVE WS-K671-STATUS      TO RETURN-CODE                      
                   DISPLAY 'OPEN BP13K671 FAIL. STATUS=' WS-K671-STATUS         
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
           END-EVALUATE.                                                        
                                                                                
           READ SY02F001 AT END MOVE 'Y'  TO WS-F001-EOF.                       
           IF EOF-F001                                                          
              DISPLAY 'RECORD NOT FOUND IN SY01F001 '                           
              DISPLAY 'PROCESSING TERMINATED '                                  
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           ELSE                                                                 
              MOVE F001-DTE-CURRENT      TO   WS-SYSTEM-DATE                    
           END-IF.                                                              
                                                                                
           MOVE WS-SYS-DD               TO WS-EDITED-DD.                        
           MOVE WS-SYS-MM               TO WS-EDITED-MM.                        
           MOVE WS-SYS-CCYY             TO WS-EDITED-CCYY.                      
                                                                                
           STRING FUNCTION CURRENT-DATE(7:2) '/'                                
                  FUNCTION CURRENT-DATE(5:2) '/'                                
                  FUNCTION CURRENT-DATE(1:4)                                    
           DELIMITED BY SIZE INTO L357-DATE.                                    
                                                                                
           PERFORM 5100-PRINT-HEADING THRU 5100-EXIT.                           
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------*                
       2000-READ-F300.                                                          
      *--------------------------------------------------------*                
           READ BP13F300                                                        
                AT END  MOVE 'Y' TO WS-F300-EOF                                 
                GO TO 2000-EXIT                                                 
           END-READ.                                                            
                                                                                
           ADD 1 TO WS-CNT-F300-READ.                                           
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------*                
       3000-PROCESS.                                                            
      *--------------------------------------------------------*                
           MOVE SPACES TO WS-NRIC.                                              
           MOVE ZEROS  TO WS-SOC-CPF.                                           
                                                                                
           PERFORM 3500-READ-BP13K671 THRU 3500-EXIT.                           
           PERFORM 3600-GET-CPF-POST-DATE THRU 3600-EXIT.                       
                                                                                
           IF F300-AMT-SOC-CPF1 NOT NUMERIC                                     
              MOVE ZEROS  TO F300-AMT-SOC-CPF1                                  
           END-IF.                                                              
                                                                                
           IF F300-AMT-SOC-CPF2 NOT NUMERIC                                     
              MOVE ZEROS  TO F300-AMT-SOC-CPF2                                  
           END-IF.                                                              
                                                                                
           IF F300-AMT-SOC-CPF3 NOT NUMERIC                                     
              MOVE ZEROS  TO F300-AMT-SOC-CPF3                                  
           END-IF.                                                              
                                                                                
           IF F300-AMT-SOC-CPF4 NOT NUMERIC                                     
              MOVE ZEROS  TO F300-AMT-SOC-CPF4                                  
           END-IF.                                                              
                                                                                
           IF F300-AMT-SOC-CPF1 > 0                                             
              MOVE WS-DTE-CPF1          TO WS-DTE-CPF-POST                      
              MOVE F300-NRIC1           TO WS-NRIC                              
              MOVE F300-AMT-SOC-CPF1    TO WS-SOC-CPF                           
              MOVE '1'                  TO WS-CDE-APPLT-CPF                     
              PERFORM 4000-WRITE-F121   THRU 4000-EXIT                          
           END-IF.                                                              
                                                                                
           IF F300-AMT-SOC-CPF2 > 0                                             
              MOVE WS-DTE-CPF2          TO WS-DTE-CPF-POST                      
              MOVE F300-NRIC2           TO WS-NRIC                              
              MOVE F300-AMT-SOC-CPF2    TO WS-SOC-CPF                           
              MOVE '2'                  TO WS-CDE-APPLT-CPF                     
              PERFORM 4000-WRITE-F121   THRU 4000-EXIT                          
           END-IF.                                                              
                                                                                
           IF F300-AMT-SOC-CPF3 > 0                                             
              MOVE WS-DTE-CPF3          TO WS-DTE-CPF-POST                      
              MOVE F300-NRIC3           TO WS-NRIC                              
              MOVE F300-AMT-SOC-CPF3    TO WS-SOC-CPF                           
              MOVE '3'                  TO WS-CDE-APPLT-CPF                     
              PERFORM 4000-WRITE-F121   THRU 4000-EXIT                          
           END-IF.                                                              
                                                                                
           IF F300-AMT-SOC-CPF4 > 0                                             
              IF WS-K671-FOUND = 'Y'                                            
              MOVE WS-DTE-CPF4          TO WS-DTE-CPF-POST                      
              MOVE F300-NRIC4           TO WS-NRIC                              
              MOVE F300-AMT-SOC-CPF4    TO WS-SOC-CPF                           
              MOVE '4'                  TO WS-CDE-APPLT-CPF                     
              PERFORM 4000-WRITE-F121   THRU 4000-EXIT                          
           END-IF.                                                              
                                                                                
           PERFORM 2000-READ-F300       THRU 2000-EXIT.                         
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------*                
       3500-READ-BP13K671.                                                      
      *--------------------------------------------------------*                
           MOVE 'N'              TO WS-K671-FOUND.                              
           MOVE F300-CUR-REG     TO K671-NUM-REGN.                              
                                                                                
           READ BP13K671.                                                       
                                                                                
           EVALUATE WS-K671-STATUS                                              
              WHEN 00                                                           
                 MOVE 'Y' TO WS-K671-FOUND                                      
                 ADD 1 TO WS-CNT-K671-FND                                       
                 PERFORM 3700-UPDATE-BP13K671 THRU 3700-EXIT                    
              WHEN 23                                                           
                 MOVE 'N' TO WS-K671-FOUND                                      
                 ADD 1 TO WS-CNT-K671-NFND                                      
                 DISPLAY 'NOT FOUND IN BP13K671. REGN : ' F300-CUR-REG          
              WHEN OTHER                                                        
                 MOVE WS-K671-STATUS     TO RETURN-CODE                         
                 DISPLAY 'ERROR READING BP13K671, STATUS = '                    
                                        WS-K671-STATUS                          
                 PERFORM 9000-CLOSE-ROUTINE  THRU 9000-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       3500-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------*                
       3600-GET-CPF-POST-DATE.                                                  
      *--------------------------------------------------------*                
              MOVE WS-SYSTEM-DATE      TO WS-DTE-CPF1,                          
                                          WS-DTE-CPF2,                          
                                          WS-DTE-CPF3,                          
                                          WS-DTE-CPF4.                          
                                                                                
              IF WS-K671-FOUND = 'Y'                                            
                 IF (K671-DTE-VALUE-CPF1 NOT = SPACES AND LOW-VALUES            
                                               AND ALL '0')                     
                     MOVE K671-DTE-VALUE-CPF1 TO WS-DTE-CPF1                    
                 END-IF                                                         
                 IF (K671-DTE-VALUE-CPF2 NOT = SPACES AND LOW-VALUES            
                                               AND ALL '0')                     
                     MOVE K671-DTE-VALUE-CPF2 TO WS-DTE-CPF2                    
                 END-IF                                                         
                 IF (K671-DTE-VALUE-CPF3 NOT = SPACES AND LOW-VALUES            
                                               AND ALL '0')                     
                     MOVE K671-DTE-VALUE-CPF3 TO WS-DTE-CPF3                    
                 END-IF                                                         
                 IF (K671-DTE-VALUE-CPF4 NOT = SPACES AND LOW-VALUES            
                                               AND ALL '0')                     
                     MOVE K671-DTE-VALUE-CPF4 TO WS-DTE-CPF4                    
                 END-IF                                                         
              END-IF.                                                           
                                                                                
       3600-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------*                
       3700-UPDATE-BP13K671.                                                    
      *--------------------------------------------------------*                
           PERFORM 3705-INITIALIZE-FLDS THRU 3705-EXIT.                         
                                                                                
           IF F300-CPF1 NOT = SPACES AND LOW-VALUES                             
              MOVE F300-CPF1 TO WS-CPF-NO                                       
              PERFORM 3710-COMPUTE-BALANCE-CPF1 THRU 3710-EXIT.                 
                                                                                
           IF F300-CPF2 NOT = SPACES AND LOW-VALUES                             
              MOVE F300-CPF2 TO WS-CPF-NO                                       
              PERFORM 3720-COMPUTE-BALANCE-CPF2 THRU 3720-EXIT.                 
                                                                                
           IF F300-CPF3 NOT = SPACES AND LOW-VALUES                             
              MOVE F300-CPF3 TO WS-CPF-NO                                       
              PERFORM 3730-COMPUTE-BALANCE-CPF3 THRU 3730-EXIT.                 
                                                                                
           IF F300-CPF4 NOT = SPACES AND LOW-VALUES                             
              MOVE F300-CPF4 TO WS-CPF-NO                                       
              PERFORM 3740-COMPUTE-BALANCE-CPF4 THRU 3740-EXIT.                 
                                                                                
           PERFORM 3750-REWRITE-BP13K671 THRU 3750-EXIT.                        
                                                                                
       3700-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------*                
       3705-INITIALIZE-FLDS.                                                    
      *--------------------------------------------------------*                
           IF K671-AMT-SOC-CPF1-PAID NOT NUMERIC                                
              MOVE ZEROES TO K671-AMT-SOC-CPF1-PAID.                            
           IF K671-AMT-SOC-CPF2-PAID NOT NUMERIC                                
              MOVE ZEROES TO K671-AMT-SOC-CPF2-PAID.                            
           IF K671-AMT-SOC-CPF3-PAID NOT NUMERIC                                
              MOVE ZEROES TO K671-AMT-SOC-CPF3-PAID.                            
           IF K671-AMT-SOC-CPF4-PAID NOT NUMERIC                                
              MOVE ZEROES TO K671-AMT-SOC-CPF4-PAID.                            
                                                                                
           IF K671-AMT-LSE-STMP-CPF1-PAID NOT NUMERIC                           
              MOVE ZEROES TO K671-AMT-LSE-STMP-CPF1-PAID.                       
           IF K671-AMT-LSE-STMP-CPF2-PAID NOT NUMERIC                           
              MOVE ZEROES TO K671-AMT-LSE-STMP-CPF2-PAID.                       
           IF K671-AMT-LSE-STMP-CPF3-PAID NOT NUMERIC                           
              MOVE ZEROES TO K671-AMT-LSE-STMP-CPF3-PAID.                       
           IF K671-AMT-LSE-STMP-CPF4-PAID NOT NUMERIC                           
              MOVE ZEROES TO K671-AMT-LSE-STMP-CPF4-PAID.                       
                                                                                
           IF K671-AMT-SALE-CONVY-CPF1-PAID NOT NUMERIC                         
              MOVE ZEROES TO K671-AMT-SALE-CONVY-CPF1-PAID.                     
           IF K671-AMT-SALE-CONVY-CPF2-PAID NOT NUMERIC                         
              MOVE ZEROES TO K671-AMT-SALE-CONVY-CPF2-PAID.                     
           IF K671-AMT-SALE-CONVY-CPF3-PAID NOT NUMERIC                         
              MOVE ZEROES TO K671-AMT-SALE-CONVY-CPF3-PAID.                     
           IF K671-AMT-SALE-CONVY-CPF4-PAID NOT NUMERIC                         
              MOVE ZEROES TO K671-AMT-SALE-CONVY-CPF4-PAID.                     
                                                                                
           IF K671-AMT-MORT-CONVY-CPF1-PAID NOT NUMERIC                         
              MOVE ZEROES TO K671-AMT-MORT-CONVY-CPF1-PAID.                     
           IF K671-AMT-MORT-CONVY-CPF2-PAID NOT NUMERIC                         
              MOVE ZEROES TO K671-AMT-MORT-CONVY-CPF2-PAID.                     
           IF K671-AMT-MORT-CONVY-CPF3-PAID NOT NUMERIC                         
              MOVE ZEROES TO K671-AMT-MORT-CONVY-CPF3-PAID.                     
           IF K671-AMT-MORT-CONVY-CPF4-PAID NOT NUMERIC                         
              MOVE ZEROES TO K671-AMT-MORT-CONVY-CPF4-PAID.                     
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF1-PAID NOT NUMERIC                        
              MOVE ZEROES TO K671-AMT-CAVEAT-REGN-CPF1-PAID.                    
           IF K671-AMT-CAVEAT-REGN-CPF2-PAID NOT NUMERIC                        
              MOVE ZEROES TO K671-AMT-CAVEAT-REGN-CPF2-PAID.                    
           IF K671-AMT-CAVEAT-REGN-CPF3-PAID NOT NUMERIC                        
              MOVE ZEROES TO K671-AMT-CAVEAT-REGN-CPF3-PAID.                    
           IF K671-AMT-CAVEAT-REGN-CPF4-PAID NOT NUMERIC                        
              MOVE ZEROES TO K671-AMT-CAVEAT-REGN-CPF4-PAID.                    
                                                                                
           IF F300-AMT-TOPUP-CPF1 NOT NUMERIC                                   
              MOVE ZEROES TO F300-AMT-TOPUP-CPF1.                               
           IF F300-AMT-TOPUP-CPF2 NOT NUMERIC                                   
              MOVE ZEROES TO F300-AMT-TOPUP-CPF2.                               
           IF F300-AMT-TOPUP-CPF3 NOT NUMERIC                                   
              MOVE ZEROES TO F300-AMT-TOPUP-CPF3.                               
           IF F300-AMT-TOPUP-CPF4 NOT NUMERIC                                   
              MOVE ZEROES TO F300-AMT-TOPUP-CPF4.                               
                                                                                
           IF F300-AMT-LEASE-STAMP-CPF1 NOT NUMERIC                             
              MOVE ZEROES TO F300-AMT-LEASE-STAMP-CPF1.                         
           IF F300-AMT-LEASE-STAMP-CPF2 NOT NUMERIC                             
              MOVE ZEROES TO F300-AMT-LEASE-STAMP-CPF2.                         
           IF F300-AMT-LEASE-STAMP-CPF3 NOT NUMERIC                             
              MOVE ZEROES TO F300-AMT-LEASE-STAMP-CPF3.                         
           IF F300-AMT-LEASE-STAMP-CPF4 NOT NUMERIC                             
              MOVE ZEROES TO F300-AMT-LEASE-STAMP-CPF4.                         
                                                                                
           IF F300-AMT-CONV-CPF1 NOT NUMERIC                                    
              MOVE ZEROES TO F300-AMT-CONV-CPF1.                                
           IF F300-AMT-CONV-CPF2 NOT NUMERIC                                    
              MOVE ZEROES TO F300-AMT-CONV-CPF2.                                
           IF F300-AMT-CONV-CPF3 NOT NUMERIC                                    
              MOVE ZEROES TO F300-AMT-CONV-CPF3.                                
           IF F300-AMT-CONV-CPF4 NOT NUMERIC                                    
              MOVE ZEROES TO F300-AMT-CONV-CPF4.                                
                                                                                
           IF F300-AMT-MORT-CONVY-CPF1 NOT NUMERIC                              
              MOVE ZEROES TO F300-AMT-MORT-CONVY-CPF1.                          
           IF F300-AMT-MORT-CONVY-CPF2 NOT NUMERIC                              
              MOVE ZEROES TO F300-AMT-MORT-CONVY-CPF2.                          
           IF F300-AMT-MORT-CONVY-CPF3 NOT NUMERIC                              
              MOVE ZEROES TO F300-AMT-MORT-CONVY-CPF3.                          
           IF F300-AMT-MORT-CONVY-CPF4 NOT NUMERIC                              
              MOVE ZEROES TO F300-AMT-MORT-CONVY-CPF4.                          
                                                                                
           IF F300-AMT-CAVEAT-REGN-CPF1 NOT NUMERIC                             
              MOVE ZEROES TO F300-AMT-CAVEAT-REGN-CPF1.                         
           IF F300-AMT-CAVEAT-REGN-CPF2 NOT NUMERIC                             
              MOVE ZEROES TO F300-AMT-CAVEAT-REGN-CPF2.                         
           IF F300-AMT-CAVEAT-REGN-CPF3 NOT NUMERIC                             
              MOVE ZEROES TO F300-AMT-CAVEAT-REGN-CPF3.                         
           IF F300-AMT-CAVEAT-REGN-CPF4 NOT NUMERIC                             
              MOVE ZEROES TO F300-AMT-CAVEAT-REGN-CPF4.                         
                                                                                
           IF K671-AMT-SOC-CPF1-BAL NOT NUMERIC                                 
              MOVE ZEROES TO K671-AMT-SOC-CPF1-BAL.                             
           IF K671-AMT-SOC-CPF2-BAL NOT NUMERIC                                 
              MOVE ZEROES TO K671-AMT-SOC-CPF2-BAL.                             
           IF K671-AMT-SOC-CPF3-BAL NOT NUMERIC                                 
              MOVE ZEROES TO K671-AMT-SOC-CPF3-BAL.                             
           IF K671-AMT-SOC-CPF4-BAL NOT NUMERIC                                 
              MOVE ZEROES TO K671-AMT-SOC-CPF4-BAL.                             
                                                                                
           IF K671-AMT-LSE-STMP-CPF1-BAL NOT NUMERIC                            
              MOVE ZEROES TO K671-AMT-LSE-STMP-CPF1-BAL.                        
           IF K671-AMT-LSE-STMP-CPF2-BAL NOT NUMERIC                            
              MOVE ZEROES TO K671-AMT-LSE-STMP-CPF2-BAL.                        
           IF K671-AMT-LSE-STMP-CPF3-BAL NOT NUMERIC                            
              MOVE ZEROES TO K671-AMT-LSE-STMP-CPF3-BAL.                        
           IF K671-AMT-LSE-STMP-CPF4-BAL NOT NUMERIC                            
              MOVE ZEROES TO K671-AMT-LSE-STMP-CPF4-BAL.                        
                                                                                
           IF K671-AMT-SALE-CONVY-CPF1-BAL NOT NUMERIC                          
              MOVE ZEROES TO K671-AMT-SALE-CONVY-CPF1-BAL.                      
           IF K671-AMT-SALE-CONVY-CPF2-BAL NOT NUMERIC                          
              MOVE ZEROES TO K671-AMT-SALE-CONVY-CPF2-BAL.                      
           IF K671-AMT-SALE-CONVY-CPF3-BAL NOT NUMERIC                          
              MOVE ZEROES TO K671-AMT-SALE-CONVY-CPF3-BAL.                      
           IF K671-AMT-SALE-CONVY-CPF4-BAL NOT NUMERIC                          
              MOVE ZEROES TO K671-AMT-SALE-CONVY-CPF4-BAL.                      
                                                                                
           IF K671-AMT-MORT-CONVY-CPF1-BAL NOT NUMERIC                          
              MOVE ZEROES TO K671-AMT-MORT-CONVY-CPF1-BAL.                      
           IF K671-AMT-MORT-CONVY-CPF2-BAL NOT NUMERIC                          
              MOVE ZEROES TO K671-AMT-MORT-CONVY-CPF2-BAL.                      
           IF K671-AMT-MORT-CONVY-CPF3-BAL NOT NUMERIC                          
              MOVE ZEROES TO K671-AMT-MORT-CONVY-CPF3-BAL.                      
           IF K671-AMT-MORT-CONVY-CPF4-BAL NOT NUMERIC                          
              MOVE ZEROES TO K671-AMT-MORT-CONVY-CPF4-BAL.                      
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF1-BAL NOT NUMERIC                         
              MOVE ZEROES TO K671-AMT-CAVEAT-REGN-CPF1-BAL.                     
           IF K671-AMT-CAVEAT-REGN-CPF2-BAL NOT NUMERIC                         
              MOVE ZEROES TO K671-AMT-CAVEAT-REGN-CPF2-BAL.                     
           IF K671-AMT-CAVEAT-REGN-CPF3-BAL NOT NUMERIC                         
              MOVE ZEROES TO K671-AMT-CAVEAT-REGN-CPF3-BAL.                     
           IF K671-AMT-CAVEAT-REGN-CPF4-BAL NOT NUMERIC                         
              MOVE ZEROES TO K671-AMT-CAVEAT-REGN-CPF4-BAL.                     
                                                                                
       3705-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------*                
       3710-COMPUTE-BALANCE-CPF1.                                               
      *--------------------------------------------------------*                
                                                                                
           IF K671-AMT-SOC-CPF1-PAID > ZEROES                                   
              COMPUTE K671-AMT-SOC-CPF1-BAL =                                   
                K671-AMT-SOC-CPF1-PAID - F300-AMT-TOPUP-CPF1                    
              IF K671-AMT-SOC-CPF1-BAL > ZEROES                                 
                 MOVE K671-AMT-SOC-CPF1-BAL  TO WS-AMT-BALANCE                  
                 MOVE K671-AMT-SOC-CPF1-PAID TO WS-AMT-RECEIVED                 
                 MOVE F300-AMT-TOPUP-CPF1    TO WS-AMT-COLLECTED                
                 MOVE 1 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF1-PAID > ZEROES                              
              COMPUTE K671-AMT-LSE-STMP-CPF1-BAL =                              
                K671-AMT-LSE-STMP-CPF1-PAID - F300-AMT-LEASE-STAMP-CPF1         
              IF K671-AMT-LSE-STMP-CPF1-BAL > ZEROES                            
                 MOVE K671-AMT-LSE-STMP-CPF1-BAL  TO WS-AMT-BALANCE             
                 MOVE K671-AMT-LSE-STMP-CPF1-PAID TO WS-AMT-RECEIVED            
                 MOVE F300-AMT-LEASE-STAMP-CPF1   TO WS-AMT-COLLECTED           
                 MOVE 2 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF1-PAID > ZEROES                            
              COMPUTE K671-AMT-SALE-CONVY-CPF1-BAL =                            
                K671-AMT-SALE-CONVY-CPF1-PAID - F300-AMT-CONV-CPF1              
              IF K671-AMT-SALE-CONVY-CPF1-BAL > ZEROES                          
                 MOVE K671-AMT-SALE-CONVY-CPF1-BAL  TO WS-AMT-BALANCE           
                 MOVE K671-AMT-SALE-CONVY-CPF1-PAID TO WS-AMT-RECEIVED          
                 MOVE F300-AMT-CONV-CPF1            TO WS-AMT-COLLECTED         
                 MOVE 3 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF1-PAID > ZEROES                            
              COMPUTE K671-AMT-MORT-CONVY-CPF1-BAL =                            
                K671-AMT-MORT-CONVY-CPF1-PAID - F300-AMT-MORT-CONVY-CPF1        
              IF K671-AMT-MORT-CONVY-CPF1-BAL > ZEROES                          
                 MOVE K671-AMT-MORT-CONVY-CPF1-BAL TO WS-AMT-BALANCE            
                 MOVE K671-AMT-MORT-CONVY-CPF1-PAID TO WS-AMT-RECEIVED          
                 MOVE F300-AMT-MORT-CONVY-CPF1   TO WS-AMT-COLLECTED            
                 MOVE 4 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF1-PAID > ZEROES                           
              COMPUTE K671-AMT-CAVEAT-REGN-CPF1-BAL =                           
              K671-AMT-CAVEAT-REGN-CPF1-PAID - F300-AMT-CAVEAT-REGN-CPF1        
              IF K671-AMT-CAVEAT-REGN-CPF1-BAL > ZEROES                         
                 MOVE K671-AMT-CAVEAT-REGN-CPF1-BAL TO WS-AMT-BALANCE           
                 MOVE K671-AMT-CAVEAT-REGN-CPF1-PAID TO WS-AMT-RECEIVED         
                 MOVE F300-AMT-CAVEAT-REGN-CPF1   TO WS-AMT-COLLECTED           
                 MOVE 5 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3710-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------*                
       3720-COMPUTE-BALANCE-CPF2.                                               
      *--------------------------------------------------------*                
                                                                                
           IF K671-AMT-SOC-CPF2-PAID > ZEROES                                   
              COMPUTE K671-AMT-SOC-CPF2-BAL =                                   
                K671-AMT-SOC-CPF2-PAID - F300-AMT-TOPUP-CPF2                    
              IF K671-AMT-SOC-CPF2-BAL > ZEROES                                 
                 MOVE K671-AMT-SOC-CPF2-BAL  TO WS-AMT-BALANCE                  
                 MOVE K671-AMT-SOC-CPF2-PAID TO WS-AMT-RECEIVED                 
                 MOVE F300-AMT-TOPUP-CPF2    TO WS-AMT-COLLECTED                
                 MOVE 1 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF2-PAID > ZEROES                              
              COMPUTE K671-AMT-LSE-STMP-CPF2-BAL =                              
                K671-AMT-LSE-STMP-CPF2-PAID - F300-AMT-LEASE-STAMP-CPF2         
              IF K671-AMT-LSE-STMP-CPF2-BAL > ZEROES                            
                 MOVE K671-AMT-LSE-STMP-CPF2-BAL  TO WS-AMT-BALANCE             
                 MOVE K671-AMT-LSE-STMP-CPF2-PAID TO WS-AMT-RECEIVED            
                 MOVE F300-AMT-LEASE-STAMP-CPF2   TO WS-AMT-COLLECTED           
                 MOVE 2 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF2-PAID > ZEROES                            
              COMPUTE K671-AMT-SALE-CONVY-CPF2-BAL =                            
                K671-AMT-SALE-CONVY-CPF2-PAID - F300-AMT-CONV-CPF2              
              IF K671-AMT-SALE-CONVY-CPF2-BAL > ZEROES                          
                 MOVE K671-AMT-SALE-CONVY-CPF2-BAL  TO WS-AMT-BALANCE           
                 MOVE K671-AMT-SALE-CONVY-CPF2-PAID TO WS-AMT-RECEIVED          
                 MOVE F300-AMT-CONV-CPF2            TO WS-AMT-COLLECTED         
                 MOVE 3 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF2-PAID > ZEROES                            
              COMPUTE K671-AMT-MORT-CONVY-CPF2-BAL =                            
                K671-AMT-MORT-CONVY-CPF2-PAID - F300-AMT-MORT-CONVY-CPF2        
              IF K671-AMT-MORT-CONVY-CPF2-BAL > ZEROES                          
                 MOVE K671-AMT-MORT-CONVY-CPF2-BAL TO WS-AMT-BALANCE            
                 MOVE K671-AMT-MORT-CONVY-CPF2-PAID TO WS-AMT-RECEIVED          
                 MOVE F300-AMT-MORT-CONVY-CPF2   TO WS-AMT-COLLECTED            
                 MOVE 4 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF2-PAID > ZEROES                           
              COMPUTE K671-AMT-CAVEAT-REGN-CPF2-BAL =                           
              K671-AMT-CAVEAT-REGN-CPF2-PAID - F300-AMT-CAVEAT-REGN-CPF2        
              IF K671-AMT-CAVEAT-REGN-CPF2-BAL > ZEROES                         
                 MOVE K671-AMT-CAVEAT-REGN-CPF2-BAL TO WS-AMT-BALANCE           
                 MOVE K671-AMT-CAVEAT-REGN-CPF2-PAID TO WS-AMT-RECEIVED         
                 MOVE F300-AMT-CAVEAT-REGN-CPF2   TO WS-AMT-COLLECTED           
                 MOVE 5 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3720-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------*                
       3730-COMPUTE-BALANCE-CPF3.                                               
      *--------------------------------------------------------*                
                                                                                
           IF K671-AMT-SOC-CPF3-PAID > ZEROES                                   
              COMPUTE K671-AMT-SOC-CPF3-BAL =                                   
                K671-AMT-SOC-CPF3-PAID - F300-AMT-TOPUP-CPF3                    
              IF K671-AMT-SOC-CPF3-BAL > ZEROES                                 
                 MOVE K671-AMT-SOC-CPF3-BAL  TO WS-AMT-BALANCE                  
                 MOVE K671-AMT-SOC-CPF3-PAID TO WS-AMT-RECEIVED                 
                 MOVE F300-AMT-TOPUP-CPF3    TO WS-AMT-COLLECTED                
                 MOVE 1 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF3-PAID > ZEROES                              
              COMPUTE K671-AMT-LSE-STMP-CPF3-BAL =                              
                K671-AMT-LSE-STMP-CPF3-PAID - F300-AMT-LEASE-STAMP-CPF3         
              IF K671-AMT-LSE-STMP-CPF3-BAL > ZEROES                            
                 MOVE K671-AMT-LSE-STMP-CPF3-BAL  TO WS-AMT-BALANCE             
                 MOVE K671-AMT-LSE-STMP-CPF3-PAID TO WS-AMT-RECEIVED            
                 MOVE F300-AMT-LEASE-STAMP-CPF3   TO WS-AMT-COLLECTED           
                 MOVE 2 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF3-PAID > ZEROES                            
              COMPUTE K671-AMT-SALE-CONVY-CPF3-BAL =                            
                K671-AMT-SALE-CONVY-CPF3-PAID - F300-AMT-CONV-CPF3              
              IF K671-AMT-SALE-CONVY-CPF3-BAL > ZEROES                          
                 MOVE K671-AMT-SALE-CONVY-CPF3-BAL  TO WS-AMT-BALANCE           
                 MOVE K671-AMT-SALE-CONVY-CPF3-PAID TO WS-AMT-RECEIVED          
                 MOVE F300-AMT-CONV-CPF3            TO WS-AMT-COLLECTED         
                 MOVE 3 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF3-PAID > ZEROES                            
              COMPUTE K671-AMT-MORT-CONVY-CPF3-BAL =                            
                K671-AMT-MORT-CONVY-CPF3-PAID - F300-AMT-MORT-CONVY-CPF3        
              IF K671-AMT-MORT-CONVY-CPF3-BAL > ZEROES                          
                 MOVE K671-AMT-MORT-CONVY-CPF3-BAL TO WS-AMT-BALANCE            
                 MOVE K671-AMT-MORT-CONVY-CPF3-PAID TO WS-AMT-RECEIVED          
                 MOVE F300-AMT-MORT-CONVY-CPF3   TO WS-AMT-COLLECTED            
                 MOVE 4 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF3-PAID > ZEROES                           
              COMPUTE K671-AMT-CAVEAT-REGN-CPF3-BAL =                           
              K671-AMT-CAVEAT-REGN-CPF3-PAID - F300-AMT-CAVEAT-REGN-CPF3        
              IF K671-AMT-CAVEAT-REGN-CPF3-BAL > ZEROES                         
                 MOVE K671-AMT-CAVEAT-REGN-CPF3-BAL TO WS-AMT-BALANCE           
                 MOVE K671-AMT-CAVEAT-REGN-CPF3-PAID TO WS-AMT-RECEIVED         
                 MOVE F300-AMT-CAVEAT-REGN-CPF3   TO WS-AMT-COLLECTED           
                 MOVE 5 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3730-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------*                
       3740-COMPUTE-BALANCE-CPF4.                                               
      *--------------------------------------------------------*                
                                                                                
           IF K671-AMT-SOC-CPF4-PAID > ZEROES                                   
              COMPUTE K671-AMT-SOC-CPF4-BAL =                                   
                K671-AMT-SOC-CPF4-PAID - F300-AMT-TOPUP-CPF4                    
              IF K671-AMT-SOC-CPF4-BAL > ZEROES                                 
                 MOVE K671-AMT-SOC-CPF4-BAL  TO WS-AMT-BALANCE                  
                 MOVE K671-AMT-SOC-CPF4-PAID TO WS-AMT-RECEIVED                 
                 MOVE F300-AMT-TOPUP-CPF4    TO WS-AMT-COLLECTED                
                 MOVE 1 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K671-AMT-LSE-STMP-CPF4-PAID > ZEROES                              
              COMPUTE K671-AMT-LSE-STMP-CPF4-BAL =                              
                K671-AMT-LSE-STMP-CPF4-PAID - F300-AMT-LEASE-STAMP-CPF4         
              IF K671-AMT-LSE-STMP-CPF4-BAL > ZEROES                            
                 MOVE K671-AMT-LSE-STMP-CPF4-BAL  TO WS-AMT-BALANCE             
                 MOVE K671-AMT-LSE-STMP-CPF4-PAID TO WS-AMT-RECEIVED            
                 MOVE F300-AMT-LEASE-STAMP-CPF4   TO WS-AMT-COLLECTED           
                 MOVE 2 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K671-AMT-SALE-CONVY-CPF4-PAID > ZEROES                            
              COMPUTE K671-AMT-SALE-CONVY-CPF4-BAL =                            
                K671-AMT-SALE-CONVY-CPF4-PAID - F300-AMT-CONV-CPF4              
              IF K671-AMT-SALE-CONVY-CPF4-BAL > ZEROES                          
                 MOVE K671-AMT-SALE-CONVY-CPF4-BAL  TO WS-AMT-BALANCE           
                 MOVE K671-AMT-SALE-CONVY-CPF4-PAID TO WS-AMT-RECEIVED          
                 MOVE F300-AMT-CONV-CPF4            TO WS-AMT-COLLECTED         
                 MOVE 3 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K671-AMT-MORT-CONVY-CPF4-PAID > ZEROES                            
              COMPUTE K671-AMT-MORT-CONVY-CPF4-BAL =                            
                K671-AMT-MORT-CONVY-CPF4-PAID - F300-AMT-MORT-CONVY-CPF4        
              IF K671-AMT-MORT-CONVY-CPF4-BAL > ZEROES                          
                 MOVE K671-AMT-MORT-CONVY-CPF4-BAL TO WS-AMT-BALANCE            
                 MOVE K671-AMT-MORT-CONVY-CPF4-PAID TO WS-AMT-RECEIVED          
                 MOVE F300-AMT-MORT-CONVY-CPF4   TO WS-AMT-COLLECTED            
                 MOVE 4 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K671-AMT-CAVEAT-REGN-CPF4-PAID > ZEROES                           
              COMPUTE K671-AMT-CAVEAT-REGN-CPF4-BAL =                           
              K671-AMT-CAVEAT-REGN-CPF4-PAID - F300-AMT-CAVEAT-REGN-CPF4        
              IF K671-AMT-CAVEAT-REGN-CPF4-BAL > ZEROES                         
                 MOVE K671-AMT-CAVEAT-REGN-CPF4-BAL TO WS-AMT-BALANCE           
                 MOVE K671-AMT-CAVEAT-REGN-CPF4-PAID TO WS-AMT-RECEIVED         
                 MOVE F300-AMT-CAVEAT-REGN-CPF4   TO WS-AMT-COLLECTED           
                 MOVE 5 TO WS-CPF-TYPE                                          
                 PERFORM 5000-CONTROL-LIST-PRINT THRU 5000-EXIT                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3740-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------------           
       3750-REWRITE-BP13K671.                                                   
      *--------------------------------------------------------------           
           REWRITE BP13K671-REC.                                                
                                                                                
           EVALUATE WS-K671-STATUS                                              
              WHEN 00                                                           
                 ADD 1 TO WS-CNT-K671-REWR                                      
              WHEN 23                                                           
                 DISPLAY 'NOT FOUND IN BP13K671. REGN : ' F300-CUR-REG          
              WHEN OTHER                                                        
                 MOVE WS-K671-STATUS     TO RETURN-CODE                         
                 DISPLAY 'ERROR REWRITING BP13K671, STATUS = '                  
                                        WS-K671-STATUS                          
                 PERFORM 9000-CLOSE-ROUTINE  THRU 9000-EXIT                     
           END-EVALUATE.                                                        
                                                                                
                                                                                
       3750-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------*                
       4000-WRITE-F121.                                                         
      *--------------------------------------------------------*                
           MOVE SPACES                TO BP13F121-CPFTRAN.                      
           INITIALIZE                    BP13F121-CPFTRAN.                      
                                                                                
           MOVE F300-CUR-REG          TO F121-NUM-REGN.                         
           MOVE WS-SYSTEM-DATE        TO F121-DTE-POST.                         
           MOVE WS-DTE-CPF-POST       TO F121-DTE-TRANS.                        
           MOVE ZEROS                 TO F121-COUNT-HISTORY.                    
           MOVE WS-SOC-CPF            TO F121-AMT-RECIEPT.                      
           MOVE F300-SCH-ACC          TO F121-NUM-SCH-ACCT.                     
           MOVE '12'                  TO F121-CDE-TRANS-TYPE.                   
           MOVE 'SOC'                 TO F121-CDE-PAYMENT-TYPE.                 
           MOVE WS-NRIC               TO F121-NUM-NRIC.                         
           MOVE WS-CDE-APPLT-CPF      TO F121-CDE-APPLT-CPF.                    
                                                                                
           IF K671-NUM-HBL-TYP = '2'                                            
              MOVE 'BANK LOAN CPF2'   TO F121-NUM-RECPT-JRNO                    
           ELSE                                                                 
              MOVE 'BANK LOAN CPF1'   TO F121-NUM-RECPT-JRNO                    
           END-IF.                                                              
                                                                                
           WRITE BP13F121-CPFTRAN.                                              
                                                                                
           ADD 1 TO WS-CNT-F121-WRITE.                                          
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *--------------------------------------------------------------           
       5000-CONTROL-LIST-PRINT.                                                 
      *--------------------------------------------------------------           
           IF WS-CNT-CASES > 50                                                 
              PERFORM 5100-PRINT-HEADING THRU 5100-EXIT.                        
                                                                                
           MOVE SPACES TO L357-DETAILS.                                         
           INITIALIZE     L357-DETAILS.                                         
                                                                                
           ADD 1                        TO WS-CNT-CASES                         
                                           WS-CNT-PRINTED.                      
           MOVE WS-CNT-PRINTED          TO L357-SNO.                            
           MOVE F300-CUR-REG            TO L357-REGN-NO.                        
           MOVE WS-CPF-NO               TO L357-CPF-NO.                         
           EVALUATE WS-CPF-TYPE                                                 
             WHEN 1                                                             
                MOVE 'IDP'              TO L357-CPF-TYPE                        
             WHEN 2                                                             
                MOVE 'LEASE STAMP'      TO L357-CPF-TYPE                        
             WHEN 3                                                             
                MOVE 'SALE CF'          TO L357-CPF-TYPE                        
             WHEN 4                                                             
                MOVE 'MORTGAGE CF'      TO L357-CPF-TYPE                        
             WHEN 5                                                             
                MOVE 'CAVEAT REGN'      TO L357-CPF-TYPE                        
           END-EVALUATE.                                                        
           MOVE WS-AMT-RECEIVED         TO L357-AMT-RECEIVED.                   
           MOVE WS-AMT-COLLECTED        TO L357-AMT-COLLECTED.                  
           MOVE WS-AMT-BALANCE          TO L357-AMT-BALANCE.                    
           WRITE L357-REC FROM L357-DETAILS AFTER 1.                            
                                                                                
       5000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *--------------------------------------------------------------           
       5100-PRINT-HEADING.                                                      
      *--------------------------------------------------------------           
            ADD 1                 TO WS-CNT-PAGE.                               
            MOVE ZERO             TO WS-CNT-CASES.                              
            MOVE WS-CNT-PAGE      TO L357-PAGE-NO.                              
            MOVE SPACES           TO L357-REC.                                  
            WRITE L357-REC  FROM L357-HEADER1 AFTER PAGE.                       
            WRITE L357-REC  FROM L357-HEADER2 AFTER 2.                          
            WRITE L357-REC  FROM L357-HEADER3 AFTER 2.                          
            INSPECT L357-REC REPLACING CHARACTERS BY '-'.                       
            WRITE L357-REC.                                                     
            MOVE SPACES TO L357-REC.                                            
            WRITE L357-REC AFTER 2.                                             
                                                                                
       5100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *--------------------------------------------------------*                
       9000-CLOSE-ROUTINE.                                                      
      *--------------------------------------------------------*                
           IF WS-CNT-PRINTED = ZEROES                                           
              MOVE SPACES TO L357-REC                                           
              WRITE L357-REC FROM L357-EMPTY AFTER 3.                           
                                                                                
           CLOSE BP13F300                                                       
                 BP13F121                                                       
                 SY02F001                                                       
                 BP13K671                                                       
                 BP13L357.                                                      
                                                                                
           EVALUATE WS-K671-STATUS                                              
              WHEN 00                                                           
              WHEN 97                                                           
                 CONTINUE                                                       
              WHEN OTHER                                                        
                 MOVE WS-K671-STATUS TO RETURN-CODE                             
                 DISPLAY 'BP13K671 CLOSE ERROR, STATUS='                        
                                                WS-K671-STATUS                  
           END-EVALUATE.                                                        
                                                                                
           DISPLAY '******  BP13C357 *************'.                            
           DISPLAY 'DATE : ' WS-EDITED-DATE.                                    
           DISPLAY SPACE.                                                       
           DISPLAY 'NO OF F300 READ     : ' WS-CNT-F300-READ.                   
           DISPLAY 'NO OF F121 WRITE    : ' WS-CNT-F121-WRITE.                  
           DISPLAY 'NO OF K671 FOUND    : ' WS-CNT-K671-FND.                    
           DISPLAY 'NO OF K671 NOT FOUND: ' WS-CNT-K671-NFND.                   
           DISPLAY 'NO OF K671 REWRITTEN: ' WS-CNT-K671-REWR.                   
           DISPLAY 'NO OF L357 PRINTED  : ' WS-CNT-PRINTED.                     
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
