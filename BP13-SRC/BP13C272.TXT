       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C272.                                                 
      *AUTHOR.        SIA.                                                      
      *DATE-WRITTEN.  11/03/97.                                                 
      * =========================================================== *           
      * SYSTEM OF COMMITMENT (BP13)                                 *           
      * =========================================================== *           
      *                                                             *           
      *  OBJECTIVE : TO PRINT LETTERS FOR SALES                     *           
      *              WHERE F838-NUM-AMIS    = '3' OR '4' OR         *           
      *                                       '5' OR '6'.           *           
      *  AMIS = '3' OR '4' - FOR FRESH REGISTRATION CASES NOT IN    *           
      *                      SOC MASTER.                            *           
      *  AMIS = '5' OR '6' - FOR MATURE NEW TOWN APPLICATIONS.      *           
      *                                                             *           
      *  INPUT FILES                                                *           
      *      BP13F838  --                                           *           
      *      BP13K825  --                                           *           
      *                                                             *           
      *  OUTPUT                                                     *           
      *      P13P272B  -- LETTER FOR CORR ADDR                      *           
      *      P13P272C  -- LETTER FOR CORR ADDR (COPY)               *           
      *      P13P272D  -- LETTER W/O CORR ADDR                      *           
      *      P13P272E  -- LETTER W/O CORR ADDR (COPY)               *           
      *                                                             *           
      *      P13L272B  -- SUMMARY REPORT FOR LETTER FOR CORR ADDR   *           
      *      P13L272C  -- SUMMARY REPORT FOR LETTER W/O CORR ADDR   *           
      *                                                             *           
      * ----------------------------------------------------------- *           
      * CHG REF  DATE     OIC  REMARKS                              *           
      * -------- -------- ---  -------                              *           
      * BP130251 19970311 SIA  NEW PGM                              *           
      * BP130251 19970819 LMS  PRINT LETTERS FOR REQUEST.           *           
      * BP130383 19980109 LMS  CHG IN BP13K838 LAYOUT               *           
      * BP132038 20011208 JAM  REMOVE RESPONSE SLIP FROM BP13H2     *           
      *                        & CREATE A SEPARATE FORM BP13H5      *           
      *                        USE CYCLEFORMS TO PRINT.             *           
      * BP132127 20020603 CKK  CHANGE LETTER LAYOUT                 *           
      * BP132551 20040811 SSS  ALIGN BP13H1                         *           
      * BP132545 20041109 SSS  +1 LINE FOR HA1 NAME                 *           
      * BP132626 20041209 CKK  CHANGE ALIGNMENT                     *           
      * BP134779 20130221 IL5  CHANGE SALES OPERATIONS UNIT TO      *           
      *                        SALES OPERATIONS SECTION             *           
      * BP137986 20190905 CC37 CHANGE IN LAYOUT OF FORMS            *           
      * BP137986 20200106 CC37 TO REMOVE PRINTING OF BE0201 FORM    *           
      * =========================================================== *           
                                                                                
       ENVIRONMENT DIVISION.                                                    
      *-------------------------------------------------------------            
                                                                                
       CONFIGURATION SECTION.                                                   
      *-------------------------------------------------------------            
       SOURCE-COMPUTER.   IBM-3090.                                             
       OBJECT-COMPUTER.   IBM-3090.                                             
                                                                                
                                                                                
       INPUT-OUTPUT SECTION.                                                    
      *-------------------------------------------------------------            
       FILE-CONTROL.                                                            
      *-------------------------------------------------------------            
           SELECT BP13F838 ASSIGN TO BP13F838.                                  
                                                                                
           SELECT BP13K825 ASSIGN TO BP13TMP                                    
                        ACCESS MODE          IS RANDOM                          
                        ORGANIZATION         IS INDEXED                         
                        RECORD KEY           IS K825-KEY-FLD                    
                        ALTERNATE RECORD KEY IS K825-NUM-NRIC                   
                                                WITH DUPLICATES                 
                        FILE STATUS          IS WS-K825-STATUS.                 
                                                                                
           SELECT BP13K830 ASSIGN TO BP13K830                                   
                        ACCESS MODE          IS RANDOM                          
                        ORGANIZATION         IS INDEXED                         
                        RECORD KEY           IS K830-KEY-FLD                    
                        ALTERNATE RECORD KEY IS K830-NUM-REGN                   
                                                WITH DUPLICATES                 
                        FILE STATUS          IS WS-K830-STATUS.                 
                                                                                
           SELECT P13P272B ASSIGN TO P13P272B.                                  
           SELECT P13P272C ASSIGN TO P13P272C.                                  
           SELECT P13P272D ASSIGN TO P13P272D.                                  
           SELECT P13P272E ASSIGN TO P13P272E.                                  
                                                                                
           SELECT P13L272B ASSIGN TO P13L272B.                                  
           SELECT P13L272C ASSIGN TO P13L272C.                                  
                                                                                
                                                                                
      *-------------------------------------------------------------            
       DATA DIVISION.                                                           
      *-------------------------------------------------------------            
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
                                                                                
       FD  BP13K825                                                             
               RECORD CONTAINS 200 CHARACTERS.                                  
       COPY BP13K825.                                                           
                                                                                
       FD  BP13K830                                                             
               RECORD CONTAINS 250 CHARACTERS.                                  
       COPY BP13K830.                                                           
                                                                                
       FD  BP13F838                                                             
               RECORD CONTAINS 400 CHARACTERS                                   
               BLOCK CONTAINS 0 RECORDS                                         
               LABEL RECORDS ARE STANDARD                                       
               RECORDING MODE IS F.                                             
       COPY BP13F838.                                                           
                                                                                
       FD  P13P272B                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 80 CHARACTERS                                        
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F.                                                 
       01  P13P272B-REC                 PIC X(80).                              
                                                                                
       FD  P13P272C                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 80 CHARACTERS                                        
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F.                                                 
       01  P13P272C-REC                 PIC X(80).                              
                                                                                
       FD  P13P272D                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 80 CHARACTERS                                        
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F.                                                 
       01  P13P272D-REC                 PIC X(80).                              
                                                                                
       FD  P13P272E                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 80 CHARACTERS                                        
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F.                                                 
       01  P13P272E-REC                 PIC X(80).                              
                                                                                
       FD  P13L272B                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F.                                                 
       01  P13L272B-REC                PIC X(132).                              
                                                                                
       FD  P13L272C                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F.                                                 
       01  P13L272C-REC                PIC X(132).                              
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
       COPY AV02COMM.                                                           
                                                                                
       01  WS-DATE                     PIC X(8)  VALUE SPACES.                  
       01  WS-K825-FOUND               PIC X      VALUE  'N'.                   
       01  WS-K830-FOUND               PIC X      VALUE  'N'.                   
       01  WS-NUM-COUNT                PIC 9      VALUE  ZEROS.                 
                                                                                
       01  EOF-BP13F838                PIC X      VALUE  'N'.                   
                                                                                
       01  WS-K825-STATUS                 PIC 9(2) VALUE ZEROS.                 
       01  WS-K830-STATUS                 PIC 9(2) VALUE ZEROS.                 
                                                                                
      *--------*                                                                
      * COUNTS *                                                                
      *--------*                                                                
       01  WS-F838-READ                    PIC 9(6)  VALUE  ZEROS.              
       01  WS-K825-DUP                     PIC 9(6)  VALUE  ZEROS.              
       01  WS-K825-BYPASS                  PIC 9(6)  VALUE  ZEROS.              
       01  WS-K825-2ND-READ                PIC 9(6)  VALUE  ZEROS.              
       01  WS-K825-READ                    PIC 9(6)  VALUE  ZEROS.              
       01  WS-K830-READ                    PIC 9(6)  VALUE  ZEROS.              
       01  WS-K830-NOTFND                  PIC 9(6)  VALUE  ZEROS.              
       01  WS-P272B-WRITTEN                PIC 9(6)  VALUE  ZEROS.              
       01  WS-P272C-WRITTEN                PIC 9(6)  VALUE  ZEROS.              
       01  WS-P272D-WRITTEN                PIC 9(6)  VALUE  ZEROS.              
       01  WS-P272E-WRITTEN                PIC 9(6)  VALUE  ZEROS.              
                                                                                
       01  WS-L272B-WRITTEN                PIC 9(5)  VALUE  ZEROS.              
       01  WS-PG-CNT-L272B                 PIC 999   VALUE  ZEROS.              
       01  WS-COUNT-L272B                  PIC 9(2)  VALUE  55.                 
       01  WS-SNO-L272B                    PIC 9(6)  VALUE  ZEROS.              
                                                                                
       01  WS-L272C-WRITTEN                PIC 9(5)  VALUE  ZEROS.              
       01  WS-PG-CNT-L272C                 PIC 999   VALUE  ZEROS.              
       01  WS-COUNT-L272C                  PIC 9(2)  VALUE  55.                 
       01  WS-SNO-L272C                    PIC 9(6)  VALUE  ZEROS.              
                                                                                
      *-------------------------------------------------------------            
      * PRINT LETTER.                                                           
      *-------------------------------------------------------------            
                                                                                
       01  WS-DJDE-HDBREF.                                                      
           05  FILLER                      PIC X(11) VALUE SPACES.              
           05  WS-DJDE-NT-ZONE             PIC X(3)  VALUE SPACES.              
           05  WS-DJDE-FLAT-TYPE           PIC X(2)  VALUE SPACES.              
           05  WS-DJDE-HDBREF-SLASH        PIC X     VALUE  '/'.                
           05  WS-DJDE-REGN                PIC X(8)  VALUE SPACES.              
                                                                                
       01  WS-DJDE-HDBREF-COPY.                                                 
           05  FILLER                      PIC X(11) VALUE SPACES.              
           05  WS-DJDE-COPY                PIC X(07) VALUE SPACES.              
           05  FILLER                      PIC X(02) VALUE SPACES.              
           05  WS-DJDE-NT-ZONE-COPY        PIC X(3)  VALUE SPACES.              
           05  WS-DJDE-FLAT-TYPE-COPY      PIC X(2)  VALUE SPACES.              
           05  WS-DJDE-HDBREF-SLASH-COPY   PIC X     VALUE  '/'.                
           05  WS-DJDE-REGN-COPY           PIC X(8)  VALUE SPACES.              
                                                                                
       01  WS-BP13H-DTE.                                                        
           05  FILLER                      PIC X(02) VALUE SPACES.              
           05  BP13H-LTR-DTE               PIC X(10) VALUE SPACES.              
                                                                                
       01  WS-BP13H5-DTE.                                                       
           05  FILLER                      PIC X(31) VALUE SPACES.              
           05  BP13H5-LTR-DTE              PIC X(10) VALUE SPACES.              
                                                                                
       01  WS-BP13H-NAME1.                                                      
           05 FILLER                       PIC X(02) VALUE SPACES.              
           05 WS-DJDE-NAME1                PIC X(52) VALUE SPACES.              
           05 WS-DJDE-NAME1-LABEL          PIC X(14) VALUE SPACES.              
                                                                                
       01  WS-BP13H-NAME2.                                                      
           05 FILLER                       PIC X(02) VALUE SPACES.              
           05 WS-DJDE-NAME2                PIC X(52) VALUE SPACES.              
           05 WS-DJDE-NAME2-LABEL          PIC X(14) VALUE SPACES.              
                                                                                
       01  WS-DJDE-PRT-HDG-A.                                                   
           05 FILLER                       PIC X(02) VALUE SPACES.              
           05 WS-DJDE-BLK-NO               PIC X(10) VALUE SPACES.              
           05 FILLER                       PIC X(1)  VALUE SPACES.              
           05 WS-DJDE-NUM-FLAT.                                                 
              10 WS-DJDE-CHAR              PIC X     VALUE SPACE.               
              10 WS-DJDE-LEVEL             PIC X(2)  VALUE SPACES.              
              10 WS-DJDE-DASH              PIC X     VALUE SPACE.               
              10 WS-DJDE-HSE-MAIN          PIC X(4)  VALUE SPACES.              
              10 WS-DJDE-HSE-SUB           PIC X(3)  VALUE SPACES.              
                                                                                
       01  WS-DJDE-PRT-HDG-B.                                                   
           05 FILLER                       PIC X(02) VALUE SPACES.              
           05 WS-DJDE-STREET-NAME          PIC X(65) VALUE SPACES.              
                                                                                
       01  WS-DJDE-PRT-HDG-C.                                                   
           05 FILLER                       PIC X(02) VALUE SPACES.              
           05  WS-DJDE-CODE                PIC X(16) VALUE SPACES.              
                                                                                
       01  WS-DJDE-PRT-HDG-D.                                                   
           05 FILLER                       PIC X(10) VALUE SPACES.              
           05  WS-DJDE-BARCODE             PIC X(09) VALUE SPACES.              
                                                                                
       01  WS-HDB-UNIT.                                                         
           05 FILLER                       PIC X(02) VALUE SPACES.              
           05 FILLER                       PIC X(52) VALUE                      
              'SALES OPERATIONS SECTION'.                                       
           05 FILLER                       PIC X(14) VALUE SPACES.              
                                                                                
       01  WS-HDB-NAME.                                                         
           05 FILLER                       PIC X(06) VALUE SPACES.              
           05 FILLER                       PIC X(52) VALUE                      
              'HOUSING AND DEVELOPMENT BOARD'.                                  
           05 FILLER                       PIC X(14) VALUE SPACES.              
                                                                                
       01  WS-HDB-CENTER.                                                       
           05 FILLER                       PIC X(06) VALUE SPACES.              
           05 FILLER                       PIC X(30) VALUE                      
              'ATRIUM 1ST STOREY, HDB HUB'.                                     
           05 FILLER                       PIC X(12) VALUE SPACES.              
                                                                                
       01  WS-HDB-ADDR1.                                                        
           05 FILLER                       PIC X(06) VALUE SPACES.              
           05 FILLER                       PIC X(65) VALUE                      
              '480 LORONG 6 TOA PAYOH'.                                         
                                                                                
       01  WS-HDB-POSTAL.                                                       
           05 FILLER                       PIC X(06) VALUE SPACES.              
           05 FILLER                       PIC X(16) VALUE                      
              'SINGAPORE 310480'.                                               
                                                                                
       01  WS-HDB-BARCODE.                                                      
           05 FILLER                       PIC X(10) VALUE SPACES.              
           05 WS-HDB-BAR                   PIC X(9)  VALUE SPACES.              
                                                                                
       01  WS-NEW-ADDRESS.                                                      
           05  WS-BP13H-NEW-ADDR-INFO1.                                         
               10  FILLER                  PIC X(02) VALUE SPACES.              
               10  WS-DJDE-NEW-NUM-BLK     PIC X(10) VALUE SPACES.              
               10  FILLER                  PIC X     VALUE SPACE.               
               10  WS-DJDE-NEW-FLAT.                                            
                   15 WS-DJDE-NEW-CHAR     PIC X     VALUE SPACE.               
                   15 WS-DJDE-NEW-NUM-LVL  PIC X(03) VALUE SPACES.              
                   15 WS-DJDE-NEW-DASH     PIC X     VALUE SPACE.               
                   15 WS-DJDE-NEW-NUM-UNIT PIC X(05) VALUE SPACES.              
           05  WS-BP13H-NEW-ADDR-INFO2.                                         
               10  FILLER                  PIC X(02) VALUE SPACES.              
               10  WS-DJDE-NEW-STREET-NME  PIC X(20) VALUE SPACES.              
           05  WS-BP13H-NEW-ADDR-INFO3.                                         
               10  FILLER                  PIC X(02) VALUE SPACES.              
               10  WS-DJDE-NEW-POSTAL-CDE  PIC X(16) VALUE SPACES.              
           05  WS-BP13H-NEW-ADDR-INFO4.                                         
               10  FILLER                  PIC X(02) VALUE SPACES.              
               10  WS-DJDE-NEW-BARCODE     PIC X(09) VALUE SPACES.              
                                                                                
       01  WS-DJDE-NRIC.                                                        
           05  FILLER                      PIC X(08) VALUE SPACES.              
           05  WS-DJDE-NRIC1               PIC X(09) VALUE SPACES.              
           05 FILLER                       PIC X(11) VALUE SPACES.              
           05  WS-DJDE-NRIC2               PIC X(09) VALUE SPACES.              
           05 FILLER                       PIC X(11) VALUE SPACES.              
           05  WS-DJDE-NRIC3               PIC X(09) VALUE SPACES.              
           05 FILLER                       PIC X(11) VALUE SPACES.              
           05  WS-DJDE-NRIC4               PIC X(09) VALUE SPACES.              
           05 FILLER                       PIC X(03) VALUE SPACES.              
                                                                                
       01  WS-DETAIL-LINE.                                                      
           05  WS-REGN               PIC X(8)    VALUE SPACES.                  
           05  WS-NAME1              PIC X(40)   VALUE SPACES.                  
           05  WS-OLD-RES-ADDR.                                                 
               10  WS-BLK-RES-O      PIC X(10)   VALUE SPACES.                  
               10  FILLER            PIC X(1)    VALUE SPACES.                  
               10  WS-NUM-FLAT-O.                                               
                   15  WS-CHAR-O     PIC X       VALUE SPACE.                   
                   15  WS-LEVEL-O    PIC X(2)    VALUE SPACES.                  
                   15  WS-DASH-O     PIC X       VALUE SPACE.                   
                   15  WS-HSE-MAIN-O PIC X(4)    VALUE SPACES.                  
                   15  WS-HSE-SUB-O  PIC X(3)    VALUE SPACES.                  
           05  WS-NEW-RES-ADDR.                                                 
               10  WS-BLK-RES-N      PIC X(10)   VALUE SPACES.                  
               10  FILLER            PIC X(1)    VALUE SPACES.                  
               10  WS-NUM-FLAT-N.                                               
                   15  WS-CHAR-N     PIC X       VALUE SPACE.                   
                   15  WS-LEVEL-N    PIC X(3)    VALUE SPACES.                  
                   15  WS-DASH-N     PIC X       VALUE SPACE.                   
                   15  WS-HSE-MAIN-N PIC X(5)    VALUE SPACES.                  
           05  WS-CORR-ADDR.                                                    
               10  WS-BLK-CORR          PIC X(10)   VALUE SPACES.               
               10  FILLER               PIC X(1)    VALUE SPACES.               
               10  WS-NUM-FLAT-CORR.                                            
                   15  WS-CHAR-CORR     PIC X       VALUE SPACE.                
                   15  WS-LEVEL-CORR    PIC X(2)    VALUE SPACES.               
                   15  WS-DASH-CORR     PIC X       VALUE SPACE.                
                   15  WS-HSE-MAIN-CORR PIC X(4)    VALUE SPACES.               
                   15  WS-HSE-SUB-CORR  PIC X(3)    VALUE SPACES.               
                                                                                
       01  WS-RES-ADDR2.                                                        
           05  WS-NAME2              PIC X(40)   VALUE SPACES.                  
           05  WS-NME-STREET-O       PIC X(20)   VALUE SPACES.                  
           05  WS-NME-STREET-N       PIC X(20)   VALUE SPACES.                  
           05  WS-NME-STREET-CORR    PIC X(20)   VALUE SPACES.                  
                                                                                
       01  WS-RES-ADDR3.                                                        
           05  WS-NUM-POSTAL-O       PIC X(9)    VALUE SPACES.                  
           05  WS-NUM-POSTAL-N       PIC X(9)    VALUE SPACES.                  
           05  WS-NUM-POSTAL-CORR    PIC X(9)    VALUE SPACES.                  
                                                                                
      *-------------------------------------------------------------            
      * FOR DJDE PRINTING.                                                      
      *-------------------------------------------------------------            
       01  WS-DJDE-INFO                   PIC X(100) VALUE                      
           '$DJDE$ FORMS=BE0201,END;'.                                          
                                                                                
       01  WS-DJDE-BP13H1                 PIC X(80) VALUE                       
           '$DJDE$ JDE=13C24U,FORMS=BP13H1,COPIES=1,COLLATE=YES,JDL=BP13        
      -    ',DUPLEX=NO,END;'.                                                   
                                                                                
       01  WS-DJDE-BP13H2                 PIC X(80) VALUE                       
           '$DJDE$ JDE=13C24U,FORMS=BP13H2,COPIES=1,COLLATE=YES,JDL=BP13        
      -    ',DUPLEX=NO,END;'.                                                   
                                                                                
       01  WS-DJDE-BLANKF                 PIC X(80)   VALUE                     
           '$DJDE$ FORMS=BLANKF,SHIFT=(0,0),END;'.                              
                                                                                
      *-------------------------------------------------------------            
      * HEADER LINES FOR REPORT P13L272                                         
      *-------------------------------------------------------------            
       01  L272-PR-HEAD-01.                                                     
           05  L272-HEADER              PIC X(8)    VALUE SPACES.               
           05  FILLER                   PIC X(7)    VALUE SPACES .              
           05  FILLER                   PIC X(8)    VALUE 'HDBCAT 3'.           
           05  FILLER                   PIC X(21)   VALUE SPACES.               
           05  FILLER                   PIC X(39)   VALUE                       
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                   PIC X(17)   VALUE SPACES.               
           05  FILLER                   PIC X(7)    VALUE 'DATE :'.             
           05  L272-PRT-DTE             PIC X(10)   VALUE SPACES.               
           05  FILLER                   PIC X(3)    VALUE SPACES.               
           05  FILLER                   PIC X(7)    VALUE 'PAGE : '.            
           05  L272-PAGE-NO             PIC ZZ9.                                
                                                                                
       01  L272B-PR-HEAD-02.                                                    
           05  FILLER                   PIC X(37)   VALUE SPACES .              
           05  FILLER                   PIC X(49)   VALUE                       
               'SUMMARY REPORT OF LETTERS PRINTED WITH CORR ADDR'.              
                                                                                
       01  L272C-PR-HEAD-02.                                                    
           05  FILLER                   PIC X(30)   VALUE SPACES .              
           05  FILLER                   PIC X(47)   VALUE                       
           'SUMMARY REPORT OF LETTERS PRINTED W/O CORR ADDR'.                   
           05  FILLER                   PIC X(21)   VALUE                       
           ' BUT WITH BALLOT DATE'.                                             
                                                                                
       01  L272C-PR-HEAD-03.                                                    
           05  FILLER                   PIC X(24)   VALUE                       
               'S/NO REGN NO   APPLICANT'.                                      
           05  FILLER                   PIC X(45)   VALUE SPACES.               
           05  FILLER                   PIC X(33)   VALUE                       
               'OLD RESIDENTIAL ADDRESS         '.                              
           05  FILLER                   PIC X(23)   VALUE                       
               'NEW RESIDENTIAL ADDRESS'.                                       
           05  FILLER                   PIC X(8)    VALUE SPACES.               
                                                                                
       01  L272B-PR-HEAD-03.                                                    
           05  FILLER                   PIC X(24)   VALUE                       
               'S/NO REGN NO   APPLICANT'.                                      
           05  FILLER                   PIC X(33)   VALUE SPACES.               
           05  FILLER                   PIC X(24)   VALUE                       
               'OLD RESIDENTIAL'.                                               
           05  FILLER                   PIC X(24)   VALUE                       
               'NEW RESIDENTIAL'.                                               
           05  FILLER                   PIC X(24)   VALUE                       
               'CORRESPONDENCE '.                                               
                                                                                
       01  L272B-PR-HEAD-04.                                                    
           05  FILLER                   PIC X(57)   VALUE SPACES.               
           05  FILLER                   PIC X(24)   VALUE                       
               'ADDRESS'.                                                       
           05  FILLER                   PIC X(24)   VALUE                       
               'ADDRESS'.                                                       
           05  FILLER                   PIC X(24)   VALUE                       
               'ADDRESS'.                                                       
                                                                                
      *-------------------------------------------------------------            
      * DETAIL LINE FOR REPORT P13L272B                                         
      *-------------------------------------------------------------            
       01  L272B-PR-DETAILS.                                                    
           05  L272B-SNO                PIC ZZZ9.                               
           05  FILLER                   PIC X       VALUE SPACES.               
           05  L272B-REGN               PIC X(8)    VALUE SPACES.               
           05  FILLER                   PIC X(2)    VALUE SPACES.               
           05  L272B-NAME1              PIC X(40)   VALUE SPACES.               
           05  FILLER                   PIC X(2)    VALUE SPACES.               
           05  L272B-OLD-RES-ADDR.                                              
               10  L272B-BLK-RES-O      PIC X(10)   VALUE SPACES.               
               10  FILLER               PIC X       VALUE SPACES.               
               10  L272B-NUM-FLAT-O.                                            
                   15  L272B-CHAR-O     PIC X       VALUE SPACE.                
                   15  L272B-LEVEL-O    PIC X(2)    VALUE SPACES.               
                   15  L272B-DASH-O     PIC X       VALUE SPACE.                
                   15  L272B-HSE-MAIN-O PIC X(4)    VALUE SPACES.               
                   15  L272B-HSE-SUB-O  PIC X(3)    VALUE SPACES.               
           05  FILLER                   PIC X(2)    VALUE SPACES.               
           05  L272B-NEW-RES-ADDR.                                              
               10  L272B-BLK-RES-N      PIC X(10)   VALUE SPACES.               
               10  FILLER               PIC X       VALUE SPACE.                
               10  L272B-NUM-FLAT-N.                                            
                   15  L272B-CHAR-N     PIC X       VALUE SPACE.                
                   15  L272B-LEVEL-N    PIC X(3)    VALUE SPACES.               
                   15  L272B-DASH-N     PIC X       VALUE SPACE.                
                   15  L272B-HSE-MAIN-N PIC X(5)    VALUE SPACES.               
           05  FILLER                   PIC X(3)    VALUE SPACES.               
           05  L272B-CORR-ADDR.                                                 
               10  L272B-BLK-CORR       PIC X(10)   VALUE SPACES.               
               10  FILLER               PIC X       VALUE SPACE.                
               10  L272B-NUM-FLAT-CORR.                                         
                   15  L272B-CHAR-CORR     PIC X       VALUE SPACE.             
                   15  L272B-LEVEL-CORR    PIC X(3)    VALUE SPACES.            
                   15  L272B-DASH-CORR     PIC X       VALUE SPACE.             
                   15  L272B-HSE-MAIN-CORR PIC X(5)    VALUE SPACES.            
                                                                                
       01  L272B-RES-ADDR2.                                                     
           05  FILLER                   PIC X(15)   VALUE SPACES.               
           05  L272B-NAME2              PIC X(40)   VALUE SPACES.               
           05  FILLER                   PIC X(2)    VALUE SPACES.               
           05  L272B-NME-STREET-O       PIC X(20)   VALUE SPACES.               
           05  FILLER                   PIC X(4)    VALUE SPACES.               
           05  L272B-NME-STREET-N       PIC X(20)   VALUE SPACES.               
           05  FILLER                   PIC X(4)    VALUE SPACES.               
           05  L272B-NME-STREET-CORR    PIC X(20)   VALUE SPACES.               
                                                                                
       01  L272B-RES-ADDR3.                                                     
           05  FILLER                   PIC X(57)   VALUE SPACES.               
           05  L272B-NUM-POSTAL-O       PIC X(9)    VALUE SPACES.               
           05  FILLER                   PIC X(15)   VALUE SPACES.               
           05  L272B-NUM-POSTAL-N       PIC X(9)    VALUE SPACES.               
           05  FILLER                   PIC X(15)   VALUE SPACES.               
           05  L272B-NUM-POSTAL-CORR    PIC X(9)    VALUE SPACES.               
                                                                                
      *-------------------------------------------------------------            
      * DETAIL LINE FOR REPORT P13L272C                                         
      *-------------------------------------------------------------            
       01  L272C-PR-DETAILS.                                                    
           05  L272C-SNO                PIC ZZZ9.                               
           05  FILLER                   PIC X(1)    VALUE SPACES.               
           05  L272C-REGN               PIC X(8)    VALUE SPACES.               
           05  FILLER                   PIC X(2)    VALUE SPACES.               
           05  L272C-NAME1              PIC X(52)   VALUE SPACES.               
           05  FILLER                   PIC X(2)    VALUE SPACES.               
           05  L272C-OLD-RES-ADDR.                                              
               10  L272C-BLK-RES-O      PIC X(10)   VALUE SPACES.               
               10  FILLER               PIC X(1)    VALUE SPACES.               
               10  L272C-NUM-FLAT-O.                                            
                   15  L272C-CHAR-O     PIC X       VALUE SPACE.                
                   15  L272C-LEVEL-O    PIC X(2)    VALUE SPACES.               
                   15  L272C-DASH-O     PIC X       VALUE SPACE.                
                   15  L272C-HSE-MAIN-O PIC X(4)    VALUE SPACES.               
                   15  L272C-HSE-SUB-O  PIC X(3)    VALUE SPACES.               
           05  FILLER                   PIC X(11)   VALUE SPACES.               
           05  L272C-NEW-RES-ADDR.                                              
               10  L272C-BLK-RES-N      PIC X(10)   VALUE SPACES.               
               10  FILLER               PIC X(1)    VALUE SPACE.                
               10  L272C-NUM-FLAT-N.                                            
                   15  L272C-CHAR-N     PIC X       VALUE SPACE.                
                   15  L272C-LEVEL-N    PIC X(3)    VALUE SPACES.               
                   15  L272C-DASH-N     PIC X       VALUE SPACE.                
                   15  L272C-HSE-MAIN-N PIC X(5)    VALUE SPACES.               
                                                                                
       01  L272C-RES-ADDR2.                                                     
           05  FILLER                   PIC X(15)   VALUE SPACES.               
           05  L272C-NAME2              PIC X(52)   VALUE SPACES.               
           05  FILLER                   PIC X(2)    VALUE SPACES.               
           05  L272C-NME-STREET-O       PIC X(20)   VALUE SPACES.               
           05  FILLER                   PIC X(1)    VALUE SPACES.               
           05  L272C-NUM-POSTAL-O       PIC X(9)    VALUE SPACES.               
           05  FILLER                   PIC X(3)    VALUE SPACES.               
           05  L272C-NME-STREET-N       PIC X(20)   VALUE SPACES.               
           05  FILLER                   PIC X(1)    VALUE SPACES.               
           05  L272C-NUM-POSTAL-N       PIC X(9)    VALUE SPACES.               
                                                                                
       01  L272-DRAW-LINE.                                                      
           05  LINE1                    PIC X(132)  VALUE ALL '-'.              
                                                                                
      *-------------------------------------------------------------            
      *  LINKAGE FOR AV02C015                                                   
      *-------------------------------------------------------------            
       01  WS-LINK-AV02C015.                                                    
           05  AV02C015-IN-POSTCODE         PIC X(6).                           
           05  AV02C015-OUT-POSTCODE-CHKSUM PIC X(9).                           
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
      *-------------------------------------------------------------            
       0000-MAIN.                                                               
      *-------------------------------------------------------------            
                                                                                
           PERFORM 1000-OPEN-FILES        THRU  1000-EXIT.                      
                                                                                
           MOVE  FUNCTION CURRENT-DATE TO WS-DATE.                              
                                                                                
           STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)                
                       DELIMITED BY SIZE INTO BP13H-LTR-DTE.                    
                                                                                
           STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)                
                       DELIMITED BY SIZE INTO BP13H5-LTR-DTE.                   
                                                                                
           MOVE     1    TO WS-SNO-L272B.                                       
           MOVE     1    TO WS-PG-CNT-L272B.                                    
           MOVE     1    TO WS-SNO-L272C.                                       
           MOVE     1    TO WS-PG-CNT-L272C.                                    
                                                                                
           PERFORM 3000-READ-BP13F838        THRU 3000-EXIT.                    
           PERFORM 4000-PROCESS-BP13F838     THRU 4000-EXIT                     
             UNTIL EOF-BP13F838 = 'Y'.                                          
           PERFORM 9999-CLOSE-FILES THRU 9999-EXIT.                             
                                                                                
      *****************************************************************         
       1000-OPEN-FILES.                                                         
      *****************************************************************         
                                                                                
           OPEN INPUT  BP13F838                                                 
                       BP13K825                                                 
                       BP13K830                                                 
                OUTPUT P13P272B                                                 
                       P13P272C                                                 
                       P13P272D                                                 
                       P13P272E                                                 
                       P13L272B                                                 
                       P13L272C.                                                
                                                                                
           IF WS-K825-STATUS NOT = 0 AND 97                                     
              DISPLAY ' ERROR ENCOUNTERED IN OPENING FILE BP13K825 : '          
                                              WS-K825-STATUS                    
              MOVE WS-K825-STATUS TO RETURN-CODE.                               
                                                                                
           IF WS-K830-STATUS NOT = 0 AND 97                                     
              DISPLAY ' ERROR ENCOUNTERED IN OPENING FILE BP13K830 : '          
                                              WS-K830-STATUS                    
              MOVE WS-K830-STATUS TO RETURN-CODE.                               
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       3000-READ-BP13F838.                                                      
      *****************************************************************         
                                                                                
           READ BP13F838                                                        
                AT END  MOVE  'Y' TO    EOF-BP13F838.                           
                                                                                
           IF EOF-BP13F838 NOT = 'Y'                                            
              ADD   1             TO    WS-F838-READ.                           
                                                                                
           MOVE SPACES            TO    WS-DETAIL-LINE                          
                                        WS-RES-ADDR2                            
                                        WS-RES-ADDR3.                           
           MOVE SPACES            TO    L272B-PR-DETAILS                        
                                        L272B-RES-ADDR2                         
                                        L272B-RES-ADDR3.                        
           MOVE SPACES            TO    L272C-PR-DETAILS                        
                                        L272C-RES-ADDR2.                        
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       4000-PROCESS-BP13F838.                                                   
      *****************************************************************         
                                                                                
           MOVE    SPACES     TO   WS-K825-FOUND                                
                                   WS-K830-FOUND.                               
                                                                                
           IF F838-NUM-AMIS = '3' OR '4'                                        
              MOVE SPACES        TO K830-NUM-REGN                               
              MOVE F838-NUM-REGN TO K830-NUM-REGN                               
              PERFORM 5100-READ-BP13K830-BY-REGN THRU 5100-EXIT                 
           ELSE                                                                 
              MOVE SPACES              TO K830-KEY-FLD                          
      *       MOVE F838-NUM-REGN (1:6) TO K830-KEY-FLD (1:6)                    
              MOVE F838-NUM-REGN       TO K830-KEY-FLD                          
              PERFORM 5200-READ-BP13K830-BY-REF  THRU 5200-EXIT                 
           END-IF.                                                              
                                                                                
           IF WS-K830-FOUND = 'Y'                                               
              PERFORM 7000-MOVE-VALUES-TO-LETTER THRU 7000-EXIT                 
              PERFORM 7100-PRINT-DJDE            THRU 7100-EXIT                 
           END-IF.                                                              
                                                                                
           PERFORM  3000-READ-BP13F838         THRU 3000-EXIT.                  
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5100-READ-BP13K830-BY-REGN.                                              
      *****************************************************************         
                                                                                
           READ  BP13K830 KEY IS K830-NUM-REGN.                                 
                                                                                
           EVALUATE WS-K830-STATUS                                              
           WHEN  00                                                             
                 ADD     1   TO  WS-K830-READ                                   
                 MOVE   'Y'  TO  WS-K830-FOUND                                  
           WHEN  23                                                             
                 DISPLAY 'RECORD NOT FOUND BP13K830 : ' K830-NUM-REGN           
                 DISPLAY 'NRIC READ                 : ' F838-NUM-NRIC           
                 ADD     1   TO  WS-K830-NOTFND                                 
           WHEN  OTHER                                                          
                 DISPLAY 'READ ERROR BP13K830 : ' WS-K830-STATUS                
                 DISPLAY 'NRIC READ           : ' F838-NUM-NRIC                 
                 DISPLAY 'REGN READ           : ' K830-NUM-REGN                 
                 PERFORM  9999-CLOSE-FILES THRU 9999-EXIT                       
           END-EVALUATE.                                                        
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       5200-READ-BP13K830-BY-REF.                                               
      *****************************************************************         
                                                                                
           READ  BP13K830 KEY IS K830-KEY-FLD.                                  
                                                                                
           EVALUATE WS-K830-STATUS                                              
           WHEN  00                                                             
                 ADD     1   TO  WS-K830-READ                                   
                 MOVE   'Y'  TO  WS-K830-FOUND                                  
           WHEN  23                                                             
                 DISPLAY 'RECORD NOT FOUND BP13K830 : ' K830-NUM-REGN           
                 DISPLAY 'NRIC READ                 : ' F838-NUM-NRIC           
                 ADD     1   TO  WS-K830-NOTFND                                 
           WHEN  OTHER                                                          
                 DISPLAY 'READ ERROR BP13K830 : ' WS-K830-STATUS                
                 DISPLAY 'NRIC READ           : ' F838-NUM-NRIC                 
                 DISPLAY 'REGN READ           : ' K830-NUM-REGN                 
                 PERFORM  9999-CLOSE-FILES THRU 9999-EXIT                       
           END-EVALUATE.                                                        
                                                                                
       5200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       6000-READ-BP13K825.                                                      
      *****************************************************************         
                                                                                
           READ BP13K825.                                                       
                                                                                
           EVALUATE WS-K825-STATUS                                              
           WHEN 00                                                              
                ADD 1                TO   WS-K825-READ                          
                MOVE 'Y'             TO   WS-K825-FOUND                         
           WHEN 23                                                              
                DISPLAY 'RECORD NOT FOUND BP13K825 : '                          
                                K825-NUM-NRIC                                   
                MOVE 'N'             TO   WS-K825-FOUND                         
           WHEN OTHER                                                           
                DISPLAY 'READ ERROR BP13K825   : '                              
                                WS-K825-STATUS                                  
                DISPLAY 'NRIC                  : ' K825-NUM-NRIC                
                PERFORM  9999-CLOSE-FILES THRU 9999-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       6600-CALL-AV02C015.                                                      
      *****************************************************************         
           CALL 'AV02C015'          USING                                       
                                    AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM.               
       6600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7000-MOVE-VALUES-TO-LETTER.                                              
      *****************************************************************         
                                                                                
           MOVE F838-NUM-REGN      TO  WS-DJDE-REGN                             
                                       WS-DJDE-REGN-COPY                        
                                       WS-REGN.                                 
           MOVE F838-NUM-NT-ZONE   TO  WS-DJDE-NT-ZONE                          
                                       WS-DJDE-NT-ZONE-COPY.                    
           MOVE F838-NUM-FLAT-TYPE TO  WS-DJDE-FLAT-TYPE                        
                                       WS-DJDE-FLAT-TYPE-COPY.                  
           MOVE '/'                TO  WS-DJDE-HDBREF-SLASH.                    
                                                                                
           IF F838-NUM-NRIC  NOT = SPACES AND LOW-VALUES                        
              MOVE F838-NUM-NRIC       TO WS-DJDE-NRIC1                         
              MOVE SPACES              TO WS-K825-FOUND                         
              MOVE SPACES              TO K825-KEY-FLD                          
              IF F838-NUM-REGN (7:2) = SPACES OR LOW-VALUES                     
                 MOVE F838-NUM-REGN (1:6) TO K825-NUM-REF                       
              ELSE                                                              
                 MOVE F838-NUM-REGN       TO K825-NUM-REGN                      
              END-IF                                                            
              MOVE    WS-DJDE-NRIC1      TO   K825-NUM-NRIC                     
              PERFORM 6000-READ-BP13K825 THRU 6000-EXIT                         
              IF WS-K825-FOUND = 'Y'                                            
                 MOVE  K825-NME-OCCP  TO   WS-DJDE-NAME1                        
                                           WS-NAME1                             
              ELSE                                                              
                 MOVE  SPACES         TO   WS-DJDE-NAME1                        
                                           WS-NAME1                             
              END-IF                                                            
           ELSE                                                                 
              MOVE SPACES              TO WS-DJDE-NRIC1                         
              MOVE SPACES              TO WS-DJDE-NAME1                         
                                          WS-NAME1                              
           END-IF.                                                              
                                                                                
           IF (F838-NUM-NRIC2 NOT = SPACES AND LOW-VALUES) AND                  
              (F838-NUM-NRIC2 (1:1) NOT = '#')                                  
              MOVE F838-NUM-NRIC2      TO WS-DJDE-NRIC2                         
              MOVE SPACES              TO WS-K825-FOUND                         
              MOVE SPACES              TO K825-KEY-FLD                          
              IF F838-NUM-REGN (7:2) = SPACES OR LOW-VALUES                     
                 MOVE F838-NUM-REGN (1:6) TO K825-NUM-REF                       
              ELSE                                                              
                 MOVE F838-NUM-REGN       TO K825-NUM-REGN                      
              END-IF                                                            
              MOVE    WS-DJDE-NRIC2      TO   K825-NUM-NRIC                     
              PERFORM 6000-READ-BP13K825 THRU 6000-EXIT                         
              IF WS-K825-FOUND = 'Y'                                            
                 MOVE  K825-NME-OCCP  TO   WS-DJDE-NAME2                        
                                           WS-NAME2                             
              ELSE                                                              
                 MOVE  SPACES         TO   WS-DJDE-NAME2                        
                                           WS-NAME2                             
              END-IF                                                            
           ELSE                                                                 
              MOVE SPACES              TO WS-DJDE-NRIC2                         
              MOVE SPACES              TO WS-DJDE-NAME2                         
                                          WS-NAME2                              
           END-IF.                                                              
                                                                                
           IF (F838-NUM-NRIC3 NOT = SPACES AND LOW-VALUES) AND                  
              (F838-NUM-NRIC3 (1:1) NOT = '#')                                  
              MOVE F838-NUM-NRIC3      TO WS-DJDE-NRIC3                         
           ELSE                                                                 
              MOVE SPACES              TO WS-DJDE-NRIC3                         
           END-IF.                                                              
                                                                                
           IF (F838-NUM-NRIC4 NOT = SPACES AND LOW-VALUES) AND                  
              (F838-NUM-NRIC4 (1:1) NOT = '#')                                  
              MOVE F838-NUM-NRIC4      TO WS-DJDE-NRIC4                         
           ELSE                                                                 
              MOVE SPACES              TO WS-DJDE-NRIC4                         
           END-IF.                                                              
                                                                                
      *-------------------------------------------------------------            
      * ADDRESS FOR LETTER                                                      
      *-------------------------------------------------------------            
                                                                                
           IF (K830-NUM-MAIL-ADDR  = SPACES OR LOW-VALUES) OR                   
              ((K830-NUM-MAIL-LVL-CHAR = '#') AND                               
               (K830-NUM-MAIL-LVL-NUM = SPACES OR LOW-VALUES))                  
               IF F838-NUM-OLD-ADDR-TYPE  = 'H'                                 
                  MOVE F838-NUM-OLD-BLK         TO WS-DJDE-BLK-NO               
                  MOVE F838-NME-OLD-STREET      TO WS-DJDE-STREET-NAME          
                  MOVE F838-NUM-OLD-LVL-CHAR    TO WS-DJDE-CHAR                 
                  MOVE F838-NUM-OLD-LVL-NUM     TO WS-DJDE-LEVEL                
                  MOVE F838-NUM-OLD-LVL-DASH    TO WS-DJDE-DASH                 
                  MOVE F838-NUM-OLD-HSEMAIN     TO WS-DJDE-HSE-MAIN             
                  MOVE F838-NUM-OLD-HSESUB      TO WS-DJDE-HSE-SUB              
               ELSE                                                             
                  MOVE F838-NUM-OLD-BLK         TO WS-DJDE-BLK-NO               
                  MOVE F838-NUM-OLD-FLAT        TO WS-DJDE-NUM-FLAT             
                  MOVE F838-NME-OLD-STREET-BLDG TO WS-DJDE-STREET-NAME          
               END-IF                                                           
               IF F838-NUM-OLD-POSTAL = SPACES                                  
                  MOVE  SPACES TO WS-DJDE-CODE                                  
               ELSE                                                             
                  STRING 'SINGAPORE '   F838-NUM-OLD-POSTAL                     
                          DELIMITED BY SIZE  INTO WS-DJDE-CODE                  
                  END-STRING                                                    
               END-IF                                                           
                                                                                
      * TO GET THE BAR CODE                                                     
               MOVE SPACES                      TO WS-LINK-AV02C015             
               MOVE F838-NUM-OLD-POSTAL TO AV02C015-IN-POSTCODE                 
               PERFORM 6600-CALL-AV02C015        THRU 6600-EXIT                 
               MOVE AV02C015-OUT-POSTCODE-CHKSUM TO WS-DJDE-BARCODE             
                                                                                
           ELSE                                                                 
               IF K830-NUM-MAIL-ADDR-TYPE =  'H'                                
                  MOVE K830-NUM-MAIL-BLK      TO WS-DJDE-BLK-NO                 
                  MOVE K830-NME-MAIL-STR-BLDG TO WS-DJDE-STREET-NAME            
                  MOVE K830-NUM-MAIL-LVL-CHAR TO WS-DJDE-CHAR                   
                  MOVE K830-NUM-MAIL-LVL-NUM  TO WS-DJDE-LEVEL                  
                  MOVE K830-NUM-MAIL-LVL-DASH TO WS-DJDE-DASH                   
                  MOVE K830-NUM-MAIL-HSEMAIN  TO WS-DJDE-HSE-MAIN               
                  MOVE K830-NUM-MAIL-HSESUB   TO WS-DJDE-HSE-SUB                
               ELSE                                                             
                  MOVE K830-NUM-MAIL-BLK      TO WS-DJDE-BLK-NO                 
                  MOVE K830-NUM-MAIL-FLAT     TO WS-DJDE-NUM-FLAT               
                  MOVE K830-NME-MAIL-STR-BLDG TO WS-DJDE-STREET-NAME            
               END-IF                                                           
               IF K830-NUM-MAIL-POSTAL = SPACES                                 
                  MOVE  SPACES TO WS-DJDE-CODE                                  
               ELSE                                                             
                  STRING 'SINGAPORE '   K830-NUM-MAIL-POSTAL                    
                          DELIMITED BY SIZE  INTO WS-DJDE-CODE                  
                  END-STRING                                                    
               END-IF                                                           
                                                                                
      * TO GET THE BAR CODE                                                     
               MOVE SPACES                      TO WS-LINK-AV02C015             
               MOVE K830-NUM-MAIL-POSTAL TO AV02C015-IN-POSTCODE                
               PERFORM 6600-CALL-AV02C015        THRU 6600-EXIT                 
               MOVE AV02C015-OUT-POSTCODE-CHKSUM TO WS-DJDE-BARCODE             
                                                                                
           END-IF.                                                              
                                                                                
      *-------------------------------------------------------------            
      * NEW ADDRESS FOR LETTER                                                  
      *-------------------------------------------------------------            
                                                                                
           IF  F838-NUM-NEW-ADDR-TYPE = 'H'                                     
               STRING 'BLK ' F838-NUM-NEW-BLK                                   
                       DELIMITED BY SIZE  INTO  WS-DJDE-NEW-NUM-BLK             
           ELSE                                                                 
               MOVE  F838-NUM-NEW-BLK       TO  WS-DJDE-NEW-NUM-BLK             
           END-IF.                                                              
                                                                                
           IF  F838-NUM-NEW-ADDR-TYPE = 'H'                                     
               STRING '#'  F838-NUM-NEW-HSELVL                                  
                      '-'  F838-NUM-NEW-HSEUNIT                                 
                      '  ' DELIMITED BY SIZE  INTO WS-DJDE-NEW-FLAT             
           ELSE                                                                 
              IF F838-NUM-NEW-HSELVL = SPACES OR LOW-VALUES                     
                 STRING F838-NUM-NEW-HSELVL                                     
                        F838-NUM-NEW-HSEUNIT                                    
                        '   ' DELIMITED BY SIZE  INTO WS-DJDE-NEW-FLAT          
              ELSE                                                              
                 STRING F838-NUM-NEW-HSELVL                                     
                        '-' F838-NUM-NEW-HSEUNIT                                
                        '  ' DELIMITED BY SIZE  INTO WS-DJDE-NEW-FLAT           
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE  F838-NME-NEW-STREET-TXT1 TO  WS-DJDE-NEW-STREET-NME.           
                                                                                
           IF F838-NUM-NEW-POSTAL = SPACES                                      
              MOVE  SPACES TO WS-DJDE-NEW-POSTAL-CDE                            
           ELSE                                                                 
              STRING 'SINGAPORE '   F838-NUM-NEW-POSTAL                         
                      DELIMITED BY SIZE  INTO WS-DJDE-NEW-POSTAL-CDE            
              END-STRING                                                        
           END-IF.                                                              
                                                                                
      * TO GET THE BAR CODE                                                     
           MOVE SPACES                      TO WS-LINK-AV02C015                 
           MOVE F838-NUM-NEW-POSTAL TO AV02C015-IN-POSTCODE                     
           PERFORM 6600-CALL-AV02C015        THRU 6600-EXIT                     
           MOVE AV02C015-OUT-POSTCODE-CHKSUM TO WS-DJDE-NEW-BARCODE             
                                                                                
      *-------------------------------------------------------------            
      * OLD ADDRESS FOR REPORT                                                  
      *-------------------------------------------------------------            
                                                                                
           IF F838-NUM-OLD-ADDR-TYPE  = 'H'                                     
              MOVE F838-NUM-OLD-BLK         TO WS-BLK-RES-O                     
              MOVE F838-NME-OLD-STREET      TO WS-NME-STREET-O                  
              MOVE F838-NUM-OLD-LVL-CHAR    TO WS-CHAR-O                        
              MOVE F838-NUM-OLD-LVL-NUM     TO WS-LEVEL-O                       
              MOVE F838-NUM-OLD-LVL-DASH    TO WS-DASH-O                        
              MOVE F838-NUM-OLD-HSEMAIN     TO WS-HSE-MAIN-O                    
              MOVE F838-NUM-OLD-HSESUB      TO WS-HSE-SUB-O                     
           ELSE                                                                 
              MOVE F838-NUM-OLD-BLK         TO WS-BLK-RES-O                     
              MOVE F838-NUM-OLD-FLAT        TO WS-NUM-FLAT-O                    
              MOVE F838-NME-OLD-STREET-BLDG TO WS-NME-STREET-O                  
           END-IF.                                                              
                                                                                
           IF F838-NUM-OLD-POSTAL = SPACES                                      
              MOVE  SPACES TO WS-NUM-POSTAL-O                                   
           ELSE                                                                 
              STRING 'S('   F838-NUM-OLD-POSTAL                                 
                      ')'                                                       
                      DELIMITED BY SIZE  INTO WS-NUM-POSTAL-O                   
              END-STRING                                                        
           END-IF.                                                              
                                                                                
      *-------------------------------------------------------------            
      * NEW ADDRESS FOR REPORT                                                  
      *-------------------------------------------------------------            
                                                                                
           IF  F838-NUM-NEW-ADDR-TYPE = 'H'                                     
               STRING 'BLK ' F838-NUM-NEW-BLK                                   
                       DELIMITED BY SIZE  INTO  WS-BLK-RES-N                    
           ELSE                                                                 
               MOVE  F838-NUM-NEW-BLK       TO  WS-BLK-RES-N                    
           END-IF.                                                              
                                                                                
           IF  F838-NUM-NEW-ADDR-TYPE = 'H'                                     
               STRING '#'  F838-NUM-NEW-HSELVL                                  
                      '-'  F838-NUM-NEW-HSEUNIT                                 
                      '  ' DELIMITED BY SIZE  INTO WS-NUM-FLAT-N                
           ELSE                                                                 
              IF F838-NUM-NEW-HSELVL = SPACES OR LOW-VALUES                     
                 STRING F838-NUM-NEW-HSELVL                                     
                        F838-NUM-NEW-HSEUNIT                                    
                        '   ' DELIMITED BY SIZE  INTO WS-NUM-FLAT-N             
              ELSE                                                              
                 STRING F838-NUM-NEW-HSELVL                                     
                        '-' F838-NUM-NEW-HSEUNIT                                
                        '  ' DELIMITED BY SIZE  INTO WS-NUM-FLAT-N              
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE  F838-NME-NEW-STREET-TXT1 TO  WS-NME-STREET-N.                  
                                                                                
           IF F838-NUM-NEW-POSTAL = SPACES                                      
              MOVE  SPACES TO WS-NUM-POSTAL-N                                   
           ELSE                                                                 
              STRING 'S('   F838-NUM-NEW-POSTAL                                 
                      ')'                                                       
                      DELIMITED BY SIZE  INTO WS-NUM-POSTAL-N                   
              END-STRING                                                        
           END-IF.                                                              
                                                                                
      *-------------------------------------------------------------            
      * CORRESPONDENCE ADDRESS FOR REPORT                                       
      *-------------------------------------------------------------            
                                                                                
           IF (K830-NUM-MAIL-ADDR = SPACES OR LOW-VALUES) OR                    
              ((K830-NUM-MAIL-LVL-CHAR = '#') AND                               
               (K830-NUM-MAIL-LVL-NUM = SPACES OR LOW-VALUES))                  
                NEXT SENTENCE                                                   
           ELSE                                                                 
               IF K830-NUM-MAIL-ADDR-TYPE =  'H'                                
                  MOVE K830-NUM-MAIL-BLK      TO WS-BLK-CORR                    
                  MOVE K830-NME-MAIL-STR-BLDG TO WS-NME-STREET-CORR             
                  MOVE K830-NUM-MAIL-LVL-CHAR TO WS-CHAR-CORR                   
                  MOVE K830-NUM-MAIL-LVL-NUM  TO WS-LEVEL-CORR                  
                  MOVE K830-NUM-MAIL-LVL-DASH TO WS-DASH-CORR                   
                  MOVE K830-NUM-MAIL-HSEMAIN  TO WS-HSE-MAIN-CORR               
                  MOVE K830-NUM-MAIL-HSESUB   TO WS-HSE-SUB-CORR                
               ELSE                                                             
                  MOVE K830-NUM-MAIL-BLK      TO WS-BLK-CORR                    
                  MOVE K830-NUM-MAIL-FLAT     TO WS-NUM-FLAT-CORR               
                  MOVE K830-NME-MAIL-STR-BLDG TO WS-NME-STREET-CORR             
               END-IF                                                           
               IF K830-NUM-MAIL-POSTAL = SPACES                                 
                  MOVE  SPACES TO WS-NUM-POSTAL-CORR                            
               ELSE                                                             
                  STRING 'S('   K830-NUM-MAIL-POSTAL                            
                          ')'                                                   
                          DELIMITED BY SIZE  INTO WS-NUM-POSTAL-CORR            
                  END-STRING                                                    
               END-IF                                                           
           END-IF.                                                              
                                                                                
      *    IF  WS-DJDE-NAME1 = SPACES                                           
      *        MOVE SPACES           TO WS-DJDE-NAME1-LABEL                     
      *    ELSE                                                                 
      *        MOVE ' (APPLICANT 1)' TO WS-DJDE-NAME1-LABEL.                    
      *                                                                         
      *    IF  WS-DJDE-NAME2 = SPACES                                           
      *        MOVE SPACES           TO WS-DJDE-NAME2-LABEL                     
      *    ELSE                                                                 
      *        MOVE ' (APPLICANT 2)' TO WS-DJDE-NAME2-LABEL.                    
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       7100-PRINT-DJDE.                                                         
      *****************************************************************         
                                                                                
           IF  F838-NUM-AMIS = '4' OR '6'                                       
               PERFORM 7120-PRINT-DJDE-BP13H2      THRU 7120-EXIT               
               PERFORM 7130-PRINT-DJDE-BP13H2-COPY THRU 7130-EXIT               
               PERFORM 7520-WRITE-P13L272B         THRU 7520-EXIT.              
                                                                                
           IF  F838-NUM-AMIS = '3' OR '5'                                       
               PERFORM 7140-PRINT-DJDE-BP13H1      THRU 7140-EXIT               
               PERFORM 7150-PRINT-DJDE-BP13H1-COPY THRU 7150-EXIT               
               PERFORM 7530-WRITE-P13L272C         THRU 7530-EXIT.              
                                                                                
       7100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       7120-PRINT-DJDE-BP13H2.                                                  
      *****************************************************************         
                                                                                
      *  SEND TO MAILING ADDRESS                                                
                                                                                
           MOVE  SPACES        TO    P13P272B-REC                               
           WRITE P13P272B-REC  FROM  WS-DJDE-BP13H2          AFTER PAGE         
           WRITE P13P272B-REC  FROM  WS-BP13H-NAME1          AFTER 11           
           WRITE P13P272B-REC  FROM  WS-BP13H-NAME2          AFTER 1            
           WRITE P13P272B-REC  FROM  WS-DJDE-PRT-HDG-A       AFTER 2            
           WRITE P13P272B-REC  FROM  WS-DJDE-PRT-HDG-B       AFTER 1            
           WRITE P13P272B-REC  FROM  WS-DJDE-PRT-HDG-C       AFTER 1            
           WRITE P13P272B-REC  FROM  WS-BP13H-DTE            AFTER 2            
           WRITE P13P272B-REC  FROM  WS-DJDE-HDBREF          AFTER 2            
                                                                                
           WRITE P13P272B-REC  FROM  WS-DJDE-PRT-HDG-A       AFTER 16           
           WRITE P13P272B-REC  FROM  WS-DJDE-PRT-HDG-B       AFTER 1            
           WRITE P13P272B-REC  FROM  WS-DJDE-PRT-HDG-C       AFTER 1            
           MOVE  SPACES        TO    P13P272B-REC                               
                                                                                
      *  SEND TO NEW ADDRESS                                                    
                                                                                
           MOVE  SPACES        TO    P13P272B-REC                               
           WRITE P13P272B-REC  FROM  WS-DJDE-BP13H2          AFTER PAGE         
           WRITE P13P272B-REC  FROM  WS-BP13H-NAME1          AFTER 11           
           WRITE P13P272B-REC  FROM  WS-BP13H-NAME2          AFTER 1            
           WRITE P13P272B-REC  FROM  WS-BP13H-NEW-ADDR-INFO1 AFTER 2            
           WRITE P13P272B-REC  FROM  WS-BP13H-NEW-ADDR-INFO2 AFTER 1            
           WRITE P13P272B-REC  FROM  WS-BP13H-NEW-ADDR-INFO3 AFTER 1            
           WRITE P13P272B-REC  FROM  WS-BP13H-DTE            AFTER 2            
           WRITE P13P272B-REC  FROM  WS-DJDE-HDBREF          AFTER 2            
                                                                                
           WRITE P13P272B-REC  FROM  WS-DJDE-PRT-HDG-A       AFTER 16           
           WRITE P13P272B-REC  FROM  WS-DJDE-PRT-HDG-B       AFTER 1            
           WRITE P13P272B-REC  FROM  WS-DJDE-PRT-HDG-C       AFTER 1            
           MOVE  SPACES        TO    P13P272B-REC                               
                                                                                
           ADD   1 TO WS-P272B-WRITTEN.                                         
                                                                                
       7120-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7130-PRINT-DJDE-BP13H2-COPY.                                             
      *****************************************************************         
                                                                                
      *  SEND COPY TO MAILING ADDR.                                             
                                                                                
           MOVE  'C O P Y'     TO    WS-DJDE-COPY                               
           MOVE  SPACES        TO    P13P272C-REC.                              
           WRITE P13P272C-REC  FROM  WS-DJDE-BP13H2          AFTER PAGE         
           WRITE P13P272C-REC  FROM  WS-BP13H-NAME1          AFTER 11           
           WRITE P13P272C-REC  FROM  WS-BP13H-NAME2          AFTER 1            
           WRITE P13P272C-REC  FROM  WS-DJDE-PRT-HDG-A       AFTER 2            
           WRITE P13P272C-REC  FROM  WS-DJDE-PRT-HDG-B       AFTER 1            
           WRITE P13P272C-REC  FROM  WS-DJDE-PRT-HDG-C       AFTER 1            
           WRITE P13P272C-REC  FROM  WS-BP13H-DTE            AFTER 2            
           WRITE P13P272C-REC  FROM  WS-DJDE-HDBREF-COPY     AFTER 2            
                                                                                
           WRITE P13P272C-REC  FROM  WS-DJDE-PRT-HDG-A       AFTER 16           
           WRITE P13P272C-REC  FROM  WS-DJDE-PRT-HDG-B       AFTER 1            
           WRITE P13P272C-REC  FROM  WS-DJDE-PRT-HDG-C       AFTER 1            
           MOVE  SPACES        TO    P13P272C-REC                               
                                                                                
           ADD   1 TO WS-P272C-WRITTEN.                                         
                                                                                
       7130-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7140-PRINT-DJDE-BP13H1.                                                  
      *****************************************************************         
                                                                                
           MOVE SPACES TO P13P272D-REC                                          
           WRITE P13P272D-REC  FROM  WS-DJDE-BP13H1          AFTER PAGE         
           WRITE P13P272D-REC  FROM  WS-BP13H-NAME1          AFTER 11           
           WRITE P13P272D-REC  FROM  WS-BP13H-NAME2          AFTER 1            
           WRITE P13P272D-REC  FROM  WS-BP13H-NEW-ADDR-INFO1 AFTER 2            
           WRITE P13P272D-REC  FROM  WS-BP13H-NEW-ADDR-INFO2 AFTER 1            
           WRITE P13P272D-REC  FROM  WS-BP13H-NEW-ADDR-INFO3 AFTER 1            
           WRITE P13P272D-REC  FROM  WS-BP13H-DTE            AFTER 2            
           WRITE P13P272D-REC  FROM  WS-DJDE-HDBREF          AFTER 2            
                                                                                
           WRITE P13P272D-REC  FROM  WS-BP13H-NEW-ADDR-INFO1 AFTER 15           
           WRITE P13P272D-REC  FROM  WS-BP13H-NEW-ADDR-INFO2 AFTER 1            
           WRITE P13P272D-REC  FROM  WS-BP13H-NEW-ADDR-INFO3 AFTER 1            
      *    WRITE P13P272D-REC  FROM  WS-DJDE-INFO            AFTER PAGE         
           MOVE  SPACES        TO    P13P272D-REC.                              
      *    WRITE P13P272D-REC        AFTER PAGE.                                
      *    WRITE P13P272D-REC        AFTER 5.                                   
           WRITE P13P272D-REC  FROM  WS-DJDE-BLANKF AFTER PAGE.                 
           WRITE P13P272D-REC AFTER 5.                                          
                                                                                
           ADD   1 TO WS-P272D-WRITTEN.                                         
                                                                                
       7140-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       7150-PRINT-DJDE-BP13H1-COPY.                                             
      *****************************************************************         
                                                                                
           MOVE SPACES TO P13P272E-REC                                          
           MOVE  'C O P Y'     TO    WS-DJDE-COPY                               
           WRITE P13P272E-REC  FROM  WS-DJDE-BP13H1          AFTER PAGE         
           MOVE  SPACES        TO    P13P272E-REC                               
           WRITE P13P272E-REC  FROM  WS-BP13H-NAME1          AFTER 11           
           WRITE P13P272E-REC  FROM  WS-BP13H-NAME2          AFTER 1            
           WRITE P13P272E-REC  FROM  WS-BP13H-NEW-ADDR-INFO1 AFTER 2            
           WRITE P13P272E-REC  FROM  WS-BP13H-NEW-ADDR-INFO2 AFTER 1            
           WRITE P13P272E-REC  FROM  WS-BP13H-NEW-ADDR-INFO3 AFTER 1            
           WRITE P13P272E-REC  FROM  WS-BP13H-DTE            AFTER 2            
           WRITE P13P272E-REC  FROM  WS-DJDE-HDBREF-COPY     AFTER 2            
           WRITE P13P272E-REC  FROM  WS-BP13H-NEW-ADDR-INFO1 AFTER 15           
           WRITE P13P272E-REC  FROM  WS-BP13H-NEW-ADDR-INFO2 AFTER 1            
           WRITE P13P272E-REC  FROM  WS-BP13H-NEW-ADDR-INFO3 AFTER 1            
      *    WRITE P13P272E-REC  FROM  WS-DJDE-INFO            AFTER PAGE         
           MOVE  SPACES        TO    P13P272E-REC.                              
      *    WRITE P13P272E-REC        AFTER PAGE.                                
      *    WRITE P13P272E-REC        AFTER 5.                                   
           WRITE P13P272E-REC  FROM  WS-DJDE-BLANKF AFTER PAGE.                 
           WRITE P13P272E-REC AFTER 5.                                          
                                                                                
           ADD   1 TO WS-P272E-WRITTEN.                                         
                                                                                
       7150-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7520-WRITE-P13L272B.                                                     
      *****************************************************************         
                                                                                
            IF  WS-COUNT-L272B = 0 OR WS-COUNT-L272B > 50                       
                MOVE  ZERO            TO    WS-COUNT-L272B                      
                MOVE  WS-PG-CNT-L272B TO    L272-PAGE-NO                        
                MOVE  'P13L272B'      TO    L272-HEADER                         
                STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)           
                       DELIMITED BY SIZE INTO L272-PRT-DTE                      
                END-STRING                                                      
                WRITE P13L272B-REC    FROM  L272-PR-HEAD-01 AFTER PAGE          
                WRITE P13L272B-REC    FROM  L272B-PR-HEAD-02 AFTER 1            
                WRITE P13L272B-REC    FROM  L272B-PR-HEAD-03 AFTER 2            
                WRITE P13L272B-REC    FROM  L272B-PR-HEAD-04 AFTER 1            
                WRITE P13L272B-REC    FROM  L272-DRAW-LINE  AFTER 1             
                ADD   6               TO    WS-COUNT-L272B                      
                ADD   1               TO    WS-PG-CNT-L272B.                    
                                                                                
            MOVE  WS-SNO-L272B       TO    L272B-SNO.                           
            MOVE  WS-REGN            TO    L272B-REGN.                          
            MOVE  WS-NAME1           TO    L272B-NAME1.                         
            MOVE  WS-OLD-RES-ADDR    TO    L272B-OLD-RES-ADDR.                  
            MOVE  WS-NEW-RES-ADDR    TO    L272B-NEW-RES-ADDR.                  
            MOVE  WS-CORR-ADDR       TO    L272B-CORR-ADDR.                     
            WRITE P13L272B-REC       FROM  L272B-PR-DETAILS   AFTER 2.          
            MOVE  WS-NAME2           TO    L272B-NAME2.                         
            MOVE  WS-NME-STREET-O    TO    L272B-NME-STREET-O.                  
            MOVE  WS-NME-STREET-N    TO    L272B-NME-STREET-N.                  
            MOVE  WS-NME-STREET-CORR TO    L272B-NME-STREET-CORR.               
            WRITE P13L272B-REC       FROM  L272B-RES-ADDR2    AFTER 1.          
            MOVE  WS-NUM-POSTAL-O    TO    L272B-NUM-POSTAL-O.                  
            MOVE  WS-NUM-POSTAL-N    TO    L272B-NUM-POSTAL-N.                  
            MOVE  WS-NUM-POSTAL-CORR TO    L272B-NUM-POSTAL-CORR.               
            WRITE P13L272B-REC       FROM  L272B-RES-ADDR3    AFTER 1.          
                                                                                
            ADD   4             TO           WS-COUNT-L272B.                    
            ADD   1             TO           WS-L272B-WRITTEN.                  
            ADD   1             TO           WS-SNO-L272B.                      
                                                                                
       7520-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       7530-WRITE-P13L272C.                                                     
      *****************************************************************         
                                                                                
            IF  WS-COUNT-L272C = 0 OR WS-COUNT-L272C > 50                       
                MOVE  ZERO            TO    WS-COUNT-L272C                      
                MOVE  WS-PG-CNT-L272C TO    L272-PAGE-NO                        
                MOVE  'P13L272C'      TO    L272-HEADER                         
                STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)           
                       DELIMITED BY SIZE INTO L272-PRT-DTE                      
                END-STRING                                                      
                WRITE P13L272C-REC    FROM  L272-PR-HEAD-01 AFTER PAGE          
                WRITE P13L272C-REC    FROM  L272C-PR-HEAD-02 AFTER 1            
                WRITE P13L272C-REC    FROM  L272C-PR-HEAD-03 AFTER 2            
                WRITE P13L272C-REC    FROM  L272-DRAW-LINE  AFTER 1             
                ADD   5               TO    WS-COUNT-L272C                      
                ADD   1               TO    WS-PG-CNT-L272C.                    
                                                                                
            MOVE  WS-SNO-L272C       TO    L272C-SNO.                           
            MOVE  WS-REGN            TO    L272C-REGN.                          
            MOVE  WS-NAME1           TO    L272C-NAME1.                         
            MOVE  WS-OLD-RES-ADDR    TO    L272C-OLD-RES-ADDR.                  
            MOVE  WS-NEW-RES-ADDR    TO    L272C-NEW-RES-ADDR.                  
            WRITE P13L272C-REC       FROM  L272C-PR-DETAILS   AFTER 2.          
            MOVE  WS-NAME2           TO    L272C-NAME2.                         
            MOVE  WS-NME-STREET-O    TO    L272C-NME-STREET-O.                  
            MOVE  WS-NUM-POSTAL-O    TO    L272C-NUM-POSTAL-O.                  
            MOVE  WS-NME-STREET-N    TO    L272C-NME-STREET-N.                  
            MOVE  WS-NUM-POSTAL-N    TO    L272C-NUM-POSTAL-N.                  
            WRITE P13L272C-REC       FROM  L272C-RES-ADDR2    AFTER 1.          
                                                                                
            ADD   3             TO           WS-COUNT-L272C.                    
            ADD   1             TO           WS-L272C-WRITTEN.                  
            ADD   1             TO           WS-SNO-L272C.                      
                                                                                
       7530-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       9999-CLOSE-FILES.                                                        
      *****************************************************************         
                                                                                
           CLOSE BP13F838                                                       
                 BP13K825                                                       
                 BP13K830                                                       
                 P13P272B                                                       
                 P13P272C                                                       
                 P13P272D                                                       
                 P13P272E                                                       
                 P13L272B                                                       
                 P13L272C.                                                      
                                                                                
           IF WS-K825-STATUS NOT = 0                                            
              DISPLAY ' ERROR ENCOUNTERED IN CLOSING FILE  BP13K825 : '         
                                              WS-K825-STATUS                    
              MOVE WS-K825-STATUS TO RETURN-CODE.                               
                                                                                
           IF WS-K830-STATUS NOT = 0                                            
              DISPLAY ' ERROR ENCOUNTERED IN CLOSING FILE  BP13K830 : '         
                                              WS-K830-STATUS                    
              MOVE WS-K830-STATUS TO RETURN-CODE.                               
                                                                                
                                                                                
           DISPLAY '----------------------------------------'.                  
           DISPLAY ' BP13C272 CONTROL TOTAL                 '.                  
           DISPLAY '----------------------------------------'.                  
           DISPLAY ' NO OF BP13F838 RECS READ     : ' WS-F838-READ.             
           DISPLAY ' NO OF BP13K825 RECS READ     : ' WS-K825-READ.             
           DISPLAY ' NO OF BP13K830 RECS READ     : ' WS-K830-READ.             
           DISPLAY ' NO OF BP13K830 RECS NOTFND   : ' WS-K830-NOTFND.           
           DISPLAY ' NO OF P13P272B RECS WRITTEN  : ' WS-P272B-WRITTEN.         
           DISPLAY ' NO OF P13P272C RECS WRITTEN  : ' WS-P272C-WRITTEN.         
           DISPLAY ' NO OF P13P272D RECS WRITTEN  : ' WS-P272D-WRITTEN.         
           DISPLAY ' NO OF P13P272E RECS WRITTEN  : ' WS-P272E-WRITTEN.         
           DISPLAY ' NO OF P13L272B RECS WRITTEN  : ' WS-L272B-WRITTEN.         
           DISPLAY ' NO OF P13L272C RECS WRITTEN  : ' WS-L272C-WRITTEN.         
                                                                                
           STOP RUN.                                                            
                                                                                
       9999-EXIT.                                                               
           EXIT.                                                                
