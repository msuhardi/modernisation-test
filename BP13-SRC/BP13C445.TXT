      *************************                                                 
       IDENTIFICATION DIVISION.                                                 
      *************************                                                 
       PROGRAM-ID.    BP13C445.                                                 
       AUTHOR.        TOH SHIOK KUAN.                                           
       DATE-WRITTEN.  11/10/89.                                                 
                                                                                
      ***************************************************************           
      *                   SYSTEM OF COMMITMENT  (SOC)               *           
      *=============================================================*           
      *  OBJECTIVE  :  TO PRINT PAYMENT SCHEDULE FOR STAMPIMG OF    *           
      *                DEED OF ASSIGNMENT (BP13L445A)               *           
      *                (TP AND SA/TP DRAFT VOUCHER)                 *           
      *=============================================================*           
      *                                                             *           
      * CHGE     DATE   BY   DESCRIPTIONS                           *           
      * -------  ------ ---- ------------                           *           
      * C910262  260391 YPH  TO ADD 'DATE OF SALES ORDER' ON        *           
      *                      BP13L445A LISTING.                     *           
      * C910943  011291 TJF  CHG SPC TO BUC                         *           
      * SOCPH6   150492 RAZ  TO ADD BP13L445D LISTING               *           
      * SOC-PH8  280793 KPS  TO GET ADDR AND BUC FROM BP13F315      *           
      *                      AND EXPAND REGN TO 8 CHARS             *           
      * C931147  180394 RML  TO GET TOTAL STAMP FEES TO PREPARE     *           
      *                      FOR INTERFACING WITH PAYMENT SYSTEM    *           
      * C9404E6  140694 LJL  TO CATER FOR SALE OF SITTING           *           
      *                      TENANT FLATS (TYPE 2B).                *           
      * BP130020 951010 SSS  REPOSITION MAIN-HEADER TO ROW 1        *           
      * BP130037 131095 LJL  TO CATER FOR AGALMATION OF SALES       *           
      *                      TYPE 1,2,2B,3,3A AND 10.               *           
      * BP130181 960910 LJL  COLLECTION OF 15%, 20%, 25%,           *           
      *                      30% & 40% PREMIUM                      *           
      * BP130453 980322 SGK  TO CATER FOR IBG-GIRO.                 *           
      * BP130418 980609 RHB  Y2K                                    *           
      * BP130696 300799 CLT  CATER FOR E-STAMPING                   *           
      * BP130998 150501 CLT  CATER FOR SA FLAT SALES TYPE 13        *           
      * BP131036 140601 RAS  CATER FOR ALLOC CDES: SFC & SRC        *           
      * BP132037 161001 MCC  OFF BUDGET DISCOUNT 30%                *           
      * BP132270 301202 MALC CATER FOR STAMP-FEE DISC AND NO DISC   *           
      * BP132485 040304 MJ16 TO INCLUDE CHECKING OF SERS TABLE      *           
      *                      TO INCLUDE 3 NEW ALLOC SCHEMES IN      *           
      *                      TABLE.('SFO','SRO','SJO')              *           
      * BP132707 130705 JF4  CATER FOR RP FLAT TP                   *           
      * BP132878 020806 CLT1 CATER FOR 'RT' FLAT                    *           
      * BP134218 040511 JB8  CATER FOR REMOVAL OF NOMINAL DUTIES    *           
      * BP136159 090316 KSJ3 CATER FOR SALES TYPE '18'              *           
      * BP137782 160418 DN8  NOT TO CHECK LOAN AMT FOR 3588708C     *           
      * BP137782 240418 DN8  TO REMOVE CHECK FOR CASE 3588708C      *           
      * BP138132 131219 KTM3 TO CATER FOR FSH (SALES TYPE 19)       *           
      * BP138339 050820 KR13 UPDATE REPORT ID.                      *           
      * ============================================================*           
                                                                                
      ************************                                                  
       ENVIRONMENT DIVISION.                                                    
      ************************                                                  
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.   IBM-3090.                                             
       OBJECT-COMPUTER.   IBM-3090.                                             
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT B05K006   ASSIGN       TO B05K006                             
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K006-HDB-REF-SF                     
                            FILE STATUS  IS WS-K006-STATUS.                     
                                                                                
           SELECT BP13K410  ASSIGN       TO BP13K410                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K410-KEY-FLD                        
                            FILE STATUS  IS WS-K410-STATUS.                     
                                                                                
           SELECT BP13F315  ASSIGN       TO BP13F315.                           
                                                                                
           SELECT P13445AA  ASSIGN       TO P13445AA.                           
           SELECT P13445AD  ASSIGN       TO P13445AD.                           
           SELECT P13445AE  ASSIGN       TO P13445AE.                           
           SELECT P13445AG  ASSIGN       TO P13445AG.                           
           SELECT P13445AH  ASSIGN       TO P13445AH.                           
           SELECT P13445AI  ASSIGN       TO P13445AI.                           
           SELECT P13445AJ  ASSIGN       TO P13445AJ.                           
                                                                                
      *****************                                                         
       DATA DIVISION.                                                           
      *****************                                                         
                                                                                
       FILE SECTION.                                                            
      *============*                                                            
      * SFMAST  FILE                                                            
      *--------------                                                           
       FD   B05K006.                                                            
       COPY B05K006.                                                            
                                                                                
      * ACCUMSO FILE                                                            
      *--------------                                                           
       FD   BP13K410                                                            
            BLOCK  CONTAINS 0    RECORDS                                        
            RECORD CONTAINS 2000 CHARACTERS                                     
            LABEL  RECORDS  ARE  STANDARD.                                      
       COPY BP13K410.                                                           
                                                                                
      *------------------                                                       
      * TRANSACTION FILE                                                        
      *------------------                                                       
       FD   BP13F315                                                            
            BLOCK  CONTAINS 0    RECORDS                                        
            RECORD CONTAINS 500  CHARACTERS                                     
            LABEL  RECORDS  ARE  STANDARD                                       
            RECORDING MODE  IS   F.                                             
       COPY BP13F315.                                                           
                                                                                
      *---------------------------------------                                  
      * LISTING FOR STAMPING DOA FOR SOC FLAT                                   
      *---------------------------------------                                  
       FD   P13445AA                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS  ARE OMITTED                                         
            RECORDING MODE  IS  F.                                              
       01   L445A-PRINT-REC          PIC X(132).                                
                                                                                
      *---------------------------------------                                  
      * AGREEMENT OF LEASE & DOA OF SOC FLAT                                    
      *---------------------------------------                                  
       FD   P13445AD                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS  ARE OMITTED                                         
            RECORDING MODE  IS  F.                                              
       01   L445D-PRINT-REC          PIC X(132).                                
                                                                                
       FD   P13445AE                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS  ARE OMITTED                                         
            RECORDING MODE  IS  F.                                              
       01   L445E-PRINT-REC          PIC X(132).                                
                                                                                
       FD   P13445AG                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS  ARE OMITTED                                         
            RECORDING MODE  IS  F.                                              
       01   L445G-PRINT-REC          PIC X(132).                                
                                                                                
       FD   P13445AH                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS  ARE OMITTED                                         
            RECORDING MODE  IS  F.                                              
       01   L445H-PRINT-REC          PIC X(132).                                
                                                                                
       FD   P13445AI                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS  ARE OMITTED                                         
            RECORDING MODE  IS  F.                                              
       01   L445I-PRINT-REC          PIC X(132).                                
                                                                                
       FD   P13445AJ                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL  RECORDS  ARE OMITTED                                         
            RECORDING MODE  IS  F.                                              
       01   L445J-PRINT-REC          PIC X(132).                                
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *=======================*                                                 
       COPY SERSCH.                                                             
                                                                                
       01 WS-SERS-VARIABLES.                                                    
          05 WS-ALLOC-SCH                     PIC X(03).                        
          05 WS-SCH-FND                       PIC X(01).                        
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE P13L445AA, BP13L445D HEADING LINES              *             
      *-----------------------------------------------------------*             
       01  PRT-L445-HDG-1.                                                      
           05  L445-REPORT-ID       PIC X(10)  VALUE SPACES.                    
           05  FILLER               PIC X(08) VALUE '    HDB3'.                 
           05  FILLER               PIC X(27) VALUE SPACES.                     
           05  FILLER               PIC X(39) VALUE                             
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER               PIC X(14) VALUE SPACES.                     
           05  FILLER               PIC X(7)  VALUE 'DATE : '.                  
           05  L445-CURRENT-DATE    PIC X(10) VALUE SPACES.                     
           05  FILLER               PIC X(4)  VALUE SPACES.                     
           05  FILLER               PIC X(7)  VALUE 'PAGE : '.                  
           05  L445-PAGE            PIC ZZZZ9.                                  
                                                                                
       01  PRT-L445-HDG-2.                                                      
           05  FILLER               PIC X(30) VALUE                             
               'HOUSING AND DEVELOPMENT BOARD'.                                 
           05  FILLER               PIC X(20) VALUE SPACES.                     
           05  FILLER               PIC X(30) VALUE                             
               'P A Y M E N T    V O U C H E R'.                                
                                                                                
       01  PRT-L445-HDG-3.                                                      
           05  L445-REPORT-ID-DESC  PIC X(132).                                 
                                                                                
       01  PRT-L445-HDG-4.                                                      
           05  FILLER               PIC X(46) VALUE SPACES.                     
           05  FILLER               PIC X(85) VALUE ALL '-'.                    
                                                                                
       01  PRT-L445-HDG-5.                                                      
           05  FILLER               PIC X(46) VALUE                             
               'SALES UNIT (AGREEMENT TEAM)'.                                   
           05  FILLER               PIC X(1)  VALUE '¦'.                        
           05  FILLER               PIC X(27) VALUE                             
               ' FOR FINANCE DEPARTMENT USE'.                                   
           05  FILLER               PIC X(21) VALUE SPACES.                     
           05  FILLER               PIC X(36) VALUE                             
               '¦  BATCH NO    :                   ¦'.                          
                                                                                
       01  PRT-L445-HDG-6.                                                      
           05  FILLER               PIC X(46) VALUE SPACES.                     
           05  FILLER               PIC X(1)  VALUE '¦'.                        
           05  FILLER               PIC X(48) VALUE SPACES.                     
           05  FILLER               PIC X(1)  VALUE '¦'.                        
           05  FILLER               PIC X(34) VALUE SPACES.                     
           05  FILLER               PIC X(1)  VALUE '¦'.                        
                                                                                
       01  PRT-L445-HDG-7.                                                      
           05  FILLER               PIC X(46) VALUE 'SYSTEM CODE : 04'.         
           05  FILLER               PIC X(14) VALUE '¦ CHECKED BY :'.           
           05  FILLER               PIC X(35) VALUE SPACES.                     
           05  FILLER               PIC X(17) VALUE '¦               '.         
           05  FILLER               PIC X(14) VALUE SPACES.                     
           05  FILLER               PIC X(4)  VALUE SPACES.                     
           05  FILLER               PIC X(1)  VALUE '¦'.                        
                                                                                
       01  PRT-L445-HDG-8.                                                      
           05  FILLER               PIC X(46) VALUE                             
              'GL CODE     : 0000000104250'.                                    
           05  FILLER               PIC X(85) VALUE ALL '-'.                    
                                                                                
       01  PRT-L445-HDG-9.                                                      
           05  FILLER               PIC X(46) VALUE                             
              'DESCRIPTION : STAMP FEES'.                                       
                                                                                
       01  PRT-L445-HDG-10.                                                     
           05  FILLER               PIC X(53)   VALUE                           
              'PAYABLE TO  : COMMISSIONER OF STAMP DUTIES         '.            
           05  FILLER               PIC X(13)   VALUE  SPACES.                  
           05  FILLER               PIC X(20)   VALUE                           
              'BANK   : DBS        '.                                           
           05  FILLER               PIC X(11)   VALUE  SPACES.                  
           05  FILLER               PIC X(18)   VALUE                           
              'BANK CODE   : 7171'.                                             
                                                                                
       01  PRT-L445-HDG-10A.                                                    
           05  FILLER               PIC X(24)   VALUE                           
              'A/C NO      : 0010468600'.                                       
           05  FILLER               PIC X(42)   VALUE  SPACES.                  
           05  FILLER               PIC X(20)   VALUE                           
              'BRANCH : SHENTON WAY'.                                           
           05  FILLER               PIC X(11)   VALUE  SPACES.                  
           05  FILLER               PIC X(17)   VALUE                           
              'BRANCH CODE : 001'.                                              
                                                                                
       01  PRT-L445-HDG-11.                                                     
           05  FILLER               PIC X(11)   VALUE                           
               'REMITTANCE '.                                                   
           05  FILLER               PIC X(55)   VALUE                           
              'ADVICE  DESPATCH TO :  C/O SC(STAMPING) OF SALES UNIT'.          
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE P13L445AA & BP13L445D SUB-HEADING LINES         *             
      *-----------------------------------------------------------*             
       01  PRT-L445-SUBHDG-1.                                                   
           05  FILLER               PIC X(69) VALUE SPACES.                     
           05  FILLER               PIC X(19) VALUE                             
               'DATE OF    MORTGAGE'.                                           
           05  FILLER               PIC X(4)  VALUE SPACES.                     
           05  FILLER               PIC X(7)  VALUE 'DUP'.                      
           05  L445-SUP-LEASE-DESC  PIC X(10) VALUE SPACES.                     
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(8)  VALUE 'DUP'.                      
                                                                                
       01  PRT-L445-SUBHDG-2.                                                   
           05  FILLER               PIC X(4)  VALUE 'S/NO'.                     
           05  FILLER               PIC X     VALUE SPACE.                      
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.               
           05  FILLER               PIC X(5)  VALUE SPACES.                     
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.                  
           05  FILLER               PIC X     VALUE SPACE.                      
           05  FILLER               PIC X(5)  VALUE 'BLOCK'.                    
           05  FILLER               PIC X     VALUE SPACE.                      
           05  FILLER               PIC X(25) VALUE                             
               'FLAT ADDRESS/STREET NAME'.                                      
           05  FILLER               PIC X(1)  VALUE SPACE.                      
           05  FILLER               PIC X(8)  VALUE 'FLAT NO'.                  
           05  FILLER               PIC X(9)  VALUE 'SALES ORD'.                
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(9)  VALUE 'STAMP FEE'.                
           05  FILLER               PIC X(3)  VALUE SPACES.                     
           05  FILLER               PIC X(3)  VALUE 'DOA'.                      
           05  FILLER               PIC X(4)  VALUE SPACES.                     
           05  FILLER               PIC X(9)  VALUE 'STAMP FEE'.                
           05  FILLER               PIC X(3)  VALUE SPACES.                     
           05  FILLER               PIC X(2)  VALUE 'SA'.                       
           05  FILLER               PIC X(5)  VALUE SPACES.                     
           05  L445-TAG-DESC        PIC X(3)  VALUE 'TAG'.                      
           05  FILLER               PIC X(6)  VALUE SPACES.                     
           05  FILLER               PIC X(5)  VALUE 'TOTAL'.                    
                                                                                
       01  PRT-L445-SUBHDG-3.                                                   
           05  FILLER               PIC X(4)  VALUE ALL '-'.                    
           05  FILLER               PIC X     VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE ALL '-'.                    
           05  FILLER               PIC X     VALUE SPACES.                     
           05  FILLER               PIC X(8)  VALUE ALL '-'.                    
           05  FILLER               PIC X     VALUE SPACES.                     
           05  FILLER               PIC X(5)  VALUE ALL '-'.                    
           05  FILLER               PIC X     VALUE SPACES.                     
           05  FILLER               PIC X(25) VALUE ALL '-'.                    
           05  FILLER               PIC X(1)  VALUE SPACES.                     
           05  FILLER               PIC X(7)  VALUE ALL '-'.                    
           05  FILLER               PIC X(1)  VALUE SPACES.                     
           05  FILLER               PIC X(9)  VALUE ALL '-'.                    
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE ALL '-'.                    
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(5)  VALUE ALL '-'.                    
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(10) VALUE ALL '-'.                    
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(5)  VALUE ALL '-'.                    
           05  FILLER               PIC X(2)  VALUE SPACES.                     
           05  FILLER               PIC X(14) VALUE ALL '-'.                    
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE P13L445AA & BP13L445D DETAIL LINES              *             
      *-----------------------------------------------------------*             
       01  L445-REC-DETAIL.                                                     
           05  L445-SERIAL-NO               PIC ZZZ9.                           
           05  FILLER                       PIC X     VALUE SPACE.              
           05  L445-SCH-ACC                 PIC X(14) VALUE SPACES.             
           05  FILLER                       PIC X     VALUE SPACE.              
           05  L445-REGN-NO                 PIC X(8)  VALUE SPACES.             
           05  FILLER                       PIC X     VALUE SPACE.              
           05  L445-BLKNO                   PIC X(5)  VALUE SPACES.             
           05  FILLER                       PIC X     VALUE SPACE.              
           05  L445-STREET                  PIC X(25) VALUE SPACES.             
           05  FILLER                       PIC X     VALUE SPACE.              
           05  L445-FLATNO                  PIC X(7)  VALUE SPACES.             
           05  FILLER                       PIC X     VALUE SPACE.              
           05  L445-SALE-DD                 PIC X(2)  VALUE SPACES.             
           05  L445-DASH1                   PIC X     VALUE SPACE.              
           05  L445-SALE-MM                 PIC X(2)  VALUE SPACES.             
           05  L445-DASH2                   PIC X     VALUE SPACE.              
           05  L445-SALE-CC                 PIC X(2)  VALUE SPACES.             
           05  L445-SALE-YY                 PIC X(2)  VALUE SPACES.             
           05  FILLER                       PIC X(1)  VALUE SPACES.             
           05  L445-MORT-SF                 PIC $$$,$$9.99.                     
           05  FILLER                       PIC X(2)  VALUE SPACES.             
           05  L445-DUP-DOA                 PIC $9.99.                          
           05  FILLER                       PIC X(2)  VALUE SPACES.             
           05  L445-SUP-LEASE-STAMP         PIC $$$,$$9.99.                     
           05  FILLER                       PIC X(2)  VALUE SPACES.             
           05  L445-DUP-SA                  PIC $9.99.                          
           05  FILLER                       PIC X(2)  VALUE SPACES.             
           05  L445-TAG                     PIC X.                              
           05  FILLER                       PIC X(2)  VALUE SPACES.             
           05  L445-DETL-AMT-TOTAL          PIC $$$$,$$9.99.                    
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE P13L445AA & BP13L445D TOTAL LINES               *             
      *-----------------------------------------------------------*             
       01  PRT-L445-DASH-LINE.                                                  
           05  FILLER                       PIC X(78)   VALUE SPACES.           
           05  FILLER                       PIC X(54)   VALUE ALL '='.          
                                                                                
       01  PRT-L445-TOTAL-LINE.                                                 
           05  FILLER                       PIC X(35) VALUE SPACES.             
           05  FILLER                       PIC X(13) VALUE                     
               'SERIAL NO : ('.                                                 
           05  L445-VR-NO-LOW               PIC X(4)  VALUE '0001'.             
           05  FILLER                       PIC X(4)  VALUE ' TO '.             
           05  L445-VR-NO-HIGH              PIC X(4)  VALUE '0025'.             
           05  FILLER                       PIC X(4)  VALUE ')'.                
           05  FILLER                       PIC X(14) VALUE 'TOTAL :'.          
           05  L445-TOTAL-MORT-SF           PIC $,$$$,$$9.99.                   
           05  FILLER                       PIC X(1)  VALUE SPACES.             
           05  L445-TOTAL-DUP-DOA           PIC $$9.99.                         
           05  L445-TOTAL-SUP-LEASE-SF      PIC $,$$$,$$9.99.                   
           05  FILLER                       PIC X(1)  VALUE SPACES.             
           05  L445-TOTAL-DUP-SA            PIC $$9.99.                         
           05  FILLER                       PIC X(4)  VALUE SPACES.             
           05  L445-TOTAL-AMT               PIC $,$$$,$$9.99.                   
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE P13L445AA, BP13L445D FOOTING LINES              *             
      *-----------------------------------------------------------*             
       01  PRT-L445-FTG-1.                                                      
           05  FILLER              PIC X(15)   VALUE 'NET PAYABLE  : '.         
           05  L445-AMT-WORDS.                                                  
               10  L445-AMT-DESC1  PIC X(60)   VALUE SPACES.                    
               10  L445-AMT-DESC2  PIC X(60)   VALUE SPACES.                    
                                                                                
       01  PRT-L445-FTG-2.                                                      
           05  FILLER              PIC X(35)   VALUE SPACES.                    
           05  FILLER              PIC X(14)   VALUE 'CHECKED BY :'.            
           05  FILLER              PIC X(15)   VALUE ALL '_'.                   
           05  FILLER              PIC X(10)   VALUE SPACES.                    
           05  FILLER              PIC X(16)   VALUE 'CERTIFIED BY :'.          
           05  FILLER              PIC X(15)   VALUE ALL '_'.                   
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE BP13L445  HEADING LINES                         *             
      *-----------------------------------------------------------*             
       01  MAIN-HEADER.                                                         
           05  HEADER-LISTID             PIC X(8)  VALUE SPACES.                
           05  FILLER                    PIC X(16) VALUE SPACES.                
           05  FILLER                    PIC X(4)  VALUE 'HDB3'.                
           05  FILLER                    PIC X(16) VALUE SPACES.                
           05  FILLER                    PIC X(39) VALUE                        
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                    PIC X(16) VALUE SPACES.                
           05  FILLER                    PIC X(7)  VALUE 'DATE : '.             
           05  HEADER-DATE.                                                     
               10  WS-DD                 PIC X(2)  VALUE SPACES.                
               10  FILLER                PIC X     VALUE '/'.                   
               10  WS-MM                 PIC X(2)  VALUE SPACES.                
               10  FILLER                PIC X     VALUE '/'.                   
               10  WS-CC                 PIC X(2)  VALUE SPACES.                
               10  WS-YY                 PIC X(2)  VALUE SPACES.                
           05  FILLER                    PIC X(4)  VALUE SPACES.                
           05  FILLER                    PIC X(7)  VALUE 'PAGE : '.             
           05  HEADER-PAGE               PIC ZZZZ9.                             
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE ERROR MESSAGE FORMAT                            *             
      *-----------------------------------------------------------*             
       01  WS-ERRMSG-HEADER.                                                    
           05  FILLER                       PIC X(46) VALUE                     
               ' *************   ERROR MESSAGE   *************'.                
                                                                                
       01  WS-ERROR.                                                            
           05  FILLER                       PIC X(24) VALUE                     
               ' ERROR ENCOUNTERED WHEN '.                                      
           05  WS-CUR-PROC                  PIC X(21).                          
                                                                                
       01  WS-FILE-STATUS.                                                      
           05  FILLER                       PIC X(15) VALUE                     
               ' STATUS CODE = '.                                               
           05  WS-CUR-STATUS                PIC X(2).                           
                                                                                
      *-----------------------------------------------------------*             
      *    DEFINE SUMMARY FORMAT                                  *             
      *-----------------------------------------------------------*             
       01  WS-SUMMARY-HEADER.                                                   
           05  FILLER                       PIC X     VALUE SPACES.             
           05  FILLER                       PIC X(16) VALUE ALL '*'.            
           05  FILLER                       PIC X(20) VALUE                     
               'BP13C445 SUMMARY RPT'.                                          
           05  FILLER                       PIC X(19) VALUE ALL '*'.            
                                                                                
       01  WS-READ-CASES.                                                       
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF RECORDS READ FROM TRANS FILE  (BP13F315) = '.            
           05  WS-EDIT-BP13F315-READ        PIC ZZZ9.                           
                                                                                
       01  WS-DOA-PAYMENT-PRINTED.                                              
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF DOA PAYMENTS   (P13L445AA)               = '.            
           05  WS-EDIT-L445A-PRINT          PIC ZZZ9.                           
                                                                                
       01  WS-L445D-PRINTED.                                                    
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF                (P13L445AD)               = '.            
           05  WS-EDIT-L445D-PRINT          PIC ZZZ9.                           
                                                                                
       01  WS-L445E-PRINTED.                                                    
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF                (P13L445AE)               = '.            
           05  WS-EDIT-L445E-PRINT          PIC ZZZ9.                           
                                                                                
       01  WS-L445G-PRINTED.                                                    
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF                (P13L445AG)               = '.            
           05  WS-EDIT-L445G-PRINT          PIC ZZZ9.                           
                                                                                
       01  WS-L445H-PRINTED.                                                    
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF                (P13L445AH)              = '.             
           05  WS-EDIT-L445H-PRINT          PIC ZZZ9.                           
                                                                                
       01  WS-L445I-PRINTED.                                                    
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF                (P13L445AI)               = '.            
           05  WS-EDIT-L445I-PRINT          PIC ZZZ9.                           
                                                                                
       01  WS-L445J-PRINTED.                                                    
           05  FILLER                       PIC X(52) VALUE                     
               ' NO OF                (P13L445AJ)               = '.            
           05  WS-EDIT-L445J-PRINT          PIC ZZZ9.                           
                                                                                
       01  WS-SUMMARY-TRAILER.                                                  
           05  FILLER                       PIC X     VALUE SPACES.             
           05  FILLER                       PIC X(55) VALUE ALL '*'.            
                                                                                
      *-----------------------------------------------------------*             
      *    CONSTANTS LIST                                         *             
      *-----------------------------------------------------------*             
       01  WS-ERROR-PROCEDURE-NAMES.                                            
           05  CLOSE-K006                   PIC X(21) VALUE                     
                   'CLOSING FILE  B05K006'.                                     
           05  CLOSE-K410                   PIC X(21) VALUE                     
                   'CLOSING FILE BP13K410'.                                     
           05  NOTFND-IN-FIS                PIC X(23) VALUE                     
                   'REC NOT FOUND IN K310'.                                     
           05  NOTFND-IN-MST                PIC X(23) VALUE                     
                   'REC NOT FOUND IN K006'.                                     
           05  NOTFND-IN-SO                 PIC X(23) VALUE                     
                   'REC NOT FOUND IN K410'.                                     
           05  OPEN-K006                    PIC X(21) VALUE                     
                   'OPENING FILE  B05K006'.                                     
           05  OPEN-K410                    PIC X(21) VALUE                     
                   'OPENING FILE BP13K410'.                                     
           05  READ-F315                    PIC X(21) VALUE                     
                   'READING FILE BP13F315'.                                     
           05  READ-K006                    PIC X(21) VALUE                     
                   'READING FILE  B05K006'.                                     
           05  READ-K410                    PIC X(21) VALUE                     
                   'READING FILE BP13K410'.                                     
                                                                                
       01  DUP-DOA-AMT                      PIC 9V99  VALUE ZEROS.              
       01  DUP-SA-AMT                       PIC 9V99  VALUE ZEROS.              
       01  HYPHEN                           PIC X     VALUE '-'.                
       01  MAX-REC-PER-PAGE                 PIC 9(2)  VALUE 39.                 
       01  MAX-DETLS-PER-PAGE               PIC 9(3)  VALUE 25.                 
                                                                                
                                                                                
      *-----------------------------------------------------------*             
      *    LEVEL-88 VARIABLES                                     *             
      *-----------------------------------------------------------*             
       01  WS-EOF                           PIC X     VALUE 'N'.                
           88  END-OF-BP13F315                        VALUE 'Y'.                
       01  WS-REPORT-ID-SW                  PIC X(1)  VALUE SPACE.              
       01  WS-PREV-REPORT-ID                PIC X(1)  VALUE SPACE.              
           88  REPORT-L445A                           VALUE 'A'.                
           88  REPORT-L445D                           VALUE 'D'.                
           88  REPORT-L445E                           VALUE 'E'.                
           88  REPORT-L445G                           VALUE 'G'.                
           88  REPORT-L445H                           VALUE 'H'.                
           88  REPORT-L445I                           VALUE 'I'.                
           88  REPORT-L445J                           VALUE 'J'.                
                                                                                
                                                                                
      *-----------------------------------------------------------*             
      *    OTHER VARIABLES                                        *             
      *-----------------------------------------------------------*             
       01  WS-COUNTERS.                                                         
           05  WS-BP13F315-READ-CNT         PIC 9(4)    VALUE ZEROS.            
           05  WS-BP13F680-WRITE-CNT        PIC 9(4)   VALUE ZEROES.            
      *    -----------------------                                              
      *    FOR L445A - DOA LISTING                                              
      *    -----------------------                                              
           05  WS-L445A-PRINT-CNT           PIC 9(4)    VALUE ZEROS.            
           05  WS-L445A-PAGE-CNT            PIC 9(5)    VALUE ZEROS.            
           05  WS-L445A-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.               
           05  WS-L445A-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L445A-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L445A-SUP-CNT             PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L445A-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L445A-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.            
      *    -----------------------                                              
      *    FOR L445D -     LISTING                                              
      *    -----------------------                                              
           05  WS-L445D-PRINT-CNT           PIC 9(4)    VALUE ZEROS.            
           05  WS-L445D-PAGE-CNT            PIC 9(5)    VALUE ZEROS.            
           05  WS-L445D-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.               
           05  WS-L445D-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L445D-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L445D-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L445D-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L445D-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.            
                                                                                
      *    -----------------------                                              
      *    FOR L445E -     LISTING                                              
      *    -----------------------                                              
           05  WS-L445E-PRINT-CNT           PIC 9(4)    VALUE ZEROS.            
           05  WS-L445E-PAGE-CNT            PIC 9(5)    VALUE ZEROS.            
           05  WS-L445E-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.               
           05  WS-L445E-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L445E-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L445E-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L445E-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L445E-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.            
                                                                                
      *    -----------------------                                              
      *    FOR L445G -     LISTING                                              
      *    -----------------------                                              
           05  WS-L445G-PRINT-CNT           PIC 9(4)    VALUE ZEROS.            
           05  WS-L445G-PAGE-CNT            PIC 9(5)    VALUE ZEROS.            
           05  WS-L445G-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.               
           05  WS-L445G-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L445G-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L445G-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L445G-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L445G-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.            
                                                                                
      *    -----------------------                                              
      *    FOR L445H -     LISTING                                              
      *    -----------------------                                              
           05  WS-L445H-PRINT-CNT           PIC 9(4)    VALUE ZEROS.            
           05  WS-L445H-PAGE-CNT            PIC 9(5)    VALUE ZEROS.            
           05  WS-L445H-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.               
           05  WS-L445H-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L445H-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L445H-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L445H-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L445H-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.            
                                                                                
      *    -----------------------                                              
      *    FOR L445I -     LISTING                                              
      *    -----------------------                                              
           05  WS-L445I-PRINT-CNT           PIC 9(4)    VALUE ZEROS.            
           05  WS-L445I-PAGE-CNT            PIC 9(5)    VALUE ZEROS.            
           05  WS-L445I-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.               
           05  WS-L445I-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L445I-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L445I-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L445I-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L445I-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.            
                                                                                
      *    -----------------------                                              
      *    FOR L445J -     LISTING                                              
      *    -----------------------                                              
           05  WS-L445J-PRINT-CNT           PIC 9(4)    VALUE ZEROS.            
           05  WS-L445J-PAGE-CNT            PIC 9(5)    VALUE ZEROS.            
           05  WS-L445J-REC-ON-PAGE-CNT     PIC 9(2)    VALUE 66.               
           05  WS-L445J-MORT-CNT            PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L445J-DUP-DOA-CNT         PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L445J-LEASE-CNT           PIC 9(7)V99 VALUE ZEROS.            
           05  WS-L445J-DUP-SA-CNT          PIC 9(3)V99 VALUE ZEROS.            
           05  WS-L445J-IND-TOT-CNT         PIC 9(7)V99 VALUE ZEROS.            
                                                                                
       01  WS-CURRENT-DATE.                                                     
           10  WS-CURRENT-CC                PIC 9(2)    VALUE 00.               
           10  WS-CURRENT-YYMMDD.                                               
               15  WS-CURRENT-YY            PIC 9(2)    VALUE 00.               
               15  WS-CURRENT-MM            PIC 9(2)    VALUE 00.               
               15  WS-CURRENT-DD            PIC 9(2)    VALUE 00.               
                                                                                
       01  WS-EDITED-DATE.                                                      
           10  WS-EDITED-DD                 PIC 9(2)    VALUE 00.               
           10  FILLER                       PIC X(1)    VALUE '/'.              
           10  WS-EDITED-MM                 PIC 9(2)    VALUE 00.               
           10  FILLER                       PIC X(1)    VALUE '/'.              
           10  WS-EDITED-CC                 PIC 9(2)    VALUE 00.               
           10  WS-EDITED-YY                 PIC 9(2)    VALUE 00.               
                                                                                
       01  WS-FLATNO.                                                           
           05  WS-NUM-LEVEL                 PIC X(2).                           
           05  FILLER                       PIC X       VALUE '-'.              
           05  WS-NUM-MAIN                  PIC X(5).                           
                                                                                
       01  WS-SCH-ACC.                                                          
           05  WS-SCH                       PIC X(4).                           
           05  WS-SCH-SEP1                  PIC X.                              
           05  WS-ACC                       PIC X(4).                           
           05  WS-SCH-SEP2                  PIC X.                              
           05  WS-CHK                       PIC X.                              
           05  WS-SCH-SEP3                  PIC X.                              
           05  WS-LESCDE                    PIC X(2).                           
                                                                                
       01  WS-F315-ACC-CHK.                                                     
           05  WS-F315-ACC                  PIC X(4).                           
           05  WS-F315-CHK                  PIC X(1).                           
                                                                                
       01  WS-SO-DATE.                                                          
           05  WS-SO-CC                     PIC X(2).                           
           05  WS-SO-YY                     PIC X(2).                           
           05  WS-SO-MM                     PIC X(2).                           
           05  WS-SO-DD                     PIC X(2).                           
                                                                                
       01  WS-SALE-DATE.                                                        
           05  WS-SALE-CC                   PIC X(2).                           
           05  WS-SALE-YY                   PIC X(2).                           
           05  WS-SALE-MM                   PIC X(2).                           
           05  WS-SALE-DD                   PIC X(2).                           
                                                                                
       01  WS-TEMPORARY-BUFFER.                                                 
           05  WS-TEMP-TOTAL                PIC 9(7)V99.                        
                                                                                
       01  WS-BLANK-LINE                    PIC X     VALUE SPACES.             
       01  WS-F315-STATUS                   PIC 9(2)  VALUE ZEROS.              
       01  WS-K006-STATUS                   PIC 9(2)  VALUE ZEROS.              
       01  WS-K410-STATUS                   PIC 9(2)  VALUE ZEROS.              
       01  WS-DEF-DUP-LEASE                 PIC 99V99 VALUE ZEROS.              
       01  WS-LEASE-SF                      PIC S9(5)V99.                       
       01  WS-LEASE-STAMP                   PIC S9(5)V99 VALUE ZEROS.           
       01  WS-MORT-SF                       PIC S9(5)V99.                       
       01  WS-SUP-SF                        PIC S9(5)V99.                       
       01  WS-DUP-DOA                       PIC 99V99.                          
       01  WS-DUP-SA                        PIC 99V99.                          
                                                                                
      *----------------------------------------------------------*              
      *    WS VARIABLES USED BY F680                             *              
      *----------------------------------------------------------*              
       01  WS-NEW-VOUCHER                   PIC X      VALUE 'Y'.               
       01  WS-SCH-ACCT-NO                   PIC X(11)  VALUE SPACES.            
       01  WS-TXT-INFO                      PIC X(50)  VALUE SPACES.            
       01  WS-CNT-DETAILS                   PIC 9(4)   VALUE ZEROES.            
       01  WS-AMT-TRANS                     PIC 9(7)V99 VALUE ZEROES.           
       01  WS-AMT-TOTAL                     PIC 9(7)V99 VALUE ZEROES.           
       01  WS-PREV-SA-TP-TAG                PIC X(1)   VALUE SPACE.             
       01  WS-L445A-DESC.                                                       
           05  FILLER                       PIC X(35)  VALUE SPACES.            
           05  FILLER                       PIC X(46)  VALUE                    
              'DEED OF ASSIGNMENT AND SUPPLEMENTAL AGREEMENT'.                  
           05  FILLER                       PIC X(12)  VALUE                    
              'FOR SOC FLAT'.                                                   
       01  WS-L445D-DESC.                                                       
           05  FILLER                       PIC X(38)  VALUE SPACES.            
           05  FILLER                       PIC X(55)  VALUE                    
              'AGREEMENT OF LEASE AND DEED OF ASSIGNMENT OF SOC FLAT'.          
       01  WS-L445E-DESC.                                                       
           05  FILLER                       PIC X(38)  VALUE SPACES.            
           05  FILLER                       PIC X(57)  VALUE                    
            'AGREEMENT OF LEASE AND DEED OF ASSIGNMENT OF SOC FLAT(01)'.        
       01  WS-L445G-DESC.                                                       
           05  FILLER                       PIC X(38)  VALUE SPACES.            
           05  FILLER                       PIC X(57)  VALUE                    
            'AGREEMENT OF LEASE AND DEED OF ASSIGNMENT OF SOC FLAT(2B)'.        
       01  WS-L445H-DESC.                                                       
           05  FILLER                       PIC X(38)  VALUE SPACES.            
           05  FILLER                       PIC X(57)  VALUE                    
            'AGREEMENT OF LEASE AND DEED OF ASSIGNMENT OF SOC FLAT(03)'.        
       01  WS-L445I-DESC.                                                       
           05  FILLER                       PIC X(38)  VALUE SPACES.            
           05  FILLER                       PIC X(57)  VALUE                    
            'AGREEMENT OF LEASE AND DEED OF ASSIGNMENT OF SOC FLAT(3A)'.        
       01  WS-L445J-DESC.                                                       
           05  FILLER                       PIC X(38)  VALUE SPACES.            
           05  FILLER                       PIC X(42)  VALUE                    
              'AGREEMENT OF LEASE AND DEED OF ASSIGNMENT '.                     
           05  FILLER                       PIC X(17)  VALUE                    
              'OF SOC FLAT(SERS)'.                                              
                                                                                
      *----------------------------------------------------------*              
      *    WS VARIABLES PASSED FROM SUB-PROGRAM "AG07C907"       *              
      *----------------------------------------------------------*              
       COPY AG7C907C.                                                           
                                                                                
      *----------------------------------------------------------*              
      *    WS VARIABLES FOR CONVERTING AMOUNT TO WORDS           *              
      *----------------------------------------------------------*              
       01  WS-SUBSCRIPTS.                                                       
           05  WA-SUB              PIC 999   VALUE 0.                           
           05  WF-SUB              PIC 999   VALUE 0.                           
           05  WL-SUB              PIC 999   VALUE 0.                           
           05  WS-SUB              PIC 999   VALUE 0.                           
           05  WS-FIRST-SUB        PIC 999   VALUE 0.                           
                                                                                
       01  WA-NAMES.                                                            
           05  FILLER              PIC X(10) VALUE '3ONE      '.                
           05  FILLER              PIC X(10) VALUE '3TWO      '.                
           05  FILLER              PIC X(10) VALUE '5THREE    '.                
           05  FILLER              PIC X(10) VALUE '4FOUR     '.                
           05  FILLER              PIC X(10) VALUE '4FIVE     '.                
           05  FILLER              PIC X(10) VALUE '3SIX      '.                
           05  FILLER              PIC X(10) VALUE '5SEVEN    '.                
           05  FILLER              PIC X(10) VALUE '5EIGHT    '.                
           05  FILLER              PIC X(10) VALUE '4NINE     '.                
           05  FILLER              PIC X(10) VALUE '3TEN      '.                
           05  FILLER              PIC X(10) VALUE '6ELEVEN   '.                
           05  FILLER              PIC X(10) VALUE '6TWELVE   '.                
           05  FILLER              PIC X(10) VALUE '8THIRTEEN '.                
           05  FILLER              PIC X(10) VALUE '8FOURTEEN '.                
           05  FILLER              PIC X(10) VALUE '7FIFTEEN  '.                
           05  FILLER              PIC X(10) VALUE '7SIXTEEN  '.                
           05  FILLER              PIC X(10) VALUE '9SEVENTEEN'.                
           05  FILLER              PIC X(10) VALUE '8EIGHTEEN '.                
           05  FILLER              PIC X(10) VALUE '8NINETEEN '.                
           05  FILLER              PIC X(10) VALUE '6TWENTY   '.                
           05  FILLER              PIC X(10) VALUE '6THIRTY   '.                
           05  FILLER              PIC X(10) VALUE '5FORTY    '.                
           05  FILLER              PIC X(10) VALUE '5FIFTY    '.                
           05  FILLER              PIC X(10) VALUE '5SIXTY    '.                
           05  FILLER              PIC X(10) VALUE '7SEVENTY  '.                
           05  FILLER              PIC X(10) VALUE '6EIGHTY   '.                
           05  FILLER              PIC X(10) VALUE '6NINETY   '.                
       01  WA-NAMER REDEFINES WA-NAMES.                                         
           05  WA-NAME             PIC X(10) OCCURS 27 TIMES.                   
                                                                                
       01  WS-LITERALS.                                                         
           05  L-CENT              PIC X(5)  VALUE '4CENT'.                     
           05  L-AND               PIC X(4)  VALUE '3AND'.                      
           05  L-X                 PIC X     VALUE '%'.                         
           05  L-MILLION           PIC X(8)  VALUE '7MILLION'.                  
           05  L-THOUSAND          PIC X(9)  VALUE '8THOUSAND'.                 
           05  L-DOLLARS           PIC X(8)  VALUE '7DOLLARS'.                  
           05  L-CENTS             PIC X(6)  VALUE '6CENTS'.                    
           05  L-ONLY              PIC X(6)  VALUE '5ONLY '.                    
           05  L-HUNDRED           PIC X(8)  VALUE '7HUNDRED'.                  
           05  L-DOLLAR            PIC X(7)  VALUE '6DOLLAR'.                   
                                                                                
       01  SWITCHES.                                                            
           05  WS-SWITCH           PIC 9     VALUE 0.                           
           05  WS-THO-SW           PIC 9     VALUE 0.                           
           05  WS-CNT-SW           PIC 9     VALUE 0.                           
           05  WS-LIT-SW           PIC 9     VALUE 0.                           
           05  WS-TEN-SW           PIC 9     VALUE 0.                           
           05  WS-AND-SW           PIC 9     VALUE 0.                           
                                                                                
       01  WS-PLACE-COUNTER        PIC 999   VALUE 0.                           
       01  WL-AREA-SAVE            PIC X(12) VALUE SPACES.                      
       01  WS-RESULT               PIC 999   VALUE 0.                           
       01  WL-AREA.                                                             
           05  WL-ITEM1            PIC 9     VALUE 0.                           
           05  FILLER              PIC X(11) VALUE SPACE.                       
       01  WL-ITM REDEFINES WL-AREA.                                            
           05  WL-ITEM             PIC X     OCCURS 12 TIMES.                   
                                                                                
       01  WS-CHEQUE-DETAILS.                                                   
           05  WS-AMT              PIC 9(7)V99 VALUE 0.                         
           05  WS-DIGIT REDEFINES  WS-AMT OCCURS 9 TIMES PIC 9.                 
           05  WF-DETAILS.                                                      
               10  WF-LINE-1       PIC X(60).                                   
               10  WF-LINE-2       PIC X(60).                                   
           05  WF-ITEM REDEFINES WF-DETAILS OCCURS 120 PIC X.                   
           05  WP-ITEM REDEFINES WF-DETAILS OCCURS 2 PIC X(60).                 
                                                                                
                                                                                
      ********************                                                      
       PROCEDURE DIVISION.                                                      
      ********************                                                      
                                                                                
      ******************************************************************        
       0000-CONTROL.                                                            
      ******************************************************************        
            PERFORM  0100-SET-DATE               THRU  0100-EXIT.               
            PERFORM  0200-OPEN-FILES             THRU  0200-EXIT.               
            PERFORM  1100-READ-BP13F315          THRU  1100-EXIT.               
            PERFORM  0900-CHECK-SALES-TYPE       THRU  0900-EXIT.               
            MOVE     WS-REPORT-ID-SW             TO    WS-PREV-REPORT-ID        
            MOVE     F315-CDE-SA-TP-TAG          TO    WS-PREV-SA-TP-TAG        
            PERFORM  1000-READ-AND-PRINT-LOOP    THRU  1000-EXIT                
                          UNTIL END-OF-BP13F315.                                
            PERFORM  8000-DISPLAY-STATISTICS     THRU  8000-EXIT.               
            PERFORM  9000-CLOSE-FILES            THRU  9000-EXIT.               
                                                                                
       0000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       0100-SET-DATE.                                                           
      ******************************************************************        
            MOVE FUNCTION CURRENT-DATE TO WS-CURRENT-DATE.                      
                                                                                
            MOVE   WS-CURRENT-DD      TO   WS-EDITED-DD   WS-DD.                
            MOVE   WS-CURRENT-MM      TO   WS-EDITED-MM   WS-MM.                
            MOVE   WS-CURRENT-CC      TO   WS-EDITED-CC   WS-CC.                
            MOVE   WS-CURRENT-YY      TO   WS-EDITED-YY   WS-YY.                
                                                                                
            MOVE   WS-EDITED-DATE     TO   L445-CURRENT-DATE.                   
                                                                                
       0100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       0200-OPEN-FILES.                                                         
      ******************************************************************        
            OPEN INPUT  B05K006                                                 
                        BP13K410                                                
                 I-O    BP13F315                                                
                 OUTPUT P13445AA                                                
                        P13445AD                                                
                        P13445AE                                                
                        P13445AG                                                
                        P13445AH                                                
                        P13445AI                                                
                        P13445AJ.                                               
                                                                                
            IF WS-K006-STATUS NOT = 00 AND 97                                   
               MOVE    OPEN-K006                  TO   WS-CUR-PROC              
               MOVE    WS-K006-STATUS             TO   WS-CUR-STATUS            
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT                
               PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT.               
                                                                                
            IF WS-K410-STATUS NOT = 00 AND 97                                   
               MOVE    OPEN-K410                  TO    WS-CUR-PROC             
               MOVE    WS-K410-STATUS             TO    WS-CUR-STATUS           
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU  2000-EXIT               
               PERFORM 9000-CLOSE-FILES           THRU  9000-EXIT.              
                                                                                
       0200-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       0300-CHK-SERS.                                                           
      ******************************************************************        
      *-----------------------------------*                                     
      * SEARCH SCHEME IN ALLOC SCH TABLE  *                                     
      *-----------------------------------*                                     
           IF WS-ALLOC-SCH  NOT =  LOW-VALUES AND SPACES                        
               SET WS-SERS-PTR  TO 1                                            
               SEARCH WS-SERS-SCH                                               
                   AT END                                                       
                   MOVE 'N' TO WS-SCH-FND                                       
                   WHEN WS-SERS-SCHEME(WS-SERS-PTR) = WS-ALLOC-SCH              
                   MOVE 'Y' TO WS-SCH-FND                                       
               END-SEARCH                                                       
           ELSE                                                                 
               MOVE 'N' TO WS-SCH-FND                                           
           END-IF.                                                              
                                                                                
       0300-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       0900-CHECK-SALES-TYPE.                                                   
      ******************************************************************        
            MOVE F315-NUM-ALLOC-SCH  TO    WS-ALLOC-SCH.                        
            PERFORM 0300-CHK-SERS    THRU  0300-EXIT.                           
                                                                                
            IF  WS-SCH-FND = 'Y'                                                
                  MOVE  'J'           TO     WS-REPORT-ID-SW                    
                  GO TO 0900-EXIT                                               
            END-IF.                                                             
                                                                                
            IF F315-CDE-SA-TP-TAG = 'Y'                                         
               EVALUATE F315-CDE-SALES-TYPE                                     
               WHEN     '01'                                                    
               WHEN     '02'                                                    
                        MOVE    'E'    TO     WS-REPORT-ID-SW                   
               WHEN     '2B'                                                    
                        MOVE    'G'    TO     WS-REPORT-ID-SW                   
               WHEN     '03'                                                    
                        MOVE    'H'    TO     WS-REPORT-ID-SW                   
               WHEN     '3A'                                                    
                        MOVE    'I'    TO     WS-REPORT-ID-SW                   
               WHEN     '10'                                                    
                        MOVE    'D'    TO     WS-REPORT-ID-SW                   
               WHEN     '13'                                                    
                        MOVE    'D'    TO     WS-REPORT-ID-SW                   
               WHEN     '18'                                                    
                        MOVE    'D'    TO     WS-REPORT-ID-SW                   
               WHEN     '19'                                                    
                        MOVE    'D'    TO     WS-REPORT-ID-SW                   
               WHEN     OTHER                                                   
                        MOVE    ' '    TO     WS-REPORT-ID-SW                   
               END-EVALUATE                                                     
            ELSE                                                                
               EVALUATE F315-CDE-SALES-TYPE                                     
               WHEN     '01'                                                    
               WHEN     '02'                                                    
                        MOVE    'E'    TO     WS-REPORT-ID-SW                   
               WHEN     '2B'                                                    
                        MOVE    'G'    TO     WS-REPORT-ID-SW                   
               WHEN     '03'                                                    
                        MOVE    'H'    TO     WS-REPORT-ID-SW                   
               WHEN     '3A'                                                    
                        MOVE    'I'    TO     WS-REPORT-ID-SW                   
               WHEN     '10'                                                    
                        MOVE    'A'    TO     WS-REPORT-ID-SW                   
               WHEN     '13'                                                    
                        MOVE    'A'    TO     WS-REPORT-ID-SW                   
               WHEN     '18'                                                    
                        MOVE    'A'    TO     WS-REPORT-ID-SW                   
               WHEN     '19'                                                    
                        MOVE    'D'    TO     WS-REPORT-ID-SW                   
               WHEN     OTHER                                                   
                        MOVE    ' '    TO     WS-REPORT-ID-SW                   
               END-EVALUATE                                                     
            END-IF.                                                             
                                                                                
       0900-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1000-READ-AND-PRINT-LOOP.                                                
      ******************************************************************        
            MOVE F315-NUM-ALLOC-SCH TO WS-ALLOC-SCH.                            
            PERFORM 0300-CHK-SERS   THRU 0300-EXIT.                             
                                                                                
            IF F315-CDE-TRANS = 'ST'                                            
               IF (WS-REPORT-ID-SW    NOT = WS-PREV-REPORT-ID) OR               
                  (F315-CDE-SA-TP-TAG NOT = WS-PREV-SA-TP-TAG AND               
                   WS-SCH-FND NOT = 'Y')                                        
                   PERFORM  5000-WRITE-TRAILER-F680                             
                      THRU  5000-TRAILER-EXIT                                   
                   MOVE     ZEROES               TO  WS-CNT-DETAILS             
                   MOVE     ZEROES               TO  WS-TEMP-TOTAL              
                   MOVE     'Y'                  TO  WS-NEW-VOUCHER             
                   MOVE     WS-REPORT-ID-SW      TO  WS-PREV-REPORT-ID          
                   MOVE     F315-CDE-SA-TP-TAG   TO  WS-PREV-SA-TP-TAG          
               END-IF                                                           
               DISPLAY 'WS-NEW-VOUCHER = ' WS-NEW-VOUCHER                       
               PERFORM  1050-PROCESS-RECORD  THRU 1050-EXIT                     
               PERFORM  1060-PRINT-RECORD    THRU 1060-EXIT                     
               MOVE F315-CDE-SA-TP-TAG       TO   WS-PREV-SA-TP-TAG             
            END-IF.                                                             
                                                                                
            PERFORM 1100-READ-BP13F315       THRU 1100-EXIT.                    
            IF NOT END-OF-BP13F315                                              
               PERFORM 0900-CHECK-SALES-TYPE THRU 0900-EXIT                     
            END-IF.                                                             
                                                                                
       1000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1050-PROCESS-RECORD.                                                     
      ******************************************************************        
            PERFORM 1400-READ-K410 THRU 1400-EXIT.                              
                                                                                
            IF K410-AMT-LEASE-STAMP NOT NUMERIC                                 
               MOVE ZEROES TO K410-AMT-LEASE-STAMP.                             
                                                                                
            IF K410-AMT-LOAN NOT NUMERIC                                        
               MOVE ZEROS TO K410-AMT-LOAN.                                     
                                                                                
            IF K410-NUM-PREMIUM-RATE      NOT NUMERIC                           
               MOVE ZEROS TO K410-NUM-PREMIUM-RATE.                             
                                                                                
            IF K410-AMT-PREMIUM-STAMP-FEE NOT NUMERIC                           
               MOVE ZEROS TO K410-AMT-PREMIUM-STAMP-FEE.                        
                                                                                
            IF WS-NEW-VOUCHER = 'Y'                                             
                  PERFORM  5000-WRITE-HEADER-F680  THRU 5000-HEADER-EXIT        
                  MOVE    'N'   TO    WS-NEW-VOUCHER                            
            END-IF.                                                             
                                                                                
       1050-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1060-PRINT-RECORD.                                                       
      ******************************************************************        
            IF  WS-SCH-FND = 'Y'                                                
                PERFORM 2150-HANDLE-SER THRU  2150-EXIT                         
                GO  TO   1060-EXIT                                              
            END-IF.                                                             
                                                                                
            IF F315-CDE-SALES-TYPE = '01' OR '2B' OR '02' OR                    
                                     '03' OR '3A'                               
               PERFORM 2100-HANDLE-SALES-TYPE-TP        THRU 2100-EXIT          
            ELSE                                                                
               IF  F315-CDE-SALES-TYPE = '10' OR '13' OR '18' OR '19'           
                   IF F315-CDE-SA-TP-TAG = ' '                                  
                      PERFORM 2300-HANDLE-SALES-TYPE-10 THRU 2300-EXIT          
                   ELSE                                                         
                      IF  F315-CDE-SA-TP-TAG = 'Y'                              
                          PERFORM  2100-HANDLE-SALES-TYPE-TP                    
                             THRU  2100-EXIT                                    
                      END-IF                                                    
                   END-IF                                                       
               END-IF                                                           
            END-IF.                                                             
                                                                                
       1060-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1100-READ-BP13F315.                                                      
      ******************************************************************        
            READ BP13F315                                                       
              AT END                                                            
                 MOVE    'Y'  TO WS-EOF                                         
                 PERFORM 4200-PRINT-LAST-LINES THRU 4200-EXIT                   
                 GO TO   1100-EXIT.                                             
                                                                                
            IF F315-CDE-TRANS = 'ST'                                            
               ADD  1                 TO  WS-BP13F315-READ-CNT                  
      *        -----------------------------                                    
      *        SET UP KEY AND WORKING FIELDS                                    
      *        -----------------------------                                    
               MOVE F315-REGN-NO      TO  K410-KEY-FLD.                         
                                                                                
            MOVE    F315-SCH          TO  WS-SCH.                               
            MOVE    F315-ACC          TO  WS-F315-ACC-CHK.                      
            MOVE    WS-F315-ACC       TO  WS-ACC.                               
            MOVE    WS-F315-CHK       TO  WS-CHK.                               
            MOVE    F315-LESSEE-CODE  TO  WS-LESCDE.                            
            MOVE    HYPHEN            TO  WS-SCH-SEP1.                          
            MOVE    HYPHEN            TO  WS-SCH-SEP2.                          
            MOVE    HYPHEN            TO  WS-SCH-SEP3.                          
            MOVE    F315-NUM-LEVEL    TO  WS-NUM-LEVEL.                         
            MOVE    F315-NUM-MAIN     TO  WS-NUM-MAIN.                          
                                                                                
            IF F315-CDE-SA-TP-TAG  =  LOW-VALUE                                 
               MOVE SPACE             TO  F315-CDE-SA-TP-TAG                    
            END-IF.                                                             
                                                                                
            IF F315-AMT-LEASE-FEE  NOT NUMERIC                                  
               MOVE ZEROES          TO F315-AMT-LEASE-FEE                       
            END-IF.                                                             
                                                                                
            IF F315-AMT-MORT-SF    NOT NUMERIC                                  
               MOVE ZEROES          TO F315-AMT-MORT-SF                         
            END-IF.                                                             
                                                                                
       1100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1400-READ-K410.                                                          
      ******************************************************************        
      *---------------------------------------------------------------*         
      *     USE F315-REGN-NO TO ACCESS BP13K410 (GET DATE, FEES ETC)  *         
      *---------------------------------------------------------------*         
            READ BP13K410.                                                      
                                                                                
            IF WS-K410-STATUS = 00                                              
               IF    K410-CDE-RELEASE-PAYMENT NOT = 'Y'                         
                     DISPLAY ' REGN ' K410-KEY-FLD                              
                     DISPLAY ' RELEASE TAG ' K410-CDE-RELEASE-PAYMENT           
               END-IF                                                           
                                                                                
               IF     F315-NUM-ADHOC-SF = SPACES                                
                      IF K410-DTE-SO-EXECUTION <= '20110218'                    
                         IF     K410-NUM-SF-DISC = 'N'                          
                                MOVE 2.00 TO DUP-DOA-AMT                        
                                             DUP-SA-AMT                         
                                             WS-DEF-DUP-LEASE                   
                         ELSE                                                   
                                MOVE 1.40 TO DUP-DOA-AMT                        
                                             DUP-SA-AMT                         
                                             WS-DEF-DUP-LEASE                   
                         END-IF                                                 
                      ELSE                                                      
                             MOVE 0.00    TO DUP-DOA-AMT                        
                                             DUP-SA-AMT                         
                                             WS-DEF-DUP-LEASE                   
                      END-IF                                                    
                      MOVE  K410-AMT-LEASE-STAMP       TO   WS-LEASE-SF         
                      MOVE  K410-AMT-MORT-STAMP-FEE    TO   WS-MORT-SF          
                      MOVE  K410-AMT-PREMIUM-STAMP-FEE TO   WS-SUP-SF           
               ELSE                                                             
                      MOVE  F315-AMT-LEASE-FEE         TO   WS-LEASE-SF         
                      MOVE  F315-AMT-MORT-SF           TO   WS-MORT-SF          
                      MOVE  F315-AMT-SUPP-AGRM-SF      TO   WS-SUP-SF           
               END-IF                                                           
                                                                                
               MOVE    K410-DTE-SO-EXECUTION      TO   WS-SO-DATE               
            ELSE                                                                
            IF WS-K410-STATUS = 23                                              
               MOVE    ZEROES                     TO   WS-LEASE-SF              
               MOVE    ZEROES                     TO   WS-MORT-SF               
               MOVE    ZEROES                     TO   WS-SUP-SF                
               MOVE    ZEROES                     TO   WS-DUP-DOA               
               MOVE    ZEROES                     TO   WS-DUP-SA                
               MOVE    SPACES                     TO   WS-SO-DATE               
               MOVE    WS-K410-STATUS             TO   WS-CUR-STATUS            
               MOVE    READ-K410                  TO   WS-CUR-PROC              
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT                
               PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT                
            ELSE                                                                
               MOVE    READ-K410                  TO WS-CUR-PROC                
               MOVE    WS-K410-STATUS             TO WS-CUR-STATUS              
               PERFORM 2000-DISPLAY-ERROR-MESSAGE THRU 2000-EXIT                
               PERFORM 9000-CLOSE-FILES           THRU 9000-EXIT.               
                                                                                
       1400-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1800-READ-K006.                                                          
      ******************************************************************        
            MOVE  ' '                TO L445-TAG.                               
            MOVE  SPACES             TO K006-HDB-REF-SF.                        
            MOVE  K410-NUM-SCH-ACC   TO K006-HDB-REF-SF.                        
                                                                                
            READ  B05K006.                                                      
                                                                                
            IF WS-K006-STATUS = 00                                              
               IF F315-NUM-ADHOC-SF = SPACES                                    
                  PERFORM 1810-CHECK-ADHOC-BLANK-CASES THRU 1810-EXIT           
               ELSE                                                             
                  PERFORM 1820-CHECK-ADHOC-Y-CASES     THRU 1820-EXIT           
               END-IF                                                           
            END-IF.                                                             
                                                                                
       1800-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1810-CHECK-ADHOC-BLANK-CASES.                                            
      ******************************************************************        
           IF (K006-BALANCES > K410-AMT-LEASE-STAMP) OR                         
              (K006-BALANCES = K410-AMT-LEASE-STAMP)                            
               NEXT SENTENCE                                                    
           ELSE                                                                 
               MOVE '*'          TO L445-TAG.                                   
                                                                                
       1810-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1820-CHECK-ADHOC-Y-CASES.                                                
      ******************************************************************        
           IF (K006-BALANCES > F315-AMT-LEASE-FEE) OR                           
              (K006-BALANCES = F315-AMT-LEASE-FEE)                              
               NEXT SENTENCE                                                    
           ELSE                                                                 
               MOVE '*'          TO L445-TAG.                                   
                                                                                
       1820-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       2000-DISPLAY-ERROR-MESSAGE.                                              
      ******************************************************************        
            DISPLAY ' *************   ERROR MESSAGE   *************'.           
            DISPLAY 'ERROR ENCOUNTERED WHEN ' WS-CUR-PROC.                      
            DISPLAY 'STATUS CODE = ' WS-CUR-STATUS.                             
                                                                                
       2000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       2100-HANDLE-SALES-TYPE-TP.                                               
      ******************************************************************        
      *--------------------------------*                                        
      *     PRINT  L445X-RECORD (DOA)  *                                        
      *--------------------------------*                                        
            ADD    1                      TO  WS-CNT-DETAILS.                   
                                                                                
      *     -----------------------                                             
      *     SET UP L445X-REC-DETAIL                                             
      *     -----------------------                                             
            MOVE   WS-CNT-DETAILS         TO  L445-SERIAL-NO.                   
            MOVE   WS-SCH-ACC             TO  L445-SCH-ACC.                     
            MOVE   K410-KEY-FLD           TO  L445-REGN-NO.                     
            MOVE   F315-NUM-BLK           TO  L445-BLKNO.                       
            MOVE   F315-NME-STREET        TO  L445-STREET.                      
            MOVE   K410-DTE-SO-EXECUTION  TO  WS-SALE-DATE.                     
            MOVE   WS-SALE-CC             TO  L445-SALE-CC.                     
            MOVE   WS-SALE-YY             TO  L445-SALE-YY.                     
            MOVE   WS-SALE-MM             TO  L445-SALE-MM.                     
            MOVE   WS-SALE-DD             TO  L445-SALE-DD.                     
            MOVE   '/'                    TO  L445-DASH1  L445-DASH2.           
            MOVE   WS-FLATNO              TO  L445-FLATNO.                      
                                                                                
            IF K410-AMT-LOAN = ZEROS                                            
               MOVE     ZEROES            TO  L445-MORT-SF                      
               MOVE     ZEROES            TO  L445-TOTAL-MORT-SF                
               MOVE     ZEROES            TO  L445-DUP-DOA                      
               MOVE     ZEROES            TO  WS-MORT-SF                        
               MOVE     ZEROES            TO  WS-DUP-DOA                        
            ELSE                                                                
               IF F315-NUM-ADHOC-SF = SPACES                                    
                  SUBTRACT DUP-DOA-AMT    FROM  WS-MORT-SF                      
                  MOVE     WS-MORT-SF     TO    L445-MORT-SF                    
                  MOVE     DUP-DOA-AMT    TO    WS-DUP-DOA                      
                  MOVE     DUP-DOA-AMT    TO    L445-DUP-DOA                    
               ELSE                                                             
                  MOVE     WS-MORT-SF           TO L445-MORT-SF                 
                  MOVE     F315-AMT-MORT-SF-DUP TO WS-DUP-DOA                   
                  MOVE     F315-AMT-MORT-SF-DUP TO L445-DUP-DOA                 
               END-IF                                                           
            END-IF.                                                             
                                                                                
            IF F315-NUM-ADHOC-SF = SPACES                                       
             IF K410-AMT-LEASE-STAMP    NOT =  ZEROES                           
                PERFORM  1800-READ-K006  THRU  1800-EXIT                        
                MOVE     WS-DEF-DUP-LEASE  TO  L445-DUP-SA                      
                MOVE     WS-DEF-DUP-LEASE  TO  WS-DUP-SA                        
                                                                                
                COMPUTE WS-LEASE-STAMP = K410-AMT-PREMIUM-STAMP-FEE +           
                                         K410-AMT-LEASE-STAMP -                 
                                         WS-DEF-DUP-LEASE                       
                MOVE    WS-LEASE-STAMP   TO  L445-SUP-LEASE-STAMP               
             ELSE                                                               
                INITIALIZE   WS-DUP-SA       WS-LEASE-STAMP                     
                MOVE    WS-DUP-SA        TO  L445-DUP-SA                        
                MOVE    WS-LEASE-STAMP   TO  L445-SUP-LEASE-STAMP               
             END-IF                                                             
            ELSE                                                                
             IF F315-AMT-LEASE-FEE      NOT =  ZEROES                           
                PERFORM  1800-READ-K006  THRU  1800-EXIT                        
                MOVE     F315-AMT-LEASE-FEE-DUP TO L445-DUP-SA                  
                MOVE     F315-AMT-LEASE-FEE-DUP TO WS-DUP-SA                    
                                                                                
                COMPUTE WS-LEASE-STAMP = F315-AMT-SUPP-AGRM-SF +                
                                         F315-AMT-LEASE-FEE                     
                MOVE    WS-LEASE-STAMP   TO  L445-SUP-LEASE-STAMP               
             ELSE                                                               
                INITIALIZE   WS-DUP-SA       WS-LEASE-STAMP                     
                MOVE    WS-DUP-SA        TO  L445-DUP-SA                        
                MOVE    WS-LEASE-STAMP   TO  L445-SUP-LEASE-STAMP               
             END-IF                                                             
            END-IF.                                                             
                                                                                
            COMPUTE WS-TEMP-TOTAL = (WS-MORT-SF     + WS-DUP-DOA +              
                                     WS-LEASE-STAMP + WS-DUP-SA ).              
                                                                                
            MOVE    WS-TEMP-TOTAL         TO  L445-DETL-AMT-TOTAL               
                                              F315-AMT-STAMP-DUTIES.            
                                                                                
            PERFORM 4800-UPDATE-F315   THRU 4800-EXIT.                          
                                                                                
            MOVE    F315-SCH-ACC          TO  WS-SCH-ACCT-NO.                   
            MOVE    WS-TEMP-TOTAL         TO  WS-AMT-TRANS.                     
            MOVE   'PAYMENT FOR LEASE/MORTGAGE STAMP FEES   '                   
                                          TO  WS-TXT-INFO.                      
                                                                                
                                                                                
      *---------------------------------------------------------------*         
            MOVE    WS-REPORT-ID-SW       TO  WS-PREV-REPORT-ID.                
            PERFORM 2120-CLASSIFY-SALES-TYPE-TP THRU 2120-EXIT.                 
      *---------------------------------------------------------------*         
                                                                                
            IF (WS-CNT-DETAILS = MAX-DETLS-PER-PAGE)                            
                PERFORM 5000-WRITE-TRAILER-F680  THRU 5000-TRAILER-EXIT         
                MOVE    ZEROES                   TO   WS-CNT-DETAILS            
                MOVE    'Y'                      TO   WS-NEW-VOUCHER            
            END-IF.                                                             
                                                                                
       2100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       2150-HANDLE-SER.                                                         
      ******************************************************************        
      *--------------------------------*                                        
      *     PRINT  L445J-RECORD (DOA)  *                                        
      *--------------------------------*                                        
            ADD    1                      TO  WS-CNT-DETAILS.                   
                                                                                
      *     -----------------------                                             
      *     SET UP L445J-REC-DETAIL                                             
      *     -----------------------                                             
            MOVE   WS-CNT-DETAILS         TO  L445-SERIAL-NO.                   
            MOVE   WS-SCH-ACC             TO  L445-SCH-ACC.                     
            MOVE   K410-KEY-FLD           TO  L445-REGN-NO.                     
            MOVE   F315-NUM-BLK           TO  L445-BLKNO.                       
            MOVE   F315-NME-STREET        TO  L445-STREET.                      
            MOVE   K410-DTE-SO-EXECUTION  TO  WS-SALE-DATE.                     
            MOVE   WS-SALE-CC             TO  L445-SALE-CC.                     
            MOVE   WS-SALE-YY             TO  L445-SALE-YY.                     
            MOVE   WS-SALE-MM             TO  L445-SALE-MM.                     
            MOVE   WS-SALE-DD             TO  L445-SALE-DD.                     
            MOVE   '/'                    TO  L445-DASH1  L445-DASH2.           
            MOVE   WS-FLATNO              TO  L445-FLATNO.                      
                                                                                
            IF K410-AMT-LOAN = ZEROS                                            
               MOVE     ZEROES            TO  L445-MORT-SF                      
               MOVE     ZEROES            TO  L445-TOTAL-MORT-SF                
               MOVE     ZEROES            TO  L445-DUP-DOA                      
               MOVE     ZEROES            TO  WS-MORT-SF                        
               MOVE     ZEROES            TO  WS-DUP-DOA                        
            ELSE                                                                
               IF F315-NUM-ADHOC-SF = SPACES                                    
                  SUBTRACT DUP-DOA-AMT    FROM  WS-MORT-SF                      
                  MOVE     WS-MORT-SF     TO    L445-MORT-SF                    
                  MOVE     DUP-DOA-AMT    TO    WS-DUP-DOA                      
                  MOVE     DUP-DOA-AMT    TO    L445-DUP-DOA                    
               ELSE                                                             
                  MOVE     WS-MORT-SF           TO L445-MORT-SF                 
                  MOVE     F315-AMT-MORT-SF-DUP TO WS-DUP-DOA                   
                  MOVE     F315-AMT-MORT-SF-DUP TO L445-DUP-DOA                 
               END-IF                                                           
            END-IF.                                                             
                                                                                
            IF F315-NUM-ADHOC-SF = SPACES                                       
             IF K410-AMT-LEASE-STAMP    NOT =  ZEROES                           
                PERFORM  1800-READ-K006  THRU  1800-EXIT                        
                MOVE     WS-DEF-DUP-LEASE  TO  L445-DUP-SA                      
                MOVE     WS-DEF-DUP-LEASE  TO  WS-DUP-SA                        
                                                                                
                COMPUTE WS-LEASE-STAMP = K410-AMT-PREMIUM-STAMP-FEE +           
                                         K410-AMT-LEASE-STAMP -                 
                                         WS-DEF-DUP-LEASE                       
                MOVE    WS-LEASE-STAMP   TO  L445-SUP-LEASE-STAMP               
             ELSE                                                               
                INITIALIZE   WS-DUP-SA       WS-LEASE-STAMP                     
                MOVE    WS-DUP-SA        TO  L445-DUP-SA                        
                MOVE    WS-LEASE-STAMP   TO  L445-SUP-LEASE-STAMP               
             END-IF                                                             
            ELSE                                                                
             IF F315-AMT-LEASE-FEE      NOT =  ZEROES                           
                PERFORM  1800-READ-K006  THRU  1800-EXIT                        
                MOVE     F315-AMT-LEASE-FEE-DUP TO L445-DUP-SA                  
                MOVE     F315-AMT-LEASE-FEE-DUP TO WS-DUP-SA                    
                                                                                
                COMPUTE WS-LEASE-STAMP = F315-AMT-SUPP-AGRM-SF +                
                                         F315-AMT-LEASE-FEE                     
                MOVE    WS-LEASE-STAMP   TO  L445-SUP-LEASE-STAMP               
             ELSE                                                               
                INITIALIZE   WS-DUP-SA       WS-LEASE-STAMP                     
                MOVE    WS-DUP-SA        TO  L445-DUP-SA                        
                MOVE    WS-LEASE-STAMP   TO  L445-SUP-LEASE-STAMP               
             END-IF                                                             
            END-IF.                                                             
                                                                                
            COMPUTE WS-TEMP-TOTAL = (WS-MORT-SF     + WS-DUP-DOA +              
                                     WS-LEASE-STAMP + WS-DUP-SA ).              
                                                                                
            MOVE    WS-TEMP-TOTAL         TO  L445-DETL-AMT-TOTAL               
                                              F315-AMT-STAMP-DUTIES.            
                                                                                
            PERFORM 4800-UPDATE-F315   THRU 4800-EXIT.                          
                                                                                
            MOVE    F315-SCH-ACC          TO  WS-SCH-ACCT-NO.                   
            MOVE    WS-TEMP-TOTAL         TO  WS-AMT-TRANS.                     
            ADD     1                     TO  WS-L445J-PRINT-CNT                
            ADD     WS-MORT-SF            TO  WS-L445J-MORT-CNT                 
            ADD     WS-DUP-SA             TO  WS-L445J-DUP-SA-CNT               
            ADD     WS-DUP-DOA            TO  WS-L445J-DUP-DOA-CNT              
            ADD     WS-LEASE-STAMP        TO  WS-L445J-LEASE-CNT                
            ADD     WS-TEMP-TOTAL         TO  WS-L445J-IND-TOT-CNT              
            MOVE    WS-L445J-IND-TOT-CNT  TO  WS-AMT-TOTAL                      
            WRITE   L445J-PRINT-REC       FROM  L445-REC-DETAIL AFTER 1.        
            MOVE    'J'                   TO  WS-PREV-REPORT-ID.                
            MOVE   'PAYMENT FOR LEASE/MORTGAGE STAMP FEES   '                   
                                          TO  WS-TXT-INFO.                      
                                                                                
            IF (WS-CNT-DETAILS = MAX-DETLS-PER-PAGE)                            
                PERFORM 5000-WRITE-TRAILER-F680  THRU 5000-TRAILER-EXIT         
                MOVE    ZEROES                   TO   WS-CNT-DETAILS            
                MOVE    'Y'                      TO   WS-NEW-VOUCHER            
            END-IF.                                                             
                                                                                
       2150-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       2120-CLASSIFY-SALES-TYPE-TP.                                             
      ******************************************************************        
            EVALUATE TRUE                                                       
            WHEN     REPORT-L445D                                               
                  ADD    1                TO  WS-L445D-PRINT-CNT                
                  ADD   WS-MORT-SF        TO  WS-L445D-MORT-CNT                 
                  ADD   WS-DUP-SA         TO  WS-L445D-DUP-SA-CNT               
                  ADD   WS-DUP-DOA        TO  WS-L445D-DUP-DOA-CNT              
                  ADD   WS-LEASE-STAMP    TO  WS-L445D-LEASE-CNT                
                  ADD   WS-TEMP-TOTAL     TO  WS-L445D-IND-TOT-CNT              
                  MOVE  WS-L445D-IND-TOT-CNT TO   WS-AMT-TOTAL                  
                  WRITE L445D-PRINT-REC FROM L445-REC-DETAIL AFTER 1            
            WHEN     REPORT-L445E                                               
                  ADD    1                TO  WS-L445E-PRINT-CNT                
                  ADD   WS-MORT-SF        TO  WS-L445E-MORT-CNT                 
                  ADD   WS-DUP-SA         TO  WS-L445E-DUP-SA-CNT               
                  ADD   WS-DUP-DOA        TO  WS-L445E-DUP-DOA-CNT              
                  ADD   WS-LEASE-STAMP    TO  WS-L445E-LEASE-CNT                
                  ADD   WS-TEMP-TOTAL     TO  WS-L445E-IND-TOT-CNT              
                  MOVE  WS-L445E-IND-TOT-CNT TO   WS-AMT-TOTAL                  
                  WRITE L445E-PRINT-REC FROM L445-REC-DETAIL AFTER 1            
            WHEN     REPORT-L445G                                               
                  ADD    1                TO  WS-L445G-PRINT-CNT                
                  ADD   WS-MORT-SF        TO  WS-L445G-MORT-CNT                 
                  ADD   WS-DUP-SA         TO  WS-L445G-DUP-SA-CNT               
                  ADD   WS-DUP-DOA        TO  WS-L445G-DUP-DOA-CNT              
                  ADD   WS-LEASE-STAMP    TO  WS-L445G-LEASE-CNT                
                  ADD   WS-TEMP-TOTAL     TO  WS-L445G-IND-TOT-CNT              
                  MOVE  WS-L445G-IND-TOT-CNT TO   WS-AMT-TOTAL                  
                  WRITE L445G-PRINT-REC FROM L445-REC-DETAIL AFTER 1            
            WHEN     REPORT-L445H                                               
                  ADD    1                TO  WS-L445H-PRINT-CNT                
                  ADD   WS-MORT-SF        TO  WS-L445H-MORT-CNT                 
                  ADD   WS-DUP-SA         TO  WS-L445H-DUP-SA-CNT               
                  ADD   WS-DUP-DOA        TO  WS-L445H-DUP-DOA-CNT              
                  ADD   WS-LEASE-STAMP    TO  WS-L445H-LEASE-CNT                
                  ADD   WS-TEMP-TOTAL     TO  WS-L445H-IND-TOT-CNT              
                  MOVE  WS-L445H-IND-TOT-CNT TO   WS-AMT-TOTAL                  
                  WRITE L445H-PRINT-REC FROM L445-REC-DETAIL AFTER 1            
            WHEN     REPORT-L445I                                               
                  ADD    1                TO  WS-L445I-PRINT-CNT                
                  ADD   WS-MORT-SF        TO  WS-L445I-MORT-CNT                 
                  ADD   WS-DUP-SA         TO  WS-L445I-DUP-SA-CNT               
                  ADD   WS-DUP-DOA        TO  WS-L445I-DUP-DOA-CNT              
                  ADD   WS-LEASE-STAMP    TO  WS-L445I-LEASE-CNT                
                  ADD   WS-TEMP-TOTAL     TO  WS-L445I-IND-TOT-CNT              
                  MOVE  WS-L445I-IND-TOT-CNT TO   WS-AMT-TOTAL                  
                  WRITE L445I-PRINT-REC FROM L445-REC-DETAIL AFTER 1            
            END-EVALUATE.                                                       
                                                                                
       2120-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       2300-HANDLE-SALES-TYPE-10.                                               
      ******************************************************************        
                                                                                
      *--------------------------------*                                        
      *     PRINT  L445A-RECORD (DOA)  *                                        
      *--------------------------------*                                        
            ADD    1                      TO  WS-L445A-PRINT-CNT.               
            ADD    1                      TO  WS-CNT-DETAILS.                   
                                                                                
      *     -----------------------                                             
      *     SET UP L445A-REC-DETAIL                                             
      *     -----------------------                                             
            MOVE   WS-CNT-DETAILS         TO  L445-SERIAL-NO.                   
            MOVE   WS-SCH-ACC             TO  L445-SCH-ACC.                     
            MOVE   K410-KEY-FLD           TO  L445-REGN-NO.                     
            MOVE   F315-NUM-BLK           TO  L445-BLKNO.                       
            MOVE   F315-NME-STREET        TO  L445-STREET.                      
            MOVE   K410-DTE-SO-EXECUTION  TO  WS-SALE-DATE.                     
            MOVE   WS-SALE-CC             TO  L445-SALE-CC.                     
            MOVE   WS-SALE-YY             TO  L445-SALE-YY.                     
            MOVE   WS-SALE-MM             TO  L445-SALE-MM.                     
            MOVE   WS-SALE-DD             TO  L445-SALE-DD.                     
            MOVE   '/'                    TO  L445-DASH1  L445-DASH2.           
            MOVE   WS-FLATNO              TO  L445-FLATNO.                      
                                                                                
            IF K410-AMT-LOAN = ZEROS                                            
               MOVE     ZEROES            TO  L445-MORT-SF                      
               MOVE     ZEROES            TO  L445-TOTAL-MORT-SF                
               MOVE     ZEROES            TO  L445-DUP-DOA                      
               MOVE     ZEROES            TO  WS-MORT-SF                        
               MOVE     ZEROES            TO  WS-DUP-DOA                        
            ELSE                                                                
               IF F315-NUM-ADHOC-SF = SPACES                                    
                  SUBTRACT DUP-DOA-AMT     FROM  WS-MORT-SF                     
                  MOVE     WS-MORT-SF        TO  L445-MORT-SF                   
                  ADD      WS-MORT-SF        TO  WS-L445A-MORT-CNT              
                                                                                
                  MOVE     DUP-DOA-AMT       TO  WS-DUP-DOA                     
                  MOVE     DUP-DOA-AMT       TO  L445-DUP-DOA                   
                  ADD      DUP-DOA-AMT       TO  WS-L445A-DUP-DOA-CNT           
               ELSE                                                             
                  MOVE    WS-MORT-SF           TO  L445-MORT-SF                 
                  ADD     WS-MORT-SF           TO  WS-L445A-MORT-CNT            
                                                                                
                  MOVE    F315-AMT-MORT-SF-DUP TO  WS-DUP-DOA                   
                  MOVE    F315-AMT-MORT-SF-DUP TO  L445-DUP-DOA                 
                  ADD     F315-AMT-MORT-SF-DUP TO  WS-L445A-DUP-DOA-CNT         
               END-IF                                                           
            END-IF.                                                             
                                                                                
            IF F315-NUM-ADHOC-SF = SPACES                                       
             IF K410-AMT-PREMIUM-STAMP-FEE =   ZEROS                            
                MOVE     ZEROS           TO    L445-SUP-LEASE-STAMP             
                MOVE     ZEROS           TO    L445-DUP-SA                      
                MOVE     ZEROS           TO    WS-DUP-SA                        
             ELSE                                                               
      * TO CREATE A RECORD FOR PRINTING OF LIST FOR STAMPING OF                 
      * SUPPLEMENTARY AGREEMENT.                                                
                SUBTRACT DUP-SA-AMT      FROM  WS-SUP-SF                        
                MOVE     WS-SUP-SF       TO    L445-SUP-LEASE-STAMP             
                ADD      WS-SUP-SF       TO    WS-L445A-SUP-CNT                 
                                                                                
                MOVE     DUP-DOA-AMT     TO    WS-DUP-SA                        
                MOVE     DUP-DOA-AMT     TO    L445-DUP-SA                      
                ADD      DUP-DOA-AMT     TO    WS-L445A-DUP-SA-CNT              
             END-IF                                                             
            ELSE                                                                
             IF F315-AMT-SUPP-AGRM-SF =   ZEROS                                 
                MOVE  ZEROS             TO  L445-SUP-LEASE-STAMP                
                MOVE  ZEROS             TO  L445-DUP-SA                         
                MOVE  ZEROS             TO  WS-DUP-SA                           
             ELSE                                                               
      * TO CREATE A RECORD FOR PRINTING OF LIST FOR STAMPING OF                 
      * SUPPLEMENTARY AGREEMENT.                                                
                MOVE  WS-SUP-SF         TO  L445-SUP-LEASE-STAMP                
                ADD   WS-SUP-SF         TO  WS-L445A-SUP-CNT                    
                                                                                
                MOVE  F315-AMT-SUPP-AGRM-SF-DUP TO WS-DUP-SA                    
                MOVE  F315-AMT-SUPP-AGRM-SF-DUP TO L445-DUP-SA                  
                ADD   F315-AMT-SUPP-AGRM-SF-DUP TO WS-L445A-DUP-SA-CNT          
             END-IF                                                             
            END-IF.                                                             
                                                                                
            COMPUTE WS-TEMP-TOTAL  =  (WS-MORT-SF + WS-DUP-DOA +                
                                       WS-SUP-SF  + WS-DUP-SA ).                
                                                                                
            MOVE    WS-TEMP-TOTAL         TO  L445-DETL-AMT-TOTAL               
                                              F315-AMT-STAMP-DUTIES.            
                                                                                
            PERFORM 4800-UPDATE-F315   THRU 4800-EXIT.                          
                                                                                
            ADD     WS-TEMP-TOTAL         TO  WS-L445A-IND-TOT-CNT.             
                                                                                
            WRITE   L445A-PRINT-REC     FROM  L445-REC-DETAIL AFTER 1.          
            MOVE   'A'                    TO  WS-PREV-REPORT-ID.                
                                                                                
            MOVE    F315-SCH-ACC          TO  WS-SCH-ACCT-NO.                   
            MOVE    WS-TEMP-TOTAL         TO  WS-AMT-TRANS.                     
            MOVE   'PAYMENT FOR LEASE/MORTGAGE STAMP FEES            '          
                                          TO   WS-TXT-INFO.                     
            IF (WS-CNT-DETAILS = MAX-DETLS-PER-PAGE)                            
                MOVE    WS-L445A-IND-TOT-CNT     TO   WS-AMT-TOTAL              
                PERFORM 5000-WRITE-TRAILER-F680  THRU 5000-TRAILER-EXIT         
                MOVE    ZEROES                   TO   WS-CNT-DETAILS            
                MOVE    'Y'                      TO   WS-NEW-VOUCHER            
            END-IF.                                                             
                                                                                
       2300-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4200-PRINT-LAST-LINES.                                                   
      ******************************************************************        
            PERFORM 5000-WRITE-TRAILER-F680                                     
               THRU 5000-TRAILER-EXIT.                                          
                                                                                
       4200-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4210-PRINT-L445A-GRAND-TOTAL.                                            
      ******************************************************************        
            IF WS-CNT-DETAILS = ZEROES                                          
               GO TO 4210-EXIT                                                  
            END-IF.                                                             
                                                                                
            MOVE  WS-CNT-DETAILS       TO  L445-VR-NO-HIGH.                     
            MOVE  WS-L445A-MORT-CNT    TO  L445-TOTAL-MORT-SF.                  
            MOVE  WS-L445A-DUP-DOA-CNT TO  L445-TOTAL-DUP-DOA.                  
            MOVE  WS-L445A-SUP-CNT     TO  L445-TOTAL-SUP-LEASE-SF.             
            MOVE  WS-L445A-DUP-SA-CNT  TO  L445-TOTAL-DUP-SA.                   
            MOVE  WS-L445A-IND-TOT-CNT TO  L445-TOTAL-AMT.                      
                                                                                
            WRITE L445A-PRINT-REC FROM PRT-L445-DASH-LINE  AFTER 2.             
            WRITE L445A-PRINT-REC FROM PRT-L445-TOTAL-LINE AFTER 1.             
            WRITE L445A-PRINT-REC FROM PRT-L445-DASH-LINE  AFTER 1.             
                                                                                
            MOVE     WS-L445A-IND-TOT-CNT  TO   WS-AMT.                         
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.                      
            MOVE     WP-ITEM (1)           TO   L445-AMT-DESC1.                 
            MOVE     WP-ITEM (2)           TO   L445-AMT-DESC2.                 
            WRITE    L445A-PRINT-REC       FROM PRT-L445-FTG-1 AFTER 3.         
            WRITE    L445A-PRINT-REC       FROM PRT-L445-FTG-2 AFTER 6.         
                                                                                
            MOVE     ZEROES                TO   WS-L445A-MORT-CNT               
                                                WS-L445A-DUP-DOA-CNT            
                                                WS-L445A-SUP-CNT                
                                                WS-L445A-DUP-SA-CNT             
                                                WS-L445A-IND-TOT-CNT.           
       4210-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4240-PRINT-L445D-GRAND-TOTAL.                                            
      ******************************************************************        
            IF WS-CNT-DETAILS = ZEROES                                          
               GO TO 4240-EXIT                                                  
            END-IF.                                                             
                                                                                
            MOVE  WS-CNT-DETAILS        TO L445-VR-NO-HIGH.                     
            MOVE  WS-L445D-MORT-CNT     TO L445-TOTAL-MORT-SF.                  
            MOVE  WS-L445D-DUP-DOA-CNT  TO L445-TOTAL-DUP-DOA.                  
            MOVE  WS-L445D-LEASE-CNT    TO L445-TOTAL-SUP-LEASE-SF.             
            MOVE  WS-L445D-DUP-SA-CNT   TO L445-TOTAL-DUP-SA.                   
            MOVE  WS-L445D-IND-TOT-CNT  TO L445-TOTAL-AMT.                      
                                                                                
            WRITE L445D-PRINT-REC FROM PRT-L445-DASH-LINE  AFTER 2.             
            WRITE L445D-PRINT-REC FROM PRT-L445-TOTAL-LINE AFTER 1.             
            WRITE L445D-PRINT-REC FROM PRT-L445-DASH-LINE  AFTER 1.             
                                                                                
            MOVE     WS-L445D-IND-TOT-CNT  TO   WS-AMT.                         
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.                      
            MOVE     WP-ITEM (1)           TO   L445-AMT-DESC1.                 
            MOVE     WP-ITEM (2)           TO   L445-AMT-DESC2.                 
            WRITE    L445D-PRINT-REC       FROM PRT-L445-FTG-1 AFTER 3.         
            WRITE    L445D-PRINT-REC       FROM PRT-L445-FTG-2 AFTER 6.         
                                                                                
            MOVE     ZEROES                TO   WS-L445D-MORT-CNT               
                                                WS-L445D-DUP-DOA-CNT            
                                                WS-L445D-LEASE-CNT              
                                                WS-L445D-DUP-SA-CNT             
                                                WS-L445D-IND-TOT-CNT.           
       4240-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4250-PRINT-L445E-GRAND-TOTAL.                                            
      ******************************************************************        
            IF WS-CNT-DETAILS = ZEROES                                          
               GO TO 4250-EXIT                                                  
            END-IF.                                                             
                                                                                
            MOVE  WS-CNT-DETAILS        TO L445-VR-NO-HIGH.                     
            MOVE  WS-L445E-MORT-CNT     TO L445-TOTAL-MORT-SF.                  
            MOVE  WS-L445E-DUP-DOA-CNT  TO L445-TOTAL-DUP-DOA.                  
            MOVE  WS-L445E-LEASE-CNT    TO L445-TOTAL-SUP-LEASE-SF.             
            MOVE  WS-L445E-DUP-SA-CNT   TO L445-TOTAL-DUP-SA.                   
            MOVE  WS-L445E-IND-TOT-CNT  TO L445-TOTAL-AMT.                      
                                                                                
            WRITE L445E-PRINT-REC FROM PRT-L445-DASH-LINE  AFTER 2.             
            WRITE L445E-PRINT-REC FROM PRT-L445-TOTAL-LINE AFTER 1.             
            WRITE L445E-PRINT-REC FROM PRT-L445-DASH-LINE  AFTER 1.             
                                                                                
            MOVE     WS-L445E-IND-TOT-CNT  TO   WS-AMT.                         
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.                      
            MOVE     WP-ITEM (1)           TO   L445-AMT-DESC1.                 
            MOVE     WP-ITEM (2)           TO   L445-AMT-DESC2.                 
            WRITE    L445E-PRINT-REC       FROM PRT-L445-FTG-1 AFTER 3.         
            WRITE    L445E-PRINT-REC       FROM PRT-L445-FTG-2 AFTER 6.         
                                                                                
            MOVE     ZEROES                TO   WS-L445E-MORT-CNT               
                                                WS-L445E-DUP-DOA-CNT            
                                                WS-L445E-LEASE-CNT              
                                                WS-L445E-DUP-SA-CNT             
                                                WS-L445E-IND-TOT-CNT.           
       4250-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4270-PRINT-L445G-GRAND-TOTAL.                                            
      ******************************************************************        
            IF WS-CNT-DETAILS = ZEROES                                          
               GO TO 4270-EXIT                                                  
            END-IF.                                                             
                                                                                
            MOVE  WS-CNT-DETAILS        TO L445-VR-NO-HIGH.                     
            MOVE  WS-L445G-MORT-CNT     TO L445-TOTAL-MORT-SF.                  
            MOVE  WS-L445G-DUP-DOA-CNT  TO L445-TOTAL-DUP-DOA.                  
            MOVE  WS-L445G-LEASE-CNT    TO L445-TOTAL-SUP-LEASE-SF.             
            MOVE  WS-L445G-DUP-SA-CNT   TO L445-TOTAL-DUP-SA.                   
            MOVE  WS-L445G-IND-TOT-CNT  TO L445-TOTAL-AMT.                      
                                                                                
            WRITE L445G-PRINT-REC FROM PRT-L445-DASH-LINE  AFTER 2.             
            WRITE L445G-PRINT-REC FROM PRT-L445-TOTAL-LINE AFTER 1.             
            WRITE L445G-PRINT-REC FROM PRT-L445-DASH-LINE  AFTER 1.             
                                                                                
            MOVE     WS-L445G-IND-TOT-CNT  TO   WS-AMT.                         
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.                      
            MOVE     WP-ITEM (1)           TO   L445-AMT-DESC1.                 
            MOVE     WP-ITEM (2)           TO   L445-AMT-DESC2.                 
            WRITE    L445G-PRINT-REC       FROM PRT-L445-FTG-1 AFTER 3.         
            WRITE    L445G-PRINT-REC       FROM PRT-L445-FTG-2 AFTER 6.         
                                                                                
            MOVE     ZEROES                TO   WS-L445G-MORT-CNT               
                                                WS-L445G-DUP-DOA-CNT            
                                                WS-L445G-LEASE-CNT              
                                                WS-L445G-DUP-SA-CNT             
                                                WS-L445G-IND-TOT-CNT.           
       4270-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4280-PRINT-L445H-GRAND-TOTAL.                                            
      ******************************************************************        
            IF WS-CNT-DETAILS = ZEROES                                          
               GO TO 4280-EXIT                                                  
            END-IF.                                                             
                                                                                
            MOVE  WS-CNT-DETAILS        TO L445-VR-NO-HIGH.                     
            MOVE  WS-L445H-MORT-CNT     TO L445-TOTAL-MORT-SF.                  
            MOVE  WS-L445H-DUP-DOA-CNT  TO L445-TOTAL-DUP-DOA.                  
            MOVE  WS-L445H-LEASE-CNT    TO L445-TOTAL-SUP-LEASE-SF.             
            MOVE  WS-L445H-DUP-SA-CNT   TO L445-TOTAL-DUP-SA.                   
            MOVE  WS-L445H-IND-TOT-CNT  TO L445-TOTAL-AMT.                      
                                                                                
            WRITE L445H-PRINT-REC FROM PRT-L445-DASH-LINE  AFTER 2.             
            WRITE L445H-PRINT-REC FROM PRT-L445-TOTAL-LINE AFTER 1.             
            WRITE L445H-PRINT-REC FROM PRT-L445-DASH-LINE  AFTER 1.             
                                                                                
            MOVE     WS-L445H-IND-TOT-CNT  TO   WS-AMT.                         
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.                      
            MOVE     WP-ITEM (1)           TO   L445-AMT-DESC1.                 
            MOVE     WP-ITEM (2)           TO   L445-AMT-DESC2.                 
            WRITE    L445H-PRINT-REC       FROM PRT-L445-FTG-1 AFTER 3.         
            WRITE    L445H-PRINT-REC       FROM PRT-L445-FTG-2 AFTER 6.         
                                                                                
            MOVE     ZEROES                TO   WS-L445H-MORT-CNT               
                                                WS-L445H-DUP-DOA-CNT            
                                                WS-L445H-LEASE-CNT              
                                                WS-L445H-DUP-SA-CNT             
                                                WS-L445H-IND-TOT-CNT.           
       4280-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4290-PRINT-L445I-GRAND-TOTAL.                                            
      ******************************************************************        
            IF WS-CNT-DETAILS = ZEROES                                          
               GO TO 4290-EXIT                                                  
            END-IF.                                                             
                                                                                
            MOVE  WS-CNT-DETAILS        TO L445-VR-NO-HIGH.                     
            MOVE  WS-L445I-MORT-CNT     TO L445-TOTAL-MORT-SF.                  
            MOVE  WS-L445I-DUP-DOA-CNT  TO L445-TOTAL-DUP-DOA.                  
            MOVE  WS-L445I-LEASE-CNT    TO L445-TOTAL-SUP-LEASE-SF.             
            MOVE  WS-L445I-DUP-SA-CNT   TO L445-TOTAL-DUP-SA.                   
            MOVE  WS-L445I-IND-TOT-CNT  TO L445-TOTAL-AMT.                      
                                                                                
            WRITE L445I-PRINT-REC FROM PRT-L445-DASH-LINE  AFTER 2.             
            WRITE L445I-PRINT-REC FROM PRT-L445-TOTAL-LINE AFTER 1.             
            WRITE L445I-PRINT-REC FROM PRT-L445-DASH-LINE  AFTER 1.             
                                                                                
            MOVE     WS-L445I-IND-TOT-CNT  TO   WS-AMT.                         
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.                      
            MOVE     WP-ITEM (1)           TO   L445-AMT-DESC1.                 
            MOVE     WP-ITEM (2)           TO   L445-AMT-DESC2.                 
            WRITE    L445I-PRINT-REC       FROM PRT-L445-FTG-1 AFTER 3.         
            WRITE    L445I-PRINT-REC       FROM PRT-L445-FTG-2 AFTER 6.         
                                                                                
            MOVE     ZEROES                TO   WS-L445I-MORT-CNT               
                                                WS-L445I-DUP-DOA-CNT            
                                                WS-L445I-LEASE-CNT              
                                                WS-L445I-DUP-SA-CNT             
                                                WS-L445I-IND-TOT-CNT.           
       4290-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4295-PRINT-L445J-GRAND-TOTAL.                                            
      ******************************************************************        
            IF WS-CNT-DETAILS = ZEROES                                          
               GO TO 4295-EXIT                                                  
            END-IF.                                                             
                                                                                
            MOVE  WS-CNT-DETAILS        TO L445-VR-NO-HIGH.                     
            MOVE  WS-L445J-MORT-CNT     TO L445-TOTAL-MORT-SF.                  
            MOVE  WS-L445J-DUP-DOA-CNT  TO L445-TOTAL-DUP-DOA.                  
            MOVE  WS-L445J-LEASE-CNT    TO L445-TOTAL-SUP-LEASE-SF.             
            MOVE  WS-L445J-DUP-SA-CNT   TO L445-TOTAL-DUP-SA.                   
            MOVE  WS-L445J-IND-TOT-CNT  TO L445-TOTAL-AMT.                      
                                                                                
            WRITE L445J-PRINT-REC FROM PRT-L445-DASH-LINE  AFTER 2.             
            WRITE L445J-PRINT-REC FROM PRT-L445-TOTAL-LINE AFTER 1.             
            WRITE L445J-PRINT-REC FROM PRT-L445-DASH-LINE  AFTER 1.             
                                                                                
            MOVE     WS-L445J-IND-TOT-CNT  TO   WS-AMT.                         
            PERFORM  9500-CONVT-AMT-WORD   THRU 9500-EXIT.                      
            MOVE     WP-ITEM (1)           TO   L445-AMT-DESC1.                 
            MOVE     WP-ITEM (2)           TO   L445-AMT-DESC2.                 
            WRITE    L445J-PRINT-REC       FROM PRT-L445-FTG-1 AFTER 3.         
            WRITE    L445J-PRINT-REC       FROM PRT-L445-FTG-2 AFTER 6.         
                                                                                
            MOVE     ZEROES                TO   WS-L445J-MORT-CNT               
                                                WS-L445J-DUP-DOA-CNT            
                                                WS-L445J-LEASE-CNT              
                                                WS-L445J-DUP-SA-CNT             
                                                WS-L445J-IND-TOT-CNT.           
       4295-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4620-PRINT-L445A-HEADER.                                                 
      ******************************************************************        
            MOVE 'P13445AA'          TO L445-REPORT-ID.                         
            MOVE  WS-L445A-DESC      TO L445-REPORT-ID-DESC.                    
            MOVE 'SUPP. AGMT'        TO L445-SUP-LEASE-DESC.                    
            MOVE  SPACES             TO L445-TAG-DESC.                          
            ADD   1                  TO WS-L445A-PAGE-CNT.                      
            MOVE  WS-L445A-PAGE-CNT  TO L445-PAGE.                              
            IF F315-NUM-ADHOC-SF = 'Y'                                          
               MOVE '-A'             TO L445-REPORT-ID(9:2).                    
            WRITE L445A-PRINT-REC  FROM PRT-L445-HDG-1    AFTER PAGE.           
            MOVE SPACES              TO L445-REPORT-ID(9:2).                    
            WRITE L445A-PRINT-REC  FROM PRT-L445-HDG-2    AFTER 2.              
            WRITE L445A-PRINT-REC  FROM PRT-L445-HDG-3    AFTER 1.              
            WRITE L445A-PRINT-REC  FROM PRT-L445-HDG-4    AFTER 2.              
            WRITE L445A-PRINT-REC  FROM PRT-L445-HDG-5    AFTER 1.              
            WRITE L445A-PRINT-REC  FROM PRT-L445-HDG-6    AFTER 1.              
            WRITE L445A-PRINT-REC  FROM PRT-L445-HDG-7    AFTER 1.              
            WRITE L445A-PRINT-REC  FROM PRT-L445-HDG-8    AFTER 1.              
            WRITE L445A-PRINT-REC  FROM PRT-L445-HDG-9    AFTER 1.              
            WRITE L445A-PRINT-REC  FROM PRT-L445-HDG-10   AFTER 1.              
            WRITE L445A-PRINT-REC  FROM PRT-L445-HDG-10A  AFTER 1.              
            WRITE L445A-PRINT-REC  FROM PRT-L445-HDG-11   AFTER 1.              
            WRITE L445A-PRINT-REC  FROM PRT-L445-SUBHDG-1 AFTER 3.              
            WRITE L445A-PRINT-REC  FROM PRT-L445-SUBHDG-2 AFTER 1.              
            WRITE L445A-PRINT-REC  FROM PRT-L445-SUBHDG-3 AFTER 1.              
            MOVE  SPACES             TO L445A-PRINT-REC.                        
            WRITE L445A-PRINT-REC AFTER 1.                                      
                                                                                
       4620-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4710-PRINT-L445D-HEADER.                                                 
      ******************************************************************        
            MOVE 'P13445AD'          TO L445-REPORT-ID.                         
            MOVE  WS-L445D-DESC      TO L445-REPORT-ID-DESC.                    
            MOVE 'LEASE     '        TO L445-SUP-LEASE-DESC.                    
            MOVE 'TAG'               TO L445-TAG-DESC.                          
            ADD   1                  TO WS-L445D-PAGE-CNT.                      
            MOVE  WS-L445D-PAGE-CNT  TO L445-PAGE.                              
            WRITE L445D-PRINT-REC  FROM PRT-L445-HDG-1    AFTER PAGE.           
            WRITE L445D-PRINT-REC  FROM PRT-L445-HDG-2    AFTER 2.              
            WRITE L445D-PRINT-REC  FROM PRT-L445-HDG-3    AFTER 1.              
            WRITE L445D-PRINT-REC  FROM PRT-L445-HDG-4    AFTER 2.              
            WRITE L445D-PRINT-REC  FROM PRT-L445-HDG-5    AFTER 1.              
            WRITE L445D-PRINT-REC  FROM PRT-L445-HDG-6    AFTER 1.              
            WRITE L445D-PRINT-REC  FROM PRT-L445-HDG-7    AFTER 1.              
            WRITE L445D-PRINT-REC  FROM PRT-L445-HDG-8    AFTER 1.              
            WRITE L445D-PRINT-REC  FROM PRT-L445-HDG-9    AFTER 1.              
            WRITE L445D-PRINT-REC  FROM PRT-L445-HDG-10   AFTER 1.              
            WRITE L445D-PRINT-REC  FROM PRT-L445-HDG-10A  AFTER 1.              
            WRITE L445D-PRINT-REC  FROM PRT-L445-HDG-11   AFTER 1.              
            WRITE L445D-PRINT-REC  FROM PRT-L445-SUBHDG-1 AFTER 3.              
            WRITE L445D-PRINT-REC  FROM PRT-L445-SUBHDG-2 AFTER 1.              
            WRITE L445D-PRINT-REC  FROM PRT-L445-SUBHDG-3 AFTER 1.              
            MOVE  SPACES             TO L445D-PRINT-REC.                        
            WRITE L445D-PRINT-REC AFTER 1.                                      
                                                                                
       4710-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4720-PRINT-L445E-HEADER.                                                 
      ******************************************************************        
            MOVE 'P13445AE'          TO L445-REPORT-ID.                         
            MOVE  WS-L445E-DESC      TO L445-REPORT-ID-DESC.                    
            MOVE 'LEASE     '        TO L445-SUP-LEASE-DESC.                    
            MOVE 'TAG'               TO L445-TAG-DESC.                          
            ADD   1                  TO WS-L445E-PAGE-CNT.                      
            MOVE  WS-L445E-PAGE-CNT  TO L445-PAGE.                              
            WRITE L445E-PRINT-REC  FROM PRT-L445-HDG-1    AFTER PAGE.           
            WRITE L445E-PRINT-REC  FROM PRT-L445-HDG-2    AFTER 2.              
            WRITE L445E-PRINT-REC  FROM PRT-L445-HDG-3    AFTER 1.              
            WRITE L445E-PRINT-REC  FROM PRT-L445-HDG-4    AFTER 2.              
            WRITE L445E-PRINT-REC  FROM PRT-L445-HDG-5    AFTER 1.              
            WRITE L445E-PRINT-REC  FROM PRT-L445-HDG-6    AFTER 1.              
            WRITE L445E-PRINT-REC  FROM PRT-L445-HDG-7    AFTER 1.              
            WRITE L445E-PRINT-REC  FROM PRT-L445-HDG-8    AFTER 1.              
            WRITE L445E-PRINT-REC  FROM PRT-L445-HDG-9    AFTER 1.              
            WRITE L445E-PRINT-REC  FROM PRT-L445-HDG-10   AFTER 1.              
            WRITE L445E-PRINT-REC  FROM PRT-L445-HDG-10A  AFTER 1.              
            WRITE L445E-PRINT-REC  FROM PRT-L445-HDG-11   AFTER 1.              
            WRITE L445E-PRINT-REC  FROM PRT-L445-SUBHDG-1 AFTER 3.              
            WRITE L445E-PRINT-REC  FROM PRT-L445-SUBHDG-2 AFTER 1.              
            WRITE L445E-PRINT-REC  FROM PRT-L445-SUBHDG-3 AFTER 1.              
            MOVE  SPACES             TO L445E-PRINT-REC.                        
            WRITE L445E-PRINT-REC AFTER 1.                                      
                                                                                
       4720-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4740-PRINT-L445G-HEADER.                                                 
      ******************************************************************        
            MOVE 'P13445AG'          TO L445-REPORT-ID.                         
            MOVE  WS-L445G-DESC      TO L445-REPORT-ID-DESC.                    
            MOVE 'LEASE     '        TO L445-SUP-LEASE-DESC.                    
            MOVE 'TAG'               TO L445-TAG-DESC.                          
            ADD   1                  TO WS-L445G-PAGE-CNT.                      
            MOVE  WS-L445G-PAGE-CNT  TO L445-PAGE.                              
            WRITE L445G-PRINT-REC  FROM PRT-L445-HDG-1    AFTER PAGE.           
            WRITE L445G-PRINT-REC  FROM PRT-L445-HDG-2    AFTER 2.              
            WRITE L445G-PRINT-REC  FROM PRT-L445-HDG-3    AFTER 1.              
            WRITE L445G-PRINT-REC  FROM PRT-L445-HDG-4    AFTER 2.              
            WRITE L445G-PRINT-REC  FROM PRT-L445-HDG-5    AFTER 1.              
            WRITE L445G-PRINT-REC  FROM PRT-L445-HDG-6    AFTER 1.              
            WRITE L445G-PRINT-REC  FROM PRT-L445-HDG-7    AFTER 1.              
            WRITE L445G-PRINT-REC  FROM PRT-L445-HDG-8    AFTER 1.              
            WRITE L445G-PRINT-REC  FROM PRT-L445-HDG-9    AFTER 1.              
            WRITE L445G-PRINT-REC  FROM PRT-L445-HDG-10   AFTER 1.              
            WRITE L445G-PRINT-REC  FROM PRT-L445-HDG-10A  AFTER 1.              
            WRITE L445G-PRINT-REC  FROM PRT-L445-HDG-11   AFTER 1.              
            WRITE L445G-PRINT-REC  FROM PRT-L445-SUBHDG-1 AFTER 3.              
            WRITE L445G-PRINT-REC  FROM PRT-L445-SUBHDG-2 AFTER 1.              
            WRITE L445G-PRINT-REC  FROM PRT-L445-SUBHDG-3 AFTER 1.              
            MOVE  SPACES             TO L445G-PRINT-REC.                        
            WRITE L445G-PRINT-REC AFTER 1.                                      
                                                                                
       4740-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4750-PRINT-L445H-HEADER.                                                 
      ******************************************************************        
            MOVE 'P13445AH'          TO L445-REPORT-ID.                         
            MOVE  WS-L445H-DESC      TO L445-REPORT-ID-DESC.                    
            MOVE 'LEASE     '        TO L445-SUP-LEASE-DESC.                    
            MOVE 'TAG'               TO L445-TAG-DESC.                          
            ADD   1                  TO WS-L445H-PAGE-CNT.                      
            MOVE  WS-L445H-PAGE-CNT  TO L445-PAGE.                              
            WRITE L445H-PRINT-REC  FROM PRT-L445-HDG-1    AFTER PAGE.           
            WRITE L445H-PRINT-REC  FROM PRT-L445-HDG-2    AFTER 2.              
            WRITE L445H-PRINT-REC  FROM PRT-L445-HDG-3    AFTER 1.              
            WRITE L445H-PRINT-REC  FROM PRT-L445-HDG-4    AFTER 2.              
            WRITE L445H-PRINT-REC  FROM PRT-L445-HDG-5    AFTER 1.              
            WRITE L445H-PRINT-REC  FROM PRT-L445-HDG-6    AFTER 1.              
            WRITE L445H-PRINT-REC  FROM PRT-L445-HDG-7    AFTER 1.              
            WRITE L445H-PRINT-REC  FROM PRT-L445-HDG-8    AFTER 1.              
            WRITE L445H-PRINT-REC  FROM PRT-L445-HDG-9    AFTER 1.              
            WRITE L445H-PRINT-REC  FROM PRT-L445-HDG-10   AFTER 1.              
            WRITE L445H-PRINT-REC  FROM PRT-L445-HDG-10A  AFTER 1.              
            WRITE L445H-PRINT-REC  FROM PRT-L445-HDG-11   AFTER 1.              
            WRITE L445H-PRINT-REC  FROM PRT-L445-SUBHDG-1 AFTER 3.              
            WRITE L445H-PRINT-REC  FROM PRT-L445-SUBHDG-2 AFTER 1.              
            WRITE L445H-PRINT-REC  FROM PRT-L445-SUBHDG-3 AFTER 1.              
            MOVE  SPACES             TO L445H-PRINT-REC.                        
            WRITE L445H-PRINT-REC AFTER 1.                                      
                                                                                
       4750-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4760-PRINT-L445I-HEADER.                                                 
      ******************************************************************        
            MOVE 'P13445AI'          TO L445-REPORT-ID.                         
            MOVE  WS-L445I-DESC      TO L445-REPORT-ID-DESC.                    
            MOVE 'LEASE     '        TO L445-SUP-LEASE-DESC.                    
            MOVE 'TAG'               TO L445-TAG-DESC.                          
            ADD   1                  TO WS-L445I-PAGE-CNT.                      
            MOVE  WS-L445I-PAGE-CNT  TO L445-PAGE.                              
            WRITE L445I-PRINT-REC  FROM PRT-L445-HDG-1    AFTER PAGE.           
            WRITE L445I-PRINT-REC  FROM PRT-L445-HDG-2    AFTER 2.              
            WRITE L445I-PRINT-REC  FROM PRT-L445-HDG-3    AFTER 1.              
            WRITE L445I-PRINT-REC  FROM PRT-L445-HDG-4    AFTER 2.              
            WRITE L445I-PRINT-REC  FROM PRT-L445-HDG-5    AFTER 1.              
            WRITE L445I-PRINT-REC  FROM PRT-L445-HDG-6    AFTER 1.              
            WRITE L445I-PRINT-REC  FROM PRT-L445-HDG-7    AFTER 1.              
            WRITE L445I-PRINT-REC  FROM PRT-L445-HDG-8    AFTER 1.              
            WRITE L445I-PRINT-REC  FROM PRT-L445-HDG-9    AFTER 1.              
            WRITE L445I-PRINT-REC  FROM PRT-L445-HDG-10   AFTER 1.              
            WRITE L445I-PRINT-REC  FROM PRT-L445-HDG-10A  AFTER 1.              
            WRITE L445I-PRINT-REC  FROM PRT-L445-HDG-11   AFTER 1.              
            WRITE L445I-PRINT-REC  FROM PRT-L445-SUBHDG-1 AFTER 3.              
            WRITE L445I-PRINT-REC  FROM PRT-L445-SUBHDG-2 AFTER 1.              
            WRITE L445I-PRINT-REC  FROM PRT-L445-SUBHDG-3 AFTER 1.              
            MOVE  SPACES             TO L445I-PRINT-REC.                        
            WRITE L445I-PRINT-REC AFTER 1.                                      
                                                                                
       4760-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       4770-PRINT-L445J-HEADER.                                                 
      ******************************************************************        
            MOVE 'P13445AJ'          TO L445-REPORT-ID.                         
            MOVE  WS-L445J-DESC      TO L445-REPORT-ID-DESC.                    
            MOVE 'LEASE     '        TO L445-SUP-LEASE-DESC.                    
            MOVE 'TAG'               TO L445-TAG-DESC.                          
            ADD   1                  TO WS-L445J-PAGE-CNT.                      
            MOVE  WS-L445J-PAGE-CNT  TO L445-PAGE.                              
            WRITE L445J-PRINT-REC  FROM PRT-L445-HDG-1    AFTER PAGE.           
            WRITE L445J-PRINT-REC  FROM PRT-L445-HDG-2    AFTER 2.              
            WRITE L445J-PRINT-REC  FROM PRT-L445-HDG-3    AFTER 1.              
            WRITE L445J-PRINT-REC  FROM PRT-L445-HDG-4    AFTER 2.              
            WRITE L445J-PRINT-REC  FROM PRT-L445-HDG-5    AFTER 1.              
            WRITE L445J-PRINT-REC  FROM PRT-L445-HDG-6    AFTER 1.              
            WRITE L445J-PRINT-REC  FROM PRT-L445-HDG-7    AFTER 1.              
            WRITE L445J-PRINT-REC  FROM PRT-L445-HDG-8    AFTER 1.              
            WRITE L445J-PRINT-REC  FROM PRT-L445-HDG-9    AFTER 1.              
            WRITE L445J-PRINT-REC  FROM PRT-L445-HDG-10   AFTER 1.              
            WRITE L445J-PRINT-REC  FROM PRT-L445-HDG-10A  AFTER 1.              
            WRITE L445J-PRINT-REC  FROM PRT-L445-HDG-11   AFTER 1.              
            WRITE L445J-PRINT-REC  FROM PRT-L445-SUBHDG-1 AFTER 3.              
            WRITE L445J-PRINT-REC  FROM PRT-L445-SUBHDG-2 AFTER 1.              
            WRITE L445J-PRINT-REC  FROM PRT-L445-SUBHDG-3 AFTER 1.              
            MOVE  SPACES             TO L445J-PRINT-REC.                        
            WRITE L445J-PRINT-REC AFTER 1.                                      
                                                                                
       4770-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *-----------------*                                                       
       4800-UPDATE-F315.                                                        
      *-----------------*                                                       
              MOVE 'U'           TO  F315-CDE-RELEASE-PAYMENT.                  
              REWRITE BP13F315-TRANS-REC.                                       
                                                                                
       4800-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       5000-WRITE-HEADER-F680.                                                  
      ******************************************************************        
            EVALUATE TRUE                                                       
            WHEN     REPORT-L445A                                               
               PERFORM 4620-PRINT-L445A-HEADER   THRU 4620-EXIT                 
            WHEN     REPORT-L445D                                               
               PERFORM 4710-PRINT-L445D-HEADER   THRU 4710-EXIT                 
            WHEN     REPORT-L445E                                               
               PERFORM 4720-PRINT-L445E-HEADER   THRU 4720-EXIT                 
            WHEN     REPORT-L445G                                               
               PERFORM 4740-PRINT-L445G-HEADER   THRU 4740-EXIT                 
            WHEN     REPORT-L445H                                               
               PERFORM 4750-PRINT-L445H-HEADER   THRU 4750-EXIT                 
            WHEN     REPORT-L445I                                               
               PERFORM 4760-PRINT-L445I-HEADER   THRU 4760-EXIT                 
            WHEN     REPORT-L445J                                               
               PERFORM 4770-PRINT-L445J-HEADER   THRU 4770-EXIT                 
            END-EVALUATE.                                                       
                                                                                
       5000-HEADER-EXIT.                                                        
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       5000-WRITE-TRAILER-F680.                                                 
      ******************************************************************        
            IF WS-CNT-DETAILS = ZEROES                                          
               GO TO 5000-TRAILER-EXIT                                          
            END-IF.                                                             
                                                                                
            EVALUATE TRUE                                                       
            WHEN     REPORT-L445A                                               
               PERFORM 4210-PRINT-L445A-GRAND-TOTAL THRU 4210-EXIT              
               MOVE    WS-AMT                TO   WS-AMT-TOTAL                  
               DISPLAY ' A     '       WS-AMT-TOTAL                             
            WHEN     REPORT-L445D                                               
               PERFORM 4240-PRINT-L445D-GRAND-TOTAL THRU 4240-EXIT              
               MOVE    WS-AMT                TO   WS-AMT-TOTAL                  
               DISPLAY ' D     '       WS-AMT-TOTAL                             
            WHEN     REPORT-L445E                                               
               PERFORM 4250-PRINT-L445E-GRAND-TOTAL THRU 4250-EXIT              
               MOVE    WS-AMT                TO   WS-AMT-TOTAL                  
               DISPLAY ' E     '       WS-AMT-TOTAL                             
            WHEN     REPORT-L445G                                               
               PERFORM 4270-PRINT-L445G-GRAND-TOTAL THRU 4270-EXIT              
               MOVE    WS-AMT                TO   WS-AMT-TOTAL                  
               DISPLAY ' G     '       WS-AMT-TOTAL                             
            WHEN     REPORT-L445H                                               
               PERFORM 4280-PRINT-L445H-GRAND-TOTAL THRU 4280-EXIT              
               MOVE    WS-AMT                TO   WS-AMT-TOTAL                  
               DISPLAY ' H     '       WS-AMT-TOTAL                             
            WHEN     REPORT-L445I                                               
               PERFORM 4290-PRINT-L445I-GRAND-TOTAL THRU 4290-EXIT              
               MOVE    WS-AMT                TO   WS-AMT-TOTAL                  
               DISPLAY ' I     '       WS-AMT-TOTAL                             
            WHEN     REPORT-L445J                                               
               PERFORM 4295-PRINT-L445J-GRAND-TOTAL THRU 4295-EXIT              
               MOVE    WS-AMT                TO   WS-AMT-TOTAL                  
               DISPLAY ' J     '       WS-AMT-TOTAL                             
            END-EVALUATE.                                                       
                                                                                
       5000-TRAILER-EXIT.                                                       
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       8000-DISPLAY-STATISTICS.                                                 
      ******************************************************************        
            MOVE    WS-BP13F315-READ-CNT  TO  WS-EDIT-BP13F315-READ.            
            MOVE    WS-L445A-PRINT-CNT    TO  WS-EDIT-L445A-PRINT.              
            MOVE    WS-L445D-PRINT-CNT    TO  WS-EDIT-L445D-PRINT.              
            MOVE    WS-L445E-PRINT-CNT    TO  WS-EDIT-L445E-PRINT.              
            MOVE    WS-L445G-PRINT-CNT    TO  WS-EDIT-L445G-PRINT.              
            MOVE    WS-L445H-PRINT-CNT    TO  WS-EDIT-L445H-PRINT.              
            MOVE    WS-L445I-PRINT-CNT    TO  WS-EDIT-L445I-PRINT.              
            MOVE    WS-L445J-PRINT-CNT    TO  WS-EDIT-L445J-PRINT.              
                                                                                
            DISPLAY WS-BLANK-LINE.                                              
            DISPLAY WS-SUMMARY-HEADER.                                          
            DISPLAY WS-BLANK-LINE.                                              
            DISPLAY WS-READ-CASES.                                              
            DISPLAY WS-DOA-PAYMENT-PRINTED.                                     
            DISPLAY WS-L445D-PRINTED.                                           
            DISPLAY WS-L445E-PRINTED.                                           
            DISPLAY WS-L445G-PRINTED.                                           
            DISPLAY WS-L445H-PRINTED.                                           
            DISPLAY WS-L445I-PRINTED.                                           
            DISPLAY WS-L445J-PRINTED.                                           
            DISPLAY WS-BLANK-LINE.                                              
            DISPLAY WS-SUMMARY-TRAILER.                                         
                                                                                
       8000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       9000-CLOSE-FILES.                                                        
      ******************************************************************        
            CLOSE  B05K006                                                      
                   BP13F315                                                     
                   BP13K410                                                     
                   P13445AA                                                     
                   P13445AD                                                     
                   P13445AE                                                     
                   P13445AG                                                     
                   P13445AH                                                     
                   P13445AI                                                     
                   P13445AJ.                                                    
                                                                                
            IF WS-K006-STATUS NOT = 00 AND 97                                   
               DISPLAY 'ERROR CLOSING B05K006, STAT = ' WS-K006-STATUS          
               MOVE     WS-K006-STATUS     TO  RETURN-CODE                      
            END-IF.                                                             
                                                                                
            IF WS-K410-STATUS NOT = 00 AND 97                                   
               DISPLAY 'ERROR CLOSING BP13K410, STAT = ' WS-K410-STATUS         
               MOVE     WS-K410-STATUS      TO  RETURN-CODE                     
            END-IF.                                                             
                                                                                
                                                                                
            STOP RUN.                                                           
                                                                                
       9000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       9500-CONVT-AMT-WORD.                                                     
      ******************************************************************        
      *------------------------------------------------------------*            
      *                                                            *            
      *     OBJECTIVE  :  CONVERSION FROM AMOUNT IN DIGITS         *            
      *                              INTO AMOUNT IN WORDS          *            
      *                                                            *            
      *------------------------------------------------------------*            
            MOVE SPACES TO WF-DETAILS.                                          
            MOVE ZERO   TO WS-SWITCH                                            
                           WS-THO-SW                                            
                           WS-CNT-SW                                            
                           WS-LIT-SW                                            
                           WS-TEN-SW                                            
                           WS-AND-SW.                                           
            MOVE 60     TO WS-PLACE-COUNTER.                                    
            MOVE 1      TO WF-SUB.                                              
                                                                                
            PERFORM B000-ROUTINE THRU B990-EXIT                                 
                         VARYING WS-SUB FROM 1 BY 1 UNTIL WS-SUB = 10.          
                                                                                
       9500-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       B000-ROUTINE SECTION.                                                    
      ******************************************************************        
       B000-GO.                                                                 
            IF WS-DIGIT (WS-SUB) = ZERO                                         
                 IF WS-TEN-SW = ZERO                                            
                    GO TO B800-MOVE-TYPE                                        
                 ELSE                                                           
                    GO TO B010-PROCESS.                                         
                                                                                
            IF WS-FIRST-SUB = ZERO                                              
               MOVE WS-SUB TO WS-FIRST-SUB.                                     
                                                                                
            IF WS-SWITCH = ZERO                                                 
               MOVE 1 TO WS-SWITCH.                                             
                                                                                
       B010-PROCESS.                                                            
            IF WS-SUB = 8                                                       
               MOVE 9 TO WS-CNT-SW.                                             
                                                                                
            IF WS-SUB = 9                                                       
               IF WS-CNT-SW = ZERO                                              
                  MOVE WS-DIGIT (WS-SUB) TO WS-CNT-SW.                          
                                                                                
            IF WS-SUB = 2 OR 3 OR 4                                             
               MOVE 1 TO WS-THO-SW.                                             
                                                                                
            MOVE WS-DIGIT (WS-SUB) TO WA-SUB.                                   
            IF WS-SUB = 3 OR 6 OR 8                                             
               IF WS-DIGIT (WS-SUB) = 1                                         
                  MOVE 1 TO WS-TEN-SW                                           
                  GO TO B990-EXIT                                               
               ELSE                                                             
                  ADD 18 TO WA-SUB                                              
            ELSE                                                                
            IF WS-SUB = 1 OR 4 OR 7 OR 9                                        
               IF WS-TEN-SW = 1                                                 
                  MOVE 0 TO WS-TEN-SW                                           
                  ADD 10 TO WA-SUB.                                             
            MOVE WA-NAME (WA-SUB) TO WL-AREA.                                   
            PERFORM R000-LOAD-IN.                                               
                                                                                
       B300-TENS.                                                               
            IF WS-SUB = 3 OR 6 OR 8                                             
               GO TO B990-EXIT.                                                 
                                                                                
       B400-MOVE-HUNDRED.                                                       
            IF WS-SUB = 2 OR 5                                                  
               MOVE L-HUNDRED TO WL-AREA                                        
               MOVE 1 TO WS-LIT-SW                                              
               PERFORM R000-LOAD-IN                                             
               MOVE 1 TO WS-AND-SW                                              
               GO TO B990-EXIT.                                                 
                                                                                
       B800-MOVE-TYPE.                                                          
            IF WS-SWITCH = ZERO                                                 
               GO TO B990-EXIT.                                                 
                                                                                
            IF WS-SUB = 1                                                       
               MOVE  L-MILLION TO WL-AREA                                       
               MOVE  1         TO WS-LIT-SW                                     
               MOVE  1         TO WS-AND-SW                                     
               GO TO B880-LOAD-IN.                                              
                                                                                
            IF WS-SUB = 7                                                       
               MOVE 1 TO WS-LIT-SW WS-AND-SW                                    
               IF WS-FIRST-SUB = 7  AND                                         
                  WS-DIGIT (WS-SUB) = 1                                         
                  MOVE L-DOLLAR TO WL-AREA                                      
                  GO TO B880-LOAD-IN                                            
               ELSE                                                             
                  MOVE L-DOLLARS TO WL-AREA                                     
                  GO TO B880-LOAD-IN.                                           
                                                                                
            IF WS-SUB = 4 AND WS-THO-SW = 1                                     
               MOVE 1 TO WS-AND-SW WS-LIT-SW                                    
               MOVE L-THOUSAND TO WL-AREA                                       
               GO TO B880-LOAD-IN.                                              
                                                                                
            IF WS-SUB = 9                                                       
               MOVE 1 TO WS-LIT-SW                                              
               IF WS-CNT-SW = ZERO                                              
                  MOVE L-ONLY TO WL-AREA                                        
                  GO TO B880-LOAD-IN                                            
               ELSE                                                             
               IF WS-CNT-SW = 1                                                 
                  MOVE L-CENT TO WL-AREA                                        
                  PERFORM R000-LOAD-IN                                          
                  MOVE L-ONLY TO WL-AREA                                        
                  GO TO B880-LOAD-IN                                            
               ELSE                                                             
                  MOVE L-CENTS TO WL-AREA                                       
                  PERFORM R000-LOAD-IN                                          
                  MOVE L-ONLY TO WL-AREA                                        
                  GO TO B880-LOAD-IN.                                           
            GO TO B990-EXIT.                                                    
                                                                                
       B880-LOAD-IN.                                                            
            PERFORM R000-LOAD-IN.                                               
                                                                                
       B990-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       R000-LOAD-IN SECTION.                                                    
      ******************************************************************        
      *------------------------------------------------------------*            
      *                                                            *            
      *     THIS SECTION LOADS THE WORDS INTO THE THREE LINES      *            
      *     AND JUST KEEPS INCREMENTING A SUBSCRIPT.               *            
      *                                                            *            
      *------------------------------------------------------------*            
                                                                                
       R001-GO.                                                                 
            IF WS-LIT-SW = 1                                                    
               MOVE ZERO TO WS-LIT-SW                                           
               GO TO R050-CONT.                                                 
                                                                                
            IF WS-SUB = 2 OR 5                                                  
               GO TO R050-CONT.                                                 
                                                                                
       R025-ADD-TEST.                                                           
            IF WS-AND-SW NOT = 1                                                
               GO TO R050-CONT.                                                 
                                                                                
            MOVE ZERO TO WS-AND-SW.                                             
            MOVE WL-AREA TO WL-AREA-SAVE.                                       
            MOVE L-AND TO WL-AREA.                                              
            PERFORM R200-LOADUP.                                                
            MOVE WL-AREA-SAVE TO WL-AREA.                                       
                                                                                
       R050-CONT.                                                               
            PERFORM R200-LOADUP.                                                
                                                                                
       R099-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       R200-LOADUP SECTION.                                                     
      ******************************************************************        
       R201-GO.                                                                 
            ADD WL-ITEM1 WF-SUB GIVING WS-RESULT.                               
            IF  WS-RESULT > WS-PLACE-COUNTER                                    
                ADD 1 WS-PLACE-COUNTER GIVING WF-SUB                            
                ADD 60 TO WS-PLACE-COUNTER.                                     
                                                                                
            PERFORM R500-LOAD VARYING WL-SUB FROM 2 BY 1 UNTIL                  
                    WL-ITEM (WL-SUB) = L-X.                                     
                                                                                
       R490-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       R500-LOAD SECTION.                                                       
      ******************************************************************        
       R501-GO.                                                                 
                                                                                
            MOVE WL-ITEM (WL-SUB) TO WF-ITEM (WF-SUB).                          
            ADD  1                TO WF-SUB.                                    
            IF WL-ITEM (WL-SUB) = SPACE                                         
               ADD   1     TO     WL-SUB                                        
               MOVE  L-X   TO     WL-ITEM (WL-SUB)                              
               SUBTRACT 1  FROM   WL-SUB.                                       
                                                                                
       R990-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ***************************************************************           
