       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.   BP13C996.                                                  
      *DATE-WRITTEN. 13 JUN 2016.                                               
      *AUTHOR.       KRISTINE LANTIN.                                           
      * ========================================================== *            
      * SYSTEM OF COMMITMENT (BP13)                                *            
      * ========================================================== *            
      *                                                            *            
      *  OBJECTIVE: 1) TO FORMAT INTO EMAIL ALERT ALL PPO EXTRACTED*            
      *                FROM PROGRAM BP13C995.                      *            
      * ---------------------------------------------------------- *            
      * CHG REF  DATE     BY    DESCRIPTION                        *            
      * -------- -------- ----- -----------                        *            
      * BP136326 20160613 KVL1  NEW PROGRAM                        *            
      * BP136910 20170721 KVL1  TO FORMAT INTO EMAIL ALERT NON-EX- *            
      *                         EMPT CASES AFTER TP.               *            
      * BP137687 20190211 DN8   TO UPDATE THE RECIPIENT TO         *            
      *                         Hong Huat LAU (HDB).               *            
      * BP138202 20200310 KV5   REPLACE MAIL FROM HONG HUAT LAU TO *            
      *                         HENG SC SUZANNE(HDB).              *            
      * ========================================================== *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
      *-------------------------------------------------------------            
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13FPRB ASSIGN TO BP13FPRB.                                  
           SELECT BP13FPOS ASSIGN TO BP13FPOS.                                  
           SELECT BP13F73B ASSIGN TO BP13F73B.                                  
           SELECT BP13F73C ASSIGN TO BP13F73C.                                  
           SELECT BP13F73D ASSIGN TO BP13F73D.                                  
           SELECT MAILRPA1 ASSIGN TO MAILRPA1.                                  
           SELECT MAILRPA2 ASSIGN TO MAILRPA2.                                  
           SELECT MAILRPB1 ASSIGN TO MAILRPB1.                                  
           SELECT MAILRPB2 ASSIGN TO MAILRPB2.                                  
           SELECT MAILRPC1 ASSIGN TO MAILRPC1.                                  
           SELECT MAILRPC2 ASSIGN TO MAILRPC2.                                  
           SELECT MAILRPD1 ASSIGN TO MAILRPD1.                                  
           SELECT MAILRPD2 ASSIGN TO MAILRPD2.                                  
                                                                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       FD  BP13FPRB                                                             
           RECORD CONTAINS 250  CHARACTERS                                      
           RECORDING MODE  IS  F.                                               
       01  BP13FPRB-REC.                                                        
           05 FPRB-NUM-REGN          PIC X(08).                                 
           05 FPRB-NUM-NRIC          PIC X(09).                                 
           05 FPRB-NUM-HDB-REF       PIC X(11).                                 
           05 FPRB-PPO-ADDRESS       PIC X(100).                                
           05 FPRB-DTE-DISPOSE-DUE   PIC X(08).                                 
           05 FPRB-OIC-EMAIL-POSB    PIC X(60).                                 
           05 FPRB-OIC-EMAIL-PREB    PIC X(50).                                 
           05 FILLER                 PIC X(04).                                 
                                                                                
                                                                                
       FD  BP13FPOS                                                             
           RECORD CONTAINS 250  CHARACTERS                                      
           RECORDING MODE  IS  F.                                               
       01  BP13FPOS-REC.                                                        
           05 FPOS-NUM-REGN          PIC X(08).                                 
           05 FPOS-NUM-NRIC          PIC X(09).                                 
           05 FPOS-NUM-HDB-REF       PIC X(11).                                 
           05 FPOS-PPO-ADDRESS       PIC X(100).                                
           05 FPOS-DTE-DISPOSE-DUE   PIC X(08).                                 
           05 FPOS-OIC-EMAIL-POSB    PIC X(60).                                 
           05 FPOS-OIC-EMAIL-PREB    PIC X(50).                                 
           05 FILLER                 PIC X(04).                                 
                                                                                
       FD  BP13F73B                                                             
           RECORD CONTAINS 250  CHARACTERS                                      
           RECORDING MODE  IS  F.                                               
       01  BP13F73B-REC.                                                        
           05 F73B-NUM-REGN          PIC X(08).                                 
           05 F73B-NUM-NRIC          PIC X(09).                                 
           05 F73B-NUM-HDB-REF       PIC X(11).                                 
           05 F73B-PPO-ADDRESS       PIC X(100).                                
           05 F73B-DTE-DISPOSE-DUE   PIC X(08).                                 
           05 F73B-OIC-EMAIL         PIC X(60).                                 
           05 FILLER                 PIC X(54).                                 
                                                                                
       FD  BP13F73C                                                             
           RECORD CONTAINS 250  CHARACTERS                                      
           RECORDING MODE  IS  F.                                               
       01  BP13F73C-REC.                                                        
           05 F73C-NUM-REGN          PIC X(08).                                 
           05 F73C-NUM-NRIC          PIC X(09).                                 
           05 F73C-NUM-HDB-REF       PIC X(11).                                 
           05 F73C-PPO-ADDRESS       PIC X(100).                                
           05 F73C-DTE-DISPOSE-DUE   PIC X(08).                                 
           05 F73C-OIC-EMAIL         PIC X(60).                                 
           05 FILLER                 PIC X(54).                                 
                                                                                
       FD  BP13F73D                                                             
           RECORD CONTAINS 250  CHARACTERS                                      
           RECORDING MODE  IS  F.                                               
       01  BP13F73D-REC.                                                        
           05 F73D-NUM-REGN          PIC X(08).                                 
           05 F73D-NUM-NRIC          PIC X(09).                                 
           05 FILLER                 PIC X(119).                                
           05 F73D-OIC-EMAIL         PIC X(60).                                 
           05 F73D-OIC               PIC X(05).                                 
           05 F73D-NAME              PIC X(40).                                 
           05 F73D-DTE-TP            PIC X(08).                                 
           05 FILLER                 PIC X(01).                                 
                                                                                
       FD  MAILRPA1                                                             
           RECORD CONTAINS 200   CHARACTERS                                     
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE  IS  F.                                               
       01  MAILRPA1-REC              PIC X(200).                                
                                                                                
       FD  MAILRPA2                                                             
           RECORD CONTAINS 200   CHARACTERS                                     
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE  IS  F.                                               
       01  MAILRPA2-REC              PIC X(200).                                
                                                                                
       FD  MAILRPB1                                                             
           RECORD CONTAINS 200   CHARACTERS                                     
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE  IS  F.                                               
       01  MAILRPB1-REC              PIC X(200).                                
                                                                                
       FD  MAILRPB2                                                             
           RECORD CONTAINS 200   CHARACTERS                                     
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE  IS  F.                                               
       01  MAILRPB2-REC              PIC X(200).                                
                                                                                
       FD  MAILRPC1                                                             
           RECORD CONTAINS 200   CHARACTERS                                     
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE  IS  F.                                               
       01  MAILRPC1-REC              PIC X(200).                                
                                                                                
       FD  MAILRPC2                                                             
           RECORD CONTAINS 200   CHARACTERS                                     
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE  IS  F.                                               
       01  MAILRPC2-REC              PIC X(200).                                
                                                                                
       FD  MAILRPD1                                                             
           RECORD CONTAINS 200   CHARACTERS                                     
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE  IS  F.                                               
       01  MAILRPD1-REC              PIC X(200).                                
                                                                                
       FD  MAILRPD2                                                             
           RECORD CONTAINS 200   CHARACTERS                                     
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE  IS  F.                                               
       01  MAILRPD2-REC              PIC X(200).                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
      *-------------------------------------------------------------            
       01  WS-FPRB-READ             PIC 9(6)   VALUE ZERO.                      
       01  WS-FPOS-READ             PIC 9(6)   VALUE ZERO.                      
       01  WS-F73B-READ             PIC 9(6)   VALUE ZERO.                      
       01  WS-F73C-READ             PIC 9(6)   VALUE ZERO.                      
       01  WS-F73D-READ             PIC 9(6)   VALUE ZERO.                      
       01  WS-RPA1-WRITE            PIC 9(6)   VALUE ZERO.                      
       01  WS-RPA2-WRITE            PIC 9(6)   VALUE ZERO.                      
       01  WS-RPB1-WRITE            PIC 9(6)   VALUE ZERO.                      
       01  WS-RPB2-WRITE            PIC 9(6)   VALUE ZERO.                      
       01  WS-RPC1-WRITE            PIC 9(6)   VALUE ZERO.                      
       01  WS-RPC2-WRITE            PIC 9(6)   VALUE ZERO.                      
       01  WS-RPD1-WRITE            PIC 9(6)   VALUE ZERO.                      
       01  WS-RPD2-WRITE            PIC 9(6)   VALUE ZERO.                      
       01  WS-SNO                   PIC 9(6)   VALUE ZERO.                      
       01  WS-SNO2                  PIC 9(6)   VALUE ZERO.                      
       01  WS-FPRB-EOF              PIC X      VALUE 'N'.                       
       01  WS-FPOS-EOF              PIC X      VALUE 'N'.                       
       01  WS-F73B-EOF              PIC X      VALUE 'N'.                       
       01  WS-F73C-EOF              PIC X      VALUE 'N'.                       
       01  WS-F73D-EOF              PIC X      VALUE 'N'.                       
       01  WS-LISTING-TAG           PIC X      VALUE SPACE.                     
       01  WS-SAVE-OIC              PIC X(60)  VALUE SPACES.                    
       01  WS-CUR-DATE.                                                         
           05 WS-CCYY               PIC 9(04).                                  
           05 WS-MM                 PIC 9(02).                                  
           05 WS-DD                 PIC 9(02).                                  
                                                                                
       01  WS-EDT-DATE.                                                         
           05 WS-EDT-DD             PIC 9(02).                                  
           05 FILLER                PIC X(01) VALUE '/'.                        
           05 WS-EDT-MM             PIC 9(02).                                  
           05 FILLER                PIC X(01) VALUE '/'.                        
           05 WS-EDT-CCYY           PIC 9(04).                                  
                                                                                
      *-------------------------------------------------------------            
      * LAYOUT MAILFILE  -  DATASET FOR EMAIL                                   
      *-------------------------------------------------------------            
       01  MAIL-HDR1.                                                           
           05  FILLER          PIC X(12)  VALUE 'HELO SGPHDB1'.                 
           05  FILLER          PIC X(68)  VALUE SPACES.                         
                                                                                
       01  MAIL-HDR2.                                                           
           05  FILLER          PIC X(11)  VALUE 'MAIL FROM:<'.                  
           05  MAIL-SENDID     PIC X(04)  VALUE 'OPCP'.                         
           05  FILLER          PIC X(09)  VALUE '@SGPHDB1>'.                    
           05  FILLER          PIC X(56)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL1.                                                           
           05  RCTP-TO         PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  RCPT-ID         PIC X(60)                                        
               VALUE 'KATHIJAH_BEE_ALI_MOHAMED@HDB.GOV.SG>'.                    
                                                                                
       01  MAIL-DTL1A.                                                          
           05  RCTP-TO-A       PIC X(09)  VALUE 'RCPT TO:<'.                    
           05  RCPT-ID-A       PIC X(60)                                        
               VALUE 'SUZANNE_SC_HENG@HDB.GOV.SG>'.                             
      *        VALUE 'LAU_HONG_HUAT@HDB.GOV.SG>'.                               
                                                                                
       01  MAIL-DTL2.                                                           
           05  FILLER          PIC X(04)  VALUE 'DATA'.                         
           05  FILLER          PIC X(76)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL3.                                                           
           05  FILLER          PIC X(05)  VALUE 'FROM:'.                        
           05  MAIL-SENDMAILID PIC X(24)  VALUE                                 
               'SOC SYSTEM - EMAIL ALERT'.                                      
           05  FILLER          PIC X(49)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL4.                                                           
           05  TO-MAIL         PIC X(04)  VALUE 'TO:<'.                         
           05  TO-MAIL-ID      PIC X(60)                                        
               VALUE 'KATHIJAH_BEE_ALI_MOHAMED@HDB.GOV.SG>'.                    
                                                                                
       01  MAIL-DTL4A.                                                          
           05  TO-MAIL-4A      PIC X(04)  VALUE 'TO:<'.                         
           05  TO-MAIL-ID-4A   PIC X(60)                                        
               VALUE 'SUZANNE_SC_HENG@HDB.GOV.SG>'.                             
      *        VALUE 'LAU_HONG_HUAT@HDB.GOV.SG>'.                               
                                                                                
       01  MAIL-DTL5.                                                           
           05  FILLER          PIC X(10)  VALUE 'SUBJECT : '.                   
           05  MAIL-SUBJECT    PIC X(90)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL6.                                                           
           05  FILLER          PIC X(06)  VALUE 'DATE: '.                       
           05  MAIL-DTL6-DATE  PIC X(10)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL7.                                                           
           05  MAIL-DTL7-LST   PIC X(12)  VALUE SPACES.                         
           05  FILLER          PIC X(10)  VALUE 'HDBCAT 3  '.                   
           05  FILLER          PIC X(41)  VALUE                                 
               'S Y S T E M   O F   C O M M I T M E N T  '.                     
           05  FILLER          PIC X(06)  VALUE 'DATE: '.                       
           05  MAIL-DTL7-DATE  PIC X(10)  VALUE SPACES.                         
                                                                                
       01  MAIL-DTL8.                                                           
           05  MAIL-DTL8-TITLE PIC X(90)  VALUE SPACES.                         
                                                                                
       01  MAIL-BODY02.                                                         
           05 FILLER           PIC X(02)  VALUE SPACES.                         
           05 FILLER           PIC X(04)  VALUE 'S/N '.                         
           05 FILLER           PIC X(02)  VALUE SPACES.                         
           05 FILLER           PIC X(08)  VALUE ' Regn No'.                     
           05 FILLER           PIC X(02)  VALUE SPACES.                         
           05 FILLER           PIC X(09)  VALUE '   NRIC  '.                    
           05 FILLER           PIC X(03)  VALUE SPACES.                         
           05 FILLER           PIC X(13)  VALUE 'Resale HDBRef'.                
           05 FILLER           PIC X(12)  VALUE SPACES.                         
           05 FILLER           PIC X(20)  VALUE '        PPO Address '.         
           05 FILLER           PIC X(40)  VALUE SPACES.                         
           05 FILLER           PIC X(20)  VALUE '       CRM          '.         
                                                                                
       01  MAIL-BODY03.                                                         
           05 MAIL3-SNO        PIC ZZZZZ9 VALUE ZEROS.                          
           05 FILLER           PIC X(02)  VALUE SPACES.                         
           05 MAIL3-REGN-NO    PIC X(08)  VALUE SPACES.                         
           05 FILLER           PIC X(02)  VALUE SPACES.                         
           05 MAIL3-NRIC       PIC X(09)  VALUE SPACES.                         
           05 FILLER           PIC X(04)  VALUE SPACES.                         
           05 MAIL3-HDB-REF    PIC X(11)  VALUE SPACES.                         
           05 FILLER           PIC X(04)  VALUE SPACES.                         
           05 MAIL3-ADDRESS    PIC X(60)  VALUE SPACES.                         
           05 FILLER           PIC X(04)  VALUE SPACES.                         
           05 MAIL3-OIC        PIC X(38)  VALUE SPACES.                         
                                                                                
       01  MAIL-BODY04.                                                         
           05 FILLER           PIC X(02)  VALUE SPACES.                         
           05 FILLER           PIC X(04)  VALUE 'S/N '.                         
           05 FILLER           PIC X(02)  VALUE SPACES.                         
           05 FILLER           PIC X(08)  VALUE ' Regn No'.                     
           05 FILLER           PIC X(02)  VALUE SPACES.                         
           05 FILLER           PIC X(09)  VALUE '   NRIC  '.                    
           05 FILLER           PIC X(03)  VALUE SPACES.                         
           05 FILLER           PIC X(13)  VALUE 'Resale HDBRef'.                
           05 FILLER           PIC X(12)  VALUE SPACES.                         
           05 FILLER           PIC X(13)  VALUE '  PPO Address'.                
           05 FILLER           PIC X(34)  VALUE SPACES.                         
           05 FILLER           PIC X(20)  VALUE '     CSM (PREB)     '.         
           05 FILLER           PIC X(23)  VALUE SPACES.                         
           05 FILLER           PIC X(20)  VALUE '     CSM (POSB)     '.         
           05 FILLER           PIC X(12)  VALUE SPACES.                         
           05 FILLER           PIC X(19)  VALUE 'Deadline to Dispose'.          
                                                                                
       01  MAIL-BODY05.                                                         
           05 MAIL-SNO         PIC ZZZZZ9 VALUE ZEROS.                          
           05 FILLER           PIC X(02)  VALUE SPACES.                         
           05 MAIL-REGN-NO     PIC X(08)  VALUE SPACES.                         
           05 FILLER           PIC X(02)  VALUE SPACES.                         
           05 MAIL-NRIC        PIC X(09)  VALUE SPACES.                         
           05 FILLER           PIC X(04)  VALUE SPACES.                         
           05 MAIL-HDB-REF     PIC X(11)  VALUE SPACES.                         
           05 FILLER           PIC X(04)  VALUE SPACES.                         
           05 MAIL-ADDRESS     PIC X(50)  VALUE SPACES.                         
           05 FILLER           PIC X(02)  VALUE SPACES.                         
           05 MAIL-CSM1        PIC X(40)  VALUE SPACES.                         
           05 FILLER           PIC X(02)  VALUE SPACES.                         
           05 MAIL-CSM2        PIC X(40)  VALUE SPACES.                         
           05 FILLER           PIC X(02)  VALUE SPACES.                         
           05 MAIL-DTE-DISPOSE PIC X(08)  VALUE SPACES.                         
                                                                                
       01  MAIL-BODY06.                                                         
           05 FILLER           PIC X(02)  VALUE SPACES.                         
           05 FILLER           PIC X(04)  VALUE 'S/N '.                         
           05 FILLER           PIC X(02)  VALUE SPACES.                         
           05 FILLER           PIC X(05)  VALUE ' CRM '.                        
           05 FILLER           PIC X(02)  VALUE SPACES.                         
           05 FILLER           PIC X(09)  VALUE ' Regn  No'.                    
           05 FILLER           PIC X(03)  VALUE SPACES.                         
           05 FILLER           PIC X(09)  VALUE '   NRIC  '.                    
           05 FILLER           PIC X(12)  VALUE SPACES.                         
           05 FILLER           PIC X(15)  VALUE '           Name'.              
           05 FILLER           PIC X(17)  VALUE SPACES.                         
           05 FILLER           PIC X(20)  VALUE '     Date of TP     '.         
                                                                                
       01  MAIL-BODY07.                                                         
           05 MAIL7-SNO        PIC ZZZZZ9 VALUE ZEROS.                          
           05 FILLER           PIC X(02)  VALUE SPACES.                         
           05 MAIL7-CRM        PIC X(05)  VALUE SPACES.                         
           05 FILLER           PIC X(03)  VALUE SPACES.                         
           05 MAIL7-REGN-NO    PIC X(08)  VALUE SPACES.                         
           05 FILLER           PIC X(03)  VALUE SPACES.                         
           05 MAIL7-NRIC       PIC X(09)  VALUE SPACES.                         
           05 FILLER           PIC X(04)  VALUE SPACES.                         
           05 MAIL7-NAME       PIC X(40)  VALUE SPACES.                         
           05 FILLER           PIC X(06)  VALUE SPACES.                         
           05 MAIL7-DTE-TP     PIC X(08)  VALUE SPACES.                         
                                                                                
       01  MAIL-SPACES.                                                         
           05 FILLER           PIC X(200)  VALUE SPACES.                        
                                                                                
       01  MAIL-END.                                                            
           05 FILLER           PIC X      VALUE '.'.                            
                                                                                
       PROCEDURE DIVISION.                                                      
      *-------------------------------------------------------------            
       0000-MAIN-LOGIC.                                                         
      *-------------------------------------------------------------            
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8) TO   WS-CUR-DATE.                    
                                                                                
           MOVE WS-CCYY TO WS-EDT-CCYY.                                         
           MOVE WS-MM   TO WS-EDT-MM.                                           
           MOVE WS-DD   TO WS-EDT-DD.                                           
                                                                                
           PERFORM 1000-OPEN-FILES         THRU 1000-EXIT.                      
           PERFORM 4000-PRINT-MAIL-HDR-SUMMARY                                  
                                           THRU 4000-EXIT.                      
                                                                                
           PERFORM 2000-READ-BP13F73B      THRU 2000-EXIT.                      
           IF WS-F73B-READ  =  0                                                
              DISPLAY 'FILE BP13F73B IS EMPTY, NO EMAIL TO CREATE'              
              MOVE SPACES                  TO   MAILRPB1-REC                    
              MOVE '                           <    EMPTY  REPORT   >'          
                                           TO   MAILRPB1-REC                    
              WRITE MAILRPB1-REC                                                
           ELSE                                                                 
              MOVE 'B'                     TO   WS-LISTING-TAG                  
              PERFORM 4100-PRINT-MAIL-HDR-OIC                                   
                                           THRU 4100-EXIT                       
              MOVE F73B-OIC-EMAIL          TO   WS-SAVE-OIC                     
              PERFORM 3000-WRITE-EMAIL1    THRU 3000-EXIT                       
                UNTIL WS-F73B-EOF = 'Y'                                         
           END-IF                                                               
                                                                                
           PERFORM 2100-READ-BP13F73C      THRU 2100-EXIT.                      
           IF WS-F73C-READ  =  0                                                
              DISPLAY 'FILE BP13F73C IS EMPTY, NO EMAIL TO CREATE'              
              MOVE SPACES                  TO   MAILRPC1-REC                    
              MOVE '                           <    EMPTY  REPORT   >'          
                                           TO   MAILRPC1-REC                    
              WRITE MAILRPC1-REC                                                
           ELSE                                                                 
              MOVE 'C'                     TO   WS-LISTING-TAG                  
              PERFORM 4100-PRINT-MAIL-HDR-OIC                                   
                                           THRU 4100-EXIT                       
              MOVE SPACES                  TO   WS-SAVE-OIC                     
              MOVE F73C-OIC-EMAIL          TO   WS-SAVE-OIC                     
              MOVE ZEROES                  to   WS-SNO                          
                                                WS-SNO2                         
              PERFORM 3100-WRITE-EMAIL2    THRU 3100-EXIT                       
                UNTIL WS-F73C-EOF = 'Y'                                         
           END-IF                                                               
                                                                                
           PERFORM 2200-READ-BP13FPRB      THRU 2200-EXIT.                      
           IF WS-FPRB-READ  =  0                                                
              DISPLAY 'FILE BP13FPRB IS EMPTY, NO EMAIL TO CREATE'              
              MOVE SPACES                  TO   MAILRPA1-REC                    
              MOVE '                           <    EMPTY  REPORT   >'          
                                           TO   MAILRPA1-REC                    
              WRITE MAILRPA1-REC                                                
           ELSE                                                                 
              MOVE 'A'                     TO   WS-LISTING-TAG                  
              PERFORM 4100-PRINT-MAIL-HDR-OIC                                   
                                           THRU 4100-EXIT                       
              MOVE SPACES                  TO   WS-SAVE-OIC                     
              MOVE FPRB-OIC-EMAIL-PREB     TO   WS-SAVE-OIC                     
              MOVE ZEROES                  to   WS-SNO                          
                                                WS-SNO2                         
              PERFORM 3200-WRITE-EMAIL3    THRU 3200-EXIT                       
                UNTIL WS-FPRB-EOF = 'Y'                                         
              PERFORM 2300-READ-BP13FPOS   THRU 2300-EXIT                       
              MOVE 'D'                     TO   WS-LISTING-TAG                  
              PERFORM 4100-PRINT-MAIL-HDR-OIC                                   
              MOVE SPACES                  TO   WS-SAVE-OIC                     
              MOVE FPOS-OIC-EMAIL-POSB     TO   WS-SAVE-OIC                     
              MOVE ZEROES                  to   WS-SNO                          
              PERFORM 3300-WRITE-EMAIL4    THRU 3300-EXIT                       
                UNTIL WS-FPOS-EOF = 'Y'                                         
           END-IF                                                               
                                                                                
           PERFORM 2400-READ-BP13F73D      THRU 2400-EXIT.                      
           IF WS-F73D-READ  =  0                                                
              DISPLAY 'FILE BP13F73D IS EMPTY, NO EMAIL TO CREATE'              
              MOVE SPACES                  TO   MAILRPD1-REC                    
              MOVE '                           <    EMPTY  REPORT   >'          
                                           TO   MAILRPD1-REC                    
              WRITE MAILRPD1-REC                                                
           ELSE                                                                 
              MOVE 'E'                     TO   WS-LISTING-TAG                  
              PERFORM 4100-PRINT-MAIL-HDR-OIC                                   
                                           THRU 4100-EXIT                       
              MOVE SPACES                  TO   WS-SAVE-OIC                     
              MOVE F73D-OIC-EMAIL          TO   WS-SAVE-OIC                     
              MOVE ZEROES                  to   WS-SNO                          
                                                WS-SNO2                         
              PERFORM 3400-WRITE-EMAIL5    THRU 3400-EXIT                       
                UNTIL WS-F73D-EOF = 'Y'                                         
           END-IF                                                               
                                                                                
           PERFORM 9000-CLOSE-ROUTINE      THRU 9000-EXIT.                      
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       1000-OPEN-FILES.                                                         
      *-------------------------------------------------------------            
                                                                                
           OPEN INPUT  BP13FPRB                                                 
                       BP13FPOS                                                 
                       BP13F73B                                                 
                       BP13F73C                                                 
                       BP13F73D                                                 
                OUTPUT MAILRPA1                                                 
                       MAILRPA2                                                 
                       MAILRPB1                                                 
                       MAILRPB2                                                 
                       MAILRPC1                                                 
                       MAILRPC2                                                 
                       MAILRPD1                                                 
                       MAILRPD2.                                                
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *-------------------------------------------------------------            
       2000-READ-BP13F73B.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13F73B AT END                                                 
                MOVE 'Y' TO WS-F73B-EOF                                         
                GO TO 2000-EXIT.                                                
                                                                                
           ADD 1 TO WS-F73B-READ.                                               
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       2100-READ-BP13F73C.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13F73C AT END                                                 
                MOVE 'Y' TO WS-F73C-EOF                                         
                GO TO 2100-EXIT.                                                
                                                                                
           ADD 1 TO WS-F73C-READ.                                               
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       2200-READ-BP13FPRB.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13FPRB AT END                                                 
                MOVE 'Y' TO WS-FPRB-EOF                                         
                GO TO 2200-EXIT.                                                
                                                                                
           ADD 1 TO WS-FPRB-READ.                                               
                                                                                
       2200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       2300-READ-BP13FPOS.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13FPOS AT END                                                 
                MOVE 'Y' TO WS-FPOS-EOF                                         
                GO TO 2300-EXIT.                                                
                                                                                
           ADD 1 TO WS-FPOS-READ.                                               
                                                                                
       2300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       2400-READ-BP13F73D.                                                      
      *-------------------------------------------------------------            
                                                                                
           READ BP13F73D AT END                                                 
                MOVE 'Y' TO WS-F73D-EOF                                         
                GO TO 2400-EXIT.                                                
                                                                                
           ADD 1 TO WS-F73D-READ.                                               
                                                                                
       2400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3000-WRITE-EMAIL1.                                                       
      *-------------------------------------------------------------            
                                                                                
           COMPUTE WS-SNO          =    WS-SNO  + 1.                            
           MOVE ZEROES             TO   MAIL3-SNO.                              
           MOVE WS-SNO             TO   MAIL3-SNO.                              
           MOVE F73B-NUM-REGN      TO   MAIL3-REGN-NO.                          
           MOVE F73B-NUM-NRIC      TO   MAIL3-NRIC.                             
           MOVE F73B-NUM-HDB-REF   TO   MAIL3-HDB-REF.                          
           MOVE F73B-PPO-ADDRESS   TO   MAIL3-ADDRESS.                          
           MOVE F73B-OIC-EMAIL     TO   MAIL3-OIC.                              
           ADD 1                   TO   WS-RPB2-WRITE                           
           WRITE MAILRPB2-REC      FROM MAIL-BODY03.                            
                                                                                
           COMPUTE WS-SNO2         =    WS-SNO2 + 1.                            
           MOVE ZEROES             TO   MAIL3-SNO.                              
           MOVE WS-SNO2            TO   MAIL3-SNO.                              
           ADD 1                   TO   WS-RPB1-WRITE                           
           WRITE MAILRPB1-REC      FROM MAIL-BODY03.                            
           PERFORM 2000-READ-BP13F73B                                           
                                   THRU 2000-EXIT.                              
                                                                                
           IF F73B-OIC-EMAIL NOT      =    WS-SAVE-OIC                          
              MOVE F73B-OIC-EMAIL     TO   WS-SAVE-OIC                          
              WRITE MAILRPB2-REC      FROM MAIL-SPACES                          
              WRITE MAILRPB2-REC      FROM MAIL-END                             
              IF WS-F73B-EOF NOT = 'Y'                                          
                 PERFORM 4100-PRINT-MAIL-HDR-OIC                                
                                      THRU 4100-EXIT                            
                 MOVE ZEROES          TO   WS-SNO                               
              END-IF                                                            
           ELSE                                                                 
              IF WS-F73B-EOF     = 'Y'                                          
                 WRITE MAILRPB1-REC   FROM MAIL-SPACES                          
                 WRITE MAILRPB1-REC   FROM MAIL-END                             
                 WRITE MAILRPB2-REC   FROM MAIL-SPACES                          
                 WRITE MAILRPB2-REC   FROM MAIL-END                             
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3100-WRITE-EMAIL2.                                                       
      *-------------------------------------------------------------            
                                                                                
           COMPUTE WS-SNO          =    WS-SNO  + 1.                            
           MOVE ZEROES             TO   MAIL3-SNO.                              
           MOVE WS-SNO             TO   MAIL3-SNO.                              
           MOVE F73C-NUM-REGN      TO   MAIL3-REGN-NO.                          
           MOVE F73C-NUM-NRIC      TO   MAIL3-NRIC.                             
           MOVE F73C-NUM-HDB-REF   TO   MAIL3-HDB-REF.                          
           MOVE F73C-PPO-ADDRESS   TO   MAIL3-ADDRESS.                          
           MOVE F73C-OIC-EMAIL     TO   MAIL3-OIC.                              
           ADD 1                   TO   WS-RPC2-WRITE                           
           WRITE MAILRPC2-REC      FROM MAIL-BODY03.                            
                                                                                
           COMPUTE WS-SNO2         =    WS-SNO2 + 1.                            
           MOVE ZEROES             TO   MAIL3-SNO.                              
           MOVE WS-SNO2            TO   MAIL3-SNO.                              
           ADD 1                   TO   WS-RPC1-WRITE                           
           WRITE MAILRPC1-REC      FROM MAIL-BODY03.                            
           PERFORM 2100-READ-BP13F73C                                           
                                   THRU 2100-EXIT.                              
                                                                                
           IF F73C-OIC-EMAIL NOT      =    WS-SAVE-OIC                          
              MOVE F73C-OIC-EMAIL     TO   WS-SAVE-OIC                          
              WRITE MAILRPC2-REC      FROM MAIL-SPACES                          
              WRITE MAILRPC2-REC      FROM MAIL-END                             
              IF WS-F73C-EOF NOT = 'Y'                                          
                 PERFORM 4100-PRINT-MAIL-HDR-OIC                                
                                      THRU 4100-EXIT                            
                 MOVE ZEROES          TO   WS-SNO                               
              END-IF                                                            
           ELSE                                                                 
              IF WS-F73C-EOF     = 'Y'                                          
                 WRITE MAILRPC1-REC   FROM MAIL-SPACES                          
                 WRITE MAILRPC1-REC   FROM MAIL-END                             
                 WRITE MAILRPC2-REC   FROM MAIL-SPACES                          
                 WRITE MAILRPC2-REC   FROM MAIL-END                             
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3200-WRITE-EMAIL3.                                                       
      *-------------------------------------------------------------            
                                                                                
           COMPUTE WS-SNO            =    WS-SNO  + 1.                          
           MOVE ZEROES               TO   MAIL-SNO.                             
           MOVE WS-SNO               TO   MAIL-SNO.                             
           MOVE FPRB-NUM-REGN        TO   MAIL-REGN-NO.                         
           MOVE FPRB-NUM-NRIC        TO   MAIL-NRIC.                            
           MOVE FPRB-NUM-HDB-REF     TO   MAIL-HDB-REF.                         
           MOVE FPRB-PPO-ADDRESS     TO   MAIL-ADDRESS.                         
           MOVE FPRB-OIC-EMAIL-PREB  TO   MAIL-CSM1.                            
           MOVE FPRB-OIC-EMAIL-POSB  TO   MAIL-CSM2.                            
           MOVE FPRB-DTE-DISPOSE-DUE TO   MAIL-DTE-DISPOSE.                     
           ADD 1                     TO   WS-RPA2-WRITE                         
           WRITE MAILRPA2-REC        FROM MAIL-BODY05.                          
                                                                                
           COMPUTE WS-SNO2           =    WS-SNO2 + 1.                          
           MOVE ZEROES               TO   MAIL-SNO.                             
           MOVE WS-SNO2              TO   MAIL-SNO.                             
           ADD 1                     TO   WS-RPA1-WRITE                         
           WRITE MAILRPA1-REC        FROM MAIL-BODY05.                          
           PERFORM 2200-READ-BP13FPRB                                           
                                   THRU 2200-EXIT.                              
                                                                                
           IF FPRB-OIC-EMAIL-PREB NOT  =    WS-SAVE-OIC                         
              MOVE FPRB-OIC-EMAIL-PREB TO   WS-SAVE-OIC                         
              WRITE MAILRPA2-REC       FROM MAIL-SPACES                         
              WRITE MAILRPA2-REC       FROM MAIL-END                            
              IF WS-FPRB-EOF NOT  = 'Y'                                         
                 PERFORM 4100-PRINT-MAIL-HDR-OIC                                
                                       THRU 4100-EXIT                           
                 MOVE ZEROES           TO   WS-SNO                              
              END-IF                                                            
           ELSE                                                                 
              IF WS-FPRB-EOF     = 'Y'                                          
                 WRITE MAILRPA1-REC   FROM MAIL-SPACES                          
                 WRITE MAILRPA1-REC   FROM MAIL-END                             
                 WRITE MAILRPA2-REC   FROM MAIL-SPACES                          
                 WRITE MAILRPA2-REC   FROM MAIL-END                             
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3300-WRITE-EMAIL4.                                                       
      *-------------------------------------------------------------            
                                                                                
           COMPUTE WS-SNO            =    WS-SNO  + 1.                          
           MOVE ZEROES               TO   MAIL-SNO.                             
           MOVE WS-SNO               TO   MAIL-SNO.                             
           MOVE FPOS-NUM-REGN        TO   MAIL-REGN-NO.                         
           MOVE FPOS-NUM-NRIC        TO   MAIL-NRIC.                            
           MOVE FPOS-NUM-HDB-REF     TO   MAIL-HDB-REF.                         
           MOVE FPOS-PPO-ADDRESS     TO   MAIL-ADDRESS.                         
           MOVE FPOS-OIC-EMAIL-PREB  TO   MAIL-CSM1.                            
           MOVE FPOS-OIC-EMAIL-POSB  TO   MAIL-CSM2.                            
           MOVE FPOS-DTE-DISPOSE-DUE TO   MAIL-DTE-DISPOSE.                     
           ADD 1                     TO   WS-RPA2-WRITE                         
           WRITE MAILRPA2-REC        FROM MAIL-BODY05.                          
                                                                                
           PERFORM 2300-READ-BP13FPOS                                           
                                   THRU 2300-EXIT.                              
                                                                                
           IF FPOS-OIC-EMAIL-POSB NOT  =    WS-SAVE-OIC                         
              MOVE FPOS-OIC-EMAIL-POSB TO   WS-SAVE-OIC                         
              WRITE MAILRPA2-REC       FROM MAIL-SPACES                         
              WRITE MAILRPA2-REC       FROM MAIL-END                            
              IF WS-FPOS-EOF NOT  = 'Y'                                         
                 PERFORM 4100-PRINT-MAIL-HDR-OIC                                
                                       THRU 4100-EXIT                           
                 MOVE ZEROES           TO   WS-SNO                              
              END-IF                                                            
           ELSE                                                                 
              IF WS-FPOS-EOF     = 'Y'                                          
                 WRITE MAILRPA2-REC   FROM MAIL-SPACES                          
                 WRITE MAILRPA2-REC   FROM MAIL-END                             
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       3400-WRITE-EMAIL5.                                                       
      *-------------------------------------------------------------            
                                                                                
           COMPUTE WS-SNO          =    WS-SNO  + 1.                            
           MOVE ZEROES             TO   MAIL7-SNO.                              
           MOVE WS-SNO             TO   MAIL7-SNO.                              
           MOVE F73D-NUM-REGN      TO   MAIL7-REGN-NO.                          
           MOVE F73D-NUM-NRIC      TO   MAIL7-NRIC.                             
           MOVE F73D-NAME          TO   MAIL7-NAME.                             
           MOVE F73D-DTE-TP        TO   MAIL7-DTE-TP.                           
           MOVE F73D-OIC           TO   MAIL7-CRM.                              
           ADD 1                   TO   WS-RPD2-WRITE                           
           WRITE MAILRPD2-REC      FROM MAIL-BODY07.                            
                                                                                
           COMPUTE WS-SNO2         =    WS-SNO2 + 1.                            
           MOVE ZEROES             TO   MAIL7-SNO.                              
           MOVE WS-SNO2            TO   MAIL7-SNO.                              
           ADD 1                   TO   WS-RPD1-WRITE                           
           WRITE MAILRPD1-REC      FROM MAIL-BODY07.                            
           PERFORM 2400-READ-BP13F73D                                           
                                   THRU 2400-EXIT.                              
                                                                                
           IF F73D-OIC-EMAIL NOT      =    WS-SAVE-OIC                          
              MOVE F73D-OIC-EMAIL     TO   WS-SAVE-OIC                          
              WRITE MAILRPD2-REC      FROM MAIL-SPACES                          
              WRITE MAILRPD2-REC      FROM MAIL-END                             
              IF WS-F73D-EOF NOT = 'Y'                                          
                 PERFORM 4100-PRINT-MAIL-HDR-OIC                                
                                      THRU 4100-EXIT                            
                 MOVE ZEROES          TO   WS-SNO                               
              END-IF                                                            
           ELSE                                                                 
              IF WS-F73D-EOF     = 'Y'                                          
                 WRITE MAILRPD1-REC   FROM MAIL-SPACES                          
                 WRITE MAILRPD1-REC   FROM MAIL-END                             
                 WRITE MAILRPD2-REC   FROM MAIL-SPACES                          
                 WRITE MAILRPD2-REC   FROM MAIL-END                             
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       4000-PRINT-MAIL-HDR-SUMMARY.                                             
      *-------------------------------------------------------------            
                                                                                
           MOVE SPACES             TO   MAILRPA1-REC                            
                                        MAILRPB1-REC                            
                                        MAILRPC1-REC                            
                                        MAILRPD1-REC.                           
           MOVE  WS-EDT-DATE       TO   MAIL-DTL6-DATE                          
                                        MAIL-DTL7-DATE.                         
                                                                                
           WRITE MAILRPA1-REC      FROM MAIL-HDR1.                              
           WRITE MAILRPA1-REC      FROM MAIL-HDR2.                              
           WRITE MAILRPA1-REC      FROM MAIL-DTL1A.                             
           WRITE MAILRPA1-REC      FROM MAIL-DTL2.                              
           WRITE MAILRPA1-REC      FROM MAIL-DTL3.                              
           WRITE MAILRPA1-REC      FROM MAIL-DTL4A.                             
           MOVE  SPACES            TO   MAIL-SUBJECT.                           
           MOVE  'Outstanding PPO Disposal'                                     
                                   TO   MAIL-SUBJECT.                           
           WRITE MAILRPA1-REC      FROM MAIL-DTL5.                              
           WRITE MAILRPA1-REC      FROM MAIL-DTL6.                              
           MOVE  SPACES            TO   MAILRPA1-REC.                           
           MOVE  'Please confirm the disposal of PPO and update the disp        
      -          'osal date.'      TO   MAILRPA1-REC.                           
           WRITE MAILRPA1-REC.                                                  
           WRITE MAILRPA1-REC      FROM MAIL-SPACES.                            
           MOVE  SPACES            TO   MAIL-DTL7-LST.                          
           MOVE  'BP13L996A'       TO   MAIL-DTL7-LST.                          
           WRITE MAILRPA1-REC      FROM MAIL-DTL7.                              
           MOVE  SPACES            TO   MAIL-DTL8-TITLE.                        
           MOVE  'OUTSTANDING PPO DISPOSAL'                                     
                                   TO   MAIL-DTL8-TITLE(26:24).                 
           WRITE MAILRPA1-REC      FROM MAIL-DTL8.                              
           WRITE MAILRPA1-REC      FROM MAIL-SPACES.                            
           WRITE MAILRPA1-REC      FROM MAIL-BODY04.                            
                                                                                
           WRITE MAILRPB1-REC      FROM MAIL-HDR1.                              
           WRITE MAILRPB1-REC      FROM MAIL-HDR2.                              
           WRITE MAILRPB1-REC      FROM MAIL-DTL1A.                             
           WRITE MAILRPB1-REC      FROM MAIL-DTL2.                              
           WRITE MAILRPB1-REC      FROM MAIL-DTL3.                              
           WRITE MAILRPB1-REC      FROM MAIL-DTL4A.                             
           MOVE  SPACES            TO   MAIL-SUBJECT.                           
           MOVE  'Outstanding PPO Exemption (Before SOCA)'                      
                                   TO   MAIL-SUBJECT.                           
           WRITE MAILRPB1-REC      FROM MAIL-DTL5.                              
           WRITE MAILRPB1-REC      FROM MAIL-DTL6.                              
           MOVE  SPACES            TO   MAILRPB1-REC.                           
           MOVE  'Please seek PPO exemption for these cases before signi        
      -          'ng the Agreement for Lease.'                                  
                                   TO   MAILRPB1-REC.                           
           WRITE MAILRPB1-REC.                                                  
           WRITE MAILRPB1-REC      FROM MAIL-SPACES.                            
           MOVE  SPACES            TO   MAIL-DTL7-LST.                          
           MOVE  'BP13L996B'       TO   MAIL-DTL7-LST.                          
           WRITE MAILRPB1-REC      FROM MAIL-DTL7.                              
           MOVE  SPACES            TO   MAIL-DTL8-TITLE.                        
           MOVE  'OUTSTANDING PPO EXEMPTION (BEFORE SOCA)'                      
                                   TO   MAIL-DTL8-TITLE(18:39).                 
           WRITE MAILRPB1-REC      FROM MAIL-DTL8.                              
           WRITE MAILRPB1-REC      FROM MAIL-SPACES.                            
           WRITE MAILRPB1-REC      FROM MAIL-BODY02.                            
                                                                                
           WRITE MAILRPC1-REC      FROM MAIL-HDR1.                              
           WRITE MAILRPC1-REC      FROM MAIL-HDR2.                              
           WRITE MAILRPC1-REC      FROM MAIL-DTL1A.                             
           WRITE MAILRPC1-REC      FROM MAIL-DTL2.                              
           WRITE MAILRPC1-REC      FROM MAIL-DTL3.                              
           WRITE MAILRPC1-REC      FROM MAIL-DTL4A.                             
           MOVE  SPACES            TO   MAIL-SUBJECT.                           
           MOVE  'Outstanding PPO Exemption (Before TP)'                        
                                   TO   MAIL-SUBJECT.                           
           WRITE MAILRPC1-REC      FROM MAIL-DTL5.                              
           WRITE MAILRPC1-REC      FROM MAIL-DTL6.                              
           MOVE  SPACES            TO   MAILRPC1-REC.                           
           MOVE  'Please seek PPO exemption for these cases before key c        
      -          'ollection.'      TO   MAILRPC1-REC.                           
           WRITE MAILRPC1-REC.                                                  
           WRITE MAILRPC1-REC      FROM MAIL-SPACES.                            
           MOVE  SPACES            TO   MAIL-DTL7-LST.                          
           MOVE  'BP13L996C'       TO   MAIL-DTL7-LST.                          
           WRITE MAILRPC1-REC      FROM MAIL-DTL7.                              
           MOVE  SPACES            TO   MAIL-DTL8-TITLE.                        
           MOVE  'OUTSTANDING PPO EXEMPTION (BEFORE TP)'                        
                                   TO   MAIL-DTL8-TITLE(19:37).                 
           WRITE MAILRPC1-REC      FROM MAIL-DTL8.                              
           WRITE MAILRPC1-REC      FROM MAIL-SPACES.                            
           WRITE MAILRPC1-REC      FROM MAIL-BODY02.                            
                                                                                
           WRITE MAILRPD1-REC      FROM MAIL-HDR1.                              
           WRITE MAILRPD1-REC      FROM MAIL-HDR2.                              
           WRITE MAILRPD1-REC      FROM MAIL-DTL1A.                             
           WRITE MAILRPD1-REC      FROM MAIL-DTL2.                              
           WRITE MAILRPD1-REC      FROM MAIL-DTL3.                              
           WRITE MAILRPD1-REC      FROM MAIL-DTL4A.                             
           MOVE  SPACES            TO   MAIL-SUBJECT.                           
           MOVE  'Outstanding PPO Exemption (After TP)'                         
                                   TO   MAIL-SUBJECT.                           
           WRITE MAILRPD1-REC      FROM MAIL-DTL5.                              
           WRITE MAILRPD1-REC      FROM MAIL-DTL6.                              
           MOVE  SPACES            TO   MAILRPD1-REC.                           
           MOVE  'Application collected keys but PPO Exemption details n        
      -          'ot updated in PPO portal. Please follow-up to update P        
      -          'PO portal.'       TO   MAILRPD1-REC.                          
           WRITE MAILRPD1-REC.                                                  
           WRITE MAILRPD1-REC      FROM MAIL-SPACES.                            
           MOVE  SPACES            TO   MAIL-DTL7-LST.                          
           MOVE  'BP13L996D'       TO   MAIL-DTL7-LST.                          
           WRITE MAILRPD1-REC      FROM MAIL-DTL7.                              
           MOVE  SPACES            TO   MAIL-DTL8-TITLE.                        
           MOVE  'OUTSTANDING PPO EXEMPTION (AFTER TP)'                         
                                   TO   MAIL-DTL8-TITLE(19:37).                 
           WRITE MAILRPD1-REC      FROM MAIL-DTL8.                              
           WRITE MAILRPD1-REC      FROM MAIL-SPACES.                            
           WRITE MAILRPD1-REC      FROM MAIL-BODY06.                            
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       4100-PRINT-MAIL-HDR-OIC.                                                 
      *-------------------------------------------------------------            
                                                                                
           IF WS-LISTING-TAG = 'B'                                              
              MOVE SPACES             TO   MAILRPB2-REC                         
              WRITE MAILRPB2-REC      FROM MAIL-HDR1                            
              WRITE MAILRPB2-REC      FROM MAIL-HDR2                            
              MOVE SPACES             TO   MAILRPB2-REC                         
              STRING RCTP-TO          DELIMITED BY SIZE                         
                     F73B-OIC-EMAIL   DELIMITED BY SPACE                        
                     '>'              DELIMITED BY SIZE                         
               INTO MAILRPB2-REC                                                
              WRITE MAILRPB2-REC                                                
              WRITE MAILRPB2-REC      FROM MAIL-DTL2                            
              WRITE MAILRPB2-REC      FROM MAIL-DTL3                            
              MOVE SPACES             TO   MAILRPB2-REC                         
              STRING TO-MAIL          DELIMITED BY SIZE                         
                     F73B-OIC-EMAIL   DELIMITED BY SPACE                        
                     '>'              DELIMITED BY SIZE                         
               INTO MAILRPB2-REC                                                
              WRITE MAILRPB2-REC                                                
              MOVE  SPACES            TO   MAIL-SUBJECT                         
              MOVE  'Outstanding PPO Exemption (Before SOCA)'                   
                                      TO   MAIL-SUBJECT                         
              WRITE MAILRPB2-REC      FROM MAIL-DTL5                            
              WRITE MAILRPB2-REC      FROM MAIL-DTL6                            
              MOVE  SPACES            TO   MAILRPB2-REC                         
              MOVE  'Please seek PPO exemption for these cases before si        
      -             'gning the Agreement for Lease.'                            
                                      TO   MAILRPB2-REC                         
              WRITE MAILRPB2-REC                                                
              WRITE MAILRPB2-REC      FROM MAIL-SPACES                          
              MOVE  SPACES            TO   MAIL-DTL7-LST                        
              MOVE  'BP13L996B'       TO   MAIL-DTL7-LST                        
              WRITE MAILRPB2-REC      FROM MAIL-DTL7                            
              MOVE  SPACES            TO   MAIL-DTL8-TITLE                      
              MOVE  'OUTSTANDING PPO EXEMPTION (BEFORE SOCA)'                   
                                      TO   MAIL-DTL8-TITLE(18:39)               
              WRITE MAILRPB2-REC      FROM MAIL-DTL8                            
              WRITE MAILRPB2-REC      FROM MAIL-SPACES                          
              WRITE MAILRPB2-REC      FROM MAIL-BODY02                          
           END-IF.                                                              
                                                                                
           IF WS-LISTING-TAG = 'C'                                              
              MOVE SPACES             TO   MAILRPC2-REC                         
              WRITE MAILRPC2-REC      FROM MAIL-HDR1                            
              WRITE MAILRPC2-REC      FROM MAIL-HDR2                            
              MOVE SPACES             TO   MAILRPC2-REC                         
              STRING RCTP-TO          DELIMITED BY SIZE                         
                     F73C-OIC-EMAIL   DELIMITED BY SPACE                        
                     '>'              DELIMITED BY SIZE                         
               INTO MAILRPC2-REC                                                
              WRITE MAILRPC2-REC                                                
              WRITE MAILRPC2-REC      FROM MAIL-DTL2                            
              WRITE MAILRPC2-REC      FROM MAIL-DTL3                            
              MOVE SPACES             TO   MAILRPC2-REC                         
              STRING TO-MAIL          DELIMITED BY SIZE                         
                     F73C-OIC-EMAIL   DELIMITED BY SPACE                        
                     '>'              DELIMITED BY SIZE                         
               INTO MAILRPC2-REC                                                
              WRITE MAILRPC2-REC                                                
              MOVE  SPACES            TO   MAIL-SUBJECT                         
              MOVE  'Outstanding PPO Exemption (Before TP)'                     
                                      TO   MAIL-SUBJECT                         
              WRITE MAILRPC2-REC      FROM MAIL-DTL5                            
              WRITE MAILRPC2-REC      FROM MAIL-DTL6                            
              MOVE  SPACES            TO   MAILRPC2-REC                         
              MOVE  'Please seek PPO exemption for these cases before ke        
      -             'y collection.'   TO   MAILRPC2-REC                         
              WRITE MAILRPC2-REC                                                
              WRITE MAILRPC2-REC      FROM MAIL-SPACES                          
              MOVE  SPACES            TO   MAIL-DTL7-LST                        
              MOVE  'BP13L996C'       TO   MAIL-DTL7-LST                        
              WRITE MAILRPC2-REC      FROM MAIL-DTL7                            
              MOVE  SPACES            TO   MAIL-DTL8-TITLE                      
              MOVE  'OUTSTANDING PPO EXEMPTION (BEFORE TP)'                     
                                      TO   MAIL-DTL8-TITLE(19:37)               
              WRITE MAILRPC2-REC      FROM MAIL-DTL8                            
              WRITE MAILRPC2-REC      FROM MAIL-SPACES                          
              WRITE MAILRPC2-REC      FROM MAIL-BODY02                          
           END-IF.                                                              
                                                                                
           IF WS-LISTING-TAG = 'A'                                              
              MOVE SPACES                TO   MAILRPA2-REC                      
              WRITE MAILRPA2-REC         FROM MAIL-HDR1                         
              WRITE MAILRPA2-REC         FROM MAIL-HDR2                         
              MOVE SPACES                TO   MAILRPA2-REC                      
              STRING RCTP-TO             DELIMITED BY SIZE                      
                     FPRB-OIC-EMAIL-PREB DELIMITED BY SPACE                     
                     '>'                 DELIMITED BY SIZE                      
               INTO MAILRPA2-REC                                                
              WRITE MAILRPA2-REC                                                
              WRITE MAILRPA2-REC         FROM MAIL-DTL2                         
              WRITE MAILRPA2-REC         FROM MAIL-DTL3                         
              MOVE SPACES                TO   MAILRPC2-REC                      
              STRING TO-MAIL             DELIMITED BY SIZE                      
                     FPRB-OIC-EMAIL-PREB DELIMITED BY SPACE                     
                     '>'                 DELIMITED BY SIZE                      
               INTO MAILRPA2-REC                                                
              WRITE MAILRPA2-REC                                                
              MOVE  SPACES               TO   MAIL-SUBJECT                      
              MOVE  'Outstanding PPO Disposal'                                  
                                         TO   MAIL-SUBJECT                      
              WRITE MAILRPA2-REC         FROM MAIL-DTL5                         
              WRITE MAILRPA2-REC         FROM MAIL-DTL6                         
              MOVE  SPACES               TO   MAILRPA2-REC                      
              MOVE  'Please confirm the disposal of PPO and update the d        
      -             'isposal date.'      TO   MAILRPA2-REC                      
              WRITE MAILRPA2-REC                                                
              WRITE MAILRPA2-REC         FROM MAIL-SPACES                       
              MOVE  SPACES               TO   MAIL-DTL7-LST                     
              MOVE  'BP13L996A'          TO   MAIL-DTL7-LST                     
              WRITE MAILRPA2-REC         FROM MAIL-DTL7                         
              MOVE  SPACES               TO   MAIL-DTL8-TITLE                   
              MOVE  'OUTSTANDING PPO DISPOSAL'                                  
                                         TO   MAIL-DTL8-TITLE(26:24)            
              WRITE MAILRPA2-REC         FROM MAIL-DTL8                         
              WRITE MAILRPA2-REC         FROM MAIL-SPACES                       
              WRITE MAILRPA2-REC         FROM MAIL-BODY04                       
           END-IF.                                                              
                                                                                
           IF WS-LISTING-TAG = 'D'                                              
              MOVE SPACES                TO   MAILRPA2-REC                      
              WRITE MAILRPA2-REC         FROM MAIL-HDR1                         
              WRITE MAILRPA2-REC         FROM MAIL-HDR2                         
              MOVE SPACES                TO   MAILRPA2-REC                      
              STRING RCTP-TO             DELIMITED BY SIZE                      
                     FPOS-OIC-EMAIL-POSB DELIMITED BY SPACE                     
                     '>'                 DELIMITED BY SIZE                      
               INTO MAILRPA2-REC                                                
              WRITE MAILRPA2-REC                                                
              WRITE MAILRPA2-REC         FROM MAIL-DTL2                         
              WRITE MAILRPA2-REC         FROM MAIL-DTL3                         
              MOVE SPACES                TO   MAILRPC2-REC                      
              STRING TO-MAIL             DELIMITED BY SIZE                      
                     FPOS-OIC-EMAIL-POSB DELIMITED BY SPACE                     
                     '>'                 DELIMITED BY SIZE                      
               INTO MAILRPA2-REC                                                
              WRITE MAILRPA2-REC                                                
              MOVE  SPACES               TO   MAIL-SUBJECT                      
              MOVE  'Outstanding PPO Disposal'                                  
                                         TO   MAIL-SUBJECT                      
              WRITE MAILRPA2-REC         FROM MAIL-DTL5                         
              WRITE MAILRPA2-REC         FROM MAIL-DTL6                         
              MOVE  SPACES               TO   MAILRPA2-REC                      
              MOVE  'Please confirm the disposal of PPO and update the d        
      -             'isposal date.'      TO   MAILRPA2-REC                      
              WRITE MAILRPA2-REC                                                
              WRITE MAILRPA2-REC         FROM MAIL-SPACES                       
              MOVE  SPACES               TO   MAIL-DTL7-LST                     
              MOVE  'BP13L996A'          TO   MAIL-DTL7-LST                     
              WRITE MAILRPA2-REC         FROM MAIL-DTL7                         
              MOVE  SPACES               TO   MAIL-DTL8-TITLE                   
              MOVE  'OUTSTANDING PPO DISPOSAL'                                  
                                         TO   MAIL-DTL8-TITLE(26:24)            
              WRITE MAILRPA2-REC         FROM MAIL-DTL8                         
              WRITE MAILRPA2-REC         FROM MAIL-SPACES                       
              WRITE MAILRPA2-REC         FROM MAIL-BODY04                       
           END-IF.                                                              
                                                                                
           IF WS-LISTING-TAG = 'E'                                              
              MOVE SPACES             TO   MAILRPD2-REC                         
              WRITE MAILRPD2-REC      FROM MAIL-HDR1                            
              WRITE MAILRPD2-REC      FROM MAIL-HDR2                            
              MOVE SPACES             TO   MAILRPD2-REC                         
              STRING RCTP-TO          DELIMITED BY SIZE                         
                     F73D-OIC-EMAIL   DELIMITED BY SPACE                        
                     '>'              DELIMITED BY SIZE                         
               INTO MAILRPD2-REC                                                
              WRITE MAILRPD2-REC                                                
              WRITE MAILRPD2-REC      FROM MAIL-DTL2                            
              WRITE MAILRPD2-REC      FROM MAIL-DTL3                            
              MOVE SPACES             TO   MAILRPD2-REC                         
              STRING TO-MAIL          DELIMITED BY SIZE                         
                     F73D-OIC-EMAIL   DELIMITED BY SPACE                        
                     '>'              DELIMITED BY SIZE                         
               INTO MAILRPD2-REC                                                
              WRITE MAILRPD2-REC                                                
              MOVE  SPACES            TO   MAIL-SUBJECT                         
              MOVE  'Outstanding PPO Exemption (After TP)'                      
                                      TO   MAIL-SUBJECT                         
              WRITE MAILRPD2-REC      FROM MAIL-DTL5                            
              WRITE MAILRPD2-REC      FROM MAIL-DTL6                            
              MOVE  SPACES            TO   MAILRPD2-REC                         
              MOVE                                                              
                 'Application collected keys but PPO Exemption details n        
      -          'ot updated in PPO portal. Please follow-up to update P        
      -          'PO portal.'          TO   MAILRPD2-REC                        
              WRITE MAILRPD2-REC                                                
              WRITE MAILRPD2-REC      FROM MAIL-SPACES                          
              MOVE  SPACES            TO   MAIL-DTL7-LST                        
              MOVE  'BP13L996D'       TO   MAIL-DTL7-LST                        
              WRITE MAILRPD2-REC      FROM MAIL-DTL7                            
              MOVE  SPACES            TO   MAIL-DTL8-TITLE                      
              MOVE  'OUTSTANDING PPO EXEMPTION (AFTER TP)'                      
                                      TO   MAIL-DTL8-TITLE(19:37)               
              WRITE MAILRPD2-REC      FROM MAIL-DTL8                            
              WRITE MAILRPD2-REC      FROM MAIL-SPACES                          
              WRITE MAILRPD2-REC      FROM MAIL-BODY06                          
           END-IF.                                                              
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       9000-CLOSE-ROUTINE.                                                      
      *-------------------------------------------------------------            
                                                                                
                                                                                
           DISPLAY '---- BP13C996 CONTROL TOTAL -----'.                         
           DISPLAY ' NO OF REC READ FROM BP13FPRB     = '                       
                     WS-FPRB-READ.                                              
           DISPLAY ' NO OF REC READ FROM BP13FPOS     = '                       
                     WS-FPOS-READ.                                              
           DISPLAY ' NO OF REC READ FROM BP13F73B     = '                       
                     WS-F73B-READ.                                              
           DISPLAY ' NO OF REC READ FROM BP13F73C     = '                       
                     WS-F73C-READ.                                              
           DISPLAY ' NO OF REC READ FROM BP13F73D     = '                       
                     WS-F73D-READ.                                              
           DISPLAY ' NO OF REC WRITTEN TO MAILFILE A1 = '                       
                     WS-RPA1-WRITE.                                             
           DISPLAY ' NO OF REC WRITTEN TO MAILFILE A2 = '                       
                     WS-RPA2-WRITE.                                             
           DISPLAY ' NO OF REC WRITTEN TO MAILFILE B1 = '                       
                     WS-RPB1-WRITE.                                             
           DISPLAY ' NO OF REC WRITTEN TO MAILFILE B2 = '                       
                     WS-RPB2-WRITE.                                             
           DISPLAY ' NO OF REC WRITTEN TO MAILFILE C1 = '                       
                     WS-RPC1-WRITE.                                             
           DISPLAY ' NO OF REC WRITTEN TO MAILFILE C2 = '                       
                     WS-RPC2-WRITE.                                             
           DISPLAY ' NO OF REC WRITTEN TO MAILFILE D1 = '                       
                     WS-RPD1-WRITE.                                             
           DISPLAY ' NO OF REC WRITTEN TO MAILFILE D2 = '                       
                     WS-RPD2-WRITE.                                             
           DISPLAY SPACES.                                                      
                                                                                
           CLOSE       BP13FPRB                                                 
                       BP13FPOS                                                 
                       BP13F73B                                                 
                       BP13F73C                                                 
                       BP13F73D                                                 
                       MAILRPA1                                                 
                       MAILRPA2                                                 
                       MAILRPB1                                                 
                       MAILRPB2                                                 
                       MAILRPC1                                                 
                       MAILRPC2                                                 
                       MAILRPD1                                                 
                       MAILRPD2.                                                
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
