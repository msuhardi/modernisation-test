       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C493.                                                 
      *AUTHOR.        ZARITA DANE SARMIENTO.                                    
      *DATE-WRITTEN.  SEP 16 2016.                                              
      * ============================================================            
      * SYSTEM OF COMMITMENT (SOC)                                              
      * ============================================================            
      * OBJECTIVE  - PRINT LETTERS ON NOTIFICATION OF                           
      *              OPTION C AND D.                                            
      *                                                                         
      * FORM USED  BP13XX  AND BP13XX                                           
      *                                                                         
      * INPUT FILES:  BM06F110                                                  
      *               BP13K022                                                  
      *               BP13K024                                                  
      *               BP13K800                                                  
      *               BP13K820                                                  
      *               BP13K830                                                  
      *               BM06K100                                                  
      *               BM06K510                                                  
      *        I-O    BP13F205                                                  
      * REPORT:       BP13P493 - LISTING FOR OPT C                              
      *               P13P493B - LISTING FOR OPT D                              
      *               BP13L493 - HARDCOPY LISTING                               
      *               P13L493A - HARDCOPY LISTING                               
      * ------------------------------------------------------------            
      * NOTE : TO RUN ACJOB                                                     
      *                     > NORMAL COMPILE IN TSO1                            
      *                     > JCL > BIND                                        
      *                           > RUN JOB                                     
      *                           > FREE PLAN                                   
      * ------------------------------------------------------------            
      * REF NO    DATE  BY  DESCRIPTIONS                                        
      * -------- ------ --- ------------                                        
      * BP136431 160916 ZDD1 NEW PGM(MODELLED AFTER BP13C491)                   
      * BP137024 120318 KR13 CORRECTED OIC LINE NO FOR OPT D LETTER             
      * BP137452 080219 ZS13 ADDED NEW FORM FOR SMS                             
      * BP137452 130219 ZS13 ADDED BP13K491                                     
      * BP137452 140219 ZS13 CORRECT PASSING OF TAG                             
      * BP137452 150219 ZS13 PASS L FOR NON FS AND NO SMS REC                   
      * BP137452 210219 ZS13 CHANGE CONDITION FOR PRINTING                      
      * BP137687 040319 ZS13 INITIALIZE WS-SMS AND ADD LISTING REPORT           
      * BP138797 260721 Zar7 CARTER FOR NEW FORM TS/CD AND FOR TAG Z            
      *                      REMOVE FS CONDITION                                
      * BP138797 260721 Zar7 CARTER TAG Z FOR CASES WITH EMAIL                  
      * BP138797 020821 Zar7 CARTER for BP13K55 REWRITE                         
      * BP139005 171221 Zar7 CAtER FOR POSTAL CODES, MAILING AND FLAT           
      * BP139005 271221 Zar7 CAtER FOR NUM-MONTHS                               
      * ============================================================            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13K022  ASSIGN       TO BP13K022                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K022-KEY-FLD                        
                            ALTERNATE RECORD KEY IS K022-NUM-REGN               
                            WITH DUPLICATES                                     
                            FILE STATUS  IS K022-STATUS.                        
                                                                                
           SELECT BP13K024  ASSIGN       TO BP13K024                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K024-KEY-FLD                        
                            FILE STATUS  IS K024-STATUS.                        
                                                                                
           SELECT BP13K800 ASSIGN        TO BP13K800                            
                           ORGANIZATION  IS INDEXED                             
                           ACCESS MODE   IS RANDOM                              
                           RECORD KEY    IS K800-NUM-REGN                       
                           FILE STATUS   IS K800-STATUS.                        
                                                                                
           SELECT BP13K820 ASSIGN        TO BP13K820                            
                           ORGANIZATION  IS INDEXED                             
                           ACCESS MODE   IS RANDOM                              
                           RECORD KEY    IS K820-KEY-FLD                        
                           FILE STATUS   IS K820-STATUS.                        
                                                                                
           SELECT BP13K830 ASSIGN        TO BP13K830                            
                           ORGANIZATION  IS INDEXED                             
                           ACCESS MODE   IS RANDOM                              
                           RECORD KEY    IS K830-KEY-FLD                        
                           ALTERNATE KEY IS K830-NUM-REGN                       
                           FILE STATUS   IS K830-STATUS.                        
                                                                                
           SELECT BP13K857 ASSIGN        TO BP13K857                            
                           ORGANIZATION  IS INDEXED                             
                           ACCESS MODE   IS RANDOM                              
                           RECORD KEY    IS K857-KEY-FLD                        
                           FILE STATUS   IS K857-STATUS.                        
                                                                                
           SELECT BM06K510 ASSIGN        TO BM06K510                            
                           ORGANIZATION  IS INDEXED                             
                           ACCESS MODE   IS RANDOM                              
                           RECORD KEY    IS K510-ESTCDE                         
                           FILE STATUS   IS K510-STATUS.                        
                                                                                
           SELECT BM06K100 ASSIGN        TO BM06K100                            
                           ORGANIZATION  IS INDEXED                             
                           ACCESS MODE   IS RANDOM                              
                           RECORD KEY    IS K100-KEY-FLD                        
                           FILE STATUS   IS K100-STATUS.                        
                                                                                
           SELECT BP13KH55 ASSIGN        TO BP13KH55                            
                           ORGANIZATION  IS INDEXED                             
                           ACCESS MODE   IS RANDOM                              
                           RECORD KEY    IS KH55-KEY-FLD                        
                           FILE STATUS   IS KH55-STATUS.                        
                                                                                
           SELECT AB03K080 ASSIGN        TO AB03K080                            
                           ORGANIZATION  IS INDEXED                             
                           ACCESS MODE   IS DYNAMIC                             
                           RECORD KEY    IS K080-KEY                            
                           FILE STATUS   IS K080-STATUS.                        
                                                                                
           SELECT AB03K030 ASSIGN        TO AB03K030                            
                           ORGANIZATION  IS INDEXED                             
                           ACCESS MODE   IS RANDOM                              
                           RECORD KEY    IS K030-NUM-HDB-REF                    
                           FILE STATUS   IS K030-STATUS.                        
                                                                                
           SELECT BP13K491 ASSIGN       TO BP13K491                             
                           ORGANIZATION  IS INDEXED                             
                           ACCESS MODE   IS RANDOM                              
                           RECORD KEY    IS K491-KEY-FLD                        
                           FILE STATUS   IS K491-STATUS.                        
                                                                                
           SELECT BP13F205 ASSIGN       TO BP13F205.                            
                                                                                
           SELECT BM06F110 ASSIGN       TO BM06F110.                            
           SELECT BP13P493 ASSIGN       TO BP13P493.                            
           SELECT P13P493B ASSIGN       TO P13P493B.                            
           SELECT BP13L493 ASSIGN       TO BP13L493.                            
           SELECT P13L493A ASSIGN       TO P13L493A.                            
           SELECT P13P493C ASSIGN       TO P13P493C.                            
           SELECT P13P493D ASSIGN       TO P13P493D.                            
           SELECT P13P493G ASSIGN       TO P13P493G.                            
           SELECT P13P493H ASSIGN       TO P13P493H.                            
           SELECT P13P493I ASSIGN       TO P13P493I.                            
           SELECT P13P493J ASSIGN       TO P13P493J.                            
           SELECT P13P493K ASSIGN       TO P13P493K.                            
           SELECT P13P493L ASSIGN       TO P13P493L.                            
           SELECT P13P493M ASSIGN       TO P13P493M.                            
           SELECT P13P493N ASSIGN       TO P13P493K.                            
           SELECT P13P493O ASSIGN       TO P13P493L.                            
           SELECT P13P493P ASSIGN       TO P13P493M.                            
           SELECT BP13493L ASSIGN       TO BP13493L.                            
           SELECT P13BC493 ASSIGN       TO P13BC493.                            
           SELECT P13HC493 ASSIGN       TO P13HC493.                            
           SELECT BP13FTP  ASSIGN       TO BP13FTP.                             
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *-------------------------------------------------------------            
       FD   BP13K022                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K022.                                                           
                                                                                
       FD   BP13K024                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K024.                                                           
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13KH55                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13KH55.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD   BP13K830                                                            
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD   BP13K857                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13K857.                                                           
                                                                                
       FD   BM06K510                                                            
            RECORD CONTAINS 60 CHARACTERS.                                      
       COPY BM06K510.                                                           
                                                                                
       FD   BM06K100                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K100.                                                           
                                                                                
       FD   AB03K080                                                            
            RECORD CONTAINS 50  CHARACTERS.                                     
       COPY AB03K080.                                                           
                                                                                
       FD   AB03K030                                                            
            RECORD CONTAINS 800 CHARACTERS.                                     
       COPY AB03K030.                                                           
                                                                                
       FD   BP13K491                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13K491.                                                           
                                                                                
       FD   BP13F205                                                            
            RECORD CONTAINS 80 CHARACTERS                                       
            RECORDING MODE  IS F.                                               
       COPY BP13F205.                                                           
                                                                                
       FD   BM06F110                                                            
            RECORDING MODE IS F                                                 
            RECORD CONTAINS 500 CHARACTERS                                      
            BLOCK  CONTAINS 0   RECORDS.                                        
       COPY BM06F110.                                                           
                                                                                
       FD   BP13P493           RECORDING MODE IS F                              
                               RECORD CONTAINS 100 CHARACTERS                   
                               BLOCK  CONTAINS 0   RECORDS.                     
       01   P493-PRTREC        PIC X(100).                                      
                                                                                
       FD   P13P493B           RECORDING MODE IS F                              
                               RECORD CONTAINS 100 CHARACTERS                   
                               BLOCK  CONTAINS 0   RECORDS.                     
       01   P493B-PRTREC       PIC X(100).                                      
                                                                                
       FD   BP13L493           RECORDING MODE IS F                              
                               RECORD CONTAINS 132 CHARACTERS                   
                               BLOCK  CONTAINS 0   RECORDS.                     
       01   L493-PRTREC        PIC X(132).                                      
                                                                                
       FD   P13L493A           RECORDING MODE IS F                              
                               RECORD CONTAINS 132 CHARACTERS                   
                               BLOCK  CONTAINS 0   RECORDS.                     
       01   L493A-PRTREC       PIC X(132).                                      
                                                                                
       FD   P13P493C           RECORDING MODE IS F                              
                               RECORD CONTAINS 100 CHARACTERS                   
                               BLOCK  CONTAINS 0   RECORDS.                     
       01   P493C-PRTREC       PIC X(100).                                      
                                                                                
       FD   P13P493D           RECORDING MODE IS F                              
                               RECORD CONTAINS 100 CHARACTERS                   
                               BLOCK  CONTAINS 0   RECORDS.                     
       01   P493D-PRTREC       PIC X(100).                                      
                                                                                
       FD   P13P493G           RECORDING MODE IS F                              
                               RECORD CONTAINS 100 CHARACTERS                   
                               BLOCK  CONTAINS 0   RECORDS.                     
       01   P493G-PRTREC       PIC X(100).                                      
                                                                                
       FD   P13P493H           RECORDING MODE IS F                              
                               RECORD CONTAINS 100 CHARACTERS                   
                               BLOCK  CONTAINS 0   RECORDS.                     
       01   P493H-PRTREC       PIC X(100).                                      
                                                                                
       FD   P13P493I           RECORDING MODE IS F                              
                               RECORD CONTAINS 100 CHARACTERS                   
                               BLOCK  CONTAINS 0   RECORDS.                     
       01   P493I-PRTREC       PIC X(100).                                      
                                                                                
       FD   P13P493J           RECORDING MODE IS F                              
                               RECORD CONTAINS 100 CHARACTERS                   
                               BLOCK  CONTAINS 0   RECORDS.                     
       01   P493J-PRTREC       PIC X(100).                                      
                                                                                
       FD   P13P493K           RECORDING MODE IS F                              
                               RECORD CONTAINS 100 CHARACTERS                   
                               BLOCK  CONTAINS 0   RECORDS.                     
       01   P493K-PRTREC       PIC X(100).                                      
                                                                                
       FD   P13P493L           RECORDING MODE IS F                              
                               RECORD CONTAINS 100 CHARACTERS                   
                               BLOCK  CONTAINS 0   RECORDS.                     
       01   P493L-PRTREC       PIC X(100).                                      
                                                                                
       FD   P13P493M           RECORDING MODE IS F                              
                               RECORD CONTAINS 100 CHARACTERS                   
                               BLOCK  CONTAINS 0   RECORDS.                     
       01   P493M-PRTREC       PIC X(100).                                      
                                                                                
       FD   P13P493N           RECORDING MODE IS F                              
                               RECORD CONTAINS 100 CHARACTERS                   
                               BLOCK  CONTAINS 0   RECORDS.                     
       01   P493N-PRTREC       PIC X(100).                                      
                                                                                
       FD   P13P493O           RECORDING MODE IS F                              
                               RECORD CONTAINS 100 CHARACTERS                   
                               BLOCK  CONTAINS 0   RECORDS.                     
       01   P493O-PRTREC       PIC X(100).                                      
                                                                                
       FD   P13P493P           RECORDING MODE IS F                              
                               RECORD CONTAINS 100 CHARACTERS                   
                               BLOCK  CONTAINS 0   RECORDS.                     
       01   P493P-PRTREC       PIC X(100).                                      
                                                                                
       FD   BP13493L           RECORDING MODE IS F                              
                               RECORD CONTAINS 132 CHARACTERS                   
                               BLOCK  CONTAINS 0   RECORDS.                     
       01   493L-PRTREC        PIC X(132).                                      
                                                                                
       FD  P13BC493                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1500 CHARACTERS                                      
           RECORDING MODE IS F.                                                 
       01  P13BC493-REC                PIC X(1500).                             
                                                                                
       FD  P13HC493                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  P13HC493-REC                PIC X(72).                               
                                                                                
       FD  BP13FTP                                                              
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 72 CHARACTERS                                        
           RECORDING MODE IS F.                                                 
       01  BP13FTP-REC                 PIC X(72).                               
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
       COPY P13FH10A.                                                           
       COPY P13P493A.                                                           
                                                                                
       01  WS-IOMS-VARS.                                                        
           05  WS-BC493-SNO            PIC 9(7)        VALUE ZEROES.            
           05  WS-HC493-WRITE          PIC 9(7)        VALUE ZEROES.            
           05  WS-FB10-WRITE           PIC 9(7)        VALUE ZEROES.            
           05  WS-FH10-WRITE           PIC 9(7)        VALUE ZEROES.            
           05  WS-FTP-WRITE            PIC 9(7)        VALUE ZEROES.            
           05  WS-BP13CD-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-GROUP-ID             PIC X(8)        VALUE SPACES.            
           05  WS-PRINT-SETTING        PIC X(1)        VALUE SPACES.            
           05  WS-BP13C913             PIC X(8)        VALUE 'BP13C913'.        
                                                                                
       01  WS-IOMS-VARIABLES.                                                   
           05  WS-UPD-TMESTAMP.                                                 
               10  WS-UPD-DATE         PIC X(8)        VALUE SPACES.            
               10  WS-UPD-TME          PIC X(8)        VALUE SPACES.            
           05  WS-FTP-DEST-REC.                                                 
               10  WS-FTP-JOBNAME      PIC X(8)        VALUE SPACES.            
               10  FILLER              PIC X           VALUE '_'.               
               10  WS-FTP-DESC         PIC X(6)        VALUE SPACES.            
               10  FILLER              PIC X           VALUE '_'.               
               10  WS-FTP-TMESTAMP     PIC X(12)       VALUE SPACES.            
           05  WS-P13FT10A-WRITE       PIC 9(7)        VALUE ZEROES.            
           05  WS-PARM.                                                         
               10  WS-PARM-JOBNAME     PIC X(8)        VALUE SPACES.            
               10  WS-PARM-B10-SOURCE  PIC X(70)       VALUE SPACES.            
               10  WS-PARM-H10-SOURCE  PIC X(70)       VALUE SPACES.            
                                                                                
       01  WS-BP13FTP-REC.                                                      
           05  WS-FTP-LINE1.                                                    
               10  FILLER              PIC X(2)        VALUE SPACES.            
               10  FILLER              PIC X(12)       VALUE                    
                   'CD /DATAFILE'.                                              
               10  FILLER              PIC X(58)       VALUE SPACES.            
           05  WS-FTP-LINE2.                                                    
               10  FILLER              PIC X(2)        VALUE SPACES.            
               10  FILLER              PIC X(12)       VALUE                    
                   'DIR         '.                                              
               10  FILLER              PIC X(58)       VALUE SPACES.            
           05  WS-FTP-LINE3.                                                    
               10  FILLER              PIC X(2)        VALUE SPACES.            
               10  FILLER              PIC X(12)       VALUE                    
                   'ASCII       '.                                              
               10  FILLER              PIC X(58)       VALUE SPACES.            
           05  WS-FTP-LINE4.                                                    
               10  FILLER              PIC X(2)        VALUE SPACES.            
               10  WS-FTP-SOURCE       PIC X(70)       VALUE SPACES.            
           05  WS-FTP-LINE5.                                                    
               10  FILLER              PIC X(2)        VALUE SPACES.            
               10  FILLER              PIC X(12)       VALUE                    
                   'DIR         '.                                              
               10  FILLER              PIC X(66)       VALUE SPACES.            
           05  WS-FTP-LINE6.                                                    
               10  FILLER              PIC X(2)        VALUE SPACES.            
               10  FILLER              PIC X(12)       VALUE                    
                   'QUIT        '.                                              
               10  FILLER              PIC X(66)       VALUE SPACES.            
                                                                                
                                                                                
       01  KH55-STATUS                   PIC 99    VALUE 0.                     
       01  K022-STATUS                   PIC 99    VALUE 0.                     
       01  K024-STATUS                   PIC 99    VALUE 0.                     
       01  K800-STATUS                   PIC 99    VALUE 0.                     
       01  K820-STATUS                   PIC 99    VALUE 0.                     
       01  K830-STATUS                   PIC 99    VALUE 0.                     
       01  K510-STATUS                   PIC 99    VALUE 0.                     
       01  K100-STATUS                   PIC 99    VALUE 0.                     
       01  K857-STATUS                   PIC 99    VALUE 0.                     
       01  K080-STATUS                   PIC 99    VALUE 0.                     
       01  K030-STATUS                   PIC 99    VALUE 0.                     
       01  K491-STATUS                   PIC 99    VALUE 0.                     
       01  WS-F110-EOF                   PIC X     VALUE 'N'.                   
       01  WS-FOUND-K857                 PIC X     VALUE 'N'.                   
       01  WS-FOUND-K491                 PIC X     VALUE 'N'.                   
       01  WS-FOUND-KH55                 PIC X     VALUE 'N'.                   
       01  WS-F205-READ                  PIC X     VALUE 'N'.                   
       01  WS-SMS                        PIC X     VALUE 'N'.                   
       01  WS-FLAG                       PIC X     VALUE 'N'.                   
       01  WS-NRIC                       PIC X(9)  VALUE SPACES.                
       01  WS-TEMP-POSTAL         PIC X(20)  VALUE SPACES.                      
                                                                                
       01  WS-OCCUPANTS.                                                        
           05  WS-NAME      OCCURS 4 TIMES   PIC X(66).                         
                                                                                
       01  WS-DATE                       PIC X(8)  VALUE SPACES.                
       01  WS-SYS-DTE-TME.                                                      
           05 WS-SYS-DATE          PIC 9(8)        VALUE ZEROES.                
           05 WS-SYS-TIME          PIC 9(8)        VALUE ZEROES.                
       01  WS-MONTH                      PIC X(3)  VALUE SPACES.                
       01  WS-QUARTER                    PIC X(11) VALUE SPACES.                
       01  WS-YEAR                       PIC 9(4).                              
       01  WS-NAME-EMAIL                 PIC X(66).                             
                                                                                
       01  WS-PREV-BLK-NO                PIC X(5).                              
       01  WS-OCCP-PTR                   PIC 9(2).                              
       01  WS-SQL-CODE                   PIC 9(4).                              
                                                                                
       01  WS-STOP                       PIC X(1)  VALUE SPACES.                
       01  WS-PROCESS                    PIC X(1)  VALUE SPACES.                
       01  WS-TEMP-PCD                   PIC X(18) VALUE SPACES.                
       01  WS-HP                         PIC X(08) VALUE SPACES.                
                                                                                
       01  WS-COUNTERS.                                                         
           05 WS-CNT-F110-READ           PIC 9(7)  VALUE 0.                     
           05 WS-CNT-LETTER              PIC 9(7)  VALUE 0.                     
           05 WS-CNT-K800-MISS           PIC 9(7)  VALUE 0.                     
           05 WS-CNT-K820-MISS           PIC 9(7)  VALUE 0.                     
           05 WS-CNT-K830-MISS           PIC 9(7)  VALUE 0.                     
           05 WS-CNT-K510-MISS           PIC 9(7)  VALUE 0.                     
           05 WS-CNT-K100-MISS           PIC 9(7)  VALUE 0.                     
           05 WS-CNT-K857-W-EMAIL        PIC 9(7)  VALUE 0.                     
           05 WS-F491-WRT                PIC 9(7)  VALUE 0.                     
           05 WS-FOR-SMS                 PIC 9(7)  VALUE 0.                     
           05 WS-IDX                     PIC 9(2)  VALUE 0.                     
           05 WS-CNT                     PIC 9(2)  VALUE 0.                     
           05 CTR                        PIC 9(2)  VALUE 0.                     
           05 WS-BLK-CNT                 PIC 9(7)  VALUE 0.                     
           05 WS-TOTAL-CNT               PIC 9(7)  VALUE 0.                     
           05 WS-TOTAL-CNT-A             PIC 9(7)  VALUE 0.                     
           05 WS-TOTAL-CNT-B             PIC 9(7)  VALUE 0.                     
           05 WS-LINE-CNT                PIC 9(7)  VALUE 0.                     
           05 WS-LINE-CNT-B              PIC 9(7)  VALUE 0.                     
           05 WS-PAGE-CNT                PIC 9(7)  VALUE 0.                     
           05 WS-LINE-CNT-A              PIC 9(7)  VALUE 0.                     
           05 WS-PAGE-CNT-A              PIC 9(7)  VALUE 0.                     
           05 WS-PAGE-CNT-B              PIC 9(7)  VALUE 0.                     
           05 WS-F493-WRT                PIC 9(7)  VALUE 0.                     
           05 WS-KH55-WRT                PIC 9(7)  VALUE 0.                     
           05 WS-KH55-RWRT               PIC 9(7)  VALUE 0.                     
           05 WS-BP13FK-CTR              PIC 9(6)  VALUE ZEROS.                 
           05 WS-BP1328-CTR              PIC 9(6)  VALUE ZEROS.                 
           05 WS-BP1329-CTR              PIC 9(6)  VALUE ZEROS.                 
           05 WS-BP1381-CTR              PIC 9(6)  VALUE ZEROS.                 
           05 WS-BP1382-CTR              PIC 9(6)  VALUE ZEROS.                 
           05 WS-BP1383-CTR              PIC 9(6)  VALUE ZEROS.                 
           05 WS-BP13TH-CTR              PIC 9(6)  VALUE ZEROS.                 
           05 WS-RECORD-CNT              PIC ZZZ9.                              
                                                                                
           05 WS-ERROR-FL                PIC X(1) VALUE 'N'.                    
              88 WS-NO-ERROR             VALUE 'N'.                             
              88 WS-ERROR                VALUE 'Y'.                             
                                                                                
       01  WS-MONTHS-IN-DIGITS-AND-WORDS.                                       
           05 FILLER                   PIC X(06) VALUE                          
             '01 JAN'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '02 FEB'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '03 MAR'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '04 APR'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '05 MAY'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '06 JUN'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '07 JUL'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '08 AUG'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '09 SEP'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '10 OCT'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '11 NOV'.                                                          
           05 FILLER                   PIC X(06) VALUE                          
             '12 DEC'.                                                          
       01  FILLER  REDEFINES  WS-MONTHS-IN-DIGITS-AND-WORDS.                    
           05 WS-MONTH-TABLE               OCCURS 12                            
                                           INDEXED BY WS-MTH-IND.               
              10 WS-MONTH-IN-DIGITS    PIC X(02).                               
              10 FILLER                PIC X(01).                               
              10 WS-MONTH-IN-WORDS     PIC X(03).                               
                                                                                
      *=======================================================*                 
      *    LINKAGE VARIABLES                                  *                 
      *=======================================================*                 
       01   WS-LINK-REC.                                                        
            05 WS-LINK-NUM-SCH            PIC X(4).                             
            05 WS-LINK-NUM-ACC            PIC X(4).                             
            05 WS-LINK-NUM-CHK            PIC X(1).                             
                                                                                
       COPY P13COMM8.                                                           
                                                                                
      *-------------------------------------------------------------            
      *    LETTER LAYOUT                                                        
      *-------------------------------------------------------------            
       01  P493-LINE01.                                                         
           05 FILLER                     PIC X(66) VALUE SPACES.                
           05 P493-REGN-NO               PIC X(8)  VALUE SPACES.                
                                                                                
       01  P493-LINE01-A.                                                       
           05 FILLER                     PIC X(74) VALUE SPACES.                
           05 P493-REGN-NO-A             PIC X(8)  VALUE SPACES.                
                                                                                
       01  P493-LINE02-A.                                                       
           05 FILLER                     PIC X(74) VALUE SPACES.                
           05 P493-DATE-A                PIC X(10) VALUE SPACES.                
                                                                                
       01  P493-LINE02.                                                         
           05 FILLER                     PIC X(66) VALUE SPACES.                
           05 P493-DATE                  PIC X(10) VALUE SPACES.                
                                                                                
       01  P493-LINE03.                                                         
           05 FILLER                     PIC X(66) VALUE SPACES.                
           05 P493-OIC-TEL               PIC X(8)  VALUE SPACES.                
                                                                                
       01  P493-LINE03-A.                                                       
           05 FILLER                     PIC X(74) VALUE SPACES.                
           05 P493-OIC-TEL-A             PIC X(8)  VALUE SPACES.                
                                                                                
       01  P493-LINE04.                                                         
           05 FILLER                     PIC X(11)  VALUE SPACES.               
           05 P493-NAME1                 PIC X(66)  VALUE SPACES.               
                                                                                
       01  P493-LINE04B.                                                        
           05 FILLER                     PIC X(11)  VALUE SPACES.               
           05 P493-NAME2                 PIC X(66)  VALUE SPACES.               
                                                                                
       01  P493-LINE04C.                                                        
           05 FILLER                     PIC X(11)  VALUE SPACES.               
           05 P493-NAME3                 PIC X(66)  VALUE SPACES.               
                                                                                
       01  P493-LINE04D.                                                        
           05 FILLER                     PIC X(11)  VALUE SPACES.               
           05 P493-NAME4                 PIC X(66)  VALUE SPACES.               
                                                                                
       01  P493-LINE05.                                                         
           05 FILLER                     PIC X(11)  VALUE SPACES.               
           05 P493-BLK                   PIC X(10)  VALUE SPACES.               
           05 FILLER                     PIC X(2)   VALUE SPACES.               
           05 P493-FLAT-NO.                                                     
              15  P493-CHAR              PIC X      VALUE SPACE.                
              15  P493-LEVEL             PIC X(2)   VALUE SPACES.               
              15  P493-DASH              PIC X      VALUE SPACE.                
              15  P493-HSE-MAIN          PIC X(4)   VALUE SPACES.               
              15  P493-HSE-SUB           PIC X(3)   VALUE SPACES.               
                                                                                
       01  P493-LINE05B.                                                        
           05 FILLER                     PIC X(11) VALUE SPACES.                
           05 P493-STREET                PIC X(32) VALUE SPACES.                
                                                                                
       01  P493-LINE05C.                                                        
           05 FILLER                     PIC X(11) VALUE SPACES.                
           05 FILLER                     PIC X(10) VALUE 'SINGAPORE'.           
           05 P493-POSTAL                PIC X(6)  VALUE SPACES.                
                                                                                
       01  PECD-LINE06.                                                         
           05  FILLER                    PIC X(10) VALUE SPACES.                
           05  PECD-BAR-CODE             PIC X(09) VALUE SPACES.                
                                                                                
       01  PECD-LINE07.                                                         
           05 FILLER                     PIC X(11) VALUE SPACES.                
           05 FILLER                     PIC X(4)  VALUE 'BLK'.                 
           05 P493-UNIT-BLK              PIC X(5)  VALUE SPACES.                
           05 FILLER                     PIC X(3)  VALUE SPACES.                
           05 P493-UNIT-FLAT-NO.                                                
              10 FILLER                  PIC X     VALUE '#'.                   
              10 P493-UNIT-LVL-NO        PIC X(2)  VALUE SPACES.                
              10 FILLER                  PIC X     VALUE '-'.                   
              10 P493-UNIT-UNIT-NO       PIC X(5)  VALUE SPACES.                
           05 FILLER                     PIC X(3)  VALUE SPACES.                
           05 P493-UNIT-STREET-POSTAL    PIC X(50) VALUE SPACES.                
                                                                                
       01  PECD-LINE07A.                                                        
           05 FILLER                     PIC X(11) VALUE SPACES.                
           05 P493-SUBJECT               PIC X(50)                              
                   VALUE 'PROBABLE COMPLETION DATE FOR'.                        
                                                                                
       01  PECD-LINE08A.                                                        
           05 FILLER                     PIC X(84) VALUE SPACES.                
           05 P493-DTE-COMPLT-MM         PIC X(03) VALUE SPACES.                
           05 FILLER                     PIC X(13) VALUE SPACES.                
                                                                                
       01  PECD-LINE09A.                                                        
           05 FILLER                     PIC X(10) VALUE SPACES.                
           05 P493-DTE-COMPLT-YR         PIC X(05) VALUE SPACES.                
           05 FILLER                     PIC X(85) VALUE SPACES.                
                                                                                
       01  PECD-LINE08.                                                         
           05 FILLER                     PIC X(51) VALUE SPACES.                
           05 P493-NEWTOWN               PIC X(20)  VALUE SPACES.               
                                                                                
       01  PECD-LINE09.                                                         
           05 FILLER                     PIC X(56) VALUE SPACES.                
           05 FILLER                     PIC X(4)  VALUE 'BLK'.                 
           05 P493-UNIT-BLK2             PIC X(5)  VALUE SPACES.                
           05 FILLER                     PIC X(1)  VALUE SPACES.                
           05 P493-NEWTOWN2              PIC X(20) VALUE SPACES.                
                                                                                
       01  PECD-LINE10.                                                         
           05 FILLER                     PIC X(52) VALUE SPACES.                
           05 P493-NEW-PCD               PIC X(18) VALUE SPACES.                
                                                                                
       01  PECD-LINE10A.                                                        
           05 FILLER                     PIC X(47) VALUE SPACES.                
           05 P493-NEW-PCDA              PIC X(18) VALUE SPACES.                
                                                                                
       01  PECD-LINE10Q.                                                        
           05 FILLER                     PIC X(13) VALUE SPACES.                
           05 P493-NEW-PCDQ              PIC X(18) VALUE SPACES.                
                                                                                
       01  PECD-NOTE-LINE10A.                                                   
           05 FILLER                     PIC X(57) VALUE SPACES.                
           05 P493-NOTEA-PCD             PIC X(18) VALUE SPACES.                
                                                                                
       01  PECD-NOTE-LINE10B.                                                   
           05 FILLER                     PIC X(49) VALUE SPACES.                
           05 P493-NOTEB-PCD             PIC X(18) VALUE SPACES.                
                                                                                
       01  PECD-NOTE-LINE10C.                                                   
      *    05 FILLER                     PIC X(23) VALUE SPACES.                
           05 FILLER                     PIC X(57) VALUE SPACES.                
           05 P493-NOTEC-PCD             PIC X(18) VALUE SPACES.                
                                                                                
       01  PECD-NOTE-LINE10D.                                                   
      *    05 FILLER                     PIC X(23) VALUE SPACES.                
           05 FILLER                     PIC X(52) VALUE SPACES.                
           05 P493-NOTED-PCD             PIC X(18) VALUE SPACES.                
                                                                                
       01  PECD-FT-OIC.                                                         
           05 FILLER                     PIC X(10) VALUE SPACES.                
           05 P493-NME-OIC               PIC X(30) VALUE SPACES.                
                                                                                
      *-------------------------------------------------------------            
      *    NEW FLAT ADDRESS                                                     
      *-------------------------------------------------------------            
       01  PCD-FLAT-ADDR.                                                       
           05 FILLER                     PIC X(11) VALUE SPACES.                
           05 FILLER                     PIC X(4)  VALUE 'BLK'.                 
           05 PCD-UNIT-BLK              PIC X(5)  VALUE SPACES.                 
           05 FILLER                     PIC X(3)  VALUE SPACES.                
           05 PCD-UNIT-FLAT-NO.                                                 
              10 FILLER                  PIC X     VALUE '#'.                   
              10 PCD-UNIT-LVL-NO        PIC X(2)  VALUE SPACES.                 
              10 FILLER                  PIC X     VALUE '-'.                   
              10 PCD-UNIT-UNIT-NO       PIC X(5)  VALUE SPACES.                 
           05 FILLER                     PIC X(3)  VALUE SPACES.                
           05 PCD-UNIT-STREET-POSTAL    PIC X(50) VALUE SPACES.                 
           05 PCD-POSTAL                PIC X(6) VALUE SPACES.                  
                                                                                
      *-------------------------------------------------------------            
      *    REPORT LAYOUT                                                        
      *-------------------------------------------------------------            
       01  L493-HDR01.                                                          
           05 FILLER                     PIC X(14) VALUE 'BP13L493'.            
           05 FILLER                     PIC X(30) VALUE 'HDB3'.                
           05 FILLER                     PIC X(42) VALUE                        
             'S Y S T E M   O F   C O M M I T M E N T'.                         
           05 FILLER                     PIC X(13) VALUE SPACES.                
           05 FILLER                     PIC X(7)  VALUE 'DATE: '.              
           05 L493-DATE                  PIC X(10) VALUE SPACES.                
           05 FILLER                     PIC X(10) VALUE '   PAGE: '.           
           05 L493-PAGE                  PIC ZZZZ9.                             
                                                                                
       01  L493-HDR02.                                                          
           05 FILLER                     PIC X(40) VALUE SPACES.                
           05 FILLER                     PIC X(80) VALUE                        
             'LETTERS PRINTED FOR NOTIFICATION OF NEW PCD DATE'.                
                                                                                
       01  L493-HDR03.                                                          
           05 FILLER                     PIC X(10) VALUE '  BLOCK: '.           
           05 L493-BLOCK                 PIC X(5)  VALUE SPACES.                
           05 FILLER                     PIC X(4)  VALUE SPACES.                
           05 L493-STREET-NAME           PIC X(32) VALUE SPACES.                
                                                                                
       01  L493-HDR04.                                                          
           05 FILLER                     PIC X(9)  VALUE '   NO.   '.           
           05 FILLER                     PIC X(14) VALUE 'SCH-ACC NO'.          
           05 FILLER                     PIC X(10) VALUE '  REGN NO.'.          
           05 FILLER                     PIC X(34)                              
                    VALUE '  NAME(TRUNCATED) '.                                 
           05 FILLER                     PIC X(10) VALUE '  NRIC NO.'.          
           05 FILLER                     PIC X(7)  VALUE '  BLK '.              
           05 FILLER                     PIC X(26)                              
                    VALUE '      MAIL STREET NAME'.                             
           05 FILLER                     PIC X(10) VALUE '  FLAT NO.'.          
           05 FILLER                     PIC X(8)  VALUE '  PC'.                
                                                                                
       01  L493-DETAIL.                                                         
           05 FILLER                     PIC X(2)  VALUE SPACES.                
           05 L493-NO                    PIC ZZZZ9.                             
           05 FILLER                     PIC X(2)  VALUE SPACES.                
           05 L493-SCH-ACC               PIC X(14) VALUE SPACES.                
           05 FILLER                     PIC X(2)  VALUE SPACES.                
           05 L493-REGN-NO               PIC X(8)  VALUE SPACES.                
           05 FILLER                     PIC X(2)  VALUE SPACES.                
           05 L493-NAME                  PIC X(32) VALUE SPACES.                
           05 FILLER                     PIC X(2)  VALUE SPACES.                
           05 L493-NRIC-NO               PIC X(9)  VALUE SPACES.                
           05 FILLER                     PIC X     VALUE SPACES.                
           05 L493-BLK-NO                PIC X(10) VALUE SPACES.                
           05 FILLER                     PIC X     VALUE SPACES.                
           05 L493-STREET                PIC X(20) VALUE SPACES.                
           05 FILLER                     PIC X(2)  VALUE SPACES.                
           05 L493-FLAT-NO.                                                     
              10 FILLER                  PIC X     VALUE '#'.                   
              10 L493-LVL-NO             PIC X(2)  VALUE SPACES.                
              10 FILLER                  PIC X     VALUE '-'.                   
              10 L493-UNIT-NO            PIC X(4)  VALUE SPACES.                
           05 FILLER                     PIC X(2)  VALUE SPACES.                
           05 L493-POSTAL-CODE           PIC X(6)  VALUE SPACES.                
                                                                                
       01  L493-PRT-TOTAL.                                                      
           05 FILLER                     PIC X(10) VALUE SPACES.                
           05 FILLER                     PIC X(30)                              
              VALUE 'TOTAL NUMBER OF LETTERS: '.                                
           05 L493-TOTAL                 PIC Z,ZZZ,ZZ9.                         
                                                                                
      *-------------------------------------------------------------            
      *    REPORT LAYOUT FOR OPTION C AND D                                     
      *-------------------------------------------------------------            
       01  L493A-HDR01.                                                         
           05 FILLER                     PIC X(14) VALUE 'P13L493A'.            
           05 FILLER                     PIC X(30) VALUE 'HDB3'.                
           05 FILLER                     PIC X(42) VALUE                        
             'S Y S T E M   O F   C O M M I T M E N T'.                         
           05 FILLER                     PIC X(13) VALUE SPACES.                
           05 FILLER                     PIC X(7)  VALUE 'DATE: '.              
           05 L493A-DATE                 PIC X(10) VALUE SPACES.                
           05 FILLER                     PIC X(10) VALUE '   PAGE: '.           
           05 L493A-PAGE                 PIC ZZZZ9.                             
                                                                                
       01  L493A-HDR02.                                                         
           05 FILLER                     PIC X(40) VALUE SPACES.                
           05 FILLER                     PIC X(80) VALUE                        
             'CASES FOR NOTIFICATION OF NEW PCD DATE VIA SMS   '.               
                                                                                
                                                                                
       01  L493A-HDR04.                                                         
           05 FILLER                     PIC X(9)  VALUE '   NO.   '.           
           05 FILLER                     PIC X(14) VALUE 'SCH-ACC NO'.          
           05 FILLER                     PIC X(10) VALUE '  REGN NO.'.          
           05 FILLER                     PIC X(34)                              
                    VALUE '  NAME(TRUNCATED) '.                                 
           05 FILLER                     PIC X(10) VALUE '  NRIC NO.'.          
           05 FILLER                     PIC X(7)  VALUE '  BLK  '.             
           05 FILLER                     PIC X(10) VALUE '  UNIT #'.            
           05 FILLER                     PIC X(27) VALUE '  STREET'.            
           05 FILLER                     PIC X(08) VALUE '  POSTAL'.            
                                                                                
       01  L493A-DETAIL.                                                        
           05 FILLER                    PIC X(2)  VALUE SPACES.                 
           05 L493A-NO                  PIC ZZZZ9.                              
           05 FILLER                    PIC X(2)  VALUE SPACES.                 
           05 L493A-SCH-ACC              PIC X(14) VALUE SPACES.                
           05 FILLER                    PIC X(2)  VALUE SPACES.                 
           05 L493A-REGN-NO              PIC X(8)  VALUE SPACES.                
           05 FILLER                    PIC X(2)  VALUE SPACES.                 
           05 L493A-NAME                 PIC X(32) VALUE SPACES.                
           05 FILLER                    PIC X(2)  VALUE SPACES.                 
           05 L493A-NRIC-NO              PIC X(9)  VALUE SPACES.                
           05 FILLER                    PIC X     VALUE SPACES.                 
           05 L493A-BLOCK                PIC X(5)  VALUE SPACES.                
           05 FILLER                     PIC X(2)  VALUE SPACES.                
           05 L493A-FLAT-NO.                                                    
              10 FILLER                 PIC X     VALUE '#'.                    
              10 L493A-LVL-NO            PIC X(2)  VALUE SPACES.                
              10 FILLER                 PIC X     VALUE '-'.                    
              10 L493A-UNIT-NO           PIC X(4)  VALUE SPACES.                
           05 FILLER                    PIC X(2)  VALUE SPACES.                 
           05 L493A-STREET-NAME          PIC X(25) VALUE SPACES.                
           05 FILLER                    PIC X(2)  VALUE SPACES.                 
           05 L493A-POSTAL-CODE          PIC X(6)  VALUE SPACES.                
                                                                                
       01  L493A-PRT-TOTAL.                                                     
           05 FILLER                     PIC X(10) VALUE SPACES.                
           05 FILLER                     PIC X(30)                              
              VALUE 'TOTAL NUMBER OF LETTERS: '.                                
           05 L493A-TOTAL                 PIC Z,ZZZ,ZZ9.                        
                                                                                
      *-------------------------------------------------------------            
      *    REPORT FOR PRINTED LETTER AND FORM USED                              
      *-------------------------------------------------------------            
       01  493L-HDR01.                                                          
           05 FILLER                     PIC X(14) VALUE 'BP13493L'.            
           05 FILLER                     PIC X(30) VALUE 'HDB3'.                
           05 FILLER                     PIC X(42) VALUE                        
             'S Y S T E M   O F   C O M M I T M E N T'.                         
           05 FILLER                     PIC X(13) VALUE SPACES.                
           05 FILLER                     PIC X(7)  VALUE 'DATE: '.              
           05 493L-DATE                  PIC X(10) VALUE SPACES.                
           05 FILLER                     PIC X(10) VALUE '   PAGE: '.           
           05 493L-PAGE                  PIC ZZZZ9.                             
                                                                                
       01  493L-HDR02.                                                          
           05 FILLER                     PIC X(14) VALUE SPACES.                
           05 FILLER                     PIC X(30) VALUE SPACES.                
           05 FILLER                     PIC X(42) VALUE                        
             'LIST OF CASES EMAIL ADDRESS/HP/FORM USED'.                        
                                                                                
       01  493L-HDR03.                                                          
           05 FILLER                     PIC X(9)  VALUE '   NO.   '.           
           05 FILLER                     PIC X(10) VALUE '  REGN NO.'.          
           05 FILLER                     PIC X(50)                              
                    VALUE '  EMAIL ADDRESS  '.                                  
           05 FILLER                     PIC X(10) VALUE '    HP    '.          
           05 FILLER                     PIC X(10) VALUE '  TAG FORM'.          
           05 FILLER                     PIC X(17)                              
                    VALUE '  FORM(HARD COPY)'.                                  
                                                                                
       01  493L-DETAIL.                                                         
           05 493L-SNO                   PIC ZZZZ9.                             
           05 FILLER                     PIC X(06) VALUE SPACES.                
           05 493L-REGN-NO               PIC X(08) VALUE SPACES.                
           05 FILLER                     PIC X(02) VALUE SPACES.                
           05 493L-EMAIL                 PIC X(50) VALUE SPACES.                
           05 FILLER                     PIC X(02) VALUE SPACES.                
           05 493L-HP                    PIC X(08) VALUE SPACES.                
           05 FILLER                     PIC X(02) VALUE SPACES.                
           05 493L-TAG-FORM              PIC X(1)  VALUE SPACES.                
           05 FILLER                     PIC X(09) VALUE SPACES.                
           05 493L-FORM                  PIC X(6)  VALUE SPACES.                
                                                                                
      *-------------------------------------------------------------            
      *-------------------------------------------------------------            
      *  LINKAGE FOR AV02C015                                                   
      *-------------------------------------------------------------            
        01  WS-LINK-AV02C015.                                                   
            05  AV02C015-IN-POSTCODE          PIC X(6).                         
            05  AV02C015-OUT-POSTCODE-CHKSUM  PIC X(9).                         
       COPY AV02COMM.                                                           
                                                                                
      *------------------------------------------------------------*            
      *  DJDE LINE                                                 *            
      *------------------------------------------------------------*            
       01  DJDE-LINE-FK-PAGE1             PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT9,JDL=BP13,FORMS=BP13FK,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
       01  DJDE-LINE-28-PAGE1             PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT9,JDL=BP13,FORMS=BP1328,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=NO,END;'.                                                  
       01  DJDE-LINE-29-PAGE1             PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT9,JDL=BP13,FORMS=BP1329,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=NO,END;'.                                                  
       01  DJDE-LINE-81-PAGE1             PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT9,JDL=BP13,FORMS=BP1381,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=NO,END;'.                                                  
       01  DJDE-LINE-82-PAGE1             PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT9,JDL=BP13,FORMS=BP1382,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=NO,END;'.                                                  
       01  DJDE-LINE-83-PAGE1             PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT9,JDL=BP13,FORMS=BP1383,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=YES,END;'.                                                 
       01  DJDE-LINE-84-PAGE1             PIC X(80)  VALUE                      
           '$DJDE$ FORMS=BP1384,END;'.                                          
       01  DJDE-LINE-TH-PAGE1             PIC X(80)  VALUE                      
           '$DJDE$ JDE=13POT9,JDL=BP13,FORMS=BP13TH,NUMBER=(0000,29,65,3        
      -    '),DUPLEX=NO,END;'.                                                  
       01  DJDE-LINE-FE-PAGE3             PIC X(80)  VALUE                      
           '$DJDE$ FORMS=BP13FE,DUPLEX=NO,END;'.                                
       01  DJDE-LINE-FD-PAGE2             PIC X(80)  VALUE                      
           '$DJDE$ FORMS=BP13FD,END;'.                                          
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
      *-------------------------------------------------------------            
       0000-CONTROL.                                                            
      *-------------------------------------------------------------            
           ACCEPT WS-PARM-JOBNAME.                                              
           ACCEPT WS-PARM-B10-SOURCE.                                           
           ACCEPT WS-PARM-H10-SOURCE.                                           
                                                                                
           PERFORM 1000-START-UP         THRU 1000-EXIT.                        
           PERFORM 2000-MAIN-ROUTINE     THRU 2000-EXIT                         
                   UNTIL WS-F110-EOF = 'Y'.                                     
           PERFORM 8900-CREATE-FIOMS-REC THRU 8900-EXIT.                        
           PERFORM 9999-WRAP-UP.                                                
                                                                                
       0000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       1000-START-UP.                                                           
      *-------------------------------------------------------------            
            OPEN INPUT  BP13K022                                                
                        BP13K024                                                
                        BP13K800                                                
                        BP13K820                                                
                        BP13K830                                                
                        BM06K510                                                
                        BM06K100                                                
                        BM06F110                                                
                        BP13K857                                                
                        AB03K080                                                
                        AB03K030                                                
                OUTPUT  BP13P493                                                
                        P13P493B                                                
                        BP13L493                                                
                        P13L493A                                                
                        P13P493C                                                
                        P13P493D                                                
                        P13P493G                                                
                        P13P493H                                                
                        P13P493I                                                
                        P13P493J                                                
                        P13P493K                                                
                        P13P493L                                                
                        P13P493M                                                
                        P13P493N                                                
                        P13P493O                                                
                        P13P493P                                                
                        BP13493L                                                
                        P13BC493                                                
                        P13HC493                                                
                        BP13FTP                                                 
                   I-O  BP13F205                                                
                        BP13KH55                                                
                        BP13K491.                                               
                                                                                
            IF K491-STATUS NOT = 00 AND 97                                      
               DISPLAY 'OPEN FAILED FOR BP13K491,STATUS ' K491-STATUS           
               MOVE K491-STATUS TO RETURN-CODE                                  
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                         
            END-IF.                                                             
                                                                                
            IF KH55-STATUS NOT = 00 AND 97                                      
               DISPLAY 'OPEN FAILED FOR BP13KH55,STATUS ' KH55-STATUS           
               MOVE KH55-STATUS TO RETURN-CODE                                  
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                         
            END-IF.                                                             
                                                                                
            IF K022-STATUS NOT = 00 AND 97                                      
               DISPLAY 'OPEN FAILED FOR BP13K022,STATUS ' K022-STATUS           
               MOVE K022-STATUS TO RETURN-CODE                                  
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                         
            END-IF.                                                             
                                                                                
            IF K024-STATUS NOT = 00 AND 97                                      
               DISPLAY 'OPEN FAILED FOR BP13K024,STATUS ' K024-STATUS           
               MOVE K024-STATUS TO RETURN-CODE                                  
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                         
            END-IF.                                                             
                                                                                
            IF K800-STATUS NOT = 00 AND 97                                      
               DISPLAY 'OPEN FAILED FOR BP13K800,STATUS ' K800-STATUS           
               MOVE K800-STATUS TO RETURN-CODE                                  
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                         
            END-IF.                                                             
                                                                                
            IF K820-STATUS NOT = 00 AND 97                                      
               DISPLAY 'OPEN FAILED FOR BP13K820,STATUS ' K820-STATUS           
               MOVE K820-STATUS TO RETURN-CODE                                  
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                         
            END-IF.                                                             
                                                                                
            IF K830-STATUS NOT = 00 AND 97                                      
               DISPLAY 'OPEN FAILED FOR BP13K830,STATUS ' K830-STATUS           
               MOVE K830-STATUS TO RETURN-CODE                                  
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                         
            END-IF.                                                             
                                                                                
            IF K510-STATUS NOT = 00 AND 97                                      
               DISPLAY 'OPEN FAILED FOR BM06K510,STATUS ' K510-STATUS           
               MOVE K510-STATUS TO RETURN-CODE                                  
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                         
            END-IF.                                                             
                                                                                
            IF K100-STATUS NOT = 00 AND 97                                      
               DISPLAY 'OPEN FAILED FOR BM06K100,STATUS ' K100-STATUS           
               MOVE K100-STATUS TO RETURN-CODE                                  
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                         
            END-IF.                                                             
                                                                                
            IF K857-STATUS NOT = 00 AND 97                                      
               DISPLAY 'OPEN FAILED FOR BP13K857,STATUS ' K857-STATUS           
               MOVE K857-STATUS TO RETURN-CODE                                  
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                         
            END-IF.                                                             
                                                                                
            IF K030-STATUS NOT = 00 AND 97                                      
               DISPLAY 'OPEN FAILED FOR AB03K030,STATUS ' K030-STATUS           
               MOVE K030-STATUS TO RETURN-CODE                                  
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                         
            END-IF.                                                             
                                                                                
            IF K080-STATUS NOT = 00 AND 97                                      
               DISPLAY 'OPEN FAILED FOR AB03K080,STATUS ' K080-STATUS           
               MOVE K080-STATUS TO RETURN-CODE                                  
               PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                         
            END-IF.                                                             
                                                                                
            READ BM06F110                                                       
                 AT END  DISPLAY 'NO RECORDS FOUND!'                            
                         MOVE 'Y'          TO WS-F110-EOF                       
                         GO TO 1000-EXIT                                        
            END-READ.                                                           
                                                                                
            MOVE 60                  TO WS-LINE-CNT.                            
            MOVE 60                  TO WS-LINE-CNT-A.                          
            MOVE 60                  TO WS-LINE-CNT-B.                          
            ADD  1                   TO WS-CNT-F110-READ.                       
            MOVE F110-BLK-NO         TO WS-PREV-BLK-NO.                         
                                                                                
            MOVE FUNCTION CURRENT-DATE TO WS-DATE.                              
            MOVE FUNCTION CURRENT-DATE  TO WS-SYS-DTE-TME                       
                                          WS-UPD-TMESTAMP.                      
                                                                                
                                                                                
            STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)               
                   DELIMITED BY SIZE INTO P493-DATE.                            
            MOVE P493-DATE     TO P493-DATE-A.                                  
                                                                                
            STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)               
                   DELIMITED BY SIZE INTO L493-DATE.                            
                                                                                
            PERFORM 1500-READ-BP13F205    THRU 1500-EXIT.                       
                                                                                
       1000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *-------------------------------------------------------------            
       1500-READ-BP13F205.                                                      
      *------------------------------------------------------                   
            READ BP13F205                                                       
                 AT END  DISPLAY 'NO RECORDS FOUND IN BP13F205.'                
                 GO TO 1500-EXIT                                                
            END-READ.                                                           
                                                                                
            MOVE 'Y' TO WS-F205-READ.                                           
                                                                                
       1500-EXIT.                                                               
           EXIT.                                                                
                                                                                
       2000-MAIN-ROUTINE.                                                       
      *-------------------------------------------------------------            
           SET WS-NO-ERROR           TO TRUE.                                   
           INITIALIZE  WS-OCCUPANTS.                                            
           INITIALIZE  WS-NAME-EMAIL.                                           
                                                                                
      *-------------------------------------------------------------*           
      * READS BM06F110 AND PROCESS EACH RECORD UNTIL END OF FILE    *           
      *-------------------------------------------------------------*           
                                                                                
           MOVE SPACES   TO WS-HP                                               
                            WS-SMS                                              
                            WS-NRIC                                             
                            WS-TEMP-PCD                                         
                            BP13KH55-REC.                                       
           MOVE 'N'     TO WS-PROCESS.                                          
           PERFORM 4000-READ-K857       THRU 4000-EXIT                          
           PERFORM 3003-READ-K491   THRU 3003-EXIT                              
           PERFORM 2100-RETRIEVE-DATA   THRU 2100-EXIT.                         
           IF K800-NUM-ALLO-CAT = 'SER' OR                                      
              K800-NUM-PORT-ELIG-TAG = 'Y'                                      
              CONTINUE                                                          
           ELSE                                                                 
              PERFORM 2900-CHECK-SMS       THRU 2900-EXIT                       
           END-IF.                                                              
           PERFORM 3000-FORMAT-LETTER   THRU 3000-EXIT                          
           IF F205-FORM-OPTION = 'C' OR 'D'                                     
             IF WS-HP NOT = SPACES AND LOW-VALUES                               
               PERFORM 3300-PRINT-AUDIT-SMS THRU 3300-EXIT                      
               DISPLAY 'FOR SMS SENDING - ' F110-REGN-NO                        
             END-IF                                                             
             IF WS-FOUND-K857 = 'N'                                             
              IF ((K800-NUM-FLAT-TYPE = '2F') AND                               
                  (K800-NUM-LEASE-TENURE > 0  AND                               
                  K800-NUM-LEASE-TENURE <= 45)) AND                             
                  K800-NUM-PPO = 'Y'                                            
                   MOVE 'Z'                  TO KH55-TAG-FORM                   
                   PERFORM 310A-PRINT-IOMS   THRU 310A-EXIT                     
              ELSE                                                              
                 IF WS-SMS  = 'Y'                                               
                  EVALUATE  F205-FORM-OPTION                                    
                   WHEN 'C'                                                     
                       MOVE 'I'                  TO KH55-TAG-FORM               
      *                PERFORM 3105-PRINT-LETTER THRU 3105-EXIT                 
                       PERFORM 310A-PRINT-IOMS   THRU 310A-EXIT                 
                   WHEN 'D'                                                     
                       MOVE 'J'                  TO KH55-TAG-FORM               
      *                PERFORM 3106-PRINT-LETTER THRU 3106-EXIT                 
                       PERFORM 310A-PRINT-IOMS   THRU 310A-EXIT                 
                   WHEN OTHER                                                   
                       MOVE 'K'                  TO KH55-TAG-FORM               
                       PERFORM 3107-PRINT-LETTER THRU 3107-EXIT                 
                  END-EVALUATE                                                  
                 ELSE                                                           
                   MOVE 'L'                  TO KH55-TAG-FORM                   
                   PERFORM 310A-PRINT-IOMS   THRU 310A-EXIT                     
      *            PERFORM 3090-PRINT-LETTER   THRU 3090-EXIT                   
                 END-IF                                                         
               END-IF                                                           
              PERFORM 3200-PRINT-AUDIT     THRU 3200-EXIT                       
              DISPLAY 'FOR LTR SENDING - ' F110-REGN-NO                         
                      ' TAG-FORM       - ' KH55-TAG-FORM                        
             END-IF                                                             
             PERFORM 3004-READ-KH55    THRU 3004-EXIT                           
             IF WS-FOUND-KH55 = 'N'                                             
               PERFORM 3001-FORMAT-KH55       THRU 3001-EXIT                    
             ELSE                                                               
               PERFORM 3005-FORMAT-REWRT-KH55  THRU 3005-EXIT                   
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF WS-FOUND-K857 = 'Y'                                               
             IF WS-FOUND-K491 = 'N'                                             
                PERFORM 3001A-FORMAT-EMAIL   THRU 3001A-EXIT                    
             ELSE                                                               
                PERFORM 3002-FORMAT-EMAIL    THRU 3002-EXIT                     
             END-IF                                                             
             DISPLAY 'FOR EMAIL SENDING - ' F110-REGN-NO                        
           END-IF.                                                              
                                                                                
           PERFORM 8600-PRINT-LISTING     THRU 8600-EXIT.                       
                                                                                
           READ BM06F110 AT END                                                 
                MOVE 'Y' TO WS-F110-EOF                                         
                GO TO 2000-EXIT                                                 
                END-READ.                                                       
                                                                                
           ADD  1                          TO WS-CNT-F110-READ.                 
                                                                                
       2000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       2100-RETRIEVE-DATA.                                                      
      *-------------------------------------------------------------            
           MOVE F110-REGN-NO               TO K800-NUM-REGN.                    
           PERFORM 8100-READ-K800          THRU 8100-EXIT.                      
           IF WS-NO-ERROR                                                       
              PERFORM 2200-GET-NRIC-NAMES  THRU 2200-EXIT                       
              PERFORM 2300-GET-NRIC-ADDR   THRU 2300-EXIT                       
      ***testing                                                                
              PERFORM 2400-GET-BLK-ADDRESS THRU 2400-EXIT                       
      ***testing                                                                
              PERFORM 2500-GET-NEWTOWN     THRU 2500-EXIT                       
                                                                                
              IF F205-FORM-OPTION = 'C' OR 'D'                                  
                                                                                
                 PERFORM 2600-GET-PCD      THRU 2600-EXIT                       
                    MOVE SPACES        TO K491-DTE-PCD                          
                    MOVE WS-TEMP-PCD   TO P493-NEW-PCDA                         
                                          P493-NOTEA-PCD                        
                                          P493-NOTEB-PCD                        
                                          P493-NOTEC-PCD                        
                                          P493-NOTED-PCD                        
                                          K491-DTE-PCD                          
                                                                                
                 IF WS-CNT < 1                                                  
                    MOVE SPACES                 TO F205-PRINT-NOTE              
                                                                                
                    EVALUATE K100-NUM-PACD                                      
                        WHEN  'M'                                               
                              STRING WS-MONTH ' ' WS-YEAR                       
                                 DELIMITED BY SIZE INTO F205-PRINT-NOTE         
                              END-STRING                                        
                        WHEN  'Q'                                               
                              STRING WS-QUARTER(1:3) ' QTR ' WS-YEAR            
                                 DELIMITED BY SIZE INTO F205-PRINT-NOTE         
                              END-STRING                                        
                        WHEN OTHER                                              
                              DISPLAY 'K100 PACD IS UNKNOWN : '                 
                                                    K100-NUM-PACD               
                    END-EVALUATE                                                
                                                                                
                    ADD 1  TO WS-CNT                                            
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       2100-EXIT.                                                               
            EXIT.                                                               
                                                                                
       2150-RTRIM.                                                              
      *-------------------------------------------------------------            
           PERFORM VARYING CTR FROM 15 BY -1                                    
             UNTIL CTR = 1 OR WS-STOP = 'Y'                                     
                IF F205-PRINT-NOTE(CTR:1) = SPACE                               
                   CONTINUE                                                     
                ELSE                                                            
                   MOVE 'Y'    TO WS-STOP                                       
                   MOVE   F205-PRINT-NOTE(1:CTR) TO WS-TEMP-PCD                 
      *            STRING F205-PRINT-NOTE(1:CTR) '.'                            
      *                   DELIMITED BY SIZE INTO WS-TEMP-PCD                    
                END-IF                                                          
           END-PERFORM.                                                         
                                                                                
       2150-EXIT.                                                               
            EXIT.                                                               
                                                                                
       2200-GET-NRIC-NAMES.                                                     
      *-------------------------------------------------------------            
           MOVE  1                         TO   WS-OCCP-PTR.                    
           MOVE SPACES                     TO   WS-NAME-EMAIL.                  
                                                                                
           IF K800-NUM-NRIC1 NOT = SPACES AND LOW-VALUES                        
              MOVE SPACES                  TO   BP13K820-REC                    
              MOVE K800-NUM-REGN           TO   K820-NUM-REGN                   
              MOVE K800-NUM-NRIC1          TO   K820-NUM-NRIC                   
              PERFORM 8200-READ-K820       THRU 8200-EXIT                       
              MOVE K820-NME-OCCP           TO   WS-NAME(WS-OCCP-PTR)            
                                                WS-NAME-EMAIL                   
              IF K820-NUM-HP-PGR NOT = SPACES AND LOW-VALUES                    
                MOVE K820-NUM-HP-PGR         TO   WS-HP                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K800-NUM-NRIC2 NOT = SPACES AND LOW-VALUES                        
              ADD        1                 TO   WS-OCCP-PTR                     
              MOVE SPACES                  TO   BP13K820-REC                    
              MOVE K800-NUM-REGN           TO   K820-NUM-REGN                   
              MOVE K800-NUM-NRIC2          TO   K820-NUM-NRIC                   
              PERFORM 8200-READ-K820       THRU 8200-EXIT                       
              MOVE K820-NME-OCCP           TO   WS-NAME(WS-OCCP-PTR)            
              IF K820-NUM-HP-PGR NOT = SPACES AND LOW-VALUES                    
                MOVE K820-NUM-HP-PGR         TO   WS-HP                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K800-NUM-NRIC3 NOT = SPACES AND LOW-VALUES                        
              ADD        1                 TO   WS-OCCP-PTR                     
              MOVE SPACES                  TO   BP13K820-REC                    
              MOVE K800-NUM-REGN           TO   K820-NUM-REGN                   
              MOVE K800-NUM-NRIC3          TO   K820-NUM-NRIC                   
              PERFORM 8200-READ-K820       THRU 8200-EXIT                       
              MOVE K820-NME-OCCP           TO   WS-NAME(WS-OCCP-PTR)            
              IF K820-NUM-HP-PGR NOT = SPACES AND LOW-VALUES                    
                MOVE K820-NUM-HP-PGR         TO   WS-HP                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K800-NUM-NRIC4 NOT = SPACES AND LOW-VALUES                        
              ADD        1                 TO   WS-OCCP-PTR                     
              MOVE SPACES                  TO   BP13K820-REC                    
              MOVE K800-NUM-REGN           TO   K820-NUM-REGN                   
              MOVE K800-NUM-NRIC4          TO   K820-NUM-NRIC                   
              PERFORM 8200-READ-K820       THRU 8200-EXIT                       
              MOVE K820-NME-OCCP           TO   WS-NAME(WS-OCCP-PTR)            
              MOVE K820-NUM-HP-PGR         TO   WS-HP                           
           END-IF.                                                              
                                                                                
                                                                                
                                                                                
       2200-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       2300-GET-NRIC-ADDR.                                                      
      *------------------------------------------------------                   
                                                                                
           MOVE F110-REGN-NO               TO  K830-NUM-REGN.                   
           PERFORM 8300-READ-K830          THRU 8300-EXIT.                      
                                                                                
       2300-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       2400-GET-BLK-ADDRESS.                                                    
      *------------------------------------------------------                   
           MOVE SPACES           TO BP13COMM8-REC.                              
           MOVE K800-NUM-SCH     TO WS-LINK-NUM-SCH.                            
           MOVE K800-NUM-ACC     TO WS-LINK-NUM-ACC.                            
           MOVE K800-NUM-ACC-CK  TO WS-LINK-NUM-CHK.                            
                                                                                
           CALL WS-BP13C913 USING                                               
                 WS-LINK-REC, BP13COMM8-REC                                     
           END-CALL.                                                            
                                                                                
           IF COMM8-CDE-SYSERR NOT = 0                                          
              MOVE COMM8-CDE-SYSERR  TO WS-SQL-CODE                             
              IF COMM8-CDE-SYSERR = 100                                         
                 DISPLAY 'SCH-ACC NOT FOUND IN PBF TABLE' WS-SQL-CODE           
              ELSE                                                              
                 DISPLAY 'ERROR READING PBF TABLE' WS-SQL-CODE                  
              END-IF                                                            
              MOVE SPACES        TO BP13COMM8-REC                               
              SET WS-ERROR       TO TRUE                                        
           END-IF.                                                              
                                                                                
       2400-EXIT.                                                               
            EXIT.                                                               
                                                                                
       2500-GET-NEWTOWN.                                                        
      *------------------------------------------------------                   
                                                                                
            MOVE F110-ESTATE        TO   K510-ESTCDE.                           
            PERFORM 8400-READ-K510  THRU 8400-EXIT.                             
                                                                                
       2500-EXIT.                                                               
            EXIT.                                                               
                                                                                
       2600-GET-PCD.                                                            
      *------------------------------------------------------                   
                                                                                
           MOVE F110-AIX1          TO   K100-KEY-FLD.                           
           PERFORM 8500-READ-K100  THRU 8500-EXIT.                              
                                                                                
           IF K100-NUM-PACD = 'M'                                               
              PERFORM 2700-MONTHLY-PACD   THRU 2700-EXIT                        
           ELSE                                                                 
             IF K100-NUM-PACD = 'Q'                                             
                PERFORM 2800-QUARTERLY-PACD   THRU 2800-EXIT                    
             END-IF                                                             
           END-IF.                                                              
                                                                                
                                                                                
       2600-EXIT.                                                               
            EXIT.                                                               
                                                                                
       2700-MONTHLY-PACD.                                                       
      *------------------------------------------------------                   
           SET WS-MTH-IND TO 1.                                                 
                                                                                
           SEARCH WS-MONTH-TABLE                                                
               AT END                                                           
               MOVE '   ' TO WS-MONTH                                           
            WHEN WS-MONTH-IN-DIGITS(WS-MTH-IND) = K100-DTE-PACD-QTR(5:2)        
               MOVE WS-MONTH-IN-WORDS(WS-MTH-IND) TO WS-MONTH                   
           END-SEARCH.                                                          
                                                                                
           MOVE K100-DTE-PACD-QTR(1:4)       TO WS-YEAR.                        
                                                                                
           STRING WS-MONTH ' ' WS-YEAR                                          
                  DELIMITED BY SIZE                                             
                  INTO P493-NEW-PCD                                             
           END-STRING.                                                          
           MOVE SPACES         TO K491-DTE-PCD                                  
           MOVE P493-NEW-PCD   TO P493-NEW-PCDA                                 
                                  P493-NOTEA-PCD                                
                                  WS-TEMP-PCD                                   
                                  P493-NOTEB-PCD                                
                                  P493-NOTEC-PCD                                
                                  P493-NOTED-PCD                                
                                  K491-DTE-PCD.                                 
                                                                                
       2700-EXIT.                                                               
            EXIT.                                                               
                                                                                
       2800-QUARTERLY-PACD.                                                     
      *------------------------------------------------------                   
           IF K100-DTE-PACD-QTR(5:2) = '01' OR '02' OR '03'                     
              MOVE '1ST QUARTER' TO WS-QUARTER                                  
           ELSE                                                                 
              IF K100-DTE-PACD-QTR(5:2) = '04' OR '05' OR '06'                  
                 MOVE '2ND QUARTER' TO WS-QUARTER                               
              ELSE                                                              
                 IF K100-DTE-PACD-QTR(5:2) = '07' OR '08' OR '09'               
                    MOVE '3RD QUARTER' TO WS-QUARTER                            
                 ELSE                                                           
                    MOVE '4TH QUARTER' TO WS-QUARTER                            
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE K100-DTE-PACD-QTR(1:4)       TO WS-YEAR.                        
                                                                                
           STRING WS-QUARTER ' ' WS-YEAR                                        
                  DELIMITED BY SIZE                                             
                  INTO P493-NEW-PCDQ.                                           
                                                                                
           MOVE SPACES         TO K491-DTE-PCD                                  
           MOVE P493-NEW-PCDQ  TO P493-NEW-PCDA                                 
                                  P493-NOTEA-PCD                                
                                  P493-NOTEC-PCD                                
                                  P493-NOTED-PCD.                               
                                                                                
           STRING WS-QUARTER ' ' WS-YEAR                                        
                  DELIMITED BY SIZE                                             
                  INTO WS-TEMP-PCD.                                             
                                                                                
           MOVE WS-TEMP-PCD   TO K491-DTE-PCD.                                  
       2800-EXIT.                                                               
            EXIT.                                                               
                                                                                
       2900-CHECK-SMS.                                                          
      *------------------------------------------------------                   
                                                                                
            IF K800-NUM-NRIC1 NOT = SPACES AND LOW-VALUES                       
                AND K800-NUM-NRIC1(1:1) NOT = '#'                               
               MOVE SPACES          TO AB03K080-REC                             
               MOVE K800-NUM-NRIC1  TO K080-NUM-UIN                             
                                       WS-NRIC                                  
               PERFORM 2910-READ-K080       THRU 2910-EXIT                      
            END-IF.                                                             
                                                                                
            IF WS-SMS NOT = 'Y'                                                 
               IF K800-NUM-NRIC2 NOT = SPACES AND LOW-VALUES                    
                  AND K800-NUM-NRIC2(1:1) NOT = '#'                             
                 MOVE SPACES          TO AB03K080-REC                           
                 MOVE K800-NUM-NRIC2  TO K080-NUM-UIN                           
                                       WS-NRIC                                  
                 PERFORM 2910-READ-K080       THRU 2910-EXIT                    
               END-IF                                                           
            END-IF.                                                             
                                                                                
            IF WS-SMS NOT = 'Y'                                                 
               IF K800-NUM-NRIC3 NOT = SPACES AND LOW-VALUES                    
                AND K800-NUM-NRIC3(1:1) NOT = '#'                               
                 MOVE SPACES          TO AB03K080-REC                           
                 MOVE K800-NUM-NRIC3  TO K080-NUM-UIN                           
                                       WS-NRIC                                  
                 PERFORM 2910-READ-K080       THRU 2910-EXIT                    
               END-IF                                                           
            END-IF.                                                             
                                                                                
            IF WS-SMS NOT = 'Y'                                                 
               IF K800-NUM-NRIC4 NOT = SPACES AND LOW-VALUES                    
                AND K800-NUM-NRIC4(1:1) NOT = '#'                               
                 MOVE SPACES          TO AB03K080-REC                           
                 MOVE K800-NUM-NRIC4  TO K080-NUM-UIN                           
                                       WS-NRIC                                  
                 PERFORM 2910-READ-K080       THRU 2910-EXIT                    
               END-IF                                                           
            END-IF.                                                             
                                                                                
       2900-EXIT.                                                               
            EXIT.                                                               
                                                                                
       2910-READ-K080.                                                          
      *------------------------------------------------------                   
           MOVE 'N'  TO WS-FLAG                                                 
           START AB03K080 KEY >  K080-KEY                                       
                                                                                
           IF K080-STATUS = 00                                                  
                 PERFORM UNTIL WS-FLAG = 'Y'                                    
                    READ AB03K080 NEXT RECORD                                   
                         AT END MOVE 'Y' TO WS-FLAG                             
                    END-READ                                                    
                    IF K080-STATUS = 00                                         
                       IF WS-NRIC       = K080-NUM-UIN                          
                        MOVE SPACES TO AB03K030-REC                             
                        MOVE K080-NUM-HDB-REF TO K030-NUM-HDB-REF               
                        PERFORM 2920-READ-K030   THRU 2920-EXIT                 
                       ELSE                                                     
                         MOVE 'Y' TO WS-FLAG                                    
                       END-IF                                                   
                    END-IF                                                      
                 END-PERFORM                                                    
           ELSE                                                                 
              DISPLAY 'ERROR WITH START READ OF AM03K080. STATUS IS '           
                       K080-STATUS                                              
              MOVE K080-STATUS              TO RETURN-CODE                      
              PERFORM 9999-WRAP-UP        THRU 9999-EXIT                        
           END-IF.                                                              
                                                                                
       2910-EXIT.                                                               
           EXIT.                                                                
                                                                                
       2920-READ-K030.                                                          
      *-------------------------------------------------------------            
             READ AB03K030                                                      
                                                                                
             IF K030-STATUS = 00                                                
                IF K030-CDE-ACCT-STAT = 'C' AND                                 
                   K030-CDE-SALES-TYP NOT = '13' AND '18'                       
                   MOVE 'Y'    TO WS-SMS                                        
                END-IF                                                          
             ELSE                                                               
                IF K030-STATUS = 23                                             
                   MOVE 'N'  TO WS-SMS                                          
                   DISPLAY 'RECORD NOT FND IN AB03K030 ' K030-STATUS            
                ELSE                                                            
                   DISPLAY 'ERROR READ AB03K030,STATUS ' K030-STATUS            
                   MOVE K030-STATUS     TO RETURN-CODE                          
                   PERFORM 9999-WRAP-UP        THRU 9999-EXIT.                  
                                                                                
       2920-EXIT.                                                               
            EXIT.                                                               
                                                                                
       3000-FORMAT-LETTER.                                                      
      *------------------------------------------------------                   
           MOVE SPACES                   TO  P493-REGN-NO                       
                                             P493-REGN-NO-A                     
                                             P493-NAME1                         
                                             P493-NAME2                         
                                             P493-NAME3                         
                                             P493-NAME4                         
                                             P493-OIC-TEL-A                     
                                             P493-OIC-TEL                       
                                             P493-NME-OIC                       
                                             PECD-BAR-CODE.                     
                                                                                
           MOVE K800-NUM-REGN            TO  P493-REGN-NO                       
                                             P493-REGN-NO-A.                    
           MOVE WS-NAME(1)               TO  P493-NAME1.                        
           MOVE WS-NAME(2)               TO  P493-NAME2.                        
           MOVE WS-NAME(3)               TO  P493-NAME3.                        
           MOVE WS-NAME(4)               TO  P493-NAME4.                        
           IF K830-NUM-MAIL-ADDR NOT = SPACES AND LOW-VALUES                    
              PERFORM 3050-FORMAT-MAIL-ADDR THRU 3050-EXIT                      
           ELSE                                                                 
              PERFORM 3055-FORMAT-HOME-ADDR THRU 3055-EXIT                      
           END-IF.                                                              
                                                                                
      ***testing                                                                
      *    MOVE '114'                    TO  COMM8-NUM-BLK                      
      *    MOVE 'LOORNG 1 TOA PAYOH'     TO  COMM8-NME-STREET.                  
      *    MOVE '09'                     TO  COMM8-NUM-LEVEL                    
      *    MOVE '237'                    TO  COMM8-NUM-UNIT-MAIN                
      ***testing                                                                
           MOVE COMM8-NUM-BLK            TO  P493-UNIT-BLK                      
                                             P493-UNIT-BLK2                     
                                             PCD-UNIT-BLK.                      
           MOVE COMM8-NME-STREET         TO  P493-UNIT-STREET-POSTAL            
                                             PCD-UNIT-STREET-POSTAL.            
           MOVE COMM8-NUM-LEVEL          TO  P493-UNIT-LVL-NO.                  
           MOVE COMM8-NUM-LEVEL          TO  PCD-UNIT-LVL-NO.                   
           MOVE COMM8-NUM-UNIT-MAIN      TO  P493-UNIT-UNIT-NO.                 
           MOVE COMM8-NUM-POSTAL-CODE    TO  PCD-POSTAL.                        
                                                                                
           PERFORM 5000-RETRIEVE-CSM THRU 5000-EXIT.                            
                                                                                
       3000-EXIT.                                                               
            EXIT.                                                               
                                                                                
       3001-FORMAT-KH55.                                                        
      *------------------------------------------------------                   
                                                                                
           MOVE K800-NUM-REGN            TO  KH55-NUM-REGN.                     
           MOVE SPACES                   TO  KH55-NUM-EMAIL                     
           MOVE WS-HP                    TO  KH55-NUM-HP                        
           MOVE COMM8-NUM-BLK            TO  KH55-NUM-BLK                       
           MOVE COMM8-NUM-LEVEL          TO  KH55-NUM-LEVEL                     
           MOVE COMM8-NUM-UNIT-MAIN      TO  KH55-NUM-MAIN-UNIT                 
           MOVE COMM8-NME-STREET         TO  KH55-NUM-STREET                    
           MOVE COMM8-NUM-POSTAL-CODE    TO  KH55-NUM-POSTAL                    
           PERFORM 5000-RETRIEVE-CSM THRU 5000-EXIT.                            
           MOVE K024-NME-OIC             TO  KH55-NME-OIC.                      
           MOVE WS-DATE                TO KH55-DTE-UPDATE.                      
           IF WS-HP NOT = SPACES AND LOW-VALUES                                 
              MOVE 'Y'                   TO KH55-NUM-TAG-SMS                    
           ELSE                                                                 
              MOVE 'N'                   TO KH55-NUM-TAG-SMS                    
           END-IF.                                                              
           MOVE F205-FORM-OPTION  TO KH55-NUM-PCD-FORM                          
           MOVE WS-TEMP-PCD        TO KH55-DTE-PCD.                             
                                                                                
           WRITE BP13KH55-REC.                                                  
                                                                                
           EVALUATE KH55-STATUS                                                 
             WHEN 00                                                            
                 ADD 1 TO WS-KH55-WRT                                           
             WHEN 02                                                            
             WHEN 22                                                            
                 DISPLAY 'DUP RECORD KH55..STAT'    KH55-STATUS                 
                          '/' KH55-NUM-REGN                                     
             WHEN OTHER                                                         
                 DISPLAY 'ERROR WRITING THE RECORD KH55..STAT'                  
                    KH55-STATUS                                                 
                 DISPLAY 'KEY FIELD KH55 ' KH55-KEY-FLD                         
                 MOVE KH55-STATUS           TO RETURN-CODE                      
                 PERFORM 9999-WRAP-UP        THRU 9999-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       3001-EXIT.                                                               
            EXIT.                                                               
                                                                                
       3001A-FORMAT-EMAIL.                                                      
      *------------------------------------------------------                   
                                                                                
             IF WS-SMS  = 'Y'                                                   
              EVALUATE  F205-FORM-OPTION                                        
               WHEN 'C'                                                         
                   MOVE 'I'                  TO K491-TAG-FORM                   
               WHEN 'D'                                                         
                   MOVE 'J'                  TO K491-TAG-FORM                   
               WHEN OTHER                                                       
                   MOVE 'K'                  TO K491-TAG-FORM                   
              END-EVALUATE                                                      
             ELSE                                                               
              IF ((K800-NUM-FLAT-TYPE = '2F') AND                               
                  (K800-NUM-LEASE-TENURE > 0  AND                               
                  K800-NUM-LEASE-TENURE <= 45)) AND                             
                  K800-NUM-PPO = 'Y'                                            
                MOVE 'Z'                  TO K491-TAG-FORM                      
              ELSE                                                              
                MOVE 'L'                  TO K491-TAG-FORM                      
                IF F205-FORM-OPTION = 'C'                                       
                   MOVE '06'  TO K491-NUM-MONTHS                                
                ELSE                                                            
                 IF F205-FORM-OPTION = 'D'                                      
                   MOVE '12'  TO K491-NUM-MONTHS                                
                 END-IF                                                         
                END-IF                                                          
              END-IF                                                            
             END-IF                                                             
                                                                                
                                                                                
           MOVE K800-NUM-REGN            TO  K491-NUM-REGN.                     
           MOVE K857-NUM-EMAIL           TO  K491-NUM-EMAIL                     
           MOVE COMM8-NUM-BLK            TO  K491-NUM-BLK                       
           MOVE COMM8-NUM-LEVEL          TO  K491-NUM-LEVEL                     
           MOVE COMM8-NUM-UNIT-MAIN      TO  K491-NUM-MAIN-UNIT                 
           MOVE COMM8-NME-STREET         TO  K491-NUM-STREET                    
           MOVE COMM8-NUM-POSTAL-CODE    TO  K491-NUM-POSTAL                    
           PERFORM 5000-RETRIEVE-CSM THRU 5000-EXIT.                            
           MOVE K024-NME-OIC             TO  K491-NME-OIC.                      
           MOVE WS-DATE                TO K491-DTE-UPDATE.                      
                                                                                
           WRITE BP13K491-REC.                                                  
                                                                                
           EVALUATE K491-STATUS                                                 
             WHEN 00                                                            
                 ADD 1 TO WS-F491-WRT                                           
             WHEN 02                                                            
             WHEN 22                                                            
                 DISPLAY 'DUP RECORD K491..STAT'    K491-STATUS                 
                          '/' K491-NUM-REGN                                     
             WHEN OTHER                                                         
                 DISPLAY 'ERROR WRITING THE RECORD K491..STAT'                  
                    K491-STATUS                                                 
                 DISPLAY 'KEY FIELD K028 ' K491-KEY-FLD                         
                 MOVE K491-STATUS           TO RETURN-CODE                      
                 PERFORM 9999-WRAP-UP        THRU 9999-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       3001A-EXIT.                                                              
            EXIT.                                                               
                                                                                
       3002-FORMAT-EMAIL.                                                       
      *------------------------------------------------------                   
                                                                                
             IF WS-SMS  = 'Y'                                                   
              EVALUATE  F205-FORM-OPTION                                        
               WHEN 'C'                                                         
                   MOVE 'I'                  TO K491-TAG-FORM                   
               WHEN 'D'                                                         
                   MOVE 'J'                  TO K491-TAG-FORM                   
               WHEN OTHER                                                       
                   MOVE 'K'                  TO K491-TAG-FORM                   
              END-EVALUATE                                                      
             ELSE                                                               
              IF ((K800-NUM-FLAT-TYPE = '2F') AND                               
                  (K800-NUM-LEASE-TENURE > 0  AND                               
                  K800-NUM-LEASE-TENURE <= 45)) AND                             
                  K800-NUM-PPO = 'Y'                                            
                MOVE 'Z'                  TO K491-TAG-FORM                      
              ELSE                                                              
                MOVE 'L'                  TO K491-TAG-FORM                      
                IF F205-FORM-OPTION = 'C'                                       
                   MOVE '06'  TO K491-NUM-MONTHS                                
                ELSE                                                            
                 IF F205-FORM-OPTION = 'D'                                      
                   MOVE '12'  TO K491-NUM-MONTHS                                
                 END-IF                                                         
              END-IF                                                            
             END-IF                                                             
                                                                                
           MOVE K800-NUM-REGN            TO  K491-NUM-REGN.                     
           MOVE K857-NUM-EMAIL           TO  K491-NUM-EMAIL                     
           MOVE COMM8-NUM-BLK            TO  K491-NUM-BLK                       
           MOVE COMM8-NUM-LEVEL          TO  K491-NUM-LEVEL                     
           MOVE COMM8-NUM-UNIT-MAIN      TO  K491-NUM-MAIN-UNIT                 
           MOVE COMM8-NME-STREET         TO  K491-NUM-STREET                    
           MOVE COMM8-NUM-POSTAL-CODE    TO  K491-NUM-POSTAL                    
           PERFORM 5000-RETRIEVE-CSM THRU 5000-EXIT.                            
           MOVE K024-NME-OIC             TO  K491-NME-OIC.                      
           MOVE WS-DATE                TO K491-DTE-UPDATE.                      
                                                                                
           REWRITE BP13K491-REC.                                                
                                                                                
           EVALUATE K491-STATUS                                                 
             WHEN 00                                                            
                 ADD 1 TO WS-F491-WRT                                           
             WHEN OTHER                                                         
                 DISPLAY 'ERROR REWRITING THE RECORD K491..STAT'                
                    K491-STATUS                                                 
                 DISPLAY 'KEY FIELD K491 ' K491-KEY-FLD                         
                 MOVE K491-STATUS           TO RETURN-CODE                      
                 PERFORM 9999-WRAP-UP        THRU 9999-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       3002-EXIT.                                                               
            EXIT.                                                               
                                                                                
       3003-READ-K491.                                                          
      *-------------------------------------------------------------            
           MOVE SPACES         TO BP13K491-REC.                                 
           MOVE 'N'            TO WS-FOUND-K491.                                
           MOVE F110-REGN-NO   TO K491-NUM-REGN.                                
           READ BP13K491.                                                       
                                                                                
           IF K491-STATUS = 00                                                  
              MOVE 'Y'  TO WS-FOUND-K491                                        
           ELSE                                                                 
           IF K491-STATUS = 23                                                  
              MOVE 'N'  TO WS-FOUND-K491                                        
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K491, STATUS ' K491-STATUS             
              MOVE K491-STATUS TO RETURN-CODE                                   
              PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT.                         
                                                                                
       3003-EXIT.                                                               
            EXIT.                                                               
                                                                                
       3004-READ-KH55.                                                          
      *-------------------------------------------------------------            
           MOVE SPACES         TO BP13KH55-REC.                                 
           MOVE 'N'            TO WS-FOUND-KH55.                                
           MOVE F110-REGN-NO   TO KH55-NUM-REGN.                                
           READ BP13KH55.                                                       
                                                                                
           IF KH55-STATUS = 00                                                  
              MOVE 'Y'  TO WS-FOUND-KH55                                        
           ELSE                                                                 
           IF KH55-STATUS = 23                                                  
              MOVE 'N'  TO WS-FOUND-KH55                                        
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13KH55, STATUS ' KH55-STATUS             
              MOVE KH55-STATUS TO RETURN-CODE                                   
              PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT.                         
                                                                                
       3004-EXIT.                                                               
            EXIT.                                                               
                                                                                
       3005-FORMAT-REWRT-KH55.                                                  
      *------------------------------------------------------                   
                                                                                
           MOVE K800-NUM-REGN            TO  KH55-NUM-REGN.                     
           MOVE SPACES                   TO  KH55-NUM-EMAIL                     
           MOVE WS-HP                    TO  KH55-NUM-HP                        
           MOVE COMM8-NUM-BLK            TO  KH55-NUM-BLK                       
           MOVE COMM8-NUM-LEVEL          TO  KH55-NUM-LEVEL                     
           MOVE COMM8-NUM-UNIT-MAIN      TO  KH55-NUM-MAIN-UNIT                 
           MOVE COMM8-NME-STREET         TO  KH55-NUM-STREET                    
           MOVE COMM8-NUM-POSTAL-CODE    TO  KH55-NUM-POSTAL                    
           PERFORM 5000-RETRIEVE-CSM THRU 5000-EXIT.                            
           MOVE K024-NME-OIC             TO  KH55-NME-OIC.                      
           MOVE WS-DATE                TO KH55-DTE-UPDATE.                      
           IF WS-HP NOT = SPACES AND LOW-VALUES                                 
              MOVE 'Y'                   TO KH55-NUM-TAG-SMS                    
           ELSE                                                                 
              MOVE 'N'                   TO KH55-NUM-TAG-SMS                    
           END-IF.                                                              
           MOVE F205-FORM-OPTION  TO KH55-NUM-PCD-FORM                          
           MOVE WS-TEMP-PCD        TO KH55-DTE-PCD.                             
                                                                                
           REWRITE BP13KH55-REC.                                                
                                                                                
           EVALUATE KH55-STATUS                                                 
             WHEN 00                                                            
                 ADD 1 TO WS-KH55-RWRT                                          
             WHEN OTHER                                                         
                 DISPLAY 'ERROR WRITING THE RECORD KH55..STAT'                  
                    KH55-STATUS                                                 
                 DISPLAY 'KEY FIELD KH55 ' KH55-KEY-FLD                         
                 MOVE KH55-STATUS           TO RETURN-CODE                      
                 PERFORM 9999-WRAP-UP        THRU 9999-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       3005-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       3050-FORMAT-MAIL-ADDR.                                                   
      *------------------------------------------------------                   
           IF K830-NUM-MAIL-ADDR-TYPE  = 'H'                                    
              MOVE K830-NME-MAIL-STR-BLDG TO P493-STREET                        
              MOVE K830-NUM-MAIL-LVL-CHAR TO P493-CHAR                          
              MOVE K830-NUM-MAIL-LVL-NUM  TO P493-LEVEL                         
              MOVE K830-NUM-MAIL-LVL-DASH TO P493-DASH                          
              MOVE K830-NUM-MAIL-HSEMAIN  TO P493-HSE-MAIN                      
              MOVE K830-NUM-MAIL-HSESUB   TO P493-HSE-SUB                       
           ELSE                                                                 
              MOVE K830-NUM-MAIL-FLAT     TO P493-FLAT-NO                       
              MOVE K830-NME-MAIL-STR-BLDG TO P493-STREET                        
           END-IF.                                                              
                                                                                
           MOVE K830-NUM-MAIL-BLK         TO P493-BLK.                          
           MOVE K830-NUM-MAIL-POSTAL      TO P493-POSTAL.                       
                                                                                
           IF K830-NUM-MAIL-POSTAL = SPACES OR ZEROS                            
              DISPLAY '- MAIL POSTAL EMPTY ' K830-NUM-MAIL-POSTAL               
                      ', REGN IS ' K800-NUM-REGN.                               
                                                                                
           MOVE SPACES                    TO WS-LINK-AV02C015.                  
           MOVE K830-NUM-MAIL-POSTAL      TO AV02C015-IN-POSTCODE.              
           PERFORM 6500-CALL-AV02C015     THRU 6500-EXIT.                       
           MOVE AV02C015-OUT-POSTCODE-CHKSUM TO PECD-BAR-CODE.                  
                                                                                
           STRING 'SINGAPORE ' K830-NUM-MAIL-POSTAL                             
           DELIMITED BY SIZE            INTO WS-TEMP-POSTAL.                    
                                                                                
       3050-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       3055-FORMAT-HOME-ADDR.                                                   
      *------------------------------------------------------                   
           IF K830-NUM-ADDR-TYPE  = 'H'                                         
              MOVE K830-NME-STREET      TO P493-STREET                          
              MOVE K830-NUM-LVL-CHAR    TO P493-CHAR                            
              MOVE K830-NUM-LVL-NUM     TO P493-LEVEL                           
              MOVE K830-NUM-LVL-DASH    TO P493-DASH                            
              MOVE K830-NUM-HSEMAIN     TO P493-HSE-MAIN                        
              MOVE K830-NUM-HSESUB      TO P493-HSE-SUB                         
           ELSE                                                                 
              MOVE K830-NUM-FLAT        TO P493-FLAT-NO                         
              MOVE K830-NME-STREET-BLDG TO P493-STREET                          
           END-IF.                                                              
                                                                                
           MOVE K830-NUM-BLK            TO P493-BLK.                            
           MOVE K830-NUM-POSTAL         TO P493-POSTAL.                         
                                                                                
           IF K830-NUM-POSTAL = SPACES OR ZEROS                                 
              DISPLAY '- RES POSTAL EMPTY ' K830-NUM-MAIL-POSTAL                
                      ', REGN IS ' K800-NUM-REGN.                               
                                                                                
           MOVE SPACES                  TO WS-LINK-AV02C015.                    
           MOVE K830-NUM-POSTAL         TO AV02C015-IN-POSTCODE.                
           PERFORM 6500-CALL-AV02C015   THRU 6500-EXIT.                         
           MOVE AV02C015-OUT-POSTCODE-CHKSUM TO PECD-BAR-CODE.                  
                                                                                
                                                                                
       3055-EXIT.                                                               
            EXIT.                                                               
                                                                                
       3070-PRINT-LETTER.                                                       
      *-------------------------------------------------------------            
      * OPTION: B   FORM: BP13XJ                                                
      * LETTER TO BE SENT OUT FOR PCD ENTERED BY THE USER (B848)                
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493-PRTREC.                            
                    MOVE WS-TEMP-PCD   TO P493-NEW-PCDA                         
                                          P493-NOTEA-PCD                        
                                          P493-NOTEB-PCD                        
                                          P493-NOTEC-PCD                        
                                          P493-NOTED-PCD                        
                                                                                
           ADD   1                   TO WS-CNT-LETTER.                          
           WRITE P493-PRTREC FROM P493-LINE01 AFTER PAGE.                       
           WRITE P493-PRTREC FROM P493-LINE02.                                  
           WRITE P493-PRTREC FROM P493-LINE03.                                  
                                                                                
           WRITE P493-PRTREC FROM P493-LINE04 AFTER 4.                          
           WRITE P493-PRTREC FROM P493-LINE04B.                                 
           WRITE P493-PRTREC FROM P493-LINE04C.                                 
           WRITE P493-PRTREC FROM P493-LINE04D.                                 
                                                                                
           WRITE P493-PRTREC FROM P493-LINE05.                                  
           WRITE P493-PRTREC FROM P493-LINE05B.                                 
           WRITE P493-PRTREC FROM P493-LINE05C.                                 
           WRITE P493-PRTREC FROM PECD-LINE06 AFTER 2.                          
                                                                                
           WRITE P493-PRTREC FROM PECD-LINE07 AFTER 6.                          
                                                                                
      *    WRITE P493-PRTREC FROM PECD-LINE08A      AFTER 7.                    
      *    WRITE P493-PRTREC FROM PECD-LINE09A      AFTER 1.                    
           WRITE P493-PRTREC FROM PECD-NOTE-LINE10A AFTER 4.                    
      *     WRITE P493-PRTREC FROM PECD-NOTE-LINE10A AFTER 09.                  
                                                                                
           WRITE P493-PRTREC FROM PECD-FT-OIC AFTER 19.                         
                                                                                
      * FILE COPY                                                               
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493-PRTREC.                            
                                                                                
           WRITE P493-PRTREC FROM P493-LINE01 AFTER PAGE.                       
           WRITE P493-PRTREC FROM P493-LINE02.                                  
           WRITE P493-PRTREC FROM P493-LINE03.                                  
                                                                                
           WRITE P493-PRTREC FROM P493-LINE04 AFTER 4.                          
           WRITE P493-PRTREC FROM P493-LINE04B.                                 
           WRITE P493-PRTREC FROM P493-LINE04C.                                 
           WRITE P493-PRTREC FROM P493-LINE04D.                                 
                                                                                
           WRITE P493-PRTREC FROM P493-LINE05.                                  
           WRITE P493-PRTREC FROM P493-LINE05B.                                 
           WRITE P493-PRTREC FROM P493-LINE05C.                                 
           WRITE P493-PRTREC FROM PECD-LINE06 AFTER 2.                          
                                                                                
           WRITE P493-PRTREC FROM PECD-LINE07 AFTER 6.                          
                                                                                
      *    WRITE P493-PRTREC FROM PECD-LINE08A       AFTER 7.                   
      *    WRITE P493-PRTREC FROM PECD-LINE09A       AFTER 1.                   
           WRITE P493-PRTREC FROM PECD-NOTE-LINE10A AFTER 4.                    
      *    WRITE P493-PRTREC FROM PECD-NOTE-LINE10A AFTER 09.                   
                                                                                
           WRITE P493-PRTREC FROM PECD-FT-OIC AFTER 19.                         
                                                                                
       3070-EXIT.                                                               
            EXIT.                                                               
                                                                                
       3090-PRINT-LETTER.                                                       
      *-------------------------------------------------------------            
      *              FORM: BP13TH                                               
      * LETTER TO BE SENT OUT FOR PCD NOND FS AND NON SMS                       
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493-PRTREC.                            
                    MOVE WS-TEMP-PCD   TO P493-NEW-PCDA                         
                                          P493-NOTEA-PCD                        
                                          P493-NOTEB-PCD                        
                                          P493-NOTEC-PCD                        
                                          P493-NOTED-PCD                        
                                                                                
           ADD   1                   TO WS-BP13TH-CTR.                          
           MOVE  SPACES              TO P493-PRTREC.                            
           MOVE  WS-BP13TH-CTR       TO WS-RECORD-CNT.                          
           MOVE  WS-RECORD-CNT       TO DJDE-LINE-TH-PAGE1(49:4).               
           MOVE  DJDE-LINE-TH-PAGE1  TO P493-PRTREC.                            
           WRITE P493-PRTREC     AFTER PAGE.                                    
                                                                                
           ADD   1                   TO WS-CNT-LETTER.                          
           WRITE P493-PRTREC FROM P493-LINE01-A.                                
           WRITE P493-PRTREC FROM P493-LINE02-A.                                
           WRITE P493-PRTREC FROM P493-LINE03-A.                                
                                                                                
           WRITE P493-PRTREC FROM P493-LINE04 AFTER 4.                          
           WRITE P493-PRTREC FROM P493-LINE04B.                                 
           WRITE P493-PRTREC FROM P493-LINE04C.                                 
           WRITE P493-PRTREC FROM P493-LINE04D.                                 
                                                                                
           WRITE P493-PRTREC FROM P493-LINE05.                                  
           WRITE P493-PRTREC FROM P493-LINE05B.                                 
           WRITE P493-PRTREC FROM P493-LINE05C.                                 
           WRITE P493-PRTREC FROM PECD-LINE06 AFTER 2.                          
                                                                                
      *    WRITE P493-PRTREC FROM PECD-LINE07A AFTER 4.                         
           WRITE P493-PRTREC FROM PECD-LINE07  AFTER 6.                         
           WRITE P493-PRTREC FROM PECD-NOTE-LINE10D AFTER 4.                    
           WRITE P493-PRTREC FROM PECD-FT-OIC       AFTER 18.                   
                                                                                
      * FILE COPY                                                               
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493B-PRTREC.                           
           MOVE  DJDE-LINE-TH-PAGE1  TO P493B-PRTREC.                           
           WRITE P493B-PRTREC     AFTER PAGE.                                   
                                                                                
           WRITE P493B-PRTREC FROM P493-LINE01-A.                               
           WRITE P493B-PRTREC FROM P493-LINE02-A.                               
           WRITE P493B-PRTREC FROM P493-LINE03-A.                               
                                                                                
           WRITE P493B-PRTREC FROM P493-LINE04 AFTER 4.                         
           WRITE P493B-PRTREC FROM P493-LINE04B.                                
           WRITE P493B-PRTREC FROM P493-LINE04C.                                
           WRITE P493B-PRTREC FROM P493-LINE04D.                                
                                                                                
           WRITE P493B-PRTREC FROM P493-LINE05.                                 
           WRITE P493B-PRTREC FROM P493-LINE05B.                                
           WRITE P493B-PRTREC FROM P493-LINE05C.                                
           WRITE P493B-PRTREC FROM PECD-LINE06 AFTER 2.                         
                                                                                
      *    WRITE P493B-PRTREC FROM PECD-LINE07A AFTER 4.                        
           WRITE P493B-PRTREC FROM PECD-LINE07  AFTER 6.                        
           WRITE P493B-PRTREC FROM PECD-NOTE-LINE10D AFTER 4.                   
           WRITE P493B-PRTREC FROM PECD-FT-OIC       AFTER 18.                  
                                                                                
                                                                                
       3090-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
                                                                                
       3100-PRINT-LETTER.                                                       
      *-------------------------------------------------------------            
                                                                                
      * LETTER TO BE SENT OUT FOR MONTHLY                                       
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493-PRTREC.                            
                                                                                
           ADD   1                   TO WS-CNT-LETTER.                          
           WRITE P493-PRTREC FROM P493-LINE01 AFTER PAGE.                       
           WRITE P493-PRTREC FROM P493-LINE02.                                  
           WRITE P493-PRTREC FROM P493-LINE03.                                  
                                                                                
           WRITE P493-PRTREC FROM P493-LINE04 AFTER 4.                          
           WRITE P493-PRTREC FROM P493-LINE04B.                                 
           WRITE P493-PRTREC FROM P493-LINE04C.                                 
           WRITE P493-PRTREC FROM P493-LINE04D.                                 
                                                                                
           WRITE P493-PRTREC FROM P493-LINE05.                                  
           WRITE P493-PRTREC FROM P493-LINE05B.                                 
           WRITE P493-PRTREC FROM P493-LINE05C.                                 
           WRITE P493-PRTREC FROM PECD-LINE06 AFTER 2.                          
                                                                                
           WRITE P493-PRTREC FROM PECD-LINE07A AFTER 4.                         
           WRITE P493-PRTREC FROM PECD-LINE07.                                  
           WRITE P493-PRTREC FROM PECD-LINE10A AFTER 7.                         
           WRITE P493-PRTREC FROM PECD-FT-OIC AFTER 27.                         
                                                                                
      * FILE COPY                                                               
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493B-PRTREC.                           
                                                                                
           WRITE P493B-PRTREC FROM P493-LINE01 AFTER PAGE.                      
           WRITE P493B-PRTREC FROM P493-LINE02.                                 
           WRITE P493B-PRTREC FROM P493-LINE03.                                 
                                                                                
           WRITE P493B-PRTREC FROM P493-LINE04 AFTER 4.                         
           WRITE P493B-PRTREC FROM P493-LINE04B.                                
           WRITE P493B-PRTREC FROM P493-LINE04C.                                
           WRITE P493B-PRTREC FROM P493-LINE04D.                                
                                                                                
           WRITE P493B-PRTREC FROM P493-LINE05.                                 
           WRITE P493B-PRTREC FROM P493-LINE05B.                                
           WRITE P493B-PRTREC FROM P493-LINE05C.                                
           WRITE P493B-PRTREC FROM PECD-LINE06 AFTER 2.                         
                                                                                
           WRITE P493B-PRTREC FROM PECD-LINE07A AFTER 4.                        
           WRITE P493B-PRTREC FROM PECD-LINE07.                                 
           WRITE P493B-PRTREC FROM PECD-LINE10A AFTER 7.                        
           WRITE P493B-PRTREC FROM PECD-FT-OIC AFTER 27.                        
                                                                                
       3100-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *****************************************************************         
       310A-PRINT-IOMS.                                                         
      *****************************************************************         
                                                                                
           PERFORM 310B-PROCESS-B10-REC  THRU 310B-EXIT.                        
                                                                                
           ADD 1                       TO WS-BC493-SNO.                         
           MOVE WS-BC493-SNO           TO WS-P493A-NUM-SNO.                     
                                                                                
           IF KH55-TAG-FORM = 'L'                                               
             MOVE 'BP13TH'               TO WS-P493A-DESC                       
                                            WS-P493A-NUM-FORMID1                
           ELSE                                                                 
            IF KH55-TAG-FORM = 'Z'                                              
             MOVE 'BP13TS'               TO WS-P493A-DESC                       
                                            WS-P493A-NUM-FORMID1                
            ELSE                                                                
             MOVE 'BP13CD'               TO WS-P493A-DESC                       
                                            WS-P493A-NUM-FORMID1                
            END-IF                                                              
           END-IF.                                                              
                                                                                
           DISPLAY WS-BC493-SNO ' ' P493-REGN-NO '/' KH55-TAG-FORM '/'          
                   WS-P493A-DESC                                                
                                                                                
           MOVE  P493-REGN-NO          TO WS-P493A-NUM-REGN                     
           MOVE  P493-DATE             TO WS-P493A-DTE-PRINT                    
           MOVE  P493-NME-OIC          TO WS-P493A-NME-OIC                      
                                                                                
           MOVE  P493-NAME1            TO WS-P493A-NME-APPLT1                   
           MOVE  P493-NAME2            TO WS-P493A-NME-APPLT2                   
           MOVE  P493-NAME3            TO WS-P493A-NME-APPLT3                   
           MOVE  P493-NAME4            TO WS-P493A-NME-APPLT4                   
                                                                                
           MOVE  P493-BLK              TO WS-P493A-BLK                          
           MOVE  P493-STREET           TO WS-P493A-STR-BLDG                     
           MOVE  P493-FLAT-NO          TO WS-P493A-HSE-NO                       
           MOVE  P493-POSTAL           TO WS-P493A-POSTAL                       
           MOVE  PECD-BAR-CODE         TO WS-P493A-BAR-CODE                     
                                                                                
      *    MOVE  P493-PROJ-NAME-9A     TO WS-P493A-TXT-PROJ-NAME                
           MOVE  WS-TEMP-PCD           TO WS-P493A-TXT-REV-PCD                  
      *    MOVE  P493-ORIG-PCD         TO WS-P493A-TXT-ORIG-PCD                 
      *    MOVE  P493-DELAY-MONS       TO WS-P493A-TXT-DELAY-MONS               
                                                                                
      *    MOVE 'Update on Progress of'   TO WS-P493A-HEADER-DESC.              
           STRING 'BLK ' P493-UNIT-BLK                                          
           DELIMITED BY SIZE         INTO WS-P493A-PCD-BLK                      
           STRING '#' P493-UNIT-LVL-NO '-' P493-UNIT-UNIT-NO                    
              DELIMITED BY SIZE      INTO WS-P493A-PCD-HSE-NO                   
           MOVE P493-UNIT-STREET-POSTAL TO WS-P493A-PCD-STREET                  
           STRING 'SINGAPORE ' PCD-POSTAL                                       
           DELIMITED BY SIZE           INTO WS-P493A-PCD-POSTAL                 
                                                                                
           WRITE P13BC493-REC FROM WS-P13P493A-B10-REC.                         
           ADD 1                       TO WS-HC493-WRITE                        
                                          WS-BP13CD-CNT                         
                                          WS-FB10-WRITE.                        
                                                                                
       310A-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       310B-PROCESS-B10-REC.                                                    
      *****************************************************************         
                                                                                
           MOVE SPACES                 TO WS-P13P493A-B10-REC.                  
           INITIALIZE WS-P13P493A-B10-REC.                                      
                                                                                
           MOVE '_'                    TO WS-P493A-UNDERSCORE1                  
                                          WS-P493A-UNDERSCORE2                  
                                          WS-P493A-UNDERSCORE3.                 
           MOVE 'B10'                  TO WS-P493A-RECORD-TYPE.                 
           MOVE WS-PARM-JOBNAME        TO WS-P493A-JOBNAME.                     
           MOVE WS-UPD-TMESTAMP(1:12)  TO WS-P493A-TMESTAMP.                    
           MOVE P493-REGN-NO           TO WS-P493A-NUM-REGN                     
                                          WS-P493A-OUR-REF.                     
                                                                                
       310B-EXIT.                                                               
           EXIT.                                                                
                                                                                
       3102-PRINT-LETTER.                                                       
      *-------------------------------------------------------------            
                                                                                
      * FORM: BP13FK                                                            
      * LETTER TO BE SENT OUT FOR MONTHLY                                       
      *-------------------------------------------------------------            
           ADD   1                   TO WS-BP13FK-CTR.                          
           MOVE  SPACES              TO P493C-PRTREC.                           
           MOVE  WS-BP13FK-CTR       TO WS-RECORD-CNT.                          
           MOVE  WS-RECORD-CNT       TO DJDE-LINE-FK-PAGE1(49:4).               
           MOVE  DJDE-LINE-FK-PAGE1  TO P493C-PRTREC.                           
           WRITE P493C-PRTREC     AFTER PAGE.                                   
                                                                                
           ADD   1                   TO WS-CNT-LETTER.                          
           WRITE P493C-PRTREC FROM P493-LINE01-A.                               
           WRITE P493C-PRTREC FROM P493-LINE02-A.                               
           WRITE P493C-PRTREC FROM P493-LINE03-A.                               
                                                                                
           WRITE P493C-PRTREC FROM P493-LINE04 AFTER 4.                         
           WRITE P493C-PRTREC FROM P493-LINE04B.                                
           WRITE P493C-PRTREC FROM P493-LINE04C.                                
           WRITE P493C-PRTREC FROM P493-LINE04D.                                
                                                                                
           WRITE P493C-PRTREC FROM P493-LINE05.                                 
           WRITE P493C-PRTREC FROM P493-LINE05B.                                
           WRITE P493C-PRTREC FROM P493-LINE05C.                                
           WRITE P493C-PRTREC FROM PECD-LINE06 AFTER 2.                         
                                                                                
           WRITE P493C-PRTREC FROM PECD-LINE07A AFTER 4.                        
           WRITE P493C-PRTREC FROM PECD-LINE07.                                 
           WRITE P493C-PRTREC FROM PECD-LINE10A AFTER 7.                        
                                                                                
           MOVE  SPACES              TO P493C-PRTREC.                           
           MOVE  DJDE-LINE-FD-PAGE2  TO P493C-PRTREC.                           
           WRITE P493C-PRTREC     AFTER PAGE.                                   
           WRITE P493C-PRTREC FROM PECD-FT-OIC AFTER 28.                        
                                                                                
      * BP13FE                                                                  
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493C-PRTREC.                           
           MOVE  DJDE-LINE-FE-PAGE3  TO P493C-PRTREC.                           
           WRITE P493C-PRTREC     AFTER PAGE.                                   
           MOVE  SPACES              TO P493C-PRTREC.                           
           WRITE P493C-PRTREC     AFTER 5.                                      
                                                                                
      * FILE COPY                                                               
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493D-PRTREC.                           
           MOVE  DJDE-LINE-FK-PAGE1  TO P493D-PRTREC.                           
           WRITE P493D-PRTREC     AFTER PAGE.                                   
                                                                                
           WRITE P493D-PRTREC FROM P493-LINE01-A.                               
           WRITE P493D-PRTREC FROM P493-LINE02-A.                               
           WRITE P493D-PRTREC FROM P493-LINE03-A.                               
                                                                                
           WRITE P493D-PRTREC FROM P493-LINE04 AFTER 4.                         
           WRITE P493D-PRTREC FROM P493-LINE04B.                                
           WRITE P493D-PRTREC FROM P493-LINE04C.                                
           WRITE P493D-PRTREC FROM P493-LINE04D.                                
                                                                                
           WRITE P493D-PRTREC FROM P493-LINE05.                                 
           WRITE P493D-PRTREC FROM P493-LINE05B.                                
           WRITE P493D-PRTREC FROM P493-LINE05C.                                
           WRITE P493D-PRTREC FROM PECD-LINE06 AFTER 2.                         
                                                                                
           WRITE P493D-PRTREC FROM PECD-LINE07A AFTER 4.                        
           WRITE P493D-PRTREC FROM PECD-LINE07.                                 
           WRITE P493D-PRTREC FROM PECD-LINE10A AFTER 7.                        
                                                                                
           MOVE  SPACES              TO P493D-PRTREC.                           
           MOVE  DJDE-LINE-FD-PAGE2  TO P493D-PRTREC.                           
           WRITE P493D-PRTREC     AFTER PAGE.                                   
           WRITE P493D-PRTREC FROM PECD-FT-OIC AFTER 28.                        
                                                                                
      * BP13FE                                                                  
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493D-PRTREC.                           
           MOVE  DJDE-LINE-FE-PAGE3  TO P493D-PRTREC.                           
           WRITE P493D-PRTREC     AFTER PAGE.                                   
           MOVE  SPACES              TO P493D-PRTREC.                           
           WRITE P493D-PRTREC     AFTER 5.                                      
                                                                                
       3102-EXIT.                                                               
            EXIT.                                                               
                                                                                
       3103-PRINT-LETTER.                                                       
      *-------------------------------------------------------------            
                                                                                
      * FORM: BP1328                                                            
      * LETTER TO BE SENT OUT FOR MONTHLY                                       
      *-------------------------------------------------------------            
           ADD   1                   TO WS-BP1328-CTR.                          
           MOVE  SPACES              TO P493G-PRTREC.                           
           MOVE  WS-BP1328-CTR       TO WS-RECORD-CNT.                          
           MOVE  WS-RECORD-CNT       TO DJDE-LINE-28-PAGE1(49:4).               
           MOVE  DJDE-LINE-28-PAGE1  TO P493G-PRTREC.                           
           WRITE P493G-PRTREC     AFTER PAGE.                                   
                                                                                
           ADD   1                   TO WS-CNT-LETTER.                          
           WRITE P493G-PRTREC FROM P493-LINE01-A.                               
           WRITE P493G-PRTREC FROM P493-LINE02-A.                               
           WRITE P493G-PRTREC FROM P493-LINE03-A.                               
                                                                                
           WRITE P493G-PRTREC FROM P493-LINE04 AFTER 4.                         
           WRITE P493G-PRTREC FROM P493-LINE04B.                                
           WRITE P493G-PRTREC FROM P493-LINE04C.                                
           WRITE P493G-PRTREC FROM P493-LINE04D.                                
                                                                                
           WRITE P493G-PRTREC FROM P493-LINE05.                                 
           WRITE P493G-PRTREC FROM P493-LINE05B.                                
           WRITE P493G-PRTREC FROM P493-LINE05C.                                
           WRITE P493G-PRTREC FROM PECD-LINE06 AFTER 2.                         
                                                                                
      *    WRITE P493G-PRTREC FROM PECD-LINE07A AFTER 4.                        
           WRITE P493G-PRTREC FROM PECD-LINE07  AFTER 6.                        
           WRITE P493G-PRTREC FROM PECD-NOTE-LINE10C AFTER 4.                   
           WRITE P493G-PRTREC FROM PECD-FT-OIC       AFTER 22.                  
                                                                                
      * BP13FE                                                                  
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493G-PRTREC.                           
           MOVE  DJDE-LINE-FE-PAGE3  TO P493G-PRTREC.                           
           WRITE P493G-PRTREC     AFTER PAGE.                                   
           MOVE  SPACES              TO P493G-PRTREC.                           
           WRITE P493G-PRTREC     AFTER 5.                                      
                                                                                
      * FILE COPY                                                               
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493H-PRTREC.                           
           MOVE  DJDE-LINE-28-PAGE1  TO P493H-PRTREC.                           
           WRITE P493H-PRTREC     AFTER PAGE.                                   
                                                                                
           WRITE P493H-PRTREC FROM P493-LINE01-A.                               
           WRITE P493H-PRTREC FROM P493-LINE02-A.                               
           WRITE P493H-PRTREC FROM P493-LINE03-A.                               
                                                                                
           WRITE P493H-PRTREC FROM P493-LINE04 AFTER 4.                         
           WRITE P493H-PRTREC FROM P493-LINE04B.                                
           WRITE P493H-PRTREC FROM P493-LINE04C.                                
           WRITE P493H-PRTREC FROM P493-LINE04D.                                
                                                                                
           WRITE P493H-PRTREC FROM P493-LINE05.                                 
           WRITE P493H-PRTREC FROM P493-LINE05B.                                
           WRITE P493H-PRTREC FROM P493-LINE05C.                                
           WRITE P493H-PRTREC FROM PECD-LINE06 AFTER 2.                         
                                                                                
      *    WRITE P493H-PRTREC FROM PECD-LINE07A AFTER 4.                        
           WRITE P493H-PRTREC FROM PECD-LINE07  AFTER 6.                        
           WRITE P493H-PRTREC FROM PECD-NOTE-LINE10C AFTER 4.                   
           WRITE P493H-PRTREC FROM PECD-FT-OIC       AFTER 22.                  
                                                                                
      * BP13FE                                                                  
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493H-PRTREC.                           
           MOVE  DJDE-LINE-FE-PAGE3  TO P493H-PRTREC.                           
           WRITE P493H-PRTREC     AFTER PAGE.                                   
           MOVE  SPACES              TO P493H-PRTREC.                           
           WRITE P493H-PRTREC     AFTER 5.                                      
                                                                                
       3103-EXIT.                                                               
            EXIT.                                                               
                                                                                
       3104-PRINT-LETTER.                                                       
      *-------------------------------------------------------------            
                                                                                
      * FORM: BP1329                                                            
      * LETTER TO BE SENT OUT FOR MONTHLY                                       
      *-------------------------------------------------------------            
           ADD   1                   TO WS-BP1329-CTR.                          
           MOVE  SPACES              TO P493I-PRTREC.                           
           MOVE  WS-BP1328-CTR       TO WS-RECORD-CNT.                          
           MOVE  WS-RECORD-CNT       TO DJDE-LINE-29-PAGE1(49:4).               
           MOVE  DJDE-LINE-29-PAGE1  TO P493I-PRTREC.                           
           WRITE P493I-PRTREC     AFTER PAGE.                                   
                                                                                
           ADD   1                   TO WS-CNT-LETTER.                          
           WRITE P493I-PRTREC FROM P493-LINE01-A.                               
           WRITE P493I-PRTREC FROM P493-LINE02-A.                               
           WRITE P493I-PRTREC FROM P493-LINE03-A.                               
                                                                                
           WRITE P493I-PRTREC FROM P493-LINE04 AFTER 4.                         
           WRITE P493I-PRTREC FROM P493-LINE04B.                                
           WRITE P493I-PRTREC FROM P493-LINE04C.                                
           WRITE P493I-PRTREC FROM P493-LINE04D.                                
                                                                                
           WRITE P493I-PRTREC FROM P493-LINE05.                                 
           WRITE P493I-PRTREC FROM P493-LINE05B.                                
           WRITE P493I-PRTREC FROM P493-LINE05C.                                
           WRITE P493I-PRTREC FROM PECD-LINE06 AFTER 2.                         
                                                                                
      *    WRITE P493I-PRTREC FROM PECD-LINE07A AFTER 4.                        
           WRITE P493I-PRTREC FROM PECD-LINE07  AFTER 6.                        
           WRITE P493I-PRTREC FROM PECD-NOTE-LINE10C AFTER 4.                   
           WRITE P493I-PRTREC FROM PECD-FT-OIC       AFTER 22.                  
                                                                                
      * BP13FE                                                                  
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493I-PRTREC.                           
           MOVE  DJDE-LINE-FE-PAGE3  TO P493I-PRTREC.                           
           WRITE P493I-PRTREC     AFTER PAGE.                                   
           MOVE  SPACES              TO P493I-PRTREC.                           
           WRITE P493I-PRTREC     AFTER 5.                                      
                                                                                
      * FILE COPY                                                               
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493J-PRTREC.                           
           MOVE  DJDE-LINE-29-PAGE1  TO P493J-PRTREC.                           
           WRITE P493J-PRTREC     AFTER PAGE.                                   
                                                                                
           WRITE P493J-PRTREC FROM P493-LINE01-A.                               
           WRITE P493J-PRTREC FROM P493-LINE02-A.                               
           WRITE P493J-PRTREC FROM P493-LINE03-A.                               
                                                                                
           WRITE P493J-PRTREC FROM P493-LINE04 AFTER 4.                         
           WRITE P493J-PRTREC FROM P493-LINE04B.                                
           WRITE P493J-PRTREC FROM P493-LINE04C.                                
           WRITE P493J-PRTREC FROM P493-LINE04D.                                
                                                                                
           WRITE P493J-PRTREC FROM P493-LINE05.                                 
           WRITE P493J-PRTREC FROM P493-LINE05B.                                
           WRITE P493J-PRTREC FROM P493-LINE05C.                                
           WRITE P493J-PRTREC FROM PECD-LINE06 AFTER 2.                         
                                                                                
      *    WRITE P493J-PRTREC FROM PECD-LINE07A AFTER 4.                        
           WRITE P493J-PRTREC FROM PECD-LINE07  AFTER 6.                        
           WRITE P493J-PRTREC FROM PECD-NOTE-LINE10C AFTER 4.                   
           WRITE P493J-PRTREC FROM PECD-FT-OIC       AFTER 22.                  
                                                                                
      * BP13FE                                                                  
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493J-PRTREC.                           
           MOVE  DJDE-LINE-FE-PAGE3  TO P493J-PRTREC.                           
           WRITE P493J-PRTREC     AFTER PAGE.                                   
           MOVE  SPACES              TO P493J-PRTREC.                           
           WRITE P493J-PRTREC     AFTER 5.                                      
                                                                                
       3104-EXIT.                                                               
            EXIT.                                                               
                                                                                
       3105-PRINT-LETTER.                                                       
      *-------------------------------------------------------------            
                                                                                
      * FORM: BP1382                                                            
      * LETTER TO BE SENT OUT FOR MONTHLY                                       
      *-------------------------------------------------------------            
           ADD   1                   TO WS-BP1382-CTR.                          
           MOVE  SPACES              TO P493K-PRTREC.                           
           MOVE  WS-BP1382-CTR       TO WS-RECORD-CNT.                          
           MOVE  WS-RECORD-CNT       TO DJDE-LINE-82-PAGE1(49:4).               
           MOVE  DJDE-LINE-82-PAGE1  TO P493K-PRTREC.                           
           WRITE P493K-PRTREC     AFTER PAGE.                                   
                                                                                
           ADD   1                   TO WS-CNT-LETTER.                          
           WRITE P493K-PRTREC FROM P493-LINE01-A.                               
           WRITE P493K-PRTREC FROM P493-LINE02-A.                               
           WRITE P493K-PRTREC FROM P493-LINE03-A.                               
                                                                                
           WRITE P493K-PRTREC FROM P493-LINE04 AFTER 4.                         
           WRITE P493K-PRTREC FROM P493-LINE04B.                                
           WRITE P493K-PRTREC FROM P493-LINE04C.                                
           WRITE P493K-PRTREC FROM P493-LINE04D.                                
                                                                                
           WRITE P493K-PRTREC FROM P493-LINE05.                                 
           WRITE P493K-PRTREC FROM P493-LINE05B.                                
           WRITE P493K-PRTREC FROM P493-LINE05C.                                
           WRITE P493K-PRTREC FROM PECD-LINE06 AFTER 2.                         
                                                                                
      *    WRITE P493K-PRTREC FROM PECD-LINE07A AFTER 4.                        
           WRITE P493K-PRTREC FROM PECD-LINE07  AFTER 6.                        
           WRITE P493K-PRTREC FROM PECD-NOTE-LINE10D AFTER 4.                   
           WRITE P493K-PRTREC FROM PECD-FT-OIC       AFTER 22.                  
                                                                                
      * FILE COPY                                                               
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493L-PRTREC.                           
           MOVE  DJDE-LINE-82-PAGE1  TO P493L-PRTREC.                           
           WRITE P493L-PRTREC     AFTER PAGE.                                   
                                                                                
           WRITE P493L-PRTREC FROM P493-LINE01-A.                               
           WRITE P493L-PRTREC FROM P493-LINE02-A.                               
           WRITE P493L-PRTREC FROM P493-LINE03-A.                               
                                                                                
           WRITE P493L-PRTREC FROM P493-LINE04 AFTER 4.                         
           WRITE P493L-PRTREC FROM P493-LINE04B.                                
           WRITE P493L-PRTREC FROM P493-LINE04C.                                
           WRITE P493L-PRTREC FROM P493-LINE04D.                                
                                                                                
           WRITE P493L-PRTREC FROM P493-LINE05.                                 
           WRITE P493L-PRTREC FROM P493-LINE05B.                                
           WRITE P493L-PRTREC FROM P493-LINE05C.                                
           WRITE P493L-PRTREC FROM PECD-LINE06 AFTER 2.                         
                                                                                
      *    WRITE P493L-PRTREC FROM PECD-LINE07A AFTER 4.                        
           WRITE P493L-PRTREC FROM PECD-LINE07  AFTER 6.                        
           WRITE P493L-PRTREC FROM PECD-NOTE-LINE10D AFTER 4.                   
           WRITE P493L-PRTREC FROM PECD-FT-OIC       AFTER 22.                  
                                                                                
                                                                                
       3105-EXIT.                                                               
            EXIT.                                                               
                                                                                
       3106-PRINT-LETTER.                                                       
      *-------------------------------------------------------------            
                                                                                
      * FORM: BP1381                                                            
      * LETTER TO BE SENT OUT FOR MONTHLY                                       
      *-------------------------------------------------------------            
           ADD   1                   TO WS-BP1381-CTR.                          
           MOVE  SPACES              TO P493M-PRTREC.                           
           MOVE  WS-BP1381-CTR       TO WS-RECORD-CNT.                          
           MOVE  WS-RECORD-CNT       TO DJDE-LINE-81-PAGE1(49:4).               
           MOVE  DJDE-LINE-81-PAGE1  TO P493M-PRTREC.                           
           WRITE P493M-PRTREC     AFTER PAGE.                                   
                                                                                
           ADD   1                   TO WS-CNT-LETTER.                          
           WRITE P493M-PRTREC FROM P493-LINE01-A.                               
           WRITE P493M-PRTREC FROM P493-LINE02-A.                               
           WRITE P493M-PRTREC FROM P493-LINE03-A.                               
                                                                                
           WRITE P493M-PRTREC FROM P493-LINE04 AFTER 4.                         
           WRITE P493M-PRTREC FROM P493-LINE04B.                                
           WRITE P493M-PRTREC FROM P493-LINE04C.                                
           WRITE P493M-PRTREC FROM P493-LINE04D.                                
                                                                                
           WRITE P493M-PRTREC FROM P493-LINE05.                                 
           WRITE P493M-PRTREC FROM P493-LINE05B.                                
           WRITE P493M-PRTREC FROM P493-LINE05C.                                
           WRITE P493M-PRTREC FROM PECD-LINE06 AFTER 2.                         
                                                                                
      *    WRITE P493M-PRTREC FROM PECD-LINE07A AFTER 4.                        
           WRITE P493M-PRTREC FROM PECD-LINE07  AFTER 6.                        
           WRITE P493M-PRTREC FROM PECD-NOTE-LINE10D AFTER 4.                   
           WRITE P493M-PRTREC FROM PECD-FT-OIC       AFTER 22.                  
                                                                                
      * FILE COPY                                                               
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493N-PRTREC.                           
           MOVE  DJDE-LINE-81-PAGE1  TO P493N-PRTREC.                           
           WRITE P493N-PRTREC     AFTER PAGE.                                   
                                                                                
           WRITE P493N-PRTREC FROM P493-LINE01-A.                               
           WRITE P493N-PRTREC FROM P493-LINE02-A.                               
           WRITE P493N-PRTREC FROM P493-LINE03-A.                               
                                                                                
           WRITE P493N-PRTREC FROM P493-LINE04 AFTER 4.                         
           WRITE P493N-PRTREC FROM P493-LINE04B.                                
           WRITE P493N-PRTREC FROM P493-LINE04C.                                
           WRITE P493N-PRTREC FROM P493-LINE04D.                                
                                                                                
           WRITE P493N-PRTREC FROM P493-LINE05.                                 
           WRITE P493N-PRTREC FROM P493-LINE05B.                                
           WRITE P493N-PRTREC FROM P493-LINE05C.                                
           WRITE P493N-PRTREC FROM PECD-LINE06 AFTER 2.                         
                                                                                
      *    WRITE P493N-PRTREC FROM PECD-LINE07A AFTER 4.                        
           WRITE P493N-PRTREC FROM PECD-LINE07  AFTER 6.                        
           WRITE P493N-PRTREC FROM PECD-NOTE-LINE10D AFTER 4.                   
           WRITE P493N-PRTREC FROM PECD-FT-OIC       AFTER 22.                  
                                                                                
                                                                                
       3106-EXIT.                                                               
            EXIT.                                                               
                                                                                
       3107-PRINT-LETTER.                                                       
      *-------------------------------------------------------------            
                                                                                
      * FORM: BP1383 AND BP1384                                                 
      * LETTER TO BE SENT OUT FOR MONTHLY                                       
      *-------------------------------------------------------------            
           ADD   1                   TO WS-BP1383-CTR.                          
           MOVE  SPACES              TO P493O-PRTREC.                           
           MOVE  WS-BP1383-CTR       TO WS-RECORD-CNT.                          
           MOVE  WS-RECORD-CNT       TO DJDE-LINE-83-PAGE1(49:4).               
           MOVE  DJDE-LINE-83-PAGE1  TO P493O-PRTREC.                           
           WRITE P493O-PRTREC     AFTER PAGE.                                   
                                                                                
           ADD   1                   TO WS-CNT-LETTER.                          
           WRITE P493O-PRTREC FROM P493-LINE01-A.                               
           WRITE P493O-PRTREC FROM P493-LINE02-A.                               
           WRITE P493O-PRTREC FROM P493-LINE03-A.                               
                                                                                
           WRITE P493O-PRTREC FROM P493-LINE04 AFTER 4.                         
           WRITE P493O-PRTREC FROM P493-LINE04B.                                
           WRITE P493O-PRTREC FROM P493-LINE04C.                                
           WRITE P493O-PRTREC FROM P493-LINE04D.                                
                                                                                
           WRITE P493O-PRTREC FROM P493-LINE05.                                 
           WRITE P493O-PRTREC FROM P493-LINE05B.                                
           WRITE P493O-PRTREC FROM P493-LINE05C.                                
           WRITE P493O-PRTREC FROM PECD-LINE06 AFTER 2.                         
                                                                                
      *    WRITE P493O-PRTREC FROM PECD-LINE07A AFTER 4.                        
           WRITE P493O-PRTREC FROM PECD-LINE07  AFTER 6.                        
           WRITE P493O-PRTREC FROM PECD-NOTE-LINE10B AFTER 6.                   
                                                                                
      * BP1384                                                                  
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493O-PRTREC.                           
           MOVE  DJDE-LINE-84-PAGE1  TO P493O-PRTREC.                           
           WRITE P493O-PRTREC     AFTER PAGE.                                   
           WRITE P493O-PRTREC FROM PECD-FT-OIC       AFTER 29.                  
                                                                                
      * FILE COPY                                                               
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493P-PRTREC.                           
           MOVE  DJDE-LINE-83-PAGE1  TO P493P-PRTREC.                           
           WRITE P493P-PRTREC     AFTER PAGE.                                   
                                                                                
           WRITE P493P-PRTREC FROM P493-LINE01-A.                               
           WRITE P493P-PRTREC FROM P493-LINE02-A.                               
           WRITE P493P-PRTREC FROM P493-LINE03-A.                               
                                                                                
           WRITE P493P-PRTREC FROM P493-LINE04 AFTER 4.                         
           WRITE P493P-PRTREC FROM P493-LINE04B.                                
           WRITE P493P-PRTREC FROM P493-LINE04C.                                
           WRITE P493P-PRTREC FROM P493-LINE04D.                                
                                                                                
           WRITE P493P-PRTREC FROM P493-LINE05.                                 
           WRITE P493P-PRTREC FROM P493-LINE05B.                                
           WRITE P493P-PRTREC FROM P493-LINE05C.                                
           WRITE P493P-PRTREC FROM PECD-LINE06 AFTER 2.                         
                                                                                
      *    WRITE P493P-PRTREC FROM PECD-LINE07A AFTER 4.                        
           WRITE P493P-PRTREC FROM PECD-LINE07  AFTER 6.                        
           WRITE P493P-PRTREC FROM PECD-NOTE-LINE10B AFTER 6.                   
                                                                                
      * BP1384                                                                  
      *-------------------------------------------------------------            
           MOVE  SPACES              TO P493P-PRTREC.                           
           MOVE  DJDE-LINE-84-PAGE1  TO P493P-PRTREC.                           
           WRITE P493P-PRTREC     AFTER PAGE.                                   
           WRITE P493P-PRTREC FROM PECD-FT-OIC       AFTER 29.                  
                                                                                
                                                                                
       3107-EXIT.                                                               
            EXIT.                                                               
                                                                                
       3200-PRINT-AUDIT.                                                        
      *-------------------------------------------------------------            
           IF WS-LINE-CNT > 55                                                  
           OR WS-PREV-BLK-NO NOT = F110-BLK-NO                                  
              PERFORM 6000-PRINT-HEADING THRU 6000-EXIT                         
           END-IF.                                                              
                                                                                
           ADD 2                TO WS-LINE-CNT.                                 
           ADD 1                TO WS-BLK-CNT.                                  
                                                                                
           MOVE SPACES          TO L493-PRTREC.                                 
           MOVE WS-BLK-CNT      TO L493-NO.                                     
           STRING F110-SCHEME '-' F110-ACC '-' F110-CHK '-'                     
                  F110-ACC-TYPE                                                 
                  DELIMITED BY SIZE INTO L493-SCH-ACC.                          
                                                                                
           MOVE F110-REGN-NO    TO L493-REGN-NO.                                
                                                                                
           PERFORM VARYING WS-IDX FROM 1 BY 1                                   
             UNTIL WS-NAME(WS-IDX) NOT = SPACES                                 
                OR WS-IDX > 4                                                   
              CONTINUE                                                          
           END-PERFORM.                                                         
                                                                                
           IF WS-IDX > 4                                                        
              MOVE 1            TO WS-IDX                                       
           END-IF.                                                              
           MOVE WS-NAME(WS-IDX) TO L493-NAME.                                   
           MOVE K800-NUM-NRIC1  TO L493-NRIC-NO.                                
           MOVE P493-BLK        TO L493-BLK-NO.                                 
           MOVE P493-STREET     TO L493-STREET.                                 
           MOVE P493-FLAT-NO    TO L493-FLAT-NO.                                
           MOVE P493-POSTAL     TO L493-POSTAL-CODE.                            
                                                                                
           WRITE L493-PRTREC FROM L493-DETAIL AFTER 2.                          
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
       3300-PRINT-AUDIT-SMS.                                                    
      *-------------------------------------------------------------            
           IF WS-LINE-CNT-A > 55                                                
              PERFORM 6001-PRINT-HEADING-EMAIL THRU 6001-EXIT                   
           END-IF.                                                              
                                                                                
           ADD 2                TO WS-LINE-CNT-A.                               
                                                                                
           MOVE SPACES          TO L493A-PRTREC.                                
                                                                                
           ADD 1                TO WS-TOTAL-CNT-A                               
                                   WS-FOR-SMS.                                  
           MOVE WS-TOTAL-CNT-A  TO L493A-NO.                                    
                                                                                
           STRING F110-SCHEME '-' F110-ACC '-' F110-CHK '-'                     
                  F110-ACC-TYPE                                                 
                  DELIMITED BY SIZE INTO L493A-SCH-ACC.                         
                                                                                
           MOVE F110-REGN-NO    TO L493A-REGN-NO.                               
                                                                                
           MOVE WS-NAME-EMAIL   TO L493A-NAME.                                  
           MOVE K800-NUM-NRIC1  TO L493A-NRIC-NO.                               
                                                                                
           MOVE COMM8-NUM-LEVEL          TO  L493A-LVL-NO                       
           MOVE COMM8-NUM-UNIT-MAIN      TO  L493A-UNIT-NO                      
           MOVE COMM8-NUM-BLK            TO  L493A-BLOCK.                       
           MOVE COMM8-NME-STREET         TO  L493A-STREET-NAME.                 
           MOVE COMM8-NUM-POSTAL-CODE    TO  L493A-POSTAL-CODE                  
                                                                                
           WRITE L493A-PRTREC FROM L493A-DETAIL AFTER 2.                        
                                                                                
       3300-EXIT.                                                               
            EXIT.                                                               
                                                                                
       4000-READ-K857.                                                          
      *-------------------------------------------------------------            
           MOVE SPACES         TO BP13K857-REC.                                 
           MOVE 'N'            TO WS-FOUND-K857.                                
           MOVE F110-REGN-NO   TO K857-NUM-REGN.                                
           READ BP13K857.                                                       
                                                                                
           IF K857-STATUS = 00                                                  
              IF K857-NUM-EMAIL NOT = SPACES AND LOW-VALUES                     
                 MOVE 'Y'  TO WS-FOUND-K857                                     
                 ADD 1 TO WS-CNT-K857-W-EMAIL                                   
              ELSE                                                              
                 MOVE 'N'  TO WS-FOUND-K857                                     
              END-IF                                                            
           ELSE                                                                 
           IF K857-STATUS = 23                                                  
              MOVE 'N'  TO WS-FOUND-K857                                        
              DISPLAY '> NOT FOUND K857 FOR '                                   
                      K857-NUM-REGN                                             
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K857, STATUS ' K857-STATUS             
              MOVE K857-STATUS TO RETURN-CODE                                   
              PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT.                         
                                                                                
       4000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
                                                                                
       5000-RETRIEVE-CSM.                                                       
      *-------------------------------------------------------------            
           MOVE K800-NUM-REGN TO K022-NUM-REGN.                                 
           READ BP13K022 KEY IS K022-NUM-REGN.                                  
                                                                                
           IF K022-STATUS = 00                                                  
              MOVE K022-NUM-OIC TO K024-NUM-OIC                                 
              PERFORM 5100-READ-BP13K024 THRU 5100-EXIT                         
           ELSE                                                                 
           IF K022-STATUS = 23                                                  
              DISPLAY '> CSM FOR ' K022-NUM-REGN ' NOT FOUND.'                  
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K022, STATUS ' K022-STATUS             
              MOVE K022-STATUS TO RETURN-CODE                                   
              PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT.                         
                                                                                
       5000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       5100-READ-BP13K024.                                                      
      *-------------------------------------------------------------            
           READ BP13K024 KEY IS K024-KEY-FLD.                                   
                                                                                
           IF K024-STATUS = 00                                                  
              MOVE K024-NME-OIC TO P493-NME-OIC                                 
              MOVE K024-NUM-DID TO P493-OIC-TEL                                 
                                   P493-OIC-TEL-A                               
           ELSE                                                                 
           IF K024-STATUS = 23                                                  
              DISPLAY '> CSM DETAIL OF ' K024-NUM-OIC ' FOR '                   
                      K022-NUM-REGN ' NOT FOUND.'                               
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K024, STATUS ' K024-STATUS             
              MOVE K024-STATUS TO RETURN-CODE                                   
              PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT.                         
                                                                                
       5100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       6000-PRINT-HEADING.                                                      
      *-------------------------------------------------------------            
           ADD  1                    TO WS-PAGE-CNT.                            
           MOVE WS-PAGE-CNT          TO L493-PAGE.                              
           MOVE F110-BLK-NO          TO L493-BLOCK.                             
           MOVE COMM8-NME-STREET     TO L493-STREET-NAME.                       
                                                                                
           MOVE  8                   TO WS-LINE-CNT.                            
                                                                                
           IF WS-PREV-BLK-NO  NOT = F110-BLK-NO                                 
              ADD WS-BLK-CNT         TO WS-TOTAL-CNT                            
              INITIALIZE                WS-BLK-CNT                              
           END-IF.                                                              
           MOVE F110-BLK-NO          TO WS-PREV-BLK-NO.                         
                                                                                
           MOVE SPACES               TO L493-PRTREC.                            
           WRITE L493-PRTREC         FROM L493-HDR01 AFTER PAGE.                
           WRITE L493-PRTREC         FROM L493-HDR02.                           
           WRITE L493-PRTREC         FROM L493-HDR03 AFTER 2.                   
           WRITE L493-PRTREC         FROM L493-HDR04 AFTER 2.                   
           MOVE ALL         '='      TO L493-PRTREC.                            
           WRITE L493-PRTREC            AFTER 1.                                
                                                                                
       6000-EXIT.                                                               
            EXIT.                                                               
       6001-PRINT-HEADING-EMAIL.                                                
      *-------------------------------------------------------------            
           ADD  1                    TO WS-PAGE-CNT-A.                          
           MOVE WS-PAGE-CNT-A        TO L493A-PAGE.                             
                                                                                
           MOVE  8                   TO WS-LINE-CNT-A.                          
                                                                                
           MOVE SPACES               TO L493A-PRTREC.                           
           WRITE L493A-PRTREC         FROM L493A-HDR01 AFTER PAGE.              
           WRITE L493A-PRTREC         FROM L493A-HDR02.                         
           WRITE L493A-PRTREC         FROM L493A-HDR04 AFTER 2.                 
           MOVE ALL '='              TO L493A-PRTREC.                           
           WRITE L493A-PRTREC            AFTER 1.                               
                                                                                
       6001-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      *-------------------------------------------------------------            
       6500-CALL-AV02C015.                                                      
      *-------------------------------------------------------------            
           CALL 'AV02C015'          USING                                       
                                    AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM.               
       6500-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
       8100-READ-K800.                                                          
      *-------------------------------------------------------------            
           READ BP13K800 KEY IS K800-NUM-REGN.                                  
                                                                                
           EVALUATE K800-STATUS                                                 
               WHEN 00                                                          
               WHEN 02                                                          
                    CONTINUE                                                    
               WHEN 10                                                          
               WHEN 23                                                          
                    ADD  1                  TO WS-CNT-K800-MISS                 
                    DISPLAY 'K800 REC NOT FOUND : ' F110-REGN-NO                
                            ' ; ' F110-SCH-ACC-NO                               
                    SET WS-ERROR            TO TRUE                             
                    GO TO 8100-EXIT                                             
               WHEN OTHER                                                       
                    MOVE K800-STATUS              TO RETURN-CODE                
                    DISPLAY 'ERROR READING BP13K800, STATUS '                   
                             K800-STATUS                                        
                    PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       8100-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       8200-READ-K820.                                                          
      *-------------------------------------------------------------            
           READ BP13K820 KEY IS K820-KEY-FLD.                                   
                                                                                
           EVALUATE K820-STATUS                                                 
               WHEN 00                                                          
               WHEN 02                                                          
                    CONTINUE                                                    
               WHEN 10                                                          
               WHEN 23                                                          
                    MOVE SPACES             TO K820-NME-OCCP                    
                    ADD  1                  TO WS-CNT-K820-MISS                 
                    DISPLAY 'K820 REC NOT FOUND : ' K800-NUM-REGN               
                    GO TO 8200-EXIT                                             
               WHEN OTHER                                                       
                    MOVE K820-STATUS              TO RETURN-CODE                
                    DISPLAY 'ERROR READING BP13K820, STATUS '                   
                             K820-STATUS                                        
                    PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       8200-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       8300-READ-K830.                                                          
      *-------------------------------------------------------------            
           READ BP13K830 KEY IS K830-NUM-REGN.                                  
                                                                                
           EVALUATE K830-STATUS                                                 
               WHEN 00                                                          
               WHEN 02                                                          
                    CONTINUE                                                    
               WHEN 10                                                          
               WHEN 23                                                          
                    MOVE SPACES             TO BP13K830-REC                     
                    ADD  1                  TO WS-CNT-K830-MISS                 
                    DISPLAY 'REGN-NUM' K830-NUM-REGN                            
                    DISPLAY 'K830 REC NOT FOUND : ' K800-NUM-NRIC1              
                                                    K800-NUM-NRIC2              
                    SET WS-ERROR            TO TRUE                             
                    GO TO 8300-EXIT                                             
               WHEN OTHER                                                       
                    MOVE K830-STATUS              TO RETURN-CODE                
                    DISPLAY 'ERROR READING BP13K830, STATUS '                   
                             K830-STATUS                                        
                    PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       8300-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       8400-READ-K510.                                                          
      *-------------------------------------------------------------            
                                                                                
           READ BM06K510 KEY IS K510-ESTCDE.                                    
                                                                                
           EVALUATE K510-STATUS                                                 
               WHEN 00                                                          
               WHEN 02                                                          
                    MOVE K510-NT-NAME   TO  P493-NEWTOWN                        
                                            P493-NEWTOWN2                       
                    CONTINUE                                                    
               WHEN 10                                                          
               WHEN 23                                                          
                    ADD  1                  TO WS-CNT-K510-MISS                 
                    DISPLAY 'K510 REC NOT FOUND : ' K510-ESTCDE                 
                    GO TO 8400-EXIT                                             
               WHEN OTHER                                                       
                    MOVE K510-STATUS              TO RETURN-CODE                
                    DISPLAY 'ERROR READING BM06K510, STATUS '                   
                             K510-STATUS                                        
                    PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       8400-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       8500-READ-K100.                                                          
      *-------------------------------------------------------------            
                                                                                
           READ BM06K100 KEY IS K100-KEY-FLD.                                   
                                                                                
           EVALUATE K820-STATUS                                                 
               WHEN 00                                                          
               WHEN 02                                                          
                    CONTINUE                                                    
               WHEN 10                                                          
               WHEN 23                                                          
                    ADD  1                  TO WS-CNT-K100-MISS                 
                    DISPLAY 'K100 REC NOT FOUND : ' K100-KEY-FLD                
                    GO TO 8500-EXIT                                             
               WHEN OTHER                                                       
                    MOVE K100-STATUS              TO RETURN-CODE                
                    DISPLAY 'ERROR READING BM06K100, STATUS '                   
                             K100-STATUS                                        
                    PERFORM 9900-HANDLE-ABEND THRU 9900-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       8500-EXIT.                                                               
            EXIT.                                                               
                                                                                
       8600-PRINT-LISTING.                                                      
      *-------------------------------------------------------------            
           IF WS-LINE-CNT-B > 55                                                
              PERFORM 8601-PRINT-HEADING       THRU 8601-EXIT                   
           END-IF.                                                              
                                                                                
           ADD 2                TO WS-LINE-CNT-B.                               
                                                                                
           MOVE SPACES          TO 493L-PRTREC.                                 
                                                                                
           ADD 1                TO WS-TOTAL-CNT-B                               
                                                                                
           MOVE WS-TOTAL-CNT-B  TO 493L-SNO.                                    
                                                                                
           MOVE F110-REGN-NO    TO 493L-REGN-NO.                                
           MOVE K857-NUM-EMAIL  TO 493L-EMAIL                                   
           MOVE WS-HP           TO 493L-HP.                                     
           IF KH55-TAG-FORM = SPACES OR LOW-VALUES                              
              MOVE K491-TAG-FORM TO 493L-TAG-FORM                               
           ELSE                                                                 
              MOVE KH55-TAG-FORM   TO 493L-TAG-FORM                             
           END-IF.                                                              
           EVALUATE KH55-TAG-FORM                                               
             WHEN 'H'                                                           
                MOVE 'BP1328'        TO 493L-FORM                               
             WHEN 'Y'                                                           
                MOVE 'BP1329'        TO 493L-FORM                               
             WHEN 'F'                                                           
                MOVE 'BP13FK'        TO 493L-FORM                               
             WHEN 'I'                                                           
                MOVE 'BP1382'        TO 493L-FORM                               
             WHEN 'J'                                                           
                MOVE 'BP1381'        TO 493L-FORM                               
             WHEN 'K'                                                           
                MOVE 'BP1383'        TO 493L-FORM                               
             WHEN 'L'                                                           
                MOVE 'BP13TH'        TO 493L-FORM                               
             WHEN OTHER                                                         
                MOVE SPACES          TO 493L-FORM                               
           END-EVALUATE.                                                        
                                                                                
           WRITE 493L-PRTREC FROM 493L-DETAIL AFTER 2.                          
                                                                                
       8600-EXIT.                                                               
            EXIT.                                                               
                                                                                
       8601-PRINT-HEADING.                                                      
      *-------------------------------------------------------------            
           ADD  1                    TO WS-PAGE-CNT-B.                          
           MOVE WS-PAGE-CNT-B        TO 493L-PAGE.                              
                                                                                
           STRING WS-DATE(7:2) '/' WS-DATE(5:2) '/' WS-DATE(1:4)                
                   DELIMITED BY SIZE INTO 493L-DATE.                            
                                                                                
           MOVE  8                   TO WS-LINE-CNT-B.                          
                                                                                
                                                                                
           WRITE 493L-PRTREC         FROM 493L-HDR01 AFTER PAGE.                
           WRITE 493L-PRTREC         FROM 493L-HDR02 AFTER 1.                   
           WRITE 493L-PRTREC         FROM 493L-HDR03.                           
           MOVE ALL         '='      TO 493L-PRTREC.                            
           WRITE 493L-PRTREC            AFTER 1.                                
           MOVE SPACES               TO 493L-PRTREC.                            
                                                                                
       8601-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *****************************************************************         
       8900-CREATE-FIOMS-REC.                                                   
      *****************************************************************         
                                                                                
           PERFORM 8910-WRITE-BP13FH10 THRU 8910-EXIT.                          
                                                                                
      * FTP                                                                     
           WRITE BP13FTP-REC FROM WS-FTP-LINE1.                                 
           WRITE BP13FTP-REC FROM WS-FTP-LINE2.                                 
           WRITE BP13FTP-REC FROM WS-FTP-LINE3.                                 
           ADD 3                       TO WS-FTP-WRITE.                         
                                                                                
           MOVE 'BP13CD'               TO WS-FTP-DESC.                          
           PERFORM 8920-WRITE-BP13FTP-SRC THRU 8920-EXIT.                       
           WRITE BP13FTP-REC FROM WS-FTP-LINE5.                                 
           WRITE BP13FTP-REC FROM WS-FTP-LINE6.                                 
           ADD 2                       TO WS-FTP-WRITE.                         
                                                                                
                                                                                
       8900-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8910-WRITE-BP13FH10.                                                     
      *****************************************************************         
                                                                                
           MOVE 'EASSSS3I'             TO WS-GROUP-ID.                          
           MOVE 'S'                    TO WS-PRINT-SETTING.                     
           MOVE WS-HC493-WRITE         TO WS-P13FT10A-WRITE.                    
           PERFORM 8915-POPULATE-FH10A THRU 8915-EXIT.                          
           WRITE P13HC493-REC FROM WS-P13FH10A-REC.                             
           WRITE P13HC493-REC FROM WS-P13FT10A-REC.                             
           ADD 2                       TO WS-FH10-WRITE.                        
                                                                                
                                                                                
       8910-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8915-POPULATE-FH10A.                                                     
      *****************************************************************         
                                                                                
      * H10                                                                     
           MOVE SPACES                 TO WS-P13FH10A-REC.                      
           INITIALIZE WS-P13FH10A-REC.                                          
                                                                                
           MOVE 'H10'                  TO WS-FH10-RECORD-TYPE.                  
           MOVE WS-PARM-JOBNAME        TO WS-FH10-JOBNAME.                      
           MOVE WS-UPD-TMESTAMP(1:14)  TO WS-FH10-JOBDATE.                      
           MOVE 'BP13W009'             TO WS-FH10-WFD-ID.                       
           MOVE 'Y'                    TO WS-FH10-OUTPUT-PRINT.                 
           MOVE WS-GROUP-ID            TO WS-FH10-GROUP-ID.                     
                                                                                
      * FEEDBACK FROM MOOI ON 18/5/2017                                         
      * IOMS NOT CATER FOR THE PRINTING OF 2 COPIES                             
      * USING PROGRAM TO TRIGGER TWICE INSTEAD                                  
      *    MOVE 2                      TO WS-FH10-COPIES.                       
      *                                                                         
           MOVE 1                      TO WS-FH10-COPIES.                       
           MOVE 'B'                    TO WS-FH10-COLOUR.                       
           MOVE 'A4W'                  TO WS-FH10-PAPER-TYPE.                   
           MOVE WS-PRINT-SETTING       TO WS-FH10-PRINT-SETTING.                
           MOVE 'N'                    TO WS-FH10-AMIS                          
                                          WS-FH10-OMR                           
                                          WS-FH10-OUTPUT-FILING                 
                                          WS-FH10-OUTPUT-ONEINBOX               
                                          WS-FH10-OUTPUT-SMS                    
                                          WS-FH10-OUTPUT-EMAIL                  
                                          WS-FH10-OUTPUT-FAX.                   
                                                                                
      * T10                                                                     
           MOVE SPACES                 TO WS-P13FT10A-REC.                      
           INITIALIZE WS-P13FT10A-REC.                                          
                                                                                
           MOVE 'T10'                  TO WS-FT10-RECORD-TYPE.                  
           MOVE WS-P13FT10A-WRITE      TO WS-FT10-TOTAL-ACCOUNTS.               
                                                                                
       8915-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8920-WRITE-BP13FTP-SRC.                                                  
      *****************************************************************         
                                                                                
           MOVE WS-PARM-JOBNAME        TO WS-FTP-JOBNAME.                       
           MOVE WS-UPD-TMESTAMP(1:12)  TO WS-FTP-TMESTAMP.                      
                                                                                
      * B10                                                                     
           MOVE SPACES                 TO  WS-FTP-SOURCE.                       
           STRING "PUT '"                                                       
                  WS-PARM-B10-SOURCE "." WS-FTP-DESC                            
                  "' "                                                          
                  WS-FTP-DEST-REC ".TXT"                                        
              DELIMITED BY '  ' INTO WS-FTP-SOURCE                              
           END-STRING.                                                          
           WRITE BP13FTP-REC FROM WS-FTP-LINE4.                                 
           ADD 1                       TO WS-FTP-WRITE.                         
                                                                                
      * H10                                                                     
           MOVE SPACES                 TO WS-FTP-SOURCE.                        
           STRING "PUT '"                                                       
                  WS-PARM-H10-SOURCE "." WS-FTP-DESC                            
                  "' "                                                          
                  WS-FTP-DEST-REC ".H10"                                        
              DELIMITED BY '  ' INTO WS-FTP-SOURCE                              
           END-STRING.                                                          
           WRITE BP13FTP-REC FROM WS-FTP-LINE4.                                 
           ADD 1                       TO WS-FTP-WRITE.                         
                                                                                
       8920-EXIT.                                                               
           EXIT.                                                                
                                                                                
       9900-HANDLE-ABEND.                                                       
      *-------------------------------------------------------------            
           MOVE  SPACES        TO F205-TOT-PRINT.                               
           MOVE  WS-CNT-LETTER TO F205-TOT-PRINT.                               
           IF WS-F205-READ = 'Y'                                                
              REWRITE F205-REC                                                  
           END-IF.                                                              
                                                                                
           DISPLAY ' '.                                                         
           DISPLAY '- BP13C493 CONTROL TOTAL -------------'.                    
           DISPLAY 'TOTAL BM06F110 RECS READ  = ' WS-CNT-F110-READ.             
           DISPLAY 'TOTAL MISSING K800 REC    = ' WS-CNT-K800-MISS.             
           DISPLAY 'TOTAL MISSING K820 REC    = ' WS-CNT-K820-MISS.             
           DISPLAY 'TOTAL MISSING K830 REC    = ' WS-CNT-K830-MISS.             
           DISPLAY 'TOTAL MISSING K510 REC    = ' WS-CNT-K510-MISS.             
           DISPLAY 'TOTAL MISSING K100 REC    = ' WS-CNT-K100-MISS.             
           DISPLAY ' TOTAL LETTERS PRINTED   : ' WS-CNT-LETTER.                 
           DISPLAY ' TOTAL CASES FOR  EMAIL  : ' WS-CNT-K857-W-EMAIL.           
           DISPLAY ' TOTAL CASES FOR SMS     : ' WS-FOR-SMS.                    
           DISPLAY 'TOTAL CASES WRITEN F493   = ' WS-F493-WRT.                  
           DISPLAY 'TOTAL CASES WRITEN K491   = ' WS-F491-WRT.                  
           DISPLAY ' TOTAL CASES WRITEN KH55 : ' WS-KH55-WRT.                   
           DISPLAY ' TOTAL CASES REWRITEN KH55 : ' WS-KH55-RWRT.                
                                                                                
           CLOSE BP13K022                                                       
                 BP13K024                                                       
                 BP13K800                                                       
                 BP13K820                                                       
                 BP13K830                                                       
                 BP13F205                                                       
                 BM06F110                                                       
                 BP13K491                                                       
                 AB03K030                                                       
                 AB03K080                                                       
                 BP13P493                                                       
                 P13L493A                                                       
                 BP13L493                                                       
                 P13BC493                                                       
                 P13HC493                                                       
                 BP13FTP.                                                       
                                                                                
           IF K022-STATUS NOT = 00 AND 97                                       
              MOVE K022-STATUS TO RETURN-CODE                                   
              DISPLAY 'CLOSE FAILED FOR BP13K022 ' K022-STATUS                  
           END-IF.                                                              
                                                                                
           IF K024-STATUS NOT = 00 AND 97                                       
              MOVE K024-STATUS TO RETURN-CODE                                   
              DISPLAY 'CLOSE FAILED FOR BP13K800 ' K024-STATUS                  
           END-IF.                                                              
                                                                                
           IF K800-STATUS NOT = 00 AND 97                                       
              MOVE K800-STATUS TO RETURN-CODE                                   
              DISPLAY 'CLOSE FAILED FOR BP13K800 ' K800-STATUS                  
           END-IF.                                                              
                                                                                
           IF K820-STATUS NOT = 00 AND 97                                       
              MOVE K820-STATUS TO RETURN-CODE                                   
              DISPLAY 'CLOSE FAILED FOR BP13K820 ' K820-STATUS                  
           END-IF.                                                              
                                                                                
           IF K830-STATUS NOT = 00 AND 97                                       
              MOVE K830-STATUS TO RETURN-CODE                                   
              DISPLAY 'CLOSE FAILED FOR BP13K830 ' K830-STATUS                  
           END-IF.                                                              
                                                                                
           IF K510-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE FAILED FOR BM06K510 ' K510-STATUS                  
              MOVE K510-STATUS TO RETURN-CODE.                                  
                                                                                
           IF K100-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE FAILED FOR BM06K100 ' K100-STATUS                  
              MOVE K100-STATUS TO RETURN-CODE.                                  
                                                                                
           IF K857-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE FAILED FOR BP13K857 ' K857-STATUS                  
              MOVE K857-STATUS TO RETURN-CODE.                                  
                                                                                
           IF K030-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE FAILED FOR AB03K030 ' K030-STATUS                  
              MOVE K030-STATUS TO RETURN-CODE.                                  
                                                                                
           IF K080-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE FAILED FOR AB03K080 ' K080-STATUS                  
              MOVE K080-STATUS TO RETURN-CODE.                                  
                                                                                
           IF K491-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE FAILED FOR BP13K491 ' K491-STATUS                  
              MOVE K491-STATUS TO RETURN-CODE.                                  
                                                                                
           STOP RUN.                                                            
       9900-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       9999-WRAP-UP.                                                            
      *-------------------------------------------------------------            
           ADD WS-BLK-CNT                        TO WS-TOTAL-CNT.               
           MOVE WS-TOTAL-CNT                     TO L493-TOTAL.                 
           WRITE L493-PRTREC FROM L493-PRT-TOTAL AFTER 2.                       
           MOVE  SPACES        TO F205-TOT-PRINT.                               
           MOVE  WS-CNT-LETTER TO F205-TOT-PRINT.                               
           IF WS-F205-READ = 'Y'                                                
              REWRITE F205-REC                                                  
           END-IF.                                                              
                                                                                
           DISPLAY ' '.                                                         
           DISPLAY '- BP13C493 CONTROL TOTAL -------------'.                    
           DISPLAY ' TOTAL BM06F110 REC READ : ' WS-CNT-F110-READ.              
           DISPLAY ' TOTAL MISSING K800 REC  : ' WS-CNT-K800-MISS.              
           DISPLAY ' TOTAL MISSING K820 REC  : ' WS-CNT-K820-MISS.              
           DISPLAY ' TOTAL MISSING K830 REC  : ' WS-CNT-K830-MISS.              
           DISPLAY ' TOTAL MISSING K510 REC  : ' WS-CNT-K510-MISS.              
           DISPLAY ' TOTAL MISSING K100 REC  : ' WS-CNT-K100-MISS.              
           DISPLAY ' TOTAL LETTERS PRINTED   : ' WS-CNT-LETTER.                 
           DISPLAY ' TOTAL CASES FOR  EMAIL  : ' WS-CNT-K857-W-EMAIL.           
           DISPLAY ' TOTAL CASES FOR SMS     : ' WS-FOR-SMS.                    
           DISPLAY ' TOTAL CASES WRITEN F493 : ' WS-F493-WRT.                   
           DISPLAY ' TOTAL CASES WRITEN KH55 : ' WS-KH55-WRT.                   
           DISPLAY ' TOTAL CASES WRITEN K491 : ' WS-F491-WRT.                   
           DISPLAY ' TOTAL CASES REWRITEN KH55 : ' WS-KH55-RWRT.                
                                                                                
           CLOSE BP13K022                                                       
                 BP13KH55                                                       
                 BP13K024                                                       
                 BP13K800                                                       
                 BP13K820                                                       
                 BP13K830                                                       
                 BM06K510                                                       
                 BM06K100                                                       
                 BP13F205                                                       
                 BM06F110                                                       
                 BP13K857                                                       
                 BP13K491                                                       
                 BP13P493                                                       
                 AB03K030                                                       
                 AB03K080                                                       
                 P13P493B                                                       
                 P13L493A                                                       
                 BP13L493                                                       
                 P13BC493                                                       
                 P13HC493                                                       
                 BP13FTP.                                                       
                                                                                
           IF K022-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE FAILED FOR BP13K022 ' K022-STATUS                  
              MOVE K022-STATUS TO RETURN-CODE.                                  
                                                                                
           IF K024-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE FAILED FOR BP13K024 ' K024-STATUS                  
              MOVE K024-STATUS TO RETURN-CODE.                                  
                                                                                
           IF K800-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE FAILED FOR BP13K800 ' K800-STATUS                  
              MOVE K800-STATUS TO RETURN-CODE.                                  
                                                                                
           IF K820-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE FAILED FOR BP13K820 ' K820-STATUS                  
              MOVE K820-STATUS TO RETURN-CODE.                                  
                                                                                
           IF K830-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE FAILED FOR BP13K830 ' K830-STATUS                  
              MOVE K830-STATUS TO RETURN-CODE.                                  
                                                                                
           IF K510-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE FAILED FOR BM06K510 ' K510-STATUS                  
              MOVE K510-STATUS TO RETURN-CODE.                                  
                                                                                
           IF K100-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE FAILED FOR BM06K100 ' K100-STATUS                  
              MOVE K100-STATUS TO RETURN-CODE.                                  
                                                                                
           IF K857-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE FAILED FOR BP13K857 ' K857-STATUS                  
              MOVE K857-STATUS TO RETURN-CODE.                                  
                                                                                
           IF K491-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE FAILED FOR BP13K491 ' K491-STATUS                  
              MOVE K491-STATUS TO RETURN-CODE.                                  
                                                                                
           IF K030-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE FAILED FOR AB03K030 ' K030-STATUS                  
              MOVE K030-STATUS TO RETURN-CODE.                                  
                                                                                
           IF K080-STATUS NOT = 00 AND 97                                       
              DISPLAY 'CLOSE FAILED FOR AB03K080 ' K080-STATUS                  
              MOVE K080-STATUS TO RETURN-CODE.                                  
           STOP RUN.                                                            
                                                                                
       9999-EXIT.                                                               
            EXIT.                                                               
