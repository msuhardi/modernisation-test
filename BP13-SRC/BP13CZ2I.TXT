       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CZ2I.                                                 
      *AUTHOR.        LIZ PATIAG.                                               
      *DATE-WRITTEN.  27/08/2015.                                               
      *========================================================*                
      * SYSTEM OF COMMITMENT (BP13)                            *                
      *========================================================*                
      *    OBJECTIVE :                                         *                
      *      1.  UPDATE NUM-NTIMERS FIELD IN BP13K730 AND      *                
      *          CREATE REPORT FOR VALID NTIMERS APPLICANTS    *                
      *                                                        *                
      *   P13CZ2IA - VALID NTIMERS CASES (PER REGN) - BTO      *                
      *   P13CZ2IB - INVALID CASES - BTO                       *                
      *   P13CZ2IC - VALID NTIMERS CASES (PER REGN) - SBF      *                
      *   P13CZ2ID - INVALID CASES - SBF                       *                
      *   P13CZ2IE - VALID NTIMERS CASES (PER REGN) - ROF      *                
      *   P13CZ2IF - INVALID CASES - ROF                       *                
      *--------------------------------------------------------*                
      * CHG-NO    BY  DATE    DESCRIPTION                      *                
      * -------  ---  ------  -----------                      *                
      * BP135921 FNP1 270815  NEW PROGRAM                      *                
      * BP136239 SMR2 260516  ADD ALLO-CAT                     *                
      * BP136404 SMR2 061016  SEPARATE BTO AND SBF REPORTS     *                
      * BP136852 SMR2 200717  CATER FOR ROF REPORTS            *                
      * BP137263 FNP1 200318  EXCLUDE PA CASES WHO ARE NTIMERS *                
      * BP137439 AM25 040918  CORRECT PAGINATION ISSUE         *                
      * BP137547 FNP1 111018  EXCLUDE SSE CASES WHO ARE NTIMERS *               
      * BP138285 AM25 180520  CHANGE REPORT ID                 *                
      *========================================================*                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
           SELECT BP13TMP    ASSIGN       TO BP13TMP.                           
                                                                                
           SELECT BP13K730   ASSIGN       TO BP13K730                           
                             ACCESS MODE  IS RANDOM                             
                             ORGANIZATION IS INDEXED                            
                             RECORD KEY   IS K730-KEY-NEW                       
                             FILE STATUS  IS BP13K730-STATUS.                   
                                                                                
           SELECT BP13K558   ASSIGN       TO BP13K558                           
                             ACCESS MODE  IS DYNAMIC                            
                             ORGANIZATION IS INDEXED                            
                             RECORD KEY   IS K558-KEY-FLD                       
                             FILE STATUS  IS BP13K558-STATUS.                   
                                                                                
           SELECT P13LZ2IA  ASSIGN       TO P13LZ2IA.                           
           SELECT P13LZ2IB ASSIGN        TO P13LZ2IB.                           
           SELECT P13LZ2IC ASSIGN        TO P13LZ2IC.                           
           SELECT P13LZ2ID ASSIGN        TO P13LZ2ID.                           
           SELECT P13LZ2IE ASSIGN        TO P13LZ2IE.                           
           SELECT P13LZ2IF ASSIGN        TO P13LZ2IF.                           
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD   BP13TMP                                                             
            RECORD CONTAINS  50 CHARACTERS                                      
            BLOCK  CONTAINS 0   RECORDS                                         
            LABEL  RECORDS ARE  STANDARD                                        
            RECORDING MODE IS F.                                                
                                                                                
       01   BP13TMP-REC.                                                        
            05  TMP-NUM-REGN        PIC X(8).                                   
            05  TMP-NUM-NRIC        PIC X(9).                                   
            05  TMP-NUM-ALLO-CAT    PIC X(3).                                   
            05  FILLER              PIC X(30).                                  
                                                                                
       FD   BP13K730                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13K730.                                                           
                                                                                
       FD   BP13K558                                                            
            RECORD CONTAINS 600 CHARACTERS.                                     
       COPY BP13K558.                                                           
                                                                                
       FD   P13LZ2IA                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE IS F                                                 
            LABEL  RECORDS ARE  OMITTED.                                        
                                                                                
       01   P13LZ2IA-REC           PIC X(132).                                  
                                                                                
       FD   P13LZ2IB                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE IS F                                                 
            LABEL  RECORDS ARE  OMITTED.                                        
                                                                                
       01   P13LZ2IB-REC            PIC X(132).                                 
                                                                                
       FD   P13LZ2IC                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE IS F                                                 
            LABEL  RECORDS ARE  OMITTED.                                        
                                                                                
       01   P13LZ2IC-REC           PIC X(132).                                  
                                                                                
       FD   P13LZ2ID                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE IS F                                                 
            LABEL  RECORDS ARE  OMITTED.                                        
                                                                                
       01   P13LZ2ID-REC            PIC X(132).                                 
                                                                                
       FD   P13LZ2IE                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE IS F                                                 
            LABEL  RECORDS ARE  OMITTED.                                        
                                                                                
       01   P13LZ2IE-REC           PIC X(132).                                  
                                                                                
       FD   P13LZ2IF                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE IS F                                                 
            LABEL  RECORDS ARE  OMITTED.                                        
                                                                                
       01   P13LZ2IF-REC            PIC X(132).                                 
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-TMP-READ              PIC 9(8)    VALUE 0.                        
       01  WS-OUTPUT-CNT            PIC 9(8)    VALUE 0.                        
       01  WS-MATCHED-CNT           PIC 9(8)    VALUE 0.                        
       01  K730-FND-CNT             PIC 9(8)    VALUE 0.                        
       01  K730-NFND-CNT            PIC 9(8)    VALUE 0.                        
       01  WS-K558-FND-CNT          PIC 9(8)    VALUE 0.                        
       01  WS-K730-UPD              PIC 9(8)    VALUE 0.                        
       01  K558-FND-CNT             PIC 9(8)    VALUE 0.                        
       01  K558-NFND-CNT            PIC 9(8)    VALUE 0.                        
       01  WS-EXCLUDE               PIC 9(8)    VALUE 0.                        
       01  WS-FILE-STATUS           PIC X(03)   VALUE SPACES.                   
       01  WS-TOTAL                 PIC 9(5)    VALUE 0.                        
       01  WS-TOTAL-A               PIC 9(5)    VALUE 0.                        
       01  WS-TOTAL-B               PIC 9(5)    VALUE 0.                        
       01  WS-TOTAL-C               PIC 9(5)    VALUE 0.                        
       01  WS-TOTAL-D               PIC 9(5)    VALUE 0.                        
       01  WS-TOTAL-E               PIC 9(5)    VALUE 0.                        
       01  BP13K730-STATUS          PIC 99      VALUE ZEROES.                   
       01  BP13K558-STATUS          PIC 99      VALUE ZEROES.                   
                                                                                
       01  WS-FLAT-VARIABLES.                                                   
           05  WS-APP-FLAT-DETAILS OCCURS 10 TIMES.                             
               10  WS-APP-NUM-HDB-REF       PIC X(11).                          
               10  WS-APP-RESALE-CODE       PIC X(3).                           
               10  WS-APP-FILE-SRC          PIC X(3).                           
               10  WS-APP-DIVORCE-CODE      PIC X(1).                           
               10  WS-APP-DEBAR-CODE        PIC X(2).                           
           05  WS-OTH-FLAT-DETAILS OCCURS 10 TIMES.                             
               10  WS-OTH-NUM-HDB-REF       PIC X(11).                          
               10  WS-OTH-RESALE-CODE       PIC X(3).                           
               10  WS-OTH-FILE-SRC          PIC X(3).                           
               10  WS-OTH-DIVORCE-CODE      PIC X(1).                           
               10  WS-OTH-DEBAR-CODE        PIC X(2).                           
           05  WS-SP-FLAT-DETAILS OCCURS 10 TIMES.                              
               10  WS-SP-NUM-HDB-REF        PIC X(11).                          
               10  WS-SP-RESALE-CODE        PIC X(3).                           
               10  WS-SP-FILE-SRC           PIC X(3).                           
               10  WS-SP-DIVORCE-CODE       PIC X(1).                           
               10  WS-SP-DEBAR-CODE         PIC X(2).                           
           05  WS-CNT                   PIC 9(1) VALUE ZEROES.                  
           05  WS-CTR                   PIC 9(2) VALUE ZEROES.                  
           05  WS-CTR2                  PIC 9(2) VALUE ZEROES.                  
           05  WS-CTR3                  PIC 9(2) VALUE ZEROES.                  
           05  WS-CTR4                  PIC 9(2) VALUE ZEROES.                  
           05  WS-APP                   PIC 9(2) VALUE ZEROES.                  
           05  WS-SP                    PIC 9(2) VALUE ZEROES.                  
           05  WS-OTH                   PIC 9(2) VALUE ZEROES.                  
           05  WS-NUM-NTIMER            PIC X(1) VALUE SPACES.                  
           05  WS-K730-NTIMER           PIC X(1) VALUE SPACES.                  
           05  WS-DEBAR33               PIC X(1) VALUE SPACES.                  
           05  WS-DEBAR                 PIC X(2) VALUE SPACES.                  
           05  WS-NUM-MS                PIC X(9) VALUE SPACES.                  
           05  WS-NUM-REGN              PIC X(8) VALUE SPACES.                  
           05  WS-NUM-ZONE              PIC X(3) VALUE SPACES.                  
           05  WS-NUM-FT                PIC X(2) VALUE SPACES.                  
           05  WS-APPLICANT-REC.                                                
               10  WS-NUM-NRIC-A        PIC X(9) VALUE SPACES.                  
               10  WS-NUM-NTIMER-A      PIC X(1) VALUE SPACES.                  
               10  WS-CDE-HH-A          PIC X(1) VALUE SPACES.                  
               10  WS-TAG-A             PIC X(1) VALUE SPACES.                  
               10  WS-NUM-MS-A          PIC X(1) VALUE SPACES.                  
               10  WS-DP-CNT-A          PIC X(2) VALUE SPACES.                  
               10  WS-DEBAR-A           PIC X(2) VALUE SPACES.                  
               10  WS-RELN-A            PIC X(2) VALUE SPACES.                  
               10  WS-SELLER-A          PIC X(1) VALUE SPACES.                  
               10  WS-RSL-FND-A         PIC X(1) VALUE SPACES.                  
               10  WS-SMS-FND-A         PIC X(1) VALUE SPACES.                  
               10  WS-RSL-CNT-A         PIC 9    VALUE ZEROES.                  
           05  WS-SPOUSE-REC.                                                   
               10  WS-NUM-NRIC-B        PIC X(9) VALUE SPACES.                  
               10  WS-NUM-NTIMER-B      PIC X(1) VALUE SPACES.                  
               10  WS-CDE-HH-B          PIC X(1) VALUE SPACES.                  
               10  WS-TAG-B             PIC X(1) VALUE SPACES.                  
               10  WS-NUM-MS-B          PIC X(1) VALUE SPACES.                  
               10  WS-DP-CNT-B          PIC X(2) VALUE SPACES.                  
               10  WS-DEBAR-B           PIC X(2) VALUE SPACES.                  
               10  WS-RELN-B            PIC X(2) VALUE SPACES.                  
               10  WS-SELLER-B          PIC X(1) VALUE SPACES.                  
               10  WS-RSL-FND-B         PIC X(1) VALUE SPACES.                  
               10  WS-SMS-FND-B         PIC X(1) VALUE SPACES.                  
               10  WS-RSL-CNT-B         PIC 9    VALUE ZEROES.                  
           05  WS-OTHER-RELN-REC.                                               
               10  WS-NUM-NRIC-C        PIC X(9) VALUE SPACES.                  
               10  WS-NUM-NTIMER-C      PIC X(1) VALUE SPACES.                  
               10  WS-CDE-HH-C          PIC X(1) VALUE SPACES.                  
               10  WS-TAG-C             PIC X(1) VALUE SPACES.                  
               10  WS-NUM-MS-C          PIC X(1) VALUE SPACES.                  
               10  WS-DP-CNT-C          PIC X(2) VALUE SPACES.                  
               10  WS-DEBAR-C           PIC X(2) VALUE SPACES.                  
               10  WS-RELN-C            PIC X(2) VALUE SPACES.                  
           05  WS-K558-FND                  PIC X(1)  VALUE SPACE.              
               88  K558-FND                 VALUE 'Y'.                          
           05  WS-K558-EOF                  PIC X(1)  VALUE SPACE.              
               88  K558-EOF                 VALUE 'Y'.                          
                                                                                
       01  EOF-BP13TMP             PIC X        VALUE 'N'.                      
       01  WS-LZ2IA-HDR            PIC X        VALUE 'N'.                      
       01  WS-LZ2IB-HDR            PIC X        VALUE 'N'.                      
       01  WS-LZ2IC-HDR            PIC X        VALUE 'N'.                      
       01  WS-LZ2ID-HDR            PIC X        VALUE 'N'.                      
       01  WS-LZ2IE-HDR            PIC X        VALUE 'N'.                      
       01  WS-LZ2IF-HDR            PIC X        VALUE 'N'.                      
       01  WS-PAGE-VAR.                                                         
           05  WS-PAGE-CNT         PIC 9(5)     VALUE ZEROES.                   
           05  WS-PAGE-CNT-A       PIC 9(5)     VALUE ZEROES.                   
           05  WS-PAGE-CNT-B       PIC 9(5)     VALUE ZEROES.                   
           05  WS-PAGE-CNT-C       PIC 9(5)     VALUE ZEROES.                   
           05  WS-PAGE-CNT-D       PIC 9(5)     VALUE ZEROES.                   
           05  WS-PAGE-CNT-E       PIC 9(5)     VALUE ZEROES.                   
           05  WS-LINE-CNT         PIC 9(2)     VALUE ZEROES.                   
           05  WS-LINE-CNT-A       PIC 9(2)     VALUE ZEROES.                   
           05  WS-LINE-CNT-B       PIC 9(2)     VALUE ZEROES.                   
           05  WS-LINE-CNT-C       PIC 9(2)     VALUE ZEROES.                   
           05  WS-LINE-CNT-D       PIC 9(2)     VALUE ZEROES.                   
           05  WS-LINE-CNT-E       PIC 9(2)     VALUE ZEROES.                   
                                                                                
       01  WS-DATE.                                                             
           05  WS-YY               PIC X(2).                                    
           05  WS-MM               PIC X(2).                                    
           05  WS-DD               PIC X(2).                                    
                                                                                
       01  WS-CC                   PIC 99.                                      
                                                                                
                                                                                
       01  LZ2I-HEAD01.                                                         
           05  FILLER              PIC X(8)      VALUE 'BP13LZ2I'.              
           05  FILLER              PIC X(1)      VALUE '_'.                     
           05  LZ2I-SMODE          PIC X(3)      VALUE SPACES.                  
           05  FILLER              PIC X(1)      VALUE SPACES.                  
           05  FILLER              PIC X(8)      VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(23)     VALUE SPACES.                  
           05  FILLER              PIC X(20)     VALUE                          
                                    'S Y S T E M   O F   '.                     
           05  FILLER              PIC X(19)     VALUE                          
                                    'C O M M I T M E N T'.                      
           05  FILLER              PIC X(32)     VALUE SPACES.                  
           05  FILLER              PIC X(7)      VALUE 'DATE :'.                
           05  LZ2I-DATE           PIC X(10).                                   
                                                                                
       01  LZ2I-HEAD02.                                                         
           05  FILLER              PIC X(44)     VALUE SPACES.                  
           05  FILLER              PIC X(40)     VALUE                          
              'REPORT ON MULTIPLE FLATS (NTIMERS) - BTO'.                       
           05  FILLER              PIC X(31)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE :'.                
           05  LZ2I-PAGENO         PIC ZZZZ9.                                   
                                                                                
       01  LZ2I-HEAD02A.                                                        
           05  FILLER              PIC X(42)     VALUE SPACES.                  
           05  FILLER              PIC X(44)     VALUE                          
              'REPORT ON MULTIPLE FLATS (NOT NTIMERS) - BTO'.                   
           05  FILLER              PIC X(29)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE :'.                
           05  LZ2I-PAGENO-A       PIC ZZZZ9.                                   
                                                                                
       01  LZ2I-HEAD02B.                                                        
           05  FILLER              PIC X(44)     VALUE SPACES.                  
           05  FILLER              PIC X(40)     VALUE                          
              'REPORT ON MULTIPLE FLATS (NTIMERS) - SBF'.                       
           05  FILLER              PIC X(31)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE :'.                
           05  LZ2I-PAGENO-B       PIC ZZZZ9.                                   
                                                                                
       01  LZ2I-HEAD02C.                                                        
           05  FILLER              PIC X(42)     VALUE SPACES.                  
           05  FILLER              PIC X(44)     VALUE                          
              'REPORT ON MULTIPLE FLATS (NOT NTIMERS) - SBF'.                   
           05  FILLER              PIC X(29)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE :'.                
           05  LZ2I-PAGENO-C       PIC ZZZZ9.                                   
                                                                                
       01  LZ2I-HEAD02D.                                                        
           05  FILLER              PIC X(44)     VALUE SPACES.                  
           05  FILLER              PIC X(40)     VALUE                          
              'REPORT ON MULTIPLE FLATS (NTIMERS) - ROF'.                       
           05  FILLER              PIC X(31)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE :'.                
           05  LZ2I-PAGENO-D       PIC ZZZZ9.                                   
                                                                                
       01  LZ2I-HEAD02E.                                                        
           05  FILLER              PIC X(42)     VALUE SPACES.                  
           05  FILLER              PIC X(44)     VALUE                          
              'REPORT ON MULTIPLE FLATS (NOT NTIMERS) - ROF'.                   
           05  FILLER              PIC X(29)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE :'.                
           05  LZ2I-PAGENO-E       PIC ZZZZ9.                                   
                                                                                
       01  LZ2I-HEAD03.                                                         
           05  FILLER              PIC X(07)     VALUE ' S/N'.                  
           05  FILLER              PIC X(09)     VALUE 'REG NO'.                
           05  FILLER              PIC X(06)     VALUE 'SMODE '.                
           05  FILLER              PIC X(04)     VALUE 'NT'.                    
           05  FILLER              PIC X(03)     VALUE 'FT'.                    
           05  FILLER              PIC X(10)     VALUE ' NRIC'.                 
           05  FILLER              PIC X(13)     VALUE '  HDB-REF'.             
           05  FILLER              PIC X(04)     VALUE 'ST'.                    
           05  FILLER              PIC X(05)     VALUE 'FILE'.                  
           05  FILLER              PIC X(08)     VALUE 'DIVORCE'.               
           05  FILLER              PIC X(09)     VALUE 'DEBAR'.                 
           05  FILLER              PIC X(06)     VALUE 'RELN'.                  
           05  FILLER              PIC X(14)     VALUE 'MARITAL STATUS'.        
                                                                                
       01  LZ2I-BLANK.                                                          
           05  FILLER                PIC X(132)    VALUE SPACES.                
                                                                                
       01  LZ2I-DETAIL.                                                         
           05  FILLER                PIC X(01)     VALUE SPACES.                
           05  LZ2I-TOTAL            PIC X(05)     VALUE ZEROES.                
           05  FILLER                PIC X(01)     VALUE SPACES.                
           05  LZ2I-NUM-REGN         PIC X(8)      VALUE SPACES.                
           05  FILLER                PIC X(2)      VALUE SPACES.                
           05  LZ2I-NUM-SMODE        PIC X(3)      VALUE SPACES.                
           05  FILLER                PIC X(2)      VALUE SPACES.                
           05  LZ2I-NUM-NT           PIC X(3)      VALUE SPACES.                
           05  FILLER                PIC X(1)      VALUE SPACES.                
           05  LZ2I-NUM-FT           PIC X(2)      VALUE SPACES.                
           05  FILLER                PIC X(1)      VALUE SPACES.                
           05  LZ2I-NUM-NRIC1        PIC X(9)      VALUE SPACES.                
           05  FILLER                PIC X(2)      VALUE SPACES.                
           05  LZ2I-HDB-REF          PIC X(11)     VALUE SPACES.                
           05  FILLER                PIC X(02)     VALUE SPACES.                
           05  LZ2I-RESALE-STATUS    PIC X(3)      VALUE SPACES.                
           05  FILLER                PIC X(02)     VALUE SPACES.                
           05  LZ2I-CODE             PIC X(3)      VALUE SPACES.                
           05  FILLER                PIC X(04)     VALUE SPACES.                
           05  LZ2I-DIVORCE          PIC X(01)     VALUE SPACES.                
           05  FILLER                PIC X(06)     VALUE SPACES.                
           05  LZ2I-DEBAR            PIC X(02)     VALUE SPACES.                
           05  FILLER                PIC X(06)     VALUE SPACES.                
           05  LZ2I-RELN             PIC X(02)     VALUE SPACES.                
           05  FILLER                PIC X(04)     VALUE SPACES.                
           05  LZ2I-MS               PIC X(09)     VALUE SPACES.                
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
      *--------------------------------------------------------*                
       000-MAIN.                                                                
      *--------------------------------------------------------*                
           OPEN INPUT  BP13TMP                                                  
                       BP13K558                                                 
                I-O    BP13K730                                                 
                OUTPUT P13LZ2IA                                                 
                       P13LZ2IB                                                 
                       P13LZ2IC                                                 
                       P13LZ2ID                                                 
                       P13LZ2IE                                                 
                       P13LZ2IF.                                                
                                                                                
           IF BP13K730-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR OPENING BP13K730 (' BP13K730-STATUS ')'            
              MOVE BP13K730-STATUS           TO RETURN-CODE                     
              GO TO 900-CLOSE-ROUTINE                                           
           END-IF.                                                              
                                                                                
           IF BP13K558-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR OPENING BP13K558 (' BP13K558-STATUS ')'            
              MOVE BP13K558-STATUS           TO RETURN-CODE                     
              GO TO 900-CLOSE-ROUTINE                                           
           END-IF.                                                              
                                                                                
           ACCEPT WS-DATE FROM DATE.                                            
           IF WS-YY > '90'                                                      
              MOVE '19' TO WS-CC                                                
           ELSE                                                                 
              MOVE '20' TO WS-CC.                                               
           STRING WS-DD '/' WS-MM '/' WS-CC WS-YY                               
                DELIMITED BY SIZE INTO LZ2I-DATE.                               
                                                                                
           PERFORM 100-READ-TMP-REC    THRU 100-EXIT.                           
           PERFORM 200-PROCESS-REC     THRU 200-EXIT                            
                   UNTIL EOF-BP13TMP  = 'Y'.                                    
           PERFORM 900-CLOSE-ROUTINE.                                           
                                                                                
       000-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       010-PRINT-HEADING.                                                       
      *--------------------------------------------------------*                
                                                                                
           ADD 1                       TO WS-PAGE-CNT.                          
           MOVE WS-PAGE-CNT            TO LZ2I-PAGENO.                          
           MOVE 'BTO'                  TO LZ2I-SMODE.                           
                                                                                
           WRITE P13LZ2IA-REC FROM LZ2I-HEAD01  AFTER PAGE.                     
           WRITE P13LZ2IA-REC FROM LZ2I-HEAD02  AFTER 1.                        
           WRITE P13LZ2IA-REC FROM LZ2I-BLANK.                                  
           WRITE P13LZ2IA-REC FROM LZ2I-HEAD03  AFTER 3.                        
           WRITE P13LZ2IA-REC FROM LZ2I-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT.                          
                                                                                
       010-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       020-PRINT-HEADING-A.                                                     
      *--------------------------------------------------------*                
                                                                                
           ADD 1                       TO WS-PAGE-CNT-A.                        
           MOVE WS-PAGE-CNT-A          TO LZ2I-PAGENO-A.                        
           MOVE 'BTO'                  TO LZ2I-SMODE.                           
                                                                                
           WRITE P13LZ2IB-REC FROM LZ2I-HEAD01  AFTER PAGE.                     
           WRITE P13LZ2IB-REC FROM LZ2I-HEAD02A AFTER 1.                        
           WRITE P13LZ2IB-REC FROM LZ2I-BLANK.                                  
           WRITE P13LZ2IB-REC FROM LZ2I-HEAD03  AFTER 3.                        
           WRITE P13LZ2IB-REC FROM LZ2I-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT-A.                        
                                                                                
       020-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       030-PRINT-HEADING-B.                                                     
      *--------------------------------------------------------*                
                                                                                
           ADD 1                       TO WS-PAGE-CNT-B.                        
           MOVE WS-PAGE-CNT-B          TO LZ2I-PAGENO-B.                        
           MOVE 'SBF'                  TO LZ2I-SMODE.                           
                                                                                
           WRITE P13LZ2IC-REC FROM LZ2I-HEAD01  AFTER PAGE.                     
           WRITE P13LZ2IC-REC FROM LZ2I-HEAD02B AFTER 1.                        
           WRITE P13LZ2IC-REC FROM LZ2I-BLANK.                                  
           WRITE P13LZ2IC-REC FROM LZ2I-HEAD03  AFTER 3.                        
           WRITE P13LZ2IC-REC FROM LZ2I-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT-B.                        
                                                                                
       030-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       040-PRINT-HEADING-C.                                                     
      *--------------------------------------------------------*                
                                                                                
           ADD 1                       TO WS-PAGE-CNT-C.                        
           MOVE WS-PAGE-CNT-C          TO LZ2I-PAGENO-C.                        
           MOVE 'SBF'                  TO LZ2I-SMODE.                           
                                                                                
           WRITE P13LZ2ID-REC FROM LZ2I-HEAD01  AFTER PAGE.                     
           WRITE P13LZ2ID-REC FROM LZ2I-HEAD02C AFTER 1.                        
           WRITE P13LZ2ID-REC FROM LZ2I-BLANK.                                  
           WRITE P13LZ2ID-REC FROM LZ2I-HEAD03  AFTER 3.                        
           WRITE P13LZ2ID-REC FROM LZ2I-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT-C.                        
                                                                                
       040-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       050-PRINT-HEADING-D.                                                     
      *--------------------------------------------------------*                
                                                                                
           ADD 1                       TO WS-PAGE-CNT-D.                        
           MOVE WS-PAGE-CNT-D          TO LZ2I-PAGENO-D.                        
           MOVE 'ROF'                  TO LZ2I-SMODE.                           
                                                                                
           WRITE P13LZ2IE-REC FROM LZ2I-HEAD01  AFTER PAGE.                     
           WRITE P13LZ2IE-REC FROM LZ2I-HEAD02D AFTER 1.                        
           WRITE P13LZ2IE-REC FROM LZ2I-BLANK.                                  
           WRITE P13LZ2IE-REC FROM LZ2I-HEAD03  AFTER 3.                        
           WRITE P13LZ2IE-REC FROM LZ2I-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT-D.                        
                                                                                
       050-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       060-PRINT-HEADING-E.                                                     
      *--------------------------------------------------------*                
                                                                                
           ADD 1                       TO WS-PAGE-CNT-E.                        
           MOVE WS-PAGE-CNT-E          TO LZ2I-PAGENO-E.                        
           MOVE 'ROF'                  TO LZ2I-SMODE.                           
                                                                                
           WRITE P13LZ2IF-REC FROM LZ2I-HEAD01  AFTER PAGE.                     
           WRITE P13LZ2IF-REC FROM LZ2I-HEAD02E AFTER 1.                        
           WRITE P13LZ2IF-REC FROM LZ2I-BLANK.                                  
           WRITE P13LZ2IF-REC FROM LZ2I-HEAD03  AFTER 3.                        
           WRITE P13LZ2IF-REC FROM LZ2I-BLANK.                                  
                                                                                
           MOVE 5                      TO WS-LINE-CNT-E.                        
                                                                                
       060-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       100-READ-TMP-REC.                                                        
      *--------------------------------------------------------*                
                                                                                
           READ BP13TMP AT END MOVE 'Y' TO EOF-BP13TMP                          
                MOVE HIGH-VALUE TO TMP-NUM-REGN                                 
                GO TO 100-EXIT.                                                 
           ADD 1 TO WS-TMP-READ.                                                
                                                                                
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       200-PROCESS-REC.                                                         
      *--------------------------------------------------------*                
                                                                                
           MOVE SPACES         TO WS-APPLICANT-REC                              
                                  WS-SPOUSE-REC                                 
                                  WS-OTHER-RELN-REC                             
                                  WS-K730-NTIMER                                
                                  WS-NUM-REGN                                   
                                  WS-NUM-ZONE                                   
                                  WS-NUM-FT.                                    
                                                                                
           MOVE ZEROES         TO WS-RSL-CNT-A                                  
                                  WS-RSL-CNT-B.                                 
                                                                                
           PERFORM 300-STARTBR-BP13K558       THRU 300-EXIT.                    
                                                                                
           PERFORM 550-CHECK-OTHER-APPLICANTS THRU 550-EXIT.                    
           PERFORM 400-READ-BP13K730          THRU 400-EXIT.                    
                                                                                
      ****EXCLUDE SOME PA CASES DEFINED AS ELIGIBLE FOR NTIMER                  
      ****SCENARIO 1 - HUSBAND/WIFE BOTH SELLERS AND W/ SMS FLAT                
           IF K730-CDE-ELIG-SCH = 'PA '                                         
             IF (WS-TAG-A = 'Y' AND WS-TAG-B = 'Y' AND                          
                                    WS-TAG-C NOT = 'Y') AND                     
                (WS-SMS-FND-A = 'Y' AND WS-SMS-FND-B = 'Y') AND                 
                (WS-SELLER-A = 'Y' AND WS-SELLER-B = 'Y')                       
                ADD 1 TO WS-EXCLUDE                                             
                DISPLAY ' DO NOT PRT 1REG: ' TMP-NUM-REGN                       
                        ' APP: ' WS-NUM-NRIC-A                                  
                        ' SPS: ' WS-NUM-NRIC-B                                  
                PERFORM 100-READ-TMP-REC           THRU 100-EXIT                
                GO TO 200-EXIT                                                  
             END-IF                                                             
           END-IF.                                                              
                                                                                
      ****SCENARIO 2 - HUSBAND/WIFE SOLD 2 DP FLATS AS COUPLE                   
           IF K730-CDE-ELIG-SCH = 'PA '                                         
              IF (WS-TAG-A = 'Y' AND WS-TAG-B = 'Y' AND                         
                                     WS-TAG-C NOT = 'Y') AND                    
                 (WS-SELLER-A = 'Y' AND WS-SELLER-B = 'Y') AND                  
                 (WS-RSL-CNT-A = 2 AND WS-RSL-CNT-B = 2) AND                    
                 (WS-DEBAR-A = '33' OR WS-DEBAR-B = '33')                       
                ADD 1 TO WS-EXCLUDE                                             
                DISPLAY ' DO NOT PRT 2REG: ' TMP-NUM-REGN                       
                        ' APP: ' WS-NUM-NRIC-A                                  
                        ' SPS: ' WS-NUM-NRIC-B                                  
                PERFORM 100-READ-TMP-REC           THRU 100-EXIT                
                GO TO 200-EXIT                                                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
      ****SCENARIO 3 - SSE CASE . 1 HA, DIVORCED/WIDOWED SOLD 2 DP              
           IF K730-CDE-ELIG-SCH = 'SSE'                                         
              IF (WS-TAG-A = 'Y') AND (WS-RSL-CNT-A = 2) AND                    
                 (WS-NUM-MS-A = 'W' OR 'D' OR '3' OR '4') AND                   
                 (WS-DEBAR-A = '33')                                            
                ADD 1 TO WS-EXCLUDE                                             
                DISPLAY ' DO NOT PRT 3REG: ' TMP-NUM-REGN                       
                        ' APP: ' WS-NUM-NRIC-A                                  
                        ' SPS: ' WS-NUM-NRIC-B                                  
                PERFORM 100-READ-TMP-REC           THRU 100-EXIT                
                GO TO 200-EXIT                                                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
      ****WRITE APPLICANT'S DETAILS                                             
           IF WS-NUM-NRIC-A NOT = SPACES AND LOW-VALUES                         
            PERFORM VARYING WS-CTR4 FROM 1 BY 1 UNTIL WS-CTR4 > WS-CTR2         
                OR WS-APP-NUM-HDB-REF(WS-CTR4) = SPACES                         
                PERFORM 800-WRITE-APP         THRU 800-EXIT                     
            END-PERFORM                                                         
            IF WS-CTR2 = 0                                                      
               MOVE 1  TO WS-CTR4                                               
               PERFORM 800-WRITE-APP          THRU 800-EXIT                     
            END-IF                                                              
           END-IF.                                                              
                                                                                
      ****WRITE SPOUSE'S DETAILS                                                
           IF WS-NUM-NRIC-B NOT = SPACES AND LOW-VALUES                         
            PERFORM VARYING WS-CTR4 FROM 1 BY 1 UNTIL WS-CTR4 > WS-SP           
                OR WS-SP-NUM-HDB-REF(WS-CTR4) = SPACES                          
                PERFORM 810-WRITE-SP          THRU 810-EXIT                     
            END-PERFORM                                                         
            IF WS-SP = 0                                                        
               MOVE 1  TO WS-CTR4                                               
               PERFORM 810-WRITE-SP           THRU 810-EXIT                     
            END-IF                                                              
           END-IF.                                                              
                                                                                
      ****WRITE OTHER'S DETAILS                                                 
           IF WS-NUM-NRIC-C NOT = SPACES AND LOW-VALUES                         
            PERFORM VARYING WS-CTR4 FROM 1 BY 1 UNTIL WS-CTR4 > WS-OTH          
                OR WS-OTH-NUM-HDB-REF(WS-CTR4) = SPACES                         
                PERFORM 820-WRITE-OTH         THRU 820-EXIT                     
            END-PERFORM                                                         
            IF WS-OTH = 0                                                       
               MOVE 1  TO WS-CTR4                                               
               PERFORM 820-WRITE-OTH          THRU 820-EXIT                     
            END-IF                                                              
           END-IF.                                                              
                                                                                
           PERFORM 100-READ-TMP-REC           THRU 100-EXIT.                    
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       300-STARTBR-BP13K558.                                                    
      *--------------------------------------------------------*                
           MOVE LOW-VALUES       TO K558-KEY-FLD.                               
           MOVE 'N'              TO WS-K558-EOF                                 
                                    WS-K558-FND.                                
                                                                                
           MOVE TMP-NUM-REGN     TO K558-NUM-REGN.                              
           START BP13K558 KEY >= K558-NUM-REGN.                                 
                                                                                
           EVALUATE BP13K558-STATUS                                             
              WHEN 00                                                           
                  PERFORM 320-READNEXT-BP13K558  THRU 320-EXIT                  
                     UNTIL K558-NUM-REGN NOT = TMP-NUM-REGN                     
                     OR WS-K558-EOF = 'Y'                                       
              WHEN 23                                                           
                  MOVE 'Y'       TO WS-K558-EOF                                 
              WHEN OTHER                                                        
                  DISPLAY 'ERROR READING BP13K558, STATUS - '                   
                                       BP13K558-STATUS                          
                  MOVE BP13K558-STATUS TO RETURN-CODE                           
                  PERFORM 900-CLOSE-ROUTINE THRU 900-EXIT                       
           END-EVALUATE.                                                        
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       320-READNEXT-BP13K558.                                                   
      *--------------------------------------------------------*                
           READ BP13K558 NEXT RECORD                                            
                AT END MOVE 'Y' TO WS-K558-EOF                                  
           END-READ.                                                            
                                                                                
           IF K558-NUM-REGN = TMP-NUM-REGN                                      
              MOVE K558-NUM-REGN        TO WS-NUM-REGN                          
              MOVE K558-NUM-ZONE-NT-SOC TO WS-NUM-ZONE                          
              MOVE K558-NUM-FLAT-TY-SOC TO WS-NUM-FT                            
              PERFORM 510-PROCESS-K558  THRU 510-EXIT                           
              ADD 1 TO WS-K558-FND-CNT                                          
           ELSE                                                                 
              MOVE 'Y'          TO WS-K558-EOF                                  
           END-IF.                                                              
                                                                                
       320-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       400-READ-BP13K730.                                                       
      *--------------------------------------------------------*                
                                                                                
           MOVE SPACES                TO K730-NUM-REGN.                         
           MOVE TMP-NUM-REGN          TO K730-NUM-REGN.                         
                                                                                
           READ BP13K730.                                                       
                                                                                
           EVALUATE BP13K730-STATUS                                             
              WHEN 00                                                           
                 MOVE WS-K730-NTIMER     TO K730-NUM-NTIMER                     
                 PERFORM 450-REWRITE-BP13K730  THRU 450-EXIT                    
                 ADD 1 TO K730-FND-CNT                                          
             WHEN 23                                                            
                 ADD 1 TO K730-NFND-CNT                                         
                 MOVE SPACES             TO K730-CDE-ELIG-SCH                   
                 DISPLAY 'RECORD NOT FOUND IN BP13K730: ' K730-NUM-REGN         
             WHEN OTHER                                                         
                 DISPLAY 'ERROR WITH READ OF BP13K730. STATUS IS '              
                      BP13K730-STATUS                                           
                 MOVE BP13K730-STATUS              TO RETURN-CODE               
                 PERFORM 900-CLOSE-ROUTINE        THRU 900-EXIT                 
             END-EVALUATE.                                                      
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       450-REWRITE-BP13K730.                                                    
      *--------------------------------------------------------*                
                                                                                
           REWRITE BP13K730-REC.                                                
                                                                                
           EVALUATE BP13K730-STATUS                                             
              WHEN 00                                                           
                 ADD 1 TO WS-K730-UPD                                           
              WHEN OTHER                                                        
                 DISPLAY 'ERROR WITH UPDATING OF BP13K730. STATUS IS '          
                     BP13K730-STATUS                                            
                 MOVE BP13K730-STATUS             TO RETURN-CODE                
                 PERFORM 900-CLOSE-ROUTINE        THRU 900-EXIT                 
           END-EVALUATE.                                                        
                                                                                
       450-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       510-PROCESS-K558.                                                        
      *--------------------------------------------------------*                
                                                                                
           IF K558-NUM-APPLN NOT = 'Y'                                          
              IF K558-CDE-RELATIONSHIP = '20' OR '09'                           
                 CONTINUE                                                       
              ELSE                                                              
                 GO TO 510-EXIT                                                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K558-CDE-HOUSEHOLD = 'G' OR '3'                                   
              MOVE 'G'                TO K558-CDE-HOUSEHOLD                     
           END-IF.                                                              
                                                                                
                                                                                
      * PROCESS MAIN APPLICANT                                                  
           IF K558-CDE-RELATIONSHIP = '00'                                      
              MOVE 'Y'                            TO WS-TAG-A                   
              MOVE K558-NUM-MARITAL-STATUS        TO WS-NUM-MS-A                
              MOVE K558-CDE-HOUSEHOLD             TO WS-CDE-HH-A                
              MOVE K558-NUM-NTIMER                TO WS-NUM-NTIMER-A            
              MOVE K558-NUM-NRIC                  TO WS-NUM-NRIC-A              
              IF K558-NUM-DEBARMENT-6 NOT = SPACES                              
                 MOVE K558-NUM-DEBARMENT-6        TO WS-DEBAR-A                 
              ELSE                                                              
                 MOVE K558-NUM-DEBARMENT-4        TO WS-DEBAR-A                 
              END-IF                                                            
              MOVE K558-CDE-RELATIONSHIP          TO WS-RELN-A                  
              IF K558-NUM-SELLER-RSL = 'S'                                      
                 MOVE 'Y'                         TO WS-SELLER-A                
              END-IF                                                            
              PERFORM 750-GET-APP-FLAT-DTLS       THRU 750-EXIT                 
           END-IF.                                                              
                                                                                
      * PROCESS APPLICANT SPOUSE/FIANCE                                         
           IF K558-CDE-RELATIONSHIP = '20' OR '09'                              
              MOVE 'Y'                           TO WS-TAG-B                    
              MOVE K558-NUM-MARITAL-STATUS        TO WS-NUM-MS-B                
              MOVE K558-CDE-HOUSEHOLD            TO WS-CDE-HH-B                 
              MOVE K558-NUM-NTIMER                TO WS-NUM-NTIMER-B            
              MOVE K558-NUM-NRIC                  TO WS-NUM-NRIC-B              
              IF K558-NUM-DEBARMENT-6 NOT = SPACES                              
                 MOVE K558-NUM-DEBARMENT-6        TO WS-DEBAR-B                 
              ELSE                                                              
                 MOVE K558-NUM-DEBARMENT-4        TO WS-DEBAR-B                 
              END-IF                                                            
              MOVE K558-CDE-RELATIONSHIP          TO WS-RELN-B                  
              IF K558-NUM-SELLER-RSL = 'S'                                      
                 MOVE 'Y'                         TO WS-SELLER-B                
              END-IF                                                            
              PERFORM 760-GET-SP-FLAT-DTLS        THRU 760-EXIT                 
           END-IF.                                                              
                                                                                
      * PROCESS OTHER RELATIONSHIPS - PARENTS/SIBLINGS/BRO/SIS-IN-LAW           
           IF K558-CDE-RELATIONSHIP = '02' OR '12' OR '06' OR '07'              
              MOVE 'Y'                           TO WS-TAG-C                    
              MOVE K558-NUM-MARITAL-STATUS        TO WS-NUM-MS-C                
              MOVE K558-CDE-HOUSEHOLD            TO WS-CDE-HH-C                 
              MOVE K558-NUM-NTIMER                TO WS-NUM-NTIMER-C            
              MOVE K558-NUM-NRIC                  TO WS-NUM-NRIC-C              
              IF K558-NUM-DEBARMENT-6 NOT = SPACES                              
                 MOVE K558-NUM-DEBARMENT-6        TO WS-DEBAR-C                 
              ELSE                                                              
                 MOVE K558-NUM-DEBARMENT-4        TO WS-DEBAR-C                 
              END-IF                                                            
              MOVE K558-CDE-RELATIONSHIP          TO WS-RELN-C                  
              PERFORM 770-GET-OTH-FLAT-DTLS       THRU 770-EXIT                 
           END-IF.                                                              
                                                                                
       510-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       550-CHECK-OTHER-APPLICANTS.                                              
      *--------------------------------------------------------*                
                                                                                
      *************************************************************             
      *** FOR MARRIED COUPLES, BOTH NEED TO BE NTIMER AND BOTH ****             
      *** NEED TO BE UPGRADER TO BE TAGGED AS NTIMER IN K730,  ****             
      *** FOR OTHER APPLICANTS, AT LEAST ONE IS NTIMER/UPGRADER ***             
      *************************************************************             
                                                                                
                                                                                
           IF WS-TAG-A = 'Y' AND WS-TAG-B = 'Y'                                 
              IF (WS-CDE-HH-A = 'G' AND WS-CDE-HH-B = 'G') AND                  
                 (WS-NUM-NTIMER-A = 'Y' AND WS-NUM-NTIMER-B = 'Y')              
                 MOVE 'Y'        TO WS-K730-NTIMER                              
              ELSE                                                              
                 MOVE 'N'        TO WS-K730-NTIMER                              
              END-IF                                                            
           ELSE                                                                 
              IF WS-NUM-MS-A = '1' OR '4' OR '3'                                
                 IF (WS-TAG-A = 'Y' AND  WS-CDE-HH-A = 'G' AND                  
                     WS-NUM-NTIMER-A = 'Y') OR                                  
                    (WS-TAG-C = 'Y' AND  WS-CDE-HH-C = 'G' AND                  
                     WS-NUM-NTIMER-C = 'Y')                                     
                    MOVE 'Y'     TO WS-K730-NTIMER                              
                 ELSE                                                           
                    MOVE 'N'     TO WS-K730-NTIMER                              
                 END-IF                                                         
              ELSE                                                              
                 IF WS-NUM-MS-A = '2'                                           
                    IF WS-TAG-A = 'Y' AND WS-TAG-B = SPACES AND                 
                       WS-NUM-NTIMER-A = 'Y' AND WS-CDE-HH-A = 'G'              
                       MOVE 'Y'  TO WS-K730-NTIMER                              
                    ELSE                                                        
                       MOVE 'N'  TO WS-K730-NTIMER                              
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       550-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       750-GET-APP-FLAT-DTLS.                                                   
      *--------------------------------------------------------*                
           MOVE ZEROES      TO WS-CTR2.                                         
           MOVE SPACES      TO WS-DEBAR.                                        
                                                                                
           PERFORM VARYING WS-CTR4 FROM 1 BY 1 UNTIL WS-CTR4 > 10               
              MOVE SPACES         TO WS-APP-NUM-HDB-REF(WS-CTR4)                
                                     WS-APP-RESALE-CODE(WS-CTR4)                
                                     WS-APP-FILE-SRC(WS-CTR4)                   
                                     WS-APP-DIVORCE-CODE(WS-CTR4)               
                                     WS-APP-DEBAR-CODE(WS-CTR4)                 
           END-PERFORM.                                                         
                                                                                
           IF K558-NUM-DEBARMENT-6 NOT = SPACES AND LOW-VALUES                  
              MOVE K558-NUM-DEBARMENT-6 TO WS-DEBAR                             
           ELSE                                                                 
              MOVE K558-NUM-DEBARMENT-4 TO WS-DEBAR                             
           END-IF.                                                              
                                                                                
           IF K558-NUM-HDB-REF-RSL NOT = SPACES AND LOW-VALUES                  
              ADD 1 TO WS-CTR2                                                  
              MOVE K558-NUM-HDB-REF-RSL  TO WS-APP-NUM-HDB-REF(WS-CTR2)         
              MOVE K558-CDE-FILE-STATUS-RSL TO                                  
                                         WS-APP-RESALE-CODE(WS-CTR2)            
              MOVE WS-DEBAR           TO WS-APP-DEBAR-CODE(WS-CTR2)             
              MOVE 'RSL'              TO WS-APP-FILE-SRC(WS-CTR2)               
              MOVE 'Y'                TO WS-RSL-FND-A                           
              IF K558-CDE-FILE-STATUS-RSL NOT = 'OM '                           
                 ADD 1 TO WS-RSL-CNT-A                                          
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF (K558-NUM-HDB-REF-SMS NOT = SPACES AND LOW-VALUES) AND            
              K558-CDE-FILE-STATUS-SMS NOT = 'OM'                               
              ADD 1 TO WS-CTR2                                                  
              MOVE K558-NUM-HDB-REF-SMS  TO WS-APP-NUM-HDB-REF(WS-CTR2)         
              MOVE K558-CDE-SALES-TYPE-SMS  TO                                  
                                         WS-APP-RESALE-CODE(WS-CTR2)            
              MOVE WS-DEBAR           TO WS-APP-DEBAR-CODE(WS-CTR2)             
              MOVE 'SMS'              TO WS-APP-FILE-SRC(WS-CTR2)               
              MOVE 'Y'                TO WS-SMS-FND-A                           
           END-IF.                                                              
                                                                                
           IF K558-NUM-HDB-REF-TR  NOT = SPACES AND LOW-VALUES                  
              ADD 1 TO WS-CTR2                                                  
              MOVE K558-NUM-HDB-REF-TR  TO WS-APP-NUM-HDB-REF(WS-CTR2)          
              MOVE K558-NUM-SALES-TYPE-TR   TO                                  
                                          WS-APP-RESALE-CODE(WS-CTR2)           
              MOVE WS-DEBAR            TO WS-APP-DEBAR-CODE(WS-CTR2)            
              MOVE K558-NUM-DIVORCE-TR TO WS-APP-DIVORCE-CODE(WS-CTR2)          
              MOVE 'TRF'               TO WS-APP-FILE-SRC(WS-CTR2)              
           END-IF.                                                              
                                                                                
           IF K558-NUM-HDB-REF-MAM NOT = SPACES AND LOW-VALUES                  
              ADD 1 TO WS-CTR2                                                  
              MOVE K558-NUM-HDB-REF-MAM  TO WS-APP-NUM-HDB-REF(WS-CTR2)         
              MOVE K558-NUM-SALES-TYPE-MAM  TO                                  
                                          WS-APP-RESALE-CODE(WS-CTR2)           
              MOVE WS-DEBAR            TO WS-APP-DEBAR-CODE(WS-CTR2)            
              MOVE 'MAM'               TO WS-APP-FILE-SRC(WS-CTR2)              
           END-IF.                                                              
                                                                                
           IF K558-NUM-HDB-REF-SLS NOT = SPACES AND LOW-VALUES                  
              ADD 1 TO WS-CTR2                                                  
              MOVE K558-NUM-HDB-REF-SLS  TO WS-APP-NUM-HDB-REF(WS-CTR2)         
              MOVE K558-NUM-SALES-TYPE-SLS  TO                                  
                                          WS-APP-RESALE-CODE(WS-CTR2)           
              MOVE WS-DEBAR            TO WS-APP-DEBAR-CODE(WS-CTR2)            
              MOVE 'SLS'               TO WS-APP-FILE-SRC(WS-CTR2)              
           END-IF.                                                              
                                                                                
           IF K558-MULTIPLE-FLAT-SMS NOT = SPACES AND LOW-VALUES                
              ADD 1 TO WS-CTR2                                                  
              MOVE K558-MULTIPLE-FLAT-SMS TO                                    
                                          WS-APP-NUM-HDB-REF(WS-CTR2)           
              MOVE K558-MULTIPLE-STY-SMS    TO                                  
                                          WS-APP-RESALE-CODE(WS-CTR2)           
              MOVE WS-DEBAR            TO WS-APP-DEBAR-CODE(WS-CTR2)            
              MOVE 'SMS'               TO WS-APP-FILE-SRC(WS-CTR2)              
              MOVE 'Y'                 TO WS-SMS-FND-A                          
           END-IF.                                                              
                                                                                
           IF K558-MULTIPLE-FLAT-TRF NOT = SPACES AND LOW-VALUES                
              ADD 1 TO WS-CTR2                                                  
              MOVE K558-MULTIPLE-FLAT-TRF TO                                    
                                          WS-APP-NUM-HDB-REF(WS-CTR2)           
              MOVE K558-MULTIPLE-STY-TRF    TO                                  
                                          WS-APP-RESALE-CODE(WS-CTR2)           
              MOVE WS-DEBAR            TO WS-APP-DEBAR-CODE(WS-CTR2)            
              MOVE K558-MULTIPLE-DIVORCE-TRF TO                                 
                                          WS-APP-DIVORCE-CODE(WS-CTR2)          
              MOVE 'TRF'               TO WS-APP-FILE-SRC(WS-CTR2)              
           END-IF.                                                              
                                                                                
           PERFORM VARYING WS-CTR3 FROM 1 BY 1 UNTIL WS-CTR3 > 3 OR             
               K558-RESALE-UNIT(WS-CTR3) = SPACES                               
              IF K558-RESALE-UNIT(WS-CTR3) NOT = SPACES AND LOW-VALUES          
                 ADD 1 TO WS-CTR2                                               
                 MOVE K558-RESALE-UNIT(WS-CTR3) TO                              
                                WS-APP-NUM-HDB-REF(WS-CTR2)                     
                 MOVE K558-RESALE-CODE(WS-CTR3) TO                              
                                WS-APP-RESALE-CODE(WS-CTR2)                     
                 MOVE WS-DEBAR         TO WS-APP-DEBAR-CODE(WS-CTR2)            
                 MOVE 'RSL'            TO WS-APP-FILE-SRC(WS-CTR2)              
                 MOVE 'Y'              TO WS-RSL-FND-A                          
                 IF K558-CDE-FILE-STATUS-RSL NOT = 'OM '                        
                    ADD 1 TO WS-RSL-CNT-A                                       
                 END-IF                                                         
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
                                                                                
       750-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       760-GET-SP-FLAT-DTLS.                                                    
      *--------------------------------------------------------*                
           MOVE ZEROES      TO WS-SP.                                           
           MOVE SPACES      TO WS-DEBAR.                                        
                                                                                
           PERFORM VARYING WS-CTR4 FROM 1 BY 1 UNTIL WS-CTR4 > 10               
              MOVE SPACES         TO WS-SP-NUM-HDB-REF(WS-CTR4)                 
                                     WS-SP-RESALE-CODE(WS-CTR4)                 
                                     WS-SP-FILE-SRC(WS-CTR4)                    
                                     WS-SP-DIVORCE-CODE(WS-CTR4)                
                                     WS-SP-DEBAR-CODE(WS-CTR4)                  
           END-PERFORM.                                                         
                                                                                
           IF K558-NUM-DEBARMENT-6 NOT = SPACES AND LOW-VALUES                  
              MOVE K558-NUM-DEBARMENT-6 TO WS-DEBAR                             
           ELSE                                                                 
              MOVE K558-NUM-DEBARMENT-4 TO WS-DEBAR                             
           END-IF.                                                              
                                                                                
           IF K558-NUM-HDB-REF-RSL NOT = SPACES AND LOW-VALUES                  
              ADD 1 TO WS-SP                                                    
              MOVE K558-NUM-HDB-REF-RSL  TO WS-SP-NUM-HDB-REF(WS-SP)            
              MOVE K558-CDE-FILE-STATUS-RSL TO                                  
                                         WS-SP-RESALE-CODE(WS-SP)               
              MOVE WS-DEBAR           TO WS-SP-DEBAR-CODE(WS-SP)                
              MOVE 'RSL'              TO WS-SP-FILE-SRC(WS-SP)                  
              MOVE 'Y'                TO WS-RSL-FND-B                           
              IF K558-CDE-FILE-STATUS-RSL NOT = 'OM '                           
                 ADD 1 TO WS-RSL-CNT-B                                          
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF (K558-NUM-HDB-REF-SMS NOT = SPACES AND LOW-VALUES) AND            
              K558-CDE-FILE-STATUS-SMS NOT = 'OM'                               
              ADD 1 TO WS-SP                                                    
              MOVE K558-NUM-HDB-REF-SMS  TO WS-SP-NUM-HDB-REF(WS-SP)            
              MOVE K558-CDE-SALES-TYPE-SMS  TO                                  
                                         WS-SP-RESALE-CODE(WS-SP)               
              MOVE WS-DEBAR           TO WS-SP-DEBAR-CODE(WS-SP)                
              MOVE 'SMS'              TO WS-SP-FILE-SRC(WS-SP)                  
              MOVE 'Y'                TO WS-SMS-FND-B                           
           END-IF.                                                              
                                                                                
           IF K558-NUM-HDB-REF-TR  NOT = SPACES AND LOW-VALUES                  
              ADD 1 TO WS-SP                                                    
              MOVE K558-NUM-HDB-REF-TR  TO WS-SP-NUM-HDB-REF(WS-SP)             
              MOVE K558-NUM-SALES-TYPE-TR   TO                                  
                                          WS-SP-RESALE-CODE(WS-SP)              
              MOVE WS-DEBAR            TO WS-SP-DEBAR-CODE(WS-SP)               
              MOVE K558-NUM-DIVORCE-TR TO WS-SP-DIVORCE-CODE(WS-SP)             
              MOVE 'TRF'               TO WS-SP-FILE-SRC(WS-SP)                 
           END-IF.                                                              
                                                                                
           IF K558-NUM-HDB-REF-MAM NOT = SPACES AND LOW-VALUES                  
              ADD 1 TO WS-SP                                                    
              MOVE K558-NUM-HDB-REF-MAM  TO WS-SP-NUM-HDB-REF(WS-SP)            
              MOVE K558-NUM-SALES-TYPE-MAM  TO                                  
                                          WS-SP-RESALE-CODE(WS-SP)              
              MOVE WS-DEBAR            TO WS-SP-DEBAR-CODE(WS-SP)               
              MOVE 'MAM'               TO WS-SP-FILE-SRC(WS-SP)                 
           END-IF.                                                              
                                                                                
           IF K558-NUM-HDB-REF-SLS NOT = SPACES AND LOW-VALUES                  
              ADD 1 TO WS-SP                                                    
              MOVE K558-NUM-HDB-REF-SLS  TO WS-SP-NUM-HDB-REF(WS-SP)            
              MOVE K558-NUM-SALES-TYPE-SLS  TO                                  
                                          WS-SP-RESALE-CODE(WS-SP)              
              MOVE WS-DEBAR            TO WS-SP-DEBAR-CODE(WS-SP)               
              MOVE 'SLS'               TO WS-SP-FILE-SRC(WS-SP)                 
           END-IF.                                                              
                                                                                
           IF K558-MULTIPLE-FLAT-SMS NOT = SPACES AND LOW-VALUES                
              ADD 1 TO WS-SP                                                    
              MOVE K558-MULTIPLE-FLAT-SMS TO                                    
                                          WS-SP-NUM-HDB-REF(WS-SP)              
              MOVE K558-MULTIPLE-STY-SMS    TO                                  
                                          WS-SP-RESALE-CODE(WS-SP)              
              MOVE WS-DEBAR            TO WS-SP-DEBAR-CODE(WS-SP)               
              MOVE 'SMS'               TO WS-SP-FILE-SRC(WS-SP)                 
              MOVE 'Y'                 TO WS-SMS-FND-B                          
           END-IF.                                                              
                                                                                
           IF K558-MULTIPLE-FLAT-TRF NOT = SPACES AND LOW-VALUES                
              ADD 1 TO WS-SP                                                    
              MOVE K558-MULTIPLE-FLAT-TRF TO                                    
                                          WS-SP-NUM-HDB-REF(WS-SP)              
              MOVE K558-MULTIPLE-STY-TRF    TO                                  
                                          WS-SP-RESALE-CODE(WS-SP)              
              MOVE WS-DEBAR            TO WS-SP-DEBAR-CODE(WS-SP)               
              MOVE K558-MULTIPLE-DIVORCE-TRF TO                                 
                                          WS-SP-DIVORCE-CODE(WS-SP)             
              MOVE 'TRF'               TO WS-SP-FILE-SRC(WS-SP)                 
           END-IF.                                                              
                                                                                
           PERFORM VARYING WS-CTR3 FROM 1 BY 1 UNTIL WS-CTR3 > 3 OR             
               K558-RESALE-UNIT(WS-CTR3) = SPACES                               
              IF K558-RESALE-UNIT(WS-CTR3) NOT = SPACES AND LOW-VALUES          
                 ADD 1 TO WS-SP                                                 
                 MOVE K558-RESALE-UNIT(WS-CTR3) TO                              
                                WS-SP-NUM-HDB-REF(WS-SP)                        
                 MOVE K558-RESALE-CODE(WS-CTR3) TO                              
                                WS-SP-RESALE-CODE(WS-SP)                        
                 MOVE WS-DEBAR         TO WS-SP-DEBAR-CODE(WS-SP)               
                 MOVE 'RSL'            TO WS-SP-FILE-SRC(WS-SP)                 
                 MOVE 'Y'              TO WS-RSL-FND-B                          
                 IF K558-CDE-FILE-STATUS-RSL NOT = 'OM '                        
                    ADD 1 TO WS-RSL-CNT-B                                       
                 END-IF                                                         
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
                                                                                
       760-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       770-GET-OTH-FLAT-DTLS.                                                   
      *--------------------------------------------------------*                
           MOVE ZEROES      TO WS-OTH.                                          
           MOVE SPACES      TO WS-DEBAR.                                        
                                                                                
           PERFORM VARYING WS-CTR4 FROM 1 BY 1 UNTIL WS-CTR4 > 10               
              MOVE SPACES         TO WS-OTH-NUM-HDB-REF(WS-CTR4)                
                                     WS-OTH-RESALE-CODE(WS-CTR4)                
                                     WS-OTH-FILE-SRC(WS-CTR4)                   
                                     WS-OTH-DIVORCE-CODE(WS-CTR4)               
                                     WS-OTH-DEBAR-CODE(WS-CTR4)                 
           END-PERFORM.                                                         
                                                                                
                                                                                
           IF K558-NUM-DEBARMENT-6 NOT = SPACES AND LOW-VALUES                  
              MOVE K558-NUM-DEBARMENT-6 TO WS-DEBAR                             
           ELSE                                                                 
              MOVE K558-NUM-DEBARMENT-4 TO WS-DEBAR                             
           END-IF.                                                              
                                                                                
           IF K558-NUM-HDB-REF-RSL NOT = SPACES AND LOW-VALUES                  
              ADD 1 TO WS-OTH                                                   
              MOVE K558-NUM-HDB-REF-RSL  TO WS-OTH-NUM-HDB-REF(WS-OTH)          
              MOVE K558-CDE-FILE-STATUS-RSL TO                                  
                                         WS-OTH-RESALE-CODE(WS-OTH)             
              MOVE WS-DEBAR           TO WS-OTH-DEBAR-CODE(WS-OTH)              
              MOVE 'RSL'              TO WS-OTH-FILE-SRC(WS-OTH)                
           END-IF.                                                              
                                                                                
           IF (K558-NUM-HDB-REF-SMS NOT = SPACES AND LOW-VALUES) AND            
              K558-CDE-FILE-STATUS-SMS NOT = 'OM'                               
              ADD 1 TO WS-OTH                                                   
              MOVE K558-NUM-HDB-REF-SMS  TO WS-OTH-NUM-HDB-REF(WS-OTH)          
              MOVE K558-CDE-SALES-TYPE-SMS  TO                                  
                                         WS-OTH-RESALE-CODE(WS-OTH)             
              MOVE WS-DEBAR           TO WS-OTH-DEBAR-CODE(WS-OTH)              
              MOVE 'SMS'              TO WS-OTH-FILE-SRC(WS-OTH)                
           END-IF.                                                              
                                                                                
           IF K558-NUM-HDB-REF-TR  NOT = SPACES AND LOW-VALUES                  
              ADD 1 TO WS-OTH                                                   
              MOVE K558-NUM-HDB-REF-TR  TO WS-OTH-NUM-HDB-REF(WS-OTH)           
              MOVE K558-NUM-SALES-TYPE-TR   TO                                  
                                          WS-OTH-RESALE-CODE(WS-OTH)            
              MOVE WS-DEBAR            TO WS-OTH-DEBAR-CODE(WS-OTH)             
              MOVE K558-NUM-DIVORCE-TR TO WS-OTH-DIVORCE-CODE(WS-OTH)           
              MOVE 'TRF'               TO WS-OTH-FILE-SRC(WS-OTH)               
           END-IF.                                                              
                                                                                
           IF K558-NUM-HDB-REF-MAM NOT = SPACES AND LOW-VALUES                  
              ADD 1 TO WS-OTH                                                   
              MOVE K558-NUM-HDB-REF-MAM  TO WS-OTH-NUM-HDB-REF(WS-OTH)          
              MOVE K558-NUM-SALES-TYPE-MAM  TO                                  
                                          WS-OTH-RESALE-CODE(WS-OTH)            
              MOVE WS-DEBAR            TO WS-OTH-DEBAR-CODE(WS-OTH)             
              MOVE 'MAM'               TO WS-OTH-FILE-SRC(WS-OTH)               
           END-IF.                                                              
                                                                                
           IF K558-NUM-HDB-REF-SLS NOT = SPACES AND LOW-VALUES                  
              ADD 1 TO WS-OTH                                                   
              MOVE K558-NUM-HDB-REF-SLS  TO WS-OTH-NUM-HDB-REF(WS-OTH)          
              MOVE K558-NUM-SALES-TYPE-SLS  TO                                  
                                          WS-OTH-RESALE-CODE(WS-OTH)            
              MOVE WS-DEBAR            TO WS-OTH-DEBAR-CODE(WS-OTH)             
              MOVE 'SLS'               TO WS-OTH-FILE-SRC(WS-OTH)               
           END-IF.                                                              
                                                                                
           IF K558-MULTIPLE-FLAT-SMS NOT = SPACES AND LOW-VALUES                
              ADD 1 TO WS-OTH                                                   
              MOVE K558-MULTIPLE-FLAT-SMS TO                                    
                                          WS-OTH-NUM-HDB-REF(WS-OTH)            
              MOVE K558-MULTIPLE-STY-SMS    TO                                  
                                          WS-OTH-RESALE-CODE(WS-OTH)            
              MOVE WS-DEBAR            TO WS-OTH-DEBAR-CODE(WS-OTH)             
              MOVE 'SMS'               TO WS-OTH-FILE-SRC(WS-OTH)               
           END-IF.                                                              
                                                                                
           IF K558-MULTIPLE-FLAT-TRF NOT = SPACES AND LOW-VALUES                
              ADD 1 TO WS-OTH                                                   
              MOVE K558-MULTIPLE-FLAT-TRF TO                                    
                                          WS-OTH-NUM-HDB-REF(WS-OTH)            
              MOVE K558-MULTIPLE-STY-TRF    TO                                  
                                          WS-OTH-RESALE-CODE(WS-OTH)            
              MOVE WS-DEBAR            TO WS-OTH-DEBAR-CODE(WS-OTH)             
              MOVE K558-MULTIPLE-DIVORCE-TRF TO                                 
                                          WS-OTH-DIVORCE-CODE(WS-OTH)           
              MOVE 'TRF'               TO WS-OTH-FILE-SRC(WS-OTH)               
           END-IF.                                                              
                                                                                
           PERFORM VARYING WS-CTR3 FROM 1 BY 1 UNTIL WS-CTR3 > 3 OR             
               K558-RESALE-UNIT(WS-CTR3) = SPACES                               
              IF K558-RESALE-UNIT(WS-CTR3) NOT = SPACES AND LOW-VALUES          
                 ADD 1 TO WS-OTH                                                
                 MOVE K558-RESALE-UNIT(WS-CTR3) TO                              
                                WS-OTH-NUM-HDB-REF(WS-OTH)                      
                 MOVE K558-RESALE-CODE(WS-CTR3) TO                              
                                WS-OTH-RESALE-CODE(WS-OTH)                      
                 MOVE WS-DEBAR         TO WS-OTH-DEBAR-CODE(WS-OTH)             
                 MOVE 'RSL'            TO WS-OTH-FILE-SRC(WS-OTH)               
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
                                                                                
       770-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       800-WRITE-APP.                                                           
      *--------------------------------------------------------*                
                                                                                
           INITIALIZE                         P13LZ2IA-REC                      
                                              P13LZ2IB-REC                      
                                              P13LZ2IC-REC                      
                                              P13LZ2ID-REC                      
                                              P13LZ2IE-REC                      
                                              P13LZ2IF-REC                      
                                              LZ2I-DETAIL.                      
           MOVE SPACES                          TO   WS-NUM-MS.                 
           EVALUATE WS-NUM-MS-A                                                 
              WHEN '1'                                                          
                 MOVE 'SINGLE   '               TO WS-NUM-MS                    
              WHEN '2'                                                          
                 MOVE 'MARRIED  '               TO WS-NUM-MS                    
              WHEN '3'                                                          
                 MOVE 'WIDOWED  '               TO WS-NUM-MS                    
              WHEN '4'                                                          
                 MOVE 'DIVORCED '               TO WS-NUM-MS                    
              WHEN '5'                                                          
                 MOVE 'SEPARATED'               TO WS-NUM-MS                    
           END-EVALUATE.                                                        
                                                                                
           IF WS-CTR4 = 1                                                       
              IF WS-K730-NTIMER = 'Y'                                           
                 IF TMP-NUM-ALLO-CAT = 'BTO'                                    
                    ADD   1                     TO WS-TOTAL                     
                    MOVE  WS-TOTAL              TO LZ2I-TOTAL                   
                 ELSE                                                           
                    IF TMP-NUM-ALLO-CAT = 'SBF'                                 
                       ADD   1                  TO WS-TOTAL-B                   
                       MOVE  WS-TOTAL-B         TO LZ2I-TOTAL                   
                    ELSE                                                        
                       IF TMP-NUM-ALLO-CAT = 'ROF'                              
                          ADD   1                  TO WS-TOTAL-D                
                          MOVE  WS-TOTAL-D         TO LZ2I-TOTAL                
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              ELSE                                                              
                 IF TMP-NUM-ALLO-CAT = 'BTO'                                    
                    ADD   1                     TO WS-TOTAL-A                   
                    MOVE  WS-TOTAL-A            TO LZ2I-TOTAL                   
                 ELSE                                                           
                    IF TMP-NUM-ALLO-CAT = 'SBF'                                 
                       ADD   1                  TO WS-TOTAL-C                   
                       MOVE  WS-TOTAL-C         TO LZ2I-TOTAL                   
                    ELSE                                                        
                       IF TMP-NUM-ALLO-CAT = 'ROF'                              
                          ADD   1                  TO WS-TOTAL-E                
                          MOVE  WS-TOTAL-E         TO LZ2I-TOTAL                
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
              MOVE WS-NUM-REGN                  TO LZ2I-NUM-REGN                
              MOVE TMP-NUM-ALLO-CAT             TO LZ2I-NUM-SMODE               
              MOVE WS-NUM-NRIC-A                TO LZ2I-NUM-NRIC1               
              MOVE WS-NUM-ZONE                  TO LZ2I-NUM-NT                  
              MOVE WS-NUM-FT                    TO LZ2I-NUM-FT                  
              MOVE WS-RELN-A                    TO LZ2I-RELN                    
              MOVE WS-NUM-MS                    TO LZ2I-MS                      
           END-IF                                                               
                                                                                
           EVALUATE TRUE                                                        
           WHEN WS-TOTAL = 1 AND WS-LZ2IA-HDR = 'N'                             
                MOVE 'Y'             TO WS-LZ2IA-HDR                            
                PERFORM 010-PRINT-HEADING   THRU 010-EXIT                       
           WHEN WS-TOTAL-A = 1 AND WS-LZ2IB-HDR = 'N'                           
                MOVE 'Y'             TO WS-LZ2IB-HDR                            
                PERFORM 020-PRINT-HEADING-A THRU 020-EXIT                       
           WHEN WS-TOTAL-B = 1 AND WS-LZ2IC-HDR = 'N'                           
                MOVE 'Y'             TO WS-LZ2IC-HDR                            
                PERFORM 030-PRINT-HEADING-B THRU 030-EXIT                       
           WHEN WS-TOTAL-C = 1 AND WS-LZ2ID-HDR = 'N'                           
                MOVE 'Y'             TO WS-LZ2ID-HDR                            
                PERFORM 040-PRINT-HEADING-C THRU 040-EXIT                       
           WHEN WS-TOTAL-D = 1 AND WS-LZ2IE-HDR = 'N'                           
                MOVE 'Y'             TO WS-LZ2IE-HDR                            
                PERFORM 050-PRINT-HEADING-D THRU 050-EXIT                       
           WHEN WS-TOTAL-E = 1 AND WS-LZ2IF-HDR = 'N'                           
                MOVE 'Y'             TO WS-LZ2IF-HDR                            
                PERFORM 060-PRINT-HEADING-E THRU 060-EXIT                       
           END-EVALUATE.                                                        
                                                                                
           MOVE WS-APP-NUM-HDB-REF(WS-CTR4)     TO LZ2I-HDB-REF.                
           MOVE WS-APP-RESALE-CODE(WS-CTR4)     TO LZ2I-RESALE-STATUS.          
           MOVE WS-APP-FILE-SRC(WS-CTR4)        TO LZ2I-CODE.                   
           MOVE WS-APP-DIVORCE-CODE(WS-CTR4)    TO LZ2I-DIVORCE.                
           MOVE WS-APP-DEBAR-CODE(WS-CTR4)      TO LZ2I-DEBAR.                  
                                                                                
           PERFORM 830-WRITE-REPORT THRU 830-EXIT.                              
                                                                                
       800-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       810-WRITE-SP.                                                            
      *--------------------------------------------------------*                
                                                                                
           INITIALIZE                         P13LZ2IA-REC                      
                                              P13LZ2IB-REC                      
                                              P13LZ2IC-REC                      
                                              P13LZ2ID-REC                      
                                              P13LZ2IE-REC                      
                                              P13LZ2IF-REC                      
                                              LZ2I-DETAIL.                      
                                                                                
           MOVE SPACES                          TO   WS-NUM-MS.                 
           EVALUATE WS-NUM-MS-B                                                 
              WHEN '1'                                                          
                 MOVE 'SINGLE   '               TO WS-NUM-MS                    
              WHEN '2'                                                          
                 MOVE 'MARRIED  '               TO WS-NUM-MS                    
              WHEN '3'                                                          
                 MOVE 'WIDOWED  '               TO WS-NUM-MS                    
              WHEN '4'                                                          
                 MOVE 'DIVORCED '               TO WS-NUM-MS                    
              WHEN '5'                                                          
                 MOVE 'SEPARATED'               TO WS-NUM-MS                    
           END-EVALUATE.                                                        
                                                                                
           IF WS-CTR4 = 1                                                       
              IF WS-K730-NTIMER = 'Y'                                           
                 IF TMP-NUM-ALLO-CAT = 'BTO'                                    
                    ADD   1                     TO WS-TOTAL                     
                    MOVE  WS-TOTAL              TO LZ2I-TOTAL                   
                 ELSE                                                           
                    IF TMP-NUM-ALLO-CAT = 'SBF'                                 
                       ADD   1                  TO WS-TOTAL-B                   
                       MOVE  WS-TOTAL-B         TO LZ2I-TOTAL                   
                    ELSE                                                        
                       IF TMP-NUM-ALLO-CAT = 'ROF'                              
                          ADD   1                  TO WS-TOTAL-D                
                          MOVE  WS-TOTAL-D         TO LZ2I-TOTAL                
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              ELSE                                                              
                 IF TMP-NUM-ALLO-CAT = 'BTO'                                    
                    ADD   1                     TO WS-TOTAL-A                   
                    MOVE  WS-TOTAL-A            TO LZ2I-TOTAL                   
                 ELSE                                                           
                    IF TMP-NUM-ALLO-CAT = 'SBF'                                 
                       ADD   1                  TO WS-TOTAL-C                   
                       MOVE  WS-TOTAL-C         TO LZ2I-TOTAL                   
                    ELSE                                                        
                       IF TMP-NUM-ALLO-CAT = 'ROF'                              
                          ADD   1                  TO WS-TOTAL-E                
                          MOVE  WS-TOTAL-E         TO LZ2I-TOTAL                
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
              MOVE WS-NUM-REGN                  TO LZ2I-NUM-REGN                
              MOVE TMP-NUM-ALLO-CAT             TO LZ2I-NUM-SMODE               
              MOVE WS-NUM-NRIC-B                TO LZ2I-NUM-NRIC1               
              MOVE WS-NUM-ZONE                  TO LZ2I-NUM-NT                  
              MOVE WS-NUM-FT                    TO LZ2I-NUM-FT                  
              MOVE WS-RELN-B                    TO LZ2I-RELN                    
              MOVE WS-NUM-MS                    TO LZ2I-MS                      
           END-IF                                                               
                                                                                
           MOVE WS-SP-NUM-HDB-REF(WS-CTR4)     TO LZ2I-HDB-REF.                 
           MOVE WS-SP-RESALE-CODE(WS-CTR4)     TO LZ2I-RESALE-STATUS.           
           MOVE WS-SP-FILE-SRC(WS-CTR4)        TO LZ2I-CODE.                    
           MOVE WS-SP-DIVORCE-CODE(WS-CTR4)    TO LZ2I-DIVORCE.                 
           MOVE WS-SP-DEBAR-CODE(WS-CTR4)      TO LZ2I-DEBAR.                   
                                                                                
           PERFORM 830-WRITE-REPORT THRU 830-EXIT.                              
                                                                                
       810-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       820-WRITE-OTH.                                                           
      *--------------------------------------------------------*                
                                                                                
           INITIALIZE                         P13LZ2IA-REC                      
                                              P13LZ2IB-REC                      
                                              P13LZ2IC-REC                      
                                              P13LZ2ID-REC                      
                                              P13LZ2IE-REC                      
                                              P13LZ2IF-REC                      
                                              LZ2I-DETAIL.                      
                                                                                
           MOVE SPACES                          TO   WS-NUM-MS.                 
           EVALUATE WS-NUM-MS-C                                                 
              WHEN '1'                                                          
                 MOVE 'SINGLE   '               TO WS-NUM-MS                    
              WHEN '2'                                                          
                 MOVE 'MARRIED  '               TO WS-NUM-MS                    
              WHEN '3'                                                          
                 MOVE 'WIDOWED  '               TO WS-NUM-MS                    
              WHEN '4'                                                          
                 MOVE 'DIVORCED '               TO WS-NUM-MS                    
              WHEN '5'                                                          
                 MOVE 'SEPARATED'               TO WS-NUM-MS                    
           END-EVALUATE.                                                        
                                                                                
           IF WS-CTR4 = 1                                                       
              IF WS-K730-NTIMER = 'Y'                                           
                 IF TMP-NUM-ALLO-CAT = 'BTO'                                    
                    ADD   1                     TO WS-TOTAL                     
                    MOVE  WS-TOTAL              TO LZ2I-TOTAL                   
                 ELSE                                                           
                    IF TMP-NUM-ALLO-CAT = 'SBF'                                 
                       ADD   1                  TO WS-TOTAL-B                   
                       MOVE  WS-TOTAL-B         TO LZ2I-TOTAL                   
                    ELSE                                                        
                       IF TMP-NUM-ALLO-CAT = 'ROF'                              
                          ADD   1                  TO WS-TOTAL-D                
                          MOVE  WS-TOTAL-D         TO LZ2I-TOTAL                
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              ELSE                                                              
                 IF TMP-NUM-ALLO-CAT = 'BTO'                                    
                    ADD   1                     TO WS-TOTAL-A                   
                    MOVE  WS-TOTAL-A            TO LZ2I-TOTAL                   
                 ELSE                                                           
                    IF TMP-NUM-ALLO-CAT = 'SBF'                                 
                       ADD   1                  TO WS-TOTAL-C                   
                       MOVE  WS-TOTAL-C         TO LZ2I-TOTAL                   
                    ELSE                                                        
                       IF TMP-NUM-ALLO-CAT = 'ROF'                              
                          ADD   1                  TO WS-TOTAL-E                
                          MOVE  WS-TOTAL-E         TO LZ2I-TOTAL                
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
              MOVE WS-NUM-REGN                  TO LZ2I-NUM-REGN                
              MOVE TMP-NUM-ALLO-CAT             TO LZ2I-NUM-SMODE               
              MOVE WS-NUM-NRIC-C                TO LZ2I-NUM-NRIC1               
              MOVE WS-NUM-ZONE                  TO LZ2I-NUM-NT                  
              MOVE WS-NUM-FT                    TO LZ2I-NUM-FT                  
              MOVE WS-RELN-C                    TO LZ2I-RELN                    
              MOVE WS-NUM-MS                    TO LZ2I-MS                      
           END-IF                                                               
                                                                                
           MOVE WS-OTH-NUM-HDB-REF(WS-CTR4)     TO LZ2I-HDB-REF.                
           MOVE WS-OTH-RESALE-CODE(WS-CTR4)     TO LZ2I-RESALE-STATUS.          
           MOVE WS-OTH-FILE-SRC(WS-CTR4)        TO LZ2I-CODE.                   
           MOVE WS-OTH-DIVORCE-CODE(WS-CTR4)    TO LZ2I-DIVORCE.                
           MOVE WS-OTH-DEBAR-CODE(WS-CTR4)      TO LZ2I-DEBAR.                  
                                                                                
           PERFORM 830-WRITE-REPORT THRU 830-EXIT.                              
                                                                                
       820-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       830-WRITE-REPORT.                                                        
      *--------------------------------------------------------*                
                                                                                
           IF WS-K730-NTIMER = 'Y'                                              
              IF TMP-NUM-ALLO-CAT = 'BTO'                                       
                 IF WS-LINE-CNT > 59                                            
                    MOVE ZEROES               TO WS-LINE-CNT                    
                    PERFORM 010-PRINT-HEADING THRU 010-EXIT                     
                 END-IF                                                         
                                                                                
                 WRITE P13LZ2IA-REC           FROM LZ2I-DETAIL                  
                 ADD 1                        TO WS-LINE-CNT                    
                 MOVE SPACES                  TO P13LZ2IA-REC                   
                 INITIALIZE                      P13LZ2IA-REC                   
              ELSE                                                              
                 IF TMP-NUM-ALLO-CAT = 'SBF'                                    
                    IF WS-LINE-CNT-B > 59                                       
                       MOVE ZEROES            TO WS-LINE-CNT-B                  
                       PERFORM 030-PRINT-HEADING-B THRU 030-EXIT                
                    END-IF                                                      
                                                                                
                    WRITE P13LZ2IC-REC        FROM LZ2I-DETAIL                  
                    ADD 1                     TO WS-LINE-CNT-B                  
                    MOVE SPACES               TO P13LZ2IC-REC                   
                    INITIALIZE                   P13LZ2IC-REC                   
                 ELSE                                                           
                    IF TMP-NUM-ALLO-CAT = 'ROF'                                 
                       IF WS-LINE-CNT-D > 59                                    
                          MOVE ZEROES            TO WS-LINE-CNT-D               
                          PERFORM 050-PRINT-HEADING-D THRU 050-EXIT             
                       END-IF                                                   
                                                                                
                       WRITE P13LZ2IE-REC        FROM LZ2I-DETAIL               
                       ADD 1                     TO WS-LINE-CNT-D               
                       MOVE SPACES               TO P13LZ2IE-REC                
                       INITIALIZE                   P13LZ2IE-REC                
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              IF TMP-NUM-ALLO-CAT = 'BTO'                                       
                 IF WS-LINE-CNT-A > 59                                          
                    MOVE ZEROES               TO WS-LINE-CNT-A                  
                    PERFORM 020-PRINT-HEADING-A THRU 020-EXIT                   
                 END-IF                                                         
                                                                                
                 WRITE P13LZ2IB-REC           FROM LZ2I-DETAIL                  
                 ADD 1                        TO WS-LINE-CNT-A                  
                 MOVE SPACES                  TO P13LZ2IB-REC                   
                 INITIALIZE                      P13LZ2IB-REC                   
              ELSE                                                              
                 IF TMP-NUM-ALLO-CAT = 'SBF'                                    
                    IF WS-LINE-CNT-C > 59                                       
                       MOVE ZEROES              TO WS-LINE-CNT-C                
                       PERFORM 040-PRINT-HEADING-C THRU 040-EXIT                
                    END-IF                                                      
                                                                                
                    WRITE P13LZ2ID-REC        FROM LZ2I-DETAIL                  
                    ADD 1                     TO WS-LINE-CNT-C                  
                    MOVE SPACES               TO P13LZ2ID-REC                   
                    INITIALIZE                   P13LZ2ID-REC                   
                 ELSE                                                           
                    IF TMP-NUM-ALLO-CAT = 'ROF'                                 
                       IF WS-LINE-CNT-E > 59                                    
                          MOVE ZEROES              TO WS-LINE-CNT-E             
                          PERFORM 060-PRINT-HEADING-E THRU 060-EXIT             
                       END-IF                                                   
                                                                                
                       WRITE P13LZ2IF-REC        FROM LZ2I-DETAIL               
                       ADD 1                     TO WS-LINE-CNT-E               
                       MOVE SPACES               TO P13LZ2IF-REC                
                       INITIALIZE                   P13LZ2IF-REC                
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       830-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *--------------------------------------------------------*                
       900-CLOSE-ROUTINE.                                                       
      *--------------------------------------------------------*                
                                                                                
           DISPLAY ' '.                                                         
           DISPLAY 'BP13CZ2I                 CURR-DATE : ' WS-DATE.             
           DISPLAY 'REPORT ON MULTIPLE DP FLATS'.                               
           DISPLAY '*-----------------------------------------------*'.         
           DISPLAY 'NO OF RECORDS READ FROM TMP    ' WS-TMP-READ.               
           DISPLAY 'NO OF RECORDS FND IN BP13K730  ' K730-FND-CNT.              
           DISPLAY 'NO OF RECORDS NFND IN BP13K730 ' K730-NFND-CNT.             
           DISPLAY 'NO OF RECORDS UPD  IN BP13K730 ' WS-K730-UPD.               
           DISPLAY 'NO OF RECORDS FND IN BP13K558  ' WS-K558-FND-CNT.           
           DISPLAY 'NO OF PA/SSE RECS EXCLUDED     ' WS-EXCLUDE.                
           DISPLAY 'NO OF LZ2A RECORDS WRITTEN     ' WS-TOTAL.                  
           DISPLAY 'NO OF LZ2B RECORDS WRITTEN     ' WS-TOTAL-A.                
           DISPLAY 'NO OF LZ2C RECORDS WRITTEN     ' WS-TOTAL-B.                
           DISPLAY 'NO OF LZ2D RECORDS WRITTEN     ' WS-TOTAL-C.                
           DISPLAY 'NO OF LZ2E RECORDS WRITTEN     ' WS-TOTAL-D.                
           DISPLAY 'NO OF LZ2F RECORDS WRITTEN     ' WS-TOTAL-E.                
                                                                                
           CLOSE BP13K558                                                       
                 BP13K730                                                       
                 BP13TMP                                                        
                 P13LZ2IA                                                       
                 P13LZ2IB                                                       
                 P13LZ2IC                                                       
                 P13LZ2ID                                                       
                 P13LZ2IE                                                       
                 P13LZ2IF.                                                      
                                                                                
           IF BP13K730-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR CLOSING BP13K730 (' BP13K730-STATUS ')'            
              MOVE BP13K730-STATUS           TO RETURN-CODE                     
              GO TO 900-CLOSE-ROUTINE                                           
           END-IF.                                                              
                                                                                
           IF BP13K558-STATUS NOT = 00 AND 97                                   
              DISPLAY 'ERROR CLOSING BP13K558 (' BP13K558-STATUS ')'            
              MOVE BP13K558-STATUS           TO RETURN-CODE                     
              GO TO 900-CLOSE-ROUTINE                                           
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
       900-EXIT.                                                                
           EXIT.                                                                
