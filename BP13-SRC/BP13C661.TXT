      ***************************                                               
       IDENTIFICATION DIVISION.                                                 
      ***************************                                               
       PROGRAM-ID.    BP13C661.                                                 
       AUTHOR.        SGK.                                                      
      *DATE-WRITTEN.  17/02/98.                                                 
                                                                                
      * ============================================================== *        
      *                  SYSTEM OF COMMITMENT  (BP13)                  *        
      * ============================================================== *        
      *                                                                *        
      *   OBJECTIVE   :  1.  THIS IS A PROGRAM TO PRINT OUT            *        
      *                      SA-TP LETTER FOR CA CASES.                *        
      *                      (FOR SERS, STD, RP ,RED CASES ONLY)       *        
      *                                                                *        
      *   LETTER/FORM :   BP1325, BP1326, BP1336                       *        
      *                   BP1305, BP13KP, BP134L, BP134N               *        
      *                                                                *        
      *   INPUT FILES :  1.  BP13F310  -  TRANSACTION FILE             *        
      *                  2.  BP13K800  -  SOC APPLICATION MASTER FILE  *        
      *                  3.  BP13K820  -  SOC OCCUPIER FILE            *        
      *                  4.  BP13K830  -  CORR ADDRESS FILE            *        
      *                  5.  BM06K100  -  BLOCK FILE                   *        
      *                  6.  BM06K110  -  FLATINV FILE                 *        
      *                                                                *        
      *   LISTINGS    :  1.  BP13L661                                  *        
      *                      SALES AGREEMENT APPOINTMENT LETTER +      *        
      *                      HOUSE HOLD LETTER + WORKSHEET             *        
      *                  2.  P13L661A                                  *        
      *                      COPY OF APPOINTMENT LETTER(SER)           *        
      *                  3.  P13L661B                                  *        
      *                      CONTROL LIST                              *        
      *                                                                *        
      *  CHGE-NO   BY    DATE    DESCRIPTION                           *        
      *  -------   ---  ------   -----------                           *        
      *  BP132485  MJ16 020304   TO INCLUDE CHECKING OF SERS TABLE     *        
      *                          TO SERS INCLUDE 3 NEW ALLOC SCHEMES   *        
      *                          TABLE.('SFO','SRO','SJO')             *        
      *  BP132554  JF4  070704   PRINT BO/TC/CC CODE IN APPT LETTER    *        
      *  BP132568  JF4  220704   CATER FOR ENHANCEMENT OF APPT LETTER  *        
      *  BP132588  JF4  240804   PASS SYSTEM DATE TO AB20C900 PROGRAM  *        
      *  BP132660  JF4  150305   CATER FOR OCS OPT-IN AND PREMIUM      *        
      *  BP135109  JGO1 241213   REMOVE HARDCODE OF HDBSALES EMAIL     *        
      ******************************************************************        
                                                                                
      ***********************                                                   
       ENVIRONMENT DIVISION.                                                    
      ***********************                                                   
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F310  ASSIGN       TO BP13F310.                           
                                                                                
           SELECT BP13K022  ASSIGN       TO BP13K022                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K022-KEY-FLD                        
                            ALTERNATE RECORD KEY IS K022-NUM-REGN               
                            WITH DUPLICATES                                     
                            FILE STATUS  IS BP13K022-STATUS.                    
                                                                                
           SELECT BP13K024  ASSIGN       TO BP13K024                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K024-KEY-FLD                        
                            FILE STATUS  IS BP13K024-STATUS.                    
                                                                                
           SELECT BP13K800  ASSIGN       TO BP13K800                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K800-NUM-REGN                       
                            FILE STATUS  IS BP13K800-STATUS.                    
                                                                                
           SELECT BP13K820  ASSIGN       TO BP13K820                            
                            ACCESS MODE  IS DYNAMIC                             
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K820-KEY-FLD                        
                            FILE STATUS  IS BP13K820-STATUS.                    
                                                                                
           SELECT BP13K830  ASSIGN       TO BP13K830                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K830-KEY-FLD                        
                            ALTERNATE RECORD KEY IS K830-NUM-REGN               
                            FILE STATUS  IS BP13K830-STATUS.                    
                                                                                
           SELECT BP13K640  ASSIGN       TO BP13K640                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K640-KEY-FLD                        
                            FILE STATUS  IS BP13K640-STATUS.                    
                                                                                
           SELECT BM06K110  ASSIGN       TO BM06K110                            
                            ACCESS  MODE IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD   KEY IS K110-KEY-FLD                        
                            FILE STATUS  IS BM06K110-STATUS.                    
                                                                                
           SELECT BM06K100  ASSIGN       TO BM06K100                            
                            ACCESS MODE  IS RANDOM                              
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K100-KEY-FLD                        
                            FILE STATUS  IS BM06K100-STATUS.                    
                                                                                
           SELECT AB03K050  ASSIGN       TO AB03K050                            
                            ACCESS MODE  IS DYNAMIC                             
                            ORGANIZATION IS INDEXED                             
                            RECORD KEY   IS K050-KEY                            
                            FILE STATUS  IS AB03K050-STATUS.                    
                                                                                
           SELECT P13L661A  ASSIGN       TO P13L661A.                           
           SELECT P13L661B  ASSIGN       TO P13L661B.                           
           SELECT P13L661C  ASSIGN       TO P13L661C.                           
           SELECT P13L661D  ASSIGN       TO P13L661D.                           
           SELECT P13L661E  ASSIGN       TO P13L661E.                           
           SELECT P13L661G  ASSIGN       TO P13L661G.                           
           SELECT P13L661H  ASSIGN       TO P13L661H.                           
                                                                                
                                                                                
      *****************                                                         
       DATA DIVISION.                                                           
      *****************                                                         
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD   BP13F310                                                            
            RECORDING MODE  IS  F                                               
            RECORD CONTAINS 150 CHARACTERS.                                     
       COPY BP13F310.                                                           
                                                                                
       FD   BP13K022                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K022.                                                           
                                                                                
       FD   BP13K024                                                            
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K024.                                                           
                                                                                
       FD   BM06K100                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K100.                                                           
                                                                                
       FD   BM06K110                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K110.                                                           
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD   BP13K830                                                            
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD   BP13K640                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13K640.                                                           
                                                                                
       FD   AB03K050                                                            
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY AB03K050.                                                           
                                                                                
       FD  P13L661A                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132 CHARACTERS.                                      
       01  PRINT-REC-A                      PIC X(132).                         
                                                                                
       FD  P13L661B                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132  CHARACTERS.                                     
       01  P13L661B-REC                       PIC X(132).                       
                                                                                
       FD  P13L661C                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132  CHARACTERS.                                     
       01  PRINT-REC2                         PIC X(132).                       
                                                                                
       FD  P13L661D                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132  CHARACTERS.                                     
       01  PRINT-REC3                         PIC X(132).                       
                                                                                
       FD  P13L661E                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 132  CHARACTERS.                                     
       01  PRINT-REC4                         PIC X(132).                       
                                                                                
       FD  P13L661G                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 80  CHARACTERS.                                      
       01  PRINT-REC6                         PIC X(80).                        
                                                                                
       FD  P13L661H                                                             
           RECORDING MODE  IS  F                                                
           RECORD CONTAINS 80  CHARACTERS.                                      
       01  PRINT-REC7                         PIC X(80).                        
                                                                                
      *------------------------*                                                
       WORKING-STORAGE SECTION.                                                 
      *------------------------*                                                
                                                                                
       COPY SERSCH.                                                             
       COPY AB20M97C.                                                           
       COPY P13COMCD.                                                           
                                                                                
       01  WS-C908-PARAMETERS.                                                  
           05  WS-INPUT-PARAMETERS.                                             
               10  WS-C908-TXT-IN-SIZE       PIC 9(2).                          
               10  WS-C908-TXT-INPUT         PIC X(30).                         
           05  WS-OUTPUT-PARAMETERS.                                            
               10  WS-C908-TXT-OUT-SIZE      PIC 9(2).                          
               10  WS-C908-TXT-OUTPUT        PIC X(40).                         
           05  WS-C908-RETCODE               PIC S9(04)  COMP.                  
                                                                                
       01  WS-INDICATORS.                                                       
           05  BP13K022-STATUS              PIC 99    VALUE ZEROS.              
           05  BP13K024-STATUS              PIC 99    VALUE ZEROS.              
           05  BP13K800-STATUS              PIC 99    VALUE ZEROS.              
           05  BP13K820-STATUS              PIC 99    VALUE ZEROS.              
           05  BP13K830-STATUS              PIC 99    VALUE ZEROS.              
           05  BP13K640-STATUS              PIC 99    VALUE ZEROS.              
           05  BM06K100-STATUS              PIC 99    VALUE ZEROS.              
           05  BM06K110-STATUS              PIC 99    VALUE ZEROS.              
           05  AB03K050-STATUS              PIC 99    VALUE ZEROS.              
           05  WS-F310-EOF                  PIC X     VALUE 'N'.                
           05  WS-K050-EOF                  PIC X     VALUE 'N'.                
           05  WS-K820-EOF                  PIC X     VALUE 'N'.                
           05  WS-REGN-CHGE                 PIC X     VALUE 'N'.                
           05  K110-NOT-FOUND               PIC X     VALUE 'N'.                
           05  K800-NOT-FOUND               PIC X     VALUE 'N'.                
           05  K820-NOT-FOUND               PIC X     VALUE 'N'.                
           05  K830-NOT-FOUND               PIC X     VALUE 'N'.                
           05  WS-FIRST-CASE                PIC X     VALUE 'Y'.                
           05  K022-FOUND                   PIC X     VALUE 'N'.                
           05  K024-FOUND                   PIC X     VALUE 'N'.                
           05  WS-NUM-OIC                   PIC X(5).                           
           05  WS-OIC-TABLE.                                                    
               10 WS-OIC-TAB OCCURS 5 TIMES PIC X.                              
           05  WS-OIC-EMAIL-TABLE.                                              
               10 WS-OIC-EMAIL-TAB OCCURS 5 TIMES PIC X.                        
                                                                                
       01  WS-AB03K050-REC                  PIC X(200) VALUE SPACES.            
       01  WS-K050-CDE-LOAN-SCH             PIC X      VALUE SPACES.            
       01  WS-COUNTERS.                                                         
           05  WS-CNT-F310                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CNT-K110                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CNT-K820                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CNT-K830                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CNT-K640                  PIC 9(3)  VALUE ZEROS.              
           05  WS-PAGE-NO                   PIC 9(4)  VALUE ZEROS.              
           05  WS-CNT                       PIC 9(2)  VALUE ZEROS.              
           05  WS-SEQ-NO                    PIC 9(4)  VALUE ZEROS.              
           05  WS-CNT-PROC                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CNT-LETTERS               PIC 9(6)  VALUE ZEROS.              
           05  WS-CNT-SKIPPED               PIC 9(6)  VALUE ZEROS.              
           05  WS-EDT-LETTERS               PIC 9(6)  VALUE ZEROS.              
           05  WS-EDT-SKIPPED               PIC 9(6)  VALUE ZEROS.              
           05  WS-PRINT-LETTERS             PIC X(1)  VALUE SPACE.              
           05  WS-CNT-CONTROL               PIC 9(6)  VALUE ZERO.               
           05  WS-CNT-K024                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CNT-K022                  PIC 9(3)  VALUE ZEROS.              
           05  WS-CTR                       PIC 9     VALUE ZEROS.              
           05  WS-CTR2                      PIC 9     VALUE ZEROS.              
                                                                                
       01  WS-OTHER-VARIABLES.                                                  
           05  WS-DIFF                      PIC S9(5)  VALUE ZEROS.             
           05  WS-EMAIL                     PIC X(19)  VALUE SPACES.            
           05  WS-HDR-PHONE-DID             PIC X(25)  VALUE SPACES.            
                                                                                
           05  WS-NAME                      PIC X(66) VALUE SPACES.             
                                                                                
           05  WS-K820-KEY.                                                     
               10  WS-K820-REGN             PIC X(8)  VALUE SPACES.             
               10  FILLER                   PIC X(9)  VALUE SPACES.             
                                                                                
           05  WS-ACC.                                                          
               10  WS-ACCOUNT               PIC X(4)  VALUE SPACES.             
               10  WS-CDG                   PIC X(1)  VALUE SPACE.              
                                                                                
           05  WS-NUM-FIELD.                                                    
               10  WS-REM                   PIC 9(3)  VALUE ZEROES.             
               10  WS-YEAR                  PIC 9(4)  VALUE ZEROES.             
               10  WS-IN-DATE               PIC 9(8)  VALUE ZEROES.             
               10  WS-SC-CC1-AMT            PIC 9(5)V99     VALUE ZEROS.        
               10  WS-SC-CC2-AMT            PIC 9(5)V99     VALUE ZEROS.        
               10  WS-S903-SC-CC1-GST       PIC 9(4)V99     VALUE ZEROS.        
               10  WS-S903-SC-CC2-GST       PIC 9(4)V99     VALUE ZEROS.        
               10  WS-S903-SC-CC3-GST       PIC 9(4)V99     VALUE ZEROS.        
               10  WS-S903-SC-TC1-GST       PIC 9(4)V99     VALUE ZEROS.        
               10  WS-S903-SC-TC2-GST       PIC 9(4)V99     VALUE ZEROS.        
               10  WS-S903-SC-TC3-GST       PIC 9(4)V99     VALUE ZEROS.        
               10  WS-SC-CC-NUM-AMT         PIC 9(4)V99     VALUE ZEROS.        
               10  WS-SC-CC-NUM-AMT-GST     PIC 9(4)V99     VALUE ZEROS.        
               10  WS-ICP-TOP-UP            PIC S9(7)V99    VALUE ZEROS.        
                                                                                
           05  WS-SUB-UNIT.                                                     
               10  FILLER                   PIC X     VALUE '-'.                
               10  SUB-UNIT-NO              PIC X(3)  VALUE ZEROES.             
                                                                                
           05  WS-SC-CC-DESC.                                                   
               10  FILLER                   PIC X(1)   VALUE '('.               
               10  WS-SC-CC-AMT             PIC ZZ9.99 VALUE SPACES.            
               10  FILLER                   PIC X(1)   VALUE '+'.               
               10  WS-SC-CC-AMT-GST         PIC   9.99 VALUE SPACES.            
               10  FILLER                   PIC X(3)   VALUE 'GST'.             
               10  WS-SC-CC-SIGN            PIC X(1)   VALUE '-'.               
               10  WS-SC-CC-REBATE-AMT      PIC   Z.ZZ VALUE SPACES.            
               10  WS-SC-CC-REBATE-DESC     PIC X(3)   VALUE 'REB'.             
               10  WS-SC-CC-SIGN2           PIC X(1)   VALUE '-'.               
               10  WS-SC-CC-GRANT-AMT       PIC   Z.ZZ VALUE SPACES.            
               10  WS-SC-CC-GRANT-DESC      PIC X(3)   VALUE 'GRT'.             
               10  WS-SC-CC-SIGN3           PIC X(1)   VALUE '-'.               
               10  WS-SC-CC-REB-SP-AMT      PIC   Z.ZZ VALUE SPACES.            
               10  WS-SC-CC-REB-SP-DESC     PIC X(3)   VALUE 'SP)'.             
                                                                                
           05  WS-TEMP-DEC-SPRICE           PIC 9(8)V99  VALUE ZERO.            
           05  WS-DEC-SPRICE                PIC 9(8)V99  VALUE ZERO.            
           05  WS-TEMP-INT-SPRICE           PIC 9(8)     VALUE ZERO.            
           05  WS-INT-SPRICE                PIC 9(8)     VALUE ZERO.            
           05  WS-PREMIUM-ST-FEE-NEW        PIC 9(5)V99  VALUE ZERO.            
           05  WS-PREMIUM-ST-FEE-ORIG       PIC 9(5)V99  VALUE ZERO.            
           05  WS-PREMIUM-ST-FEE            PIC 9(5)V99  VALUE ZERO.            
           05  WS-EDT-OFFER-PRICE           PIC $$,$$$,$$9.                     
           05  WS-K110-OSP                  PIC 9(8)     VALUE ZEROS.           
           05  WS-K110-1ST-OSP              PIC 9(8)     VALUE ZEROS.           
           05  WS-EDT-OCS-AMT               PIC $$$9.                           
           05  WS-OCS-AMT                   PIC 9(4)     VALUE ZEROES.          
           05  WS-EDT-PODF-AMT              PIC $$$$9.                          
           05  WS-PODF-AMT                  PIC 9(6)     VALUE ZEROES.          
           05  WS-NUM-OPT-IN                PIC X(1)     VALUE SPACE.           
           05  WS-SERS-DISC                 PIC 9(8)     VALUE ZEROES.          
           05  WS-CONVEY-FEE                PIC 9(3)V99  VALUE ZERO.            
           05  WS-CONVEY-FEE1               PIC 9(3)V99  VALUE ZERO.            
           05  WS-CONVEY-FEE2               PIC 9(3)V99  VALUE ZERO.            
           05  WS-CONVEY-FEE-GST            PIC 9(3)V99  VALUE ZERO.            
           05  WS-TOT-CONVEY-FEE            PIC 9(5)V99  VALUE ZERO.            
           05  WS-INT-CONVEY-FEE            PIC 9(3)     VALUE ZERO.            
           05  WS-HH-INCOME                 PIC 9(6)     VALUE ZEROES.          
           05  WS-CA-INCOME                 PIC 9(6)     VALUE ZEROES.          
           05  WS-AMT-PREMIUM               PIC 9(6)V99  VALUE ZEROES.          
           05  WS-TMP-PREMIUM               PIC 9(6)V99  VALUE ZEROES.          
           05  WS-AMT-PREMIUM-EDT           PIC $$$$,$$9.99.                    
           05  WS-PURCHASE-PRICE            PIC 9(8)V99  VALUE ZEROES.          
           05  WS-CONTROL-PR-LINE           PIC 9(2)     VALUE 60.              
           05  WS-CONTROL-PAGE-NO           PIC 9(3)     VALUE ZERO.            
           05  WS-K110-CSPRICE              PIC 9(8)     VALUE ZEROES.          
           05  WS-K110-CSPRICE-PREMIUM      PIC 9(9)     VALUE ZEROES.          
           05  WS-COMP-SELLPR               PIC S9(8)V99 VALUE ZEROES.          
           05  WS-COMP-SELLPR-PREMIUM       PIC S9(9)V99 VALUE ZEROES.          
           05  WS-COMP-LS-FEE               PIC S9(8)V99 VALUE ZEROES.          
           05  WS-COMP-CV-FEE               PIC S9(8)V99 VALUE ZEROES.          
           05  WS-COMP-TOTAL                PIC S9(8)V99 VALUE ZEROES.          
           05  WS-LS-LEAVE                  PIC S9(8)V99 VALUE ZEROES.          
           05  WS-CONV-LEAVE                PIC S9(8)V99 VALUE ZEROES.          
           05  WS-ROUND-CONVFEE             PIC S9(8)V99 VALUE ZEROES.          
           05  WS-TOTAL-SELLPR              PIC S9(8)V99 VALUE ZEROES.          
           05  WS-BALANCE-AMT               PIC S9(8)V99 VALUE ZEROES.          
           05  WS-BALANCE                   PIC S9(7)V99 VALUE ZEROES.          
           05  WS-MAX-LOAN-AMT              PIC S9(7)V99 VALUE ZEROES.          
           05  WS-TOTAL-CD                  PIC S9(7)V99 VALUE ZEROES.          
           05  WS-TOTAL-FEES                PIC S9(6)V99 VALUE ZEROES.          
           05  WS-COMP-SURVEY-FEE           PIC S9(5)V99 VALUE ZEROES.          
           05  WS-COMP-LEASE                PIC S9(5)V99 VALUE ZEROES.          
           05  WS-COMP-MORTGAGE             PIC S9(5)V99 VALUE ZEROES.          
           05  WS-TOT-STAMP-FEE             PIC S9(5)V99 VALUE ZEROES.          
           05  WS-MORT-STAMP-FEE            PIC S9(5)V99 VALUE ZEROES.          
           05  WS-TOT-SCCC                  PIC S9(5)V99 VALUE ZEROES.          
           05  WS-INTREST-RATE              PIC 9(2)V99  VALUE ZEROES.          
           05  WS-MTHLY-INSTAL              PIC 9(5)V99  VALUE ZEROES.          
           05  WS-LOAN-ROUND-DOWN.                                              
               10  WS-LOAN-INT-5            PIC 9(5)     VALUE ZEROS.           
               10  WS-LOAN-INT-2            PIC 9(2)V99  VALUE ZEROS.           
           05  WS-LOAN-ROUND-R  REDEFINES                                       
                        WS-LOAN-ROUND-DOWN  PIC 9(7)V99.                        
           05  WS-SF-OFFER-PRICE            PIC S9(8)V99 VALUE ZEROES.          
                                                                                
           05  WS-COMPARE-DATE.                                                 
               10  WS-COMPARE-YYYY         PIC 9(4)   VALUE ZEROS.              
               10  WS-COMPARE-MM           PIC 99     VALUE ZEROS.              
                   88  FIRST-HALF              VALUE 01 02 03 04 05 06.         
                   88  SECOND-HALF             VALUE 07 08 09 10 11 12.         
               10  WS-COMPARE-DD           PIC 99     VALUE ZEROS.              
                                                                                
           05  WS-COMPUTE-DATE.                                                 
               10  WS-COMPUTE-YYYY      PIC 9(4)   VALUE ZEROS.                 
               10  WS-COMPUTE-MM        PIC 99     VALUE ZEROS.                 
               10  WS-COMPUTE-DD        PIC 99     VALUE ZEROS.                 
                                                                                
       01 WS-SERS-VARIABLES.                                                    
          05 WS-ALLOC-SCH               PIC X(03).                              
          05 WS-SCH-FND                 PIC X(01).                              
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED  TO SUB-PROGRAM "BP13C901"         *             
      *-----------------------------------------------------------*             
       01  WS-LINK-S901.                                                        
           05  WS-S901-INT                 PIC 9V9(4)   VALUE ZEROES.           
           05  WS-S901-FAC                 PIC 9(2)     VALUE ZEROES.           
           05  WS-S901-ERL                 PIC X        VALUE SPACE.            
           05  WS-S901-LOAN-AMT            PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S901-ERL-LOAN-AMT        PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S901-REPAY-PD            PIC 99       VALUE ZEROES.           
           05  WS-S901-RM                  PIC X(2)     VALUE SPACES.           
           05  WS-S901-DESIGN              PIC X(3)     VALUE SPACES.           
           05  FILLER                      PIC X(1)     VALUE SPACE.            
           05  WS-S901-MTH-INSTAL          PIC S9(5)V99 VALUE +0.               
           05  WS-S901-SUB-INSTAL          PIC S9(5)V99 VALUE +0.               
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABELS PASSED  TO SUB-PROGRAM "BP13C905"         *             
      *-----------------------------------------------------------*             
       01  WS-LINK-S905.                                                        
           05  WS-S905-SC-CC1              PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S905-SC-CC2              PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S905-SC-CC3              PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S905-SC-TOTAL-AMT        PIC 9(7)V99  VALUE ZEROES.           
                                                                                
       01  WS-DATE-VARIABLES.                                                   
           05  WS-DTE.                                                          
               10  WS-DTE-YYYY              PIC X(4)  VALUE SPACES.             
               10  WS-DTE-MM                PIC X(2)  VALUE SPACES.             
               10  WS-DTE-DD                PIC X(2)  VALUE SPACES.             
                                                                                
           05  WS-DTE-EXPIRED-TP.                                               
               10  WS-DTE-EXPIRED-TP-DD     PIC X(2)  VALUE SPACES.             
               10  WS-SLASH1                PIC X     VALUE SPACE.              
               10  WS-DTE-EXPIRED-TP-MM     PIC X(2)  VALUE SPACES.             
               10  WS-SLASH2                PIC X     VALUE SPACE.              
               10  WS-DTE-EXPIRED-TP-YYYY   PIC X(4)  VALUE SPACES.             
                                                                                
           05  WS-ACCEPTANCE-DATE.                                              
               10  WS-ACCEPTANCE-YYYY       PIC 9(4)  VALUE ZERO.               
               10  WS-ACCEPTANCE-MM         PIC 9(2)  VALUE 00.                 
               10  WS-ACCEPTANCE-DD         PIC 9(2)  VALUE 00.                 
                                                                                
           05  WS-AGE                       PIC 9(2)  VALUE ZERO.               
           05  WS-DOB1                      PIC 9(8)  VALUE 00.                 
           05  WS-DOB2                      PIC 9(8)  VALUE 00.                 
           05  WS-DOB3                      PIC 9(8)  VALUE 00.                 
           05  WS-DOB4                      PIC 9(8)  VALUE 00.                 
           05  WS-YNGST-DOB-NUM             PIC 9(8).                           
           05  WS-YNGST-DOB REDEFINES  WS-YNGST-DOB-NUM.                        
               09 WS-YNGST-CCYY             PIC 9(4).                           
               09 WS-YNGST-MMDD             PIC 9(4).                           
                                                                                
           05  WS-DOB-DAYS                  PIC 9(8).                           
           05  WS-DOB-DAY-CNT   REDEFINES WS-DOB-DAYS.                          
               10  WS-DOB-DAYS-YY                PIC 9(4).                      
               10  WS-DOB-DAYS-MM                PIC 9(2).                      
               10  WS-DOB-DAYS-DD                PIC 9(2).                      
                                                                                
           05  WS-CUR-YYYYMMDD.                                                 
               10  WS-CUR-YYYY              PIC 9(4)  VALUE ZERO.               
               10  WS-CUR-MM                PIC 99    VALUE 00.                 
               10  WS-CUR-DD                PIC 99    VALUE 00.                 
                                                                                
           05  WS-EDITED-DATE.                                                  
               10  WS-EDIT-DD               PIC XX    VALUE SPACES.             
               10  FILLER                   PIC X     VALUE '/'.                
               10  WS-EDIT-MM               PIC XX    VALUE SPACES.             
               10  FILLER                   PIC X     VALUE '/'.                
               10  WS-EDIT-YYYY             PIC X(4)  VALUE SPACES.             
                                                                                
           05  WS-CURRENT-DATE.                                                 
               10  WS-CURRENT-DD            PIC 99    VALUE 00.                 
               10  FILLER                   PIC X     VALUE '/'.                
               10  WS-CURRENT-MM            PIC 99    VALUE 00.                 
               10  FILLER                   PIC X     VALUE '/'.                
               10  WS-CURRENT-YYYY          PIC 9(4)  VALUE ZERO.               
                                                                                
           05  WS-CURR-DATE.                                                    
               10  WS-CURR-DATE1.                                               
                   15  WS-YYYY              PIC 9(4)  VALUE ZERO.               
                   15  WS-MM                PIC 9(2)  VALUE 00.                 
                   15  WS-DD                PIC 9(2)  VALUE 00.                 
           05  WS-CURR-DATE2                PIC 9(08).                          
           05  WS-CURR-DATE-R    REDEFINES WS-CURR-DATE2.                       
                 07 WS-CCYY2.                                                   
                   15  WS-CC2               PIC 9(2).                           
                   15  WS-YY2               PIC 9(2).                           
                 07 WS-CCYY2-R   REDEFINES   WS-CCYY2  PIC 9(4).                
                 07 WS-MMDD2.                                                   
                   15  WS-MM2               PIC 9(2).                           
                   15  WS-DD2               PIC 9(2).                           
                                                                                
           05  WS-EXPIRY-DATE.                                                  
               10  WS-EXPIRY-DATE1.                                             
                   15  WS-EXPIRY-YYYY       PIC 9(4)  VALUE ZERO.               
                   15  WS-EXPIRY-MM         PIC 9(2)  VALUE 00.                 
                   15  WS-EXPIRY-DD         PIC 9(2)  VALUE 00.                 
                                                                                
           05  WS-DTE-OPT-EXP.                                                  
               10  WS-DTE-OPT-YYYY          PIC X(4)  VALUE SPACES.             
               10  WS-DTE-OPT-MM            PIC X(2)  VALUE SPACES.             
               10  WS-DTE-OPT-DD            PIC X(2)  VALUE SPACES.             
                                                                                
           05  WS-DTE-WEF.                                                      
               10  WS-WEF-YYYY              PIC X(4)  VALUE SPACES.             
               10  FILLER                   PIC X(1)  VALUE SPACE.              
               10  WS-WEF-MM                PIC X(2)  VALUE SPACES.             
               10  FILLER                   PIC X(1)  VALUE SPACE.              
               10  WS-WEF-DD                PIC X(2)  VALUE SPACES.             
                                                                                
           05  WS-DTE-SCCC.                                                     
               10  WS-SCCC-DD               PIC X(2)  VALUE SPACES.             
               10  FILLER                   PIC X     VALUE '/'.                
               10  WS-SCCC-MM               PIC X(2)  VALUE SPACES.             
               10  FILLER                   PIC X     VALUE '/'.                
               10  WS-SCCC-YYYY             PIC X(4)  VALUE SPACES.             
                                                                                
       01  DATE-REC.                                                            
           05  CAL-DATE.                                                        
               10  CAL-YEAR                 PIC 9(4).                           
                   88  VALID-YEAR               VALUE 1900 THRU 2100.           
               10  CAL-MONTH                PIC 9(2).                           
                   88  31-DAY-MONTH             VALUE 01, 03, 05, 07,           
                                                      08, 10, 12.               
                   88  30-DAY-MONTH             VALUE 04, 06, 09, 11.           
                   88  28-29-DAY-MONTH          VALUE 02.                       
                   88  VALID-MONTH              VALUE 01 THRU 12.               
               10  CAL-DAY                  PIC 9(2).                           
                   88  VALID-DAY                VALUE 01 THRU 31.               
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED TO SUB-PROGRAM "BP13C903"          *             
      *-----------------------------------------------------------*             
       01  WS-LINK-S903.                                                        
           05  WS-S903-NUM-SCH-ACC          PIC X(9)     VALUE SPACES.          
           05  WS-S903-SO-EFF-DATE          PIC 9(8)     VALUE ZEROES.          
           05  WS-S903-DESIGN-TY            PIC X(3)     VALUE SPACES.          
           05  WS-S903-ROOM-TY              PIC X(2)     VALUE SPACES.          
           05  WS-S903-SC-CC1               PIC 9(6)V99  VALUE ZEROES.          
           05  WS-S903-SC-CC2               PIC 9(6)V99  VALUE ZEROES.          
           05  WS-S903-SC-CC3               PIC 9(6)V99  VALUE ZEROES.          
           05  WS-S903-SC-TOTAL-AMT         PIC 9(7)V99  VALUE ZEROES.          
           05  WS-S903-SC-REBATE1           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REBATE2           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REBATE3           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-GRANT1            PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-GRANT2            PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-GRANT3            PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REC-TC1           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REC-TC2           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REC-TC3           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REB-SP1           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REB-SP2           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-REB-SP3           PIC 9(4)V99  VALUE ZEROES.          
           05  WS-S903-SC-CURR-EFF-DATE     PIC X(10)    VALUE SPACES.          
           05  WS-S903-SC-NEXT-EFF-DATE     PIC X(10)    VALUE SPACES.          
           05  WS-S903-RET-CODE             PIC X(2)     VALUE SPACES.          
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED TO SUB-PROGRAM "AV02C021"          *             
      *-----------------------------------------------------------*             
       COPY P13GST01.                                                           
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED TO SUB-PROGRAM "BP13C90B"          *             
      *-----------------------------------------------------------*             
       COPY P13GST02.                                                           
                                                                                
       01  BLANK-LINE                       PIC X(80) VALUE SPACES.             
                                                                                
      *-----------------------------------------------------------*             
      *    WS PRINT LAY-OUT FOR LETTERS  (BP1325, BP1326, BP1336) *             
      *-----------------------------------------------------------*             
                                                                                
       01  L635-LINE-OIC.                                                       
           05  FILLER                     PIC X(10)  VALUE SPACES.              
           05  L635-OIC-NAME              PIC X(30)  VALUE SPACES.              
           05  FILLER                     PIC X(26)  VALUE SPACES.              
                                                                                
       01  L635-LINE-OIC1.                                                      
           05  FILLER                     PIC X(10)  VALUE SPACES.              
           05  L635-OIC-DESG              PIC X(24)  VALUE SPACES.              
           05  FILLER                     PIC X(32)  VALUE SPACES.              
                                                                                
       01  L635-LINE-BARCODE.                                                   
           05  FILLER                     PIC X(66)  VALUE SPACES.              
           05  L635-BARCODE-REGN          PIC X(13)  VALUE SPACES.              
                                                                                
       01  L635-PR-LINE-0.                                                      
           05  FILLER                     PIC X(28)  VALUE SPACES.              
           05  L635-BOTCCC.                                                     
               10  L635-BO                PIC X(2)   VALUE SPACES.              
               10  L635-SLASH1            PIC X      VALUE SPACE.               
               10  L635-TC                PIC X(2)   VALUE SPACES.              
               10  L635-SLASH2            PIC X      VALUE SPACE.               
               10  L635-CC                PIC X(2)   VALUE SPACES.              
           05  FILLER                     PIC X(35)  VALUE SPACES.              
                                                                                
       01  L635-PR-LINE-1.                                                      
           05  FILLER                     PIC X(28)  VALUE SPACES.              
           05  L635-CDE-NT                PIC X(3)   VALUE 'XX'.                
           05  FILLER                     PIC X(1)   VALUE '/'.                 
           05  L635-RECOM-ROOM-TYPE       PIC X(2)   VALUE 'X'.                 
           05  FILLER                     PIC X(1)   VALUE '/'.                 
           05  L635-REGN-NO               PIC X(8)   VALUE 'XXXXXXX '.          
           05  FILLER                     PIC X(3)   VALUE '  ('.               
           05  L635-ALLOCATION-SCHEME     PIC X(3)   VALUE SPACES.              
           05  FILLER                     PIC X(1)   VALUE ')'.                 
                                                                                
       01  L635-PR-LINE-2.                                                      
           05  FILLER                     PIC X(28)  VALUE SPACES.              
           05  L635-SCHEME                PIC X(4)   VALUE 'XXXX'.              
           05  D1                         PIC X      VALUE '-'.                 
           05  L635-ACC                   PIC X(4)   VALUE 'XXXX'.              
           05  D2                         PIC X      VALUE '-'.                 
           05  L635-CDG                   PIC X      VALUE 'X'.                 
           05  D3                         PIC X      VALUE '-'.                 
           05  L635-ACC-TYPE              PIC X(2)   VALUE 'XX'.                
           05  FILLER                     PIC X(35)  VALUE SPACES.              
           05  L635-HDR-PHONE-DID         PIC X(24)  VALUE SPACES.              
                                                                                
       01  L635-PR-LINE-3.                                                      
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L635-APPL-NAME             PIC X(66)  VALUE SPACES.              
           05  FILLER                     PIC X(8)   VALUE SPACES.              
           05  L635-EMAIL                 PIC X(19)  VALUE SPACES.              
                                                                                
       01  L635-PR-LINE-4.                                                      
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L635-COAPPL-NAME           PIC X(66)  VALUE SPACES.              
                                                                                
       01  L635-PR-LINE-4A.                                                     
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L635-THIRD-NAME            PIC X(66)  VALUE SPACES.              
                                                                                
       01  L635-PR-LINE-4B.                                                     
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L635-FOURTH-NAME           PIC X(66)  VALUE SPACES.              
                                                                                
       01  L635-PR-LINE-5.                                                      
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L635-BLKNO                 PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(2)   VALUE SPACES.              
           05  L635-NUM-FLAT.                                                   
               10  L635-CHAR              PIC X      VALUE SPACE.               
               10  L635-LEVEL             PIC X(2)   VALUE SPACES.              
               10  L635-DASH              PIC X      VALUE SPACE.               
               10  L635-HSE-MAIN          PIC X(4)   VALUE SPACES.              
               10  L635-HSE-SUB           PIC X(3)   VALUE SPACES.              
                                                                                
       01  L635-PR-LINE-6.                                                      
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L635-STREET-NAME           PIC X(65)  VALUE SPACES.              
                                                                                
       01  L635-PR-LINE-7.                                                      
           05  FILLER                     PIC X(11)  VALUE SPACES.              
           05  L635-POST-CODE             PIC X(16)  VALUE SPACES.              
           05  L635-DOT                   PIC X(1)   VALUE SPACE.               
                                                                                
       01  L635-PR-LINE-7A.                                                     
           05  FILLER                     PIC X(77)  VALUE SPACES.              
           05  PRINT-DATE                 PIC X(10)  VALUE 'XX/XX/XX'.          
                                                                                
       01  L635-PR-LINE-7B.                                                     
           05  FILLER                     PIC X(10)  VALUE SPACES.              
           05  L635-BAR-CODE              PIC X(09)  VALUE SPACES.              
                                                                                
       01  L635-PR-LINE-8.                                                      
           05  FILLER                     PIC X(18)  VALUE SPACES.              
           05  L635-BLK-NO                PIC X(5)   VALUE ' XXX'.              
           05  FILLER                     PIC X(2)   VALUE SPACES.              
           05  FILLER                     PIC X(1)   VALUE '#'.                 
           05  L635-LEVEL-NO              PIC X(2)   VALUE SPACES.              
           05  FILLER                     PIC X      VALUE '-'.                 
           05  L635-MAIN-UNIT             PIC X(5)   VALUE SPACES.              
           05  FILLER                     PIC X(2)   VALUE SPACES.              
           05  L635-ST-NAME               PIC X(20)  VALUE SPACES.              
           05  FILLER                     PIC X(2)   VALUE SPACES.              
           05  L635-COUNTRY-POSTCDE       PIC X(17)  VALUE 'SINGAPORE '.        
                                                                                
       01  L635-PR-LINE-9.                                                      
           05  FILLER                     PIC X(26)  VALUE SPACES.              
           05  L635-CURR-SELL-PR          PIC $$$,$$$,$$9.99.                   
           05  FILLER                     PIC X(2)  VALUE SPACES.               
           05  L635-CA-TAG                PIC X(8)  VALUE SPACES.               
           05  FILLER                     PIC X(1)  VALUE SPACES.               
           05  L635-STD-TAG               PIC X(12) VALUE SPACES.               
                                                                                
       01  L635-PR-LINE-9A.                                                     
           05  FILLER                   PIC X(25)  VALUE SPACES.                
           05  L635-PREMIUM-TXT         PIC X(30)  VALUE SPACES.                
                                                                                
       01  L635-PR-LINE-10.                                                     
           05  FILLER                     PIC X(68)  VALUE SPACES.              
           05  L635-NEW-ACC-REJ-DATE7     PIC X(10)  VALUE SPACES.              
                                                                                
       01  L635-PR-LINE-11.                                                     
           05  FILLER                     PIC X(10)  VALUE SPACES.              
           05  L635-DTE-OPTION-EXP        PIC X(10)  VALUE SPACES.              
                                                                                
       01  L635-PR-LINE-11A.                                                    
           05  FILLER                     PIC X(72)  VALUE SPACES.              
           05  L635-AMT-INSURED           PIC ZZZ,ZZ9.99.                       
           05  L635-AMT-I-R REDEFINES L635-AMT-INSURED                          
                                          PIC X(10).                            
       01  L635-PR-LINE-11B.                                                    
           05  FILLER                     PIC X(22)  VALUE SPACES.              
           05  L635-AMT-PREMIUM           PIC ZZ9.99.                           
           05  L635-AMT-P-R REDEFINES L635-AMT-PREMIUM                          
                                          PIC X(6).                             
                                                                                
       01  L635-PR-LINE-12.                                                     
           05  FILLER                     PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(13)  VALUE                      
                                                     '(ED FOR TP : '.           
           05  L635-DTE-EXPIRED           PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(1)   VALUE ')'.                 
                                                                                
       01  L635-PR-LINE-13.                                                     
           05  FILLER                     PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(03)  VALUE 'SC:'.               
           05  L635-AMT-CURR-SCCC         PIC ZZ9.99.                           
           05  FILLER                     PIC X(5)   VALUE ' WEF '.             
           05  L635-DTE-CURR-SCCC         PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(1)   VALUE SPACES.              
           05  L635-CURR-GST-DESC         PIC X(45)  VALUE SPACES.              
           05  FILLER                     PIC X(2)   VALUE SPACES.              
           05  L635-BARCODE1-PREFIX       PIC X(2)   VALUE SPACES.              
           05  L635-BARCODE1-REGN         PIC X(8)   VALUE SPACES.              
                                                                                
                                                                                
       01  L635-PR-LINE-14.                                                     
           05  FILLER                     PIC X(13)  VALUE SPACES.              
           05  L635-AMT-NEXT-SCCC         PIC ZZ9.99.                           
           05  FILLER                     PIC X(5)   VALUE ' WEF '.             
           05  L635-DTE-NEXT-SCCC         PIC X(10)  VALUE SPACES.              
           05  FILLER                     PIC X(1)   VALUE SPACES.              
           05  L635-NEXT-GST-DESC         PIC X(48)  VALUE SPACES.              
                                                                                
      *-----------------------------------------------------------*             
      *    WS PRINT LAY-OUT FOR LETTERS  (BP1327)                 *             
      *    AND CONTRACT PERSONS                                   *             
      *-----------------------------------------------------------*             
       01  L635-DTL-HAND-PHONE.                                                 
           05  FILLER                     PIC X(53)  VALUE SPACES.              
           05  L635-ASSIST-HP             PIC X(12)  VALUE SPACES.              
                                                                                
       01  L635-DTL-DID.                                                        
           05  FILLER                     PIC X(50)  VALUE SPACES.              
           05  L635-CHG-APPT-DID          PIC X(8)   VALUE SPACES.              
                                                                                
      *==> PART-A PRINT VARIABLES                                               
       01  L310A-PR-HEAD-09.                                                    
           05  FILLER                      PIC X(20) VALUE SPACES.              
           05  L211-CDE-NT                 PIC X(3)   VALUE 'XXX'.              
           05  FILLER                      PIC X(1)   VALUE '/'.                
           05  L211-RECOM-ROOM-TYPE        PIC X(2)   VALUE 'X'.                
           05  FILLER                      PIC X(1)   VALUE '/'.                
           05  L211-REGN-NO                PIC X(8)  VALUE SPACES.              
           05  FILLER                     PIC X(3)   VALUE '  ('.               
           05  L211-ALLOCATION-SCHEME     PIC X(3)   VALUE SPACES.              
           05  FILLER                     PIC X(1)   VALUE ')'.                 
           05  FILLER                      PIC X(2)  VALUE SPACES.              
           05  L211-HALF-IDP               PIC X(3)   VALUE SPACES.             
                                                                                
       01  L310A-PR-HEAD-10.                                                    
           05  FILLER                      PIC X(14) VALUE SPACES.              
           05  L211-NUM-DEPOSIT            PIC Z9.                              
           05  FILLER                      PIC X(18) VALUE SPACES.              
           05  L211-PURCHASE-PRICE         PIC $,$$$,$$$,$$9.                   
           05  FILLER                      PIC X(06) VALUE SPACES.              
           05  L211-AMT-SELL-PRICE         PIC ZZZ,ZZZ,ZZ9.99.                  
                                                                                
       01  L310A-PR-HEAD-11.                                                    
           05  FILLER                      PIC X(24)  VALUE SPACES.             
           05  L211-LS-FEE-TXT             PIC X(28)  VALUE SPACES.             
           05  FILLER                      PIC X(02)  VALUE SPACES.             
           05  L211-AMT-LS-FEE             PIC ZZ,ZZZ,ZZ9.99.                   
                                                                                
       01  L310A-PR-HEAD-12.                                                    
           05  FILLER                      PIC X(28) VALUE SPACES.              
           05  L211-ACT-CV-FEE             PIC ZZ9.99.                          
           05  FILLER                      PIC X(8)  VALUE SPACES.              
           05  L211-GST-CV-FEE             PIC ZZ9.99.                          
           05  FILLER                      PIC X(9)  VALUE SPACES.              
           05  L211-AMT-CV-FEE             PIC ZZZ,ZZ9.99.                      
                                                                                
       01  L310A-PR-HEAD-TOTAL.                                                 
           05  FILLER                      PIC X(53) VALUE SPACES.              
           05  L211-AMT-TOTAL              PIC ZZZ,ZZZ,ZZ9.99.                  
                                                                                
       01  L310A-PR-HEAD-13.                                                    
           05  FILLER                      PIC X(14) VALUE SPACES.              
           05  L211-OP-TXT                 PIC X(30)  VALUE SPACES.             
                                                                                
      *==> PART-A PRINT NOTES                                                   
       01  L310A-PR-LINE-15.                                                    
           05  FILLER                      PIC X(20) VALUE SPACES.              
           05  L310-SYS-DATE               PIC X(10) VALUE SPACES.              
                                                                                
       01  L310A-PR-LINE-16.                                                    
           05  FILLER                      PIC X(17) VALUE SPACES.              
           05  L310-AMT-CURR-SCCC          PIC ZZ9.99.                          
           05  FILLER                      PIC X(5)  VALUE ' WEF '.             
           05  L310-DTE-CURR-SCCC          PIC X(10) VALUE SPACES.              
           05  FILLER                      PIC X(1)  VALUE SPACE.               
           05  L310-CURR-GST-DESC          PIC X(48) VALUE SPACES.              
                                                                                
       01  L310A-PR-LINE-17.                                                    
           05  FILLER                      PIC X(17) VALUE SPACES.              
           05  L310-AMT-NEXT-SCCC          PIC ZZ9.99.                          
           05  FILLER                      PIC X(5)  VALUE ' WEF '.             
           05  L310-DTE-NEXT-SCCC          PIC X(10) VALUE SPACES.              
           05  FILLER                      PIC X(1)  VALUE SPACE.               
           05  L310-NEXT-GST-DESC          PIC X(48) VALUE SPACES.              
                                                                                
      *==> PART-B PRINT VARIABLES                                               
                                                                                
       01  L400C-PR-LINE-1.                                                     
           05  FILLER                   PIC X(33)  VALUE SPACES.                
           05  400C-YNGST-PURCHSR       PIC Z9     VALUE ZEROES.                
           05  FILLER                   PIC X(28)  VALUE SPACES.                
           05  400C-REPAY-PRD           PIC ZZ9.                                
           05  FILLER                   PIC X(06)  VALUE ' Years'.              
                                                                                
      *==> FOR SA/TP EXEMPTED FROM CA                                           
                                                                                
       01  L400C-PR-LINE-1A.                                                    
           05  FILLER                   PIC X(39)  VALUE SPACES.                
           05  400C-OFFER-SP-DESC       PIC X(24)  VALUE                        
                                        '*Offer Selling Price : $'.             
           05  400C-OFFER-SP            PIC Z,ZZZ,ZZ9.                          
                                                                                
       01  L400C-PR-LINE-1B.                                                    
           05  FILLER                   PIC X(40)  VALUE SPACES.                
           05  400C-DISC-OCS-DESC       PIC X(23)  VALUE                        
                                        'Discount OCS        : $'.              
           05  FILLER                   PIC X(04)  VALUE SPACES.                
           05  400C-DISC-OCS            PIC Z,ZZ9.                              
                                                                                
       01  L400C-PR-LINE-2.                                                     
           05  FILLER                   PIC X(29)  VALUE SPACES.                
           05  400C-HH-INCOME           PIC $$$$$9.                             
           05  FILLER                   PIC X(28)  VALUE SPACES.                
           05  400C-CA-INCOME           PIC $$$$$9.                             
                                                                                
      *==> FOR SA/TP EXEMPTED FROM CA                                           
       01  L400C-PR-LINE-2A.                                                    
           05  FILLER                   PIC X(29)  VALUE SPACES.                
           05  400C-REPAY-PRDA          PIC ZZ9.                                
           05  FILLER                   PIC X(06)  VALUE ' Years'.              
           05  FILLER                   PIC X(02)  VALUE SPACES.                
           05  400C-DISC-SERS-DESC      PIC X(23)  VALUE                        
                                        'Discount SERS/RED   : $'.              
           05  400C-DISC-SERS           PIC Z,ZZZ,ZZ9.                          
                                                                                
       01  L400C-PR-LINE-2B.                                                    
           05  FILLER                   PIC X(29)  VALUE SPACES.                
           05  400C-INT-RATEA           PIC Z9.99.                              
           05  FILLER                   PIC X(2)   VALUE ' %'.                  
           05  FILLER                   PIC X(04)  VALUE SPACES.                
           05  400C-SELL-PRICE-DESC     PIC X(23)  VALUE                        
                                        'Selling Price       : $'.              
           05  400C-SELL-PRICE          PIC Z,ZZZ,ZZ9.                          
                                                                                
       01  L400C-PR-LINE-2C.                                                    
           05  FILLER                   PIC X(30)  VALUE SPACES.                
           05  400C-INT-RATE            PIC Z9.99.                              
           05  FILLER                   PIC X(2)   VALUE ' %'.                  
           05  FILLER                   PIC X(26)  VALUE SPACES.                
           05  400C-MAX-LOAN-ELIG       PIC $$$$$$$9.99.                        
                                                                                
       01  L400C-PR-LINE-2D.                                                    
           05  FILLER                   PIC X(37)  VALUE SPACES.                
           05  FILLER                   PIC X(25)  VALUE SPACES.                
           05  400C-INSTAL-ELIG         PIC $$$$$9.99.                          
                                                                                
       01  L400C-PR-LINE-3.                                                     
           05  FILLER                   PIC X(23)  VALUE SPACES.                
           05  400C-SELLNG-PRICE        PIC $$,$$$,$$9.                         
           05  400C-SELLNG-PRICE-TXT REDEFINES 400C-SELLNG-PRICE                
                                        PIC X(10).                              
           05  400C-PREMIUM-TXT         PIC X(26)  VALUE SPACES.                
           05  400C-SELLING-PRICE       PIC ZZ,ZZZ,ZZ9.99.                      
                                                                                
       01  L400C-PR-LINE-3A.                                                    
           05  FILLER                   PIC X(50)  VALUE SPACES.                
           05  400C-LEASE-STAMP-FEE     PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-4.                                                     
           05  FILLER                   PIC X(50)  VALUE SPACES.                
           05  400C-LEASE-FEE           PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-5.                                                     
           05  FILLER                   PIC X(50)  VALUE SPACES.                
           05  400C-MORT-STAMP-FEE      PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-6.                                                     
           05  FILLER                   PIC X(50)  VALUE SPACES.                
           05  400C-MORTGAGE-FEE        PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-7.                                                     
           05  FILLER                   PIC X(50)  VALUE SPACES.                
           05  400C-TOT-STAMP-FEE       PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-7A.                                                    
           05  FILLER                   PIC X(29)  VALUE SPACES.                
           05  FILLER                   PIC X(1)   VALUE '('.                   
           05  400C-CONVEY-FEE          PIC ZZ9.99.                             
           05  FILLER                   PIC X(1)   VALUE '+'.                   
           05  400C-CONVEY-FEE-GST      PIC Z9.99.                              
           05  FILLER                   PIC X(5)   VALUE ' GST)'.               
           05  FILLER                   PIC X(3)   VALUE SPACES.                
           05  400C-TOT-CONVEY-FEE      PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-8.                                                     
           05  FILLER                   PIC X(24)  VALUE SPACES.                
           05  FILLER                   PIC X(1)   VALUE '('.                   
           05  400C-SURVEY-FEE-ACT      PIC Z,ZZ9.99.                           
           05  FILLER                   PIC X(3)   VALUE ' + '.                 
           05  400C-SURVEY-FEE-GST      PIC ZZ9.99.                             
           05  FILLER                   PIC X(8)   VALUE ' GST)'.               
           05  400C-TOT-SURVEY-FEE      PIC ZZZ,ZZ9.99.                         
           05  FILLER                   PIC X(2)   VALUE SPACES.                
           05  400C-TOT-FEES            PIC ZZZ,ZZ9.99.                         
                                                                                
       01  L400C-PR-LINE-9.                                                     
           05  FILLER                   PIC X(59)  VALUE SPACES.                
           05  400C-TOT-SELLPR          PIC ZZ,ZZZ,ZZ9.99.                      
                                                                                
       01  L400C-PR-LINE-10.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CASH             PIC ZZZZ,ZZ9.99.                        
                                                                                
       01  L400C-PR-LINE-11.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CPF1             PIC ZZZZ,ZZ9.99.                        
           05  FILLER                   PIC X(3)   VALUE SPACES.                
           05  400C-CD-CPF1-TXT         PIC X(5)   VALUE SPACES.                
                                                                                
       01  L400C-PR-LINE-12.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CPF2             PIC ZZZZ,ZZ9.99.                        
                                                                                
       01  L400C-PR-LINE-13.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CPF3             PIC ZZZZ,ZZ9.99.                        
                                                                                
       01  L400C-PR-LINE-14.                                                    
           05  FILLER                   PIC X(49)  VALUE SPACES.                
           05  400C-CD-CPF4             PIC ZZZZ,ZZ9.99.                        
           05  FILLER                   PIC X      VALUE SPACES.                
           05  400C-TOTAL-CD            PIC ZZZZ,ZZ9.99.                        
                                                                                
       01  L400C-PR-LINE-15.                                                    
           05  FILLER                   PIC X(59)  VALUE SPACES.                
           05  400C-BALANCE-AMT         PIC ZZ,ZZZ,ZZ9.99.                      
                                                                                
       01  L400C-PR-LINE-16.                                                    
           05  FILLER                   PIC X(60)  VALUE SPACES.                
           05  400C-MAX-LOAN-AMT        PIC Z,ZZZ,ZZ9.99.                       
                                                                                
       01  L400C-PR-LINE-16B.                                                   
           05  FILLER                   PIC X(60)  VALUE SPACES.                
           05  400C-TOP-UP-ICP          PIC Z,ZZZ,ZZ9.99.                       
                                                                                
       01  L400C-PR-LINE-17.                                                    
           05  FILLER                   PIC X(36)  VALUE SPACES.                
           05  L400C-REPAY-PRD          PIC ZZ.                                 
           05  FILLER                   PIC X(26)  VALUE SPACES.                
           05  400C-MTHLY-INSTAL        PIC Z,ZZ9.99.                           
                                                                                
       01  L400C-PR-LINE-18.                                                    
           05  FILLER                   PIC X(64)  VALUE SPACES.                
           05  400C-SC-CC-AMT           PIC Z,ZZ9.99.                           
                                                                                
      *****LAY OUT FOR  CONTROL LIST                                            
       01 L661B-HEADER-0.                                                       
          05   FILLER                   PIC X(40)    VALUE SPACES.              
          05   FILLER                   PIC X(50)    VALUE                      
                  '      S  O  C    S  Y  S  T  E  M            '.              
          05   FILLER                   PIC X(15)    VALUE SPACES.              
                                                                                
       01 L661B-HEADER-1.                                                       
          05   FILLER                   PIC X(40)    VALUE SPACES.              
          05   FILLER                   PIC X(50)    VALUE                      
                  'LIST OF SA-TP LETTER (CA = Y/E) CONTROL LIST '.              
          05   FILLER                   PIC X(15)    VALUE SPACES.              
                                                                                
       01 L661B-HEADER-2.                                                       
          05   FILLER                   PIC X(01)    VALUE SPACES.              
          05   FILLER                   PIC X(08)    VALUE 'P13L661B'.          
          05   FILLER                   PIC X(10)    VALUE SPACES.              
          05   FILLER                   PIC X(08)    VALUE 'DATE : '.           
          05   L661B-PRT-DATE           PIC X(10)    VALUE SPACES.              
          05   FILLER                   PIC X(63)    VALUE SPACES.              
          05   FILLER                   PIC X(06)    VALUE 'PAGE: '.            
          05   L661B-PAGE-NO            PIC ZZ99.                               
                                                                                
       01 L661B-HEADER-3.                                                       
          05   FILLER                   PIC X(02)  VALUE SPACES.                
          05   FILLER                   PIC X(06)  VALUE 'S/NO  '.              
          05   FILLER                   PIC X(02)  VALUE SPACES.                
          05   FILLER                   PIC X(08)  VALUE 'REGN NO.'.            
          05   FILLER                   PIC X(02)  VALUE SPACES.                
          05   FILLER                   PIC X(09)  VALUE 'NRIC     '.           
          05   FILLER                   PIC X(02)  VALUE SPACES.                
          05   FILLER                   PIC X(13)  VALUE 'SELLNG PRICE'.        
          05   FILLER                   PIC X(02)  VALUE SPACES.                
          05   FILLER                   PIC X(12)  VALUE 'SCH-ACC-NO  '.        
          05   FILLER                   PIC X(02)  VALUE SPACES.                
          05   FILLER                   PIC X(04)  VALUE 'NAME'.                
          05   FILLER                   PIC X(23)  VALUE SPACES.                
          05   FILLER                   PIC X(12)  VALUE 'REMARKS     '.        
                                                                                
       01 L661B-DETAIL.                                                         
          05   FILLER                   PIC X(02)  VALUE SPACES.                
          05   L661B-SNO                PIC ZZZZZ9.                             
          05   FILLER                   PIC X(02)  VALUE SPACES.                
          05   L661B-REGN-NO            PIC X(08)  VALUE SPACES.                
          05   FILLER                   PIC X(02)  VALUE SPACES.                
          05   L661B-NRIC               PIC X(09)  VALUE SPACES.                
          05   FILLER                   PIC X(02)  VALUE SPACES.                
          05   L661B-SELLING-PRICE      PIC ZZ,ZZZ,ZZ9.99.                      
          05   FILLER                   PIC X(02)  VALUE SPACES.                
          05   L661B-SCH-ACC-NO         PIC X(12)  VALUE SPACES.                
          05   FILLER                   PIC X(02)  VALUE SPACES.                
          05   L661B-NAME               PIC X(25)  VALUE SPACES.                
          05   FILLER                   PIC X(02)  VALUE SPACES.                
          05   L661B-REMARK             PIC X(39)  VALUE SPACES.                
                                                                                
       01  WS-LINK-S90N.                                                        
         02 WS-S90N-OFFERPR-PREMIUM        PIC 9(8)     VALUE ZEROES.           
         02 WS-S90N-OFFERPR                PIC 9(8)     VALUE ZEROES.           
         02 WS-LINK-S900.                                                       
           05  WS-S900-SELL-PR             PIC 9(8)     VALUE ZEROES.           
           05  WS-S900-DESIGN              PIC X(3)     VALUE SPACES.           
           05  WS-S900-RM                  PIC X(2)     VALUE SPACES.           
           05  WS-S900-CD-PREV-PAID        PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S900-TOT-ICP             PIC 9(7)V99  VALUE ZEROES.           
           05  WS-S900-REPAY-PD            PIC 99       VALUE ZEROES.           
           05  WS-S900-PREM-ST-FEE         PIC 9(5)V99  VALUE ZEROES.           
           05  WS-S900-SURVEY-FEE          PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-LS-ESCROW-FEE       PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-LS-REGN-FEE         PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-CONVEY-FEE          PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-MORT-ESCROW-FEE     PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-MORT-ST-FEE         PIC 9(5)V99  VALUE ZEROES.           
           05  WS-S900-MORT-REGN-FEE       PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-LOAN                PIC S9(7)V99 VALUE ZEROES.           
           05  WS-S900-ORIG-SELL           PIC 9(8)     VALUE ZEROES.           
           05  WS-S900-SALE-TYPE           PIC X(2)     VALUE SPACES.           
           05  WS-S900-PREMIUM-CODE        PIC X(2)     VALUE SPACES.           
           05  WS-S900-SURVEY-FEE-GST      PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-CONVEY-FEE-GST      PIC 9(3)V99  VALUE ZEROES.           
           05  WS-S900-SALES-TYPE-SURVEY   PIC X(2)     VALUE ZEROES.           
                                                                                
      *------------------------*                                                
      *  LINKAGE FOR AV02C015  *                                                
      *------------------------*                                                
        01  WS-LINK-AV02C015.                                                   
            05  AV02C015-IN-POSTCODE         PIC X(6).                          
            05  AV02C015-OUT-POSTCODE-CHKSUM PIC X(9).                          
                                                                                
      **********************                                                    
       PROCEDURE DIVISION.                                                      
      **********************                                                    
                                                                                
      ******************************************************************        
       100-MAIN-ROUTINE.                                                        
      ******************************************************************        
           PERFORM 200-OPEN-FILES              THRU    200-EXIT.                
           PERFORM 250-MOVE-GST-RATE           THRU    250-EXIT.                
           PERFORM 300-READ-BP13F310           THRU    300-EXIT.                
                                                                                
           PERFORM 400-ALLOCATION-STATUS-CHECK THRU    400-EXIT                 
                       UNTIL WS-F310-EOF = 'Y'.                                 
           IF  WS-CNT-LETTERS > ZERO OR WS-CNT-SKIPPED > 0                      
             MOVE    WS-CNT-LETTERS            TO  WS-EDT-LETTERS               
             MOVE    WS-CNT-SKIPPED            TO  WS-EDT-SKIPPED               
                                                                                
             MOVE    SPACES                    TO  P13L661B-REC                 
             STRING '                         '                                 
             'TOTAL NO. LETTERS PRINTED : ' WS-EDT-LETTERS                      
                    DELIMITED BY SIZE    INTO      P13L661B-REC                 
             WRITE P13L661B-REC  AFTER 2                                        
                                                                                
             MOVE    SPACES                    TO  P13L661B-REC                 
             STRING '                         '                                 
             'TOTAL NO. LETTERS SKIPPED : ' WS-EDT-SKIPPED                      
                    DELIMITED BY SIZE    INTO      P13L661B-REC                 
                                                                                
             WRITE P13L661B-REC  AFTER 2                                        
           END-IF.                                                              
                                                                                
           PERFORM 1000-CLOSE-ROUTINE          THRU    1000-EXIT.               
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       110-CHK-SERS.                                                            
      ******************************************************************        
      *-----------------------------------*                                     
      * SEARCH SCHEME IN ALLOC SCH TABLE  *                                     
      *-----------------------------------*                                     
           IF WS-ALLOC-SCH  NOT =  LOW-VALUES AND SPACES                        
               SET WS-SERS-PTR  TO 1                                            
               SEARCH WS-SERS-SCH                                               
                   AT END                                                       
                   MOVE 'N' TO WS-SCH-FND                                       
                   WHEN WS-SERS-SCHEME(WS-SERS-PTR) = WS-ALLOC-SCH              
                   MOVE 'Y' TO WS-SCH-FND                                       
               END-SEARCH                                                       
           ELSE                                                                 
               MOVE 'N' TO WS-SCH-FND                                           
           END-IF.                                                              
                                                                                
       110-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       200-OPEN-FILES.                                                          
      ******************************************************************        
           OPEN INPUT BP13K800                                                  
                      BP13K022                                                  
                      BP13K024                                                  
                      BP13K820                                                  
                      BP13K830                                                  
                      BP13K640                                                  
                      BM06K100                                                  
                      BM06K110                                                  
                      AB03K050                                                  
                      BP13F310                                                  
               OUTPUT P13L661A                                                  
                      P13L661B                                                  
                      P13L661C                                                  
                      P13L661D                                                  
                      P13L661E                                                  
                      P13L661G                                                  
                      P13L661H.                                                 
                                                                                
           IF BP13K800-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K800-STATUS ' BP13K800-STATUS          
              MOVE     BP13K800-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF BP13K022-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K022-STATUS ' BP13K022-STATUS          
              MOVE     BP13K022-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF BP13K024-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K024-STATUS ' BP13K024-STATUS          
              MOVE     BP13K024-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF BP13K820-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K820-STATUS ' BP13K820-STATUS          
              MOVE     BP13K820-STATUS TO RETURN-CODE                           
              PERFORM 1000-CLOSE-ROUTINE.                                       
                                                                                
           IF BP13K830-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K830-STATUS ' BP13K830-STATUS          
              MOVE     BP13K830-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF BP13K640-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BP13K640-STATUS ' BP13K640-STATUS          
              MOVE     BP13K640-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF BM06K100-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BM06K100-STATUS ' BM06K100-STATUS          
              MOVE     BM06K100-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF BM06K110-STATUS NOT = 00 AND 97                                   
              DISPLAY 'OPENING ERROR-BM06K110-STATUS ' BM06K110-STATUS          
              MOVE     BM06K110-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           MOVE 30 TO WS-CNT.                                                   
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       250-MOVE-GST-RATE.                                                       
      ******************************************************************        
      *-----------------------------------------------------------*             
      *    CALL BP13C90D TO GET GST-RATE                          *             
      *-----------------------------------------------------------*             
           CALL 'BP13C90D' USING WS-COMM-AREA-GST.                              
                                                                                
       250-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       300-READ-BP13F310.                                                       
      ******************************************************************        
      *--------------------------------------------------------*                
      *    1.   READ FILE BP13F310.                            *                
      *    2.   CHECK F310-ALLOC-STATUS.                       *                
      *--------------------------------------------------------*                
           READ BP13F310                                                        
                AT END MOVE 'Y' TO WS-F310-EOF                                  
                       GO TO 300-EXIT.                                          
                                                                                
           ADD  1  TO  WS-CNT-F310.                                             
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       400-ALLOCATION-STATUS-CHECK.                                             
      ******************************************************************        
           PERFORM 500-ELIGIBILITY-CHECK  THROUGH  500-EXIT.                    
           PERFORM 300-READ-BP13F310      THROUGH  300-EXIT.                    
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       500-ELIGIBILITY-CHECK.                                                   
      ******************************************************************        
           PERFORM 550-INITIALIZE-WORKSHEET  THRU 550-EXIT.                     
           PERFORM 600-ACCESS-BM06K110  THROUGH  600-EXIT.                      
           MOVE    ZEROS   TO WS-ACCEPTANCE-DATE.                               
                                                                                
           IF K110-NOT-FOUND = 'Y'                                              
              MOVE ZEROS  TO WS-ACCEPTANCE-DATE                                 
              GO TO 500-EXIT                                                    
           ELSE                                                                 
              MOVE K110-DTE-ACCEPTANCE TO WS-ACCEPTANCE-DATE                    
              IF  (K110-DTE-KEY-AVAIL  = SPACES OR LOW-VALUES OR ZEROES)        
              OR  (K110-DTE-KEY-AVAIL  NOT NUMERIC)                             
                   GO TO 500-EXIT.                                              
                                                                                
           PERFORM 700-READ-SOC-MASTER THRU 700-EXIT.                           
           MOVE K800-NUM-ALLO-SCHEME   TO   WS-ALLOC-SCH.                       
           PERFORM 110-CHK-SERS        THRU 110-EXIT.                           
                                                                                
           IF ((K800-NUM-ALLO-SCHEME = 'STD' OR 'RP ' OR 'RED') OR              
               (WS-SCH-FND = 'Y'))                                              
                CONTINUE                                                        
           ELSE                                                                 
                GO TO 500-EXIT                                                  
           END-IF.                                                              
                                                                                
           ADD     1   TO    WS-CNT-PROC.                                       
           PERFORM 750-GET-REGN-CHKDIGIT  THRU 750-EXIT.                        
           PERFORM 800-SETUP-LETTERS THROUGH 800-EXIT.                          
           PERFORM 900-SETUP-WORKSHEET THROUGH 900-EXIT.                        
                                                                                
           ADD  1                    TO  WS-CNT-LETTERS.                        
                                                                                
           PERFORM 845-READ-BP13K022  THRU 845-EXIT.                            
           PERFORM 847-GET-CSM-INFO   THRU 847-EXIT.                            
                                                                                
           IF (K800-NUM-ALLO-SCHEME = 'STD' OR 'RP' OR 'RED')                   
              PERFORM 825-PRINT-LETTERS-STD THROUGH 825-EXIT                    
           ELSE                                                                 
              PERFORM 835-PRINT-LETTERS-SER THROUGH 835-EXIT                    
              PERFORM 840-SER-LETTER-COPY   THROUGH 840-EXIT                    
           END-IF.                                                              
                                                                                
           IF K800-NUM-CA-TAG = 'Y'                                             
              PERFORM 885-GET-INCOME     THROUGH 885-EXIT                       
           END-IF.                                                              
                                                                                
           PERFORM 950-PROCESS-PRINT-WSHEET  THRU 950-EXIT.                     
                                                                                
           PERFORM 2500-CONTROL-REC          THRU 2500-EXIT.                    
                                                                                
       500-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       550-INITIALIZE-WORKSHEET.                                                
      ******************************************************************        
           MOVE SPACES   TO L211-REGN-NO        L310-SYS-DATE                   
                            L310-DTE-CURR-SCCC  L310-CURR-GST-DESC              
                            L310-DTE-NEXT-SCCC  L310-NEXT-GST-DESC              
                            400C-CD-CPF1-TXT.                                   
                                                                                
           MOVE SPACES   TO  L661B-REGN-NO                                      
                             L661B-NRIC                                         
                             L661B-SCH-ACC-NO                                   
                             L661B-REMARK                                       
                             L661B-NAME.                                        
                                                                                
           MOVE  ZERO    TO  L661B-SNO                                          
                             L661B-SELLING-PRICE.                               
                                                                                
           MOVE ZEROES   TO L211-NUM-DEPOSIT                                    
                            L211-AMT-SELL-PRICE  L211-AMT-LS-FEE                
                            L211-ACT-CV-FEE      L211-GST-CV-FEE                
                            L211-AMT-CV-FEE      L211-AMT-TOTAL                 
                            L310-AMT-CURR-SCCC   L310-AMT-NEXT-SCCC             
                            400C-REPAY-PRD       400C-INT-RATE                  
                            400C-SELLING-PRICE   400C-LEASE-FEE                 
                            400C-MORT-STAMP-FEE  400C-MORTGAGE-FEE              
                            400C-TOT-STAMP-FEE   400C-SURVEY-FEE-ACT            
                            400C-SURVEY-FEE-GST  400C-TOT-SURVEY-FEE            
                            400C-TOT-FEES        400C-TOT-SELLPR                
                            400C-CD-CASH         400C-CD-CPF1                   
                            400C-CD-CPF2         400C-CD-CPF3                   
                            400C-CD-CPF4         400C-TOTAL-CD                  
                            400C-BALANCE-AMT     400C-MAX-LOAN-AMT              
                            400C-MTHLY-INSTAL    400C-SC-CC-AMT                 
                            400C-YNGST-PURCHSR                                  
                            400C-REPAY-PRDA      400C-MAX-LOAN-ELIG             
                            400C-INT-RATEA                                      
                            400C-INSTAL-ELIG                                    
                            400C-TOP-UP-ICP.                                    
                                                                                
           INITIALIZE       WS-LINK-S90N.                                       
           MOVE ZEROES   TO WS-LOAN-ROUND-DOWN                                  
                            WS-TOTAL-CD                                         
                            WS-K110-CSPRICE                                     
                            WS-K110-CSPRICE-PREMIUM                             
                            WS-COMP-SELLPR                                      
                            WS-COMP-SELLPR-PREMIUM                              
                            WS-TOTAL-SELLPR                                     
                            WS-BALANCE-AMT                                      
                            WS-MAX-LOAN-AMT.                                    
                                                                                
           MOVE SPACES TO L635-BARCODE-REGN.                                    
           MOVE SPACES TO L635-BARCODE1-REGN.                                   
           MOVE SPACES TO L635-BARCODE1-PREFIX.                                 
                                                                                
       550-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       600-ACCESS-BM06K110.                                                     
      ******************************************************************        
      *--------------------------------------------------------*                
      *    USE F310-SCH-ACCT-NO TO ACCESS BM06K110 FOR NEW     *                
      *        FLAT INFORMATION.                               *                
      *--------------------------------------------------------*                
           MOVE 'N' TO K110-NOT-FOUND.                                          
           MOVE F310-SCH-ACC TO K110-KEY-FLD                                    
                                L661B-SCH-ACC-NO.                               
                                                                                
           READ BM06K110.                                                       
                                                                                
           IF BM06K110-STATUS = 00 OR 02                                        
              CONTINUE                                                          
           ELSE                                                                 
           IF BM06K110-STATUS = 23                                              
              MOVE    'Y'  TO K110-NOT-FOUND                                    
              DISPLAY 'REC NOT FND, K110-KEY-FLD   ' K110-KEY-FLD               
           ELSE                                                                 
              DISPLAY 'READ ERROR, K110-STATUS  = ' BM06K110-STATUS             
              DISPLAY '            K110-KEY-FLD = ' K110-KEY-FLD                
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           ADD  1  TO  WS-CNT-K110.                                             
                                                                                
       600-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       700-READ-SOC-MASTER.                                                     
      ******************************************************************        
           MOVE F310-REGN-NO TO K800-NUM-REGN.                                  
                                                                                
           READ BP13K800.                                                       
                                                                                
           IF BP13K800-STATUS = 00                                              
              MOVE    'N'  TO K800-NOT-FOUND                                    
           ELSE                                                                 
           IF BP13K800-STATUS = 23                                              
              MOVE    'Y'  TO K800-NOT-FOUND                                    
              DISPLAY 'REC NOT FOUND IN BP13K800 ' K800-NUM-REGN                
              GO TO    500-EXIT                                                 
           ELSE                                                                 
              DISPLAY 'READ ERROR, BP13K800-STATUS ' BP13K800-STATUS            
              MOVE     BP13K800-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF K800-NUM-SCH-ACC = SPACES OR LOW-VALUES                           
              GO TO 500-EXIT.                                                   
                                                                                
           IF K800-DTE-SALE-AGMT NOT = SPACES AND LOW-VALUES AND ZEROS          
              GO TO 500-EXIT.                                                   
                                                                                
           IF K800-DTE-AO-APPT   NOT = SPACES AND LOW-VALUES AND ZEROS          
              GO TO 500-EXIT.                                                   
                                                                                
           IF K800-AMT-DEFER-PREMIUM IS NOT NUMERIC                             
              MOVE ZEROES     TO K800-AMT-DEFER-PREMIUM                         
           END-IF.                                                              
                                                                                
       700-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *-------------------------------------------------------------            
       750-GET-REGN-CHKDIGIT.                                                   
      *-------------------------------------------------------------            
                                                                                
           STRING 'SL' K800-NUM-REGN DELIMITED BY SIZE                          
             INTO  WS-C908-TXT-INPUT.                                           
                                                                                
           MOVE SPACES               TO WS-C908-TXT-OUTPUT.                     
           MOVE 10                   TO WS-C908-TXT-IN-SIZE.                    
           MOVE ZEROS                TO WS-C908-RETCODE                         
                                        WS-C908-TXT-OUT-SIZE.                   
                                                                                
           CALL 'BP13C908'    USING WS-C908-PARAMETERS.                         
                                                                                
           IF WS-C908-RETCODE = ZEROS                                           
              MOVE WS-C908-TXT-OUTPUT(1:WS-C908-TXT-OUT-SIZE) TO                
                   L635-BARCODE-REGN                                            
           ELSE                                                                 
              DISPLAY 'ERROR IN BP13C908-REGN: ' WS-C908-TXT-INPUT              
              MOVE SPACES                 TO  L635-BARCODE-REGN.                
                                                                                
       750-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ******************************************************************        
       800-SETUP-LETTERS.                                                       
      ******************************************************************        
      *--------------------------------------------------------*                
      *    PRINT LETTERS FOR LEASE AGREEMENT.                  *                
      *--------------------------------------------------------*                
                                                                                
           MOVE K800-NUM-NEW-TOWN    TO  L635-CDE-NT                            
                                         L211-CDE-NT.                           
           IF F310-CDE-TYP-ACTUSE = '06'                                        
              MOVE 'E ' TO L635-RECOM-ROOM-TYPE                                 
                           L211-RECOM-ROOM-TYPE                                 
           ELSE                                                                 
           IF F310-CDE-TYP-ACTUSE = '08'                                        
              MOVE 'MG' TO L635-RECOM-ROOM-TYPE                                 
                           L211-RECOM-ROOM-TYPE                                 
           ELSE                                                                 
           IF F310-CDE-TYP-ACTUSE = '04' AND                                    
              F310-CDE-MODL-DESG  = '06'                                        
              MOVE '4S' TO L635-RECOM-ROOM-TYPE                                 
                           L211-RECOM-ROOM-TYPE                                 
           ELSE                                                                 
              MOVE F310-CDE-TYP-ACTUSE TO L635-RECOM-ROOM-TYPE                  
                                          L211-RECOM-ROOM-TYPE.                 
                                                                                
           MOVE K800-NUM-REGN        TO L635-REGN-NO                            
                                        L661B-REGN-NO                           
                                        L635-BARCODE1-REGN.                     
                                                                                
           MOVE 'SL'   TO L635-BARCODE1-PREFIX.                                 
                                                                                
           MOVE K800-NUM-ALLO-SCHEME TO L635-ALLOCATION-SCHEME                  
                                        L211-ALLOCATION-SCHEME.                 
                                                                                
           IF K800-NUM-HALF-IDP = 'S' OR = 'A' OR = 'Y'                         
              STRING '-' K800-NUM-HALF-IDP                                      
                     DELIMITED BY SIZE INTO L211-HALF-IDP.                      
                                                                                
           MOVE SPACES               TO PRINT-REC2.                             
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-CUR-YYYYMMDD.                  
           MOVE WS-CUR-DD            TO WS-EDIT-DD.                             
           MOVE WS-CUR-MM            TO WS-EDIT-MM.                             
           MOVE WS-CUR-YYYY          TO WS-EDIT-YYYY.                           
           MOVE SPACES               TO PRINT-DATE.                             
                                                                                
           MOVE    '-'               TO D1 D2 D3.                               
           MOVE    F310-SCH          TO L635-SCHEME.                            
           MOVE    F310-ACC          TO WS-ACC.                                 
           MOVE    WS-ACCOUNT        TO L635-ACC.                               
           MOVE    WS-CDG            TO L635-CDG.                               
           MOVE    F310-LESSEE-CODE  TO L635-ACC-TYPE.                          
                                                                                
           MOVE    ZERO              TO WS-DOB1 WS-DOB2 WS-DOB3 WS-DOB4.        
                                                                                
           MOVE    F310-CDE-BO       TO L635-BO.                                
           MOVE    F310-CDE-CC       TO L635-CC.                                
           MOVE    F310-CDE-TC       TO L635-TC.                                
           MOVE    '/'               TO L635-SLASH1                             
                                        L635-SLASH2.                            
                                                                                
           MOVE    K800-NUM-REGN     TO K820-NUM-REGN.                          
           MOVE    K800-NUM-NRIC1    TO K820-NUM-NRIC                           
                                        L661B-NRIC.                             
           PERFORM 850-GET-NAME    THRU 850-EXIT.                               
           MOVE    WS-NAME           TO L635-APPL-NAME.                         
           MOVE    WS-NAME           TO L661B-NAME.                             
           MOVE    K820-DTE-BIRTH    TO WS-DOB1.                                
                                                                                
           IF K800-NUM-NRIC2(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC2      NOT = SPACES                                  
              MOVE    K800-NUM-REGN     TO K820-NUM-REGN                        
              MOVE    K800-NUM-NRIC2    TO K820-NUM-NRIC                        
              PERFORM 850-GET-NAME      THRU  850-EXIT                          
              MOVE    WS-NAME           TO L635-COAPPL-NAME                     
              MOVE    K820-DTE-BIRTH    TO WS-DOB2                              
           ELSE                                                                 
              MOVE SPACES               TO L635-COAPPL-NAME.                    
                                                                                
           IF K800-NUM-NRIC3(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC3      NOT = SPACES                                  
              MOVE K800-NUM-REGN     TO K820-NUM-REGN                           
              MOVE K800-NUM-NRIC3    TO K820-NUM-NRIC                           
              PERFORM 850-GET-NAME   THRU 850-EXIT                              
              MOVE WS-NAME           TO L635-THIRD-NAME                         
              MOVE K820-DTE-BIRTH    TO WS-DOB3                                 
           ELSE                                                                 
              MOVE SPACES            TO L635-THIRD-NAME.                        
                                                                                
           IF K800-NUM-NRIC4(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC4      NOT = SPACES                                  
              MOVE K800-NUM-REGN     TO K820-NUM-REGN                           
              MOVE K800-NUM-NRIC4    TO K820-NUM-NRIC                           
              PERFORM 850-GET-NAME   THRU 850-EXIT                              
              MOVE WS-NAME           TO L635-FOURTH-NAME                        
              MOVE    K820-DTE-BIRTH TO WS-DOB4                                 
           ELSE                                                                 
              MOVE SPACES            TO L635-FOURTH-NAME.                       
                                                                                
           PERFORM 860-READ-K830     THRU  860-EXIT.                            
                                                                                
           IF K800-NUM-PREMIUM-RATE IS NOT NUMERIC                              
              MOVE  ZERO        TO K800-NUM-PREMIUM-RATE                        
           END-IF.                                                              
                                                                                
           IF K800-AMT-PREMIUM      IS NOT NUMERIC                              
              MOVE  ZERO        TO K800-AMT-PREMIUM                             
           END-IF.                                                              
                                                                                
           IF K110-NOT-FOUND = 'Y'                                              
              MOVE ZEROS             TO K110-CURR-SELLING-PRICE                 
           END-IF.                                                              
                                                                                
           MOVE   K110-CURR-SELLING-PRICE    TO   L661B-SELLING-PRICE.          
                                                                                
           IF  K800-NUM-PREMIUM-RATE > 0                                        
               MOVE K800-AMT-PREMIUM       TO WS-AMT-PREMIUM                    
               COMPUTE WS-PURCHASE-PRICE =  K110-CURR-SELLING-PRICE +           
                                    WS-AMT-PREMIUM                              
               MOVE  WS-PURCHASE-PRICE     TO L635-CURR-SELL-PR                 
               MOVE  WS-AMT-PREMIUM        TO WS-AMT-PREMIUM-EDT                
               STRING '(WITH PREMIUM ' WS-AMT-PREMIUM-EDT ')'                   
                       DELIMITED BY SIZE INTO  L635-PREMIUM-TXT                 
           ELSE                                                                 
              MOVE K110-CURR-SELLING-PRICE TO L635-CURR-SELL-PR                 
              MOVE SPACES                  TO L635-PREMIUM-TXT                  
           END-IF.                                                              
                                                                                
           IF K800-NUM-CA-TAG = 'E'                                             
              MOVE ' CA = E ' TO L635-CA-TAG                                    
           ELSE                                                                 
           IF K800-NUM-CA-TAG = 'Y'                                             
              MOVE ' CA = Y ' TO L635-CA-TAG                                    
           ELSE                                                                 
              MOVE SPACES     TO L635-CA-TAG.                                   
                                                                                
           MOVE F310-NUM-BLK         TO L635-BLK-NO.                            
           MOVE F310-NUM-LEVEL       TO L635-LEVEL-NO.                          
           MOVE F310-NUM-MAIN        TO L635-MAIN-UNIT.                         
           MOVE F310-NME-STREET      TO L635-ST-NAME.                           
                                                                                
           IF   F310-NUM-POSTAL = SPACES OR LOW-VALUES  OR ZEROES               
                MOVE SPACES          TO L635-COUNTRY-POSTCDE                    
           ELSE                                                                 
                STRING 'SINGAPORE ' F310-NUM-POSTAL '.'                         
                DELIMITED BY SIZE  INTO L635-COUNTRY-POSTCDE.                   
                                                                                
           MOVE K800-DTE-EXPIRED-TP TO WS-DTE.                                  
           MOVE '/'                 TO WS-SLASH1  WS-SLASH2.                    
           MOVE WS-DTE-YYYY         TO WS-DTE-EXPIRED-TP-YYYY.                  
           MOVE WS-DTE-MM           TO WS-DTE-EXPIRED-TP-MM.                    
           MOVE WS-DTE-DD           TO WS-DTE-EXPIRED-TP-DD.                    
                                                                                
           MOVE  WS-DTE-EXPIRED-TP  TO L635-DTE-EXPIRED.                        
                                                                                
           IF K800-DTE-OPTION-EXP NOT NUMERIC                                   
              MOVE ZEROS TO WS-IN-DATE                                          
           ELSE                                                                 
              MOVE K800-DTE-OPTION-EXP TO WS-IN-DATE.                           
                                                                                
           IF WS-IN-DATE = ZEROS OR LOW-VALUES                                  
              PERFORM 1500-COMPUTE-EXPIRY-DATE  THRU 1500-EXIT                  
           ELSE                                                                 
              MOVE WS-IN-DATE TO WS-DTE-OPT-EXP.                                
                                                                                
           MOVE K110-AIX1 TO K100-KEY-FLD.                                      
                                                                                
           READ BM06K100.                                                       
                                                                                
           IF BM06K100-STATUS = 00                                              
              NEXT SENTENCE                                                     
           ELSE                                                                 
           IF BM06K100-STATUS = 23                                              
              DISPLAY 'REC NOT FOUND IN BM06K100 = ' K100-KEY-FLD               
              GO TO    800-EXIT                                                 
           ELSE                                                                 
              DISPLAY 'READ ERROR, BM06K100-STATUS ' BM06K100-STATUS            
              MOVE     BM06K100-STATUS TO RETURN-CODE                           
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           IF K100-DTE-POD-DUE NOT NUMERIC                                      
              MOVE ZEROES      TO K100-DTE-POD-DUE                              
           END-IF.                                                              
                                                                                
           IF K100-DTE-POF-DUE NOT NUMERIC                                      
              MOVE ZEROES      TO K100-DTE-POF-DUE                              
           END-IF.                                                              
                                                                                
           IF K100-DTE-POD-DUE > ZEROS OR K100-DTE-POF-DUE > ZEROS              
              MOVE 'Y'         TO WS-NUM-OPT-IN                                 
           END-IF.                                                              
                                                                                
           STRING WS-DTE-OPT-DD '/' WS-DTE-OPT-MM '/' WS-DTE-OPT-YYYY           
                  DELIMITED BY SIZE INTO L635-DTE-OPTION-EXP.                   
                                                                                
           MOVE    FUNCTION CURRENT-DATE(1:8)                                   
                                     TO WS-CURR-DATE.                           
           MOVE    WS-CURR-DATE      TO WS-CURR-DATE2.                          
                                                                                
           COMPUTE WS-DIFF = WS-IN-DATE - WS-CURR-DATE2.                        
                                                                                
           IF WS-DIFF > 0                                                       
             STRING WS-DTE-OPT-DD '/' WS-DTE-OPT-MM '/' WS-DTE-OPT-YYYY         
                    DELIMITED BY SIZE INTO L635-NEW-ACC-REJ-DATE7               
           ELSE                                                                 
               MOVE SPACES             TO L635-NEW-ACC-REJ-DATE7                
           END-IF.                                                              
                                                                                
           MOVE F310-CDE-TYP-ACTUSE     TO  BM97-NUM-FLAT-TYPE.                 
           MOVE F310-CDE-MODL-DESG      TO  BM97-CDE-MODL-DESG.                 
           MOVE FUNCTION CURRENT-DATE(1:8)  TO   WS-CURR-DATE1.                 
           MOVE WS-CURR-DATE1           TO  BM97-DTE-COMPARE.                   
           INITIALIZE                       BM97-NUM-ERROR                      
                                            BM97-NUM-SYSERR.                    
                                                                                
                                                                                
                                                                                
           CALL 'AB20C900' USING WS-BM97-AREA.                                  
                                                                                
           IF BM97-NUM-ERROR = ZEROS OR SPACES AND                              
              BM97-NUM-SYSERR = ZEROS                                           
              MOVE BM97-AMT-INSURED     TO  L635-AMT-INSURED                    
              MOVE BM97-AMT-PREMIUM     TO  L635-AMT-PREMIUM                    
           ELSE                                                                 
              DISPLAY 'BM97-SYSERR: '  BM97-NUM-SYSERR                          
              MOVE BM97-NUM-SYSERR      TO  RETURN-CODE                         
              DISPLAY 'ERROR IN CALLING AB20C900, ' BM97-NUM-ERROR              
              MOVE SPACES               TO  L635-AMT-I-R                        
                                            L635-AMT-P-R                        
              PERFORM  1000-CLOSE-ROUTINE.                                      
                                                                                
           PERFORM 890-CALL-BP13C903  THRU  890-EXIT.                           
                                                                                
       800-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
       820-CALL-AV02C015.                                                       
      *****************************************************************         
           CALL 'AV02C015'          USING                                       
                                    AV02C015-IN-POSTCODE                        
                                    AV02C015-OUT-POSTCODE-CHKSUM.               
       820-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       825-PRINT-LETTERS-STD.                                                   
      ******************************************************************        
           IF K800-NUM-ALLO-SCHEME = 'RED'                                      
              PERFORM 826-PRINT-LETTERS-RED THRU 826-EXIT                       
           ELSE                                                                 
              PERFORM 827-PRINT-LETTERS-STD THRU 827-EXIT                       
           END-IF.                                                              
                                                                                
       825-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       826-PRINT-LETTERS-RED.                                                   
      ******************************************************************        
           MOVE  SPACES       TO    PRINT-REC2.                                 
           WRITE PRINT-REC2   AFTER PAGE.                                       
                                                                                
           IF  K800-NUM-ALLO-SCHEME = 'STD'                                     
               MOVE  ' - (STD) '     TO   L635-STD-TAG                          
           ELSE                                                                 
               IF K800-NUM-ALLO-SCHEME = 'RED'                                  
                  MOVE  SPACES       TO   L635-STD-TAG                          
               ELSE                                                             
                  MOVE  ' - (RP)  '  TO   L635-STD-TAG                          
               END-IF                                                           
           END-IF.                                                              
                                                                                
           MOVE  SPACES       TO   PRINT-REC2.                                  
                                                                                
           WRITE PRINT-REC2 FROM L635-PR-LINE-0      AFTER 4.                   
           WRITE PRINT-REC2 FROM L635-PR-LINE-1      AFTER 1.                   
           WRITE PRINT-REC2 FROM L635-PR-LINE-7A     AFTER 0.                   
           WRITE PRINT-REC2 FROM L635-PR-LINE-2.                                
           WRITE PRINT-REC2 FROM L635-PR-LINE-3      AFTER 2.                   
           WRITE PRINT-REC2 FROM L635-PR-LINE-4      AFTER 1.                   
                                                                                
           IF K800-NUM-NRIC3(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC3     NOT = SPACES                                   
              WRITE PRINT-REC2 FROM L635-PR-LINE-4A AFTER 1                     
              WRITE PRINT-REC2 FROM L635-PR-LINE-4B AFTER 1                     
              WRITE PRINT-REC2 FROM L635-PR-LINE-5                              
              WRITE PRINT-REC2 FROM L635-PR-LINE-6  AFTER 1                     
              WRITE PRINT-REC2 FROM L635-PR-LINE-7                              
              WRITE PRINT-REC2 FROM L635-PR-LINE-7B                             
              WRITE PRINT-REC2 FROM L635-PR-LINE-8  AFTER 5                     
           ELSE                                                                 
              WRITE PRINT-REC2 FROM L635-PR-LINE-5                              
              WRITE PRINT-REC2 FROM L635-PR-LINE-6                              
              WRITE PRINT-REC2 FROM L635-PR-LINE-7                              
              WRITE PRINT-REC2 FROM L635-PR-LINE-7B  AFTER 3                    
              WRITE PRINT-REC2 FROM L635-PR-LINE-8   AFTER 5.                   
                                                                                
           WRITE PRINT-REC2 FROM L635-PR-LINE-9  AFTER 2.                       
           WRITE PRINT-REC2 FROM L635-PR-LINE-9A AFTER 1.                       
                                                                                
      *--------------------------------------------------------*                
      *    TO PRINT INSURANCE AMOUNT                           *                
      *--------------------------------------------------------*                
           IF K800-NUM-ALLO-SCHEME = 'RED'                                      
              WRITE PRINT-REC2 FROM L635-PR-LINE-10 AFTER 7                     
              MOVE  SPACES    TO   L635-PR-LINE-11                              
              WRITE PRINT-REC2 FROM L635-PR-LINE-11  AFTER 02                   
              WRITE PRINT-REC2 FROM L635-PR-LINE-11A AFTER 08                   
              WRITE PRINT-REC2 FROM L635-PR-LINE-11B AFTER 01                   
              WRITE PRINT-REC2 FROM BLANK-LINE       AFTER 01                   
           ELSE                                                                 
              MOVE  SPACES    TO   L635-PR-LINE-11                              
              WRITE PRINT-REC2 FROM L635-PR-LINE-11  AFTER 15                   
              WRITE PRINT-REC2 FROM L635-PR-LINE-11A AFTER 02                   
              WRITE PRINT-REC2 FROM L635-PR-LINE-11B AFTER 01                   
              WRITE PRINT-REC2 FROM BLANK-LINE       AFTER 01                   
           END-IF.                                                              
                                                                                
           WRITE PRINT-REC2 FROM L635-LINE-OIC       AFTER 14.                  
           WRITE PRINT-REC2 FROM L635-LINE-OIC1      AFTER 1.                   
                                                                                
           WRITE PRINT-REC2 FROM L635-PR-LINE-12     AFTER 2.                   
           WRITE PRINT-REC2 FROM L635-LINE-BARCODE   AFTER 0.                   
           WRITE PRINT-REC2 FROM L635-PR-LINE-13     AFTER 1.                   
           WRITE PRINT-REC2 FROM L635-PR-LINE-14     AFTER 1.                   
                                                                                
       826-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       827-PRINT-LETTERS-STD.                                                   
      ******************************************************************        
           MOVE  SPACES       TO    PRINT-REC4.                                 
           WRITE PRINT-REC4   AFTER PAGE.                                       
                                                                                
           IF  K800-NUM-ALLO-SCHEME = 'STD'                                     
               MOVE  ' - (STD) '     TO   L635-STD-TAG                          
           ELSE                                                                 
               IF K800-NUM-ALLO-SCHEME = 'RED'                                  
                  MOVE  SPACES       TO   L635-STD-TAG                          
               ELSE                                                             
                  MOVE  ' - (RP)  '  TO   L635-STD-TAG                          
               END-IF                                                           
           END-IF.                                                              
                                                                                
           MOVE  SPACES       TO   PRINT-REC4.                                  
                                                                                
           WRITE PRINT-REC4 FROM L635-PR-LINE-0      AFTER 4.                   
           WRITE PRINT-REC4 FROM L635-PR-LINE-1      AFTER 1.                   
           WRITE PRINT-REC4 FROM L635-PR-LINE-7A     AFTER 0.                   
           WRITE PRINT-REC4 FROM L635-PR-LINE-2.                                
           WRITE PRINT-REC4 FROM L635-PR-LINE-3      AFTER 2.                   
           WRITE PRINT-REC4 FROM L635-PR-LINE-4      AFTER 1.                   
                                                                                
           IF K800-NUM-NRIC3(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC3     NOT = SPACES                                   
              WRITE PRINT-REC4 FROM L635-PR-LINE-4A AFTER 1                     
              WRITE PRINT-REC4 FROM L635-PR-LINE-4B AFTER 1                     
              WRITE PRINT-REC4 FROM L635-PR-LINE-5                              
              WRITE PRINT-REC4 FROM L635-PR-LINE-6  AFTER 1                     
              WRITE PRINT-REC4 FROM L635-PR-LINE-7                              
              WRITE PRINT-REC4 FROM L635-PR-LINE-7B                             
              WRITE PRINT-REC4 FROM L635-PR-LINE-8  AFTER 6                     
           ELSE                                                                 
              WRITE PRINT-REC4 FROM L635-PR-LINE-5                              
              WRITE PRINT-REC4 FROM L635-PR-LINE-6                              
              WRITE PRINT-REC4 FROM L635-PR-LINE-7                              
              WRITE PRINT-REC4 FROM L635-PR-LINE-7B  AFTER 3                    
              WRITE PRINT-REC4 FROM L635-PR-LINE-8   AFTER 6.                   
                                                                                
           WRITE PRINT-REC4 FROM L635-PR-LINE-9  AFTER 2.                       
           WRITE PRINT-REC4 FROM L635-PR-LINE-9A AFTER 1.                       
                                                                                
      *--------------------------------------------------------*                
      *    TO PRINT INSURANCE AMOUNT                           *                
      *--------------------------------------------------------*                
           IF K800-NUM-ALLO-SCHEME = 'RED'                                      
              WRITE PRINT-REC4 FROM L635-PR-LINE-10 AFTER 7                     
              MOVE  SPACES    TO   L635-PR-LINE-11                              
              WRITE PRINT-REC4 FROM L635-PR-LINE-11  AFTER 02                   
              WRITE PRINT-REC4 FROM L635-PR-LINE-11A AFTER 08                   
              WRITE PRINT-REC4 FROM L635-PR-LINE-11B AFTER 01                   
           ELSE                                                                 
              MOVE  SPACES    TO   L635-PR-LINE-11                              
              WRITE PRINT-REC4 FROM L635-PR-LINE-11  AFTER 15                   
              WRITE PRINT-REC4 FROM L635-PR-LINE-11A AFTER 01                   
              WRITE PRINT-REC4 FROM L635-PR-LINE-11B AFTER 01                   
              WRITE PRINT-REC4 FROM BLANK-LINE       AFTER 01                   
           END-IF.                                                              
                                                                                
           WRITE PRINT-REC4 FROM L635-LINE-OIC       AFTER 14.                  
           WRITE PRINT-REC4 FROM L635-LINE-OIC1      AFTER 1.                   
                                                                                
           WRITE PRINT-REC4 FROM L635-PR-LINE-12  AFTER 2.                      
           WRITE PRINT-REC4 FROM L635-LINE-BARCODE AFTER 0.                     
           WRITE PRINT-REC4 FROM L635-PR-LINE-13  AFTER 1.                      
           WRITE PRINT-REC4 FROM L635-PR-LINE-14  AFTER 1.                      
                                                                                
       827-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       835-PRINT-LETTERS-SER.                                                   
      ******************************************************************        
           MOVE  SPACES       TO   PRINT-REC3.                                  
           WRITE PRINT-REC3 AFTER PAGE.                                         
           MOVE  SPACES       TO   L635-STD-TAG.                                
                                                                                
           IF F310-CDE-SALES-TYPE = '3A'                                        
              MOVE '(BB - SERS)'    TO   L635-STD-TAG                           
           ELSE                                                                 
              IF F310-CDE-SALES-TYPE = '03'                                     
                 MOVE '(RP - SERS)' TO   L635-STD-TAG                           
              ELSE                                                              
                 MOVE '(SERS)' TO L635-STD-TAG                                  
              END-IF                                                            
           END-IF.                                                              
           MOVE  SPACES       TO   PRINT-REC3.                                  
                                                                                
           WRITE PRINT-REC3 FROM L635-PR-LINE-0    AFTER 4.                     
           WRITE PRINT-REC3 FROM L635-PR-LINE-1    AFTER 1.                     
           WRITE PRINT-REC3 FROM L635-PR-LINE-7A   AFTER 0.                     
           WRITE PRINT-REC3 FROM L635-PR-LINE-2.                                
           WRITE PRINT-REC3 FROM L635-PR-LINE-3    AFTER 2.                     
           WRITE PRINT-REC3 FROM L635-PR-LINE-4    AFTER 1.                     
                                                                                
           IF K800-NUM-NRIC3(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC3     NOT = SPACES                                   
              WRITE PRINT-REC3 FROM L635-PR-LINE-4A AFTER 1                     
              WRITE PRINT-REC3 FROM L635-PR-LINE-4B AFTER 1                     
              WRITE PRINT-REC3 FROM L635-PR-LINE-5                              
              WRITE PRINT-REC3 FROM L635-PR-LINE-6  AFTER 1                     
              WRITE PRINT-REC3 FROM L635-PR-LINE-7                              
              WRITE PRINT-REC3 FROM L635-PR-LINE-7B                             
              WRITE PRINT-REC3 FROM L635-PR-LINE-8  AFTER 5                     
           ELSE                                                                 
              WRITE PRINT-REC3 FROM L635-PR-LINE-5                              
              WRITE PRINT-REC3 FROM L635-PR-LINE-6                              
              WRITE PRINT-REC3 FROM L635-PR-LINE-7                              
              WRITE PRINT-REC3 FROM L635-PR-LINE-7B AFTER 3                     
              WRITE PRINT-REC3 FROM L635-PR-LINE-8  AFTER 5.                    
                                                                                
           WRITE PRINT-REC3 FROM L635-PR-LINE-9  AFTER 2.                       
           WRITE PRINT-REC3 FROM L635-PR-LINE-9A AFTER 1.                       
                                                                                
      *--------------------------------------------------------*                
      *    TO PRINT INSURANCE AMOUNT                           *                
      *--------------------------------------------------------*                
           MOVE  SPACES    TO   L635-PR-LINE-11.                                
           WRITE PRINT-REC3 FROM L635-PR-LINE-11  AFTER 13.                     
           WRITE PRINT-REC3 FROM L635-PR-LINE-11A AFTER 01.                     
           WRITE PRINT-REC3 FROM L635-PR-LINE-11B AFTER 01.                     
                                                                                
           WRITE PRINT-REC3 FROM L635-LINE-OIC    AFTER 17.                     
           WRITE PRINT-REC3 FROM L635-LINE-OIC1   AFTER 1.                      
                                                                                
           WRITE PRINT-REC3 FROM L635-PR-LINE-12  AFTER 3.                      
           WRITE PRINT-REC3 FROM L635-LINE-BARCODE AFTER 0.                     
           WRITE PRINT-REC3 FROM L635-PR-LINE-13  AFTER 1.                      
           WRITE PRINT-REC3 FROM L635-PR-LINE-14  AFTER 1.                      
                                                                                
       835-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       840-SER-LETTER-COPY.                                                     
      ******************************************************************        
           MOVE  SPACES      TO    PRINT-REC-A.                                 
           WRITE PRINT-REC-A AFTER PAGE.                                        
           MOVE  SPACES       TO   L635-STD-TAG.                                
                                                                                
           IF F310-CDE-SALES-TYPE = '3A'                                        
              MOVE '(BB - SERS)'    TO   L635-STD-TAG                           
           ELSE                                                                 
              IF F310-CDE-SALES-TYPE = '03'                                     
                 MOVE '(RP - SERS)' TO   L635-STD-TAG                           
              ELSE                                                              
                 MOVE '(SERS)' TO L635-STD-TAG                                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE  SPACES       TO   PRINT-REC-A.                                 
                                                                                
           WRITE PRINT-REC-A  FROM L635-PR-LINE-0    AFTER 4.                   
           WRITE PRINT-REC-A  FROM L635-PR-LINE-1    AFTER 1.                   
           WRITE PRINT-REC-A  FROM L635-PR-LINE-7A   AFTER 0.                   
           WRITE PRINT-REC-A  FROM L635-PR-LINE-2.                              
           WRITE PRINT-REC-A  FROM L635-PR-LINE-3    AFTER 2.                   
           WRITE PRINT-REC-A  FROM L635-PR-LINE-4    AFTER 1.                   
                                                                                
           IF K800-NUM-NRIC3(2:1) NOT = '#' AND                                 
              K800-NUM-NRIC3     NOT = SPACES                                   
              WRITE PRINT-REC-A  FROM L635-PR-LINE-4A AFTER 1                   
              WRITE PRINT-REC-A  FROM L635-PR-LINE-4B AFTER 1                   
              WRITE PRINT-REC-A  FROM L635-PR-LINE-5                            
              WRITE PRINT-REC-A  FROM L635-PR-LINE-6  AFTER 1                   
              WRITE PRINT-REC-A  FROM L635-PR-LINE-7                            
              WRITE PRINT-REC-A  FROM L635-PR-LINE-7B                           
              WRITE PRINT-REC-A  FROM L635-PR-LINE-8  AFTER 5                   
           ELSE                                                                 
              WRITE PRINT-REC-A  FROM L635-PR-LINE-5                            
              WRITE PRINT-REC-A  FROM L635-PR-LINE-6                            
              WRITE PRINT-REC-A  FROM L635-PR-LINE-7                            
              WRITE PRINT-REC-A  FROM L635-PR-LINE-7B AFTER 3                   
              WRITE PRINT-REC-A  FROM L635-PR-LINE-8  AFTER 5.                  
                                                                                
           WRITE PRINT-REC-A  FROM L635-PR-LINE-9  AFTER 2.                     
           WRITE PRINT-REC-A  FROM L635-PR-LINE-9A AFTER 1.                     
                                                                                
      *--------------------------------------------------------*                
      *    TO PRINT INSURANCE AMOUNT                           *                
      *--------------------------------------------------------*                
           MOVE  SPACES    TO   L635-PR-LINE-11.                                
           WRITE PRINT-REC-A  FROM L635-PR-LINE-11  AFTER 13.                   
           WRITE PRINT-REC-A  FROM L635-PR-LINE-11A AFTER 01.                   
           WRITE PRINT-REC-A  FROM L635-PR-LINE-11B AFTER 01.                   
                                                                                
           WRITE PRINT-REC-A FROM L635-LINE-OIC     AFTER 17.                   
           WRITE PRINT-REC-A FROM L635-LINE-OIC1    AFTER 1.                    
                                                                                
           WRITE PRINT-REC-A  FROM L635-PR-LINE-12  AFTER 3.                    
           WRITE PRINT-REC-A  FROM L635-LINE-BARCODE AFTER 0.                   
           WRITE PRINT-REC-A  FROM L635-PR-LINE-13  AFTER 1.                    
           WRITE PRINT-REC-A  FROM L635-PR-LINE-14  AFTER 1.                    
                                                                                
       840-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       845-READ-BP13K022.                                                       
      ******************************************************************        
           MOVE 'N'          TO K022-FOUND.                                     
                                                                                
           MOVE F310-REGN-NO TO K022-NUM-REGN.                                  
                                                                                
           READ BP13K022 KEY IS K022-NUM-REGN.                                  
                                                                                
           IF BP13K022-STATUS = 00                                              
              MOVE 'Y' TO K022-FOUND                                            
           ELSE                                                                 
           IF BP13K022-STATUS = 23                                              
              MOVE 'N' TO K022-FOUND                                            
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K022 = '  BP13K022-STATUS              
              MOVE 'N' TO K022-FOUND.                                           
                                                                                
           MOVE 'N'          TO K024-FOUND.                                     
           IF K022-FOUND = 'Y'                                                  
              ADD 1                       TO   WS-CNT-K022                      
              MOVE K022-NUM-OIC           TO   K024-NUM-OIC                     
              PERFORM 846-READ-BP13K024   THRU 846-EXIT                         
           END-IF.                                                              
                                                                                
       845-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       846-READ-BP13K024.                                                       
      ******************************************************************        
           READ BP13K024 KEY IS K024-KEY-FLD.                                   
                                                                                
           IF BP13K024-STATUS = 00                                              
              MOVE 'Y' TO K024-FOUND                                            
           ELSE                                                                 
           IF BP13K024-STATUS = 23                                              
              MOVE 'N' TO K024-FOUND                                            
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K024 = '  BP13K024-STATUS              
              MOVE 'N' TO K024-FOUND.                                           
                                                                                
           IF K024-FOUND = 'Y'                                                  
              ADD   1  TO WS-CNT-K024                                           
           END-IF.                                                              
                                                                                
       846-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       847-GET-CSM-INFO.                                                        
      ******************************************************************        
           MOVE SPACES TO L635-HDR-PHONE-DID                                    
                          L635-DTL-HAND-PHONE                                   
                          L635-EMAIL                                            
                          L635-DTL-DID                                          
                          L635-OIC-NAME                                         
                          L635-OIC-DESG                                         
                          WS-HDR-PHONE-DID                                      
                          WS-EMAIL.                                             
                                                                                
           IF K024-FOUND = 'Y'                                                  
              PERFORM VARYING WS-CTR FROM 1 BY 1 UNTIL WS-CTR > 5               
                 MOVE SPACES TO WS-OIC-EMAIL-TAB(WS-CTR)                        
                 MOVE SPACES TO WS-OIC-TAB(WS-CTR)                              
              END-PERFORM                                                       
                                                                                
              MOVE K024-NME-OIC                 TO L635-OIC-NAME                
              MOVE 'CUSTOMER SERVICE MANAGER'   TO L635-OIC-DESG                
              MOVE K024-NUM-DID                 TO L635-HDR-PHONE-DID           
                                                   L635-CHG-APPT-DID            
              MOVE '1800-8663066'               TO L635-ASSIST-HP               
      *       MOVE 'HDBSALES@HDB.GOV.SG'        TO WS-EMAIL                     
           ELSE                                                                 
              MOVE '1800-8663066(TOLL-FREE)'    TO WS-HDR-PHONE-DID             
              MOVE FUNCTION LOWER-CASE(WS-HDR-PHONE-DID)                        
                                                TO L635-HDR-PHONE-DID           
              MOVE '64903783'                   TO L635-CHG-APPT-DID            
              MOVE '1800-8663066'               TO L635-ASSIST-HP               
      *       MOVE 'HDBSALES@HDB.GOV.SG'        TO WS-EMAIL                     
           END-IF.                                                              
                                                                                
      *    MOVE FUNCTION LOWER-CASE(WS-EMAIL)   TO L635-EMAIL.                  
                                                                                
       847-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       850-GET-NAME.                                                            
      ******************************************************************        
           READ BP13K820.                                                       
                                                                                
           IF BP13K820-STATUS = 00                                              
              MOVE K820-NME-OCCP    TO WS-NAME                                  
           ELSE                                                                 
           IF BP13K820-STATUS = 23                                              
              MOVE     SPACES       TO WS-NAME                                  
              DISPLAY 'BP13K820 RECORD NOT FOUND = ' BP13K820-STATUS            
              DISPLAY 'K820-KEY-FLD  = '    K820-KEY-FLD                        
           ELSE                                                                 
              MOVE     SPACES       TO WS-NAME                                  
              DISPLAY 'ERROR READING BP13K820 = '  BP13K820-STATUS.             
                                                                                
           ADD 1 TO WS-CNT-K820.                                                
                                                                                
       850-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       860-READ-K830.                                                           
      ******************************************************************        
           MOVE     F310-REGN-NO     TO    K830-NUM-REGN.                       
                                                                                
           READ BP13K830 KEY IS K830-NUM-REGN.                                  
                                                                                
           IF BP13K830-STATUS = 00 OR '02'                                      
              IF K830-NUM-MAIL-ADDR = SPACES OR LOW-VALUES                      
                 IF K830-NUM-ADDR-TYPE = 'H'                                    
                    MOVE SPACES              TO L635-STREET-NAME                
                    MOVE K830-NUM-BLK        TO L635-BLKNO                      
                    MOVE K830-NUM-LVL-CHAR   TO L635-CHAR                       
                    MOVE K830-NUM-LVL-NUM    TO L635-LEVEL                      
                    MOVE K830-NUM-LVL-DASH   TO L635-DASH                       
                    MOVE K830-NUM-HSEMAIN    TO L635-HSE-MAIN                   
                    MOVE K830-NUM-HSESUB     TO L635-HSE-SUB                    
                    MOVE K830-NME-STREET     TO L635-STREET-NAME                
                                                                                
                    IF K830-NUM-POSTAL = SPACES OR LOW-VALUES OR ZEROES         
                       MOVE SPACES           TO L635-POST-CODE L635-DOT         
                    ELSE                                                        
                       STRING 'SINGAPORE ' K830-NUM-POSTAL                      
                       DELIMITED BY SIZE   INTO L635-POST-CODE                  
                       MOVE  '.'             TO L635-DOT                        
                    END-IF                                                      
                                                                                
                 ELSE                                                           
                    MOVE SPACES               TO L635-STREET-NAME               
                    MOVE K830-NUM-BLK         TO L635-BLKNO                     
                    MOVE K830-NUM-FLAT        TO L635-NUM-FLAT                  
                    MOVE K830-NME-STREET-BLDG TO L635-STREET-NAME               
                                                                                
                    IF K830-NUM-POSTAL = SPACES OR LOW-VALUES OR ZEROES         
                       MOVE SPACES            TO L635-POST-CODE                 
                    ELSE                                                        
                       STRING 'SINGAPORE '  K830-NUM-POSTAL                     
                       DELIMITED BY SIZE    INTO L635-POST-CODE                 
                       MOVE  '.'              TO L635-DOT                       
                    END-IF                                                      
                 END-IF                                                         
      *--------TO GET THE BAR CODE -----------------------------------          
                                                                                
                    MOVE SPACES               TO WS-LINK-AV02C015               
                    MOVE K830-NUM-POSTAL      TO AV02C015-IN-POSTCODE           
                    PERFORM 820-CALL-AV02C015 THRU 820-EXIT                     
                    MOVE AV02C015-OUT-POSTCODE-CHKSUM TO L635-BAR-CODE          
            ELSE                                                                
               IF K830-NUM-MAIL-ADDR-TYPE = 'H'                                 
                  MOVE SPACES                 TO L635-STREET-NAME               
                  MOVE K830-NUM-MAIL-BLK      TO L635-BLKNO                     
                  MOVE K830-NUM-MAIL-LVL-CHAR TO L635-CHAR                      
                  MOVE K830-NUM-MAIL-LVL-NUM  TO L635-LEVEL                     
                  MOVE K830-NUM-MAIL-LVL-DASH TO L635-DASH                      
                  MOVE K830-NUM-MAIL-HSEMAIN  TO L635-HSE-MAIN                  
                  MOVE K830-NUM-MAIL-HSESUB   TO L635-HSE-SUB                   
                  MOVE K830-NME-MAIL-STREET   TO L635-STREET-NAME               
                                                                                
                  IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR             
                                            ZEROES                              
                     MOVE SPACES              TO L635-POST-CODE L635-DOT        
                  ELSE                                                          
                     STRING 'SINGAPORE '    K830-NUM-MAIL-POSTAL                
                     DELIMITED BY SIZE      INTO L635-POST-CODE                 
                     MOVE  '.'                TO L635-DOT                       
                  END-IF                                                        
                                                                                
               ELSE                                                             
                  MOVE SPACES                 TO L635-STREET-NAME               
                  MOVE K830-NUM-MAIL-BLK      TO L635-BLKNO                     
                  MOVE K830-NUM-MAIL-FLAT     TO L635-NUM-FLAT                  
                  MOVE K830-NME-MAIL-STR-BLDG TO L635-STREET-NAME               
                                                                                
                  IF K830-NUM-MAIL-POSTAL = SPACES OR LOW-VALUES OR             
                                            ZEROES                              
                     MOVE SPACES              TO L635-POST-CODE                 
                  ELSE                                                          
                     STRING 'SINGAPORE '    K830-NUM-MAIL-POSTAL                
                     DELIMITED BY SIZE      INTO L635-POST-CODE                 
                     MOVE  '.'                TO L635-DOT                       
                  END-IF                                                        
               END-IF                                                           
      *--------TO GET THE BAR CODE -----------------------------------          
                                                                                
                    MOVE SPACES               TO WS-LINK-AV02C015               
                    MOVE K830-NUM-MAIL-POSTAL TO AV02C015-IN-POSTCODE           
                    PERFORM 820-CALL-AV02C015 THRU 820-EXIT                     
                    MOVE AV02C015-OUT-POSTCODE-CHKSUM TO L635-BAR-CODE          
                                                                                
           ELSE                                                                 
           IF BP13K830-STATUS = 23                                              
              MOVE SPACES  TO L635-BLKNO                                        
                              L635-NUM-FLAT                                     
                              L635-STREET-NAME                                  
                              L635-POST-CODE                                    
                              L635-DOT                                          
              DISPLAY 'BP13K830 RECORD NOT FOUND  = ' BP13K830-STATUS           
              DISPLAY '         K830-NUM-REGN     = ' K830-NUM-REGN             
           ELSE                                                                 
              DISPLAY 'ERROR READING BP13K830 = ' BP13K830-STATUS               
              DISPLAY '      K830-NUM-REGN    = ' K830-NUM-REGN                 
              GO TO    1000-CLOSE-ROUTINE.                                      
                                                                                
           ADD 1 TO WS-CNT-K830.                                                
                                                                                
       860-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       885-GET-INCOME.                                                          
      ******************************************************************        
           MOVE 'Y'             TO WS-FIRST-CASE.                               
           MOVE K820-NUM-REGN   TO WS-K820-REGN.                                
           MOVE WS-K820-KEY     TO K820-KEY-FLD.                                
           MOVE 'N'             TO WS-REGN-CHGE.                                
                                                                                
           START BP13K820 KEY >= K820-KEY-FLD.                                  
           MOVE  ZERO           TO WS-HH-INCOME.                                
           MOVE  ZERO           TO WS-CA-INCOME.                                
                                                                                
           IF BP13K820-STATUS NOT = 00                                          
              DISPLAY 'START ERROR, BP13K820-STATUS ' BP13K820-STATUS           
           ELSE                                                                 
              PERFORM 886-READNEXT  THRU  886-EXIT                              
                       UNTIL    WS-K820-EOF  = 'Y'                              
                       OR       WS-REGN-CHGE = 'Y'.                             
                                                                                
           MOVE  WS-HH-INCOME        TO 400C-HH-INCOME.                         
           MOVE  WS-CA-INCOME        TO 400C-CA-INCOME.                         
                                                                                
       885-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       886-READNEXT.                                                            
      ******************************************************************        
           READ BP13K820 NEXT                                                   
                AT END   MOVE 'Y' TO WS-K820-EOF.                               
                                                                                
           IF K820-NUM-REGN NOT = WS-K820-REGN                                  
              MOVE 'Y' TO WS-REGN-CHGE                                          
           ELSE                                                                 
              IF (K820-AMT-INCOME   NOT = SPACES AND LOW-VALUES AND             
                                          ZEROS) AND                            
                 (K820-NUM-CA-TAG = 'CA' OR 'CD')                               
                  COMPUTE  WS-HH-INCOME = K820-AMT-INCOME +                     
                                          WS-HH-INCOME                          
              END-IF                                                            
              IF (K820-AMT-INCOME-CA NOT = SPACES AND LOW-VALUES AND            
                                           ZEROS) AND                           
                 (K820-NUM-CA-TAG = 'CA' OR 'CD')                               
                  COMPUTE  WS-CA-INCOME = K820-AMT-INCOME-CA +                  
                                          WS-CA-INCOME                          
              END-IF                                                            
           END-IF.                                                              
                                                                                
       886-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       890-CALL-BP13C903.                                                       
      ******************************************************************        
           MOVE     FUNCTION CURRENT-DATE(1:8)  TO  WS-CURR-DATE1.              
           MOVE     WS-CURR-DATE1        TO    WS-S903-SO-EFF-DATE.             
           MOVE     ZEROES               TO    WS-S903-SC-CC1                   
                                               WS-S903-SC-CC2                   
                                               WS-S903-SC-CC3.                  
           MOVE     ZEROES               TO    WS-S903-SC-REBATE1               
                                               WS-S903-SC-REBATE2               
                                               WS-S903-SC-REBATE3               
                                               WS-S903-SC-GRANT1                
                                               WS-S903-SC-GRANT2                
                                               WS-S903-SC-GRANT3                
                                               WS-S903-SC-REC-TC1               
                                               WS-S903-SC-REC-TC2               
                                               WS-S903-SC-REC-TC3               
                                               WS-S903-SC-TOTAL-AMT.            
           MOVE     ZEROES               TO    WS-S903-SC-TOTAL-AMT.            
           MOVE     F310-SCH-ACC(1:9)    TO    WS-S903-NUM-SCH-ACC.             
           MOVE     F310-CDE-TYP-ACTUSE  TO    WS-S903-ROOM-TY.                 
           MOVE     F310-CDE-MODL-DESG   TO    WS-S903-DESIGN-TY.               
                                                                                
      *-----------------------------------------------------------*             
      *    CALL BP13C903 TO GET THE SC-CC1,SC-CC2 AND SC-CC3      *             
      *-----------------------------------------------------------*             
           CALL 'BP13C903' USING WS-LINK-S903.                                  
                                                                                
      *-----------------------------------------------------------*             
      *    CALL AV02C021 TO COMPUTE THE GST FOR SC-CC1 & SC-CC2   *             
      *-----------------------------------------------------------*             
           MOVE  WS-S903-SC-CC1     TO  WS-AMT-NETT.                            
           CALL 'AV02C021' USING WS-COMM-AREA-GST.                              
                                                                                
           MOVE  WS-AMT-GST         TO WS-S903-SC-CC1-GST.                      
                                                                                
           MOVE  WS-S903-SC-REC-TC1 TO  WS-AMT-NETT.                            
           CALL 'AV02C021' USING WS-COMM-AREA-GST.                              
           MOVE  WS-AMT-GST         TO WS-S903-SC-TC1-GST.                      
                                                                                
           IF (K800-NUM-SCCC-ELGBTY = 'N' OR 'Z') OR                            
              (K800-NUM-ALLO-SCHEME = 'SPO' OR 'SPP' OR 'SSP' OR                
                                      'SPS' OR 'SRP')                           
              COMPUTE WS-SC-CC1-AMT =  WS-S903-SC-CC1     +                     
                                       WS-S903-SC-CC1-GST +                     
                                       WS-S903-SC-REC-TC1 +                     
                                       WS-S903-SC-TC1-GST                       
           ELSE                                                                 
              COMPUTE WS-SC-CC1-AMT =  WS-S903-SC-CC1     +                     
                                       WS-S903-SC-CC1-GST -                     
                                       WS-S903-SC-REBATE1 -                     
                                       WS-S903-SC-GRANT1  -                     
                                       WS-S903-SC-REB-SP1                       
           END-IF.                                                              
                                                                                
           MOVE WS-SC-CC1-AMT       TO  L310-AMT-CURR-SCCC.                     
           DISPLAY 'SC-CC1 ' WS-SC-CC1-AMT.                                     
                                                                                
           MOVE WS-S903-SC-CURR-EFF-DATE TO WS-DTE-WEF.                         
           MOVE WS-WEF-DD                TO WS-SCCC-DD.                         
           MOVE WS-WEF-MM                TO WS-SCCC-MM.                         
           MOVE WS-WEF-YYYY              TO WS-SCCC-YYYY.                       
           MOVE WS-DTE-SCCC              TO L310-DTE-CURR-SCCC.                 
                                                                                
           IF (K800-NUM-SCCC-ELGBTY        = 'N' OR 'Z') OR                     
              (K800-NUM-ALLO-SCHEME        = 'SPO' OR 'SPP' OR 'SSP' OR         
                                             'SPS' OR 'SRP')                    
              COMPUTE WS-SC-CC-NUM-AMT     =  WS-S903-SC-CC1 +                  
                                              WS-S903-SC-REC-TC1                
              COMPUTE WS-SC-CC-NUM-AMT-GST =  WS-S903-SC-CC1-GST +              
                                              WS-S903-SC-TC1-GST                
              MOVE WS-SC-CC-NUM-AMT        TO WS-SC-CC-AMT                      
              MOVE WS-SC-CC-NUM-AMT-GST    TO WS-SC-CC-AMT-GST                  
           ELSE                                                                 
              MOVE WS-S903-SC-CC1          TO WS-SC-CC-AMT                      
              MOVE WS-S903-SC-CC1-GST      TO WS-SC-CC-AMT-GST                  
           END-IF.                                                              
                                                                                
           IF (K800-NUM-SCCC-ELGBTY      = 'N' OR 'Z') OR                       
              (K800-NUM-ALLO-SCHEME      = 'SPO' OR 'SSP' OR 'SPP' OR           
                                           'SPS' OR 'SRP')                      
              MOVE ')'                   TO WS-SC-CC-SIGN                       
              MOVE ZEROES                TO WS-SC-CC-REBATE-AMT                 
              MOVE SPACES                TO WS-SC-CC-REBATE-DESC                
              MOVE SPACES                TO WS-SC-CC-SIGN2                      
              MOVE ZEROES                TO WS-SC-CC-GRANT-AMT                  
              MOVE SPACES                TO WS-SC-CC-GRANT-DESC                 
              MOVE SPACES                TO WS-SC-CC-SIGN3                      
              MOVE ZEROES                TO WS-SC-CC-REB-SP-AMT                 
              MOVE SPACES                TO WS-SC-CC-REB-SP-DESC                
           ELSE                                                                 
           IF WS-S903-SC-REBATE1         =  ZEROES                              
              IF WS-S903-SC-GRANT1       =  ZEROES                              
                 IF WS-S903-SC-REB-SP1   =  ZEROES OR                           
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN                       
                    MOVE ZEROES          TO WS-SC-CC-REBATE-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REBATE-DESC                
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN                       
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-REBATE-AMT              
                    MOVE  'SP)'          TO WS-SC-CC-REBATE-DESC                
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN                       
                 MOVE WS-S903-SC-GRANT1  TO WS-SC-CC-REBATE-AMT                 
                 MOVE 'GRT'              TO WS-SC-CC-REBATE-DESC                
                 IF WS-S903-SC-REB-SP1    =  ZEROES OR                          
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              MOVE '-'                   TO WS-SC-CC-SIGN                       
              MOVE WS-S903-SC-REBATE1    TO WS-SC-CC-REBATE-AMT                 
              MOVE 'REB'                 TO WS-SC-CC-REBATE-DESC                
              IF WS-S903-SC-GRANT1        =  ZEROES                             
                 IF WS-S903-SC-REB-SP1    =  ZEROES OR                          
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN2                      
                 MOVE WS-S903-SC-GRANT1  TO WS-SC-CC-GRANT-AMT                  
                 MOVE 'GRT'              TO WS-SC-CC-GRANT-DESC                 
                 IF WS-S903-SC-REB-SP1    =  ZEROES OR                          
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN3                      
                    MOVE WS-S903-SC-REB-SP1 TO WS-SC-CC-REB-SP-AMT              
                    MOVE  'SP)'          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE WS-SC-CC1-AMT            TO L635-AMT-CURR-SCCC.                 
           MOVE WS-DTE-SCCC              TO L635-DTE-CURR-SCCC.                 
           MOVE WS-SC-CC-DESC            TO L635-CURR-GST-DESC                  
                                            L310-CURR-GST-DESC.                 
                                                                                
           IF   WS-S903-SC-CC1 = WS-S903-SC-CC2                                 
                MOVE WS-S903-SC-CC1-GST  TO WS-S903-SC-CC2-GST                  
           ELSE                                                                 
                MOVE WS-S903-SC-CC2     TO  WS-AMT-NETT                         
                CALL 'AV02C021'     USING   WS-COMM-AREA-GST                    
                MOVE WS-AMT-GST         TO  WS-S903-SC-CC2-GST.                 
                                                                                
           IF   WS-S903-SC-REC-TC1 = WS-S903-SC-REC-TC2                         
                MOVE WS-S903-SC-TC1-GST  TO WS-S903-SC-TC2-GST                  
           ELSE                                                                 
                MOVE WS-S903-SC-REC-TC2  TO  WS-AMT-NETT                        
                CALL 'AV02C021'     USING   WS-COMM-AREA-GST                    
                MOVE WS-AMT-GST         TO  WS-S903-SC-TC2-GST.                 
                                                                                
           IF (K800-NUM-SCCC-ELGBTY = 'N' OR 'Z') OR                            
              (K800-NUM-ALLO-SCHEME = 'SPO' OR 'SPP' OR 'SSP' OR                
                                      'SPS' OR 'SRP')                           
              COMPUTE WS-SC-CC2-AMT =  WS-S903-SC-CC2     +                     
                                       WS-S903-SC-CC2-GST +                     
                                       WS-S903-SC-REC-TC2 +                     
                                       WS-S903-SC-TC2-GST                       
           ELSE                                                                 
              COMPUTE WS-SC-CC2-AMT =  WS-S903-SC-CC2     +                     
                                       WS-S903-SC-CC2-GST -                     
                                       WS-S903-SC-REBATE2 -                     
                                       WS-S903-SC-GRANT2  -                     
                                       WS-S903-SC-REB-SP2                       
           END-IF.                                                              
                                                                                
           MOVE WS-SC-CC2-AMT       TO  L310-AMT-NEXT-SCCC.                     
                                                                                
           MOVE WS-S903-SC-NEXT-EFF-DATE TO WS-DTE-WEF.                         
           MOVE WS-WEF-DD                TO WS-SCCC-DD.                         
           MOVE WS-WEF-MM                TO WS-SCCC-MM.                         
           MOVE WS-WEF-YYYY              TO WS-SCCC-YYYY.                       
           MOVE WS-DTE-SCCC              TO L310-DTE-NEXT-SCCC.                 
                                                                                
           IF (K800-NUM-SCCC-ELGBTY        = 'N' OR 'Z') OR                     
              (K800-NUM-ALLO-SCHEME        = 'SPO' OR 'SPP' OR 'SSP' OR         
                                             'SPS' OR 'SRP')                    
              COMPUTE WS-SC-CC-NUM-AMT     =  WS-S903-SC-CC2 +                  
                                              WS-S903-SC-REC-TC2                
              COMPUTE WS-SC-CC-NUM-AMT-GST =  WS-S903-SC-CC2-GST +              
                                              WS-S903-SC-TC2-GST                
              MOVE WS-SC-CC-NUM-AMT        TO WS-SC-CC-AMT                      
              MOVE WS-SC-CC-NUM-AMT-GST    TO WS-SC-CC-AMT-GST                  
           ELSE                                                                 
              MOVE WS-S903-SC-CC2          TO WS-SC-CC-AMT                      
              MOVE WS-S903-SC-CC2-GST      TO WS-SC-CC-AMT-GST                  
           END-IF.                                                              
                                                                                
           IF (K800-NUM-SCCC-ELGBTY      = 'N' OR 'Z') OR                       
              (K800-NUM-ALLO-SCHEME      = 'SPO' OR 'SPP' OR 'SSP' OR           
                                           'SPS' OR 'SRP')                      
              MOVE ')'                   TO WS-SC-CC-SIGN                       
              MOVE ZEROES                TO WS-SC-CC-REBATE-AMT                 
              MOVE SPACES                TO WS-SC-CC-REBATE-DESC                
              MOVE SPACES                TO WS-SC-CC-SIGN2                      
              MOVE ZEROES                TO WS-SC-CC-GRANT-AMT                  
              MOVE SPACES                TO WS-SC-CC-GRANT-DESC                 
              MOVE SPACES                TO WS-SC-CC-SIGN3                      
              MOVE ZEROES                TO WS-SC-CC-REB-SP-AMT                 
              MOVE SPACES                TO WS-SC-CC-REB-SP-DESC                
           ELSE                                                                 
           IF WS-S903-SC-REBATE2         =  ZEROES                              
              IF WS-S903-SC-GRANT2       =  ZEROES                              
                 IF WS-S903-SC-REB-SP2   =  ZEROES OR                           
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN                       
                    MOVE ZEROES          TO WS-SC-CC-REBATE-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REBATE-DESC                
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN                       
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-REBATE-AMT              
                    MOVE  'SP)'          TO WS-SC-CC-REBATE-DESC                
                    MOVE SPACES          TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN                       
                 MOVE WS-S903-SC-GRANT2  TO WS-SC-CC-REBATE-AMT                 
                 MOVE 'GRT'              TO WS-SC-CC-REBATE-DESC                
                 IF WS-S903-SC-REB-SP2    =  ZEROES OR                          
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              MOVE '-'                   TO WS-SC-CC-SIGN                       
              MOVE WS-S903-SC-REBATE2    TO WS-SC-CC-REBATE-AMT                 
              MOVE 'REB'                 TO WS-SC-CC-REBATE-DESC                
              IF WS-S903-SC-GRANT1        =  ZEROES                             
                 IF WS-S903-SC-REB-SP2    =  ZEROES OR                          
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN2                      
                    MOVE ZEROES          TO WS-SC-CC-GRANT-AMT                  
                    MOVE SPACES          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN2                      
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-GRANT-AMT               
                    MOVE  'SP)'          TO WS-SC-CC-GRANT-DESC                 
                    MOVE SPACES          TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              ELSE                                                              
                 MOVE '-'                TO WS-SC-CC-SIGN2                      
                 MOVE WS-S903-SC-GRANT2  TO WS-SC-CC-GRANT-AMT                  
                 MOVE 'GRT'              TO WS-SC-CC-GRANT-DESC                 
                 IF WS-S903-SC-REB-SP2    =  ZEROES OR                          
                    WS-S903-ROOM-TY      =  '06'                                
                    MOVE ')'             TO WS-SC-CC-SIGN3                      
                    MOVE ZEROES          TO WS-SC-CC-REB-SP-AMT                 
                    MOVE SPACES          TO WS-SC-CC-REB-SP-DESC                
                 ELSE                                                           
                    MOVE '-'             TO WS-SC-CC-SIGN3                      
                    MOVE WS-S903-SC-REB-SP2 TO WS-SC-CC-REB-SP-AMT              
                    MOVE  'SP)'          TO WS-SC-CC-REB-SP-DESC                
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE WS-SC-CC2-AMT            TO L635-AMT-NEXT-SCCC.                 
           MOVE WS-DTE-SCCC              TO L635-DTE-NEXT-SCCC.                 
           MOVE WS-SC-CC-DESC            TO L635-NEXT-GST-DESC                  
                                            L310-NEXT-GST-DESC.                 
                                                                                
           COMPUTE WS-TOT-SCCC ROUNDED = WS-SC-CC1-AMT +                        
                                        (WS-SC-CC2-AMT * 2).                    
           MOVE WS-TOT-SCCC              TO 400C-SC-CC-AMT.                     
                                                                                
       890-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       900-SETUP-WORKSHEET.                                                     
      ******************************************************************        
      *PARTA CALCULATION                                                        
           PERFORM 910-COMPUTE-COMM-DEPOSIT      THRU 910-EXIT.                 
           PERFORM 920-COMPUTE-LSTAMP-FEE        THRU 920-EXIT.                 
           PERFORM 930-COMPUTE-CONVEY-FEE        THRU 930-EXIT.                 
           PERFORM 935-COMPUTE-CREDIT-ASSESMNT   THRU 935-EXIT.                 
           PERFORM 940-COMPUTE-PARTC-WSHEET      THRU 940-EXIT.                 
                                                                                
       900-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       910-COMPUTE-COMM-DEPOSIT.                                                
      ******************************************************************        
           IF K110-CURR-SELLING-PRICE IS NUMERIC                                
              MOVE K110-CURR-SELLING-PRICE  TO WS-K110-CSPRICE                  
           ELSE                                                                 
              MOVE ZEROES                   TO WS-K110-CSPRICE.                 
                                                                                
           MOVE   WS-K110-CSPRICE           TO L211-PURCHASE-PRICE.             
                                                                                
           IF K800-NUM-PREMIUM-RATE IS NOT NUMERIC                              
               MOVE   ZERO                  TO K800-NUM-PREMIUM-RATE            
           END-IF.                                                              
                                                                                
           IF K800-AMT-PREMIUM      IS NOT NUMERIC                              
               MOVE   ZERO                  TO K800-AMT-PREMIUM                 
           END-IF.                                                              
                                                                                
           MOVE K800-AMT-PREMIUM  TO WS-AMT-PREMIUM.                            
                                                                                
           COMPUTE WS-K110-CSPRICE-PREMIUM =                                    
                   WS-K110-CSPRICE +  WS-AMT-PREMIUM.                           
                                                                                
           PERFORM 915-GET-CD-PERCENT THRU 915-EXIT.                            
                                                                                
           MOVE WS-SR08-CD-PCT    TO L211-NUM-DEPOSIT.                          
                                                                                
           COMPUTE WS-COMP-SELLPR = (WS-SR08-CD-PCT / 100) *                    
                                    WS-K110-CSPRICE.                            
                                                                                
           COMPUTE WS-COMP-SELLPR-PREMIUM = (WS-SR08-CD-PCT / 100) *            
                                    WS-K110-CSPRICE-PREMIUM.                    
                                                                                
           MOVE WS-COMP-SELLPR    TO L211-AMT-SELL-PRICE.                       
                                                                                
       910-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       915-GET-CD-PERCENT.                                                      
      ******************************************************************        
           MOVE SPACES                  TO WS-SR08-COMMAREA.                    
           INITIALIZE                      WS-SR08-COMMAREA.                    
                                                                                
           MOVE F310-SCH-ACC            TO WS-SR08-SCH-ACC.                     
           MOVE K800-NUM-IDP-SCHEME     TO WS-SR08-IDP-SCH.                     
           MOVE K800-NUM-ALLO-SCHEME    TO WS-SR08-ALLOC-SCH.                   
           MOVE K800-NUM-ELIG-SCHEME    TO WS-SR08-ELIG-SCH.                    
           MOVE SPACES                  TO WS-SR08-HALF-IDP.                    
           MOVE ZEROES                  TO WS-SR08-CD-PCT                       
                                           WS-SR08-JT-BALLOT-MTF.               
           MOVE SPACES                  TO WS-SR08-CDE-ERROR.                   
                                                                                
           CALL 'BP13C904' USING WS-SR08-COMMAREA.                              
                                                                                
       915-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       920-COMPUTE-LSTAMP-FEE.                                                  
      ******************************************************************        
           IF K110-1ST-OFFER-SELLING-PRICE IS NOT NUMERIC                       
              MOVE  ZERO         TO    K110-1ST-OFFER-SELLING-PRICE             
           END-IF.                                                              
                                                                                
           IF K110-CURR-SELLING-PRICE      IS NOT NUMERIC                       
              MOVE  ZERO         TO    K110-CURR-SELLING-PRICE                  
           END-IF.                                                              
                                                                                
           IF K110-AMT-OCS-DISCOUNT    IS NOT NUMERIC                           
              MOVE  ZERO         TO    K110-AMT-OCS-DISCOUNT                    
           END-IF.                                                              
                                                                                
           IF K110-AMT-FLAT-DISCOUNT   IS NOT NUMERIC                           
              MOVE  ZERO         TO    K110-AMT-FLAT-DISCOUNT                   
           END-IF.                                                              
                                                                                
           IF K110-AMT-POD  IS NOT NUMERIC                                      
              MOVE  ZERO         TO    K110-AMT-POD                             
           END-IF.                                                              
                                                                                
           IF K110-AMT-POF  IS NOT NUMERIC                                      
              MOVE  ZERO         TO    K110-AMT-POF                             
           END-IF.                                                              
                                                                                
           COMPUTE WS-PODF-AMT = K110-AMT-POD + K110-AMT-POF.                   
           MOVE  WS-PODF-AMT                  TO WS-EDT-PODF-AMT.               
                                                                                
           MOVE  K110-1ST-OFFER-SELLING-PRICE TO WS-EDT-OFFER-PRICE             
                                                 WS-K110-1ST-OSP.               
                                                                                
           MOVE  K110-AMT-OCS-DISCOUNT        TO WS-EDT-OCS-AMT                 
                                                 WS-OCS-AMT.                    
                                                                                
           MOVE  K110-AMT-FLAT-DISCOUNT       TO WS-SERS-DISC.                  
                                                                                
           MOVE  ZEROES                       TO WS-K110-OSP.                   
                                                                                
           IF ((K800-NUM-ALLO-SCHEME = 'STD' OR 'RP ' OR 'RED') OR              
               (WS-SCH-FND = 'Y')) AND (K110-CDE-OCS-TAG  = 'N')                
              STRING '(*OSP ' WS-EDT-OFFER-PRICE                                
                     ' - OCS '  WS-EDT-OCS-AMT ')'                              
                     DELIMITED BY SIZE INTO    L211-LS-FEE-TXT                  
                                                                                
              MOVE SPACES           TO L211-OP-TXT                              
                                                                                
              IF K800-NUM-ALLO-SCHEME = 'STD' OR 'SMS' OR 'SEF' OR              
                               'SMF' OR 'RP'  OR 'RED' OR 'SRD' OR              
                               'SSD' OR 'SJD' OR 'SDF' OR 'SSS' OR              
                               'SFO' OR 'SRO' OR 'SJO'                          
                 MOVE 'PURCHASE PRICE      : $'                                 
                                            TO 400C-SELL-PRICE-DESC             
              END-IF                                                            
           ELSE                                                                 
              IF ((K800-NUM-ALLO-SCHEME = 'STD' OR 'RP ' OR 'RED') OR           
                  (WS-SCH-FND = 'Y')) AND (WS-NUM-OPT-IN  = 'Y')                
                 STRING '(OSP ' WS-EDT-OFFER-PRICE                              
                        '+PODF '  WS-EDT-PODF-AMT ')'                           
                        DELIMITED BY SIZE INTO    L211-LS-FEE-TXT               
                                                                                
                 MOVE SPACES           TO L211-OP-TXT                           
                                                                                
                 IF K800-NUM-ALLO-SCHEME = 'STD' OR 'SMS' OR 'SEF' OR           
                                  'SMF' OR 'RP'  OR 'RED' OR 'SRD' OR           
                                  'SSD' OR 'SJD' OR 'SDF' OR 'SSS' OR           
                                  'SFO' OR 'SRO' OR 'SJO'                       
                   MOVE 'PURCHASE PRICE      : $'                               
                                              TO 400C-SELL-PRICE-DESC           
                 END-IF                                                         
              ELSE                                                              
                 IF K800-NUM-ALLO-SCHEME = 'STD' OR 'SMS' OR 'SEF' OR           
                                           'SRD' OR 'SMF' OR 'RP'  OR           
                                           'RED' OR 'SSD' OR 'SJD' OR           
                                           'SDF' OR 'SFO' OR 'SRO' OR           
                                           'SJO' OR 'SSS'                       
                    MOVE SPACES TO  L310A-PR-HEAD-11                            
                    STRING '(BASED ON *OP ' WS-EDT-OFFER-PRICE ')'              
                          DELIMITED BY SIZE INTO    L211-LS-FEE-TXT             
                    MOVE  '*OP = OFFER SELLING PRICE' TO  L211-OP-TXT           
                                                                                
                    MOVE 'PURCHASE PRICE      : $'                              
                                               TO 400C-SELL-PRICE-DESC          
                 ELSE                                                           
                    MOVE   SPACES              TO L211-LS-FEE-TXT               
                    MOVE   SPACES              TO L211-OP-TXT                   
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE  K110-1ST-OFFER-SELLING-PRICE TO 400C-OFFER-SP.                 
                                                                                
           IF K110-CDE-OCS-TAG = 'N'                                            
              MOVE  K110-AMT-OCS-DISCOUNT        TO 400C-DISC-OCS               
              MOVE 'DISCOUNT OCS        : $'     TO 400C-DISC-OCS-DESC          
           ELSE                                                                 
              IF WS-NUM-OPT-IN = 'Y'                                            
                 MOVE  WS-PODF-AMT               TO 400C-DISC-OCS               
                 MOVE 'PODF AMOUNT         : $'  TO 400C-DISC-OCS-DESC          
              ELSE                                                              
                 MOVE  K110-AMT-OCS-DISCOUNT     TO 400C-DISC-OCS               
                 MOVE 'DISCOUNT OCS        : $'  TO 400C-DISC-OCS-DESC          
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE  K110-AMT-FLAT-DISCOUNT       TO 400C-DISC-SERS.                
           MOVE  K110-CURR-SELLING-PRICE      TO 400C-SELL-PRICE.               
                                                                                
      ***BP132207 REMOVE 30% DISCOUNT                                           
      *==> 0.007 --> 0.01 (REMOVE DISCOUNT FROM 2001 OFF-BUDGET)                
      *==> 0.014 --> 0.02 (REMOVE DISCOUNT FROM 2001 OFF-BUDGET)                
      *==> 0.021 --> 0.03 (REMOVE DISCOUNT FROM 2001 OFF-BUDGET)                
                                                                                
           COMPUTE WS-SF-OFFER-PRICE = K110-CURR-SELLING-PRICE +                
                                       K110-AMT-FLAT-DISCOUNT.                  
                                                                                
           IF WS-SF-OFFER-PRICE NOT > 180000                                    
              COMPUTE WS-COMP-LS-FEE = 0.01 * WS-SF-OFFER-PRICE                 
           ELSE                                                                 
              COMPUTE WS-LS-LEAVE = WS-SF-OFFER-PRICE - 180000                  
              IF WS-LS-LEAVE NOT  > 180000                                      
                 COMPUTE WS-COMP-LS-FEE = 0.01 * 180000 +                       
                                         (0.02 * WS-LS-LEAVE)                   
              ELSE                                                              
                 COMPUTE WS-LS-LEAVE    = WS-SF-OFFER-PRICE                     
                                          - 360000                              
                 COMPUTE WS-COMP-LS-FEE = (0.01 * 180000) +                     
                                          (0.02 * 180000) +                     
                                          (0.03 * WS-LS-LEAVE)                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *==> SC/CC AD VALOREM                                                     
           IF (K800-NUM-SCCC-ELGBTY  = 'N' OR 'Z') OR                           
              (K800-NUM-ALLO-SCHEME  = 'SPO' OR 'SPP' OR 'SSP' OR               
                                       'SPS' OR 'SRP')                          
              COMPUTE WS-S905-SC-CC1 = WS-S903-SC-CC1 +                         
                                       WS-S903-SC-REC-TC1                       
              COMPUTE WS-S905-SC-CC2 = WS-S903-SC-CC2 +                         
                                       WS-S903-SC-REC-TC2                       
              COMPUTE WS-S905-SC-CC3 = WS-S903-SC-CC3 +                         
                                       WS-S903-SC-REC-TC3                       
              MOVE ZEROES           TO WS-S905-SC-TOTAL-AMT                     
           ELSE                                                                 
              MOVE WS-S903-SC-CC1   TO WS-S905-SC-CC1                           
              MOVE WS-S903-SC-CC2   TO WS-S905-SC-CC2                           
              MOVE WS-S903-SC-CC3   TO WS-S905-SC-CC3                           
              MOVE ZEROES           TO WS-S905-SC-TOTAL-AMT                     
           END-IF.                                                              
                                                                                
      *==> CALL BP13C905 TO GET THE AD VALOREM STAMP FEE                        
      *    COMPUTE THE SC/CC AD-VALOREM , USE PURE SC-CC ONLY!                  
                                                                                
           CALL 'BP13C905' USING WS-LINK-S905.                                  
           IF WS-S905-SC-TOTAL-AMT IS NUMERIC                                   
                                                                                
              ADD  WS-S905-SC-TOTAL-AMT  TO  WS-COMP-LS-FEE.                    
      *==> $1.40 FOR DUPLICATE SALES AGREEMENT (2001 OFF-BUDGET)                
      *==> $2 FOR DUPLICATE SALES AGREEMENT (ORIGINAL)                          
           ADD  2                        TO  WS-COMP-LS-FEE.                    
                                                                                
           MOVE WS-COMP-LS-FEE           TO L211-AMT-LS-FEE.                    
                                                                                
       920-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       930-COMPUTE-CONVEY-FEE.                                                  
      ******************************************************************        
           IF K110-CURR-SELLING-PRICE NOT > 30000                               
              COMPUTE WS-COMP-CV-FEE = 0.0009                                   
                                      * K110-CURR-SELLING-PRICE                 
           ELSE                                                                 
              COMPUTE WS-CONV-LEAVE = K110-CURR-SELLING-PRICE                   
                                      - 30000                                   
              IF WS-CONV-LEAVE NOT  > 30000                                     
                 COMPUTE WS-COMP-CV-FEE = 0.0009 * 30000 +                      
                                          (0.00072 * WS-CONV-LEAVE)             
              ELSE                                                              
                 COMPUTE WS-CONV-LEAVE  = K110-CURR-SELLING-PRICE               
                                           - 60000                              
                 COMPUTE WS-COMP-CV-FEE = (0.0009 * 30000) +                    
                                          (0.00072 * 30000) +                   
                                          (0.00060 * WS-CONV-LEAVE)             
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *==> THE MINIMUM CONVEY FEE IS $20                                        
      *    ROUND IT UP TO THE NEAREST DOLLAR EG. $51.20 BECOME $52.00           
                                                                                
            IF WS-COMP-CV-FEE NOT > 20                                          
               MOVE 20              TO  WS-COMP-CV-FEE                          
            ELSE                                                                
               ADD 0.49             TO  WS-COMP-CV-FEE                          
               COMPUTE WS-ROUND-CONVFEE ROUNDED = WS-COMP-CV-FEE / 100          
               COMPUTE WS-COMP-CV-FEE          = WS-ROUND-CONVFEE * 100.        
                                                                                
      *==> COMPUTING GST FOR CONVEYANCING FEES                                  
            MOVE  WS-COMP-CV-FEE     TO   WS-AMT-NETT                           
                                          L211-ACT-CV-FEE.                      
                                                                                
            CALL 'AV02C021' USING WS-COMM-AREA-GST.                             
                                                                                
            ADD   WS-AMT-GST         TO   WS-COMP-CV-FEE.                       
            MOVE  WS-AMT-GST         TO   L211-GST-CV-FEE.                      
            MOVE  WS-COMP-CV-FEE     TO   L211-AMT-CV-FEE.                      
                                                                                
      * TO REMOVE ODD CENTS                                                     
            MOVE SPACES              TO   WS-COMM-AREA-ODDCENTS.                
            INITIALIZE                    WS-COMM-AREA-ODDCENTS.                
                                                                                
            MOVE  WS-NUM-GST-RATE    TO   WS-COMM-ODD-GST-RATE.                 
            MOVE  WS-COMP-CV-FEE     TO   WS-COMM-ODD-TOTAL-FEE.                
                                                                                
            CALL 'BP13C90B' USING WS-COMM-AREA-ODDCENTS.                        
                                                                                
            IF WS-COMM-ODD-CENTS-SW = 'Y'                                       
               MOVE WS-COMM-ODD-GST       TO WS-AMT-GST                         
                                             L211-GST-CV-FEE                    
               MOVE WS-COMM-ODD-BASE-FEE  TO L211-ACT-CV-FEE                    
               MOVE WS-COMM-ODD-TOTAL-FEE TO WS-COMP-CV-FEE                     
                                             L211-AMT-CV-FEE                    
            END-IF.                                                             
                                                                                
            COMPUTE   WS-COMP-TOTAL   =   WS-COMP-LS-FEE +                      
                                          WS-COMP-CV-FEE +                      
                                          WS-COMP-SELLPR.                       
                                                                                
            MOVE      WS-COMP-TOTAL   TO  L211-AMT-TOTAL.                       
                                                                                
       930-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       935-COMPUTE-CREDIT-ASSESMNT.                                             
      ******************************************************************        
           PERFORM  2000-READ-K640       THRU   2000-EXIT.                      
                                                                                
           IF K800-NUM-CA-TAG = 'Y'                                             
               IF  K640-AMT-REPAY-PERIOD IS NOT NUMERIC                         
                   MOVE  ZERO            TO  K640-AMT-REPAY-PERIOD              
               END-IF                                                           
               MOVE     K640-AMT-REPAY-PERIOD                                   
                                             TO     WS-S901-REPAY-PD            
                                                    400C-REPAY-PRD              
                                                    400C-REPAY-PRDA             
               IF  K640-AMT-INTEREST-RATE IS NOT NUMERIC                        
                   MOVE  ZERO            TO  K640-AMT-INTEREST-RATE             
               END-IF                                                           
               MOVE     K640-AMT-INTEREST-RATE TO   400C-INT-RATE               
                                                    400C-INT-RATEA              
               IF  K640-AMT-MAX-LOAN IS NOT NUMERIC                             
                   MOVE  ZERO            TO  K640-AMT-MAX-LOAN                  
               END-IF                                                           
               MOVE     K640-AMT-MAX-LOAN    TO     400C-MAX-LOAN-ELIG          
               IF  K640-AMT-ELIG-INSTAL IS NOT NUMERIC                          
                   MOVE  ZERO            TO  K640-AMT-ELIG-INSTAL               
               END-IF                                                           
               IF  K800-AMT-HSE-INCOME  IS NOT NUMERIC                          
                   MOVE  ZERO            TO  K800-AMT-HSE-INCOME                
               END-IF                                                           
               PERFORM 937-YOUNGEST-APPL    THRU   937-EXIT                     
           ELSE                                                                 
           IF K800-NUM-CA-TAG = 'E'                                             
              MOVE '30'                      TO     400C-REPAY-PRD              
                                                    400C-REPAY-PRDA             
               IF  K640-AMT-INTEREST-RATE IS NOT NUMERIC                        
                   MOVE  ZERO            TO  K640-AMT-INTEREST-RATE             
               END-IF                                                           
              MOVE K640-AMT-INTEREST-RATE    TO     400C-INT-RATE               
                                                    400C-INT-RATEA              
           END-IF.                                                              
                                                                                
       935-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       937-YOUNGEST-APPL.                                                       
      ******************************************************************        
            MOVE    ZEROS             TO      WS-DOB-DAYS.                      
            MOVE FUNCTION CURRENT-DATE(1:8)  TO  WS-CURR-DATE2.                 
                                                                                
            IF WS-DOB1 = ZERO  OR LOW-VALUES OR SPACES                          
            IF WS-DOB2 = ZERO  OR LOW-VALUES OR SPACES                          
            IF WS-DOB3 = ZERO  OR LOW-VALUES OR SPACES                          
            IF WS-DOB4 = ZERO  OR LOW-VALUES OR SPACES                          
                  GO TO 937-EXIT                                                
            END-IF.                                                             
                                                                                
            IF WS-DOB1 = SPACES OR LOW-VALUES OR ZERO                           
                 MOVE '00000000'    TO   WS-DOB1.                               
                                                                                
            IF WS-DOB2 = SPACES OR LOW-VALUES OR ZERO                           
                 MOVE '00000000'    TO   WS-DOB2.                               
                                                                                
            IF WS-DOB3 = SPACES OR LOW-VALUES OR ZERO                           
                 MOVE '00000000'    TO   WS-DOB3.                               
                                                                                
            IF WS-DOB4 = SPACES OR LOW-VALUES OR ZERO                           
                 MOVE '00000000'    TO   WS-DOB4.                               
            MOVE  ZERO              TO   WS-YNGST-DOB-NUM.                      
                                                                                
            IF (WS-DOB1 NOT = '00000000' )  AND                                 
               WS-DOB1 >= WS-DOB2 AND WS-DOB1 >= WS-DOB3 AND                    
               WS-DOB1 >= WS-DOB4                                               
                   DISPLAY 'DOB1 : '   WS-DOB1                                  
                   COMPUTE  WS-DOB-DAYS =  WS-CURR-DATE2 - WS-DOB1              
                   COMPUTE  WS-YNGST-DOB-NUM =   WS-DOB1                        
            ELSE                                                                
            IF (WS-DOB2 NOT = '00000000') AND                                   
               WS-DOB2 >= WS-DOB1 AND WS-DOB2 >= WS-DOB3 AND                    
               WS-DOB2 >= WS-DOB4                                               
                   DISPLAY 'DOB2 : '   WS-DOB2                                  
                   COMPUTE  WS-DOB-DAYS =  WS-CURR-DATE2 - WS-DOB2              
                   COMPUTE  WS-YNGST-DOB-NUM =   WS-DOB2                        
            ELSE                                                                
            IF (WS-DOB3 NOT = '00000000') AND                                   
               WS-DOB3 >= WS-DOB1 AND WS-DOB3 >= WS-DOB2 AND                    
               WS-DOB3 >= WS-DOB4                                               
                   DISPLAY 'DOB3 : '   WS-DOB3                                  
                   COMPUTE  WS-DOB-DAYS =  WS-CURR-DATE2 - WS-DOB3              
                   COMPUTE  WS-YNGST-DOB-NUM =   WS-DOB3                        
            ELSE                                                                
            IF (WS-DOB4 NOT = '00000000') AND                                   
               WS-DOB4 >= WS-DOB1 AND WS-DOB4 >= WS-DOB2 AND                    
               WS-DOB4 >= WS-DOB3                                               
                   DISPLAY 'DOB4 : '   WS-DOB4                                  
                   COMPUTE  WS-DOB-DAYS =  WS-CURR-DATE2 - WS-DOB4              
                   COMPUTE  WS-YNGST-DOB-NUM =   WS-DOB4.                       
                                                                                
            MOVE      ZERO      TO   WS-AGE.                                    
            COMPUTE   WS-AGE  = WS-CCYY2-R - WS-YNGST-CCYY.                     
            IF WS-MMDD2 <  WS-YNGST-MMDD                                        
                 COMPUTE  WS-AGE =   WS-AGE - 1                                 
            END-IF.                                                             
                                                                                
            MOVE  WS-AGE              TO      400C-YNGST-PURCHSR.               
                                                                                
       937-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       940-COMPUTE-PARTC-WSHEET.                                                
      ******************************************************************        
      ***********************************************************               
      *   TO GET THE LEASE STAMP FEE FOR SUPPL AGR                              
      *************************************************************             
           PERFORM  955-CALC-LSTAMP-FEE   THRU  955-EXIT.                       
                                                                                
      ***********************************************************               
      *   TO GET THE CONVEYANCE FEE  FOR PART-C                                 
      *************************************************************             
           PERFORM  975-CALC-CONVEY-FEE   THRU  975-EXIT.                       
                                                                                
      ***********************************************************               
      *   TO GET THE FEES AND INSTALMENT                                        
      *************************************************************             
           MOVE ZEROES                   TO WS-TOTAL-CD.                        
           ADD WS-COMP-SELLPR-PREMIUM    TO WS-TOTAL-CD.                        
           IF K800-AMT-CD-CPF1 IS NUMERIC                                       
              ADD  K800-AMT-CD-CPF1      TO WS-TOTAL-CD.                        
           IF K800-AMT-CD-CPF2 IS NUMERIC                                       
              ADD  K800-AMT-CD-CPF2      TO WS-TOTAL-CD.                        
           IF K800-AMT-CD-CPF3 IS NUMERIC                                       
              ADD  K800-AMT-CD-CPF3      TO WS-TOTAL-CD.                        
           IF K800-AMT-CD-CPF4 IS NUMERIC                                       
              ADD  K800-AMT-CD-CPF4      TO WS-TOTAL-CD.                        
                                                                                
              MOVE   ZERO                TO WS-S900-TOT-ICP.                    
                                                                                
      *===> ROUND 1.                                                            
              IF ((K800-NUM-ALLO-SCHEME = 'RED' OR WS-SCH-FND = 'Y') OR         
                  (F310-CDE-SALES-TYPE = '2B' )) AND                            
                 (K800-NUM-PREMIUM-RATE > 0)                                    
                  PERFORM 945-CALL-BP13C90N  THRU  945-EXIT                     
              ELSE                                                              
                  PERFORM 943-CALL-BP13C900   THRU 943-EXIT                     
              END-IF.                                                           
                                                                                
              MOVE   ZERO                TO WS-S900-TOT-ICP.                    
              MOVE   WS-LOAN-INT-2       TO WS-S900-TOT-ICP.                    
              MOVE   ZEROES              TO WS-LOAN-INT-2.                      
              MOVE   WS-LOAN-ROUND-DOWN  TO WS-MAX-LOAN-AMT.                    
      *===> ROUND 2.                                                            
              IF ((K800-NUM-ALLO-SCHEME = 'RED' OR WS-SCH-FND = 'Y') OR         
                  (F310-CDE-SALES-TYPE = '2B' )) AND                            
                 (K800-NUM-PREMIUM-RATE > 0)                                    
                  PERFORM 945-CALL-BP13C90N  THRU  945-EXIT                     
              ELSE                                                              
                  PERFORM 943-CALL-BP13C900  THRU 943-EXIT                      
              END-IF.                                                           
                                                                                
           IF K800-NUM-CA-TAG = 'Y'                                             
              IF K640-AMT-MAX-LOAN < WS-MAX-LOAN-AMT                            
                 PERFORM 944-CALL-BP13C90A  THRU 944-EXIT                       
                 MOVE K640-AMT-MAX-LOAN     TO 400C-MAX-LOAN-AMT                
              ELSE                                                              
                 MOVE WS-MAX-LOAN-AMT       TO 400C-MAX-LOAN-AMT                
              END-IF                                                            
           ELSE                                                                 
              IF K800-NUM-CA-TAG = 'E'                                          
                 MOVE WS-MAX-LOAN-AMT       TO 400C-MAX-LOAN-AMT                
              END-IF                                                            
           END-IF.                                                              
                                                                                
           COMPUTE WS-TOTAL-CD = WS-TOTAL-CD + WS-LOAN-INT-2.                   
                                                                                
           COMPUTE WS-TOT-STAMP-FEE = WS-COMP-LEASE + WS-MORT-STAMP-FEE         
                                + WS-COMP-MORTGAGE + WS-PREMIUM-ST-FEE.         
           COMPUTE WS-TOTAL-FEES    = WS-TOT-STAMP-FEE +                        
                                      WS-TOT-CONVEY-FEE +                       
                                      WS-COMP-SURVEY-FEE.                       
           COMPUTE WS-TOTAL-SELLPR  = WS-TOTAL-FEES +                           
                                      WS-PURCHASE-PRICE.                        
           COMPUTE WS-S900-TOT-ICP  = WS-TOTAL-SELLPR - WS-TOTAL-CD -           
                                      K640-AMT-MAX-LOAN.                        
           COMPUTE WS-BALANCE-AMT   = WS-TOTAL-SELLPR - WS-TOTAL-CD.            
                                                                                
           MOVE  K110-CURR-SELLING-PRICE TO 400C-SELLNG-PRICE.                  
           MOVE WS-COMP-LEASE            TO 400C-LEASE-FEE.                     
           MOVE WS-COMP-SURVEY-FEE       TO 400C-TOT-SURVEY-FEE.                
           MOVE WS-MORT-STAMP-FEE        TO 400C-MORT-STAMP-FEE.                
           MOVE WS-COMP-MORTGAGE         TO 400C-MORTGAGE-FEE.                  
           MOVE WS-TOT-STAMP-FEE         TO 400C-TOT-STAMP-FEE.                 
           MOVE WS-TOTAL-FEES            TO 400C-TOT-FEES.                      
           MOVE WS-TOTAL-SELLPR          TO 400C-TOT-SELLPR.                    
           MOVE WS-TOTAL-CD              TO 400C-TOTAL-CD.                      
           MOVE WS-COMP-SELLPR-PREMIUM   TO 400C-CD-CASH.                       
           MOVE WS-LOAN-INT-2            TO 400C-CD-CPF1.                       
           MOVE '     '                  TO 400C-CD-CPF1-TXT.                   
           MOVE K800-AMT-CD-CPF2         TO 400C-CD-CPF2.                       
           MOVE K800-AMT-CD-CPF3         TO 400C-CD-CPF3.                       
           MOVE K800-AMT-CD-CPF4         TO 400C-CD-CPF4.                       
           MOVE WS-BALANCE-AMT           TO 400C-BALANCE-AMT.                   
                                                                                
      *==> GET INTEREST RATE                                                    
           MOVE FUNCTION CURRENT-DATE(1:8)                                      
                                       TO WS-COMPUTE-DATE.                      
                                                                                
           IF WS-COMPUTE-DD > 15                                                
              ADD  01                  TO WS-COMPUTE-MM                         
              MOVE 01                  TO WS-COMPUTE-DD                         
           END-IF.                                                              
           PERFORM 941-READ-AB03K050   THRU 941-EXIT.                           
                                                                                
      *==> TO GET INSTALMENT                                                    
           MOVE   'N'                    TO WS-S901-ERL.                        
           MOVE    F310-CDE-TYP-ACTUSE   TO WS-S901-RM.                         
           MOVE    F310-CDE-MODL-DESG    TO WS-S901-DESIGN.                     
           MOVE    ZERO                  TO WS-S901-REPAY-PD.                   
           IF  K800-NUM-CA-TAG = 'Y'                                            
             MOVE  K640-AMT-REPAY-PERIOD   TO WS-S901-REPAY-PD                  
           END-IF.                                                              
           IF  K800-NUM-CA-TAG = 'E'                                            
             MOVE    30                    TO WS-S901-REPAY-PD                  
           END-IF.                                                              
                                                                                
           IF K640-AMT-INTEREST-RATE IS NOT NUMERIC                             
              MOVE  ZERO            TO     K640-AMT-INTEREST-RATE               
           END-IF.                                                              
                                                                                
           COMPUTE WS-S901-INT = K640-AMT-INTEREST-RATE * 0.01.                 
                                                                                
           IF WS-K050-CDE-LOAN-SCH = 'P'                                        
              COMPUTE WS-S901-INT = K050-PCT-PA-INT * 0.01                      
              MOVE    K050-CDE-PA-FACTOR  TO  WS-S901-FAC                       
           ELSE                                                                 
              MOVE    K050-CDE-MKT-FACTOR  TO  WS-S901-FAC                      
              IF K640-AMT-REPAY-PERIOD >= 1 AND                                 
                 K640-AMT-REPAY-PERIOD <= 5                                     
                 COMPUTE WS-S901-INT = K050-PCT-MKT-INT(1) * 0.01               
              ELSE                                                              
                IF K640-AMT-REPAY-PERIOD >= 6 AND                               
                   K640-AMT-REPAY-PERIOD <= 10                                  
                   COMPUTE WS-S901-INT = K050-PCT-MKT-INT(2) * 0.01             
                ELSE                                                            
                   COMPUTE WS-S901-INT = K050-PCT-MKT-INT(3) * 0.01             
                END-IF                                                          
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF K800-NUM-CA-TAG = 'Y'                                             
              COMPUTE WS-ICP-TOP-UP = WS-MAX-LOAN-AMT -                         
                                      K640-AMT-MAX-LOAN                         
              IF WS-ICP-TOP-UP > 0                                              
                  MOVE WS-ICP-TOP-UP      TO 400C-TOP-UP-ICP                    
                  MOVE K640-AMT-MAX-LOAN  TO WS-S901-LOAN-AMT                   
              ELSE                                                              
                  MOVE WS-MAX-LOAN-AMT    TO WS-S901-LOAN-AMT                   
              END-IF                                                            
           ELSE                                                                 
              MOVE    WS-MAX-LOAN-AMT     TO WS-S901-LOAN-AMT                   
           END-IF.                                                              
                                                                                
           MOVE    ZEROES                 TO WS-S901-ERL-LOAN-AMT.              
                                                                                
           IF  WS-S901-INT IS NOT NUMERIC OR WS-S901-INT = ZERO                 
               MOVE 'INT.RATE = 0 IN BP13C901/CASE SKIPPED'                     
                                  TO  L661B-REMARK                              
               ADD   1            TO  WS-CNT-SKIPPED                            
               PERFORM  2500-CONTROL-REC   THRU    2500-EXIT                    
               GO TO 500-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF  WS-S901-REPAY-PD IS NOT NUMERIC OR                               
               WS-S901-REPAY-PD = ZERO                                          
               MOVE 'REPAY.PD = 0 IN BP13C901/CASE SKIPPED'                     
                                  TO  L661B-REMARK                              
               ADD   1            TO  WS-CNT-SKIPPED                            
               PERFORM  2500-CONTROL-REC   THRU    2500-EXIT                    
               GO TO 500-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF  WS-S901-FAC      IS NOT NUMERIC OR                               
               WS-S901-FAC  = ZERO                                              
               MOVE 'S910-FAC = 0 IN BP13C901/CASE SKIPPED'                     
                                  TO  L661B-REMARK                              
               ADD   1            TO  WS-CNT-SKIPPED                            
               PERFORM  2500-CONTROL-REC   THRU    2500-EXIT                    
               GO TO 500-EXIT                                                   
           END-IF.                                                              
                                                                                
           CALL   'BP13C901' USING WS-LINK-S901.                                
                                                                                
           MOVE WS-S901-MTH-INSTAL      TO WS-MTHLY-INSTAL.                     
           MOVE WS-MTHLY-INSTAL         TO 400C-MTHLY-INSTAL.                   
           MOVE K640-AMT-ELIG-INSTAL    TO 400C-INSTAL-ELIG.                    
                                                                                
       940-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       941-READ-AB03K050.                                                       
      ******************************************************************        
            MOVE K640-CDE-LOAN-OPTION TO  K050-CDE-LOAN-SCH                     
                                          WS-K050-CDE-LOAN-SCH.                 
                                                                                
            MOVE 'N'                  TO  WS-K050-EOF.                          
            MOVE LOW-VALUES           TO  K050-DTE-INT-EFF.                     
                                                                                
            START  AB03K050  KEY > K050-KEY.                                    
                                                                                
            IF AB03K050-STATUS NOT = 00                                         
               DISPLAY 'ERROR READING AB03K050, STATUS '                        
                                      AB03K050-STATUS                           
               MOVE AB03K050-STATUS TO RETURN-CODE                              
               PERFORM  1000-CLOSE-ROUTINE                                      
            END-IF.                                                             
                                                                                
            PERFORM  UNTIL K050-DTE-INT-EFF >= WS-COMPUTE-DATE                  
                          OR  WS-K050-EOF = 'Y'                                 
             MOVE  AB03K050-REC       TO     WS-AB03K050-REC                    
             READ  AB03K050  NEXT  AT END  MOVE 'Y'  TO  WS-K050-EOF            
                                           GO TO 941-CHECK-DATE                 
             END-READ                                                           
             IF AB03K050-STATUS NOT = 00                                        
               DISPLAY 'ERROR READING AB03K050, STATUS '                        
                                      AB03K050-STATUS                           
               MOVE AB03K050-STATUS TO RETURN-CODE                              
               PERFORM  1000-CLOSE-ROUTINE                                      
             END-IF                                                             
                                                                                
             IF  K050-CDE-LOAN-SCH NOT = WS-K050-CDE-LOAN-SCH                   
                 MOVE  'Y'      TO    WS-K050-EOF                               
             END-IF                                                             
           END-PERFORM.                                                         
                                                                                
       941-CHECK-DATE.                                                          
                                                                                
           IF  K050-DTE-INT-EFF  >  WS-COMPUTE-DATE OR                          
               WS-K050-CDE-LOAN-SCH NOT = K050-CDE-LOAN-SCH                     
               MOVE   WS-AB03K050-REC    TO    AB03K050-REC                     
           END-IF.                                                              
                                                                                
           IF  K050-DTE-INT-EFF IS NOT NUMERIC                                  
               DISPLAY 'NO RECORD MATCH IN AB03K050    '                        
               MOVE '99'            TO RETURN-CODE                              
               PERFORM  1000-CLOSE-ROUTINE                                      
           END-IF.                                                              
                                                                                
           IF  WS-K050-CDE-LOAN-SCH = 'P'                                       
             MOVE K050-CDE-PA-FACTOR TO WS-S901-FAC                             
           ELSE                                                                 
             MOVE K050-CDE-MKT-FACTOR TO WS-S901-FAC                            
           END-IF.                                                              
                                                                                
       941-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       943-CALL-BP13C900.                                                       
      ******************************************************************        
           MOVE WS-TOTAL-CD           TO WS-S900-CD-PREV-PAID.                  
           MOVE K800-AMT-PREMIUM      TO WS-AMT-PREMIUM.                        
           COMPUTE WS-PURCHASE-PRICE =  K110-CURR-SELLING-PRICE +               
                                WS-AMT-PREMIUM                                  
           MOVE  WS-PURCHASE-PRICE       TO 400C-SELLING-PRICE.                 
           MOVE  WS-PURCHASE-PRICE       TO WS-S900-SELL-PR.                    
           IF   WS-AMT-PREMIUM   > ZERO                                         
               MOVE  WS-AMT-PREMIUM        TO WS-AMT-PREMIUM-EDT                
               STRING ' + PREMIUM ' WS-AMT-PREMIUM-EDT ' = '                    
                       DELIMITED BY SIZE INTO  400C-PREMIUM-TXT                 
           ELSE                                                                 
               MOVE  SPACES                TO 400C-PREMIUM-TXT                  
           END-IF.                                                              
                                                                                
           MOVE F310-CDE-TYP-ACTUSE      TO WS-S900-RM.                         
           MOVE F310-CDE-MODL-DESG       TO WS-S900-DESIGN.                     
           MOVE ZERO                     TO WS-S900-REPAY-PD.                   
           IF K800-NUM-CA-TAG = 'Y'                                             
           MOVE K640-AMT-REPAY-PERIOD    TO WS-S900-REPAY-PD                    
           END-IF.                                                              
           IF K800-NUM-CA-TAG = 'E'                                             
           MOVE 30                       TO WS-S900-REPAY-PD                    
           END-IF.                                                              
           MOVE F310-CDE-SALES-TYPE      TO WS-S900-SALES-TYPE-SURVEY           
           MOVE '11'                     TO WS-S900-SALE-TYPE.                  
           MOVE K110-CURR-SELLING-PRICE  TO WS-S900-ORIG-SELL.                  
           MOVE K800-NUM-PREMIUM-RATE    TO WS-S900-PREMIUM-CODE.               
                                                                                
           CALL 'BP13C900' USING WS-LINK-S900.                                  
                                                                                
           IF   K110-REPOSSESSED-CODE = '40'                                    
                MOVE ZEROES              TO WS-S900-SURVEY-FEE                  
                MOVE ZEROES              TO WS-S900-SURVEY-FEE-GST              
           END-IF.                                                              
                                                                                
           MOVE WS-S900-SURVEY-FEE       TO WS-COMP-SURVEY-FEE                  
                                            400C-SURVEY-FEE-ACT.                
           ADD  WS-S900-SURVEY-FEE-GST   TO WS-COMP-SURVEY-FEE.                 
           MOVE WS-S900-SURVEY-FEE-GST   TO 400C-SURVEY-FEE-GST.                
           MOVE WS-COMP-SURVEY-FEE       TO 400C-TOT-SURVEY-FEE.                
                                                                                
           COMPUTE WS-COMP-LEASE  =  WS-S900-LS-ESCROW-FEE +                    
                                     WS-S900-LS-REGN-FEE.                       
                                                                                
           MOVE WS-S900-MORT-ST-FEE     TO WS-MORT-STAMP-FEE.                   
                                                                                
           IF WS-S900-MORT-ST-FEE IS <= 0                                       
              COMPUTE WS-S900-LOAN = WS-S900-LOAN -                             
                                     WS-S900-MORT-ESCROW-FEE -                  
                                     WS-S900-MORT-REGN-FEE                      
              MOVE ZEROES         TO WS-S900-MORT-ESCROW-FEE                    
                                     WS-S900-MORT-REGN-FEE                      
           END-IF.                                                              
                                                                                
           COMPUTE WS-COMP-MORTGAGE =  WS-S900-MORT-ESCROW-FEE +                
                                       WS-S900-MORT-REGN-FEE.                   
                                                                                
           MOVE WS-S900-LOAN          TO WS-LOAN-ROUND-DOWN.                    
                                                                                
       943-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       944-CALL-BP13C90A.                                                       
      ******************************************************************        
           MOVE WS-TOTAL-CD              TO WS-S900-CD-PREV-PAID.               
           MOVE K800-AMT-PREMIUM         TO WS-AMT-PREMIUM.                     
           COMPUTE WS-PURCHASE-PRICE =      K110-CURR-SELLING-PRICE +           
                                            WS-AMT-PREMIUM.                     
           MOVE  WS-PURCHASE-PRICE       TO 400C-SELLING-PRICE.                 
           MOVE  K110-CURR-SELLING-PRICE TO 400C-SELLNG-PRICE.                  
           COMPUTE WS-S900-SELL-PR = WS-PURCHASE-PRICE +                        
                                     K800-AMT-DEFER-PREMIUM.                    
           IF   WS-AMT-PREMIUM   > ZERO                                         
               MOVE  WS-AMT-PREMIUM        TO WS-AMT-PREMIUM-EDT                
               STRING ' + PREMIUM ' WS-AMT-PREMIUM-EDT ' = '                    
                       DELIMITED BY SIZE INTO  400C-PREMIUM-TXT                 
           ELSE                                                                 
               MOVE  SPACES                TO 400C-PREMIUM-TXT                  
           END-IF.                                                              
                                                                                
           MOVE F310-CDE-TYP-ACTUSE      TO WS-S900-RM.                         
           MOVE F310-CDE-MODL-DESG       TO WS-S900-DESIGN.                     
           MOVE ZERO                     TO WS-S900-REPAY-PD.                   
           IF K800-NUM-CA-TAG = 'Y'                                             
           MOVE K640-AMT-REPAY-PERIOD    TO WS-S900-REPAY-PD                    
           END-IF.                                                              
           IF K800-NUM-CA-TAG = 'E'                                             
           MOVE 30                       TO WS-S900-REPAY-PD                    
           END-IF.                                                              
           MOVE F310-CDE-SALES-TYPE      TO WS-S900-SALES-TYPE-SURVEY.          
           MOVE  '11'                    TO WS-S900-SALE-TYPE.                  
           MOVE K110-CURR-SELLING-PRICE  TO WS-S900-ORIG-SELL.                  
           MOVE K800-NUM-PREMIUM-RATE    TO WS-S900-PREMIUM-CODE.               
           MOVE ZEROS                    TO WS-S900-TOT-ICP.                    
           MOVE K640-AMT-MAX-LOAN        TO WS-S900-LOAN.                       
                                                                                
           CALL 'BP13C90A' USING WS-LINK-S900.                                  
                                                                                
           MOVE WS-S900-SURVEY-FEE       TO WS-COMP-SURVEY-FEE                  
                                            400C-SURVEY-FEE-ACT.                
           ADD  WS-S900-SURVEY-FEE-GST   TO WS-COMP-SURVEY-FEE.                 
           MOVE WS-S900-SURVEY-FEE-GST   TO 400C-SURVEY-FEE-GST.                
           MOVE WS-COMP-SURVEY-FEE       TO 400C-TOT-SURVEY-FEE.                
                                                                                
           COMPUTE WS-COMP-LEASE     =      WS-S900-LS-ESCROW-FEE +             
                                            WS-S900-LS-REGN-FEE.                
                                                                                
           MOVE WS-S900-MORT-ST-FEE      TO WS-MORT-STAMP-FEE.                  
                                                                                
           COMPUTE WS-COMP-MORTGAGE  =      WS-S900-MORT-ESCROW-FEE +           
                                            WS-S900-MORT-REGN-FEE.              
                                                                                
           COMPUTE WS-TOT-STAMP-FEE = WS-COMP-LEASE + WS-MORT-STAMP-FEE         
                                + WS-COMP-MORTGAGE + WS-PREMIUM-ST-FEE.         
           COMPUTE WS-TOTAL-FEES    = WS-TOT-STAMP-FEE +                        
                                      WS-TOT-CONVEY-FEE +                       
                                      WS-COMP-SURVEY-FEE.                       
           COMPUTE WS-TOTAL-SELLPR  = WS-TOTAL-FEES +                           
                                      WS-PURCHASE-PRICE.                        
           COMPUTE WS-BALANCE       = WS-TOTAL-SELLPR -                         
                                      WS-TOTAL-CD.                              
                                                                                
           MOVE WS-BALANCE               TO WS-LOAN-ROUND-DOWN.                 
           COMPUTE WS-MAX-LOAN-AMT  = WS-LOAN-INT-5 * 100.                      
                                                                                
       944-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       945-CALL-BP13C90N.                                                       
      ******************************************************************        
      *TO CALCULATE LOAN FOR OFFER SELLING PRICE + PREMIUM                      
           MOVE WS-TOTAL-CD              TO WS-S900-CD-PREV-PAID.               
           MOVE K800-AMT-PREMIUM         TO WS-AMT-PREMIUM.                     
           COMPUTE WS-PURCHASE-PRICE =      K110-CURR-SELLING-PRICE +           
                                            WS-AMT-PREMIUM.                     
           MOVE  WS-PURCHASE-PRICE       TO 400C-SELLING-PRICE.                 
           COMPUTE WS-S900-SELL-PR = WS-PURCHASE-PRICE +                        
                                     K800-AMT-DEFER-PREMIUM.                    
           IF   WS-AMT-PREMIUM   > ZERO                                         
               MOVE  WS-AMT-PREMIUM        TO WS-AMT-PREMIUM-EDT                
               STRING ' + PREMIUM ' WS-AMT-PREMIUM-EDT ' = '                    
                       DELIMITED BY SIZE INTO  400C-PREMIUM-TXT                 
           ELSE                                                                 
               MOVE  SPACES                TO 400C-PREMIUM-TXT                  
           END-IF.                                                              
                                                                                
           MOVE F310-CDE-TYP-ACTUSE      TO WS-S900-RM.                         
           MOVE F310-CDE-MODL-DESG       TO WS-S900-DESIGN.                     
           MOVE ZERO                     TO WS-S900-REPAY-PD.                   
           IF K800-NUM-CA-TAG = 'Y'                                             
           MOVE K640-AMT-REPAY-PERIOD    TO WS-S900-REPAY-PD                    
           END-IF.                                                              
           IF K800-NUM-CA-TAG = 'E'                                             
           MOVE 30                       TO WS-S900-REPAY-PD                    
           END-IF.                                                              
           MOVE F310-CDE-SALES-TYPE      TO WS-S900-SALES-TYPE-SURVEY           
           MOVE '11'                     TO WS-S900-SALE-TYPE.                  
           MOVE K110-CURR-SELLING-PRICE  TO WS-S900-ORIG-SELL.                  
           MOVE K800-NUM-PREMIUM-RATE    TO WS-S900-PREMIUM-CODE.               
                                                                                
           IF K110-1ST-OFFER-SELLING-PRICE IS NOT NUMERIC                       
              MOVE  ZERO          TO   K110-1ST-OFFER-SELLING-PRICE             
           END-IF.                                                              
                                                                                
           IF K110-AMT-POD IS NOT NUMERIC                                       
              MOVE  ZERO          TO   K110-AMT-POD                             
           END-IF.                                                              
                                                                                
           IF K110-AMT-POF IS NOT NUMERIC                                       
              MOVE  ZERO          TO   K110-AMT-POF                             
           END-IF.                                                              
                                                                                
           COMPUTE  WS-S90N-OFFERPR = K110-1ST-OFFER-SELLING-PRICE +            
                                      K110-AMT-POD +                            
                                      K110-AMT-POF.                             
                                                                                
           COMPUTE  WS-S90N-OFFERPR-PREMIUM = WS-S90N-OFFERPR +                 
                                              WS-AMT-PREMIUM  +                 
                                              K800-AMT-DEFER-PREMIUM.           
                                                                                
           CALL 'BP13C90N' USING WS-LINK-S90N.                                  
                                                                                
           IF   K110-REPOSSESSED-CODE = '40'                                    
                MOVE ZEROES              TO WS-S900-SURVEY-FEE                  
                MOVE ZEROES              TO WS-S900-SURVEY-FEE-GST              
           END-IF.                                                              
                                                                                
           MOVE WS-S900-SURVEY-FEE       TO WS-COMP-SURVEY-FEE                  
                                            400C-SURVEY-FEE-ACT.                
           ADD  WS-S900-SURVEY-FEE-GST   TO WS-COMP-SURVEY-FEE.                 
           MOVE WS-S900-SURVEY-FEE-GST   TO 400C-SURVEY-FEE-GST.                
           MOVE WS-COMP-SURVEY-FEE       TO 400C-TOT-SURVEY-FEE.                
                                                                                
           COMPUTE WS-COMP-LEASE  =  WS-S900-LS-ESCROW-FEE +                    
                                     WS-S900-LS-REGN-FEE.                       
                                                                                
           MOVE WS-S900-MORT-ST-FEE     TO WS-MORT-STAMP-FEE.                   
                                                                                
           IF WS-S900-MORT-ST-FEE IS <= 0                                       
              COMPUTE WS-S900-LOAN = WS-S900-LOAN -                             
                                     WS-S900-MORT-ESCROW-FEE -                  
                                     WS-S900-MORT-REGN-FEE                      
              MOVE ZEROES         TO WS-S900-MORT-ESCROW-FEE                    
                                     WS-S900-MORT-REGN-FEE                      
           END-IF.                                                              
                                                                                
           COMPUTE WS-COMP-MORTGAGE =  WS-S900-MORT-ESCROW-FEE +                
                                       WS-S900-MORT-REGN-FEE.                   
                                                                                
           MOVE WS-S900-LOAN          TO WS-LOAN-ROUND-DOWN.                    
                                                                                
       945-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       950-PROCESS-PRINT-WSHEET.                                                
      ******************************************************************        
      *==> PRINT PARTA                                                          
           IF K800-NUM-CA-TAG = 'Y'                                             
             MOVE F310-REGN-NO    TO   L211-REGN-NO                             
             WRITE PRINT-REC6     FROM L310A-PR-HEAD-09     AFTER PAGE          
             PERFORM 951-PRINT-CA-Y THRU 951-EXIT                               
           ELSE                                                                 
           IF K800-NUM-CA-TAG = 'E'                                             
             MOVE F310-REGN-NO    TO   L211-REGN-NO                             
             WRITE PRINT-REC7     FROM L310A-PR-HEAD-09     AFTER PAGE          
             PERFORM 952-PRINT-CA-E THRU 952-EXIT.                              
                                                                                
       950-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       951-PRINT-CA-Y.                                                          
      ******************************************************************        
      *==> PRINT PARTA                                                          
           WRITE PRINT-REC6     FROM L310A-PR-HEAD-10 AFTER 4.                  
           WRITE PRINT-REC6     FROM L310A-PR-HEAD-11 AFTER 1.                  
           WRITE PRINT-REC6     FROM L310A-PR-HEAD-12 AFTER 1.                  
           WRITE PRINT-REC6     FROM L310A-PR-HEAD-TOTAL AFTER 1.               
           WRITE PRINT-REC6     FROM L310A-PR-HEAD-13    AFTER 1.               
                                                                                
      *==> PRINT PARTB                                                          
           WRITE PRINT-REC6     FROM L400C-PR-LINE-1  AFTER 3.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-2  AFTER 1.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-2C AFTER 1.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-2D AFTER 1.                  
                                                                                
      *==> PRINT PARTC                                                          
                                                                                
           IF  WS-AMT-PREMIUM  <= ZERO                                          
               MOVE  SPACES                TO 400C-SELLNG-PRICE-TXT             
           END-IF.                                                              
                                                                                
           WRITE PRINT-REC6     FROM L400C-PR-LINE-3  AFTER 3.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-3A AFTER 2.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-4  AFTER 2.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-5  AFTER 2.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-6  AFTER 2.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-7  AFTER 2.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-7A AFTER 2.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-8  AFTER 2.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-9  AFTER 2.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-10 AFTER 3.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-11 AFTER 2.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-12 AFTER 2.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-13 AFTER 2.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-14 AFTER 2.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-15 AFTER 2.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-16 AFTER 2.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-16B AFTER 2.                 
           MOVE   K640-AMT-REPAY-PERIOD   TO  L400C-REPAY-PRD.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-17 AFTER 2.                  
           WRITE PRINT-REC6     FROM L400C-PR-LINE-18 AFTER 2.                  
                                                                                
      *==> PRINT NOTE                                                           
           MOVE   WS-EDITED-DATE  TO L310-SYS-DATE.                             
           WRITE  PRINT-REC6    FROM L310A-PR-LINE-15 AFTER 05.                 
           WRITE  PRINT-REC6    FROM L310A-PR-LINE-16 AFTER 1.                  
           WRITE  PRINT-REC6    FROM L310A-PR-LINE-17 AFTER 1.                  
                                                                                
       951-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       952-PRINT-CA-E.                                                          
      ******************************************************************        
      *==> PRINT PARTA                                                          
           WRITE PRINT-REC7     FROM L310A-PR-HEAD-10 AFTER 4.                  
           WRITE PRINT-REC7     FROM L310A-PR-HEAD-11 AFTER 1.                  
           WRITE PRINT-REC7     FROM L310A-PR-HEAD-12 AFTER 1.                  
           WRITE PRINT-REC7     FROM L310A-PR-HEAD-TOTAL AFTER 1.               
           WRITE PRINT-REC7     FROM L310A-PR-HEAD-13    AFTER 1.               
                                                                                
      *==> PRINT PARTB                                                          
           MOVE  SPACES         TO   PRINT-REC7.                                
           WRITE PRINT-REC7      FROM L400C-PR-LINE-1A AFTER 2.                 
           MOVE  SPACES         TO   PRINT-REC7.                                
           WRITE PRINT-REC7      FROM L400C-PR-LINE-1B AFTER 1.                 
           MOVE  SPACES         TO   PRINT-REC7.                                
           WRITE PRINT-REC7      FROM L400C-PR-LINE-2A AFTER 1.                 
           MOVE  SPACES         TO   PRINT-REC7.                                
           WRITE PRINT-REC7      FROM L400C-PR-LINE-2B AFTER 1.                 
           MOVE  SPACES         TO   PRINT-REC7.                                
           WRITE PRINT-REC7      AFTER 1.                                       
                                                                                
      *==> PRINT PARTC                                                          
                                                                                
           IF  WS-AMT-PREMIUM  <= ZERO                                          
               MOVE  SPACES                TO 400C-SELLNG-PRICE-TXT             
           END-IF.                                                              
                                                                                
           WRITE PRINT-REC7     FROM L400C-PR-LINE-3  AFTER 3.                  
           WRITE PRINT-REC7     FROM L400C-PR-LINE-3A AFTER 2.                  
           WRITE PRINT-REC7     FROM L400C-PR-LINE-4  AFTER 2.                  
           WRITE PRINT-REC7     FROM L400C-PR-LINE-5  AFTER 2.                  
           WRITE PRINT-REC7     FROM L400C-PR-LINE-6  AFTER 2.                  
           WRITE PRINT-REC7     FROM L400C-PR-LINE-7  AFTER 2.                  
           WRITE PRINT-REC7     FROM L400C-PR-LINE-7A AFTER 2.                  
           WRITE PRINT-REC7     FROM L400C-PR-LINE-8  AFTER 2.                  
           WRITE PRINT-REC7     FROM L400C-PR-LINE-9  AFTER 2.                  
           WRITE PRINT-REC7     FROM L400C-PR-LINE-10 AFTER 3.                  
           WRITE PRINT-REC7     FROM L400C-PR-LINE-11 AFTER 2.                  
           WRITE PRINT-REC7     FROM L400C-PR-LINE-12 AFTER 2.                  
           WRITE PRINT-REC7     FROM L400C-PR-LINE-13 AFTER 2.                  
           WRITE PRINT-REC7     FROM L400C-PR-LINE-14 AFTER 2.                  
           WRITE PRINT-REC7     FROM L400C-PR-LINE-15 AFTER 2.                  
           WRITE PRINT-REC7     FROM L400C-PR-LINE-16 AFTER 2.                  
           MOVE   30                       TO  L400C-REPAY-PRD.                 
           WRITE PRINT-REC7     FROM L400C-PR-LINE-17 AFTER 2.                  
           WRITE PRINT-REC7     FROM L400C-PR-LINE-18 AFTER 2.                  
                                                                                
      *==> PRINT NOTE                                                           
           MOVE   WS-EDITED-DATE  TO L310-SYS-DATE.                             
           WRITE  PRINT-REC7    FROM L310A-PR-LINE-15 AFTER 07.                 
           WRITE  PRINT-REC7    FROM L310A-PR-LINE-16 AFTER 1.                  
           WRITE  PRINT-REC7    FROM L310A-PR-LINE-17 AFTER 1.                  
                                                                                
       952-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       955-CALC-LSTAMP-FEE.                                                     
      ******************************************************************        
      * TO GET  VALUE FOR  400C-LEASE-STAMP-FEE                                 
                                                                                
           MOVE  ZERO               TO    WS-PREMIUM-ST-FEE.                    
                                                                                
           PERFORM   960-STAMP-FEE-FOR-TYPE10  THRU 960-EXIT.                   
                                                                                
           MOVE      WS-PREMIUM-ST-FEE     TO  400C-LEASE-STAMP-FEE.            
                                                                                
       955-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       960-STAMP-FEE-FOR-TYPE10.                                                
      ******************************************************************        
            IF K800-NUM-PREMIUM-RATE = ZERO  OR LOW-VALUES                      
                MOVE  ZERO        TO   WS-PREMIUM-ST-FEE                        
                GO TO 960-EXIT                                                  
            END-IF.                                                             
                                                                                
            PERFORM   965-SELLING-PREMIUM-ST-FEE THRU 965-EXIT                  
            PERFORM   970-SELLING-ST-FEE         THRU 970-EXIT                  
            COMPUTE   WS-PREMIUM-ST-FEE =                                       
                ( WS-PREMIUM-ST-FEE-NEW  - WS-PREMIUM-ST-FEE-ORIG).             
                                                                                
       960-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       965-SELLING-PREMIUM-ST-FEE.                                              
      ******************************************************************        
           IF K800-NUM-PREMIUM-RATE IS NOT NUMERIC                              
              MOVE   ZERO          TO   K800-NUM-PREMIUM-RATE                   
           END-IF.                                                              
                                                                                
           IF K800-AMT-PREMIUM      IS NOT NUMERIC                              
              MOVE   ZERO          TO   K800-AMT-PREMIUM                        
           END-IF.                                                              
                                                                                
           MOVE K800-AMT-PREMIUM   TO   WS-AMT-PREMIUM.                         
                                                                                
           COMPUTE WS-TMP-PREMIUM = K800-AMT-PREMIUM +                          
                                    K800-AMT-DEFER-PREMIUM.                     
                                                                                
           COMPUTE WS-PURCHASE-PRICE =  WS-SF-OFFER-PRICE +                     
                                        WS-TMP-PREMIUM.                         
                                                                                
           COMPUTE WS-TEMP-DEC-SPRICE = WS-PURCHASE-PRICE / 100.                
                                                                                
           MOVE    WS-TEMP-DEC-SPRICE  TO  WS-TEMP-INT-SPRICE.                  
                                                                                
           IF (WS-TEMP-DEC-SPRICE - WS-TEMP-INT-SPRICE) > 0                     
              ADD  1                   TO  WS-TEMP-INT-SPRICE.                  
                                                                                
           COMPUTE WS-TEMP-INT-SPRICE = WS-TEMP-INT-SPRICE * 100.               
                                                                                
      ***BP132207 REMOVE 30% DISCOUNT                                           
      *==> 0.007 --> 0.01 (REMOVE DISCOUNT FROM 2001 OFF-BUDGET)                
      *==> 0.014 --> 0.02 (REMOVE DISCOUNT FROM 2001 OFF-BUDGET)                
      *==> 0.021 --> 0.03 (REMOVE DISCOUNT FROM 2001 OFF-BUDGET)                
                                                                                
           IF WS-TEMP-INT-SPRICE >= 360000                                      
              COMPUTE  WS-PREMIUM-ST-FEE-NEW =                                  
                 ( WS-TEMP-INT-SPRICE - 360000 ) * 0.03 + 5400                  
           ELSE                                                                 
           IF WS-TEMP-INT-SPRICE >  180000                                      
              COMPUTE  WS-PREMIUM-ST-FEE-NEW =                                  
                 ( WS-TEMP-INT-SPRICE - 180000 ) * 0.02 + 1800                  
           ELSE                                                                 
              COMPUTE  WS-PREMIUM-ST-FEE-NEW =                                  
                 ( WS-TEMP-INT-SPRICE * 0.01 )                                  
           END-IF.                                                              
                                                                                
       965-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       970-SELLING-ST-FEE.                                                      
      ******************************************************************        
           COMPUTE WS-DEC-SPRICE = WS-SF-OFFER-PRICE / 100.                     
                                                                                
           MOVE    WS-DEC-SPRICE  TO  WS-INT-SPRICE.                            
                                                                                
           IF (WS-DEC-SPRICE - WS-INT-SPRICE) > 0                               
              ADD  1                   TO  WS-INT-SPRICE.                       
                                                                                
           COMPUTE WS-INT-SPRICE = WS-INT-SPRICE * 100.                         
                                                                                
      ***BP132207 REMOVE 30% DISCOUNT                                           
      *==> 0.007 --> 0.01 (REMOVE DISCOUNT FROM 2001 OFF-BUDGET)                
      *==> 0.014 --> 0.02 (REMOVE DISCOUNT FROM 2001 OFF-BUDGET)                
      *==> 0.021 --> 0.03 (REMOVE DISCOUNT FROM 2001 OFF-BUDGET)                
                                                                                
           IF WS-INT-SPRICE >= 360000                                           
              COMPUTE  WS-PREMIUM-ST-FEE-ORIG =                                 
                 ( WS-INT-SPRICE - 360000 ) * 0.03 + 5400                       
           ELSE                                                                 
           IF WS-INT-SPRICE >  180000                                           
              COMPUTE  WS-PREMIUM-ST-FEE-ORIG =                                 
                 ( WS-INT-SPRICE - 180000 ) * 0.02 + 1800                       
           ELSE                                                                 
              COMPUTE  WS-PREMIUM-ST-FEE-ORIG =                                 
                 ( WS-INT-SPRICE * 0.01 )                                       
           END-IF.                                                              
                                                                                
       970-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       975-CALC-CONVEY-FEE.                                                     
      ******************************************************************        
           IF  WS-PREMIUM-ST-FEE = ZERO                                         
               MOVE   ZERO           TO   400C-CONVEY-FEE                       
                                          400C-CONVEY-FEE-GST                   
                                          400C-TOT-CONVEY-FEE                   
                                          WS-TOT-CONVEY-FEE                     
               GO TO  975-EXIT                                                  
           END-IF.                                                              
                                                                                
           MOVE K800-AMT-PREMIUM     TO   WS-AMT-PREMIUM.                       
                                                                                
           COMPUTE WS-TMP-PREMIUM = K800-AMT-PREMIUM +                          
                                    K800-AMT-DEFER-PREMIUM.                     
           COMPUTE WS-PURCHASE-PRICE =  K110-CURR-SELLING-PRICE +               
                                        WS-TMP-PREMIUM.                         
                                                                                
              IF WS-PURCHASE-PRICE > 60000                                      
                  COMPUTE  WS-CONVEY-FEE1 = 48.6 +                              
                          ( WS-PURCHASE-PRICE - 60000 ) * 0.01 * 0.06           
                                                                                
              ELSE                                                              
              IF WS-PURCHASE-PRICE > 30000                                      
                  COMPUTE  WS-CONVEY-FEE1 = 27 +                                
                          ( WS-PURCHASE-PRICE - 30000 ) * 0.01 * 0.072          
              ELSE                                                              
                  COMPUTE  WS-CONVEY-FEE1 =                                     
                            WS-PURCHASE-PRICE * 0.01 * 0.09.                    
                                                                                
              IF  WS-CONVEY-FEE1 < 20                                           
                  MOVE   20   TO    WS-CONVEY-FEE1.                             
                                                                                
              MOVE   WS-CONVEY-FEE1   TO   WS-INT-CONVEY-FEE.                   
                                                                                
              IF  (WS-CONVEY-FEE1 - WS-INT-CONVEY-FEE) > 0                      
                  COMPUTE WS-CONVEY-FEE1 = WS-INT-CONVEY-FEE + 1.               
                                                                                
              IF K110-CURR-SELLING-PRICE > 60000                                
                  COMPUTE  WS-CONVEY-FEE2 = 48.6 +                              
                     ( K110-CURR-SELLING-PRICE - 60000 )                        
                                           * 0.01 * 0.06                        
              ELSE                                                              
              IF K110-CURR-SELLING-PRICE > 30000                                
                  COMPUTE  WS-CONVEY-FEE2 = 27 +                                
                     ( K110-CURR-SELLING-PRICE - 30000 )                        
                                           * 0.01 * 0.072                       
              ELSE                                                              
                  COMPUTE  WS-CONVEY-FEE2 =                                     
                       K110-CURR-SELLING-PRICE * 0.01 * 0.09.                   
                                                                                
              IF  WS-CONVEY-FEE2 < 20                                           
                  MOVE   20   TO    WS-CONVEY-FEE2.                             
                                                                                
              MOVE   WS-CONVEY-FEE2   TO   WS-INT-CONVEY-FEE.                   
                                                                                
              IF  (WS-CONVEY-FEE2 - WS-INT-CONVEY-FEE) > 0                      
                  COMPUTE WS-CONVEY-FEE2 = WS-INT-CONVEY-FEE + 1.               
                                                                                
              COMPUTE  WS-CONVEY-FEE = WS-CONVEY-FEE1 - WS-CONVEY-FEE2.         
                                                                                
           MOVE  WS-CONVEY-FEE   TO 400C-CONVEY-FEE.                            
           MOVE  WS-CONVEY-FEE   TO WS-AMT-NETT.                                
           CALL 'AV02C021' USING WS-COMM-AREA-GST.                              
           MOVE  WS-AMT-GST      TO 400C-CONVEY-FEE-GST.                        
           ADD   WS-AMT-GST      TO WS-CONVEY-FEE.                              
           MOVE WS-CONVEY-FEE    TO 400C-TOT-CONVEY-FEE                         
                                    WS-TOT-CONVEY-FEE.                          
                                                                                
      * TO REMOVE ODD CENTS                                                     
            MOVE SPACES             TO   WS-COMM-AREA-ODDCENTS.                 
            INITIALIZE                   WS-COMM-AREA-ODDCENTS.                 
                                                                                
            MOVE  WS-NUM-GST-RATE   TO   WS-COMM-ODD-GST-RATE.                  
            MOVE  WS-CONVEY-FEE     TO   WS-COMM-ODD-TOTAL-FEE.                 
                                                                                
            CALL 'BP13C90B' USING WS-COMM-AREA-ODDCENTS.                        
                                                                                
            IF WS-COMM-ODD-CENTS-SW = 'Y'                                       
               MOVE WS-COMM-ODD-GST       TO WS-AMT-GST                         
                                             400C-CONVEY-FEE-GST                
               MOVE WS-COMM-ODD-BASE-FEE  TO 400C-CONVEY-FEE                    
               MOVE WS-COMM-ODD-TOTAL-FEE TO WS-CONVEY-FEE                      
                                             400C-TOT-CONVEY-FEE                
                                             WS-TOT-CONVEY-FEE                  
            END-IF.                                                             
                                                                                
       975-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
       1000-CLOSE-ROUTINE.                                                      
      ******************************************************************        
            DISPLAY '                                        '.                 
            DISPLAY ' *****   BP13C661 CONTROL TOTALS   *****'.                 
            DISPLAY '                                        '.                 
            DISPLAY ' NO READ FROM F310 : ' WS-CNT-F310.                        
            DISPLAY ' NO READ FROM K022 : ' WS-CNT-K022.                        
            DISPLAY ' NO READ FROM K024 : ' WS-CNT-K024.                        
            DISPLAY ' NO READ FROM K110 : ' WS-CNT-K110.                        
            DISPLAY ' NO READ FROM K820 : ' WS-CNT-K820.                        
            DISPLAY ' NO READ FROM K830 : ' WS-CNT-K830.                        
            DISPLAY ' NO READ FROM K640 : ' WS-CNT-K640.                        
            DISPLAY ' NO PROCESSED      : ' WS-CNT-PROC.                        
            DISPLAY ' NO PRINTED        : ' WS-CNT-LETTERS.                     
            DISPLAY ' NO SKIPPED        : ' WS-CNT-SKIPPED.                     
                                                                                
            CLOSE BP13F310                                                      
                  BP13K022                                                      
                  BP13K024                                                      
                  BP13K800                                                      
                  BP13K820                                                      
                  BP13K830                                                      
                  BM06K100                                                      
                  BM06K110                                                      
                  AB03K050                                                      
                  P13L661A                                                      
                  P13L661B                                                      
                  P13L661C                                                      
                  P13L661D                                                      
                  P13L661E                                                      
                  P13L661G                                                      
                  P13L661H.                                                     
                                                                                
            IF BP13K800-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BP13K800-STAT ' BP13K800-STATUS.          
            IF BP13K022-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BP13K022-STAT ' BP13K022-STATUS.          
            IF BP13K024-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BP13K024-STAT ' BP13K024-STATUS.          
            IF BP13K820-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BP13K820-STAT ' BP13K820-STATUS.          
            IF BP13K830-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BP13K830-STAT ' BP13K830-STATUS.          
            IF BM06K100-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BM06K100-STAT ' BM06K100-STATUS.          
            IF BM06K110-STATUS NOT = 00                                         
               DISPLAY 'CLOSING ERROR-BM06K110-STAT ' BM06K110-STATUS.          
                                                                                
            STOP RUN.                                                           
                                                                                
       1000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1500-COMPUTE-EXPIRY-DATE.                                                
      ******************************************************************        
      *--------------------------------------------------------*                
      *      ROUTINE TO COMPUTE THE EXPIRY DATE                *                
      *      IE. 2 MONTH AFTER THE BOOKING DATE                *                
      *--------------------------------------------------------*                
           MOVE     ZEROS                  TO     WS-NUM-FIELD.                 
           MOVE     K110-DTE-ACCEPTANCE    TO     WS-EXPIRY-DATE1.              
           MOVE     WS-EXPIRY-DATE         TO     DATE-REC.                     
           PERFORM  1600-CHECK-DATE        THRU   1600-EXIT.                    
           ADD       2                     TO      CAL-MONTH.                   
                                                                                
           IF NOT VALID-MONTH                                                   
              SUBTRACT  12   FROM  CAL-MONTH                                    
              ADD       1    TO    CAL-YEAR.                                    
                                                                                
            PERFORM 1700-PROCESS-DATE  THRU   1700-EXIT.                        
            MOVE    DATE-REC           TO     WS-DTE-OPT-EXP.                   
            MOVE    DATE-REC           TO     WS-IN-DATE.                       
                                                                                
       1500-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1600-CHECK-DATE.                                                         
      ******************************************************************        
            IF CAL-DATE   IS NUMERIC AND                                        
               VALID-DAY             AND                                        
               VALID-MONTH           AND                                        
               VALID-YEAR                                                       
               NEXT SENTENCE                                                    
            ELSE                                                                
               DISPLAY 'INVALID INPUT DATE : ' DATE-REC                         
               ADD      2          TO CAL-MONTH                                 
               MOVE     DATE-REC   TO WS-DTE-OPT-EXP                            
               MOVE     DATE-REC   TO WS-IN-DATE.                               
                                                                                
       1600-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1700-PROCESS-DATE.                                                       
      ******************************************************************        
            IF 31-DAY-MONTH                                                     
               IF CAL-DAY IS NOT LESS THAN 32                                   
                  MOVE 31 TO CAL-DAY.                                           
                                                                                
            IF 30-DAY-MONTH                                                     
               IF CAL-DAY IS NOT LESS THAN 31                                   
                  MOVE 30 TO CAL-DAY.                                           
                                                                                
            IF 28-29-DAY-MONTH                                                  
               IF CAL-DAY IS LESS THAN 29                                       
                  GO TO 1700-EXIT                                               
               ELSE                                                             
                  PERFORM 1800-FEBRUARY                                         
            ELSE                                                                
               NEXT SENTENCE.                                                   
                                                                                
       1700-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       1800-FEBRUARY.                                                           
      ******************************************************************        
            DIVIDE 4 INTO CAL-YEAR   GIVING WS-YEAR REMAINDER WS-REM.           
                                                                                
            IF WS-REM IS EQUAL TO ZERO AND CAL-DAY IS GREATER THAN 29           
               MOVE 29 TO CAL-DAY.                                              
                                                                                
            IF WS-REM IS NOT EQUAL TO ZERO                                      
                                   AND CAL-DAY IS GREATER THAN 28               
               MOVE 28 TO CAL-DAY.                                              
                                                                                
       1800-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       2000-READ-K640.                                                          
      ******************************************************************        
              MOVE  SPACES               TO      BP13K640-TRANS-REC.            
              MOVE  F310-REGN-NO         TO      K640-REGN-NO.                  
              READ BP13K640.                                                    
                                                                                
              EVALUATE BP13K640-STATUS                                          
                 WHEN '00'                                                      
                         ADD     1       TO      WS-CNT-K640                    
                 WHEN '23'                                                      
                         DISPLAY 'BP13K640 - RECORD NOT FOUND '                 
                         DISPLAY 'KEY : ' K640-REGN-NO                          
                 WHEN OTHER                                                     
                         DISPLAY 'ERROR READING BP13K640      '                 
                         DISPLAY 'KEY : ' K640-REGN-NO                          
                         DISPLAY 'STATUS : '  BP13K640-STATUS                   
              END-EVALUATE.                                                     
                                                                                
       2000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
       2500-CONTROL-REC.                                                        
      ******************************************************************        
            IF   WS-CONTROL-PR-LINE > 55                                        
                  ADD       1       TO     WS-CONTROL-PAGE-NO                   
                  PERFORM   2550-WRITE-HEADER    THRU  2550-EXIT                
            END-IF.                                                             
                                                                                
            ADD    1                     TO    WS-CNT-CONTROL.                  
            MOVE   WS-CNT-CONTROL        TO    L661B-SNO.                       
            MOVE   F310-REGN-NO          TO    L661B-REGN-NO.                   
            WRITE  P13L661B-REC          FROM  L661B-DETAIL.                    
            ADD    1                     TO    WS-CONTROL-PR-LINE.              
                                                                                
       2500-EXIT.                                                               
              EXIT.                                                             
                                                                                
                                                                                
      ******************************************************************        
       2550-WRITE-HEADER.                                                       
      ******************************************************************        
             WRITE  P13L661B-REC     FROM   L661B-HEADER-0 AFTER PAGE.          
             WRITE  P13L661B-REC     FROM   L661B-HEADER-1 AFTER 1.             
                                                                                
             MOVE FUNCTION CURRENT-DATE(1:8)  TO  WS-CUR-YYYYMMDD.              
             MOVE WS-CUR-DD            TO WS-EDIT-DD.                           
             MOVE WS-CUR-MM            TO WS-EDIT-MM.                           
             MOVE WS-CUR-YYYY          TO WS-EDIT-YYYY.                         
             MOVE WS-EDITED-DATE       TO L661B-PRT-DATE.                       
                                                                                
             MOVE   WS-CONTROL-PAGE-NO TO     L661B-PAGE-NO.                    
             WRITE  P13L661B-REC       FROM   L661B-HEADER-2  AFTER 2.          
                                                                                
             MOVE   ALL '-'            TO     P13L661B-REC.                     
             WRITE  P13L661B-REC       AFTER 1.                                 
                                                                                
             WRITE  P13L661B-REC       FROM   L661B-HEADER-3  AFTER 1.          
                                                                                
             MOVE   ALL '-'            TO     P13L661B-REC.                     
             WRITE  P13L661B-REC       AFTER 1.                                 
                                                                                
             MOVE   7                  TO     WS-CONTROL-PR-LINE.               
                                                                                
       2550-EXIT.                                                               
              EXIT.                                                             
