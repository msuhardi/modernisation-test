       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C438.                                                 
      *AUTHOR.        YPH.                                                      
      *DATE-WRITTEN.  21/03/91.                                                 
      *DATE-COMPILED.                                                           
      *    SKIP 3.                                                              
      *REMARKS.                                                                 
      * ======================================================== *              
      *              SYSTEM OF COMMITMENT (BP13)                 *              
      * ======================================================== *              
      *    OBJECTIVE  :                                          *              
      *      1. TO PRINT FROM THE FILE BP13F310 ALL THE LEGAL    *              
      *         DOCUMENTS THAT ARE STAMPED AND ARE READY TO BE   *              
      *         SENT TO LEGAL DEPT -- ACCORDING TO SCHEME AND    *              
      *         ACCOUNT NO. ON BLOCK BASIS.                      *              
      *                                                          *              
      *      2. THE INPUT FILE WILL BE PRE-SORTED THROUGH USE OF *              
      *         PROGRAM 'BP13C439'.                              *              
      *                                                          *              
      *    INPUT FILES :                                         *              
      *      1. BP13F310 (TRANS FILE)                            *              
      *      2. BP13K410 (ACCUMSO FILE)                          *              
      *                                                          *              
      *    LISTING :                                             *              
      *      1. P13L438A (LEGAL DOCUMENTS TO BE SENT TO BO FOR   *              
      *                   FOLLOW-UP ACTION.                      *              
      *                                                          *              
      * ======================================================== *              
      * CHG-NO   BY  DATE    DESCRIPTION                         *              
      * -------- --- ------  -----------                         *              
      * BP130020 SSS 951011  REPOSITION REPORT-ID TO COL 1       *              
      * BP130418 RHB 980804  TO CATER FOR Y2K.                   *              
      * BP134779 PCL4130613  TO CONVERT THE REPORT TO SENDMAIL   *              
      * BP135537 RJB1230215  CHANGE  THE EMAIL RECIPIENT FROM    *              
      *                      NICKNAME INTO COMPLETE NAME         *              
      * BP136477 RJB 181016  TO REPLACE KIM HUAT TO YEE MIEN     *              
      * BP137087 PCL 171117  TO UPDATE EMAIL RECIPIENTS          *              
      * BP137155 PCL 080118  TO UPDATE EMAIL RECIPIENTS          *              
      * BP137554 DN8 112018  TO UPDATE EMAIL RECIPIENTS          *              
      * BP137554 zs13112818  add NGAI_Chyau_Jiann@hdb.gov.sg     *              
      * BP138757 KV8 230721  TO REPLACE KATHIJAH TO SUZANNE      *              
      * BP139030 ZAR7 070122 REPLACE CHUA YEE MIEN TO LIM KOK CHUN *            
      * BP139159 KAC1 130622 REMOVED Normala_BUANG@hdb.gov.sg    *              
      * BP139159 KAC1 280622 REMOVED Afiqah                      *              
      * BP139276 KAC1 050424 REPLACE LIM KOK CHUN BY             *              
      *                              KATHIJAH_BEE_ALI_MOHAMED    *              
      * ======================================================== *              
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
           SELECT BP13F310  ASSIGN TO BP13F310.                                 
           SELECT BP13K410   ASSIGN TO BP13K410                                 
                  ORGANIZATION IS INDEXED                                       
                  ACCESS MODE IS RANDOM                                         
                  RECORD KEY IS K410-KEY-FLD                                    
                  FILE STATUS IS BP13K410-STATUS.                               
           SELECT P13L438A  ASSIGN TO P13L438A.                                 
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  BP13F310                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 150 CHARACTERS                                       
           LABEL RECORDS ARE STANDARD.                                          
       COPY BP13F310.                                                           
                                                                                
       FD   BP13K410                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 2000 CHARACTERS                                     
            LABEL RECORD IS STANDARD.                                           
       COPY BP13K410.                                                           
                                                                                
       FD  P13L438A                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED.                                           
       01  L438A-PRINT-REC                PIC X(132).                           
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
       01  WS-EMAIL-RPT-VARIABLES.                                              
           05  WS-DATE-RPT-DTL.                                                 
               10 FILLER                PIC X(6)  VALUE 'DATE: '.               
               10 WS-DATE-RPT           PIC X(10) VALUE SPACES.                 
           05  WS-MAIL-RPT1             PIC X(12) VALUE 'HELO SGPHDB1'.         
           05  WS-MAIL-RPT2             PIC X(27)                               
               VALUE 'MAIL FROM:<OPCP@SGPHDB1>'.                                
           05  WS-MAIL-RPT3             PIC X(60)                               
               VALUE 'RCPT TO:<BALASUBRAMANIAM_ARUNASALAM@HDB.GOV.SG>'.         
           05  WS-MAIL-RPT4             PIC X(60) VALUE                         
              'RCPT TO:<NOORJAHAN_SHAIK_MOHAMED_GULEMKADER@HDB.GOV.SG>'.        
           05  WS-MAIL-RPT5             PIC X(60)                               
               VALUE 'RCPT TO:<MUHAMMED_SHARIFF_SAHROM@HDB.GOV.SG>'.            
           05  WS-MAIL-RPT7             PIC X(60)                               
      *        VALUE 'RCPT TO:<KATHIJAH_BEE_ALI_MOHAMED@HDB.GOV.SG>'.           
               VALUE 'RCPT TO:<SUZANNE_SC_HENG@HDB.GOV.SG>'.                    
           05  WS-MAIL-RPT7B            PIC X(40)                               
               VALUE 'RCPT TO:<PHNG_BEE_LUAN@HDB.GOV.SG>'.                      
           05  WS-MAIL-RPT7B1           PIC X(40)                               
               VALUE 'RCPT TO:<NGAI_CHYAU_JIANN@HDB.GOV.SG>'.                   
           05  WS-MAIL-RPT7C            PIC X(45)                               
               VALUE 'RCPT TO:<KATHIJAH_BEE_ALI_MOHAMED@hdb.gov.sg>'.           
           05  WS-MAIL-RPT7D            PIC X(40)                               
               VALUE 'RCPT TO:<OH_MENG_HUAT@HDB.GOV.SG>'.                       
           05  WS-MAIL-RPT8             PIC X(4)                                
               VALUE 'DATA'.                                                    
           05  WS-MAIL-RPT9             PIC X(40)                               
               VALUE 'FROM:Soc System - Email Alert'.                           
           05  WS-MAIL-RPT10            PIC X(60)                               
               VALUE 'TO:<BALASUBRAMANIAM_ARUNASALAM@HDB.GOV.SG>'.              
           05  WS-MAIL-RPT11            PIC X(60) VALUE                         
              'TO:<NOORJAHAN_SHAIK_MOHAMED_GULEMKADER@HDB.GOV.SG>'.             
           05  WS-MAIL-RPT12            PIC X(60)                               
               VALUE 'TO:<MUHAMMED_SHARIFF_SAHROM@HDB.GOV.SG>'.                 
           05  WS-MAIL-RPT13B           PIC X(60)                               
      *        VALUE 'TO:<KATHIJAH_BEE_ALI_MOHAMED@HDB.GOV.SG>'.                
               VALUE 'TO:<SUZANNE_SC_HENG@HDB.GOV.SG>'.                         
           05  WS-MAIL-RPT13D           PIC X(40)                               
               VALUE 'TO:<PHNG_BEE_LUAN@HDB.GOV.SG>'.                           
           05  WS-MAIL-RPT13D1          PIC X(40)                               
               VALUE 'TO:<NGAI_Chyau_Jiann@hdb.gov.sg>'.                        
           05  WS-MAIL-RPT13E           PIC X(40)                               
               VALUE 'CC:<KATHIJAH_BEE_ALI_MOHAMED@hdb.gov.sg>'.                
           05  WS-MAIL-RPT13F           PIC X(40)                               
               VALUE 'CC:<OH_MENG_HUAT@HDB.GOV.SG>'.                            
           05  WS-MAIL-RPT15            PIC X(100)                              
               VALUE 'SUBJECT : LIST OF LEGAL DOCUMENTS SENT TO LEGAL'.         
                                                                                
       01  FILE-STATUS.                                                         
           03  BP13K410-STATUS            PIC 99    VALUE 0.                    
                                                                                
       01  WS1-DATE-VARIABLES.                                                  
           03  WS1-DATE.                                                        
               05  WS1-MM                 PIC 9(2).                             
               05  FILLER                 PIC X.                                
               05  WS1-DD                 PIC 9(2).                             
               05  FILLER                 PIC X.                                
               05  WS1-CC                 PIC 9(2).                             
               05  WS1-YY                 PIC 9(2).                             
           03  WS1-KEY-ISSUE-DATE.                                              
               05  WS1-KEY-CC             PIC 9(2).                             
               05  WS1-KEY-YY             PIC 9(2).                             
               05  WS1-KEY-MM             PIC 9(2).                             
               05  WS1-KEY-DD             PIC 9(2).                             
           03  WS1-EDITED-DATE.                                                 
               05  WS1-EDIT-DD            PIC 99.                               
               05  FILLER                 PIC X     VALUE '/'.                  
               05  WS1-EDIT-MM            PIC 99.                               
               05  FILLER                 PIC X     VALUE '/'.                  
               05  WS1-EDIT-CC            PIC 99.                               
               05  WS1-EDIT-YY            PIC 99.                               
           03  WS1-CURR-YYMMDD.                                                 
               05  WS1-CURR-CC            PIC 99.                               
               05  WS1-CURR-YY            PIC 99.                               
               05  WS1-CURR-MM            PIC 99.                               
               05  WS1-CURR-DD            PIC 99.                               
                                                                                
       01  WS2-REPORT-VARIABLES.                                                
      **COUNTERS ****                                                           
           03  WS2-NUM-VARIABLES.                                               
               05  WS2-NUM-SUM            PIC S9(4) VALUE +0.                   
               05  WS2-NUM-DOA            PIC S9(2) VALUE +0.                   
               05  WS2-NUM-SU             PIC S9(2) VALUE +0.                   
               05  WS2-NUM-SA             PIC S9(2) VALUE +0.                   
               05  WS2-NUM-LIE            PIC S9(2) VALUE +0.                   
               05  WS2-NUM-DOA-ST         PIC S9(2) VALUE +0.                   
               05  WS2-NUM-LA             PIC S9(2) VALUE +0.                   
               05  WS2-NUM-FSA            PIC S9(2) VALUE +0.                   
               05  WS2-NUM-WA             PIC S9(2) VALUE +0.                   
               05  WS2-NUM-MIE            PIC S9(2) VALUE +0.                   
               05  WS-SA                  PIC 9(2)  VALUE 0.                    
               05  WS-LIE                 PIC 9(2)  VALUE 0.                    
               05  WS2-NUM-DOA-TOTAL      PIC 9(4)  VALUE 0.                    
               05  WS2-NUM-SU-TOTAL       PIC 9(4)  VALUE 0.                    
               05  WS2-NUM-SA-TOTAL       PIC 9(4)  VALUE 0.                    
               05  WS2-NUM-LIE-TOTAL      PIC 9(4)  VALUE 0.                    
               05  WS2-NUM-MIE-TOTAL      PIC 9(4)  VALUE 0.                    
               05  WS2-NUM-DOA-ST-TOTAL   PIC 9(4)  VALUE 0.                    
               05  WS2-NUM-WA-TOTAL       PIC 9(4)  VALUE 0.                    
               05  WS2-NUM-FSA-TOTAL      PIC 9(4)  VALUE 0.                    
               05  WS2-NUM-LA-TOTAL       PIC 9(4)  VALUE 0.                    
                                                                                
      * COUNTERS FOR REPORT (FILE SENT)  *                                      
               05  WS-PREV-PAGE           PIC 9(5)  COMP-3  VALUE 0.            
               05  WS2-CNT-PAGE-FS        PIC 9(5)  COMP-3  VALUE 0.            
               05  WS2-SERIAL-NO-FS       PIC 9(3)  COMP-3  VALUE 0.            
               05  WS2-CNT-LINES-FS       PIC 9(3)  COMP-3  VALUE 0.            
                                                                                
       01  WS3-COUNTERS.                                                        
           03  WS3-CNT-F310-READ          PIC 9(5)  VALUE  0.                   
                                                                                
       01  WS4-SWITCHES-INDICATORS.                                             
           03  WS4-EOF-IND                PIC X(01) VALUE 'N'.                  
               88  WS4-EOF                VALUE 'Y'.                            
                                                                                
           03  WS4-CALLED-FROM-IND        PIC X(02)  VALUE SPACES.              
               88  WS4-CALLED-FROM-FS     VALUE 'FS'.                           
                                                                                
                                                                                
      ** TO INDICATE THAT A PARTICULAR PAGE  OR LIST NO OR CHANGE  **           
      ** IN BO WAS READ/PRINTED **                                              
      *                                                                         
           03  WS4-PRTED-ACK-IND          PIC X      VALUE SPACE.               
                                                                                
       01  WS5-DEFAULT-VALUES.                                                  
           03  WS5-MAX-LINE-FS            PIC 9(2)   VALUE 30.                  
                                                                                
      **** DEFAULT HEADINGS FOR THE VARIOUS LISTINGS *****                      
           03  WS5-HD2B-DESC-FS           PIC X(52)  VALUE                      
               'LIST  OF  LEGAL  DOCUMENTS  SENT  TO  LEGAL DEPT   '.           
                                                                                
       01  WS6-MSIC.                                                            
           03  WS6-SCH-ACC.                                                     
               05  WS6-SCH                PIC X(04).                            
               05  WS6-ACC                PIC X(05).                            
               05  WS6-ACC-TYPE           PIC X(02).                            
           03  WS6-TEMP                   PIC 9(3)   VALUE 0.                   
                                                                                
      * VARIABLES FOR CHECKING CONTROL IN PAGE BREAK *                          
           03  WS-PREV-BLK-NO             PIC X(5)  VALUE SPACES.               
           03  WS-PREV-LIST-NO            PIC X(10) VALUE SPACES.               
                                                                                
      *---------------------------------------------------------------*         
      *                                                               *         
      *        C O M M O N      L A Y - O U T  (HEADINGS) FOR :       *         
      *          LIST OF FILES SENT TO BRANCH OFFICE                  *         
      *    &     LIST OF SALES ORDERS SENT TO BRANCH OFFICE           *         
      *                                                               *         
      *---------------------------------------------------------------*         
                                                                                
       01  L438-DIVIDER.                                                        
           03  FILLER                PIC X(40)   VALUE                          
               '     -----------------------------------'.                      
           03  FILLER                PIC X(40)   VALUE                          
               '----------------------------------------'.                      
           03  FILLER                PIC X(40)   VALUE                          
               '----------------------------------------'.                      
                                                                                
       01  L438-HDG-1.                                                          
           03  FILLER                PIC X(8)    VALUE 'BP13L438'.              
           03  FILLER                PIC X(30)   VALUE SPACES.                  
           03  FILLER                PIC X(39)   VALUE                          
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           03  FILLER                PIC X(55)   VALUE SPACES.                  
                                                                                
       01  L438-HDG-2A.                                                         
           03  FILLER                PIC X(48)   VALUE SPACES.                  
           03  FILLER                PIC X(30)   VALUE                          
              'AGREEMENT TEAM (SALES)'.                                         
           03  FILLER                PIC X(54)   VALUE SPACES.                  
                                                                                
       01  L438-HDG-2B.                                                         
           03  FILLER                PIC X(37)   VALUE SPACES.                  
           03  L438-HD2B-DESC        PIC X(52)   VALUE SPACES.                  
           03  FILLER                PIC X(43)   VALUE SPACES.                  
                                                                                
       01  L438-HDG-4.                                                          
           03  FILLER                PIC X(05)   VALUE SPACES.                  
           03  FILLER                PIC X(11)   VALUE 'LIST-NO : '.            
           03  L438-HD4-LIST-NO      PIC X(10).                                 
           03  FILLER                PIC X(77)   VALUE SPACES.                  
           03  FILLER                PIC X(10)   VALUE '   DATE : '.            
           03  L438-HD4-DATE         PIC X(10).                                 
                                                                                
       01  L438-HDG-4A.                                                         
           03  FILLER                PIC X(05)   VALUE SPACES.                  
           03  FILLER                PIC X(10)   VALUE 'APT BLOCK '.            
           03  L438-FS-BLK-NO        PIC X(5)    VALUE SPACE.                   
           03  FILLER                PIC X(2)    VALUE SPACE.                   
           03  L438-FS-ST-NAME       PIC X(20).                                 
           03  FILLER                PIC X(90)   VALUE SPACE.                   
                                                                                
      *-------------------------------------------------------------*           
      *                                                             *           
      *   REPORT LAY-OUT FOR LISTING OF FILES SENT TO AREA OFFICE   *           
      *                                                             *           
      *-------------------------------------------------------------*           
                                                                                
      ****     '1234567890123456789012345678901234567890'.                      
      ****     '                                        '.                      
       01  L438-FS-HDG-5.                                                       
           03  FILLER                PIC X(40)   VALUE                          
               '      SR                         HOUSE  '.                      
           03  FILLER                PIC X(40)   VALUE                          
               '     SA       LIE         MIE       DOA '.                      
           03  FILLER                PIC X(40)   VALUE                          
               '   SU     FSA  DOA-ST   LA       WA *   '.                      
                                                                                
       01  L438-FS-HDG-5A.                                                      
           03  FILLER                PIC X(40)   VALUE                          
               '      NO   SCHEME ACCOUNT NO       NO   '.                      
           03  FILLER                PIC X(40)   VALUE                          
               '      O      O    D      O    D      O  '.                      
           03  FILLER                PIC X(40)   VALUE                          
               '    O      O      O      O      O    O  '.                      
                                                                                
      **** DETAIL LINE FOR REPORT FORMAT (LIST OF FILES SENT) ****              
                                                                                
       01  L438-FS-DETAIL-1.                                                    
           03  FILLER                PIC X(5)    VALUE SPACE.                   
           03  L438-FS-SERIAL-NO     PIC ZZ9.                                   
           03  FILLER                PIC X(5)    VALUE SPACE.                   
           03  L438-FS-SCHEME        PIC 9(4).                                  
           03  FILLER                PIC X       VALUE '-'.                     
           03  L438-FS-ACC           PIC 9(5).                                  
           03  FILLER                PIC X       VALUE '-'.                     
           03  L438-FS-ACC-TYPE      PIC 99.                                    
           03  FILLER                PIC X(4)    VALUE SPACE.                   
           03  FILLER                PIC X(2)    VALUE ' #'.                    
           03  L438-FS-LEVEL-NO      PIC X(2).                                  
           03  FILLER                PIC X       VALUE '-'.                     
           03  L438-FS-MAIN-UNIT     PIC X(5).                                  
           03  FILLER                PIC X(3)    VALUE SPACE.                   
           03  L438-FS-SA            PIC X(1).                                  
           03  FILLER                PIC X(6)    VALUE SPACE.                   
           03  L438-FS-LIE           PIC X(1).                                  
           03  FILLER                PIC X(4)    VALUE SPACE.                   
           03  L438-FS-LIED          PIC X(1).                                  
           03  FILLER                PIC X(6)    VALUE SPACE.                   
           03  L438-FS-MIE           PIC X(1).                                  
           03  FILLER                PIC X(4)    VALUE SPACE.                   
           03  L438-FS-MIED          PIC X(1).                                  
           03  FILLER                PIC X(6)    VALUE SPACE.                   
           03  L438-FS-DOA           PIC X(1).                                  
           03  FILLER                PIC X(6)    VALUE SPACE.                   
           03  L438-FS-SU            PIC X(1).                                  
           03  FILLER                PIC X(2)    VALUE SPACE.                   
           03  FILLER                PIC X(1)    VALUE '¦'.                     
           03  FILLER                PIC X(3)    VALUE SPACE.                   
           03  L438-FS-FSA           PIC X(1).                                  
           03  FILLER                PIC X(6)    VALUE SPACE.                   
           03  L438-FS-DOA-ST        PIC X(1).                                  
           03  FILLER                PIC X(6)    VALUE SPACE.                   
           03  L438-FS-LA            PIC X(1).                                  
           03  FILLER                PIC X(6)    VALUE SPACE.                   
           03  L438-FS-WA            PIC X(1).                                  
           03  FILLER                PIC X(4)    VALUE SPACE.                   
           03  L438-FS-WAT           PIC X(1).                                  
                                                                                
      *--------------------------------------------------------------*          
      *       REPORT LAY-OUT FOR END PAGE DETAILS                    *          
      *--------------------------------------------------------------*          
       01  L438-SO-DETAIL-1.                                                    
           03  FILLER                PIC X(18)   VALUE SPACES.                  
           03  FILLER                PIC X(11)   VALUE 'SUB-TOTAL  '.           
           03  FILLER                PIC X(16)   VALUE SPACES.                  
           03  L438-FS-NUM-SA        PIC Z9.                                    
           03  FILLER                PIC X(5)    VALUE SPACE.                   
           03  L438-FS-NUM-LIE       PIC Z9.                                    
           03  FILLER                PIC X(3)    VALUE SPACE.                   
           03  L438-FS-NUM-LIED      PIC Z9.                                    
           03  FILLER                PIC X(5)    VALUE SPACE.                   
           03  L438-FS-NUM-MIE       PIC Z9.                                    
           03  FILLER                PIC X(3)    VALUE SPACE.                   
           03  L438-FS-NUM-MIED      PIC Z9.                                    
           03  FILLER                PIC X(5)    VALUE SPACE.                   
           03  L438-FS-NUM-DOA       PIC Z9.                                    
           03  FILLER                PIC X(5)    VALUE SPACE.                   
           03  L438-FS-NUM-SU        PIC Z9.                                    
           03  FILLER                PIC X(2)    VALUE SPACE.                   
           03  FILLER                PIC X       VALUE '¦'.                     
           03  FILLER                PIC X(2)    VALUE SPACE.                   
           03  L438-FS-NUM-FSA       PIC Z9.                                    
           03  FILLER                PIC X(5)    VALUE SPACE.                   
           03  L438-FS-NUM-DOA-ST    PIC Z9.                                    
           03  FILLER                PIC X(5)    VALUE SPACE.                   
           03  L438-FS-NUM-LA        PIC Z9.                                    
           03  FILLER                PIC X(5)    VALUE SPACE.                   
           03  L438-FS-NUM-WA        PIC Z9.                                    
           03  FILLER                PIC X(3)    VALUE SPACE.                   
           03  L438-FS-NUM-WAT       PIC Z9.                                    
                                                                                
       01  L438-SO-DETAIL-1A.                                                   
           03  FILLER                PIC X(18)   VALUE SPACES.                  
           03  FILLER                PIC X(11)   VALUE '    TOTAL  '.           
           03  FILLER                PIC X(14)   VALUE SPACES.                  
           03  L438-FS-TOT-SUM       PIC ZZZ9.                                  
           03  FILLER                PIC X(2)    VALUE SPACE.                   
                                                                                
       01  L438-SO-DETAIL-1B.                                                   
           03  FILLER                PIC X(05)   VALUE SPACE.                   
           03  FILLER                PIC X(36)   VALUE                          
           '* TRANSFEROR/TRANSFEREE'.                                           
           03  FILLER                PIC X(91)   VALUE SPACE.                   
                                                                                
       01  L438-SO-DETAIL-2.                                                    
           03  FILLER                PIC X(5)    VALUE SPACES.                  
           03  FILLER                PIC X(22)   VALUE 'HH/LFK'.                
                                                                                
       01  L438-SO-DETAIL-3.                                                    
           03  FILLER                PIC X(5)    VALUE SPACES.                  
           03  FILLER                PIC X(22)   VALUE 'J:090291'.              
                                                                                
                                                                                
      ************************************************************              
       PROCEDURE DIVISION.                                                      
      ************************************************************              
       MAIN SECTION.                                                            
      *============*                                                            
           PERFORM 0010-INITIALIZATION   THRU 0010-EXIT.                        
           PERFORM 0020-PROCESS-INPUT    THRU 0020-EXIT                         
                   UNTIL WS4-EOF.                                               
           PERFORM 0030-FINAL-PRT-ACKNOW THRU 0030-EXIT.                        
           PERFORM 0040-CLOSE-ROUTINE    THRU 0040-EXIT.                        
                                                                                
      *===================*                                                     
       0010-INITIALIZATION.                                                     
      *===================*                                                     
           OPEN INPUT  BP13F310                                                 
                       BP13K410                                                 
                OUTPUT P13L438A.                                                
                                                                                
           IF BP13K410-STATUS NOT = 0 AND NOT = 97                              
              DISPLAY 'OPENING ERROR, K410-STATUS ' BP13K410-STATUS             
              MOVE BP13K410-STATUS TO RETURN-CODE.                              
                                                                                
            PERFORM 5000-HEADER-EMAIL  THRU 5000-EXIT.                          
                                                                                
       0010-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *==================*                                                      
       0020-PROCESS-INPUT.                                                      
      *==================*                                                      
           READ BP13F310 AT END                                                 
                MOVE 'Y' TO WS4-EOF-IND                                         
                GO TO 0020-EXIT.                                                
                                                                                
      *-------------------------------------------------------*                 
      *  ACCUMULATE NUMBER OF SALES TYPE AND SET INDICATORS   *                 
      *-------------------------------------------------------*                 
           ADD  1      TO  WS3-CNT-F310-READ.                                   
                                                                                
           PERFORM 0100-PROCESS-RPT  THRU  0100-EXIT.                           
                                                                                
       0020-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *=====================*                                                   
       0030-FINAL-PRT-ACKNOW.                                                   
      *=====================*                                                   
      ***---------------------------------------------------***                 
      *  IF THE LAST RECORD(SALES TYPE) READ BEFORE END OF    *                 
      *      FILE  DOES NOT HAVE ACKNOWLEDGEMENT PRINTED      *                 
      *      -  PRINT ACKNOWLEDGEMENT                         *                 
      ***---------------------------------------------------***                 
            IF  WS4-EOF AND                                                     
                  WS4-PRTED-ACK-IND = SPACE                                     
                  PERFORM 2100-PRT-PAGE-END THRU 2100-EXIT.                     
       0030-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *==================*                                                      
       0040-CLOSE-ROUTINE.                                                      
      *==================*                                                      
      * DISPLAY NECESSARY STATISTICS *                                          
            DISPLAY ' **** BP13C438 ****'.                                      
            DISPLAY ' NO. OF RECORDS READ FROM (BP13F310) : '                   
                    WS3-CNT-F310-READ.                                          
            DISPLAY ' DEED OF ASSIGNMENT  SENT TO LEGAL DEPT  : '               
                    WS2-NUM-DOA-TOTAL.                                          
            DISPLAY ' SUPPLEMENTARY AGREEMENT SENT TO LEGAL DEPT : '            
                    WS2-NUM-SU-TOTAL.                                           
                                                                                
            CLOSE BP13F310                                                      
                  BP13K410                                                      
                  P13L438A.                                                     
                                                                                
            STOP RUN.                                                           
                                                                                
       0040-EXIT.                                                               
            EXIT.                                                               
                                                                                
      **************************************************************            
      *                                                            *            
      *    CONTROL ROUTINE FOR PRINTING REPORT WITH 2 FORMATS      *            
      *        FOR EACH SALES TYPE (01, 02, 03 & 10)               *            
      *                                                            *            
      **************************************************************            
       0100-PROCESS-RPT.                                                        
      *================*                                                        
      ***---------------------------------------------------***                 
      *  TO GET ADDRESS, THEN PRINT LISTINGS                  *                 
      ***---------------------------------------------------***                 
           PERFORM 1200-MOVE-ADDRESS      THRU 1200-EXIT.                       
      ***---------------------------------------------------***                 
      *  TO START NEW PAGE BY BLOCK BASIS FOR                 *                 
      *  -  STARTING PAGE BY LIST NO.                         *                 
      *  -  STARTING PAGE BY BLOCK, AND                       *                 
      *  -  SUBSEQUENT DIFFERENT BLOCK                        *                 
      ***---------------------------------------------------***                 
           IF WS-PREV-LIST-NO = SPACES                                          
              MOVE F310-NUM-BLK      TO WS-PREV-BLK-NO                          
              MOVE F310-NUM-SCHEDULE TO WS-PREV-LIST-NO                         
                                        L438-HD4-LIST-NO                        
              PERFORM 1000-PRT-L438-FS-HEADING THRU 1000-EXIT                   
                                                                                
           ELSE                                                                 
           IF WS-PREV-LIST-NO NOT = F310-NUM-SCHEDULE                           
              MOVE F310-NUM-BLK      TO WS-PREV-BLK-NO                          
              MOVE F310-NUM-SCHEDULE TO WS-PREV-LIST-NO                         
                                        L438-HD4-LIST-NO                        
              PERFORM 0200-PRINT-PAGE-BREAK    THRU 0200-EXIT                   
                                                                                
           ELSE                                                                 
           IF WS-PREV-BLK-NO NOT = F310-NUM-BLK                                 
              MOVE F310-NUM-BLK      TO WS-PREV-BLK-NO                          
              PERFORM 0200-PRINT-PAGE-BREAK    THRU 0200-EXIT.                  
                                                                                
           MOVE  F310-REGN-NO TO K410-KEY-FLD.                                  
           READ  BP13K410.                                                      
           PERFORM 1210-MOVE-K410-ACCUMSO THRU 1210-EXIT.                       
                                                                                
           PERFORM 1300-LIST-FILE-SENT    THRU 1300-EXIT.                       
                                                                                
       0100-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *********************************************************                 
      *  PRINT THE END OF PAGE OF CURRENT LISTING, AND        *                 
      *  PRINT HEADINGS FOR NEXT PAGE OF LISTING              *                 
      *********************************************************                 
       0200-PRINT-PAGE-BREAK.                                                   
              PERFORM 2100-PRT-PAGE-END    THRU 2100-EXIT.                      
              PERFORM 1000-PRT-L438-FS-HEADING THRU 1000-EXIT.                  
       0200-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ****************************************************                      
      *                                                  *                      
      *  PRINT HEADINGS FOR LIST OF FILES SENT           *                      
      *                                                  *                      
      ****************************************************                      
       1000-PRT-L438-FS-HEADING.                                                
                                                                                
           MOVE 'FS'  TO WS4-CALLED-FROM-IND.                                   
           ADD  1     TO WS2-CNT-PAGE-FS.                                       
      *    MOVE 1     TO WS2-CNT-LINES-FS.                                      
                                                                                
           MOVE WS5-HD2B-DESC-FS    TO L438-HD2B-DESC.                          
           PERFORM 3100-FORMAT-DATE THRU 3100-EXIT.                             
                                                                                
           WRITE L438A-PRINT-REC  FROM  L438-HDG-1 AFTER PAGE.                  
           WRITE L438A-PRINT-REC  FROM  L438-HDG-2A                             
                                  AFTER ADVANCING 2.                            
           WRITE L438A-PRINT-REC  FROM  L438-HDG-2B                             
                                  AFTER ADVANCING 2.                            
           WRITE L438A-PRINT-REC  FROM  L438-HDG-4                              
                                  AFTER ADVANCING 2.                            
           WRITE L438A-PRINT-REC  FROM  L438-HDG-4A                             
                                  AFTER ADVANCING 2.                            
           WRITE L438A-PRINT-REC  FROM  L438-FS-HDG-5                           
                                  AFTER ADVANCING 3.                            
           WRITE L438A-PRINT-REC  FROM  L438-FS-HDG-5A                          
                                  AFTER ADVANCING 1.                            
           WRITE L438A-PRINT-REC  FROM  L438-DIVIDER                            
                                  AFTER ADVANCING 1.                            
           MOVE SPACES            TO L438A-PRINT-REC.                           
           WRITE L438A-PRINT-REC  AFTER ADVANCING 1.                            
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************                      
      *                                                  *                      
      *     RETRIEVE ADDRESS FROM F310 FILE              *                      
      *                                                  *                      
      ****************************************************                      
       1200-MOVE-ADDRESS.                                                       
           MOVE F310-NUM-LEVEL       TO L438-FS-LEVEL-NO.                       
           MOVE F310-NUM-MAIN        TO L438-FS-MAIN-UNIT.                      
           MOVE F310-NUM-BLK         TO L438-FS-BLK-NO.                         
           MOVE F310-NME-STREET      TO L438-FS-ST-NAME.                        
                                                                                
       1200-EXIT.                                                               
           EXIT.                                                                
                                                                                
       1210-MOVE-K410-ACCUMSO.                                                  
           IF BP13K410-STATUS = 0                                               
              NEXT SENTENCE                                                     
           ELSE                                                                 
           IF BP13K410-STATUS = 23                                              
              DISPLAY 'RECORD NOT FOUND IN K410 ' K410-KEY-FLD                  
           ELSE                                                                 
              DISPLAY 'ERROR READING K410, K410-STATUS '                        
                      BP13K410-STATUS                                           
              MOVE BP13K410-STATUS TO RETURN-CODE                               
              PERFORM 0040-CLOSE-ROUTINE.                                       
                                                                                
            IF  K410-AMT-LEASE-ESCROW-FEE IS NOT NUMERIC                        
             MOVE ZEROS TO K410-AMT-LEASE-ESCROW-FEE.                           
                                                                                
            IF  K410-AMT-LEASE-ESCROW-FEE > 0                                   
                  ADD 1 TO WS2-NUM-LIE                                          
                  ADD 1 TO WS2-NUM-LIE-TOTAL                                    
                  MOVE '1'              TO L438-FS-LIE                          
                  MOVE '1'              TO L438-FS-LIED                         
           ELSE                                                                 
                  MOVE SPACES           TO L438-FS-LIE                          
                  MOVE SPACES           TO L438-FS-LIED.                        
                                                                                
            IF  K410-CDE-PRINT-DOA       = 'Y'                                  
                  ADD   1               TO WS2-NUM-DOA                          
                  ADD   1               TO WS2-NUM-DOA-TOTAL                    
                  MOVE '1'              TO L438-FS-DOA                          
           ELSE                                                                 
                  MOVE SPACES           TO L438-FS-DOA.                         
                                                                                
            IF  K410-CDE-PRINT-MORT      = 'Y'                                  
                  ADD   1               TO WS2-NUM-MIE                          
                  ADD   1               TO WS2-NUM-MIE-TOTAL                    
                  MOVE '1'              TO L438-FS-MIE                          
                  MOVE '1'              TO L438-FS-MIED                         
            ELSE                                                                
                  MOVE SPACES           TO L438-FS-MIE                          
                  MOVE SPACES           TO L438-FS-MIED.                        
                                                                                
            IF  K410-CDE-PRINT-SUPL-AGMT  =  'Y'                                
                  ADD   1               TO WS2-NUM-SU                           
                  ADD   1               TO WS2-NUM-SU-TOTAL                     
                  MOVE '1'              TO L438-FS-SU                           
            ELSE                                                                
                  MOVE SPACES           TO L438-FS-SU.                          
                                                                                
            IF  K410-DTE-ARGORDER NOT = ZEROS AND SPACES AND LOW-VALUES         
                  ADD   1               TO WS2-NUM-SA                           
                  ADD   1               TO WS2-NUM-SA-TOTAL                     
                  MOVE '1'              TO L438-FS-SA                           
            ELSE                                                                
            IF  K410-CDE-SALES-TYPE  NOT = '10'                                 
                IF  K410-DTE-KEY-ISSUE NOT = ZEROS AND SPACES AND               
                                             LOW-VALUES                         
                    ADD   1             TO WS2-NUM-SA                           
                    ADD   1             TO WS2-NUM-SA-TOTAL                     
                    MOVE '1'            TO L438-FS-SA                           
                ELSE                                                            
                    DISPLAY 'NO SA '                                            
                    MOVE SPACES         TO L438-FS-SA                           
            ELSE                                                                
                DISPLAY 'NO SA '                                                
                MOVE SPACES             TO L438-FS-SA.                          
                                                                                
            IF  K410-CDE-SUB-TRANSFER = 'Y'                                     
                ADD 1       TO   WS2-NUM-FSA WS2-NUM-DOA-ST                     
                                 WS2-NUM-LA  WS2-NUM-WA                         
                ADD 1       TO   WS2-NUM-FSA-TOTAL                              
                                 WS2-NUM-DOA-ST-TOTAL                           
                                 WS2-NUM-LA-TOTAL                               
                                 WS2-NUM-WA-TOTAL                               
                MOVE '1'    TO   L438-FS-FSA                                    
                                 L438-FS-DOA-ST                                 
                                 L438-FS-LA                                     
                                 L438-FS-WA                                     
                                 L438-FS-WAT                                    
                MOVE SPACES TO   L438-FS-SA                                     
                SUBTRACT 1  FROM WS2-NUM-SA                                     
            ELSE                                                                
                MOVE SPACES TO   L438-FS-FSA                                    
                                 L438-FS-DOA-ST                                 
                                 L438-FS-LA                                     
                                 L438-FS-WA                                     
                                 L438-FS-WAT.                                   
       1210-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ***********************************************************               
      *                                                         *               
      *   PRINT DETAILS  OF FILES SENT TO AREA OFFICE           *               
      *     FOR SALES TYPE '01','02','03','5B', '5C' & '10'*                    
      *                                                         *               
      ***********************************************************               
       1300-LIST-FILE-SENT.                                                     
             ADD 1 TO WS2-SERIAL-NO-FS                                          
                      WS2-CNT-LINES-FS.                                         
                                                                                
             MOVE WS2-SERIAL-NO-FS TO L438-FS-SERIAL-NO.                        
             MOVE F310-SCH-ACC     TO WS6-SCH-ACC.                              
             MOVE WS6-SCH          TO L438-FS-SCHEME.                           
             MOVE WS6-ACC          TO L438-FS-ACC.                              
             MOVE WS6-ACC-TYPE     TO L438-FS-ACC-TYPE.                         
                                                                                
             WRITE L438A-PRINT-REC FROM L438-FS-DETAIL-1                        
                   AFTER ADVANCING 1.                                           
                                                                                
             IF WS2-CNT-LINES-FS = WS5-MAX-LINE-FS                              
               PERFORM 0200-PRINT-PAGE-BREAK THRU 0200-EXIT.                    
                                                                                
       1300-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ****************************************************                      
      *                                                  *                      
      *  PRINT ACKNOWLEDGEMENT LINE AT END OF EACH PAGE  *                      
      *                                                  *                      
      ****************************************************                      
       2100-PRT-PAGE-END.                                                       
                                                                                
           MOVE SPACE            TO WS4-PRTED-ACK-IND.                          
           MOVE WS2-NUM-SA       TO L438-FS-NUM-SA.                             
           MOVE WS2-NUM-SU       TO L438-FS-NUM-SU.                             
           MOVE WS2-NUM-DOA      TO L438-FS-NUM-DOA.                            
           MOVE WS2-NUM-LIE      TO L438-FS-NUM-LIE.                            
           MOVE WS2-NUM-LIE      TO L438-FS-NUM-LIED.                           
           MOVE WS2-NUM-MIE      TO L438-FS-NUM-MIE.                            
           MOVE WS2-NUM-MIE      TO L438-FS-NUM-MIED.                           
           MOVE WS2-NUM-FSA      TO L438-FS-NUM-FSA.                            
           MOVE WS2-NUM-LA       TO L438-FS-NUM-LA.                             
           MOVE WS2-NUM-WA       TO L438-FS-NUM-WA.                             
           MOVE WS2-NUM-WA       TO L438-FS-NUM-WAT.                            
           MOVE WS2-NUM-DOA-ST   TO L438-FS-NUM-DOA-ST.                         
                                                                                
           COMPUTE WS2-NUM-SUM = WS2-NUM-SU + WS2-NUM-DOA +                     
                                 WS2-NUM-LIE +  WS2-NUM-MIE +                   
                                 WS2-NUM-LIE +  WS2-NUM-MIE +                   
                                 WS2-NUM-SA  +  WS2-NUM-DOA-ST +                
                                 WS2-NUM-FSA +  WS2-NUM-LA +                    
                                 WS2-NUM-WA  +  WS2-NUM-WA.                     
                                                                                
           MOVE WS2-NUM-SUM   TO L438-FS-TOT-SUM.                               
                                                                                
           WRITE L438A-PRINT-REC FROM L438-DIVIDER      AFTER 2.                
           WRITE L438A-PRINT-REC FROM L438-SO-DETAIL-1  AFTER 1.                
           WRITE L438A-PRINT-REC FROM L438-DIVIDER      AFTER 1.                
           WRITE L438A-PRINT-REC FROM L438-SO-DETAIL-1A AFTER 1.                
           WRITE L438A-PRINT-REC FROM L438-DIVIDER      AFTER 1.                
           WRITE L438A-PRINT-REC FROM L438-SO-DETAIL-1B AFTER 1.                
           WRITE L438A-PRINT-REC FROM L438-SO-DETAIL-2  AFTER 3.                
           WRITE L438A-PRINT-REC FROM L438-SO-DETAIL-3  AFTER 1.                
                                                                                
           MOVE SPACES TO L438A-PRINT-REC.                                      
           WRITE L438A-PRINT-REC.                                               
           MOVE  ZEROS TO WS2-NUM-DOA   WS2-NUM-SU                              
                          WS2-NUM-LIE   WS2-NUM-MIE                             
                          WS2-NUM-SA    WS2-NUM-DOA-ST                          
                          WS2-NUM-FSA   WS2-NUM-LA                              
                          WS2-NUM-WA    WS2-NUM-SUM.                            
                                                                                
           MOVE ZEROES TO WS2-SERIAL-NO-FS                                      
                          WS2-CNT-PAGE-FS                                       
                          WS2-CNT-LINES-FS.                                     
                                                                                
       2100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ***********************************************************               
      *                                                         *               
      *   COMMON FUNCTIONS CALLED BY THE ABOVE ROUTINES.        *               
      *                                                         *               
      ***********************************************************               
      *                                                                         
       3100-FORMAT-DATE.                                                        
                                                                                
            MOVE FUNCTION CURRENT-DATE TO WS1-CURR-YYMMDD.                      
            MOVE WS1-CURR-CC           TO WS1-CC  WS1-EDIT-CC.                  
            MOVE WS1-CURR-YY           TO WS1-YY  WS1-EDIT-YY.                  
            MOVE WS1-CURR-MM           TO WS1-MM  WS1-EDIT-MM.                  
            MOVE WS1-CURR-DD           TO WS1-DD  WS1-EDIT-DD.                  
            MOVE WS1-EDITED-DATE       TO L438-HD4-DATE.                        
       3100-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *================================================================*        
       5000-HEADER-EMAIL.                                                       
      *================================================================*        
                                                                                
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT1.                            
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT2.                            
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT3.                            
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT4.                            
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT5.                            
                                                                                
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT7.                            
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT7B.                           
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT7B1.                          
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT7C.                           
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT7D.                           
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT8.                            
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT9.                            
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT10.                           
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT11.                           
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT12.                           
                                                                                
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT13B.                          
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT13D.                          
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT13D1.                         
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT13E.                          
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT13F.                          
            WRITE L438A-PRINT-REC FROM WS-MAIL-RPT15.                           
                                                                                
            STRING  FUNCTION CURRENT-DATE(7:2) '/'                              
                    FUNCTION CURRENT-DATE(5:2) '/'                              
                    FUNCTION CURRENT-DATE(1:4)                                  
            DELIMITED BY SIZE INTO WS-DATE-RPT.                                 
                                                                                
            WRITE L438A-PRINT-REC FROM WS-DATE-RPT-DTL.                         
                                                                                
            MOVE SPACES TO  L438A-PRINT-REC.                                    
            WRITE   L438A-PRINT-REC.                                            
                                                                                
       5000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
