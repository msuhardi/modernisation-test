       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C019.                                                 
      *AUTHOR.        CKK7.                                                     
      *DATE-WRITTEN.  23OCT2002.                                                
      * ====================================================== *                
      *                                                        *                
      *    SYSTEM NAME : SYSTEM OF COMMITMENT  (SOC)           *                
      *                                                        *                
      *    SYSTEM ID   : BP13                                  *                
      *                                                        *                
      *    OBJECTIVES :                                        *                
      *                                                        *                
      *    1. PROGRAM FOR GENERATING REPORT FOR FIN FOR SALES  *                
      *       FROM THE 1ST TO 22ND OF THE MONTH                *                
      *                                                        *                
      *    INPUT  FILES : BP13F410 - APPOINTMENT FILE          *                
      *                 : SY02F001 - DATE FILE                 *                
      *                                                        *                
      *    LISTINGS     : BP13L019 - REPORT ON SCHEDULED TP    *                
      *--------------------------------------------------------*                
      * CHG-NO  BY    DATE    DETAILS                          *                
      * ======  ==   ======== ================================ *                
      *BP132231 CKK  20021025 NEW PGM                          *                
      *BP132351 SK   20030707 WRITE OUTFILE  (P13L019A)        *                
      *BP132375 SK   20030714 INCLUDE BM06K110                 *                
      * ====================================================== *                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-4341.                                               
       OBJECT-COMPUTER. IBM-4341.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F410 ASSIGN TO BP13F410.                                  
           SELECT SY02F001 ASSIGN TO SY02F001.                                  
                                                                                
           SELECT BM06K110 ASSIGN TO BM06K110                                   
                ACCESS MODE       IS RANDOM                                     
                ORGANIZATION      IS INDEXED                                    
                RECORD KEY        IS K110-KEY-FLD                               
                FILE STATUS       IS WS-K110-STATUS.                            
                                                                                
           SELECT BP13L019 ASSIGN TO BP13L019.                                  
           SELECT P13L019A ASSIGN TO P13L019A.                                  
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD   BP13F410                                                            
            RECORDING MODE    F                                                 
            BLOCK CONTAINS    0 RECORDS                                         
            LABEL RECORDS   ARE STANDARD                                        
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13F410.                                                           
                                                                                
       COPY SY02F001.                                                           
                                                                                
       FD  BM06K110                                                             
           RECORD CONTAINS 500 CHARACTERS.                                      
       COPY BM06K110.                                                           
                                                                                
       FD   BP13L019                                                            
            RECORD CONTAINS 132 CHARACTERS                                      
            RECORDING MODE    F.                                                
       01   BP13L019-REC    PIC X(132).                                         
                                                                                
       FD   P13L019A                                                            
            RECORD CONTAINS 133 CHARACTERS                                      
            RECORDING MODE    F.                                                
       01   P13L019A-REC    PIC X(132).                                         
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-FILE-CONTROLS.                                                    
           05  WS-F410-EOF-SW                 PIC X(1)  VALUE 'N'.              
           05  WS-K110-STATUS                 PIC 9(2)  VALUE 0.                
                                                                                
       01  WS-RECORD-COUNTERS.                                                  
           05  WS-CNT-READ-F410               PIC 9(6)  VALUE ZEROS.            
           05  WS-CANCEL                      PIC 9(6)  VALUE ZEROS.            
           05  WS-L019-WRT-CTR                PIC 9(6)  VALUE 0.                
           05  WS-K110-CTR-NOTFND             PIC 9(6)  VALUE 0.                
                                                                                
       01  WS-L019-CONTROLS.                                                    
           05  WS-L019-LINECTR                PIC 9(2)  VALUE 60.               
           05  WS-L019-PAGECTR                PIC 9(5)  VALUE ZEROS.            
           05  WS-L019-SNO                    PIC 9(4)  VALUE 0.                
           05  WS-CNT-LETTERS                 PIC 9(4)   VALUE ZEROES.          
                                                                                
       01  WS-MISCELLANEOUS-VARS.                                               
           05  WS-BLANKS                      PIC X(132) VALUE SPACES.          
           05  WS-CTR                         PIC 9(2)   VALUE 0.               
           05  WS-TOTAL-PRICE                 PIC 9(10)  VALUE 0.               
           05  WS-TOTAL-LOAN                  PIC 9(10)  VALUE 0.               
           05  WS-LOAN-C1TO15                 PIC 9(10)  VALUE 0.               
           05  WS-LOAN-C16TO22                PIC 9(10)  VALUE 0.               
           05  WS-LOAN-C                      PIC 9(10)  VALUE 0.               
           05  WS-LOAN-NA                     PIC 9(10)  VALUE 0.               
           05  WS-LOAN-M                      PIC 9(10)  VALUE 0.               
           05  WS-LOAN-TO5                    PIC 9(10)  VALUE 0.               
           05  WS-LOAN-TO10                   PIC 9(10)  VALUE 0.               
           05  WS-LOAN-TO15                   PIC 9(10)  VALUE 0.               
           05  WS-LOAN-TO20                   PIC 9(10)  VALUE 0.               
           05  WS-LOAN-TO25                   PIC 9(10)  VALUE 0.               
           05  WS-LOAN-TO30                   PIC 9(10)  VALUE 0.               
           05  WS-PRICE-C1TO15                PIC 9(10)  VALUE 0.               
           05  WS-PRICE-C16TO22               PIC 9(10)  VALUE 0.               
           05  WS-PRICE-C                     PIC 9(10)  VALUE 0.               
           05  WS-PRICE-NA                    PIC 9(10)  VALUE 0.               
           05  WS-PRICE-M                     PIC 9(10)  VALUE 0.               
           05  WS-PRICE-TO5                   PIC 9(10)  VALUE 0.               
           05  WS-PRICE-TO10                  PIC 9(10)  VALUE 0.               
           05  WS-PRICE-TO15                  PIC 9(10)  VALUE 0.               
           05  WS-PRICE-TO20                  PIC 9(10)  VALUE 0.               
           05  WS-PRICE-TO25                  PIC 9(10)  VALUE 0.               
           05  WS-PRICE-TO30                  PIC 9(10)  VALUE 0.               
           05  WS-LOAN-SCH                    PIC X(02)  VALUE SPACES.          
           05  WS-K110-FOUND                  PIC X(01)  VALUE SPACES.          
                                                                                
       01  WS-TIME-DATES.                                                       
           05  WS-SYSTEM-DATE.                                                  
               10  WS-SYS-CCYY.                                                 
                   15  WS-SYS-CC              PIC 9(2).                         
                   15  WS-SYS-YY              PIC 9(2).                         
               10  WS-SYS-MM                  PIC 9(2).                         
               10  WS-SYS-DD                  PIC 9(2).                         
                                                                                
           05  WS-EDITED-DATE.                                                  
               10  WS-EDITED-DD               PIC 9(2).                         
               10  FILLER                     PIC X(1)  VALUE '/'.              
               10  WS-EDITED-MM               PIC 9(2).                         
               10  FILLER                     PIC X(1)  VALUE '/'.              
               10  WS-EDITED-YY               PIC 9(4).                         
                                                                                
      *============================================================*            
      *         BP13L019 -   R E P O R T    L A Y O U T            *            
      *============================================================*            
                                                                                
       01  L019-HEADER-01.                                                      
           05  FILLER              PIC X(08)     VALUE 'BP13L019'.              
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE 'HDBCAT 3'.              
           05  FILLER              PIC X(25)     VALUE SPACES.                  
           05  FILLER              PIC X(41)     VALUE                          
               'S Y S T E M    O F    C O M M I T M E N T'.                     
           05  FILLER              PIC X(12)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'DATE :'.                
           05  L019-RUN-DATE       PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'PAGE : '.               
           05  L019-PAGE-NO        PIC ZZZZ9 .                                  
                                                                                
       01  L019-HEADER-02.                                                      
           05  FILLER              PIC X(38)     VALUE SPACES.                  
           05  FILLER              PIC X(26)     VALUE                          
           'LISTING OF FLATS SOLD IN '.                                         
           05  L019-SOLD-MM        PIC X(09)     VALUE SPACES.                  
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  L019-SOLD-CCYY      PIC X(04)     VALUE SPACES.                  
                                                                                
       01  L019-HEADER-03.                                                      
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(05)     VALUE ' S/N '.                 
           05  FILLER              PIC X(06)     VALUE SPACES.                  
           05  FILLER              PIC X(10)     VALUE 'SCH-ACC-NO'.            
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  FILLER              PIC X(13)     VALUE 'KEY ISSUE DTE'.         
           05  FILLER              PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE 'LOAN SCH'.              
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(12)     VALUE 'REPAY PERIOD'.          
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(12)     VALUE 'LOAN GRANTED'.          
           05  FILLER              PIC X(07)     VALUE SPACES.                  
           05  FILLER              PIC X(13)     VALUE 'SELLING PRICE'.         
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(07)     VALUE 'REGN NO'.               
                                                                                
       01  L019-HEADER-04.                                                      
           05  FILLER              PIC X(130)    VALUE ALL '-'.                 
                                                                                
       01  L019-SPACES.                                                         
           05  FILLER              PIC X(130)    VALUE ALL ' '.                 
                                                                                
       01  L019-DETAIL.                                                         
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  L019-SNO            PIC ZZZ9      VALUE ZEROES.                  
           05  FILLER              PIC X(06)     VALUE SPACES.                  
           05  L019-NUM-SCH-ACC    PIC X(11)     VALUE SPACES.                  
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  L019-SO-DATE        PIC X(10)     VALUE SPACES.                  
           05  FILLER              PIC X(08)     VALUE SPACES.                  
           05  L019-LOAN-SCH       PIC X(01)     VALUE SPACES.                  
           05  FILLER              PIC X(11)     VALUE SPACES.                  
           05  L019-REPAY-PERIOD   PIC X(02)     VALUE SPACES.                  
           05  FILLER              PIC X(12)       VALUE SPACES.                
           05  L019-LOAN-GRANTED   PIC $$$$,$$9.99  VALUE ZEROES.               
           05  FILLER              PIC X(08)       VALUE SPACES.                
           05  L019-SELLING-PRICE  PIC $$$$,$$9.99  VALUE ZEROES.               
           05  FILLER              PIC X(06)     VALUE SPACES.                  
           05  L019-REGN-NO        PIC X(8)      VALUE SPACES.                  
                                                                                
       01  L019-FOOTER-01.                                                      
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(27)                                    
                                   VALUE '(SALES FROM 1ST TO 15TH):  '.         
           05  L019-CASES-C1TO15   PIC 9999      VALUE ZEROES.                  
           05  FILLER              PIC X(06)     VALUE ' CASES'.                
           05  FILLER              PIC X(40)     VALUE SPACES.                  
           05  L019-LOAN-C1TO15    PIC $$$9,999,999.99  VALUE ZEROES.           
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  L019-PRICE-C1TO15   PIC $$$9,999,999.99  VALUE ZEROES.           
                                                                                
       01  L019-FOOTER-02.                                                      
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(20)                                    
                                   VALUE '(SALES FROM 16TH TO '.                
           05  L019-TODAY-DD       PIC X(2)      VALUE ZEROES.                  
           05  FILLER              PIC X(03)     VALUE '): '.                   
           05  L019-CASES-C16TO22  PIC 9999      VALUE ZEROES.                  
           05  FILLER              PIC X(06)     VALUE ' CASES'.                
           05  FILLER              PIC X(40)     VALUE SPACES.                  
           05  L019-LOAN-C16TO22   PIC $$$9,999,999.99  VALUE ZEROES.           
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  L019-PRICE-C16TO22  PIC $$$9,999,999.99  VALUE ZEROES.           
                                                                                
       01  L019-FOOTER-2A.                                                      
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(27)                                    
                                   VALUE '- LOAN GRANTED = 0         '.         
           05  L019-CASES-NA       PIC 9999      VALUE ZEROES.                  
           05  FILLER              PIC X(06)     VALUE ' CASES'.                
           05  FILLER              PIC X(40)     VALUE SPACES.                  
           05  L019-LOAN-NA        PIC $$$$,$99,999.99  VALUE ZEROES.           
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  L019-PRICE-NA       PIC $$$$,$99,999.99  VALUE ZEROES.           
                                                                                
       01  L019-FOOTER-2B.                                                      
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(27)                                    
                                   VALUE '- LOAN SCHEME "C"          '.         
           05  L019-CASES-C        PIC 9999      VALUE ZEROES.                  
           05  FILLER              PIC X(06)     VALUE ' CASES'.                
           05  FILLER              PIC X(40)     VALUE SPACES.                  
           05  L019-LOAN-C         PIC $$$$,$99,999.99  VALUE ZEROES.           
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  L019-PRICE-C        PIC $$$$,$99,999.99  VALUE ZEROES.           
                                                                                
       01  L019-FOOTER-2C.                                                      
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(27)                                    
                                   VALUE '- LOAN SCHEME "M"          '.         
           05  L019-CASES-M        PIC 9999      VALUE ZEROES.                  
           05  FILLER              PIC X(06)     VALUE ' CASES'.                
           05  FILLER              PIC X(40)     VALUE SPACES.                  
           05  L019-LOAN-M         PIC $$$$,$99,999.99  VALUE ZEROES.           
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  L019-PRICE-M        PIC $$$$,$99,999.99  VALUE ZEROES.           
                                                                                
       01  L019-FOOTER-2CI.                                                     
           05  FILLER              PIC X(05)     VALUE SPACES.                  
           05  FILLER              PIC X(36)                                    
                     VALUE 'REPAY PERIOD FOR SALES FROM 16TH TO '.              
           05  L019-TODAY-DD2      PIC X(2)      VALUE ZEROES.                  
                                                                                
       01  L019-FOOTER-2C1.                                                     
           05  FILLER              PIC X(08)     VALUE SPACES.                  
           05  FILLER              PIC X(22)                                    
                                   VALUE '1 - 5 YRS             '.              
           05  L019-CASES-TO5      PIC 9999      VALUE ZEROES.                  
           05  FILLER              PIC X(06)     VALUE ' CASES'.                
           05  FILLER              PIC X(40)     VALUE SPACES.                  
           05  L019-LOAN-TO5       PIC $$$$,$$9,999.99  VALUE ZEROES.           
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  L019-PRICE-TO5      PIC $$$$,$$9,999.99  VALUE ZEROES.           
                                                                                
       01  L019-FOOTER-2C2.                                                     
           05  FILLER              PIC X(08)     VALUE SPACES.                  
           05  FILLER              PIC X(22)                                    
                                   VALUE '6 - 10 YRS            '.              
           05  L019-CASES-TO10     PIC 9999      VALUE ZEROES.                  
           05  FILLER              PIC X(06)     VALUE ' CASES'.                
           05  FILLER              PIC X(40)     VALUE SPACES.                  
           05  L019-LOAN-TO10      PIC $$$$,$$9,999.99  VALUE ZEROES.           
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  L019-PRICE-TO10     PIC $$$$,$$9,999.99  VALUE ZEROES.           
                                                                                
       01  L019-FOOTER-2C3.                                                     
           05  FILLER              PIC X(08)     VALUE SPACES.                  
           05  FILLER              PIC X(22)                                    
                                   VALUE '11 - 15 YRS           '.              
           05  L019-CASES-TO15     PIC 9999      VALUE ZEROES.                  
           05  FILLER              PIC X(06)     VALUE ' CASES'.                
           05  FILLER              PIC X(40)     VALUE SPACES.                  
           05  L019-LOAN-TO15      PIC $$$$,$99,999.99  VALUE ZEROES.           
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  L019-PRICE-TO15     PIC $$$$,$99,999.99  VALUE ZEROES.           
                                                                                
       01  L019-FOOTER-2C4.                                                     
           05  FILLER              PIC X(08)     VALUE SPACES.                  
           05  FILLER              PIC X(22)                                    
                                   VALUE '16 - 20 YRS           '.              
           05  L019-CASES-TO20     PIC 9999      VALUE ZEROES.                  
           05  FILLER              PIC X(06)     VALUE ' CASES'.                
           05  FILLER              PIC X(40)     VALUE SPACES.                  
           05  L019-LOAN-TO20      PIC $$$$,$99,999.99  VALUE ZEROES.           
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  L019-PRICE-TO20     PIC $$$$,$99,999.99  VALUE ZEROES.           
                                                                                
       01  L019-FOOTER-2C5.                                                     
           05  FILLER              PIC X(08)     VALUE SPACES.                  
           05  FILLER              PIC X(22)                                    
                                   VALUE '21 - 25 YRS           '.              
           05  L019-CASES-TO25     PIC 9999      VALUE ZEROES.                  
           05  FILLER              PIC X(06)     VALUE ' CASES'.                
           05  FILLER              PIC X(40)     VALUE SPACES.                  
           05  L019-LOAN-TO25      PIC $$$$,$99,999.99  VALUE ZEROES.           
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  L019-PRICE-TO25     PIC $$$$,$99,999.99  VALUE ZEROES.           
                                                                                
       01  L019-FOOTER-2C6.                                                     
           05  FILLER              PIC X(08)     VALUE SPACES.                  
           05  FILLER              PIC X(22)                                    
                                   VALUE '26 - 30 YRS           '.              
           05  L019-CASES-TO30     PIC 9999      VALUE ZEROES.                  
           05  FILLER              PIC X(06)     VALUE ' CASES'.                
           05  FILLER              PIC X(40)     VALUE SPACES.                  
           05  L019-LOAN-TO30      PIC $$$$,$99,999.99  VALUE ZEROES.           
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  L019-PRICE-TO30     PIC $$$$,$99,999.99  VALUE ZEROES.           
                                                                                
       01  L019-FOOTER-03.                                                      
           05  FILLER              PIC X(03)     VALUE SPACES.                  
           05  FILLER              PIC X(27)                                    
                                   VALUE 'GRAND TOTAL                '.         
           05  L019-CASES-TOTAL    PIC 9999      VALUE ZEROES.                  
           05  FILLER              PIC X(06)     VALUE ' CASES'.                
           05  FILLER              PIC X(40)     VALUE SPACES.                  
           05  L019-LOAN-TOTAL     PIC $$$$,$99,999.99  VALUE ZEROES.           
           05  FILLER              PIC X(04)     VALUE SPACES.                  
           05  L019-PRICE-TOTAL    PIC $$$$,$99,999.99  VALUE ZEROES.           
                                                                                
      ****************************************************************          
       PROCEDURE DIVISION.                                                      
      ****************************************************************          
       0000-MAIN-ROUTINE.                                                       
      ****************************************************************          
                                                                                
           PERFORM 1000-OPEN-ROUTINE        THRU 1000-EXIT.                     
                                                                                
           PERFORM 3000-PROCESS-F410                                            
              THRU 3000-EXIT                                                    
             UNTIL (WS-F410-EOF-SW = 'Y').                                      
                                                                                
           PERFORM 5000-PRINT-FOOTER        THRU 5000-EXIT.                     
           PERFORM 9999-CLOSE-ROUTINE       THRU 9999-EXIT.                     
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       1000-OPEN-ROUTINE.                                                       
      ****************************************************************          
                                                                                
           OPEN INPUT  BP13F410                                                 
                       BM06K110                                                 
                       SY02F001                                                 
                OUTPUT BP13L019                                                 
                       P13L019A.                                                
                                                                                
           IF WS-K110-STATUS NOT = '00' AND NOT = '97'                          
              DISPLAY ' OPENING ERROR BM06K110 - STATUS' WS-K110-STATUS         
              MOVE WS-K110-STATUS TO RETURN-CODE                                
              PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                         
           END-IF.                                                              
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8)  TO  WS-SYSTEM-DATE.                 
                                                                                
           MOVE   WS-SYS-DD           TO WS-EDITED-DD.                          
           MOVE   WS-SYS-MM           TO WS-EDITED-MM.                          
                                                                                
           MOVE   WS-SYS-CCYY         TO WS-EDITED-YY                           
                                         L019-SOLD-CCYY.                        
                                                                                
           MOVE   WS-EDITED-DATE      TO L019-RUN-DATE.                         
                                                                                
                                                                                
           READ SY02F001                                                        
           AT END                                                               
              DISPLAY 'EMPTY FILE - SY02F001 '                                  
              PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT.                        
                                                                                
           MOVE F001-TXT-CURRENT-MTH  TO L019-SOLD-MM.                          
           MOVE F001-CURR-DD          TO L019-TODAY-DD                          
                                         L019-TODAY-DD2.                        
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       2000-READ-F410.                                                          
      ****************************************************************          
                                                                                
           READ BP13F410                                                        
              AT END MOVE 'Y'   TO WS-F410-EOF-SW                               
                     GO TO 2000-EXIT.                                           
                                                                                
           ADD  +1                 TO WS-CNT-READ-F410.                         
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       3000-PROCESS-F410.                                                       
      ****************************************************************          
                                                                                
           PERFORM  2000-READ-F410    THRU 2000-EXIT.                           
           PERFORM  3100-READ-K110    THRU 3100-EXIT.                           
                                                                                
           IF WS-K110-FOUND = 'Y'                                               
                                                                                
           IF (WS-F410-EOF-SW NOT = 'Y' AND                                     
               F410-CDE-SALES-TYPE NOT = '13' AND                               
              (K110-DTE-KEY-ISSUED(1:4) = F001-DTE-CURRENT(1:4) AND             
               K110-DTE-KEY-ISSUED(5:2) = F001-DTE-CURRENT(5:2) AND             
               K110-DTE-KEY-ISSUED(7:2) <= F001-DTE-CURRENT(7:2)))              
                                                                                
             MOVE K110-DTE-KEY-ISSUED(1:4)    TO WS-EDITED-YY                   
             MOVE K110-DTE-KEY-ISSUED(5:2)    TO WS-EDITED-MM                   
             MOVE K110-DTE-KEY-ISSUED(7:2)    TO WS-EDITED-DD                   
             MOVE WS-EDITED-DATE          TO L019-SO-DATE                       
                                                                                
             MOVE F410-NUM-SCH-ACC        TO L019-NUM-SCH-ACC                   
             MOVE F410-CDE-LOAN-SCH       TO L019-LOAN-SCH                      
             IF F410-NUM-REPAY-PERIOD = ZEROES                                  
                MOVE '--'                    TO L019-REPAY-PERIOD               
             ELSE                                                               
                MOVE F410-NUM-REPAY-PERIOD   TO L019-REPAY-PERIOD               
             END-IF                                                             
             MOVE F410-AMT-LOAN           TO L019-LOAN-GRANTED                  
             ADD  F410-AMT-LOAN           TO WS-TOTAL-LOAN                      
             MOVE F410-AMT-SELLING-PRICE  TO L019-SELLING-PRICE                 
             ADD  F410-AMT-SELLING-PRICE  TO WS-TOTAL-PRICE                     
             MOVE F410-NUM-REGN           TO L019-REGN-NO                       
                                                                                
             IF F410-AMT-LOAN = ZEROES                                          
                MOVE 'NA'              TO WS-LOAN-SCH                           
             ELSE                                                               
                IF F410-CDE-LOAN-SCH = '1' OR '2' OR '3'                        
                   MOVE 'C'                  TO WS-LOAN-SCH                     
                ELSE                                                            
                   IF F410-CDE-LOAN-SCH = '4'                                   
                      MOVE 'M'                    TO WS-LOAN-SCH                
                   END-IF                                                       
                END-IF                                                          
             END-IF                                                             
                                                                                
             IF K110-DTE-KEY-ISSUED(7:2) < '16'                                 
                ADD 1                       TO L019-CASES-C1TO15                
                ADD F410-AMT-LOAN           TO WS-LOAN-C1TO15                   
                MOVE WS-LOAN-C1TO15         TO L019-LOAN-C1TO15                 
                ADD F410-AMT-SELLING-PRICE  TO WS-PRICE-C1TO15                  
                MOVE WS-PRICE-C1TO15        TO L019-PRICE-C1TO15                
             END-IF                                                             
                                                                                
             IF K110-DTE-KEY-ISSUED(7:2) > '15'                                 
                ADD 1                       TO L019-CASES-C16TO22               
                ADD F410-AMT-LOAN           TO WS-LOAN-C16TO22                  
                MOVE WS-LOAN-C16TO22        TO L019-LOAN-C16TO22                
                ADD F410-AMT-SELLING-PRICE  TO WS-PRICE-C16TO22                 
                MOVE WS-PRICE-C16TO22       TO L019-PRICE-C16TO22               
                IF WS-LOAN-SCH = 'NA'                                           
                   ADD 1                       TO L019-CASES-NA                 
                   ADD F410-AMT-LOAN           TO WS-LOAN-NA                    
                   MOVE WS-LOAN-NA             TO L019-LOAN-NA                  
                   ADD F410-AMT-SELLING-PRICE  TO WS-PRICE-NA                   
                   MOVE WS-PRICE-NA            TO L019-PRICE-NA                 
                ELSE                                                            
                   IF WS-LOAN-SCH = 'C'                                         
                      ADD 1                       TO L019-CASES-C               
                      ADD F410-AMT-LOAN           TO WS-LOAN-C                  
                      MOVE WS-LOAN-C              TO L019-LOAN-C                
                      ADD F410-AMT-SELLING-PRICE  TO WS-PRICE-C                 
                      MOVE WS-PRICE-C             TO L019-PRICE-C               
                   ELSE                                                         
                      IF WS-LOAN-SCH = 'M'                                      
                         ADD 1                       TO L019-CASES-M            
                         ADD F410-AMT-LOAN           TO WS-LOAN-M               
                         MOVE WS-LOAN-M              TO L019-LOAN-M             
                         ADD F410-AMT-SELLING-PRICE  TO WS-PRICE-M              
                         MOVE WS-PRICE-M             TO L019-PRICE-M            
                                                                                
                         IF F410-NUM-REPAY-PERIOD > 0 AND                       
                            F410-NUM-REPAY-PERIOD <= 5                          
                           ADD 1                      TO                        
                                                      L019-CASES-TO5            
                           ADD F410-AMT-LOAN          TO                        
                                                      WS-LOAN-TO5               
                           MOVE WS-LOAN-TO5           TO                        
                                                      L019-LOAN-TO5             
                           ADD F410-AMT-SELLING-PRICE TO                        
                                                      WS-PRICE-TO5              
                           MOVE WS-PRICE-TO5          TO                        
                                                      L019-PRICE-TO5            
                         END-IF                                                 
                                                                                
                         IF F410-NUM-REPAY-PERIOD > 5 AND                       
                            F410-NUM-REPAY-PERIOD <= 10                         
                           ADD 1                      TO                        
                                                      L019-CASES-TO10           
                           ADD F410-AMT-LOAN          TO                        
                                                      WS-LOAN-TO10              
                           MOVE WS-LOAN-TO10          TO                        
                                                      L019-LOAN-TO10            
                           ADD F410-AMT-SELLING-PRICE TO                        
                                                      WS-PRICE-TO10             
                           MOVE WS-PRICE-TO10         TO                        
                                                      L019-PRICE-TO10           
                         END-IF                                                 
                                                                                
                         IF F410-NUM-REPAY-PERIOD > 10 AND                      
                            F410-NUM-REPAY-PERIOD <= 15                         
                           ADD 1                      TO                        
                                                      L019-CASES-TO15           
                           ADD F410-AMT-LOAN          TO                        
                                                      WS-LOAN-TO15              
                           MOVE WS-LOAN-TO15          TO                        
                                                      L019-LOAN-TO15            
                           ADD F410-AMT-SELLING-PRICE TO                        
                                                      WS-PRICE-TO15             
                           MOVE WS-PRICE-TO15         TO                        
                                                      L019-PRICE-TO15           
                         END-IF                                                 
                                                                                
                         IF F410-NUM-REPAY-PERIOD > 15 AND                      
                            F410-NUM-REPAY-PERIOD <= 20                         
                           ADD 1                      TO                        
                                                      L019-CASES-TO20           
                           ADD F410-AMT-LOAN          TO                        
                                                      WS-LOAN-TO20              
                           MOVE WS-LOAN-TO20          TO                        
                                                      L019-LOAN-TO20            
                           ADD F410-AMT-SELLING-PRICE TO                        
                                                      WS-PRICE-TO20             
                           MOVE WS-PRICE-TO20         TO                        
                                                      L019-PRICE-TO20           
                         END-IF                                                 
                                                                                
                         IF F410-NUM-REPAY-PERIOD > 20 AND                      
                            F410-NUM-REPAY-PERIOD <= 25                         
                           ADD 1                      TO                        
                                                      L019-CASES-TO25           
                           ADD F410-AMT-LOAN          TO                        
                                                      WS-LOAN-TO25              
                           MOVE WS-LOAN-TO25          TO                        
                                                      L019-LOAN-TO25            
                           ADD F410-AMT-SELLING-PRICE TO                        
                                                      WS-PRICE-TO25             
                           MOVE WS-PRICE-TO25         TO                        
                                                      L019-PRICE-TO25           
                         END-IF                                                 
                                                                                
                         IF F410-NUM-REPAY-PERIOD > 25 AND                      
                            F410-NUM-REPAY-PERIOD <= 30                         
                           ADD 1                      TO                        
                                                      L019-CASES-TO30           
                           ADD F410-AMT-LOAN          TO                        
                                                      WS-LOAN-TO30              
                           MOVE WS-LOAN-TO30          TO                        
                                                      L019-LOAN-TO30            
                           ADD F410-AMT-SELLING-PRICE TO                        
                                                      WS-PRICE-TO30             
                           MOVE WS-PRICE-TO30         TO                        
                                                      L019-PRICE-TO30           
                         END-IF                                                 
                                                                                
                      END-IF                                                    
                   END-IF                                                       
                END-IF                                                          
             END-IF                                                             
             PERFORM 4000-PRINT-RPT     THRU 4000-EXIT                          
           END-IF                                                               
           END-IF.                                                              
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *************************************************************             
       3100-READ-K110.                                                          
      *************************************************************             
                                                                                
           MOVE LOW-VALUES        TO K110-KEY-FLD.                              
           MOVE F410-NUM-SCH-ACC  TO K110-KEY-FLD.                              
           MOVE 'N'               TO WS-K110-FOUND.                             
                                                                                
           READ BM06K110.                                                       
                                                                                
           EVALUATE WS-K110-STATUS                                              
              WHEN 00                                                           
                   MOVE 'Y'  TO WS-K110-FOUND                                   
                   CONTINUE                                                     
              WHEN 23                                                           
                   MOVE SPACES                 TO L019-DETAIL                   
                   MOVE F410-NUM-SCH-ACC       TO L019-NUM-SCH-ACC              
                   MOVE 'NOT IN FIS'           TO L019-SO-DATE                  
                   PERFORM 4000-PRINT-RPT      THRU 4000-EXIT                   
                   ADD 1 TO WS-K110-CTR-NOTFND                                  
              WHEN OTHER                                                        
                   DISPLAY 'ERROR READING BM06K110 - STATUS '                   
                            WS-K110-STATUS                                      
                   PERFORM 9999-CLOSE-ROUTINE  THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *************************************************************             
       4000-PRINT-RPT.                                                          
      *************************************************************             
                                                                                
           ADD 1                        TO WS-L019-SNO.                         
           MOVE WS-L019-SNO             TO L019-SNO.                            
                                                                                
           IF WS-L019-LINECTR >= 55                                             
              ADD                  1 TO WS-L019-PAGECTR                         
              MOVE WS-L019-PAGECTR   TO L019-PAGE-NO                            
              WRITE BP13L019-REC   FROM L019-HEADER-01 AFTER PAGE               
              WRITE BP13L019-REC   FROM L019-HEADER-02                          
              WRITE BP13L019-REC   FROM L019-HEADER-03                          
              WRITE BP13L019-REC   FROM L019-HEADER-04                          
              WRITE BP13L019-REC   FROM L019-DETAIL                             
              MOVE                 5 TO WS-L019-LINECTR                         
           ELSE                                                                 
              ADD                  1 TO WS-L019-LINECTR                         
              WRITE BP13L019-REC   FROM L019-DETAIL                             
           END-IF.                                                              
                                                                                
           MOVE SPACES            TO P13L019A-REC.                              
           INITIALIZE                P13L019A-REC.                              
           WRITE P13L019A-REC     FROM L019-DETAIL.                             
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *************************************************************             
       5000-PRINT-FOOTER.                                                       
      *************************************************************             
                                                                                
           MOVE L019-SNO TO L019-CASES-TOTAL.                                   
           MOVE WS-TOTAL-PRICE TO L019-PRICE-TOTAL.                             
           MOVE WS-TOTAL-LOAN  TO L019-LOAN-TOTAL.                              
                                                                                
              ADD                  1 TO WS-L019-PAGECTR                         
              MOVE WS-L019-PAGECTR   TO L019-PAGE-NO                            
              WRITE BP13L019-REC   FROM L019-HEADER-01 AFTER PAGE.              
              WRITE BP13L019-REC   FROM L019-HEADER-02.                         
              WRITE BP13L019-REC   FROM L019-HEADER-03.                         
              WRITE BP13L019-REC   FROM L019-HEADER-04.                         
              WRITE BP13L019-REC   FROM L019-SPACES.                            
              WRITE BP13L019-REC   FROM L019-FOOTER-01.                         
              WRITE BP13L019-REC   FROM L019-SPACES.                            
              WRITE BP13L019-REC   FROM L019-SPACES.                            
              WRITE BP13L019-REC   FROM L019-FOOTER-02.                         
              WRITE BP13L019-REC   FROM L019-SPACES.                            
              WRITE BP13L019-REC   FROM L019-FOOTER-2A.                         
              WRITE BP13L019-REC   FROM L019-SPACES.                            
              WRITE BP13L019-REC   FROM L019-FOOTER-2B.                         
              WRITE BP13L019-REC   FROM L019-SPACES.                            
              WRITE BP13L019-REC   FROM L019-FOOTER-2C.                         
              WRITE BP13L019-REC   FROM L019-SPACES.                            
              WRITE BP13L019-REC   FROM L019-FOOTER-2CI.                        
              WRITE BP13L019-REC   FROM L019-FOOTER-2C1.                        
              WRITE BP13L019-REC   FROM L019-FOOTER-2C2.                        
              WRITE BP13L019-REC   FROM L019-FOOTER-2C3.                        
              WRITE BP13L019-REC   FROM L019-FOOTER-2C4.                        
              WRITE BP13L019-REC   FROM L019-FOOTER-2C5.                        
              WRITE BP13L019-REC   FROM L019-FOOTER-2C6.                        
              WRITE BP13L019-REC   FROM L019-SPACES.                            
              WRITE BP13L019-REC   FROM L019-SPACES.                            
              WRITE BP13L019-REC   FROM L019-SPACES.                            
              WRITE BP13L019-REC   FROM L019-FOOTER-03.                         
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ****************************************************************          
       9999-CLOSE-ROUTINE.                                                      
      ****************************************************************          
                                                                                
           CLOSE BP13F410                                                       
                 SY02F001                                                       
                 BM06K110                                                       
                 BP13L019                                                       
                 P13L019A.                                                      
                                                                                
           DISPLAY SPACES.                                                      
           DISPLAY 'RUN DATE : ' WS-EDITED-DATE.                                
           DISPLAY SPACES.                                                      
           DISPLAY '*===========BP13C019 CONTROL TOTALS============*'.          
           DISPLAY SPACES.                                                      
           DISPLAY 'BP13F410 RECORDS READ        = ' WS-CNT-READ-F410.          
           DISPLAY 'BM06K110 NOT FOUND           = ' WS-K110-CTR-NOTFND.        
           DISPLAY SPACES.                                                      
           DISPLAY '*==============================================*'.          
                                                                                
           STOP RUN.                                                            
                                                                                
       9999-EXIT.                                                               
            EXIT.                                                               
                                                                                
