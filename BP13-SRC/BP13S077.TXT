  /***************************************************************/             
  /*  SYSTEM OF COMMITMENT  (SOC)                                */             
  /*=============================================================*/             
  /* REPORT FOR BOOKING PROFILE (SUBSCRIPTION AND TAKE-UP)       */             
  /*-------------------------------------------------------------*/             
  /* CHG REF  DATE     BY   DESCRIPTION                          */             
  /* -------- -------- ---- -----------                          */             
  /* BP133614 20090528 PCL3 NEW PROGRAM                          */             
  /* BP133614 20090804 PCL3 ADD NEW FIELD (00 PREV OFFER)        */             
  /* BP133792 20100122 JB8  TO PRINT DETAIL FILES                */             
  /* BP133737 20100129 JB8  TO SETUP LINESIZE BEFORE DOING TABULATE */          
  /* BP133921 20100812 PCL3 TO ADD FLAT TYPE (1P, 4P & 5P)       */             
  /* BP134875 20130405 IMC1 DO NOT BYPASS CANCEL CASES AND ADD   */             
  /*                        NEW REPORT FOR HOUSEHOLD TYPE G      */             
  /* BP135340 20140514 IMC1 REPLACE BP13K816 WITH BP13K813       */             
  ****************************************************************/             
                                                                                
  %GLOBAL DTE_BALLOT DATE;                                                      
  OPTIONS  NODATE CAPS;                                                         
     PROC FORMAT;                                                               
                                                                                
          VALUE $RMFMT  "1 ","1A"="1R"                                          
                        "2 ","2A"="2R"                                          
                        "SA"="SA"                                               
                        "1P"="1P"                                               
                        "4P"="4P"                                               
                        "5P"="5P"                                               
                        "3 "="3R"                                               
                        "4 ","4D","4S"="4R"                                     
                        "5 ","5D"="5R"                                          
                        "6 ","E ","ED"="EF";                                    
                                                                                
  DATA BP13FH13;                                                                
  INFILE BP13FH13 END=EOF;                                                      
  INPUT  @1   REGN                       $CHAR8.                                
         @9   DATE_BALLOT                $CHAR6.                                
         @15  FLAT_TYPE                  $CHAR2.                                
         @137 ZONE                       $CHAR2.                                
         @19  NEW_TOWN                   $CHAR3.                                
         @95  CANCEL_STAT_F595           $CHAR1.                                
         @96  INCLUDE_BALLOT             $CHAR1.                                
         @97  BOOK_STAT                  $CHAR2.                                
         @99  CANCEL_STAT_F800           $CHAR1.                                
         @107 HOUSEHOLD                  $CHAR1.                                
         @108 BALLOT_HOUSEHOLD           $CHAR1.                                
         @109 NON_SELN                   2.                                     
         @111 NON_SELN_BE                2.                                     
         @113 NON_SELN_BTO               2.                                     
         @121 ST_BE                      2.                                     
         @123 ST_BTO                     2.                                     
         @125 ST_CODE                    $CHAR1.                                
         @126 ALLO_CAT                   $CHAR3.                                
         @129 APPLN_RCVD                 $CHAR1.                                
         @130 REJECT_BE                  2.                                     
         @132 REJECT_BTO                 2.                                     
         @134 REFINE                     $CHAR1.                                
         @135 NOT_REFINE                 $CHAR1.                                
         @136 COULD_NT_BOOK              $CHAR1.;                               
                                                                                
   IF _N_ = 1 THEN                                                              
      DO;                                                                       
        CUR_DTE=PUT(TODAY(),DDMMYY10.);                                         
        CALL SYMPUT('DATE',CUR_DTE);                                            
        CALL SYMPUT('DTE_BALLOT',DATE_BALLOT);                                  
      END;                                                                      
                                                                                
   RETAIN WS_K813_KEY;                                                          
   LENGTH FH13_KEY                       $11;                                   
                                                                                
   /**********************************************/                             
   /* READING BP13K813 TO GET NO. OF FLAT SUPPLY */                             
   /**********************************************/                             
   FH13_KEY    = NEW_TOWN||FLAT_TYPE||DTE_BALLOT;                               
                                                                                
   IF FH13_KEY NOT = WS_K813_KEY THEN                                           
      DO;                                                                       
           WS_K813_KEY    = FH13_KEY;                                           
                                                                                
          /* READING BP13K813 TO DECODE NT-CODE */                              
                                                                                
           LENGTH     K813_KEY $11;                                             
                                                                                
           K813_KEY    = ZONE;                                                  
                                                                                
           INFILE BP13K813 VSAM KEY = K813_KEY;                                 
           INPUT @;                                                             
           RC = _IORC_;                                                         
           IF RC = 0 THEN                                                       
              DO;                                                               
                 INPUT @250 UNIT_OFFER 4.;                                      
                 FLAT_SUPPLY       = UNIT_OFFER;                                
                                                                                
              END;                                                              
      END;                                                                      
                                                                                
                                                                                
   STATUS1           = 0;                                                       
   STATUS2           = 0;                                                       
   STATUS3           = 0;                                                       
   STATUS4           = 0;                                                       
   APPLN             = 0;                                                       
                                                                                
   WS_TOT_SELN       = 0;                                                       
   WS_TOT_ST         = 0;                                                       
   WS_TOT_REJECT     = 0;                                                       
                                                                                
   W1ST_SELN_BE      = 0;                                                       
   W1ST_SELN_BTO     = 0;                                                       
   W2ND_SELN_BE      = 0;                                                       
   W2ND_SELN_BTO     = 0;                                                       
   W2ND_SELN_BE_BTO  = 0;                                                       
   W3RD_SELN_BE      = 0;                                                       
   W3RD_SELN_BTO     = 0;                                                       
   W3RD_SELN_BE_BTO  = 0;                                                       
                                                                                
                                                                                
   WS_1ST_SELN_BE     = 0;                                                      
   WS_1ST_SELN_BTO    = 0;                                                      
   WS_2ND_SELN_BE     = 0;                                                      
   WS_2ND_SELN_BTO    = 0;                                                      
   WS_2ND_SELN_BE_BTO = 0;                                                      
   WS_3RD_SELN_BE     = 0;                                                      
   WS_3RD_SELN_BTO    = 0;                                                      
   WS_3RD_SELN_BE_BTO = 0;                                                      
                                                                                
                                                                                
   ST_BE_ALL         = 0;                                                       
   ST_BTO_ALL        = 0;                                                       
   ST_BE_BTO         = 0;                                                       
                                                                                
   WS_ST_BE_ALL      = 0;                                                       
   WS_ST_BTO_ALL     = 0;                                                       
   WS_ST_BE_BTO_ALL  = 0;                                                       
                                                                                
   WS_ST_CODE1       = 0;                                                       
   WS_ST_CODE2       = 0;                                                       
                                                                                
   WS_ZERO_OFFER     = 0;                                                       
   WS_1ST_OFFER      = 0;                                                       
   WS_2ND_OFFER      = 0;                                                       
   WS_3RD_OFFER      = 0;                                                       
   WS_AFFECTED       = 0;                                                       
   WS_NT_AFFECTED    = 0;                                                       
   WS_TOTALA         = 0;                                                       
   WS_TOTALB         = 0;                                                       
   WS_TOTALC         = 0;                                                       
   WS_TOTAL_SELN     = 0;                                                       
   WS_TOTALE        = 0;                                                        
                                                                                
                                                                                
   WS_TOT_SELN      = NON_SELN_BE + NON_SELN_BTO;                               
   WS_TOT_ST        = ST_BE       + ST_BTO;                                     
   WS_TOT_REJECT    = REJECT_BE   + REJECT_BTO;                                 
                                                                                
   IF WS_TOT_SELN = 0 THEN WS_TOTALE = WS_TOTALE + 1;                           
   IF CANCEL_STAT_F595 = 'C'   THEN STATUS1 = 1;                                
   IF INCLUDE_BALLOT   = 'Y'   THEN STATUS2 = 1;                                
   IF BOOK_STAT        = 'BF'  THEN STATUS3 = 1;                                
   IF CANCEL_STAT_F800 = 'C'   THEN STATUS4 = 1;                                
   IF APPLN_RCVD       = 'Y'   THEN APPLN   = 1;                                
                                                                                
   IF COULD_NT_BOOK = 'Y' THEN                                                  
      DO;                                                                       
                                                                                
        /**********************/                                                
        /* FOR REJECTED OFFER */                                                
        /*********************/                                                 
                                                                                
                IF  WS_TOT_REJECT  = 1 THEN WS_1ST_OFFER = 1;                   
           ELSE IF  WS_TOT_REJECT  = 2 THEN WS_2ND_OFFER = 1;                   
           ELSE IF  WS_TOT_REJECT >= 3 THEN WS_3RD_OFFER = 1;                   
                                                                                
           IF REFINE = 'N' AND NOT_REFINE = 'N' THEN                            
              DO;                                                               
                IF  WS_TOT_REJECT  = 0 THEN WS_ZERO_OFFER = 1;                  
              END;                                                              
                                                                                
           IF REFINE     = 'Y' THEN WS_AFFECTED = 1;                            
           IF NOT_REFINE = 'Y' THEN WS_NT_AFFECTED = 1;                         
                                                                                
           WS_TOTALC    = WS_1ST_OFFER    + WS_2ND_OFFER + WS_3RD_OFFER         
                          + WS_ZERO_OFFER + WS_AFFECTED  +                      
                            WS_NT_AFFECTED;                                     
      END;                                                                      
                                                                                
   ELSE                                                                         
    DO;                                                                         
                                                                                
      /**********************************************/                          
      /* (ST) AFFECTED/NOT AFFECTED BY REFINEMENT  */                           
      /********************************************/                            
                                                                                
      IF  WS_TOT_ST > 0 THEN                                                    
          DO;                                                                   
             IF WS_TOT_ST = ST_BE       THEN ST_BE_ALL  = 1;                    
             ELSE IF WS_TOT_ST = ST_BTO THEN ST_BTO_ALL = 1;                    
             ELSE ST_BE_BTO = 1;                                                
          END;                                                                  
                                                                                
                                                                                
         /* *******************/                                                
         /* FOR NON-SELECTION */                                                
         /* *******************/                                                
                                                                                
         IF WS_TOT_SELN = 1 THEN                                                
            DO;                                                                 
              IF NON_SELN_BE  = 1 THEN W1ST_SELN_BE  = 1;                       
              IF NON_SELN_BTO = 1 THEN W1ST_SELN_BTO = 1;                       
            END;                                                                
                                                                                
          ELSE IF WS_TOT_SELN = 2 THEN                                          
            DO;                                                                 
               IF NON_SELN_BE  = 2      THEN W2ND_SELN_BE  = 1;                 
               ELSE IF NON_SELN_BTO = 2 THEN W2ND_SELN_BTO = 1;                 
               ELSE W2ND_SELN_BE_BTO = 1;                                       
            END;                                                                
                                                                                
          ELSE IF WS_TOT_SELN >= 3 THEN                                         
            DO;                                                                 
             IF NON_SELN_BE  = WS_TOT_SELN THEN W3RD_SELN_BE  = 1;              
             ELSE IF NON_SELN_BTO = WS_TOT_SELN THEN W3RD_SELN_BTO = 1;         
             ELSE W3RD_SELN_BE_BTO = 1;                                         
            END;                                                                
                                                                                
                                                                                
           IF BALLOT_HOUSEHOLD = 'G' THEN                                       
               DO;                                                              
                  IF ST_CODE = 'Y' THEN WS_ST_CODE2  = 1;                       
                                                                                
                  WS_ST_BE_ALL   = ST_BE_ALL;                                   
                  WS_ST_BTO_ALL  = ST_BTO_ALL;                                  
                  WS_ST_BE_BTO   = ST_BE_BTO;                                   
                  WS_TOTALB      = WS_ST_BE_ALL  +                              
                                   WS_ST_BTO_ALL +                              
                                   WS_ST_BE_BTO  +                              
                                   WS_ST_CODE2;                                 
               END;                                                             
                                                                                
   /* LSB  IF  ST_CODE NOT = 'Y' THEN  */                                       
   /* LSB      DO;                     */                                       
                                                                                
                 IF BOOK_STAT = 'LF' OR                                         
                    BOOK_STAT = 'WS' OR                                         
                    BOOK_STAT = 'WF' OR                                         
                    BOOK_STAT = 'LS' THEN                                       
                    DO;                                                         
                      WS_1ST_SELN_BE      =  W1ST_SELN_BE;                      
                      WS_1ST_SELN_BTO     =  W1ST_SELN_BTO;                     
                      WS_2ND_SELN_BE      =  W2ND_SELN_BE;                      
                      WS_2ND_SELN_BTO     =  W2ND_SELN_BTO;                     
                      WS_2ND_SELN_BE_BTO  =  W2ND_SELN_BE_BTO;                  
                      WS_3RD_SELN_BE      =  W3RD_SELN_BE;                      
                      WS_3RD_SELN_BTO     =  W3RD_SELN_BTO;                     
                      WS_3RD_SELN_BE_BTO  =  W3RD_SELN_BE_BTO;                  
                    END;                                                        
                                                                                
                                                                                
                    WS_TOTAL_SELN         =  WS_1ST_SELN_BE      +              
                                             WS_1ST_SELN_BTO     +              
                                             WS_2ND_SELN_BE      +              
                                             WS_2ND_SELN_BTO     +              
                                             WS_2ND_SELN_BE_BTO  +              
                                             WS_3RD_SELN_BE      +              
                                             WS_3RD_SELN_BTO     +              
                                             WS_3RD_SELN_BE_BTO;                
                                                                                
   END;                                                                         
                                                                                
   /******************************************************/                     
   /* PRINT DETIAL FOR REPORT1                           */                     
   /******************************************************/                     
    DATA DETAIL1;                                                               
      SET BP13FH13;                                                             
          IF APPLN   = 1 OR                                                     
             STATUS1 = 1 OR                                                     
             STATUS2 = 1 OR                                                     
             STATUS3 = 1 OR                                                     
             STATUS4 = 1;                                                       
                                                                                
          IF STATUS1 = 1 THEN DTL1_CAN_BF = 'Y';                                
          IF STATUS2 = 1 THEN DTL1_INC_BAL = 'Y' ;                              
          IF STATUS3 = 1 THEN DTL1_BF = 'Y';                                    
          IF STATUS4 = 1 THEN DTL1_CAN_AF = 'Y';                                
    RUN;                                                                        
                                                                                
    OPTIONS PAGENO=1 LINESIZE=200 PAGESIZE=32000;                               
    PROC PRINTTO FILE=P13F077A NEW;                                             
    PROC PRINT DATA=DETAIL1 SPLIT='*' N='TOTAL' OBS='OBS*-----';                
     VAR REGN                                                                   
         NEW_TOWN                                                               
         FLAT_TYPE                                                              
         DATE_BALLOT                                                            
         DTL1_CAN_BF                                                            
         DTL1_INC_BAL                                                           
         DTL1_BF                                                                
         DTL1_CAN_AF;                                                           
                                                                                
     LABEL REGN='REGN*--------'                                                 
           NEW_TOWN='NEW*TOWN*----'                                             
           FLAT_TYPE='FLAT*TYPE*----'                                           
           DATE_BALLOT='DATE*BALLOT*------'                                     
           DTL1_CAN_BF='CANCEL*BF BALLOT*---------'                             
           DTL1_INC_BAL='INCLUDED*IN BALLOT*--------'                           
           DTL1_BF='BOOK*FLAT*----'                                             
           DTL1_CAN_AF='CANCEL*AF BALLOT*---------';                            
                                                                                
     TITLE "REPORT ON BOOKING PROFILE (SUBSCRIPTION AND TAKE-UP)";              
    RUN;                                                                        
                                                                                
   /******************************************************/                     
   /* PRINT FLAT SUPPLY, NO. APPLN RECEIVED,             */                     
   /* CANCELLED CASES BEFORE/AFTER & NO. OF FLATS BOOKED */                     
   /* (P13L077A)                                         */                     
   /******************************************************/                     
                                                                                
   OPTIONS MISSING=0 LINESIZE=132 PAGESIZE=60 PAGENO=1;                         
   PROC PRINTTO FILE=P13L077A NEW;                                              
   PROC TABULATE DATA=BP13FH13 MISSING FORMAT=15.;                              
   CLASS NEW_TOWN                                                               
         FLAT_TYPE;                                                             
     VAR FLAT_SUPPLY                                                            
         APPLN                                                                  
         STATUS1                                                                
         STATUS2                                                                
         STATUS3                                                                
         STATUS4;                                                               
                                                                                
   FORMAT FLAT_TYPE         $RMFMT.;                                            
                                                                                
   KEYLABEL N   = " "                                                           
            SUM = " "                                                           
            ALL = "TOTAL";                                                      
                                                                                
   LABEL NEW_TOWN         = 'NEW TOWN';                                         
   LABEL FLAT_TYPE        = 'FLAT TYPE';                                        
   LABEL FLAT_SUPPLY      = 'FLAT SUPPLY';                                      
   LABEL APPLN            = 'NO. OF APPLICATION RECEIVED';                      
   LABEL STATUS1          = 'CANCELLED CASES BEFORE BALLOT';                    
   LABEL STATUS2          = 'NO. OF INCLUDED IN BALLOT';                        
   LABEL STATUS3          = 'NO. OF FLATS BOOKED';                              
   LABEL STATUS4          = 'CANCELLED CASES AFTER BALLOT';                     
                                                                                
   TABLE (NEW_TOWN*(FLAT_TYPE ALL="SUB TOTAL") ALL="TOTAL"),                    
        ((FLAT_SUPPLY APPLN                                                     
          STATUS1     STATUS2                                                   
          STATUS3     STATUS4)*SUM=" ")                                         
         /RTS = 20  MISSTEXT = "0"                                              
          BOX="        ";                                                       
                                                                                
   TITLE1 "P13L077A      HDB3                              SYSTEM OF COMMITMENT 
                      DATE : &DATE  PAGE  :  ";                                 
   TITLE2 "REPORT ON BOOKING PROFILE (SUBSCRIPTION AND TAKE-UP)";               
   TITLE3 "DATE BALLOT &DTE_BALLOT";                                            
                                                                                
   /******************************************************/                     
   /* PRINT DETIAL FOR REPORT2                           */                     
   /******************************************************/                     
    DATA DETAIL2;                                                               
      SET BP13FH13;                                                             
          IF (WS_1ST_SELN_BE      > 0 OR                                        
              WS_1ST_SELN_BTO     > 0 OR                                        
              WS_2ND_SELN_BE      > 0 OR                                        
              WS_2ND_SELN_BTO     > 0 OR                                        
              WS_2ND_SELN_BE_BTO  > 0 OR                                        
              WS_3RD_SELN_BE      > 0 OR                                        
              WS_3RD_SELN_BTO     > 0 OR                                        
              WS_TOTALE           > 0 OR                                        
              WS_3RD_SELN_BE_BTO  > 0 ) AND                                     
               (BALLOT_HOUSEHOLD = 'H' OR                                       
                BALLOT_HOUSEHOLD = 'T') AND                                     
               (BOOK_STAT = 'WF' OR                                             
                BOOK_STAT = 'LF');                                              
                                                                                
          IF WS_1ST_SELN_BE      > 0 THEN DTL2_1ST_SELN_BE      = 'Y';          
          IF WS_1ST_SELN_BTO     > 0 THEN DTL2_1ST_SELN_BTO     = 'Y';          
          IF WS_2ND_SELN_BE      > 0 THEN DTL2_2ND_SELN_BE      = 'Y';          
          IF WS_2ND_SELN_BTO     > 0 THEN DTL2_2ND_SELN_BTO     = 'Y';          
          IF WS_2ND_SELN_BE_BTO  > 0 THEN DTL2_2ND_SELN_BE_BTO  = 'Y';          
          IF WS_3RD_SELN_BE      > 0 THEN DTL2_3RD_SELN_BE      = 'Y';          
          IF WS_3RD_SELN_BTO     > 0 THEN DTL2_3RD_SELN_BTO     = 'Y';          
          IF WS_3RD_SELN_BE_BTO  > 0 THEN DTL2_3RD_SELN_BE_BTO  = 'Y';          
          IF WS_TOTALE           > 0 THEN DTL2_TOTALE           = 'Y';          
    RUN;                                                                        
                                                                                
    OPTIONS PAGENO=1 LINESIZE=200 PAGESIZE=32000;                               
    PROC PRINTTO FILE=P13F077B NEW;                                             
    PROC PRINT DATA=DETAIL2 SPLIT='*' N='TOTAL' OBS='OBS*-----';                
     VAR REGN                                                                   
         NEW_TOWN                                                               
         ZONE                                                                   
         FLAT_TYPE                                                              
         DATE_BALLOT                                                            
         BOOK_STAT                                                              
         DTL2_TOTALE                                                            
         DTL2_1ST_SELN_BE                                                       
         DTL2_1ST_SELN_BTO                                                      
         DTL2_2ND_SELN_BE                                                       
         DTL2_2ND_SELN_BTO                                                      
         DTL2_2ND_SELN_BE_BTO                                                   
         DTL2_3RD_SELN_BE                                                       
         DTL2_3RD_SELN_BTO                                                      
         DTL2_3RD_SELN_BE_BTO ;                                                 
                                                                                
      LABEL REGN               = 'REGN*--------';                               
      LABEL NEW_TOWN           = 'NEW*TOWN*----';                               
      LABEL ZONE               = 'ZONE*-----';                                  
      LABEL FLAT_TYPE          = 'FLAT*TYPE*----';                              
      LABEL DATE_BALLOT        = 'DATE*BALLOT*------';                          
      LABEL BOOK_STAT          = 'BOOK*STATUS*------';                          
      LABEL DTL2_TOTALE        = 'NO*NON-SELN*------';                          
      LABEL DTL2_1ST_SELN_BE   = 'NON-SELN*1ST-REJ*BE*--------';                
      LABEL DTL2_1ST_SELN_BTO  = 'NON-SELN*1ST-REJ*BTO*--------';               
      LABEL DTL2_2ND_SELN_BE   = 'NON-SELN*2ND-REJ*ALL BE*--------';            
      LABEL DTL2_2ND_SELN_BTO  = 'NON-SELN*2ND-REJ*ALL BTO*--------';           
      LABEL DTL2_2ND_SELN_BE_BTO = 'NON-SELN*2ND-REJ*BTO & BE*--------';        
      LABEL DTL2_3RD_SELN_BE   = 'NON-SELN*>= 3RD-REJ*ALL BE*--------';         
      LABEL DTL2_3RD_SELN_BTO  = 'NON-SELN*>= 3RD-REJ*ALL BTO*--------';        
      LABEL DTL2_3RD_SELN_BE_BTO =                                              
                             'NON-SELN*>= 3RD-REJ*BTO & BE*--------';           
                                                                                
     TITLE1 "REPORT ON BOOKING PROFILE (SUBSCRIPTION AND TAKE-UP)";             
     TITLE2 "APPLICANTS INVITED FOR SELECTION";                                 
     TITLE3 "NO. OF APPLICANTS WHO DID NOT BOOK A FLAT ";                       
    RUN;                                                                        
                                                                                
   /***********************************************/                            
   /* PRINT APPLICANTS INVITED FOR SELECTION (FT) */                            
   /* (P13L077B)                                  */                            
   /***********************************************/                            
                                                                                
   OPTIONS MISSING=0 LINESIZE=132 PAGESIZE=60 PAGENO=1;                         
   PROC PRINTTO FILE=P13L077B NEW;                                              
   PROC TABULATE DATA=DETAIL2  MISSING FORMAT=8.;                               
                                                                                
    CLASS NEW_TOWN                                                              
          ZONE                                                                  
          BOOK_STAT                                                             
          FLAT_TYPE;                                                            
      VAR WS_1ST_SELN_BE                                                        
          WS_1ST_SELN_BTO                                                       
          WS_2ND_SELN_BE                                                        
          WS_2ND_SELN_BTO                                                       
          WS_2ND_SELN_BE_BTO                                                    
          WS_3RD_SELN_BE                                                        
          WS_3RD_SELN_BTO                                                       
          WS_3RD_SELN_BE_BTO                                                    
          WS_TOTALA                                                             
          WS_TOTALE                                                             
          WS_TOTAL_SELN ;                                                       
                                                                                
   FORMAT FLAT_TYPE         $RMFMT.;                                            
                                                                                
   KEYLABEL N   = " "                                                           
            SUM = " "                                                           
            ALL = "TOTAL";                                                      
                                                                                
   LABEL NEW_TOWN            = 'NEW TOWN';                                      
   LABEL FLAT_TYPE           = 'FLAT TYPE';                                     
   LABEL BOOK_STAT           = 'BOOK STAT';                                     
   LABEL WS_1ST_SELN_BE      = 'NON-SELN 1ST-REJ BE';                           
   LABEL WS_1ST_SELN_BTO     = 'NON-SELN 1ST-REJ BTO';                          
   LABEL WS_2ND_SELN_BE      = 'NON-SELN 2ND-REJ ALL BE';                       
   LABEL WS_2ND_SELN_BTO     = 'NON-SELN 2ND-REJ ALL BTO';                      
   LABEL WS_2ND_SELN_BE_BTO  = 'NON-SELN 2ND-REJ BTO & BE';                     
   LABEL WS_3RD_SELN_BE      = 'NON-SELN >= 3RD-REJ ALL BE';                    
   LABEL WS_3RD_SELN_BTO     = 'NON-SELN >= 3RD-REJ ALL BTO';                   
   LABEL WS_3RD_SELN_BE_BTO  = 'NON-SELN >= 3RD-REJ BTO & BE';                  
   LABEL WS_TOTAL_SELN       = 'TOTAL NON-SELN';                                
   LABEL WS_TOTALE           = 'NO NON-SELN';                                   
                                                                                
   TABLE (NEW_TOWN*ZONE*(FLAT_TYPE*BOOK_STAT ALL="SUB TOTAL")                   
          ALL ="TOTAL"),                                                        
         ( WS_TOTALE  WS_1ST_SELN_BTO  WS_1ST_SELN_BE                           
           WS_2ND_SELN_BTO  WS_2ND_SELN_BE   WS_2ND_SELN_BE_BTO                 
           WS_3RD_SELN_BTO  WS_3RD_SELN_BE   WS_3RD_SELN_BE_BTO                 
           WS_TOTAL_SELN)                                                       
         /RTS = 20  MISSTEXT = "0"                                              
          BOX="FT      ";                                                       
                                                                                
   TITLE1 "P13L077B      HDB3                              SYSTEM OF COMMITMENT 
                      DATE : &DATE  PAGE  :  ";                                 
   TITLE2 "REPORT ON BOOKING PROFILE (SUBSCRIPTION AND TAKE-UP)";               
   TITLE3 "APPLICANTS INVITED FOR SELECTION";                                   
   TITLE4 "NO. OF APPLICANTS WHO DID NOT BOOK A FLAT";                          
   TITLE5 "DATE BALLOT &DTE_BALLOT";                                            
                                                                                
   /******************************************************/                     
   /* PRINT DETIAL FOR REPORT3                           */                     
   /******************************************************/                     
    DATA DETAIL3;                                                               
      SET BP13FH13;                                                             
          IF WS_ST_BE_ALL  = 1 OR                                               
             WS_ST_BTO_ALL = 1 OR                                               
             WS_ST_BE_BTO  = 1 OR                                               
             WS_ST_CODE2   = 1;                                                 
                                                                                
          IF WS_ST_BE_ALL  = 1 THEN DTL3_ST_BE_ALL  = 'Y';                      
          IF WS_ST_BTO_ALL = 1 THEN DTL3_ST_BTO_ALL = 'Y';                      
          IF WS_ST_BE_BTO  = 1 THEN DTL3_ST_BE_BTO  = 'Y';                      
          IF WS_ST_CODE2   = 1 THEN DTL3_ST_CODE2   = 'Y';                      
    RUN;                                                                        
                                                                                
    OPTIONS PAGENO=1 LINESIZE=200 PAGESIZE=32000;                               
    PROC PRINTTO FILE=P13F077C NEW;                                             
    PROC PRINT DATA=DETAIL3 SPLIT='*' N='TOTAL' OBS='OBS*-----';                
     VAR REGN                                                                   
         NEW_TOWN                                                               
         FLAT_TYPE                                                              
         DATE_BALLOT                                                            
         DTL3_ST_BE_ALL                                                         
         DTL3_ST_BTO_ALL                                                        
         DTL3_ST_BE_BTO                                                         
         DTL3_ST_CODE2;                                                         
                                                                                
     LABEL REGN           = 'REGN*--------';                                    
     LABEL NEW_TOWN       = 'NEW*TOWN*----';                                    
     LABEL FLAT_TYPE      = 'FLAT*TYPE*----';                                   
     LABEL DATE_BALLOT    = 'DATE*BALLOT*------';                               
     LABEL DTL3_ST_BE_ALL                                                       
                 = 'AFFECTED*BY REFINEMENT*ALL BE*-------------';               
     LABEL DTL3_ST_BTO_ALL                                                      
                 = 'AFFECTED*BY REFINEMENT*ALL BTO*-------------';              
     LABEL DTL3_ST_BE_BTO                                                       
                 = 'AFFECTED*BY REFINEMENT*BTO & BE*-------------';             
     LABEL DTL3_ST_CODE2                                                        
                 = 'NOT AFFECTED*BY REFINEMENT*-------------';                  
                                                                                
     TITLE1 "REPORT ON BOOKING PROFILE (SUBSCRIPTION AND TAKE-UP)";             
     TITLE2 "APPLICANTS INVITED FOR SELECTION";                                 
     TITLE3 "NO. OF APPLICANTS WHO DID NOT BOOK A FLAT";                        
    RUN;                                                                        
   /***********************************************/                            
   /* PRINT APPLICANTS INVITED FOR SELECTION (ST) */                            
   /* (P13L077C)                                  */                            
   /***********************************************/                            
                                                                                
   OPTIONS MISSING=0 LINESIZE=132 PAGESIZE=60 PAGENO=1;                         
   PROC PRINTTO FILE=P13L077C NEW;                                              
   PROC TABULATE DATA=BP13FH13 MISSING FORMAT=15.;                              
                                                                                
    CLASS NEW_TOWN                                                              
          FLAT_TYPE;                                                            
      VAR WS_ST_BE_ALL                                                          
          WS_ST_BTO_ALL                                                         
          WS_ST_BE_BTO                                                          
          WS_ST_CODE2                                                           
          WS_TOTALB;                                                            
                                                                                
   FORMAT FLAT_TYPE         $RMFMT.;                                            
                                                                                
   KEYLABEL N   = " "                                                           
            SUM = " "                                                           
            ALL = "TOTAL";                                                      
                                                                                
   LABEL NEW_TOWN         = 'NEW TOWN';                                         
   LABEL FLAT_TYPE        = 'FLAT TYPE';                                        
   LABEL WS_ST_BE_ALL     = 'AFFECTED BY REFINEMENT ALL BE';                    
   LABEL WS_ST_BTO_ALL    = 'AFFECTED BY REFINEMENT ALL BTO';                   
   LABEL WS_ST_BE_BTO     = 'AFFECTED BY REFINEMENT BTO & BE';                  
   LABEL WS_ST_CODE2      = 'NOT AFFECTED BY REFINEMENT';                       
   LABEL WS_TOTALB        = 'TOTAL';                                            
                                                                                
   TABLE (NEW_TOWN*(FLAT_TYPE ALL="SUB TOTAL") ALL ="TOTAL"),                   
         ((WS_ST_BTO_ALL WS_ST_BE_ALL WS_ST_BE_BTO                              
           WS_ST_CODE2                                                          
           WS_TOTALB)*SUM=' ')                                                  
         /RTS = 20  MISSTEXT = "0"                                              
          BOX="ST      ";                                                       
                                                                                
   TITLE1 "P13L077C      HDB3                              SYSTEM OF COMMITMENT 
                      DATE : &DATE  PAGE  :  ";                                 
   TITLE2 "REPORT ON BOOKING PROFILE (SUBSCRIPTION AND TAKE-UP)";               
   TITLE3 "APPLICANTS INVITED FOR SELECTION";                                   
   TITLE4 "NO. OF APPLICANTS WHO DID NOT BOOK A FLAT";                          
   TITLE5 "DATE BALLOT &DTE_BALLOT";                                            
                                                                                
   /******************************************************/                     
   /* PRINT DETIAL FOR REPORT4                           */                     
   /******************************************************/                     
    DATA DETAIL4;                                                               
      SET BP13FH13;                                                             
          IF WS_ZERO_OFFER  = 1 OR                                              
             WS_1ST_OFFER   = 1 OR                                              
             WS_2ND_OFFER   = 1 OR                                              
             WS_3RD_OFFER   = 1 OR                                              
             WS_AFFECTED    = 1 OR                                              
             WS_NT_AFFECTED = 1;                                                
                                                                                
          IF WS_ZERO_OFFER  = 1 THEN DTL4_ZERO_OFFER  = 'Y';                    
          IF WS_1ST_OFFER   = 1 THEN DTL4_1ST_OFFER   = 'Y';                    
          IF WS_2ND_OFFER   = 1 THEN DTL4_2ND_OFFER   = 'Y';                    
          IF WS_3RD_OFFER   = 1 THEN DTL4_3RD_OFFER   = 'Y';                    
          IF WS_AFFECTED    = 1 THEN DTL4_AFFECTED    = 'Y';                    
          IF WS_NT_AFFECTED = 1 THEN DTL4_NT_AFFECTED = 'Y';                    
    RUN;                                                                        
                                                                                
    OPTIONS PAGENO=1 LINESIZE=200 PAGESIZE=32000;                               
    PROC PRINTTO FILE=P13F077D NEW;                                             
    PROC PRINT DATA=DETAIL4 SPLIT='*' N='TOTAL' OBS='OBS*-----';                
     VAR REGN                                                                   
         NEW_TOWN                                                               
         FLAT_TYPE                                                              
         DATE_BALLOT                                                            
         DTL4_ZERO_OFFER                                                        
         DTL4_1ST_OFFER                                                         
         DTL4_2ND_OFFER                                                         
         DTL4_3RD_OFFER                                                         
         DTL4_AFFECTED                                                          
         DTL4_NT_AFFECTED;                                                      
                                                                                
     LABEL REGN             = 'REGN*--------';                                  
     LABEL NEW_TOWN         = 'NEW*TOWN*----';                                  
     LABEL FLAT_TYPE        = 'FLAT*TYPE*---';                                  
     LABEL DATE_BALLOT      = 'DATE*BALLOT*------';                             
     LABEL DTL4_ZERO_OFFER  = '00 *PREV OFFER*----------';                      
     LABEL DTL4_1ST_OFFER   = '1ST*PREV OFFER*----------';                      
     LABEL DTL4_2ND_OFFER   = '2ND*PREV OFFER*----------';                      
     LABEL DTL4_3RD_OFFER   = '3RD OR MORE*PREV OFFER*-----------';             
     LABEL DTL4_AFFECTED    = 'AFFECTED*BY REFINEMENT*-------------';           
     LABEL DTL4_NT_AFFECTED                                                     
                   = 'NOT AFFECTED*BY REFINEMENT*-------------';                
                                                                                
     TITLE1 "REPORT ON BOOKING PROFILE (SUBSCRIPTION AND TAKE-UP)";             
     TITLE2 "APPLICANTS INVITED FOR SELECTION";                                 
     TITLE3 "TABLE A2 - NO. OF APPLICANTS WHO COULD NOT BOOK A FLAT";           
     TITLE4 "              (NC, NF, SF, SC, & NV)                ";             
    RUN;                                                                        
   /*********************************************************/                  
   /* PRINT TABLE A2 - APPLICANTS WHO COULD NOT BOOK A FLAT */                  
   /* (P13L077D)                                            */                  
   /*********************************************************/                  
                                                                                
   OPTIONS MISSING=0 LINESIZE=132 PAGESIZE=60 PAGENO=1;                         
   PROC PRINTTO FILE=P13L077D NEW;                                              
   PROC TABULATE DATA=BP13FH13 MISSING FORMAT=10.;                              
                                                                                
    CLASS NEW_TOWN                                                              
          FLAT_TYPE;                                                            
      VAR FLAT_SUPPLY                                                           
          WS_ZERO_OFFER                                                         
          WS_1ST_OFFER                                                          
          WS_2ND_OFFER                                                          
          WS_3RD_OFFER                                                          
          WS_AFFECTED                                                           
          WS_NT_AFFECTED                                                        
          WS_TOTALC;                                                            
                                                                                
   FORMAT FLAT_TYPE         $RMFMT.;                                            
                                                                                
   KEYLABEL N   = " "                                                           
            SUM = " "                                                           
            ALL = "TOTAL";                                                      
                                                                                
   LABEL NEW_TOWN         = 'NEW TOWN';                                         
   LABEL FLAT_TYPE        = 'FLAT TYPE';                                        
   LABEL FLAT_SUPPLY      = 'FLAT SUPPLY';                                      
   LABEL WS_ZERO_OFFER    = ' 00  PREV OFFER';                                  
   LABEL WS_1ST_OFFER     = ' 1ST PREV OFFER';                                  
   LABEL WS_2ND_OFFER     = ' 2ND PREV OFFER';                                  
   LABEL WS_3RD_OFFER     = ' 3RD OR MORE PREV OFFER';                          
   LABEL WS_AFFECTED      = ' AFFECTED BY REFINEMENT';                          
   LABEL WS_NT_AFFECTED   = ' NOT AFFECTED BY REFINEMENT';                      
   LABEL WS_TOTALC        = 'TOTAL';                                            
                                                                                
   TABLE (NEW_TOWN*(FLAT_TYPE ALL="SUB TOTAL") ALL ="TOTAL"),                   
        ((FLAT_SUPPLY WS_ZERO_OFFER WS_1ST_OFFER WS_2ND_OFFER                   
          WS_3RD_OFFER WS_AFFECTED  WS_NT_AFFECTED                              
          WS_TOTALC)*SUM=' ')                                                   
         /RTS = 20  MISSTEXT = "0"                                              
          BOX="        ";                                                       
                                                                                
   TITLE1 "P13L077D      HDB3                              SYSTEM OF COMMITMENT 
                      DATE : &DATE  PAGE  :  ";                                 
   TITLE2 "REPORT ON BOOKING PROFILE (SUBSCRIPTION AND TAKE-UP)";               
   TITLE3 "APPLICANTS INVITED FOR SELECTION";                                   
   TITLE4 "TABLE A2 - NO. OF APPLICANTS WHO COULD NOT BOOK A FLAT";             
   TITLE5 "              (NC, NF, SF, SC, & NV)                ";               
   TITLE6 "DATE BALLOT &DTE_BALLOT";                                            
   /******************************************************/                     
   /* PRINT DETIAL FOR REPORT5                           */                     
   /******************************************************/                     
    DATA DETAIL5;                                                               
      SET BP13FH13;                                                             
          IF (WS_1ST_SELN_BE      > 0 OR                                        
              WS_1ST_SELN_BTO     > 0 OR                                        
              WS_2ND_SELN_BE      > 0 OR                                        
              WS_2ND_SELN_BTO     > 0 OR                                        
              WS_2ND_SELN_BE_BTO  > 0 OR                                        
              WS_3RD_SELN_BE      > 0 OR                                        
              WS_3RD_SELN_BTO     > 0 OR                                        
              WS_TOTALE           > 0 OR                                        
              WS_3RD_SELN_BE_BTO  > 0)                                          
              AND (BALLOT_HOUSEHOLD = 'G') AND                                  
               (BOOK_STAT = 'WS' OR                                             
                BOOK_STAT = 'LS');                                              
                                                                                
          IF WS_1ST_SELN_BE      >0 THEN DTL2_1ST_SELN_BE      = 'Y';           
          IF WS_1ST_SELN_BTO     >0 THEN DTL2_1ST_SELN_BTO     = 'Y';           
          IF WS_2ND_SELN_BE      >0 THEN DTL2_2ND_SELN_BE      = 'Y';           
          IF WS_2ND_SELN_BTO     >0 THEN DTL2_2ND_SELN_BTO     = 'Y';           
          IF WS_2ND_SELN_BE_BTO  >0 THEN DTL2_2ND_SELN_BE_BTO  = 'Y';           
          IF WS_3RD_SELN_BE      >0 THEN DTL2_3RD_SELN_BE      = 'Y';           
          IF WS_3RD_SELN_BTO     >0 THEN DTL2_3RD_SELN_BTO     = 'Y';           
          IF WS_3RD_SELN_BE_BTO  >0 THEN DTL2_3RD_SELN_BE_BTO  = 'Y';           
          IF WS_TOTALE           >0 THEN DTL2_TOTALE           = 'Y';           
    RUN;                                                                        
                                                                                
    OPTIONS PAGENO=1 LINESIZE=200 PAGESIZE=32000;                               
    PROC PRINTTO FILE=P13F077E NEW;                                             
    PROC PRINT DATA=DETAIL5 SPLIT='*' N='TOTAL' OBS='OBS*-----';                
     VAR REGN                                                                   
         NEW_TOWN                                                               
         ZONE                                                                   
         FLAT_TYPE                                                              
         DATE_BALLOT                                                            
         BOOK_STAT                                                              
         DTL2_TOTALE                                                            
         DTL2_1ST_SELN_BE                                                       
         DTL2_1ST_SELN_BTO                                                      
         DTL2_2ND_SELN_BE                                                       
         DTL2_2ND_SELN_BTO                                                      
         DTL2_2ND_SELN_BE_BTO                                                   
         DTL2_3RD_SELN_BE                                                       
         DTL2_3RD_SELN_BTO                                                      
         DTL2_3RD_SELN_BE_BTO;                                                  
                                                                                
      LABEL REGN               = 'REGN*--------';                               
      LABEL NEW_TOWN           = 'NEW*TOWN*----';                               
      LABEL ZONE               = 'ZONE*-----';                                  
      LABEL FLAT_TYPE          = 'FLAT*TYPE*----';                              
      LABEL DATE_BALLOT        = 'DATE*BALLOT*------';                          
      LABEL BOOK_STAT          = 'BOOK*STATUS*------';                          
      LABEL DTL2_TOTALE         = 'NO*NON-SELN*------';                         
      LABEL DTL2_1ST_SELN_BE   = 'NON-SELN*1ST-REJ*BE*--------';                
      LABEL DTL2_1ST_SELN_BTO  = 'NON-SELN*1ST-REJ*BTO*--------';               
      LABEL DTL2_2ND_SELN_BE   = 'NON-SELN*2ND-REJ*ALL BE*--------';            
      LABEL DTL2_2ND_SELN_BTO  = 'NON-SELN*2ND-REJ*ALL BTO*--------';           
      LABEL DTL2_2ND_SELN_BE_BTO = 'NON-SELN*2ND-REJ*BTO & BE*--------';        
      LABEL DTL2_3RD_SELN_BE   = 'NON-SELN*>= 3RD-REJ*ALL BE*--------';         
      LABEL DTL2_3RD_SELN_BTO  = 'NON-SELN*>= 3RD-REJ*ALL BTO*--------';        
      LABEL DTL2_3RD_SELN_BE_BTO =                                              
                             'NON-SELN*>= 3RD-REJ*BTO & BE*--------';           
                                                                                
     TITLE1 "REPORT ON BOOKING PROFILE (SUBSCRIPTION AND TAKE-UP)";             
     TITLE2 "APPLICANTS INVITED FOR SELECTION";                                 
     TITLE3 "NO. OF APPLICANTS WHO DID NOT BOOK A FLAT";                        
    RUN;                                                                        
                                                                                
   /***********************************************/                            
   /* PRINT APPLICANTS INVITED FOR SELECTION (FT) */                            
   /* (P13L077B)                                  */                            
   /***********************************************/                            
                                                                                
   OPTIONS MISSING=0 LINESIZE=132 PAGESIZE=60 PAGENO=1;                         
   PROC PRINTTO FILE=P13L077E NEW;                                              
   PROC TABULATE DATA=DETAIL5  MISSING FORMAT=8.;                               
                                                                                
    CLASS NEW_TOWN                                                              
          ZONE                                                                  
          BOOK_STAT                                                             
          FLAT_TYPE;                                                            
      VAR WS_1ST_SELN_BE                                                        
          WS_1ST_SELN_BTO                                                       
          WS_2ND_SELN_BE                                                        
          WS_2ND_SELN_BTO                                                       
          WS_2ND_SELN_BE_BTO                                                    
          WS_3RD_SELN_BE                                                        
          WS_3RD_SELN_BTO                                                       
          WS_3RD_SELN_BE_BTO                                                    
          WS_TOTALA                                                             
          WS_TOTALE                                                             
          WS_TOTAL_SELN ;                                                       
                                                                                
   FORMAT FLAT_TYPE         $RMFMT.;                                            
                                                                                
   KEYLABEL N   = " "                                                           
            SUM = " "                                                           
            ALL = "TOTAL";                                                      
                                                                                
   LABEL NEW_TOWN            = 'NEW TOWN';                                      
   LABEL FLAT_TYPE           = 'FLAT TYPE';                                     
   LABEL BOOK_STAT           = 'BOOK STAT';                                     
   LABEL WS_1ST_SELN_BE      = 'NON-SELN 1ST-REJ BE';                           
   LABEL WS_1ST_SELN_BTO     = 'NON-SELN 1ST-REJ BTO';                          
   LABEL WS_2ND_SELN_BE      = 'NON-SELN 2ND-REJ ALL BE';                       
   LABEL WS_2ND_SELN_BTO     = 'NON-SELN 2ND-REJ ALL BTO';                      
   LABEL WS_2ND_SELN_BE_BTO  = 'NON-SELN 2ND-REJ BTO & BE';                     
   LABEL WS_3RD_SELN_BE      = 'NON-SELN >= 3RD-REJ ALL BE';                    
   LABEL WS_3RD_SELN_BTO     = 'NON-SELN >= 3RD-REJ ALL BTO';                   
   LABEL WS_3RD_SELN_BE_BTO  = 'NON-SELN >= 3RD-REJ BTO & BE';                  
   LABEL WS_TOTAL_SELN       = 'TOTAL NON-SELN';                                
   LABEL WS_TOTALE           = 'NO NON-SELN';                                   
                                                                                
   TABLE (NEW_TOWN*ZONE*(FLAT_TYPE*BOOK_STAT ALL="SUB TOTAL")                   
          ALL ="TOTAL"),                                                        
         ( WS_TOTALE  WS_1ST_SELN_BTO  WS_1ST_SELN_BE                           
           WS_2ND_SELN_BTO  WS_2ND_SELN_BE   WS_2ND_SELN_BE_BTO                 
           WS_3RD_SELN_BTO  WS_3RD_SELN_BE   WS_3RD_SELN_BE_BTO                 
           WS_TOTAL_SELN)                                                       
         /RTS = 20  MISSTEXT = "0"                                              
          BOX="FT      ";                                                       
                                                                                
   TITLE1 "P13L077E      HDB3                              SYSTEM OF COMMITMENT 
                      DATE : &DATE  PAGE  :  ";                                 
   TITLE2 "REPORT ON BOOKING PROFILE (SUBSCRIPTION AND TAKE-UP)";               
   TITLE3 "APPLICANTS INVITED FOR SELECTION";                                   
   TITLE4 "NO. OF APPLICANTS WHO DID NOT BOOK A FLAT WITH G";                   
   TITLE5 "DATE BALLOT &DTE_BALLOT";                                            
                                                                                
