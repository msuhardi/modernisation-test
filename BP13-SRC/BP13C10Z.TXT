       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.   BP13C10Z.                                                  
       AUTHOR.       AM25.                                                      
       DATE-WRITTEN. 03/03/2022.                                                
      *****************************************************************         
      *                SOC - SYSTEM OF COMMITMENT (BP13)              *         
      *===============================================================*         
      *  OBJECTIVES :                                                 *         
      *     - TO STORE THE DETAILS OF FLAT_RQST CONFIRMED BY SALES    *         
      *       AFTER ELIGIBILITY CHECKING THAT WILL BE COMMUNICATED TO *         
      *       THE FLAT APPLICANT IN FLAT_RQST_CNFRM TABLE.            *         
      *===============================================================*         
      * FILES DESCRIPTION :-                                          *         
      *                                                               *         
      *                ACCESS     REC                                 *         
      * DD NAME  I/O/E MODE       LEN  KEY FIELDS    REMARKS          *         
      * -------- ----- ---------- ---- ------------- ---------------- *         
      * BP13F730 I     SEQUENTIAL 500                                 *         
      * BP13K730 I     RANDOM     500  K730-KEY-NEW                   *         
      * BP13K757 I     RANDOM     3000 K757-KEY-FLD                   *         
      * BP13K813 I     RANDOM     1000 K813-KEY-FLD                   *         
      * P13L10ZA O                                   INSERTED RPT     *         
      * P13L10ZB O                                   EXCEPTION RPT    *         
      * P13L10ZC O                                   UPDATED RPT      *         
      * P13FLRCN O                                   FLAT_RQST_CNFRM  *         
      *===============================================================*         
      * REVISION HISTORY :                                            *         
      *                                                               *         
      * CHG-REQ#  DDMMYYYY   BY   DESCRIPTION                         *         
      * --------  --------  ----  ----------------------------------- *         
      * BP138342  03032022  AM25  NEW PROGRAM                         *         
      * BP139576  20072023  AM25  REMOVE UPDATING OF FLAT_RQST_CNFRM  *         
      * BP139755  25082023  AM25  CATER FOR FT(PMC)                   *         
      * BP139280  06112023  eaa2  expand bp13k757 from 3000 to 4000   *         
      * BP139901  11022024  MRR5  CATER FOR NUM-CCA 'R'               *         
      *****************************************************************         
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F730 ASSIGN      TO BP13F730.                             
                                                                                
           SELECT BP13K730 ASSIGN      TO BP13K730                              
              ORGANIZATION  IS INDEXED                                          
              ACCESS MODE   IS RANDOM                                           
              RECORD KEY    IS K730-KEY-NEW                                     
              FILE STATUS   IS WS-K730-STATUS.                                  
                                                                                
           SELECT BP13K757 ASSIGN      TO BP13K757                              
              ORGANIZATION  IS INDEXED                                          
              ACCESS MODE   IS RANDOM                                           
              RECORD KEY    IS K757-KEY-FLD                                     
              FILE STATUS   IS WS-K757-STATUS.                                  
                                                                                
           SELECT BP13K813 ASSIGN      TO BP13K813                              
              ORGANIZATION  IS INDEXED                                          
              ACCESS MODE   IS RANDOM                                           
              RECORD KEY    IS K813-KEY-FLD                                     
              FILE STATUS   IS WS-K813-STATUS.                                  
                                                                                
           SELECT P13L10ZA ASSIGN      TO P13L10ZA.                             
           SELECT P13L10ZB ASSIGN      TO P13L10ZB.                             
           SELECT P13L10ZC ASSIGN      TO P13L10ZC.                             
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  BP13F730                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 500 CHARACTERS                                       
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F.                                                 
       COPY BP13F730.                                                           
                                                                                
       FD  BP13K730                                                             
           RECORD CONTAINS 500 CHARACTERS.                                      
       COPY BP13K730.                                                           
                                                                                
       FD  BP13K757                                                             
           RECORD CONTAINS 4000 CHARACTERS.                                     
       COPY BP13K757.                                                           
                                                                                
       FD  BP13K813                                                             
           RECORD CONTAINS 1000 CHARACTERS.                                     
       COPY BP13K813.                                                           
                                                                                
       FD  P13L10ZA                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       01  P13L10ZA-REC                PIC X(132).                              
                                                                                
       FD  P13L10ZB                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       01  P13L10ZB-REC                PIC X(132).                              
                                                                                
       FD  P13L10ZC                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING MODE IS F.                                                 
       01  P13L10ZC-REC                PIC X(132).                              
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-K730-STATUS          PIC 9(2)        VALUE ZEROES.            
           05  WS-K757-STATUS          PIC 9(2)        VALUE ZEROES.            
           05  WS-K813-STATUS          PIC 9(2)        VALUE ZEROES.            
           05  WS-SYS-DTE-TME.                                                  
               10 WS-SYS-DATE          PIC 9(8)        VALUE ZEROES.            
               10 WS-SYS-TIME          PIC 9(8)        VALUE ZEROES.            
           05  WS-DTE-BAL-MTH-9        PIC X(9)        VALUE SPACES.            
           05  WS-SQLCODE              PIC -9(3)       VALUE ZEROES.            
           05  WS-PARM-JOBNAME         PIC X(8)        VALUE SPACES.            
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-F730-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-K730-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-K757-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-K813-READ            PIC 9(6)        VALUE ZEROES.            
           05  WS-FLRCN-WRITE          PIC 9(6)        VALUE ZEROES.            
           05  WS-L10ZA-WRITE          PIC 9(6)        VALUE ZEROES.            
           05  WS-L10ZB-WRITE          PIC 9(6)        VALUE ZEROES.            
           05  WS-L10ZC-WRITE          PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13XY-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13Y1-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13BD-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13YT-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13XT-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13YM-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13AI-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13AS-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP1377-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13YX-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13XQ-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13YR-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP1374-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP1376-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP137I-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13YW-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13XS-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13YQ-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP137F-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP137H-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13BC-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13YS-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13XK-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13YL-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13AH-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13AM-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13BE-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13YU-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13XM-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13YO-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13AQ-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13AT-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13EB-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13YV-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13XO-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13YP-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13AR-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13EA-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13BQ-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP135P-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13ES-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13EU-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13EW-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP135J-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13P1-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13J1-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13B1-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-BP13G1-CNT           PIC 9(6)        VALUE ZEROES.            
           05  WS-L10ZA-CNT            PIC 9(5)        VALUE ZEROES.            
           05  WS-L10ZA-PAGE-CNT       PIC 9(4)        VALUE ZEROES.            
           05  WS-L10ZA-LINE-CNT       PIC 9(2)        VALUE 60.                
           05  WS-L10ZB-CNT            PIC 9(5)        VALUE ZEROES.            
           05  WS-L10ZB-PAGE-CNT       PIC 9(4)        VALUE ZEROES.            
           05  WS-L10ZB-LINE-CNT       PIC 9(2)        VALUE 60.                
           05  WS-L10ZC-CNT            PIC 9(5)        VALUE ZEROES.            
           05  WS-L10ZC-PAGE-CNT       PIC 9(4)        VALUE ZEROES.            
           05  WS-L10ZC-LINE-CNT       PIC 9(2)        VALUE 60.                
                                                                                
       01  WS-SWITCHES-FLAGS.                                                   
           05  WS-F730-EOF             PIC X           VALUE 'N'.               
           05  WS-INSERTED             PIC X           VALUE 'N'.               
                                                                                
       01  WS-MONTHS-IN-DIGITS-AND-WORDS.                                       
           05  FILLER                  PIC X(12)       VALUE                    
               '01 January  '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '02 February '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '03 March    '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '04 April    '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '05 May      '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '06 June     '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '07 July     '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '08 August   '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '09 September'.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '10 October  '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '11 November '.                                                  
           05  FILLER                  PIC X(12)       VALUE                    
               '12 December '.                                                  
       01  FILLER REDEFINES WS-MONTHS-IN-DIGITS-AND-WORDS.                      
           05  WS-MONTH-TABLE OCCURS 12 INDEXED BY WS-MTH-IND.                  
               10  WS-MONTH-IN-DIGITS  PIC X(2).                                
               10  FILLER              PIC X(1).                                
               10  WS-MONTH-IN-WORDS   PIC X(9).                                
                                                                                
      *------------------------------------------------------------*            
      *    REPORT LAYOUT FOR P13L10ZA                              *            
      *------------------------------------------------------------*            
       01  L10ZA-HDR1.                                                          
           05  FILLER                  PIC X(9)        VALUE                    
               'P13L10ZA_'.                                                     
           05  L10ZA-PARM              PIC X(4)        VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(4)        VALUE 'HDB3'.            
           05  FILLER                  PIC X(22)       VALUE SPACES.            
           05  FILLER                  PIC X(39)       VALUE                    
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                  PIC X(18)       VALUE SPACES.            
           05  FILLER                  PIC X(6)        VALUE 'DATE: '.          
           05  L10ZA-DATE              PIC X(10)       VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE ' PAGE: '.         
           05  L10ZA-PAGE              PIC Z,ZZ9.                               
           05  FILLER                  PIC X(7)        VALUE SPACES.            
                                                                                
       01  L10ZA-HDR2.                                                          
           05  FILLER                  PIC X(41)       VALUE SPACES.            
           05  FILLER                  PIC X(49)       VALUE                    
               'REPORT SUMMARY OF CONFIRMATION RECORDS - INSERTED'.             
           05  FILLER                  PIC X(42)       VALUE SPACES.            
                                                                                
       01  L10ZA-HDR3.                                                          
           05  FILLER                  PIC X(5)        VALUE '  S/N'.           
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(6)        VALUE 'REG-NO'.          
           05  FILLER                  PIC X(5)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE 'NT1'.             
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(2)        VALUE 'FT'.              
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(10)       VALUE                    
               'CNFRM-TYPE'.                                                    
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE 'INTRRCL'.         
           05  FILLER                  PIC X(82)       VALUE SPACES.            
                                                                                
       01  L10ZA-DTL1.                                                          
           05  L10ZA-SNO               PIC ZZZZ9.                               
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L10ZA-REG-NO            PIC X(8)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L10ZA-NT1               PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L10ZA-FLAT              PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L10ZA-CNFRM             PIC X(6)        VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE SPACES.            
           05  L10ZA-INTRRCL           PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(88)       VALUE SPACES.            
                                                                                
       01  L10ZA-BLANK.                                                         
           05  FILLER                  PIC X(132)      VALUE SPACES.            
                                                                                
      *------------------------------------------------------------*            
      *    REPORT LAYOUT FOR P13L10ZB                              *            
      *------------------------------------------------------------*            
       01  L10ZB-HDR1.                                                          
           05  FILLER                  PIC X(9)        VALUE                    
               'P13L10ZB_'.                                                     
           05  L10ZB-PARM              PIC X(4)        VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(4)        VALUE 'HDB3'.            
           05  FILLER                  PIC X(22)       VALUE SPACES.            
           05  FILLER                  PIC X(39)       VALUE                    
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                  PIC X(18)       VALUE SPACES.            
           05  FILLER                  PIC X(6)        VALUE 'DATE: '.          
           05  L10ZB-DATE              PIC X(10)       VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE ' PAGE: '.         
           05  L10ZB-PAGE              PIC Z,ZZ9.                               
           05  FILLER                  PIC X(7)        VALUE SPACES.            
                                                                                
       01  L10ZB-HDR2.                                                          
           05  FILLER                  PIC X(41)       VALUE SPACES.            
           05  FILLER                  PIC X(50)       VALUE                    
               'REPORT SUMMARY OF CONFIRMATION RECORDS - EXCEPTION'.            
           05  FILLER                  PIC X(41)       VALUE SPACES.            
                                                                                
       01  L10ZB-HDR3.                                                          
           05  FILLER                  PIC X(5)        VALUE '  S/N'.           
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(6)        VALUE 'REG-NO'.          
           05  FILLER                  PIC X(5)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE 'NT1'.             
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(2)        VALUE 'FT'.              
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE 'REMARKS'.         
           05  FILLER                  PIC X(95)       VALUE SPACES.            
                                                                                
       01  L10ZB-DTL1.                                                          
           05  L10ZB-SNO               PIC ZZZZ9.                               
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L10ZB-REG-NO            PIC X(8)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L10ZB-NT1               PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L10ZB-FLAT              PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L10ZB-REMARKS           PIC X(50)       VALUE SPACES.            
           05  FILLER                  PIC X(52)       VALUE SPACES.            
                                                                                
       01  L10ZB-BLANK.                                                         
           05  FILLER                  PIC X(132)      VALUE SPACES.            
                                                                                
      *------------------------------------------------------------*            
      *    REPORT LAYOUT FOR P13L10ZC                              *            
      *------------------------------------------------------------*            
       01  L10ZC-HDR1.                                                          
           05  FILLER                  PIC X(9)        VALUE                    
               'P13L10ZC_'.                                                     
           05  L10ZC-PARM              PIC X(4)        VALUE SPACES.            
           05  FILLER                  PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(4)        VALUE 'HDB3'.            
           05  FILLER                  PIC X(22)       VALUE SPACES.            
           05  FILLER                  PIC X(39)       VALUE                    
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                  PIC X(18)       VALUE SPACES.            
           05  FILLER                  PIC X(6)        VALUE 'DATE: '.          
           05  L10ZC-DATE              PIC X(10)       VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE ' PAGE: '.         
           05  L10ZC-PAGE              PIC Z,ZZ9.                               
           05  FILLER                  PIC X(7)        VALUE SPACES.            
                                                                                
       01  L10ZC-HDR2.                                                          
           05  FILLER                  PIC X(41)       VALUE SPACES.            
           05  FILLER                  PIC X(48)       VALUE                    
               'REPORT SUMMARY OF CONFIRMATION RECORDS - UPDATED'.              
           05  FILLER                  PIC X(43)       VALUE SPACES.            
                                                                                
       01  L10ZC-HDR3.                                                          
           05  FILLER                  PIC X(5)        VALUE '  S/N'.           
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(6)        VALUE 'REG-NO'.          
           05  FILLER                  PIC X(5)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE 'NT1'.             
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(2)        VALUE 'FT'.              
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(10)       VALUE                    
               'CNFRM-TYPE'.                                                    
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE 'INTRRCL'.         
           05  FILLER                  PIC X(82)       VALUE SPACES.            
                                                                                
       01  L10ZC-DTL1.                                                          
           05  L10ZC-SNO               PIC ZZZZ9.                               
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L10ZC-REG-NO            PIC X(8)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L10ZC-NT1               PIC X(3)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L10ZC-FLAT              PIC X(2)        VALUE SPACES.            
           05  FILLER                  PIC X(3)        VALUE SPACES.            
           05  L10ZC-CNFRM             PIC X(6)        VALUE SPACES.            
           05  FILLER                  PIC X(7)        VALUE SPACES.            
           05  L10ZC-INTRRCL           PIC X(1)        VALUE SPACES.            
           05  FILLER                  PIC X(88)       VALUE SPACES.            
                                                                                
       01  L10ZC-BLANK.                                                         
           05  FILLER                  PIC X(132)      VALUE SPACES.            
                                                                                
           EXEC SQL INCLUDE SQLCA    END-EXEC.                                  
           EXEC SQL INCLUDE P13FLRCN END-EXEC.                                  
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
      *****************************************************************         
       0000-CONTROL.                                                            
      *****************************************************************         
                                                                                
           ACCEPT WS-PARM-JOBNAME.                                              
                                                                                
           PERFORM 1000-OPEN-FILES       THRU 1000-EXIT.                        
           PERFORM 2000-READ-BP13F730    THRU 2000-EXIT.                        
           PERFORM 3000-MAIN-PROCESSING  THRU 3000-EXIT                         
              UNTIL WS-F730-EOF = 'Y'.                                          
           PERFORM 9000-CLOSE-FILES      THRU 9000-EXIT.                        
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       1000-OPEN-FILES.                                                         
      *****************************************************************         
                                                                                
           OPEN INPUT  BP13F730                                                 
                       BP13K730                                                 
                       BP13K757                                                 
                       BP13K813                                                 
                OUTPUT P13L10ZA                                                 
                       P13L10ZB                                                 
                       P13L10ZC.                                                
                                                                                
           IF (WS-K730-STATUS NOT = ZEROES AND 97)                              
              DISPLAY 'OPEN BP13K730 FAIL STATUS=' WS-K730-STATUS               
              MOVE WS-K730-STATUS      TO RETURN-CODE                           
              GO TO 9000-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF (WS-K757-STATUS NOT = ZEROES AND 97)                              
              DISPLAY 'OPEN BP13K757 FAIL STATUS=' WS-K757-STATUS               
              MOVE WS-K757-STATUS      TO RETURN-CODE                           
              GO TO 9000-EXIT                                                   
           END-IF.                                                              
                                                                                
           IF (WS-K813-STATUS NOT = ZEROES AND 97)                              
              DISPLAY 'OPEN BP13K813 FAIL STATUS=' WS-K813-STATUS               
              MOVE WS-K813-STATUS      TO RETURN-CODE                           
              GO TO 9000-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE WS-PARM-JOBNAME(5:4)   TO L10ZA-PARM                            
                                          L10ZB-PARM                            
                                          L10ZC-PARM.                           
           MOVE FUNCTION CURRENT-DATE  TO WS-SYS-DTE-TME.                       
                                                                                
           STRING WS-SYS-DATE(7:2) '/'                                          
                  WS-SYS-DATE(5:2) '/'                                          
                  WS-SYS-DATE(1:4)                                              
              DELIMITED BY SIZE INTO L10ZA-DATE.                                
                                                                                
           MOVE L10ZA-DATE             TO L10ZB-DATE                            
                                          L10ZC-DATE.                           
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       2000-READ-BP13F730.                                                      
      *****************************************************************         
                                                                                
           READ BP13F730                                                        
              AT END                                                            
                 MOVE 'Y'              TO WS-F730-EOF                           
              NOT AT END                                                        
                 ADD 1                 TO WS-F730-READ                          
           END-READ.                                                            
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       3000-MAIN-PROCESSING.                                                    
      *****************************************************************         
                                                                                
           MOVE 'N'                    TO WS-INSERTED.                          
           MOVE SPACES                 TO L10ZB-REMARKS.                        
                                                                                
           IF F730-DTE-BALLOT = SPACES OR LOW-VALUES                            
              MOVE 'DATE BALLOT IS BLANK'                                       
                                       TO L10ZB-REMARKS                         
              MOVE SPACES              TO K730-CDE-NT1                          
                                          K730-CDE-FLAT-TYPE                    
           ELSE                                                                 
              PERFORM 3100-READ-BP13K730 THRU 3100-EXIT                         
                                                                                
              IF WS-K730-STATUS = 00                                            
                 PERFORM 3200-PROCESS-LETTERS THRU 3200-EXIT                    
                                                                                
                 IF L10ZB-REMARKS = SPACES OR LOW-VALUES                        
                    PERFORM 3300-WRITE-P13FLRCN THRU 3300-EXIT                  
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF L10ZB-REMARKS = SPACES OR LOW-VALUES                              
              IF WS-INSERTED = 'Y'                                              
                 PERFORM 8500-PRINT-REPORT-L10ZA THRU 8500-EXIT                 
              ELSE                                                              
                 PERFORM 8700-PRINT-REPORT-L10ZC THRU 8700-EXIT                 
              END-IF                                                            
           ELSE                                                                 
              PERFORM 8600-PRINT-REPORT-L10ZB THRU 8600-EXIT                    
           END-IF.                                                              
                                                                                
           PERFORM 2000-READ-BP13F730 THRU 2000-EXIT.                           
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       3100-READ-BP13K730.                                                      
      *****************************************************************         
                                                                                
           MOVE SPACES                 TO BP13K730-REC.                         
           INITIALIZE BP13K730-REC.                                             
                                                                                
           MOVE F730-NUM-REGN          TO K730-NUM-REGN.                        
                                                                                
           READ BP13K730.                                                       
                                                                                
           EVALUATE WS-K730-STATUS                                              
              WHEN 00                                                           
                 ADD 1                 TO WS-K730-READ                          
              WHEN 23                                                           
                 DISPLAY 'REC NOT FOUND IN BP13K730: ' F730-NUM-REGN            
                 MOVE 'REC NOT FOUND IN BP13K730'                               
                                       TO L10ZB-REMARKS                         
              WHEN OTHER                                                        
                 DISPLAY 'READ BP13K730 FAIL STATUS=' WS-K730-STATUS            
                 EXEC SQL ROLLBACK END-EXEC                                     
                 MOVE WS-K730-STATUS   TO RETURN-CODE                           
                 PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       3200-PROCESS-LETTERS.                                                    
      *****************************************************************         
                                                                                
           PERFORM 4000-PROCESS-P13FLRCN THRU 4000-EXIT.                        
                                                                                
           EVALUATE TRUE                                                        
              WHEN (K730-NUM-ELDERLY = 'F' OR 'S') AND                          
                    K730-CDE-FLAT-TYPE(1:1) = '2'                               
                 PERFORM 5000-PROCESS-CFMLTR-2F THRU 5000-EXIT                  
                                                                                
              WHEN  K730-CDE-FLAT-TYPE = '1F'                                   
                 PERFORM 6000-PROCESS-CFMLTR-CCA THRU 6000-EXIT                 
                                                                                
              WHEN OTHER                                                        
                 PERFORM 7000-PROCESS-CFMLTR THRU 7000-EXIT                     
                                                                                
           END-EVALUATE.                                                        
                                                                                
           EVALUATE TRUE                                                        
              WHEN (NUM-CNFRM = 'BP13ES' OR 'BP135P' OR 'BP13EU' OR             
                                'BP13EW' OR 'BP135J' OR 'BP13BQ' OR             
                                'BP13B1' OR 'BP13P1' OR 'BP13J1' OR             
                                'BP13G1')                                       
                 MOVE '02'             TO NUM-DSPLY                             
                                                                                
              WHEN (NUM-CNFRM = 'BP13Y1')                                       
                 MOVE '03'             TO NUM-DSPLY                             
                                                                                
              WHEN OTHER                                                        
                 MOVE '01'             TO NUM-DSPLY                             
                                                                                
           END-EVALUATE.                                                        
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       3300-WRITE-P13FLRCN.                                                     
      *****************************************************************         
                                                                                
           EXEC SQL                                                             
              INSERT INTO FLAT_RQST_CNFRM                                       
                 (NUM_RGSTRN                                                    
                 ,NUM_CNFRM                                                     
                 ,NME_ALCTN_CTGRY                                               
                 ,TXT_BALLOT_QRTR                                               
                 ,NME_SALES_ZONE                                                
                 ,NME_SALES_FLAT_TYPE                                           
                 ,NME_HSHLD_TYPE_BALLOT                                         
                 ,NUM_HSHLD_TYPE_BALLOT                                         
                 ,QTY_BALLOT_CHANCE                                             
                 ,TXT_ESTMT_PERIOD_BALLOT_RESULT                                
                 ,NME_HSHLD_ETHNIC_GROUP                                        
                 ,NME_HSHLD_ETHNIC_GROUP_PREFER                                 
                 ,DTE_RLGTN_START                                               
                 ,NUM_UPDATE_USERID                                             
                 ,TME_UPDATE                                                    
                 ,NUM_DSPLY                                                     
                 ,NUM_FTPMC)                                                    
              VALUES                                                            
                 (:NUM-RGSTRN                                                   
                 ,:NUM-CNFRM                                                    
                 ,:NME-ALCTN-CTGRY                                              
                 ,:TXT-BALLOT-QRTR                                              
                 ,:NME-SALES-ZONE                                               
                 ,:NME-SALES-FLAT-TYPE                                          
                 ,:NME-HSHLD-TYPE-BALLOT                                        
                 ,:NUM-HSHLD-TYPE-BALLOT                                        
                 ,:QTY-BALLOT-CHANCE                                            
                 ,:TXT-ESTMT-PERIOD-BALLOT-RESULT                               
                 ,:NME-HSHLD-ETHNIC-GROUP                                       
                 ,:NME-HSHLD-ETHNIC-GROUP-PREFER                                
                 ,:DTE-RLGTN-START                                              
                 ,:NUM-UPDATE-USERID                                            
                 ,CURRENT TIMESTAMP                                             
                 ,:NUM-DSPLY                                                    
                 ,:NUM-FTPMC)                                                   
           END-EXEC.                                                            
                                                                                
           EVALUATE SQLCODE                                                     
              WHEN +000                                                         
                 ADD 1                 TO WS-FLRCN-WRITE                        
                 MOVE 'Y'              TO WS-INSERTED                           
              WHEN -803                                                         
                 DISPLAY 'REC ALREADY EXISTS IN FLAT_RQST_CNFRM '               
                         'TABLE: ' K730-NUM-REGN                                
                 MOVE 'REC ALREADY EXISTS IN FLAT_RQST_CNFRM TABLE'             
                                       TO L10ZB-REMARKS                         
              WHEN OTHER                                                        
                 MOVE SQLCODE          TO WS-SQLCODE                            
                 DISPLAY 'INSERT ERROR P13FLRCN: ' WS-SQLCODE                   
                         ' - REGN=' K730-NUM-REGN                               
                 EXEC SQL ROLLBACK END-EXEC                                     
                 MOVE 99               TO RETURN-CODE                           
                 PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4000-PROCESS-P13FLRCN.                                                   
      *****************************************************************         
                                                                                
           MOVE SPACES                 TO DCLFLAT-RQST-CNFRM.                   
           INITIALIZE DCLFLAT-RQST-CNFRM.                                       
                                                                                
           MOVE K730-NUM-REGN          TO NUM-RGSTRN.                           
           MOVE K730-CDE-BALLOT-HOUSEHOLD                                       
                                       TO NUM-HSHLD-TYPE-BALLOT.                
           MOVE '0001-01-01'           TO DTE-RLGTN-START.                      
           MOVE 'BP13C10Z'             TO NUM-UPDATE-USERID.                    
                                                                                
           EVALUATE F730-NUM-ALLO-CAT                                           
              WHEN 'BTO'                                                        
                 MOVE 'Build-To-Order' TO NME-ALCTN-CTGRY                       
              WHEN 'SBF'                                                        
                 MOVE 'Sale Of Balance Flats'                                   
                                       TO NME-ALCTN-CTGRY                       
              WHEN OTHER                                                        
                 CONTINUE                                                       
           END-EVALUATE.                                                        
                                                                                
           PERFORM 4050-SEARCH-MONTH THRU 4050-EXIT.                            
           STRING WS-DTE-BAL-MTH-9 DELIMITED BY SPACES                          
                  ' ' F730-DTE-BALLOT(1:4)                                      
              DELIMITED BY SIZE INTO TXT-BALLOT-QRTR.                           
                                                                                
           EVALUATE K730-CDE-BALLOT-HOUSEHOLD                                   
              WHEN 'H'                                                          
              WHEN 'T'                                                          
              WHEN 'F'                                                          
                 MOVE 'First-timer'    TO NME-HSHLD-TYPE-BALLOT                 
              WHEN 'G'                                                          
                 MOVE 'Second-timer'   TO NME-HSHLD-TYPE-BALLOT                 
              WHEN OTHER                                                        
                 CONTINUE                                                       
           END-EVALUATE.                                                        
                                                                                
           EVALUATE K730-CDE-CATEGORY                                           
              WHEN '1'                                                          
                 MOVE 'Malay'          TO NME-HSHLD-ETHNIC-GROUP                
              WHEN '2'                                                          
                 MOVE 'Chinese'        TO NME-HSHLD-ETHNIC-GROUP                
              WHEN '3'                                                          
                 MOVE 'Indian'         TO NME-HSHLD-ETHNIC-GROUP                
              WHEN '4'                                                          
                 MOVE 'Others'         TO NME-HSHLD-ETHNIC-GROUP                
              WHEN OTHER                                                        
                 CONTINUE                                                       
           END-EVALUATE.                                                        
                                                                                
           IF K730-NUM-FTPMC = 'M' OR 'C' OR 'O' OR 'A'                         
              MOVE K730-NUM-FTPMC      TO NUM-FTPMC                             
           END-IF.                                                              
                                                                                
           PERFORM 4100-READ-BP13K813     THRU 4100-EXIT.                       
           PERFORM 4200-READ-BP13K757     THRU 4200-EXIT.                       
           PERFORM 4300-GET-BALLOT-CHANCE THRU 4300-EXIT.                       
           PERFORM 4400-GET-DTE-DEBAR     THRU 4400-EXIT.                       
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4050-SEARCH-MONTH.                                                       
      *****************************************************************         
                                                                                
           SET WS-MTH-IND              TO 1.                                    
           SEARCH WS-MONTH-TABLE                                                
              AT END                                                            
                 MOVE SPACES           TO WS-DTE-BAL-MTH-9                      
              WHEN WS-MONTH-IN-DIGITS(WS-MTH-IND) =                             
                                               F730-DTE-BALLOT(5:2)             
                 MOVE WS-MONTH-IN-WORDS(WS-MTH-IND)                             
                                       TO WS-DTE-BAL-MTH-9                      
           END-SEARCH.                                                          
                                                                                
       4050-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4100-READ-BP13K813.                                                      
      *****************************************************************         
                                                                                
           MOVE SPACES                 TO BP13K813-REC.                         
           INITIALIZE BP13K813-REC.                                             
                                                                                
           MOVE K730-CDE-NT1           TO K813-NUM-ZONE.                        
           MOVE K730-CDE-FLAT-TYPE     TO K813-NUM-FLAT-TYPE.                   
           MOVE K730-DTE-BALLOT        TO K813-DTE-BALLOT.                      
                                                                                
           READ BP13K813.                                                       
                                                                                
           EVALUATE WS-K813-STATUS                                              
              WHEN 00                                                           
                 ADD 1                 TO WS-K813-READ                          
                 MOVE K813-NME-FLAT-TYPE-LTR                                    
                                       TO NME-SALES-FLAT-TYPE                   
                 MOVE K813-NME-PROJECT-LTR                                      
                                       TO NME-SALES-ZONE                        
                 MOVE K813-TXT-RESULT-PERIOD-LTR                                
                                       TO                                       
                                    TXT-ESTMT-PERIOD-BALLOT-RESULT              
              WHEN 23                                                           
                 DISPLAY 'REC NOT FOUND IN BP13K813: '                          
                    'REGN=' K730-NUM-REGN ',KEY=' K813-KEY-FLD                  
              WHEN OTHER                                                        
                 DISPLAY 'READ BP13K813 FAIL STATUS=' WS-K813-STATUS            
                 EXEC SQL ROLLBACK END-EXEC                                     
                 MOVE WS-K813-STATUS   TO RETURN-CODE                           
                 PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       4100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4200-READ-BP13K757.                                                      
      *****************************************************************         
                                                                                
           MOVE SPACES                 TO BP13K757-REC.                         
           INITIALIZE BP13K757-REC.                                             
                                                                                
           MOVE K730-NUM-REGN          TO K757-NUM-REGN.                        
                                                                                
           READ BP13K757.                                                       
                                                                                
           EVALUATE WS-K757-STATUS                                              
              WHEN 00                                                           
                 ADD 1                 TO WS-K757-READ                          
                                                                                
                 EVALUATE K757-NUM-APPL-RACE                                    
                    WHEN 'M'                                                    
                       MOVE 'Malay'    TO NME-HSHLD-ETHNIC-GROUP-PREFER         
                    WHEN 'C'                                                    
                       MOVE 'Chinese'  TO NME-HSHLD-ETHNIC-GROUP-PREFER         
                    WHEN 'I'                                                    
                       MOVE 'Indian'   TO NME-HSHLD-ETHNIC-GROUP-PREFER         
                    WHEN 'O'                                                    
                       MOVE 'Others'   TO NME-HSHLD-ETHNIC-GROUP-PREFER         
                    WHEN OTHER                                                  
                       CONTINUE                                                 
                 END-EVALUATE                                                   
                                                                                
              WHEN 23                                                           
                 DISPLAY 'REC NOT FOUND IN BP13K757: ' K730-NUM-REGN            
              WHEN OTHER                                                        
                 DISPLAY 'READ BP13K757 FAIL STATUS=' WS-K757-STATUS            
                 EXEC SQL ROLLBACK END-EXEC                                     
                 MOVE WS-K757-STATUS   TO RETURN-CODE                           
                 PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                        
           END-EVALUATE.                                                        
                                                                                
       4200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4300-GET-BALLOT-CHANCE.                                                  
      *****************************************************************         
                                                                                
           IF K730-NUM-RANDOM-PRIORITY IS NUMERIC                               
              MOVE K730-NUM-RANDOM-PRIORITY                                     
                                       TO QTY-BALLOT-CHANCE                     
           END-IF.                                                              
                                                                                
       4300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       4400-GET-DTE-DEBAR.                                                      
      *****************************************************************         
                                                                                
           IF (BP13F730-REC(7:4) = SPACES OR LOW-VALUES) OR                     
              (BP13F730-REC(4:2) = SPACES OR LOW-VALUES) OR                     
              (BP13F730-REC(1:2) = SPACES OR LOW-VALUES)                        
              CONTINUE                                                          
           ELSE                                                                 
              STRING BP13F730-REC(7:4) '-'                                      
                     BP13F730-REC(4:2) '-'                                      
                     BP13F730-REC(1:2)                                          
                 DELIMITED BY SIZE INTO DTE-RLGTN-START                         
           END-IF.                                                              
                                                                                
       4400-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5000-PROCESS-CFMLTR-2F.                                                  
      *****************************************************************         
                                                                                
           EVALUATE TRUE                                                        
              WHEN K730-CDE-ALLOC-SCH = 'TPS'                                   
                 PERFORM 5005-BP135P THRU 5005-EXIT                             
                                                                                
              WHEN K730-CDE-ALLOC-SCH = 'TCP'                                   
                 PERFORM 5010-BP13ES THRU 5010-EXIT                             
                                                                                
              WHEN K730-NUM-PORT-ELIG-TAG = 'P'                                 
                 PERFORM 5015-BP135J THRU 5015-EXIT                             
                                                                                
              WHEN (K730-NUM-MGPS NOT = SPACES AND LOW-VALUES) AND              
                    K730-NUM-ALLO-CAT = 'BTO'                                   
                 PERFORM 5020-BP13EU THRU 5020-EXIT                             
                                                                                
              WHEN ((K730-NUM-APPS NOT = SPACES AND LOW-VALUES) AND             
                    (F730-NUM-APPS-ELIG-TAG = '1' OR 'T')) OR                   
                   ((K730-NUM-MCPS = 'P' OR 'C' OR 'M' OR 'B') AND              
                    (K730-CDE-RESIDENT-HA1 = '1' OR 'A' OR 'T'))                
                 PERFORM 5025-BP13EW THRU 5025-EXIT                             
                                                                                
              WHEN OTHER                                                        
                 PERFORM 5030-BP13BQ THRU 5030-EXIT                             
                                                                                
           END-EVALUATE.                                                        
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5005-BP135P.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP135P'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP135P-CNT.                        
                                                                                
       5005-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5010-BP13ES.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13ES'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13ES-CNT.                        
                                                                                
       5010-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5015-BP135J.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP135J'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP135J-CNT.                        
                                                                                
       5015-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5020-BP13EU.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13EU'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13EU-CNT.                        
                                                                                
       5020-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5025-BP13EW.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13EW'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13EW-CNT.                        
                                                                                
       5025-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       5030-BP13BQ.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13BQ'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13BQ-CNT.                        
                                                                                
       5030-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6000-PROCESS-CFMLTR-CCA.                                                 
      *****************************************************************         
                                                                                
           EVALUATE K730-NUM-CCA                                                
              WHEN 'P'                                                          
              WHEN 'S'                                                          
                 IF K730-NUM-JB-REGN = SPACES OR LOW-VALUES                     
                    PERFORM 6005-BP13P1 THRU 6005-EXIT                          
                 ELSE                                                           
                    PERFORM 6010-BP13J1 THRU 6010-EXIT                          
                 END-IF                                                         
                                                                                
              WHEN 'T'                                                          
              WHEN 'Z'                                                          
              WHEN 'R'                                                          
                 IF K730-NUM-JB-REGN = SPACES OR LOW-VALUES                     
                    PERFORM 6015-BP13G1 THRU 6015-EXIT                          
                 ELSE                                                           
                    PERFORM 6020-BP13B1 THRU 6020-EXIT                          
                 END-IF                                                         
                                                                                
           END-EVALUATE.                                                        
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6005-BP13P1.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13P1'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13P1-CNT.                        
                                                                                
       6005-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6010-BP13J1.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13J1'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13J1-CNT.                        
                                                                                
       6010-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6015-BP13G1.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13G1'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13G1-CNT.                        
                                                                                
       6015-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       6020-BP13B1.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13B1'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13B1-CNT.                        
                                                                                
       6020-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7000-PROCESS-CFMLTR.                                                     
      *****************************************************************         
                                                                                
           EVALUATE TRUE                                                        
              WHEN K730-NUM-AST = 'Y'                                           
                 PERFORM 7505-BP13XY THRU 7505-EXIT                             
                                                                                
              WHEN K730-CDE-ALLOC-SCH = 'FTS'                                   
                 PERFORM 7510-BP13Y1 THRU 7510-EXIT                             
                                                                                
              WHEN K730-NUM-ALLO-CAT = 'BTO' OR 'SBF'                           
                 PERFORM 7100-PROCESS-BTO-SBF THRU 7100-EXIT                    
                                                                                
              WHEN OTHER                                                        
                 MOVE 'INVALID CONFIRMATION LETTER'                             
                                       TO L10ZB-REMARKS                         
                                                                                
           END-EVALUATE.                                                        
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7100-PROCESS-BTO-SBF.                                                    
      *****************************************************************         
                                                                                
           EVALUATE TRUE                                                        
              WHEN K730-NUM-MCPS NOT = SPACES AND                               
                  (K730-CDE-RESIDENT-HA1 NOT = 'M' AND                          
                   K730-CDE-RESIDENT-HA1 NOT = 'H' AND                          
                   K730-CDE-RESIDENT-HA1 NOT = 'P' AND                          
                   K730-CDE-RESIDENT-HA1 NOT = SPACES)                          
                 PERFORM 7110-PROCESS-MCPS THRU 7110-EXIT                       
                                                                                
              WHEN K730-NUM-PORT-ELIG-TAG = 'P'                                 
                 IF K813-NUM-MATURE-EST-TAG = 'Y' AND                           
                    K730-NUM-ALLO-CAT = 'BTO'                                   
                    PERFORM 7120-PROCESS-SERS THRU 7120-EXIT                    
                 ELSE                                                           
                    PERFORM 7125-PROCESS-SERS THRU 7125-EXIT                    
                 END-IF                                                         
                                                                                
              WHEN (K730-NUM-MGPS NOT = SPACES AND LOW-VALUES) AND              
                    K730-NUM-ALLO-CAT = 'BTO'                                   
                 PERFORM 7130-PROCESS-MGPS THRU 7130-EXIT                       
                                                                                
              WHEN K730-NUM-MCPS = SPACES AND                                   
                   K730-CDE-ALLOC-SCH = 'PA '                                   
                 PERFORM 7140-PROCESS-PA THRU 7140-EXIT                         
                                                                                
              WHEN K730-NUM-MCPS = SPACES AND                                   
                   K730-CDE-ALLOC-SCH = 'TCP'                                   
                 PERFORM 7150-PROCESS-TCP THRU 7150-EXIT                        
                                                                                
              WHEN K730-NUM-MCPS = SPACES AND                                   
                   K730-CDE-ALLOC-SCH = 'TPS'                                   
                 PERFORM 7160-PROCESS-TPS THRU 7160-EXIT                        
                                                                                
              WHEN OTHER                                                        
                 MOVE 'INVALID CONFIRMATION LETTER'                             
                                       TO L10ZB-REMARKS                         
                                                                                
           END-EVALUATE.                                                        
                                                                                
       7100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7110-PROCESS-MCPS.                                                       
      *****************************************************************         
                                                                                
           IF K730-NUM-MCPS = 'P' OR 'C' OR 'B'                                 
              IF (K730-CDE-HOUSEHOLD = 'H' OR 'T') OR                           
                 (K730-NUM-FT2T = 'Y')                                          
                 IF (K730-CDE-HOUSEHOLD = 'H' OR 'T') AND                       
                    K730-CDE-BALLOT-HOUSEHOLD = 'G'                             
                    PERFORM 7515-BP13BD THRU 7515-EXIT                          
                 ELSE                                                           
                    IF K730-NUM-PPS-ELIG-TAG = 'Y' OR 'E' OR 'F'                
                       IF K730-NUM-FT2T = 'Y'                                   
                          PERFORM 7520-BP13YT THRU 7520-EXIT                    
                       ELSE                                                     
                          PERFORM 7525-BP13XT THRU 7525-EXIT                    
                       END-IF                                                   
                    ELSE                                                        
                       IF K730-NUM-FT2T = 'Y'                                   
                          PERFORM 7530-BP13YM THRU 7530-EXIT                    
                       ELSE                                                     
                          PERFORM 7535-BP13AI THRU 7535-EXIT                    
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
              ELSE                                                              
                 IF K730-CDE-HOUSEHOLD = 'G'                                    
                    PERFORM 7540-BP13AS THRU 7540-EXIT                          
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              IF K730-NUM-MCPS = 'M'                                            
                 IF (K730-CDE-HOUSEHOLD = 'H' OR 'T') OR                        
                    (K730-NUM-FT2T = 'Y')                                       
                    IF (K730-CDE-HOUSEHOLD = 'H' OR 'T') AND                    
                       K730-CDE-BALLOT-HOUSEHOLD = 'G'                          
                       PERFORM 7515-BP13BD THRU 7515-EXIT                       
                    ELSE                                                        
                       IF K730-NUM-PPS-ELIG-TAG = 'Y' OR 'E' OR 'F'             
                          IF K730-NUM-FT2T = 'Y'                                
                             PERFORM 7520-BP13YT THRU 7520-EXIT                 
                          ELSE                                                  
                             PERFORM 7525-BP13XT THRU 7525-EXIT                 
                          END-IF                                                
                       ELSE                                                     
                          IF K730-NUM-FT2T = 'Y'                                
                             PERFORM 7530-BP13YM THRU 7530-EXIT                 
                          ELSE                                                  
                             PERFORM 7535-BP13AI THRU 7535-EXIT                 
                          END-IF                                                
                       END-IF                                                   
                    END-IF                                                      
                 ELSE                                                           
                    IF K730-CDE-HOUSEHOLD = 'G'                                 
                       PERFORM 7540-BP13AS THRU 7540-EXIT                       
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       7110-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7120-PROCESS-SERS.                                                       
      *****************************************************************         
                                                                                
           IF K730-NUM-PPS-ELIG-TAG = 'Y' OR 'E' OR 'F'                         
              IF K730-NUM-FT2T = 'Y'                                            
                 PERFORM 7550-BP13YX THRU 7550-EXIT                             
              ELSE                                                              
                 PERFORM 7555-BP13XQ THRU 7555-EXIT                             
              END-IF                                                            
           ELSE                                                                 
              IF K730-CDE-HOUSEHOLD = 'H' OR 'T'                                
                 PERFORM 7565-BP1374 THRU 7565-EXIT                             
              ELSE                                                              
                 IF K730-CDE-HOUSEHOLD = 'G'                                    
                    IF K730-NUM-FT2T = 'Y'                                      
                       PERFORM 7560-BP13YR THRU 7560-EXIT                       
                    ELSE                                                        
                       PERFORM 7570-BP1376 THRU 7570-EXIT                       
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
       7120-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7125-PROCESS-SERS.                                                       
      *****************************************************************         
                                                                                
           IF (K730-CDE-HOUSEHOLD = 'H' OR 'T') OR                              
              (K730-NUM-FT2T = 'Y')                                             
              IF (K730-CDE-HOUSEHOLD = 'H' OR 'T') AND                          
                 K730-CDE-BALLOT-HOUSEHOLD = 'G'                                
                 PERFORM 7545-BP1377 THRU 7545-EXIT                             
              ELSE                                                              
                 IF K730-NUM-PPS-ELIG-TAG = 'Y' OR 'E' OR 'F'                   
                    IF K730-NUM-FT2T = 'Y'                                      
                       PERFORM 7550-BP13YX THRU 7550-EXIT                       
                    ELSE                                                        
                       PERFORM 7555-BP13XQ THRU 7555-EXIT                       
                    END-IF                                                      
                 ELSE                                                           
                    IF K730-NUM-FT2T = 'Y'                                      
                       PERFORM 7560-BP13YR THRU 7560-EXIT                       
                    ELSE                                                        
                       PERFORM 7565-BP1374 THRU 7565-EXIT                       
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              IF K730-CDE-HOUSEHOLD = 'G'                                       
                 PERFORM 7570-BP1376 THRU 7570-EXIT                             
              END-IF                                                            
           END-IF.                                                              
                                                                                
       7125-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7130-PROCESS-MGPS.                                                       
      *****************************************************************         
                                                                                
           IF (K730-CDE-HOUSEHOLD = 'H' OR 'T') OR                              
              (K730-NUM-FT2T = 'Y')                                             
              IF (K730-CDE-HOUSEHOLD = 'H' OR 'T') AND                          
                 K730-CDE-BALLOT-HOUSEHOLD = 'G'                                
                 PERFORM 7575-BP137I THRU 7575-EXIT                             
              ELSE                                                              
                 IF K730-NUM-PPS-ELIG-TAG = 'Y' OR 'E' OR 'F'                   
                    IF K730-NUM-FT2T = 'Y'                                      
                       PERFORM 7580-BP13YW THRU 7580-EXIT                       
                    ELSE                                                        
                       PERFORM 7585-BP13XS THRU 7585-EXIT                       
                    END-IF                                                      
                 ELSE                                                           
                    IF K730-NUM-FT2T = 'Y'                                      
                       PERFORM 7590-BP13YQ THRU 7590-EXIT                       
                    ELSE                                                        
                       PERFORM 7595-BP137F THRU 7595-EXIT                       
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              IF K730-CDE-HOUSEHOLD = 'G'                                       
                 PERFORM 7600-BP137H THRU 7600-EXIT                             
              END-IF                                                            
           END-IF.                                                              
                                                                                
       7130-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7140-PROCESS-PA.                                                         
      *****************************************************************         
                                                                                
           IF (K730-CDE-HOUSEHOLD = 'H' OR 'T') OR                              
              (K730-NUM-FT2T = 'Y')                                             
              IF (K730-CDE-HOUSEHOLD = 'H' OR 'T') AND                          
                 K730-CDE-BALLOT-HOUSEHOLD = 'G'                                
                 PERFORM 7605-BP13BC THRU 7605-EXIT                             
              ELSE                                                              
                 IF K730-NUM-PPS-ELIG-TAG = 'Y' OR 'E' OR 'F'                   
                    IF K730-NUM-FT2T = 'Y'                                      
                       PERFORM 7610-BP13YS THRU 7610-EXIT                       
                    ELSE                                                        
                       PERFORM 7615-BP13XK THRU 7615-EXIT                       
                    END-IF                                                      
                 ELSE                                                           
                    IF K730-NUM-FT2T = 'Y'                                      
                       PERFORM 7620-BP13YL THRU 7620-EXIT                       
                    ELSE                                                        
                       PERFORM 7625-BP13AH THRU 7625-EXIT                       
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              IF K730-CDE-HOUSEHOLD = 'G'                                       
                 PERFORM 7630-BP13AM THRU 7630-EXIT                             
              END-IF                                                            
           END-IF.                                                              
                                                                                
       7140-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7150-PROCESS-TCP.                                                        
      *****************************************************************         
                                                                                
           IF (K730-CDE-HOUSEHOLD = 'H' OR 'T') OR                              
              (K730-NUM-FT2T = 'Y')                                             
              IF (K730-CDE-HOUSEHOLD = 'H' OR 'T') AND                          
                 K730-CDE-BALLOT-HOUSEHOLD = 'G'                                
                 PERFORM 7635-BP13BE THRU 7635-EXIT                             
              ELSE                                                              
                 IF K730-NUM-PPS-ELIG-TAG = 'Y' OR 'E' OR 'F'                   
                    IF K730-NUM-FT2T = 'Y'                                      
                       PERFORM 7640-BP13YU THRU 7640-EXIT                       
                    ELSE                                                        
                       PERFORM 7645-BP13XM THRU 7645-EXIT                       
                    END-IF                                                      
                 ELSE                                                           
                    IF K730-NUM-FT2T = 'Y'                                      
                       PERFORM 7650-BP13YO THRU 7650-EXIT                       
                    ELSE                                                        
                       PERFORM 7655-BP13AQ THRU 7655-EXIT                       
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              IF K730-CDE-HOUSEHOLD = 'G'                                       
                 PERFORM 7660-BP13AT THRU 7660-EXIT                             
              END-IF                                                            
           END-IF.                                                              
                                                                                
       7150-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7160-PROCESS-TPS.                                                        
      *****************************************************************         
                                                                                
           IF (K730-CDE-HOUSEHOLD = 'H' OR 'T') OR                              
              (K730-NUM-FT2T = 'Y')                                             
              IF (K730-CDE-HOUSEHOLD = 'H' OR 'T') AND                          
                 K730-CDE-BALLOT-HOUSEHOLD = 'G'                                
                 PERFORM 7665-BP13EB THRU 7665-EXIT                             
              ELSE                                                              
                 IF K730-NUM-PPS-ELIG-TAG = 'Y' OR 'E' OR 'F'                   
                    IF K730-NUM-FT2T = 'Y'                                      
                       PERFORM 7670-BP13YV THRU 7670-EXIT                       
                    ELSE                                                        
                       PERFORM 7675-BP13XO THRU 7675-EXIT                       
                    END-IF                                                      
                 ELSE                                                           
                    IF K730-NUM-FT2T = 'Y'                                      
                       PERFORM 7680-BP13YP THRU 7680-EXIT                       
                    ELSE                                                        
                       PERFORM 7685-BP13AR THRU 7685-EXIT                       
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              IF K730-CDE-HOUSEHOLD = 'G'                                       
                 PERFORM 7690-BP13EA THRU 7690-EXIT                             
              END-IF                                                            
           END-IF.                                                              
                                                                                
       7160-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7505-BP13XY.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13XY'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13XY-CNT.                        
                                                                                
       7505-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7510-BP13Y1.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13Y1'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13Y1-CNT.                        
                                                                                
       7510-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7515-BP13BD.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13BD'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13BD-CNT.                        
                                                                                
       7515-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7520-BP13YT.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13YT'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13YT-CNT.                        
                                                                                
       7520-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7525-BP13XT.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13XT'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13XT-CNT.                        
                                                                                
       7525-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7530-BP13YM.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13YM'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13YM-CNT.                        
                                                                                
       7530-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7535-BP13AI.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13AI'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13AI-CNT.                        
                                                                                
       7535-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7540-BP13AS.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13AS'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13AS-CNT.                        
                                                                                
       7540-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7545-BP1377.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP1377'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP1377-CNT.                        
                                                                                
       7545-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7550-BP13YX.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13YX'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13YX-CNT.                        
                                                                                
       7550-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7555-BP13XQ.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13XQ'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13XQ-CNT.                        
                                                                                
       7555-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7560-BP13YR.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13YR'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13YR-CNT.                        
                                                                                
       7560-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7565-BP1374.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP1374'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP1374-CNT.                        
                                                                                
       7565-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7570-BP1376.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP1376'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP1376-CNT.                        
                                                                                
       7570-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7575-BP137I.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP137I'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP137I-CNT.                        
                                                                                
       7575-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7580-BP13YW.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13YW'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13YW-CNT.                        
                                                                                
       7580-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7585-BP13XS.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13XS'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13XS-CNT.                        
                                                                                
       7585-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7590-BP13YQ.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13YQ'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13YQ-CNT.                        
                                                                                
       7590-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7595-BP137F.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP137F'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP137F-CNT.                        
                                                                                
       7595-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7600-BP137H.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP137H'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP137H-CNT.                        
                                                                                
       7600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7605-BP13BC.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13BC'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13BC-CNT.                        
                                                                                
       7605-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7610-BP13YS.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13YS'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13YS-CNT.                        
                                                                                
       7610-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7615-BP13XK.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13XK'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13XK-CNT.                        
                                                                                
       7615-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7620-BP13YL.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13YL'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13YL-CNT.                        
                                                                                
       7620-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7625-BP13AH.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13AH'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13AH-CNT.                        
                                                                                
       7625-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7630-BP13AM.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13AM'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13AM-CNT.                        
                                                                                
       7630-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7635-BP13BE.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13BE'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13BE-CNT.                        
                                                                                
       7635-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7640-BP13YU.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13YU'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13YU-CNT.                        
                                                                                
       7640-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7645-BP13XM.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13XM'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13XM-CNT.                        
                                                                                
       7645-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7650-BP13YO.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13YO'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13YO-CNT.                        
                                                                                
       7650-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7655-BP13AQ.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13AQ'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13AQ-CNT.                        
                                                                                
       7655-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7660-BP13AT.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13AT'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13AT-CNT.                        
                                                                                
       7660-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7665-BP13EB.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13EB'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13EB-CNT.                        
                                                                                
       7665-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7670-BP13YV.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13YV'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13YV-CNT.                        
                                                                                
       7670-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7675-BP13XO.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13XO'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13XO-CNT.                        
                                                                                
       7675-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7680-BP13YP.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13YP'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13YP-CNT.                        
                                                                                
       7680-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7685-BP13AR.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13AR'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13AR-CNT.                        
                                                                                
       7685-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       7690-BP13EA.                                                             
      *****************************************************************         
                                                                                
           MOVE 'BP13EA'               TO NUM-CNFRM.                            
                                                                                
           ADD 1                       TO WS-BP13EA-CNT.                        
                                                                                
       7690-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8500-PRINT-REPORT-L10ZA.                                                 
      *****************************************************************         
                                                                                
           IF WS-L10ZA-LINE-CNT > 59                                            
              ADD 1                    TO WS-L10ZA-PAGE-CNT                     
              MOVE WS-L10ZA-PAGE-CNT   TO L10ZA-PAGE                            
                                                                                
              WRITE P13L10ZA-REC FROM L10ZA-HDR1 AFTER PAGE                     
              WRITE P13L10ZA-REC FROM L10ZA-HDR2                                
              WRITE P13L10ZA-REC FROM L10ZA-BLANK                               
              WRITE P13L10ZA-REC FROM L10ZA-HDR3                                
              WRITE P13L10ZA-REC FROM L10ZA-BLANK                               
                                                                                
              MOVE 5                   TO WS-L10ZA-LINE-CNT                     
           END-IF.                                                              
                                                                                
           ADD 1                       TO WS-L10ZA-CNT.                         
           MOVE WS-L10ZA-CNT           TO L10ZA-SNO.                            
                                                                                
           MOVE F730-NUM-REGN          TO L10ZA-REG-NO.                         
           MOVE K730-CDE-NT1           TO L10ZA-NT1.                            
           MOVE K730-CDE-FLAT-TYPE     TO L10ZA-FLAT.                           
           MOVE NUM-CNFRM              TO L10ZA-CNFRM.                          
                                                                                
           IF K757-NUM-APPL-RACE = SPACES OR LOW-VALUES                         
              MOVE 'N'                 TO L10ZA-INTRRCL                         
           ELSE                                                                 
              MOVE 'Y'                 TO L10ZA-INTRRCL                         
           END-IF.                                                              
                                                                                
           WRITE P13L10ZA-REC FROM L10ZA-DTL1.                                  
           ADD 1                       TO WS-L10ZA-LINE-CNT                     
                                          WS-L10ZA-WRITE.                       
                                                                                
       8500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8600-PRINT-REPORT-L10ZB.                                                 
      *****************************************************************         
                                                                                
           IF WS-L10ZB-LINE-CNT > 59                                            
              ADD 1                    TO WS-L10ZB-PAGE-CNT                     
              MOVE WS-L10ZB-PAGE-CNT   TO L10ZB-PAGE                            
                                                                                
              WRITE P13L10ZB-REC FROM L10ZB-HDR1 AFTER PAGE                     
              WRITE P13L10ZB-REC FROM L10ZB-HDR2                                
              WRITE P13L10ZB-REC FROM L10ZB-BLANK                               
              WRITE P13L10ZB-REC FROM L10ZB-HDR3                                
              WRITE P13L10ZB-REC FROM L10ZB-BLANK                               
                                                                                
              MOVE 5                   TO WS-L10ZB-LINE-CNT                     
           END-IF.                                                              
                                                                                
           ADD 1                       TO WS-L10ZB-CNT.                         
           MOVE WS-L10ZB-CNT           TO L10ZB-SNO.                            
                                                                                
           MOVE F730-NUM-REGN          TO L10ZB-REG-NO.                         
           MOVE K730-CDE-NT1           TO L10ZB-NT1.                            
           MOVE K730-CDE-FLAT-TYPE     TO L10ZB-FLAT.                           
                                                                                
           WRITE P13L10ZB-REC FROM L10ZB-DTL1.                                  
           ADD 1                       TO WS-L10ZB-LINE-CNT                     
                                          WS-L10ZB-WRITE.                       
                                                                                
       8600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       8700-PRINT-REPORT-L10ZC.                                                 
      *****************************************************************         
                                                                                
           IF WS-L10ZC-LINE-CNT > 59                                            
              ADD 1                    TO WS-L10ZC-PAGE-CNT                     
              MOVE WS-L10ZC-PAGE-CNT   TO L10ZC-PAGE                            
                                                                                
              WRITE P13L10ZC-REC FROM L10ZC-HDR1 AFTER PAGE                     
              WRITE P13L10ZC-REC FROM L10ZC-HDR2                                
              WRITE P13L10ZC-REC FROM L10ZC-BLANK                               
              WRITE P13L10ZC-REC FROM L10ZC-HDR3                                
              WRITE P13L10ZC-REC FROM L10ZC-BLANK                               
                                                                                
              MOVE 5                   TO WS-L10ZC-LINE-CNT                     
           END-IF.                                                              
                                                                                
           ADD 1                       TO WS-L10ZC-CNT.                         
           MOVE WS-L10ZC-CNT           TO L10ZC-SNO.                            
                                                                                
           MOVE F730-NUM-REGN          TO L10ZC-REG-NO.                         
           MOVE K730-CDE-NT1           TO L10ZC-NT1.                            
           MOVE K730-CDE-FLAT-TYPE     TO L10ZC-FLAT.                           
           MOVE NUM-CNFRM              TO L10ZC-CNFRM.                          
                                                                                
           IF K757-NUM-APPL-RACE = SPACES OR LOW-VALUES                         
              MOVE 'N'                 TO L10ZC-INTRRCL                         
           ELSE                                                                 
              MOVE 'Y'                 TO L10ZC-INTRRCL                         
           END-IF.                                                              
                                                                                
           WRITE P13L10ZC-REC FROM L10ZC-DTL1.                                  
           ADD 1                       TO WS-L10ZC-LINE-CNT                     
                                          WS-L10ZC-WRITE.                       
                                                                                
       8700-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *****************************************************************         
       9000-CLOSE-FILES.                                                        
      *****************************************************************         
                                                                                
           CLOSE BP13F730                                                       
                 BP13K730                                                       
                 BP13K757                                                       
                 BP13K813                                                       
                 P13L10ZA                                                       
                 P13L10ZB                                                       
                 P13L10ZC.                                                      
                                                                                
           IF WS-K730-STATUS NOT = ZEROES                                       
              DISPLAY 'CLOSE BP13K730 FAIL STATUS=' WS-K730-STATUS              
              EXEC SQL ROLLBACK END-EXEC                                        
              MOVE WS-K730-STATUS      TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF WS-K757-STATUS NOT = ZEROES                                       
              DISPLAY 'CLOSE BP13K757 FAIL STATUS=' WS-K757-STATUS              
              EXEC SQL ROLLBACK END-EXEC                                        
              MOVE WS-K757-STATUS      TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           IF WS-K813-STATUS NOT = ZEROES                                       
              DISPLAY 'CLOSE BP13K813 FAIL STATUS=' WS-K813-STATUS              
              EXEC SQL ROLLBACK END-EXEC                                        
              MOVE WS-K813-STATUS      TO RETURN-CODE                           
           END-IF.                                                              
                                                                                
           DISPLAY '******************************'.                            
           DISPLAY '* PROGRAM BP13C10Z           *'.                            
           DISPLAY '* CONTROL COUNTS             *'.                            
           DISPLAY '*----------------------------*'.                            
           DISPLAY '* REC READ F730     : ' WS-F730-READ ' *'.                  
           DISPLAY '* REC READ K730     : ' WS-K730-READ ' *'.                  
           DISPLAY '* REC READ K757     : ' WS-K757-READ ' *'.                  
           DISPLAY '* REC READ K813     : ' WS-K813-READ ' *'.                  
           DISPLAY '* REC WRITTEN       : ' WS-FLRCN-WRITE ' *'.                
           DISPLAY '* FLAT_RQST_CNFRM            *'.                            
           DISPLAY '* REC WRITTEN L10ZA : ' WS-L10ZA-WRITE ' *'.                
           DISPLAY '* REC WRITTEN L10ZB : ' WS-L10ZB-WRITE ' *'.                
           DISPLAY '* REC WRITTEN L10ZC : ' WS-L10ZC-WRITE ' *'.                
           DISPLAY '* CASES FOR BP13AH  : ' WS-BP13AH-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13AI  : ' WS-BP13AI-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13AM  : ' WS-BP13AM-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13AQ  : ' WS-BP13AQ-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13AR  : ' WS-BP13AR-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13AS  : ' WS-BP13AS-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13AT  : ' WS-BP13AT-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13BC  : ' WS-BP13BC-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13BD  : ' WS-BP13BD-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13BE  : ' WS-BP13BE-CNT ' *'.                 
           DISPLAY '* CASES FOR BP1374  : ' WS-BP1374-CNT ' *'.                 
           DISPLAY '* CASES FOR BP1376  : ' WS-BP1376-CNT ' *'.                 
           DISPLAY '* CASES FOR BP1377  : ' WS-BP1377-CNT ' *'.                 
           DISPLAY '* CASES FOR BP137H  : ' WS-BP137H-CNT ' *'.                 
           DISPLAY '* CASES FOR BP137I  : ' WS-BP137I-CNT ' *'.                 
           DISPLAY '* CASES FOR BP137F  : ' WS-BP137F-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13EB  : ' WS-BP13EB-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13XK  : ' WS-BP13XK-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13XM  : ' WS-BP13XM-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13XO  : ' WS-BP13XO-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13XQ  : ' WS-BP13XQ-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13XS  : ' WS-BP13XS-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13XT  : ' WS-BP13XT-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13XY  : ' WS-BP13XY-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13Y1  : ' WS-BP13Y1-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13YL  : ' WS-BP13YL-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13YM  : ' WS-BP13YM-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13YO  : ' WS-BP13YO-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13YP  : ' WS-BP13YP-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13YQ  : ' WS-BP13YQ-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13YR  : ' WS-BP13YR-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13YS  : ' WS-BP13YS-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13YT  : ' WS-BP13YT-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13YU  : ' WS-BP13YU-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13YV  : ' WS-BP13YV-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13YW  : ' WS-BP13YW-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13YX  : ' WS-BP13YX-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13EA  : ' WS-BP13EA-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13BQ  : ' WS-BP13BQ-CNT ' *'.                 
           DISPLAY '* CASES FOR BP135P  : ' WS-BP135P-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13ES  : ' WS-BP13ES-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13EU  : ' WS-BP13EU-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13EW  : ' WS-BP13EW-CNT ' *'.                 
           DISPLAY '* CASES FOR BP135J  : ' WS-BP135J-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13P1  : ' WS-BP13P1-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13J1  : ' WS-BP13J1-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13B1  : ' WS-BP13B1-CNT ' *'.                 
           DISPLAY '* CASES FOR BP13G1  : ' WS-BP13G1-CNT ' *'.                 
           DISPLAY '******************************'.                            
                                                                                
       9000-EXIT.                                                               
           STOP RUN.                                                            
           EXIT.                                                                
                                                                                
      *======================  END OF PROGRAM  ======================*          
