      *------------------------*                                        00010000
       IDENTIFICATION DIVISION.                                         00020000
      *------------------------*                                        00030000
       PROGRAM-ID.    BP13C35F.                                         00040000
      *AUTHOR.        JGO1.                                             00050000
      *DATE-WRITTEN.  12052015.                                         00060000
                                                                        00070000
      * =========================================================== *   00080000
      *  SYSTEM OF COMMITMENT (BP13)                                *   00090000
      * =========================================================== *   00100000
      *                                                             *   00110000
      *  OBJECTIVE :                                                *   00120000
      *  1. TO PRINT REPORT ON AGREEMENT FOR LEASE AND DEED OF      *   00130000
      *     ASSIGNMENT (SUB-TRANSFER) FOR DAWSON                    *   00140000
      *     ( COPIED FROM BP13C355, CATERED TO FOR DAWSON CASES )   *   00150000
      *                                                             *   00160000
      *  INPUT FILES:                                               *   00170000
      *  1. BP13F315                                                *   00180000
      *  2. BP13K330                                                *   00190000
      *                                                             *   00200000
      *  OUTPUT FILES:                                              *   00210000
      *  1. AG07F225      - VOUCHER STAMPING FILE                   *   00220000
      *  2. BP13K625      - STAMP FEE MASTER FILE                   *   00230000
      *                                                             *   00240000
      *  LISTING                                                    *   00250000
      *  1. P13L35FA      - DRAFT REPORT                            *   00260000
      *  2. P13L35FB      - SOURCE COPY (FINAL REPORT)              *   00270000
      *                                                             *   00280000
      * ----------------------------------------------------------- *   00290000
      * CHG-NO   BY  DATE      DESCRIPTION                          *   00300000
      * -------- --- --------- -----------                          *   00310000
      * BP135650 JGO1 12052015 NEW PROGRAM                          *   00320000
      * BP135798 JGO1 22052015 REMOVE K625-NUM-ZERO-STAMP           *   00330000
      * BP135832 JGO1 19052015 UPDATE VALUE PASSED TO F225 BANK     *   00340000
      * BP137140 PCL4 19122017 TO REDEFINE AG07 FILE ERROR CODE     *   00350000
      * BP138339 KR13 07082020 REMOVED P13L35FC - IOM8 CONVERSION.  *   00360000
      * BP139164 KV8  04052022 INCLUDED ADDRESS AND COMMENTED STREET*   00361002
      * =========================================================== *   00370000
                                                                        00380000
      *--------------------*                                            00390000
       ENVIRONMENT DIVISION.                                            00400000
      *--------------------*                                            00410000
       CONFIGURATION SECTION.                                           00420000
       SOURCE-COMPUTER. IBM-3090.                                       00430000
       OBJECT-COMPUTER. IBM-3090.                                       00440000
                                                                        00450000
       INPUT-OUTPUT SECTION.                                            00460000
       FILE-CONTROL.                                                    00470000
                                                                        00480000
           SELECT BP13F315        ASSIGN       TO BP13F315.             00490000
                                                                        00500000
           SELECT BP13K330        ASSIGN       TO BP13K330              00510000
                                  ACCESS MODE  IS DYNAMIC               00520000
                                  ORGANIZATION IS INDEXED               00530000
                                  RECORD KEY   IS K330-KEY-FLD          00540000
                                  FILE STATUS  IS WS-BP13K330-STATUS.   00550000
                                                                        00560000
           SELECT BP13K625        ASSIGN       TO BP13K625              00570000
                                  ACCESS MODE  IS DYNAMIC               00580000
                                  ORGANIZATION IS INDEXED               00590000
                                  RECORD KEY   IS K625-KEY-FLD          00600000
                                  FILE STATUS  IS WS-BP13K625-STATUS.   00610000
                                                                        00620000
           SELECT BP13K800        ASSIGN       TO BP13K800              00630000
                                  ACCESS MODE  IS RANDOM                00640000
                                  ORGANIZATION IS INDEXED               00650000
                                  RECORD KEY   IS K800-NUM-REGN         00660000
                                  FILE STATUS  IS WS-BP13K800-STATUS.   00670000
                                                                        00680000
                                                                        00690000
           SELECT BP13K893        ASSIGN       TO BP13K893              00700000
                                  ACCESS MODE  IS DYNAMIC               00710000
                                  ORGANIZATION IS INDEXED               00720000
                                  RECORD KEY   IS K893-KEY-FLD          00730000
                                  FILE STATUS  IS WS-BP13K893-STATUS.   00740000
                                                                        00750000
           SELECT BP13K410        ASSIGN       TO BP13K410              00760000
                                  ACCESS MODE  IS RANDOM                00770000
                                  ORGANIZATION IS INDEXED               00780000
                                  RECORD KEY   IS K410-KEY-FLD          00790000
                                  FILE STATUS  IS WS-BP13K410-STATUS.   00800000
                                                                        00810000
           SELECT AG07F225        ASSIGN       TO AG07F225.             00820000
                                                                        00830000
           SELECT P13L35FA        ASSIGN       TO P13L35FA.             00840000
                                                                        00850000
           SELECT P13L35FB        ASSIGN       TO P13L35FB.             00860000
                                                                        00870000
           SELECT P13L35FD        ASSIGN       TO P13L35FD.             00880000
                                                                        00890000
                                                                        00900000
      *--------------------*                                            00910000
       DATA DIVISION.                                                   00920000
      *--------------------*                                            00930000
       FILE SECTION.                                                    00940000
                                                                        00950000
       FD   BP13F315                                                    00960000
            RECORD CONTAINS 500 CHARACTERS                              00970000
            RECORDING MODE  IS  F.                                      00980000
       COPY BP13F315.                                                   00990000
                                                                        01000000
       FD   BP13K330                                                    01010000
            RECORD CONTAINS 2000 CHARACTERS.                            01020000
       COPY BP13K330.                                                   01030000
                                                                        01040000
       FD   BP13K625                                                    01050000
            RECORD CONTAINS 500 CHARACTERS.                             01060000
       COPY BP13K625.                                                   01070000
                                                                        01080000
       FD   BP13K800                                                    01090000
            RECORD CONTAINS 2000 CHARACTERS.                            01100000
       COPY BP13K800.                                                   01110000
                                                                        01120000
       FD   BP13K893                                                    01130000
            RECORD CONTAINS 2050 CHARACTERS.                            01140000
       COPY BP13K893.                                                   01150000
                                                                        01160000
       FD   BP13K410                                                    01170000
            RECORD CONTAINS 2000 CHARACTERS.                            01180000
       COPY BP13K410.                                                   01190000
                                                                        01200000
       FD   AG07F225                                                    01210000
            RECORD CONTAINS 600 CHARACTERS                              01220000
            RECORDING MODE  IS  F.                                      01230000
       COPY AG07F225.                                                   01240000
                                                                        01250000
       FD   P13L35FA                                                    01260000
            RECORD CONTAINS 132 CHARACTERS                              01270000
            RECORDING MODE  IS  F.                                      01280000
       01   L35FA-PRINT-REC            PIC X(132).                      01290000
                                                                        01300000
       FD   P13L35FB                                                    01310000
            RECORD CONTAINS 132 CHARACTERS                              01320000
            RECORDING MODE  IS  F.                                      01330000
       01   L35FB-PRINT-REC            PIC X(132).                      01340000
                                                                        01350000
       FD   P13L35FD                                                    01360000
            RECORD CONTAINS 132 CHARACTERS                              01370000
            RECORDING MODE  IS  F.                                      01380000
       01   L35FD-PRINT-REC            PIC X(132).                      01390000
                                                                        01400000
       WORKING-STORAGE SECTION.                                         01410000
       01  WS-FILE-STATUS.                                              01420000
           05  WS-BP13K330-STATUS      PIC 9(02) VALUE ZEROES.          01430000
           05  WS-BP13K625-STATUS      PIC 9(02) VALUE ZEROES.          01440000
           05  WS-BP13K800-STATUS      PIC 9(02) VALUE ZEROES.          01450000
           05  WS-BP13K893-STATUS      PIC 9(02) VALUE ZEROES.          01460000
           05  WS-BP13K410-STATUS      PIC 9(02) VALUE ZEROES.          01470000
           05  WS-AG07-STATUS          PIC 9(2)  VALUE ZEROS.           01480000
           05  WS-AG07-STAT-X REDEFINES WS-AG07-STATUS PIC X(2).        01490000
                                                                        01500000
       01  WS-COUNTERS.                                                 01510000
           05  WS-LINE-CTR             PIC 9(04) VALUE ZEROES.          01520000
           05  WS-PAGENO-CTR           PIC 9(04) VALUE ZEROES.          01530000
           05  WS-BP13K330-FND         PIC 9(04) VALUE ZEROES.          01540000
           05  WS-BP13K800-FND         PIC 9(04) VALUE ZEROES.          01550000
           05  WS-BP13K893-FND         PIC X(01) VALUE SPACES.          01560000
           05  WS-BP13K893-EOF         PIC X(01) VALUE SPACES.          01570000
           05  WS-BP13F315-READ        PIC 9(04) VALUE ZEROES.          01580000
           05  WS-BP13K330-READ        PIC 9(04) VALUE ZEROES.          01590000
           05  WS-AG07F225-WRITE       PIC 9(04) VALUE ZEROES.          01600000
           05  WS-BP13K625-WRITE       PIC 9(04) VALUE ZEROES.          01610000
           05  WS-AG07F225-SERIAL      PIC 9(04) VALUE ZEROES.          01620000
           05  WS-BP13K330-NFND        PIC 9(04) VALUE ZEROES.          01630000
           05  WS-BP13K800-NFND        PIC 9(04) VALUE ZEROES.          01640000
           05  WS-BP13F315-REWRT       PIC 9(04) VALUE ZEROES.          01650000
                                                                        01660000
       01  WS-ACCUM-VARIABLES.                                          01670000
           05  WS-TOTAL                PIC S9(07)V99 VALUE ZEROES.      01680000
           05  WS-TOTAL-DOA            PIC S9(06)V99 VALUE ZEROES.      01690000
           05  WS-TOTAL-DUP-DOA        PIC S9(06)V99 VALUE ZEROES.      01700000
           05  WS-TOTAL-SSD            PIC S9(06)V99 VALUE ZEROES.      01710000
           05  WS-TOTAL-COMPUTED       PIC S9(07)V99 VALUE ZEROES.      01720000
           05  WS-TOTAL-DUP-LEASE      PIC S9(06)V99 VALUE ZEROES.      01730000
           05  WS-TOTAL-ACTUAL-LEASE   PIC S9(06)V99 VALUE ZEROES.      01740000
                                                                        01750000
       01  WS-CONSTANT.                                                 01760000
           05  WS-NEW-VOUCHER-NO       PIC X(01) VALUE 'Y'.             01770000
           05  WS-NEW-BATCH-NO         PIC X(01) VALUE 'Y'.             01780000
           05  WS-NEW-HEADER           PIC X(01) VALUE 'Y'.             01790000
           05  WS-REPORT-TYPE          PIC X(01) VALUE 'N'.             01800000
           05  WS-FOOTER-TAG           PIC X(01) VALUE SPACE.           01810000
           05  WS-STAFF-START          PIC X(9)   VALUE '29586H   '.    01820000
                                                                        01830000
       01  WS-SYSTEM-DATE.                                              01840000
           05  WS-SYS-DATE             PIC X(08) VALUE SPACES.          01850000
           05  FILLER                  PIC X(13) VALUE SPACES.          01860000
                                                                        01870000
       01  WS-VARIABLES.                                                01880000
           05  WS-DTE-DOC-PREPARE      PIC X(08)    VALUE SPACES.       01890000
           05  WS-NUM-VOUCHER          PIC X(11)    VALUE SPACES.       01900000
           05  WS-NUM-GL-ACCT          PIC X(13)    VALUE SPACES.       01910000
           05  WS-ANNUAL-RENT          PIC 9(07)V99 VALUE ZEROES.       01920000
           05  WS-NUM-BATCH-TYPE       PIC X(04)    VALUE SPACES.       01930000
           05  WS-NUM-TEMP-VOUCHER     PIC X(11)    VALUE SPACES.       01940000
           05  WS-NUM-FIN-YEAR         PIC 9(04)    VALUE ZEROES.       01950000
           05  WS-NUM-BATCH-SERIAL     PIC 9(05)    VALUE ZEROES.       01960000
                                                                        01970000
           05  WS-PLACE-COUNTER        PIC 9(03) VALUE ZEROES.          01980000
           05  WL-AREA-SAVE            PIC X(12) VALUE SPACES.          01990000
           05  WS-RESULT               PIC 9(03) VALUE ZEROES.          02000000
           05  WL-AREA.                                                 02010000
               10  WL-ITEM1            PIC 9(01) VALUE ZEROES.          02020000
               10  FILLER              PIC X(11) VALUE SPACE.           02030000
           05  WL-ITM REDEFINES WL-AREA.                                02040000
               10  WL-ITEM             PIC X(01) OCCURS 12 TIMES.       02050000
           05  WS-K625-EOF             PIC X(01) VALUE 'N'.             02060000
           05  WS-NUM-HDB-REF          PIC X(11) VALUE SPACES.          02070000
           05  WS-NUM-DOC              PIC X(03) VALUE SPACES.          02080000
           05  WS-NUM-DOC-TYP          PIC X(01) VALUE SPACES.          02090000
           05  WS-NUM-DOC-CNT          PIC 9(01) VALUE ZEROES.          02100000
           05  WS-NUM-INCREASE-SCCC    PIC X(1)  VALUE SPACES.          02110000
           05  WS-NUM-LEASE-TERM       PIC 9(4)V99  VALUE ZEROES.       02120000
           05  WS-AMT-PURCHASE-PRICE   PIC 9(13)V99 VALUE ZEROES.       02130000
           05  WS-AMT-STAMP-DUTY       PIC 9(13)V99 VALUE ZEROES.       02140000
           05  WS-AMT-STAMP-DUTY-DUP   PIC 9(13)V99 VALUE ZEROES.       02150000
           05  WS-AMT-SSD              PIC 9(13)V99 VALUE ZEROES.       02160000
           05  WS-AMT-EARMARK          PIC 9(10)V99 VALUE ZEROES.       02170000
                                                                        02180000
           05  WS-L35FD-PRT-CNT        PIC 9(4)     VALUE ZEROS.        02190000
           05  WS-L35FD-PAGE-CNT       PIC 9(5)     VALUE ZEROS.        02200000
           05  WS-L35FD-REC-ON-PAGE-CNT  PIC 9(2)   VALUE 66.           02210000
                                                                        02220000
      *--------------------------------*                                02230000
      * FOR AMOUNT TO WORDS CONVERSION *                                02240000
      *--------------------------------*                                02250000
       01  WS-SUBSCRIPTS.                                               02260000
           05  WA-SUB                  PIC 9(03) VALUE ZEROES.          02270000
           05  WF-SUB                  PIC 9(03) VALUE ZEROES.          02280000
           05  WL-SUB                  PIC 9(03) VALUE ZEROES.          02290000
           05  WS-SUB                  PIC 9(03) VALUE ZEROES.          02300000
           05  WS-FIRST-SUB            PIC 9(03) VALUE ZEROES.          02310000
                                                                        02320000
       01  WA-NAMES.                                                    02330000
           05  FILLER                  PIC X(10) VALUE '3ONE      '.    02340000
           05  FILLER                  PIC X(10) VALUE '3TWO      '.    02350000
           05  FILLER                  PIC X(10) VALUE '5THREE    '.    02360000
           05  FILLER                  PIC X(10) VALUE '4FOUR     '.    02370000
           05  FILLER                  PIC X(10) VALUE '4FIVE     '.    02380000
           05  FILLER                  PIC X(10) VALUE '3SIX      '.    02390000
           05  FILLER                  PIC X(10) VALUE '5SEVEN    '.    02400000
           05  FILLER                  PIC X(10) VALUE '5EIGHT    '.    02410000
           05  FILLER                  PIC X(10) VALUE '4NINE     '.    02420000
           05  FILLER                  PIC X(10) VALUE '3TEN      '.    02430000
           05  FILLER                  PIC X(10) VALUE '6ELEVEN   '.    02440000
           05  FILLER                  PIC X(10) VALUE '6TWELVE   '.    02450000
           05  FILLER                  PIC X(10) VALUE '8THIRTEEN '.    02460000
           05  FILLER                  PIC X(10) VALUE '8FOURTEEN '.    02470000
           05  FILLER                  PIC X(10) VALUE '7FIFTEEN  '.    02480000
           05  FILLER                  PIC X(10) VALUE '7SIXTEEN  '.    02490000
           05  FILLER                  PIC X(10) VALUE '9SEVENTEEN'.    02500000
           05  FILLER                  PIC X(10) VALUE '8EIGHTEEN '.    02510000
           05  FILLER                  PIC X(10) VALUE '8NINETEEN '.    02520000
           05  FILLER                  PIC X(10) VALUE '6TWENTY   '.    02530000
           05  FILLER                  PIC X(10) VALUE '6THIRTY   '.    02540000
           05  FILLER                  PIC X(10) VALUE '5FORTY    '.    02550000
           05  FILLER                  PIC X(10) VALUE '5FIFTY    '.    02560000
           05  FILLER                  PIC X(10) VALUE '5SIXTY    '.    02570000
           05  FILLER                  PIC X(10) VALUE '7SEVENTY  '.    02580000
           05  FILLER                  PIC X(10) VALUE '6EIGHTY   '.    02590000
           05  FILLER                  PIC X(10) VALUE '6NINETY   '.    02600000
       01  WA-NAMER REDEFINES WA-NAMES.                                 02610000
           05  WA-NAME                 PIC X(10) OCCURS 27 TIMES.       02620000
                                                                        02630000
       01  WS-LITERALS.                                                 02640000
           05  L-CENT                  PIC X(05) VALUE '4CENT'.         02650000
           05  L-AND                   PIC X(04) VALUE '3AND'.          02660000
           05  L-X                     PIC X(01) VALUE '%'.             02670000
           05  L-MILLION               PIC X(08) VALUE '7MILLION'.      02680000
           05  L-THOUSAND              PIC X(09) VALUE '8THOUSAND'.     02690000
           05  L-DOLLARS               PIC X(08) VALUE '7DOLLARS'.      02700000
           05  L-CENTS                 PIC X(06) VALUE '6CENTS'.        02710000
           05  L-ONLY                  PIC X(06) VALUE '5ONLY '.        02720000
           05  L-HUNDRED               PIC X(08) VALUE '7HUNDRED'.      02730000
           05  L-DOLLAR                PIC X(07) VALUE '6DOLLAR'.       02740000
                                                                        02750000
       01  SWITCHES.                                                    02760000
           05  WS-SWITCH               PIC 9(01) VALUE ZEROES.          02770000
           05  WS-THO-SW               PIC 9(01) VALUE ZEROES.          02780000
           05  WS-CNT-SW               PIC 9(01) VALUE ZEROES.          02790000
           05  WS-LIT-SW               PIC 9(01) VALUE ZEROES.          02800000
           05  WS-TEN-SW               PIC 9(01) VALUE ZEROES.          02810000
           05  WS-AND-SW               PIC 9(01) VALUE ZEROES.          02820000
                                                                        02830000
       01  WS-CHEQUE-DETAILS.                                           02840000
           05  WS-AMT                  PIC 9(07)V99 VALUE ZEROES.       02850000
           05  WS-DIGIT REDEFINES  WS-AMT OCCURS 9 TIMES PIC 9.         02860000
           05  WF-DETAILS.                                              02870000
               10  WF-LINE-1           PIC X(60).                       02880000
               10  WF-LINE-2           PIC X(60).                       02890000
           05  WF-ITEM REDEFINES WF-DETAILS OCCURS 120 PIC X.           02900000
           05  WP-ITEM REDEFINES WF-DETAILS OCCURS 2 PIC X(60).         02910000
                                                                        02920000
      *--------------------------------*                                02930000
      * VARIABLES FOR AG07C907         *                                02940000
      *--------------------------------*                                02950000
       COPY AG7C907C.                                                   02960000
                                                                        02970000
      *--------------------------------*                                02980000
      * VARIABLES FOR BP13C906         *                                02990000
      *--------------------------------*                                03000000
       COPY P13C906C.                                                   03010000
                                                                        03020000
      *--------------------------------*                                03030000
      * VARIABLES FOR AB05C902         *                                03040000
      *--------------------------------*                                03050000
       COPY AB05902C.                                                   03060000
                                                                        03070000
      *--------------------------------*                                03080000
      * REPORT LAYOUT FOR SUB-TRANSFER *                                03090000
      *--------------------------------*                                03100000
       01  L35F-HEADER-01.                                              03110000
           05  L35F-REPORT-ID          PIC X(08) VALUE SPACES.          03120000
           05  FILLER                  PIC X(10) VALUE '      HDB3'.    03130000
           05  FILLER                  PIC X(28) VALUE SPACES.          03140000
           05  FILLER                  PIC X(39) VALUE                  03150000
               'S Y S T E M   O F   C O M M I T M E N T'.               03160000
           05  FILLER                  PIC X(12) VALUE SPACES.          03170000
           05  FILLER                  PIC X(07) VALUE 'DATE : '.       03180000
           05  L35F-CURRENT-DATE       PIC X(10) VALUE SPACES.          03190000
           05  FILLER                  PIC X(06) VALUE SPACES.          03200000
           05  FILLER                  PIC X(07) VALUE 'PAGE : '.       03210000
           05  L35F-PAGE               PIC ZZZZ9.                       03220000
                                                                        03230000
       01  L35F-HEADER-02.                                              03240000
           05  FILLER                  PIC X(30) VALUE                  03250000
               'HOUSING AND DEVELOPMENT BOARD'.                         03260000
           05  FILLER                  PIC X(05) VALUE SPACES.          03270000
           05  FILLER                  PIC X(70) VALUE                  03280000
               '        P A Y M E N T   V O U C H E R                   03290000
      -        '              '.                                        03300000
           05  FILLER                  PIC X(05) VALUE SPACES.          03310000
           05  L35F-COPY-NAME          PIC X(20) VALUE SPACES.          03320000
                                                                        03330000
       01  L35F-HEADER-2A.                                              03340000
           05  FILLER                  PIC X(35) VALUE SPACES.          03350000
           05  FILLER                  PIC X(70) VALUE                  03360000
               'AGREEMENT FOR LEASE AND DEED OF ASSIGNMENT (SUB-TRANSFER03370000
      -        ') FOR DAWSON  '.                                        03380000
           05  FILLER                  PIC X(25) VALUE SPACES.          03390000
                                                                        03400000
       01  L35F-HEADER-03.                                              03410000
           05  FILLER                  PIC X(27) VALUE                  03420000
               'SALES UNIT (AGREEMENT TEAM)'.                           03430000
           05  FILLER                  PIC X(31) VALUE SPACES.          03440000
           05  FILLER                  PIC X(27) VALUE                  03450000
               'FOR FINANCE DEPARTMENT USE'.                            03460000
           05  FILLER                  PIC X(12) VALUE SPACES.          03470000
           05  FILLER                  PIC X(12) VALUE 'BATCH NO   :'.  03480000
           05  FILLER                  PIC X(01) VALUE SPACES.          03490000
           05  L35F-BATCH-NO           PIC X(15) VALUE SPACES.          03500000
                                                                        03510000
       01  L35F-HEADER-04.                                              03520000
           05  FILLER                  PIC X(17) VALUE                  03530000
               'SYSTEM CODE  : 04'.                                     03540000
           05  FILLER                  PIC X(41) VALUE SPACES.          03550000
           05  FILLER                  PIC X(12) VALUE 'CHECKED BY :'.  03560000
           05  FILLER                  PIC X(27) VALUE SPACES.          03570000
           05  FILLER                  PIC X(12) VALUE 'VOUCHER NO :'.  03580000
           05  FILLER                  PIC X(01) VALUE SPACES.          03590000
           05  L35F-VOUCHER-NO         PIC X(11) VALUE SPACES.          03600000
                                                                        03610000
       01  L35F-HEADER-05.                                              03620000
           05  FILLER                  PIC X(28) VALUE                  03630000
              'GL CODE      : 0000000104250'.                           03640000
                                                                        03650000
       01  L35F-HEADER-06.                                              03660000
           05  FILLER                  PIC X(25) VALUE                  03670000
              'DESCRIPTION  : STAMP FEES'.                              03680000
                                                                        03690000
       01  L35F-HEADER-07.                                              03700000
           05  FILLER                  PIC X(44) VALUE                  03710000
              'PAYABLE TO   : COMMISSIONER OF STAMP DUTIES'.            03720000
           05  FILLER                  PIC X(14) VALUE SPACES.          03730000
           05  FILLER                  PIC X(12) VALUE 'BANK   : DBS'.  03740000
           05  FILLER                  PIC X(27) VALUE  SPACES.         03750000
           05  FILLER                  PIC X(26) VALUE                  03760000
               'BANK CODE    : DBSSSGSGXXX'.                            03770000
                                                                        03780000
       01  L35F-HEADER-08.                                              03790000
           05  FILLER                  PIC X(25) VALUE                  03800000
              'A/C NO       : 0010468600'.                              03810000
           05  FILLER                  PIC X(33) VALUE SPACES.          03820000
                                                                        03830000
       01  L35F-HEADER-09.                                              03840000
           05  FILLER                  PIC X(62) VALUE                  03850000
               'REMITTANCE ADVICE DESPATCH TO : C/O SC(STAMPING) OF SALE03860000
      -        'S UNIT'.                                                03870000
                                                                        03880000
       01  L35F-HEADER-10.                                              03890000
           05  FILLER                  PIC X(37) VALUE SPACES.          03900000
           05  FILLER                  PIC X(13) VALUE 'FLAT ADDRESS/'. 03910000
           05  FILLER                  PIC X(19) VALUE SPACES.          03920000
           05  FILLER                  PIC X(3)  VALUE 'DOC'.           03930000
           05  FILLER                  PIC X(5)  VALUE SPACES.          03940000
           05  FILLER                  PIC X(09) VALUE 'AGREEMENT'.     03950000
           05  FILLER                  PIC X(02) VALUE SPACES.          03960000
           05  FILLER                  PIC X(05) VALUE 'DUP  '.         03970000
           05  FILLER                  PIC X(02) VALUE SPACES.          03980000
           05  FILLER                  PIC X(08) VALUE 'DOA'.           03990000
           05  FILLER                  PIC X(03) VALUE SPACES.          04000000
           05  FILLER                  PIC X(05) VALUE 'DUP '.          04010000
           05  FILLER                  PIC X(03) VALUE SPACES.          04020000
           05  FILLER                  PIC X(05) VALUE 'SSD '.          04030000
                                                                        04040000
       01  L35F-HEADER-11.                                              04050000
           05  FILLER                  PIC X(04) VALUE 'S/NO'.          04060000
           05  FILLER                  PIC X(01) VALUE SPACES.          04070000
           05  FILLER                  PIC X(10) VALUE 'SCH-ACC-NO'.    04080000
           05  FILLER                  PIC X(05) VALUE SPACES.          04090000
           05  FILLER                  PIC X(07) VALUE 'REGN NO'.       04100000
           05  FILLER                  PIC X(02) VALUE SPACES.          04110000
           05  FILLER                  PIC X(05) VALUE 'BLOCK'.         04120000
           05  FILLER                  PIC X(03) VALUE SPACES.          04130000
           05  FILLER                  PIC X(11) VALUE                  04140000
               'STREET NAME'.                                           04150000
           05  FILLER                  PIC X(09) VALUE SPACES.          04160000
           05  FILLER                  PIC X(07) VALUE 'FLAT NO'.       04170000
           05  FILLER                  PIC X(05) VALUE SPACES.          04180000
           05  FILLER                  PIC X(04) VALUE 'DATE'.          04190000
           05  FILLER                  PIC X(04) VALUE SPACES.          04200000
           05  FILLER                  PIC X(09) VALUE 'FOR LEASE'.     04210000
           05  FILLER                  PIC X(03) VALUE SPACES.          04220000
           05  FILLER                  PIC X(04) VALUE 'SA'.            04230000
           05  FILLER                  PIC X(01) VALUE SPACES.          04240000
           05  FILLER                  PIC X(10) VALUE '(TRANSFER)'.    04250000
           05  FILLER                  PIC X(02) VALUE SPACES.          04260000
           05  FILLER                  PIC X(05) VALUE 'DOA  '.         04270000
           05  FILLER                  PIC X(13) VALUE SPACES.          04280000
           05  FILLER                  PIC X(05) VALUE 'TOTAL'.         04290000
                                                                        04300000
       01  L35F-DETAIL.                                                 04310000
           05  L35F-SNO                PIC ZZZ9.                        04320000
           05  FILLER                  PIC X(01) VALUE SPACES.          04330000
           05  L35F-SCH-ACC            PIC X(14) VALUE SPACES.          04340000
           05  FILLER                  PIC X(01) VALUE SPACES.          04350000
           05  L35F-REGN-NO            PIC X(08) VALUE SPACES.          04360000
           05  FILLER                  PIC X(01) VALUE SPACES.          04370000
           05  L35F-BLK-NO             PIC X(05) VALUE SPACES.          04380000
           05  FILLER                  PIC X(01) VALUE SPACES.          04390000
           05  L35F-STREET             PIC X(20) VALUE SPACES.          04400000
           05  FILLER                  PIC X(02) VALUE SPACES.          04410000
           05  L35F-FLAT-NO.                                            04420000
               10  L35F-CONST-1        PIC X(01) VALUE '#'.             04430000
               10  L35F-LEVEL-NO       PIC X(02) VALUE SPACES.          04440000
               10  L35F-CONST-2        PIC X(01) VALUE '-'.             04450000
               10  L35F-UNIT-NO        PIC X(04) VALUE SPACES.          04460000
           05  FILLER                  PIC X(01) VALUE SPACES.          04470000
           05  L35F-AFL-DATE           PIC X(10) VALUE SPACES.          04480000
           05  FILLER                  PIC X(01) VALUE SPACES.          04490000
           05  L35F-LEASE              PIC $$,$$9.99.                   04500000
           05  FILLER                  PIC X(01) VALUE SPACES.          04510000
           05  L35F-DUP-LEASE          PIC $9.99.                       04520000
           05  FILLER                  PIC X(02) VALUE SPACES.          04530000
           05  L35F-DOA                PIC $$,$$9.99.                   04540000
           05  FILLER                  PIC X(01) VALUE SPACES.          04550000
           05  L35F-DUP-DOA            PIC $9.99.                       04560000
           05  FILLER                  PIC X(01) VALUE SPACES.          04570000
           05  L35F-SSD                PIC $$$,$$9.99.                  04580000
           05  FILLER                  PIC X(02) VALUE SPACES.          04590000
           05  L35F-TOTAL              PIC $$$,$$9.99.                  04600000
                                                                        04610000
       01  L35F-TOTAL-LINE.                                             04620000
           05  FILLER                  PIC X(20) VALUE SPACES.          04630000
           05  FILLER                  PIC X(20) VALUE 'SERIAL NO :(000104640000
      -        ' TO '.                                                  04650000
           05  L35F-HIGH-NO            PIC 9(04) VALUE ZEROES.          04660000
           05  FILLER                  PIC X(01) VALUE ')'.             04670000
           05  FILLER                  PIC X(05) VALUE SPACES.          04680000
           05  FILLER                  PIC X(08) VALUE 'TOTAL : '.      04690000
           05  FILLER                  PIC X(18) VALUE SPACES.          04700000
           05  L35F-TOTAL-ACTUAL-LEASE PIC $$$,$$9.99.                  04710000
           05  FILLER                  PIC X(01) VALUE SPACES.          04720000
           05  L35F-TOTAL-DUP-LEASE    PIC $9.99.                       04730000
           05  FILLER                  PIC X(01) VALUE SPACES.          04740000
           05  L35F-TOTAL-DOA          PIC $$$,$$9.99.                  04750000
           05  FILLER                  PIC X(01) VALUE SPACES.          04760000
           05  L35F-TOTAL-DUP-DOA      PIC $9.99.                       04770000
           05  FILLER                  PIC X(01) VALUE SPACES.          04780000
           05  L35F-TOTAL-SSD          PIC $$$,$$9.99.                  04790000
           05  FILLER                  PIC X(01) VALUE SPACES.          04800000
           05  L35F-TOTAL-COMPUTED     PIC $$$$,$$9.99.                 04810000
                                                                        04820000
       01  L35F-DASH-LINE.                                              04830000
           05  FILLER                  PIC X(77) VALUE SPACES.          04840000
           05  FILLER                  PIC X(59) VALUE ALL '-'.         04850000
                                                                        04860000
       01  L35F-TRAILER-01.                                             04870000
           05  FILLER                  PIC X(12) VALUE 'NET PAYABLE:'.  04880000
           05  FILLER                  PIC X(02) VALUE SPACES.          04890000
           05  L35F-AMT-WORDS.                                          04900000
               10  L35F-AMT-DESC1      PIC X(60) VALUE SPACES.          04910000
               10  L35F-AMT-DESC2      PIC X(60) VALUE SPACES.          04920000
                                                                        04930000
       01  L35F-TRAILER-02.                                             04940000
           05  FILLER                  PIC X(30) VALUE SPACES.          04950000
           05  FILLER                  PIC X(11) VALUE 'CHECKED BY:'.   04960000
           05  FILLER                  PIC X(25) VALUE ALL '_'.         04970000
           05  FILLER                  PIC X(09) VALUE SPACES.          04980000
           05  FILLER                  PIC X(13) VALUE 'CERTIFIED BY:'. 04990000
           05  FILLER                  PIC X(25) VALUE ALL '_'.         05000000
                                                                        05010000
      *-----------------------------------------------------------*     05020000
      *    DEFINE P13C35FD REPORT LINES                           *     05030000
      *-----------------------------------------------------------*     05040000
       01  L35FD-HEADER2.                                               05050000
           05  FILLER                    PIC X(47) VALUE SPACES.        05060000
           05  FILLER                    PIC X(35)  VALUE               05070000
               'REPORT ON CASES WITH EARMARK ERROR'.                    05080000
                                                                        05090000
       01  L35FD-HEADER3.                                               05100000
           05  FILLER               PIC X(4)  VALUE 'S/NO'.             05110000
           05  FILLER               PIC X(3)  VALUE SPACE.              05120000
           05  FILLER               PIC X(10) VALUE 'SCH-ACC-NO'.       05130000
           05  FILLER               PIC X(9)  VALUE SPACES.             05140000
           05  FILLER               PIC X(8)  VALUE 'REGN NO'.          05150000
           05  FILLER               PIC X(5)  VALUE SPACE.              05160000
           05  FILLER               PIC X(13) VALUE 'JR VOUCHER NO'.    05170000
           05  FILLER               PIC X(5)  VALUE SPACES.             05180000
           05  FILLER               PIC X(12) VALUE 'TOTAL AMOUNT'.     05190000
           05  FILLER               PIC X(4)  VALUE SPACES.             05200000
           05  FILLER               PIC X(17) VALUE 'ERROR DESCRIPTION'.05210000
                                                                        05220000
       01  L35FD-REC-DETAIL.                                            05230000
           05  L35FD-SERIAL-NO              PIC ZZZ9.                   05240000
           05  FILLER                       PIC X(3)  VALUE SPACE.      05250000
           05  L35FD-SCH-ACC                PIC X(14) VALUE SPACES.     05260000
           05  FILLER                       PIC X(5)  VALUE SPACE.      05270000
           05  L35FD-REGN-NO                PIC X(8)  VALUE SPACES.     05280000
           05  FILLER                       PIC X(5)  VALUE SPACE.      05290000
           05  L35FD-JR-VCHR-NO             PIC X(13) VALUE SPACES.     05300000
           05  FILLER                       PIC X(5)  VALUE SPACES.     05310000
           05  L35FD-AMT-TOTAL              PIC $$$$,$$9.99.            05320000
           05  FILLER                       PIC X(5)  VALUE SPACES.     05330000
           05  L35FD-ERROR-DESC             PIC X(30).                  05340000
                                                                        05350000
       01  L35FD-UNDERLINE                  PIC X(132) VALUE ALL '-'.   05360000
                                                                        05370000
                                                                        05380000
      *-------------------*                                             05390000
       PROCEDURE DIVISION.                                              05400000
      *-------------------*                                             05410000
                                                                        05420000
      *--------------------------------*                                05430000
       0000-MAIN-ROUTINE.                                               05440000
      *--------------------------------*                                05450000
           PERFORM 1000-OPEN-FILES              THRU 1000-EXIT.         05460000
           PERFORM 2000-READ-BP13F315           THRU 2000-EXIT.         05470000
           PERFORM 3000-MAIN-ROUTINE            THRU 3000-EXIT          05480000
             UNTIL F315-REGN-NO = HIGH-VALUES.                          05490000
                                                                        05500000
      *-------> TO PRINT THE FOOTER OF DRAFT REPORT                     05510000
           IF WS-REPORT-TYPE = SPACES                                   05520000
             PERFORM 4310-PRINT-DRAFT-COMPTOTAL THRU 4310-EXIT          05530000
             PERFORM 4320-PRINT-DRAFT-FOOTER    THRU 4320-EXIT          05540000
             PERFORM 8200-INITIALIZE-VARIABLES  THRU 8200-EXIT          05550000
           END-IF.                                                      05560000
                                                                        05570000
      *-------> TO PRINT THE FOOTER OF FINAL REPORT                     05580000
           IF WS-REPORT-TYPE = 'V' AND WS-FOOTER-TAG = 'Y'              05590000
             PERFORM 6700-WRITE-AG07-TRL        THRU 6700-EXIT          05600000
             PERFORM 6800-WRITE-FINAL-COMPTOTAL THRU 6800-EXIT          05610000
             PERFORM 6900-WRITE-FINAL-FOOTER    THRU 6900-EXIT          05620000
             PERFORM 8200-INITIALIZE-VARIABLES  THRU 8200-EXIT          05630000
           END-IF.                                                      05640000
                                                                        05650000
           PERFORM 9000-CLOSE-FILES             THRU 9000-EXIT.         05660000
                                                                        05670000
       0000-EXIT.                                                       05680000
           EXIT.                                                        05690000
                                                                        05700000
                                                                        05710000
      *--------------------------------*                                05720000
       1000-OPEN-FILES.                                                 05730000
      *--------------------------------*                                05740000
           OPEN INPUT  BP13K330                                         05750000
                       BP13K800                                         05760000
                       BP13K893                                         05770000
                       BP13K410                                         05780000
                I-O    BP13F315                                         05790000
                       BP13K625                                         05800000
                OUTPUT AG07F225                                         05810000
                       P13L35FA                                         05820000
                       P13L35FB                                         05830000
                       P13L35FD.                                        05840000
                                                                        05850000
           IF WS-BP13K330-STATUS NOT = 00 AND NOT = 97                  05860000
              DISPLAY 'BP13K330 - OPEN FILE ERROR: ' WS-BP13K330-STATUS 05870000
              MOVE WS-BP13K330-STATUS  TO RETURN-CODE                   05880000
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                   05890000
           END-IF.                                                      05900000
                                                                        05910000
           IF WS-BP13K410-STATUS NOT = 00 AND NOT = 97                  05920000
              DISPLAY 'BP13K410 - OPEN FILE ERROR: ' WS-BP13K410-STATUS 05930000
              MOVE WS-BP13K410-STATUS  TO RETURN-CODE                   05940000
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                   05950000
           END-IF.                                                      05960000
                                                                        05970000
           IF WS-BP13K625-STATUS NOT = 00 AND NOT = 97                  05980000
              DISPLAY 'BP13K625 - OPEN FILE ERROR: ' WS-BP13K625-STATUS 05990000
              MOVE WS-BP13K625-STATUS  TO RETURN-CODE                   06000000
              PERFORM 9000-CLOSE-FILES THRU 9000-EXIT                   06010000
           END-IF.                                                      06020000
                                                                        06030000
                                                                        06040000
      *-------> FOR VOUCHER NUMBER                                      06050000
           MOVE 'AG07K960'             TO C907-NUM-FILENME.             06060000
                                                                        06070000
           CALL 'K960OPEN' USING AG07C907-AREA.                         06080000
                                                                        06090000
           IF C907-NUM-FILE-STATUS NOT = '00' AND '97'                  06100000
             DISPLAY 'AG07K960 OPEN FILE ERROR: ' C907-NUM-FILE-STATUS  06110000
             MOVE C907-NUM-FILE-STATUS TO WS-AG07-STAT-X                06120000
             MOVE WS-AG07-STATUS       TO RETURN-CODE                   06130000
             PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT                   06140000
           END-IF.                                                      06150000
                                                                        06160000
      *-------> FOR BATCH NO                                            06170000
           MOVE 'BP13K620'             TO C906-NUM-FILENME.             06180000
                                                                        06190000
           CALL 'K620OPEN' USING BP13C906-AREA.                         06200000
                                                                        06210000
           IF C906-NUM-FILE-STATUS NOT = '00' AND '97'                  06220000
             DISPLAY 'BP13K620 OPEN FILE ERROR: ' C906-NUM-FILE-STATUS  06230000
             MOVE C906-NUM-FILE-STATUS TO RETURN-CODE                   06240000
             PERFORM  9000-CLOSE-FILES THRU 9000-EXIT                   06250000
           END-IF.                                                      06260000
                                                                        06270000
      **CALL AB05C902 TO OPEN B05K006 AND AB05K009 FILES(CODE='O')      06280000
           MOVE SPACES              TO   WS-B902-AREA.                  06290000
           INITIALIZE                    WS-B902-AREA.                  06300000
           MOVE 'O'                 TO   B902-CDE-TYPE.                 06310000
           CALL 'AB05C902'  USING WS-B902-AREA.                         06320000
                                                                        06330000
           IF B902-CDE-ERROR NOT = ZEROES                               06340000
              MOVE B902-CDE-SYSERR      TO   RETURN-CODE                06350000
              DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'             06360000
              PERFORM  9000-CLOSE-FILES  THRU 9000-EXIT                 06370000
           END-IF.                                                      06380000
                                                                        06390000
           MOVE FUNCTION CURRENT-DATE(1:8)  TO WS-SYS-DATE.             06400000
                                                                        06410000
       1000-EXIT.                                                       06420000
           EXIT.                                                        06430000
                                                                        06440000
                                                                        06450000
      *--------------------------------*                                06460000
       2000-READ-BP13F315.                                              06470000
      *--------------------------------*                                06480000
           READ BP13F315                                                06490000
             AT END MOVE HIGH-VALUES   TO F315-REGN-NO                  06500000
             GO TO  2000-EXIT.                                          06510000
                                                                        06520000
           ADD 1                       TO WS-BP13F315-READ.             06530000
                                                                        06540000
       2000-EXIT.                                                       06550000
           EXIT.                                                        06560000
                                                                        06570000
                                                                        06580000
      *--------------------------------*                                06590000
       3000-MAIN-ROUTINE.                                               06600000
      *--------------------------------*                                06610000
                                                                        06620000
      * TEST !!!                                                        06630000
      *    MOVE 'V' TO F315-CDE-RELEASE-PAYMENT                         06640000
      * TEST !!!                                                        06650000
           IF F315-FLAG-DAWSON NOT = 'Y'                                06660000
              PERFORM 2000-READ-BP13F315    THRU 2000-EXIT              06670000
              GO TO 3000-EXIT                                           06680000
           END-IF.                                                      06690000
                                                                        06700000
                                                                        06710000
           EVALUATE TRUE                                                06720000
                                                                        06730000
           WHEN F315-CDE-RELEASE-PAYMENT = SPACES                       06740000
             MOVE SPACES                       TO WS-REPORT-TYPE        06750000
             PERFORM 4000-PROCESS-DRAFT-REPORT THRU 4000-EXIT           06760000
           WHEN F315-CDE-RELEASE-PAYMENT = 'V'                          06770000
             MOVE 'V'                          TO WS-REPORT-TYPE        06780000
             PERFORM 6000-PROCESS-FINAL-REPORT THRU 6000-EXIT           06790000
                                                                        06800000
           END-EVALUATE.                                                06810000
                                                                        06820000
           PERFORM 2000-READ-BP13F315          THRU 2000-EXIT.          06830000
                                                                        06840000
       3000-EXIT.                                                       06850000
           EXIT.                                                        06860000
                                                                        06870000
                                                                        06880000
      *------->                                                         06890000
      * FOR DRAFT REPORT COPY                                           06900000
      *--------------------------------*                                06910000
       4000-PROCESS-DRAFT-REPORT.                                       06920000
      *--------------------------------*                                06930000
           PERFORM 8000-MOVE-DATA         THRU 8000-EXIT.               06940000
                                                                        06950000
           IF WS-NEW-VOUCHER-NO  = 'Y'                                  06960000
             PERFORM 4100-PRINT-DRAFT-HDR THRU 4100-EXIT                06970000
             MOVE 'N'                     TO WS-NEW-VOUCHER-NO          06980000
           END-IF.                                                      06990000
                                                                        07000000
           PERFORM 4200-PRINT-DRAFT-DTL   THRU 4200-EXIT.               07010000
           MOVE 'U'                       TO F315-CDE-RELEASE-PAYMENT.  07020000
           MOVE WS-TOTAL                  TO F315-AMT-STAMP-DUTIES.     07030000
           REWRITE BP13F315-TRANS-REC.                                  07040000
           ADD 1                          TO WS-BP13F315-REWRT.         07050000
                                                                        07060000
       4000-EXIT.                                                       07070000
           EXIT.                                                        07080000
                                                                        07090000
                                                                        07100000
      *--------------------------------*                                07110000
       4100-PRINT-DRAFT-HDR.                                            07120000
      *--------------------------------*                                07130000
           MOVE SPACES                 TO L35FA-PRINT-REC.              07140000
                                                                        07150000
           MOVE 'P13L35FA'             TO L35F-REPORT-ID.               07160000
                                                                        07170000
           ADD 1                       TO WS-PAGENO-CTR.                07180000
           MOVE WS-PAGENO-CTR          TO L35F-PAGE.                    07190000
                                                                        07200000
           STRING WS-SYS-DATE(7:2) '/' WS-SYS-DATE(5:2) '/'             07210000
                  WS-SYS-DATE(1:4)                                      07220000
                  DELIMITED BY SIZE    INTO L35F-CURRENT-DATE.          07230000
                                                                        07240000
           WRITE L35FA-PRINT-REC       FROM L35F-HEADER-01 AFTER PAGE.  07250000
           WRITE L35FA-PRINT-REC       FROM L35F-HEADER-02 AFTER 1.     07260000
           WRITE L35FA-PRINT-REC       FROM L35F-HEADER-2A AFTER 1.     07270000
           WRITE L35FA-PRINT-REC       FROM L35F-HEADER-03 AFTER 2.     07280000
           WRITE L35FA-PRINT-REC       FROM L35F-HEADER-04 AFTER 2.     07290000
           WRITE L35FA-PRINT-REC       FROM L35F-HEADER-05 AFTER 1.     07300000
           WRITE L35FA-PRINT-REC       FROM L35F-HEADER-06 AFTER 1.     07310000
           WRITE L35FA-PRINT-REC       FROM L35F-HEADER-07 AFTER 1.     07320000
           WRITE L35FA-PRINT-REC       FROM L35F-HEADER-08 AFTER 1.     07330000
           WRITE L35FA-PRINT-REC       FROM L35F-HEADER-09 AFTER 1.     07340000
           WRITE L35FA-PRINT-REC       FROM L35F-HEADER-10 AFTER 3.     07350000
           WRITE L35FA-PRINT-REC       FROM L35F-HEADER-11 AFTER 1.     07360000
                                                                        07370000
           MOVE SPACES                 TO L35FA-PRINT-REC.              07380000
           WRITE L35FA-PRINT-REC        AFTER 1.                        07390000
                                                                        07400000
       4100-EXIT.                                                       07410000
           EXIT.                                                        07420000
                                                                        07430000
                                                                        07440000
      *--------------------------------*                                07450000
       4200-PRINT-DRAFT-DTL.                                            07460000
      *--------------------------------*                                07470000
           ADD 1                        TO WS-LINE-CTR.                 07480000
                                                                        07490000
           MOVE SPACES                  TO L35FA-PRINT-REC.             07500000
           MOVE WS-LINE-CTR             TO L35F-SNO.                    07510000
                                                                        07520000
           WRITE L35FA-PRINT-REC        FROM L35F-DETAIL AFTER 1.       07530000
                                                                        07540000
           PERFORM 4300-PRINT-DRAFT-TRL THRU 4300-EXIT.                 07550000
                                                                        07560000
       4200-EXIT.                                                       07570000
           EXIT.                                                        07580000
                                                                        07590000
                                                                        07600000
      *--------------------------------*                                07610000
       4300-PRINT-DRAFT-TRL.                                            07620000
      *--------------------------------*                                07630000
           IF WS-LINE-CTR = 25 OR F315-REGN-NO = HIGH-VALUES            07640000
             PERFORM 4310-PRINT-DRAFT-COMPTOTAL THRU 4310-EXIT          07650000
             PERFORM 4320-PRINT-DRAFT-FOOTER    THRU 4320-EXIT          07660000
             PERFORM 8200-INITIALIZE-VARIABLES  THRU 8200-EXIT          07670000
           END-IF.                                                      07680000
                                                                        07690000
       4300-EXIT.                                                       07700000
           EXIT.                                                        07710000
                                                                        07720000
                                                                        07730000
      *--------------------------------*                                07740000
       4310-PRINT-DRAFT-COMPTOTAL.                                      07750000
      *--------------------------------*                                07760000
           WRITE L35FA-PRINT-REC       FROM L35F-DASH-LINE AFTER 3.     07770000
                                                                        07780000
           MOVE WS-LINE-CTR            TO L35F-HIGH-NO.                 07790000
           MOVE WS-TOTAL-DOA           TO L35F-TOTAL-DOA.               07800000
           MOVE WS-TOTAL-SSD           TO L35F-TOTAL-SSD.               07810000
           MOVE WS-TOTAL-DUP-DOA       TO L35F-TOTAL-DUP-DOA.           07820000
           MOVE WS-TOTAL-DUP-LEASE     TO L35F-TOTAL-DUP-LEASE.         07830000
           MOVE WS-TOTAL-ACTUAL-LEASE  TO L35F-TOTAL-ACTUAL-LEASE.      07840000
           MOVE WS-TOTAL-COMPUTED      TO L35F-TOTAL-COMPUTED.          07850000
                                                                        07860000
           WRITE L35FA-PRINT-REC       FROM L35F-TOTAL-LINE AFTER 1.    07870000
           WRITE L35FA-PRINT-REC       FROM L35F-DASH-LINE AFTER 1.     07880000
                                                                        07890000
       4310-EXIT.                                                       07900000
           EXIT.                                                        07910000
                                                                        07920000
                                                                        07930000
      *--------------------------------*                                07940000
       4320-PRINT-DRAFT-FOOTER.                                         07950000
      *--------------------------------*                                07960000
           MOVE WS-TOTAL-COMPUTED      TO WS-AMT.                       07970000
                                                                        07980000
           PERFORM 8300-CONVT-AMT-WORD THRU 8300-EXIT.                  07990000
                                                                        08000000
           MOVE WP-ITEM (1)            TO L35F-AMT-DESC1.               08010000
           MOVE WP-ITEM (2)            TO L35F-AMT-DESC2.               08020000
                                                                        08030000
           WRITE L35FA-PRINT-REC       FROM L35F-TRAILER-01 AFTER 2.    08040000
           WRITE L35FA-PRINT-REC       FROM L35F-TRAILER-02 AFTER 3.    08050000
                                                                        08060000
       4320-EXIT.                                                       08070000
           EXIT.                                                        08080000
                                                                        08090000
                                                                        08100000
      *------->                                                         08110000
      * FOR THE FINAL REPORT COPY                                       08120000
      *--------------------------------*                                08130000
       6000-PROCESS-FINAL-REPORT.                                       08140000
      *--------------------------------*                                08150000
           PERFORM 8000-MOVE-DATA        THRU 8000-EXIT.                08160000
           PERFORM 8100-CALL-BP13C906    THRU 8100-EXIT.                08170000
           PERFORM 6100-CALL-AG07C907    THRU 6100-EXIT.                08180000
           PERFORM 6105-EARMARK-ACCOUNT  THRU 6105-EXIT.                08190000
                                                                        08200000
           IF B902-CDE-SYSERR NOT = ZEROES                              08210000
              DISPLAY 'ERROR CALLING AB05C902, STATUS = '               08220000
                       B902-CDE-SYSERR                                  08230000
              MOVE     '99'                 TO RETURN-CODE              08240000
              PERFORM  9000-CLOSE-FILES                                 08250000
           END-IF.                                                      08260000
                                                                        08270000
           IF B902-CDE-ERROR-ACCT(1) = SPACES                           08280000
              IF WS-NEW-HEADER = 'Y'                                    08290000
                 PERFORM 6110-WRITE-AG07-HDR THRU 6110-EXIT             08300000
                 MOVE 'N' TO  WS-NEW-HEADER                             08310000
                 MOVE 'Y' TO  WS-FOOTER-TAG                             08320000
              END-IF                                                    08330000
              PERFORM 6200-WRITE-AG07-TRANS THRU 6200-EXIT              08340000
              PERFORM 6300-WRITE-BP13K625   THRU 6300-EXIT              08350000
           END-IF.                                                      08360000
                                                                        08370000
       6000-EXIT.                                                       08380000
           EXIT.                                                        08390000
                                                                        08400000
                                                                        08410000
      *--------------------------------*                                08420000
       6100-CALL-AG07C907.                                              08430000
      *--------------------------------*                                08440000
           IF WS-NEW-VOUCHER-NO = 'Y'                                   08450000
      *      MOVE 'SU '                    TO C907-NUM-DDD              08460000
             MOVE 'SS '                    TO C907-NUM-DDD              08470000
             MOVE 'AG07K960'               TO C907-NUM-FILENME          08480000
                                                                        08490000
             CALL 'AG07C907'               USING AG07C907-AREA          08500000
                                                                        08510000
             EVALUATE C907-NUM-FILE-STATUS                              08520000
             WHEN 00                                                    08530000
               MOVE 'N'                    TO WS-NEW-VOUCHER-NO         08540000
             WHEN OTHER                                                 08550000
               DISPLAY 'AG07C907 - ERROR IN CALLING PROGRAM : '         08560000
                                              C907-NUM-FILE-STATUS      08570000
               MOVE C907-NUM-FILE-STATUS   TO WS-AG07-STAT-X            08580000
               MOVE WS-AG07-STATUS         TO RETURN-CODE               08590000
               PERFORM 9000-CLOSE-FILES    THRU 9000-EXIT               08600000
              END-EVALUATE                                              08610000
           END-IF.                                                      08620000
                                                                        08630000
       6100-EXIT.                                                       08640000
           EXIT.                                                        08650000
                                                                        08660000
                                                                        08670000
      *--------------------------------*                                08680000
       6105-EARMARK-ACCOUNT.                                            08690000
      *--------------------------------*                                08700000
      **CALL AB05C902 TO EARMARK ACCOUNT(CODE='E')                      08710000
           MOVE SPACES              TO   WS-B902-AREA.                  08720000
           INITIALIZE                    WS-B902-AREA.                  08730000
                                                                        08740000
           STRING C907-NUM-DDD  C907-NUM-FIN-YR                         08750000
                  C907-NUM-VR-SERIAL                                    08760000
                  DELIMITED BY SIZE INTO B902-VR-NO                     08770000
           END-STRING.                                                  08780000
                                                                        08790000
           MOVE 'E'                     TO   B902-CDE-TYPE.             08800000
           MOVE 'BP13'                  TO   B902-CDE-SYSTEMID.         08810000
           MOVE FUNCTION CURRENT-DATE   TO   B902-DTE-TRANS.            08820000
           MOVE 'P13C35F'               TO   B902-NUM-USERID-UPDATE.    08830000
           MOVE 'CV'                    TO   B902-CDE-EARMARK-REASON.   08840000
           MOVE 01                      TO   B902-NUM-HDB-REF-CNT.      08850000
           MOVE F315-SCH-ACC            TO   B902-NUM-HDB-REF(1).       08860000
           MOVE ZEROES                  TO   WS-AMT-EARMARK.            08870000
                                                                        08880000
           IF F315-AMT-LEASE-FEE NUMERIC                                08890000
              COMPUTE WS-AMT-EARMARK    = F315-AMT-LEASE-FEE     +      08900000
                                          F315-AMT-LEASE-FEE-DUP +      08910000
                                          F315-AMT-SUB-TRF-DOA   +      08920000
                                          F315-AMT-SUB-TRF-DOA-DUP +    08930000
                                          F315-AMT-SELLER-STAMP-DUTY    08940000
           ELSE                                                         08950000
              MOVE ZEROES               TO   WS-AMT-EARMARK             08960000
           END-IF.                                                      08970000
                                                                        08980000
           IF WS-AMT-EARMARK  =  ZEROES                                 08990000
              GO  TO  6105-EXIT                                         09000000
           END-IF.                                                      09010000
                                                                        09020000
           MOVE WS-AMT-EARMARK          TO   B902-AMT-EARMARK(1).       09030000
                                                                        09040000
           DISPLAY '----------------'.                                  09050000
           DISPLAY 'B902-VR-NO       = ' B902-VR-NO.                    09060000
           DISPLAY 'B902-CDE-TYPE    = ' B902-CDE-TYPE.                 09070000
           DISPLAY 'CDE-SYSTEMID     = ' B902-CDE-SYSTEMID.             09080000
           DISPLAY 'B902-DTE-TRANS   = ' B902-DTE-TRANS.                09090000
           DISPLAY 'NUM-USERID       = ' B902-NUM-USERID-UPDATE.        09100000
           DISPLAY 'HDB-REF-CNT      = ' B902-NUM-HDB-REF-CNT.          09110000
           DISPLAY 'NUM-HDB-REF      = ' B902-NUM-HDB-REF(1).           09120000
           DISPLAY 'B902-AMT-EARMARK = ' B902-AMT-EARMARK(1).           09130000
                                                                        09140000
           CALL 'AB05C902'  USING WS-B902-AREA.                         09150000
           DISPLAY 'CDE-ERROR-ACCT   = ' B902-CDE-ERROR-ACCT(1).        09160000
           DISPLAY 'CDE-ERROR-ACCT   = ' B902-CDE-ERROR-ACCT(1).        09170000
           EVALUATE B902-CDE-ERROR-ACCT(1)                              09180000
              WHEN SPACES                                               09190000
                 CONTINUE                                               09200000
              WHEN OTHER                                                09210000
                 COMPUTE WS-TOTAL-COMPUTED = WS-TOTAL-COMPUTED -        09220000
                                             WS-AMT-EARMARK             09230000
                 PERFORM 8500-PRINT-L35FD-REPORT     THRU 8500-EXIT     09240000
           END-EVALUATE.                                                09250000
                                                                        09260000
       6105-EXIT.                                                       09270000
           EXIT.                                                        09280000
                                                                        09290000
                                                                        09300000
      *--------------------------------*                                09310000
       6110-WRITE-AG07-HDR.                                             09320000
      *--------------------------------*                                09330000
           INITIALIZE AG07F225-HEADER.                                  09340000
                                                                        09350000
           MOVE SPACES                 TO AG07F225-HEADER.              09360000
           MOVE C907-NUM-DDD           TO F225-NUM-DDD.                 09370000
           MOVE C907-NUM-FIN-YR        TO F225-NUM-FIN-YEAR.            09380000
           MOVE C907-NUM-VR-SERIAL     TO F225-NUM-VR-SERIAL.           09390000
           MOVE F225-NUM-VR            TO WS-NUM-VOUCHER.               09400000
           MOVE SPACES                 TO F225-NUM-ROOT-ACCT.           09410000
           MOVE  00                    TO F225-NUM-REC-TYP.             09420000
           MOVE 'PV'                   TO F225-NUM-VR-TYP.              09430000
           MOVE 'TL'                   TO F225-NUM-VR-SUB-TYP.          09440000
           MOVE 'SOC'                  TO F225-NUM-TRANS-TYP.           09450000
                                                                        09460000
           MOVE WS-SYS-DATE            TO F225-DTE-VR-CREATE            09470000
                                          F225-DTE-VR-PRT-FINAL.        09480000
                                                                        09490000
           MOVE 'BP13C35F'             TO F225-NUM-VR-CREATE-USERID     09500000
                                          F225-NUM-VR-PRT-FINAL-USERID. 09510000
                                                                        09520000
           MOVE 'DBSSSGSGXXX'             TO F225-NUM-PAYEE-BANK        09530000
           MOVE SPACES                    TO F225-NUM-PAYEE-BANK-BRNCH  09540000
           MOVE '0010468600'              TO F225-NUM-PAYEE-IBG-ACCT.   09550000
           MOVE 'STPFEE  '                TO F225-NUM-DDD-FILE-REF.     09560000
           MOVE 'COMMISSIONER OF STAMP DUTIES'                          09570000
                                          TO F225-NME-PAYEE1.           09580000
           MOVE SPACES                    TO F225-NUM-PAYEE-UIN1.       09590000
           MOVE SPACES                    TO F225-NME-PAYEE2.           09600000
           MOVE SPACES                    TO F225-NUM-PAYEE-UIN2.       09610000
           MOVE SPACES                    TO F225-NUM-PAYEE-TAX-REGN.   09620000
           MOVE '55'                      TO F225-NUM-BLK-HSE.          09621001
           MOVE 'NEWTON ROAD'             TO F225-NME-STREET.           09622001
           MOVE 'REVENUE HOUSE'           TO F225-NME-BLDNG.            09623001
           MOVE '307987'                  TO F225-NUM-POSTAL.           09624001
      *    MOVE 'C/O SC(STAMPING) OF SALES UNIT'                        09630001
      *                                   TO F225-NME-STREET            09640001
           MOVE 'SALES AGREEMENT TEAM'    TO F225-NME-COLL-OFFCR.       09650000
           MOVE '64903783'                TO F225-NUM-COLL-OFFCR-PHONE. 09660000
           MOVE 'SALES AGREEMENT TEAM'    TO F225-NME-CONTACT-OFFCR.    09670000
           MOVE '64903783'                TO F225-NUM-CONTACT-PHONE.    09680000
           MOVE SPACES                    TO F225-TXT-REJECT-HDR.       09690000
           MOVE 'STPFEE  '                TO F225-NUM-INTRFC-FR-HDR.    09700000
           MOVE 'CV'                      TO F225-NUM-ACTION-TYP.       09710000
           MOVE SPACES                    TO F225-NUM-PRCS-TERM.        09720000
           MOVE SPACES                    TO F225-NUM-ROUTE-FLAG.       09730000
           MOVE 'Y'                   TO F225-CDE-EARMARK-STAMP-FEE.    09740000
           IF F315-USERID   = 'BP13P001'                                09750000
              MOVE WS-STAFF-START         TO F225-NUM-STAFF-ID-PREP     09760000
                                             F225-NUM-USERID-START      09770000
           ELSE                                                         09780000
              MOVE F315-USERID            TO F225-NUM-STAFF-ID-PREP     09790000
                                             F225-NUM-USERID-START      09800000
           END-IF.                                                      09810000
           MOVE 'PREP'                    TO F225-NUM-VCHR-STATE-START. 09820000
           MOVE SPACES                    TO F225-DTE-PYMNT-DUE.        09830000
                                                                        09840000
           WRITE AG07F225-HEADER.                                       09850000
                                                                        09860000
           ADD 1                         TO WS-AG07F225-WRITE.          09870000
                                                                        09880000
           PERFORM  6400-PRINT-FINAL-HDR THRU 6400-EXIT.                09890000
                                                                        09900000
       6110-EXIT.                                                       09910000
           EXIT.                                                        09920000
                                                                        09930000
                                                                        09940000
      *--------------------------------*                                09950000
       6200-WRITE-AG07-TRANS.                                           09960000
      *--------------------------------*                                09970000
           INITIALIZE AG07F225-TRANS.                                   09980000
           MOVE SPACES                 TO AG07F225-TRANS.               09990000
                                                                        10000000
           ADD 1                       TO WS-AG07F225-WRITE             10010000
                                          WS-AG07F225-SERIAL.           10020000
                                                                        10030000
           MOVE WS-NUM-VOUCHER         TO F225-NUM-VR-T.                10040000
           MOVE WS-AG07F225-SERIAL     TO F225-NUM-TRANS-SERIAL.        10050000
           MOVE '04'                   TO F225-NUM-SYS.                 10060000
           MOVE F315-SCH-ACC           TO F225-NUM-HDB-REF.             10070000
           MOVE '0000000104250'        TO F225-NUM-GL-ACCT.             10080000
           MOVE SPACES                 TO F225-NUM-TAX-CDE.             10090000
           MOVE 'D'                    TO F225-NUM-TRANS-DR-CR.         10100000
           MOVE ZEROES                 TO F225-AMT-TRANS-GST.           10110000
           MOVE F315-REGN-NO           TO F225-TXT-INFO.                10120000
           MOVE SPACES                 TO F225-NUM-CPF.                 10130000
           MOVE SPACES                 TO F225-TXT-REJECT-DTL.          10140000
           MOVE 'STPFEE  '             TO F225-NUM-INTRFC-FR-T.         10150000
                                                                        10160000
           IF F315-AMT-LEASE-FEE NUMERIC                                10170000
             MOVE WS-TOTAL              TO F225-AMT-TRANS               10180000
           ELSE                                                         10190000
             MOVE ZEROES                TO F225-AMT-TRANS.              10200000
                                                                        10210000
           WRITE AG07F225-TRANS.                                        10220000
                                                                        10230000
           PERFORM 6500-PRINT-FINAL-DTL THRU 6500-EXIT.                 10240000
                                                                        10250000
       6200-EXIT.                                                       10260000
           EXIT.                                                        10270000
                                                                        10280000
                                                                        10290000
      *--------------------------------*                                10300000
       6300-WRITE-BP13K625.                                             10310000
      *--------------------------------*                                10320000
            INITIALIZE BP13K625-REC.                                    10330000
            MOVE SPACES                    TO BP13K625-REC.             10340000
                                                                        10350000
            PERFORM 6340-ASSIGN-NUMDOC  THRU 6340-EXIT.                 10360000
            PERFORM 6350-READ-BP13K800  THRU 6350-EXIT.                 10370000
                                                                        10380000
            MOVE F315-SCH-ACC           TO WS-NUM-HDB-REF.              10390000
                                                                        10400000
            PERFORM 6360-WRITE-BP13K625 THRU 6360-EXIT.                 10410000
                                                                        10420000
       6300-EXIT.                                                       10430000
           EXIT.                                                        10440000
                                                                        10450000
                                                                        10460000
      *--------------------------------*                                10470000
       6310-STARTBR-BP13K330.                                           10480000
      *--------------------------------*                                10490000
           MOVE SPACES                 TO WS-NUM-INCREASE-SCCC.         10500000
           MOVE ZEROES                 TO WS-DTE-DOC-PREPARE            10510000
           MOVE ZEROES                 TO WS-AMT-PURCHASE-PRICE         10520000
                                          WS-BP13K330-FND.              10530000
                                                                        10540000
           MOVE LOW-VALUES             TO K330-KEY-FLD.                 10550000
           MOVE F315-REGN-NO           TO K330-CURR-REG.                10560000
                                                                        10570000
           START BP13K330 KEY >= K330-KEY-FLD                           10580000
                                                                        10590000
           IF WS-BP13K330-STATUS NOT = 00                               10600000
             DISPLAY 'BP13K330 READ FILE ERROR : ' WS-BP13K330-STATUS   10610000
           END-IF.                                                      10620000
                                                                        10630000
       6310-EXIT.                                                       10640000
           EXIT.                                                        10650000
                                                                        10660000
                                                                        10670000
      *--------------------------------*                                10680000
       6320-READNEXT-BP13K330.                                          10690000
      *--------------------------------*                                10700000
           READ BP13K330 NEXT AT END                                    10710000
             MOVE HIGH-VALUES          TO K330-KEY-FLD                  10720000
             GO TO 6320-EXIT.                                           10730000
                                                                        10740000
           EVALUATE WS-BP13K330-STATUS                                  10750000
           WHEN 00                                                      10760000
             IF F315-REGN-NO  = K330-CURR-REG                           10770000
               MOVE K330-AMT-CURR-SELLPR   TO WS-AMT-PURCHASE-PRICE     10780000
               MOVE K330-NUM-INCREASE-SCCC TO WS-NUM-INCREASE-SCCC      10790000
               ADD 1                       TO WS-BP13K330-FND           10800000
             END-IF                                                     10810000
           WHEN 10                                                      10820000
             IF WS-BP13K330-FND NOT > ZEROES                            10830000
                DISPLAY 'BP13K330 RECORD NOT FOUND: ' K330-CURR-REG     10840000
                ADD 1                      TO WS-BP13K330-NFND          10850000
             END-IF                                                     10860000
           WHEN 23                                                      10870000
             DISPLAY 'BP13K330 RECORD NOT FOUND: ' K330-CURR-REG        10880000
             ADD 1                         TO WS-BP13K330-NFND          10890000
                                                                        10900000
           WHEN OTHER                                                   10910000
             DISPLAY 'BP13K330 READ FILE ERROR : ' WS-BP13K330-STATUS   10920000
             MOVE WS-BP13K330-STATUS       TO RETURN-CODE               10930000
             PERFORM 9000-CLOSE-FILES      THRU 9000-EXIT               10940000
           END-EVALUATE.                                                10950000
                                                                        10960000
       6320-EXIT.                                                       10970000
           EXIT.                                                        10980000
                                                                        10990000
                                                                        11000000
      *--------------------------------*                                11010000
       6340-ASSIGN-NUMDOC.                                              11020000
      *--------------------------------*                                11030000
           PERFORM 6310-STARTBR-BP13K330  THRU 6310-EXIT.               11040000
           PERFORM 6320-READNEXT-BP13K330 THRU 6320-EXIT                11050000
             UNTIL F315-REGN-NO  NOT = K330-CURR-REG  OR                11060000
                   K330-KEY-FLD = HIGH-VALUES.                          11070000
                                                                        11080000
           MOVE F315-CDE-SUBTRANSFER-DOC  TO   WS-NUM-DOC.              11090000
                                                                        11100000
       6340-EXIT.                                                       11110000
           EXIT.                                                        11120000
                                                                        11130000
      *--------------------------------*                                11140000
       6350-READ-BP13K800.                                              11150000
      *--------------------------------*                                11160000
           MOVE SPACES                 TO BP13K800-MASTER.              11170000
           MOVE F315-REGN-NO           TO K800-NUM-REGN.                11180000
                                                                        11190000
           READ BP13K800.                                               11200000
           EVALUATE WS-BP13K800-STATUS                                  11210000
           WHEN 00                                                      11220000
             IF K800-NUM-FLAT-TYPE = SPACES OR LOW-VALUES               11230000
               MOVE ZEROES             TO WS-NUM-LEASE-TERM             11240000
             ELSE                                                       11250000
               IF K800-NUM-FLAT-TYPE = '1A' OR '2A'                     11260000
                 COMPUTE WS-NUM-LEASE-TERM = 30 * 12                    11270000
               ELSE                                                     11280000
                 COMPUTE WS-NUM-LEASE-TERM = 99 * 12                    11290000
               END-IF                                                   11300000
            END-IF                                                      11310000
            ADD 1                      TO WS-BP13K800-FND               11320000
           WHEN 23                                                      11330000
             PERFORM 6355-READ-BP13K893 THRU 6355-EXIT                  11340000
           WHEN OTHER                                                   11350000
             DISPLAY 'BP13K800 READ FILE ERROR : ' WS-BP13K800-STATUS   11360000
             MOVE WS-BP13K800-STATUS   TO RETURN-CODE                   11370000
             PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT                   11380000
           END-EVALUATE.                                                11390000
                                                                        11400000
       6350-EXIT.                                                       11410000
           EXIT.                                                        11420000
                                                                        11430000
      *--------------------------------*                                11440000
       6355-READ-BP13K893.                                              11450000
      *--------------------------------*                                11460000
                                                                        11470000
           MOVE SPACES                 TO BP13K893-MASTER.              11480000
           INITIALIZE                     BP13K893-MASTER.              11490000
           MOVE F315-REGN-NO           TO K893-NUM-REGN-HIST.           11500000
           MOVE 'N'                    TO WS-BP13K893-EOF               11510000
                                          WS-BP13K893-FND.              11520000
                                                                        11530000
           START BP13K893 KEY >= K893-KEY-FLD.                          11540000
                                                                        11550000
           EVALUATE WS-BP13K893-STATUS                                  11560000
           WHEN 00                                                      11570000
             WHEN 00                                                    11580000
                PERFORM 6356-NEXT-BP13K893    THRU 6356-EXIT            11590000
                  UNTIL K893-NUM-REGN-HIST NOT = F315-REGN-NO           11600000
                     OR WS-BP13K893-FND = 'Y'                           11610000
           WHEN 23                                                      11620000
                 DISPLAY 'NOT FOUND IN BP13K893' WS-BP13K893-STATUS     11630000
                 MOVE WS-BP13K893-STATUS   TO RETURN-CODE               11640000
                 PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT               11650000
           WHEN OTHER                                                   11660000
                 DISPLAY 'ERROR IN STARTBR K893' WS-BP13K893-STATUS     11670000
                 MOVE WS-BP13K893-STATUS   TO RETURN-CODE               11680000
                 PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT               11690000
           END-EVALUATE.                                                11700000
                                                                        11710000
           IF WS-BP13K893-FND = 'Y'                                     11720000
             MOVE BP13K893-MASTER(1:2000)   TO BP13K800-MASTER          11730000
             IF K800-NUM-FLAT-TYPE = SPACES OR LOW-VALUES               11740000
               MOVE ZEROES             TO WS-NUM-LEASE-TERM             11750000
             ELSE                                                       11760000
               IF K800-NUM-FLAT-TYPE = '1A' OR '2A'                     11770000
                 COMPUTE WS-NUM-LEASE-TERM = 30 * 12                    11780000
               ELSE                                                     11790000
                 COMPUTE WS-NUM-LEASE-TERM = 99 * 12                    11800000
               END-IF                                                   11810000
             END-IF                                                     11820000
           END-IF.                                                      11830000
                                                                        11840000
       6355-EXIT.                                                       11850000
           EXIT.                                                        11860000
                                                                        11870000
      *--------------------------------*                                11880000
       6356-NEXT-BP13K893.                                              11890000
      *--------------------------------*                                11900000
                                                                        11910000
           READ BP13K893 NEXT RECORD                                    11920000
             AT END                                                     11930000
                MOVE 'Y'                  TO WS-BP13K893-EOF            11940000
           END-READ.                                                    11950000
                                                                        11960000
           EVALUATE WS-BP13K893-STATUS                                  11970000
              WHEN 00                                                   11980000
              WHEN 02                                                   11990000
                 IF K893-NUM-REGN-HIST = F315-REGN-NO                   12000000
                    MOVE 'Y'            TO  WS-BP13K893-EOF             12010000
                    MOVE 'Y'            TO  WS-BP13K893-FND             12020000
                 END-IF                                                 12030000
              WHEN 10                                                   12040000
              WHEN 23                                                   12050000
                 DISPLAY 'NOT FOUND IN BP13K893' WS-BP13K893-STATUS     12060000
                 MOVE WS-BP13K893-STATUS   TO RETURN-CODE               12070000
                 PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT               12080000
              WHEN OTHER                                                12090000
                 DISPLAY 'ERROR IN READ NXT K893' WS-BP13K893-STATUS    12100000
                 MOVE WS-BP13K893-STATUS   TO RETURN-CODE               12110000
                 PERFORM 9000-CLOSE-FILES  THRU 9000-EXIT               12120000
           END-EVALUATE.                                                12130000
                                                                        12140000
       6356-EXIT.                                                       12150000
           EXIT.                                                        12160000
                                                                        12170000
                                                                        12180000
      *--------------------------------*                                12190000
       6360-WRITE-BP13K625.                                             12200000
      *--------------------------------*                                12210000
      *----> FOR F315-AMT-SUB-TRF-DOA                                   12220000
      *      WRITE DETAIL PART FOR ORIGINAL AGREEMENT LEASE             12230000
            MOVE 'O'                      TO WS-NUM-DOC-TYP.            12240000
            MOVE F315-AMT-SUB-TRF-DOA     TO WS-AMT-STAMP-DUTY.         12250000
            MOVE ZEROES                   TO WS-AMT-STAMP-DUTY-DUP.     12260000
                                                                        12270000
            IF   F315-AMT-SELLER-STAMP-DUTY IS NOT NUMERIC              12280000
            MOVE ZEROES   TO WS-AMT-SSD                                 12290000
                             F315-AMT-SELLER-STAMP-DUTY                 12300000
            ELSE                                                        12310000
            MOVE F315-AMT-SELLER-STAMP-DUTY TO WS-AMT-SSD               12320000
            END-IF.                                                     12330000
                                                                        12340000
            IF WS-NUM-DOC = 'TRA' OR 'TWF' OR 'RMP'                     12350000
               PERFORM 6370-CHK-EXISTING-BP13K625 THRU 6370-EXIT        12360000
               PERFORM 6390-MAIN-DETAILS-TO-K625  THRU 6390-EXIT        12370000
               MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY        12380000
               MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP    12390000
               MOVE WS-AMT-SSD            TO K625-AMT-SELLER-DUTY       12400000
               MOVE F315-AMT-LEASE-FEE TO K625-AMT-DAWSON-LEASE         12410000
               MOVE F315-AMT-SUB-TRF-DOA TO K625-AMT-DAWSON-DOA         12420000
               MOVE 'Y'                  TO K625-FLAG-DAWSON            12430000
               IF WS-NUM-DOC = 'TWF' OR 'RMP'                           12440000
                  IF WS-AMT-STAMP-DUTY  = ZEROES  AND                   12450000
                     K625-NUM-VRCH  NOT = WS-NUM-TEMP-VOUCHER           12460000
                     MOVE  K625-NUM-VRCH  TO      WS-NUM-TEMP-VOUCHER   12470000
                  END-IF                                                12480000
               END-IF                                                   12490000
               IF WS-NUM-DOC = 'TRA'                                    12500000
                COMPUTE K625-AMT-STAMP-DUTY = F315-AMT-LEASE-FEE +      12510000
                             F315-AMT-SUB-TRF-DOA                       12520000
               ELSE                                                     12530000
                MOVE F315-AMT-LEASE-FEE TO K625-AMT-STAMP-DUTY          12540000
               END-IF                                                   12550000
                                                                        12560000
               WRITE BP13K625-REC                                       12570000
               ADD 1  TO WS-BP13K625-WRITE                              12580000
                                                                        12590000
               IF WS-NUM-DOC = 'TWF' OR 'RMP' OR 'TRA'                  12600000
                  GO TO 6360-EXIT                                       12610000
               END-IF                                                   12620000
            END-IF.                                                     12630000
                                                                        12640000
      *----> FOR F315-AMT-SUB-TRF-DOA-DUP                               12650000
      *      WRITE DETAIL PART FOR DUPLICATE AGREEMENT LEASE            12660000
            MOVE 'D'                      TO WS-NUM-DOC-TYP.            12670000
            MOVE ZEROES                   TO WS-AMT-STAMP-DUTY.         12680000
            MOVE F315-AMT-SUB-TRF-DOA-DUP TO WS-AMT-STAMP-DUTY-DUP.     12690000
                                                                        12700000
            IF WS-NUM-DOC = 'TRA'                                       12710000
               PERFORM 6370-CHK-EXISTING-BP13K625 THRU 6370-EXIT        12720000
               PERFORM 6390-MAIN-DETAILS-TO-K625  THRU 6390-EXIT        12730000
               MOVE WS-AMT-STAMP-DUTY     TO K625-AMT-STAMP-DUTY        12740000
               MOVE WS-AMT-STAMP-DUTY-DUP TO K625-AMT-STAMP-DUTY-DUP    12750000
               MOVE WS-AMT-SSD            TO K625-AMT-SELLER-DUTY       12760000
               WRITE BP13K625-REC                                       12770000
               ADD 1  TO WS-BP13K625-WRITE                              12780000
            END-IF.                                                     12790000
                                                                        12800000
      *----> FOR F315-AMT-LEASE-FEE                                     12810000
      *      WRITE DETAIL PART FOR ORIGINAL AGREEMENT LEASE             12820000
            MOVE 'O'                    TO WS-NUM-DOC-TYP.              12830000
            MOVE 'ALE'                  TO WS-NUM-DOC.                  12840000
            PERFORM 6370-CHK-EXISTING-BP13K625 THRU 6370-EXIT.          12850000
            PERFORM 6390-MAIN-DETAILS-TO-K625  THRU 6390-EXIT.          12860000
            IF F315-AMT-LEASE-FEE NOT = ZEROES                          12870000
              MOVE F315-AMT-LEASE-FEE     TO K625-AMT-STAMP-DUTY        12880000
            ELSE                                                        12890000
              IF F315-AMT-SUB-TRF-DOA NOT = ZEROES                      12900000
                MOVE F315-AMT-SUB-TRF-DOA   TO K625-AMT-STAMP-DUTY      12910000
              ELSE                                                      12920000
                MOVE ZEROES                 TO K625-AMT-STAMP-DUTY      12930000
              END-IF                                                    12940000
            END-IF.                                                     12950000
            MOVE ZEROES                 TO K625-AMT-STAMP-DUTY-DUP.     12960000
            WRITE BP13K625-REC.                                         12970000
            ADD 1                       TO WS-BP13K625-WRITE.           12980000
                                                                        12990000
                                                                        13000000
      *----> FOR F315-AMT-SUB-TRF-DOA                                   13010000
      *      WRITE DETAIL PART FOR DUPLICATE AGREEMENT LEASE            13020000
            MOVE 'D'                    TO WS-NUM-DOC-TYP.              13030000
            MOVE 'ALE'                  TO WS-NUM-DOC.                  13040000
            PERFORM 6370-CHK-EXISTING-BP13K625 THRU 6370-EXIT.          13050000
            PERFORM 6390-MAIN-DETAILS-TO-K625  THRU 6390-EXIT.          13060000
            MOVE ZEROES                 TO K625-AMT-STAMP-DUTY.         13070000
            MOVE F315-AMT-LEASE-FEE-DUP TO K625-AMT-STAMP-DUTY-DUP.     13080000
            WRITE BP13K625-REC.                                         13090000
            ADD 1                       TO WS-BP13K625-WRITE.           13100000
                                                                        13110000
       6360-EXIT.                                                       13120000
           EXIT.                                                        13130000
                                                                        13140000
                                                                        13150000
      *--------------------------------*                                13160000
       6370-CHK-EXISTING-BP13K625.                                      13170000
      *--------------------------------*                                13180000
           MOVE WS-NUM-HDB-REF          TO K625-NUM-HDB-REF.            13190000
           MOVE WS-NUM-DOC              TO K625-NUM-DOC.                13200000
           MOVE WS-NUM-DOC-TYP          TO K625-NUM-DOC-TYP.            13210000
           MOVE 1                       TO K625-NUM-DOC-CNT.            13220000
           MOVE 'N'                     TO WS-K625-EOF.                 13230000
                                                                        13240000
           START BP13K625 KEY = K625-KEY-FLD.                           13250000
                                                                        13260000
           EVALUATE  WS-BP13K625-STATUS                                 13270000
              WHEN '00'                                                 13280000
                    PERFORM 6380-READNEXT-BP13K625 THRU 6380-EXIT       13290000
                            UNTIL WS-K625-EOF = 'Y'                     13300000
                    ADD  1              TO WS-NUM-DOC-CNT               13310000
              WHEN '10'                                                 13320000
              WHEN '23'                                                 13330000
                    MOVE 1              TO WS-NUM-DOC-CNT               13340000
              WHEN OTHER                                                13350000
                    DISPLAY 'ERROR WHILE STARTING BROWSE-BP13K625 '     13360000
                    MOVE WS-BP13K625-STATUS TO RETURN-CODE              13370000
                    PERFORM 9000-CLOSE-FILES THRU 9000-EXIT             13380000
           END-EVALUATE.                                                13390000
                                                                        13400000
       6370-EXIT.                                                       13410000
           EXIT.                                                        13420000
                                                                        13430000
                                                                        13440000
      *--------------------------------*                                13450000
       6380-READNEXT-BP13K625.                                          13460000
      *--------------------------------*                                13470000
           READ BP13K625 NEXT AT END MOVE 'Y' TO WS-K625-EOF            13480000
              GO TO 6380-EXIT.                                          13490000
                                                                        13500000
           IF (K625-NUM-HDB-REF NOT = WS-NUM-HDB-REF) OR                13510000
              (K625-NUM-DOC     NOT = WS-NUM-DOC)     OR                13520000
              (K625-NUM-DOC-TYP NOT = WS-NUM-DOC-TYP)                   13530000
              MOVE 'Y'                  TO WS-K625-EOF                  13540000
              GO TO 6380-EXIT                                           13550000
           END-IF.                                                      13560000
                                                                        13570000
           MOVE K625-NUM-DOC-CNT        TO WS-NUM-DOC-CNT.              13580000
                                                                        13590000
       6380-EXIT.                                                       13600000
           EXIT.                                                        13610000
                                                                        13620000
                                                                        13630000
      *--------------------------------*                                13640000
       6390-MAIN-DETAILS-TO-K625.                                       13650000
      *--------------------------------*                                13660000
            MOVE SPACES                 TO BP13K625-REC.                13670000
            INITIALIZE                     BP13K625-REC.                13680000
                                                                        13690000
            MOVE F315-REGN-NO           TO K625-NUM-REGN.               13700000
            MOVE F315-SCH-ACC           TO K625-NUM-HDB-REF.            13710000
            MOVE WS-NUM-DOC             TO K625-NUM-DOC.                13720000
            MOVE WS-NUM-DOC-TYP         TO K625-NUM-DOC-TYP.            13730000
            MOVE WS-NUM-DOC-CNT         TO K625-NUM-DOC-CNT.            13740000
            MOVE C907-NUM-DDD           TO K625-NUM-DDD.                13750000
            MOVE C907-NUM-FIN-YR        TO K625-NUM-FIN-YEAR.           13760000
            MOVE C907-NUM-VR-SERIAL     TO K625-NUM-VR-SERIAL.          13770000
            MOVE C906-NUM-BATCH-TYPE    TO K625-NUM-BATCH-TYPE.         13780000
            MOVE C906-NUM-FIN-YEAR      TO K625-NUM-CAL-YEAR.           13790000
            MOVE C906-NUM-BATCH-SERIAL  TO K625-NUM-BATCH-SERIAL.       13800000
      *     MOVE WS-ANNUAL-RENT         TO K625-AMT-ANNUAL-RENT.        13810000
            MOVE ZEROES                 TO K625-AMT-ANNUAL-RENT.        13820000
            MOVE 'BP13C35F'             TO K625-NUM-SYSTEM.             13830000
            MOVE ZEROES                 TO K625-AMT-LOAN.               13840000
            MOVE WS-AMT-PURCHASE-PRICE  TO K625-AMT-PURCHASE-PRICE.     13850000
            MOVE WS-NUM-INCREASE-SCCC   TO K625-NUM-INCREASE-SCCC.      13860000
            MOVE WS-NUM-LEASE-TERM      TO K625-NUM-LEASE-TERM.         13870000
            MOVE F315-DTE-PROC          TO K625-DTE-DOC-PREPARE         13880000
            MOVE WS-SYS-DATE            TO K625-DTE-UPDATE.             13890000
                                                                        13900000
       6390-EXIT.                                                       13910000
           EXIT.                                                        13920000
                                                                        13930000
      *--------------------------------*                                13940000
       6400-PRINT-FINAL-HDR.                                            13950000
      *--------------------------------*                                13960000
           MOVE SPACES                 TO L35FB-PRINT-REC.              13970000
                                                                        13980000
           ADD 1                       TO WS-PAGENO-CTR.                13990000
           MOVE WS-PAGENO-CTR          TO L35F-PAGE.                    14000000
                                                                        14010000
           STRING WS-SYS-DATE(7:2) '/' WS-SYS-DATE(5:2) '/'             14020000
                  WS-SYS-DATE(1:4)                                      14030000
                  DELIMITED BY SIZE    INTO L35F-CURRENT-DATE.          14040000
                                                                        14050000
           STRING WS-NUM-BATCH-TYPE ' '                                 14060000
                  WS-NUM-FIN-YEAR   '-' WS-NUM-BATCH-SERIAL             14070000
                  DELIMITED BY SIZE    INTO L35F-BATCH-NO.              14080000
                                                                        14090000
           MOVE WS-NUM-VOUCHER         TO L35F-VOUCHER-NO.              14100000
                                                                        14110000
           MOVE 'BP13L35F'             TO L35F-REPORT-ID.               14120000
           WRITE L35FB-PRINT-REC       FROM L35F-HEADER-01 AFTER PAGE.  14130000
                                                                        14140000
           MOVE "FINANCE'S COPY"       TO L35F-COPY-NAME.               14150000
           WRITE L35FB-PRINT-REC       FROM L35F-HEADER-02 AFTER 1.     14160000
           WRITE L35FB-PRINT-REC       FROM L35F-HEADER-2A AFTER 1.     14170000
           WRITE L35FB-PRINT-REC       FROM L35F-HEADER-03 AFTER 2.     14180000
           WRITE L35FB-PRINT-REC       FROM L35F-HEADER-04 AFTER 2.     14190000
           WRITE L35FB-PRINT-REC       FROM L35F-HEADER-05 AFTER 1.     14200000
           WRITE L35FB-PRINT-REC       FROM L35F-HEADER-06 AFTER 1.     14210000
           WRITE L35FB-PRINT-REC       FROM L35F-HEADER-07 AFTER 1.     14220000
           WRITE L35FB-PRINT-REC       FROM L35F-HEADER-08 AFTER 1.     14230000
           WRITE L35FB-PRINT-REC       FROM L35F-HEADER-09 AFTER 1.     14240000
           WRITE L35FB-PRINT-REC       FROM L35F-HEADER-10 AFTER 3.     14250000
           WRITE L35FB-PRINT-REC       FROM L35F-HEADER-11 AFTER 1.     14260000
                                                                        14270000
           MOVE SPACES                 TO L35FB-PRINT-REC.              14280000
           WRITE L35FB-PRINT-REC        AFTER 1.                        14290000
                                                                        14300000
       6400-EXIT.                                                       14310000
           EXIT.                                                        14320000
                                                                        14330000
                                                                        14340000
      *--------------------------------*                                14350000
       6500-PRINT-FINAL-DTL.                                            14360000
      *--------------------------------*                                14370000
           ADD 1                        TO WS-LINE-CTR.                 14380000
                                                                        14390000
           MOVE SPACES                  TO L35FB-PRINT-REC.             14400000
           MOVE WS-LINE-CTR             TO L35F-SNO.                    14410000
                                                                        14420000
           WRITE L35FB-PRINT-REC        FROM L35F-DETAIL AFTER 1.       14430000
                                                                        14440000
           PERFORM 6600-PRINT-FINAL-TRL THRU 6600-EXIT.                 14450000
                                                                        14460000
       6500-EXIT.                                                       14470000
           EXIT.                                                        14480000
                                                                        14490000
                                                                        14500000
      *--------------------------------*                                14510000
       6600-PRINT-FINAL-TRL.                                            14520000
      *--------------------------------*                                14530000
           IF WS-LINE-CTR = 25 OR F315-REGN-NO = HIGH-VALUES            14540000
             PERFORM 6700-WRITE-AG07-TRL        THRU 6700-EXIT          14550000
             PERFORM 6800-WRITE-FINAL-COMPTOTAL THRU 6800-EXIT          14560000
             PERFORM 6900-WRITE-FINAL-FOOTER    THRU 6900-EXIT          14570000
             PERFORM 8200-INITIALIZE-VARIABLES  THRU 8200-EXIT          14580000
           END-IF.                                                      14590000
                                                                        14600000
       6600-EXIT.                                                       14610000
           EXIT.                                                        14620000
                                                                        14630000
                                                                        14640000
      *--------------------------------*                                14650000
       6700-WRITE-AG07-TRL.                                             14660000
      *--------------------------------*                                14670000
           INITIALIZE AG07F225-TRAILER.                                 14680000
           MOVE SPACES                 TO AG07F225-TRAILER.             14690000
                                                                        14700000
           ADD 1                       TO WS-AG07F225-WRITE.            14710000
           MOVE WS-NUM-VOUCHER         TO F225-NUM-VR-R.                14720000
           MOVE 99                     TO F225-NUM-TRAILER-SERIAL.      14730000
           MOVE 'PAYMENT FOR LEASE/MORTGAGE STAMP FEES'                 14740000
                                       TO F225-TXT-VOUCHER-NARRATION.   14750000
           MOVE WS-AG07F225-SERIAL     TO F225-QTY-VR-TRANS.            14760000
           MOVE WS-TOTAL-COMPUTED      TO F225-AMT-VR-DR-TOTAL.         14770000
           MOVE ZEROES                 TO F225-AMT-VR-CR-TOTAL.         14780000
           MOVE       SPACES           TO  F225-TXT-REJECT-TLR.         14790000
           MOVE       'STPFEE  '       TO  F225-NUM-INTRFC-FR.          14800000
                                                                        14810000
           WRITE AG07F225-TRAILER.                                      14820000
                                                                        14830000
           DISPLAY 'WS-FOOTER-TAG = ' WS-FOOTER-TAG.                    14840000
           MOVE  SPACE       TO  WS-FOOTER-TAG.                         14850000
                                                                        14860000
       6700-EXIT.                                                       14870000
           EXIT.                                                        14880000
                                                                        14890000
                                                                        14900000
      *--------------------------------*                                14910000
       6800-WRITE-FINAL-COMPTOTAL.                                      14920000
      *--------------------------------*                                14930000
           WRITE L35FB-PRINT-REC       FROM L35F-DASH-LINE AFTER 3.     14940000
                                                                        14950000
           MOVE WS-TOTAL-DOA           TO L35F-TOTAL-DOA.               14960000
           MOVE WS-TOTAL-SSD           TO L35F-TOTAL-SSD.               14970000
           MOVE WS-TOTAL-DUP-DOA       TO L35F-TOTAL-DUP-DOA.           14980000
           MOVE WS-TOTAL-DUP-LEASE     TO L35F-TOTAL-DUP-LEASE.         14990000
           MOVE WS-TOTAL-ACTUAL-LEASE  TO L35F-TOTAL-ACTUAL-LEASE.      15000000
           MOVE WS-TOTAL-COMPUTED      TO L35F-TOTAL-COMPUTED.          15010000
                                                                        15020000
           MOVE WS-LINE-CTR            TO L35F-HIGH-NO.                 15030000
           WRITE L35FB-PRINT-REC       FROM L35F-TOTAL-LINE AFTER 1.    15040000
           WRITE L35FB-PRINT-REC       FROM L35F-DASH-LINE AFTER 1.     15050000
                                                                        15060000
       6800-EXIT.                                                       15070000
           EXIT.                                                        15080000
                                                                        15090000
                                                                        15100000
      *--------------------------------*                                15110000
       6900-WRITE-FINAL-FOOTER.                                         15120000
      *--------------------------------*                                15130000
           MOVE WS-TOTAL-COMPUTED      TO WS-AMT.                       15140000
                                                                        15150000
           PERFORM 8300-CONVT-AMT-WORD THRU 8300-EXIT.                  15160000
                                                                        15170000
           MOVE WP-ITEM (1)            TO L35F-AMT-DESC1.               15180000
           MOVE WP-ITEM (2)            TO L35F-AMT-DESC2.               15190000
                                                                        15200000
           WRITE L35FB-PRINT-REC        FROM L35F-TRAILER-01 AFTER 2.   15210000
           WRITE L35FB-PRINT-REC        FROM L35F-TRAILER-02 AFTER 3.   15220000
                                                                        15230000
       6900-EXIT.                                                       15240000
           EXIT.                                                        15250000
                                                                        15260000
                                                                        15270000
      *--------------------------------*                                15280000
       8000-MOVE-DATA.                                                  15290000
      *--------------------------------*                                15300000
           MOVE SPACES                 TO L35F-DETAIL.                  15310000
                                                                        15320000
           PERFORM 6310-STARTBR-BP13K330  THRU 6310-EXIT.               15330000
           PERFORM 6320-READNEXT-BP13K330 THRU 6320-EXIT                15340000
             UNTIL F315-REGN-NO  NOT = K330-CURR-REG  OR                15350000
                   K330-KEY-FLD = HIGH-VALUES.                          15360000
                                                                        15370000
           MOVE F315-DTE-PROC          TO WS-DTE-DOC-PREPARE            15380000
           IF WS-DTE-DOC-PREPARE > ZEROES                               15390000
              STRING WS-DTE-DOC-PREPARE(7:2) '/'                        15400000
                     WS-DTE-DOC-PREPARE(5:2) '/'                        15410000
                     WS-DTE-DOC-PREPARE(1:4)                            15420000
                     DELIMITED BY SIZE INTO L35F-AFL-DATE               15430000
           ELSE                                                         15440000
              PERFORM 8050-READ-BP13K410 THRU 8050-EXIT                 15450000
           END-IF.                                                      15460000
                                                                        15470000
           IF F315-NUM-HSE > SPACES                                     15480000
             MOVE '#'                  TO L35F-CONST-1                  15490000
             MOVE '-'                  TO L35F-CONST-2                  15500000
           END-IF.                                                      15510000
                                                                        15520000
           MOVE F315-NUM-BLK           TO L35F-BLK-NO.                  15530000
           MOVE F315-NME-STREET        TO L35F-STREET.                  15540000
           MOVE F315-NUM-MAIN          TO L35F-UNIT-NO.                 15550000
           MOVE F315-NUM-LEVEL         TO L35F-LEVEL-NO.                15560000
           MOVE F315-REGN-NO           TO L35F-REGN-NO.                 15570000
                                                                        15580000
           STRING F315-SCH-ACC(1:4) '-' F315-SCH-ACC(5:4) '-'           15590000
                  F315-SCH-ACC(9:1) '-' F315-SCH-ACC(10:2)              15600000
                  DELIMITED BY SIZE    INTO L35F-SCH-ACC.               15610000
                                                                        15620000
           MOVE F315-AMT-LEASE-FEE       TO L35F-LEASE.                 15630000
           MOVE F315-AMT-LEASE-FEE-DUP   TO L35F-DUP-LEASE.             15640000
           MOVE F315-AMT-SUB-TRF-DOA     TO L35F-DOA.                   15650000
           MOVE F315-AMT-SUB-TRF-DOA-DUP TO L35F-DUP-DOA.               15660000
                                                                        15670000
           IF   F315-AMT-SELLER-STAMP-DUTY IS NOT NUMERIC               15680000
           MOVE ZEROES    TO L35F-SSD                                   15690000
                             F315-AMT-SELLER-STAMP-DUTY                 15700000
           ELSE                                                         15710000
           MOVE F315-AMT-SELLER-STAMP-DUTY TO L35F-SSD                  15720000
           END-IF.                                                      15730000
                                                                        15740000
           COMPUTE WS-TOTAL              = F315-AMT-LEASE-FEE +         15750000
                                           F315-AMT-LEASE-FEE-DUP +     15760000
                                           F315-AMT-SUB-TRF-DOA +       15770000
                                           F315-AMT-SUB-TRF-DOA-DUP +   15780000
                                           F315-AMT-SELLER-STAMP-DUTY.  15790000
                                                                        15800000
           MOVE WS-TOTAL                 TO L35F-TOTAL.                 15810000
                                                                        15820000
           COMPUTE WS-TOTAL-DOA          = WS-TOTAL-DOA +               15830000
                                           F315-AMT-SUB-TRF-DOA.        15840000
                                                                        15850000
           COMPUTE WS-TOTAL-DUP-DOA      = WS-TOTAL-DUP-DOA +           15860000
                                           F315-AMT-SUB-TRF-DOA-DUP.    15870000
                                                                        15880000
           COMPUTE WS-TOTAL-ACTUAL-LEASE = WS-TOTAL-ACTUAL-LEASE +      15890000
                                           F315-AMT-LEASE-FEE.          15900000
                                                                        15910000
           COMPUTE WS-TOTAL-DUP-LEASE    = WS-TOTAL-DUP-LEASE +         15920000
                                           F315-AMT-LEASE-FEE-DUP.      15930000
                                                                        15940000
           COMPUTE WS-TOTAL-SSD          = WS-TOTAL-SSD +               15950000
                                           F315-AMT-SELLER-STAMP-DUTY.  15960000
                                                                        15970000
           COMPUTE WS-TOTAL-COMPUTED     = WS-TOTAL-COMPUTED +          15980000
                                           WS-TOTAL.                    15990000
                                                                        16000000
       8000-EXIT.                                                       16010000
           EXIT.                                                        16020000
                                                                        16030000
                                                                        16040000
      *--------------------------------*                                16050000
       8050-READ-BP13K410.                                              16060000
      *--------------------------------*                                16070000
                                                                        16080000
            INITIALIZE K410-KEY-FLD.                                    16090000
            MOVE ZEROES TO K410-DTE-TR-EFFECTIVE.                       16100000
            MOVE F315-REGN-NO      TO  K410-KEY-FLD.                    16110000
            READ BP13K410.                                              16120000
            IF WS-BP13K410-STATUS = '00'                                16130000
              AND K410-DTE-TR-EFFECTIVE > ZEROES                        16140000
                 MOVE K410-DTE-TR-EFFECTIVE TO WS-DTE-DOC-PREPARE       16150000
                 STRING WS-DTE-DOC-PREPARE(7:2) '/'                     16160000
                        WS-DTE-DOC-PREPARE(5:2) '/'                     16170000
                        WS-DTE-DOC-PREPARE(1:4)                         16180000
                        DELIMITED BY SIZE INTO L35F-AFL-DATE            16190000
            ELSE                                                        16200000
                 MOVE '  /  /    '  TO L35F-AFL-DATE                    16210000
            END-IF.                                                     16220000
                                                                        16230000
                                                                        16240000
       8050-EXIT.                                                       16250000
           EXIT.                                                        16260000
                                                                        16270000
                                                                        16280000
      *--------------------------------*                                16290000
       8100-CALL-BP13C906.                                              16300000
      *--------------------------------*                                16310000
           IF WS-NEW-BATCH-NO = 'Y'                                     16320000
             MOVE 'SUBT'               TO C906-NUM-BATCH-TYPE           16330000
             MOVE 'BP13K620'           TO C906-NUM-FILENME              16340000
                                                                        16350000
             CALL 'BP13C906'           USING BP13C906-AREA              16360000
                                                                        16370000
             EVALUATE C906-NUM-FILE-STATUS                              16380000
             WHEN 00                                                    16390000
               MOVE C906-NUM-BATCH-TYPE   TO WS-NUM-BATCH-TYPE          16400000
               MOVE C906-NUM-FIN-YEAR     TO WS-NUM-FIN-YEAR            16410000
               MOVE C906-NUM-BATCH-SERIAL TO WS-NUM-BATCH-SERIAL        16420000
               MOVE 'N'                   TO WS-NEW-BATCH-NO            16430000
             WHEN OTHER                                                 16440000
               DISPLAY 'BP13C906 - ERROR IN CALLING PROGRAM : '         16450000
                                            C906-NUM-FILE-STATUS        16460000
               MOVE C906-NUM-FILE-STATUS  TO RETURN-CODE                16470000
               PERFORM 9000-CLOSE-FILES   THRU 9000-EXIT                16480000
             END-EVALUATE                                               16490000
           END-IF.                                                      16500000
                                                                        16510000
       8100-EXIT.                                                       16520000
           EXIT.                                                        16530000
                                                                        16540000
                                                                        16550000
      *--------------------------------*                                16560000
       8200-INITIALIZE-VARIABLES.                                       16570000
      *--------------------------------*                                16580000
           MOVE ZEROES                 TO WS-LINE-CTR                   16590000
                                          WS-TOTAL-COMPUTED             16600000
                                          WS-TOTAL-DOA                  16610000
                                          WS-TOTAL-SSD                  16620000
                                          WS-TOTAL-DUP-DOA              16630000
                                          WS-TOTAL-DUP-LEASE            16640000
                                          WS-TOTAL-ACTUAL-LEASE         16650000
                                          WS-AG07F225-SERIAL.           16660000
                                                                        16670000
           MOVE 'Y'                    TO WS-NEW-VOUCHER-NO             16680000
                                          WS-NEW-BATCH-NO               16690000
                                          WS-NEW-HEADER.                16700000
                                                                        16710000
       8200-EXIT.                                                       16720000
           EXIT.                                                        16730000
                                                                        16740000
                                                                        16750000
      *--------------------------*                                      16760000
       8500-PRINT-L35FD-REPORT.                                         16770000
      *--------------------------*                                      16780000
           IF WS-L35FD-REC-ON-PAGE-CNT > 65                             16790000
              PERFORM 8510-PRINT-L35FD-HEADER     THRU 8510-EXIT        16800000
           END-IF.                                                      16810000
                                                                        16820000
           MOVE SPACES        TO L35FD-REC-DETAIL.                      16830000
           INITIALIZE            L35FD-REC-DETAIL.                      16840000
           ADD  1             TO WS-L35FD-PRT-CNT.                      16850000
           MOVE WS-L35FD-PRT-CNT  TO L35FD-SERIAL-NO.                   16860000
                                                                        16870000
           STRING F315-SCH-ACC(1:4) '-'                                 16880000
                  F315-SCH-ACC(5:4) '-'                                 16890000
                  F315-SCH-ACC(9:1) '-'                                 16900000
                  F315-SCH-ACC(10:2)                                    16910000
                  DELIMITED BY SIZE INTO L35FD-SCH-ACC                  16920000
           END-STRING.                                                  16930000
                                                                        16940000
           MOVE F315-REGN-NO      TO L35FD-REGN-NO.                     16950000
           STRING C907-NUM-DDD    '-'                                   16960000
                  C907-NUM-FIN-YR '-'                                   16970000
                  C907-NUM-VR-SERIAL                                    16980000
                  DELIMITED BY SIZE INTO L35FD-JR-VCHR-NO               16990000
           END-STRING.                                                  17000000
           MOVE WS-AMT-EARMARK    TO L35FD-AMT-TOTAL.                   17010000
                                                                        17020000
           EVALUATE B902-CDE-ERROR-ACCT(1)                              17030000
              WHEN 'S0053'                                              17040000
                 MOVE 'AB05K009 FILE ERROR'        TO L35FD-ERROR-DESC  17050000
              WHEN 'S0054'                                              17060000
                 MOVE 'B05K006 REC NOT FND'        TO L35FD-ERROR-DESC  17070000
              WHEN 'S0045'                                              17080000
                 MOVE 'B05K006 FILE ERROR'         TO L35FD-ERROR-DESC  17090000
              WHEN 'S0055'                                              17100000
                 MOVE 'DOESN''T HAVE ENOUGH BALANCE'                    17110000
                                                   TO L35FD-ERROR-DESC  17120000
              WHEN OTHER                                                17130000
                 MOVE 'AB05C902 SUBROUTINE ERROR'  TO L35FD-ERROR-DESC  17140000
           END-EVALUATE.                                                17150000
                                                                        17160000
           WRITE L35FD-PRINT-REC  FROM L35FD-REC-DETAIL  AFTER 1.       17170000
                                                                        17180000
           ADD   1     TO  WS-L35FD-REC-ON-PAGE-CNT.                    17190000
                                                                        17200000
       8500-EXIT.                                                       17210000
           EXIT.                                                        17220000
                                                                        17230000
                                                                        17240000
      *-------------------------*                                       17250000
       8510-PRINT-L35FD-HEADER.                                         17260000
      *-------------------------*                                       17270000
           ADD  1                 TO   WS-L35FD-PAGE-CNT.               17280000
           MOVE WS-L35FD-PAGE-CNT TO   L35F-PAGE.                       17290000
           MOVE 'P13L35FD'        TO   L35F-REPORT-ID.                  17300000
           WRITE L35FD-PRINT-REC  FROM L35F-HEADER-01    AFTER PAGE.    17310000
           WRITE L35FD-PRINT-REC  FROM L35FD-HEADER2     AFTER 2.       17320000
           WRITE L35FD-PRINT-REC  FROM L35FD-HEADER3     AFTER 2.       17330000
           WRITE L35FD-PRINT-REC  FROM L35FD-UNDERLINE   AFTER 1.       17340000
           MOVE  6                TO   WS-L35FD-REC-ON-PAGE-CNT.        17350000
                                                                        17360000
       8510-EXIT.                                                       17370000
           EXIT.                                                        17380000
                                                                        17390000
                                                                        17400000
      *--------------------------------*                                17410000
       9000-CLOSE-FILES.                                                17420000
      *--------------------------------*                                17430000
           CLOSE BP13F315                                               17440000
                 BP13K330                                               17450000
                 BP13K410                                               17460000
                 BP13K625                                               17470000
                 BP13K800                                               17480000
                 BP13K893                                               17490000
                 AG07F225                                               17500000
                 P13L35FA                                               17510000
                 P13L35FB                                               17520000
                 P13L35FD.                                              17530000
                                                                        17540000
           IF WS-BP13K800-STATUS NOT = 00                               17550000
              DISPLAY 'BP13K800 CLOSE FILE ERROR :' WS-BP13K800-STATUS  17560000
              MOVE WS-BP13K800-STATUS   TO RETURN-CODE                  17570000
           END-IF.                                                      17580000
                                                                        17590000
           IF WS-BP13K893-STATUS NOT = 00                               17600000
              DISPLAY 'BP13K893 CLOSE FILE ERROR :' WS-BP13K893-STATUS  17610000
              MOVE WS-BP13K893-STATUS   TO RETURN-CODE                  17620000
           END-IF.                                                      17630000
                                                                        17640000
           IF WS-BP13K410-STATUS NOT = 00                               17650000
              DISPLAY 'BP13K410 CLOSE FILE ERROR :' WS-BP13K410-STATUS  17660000
              MOVE WS-BP13K410-STATUS   TO RETURN-CODE                  17670000
           END-IF.                                                      17680000
                                                                        17690000
           IF WS-BP13K330-STATUS NOT = 00                               17700000
              DISPLAY 'BP13K330 CLOSE FILE ERROR : ' WS-BP13K330-STATUS 17710000
              MOVE WS-BP13K330-STATUS   TO RETURN-CODE                  17720000
           END-IF.                                                      17730000
                                                                        17740000
           IF WS-BP13K625-STATUS NOT = 00                               17750000
              DISPLAY 'BP13K625 CLOSE FILE ERROR : ' WS-BP13K625-STATUS 17760000
              MOVE WS-BP13K625-STATUS   TO RETURN-CODE                  17770000
           END-IF.                                                      17780000
                                                                        17790000
           MOVE 'AG07K960'              TO C907-NUM-FILENME.            17800000
                                                                        17810000
           CALL 'K960CLSE'              USING AG07C907-AREA.            17820000
                                                                        17830000
           IF C907-NUM-FILE-STATUS NOT = ('00' AND '97')                17840000
             DISPLAY 'AG07K960 CLOSE FILE ERROR :' C907-NUM-FILE-STATUS 17850000
             MOVE C907-NUM-FILE-STATUS  TO WS-AG07-STAT-X               17860000
             MOVE WS-AG07-STATUS        TO RETURN-CODE                  17870000
           END-IF.                                                      17880000
                                                                        17890000
           MOVE 'BP13K620'              TO C906-NUM-FILENME.            17900000
           CALL 'K620MCLS'              USING BP13C906-AREA.            17910000
                                                                        17920000
           IF C906-NUM-FILE-STATUS NOT = ('00' AND '97')                17930000
             DISPLAY 'BP13K620 CLOSE FILE ERROR :' C906-NUM-FILE-STATUS 17940000
             MOVE C906-NUM-FILE-STATUS  TO RETURN-CODE                  17950000
           END-IF.                                                      17960000
                                                                        17970000
      **CALL AB05C902 TO CLOSE B05K006 AND AB05K009 FILES(CODE='C')     17980000
           MOVE SPACES              TO   WS-B902-AREA.                  17990000
           INITIALIZE                    WS-B902-AREA.                  18000000
           MOVE 'C'                 TO   B902-CDE-TYPE.                 18010000
           CALL 'AB05C902'  USING WS-B902-AREA.                         18020000
                                                                        18030000
           IF B902-CDE-ERROR NOT = ZEROES                               18040000
              MOVE B902-CDE-SYSERR      TO   RETURN-CODE                18050000
              DISPLAY 'ERROR CALLING AB05C902 SUB-ROUTINE!'             18060000
           END-IF.                                                      18070000
                                                                        18080000
           DISPLAY SPACES.                                              18090000
           DISPLAY '***********************'.                           18100000
           DISPLAY ' PROGRAM ID : BP13C35F '.                           18110000
           DISPLAY '***********************'.                           18120000
           DISPLAY SPACES.                                              18130000
           DISPLAY 'NO OF REC READ      BP13F315  : ' WS-BP13F315-READ. 18140000
           DISPLAY 'NO OF REC FOUND     BP13K330  : ' WS-BP13K330-FND.  18150000
           DISPLAY 'NO OF REC FOUND     BP13K800  : ' WS-BP13K800-FND.  18160000
           DISPLAY SPACES.                                              18170000
           DISPLAY 'NO OF REC NOT FOUND BP13K330  : ' WS-BP13K330-NFND. 18180000
           DISPLAY 'NO OF REC NOT FOUND BP13K800  : ' WS-BP13K800-NFND. 18190000
           DISPLAY 'NO OF REC WRITTEN   AG07F225  : ' WS-AG07F225-WRITE.18200000
           DISPLAY 'NO OF REC WRITTEN   BP13F315  : ' WS-BP13F315-REWRT.18210000
           DISPLAY 'NO OF REC WRITTEN   BP13K625  : ' WS-BP13K625-WRITE.18220000
           DISPLAY 'NO OF RECS WITH EARMARK ERROR : ' WS-L35FD-PRT-CNT. 18230000
                                                                        18240000
           STOP RUN.                                                    18250000
                                                                        18260000
       9000-EXIT.                                                       18270000
           EXIT.                                                        18280000
                                                                        18290000
                                                                        18300000
      *--------------------------------*                                18310000
       8300-CONVT-AMT-WORD.                                             18320000
      *--------------------------------*                                18330000
            MOVE SPACES                TO WF-DETAILS.                   18340000
                                                                        18350000
            MOVE ZEROES                TO WS-SWITCH WS-THO-SW           18360000
                                          WS-CNT-SW WS-LIT-SW           18370000
                                          WS-TEN-SW WS-AND-SW.          18380000
                                                                        18390000
            MOVE 60                    TO WS-PLACE-COUNTER.             18400000
                                                                        18410000
            MOVE 1                     TO WF-SUB.                       18420000
                                                                        18430000
            PERFORM B000-ROUTINE THRU B990-EXIT                         18440000
                         VARYING WS-SUB FROM 1 BY 1 UNTIL WS-SUB = 10.  18450000
                                                                        18460000
       8300-EXIT.                                                       18470000
           EXIT.                                                        18480000
                                                                        18490000
                                                                        18500000
      *--------------------------------*                                18510000
       B000-ROUTINE SECTION.                                            18520000
      *--------------------------------*                                18530000
       B000-GO.                                                         18540000
           IF WS-DIGIT (WS-SUB) = ZERO                                  18550000
             IF WS-TEN-SW = ZERO                                        18560000
               GO TO B800-MOVE-TYPE                                     18570000
             ELSE                                                       18580000
               GO TO B010-PROCESS                                       18590000
             END-IF                                                     18600000
           END-IF.                                                      18610000
                                                                        18620000
           IF WS-FIRST-SUB = ZERO                                       18630000
             MOVE WS-SUB               TO WS-FIRST-SUB.                 18640000
                                                                        18650000
           IF WS-SWITCH = ZERO                                          18660000
             MOVE 1                    TO WS-SWITCH.                    18670000
                                                                        18680000
       B010-PROCESS.                                                    18690000
           IF WS-SUB = 8                                                18700000
             MOVE 9                    TO WS-CNT-SW.                    18710000
                                                                        18720000
           IF WS-SUB = 9                                                18730000
             IF WS-CNT-SW = ZERO                                        18740000
               MOVE WS-DIGIT (WS-SUB)  TO WS-CNT-SW                     18750000
             END-IF                                                     18760000
           END-IF.                                                      18770000
                                                                        18780000
           IF WS-SUB = 2 OR 3 OR 4                                      18790000
             MOVE 1                    TO WS-THO-SW.                    18800000
                                                                        18810000
           MOVE WS-DIGIT(WS-SUB)       TO WA-SUB.                       18820000
                                                                        18830000
           IF WS-SUB = 3 OR 6 OR 8                                      18840000
             IF WS-DIGIT (WS-SUB) = 1                                   18850000
               MOVE 1                  TO WS-TEN-SW                     18860000
               GO TO B990-EXIT                                          18870000
             ELSE                                                       18880000
               ADD 18                  TO WA-SUB                        18890000
             END-IF                                                     18900000
           ELSE                                                         18910000
             IF WS-SUB = 1 OR 4 OR 7 OR 9                               18920000
               IF WS-TEN-SW = 1                                         18930000
                 MOVE 0                TO WS-TEN-SW                     18940000
                 ADD 10                TO WA-SUB                        18950000
               END-IF                                                   18960000
             END-IF                                                     18970000
           END-IF.                                                      18980000
                                                                        18990000
           MOVE WA-NAME(WA-SUB)        TO WL-AREA.                      19000000
                                                                        19010000
           PERFORM R000-LOAD-IN.                                        19020000
                                                                        19030000
       B300-TENS.                                                       19040000
           IF WS-SUB = 3 OR 6 OR 8                                      19050000
             GO TO B990-EXIT.                                           19060000
                                                                        19070000
       B400-MOVE-HUNDRED.                                               19080000
           IF WS-SUB = 2 OR 5                                           19090000
             MOVE L-HUNDRED            TO WL-AREA                       19100000
             MOVE 1                    TO WS-LIT-SW                     19110000
             PERFORM R000-LOAD-IN                                       19120000
             MOVE 1                    TO WS-AND-SW                     19130000
             GO TO B990-EXIT.                                           19140000
                                                                        19150000
       B800-MOVE-TYPE.                                                  19160000
           IF WS-SWITCH = ZERO                                          19170000
             GO TO B990-EXIT.                                           19180000
                                                                        19190000
           IF WS-SUB = 1                                                19200000
             MOVE L-MILLION            TO WL-AREA                       19210000
             MOVE 1                    TO WS-LIT-SW                     19220000
             MOVE 1                    TO WS-AND-SW                     19230000
             GO TO B880-LOAD-IN.                                        19240000
                                                                        19250000
            IF WS-SUB = 7                                               19260000
              MOVE 1 TO WS-LIT-SW WS-AND-SW                             19270000
              IF WS-FIRST-SUB = 7  AND                                  19280000
                WS-DIGIT (WS-SUB) = 1                                   19290000
                MOVE L-DOLLAR          TO WL-AREA                       19300000
                GO TO B880-LOAD-IN                                      19310000
               ELSE                                                     19320000
                 MOVE L-DOLLARS        TO WL-AREA                       19330000
                 GO TO B880-LOAD-IN                                     19340000
               END-IF                                                   19350000
            END-IF.                                                     19360000
                                                                        19370000
            IF WS-SUB = 4 AND WS-THO-SW = 1                             19380000
              MOVE 1                   TO WS-AND-SW WS-LIT-SW           19390000
              MOVE L-THOUSAND          TO WL-AREA                       19400000
              GO TO B880-LOAD-IN.                                       19410000
                                                                        19420000
            IF WS-SUB = 9                                               19430000
              MOVE 1 TO WS-LIT-SW                                       19440000
              IF WS-CNT-SW = ZERO                                       19450000
                MOVE L-ONLY            TO WL-AREA                       19460000
                GO TO B880-LOAD-IN                                      19470000
              ELSE                                                      19480000
                IF WS-CNT-SW = 1                                        19490000
                  MOVE L-CENT          TO WL-AREA                       19500000
                  PERFORM R000-LOAD-IN                                  19510000
                  MOVE L-ONLY          TO WL-AREA                       19520000
                  GO TO B880-LOAD-IN                                    19530000
                ELSE                                                    19540000
                  MOVE L-CENTS         TO WL-AREA                       19550000
                  PERFORM R000-LOAD-IN                                  19560000
                  MOVE L-ONLY          TO WL-AREA                       19570000
                  GO TO B880-LOAD-IN                                    19580000
                END-IF                                                  19590000
              END-IF                                                    19600000
            END-IF.                                                     19610000
                                                                        19620000
            GO TO B990-EXIT.                                            19630000
                                                                        19640000
       B880-LOAD-IN.                                                    19650000
            PERFORM R000-LOAD-IN.                                       19660000
                                                                        19670000
       B990-EXIT.                                                       19680000
            EXIT.                                                       19690000
                                                                        19700000
      *--------------------------------*                                19710000
       R000-LOAD-IN SECTION.                                            19720000
      *--------------------------------*                                19730000
                                                                        19740000
       R001-GO.                                                         19750000
            IF WS-LIT-SW = 1                                            19760000
               MOVE ZERO TO WS-LIT-SW                                   19770000
               GO TO R050-CONT.                                         19780000
                                                                        19790000
            IF WS-SUB = 2 OR 5                                          19800000
               GO TO R050-CONT.                                         19810000
                                                                        19820000
       R025-ADD-TEST.                                                   19830000
            IF WS-AND-SW NOT = 1                                        19840000
               GO TO R050-CONT.                                         19850000
                                                                        19860000
            MOVE ZERO TO WS-AND-SW.                                     19870000
            MOVE WL-AREA TO WL-AREA-SAVE.                               19880000
            MOVE L-AND TO WL-AREA.                                      19890000
            PERFORM R200-LOADUP.                                        19900000
            MOVE WL-AREA-SAVE TO WL-AREA.                               19910000
                                                                        19920000
       R050-CONT.                                                       19930000
            PERFORM R200-LOADUP.                                        19940000
                                                                        19950000
       R099-EXIT.                                                       19960000
            EXIT.                                                       19970000
                                                                        19980000
      *--------------------------------*                                19990000
       R200-LOADUP SECTION.                                             20000000
      *--------------------------------*                                20010000
       R201-GO.                                                         20020000
            ADD WL-ITEM1 WF-SUB GIVING WS-RESULT.                       20030000
            IF  WS-RESULT > WS-PLACE-COUNTER                            20040000
                ADD 1 WS-PLACE-COUNTER GIVING WF-SUB                    20050000
                ADD 60 TO WS-PLACE-COUNTER.                             20060000
                                                                        20070000
            PERFORM R500-LOAD VARYING WL-SUB FROM 2 BY 1 UNTIL          20080000
                    WL-ITEM (WL-SUB) = L-X.                             20090000
                                                                        20100000
       R490-EXIT.                                                       20110000
           EXIT.                                                        20120000
                                                                        20130000
      *--------------------------------*                                20140000
       R500-LOAD SECTION.                                               20150000
      *--------------------------------*                                20160000
       R501-GO.                                                         20170000
                                                                        20180000
            MOVE WL-ITEM (WL-SUB) TO WF-ITEM (WF-SUB).                  20190000
            ADD  1                TO WF-SUB.                            20200000
            IF WL-ITEM (WL-SUB) = SPACE                                 20210000
               ADD   1     TO     WL-SUB                                20220000
               MOVE  L-X   TO     WL-ITEM (WL-SUB)                      20230000
               SUBTRACT 1  FROM   WL-SUB.                               20240000
                                                                        20250000
       R990-EXIT.                                                       20260000
            EXIT.                                                       20270000
