       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CZ3D.                                                 
      *AUTHOR.        GURU..                                                    
      *DATE-WRITTEN.  29/04/2019.                                               
      * ========================================================== *            
      * SYSTEM OF COMMITMENT (BP13)                                *            
      * ========================================================== *            
      *                                                            *            
      *    OBJECTIVE  :                                            *            
      *        1.  THIS PROGRAMME WILL CREATE THE GL DETAIL        *            
      *            TRANSACTION FILE BP13F180 FOR SERS AND RELOCATION            
      *            GRANT (ON KEY-ISSUED-MONTH)                     *            
      *            FOR LBS AND 2-ROOM FLEXI CASES                  *            
      *     INPUT FILES:  1. BP13F736                              *            
      *     OUTPUT FILES: 1. BP13F180                              *            
      *                   2. AC28F526                              *            
      *     LISTING:      1. BP13LZ3D (CONTROL LIST)               *            
      *                                                            *            
      * ---------------------------------------------------------- *            
      * CHG-NO     BY     DATE    DESCRIPTION                      *            
      * --------  ----  --------  -----------                      *            
      * BP137965  KR13  29042019  NEW PGM (SIMILAR TO BP13C39E).   *            
      * BP137936  KR13  18102019  FIX F180-TRANS-DATE = CURR-DTE.  *            
      * BP137503  SRG1  22102019  CHANGE SHORTLEASE-TAG COND CHECK.*            
      * BP138095  KR13  27112019  ADD EHG.                         *            
      * BP138231  PP11  10012023  ADD TUG AND ATG                  *            
      * ********************************************************** *            
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-4341.                                               
       OBJECT-COMPUTER. IBM-4341.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F736 ASSIGN TO BP13F736.                                  
                                                                                
           SELECT SY02F001 ASSIGN TO SY02F001.                                  
                                                                                
           SELECT BP13F180 ASSIGN TO BP13F180.                                  
                                                                                
           SELECT AC28F526 ASSIGN TO AC28F526.                                  
                                                                                
           SELECT BP13LZ3D ASSIGN TO BP13LZ3D.                                  
                                                                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  BP13F736                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 1000 CHARACTERS                                      
           RECORDING MODE F                                                     
           LABEL RECORDS ARE STANDARD.                                          
       COPY BP13F736.                                                           
                                                                                
       FD  BP13F180                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 120 CHARACTERS                                       
           RECORDING MODE F                                                     
           LABEL RECORDS ARE OMITTED.                                           
       COPY BP13F180.                                                           
                                                                                
       FD  AC28F526                                                             
           BLOCK     CONTAINS 0   RECORDS                                       
           RECORD    CONTAINS 130 CHARACTERS                                    
           LABEL     RECORDS  ARE STANDARD                                      
           RECORDING MODE     IS  F.                                            
       COPY AC28F526.                                                           
                                                                                
       FD BP13LZ3D                                                              
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE F                                                     
           DATA RECORD IS BP13LZ3D-REPORT.                                      
       01  BP13LZ3D-REPORT               PIC X(132).                            
                                                                                
       COPY SY02F001.                                                           
                                                                                
      *                                                                         
       WORKING-STORAGE SECTION.                                                 
       01  WS-F736-EOF-FLAG               PIC X          VALUE 'N'.             
       01  WS-F180-EOF-FLAG               PIC X          VALUE 'N'.             
                                                                                
       01  WS-DEFER-INCOME-VARS.                                                
          05  WS-CR-AMORT-AMT-SRG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-SRG-L       PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-SUG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-REG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-AHG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-AHG-L       PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-EHG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-EHG-L       PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-SHG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-SHG-L       PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-FSG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-INT         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-INT-L       PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-HGT         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-HGT1        PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-HGT2        PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-TUG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-TUG1        PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-TUG2        PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-ATG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-ATG1        PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-AMT-ATG2        PIC S9(08)V99   VALUE ZEROS.          
          05  WS-CR-AMORT-SRG             PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-SRG-L           PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-SUG             PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-REG             PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-AHG             PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-AHG-L           PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-EHG             PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-EHG-L           PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-SHG             PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-SHG-L           PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-FSG             PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-INT             PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-INT-L           PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-HGT             PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-HGT1            PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-HGT2            PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-TUG             PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-TUG1            PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-TUG2            PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-ATG             PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-ATG1            PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-AMORT-ATG2            PIC 9(3)        VALUE ZEROS.          
          05  WS-CR-GL-SRG                PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-SRG-L              PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-SUG                PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-REG                PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-AHG                PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-AHG-L              PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-EHG                PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-EHG-L              PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-SHG                PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-SHG-L              PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-FSG                PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-INT                PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-INT-L              PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-HGT                PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-HGT1               PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-HGT2               PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-TUG                PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-TUG1               PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-TUG2               PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-ATG                PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-ATG1               PIC X(13)       VALUE SPACES.         
          05  WS-CR-GL-ATG2               PIC X(13)       VALUE SPACES.         
                                                                                
       01  WS-AMORT-INCOME-VARS.                                                
          05  WS-DR-AMORT-AMT-SRG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-SRG-L       PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-SUG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-REG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-AHG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-AHG-L       PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-EHG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-EHG-L       PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-SHG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-SHG-L       PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-FSG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-INT         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-INT-L       PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-HGT         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-HGT1        PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-HGT2        PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-TUG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-TUG1        PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-TUG2        PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-ATG         PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-ATG1        PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-AMT-ATG2        PIC S9(08)V99   VALUE ZEROS.          
          05  WS-DR-AMORT-SRG             PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-SRG-L           PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-SUG             PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-REG             PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-AHG             PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-AHG-L           PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-EHG             PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-EHG-L           PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-SHG             PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-SHG-L           PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-FSG             PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-INT             PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-INT-L           PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-HGT             PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-HGT1            PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-HGT2            PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-TUG             PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-TUG1            PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-TUG2            PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-ATG             PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-ATG1            PIC 9(3)        VALUE ZEROS.          
          05  WS-DR-AMORT-ATG2            PIC 9(3)        VALUE ZEROS.          
          05  WS-GL-SRG                   PIC X(13)       VALUE SPACES.         
          05  WS-GL-SRG-L                 PIC X(13)       VALUE SPACES.         
          05  WS-GL-SUG                   PIC X(13)       VALUE SPACES.         
          05  WS-GL-REG                   PIC X(13)       VALUE SPACES.         
          05  WS-GL-AHG                   PIC X(13)       VALUE SPACES.         
          05  WS-GL-AHG-L                 PIC X(13)       VALUE SPACES.         
          05  WS-GL-EHG                   PIC X(13)       VALUE SPACES.         
          05  WS-GL-EHG-L                 PIC X(13)       VALUE SPACES.         
          05  WS-GL-SHG                   PIC X(13)       VALUE SPACES.         
          05  WS-GL-SHG-L                 PIC X(13)       VALUE SPACES.         
          05  WS-GL-FSG                   PIC X(13)       VALUE SPACES.         
          05  WS-GL-INT                   PIC X(13)       VALUE SPACES.         
          05  WS-GL-INT-L                 PIC X(13)       VALUE SPACES.         
          05  WS-GL-HGT                   PIC X(13)       VALUE SPACES.         
          05  WS-GL-HGT1                  PIC X(13)       VALUE SPACES.         
          05  WS-GL-HGT2                  PIC X(13)       VALUE SPACES.         
          05  WS-GL-TUG                   PIC X(13)       VALUE SPACES.         
          05  WS-GL-TUG1                  PIC X(13)       VALUE SPACES.         
          05  WS-GL-TUG2                  PIC X(13)       VALUE SPACES.         
          05  WS-GL-ATG                   PIC X(13)       VALUE SPACES.         
          05  WS-GL-ATG1                  PIC X(13)       VALUE SPACES.         
          05  WS-GL-ATG2                  PIC X(13)       VALUE SPACES.         
                                                                                
       01  WS-CR-AMT                      PIC 9(06)V99   VALUE ZEROS.           
       01  WS-CR-TOT                      PIC S9(11)V99   VALUE ZEROS.          
       01  WS-DR-TOT                      PIC S9(11)V99   VALUE ZEROS.          
       01  WS-RCPT-CD                     PIC X(5)       VALUE SPACES.          
       01  WS-CR-CASES                    PIC 9(5)       VALUE ZEROS.           
       01  WS-DR-CASES                    PIC 9(5)       VALUE ZEROS.           
       01  WS-READ-F736-COUNT             PIC 9(5)       VALUE ZEROS.           
       01  WS-WRITE-F180-COUNT            PIC 9(5)       VALUE ZEROS.           
       01  WS-WRITE-F526-COUNT            PIC 9(5)       VALUE ZEROS.           
       01  WS-WITH-GRANT                  PIC 9(5)       VALUE ZEROS.           
       01  WS-F180-PERIOD                 PIC 9(2)       VALUE ZEROS.           
       01  WS-TOT-F180-CREDIT             PIC 9(5)       VALUE ZEROS.           
       01  WS-TOT-F180-DEBIT              PIC 9(5)       VALUE ZEROS.           
       01  WS-PAGE-COUNT                  PIC 99         VALUE ZEROS.           
       01  WS-YEAR                        PIC 999.                              
       01  WS-LEAP-YEAR                   PIC 99.                               
       01  WS-ODD-MONTH                   PIC 9.                                
       01  WS-MONTH                       PIC X(2).                             
           88  CHECK-MM         VALUE '04' '06' '09' '11'.                      
           88  CHECK-FEB        VALUE '02'.                                     
       01  SY02F001-EOF                   PIC X(01)    VALUE 'N'.               
                                                                                
       01  WS-GL-ACCT-VARS.                                                     
           05 WS-ACC-NO1.                                                       
              10 WS-ACC-LEAD              PIC X(01).                            
              10 WS-ACC-INTERNAL          PIC X(06).                            
              10 WS-ACC-FILLER            PIC X(02).                            
              10 WS-ACC-GL                PIC X(04).                            
                                                                                
      ****************************************************************          
      *    WORKING STORAGE FOR SYSTEM DATE FOR EDITING INTO REPORT   *          
      *    DATE.                                                     *          
      ****************************************************************          
       01  WS-CURRENT-DATE.                                                     
           05 CURRENT-CC                  PIC 99.                               
           05 CURRENT-YY                  PIC 99.                               
           05 CURRENT-MM                  PIC 99.                               
           05 CURRENT-DD                  PIC 99.                               
      ****************************************************************          
      *    GET K160-DTE-OPEN-BF AS GL TRANS DATE FOR MONTH           *          
      ****************************************************************          
       01  WS-F180-TRANS-DATE.                                                  
           05 WS-F180-TRANS-CCYY          PIC 9(4).                             
           05 WS-F180-TRANS-CCYY-N REDEFINES WS-F180-TRANS-CCYY.                
              10 WS-F180-TRANS-CC         PIC 99.                               
              10 WS-F180-TRANS-YY         PIC 99.                               
           05 WS-F180-TRANS-MM            PIC 99.                               
           05 WS-F180-TRANS-DD            PIC 99.                               
                                                                                
      ****************************************************************          
      *    DATE FOR EMAIL ALERT                                      *          
      ****************************************************************          
       01  WS-DATE.                                                             
           05  WS-DTE-FMT8.                                                     
               10  WS-DTE-CCYY.                                                 
                   15  WS-DTE-CC         PIC 9(2)   VALUE ZEROES.               
                   15  WS-DTE-YY         PIC 9(2)   VALUE ZEROES.               
               10  WS-DTE-MM             PIC 9(2)   VALUE ZEROES.               
               10  WS-DTE-DD             PIC 9(2)   VALUE ZEROES.               
           05  WS-DTE-FMT10.                                                    
               10  WS-DTE-DD             PIC 9(2)   VALUE ZEROES.               
               10  FILLER                PIC X      VALUE '/'.                  
               10  WS-DTE-MM             PIC 9(2)   VALUE ZEROES.               
               10  FILLER                PIC X      VALUE '/'.                  
               10  WS-DTE-CCYY.                                                 
                   15  WS-DTE-CC         PIC 9(2)   VALUE ZEROES.               
                   15  WS-DTE-YY         PIC 9(2)   VALUE ZEROES.               
           05  WS-DTE-CURR-8             PIC 9(8)   VALUE ZEROES.               
           05  WS-DTE-CURR-10            PIC X(10)  VALUE ZEROES.               
                                                                                
      ****************************************************************          
      *    MAIL HEADER                                               *          
      ****************************************************************          
       01  MAIL-HDR-HELO.                                                       
           05  FILLER PIC X(132) VALUE 'HELO SGPHDB1'.                          
                                                                                
       01  MAIL-HDR-MAIL-FROM.                                                  
           05  FILLER PIC X(132) VALUE 'MAIL FROM:<OPCP@SGPHDB1>'.              
                                                                                
       01  MAIL-HDR-MAIL-RCPT-TO.                                               
           05  FILLER PIC X(132) VALUE SPACES.                                  
                                                                                
       01  MAIL-HDR-MAIL-RCPT-TO1.                                              
           05  FILLER PIC X(132)    VALUE 'RCPT TO:<FARAH_HANNAN_MOHAMED        
      -        '_E_ZARKI@HDB.GOV.SG>'.                                          
                                                                                
       01  MAIL-HDR-MAIL-RCPT-TO2.                                              
           05  FILLER PIC X(132)    VALUE 'RCPT TO:<SUSANNA_MC_SEAH@HDB.        
      -        'GOV.SG>'.                                                       
                                                                                
       01  MAIL-HDR-MAIL-RCPT-CC1.                                              
           05  FILLER PIC X(132)    VALUE 'RCPT TO:<AGNES_PE_WAN@HDB.GOV        
      -        '.SG>'.                                                          
                                                                                
       01  MAIL-HDR-MAIL-RCPT-CC2.                                              
           05  FILLER PIC X(132)    VALUE 'RCPT TO:<SWI_LI_LI@HDB.GOV.SG        
      -        '>'.                                                             
                                                                                
       01  MAIL-HDR-MAIL-RCPT-CC3.                                              
           05  FILLER PIC X(132)    VALUE 'RCPT TO:<BEVERLY_WS_TOH@HDB.G        
      -        'OV.SG>'.                                                        
                                                                                
       01  MAIL-HDR-DATA.                                                       
           05  FILLER PIC X(132) VALUE 'DATA'.                                  
                                                                                
       01  MAIL-HDR-FROM.                                                       
           05  FILLER PIC X(132) VALUE 'FROM:Soc System - Email Alert'.         
                                                                                
       01  MAIL-HDR-MAIL-TO.                                                    
           05  FILLER PIC X(132) VALUE SPACES.                                  
                                                                                
       01  MAIL-HDR-MAIL-TO-FARAH.                                              
           05  FILLER PIC X(132)                                                
               VALUE 'TO:<Farah_Hannan_MOHAMED_E_ZARKI@hdb.gov.sg>'.            
                                                                                
       01  MAIL-HDR-MAIL-TO-SUSANNA.                                            
           05  FILLER PIC X(132)                                                
               VALUE 'TO:<Susanna_MC_SEAH@hdb.gov.sg>'.                         
                                                                                
       01  MAIL-HDR-MAIL-CC1.                                                   
           05  FILLER PIC X(132)                                                
               VALUE 'CC:<Agnes_PE_WAN@hdb.gov.sg>'.                            
                                                                                
       01  MAIL-HDR-MAIL-CC2.                                                   
           05  FILLER PIC X(132)                                                
               VALUE 'CC:<SWI_Li_Li@hdb.gov.sg>'.                               
                                                                                
       01  MAIL-HDR-MAIL-CC3.                                                   
           05  FILLER PIC X(132)                                                
               VALUE 'CC:<Beverly_WS_TOH@hdb.gov.sg>'.                          
                                                                                
       01  MAIL-SUBJECT-LZ3D.                                                   
           05  FILLER PIC X(132)   VALUE 'SUBJECT : Report on Debits and        
      -        ' Credits To and From Clearing Account'.                         
                                                                                
       01  MAIL-BODY-LZ3D              PIC X(132) VALUE SPACES.                 
                                                                                
       01  MAIL-END-LZ3D               PIC X(132) VALUE SPACES.                 
                                                                                
       01  MAIL-HDR-DATE.                                                       
           05  FILLER                  PIC X(6)   VALUE 'DATE: '.               
           05  MAIL-DATE               PIC X(10)  VALUE SPACES.                 
                                                                                
       01  MAIL-END.                                                            
           05 FILLER                   PIC X      VALUE '.'.                    
                                                                                
       01  MAIL-SPACES.                                                         
           05 FILLER                   PIC X(132) VALUE SPACES.                 
                                                                                
      ****************************************************************          
      *    PAGE TITLE FOR REPORT BP13LZ3D.                           *          
      ****************************************************************          
       01  WS-TITLE-1.                                                          
           05  FILLER               PIC X(8)     VALUE 'BP13LZ3D'.              
           05  FILLER               PIC X(6)     VALUE SPACES.                  
           05  FILLER               PIC X(4)     VALUE 'HDB3'.                  
           05  FILLER               PIC X(28)    VALUE SPACES.                  
           05  FILLER               PIC X(39)    VALUE                          
           'S Y S T E M   O F   C O M M I T M E N T'.                           
           05  FILLER               PIC X(13)    VALUE SPACES.                  
           05  FILLER               PIC X(7)     VALUE 'DATE : '.               
           05  LZ3D-EDITED-DATE.                                                
               10  CURRENT-DD       PIC 99.                                     
               10  FILLER           PIC X        VALUE '/'.                     
               10  CURRENT-MM       PIC 99.                                     
               10  FILLER           PIC X        VALUE '/'.                     
               10  CURRENT-CC       PIC 99.                                     
               10  CURRENT-YY       PIC 99.                                     
           05  FILLER               PIC X(3)     VALUE SPACES.                  
           05  FILLER               PIC X(7)     VALUE 'PAGE : '.               
           05  LZ3D-PAGE            PIC ZZZZ9.                                  
                                                                                
       01  WS-TITLE-2.                                                          
           05  FILLER                     PIC X(37)      VALUE SPACES.          
           05  FILLER                     PIC X(57)      VALUE                  
            'REPORT ON DEBITS AND CREDITS TO AND FROM CLEARING ACCOUNT'.        
           05  FILLER                     PIC X(38)      VALUE SPACES.          
                                                                                
       01  WS-TITLE-3.                                                          
           05  FILLER                     PIC X(48)      VALUE SPACES.          
           05  FILLER                     PIC X(36)      VALUE                  
            'BP13F736 AND GENERAL LEDGER BP13F180'.                             
           05  FILLER                     PIC X(48)      VALUE SPACES.          
                                                                                
      ******************************************************************        
      *    HEADERS FOR TOTAL NUMBER OF RECORDS READ/WRITTEN FROM/TO    *        
      *    FILES BP13F736 AND BP13F180.                                *        
      ******************************************************************        
       01  WS-HEADER-LINE-1.                                                    
           05  FILLER                     PIC X(30)      VALUE SPACES.          
           05  LZ3D-READ-F736-CNT         PIC ZZZZ9.                            
           05  FILLER                     PIC X(44)      VALUE                  
               ' RECORDS READ FROM CLEARING ACCOUNT BP13F736'.                  
           05  FILLER                     PIC X(53)      VALUE SPACES.          
                                                                                
       01  WS-HEADER-LINE-2.                                                    
           05  FILLER                     PIC X(30)      VALUE SPACES.          
           05  LZ3D-WRITE-F180-CNT        PIC ZZZZ9.                            
           05  FILLER                     PIC X(44)      VALUE                  
               ' RECORDS WRITTEN TO GENERAL LEDGER  BP13F180'.                  
           05  FILLER                     PIC X(53)      VALUE SPACES.          
      ******************************************************************        
      *    SUMMARY OF NUMBER OF CREDITS AND DEBITS RECORDS TRANSFERED  *        
      *    ACCORDING TO PAYMENT TYPES.                                 *        
      ******************************************************************        
       01  WS-SUMMARY-HEADER-1.                                                 
           05  FILLER                     PIC X(30)      VALUE SPACES.          
           05  FILLER                     PIC X(44)      VALUE                  
               'SUMMARY OF RECORDS WRITTEN TO GENERAL LEDGER'.                  
           05  FILLER                     PIC X(58)      VALUE SPACES.          
                                                                                
       01  WS-SUMMARY-HEADER-2.                                                 
           05  FILLER                     PIC X(30)      VALUE SPACES.          
           05  FILLER                     PIC X(20)      VALUE                  
               'PAYMENT TYPE        '.                                          
           05  FILLER                     PIC X(4)       VALUE SPACES.          
           05  FILLER                     PIC X(6)       VALUE                  
               'DEBITS'.                                                        
           05  FILLER                     PIC X(3)       VALUE SPACES.          
           05  FILLER                     PIC X(7)       VALUE                  
               'CREDITS'.                                                       
           05  FILLER                     PIC X(3)       VALUE SPACES.          
           05  FILLER                     PIC X(15)      VALUE                  
               'AMT DEBITED ($)'.                                               
           05  FILLER                     PIC X(3)       VALUE SPACES.          
           05  FILLER                     PIC X(15)      VALUE                  
               'AMT CREDITED($)'.                                               
           05  FILLER                     PIC X(26)      VALUE SPACES.          
                                                                                
       01  WS-SUMMARY-DETAIL-1.                                                 
           05  FILLER                     PIC X(20)      VALUE SPACES.          
           05  LZ3D-AMORT-DESC1           PIC X(16)      VALUE SPACES.          
           05  FILLER                     PIC X          VALUE '('.             
           05  LZ3D-DEFER-GL              PIC X(13)      VALUE SPACES.          
           05  FILLER                     PIC X(1)       VALUE ')'.             
           05  FILLER                     PIC X(5)       VALUE SPACES.          
           05  LZ3D-DR-CASES              PIC ZZZZ9.                            
           05  FILLER                     PIC X(2)       VALUE SPACES.          
           05  LZ3D-CR-CASES              PIC ZZZZ9.                            
           05  FILLER                     PIC X(2)       VALUE SPACES.          
           05  LZ3D-DR-DEFER-DEBIT        PIC ZZZZZZZZZZ9.99.                   
           05  FILLER                     PIC X(02)      VALUE SPACES.          
           05  LZ3D-CR-DEFER-CREDIT       PIC ZZZZZZZZZZ9.99.                   
                                                                                
       01  WS-SUMMARY-DETAIL-2.                                                 
           05  FILLER                     PIC X(20)      VALUE SPACES.          
           05  LZ3D-AMORT-DESC            PIC X(16)      VALUE SPACES.          
           05  FILLER                     PIC X          VALUE '('.             
           05  LZ3D-AMORT-GL              PIC X(13)      VALUE SPACES.          
           05  FILLER                     PIC X(1)       VALUE ')'.             
           05  FILLER                     PIC X(5)       VALUE SPACES.          
           05  LZ3D-DR-AMORT-CASES        PIC ZZZZ9.                            
           05  FILLER                     PIC X(2)       VALUE SPACES.          
           05  LZ3D-CR-AMORT-CASES        PIC ZZZZ9.                            
           05  FILLER                     PIC X(2)       VALUE SPACES.          
           05  LZ3D-DR-AMORT-DEBIT        PIC ZZZZZZZZZZ9.99.                   
           05  FILLER                     PIC X(02)      VALUE SPACES.          
           05  LZ3D-CR-AMORT-CREDIT       PIC ZZZZZZZZZZ9.99.                   
                                                                                
       01  WS-FOOTER-LINE-1.                                                    
           05  FILLER                     PIC X(31)      VALUE SPACES.          
           05  FILLER                     PIC X(20)      VALUE                  
               'TOTAL               '.                                          
           05  FILLER                     PIC X(5)       VALUE SPACES.          
           05  LZ3D-DR-CASES-TOT          PIC ZZZZ9.                            
           05  FILLER                     PIC X(2)       VALUE SPACES.          
           05  LZ3D-CR-CASES-TOT          PIC ZZZZ9.                            
           05  FILLER                     PIC X(3)       VALUE SPACES.          
           05  LZ3D-DR-TOT                PIC ZZZZZZZZZ9.99.                    
           05  FILLER                     PIC X(3)       VALUE SPACES.          
           05  LZ3D-CR-TOT                PIC ZZZZZZZZZ9.99.                    
           05  FILLER                     PIC X(25)      VALUE SPACES.          
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
       000-MAINT-ROUTINE.                                                       
                                                                                
           PERFORM 100-OPEN-FILE             THRU 100-EXIT.                     
                                                                                
           PERFORM 200-READ-F736             THRU 200-EXIT.                     
                                                                                
           PERFORM 300-PROCESS-GLTRAN-DETAIL THRU 300-EXIT                      
             UNTIL WS-F736-EOF-FLAG = 'Y'.                                      
                                                                                
           PERFORM 700-PRINT-REPORT          THRU 700-EXIT.                     
                                                                                
           PERFORM 999-CLOSE-FILES           THRU 999-EXIT.                     
                                                                                
       000-EXIT.                                                                
           EXIT.                                                                
                                                                                
      ***************************************************************           
      *    OPENING FILES SECTION                                    *           
      ***************************************************************           
                                                                                
       100-OPEN-FILE.                                                           
           OPEN INPUT BP13F736                                                  
                      SY02F001                                                  
               OUTPUT BP13F180                                                  
                      AC28F526                                                  
                      BP13LZ3D.                                                 
                                                                                
           READ SY02F001 AT END MOVE 'Y' TO SY02F001-EOF.                       
                                                                                
           IF SY02F001-EOF = 'Y'                                                
              DISPLAY 'RECORD NOT FOUND IN SY02F001.'                           
              DISPLAY 'PROCESSING TERMINATED.'                                  
              PERFORM 999-CLOSE-FILES                                           
           ELSE                                                                 
              MOVE F001-DTE-CURRENT TO WS-F180-TRANS-DATE                       
           END-IF.                                                              
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------         
      *    READ FILE BP13F736 FROM THE BEGINING                       *         
      *----------------------------------------------------------------         
       200-READ-F736.                                                           
                                                                                
           READ BP13F736  AT END                                                
                MOVE 'Y' TO WS-F736-EOF-FLAG                                    
                GO TO 200-EXIT.                                                 
                                                                                
           PERFORM 600-CHK-PERIOD           THRU 600-EXIT.                      
                                                                                
           ADD 1 TO WS-READ-F736-COUNT.                                         
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------         
      *    CHECKS FOR THE PAYMENT TYPE AND TRANSFER CONTROL TO CHECK   *        
      *    FOR TRANSACTION TYPE.                                       *        
      *----------------------------------------------------------------         
       300-PROCESS-GLTRAN-DETAIL.                                               
                                                                                
           PERFORM 340-INITIALIZE-FIELDS THRU 340-EXIT                          
                                                                                
           IF F736-AMT-GRANT-AHG-CPF NOT = ZEROES OR                            
              F736-AMT-GRANT-EHG-CPF NOT = ZEROES OR                            
              F736-AMT-GRANT-SHG-CPF NOT = ZEROES OR                            
              F736-AMT-GRANT-SUG-CPF NOT = ZEROES OR                            
              F736-AMT-GRANT-SRG-CPF NOT = ZEROES OR                            
              F736-AMT-GRANT-HGT-CPF NOT = ZEROES OR                            
              F736-AMT-GRANT-REG-CPF NOT = ZEROES OR                            
              F736-AMT-GRANT-FSG-CPF NOT = ZEROES OR                            
              F736-AMT-GRANT-TUG-CPF NOT = ZEROES OR                            
              F736-AMT-GRANT-ATG-CPF NOT = ZEROES OR                            
              F736-AMT-INT-CPF       NOT = ZEROES                               
              ADD 1 TO WS-WITH-GRANT                                            
              PERFORM 420-CR-GRANT       THRU 420-EXIT                          
              PERFORM 520-DR-GRANT       THRU 520-EXIT                          
           END-IF                                                               
                                                                                
           PERFORM 200-READ-F736          THRU 200-EXIT.                        
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------         
       340-INITIALIZE-FIELDS.                                                   
      *----------------------------------------------------------------         
                                                                                
           IF F736-AMT-GRANT-AHG-CPF NOT NUMERIC                                
              MOVE ZEROES                   TO F736-AMT-GRANT-AHG-CPF           
           END-IF.                                                              
                                                                                
           IF F736-AMT-GRANT-EHG-CPF NOT NUMERIC                                
              MOVE ZEROES                   TO F736-AMT-GRANT-EHG-CPF           
           END-IF.                                                              
                                                                                
           IF F736-AMT-GRANT-SHG-CPF NOT NUMERIC                                
              MOVE ZEROES                   TO F736-AMT-GRANT-SHG-CPF           
           END-IF.                                                              
                                                                                
           IF F736-AMT-GRANT-SUG-CPF NOT NUMERIC                                
              MOVE ZEROES                   TO F736-AMT-GRANT-SUG-CPF           
           END-IF.                                                              
                                                                                
           IF F736-AMT-GRANT-SRG-CPF NOT NUMERIC                                
              MOVE ZEROES                   TO F736-AMT-GRANT-SRG-CPF           
           END-IF.                                                              
                                                                                
           IF F736-AMT-GRANT-HGT-CPF NOT NUMERIC                                
              MOVE ZEROES                   TO F736-AMT-GRANT-HGT-CPF           
           END-IF.                                                              
                                                                                
           IF F736-AMT-GRANT-REG-CPF NOT NUMERIC                                
              MOVE ZEROES                   TO F736-AMT-GRANT-REG-CPF           
           END-IF.                                                              
                                                                                
           IF F736-AMT-GRANT-FSG-CPF NOT NUMERIC                                
              MOVE ZEROES                   TO F736-AMT-GRANT-FSG-CPF           
           END-IF.                                                              
                                                                                
           IF F736-AMT-INT-CPF NOT NUMERIC                                      
              MOVE ZEROES                   TO F736-AMT-INT-CPF                 
           END-IF.                                                              
                                                                                
       340-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------         
       420-CR-GRANT.                                                            
      *----------------------------------------------------------------         
                                                                                
      ***AHG GRANT                                                              
           IF F736-AMT-GRANT-AHG-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'AHG'                    TO F180-DTE-POST                    
              COMPUTE F180-CR-AMT = 0 - F736-AMT-GRANT-AHG-CPF                  
                                                                                
              MOVE SPACES                   TO WS-ACC-NO1                       
              MOVE '0'                      TO WS-ACC-LEAD                      
              MOVE '3488'                   TO WS-ACC-GL                        
              MOVE 'SG'                     TO F180-JR-SC                       
              IF F736-NUM-SHORTLEASE-TAG = 'N ' OR ' N' OR SPACES               
                 ADD   1                    TO WS-CR-AMORT-AHG-L                
                 ADD F180-CR-AMT            TO WS-CR-AMORT-AMT-AHG-L            
                 MOVE '40'                  TO WS-ACC-FILLER                    
                 MOVE '407600'              TO WS-ACC-INTERNAL                  
                 MOVE WS-ACC-NO1            TO WS-CR-GL-AHG-L                   
                 MOVE 'SOC - AHG GRANT RECOVERY' TO F180-TRANS-DESC             
              ELSE                                                              
                 ADD   1                    TO WS-CR-AMORT-AHG                  
                 ADD F180-CR-AMT            TO WS-CR-AMORT-AMT-AHG              
                 MOVE '57'                  TO WS-ACC-FILLER                    
                 MOVE '407000'              TO WS-ACC-INTERNAL                  
                 MOVE WS-ACC-NO1            TO WS-CR-GL-AHG                     
                 MOVE 'SOC - AHG GRANT RECOVERY FLEXI'                          
                                            TO F180-TRANS-DESC                  
              END-IF                                                            
                                                                                
              MOVE WS-ACC-NO1               TO F180-ACC-NO1                     
                                                                                
              WRITE F180-GL-REC                                                 
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***EHG GRANT                                                              
           IF F736-AMT-GRANT-EHG-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'EHG'                    TO F180-DTE-POST                    
              COMPUTE F180-CR-AMT = 0 - F736-AMT-GRANT-EHG-CPF                  
                                                                                
              MOVE SPACES                   TO WS-ACC-NO1                       
              MOVE '0'                      TO WS-ACC-LEAD                      
              MOVE '3488'                   TO WS-ACC-GL                        
              MOVE 'SG'                     TO F180-JR-SC                       
              IF F736-NUM-SHORTLEASE-TAG = 'N ' OR ' N' OR SPACES               
                 ADD   1                    TO WS-CR-AMORT-EHG-L                
                 ADD F180-CR-AMT            TO WS-CR-AMORT-AMT-EHG-L            
                 MOVE '40'                  TO WS-ACC-FILLER                    
                 MOVE '407900'              TO WS-ACC-INTERNAL                  
                 MOVE WS-ACC-NO1            TO WS-CR-GL-EHG-L                   
                 MOVE 'SOC - EHG GRANT RECOVERY' TO F180-TRANS-DESC             
              ELSE                                                              
                 ADD   1                    TO WS-CR-AMORT-EHG                  
                 ADD F180-CR-AMT            TO WS-CR-AMORT-AMT-EHG              
                 MOVE '57'                  TO WS-ACC-FILLER                    
                 MOVE '407900'              TO WS-ACC-INTERNAL                  
                 MOVE WS-ACC-NO1            TO WS-CR-GL-EHG                     
                 MOVE 'SOC - EHG GRANT RECOVERY FLEXI'                          
                                            TO F180-TRANS-DESC                  
              END-IF                                                            
                                                                                
              MOVE WS-ACC-NO1               TO F180-ACC-NO1                     
                                                                                
              WRITE F180-GL-REC                                                 
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***SHG GRANT                                                              
           IF F736-AMT-GRANT-SHG-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'SHG'                    TO F180-DTE-POST                    
              COMPUTE F180-CR-AMT = 0 - F736-AMT-GRANT-SHG-CPF                  
                                                                                
              MOVE SPACES                   TO WS-ACC-NO1                       
              MOVE '0'                      TO WS-ACC-LEAD                      
              MOVE '3488'                   TO WS-ACC-GL                        
              MOVE 'SG'                     TO F180-JR-SC                       
              IF F736-NUM-SHORTLEASE-TAG = 'N ' OR ' N' OR SPACES               
                 ADD   1                    TO WS-CR-AMORT-SHG-L                
                 ADD F180-CR-AMT            TO WS-CR-AMORT-AMT-SHG-L            
                 MOVE '40'                  TO WS-ACC-FILLER                    
                 MOVE '407000'              TO WS-ACC-INTERNAL                  
                 MOVE WS-ACC-NO1            TO WS-CR-GL-SHG-L                   
                 MOVE 'SOC - SHG GRANT RECOVERY' TO F180-TRANS-DESC             
              ELSE                                                              
                 ADD   1                    TO WS-CR-AMORT-SHG                  
                 ADD F180-CR-AMT            TO WS-CR-AMORT-AMT-SHG              
                 MOVE '57'                  TO WS-ACC-FILLER                    
                 MOVE '407800'              TO WS-ACC-INTERNAL                  
                 MOVE WS-ACC-NO1            TO WS-CR-GL-SHG                     
                 MOVE 'SOC - SHG GRANT RECOVERY FLEXI'                          
                                            TO F180-TRANS-DESC                  
              END-IF                                                            
                                                                                
              MOVE WS-ACC-NO1               TO F180-ACC-NO1                     
              WRITE F180-GL-REC                                                 
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***SUG GRANT                                                              
           IF F736-AMT-GRANT-SUG-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'SUG'                    TO F180-DTE-POST                    
              COMPUTE F180-CR-AMT = 0 - F736-AMT-GRANT-SUG-CPF                  
                                                                                
              MOVE SPACES                   TO WS-ACC-NO1                       
              MOVE '0'                      TO WS-ACC-LEAD                      
              MOVE '40'                     TO WS-ACC-FILLER                    
              MOVE '407100'                 TO WS-ACC-INTERNAL                  
              MOVE '3488'                   TO WS-ACC-GL                        
              MOVE 'SG'                     TO F180-JR-SC                       
              MOVE 'SOC - SUG GRANT RECOVERY'                                   
                                            TO F180-TRANS-DESC                  
              ADD   1                       TO WS-CR-AMORT-SUG                  
              ADD F180-CR-AMT               TO WS-CR-AMORT-AMT-SUG              
              MOVE WS-ACC-NO1               TO WS-CR-GL-SUG                     
                                               F180-ACC-NO1                     
              WRITE F180-GL-REC                                                 
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***SRG GRANT                                                              
           IF F736-AMT-GRANT-SRG-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'SRG'                    TO F180-DTE-POST                    
              COMPUTE F180-CR-AMT = 0 - F736-AMT-GRANT-SRG-CPF                  
                                                                                
              MOVE SPACES                   TO WS-ACC-NO1                       
              MOVE '0'                      TO WS-ACC-LEAD                      
              MOVE '3488'                   TO WS-ACC-GL                        
              MOVE 'SG'                     TO F180-JR-SC                       
              IF F736-NUM-SHORTLEASE-TAG = 'N ' OR ' N' OR SPACES               
                 ADD   1                    TO WS-CR-AMORT-SRG-L                
                 ADD F180-CR-AMT            TO WS-CR-AMORT-AMT-SRG-L            
                 MOVE '40'                  TO WS-ACC-FILLER                    
                 MOVE '407300'              TO WS-ACC-INTERNAL                  
                 MOVE WS-ACC-NO1            TO WS-CR-GL-SRG-L                   
                 MOVE 'SOC - SRG GRANT RECOVERY'                                
                                            TO F180-TRANS-DESC                  
              ELSE                                                              
                 ADD   1                    TO WS-CR-AMORT-SRG                  
                 ADD F180-CR-AMT            TO WS-CR-AMORT-AMT-SRG              
                 MOVE '57'                  TO WS-ACC-FILLER                    
                 MOVE '407300'              TO WS-ACC-INTERNAL                  
                 MOVE WS-ACC-NO1            TO WS-CR-GL-SRG                     
                 MOVE 'SOC - SRG GRANT RECOVERY FLEXI'                          
                                            TO F180-TRANS-DESC                  
              END-IF                                                            
                                                                                
              MOVE WS-ACC-NO1               TO F180-ACC-NO1                     
              WRITE F180-GL-REC                                                 
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***HGT GRANT                                                              
           IF F736-AMT-GRANT-HGT-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'HGT'                    TO F180-DTE-POST                    
              COMPUTE F180-CR-AMT = 0 - F736-AMT-GRANT-HGT-CPF                  
                                                                                
              MOVE SPACES                   TO WS-ACC-NO1                       
              IF F736-NUM-REGN(1:1) = '6'                                       
                 MOVE '8'                   TO WS-ACC-LEAD                      
                 MOVE '40'                  TO WS-ACC-FILLER                    
                 MOVE '407600'              TO WS-ACC-INTERNAL                  
                 MOVE '8782'                TO WS-ACC-GL                        
                 ADD   1                    TO WS-CR-AMORT-HGT                  
                 ADD F180-CR-AMT            TO WS-CR-AMORT-AMT-HGT              
                 MOVE WS-ACC-NO1            TO WS-CR-GL-HGT                     
                 MOVE 'SOC - EC GRANT RECOVERY' TO F180-TRANS-DESC              
              ELSE                                                              
                 IF F736-NUM-REGN(1:1) = '5'                                    
                    MOVE '8'                TO WS-ACC-LEAD                      
                    MOVE '40'               TO WS-ACC-FILLER                    
                    MOVE '407600'           TO WS-ACC-INTERNAL                  
                    MOVE '8784'             TO WS-ACC-GL                        
                    ADD   1                 TO WS-CR-AMORT-HGT1                 
                    ADD F180-CR-AMT         TO WS-CR-AMORT-AMT-HGT1             
                    MOVE WS-ACC-NO1         TO WS-CR-GL-HGT1                    
                    MOVE 'SOC - DBSS GRANT RECOVERY' TO F180-TRANS-DESC         
                 ELSE                                                           
                    MOVE '8'                TO WS-ACC-LEAD                      
                    MOVE '40'               TO WS-ACC-FILLER                    
                    MOVE '407600'           TO WS-ACC-INTERNAL                  
                    MOVE '8E85'             TO WS-ACC-GL                        
                    ADD   1                 TO WS-CR-AMORT-HGT2                 
                    ADD F180-CR-AMT         TO WS-CR-AMORT-AMT-HGT2             
                    MOVE WS-ACC-NO1         TO WS-CR-GL-HGT2                    
                    MOVE 'SOC - DBSS AHG GRANT RECOVERY'                        
                                            TO F180-TRANS-DESC                  
                 END-IF                                                         
              END-IF                                                            
                                                                                
              MOVE 'SG'                     TO F180-JR-SC                       
              MOVE WS-ACC-NO1               TO F180-ACC-NO1                     
                                                                                
              WRITE F180-GL-REC                                                 
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***REG GRANT                                                              
           IF F736-AMT-GRANT-REG-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'REG'                    TO F180-DTE-POST                    
              COMPUTE F180-CR-AMT = 0 - F736-AMT-GRANT-REG-CPF                  
                                                                                
              MOVE SPACES                   TO WS-ACC-NO1                       
              MOVE '0'                      TO WS-ACC-LEAD                      
              MOVE '57'                     TO WS-ACC-FILLER                    
              MOVE '419200'                 TO WS-ACC-INTERNAL                  
              MOVE '3488'                   TO WS-ACC-GL                        
              MOVE 'SG'                     TO F180-JR-SC                       
              MOVE 'SOC - REG GRANT RECOVERY FLEXI'                             
                                            TO F180-TRANS-DESC                  
              ADD   1                       TO WS-CR-AMORT-REG                  
              ADD F180-CR-AMT               TO WS-CR-AMORT-AMT-REG              
              MOVE WS-ACC-NO1               TO WS-CR-GL-REG                     
                                               F180-ACC-NO1                     
              WRITE F180-GL-REC                                                 
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***FSG GRANT                                                              
           IF F736-AMT-GRANT-FSG-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'FSG'                    TO F180-DTE-POST                    
              COMPUTE F180-CR-AMT = 0 - F736-AMT-GRANT-FSG-CPF                  
                                                                                
              MOVE SPACES                   TO WS-ACC-NO1                       
              MOVE '0'                      TO WS-ACC-LEAD                      
              MOVE '57'                     TO WS-ACC-FILLER                    
              MOVE '41FS00'                 TO WS-ACC-INTERNAL                  
              MOVE '3491'                   TO WS-ACC-GL                        
              MOVE 'SG'                     TO F180-JR-SC                       
              MOVE 'SOC - FSG GRANT RECOVERY'                                   
                                            TO F180-TRANS-DESC                  
              ADD   1                       TO WS-CR-AMORT-FSG                  
              ADD F180-CR-AMT               TO WS-CR-AMORT-AMT-FSG              
              MOVE WS-ACC-NO1               TO WS-CR-GL-FSG                     
                                               F180-ACC-NO1                     
              WRITE F180-GL-REC                                                 
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***TUG GRANT                                                              
           IF F736-AMT-GRANT-TUG-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'TUG'                    TO F180-DTE-POST                    
              COMPUTE F180-CR-AMT = 0 - F736-AMT-GRANT-TUG-CPF                  
              MOVE SPACES                   TO WS-ACC-NO1                       
              IF F736-NUM-REGN(1:1) = '6'                                       
                 MOVE '8'                   TO WS-ACC-LEAD                      
                 MOVE '40'                  TO WS-ACC-FILLER                    
                 MOVE '407600'              TO WS-ACC-INTERNAL                  
                 MOVE '8782'                TO WS-ACC-GL                        
                 ADD   1                    TO WS-CR-AMORT-TUG                  
                 ADD F180-CR-AMT            TO WS-CR-AMORT-AMT-TUG              
                 MOVE WS-ACC-NO1            TO WS-CR-GL-TUG                     
                 MOVE 'SOC - EC GRANT RECOVERY' TO F180-TRANS-DESC              
              ELSE                                                              
                 IF F736-NUM-REGN(1:1) = '5'                                    
                    MOVE '8'                TO WS-ACC-LEAD                      
                    MOVE '40'               TO WS-ACC-FILLER                    
                    MOVE '407600'           TO WS-ACC-INTERNAL                  
                    MOVE '8784'             TO WS-ACC-GL                        
                    ADD   1                 TO WS-CR-AMORT-TUG1                 
                    ADD F180-CR-AMT         TO WS-CR-AMORT-AMT-TUG1             
                    MOVE WS-ACC-NO1         TO WS-CR-GL-TUG1                    
                    MOVE 'SOC - DBSS GRANT RECOVERY' TO F180-TRANS-DESC         
                 ELSE                                                           
                    MOVE '8'                TO WS-ACC-LEAD                      
                    MOVE '40'               TO WS-ACC-FILLER                    
                    MOVE '407600'           TO WS-ACC-INTERNAL                  
                    MOVE '8E85'             TO WS-ACC-GL                        
                    ADD   1                 TO WS-CR-AMORT-TUG2                 
                    ADD F180-CR-AMT         TO WS-CR-AMORT-AMT-TUG2             
                    MOVE WS-ACC-NO1         TO WS-CR-GL-TUG2                    
                    MOVE 'SOC - DBSS TUG GRANT RECOVERY'                        
                                            TO F180-TRANS-DESC                  
                 END-IF                                                         
              END-IF                                                            
              MOVE 'SG'                     TO F180-JR-SC                       
              MOVE WS-ACC-NO1               TO F180-ACC-NO1                     
              WRITE F180-GL-REC                                                 
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***ATG GRANT                                                              
           IF F736-AMT-GRANT-ATG-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'ATG'                    TO F180-DTE-POST                    
              COMPUTE F180-CR-AMT = 0 - F736-AMT-GRANT-ATG-CPF                  
              MOVE SPACES                   TO WS-ACC-NO1                       
              IF F736-NUM-REGN(1:1) = '6'                                       
                 MOVE '8'                   TO WS-ACC-LEAD                      
                 MOVE '40'                  TO WS-ACC-FILLER                    
                 MOVE '407600'              TO WS-ACC-INTERNAL                  
                 MOVE '8782'                TO WS-ACC-GL                        
                 ADD   1                    TO WS-CR-AMORT-ATG                  
                 ADD F180-CR-AMT            TO WS-CR-AMORT-AMT-ATG              
                 MOVE WS-ACC-NO1            TO WS-CR-GL-ATG                     
                 MOVE 'SOC - EC GRANT RECOVERY' TO F180-TRANS-DESC              
              ELSE                                                              
                 IF F736-NUM-REGN(1:1) = '5'                                    
                    MOVE '8'                TO WS-ACC-LEAD                      
                    MOVE '40'               TO WS-ACC-FILLER                    
                    MOVE '407600'           TO WS-ACC-INTERNAL                  
                    MOVE '8784'             TO WS-ACC-GL                        
                    ADD   1                 TO WS-CR-AMORT-ATG1                 
                    ADD F180-CR-AMT         TO WS-CR-AMORT-AMT-ATG1             
                    MOVE WS-ACC-NO1         TO WS-CR-GL-ATG1                    
                    MOVE 'SOC - DBSS GRANT RECOVERY' TO F180-TRANS-DESC         
                 ELSE                                                           
                    MOVE '8'                TO WS-ACC-LEAD                      
                    MOVE '40'               TO WS-ACC-FILLER                    
                    MOVE '407600'           TO WS-ACC-INTERNAL                  
                    MOVE '8E85'             TO WS-ACC-GL                        
                    ADD   1                 TO WS-CR-AMORT-ATG2                 
                    ADD F180-CR-AMT         TO WS-CR-AMORT-AMT-ATG2             
                    MOVE WS-ACC-NO1         TO WS-CR-GL-ATG2                    
                    MOVE 'SOC - DBSS ATG GRANT RECOVERY'                        
                                            TO F180-TRANS-DESC                  
                 END-IF                                                         
              END-IF                                                            
                                                                                
              MOVE 'SG'                     TO F180-JR-SC                       
              MOVE WS-ACC-NO1               TO F180-ACC-NO1                     
                                                                                
              WRITE F180-GL-REC                                                 
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***INTEREST                                                               
           IF F736-AMT-INT-CPF       NOT = ZEROES                               
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'INT'                    TO F180-DTE-POST                    
              COMPUTE F180-CR-AMT = 0 - F736-AMT-INT-CPF                        
                                                                                
              MOVE SPACES                   TO WS-ACC-NO1                       
              MOVE 'SG'                     TO F180-JR-SC                       
              IF F736-NUM-SHORTLEASE-TAG = 'N ' OR ' N' OR SPACES               
                 MOVE '9'                   TO WS-ACC-LEAD                      
                 MOVE '40'                  TO WS-ACC-FILLER                    
                 MOVE '000000'              TO WS-ACC-INTERNAL                  
                 MOVE '6969'                TO WS-ACC-GL                        
                 ADD   1                    TO WS-CR-AMORT-INT-L                
                 ADD F180-CR-AMT            TO WS-CR-AMORT-AMT-INT-L            
                 MOVE WS-ACC-NO1            TO WS-CR-GL-INT-L                   
                 MOVE 'SOC - INT GRANT RECOVERY'                                
                                            TO F180-TRANS-DESC                  
              ELSE                                                              
                 MOVE '0'                   TO WS-ACC-LEAD                      
                 MOVE '57'                  TO WS-ACC-FILLER                    
                 MOVE '000000'              TO WS-ACC-INTERNAL                  
                 MOVE '6969'                TO WS-ACC-GL                        
                 ADD   1                    TO WS-CR-AMORT-INT                  
                 ADD F180-CR-AMT            TO WS-CR-AMORT-AMT-INT              
                 MOVE WS-ACC-NO1            TO WS-CR-GL-INT                     
                 MOVE 'SOC - INT GRANT RECOVERY FLEXI'                          
                                            TO F180-TRANS-DESC                  
              END-IF                                                            
              MOVE WS-ACC-NO1               TO F180-ACC-NO1                     
              WRITE F180-GL-REC                                                 
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
       420-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------         
       520-DR-GRANT.                                                            
      *----------------------------------------------------------------         
                                                                                
      ***AHG GRANT                                                              
           IF F736-AMT-GRANT-AHG-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'AHG'                    TO F180-DTE-POST WS-RCPT-CD         
              COMPUTE F180-CR-AMT = F736-AMT-GRANT-AHG-CPF                      
              MOVE F736-AMT-GRANT-AHG-CPF   TO WS-CR-AMT                        
                                                                                
              MOVE SPACES                   TO WS-ACC-NO1                       
              MOVE '0'                      TO WS-ACC-LEAD                      
              MOVE '000000'                 TO WS-ACC-INTERNAL                  
              MOVE '10'                     TO WS-ACC-FILLER                    
              MOVE '3617'                   TO WS-ACC-GL                        
              MOVE 'SG'                     TO F180-JR-SC                       
              MOVE 'SOC - CPF GRANT RECOVERY'                                   
                                            TO F180-TRANS-DESC                  
              ADD   1                       TO WS-DR-AMORT-AHG                  
              ADD F180-CR-AMT               TO WS-DR-AMORT-AMT-AHG              
              MOVE WS-ACC-NO1               TO WS-GL-AHG                        
                                               F180-ACC-NO1                     
              WRITE F180-GL-REC                                                 
              PERFORM 710-WRITE-F526        THRU 710-EXIT                       
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***EHG GRANT                                                              
           IF F736-AMT-GRANT-EHG-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'EHG'                    TO F180-DTE-POST WS-RCPT-CD         
              COMPUTE F180-CR-AMT = F736-AMT-GRANT-EHG-CPF                      
              MOVE F736-AMT-GRANT-EHG-CPF   TO WS-CR-AMT                        
                                                                                
              MOVE SPACES                   TO WS-ACC-NO1                       
              MOVE '0'                      TO WS-ACC-LEAD                      
              MOVE '000000'                 TO WS-ACC-INTERNAL                  
              MOVE '10'                     TO WS-ACC-FILLER                    
              MOVE '3617'                   TO WS-ACC-GL                        
              MOVE 'SG'                     TO F180-JR-SC                       
              MOVE 'SOC - CPF GRANT RECOVERY'                                   
                                            TO F180-TRANS-DESC                  
              ADD   1                       TO WS-DR-AMORT-EHG                  
              ADD F180-CR-AMT               TO WS-DR-AMORT-AMT-EHG              
              MOVE WS-ACC-NO1               TO WS-GL-EHG                        
                                               F180-ACC-NO1                     
              WRITE F180-GL-REC                                                 
              PERFORM 710-WRITE-F526        THRU 710-EXIT                       
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***SHG GRANT                                                              
           IF F736-AMT-GRANT-SHG-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'SHG'                    TO F180-DTE-POST WS-RCPT-CD         
              COMPUTE F180-CR-AMT = F736-AMT-GRANT-SHG-CPF                      
              MOVE F736-AMT-GRANT-SHG-CPF   TO WS-CR-AMT                        
                                                                                
              MOVE SPACES                   TO WS-ACC-NO1                       
              MOVE '0'                      TO WS-ACC-LEAD                      
              MOVE '000000'                 TO WS-ACC-INTERNAL                  
              MOVE '10'                     TO WS-ACC-FILLER                    
              MOVE 'SG'                     TO F180-JR-SC                       
              MOVE '3617'                   TO WS-ACC-GL                        
              MOVE 'SOC - CPF GRANT RECOVERY'                                   
                                            TO F180-TRANS-DESC                  
              ADD   1                       TO WS-DR-AMORT-SHG                  
              ADD F180-CR-AMT               TO WS-DR-AMORT-AMT-SHG              
              MOVE WS-ACC-NO1               TO WS-GL-SHG                        
                                               F180-ACC-NO1                     
              WRITE F180-GL-REC                                                 
              PERFORM 710-WRITE-F526        THRU 710-EXIT                       
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***SUG GRANT                                                              
           IF F736-AMT-GRANT-SUG-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'SUG'                    TO F180-DTE-POST WS-RCPT-CD         
              COMPUTE F180-CR-AMT = F736-AMT-GRANT-SUG-CPF                      
              MOVE F736-AMT-GRANT-SUG-CPF   TO WS-CR-AMT                        
                                                                                
              MOVE SPACES                   TO WS-ACC-NO1                       
              MOVE '0'                      TO WS-ACC-LEAD                      
              MOVE '000000'                 TO WS-ACC-INTERNAL                  
              MOVE '10'                     TO WS-ACC-FILLER                    
              MOVE '3617'                   TO WS-ACC-GL                        
              MOVE 'SG'                     TO F180-JR-SC                       
              MOVE 'SOC - CPF GRANT RECOVERY'                                   
                                            TO F180-TRANS-DESC                  
              ADD   1                       TO WS-DR-AMORT-SUG                  
              ADD F180-CR-AMT               TO WS-DR-AMORT-AMT-SUG              
              MOVE WS-ACC-NO1               TO WS-GL-SUG                        
                                               F180-ACC-NO1                     
              WRITE F180-GL-REC                                                 
              PERFORM 710-WRITE-F526        THRU 710-EXIT                       
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***SRG GRANT                                                              
           IF F736-AMT-GRANT-SRG-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'SRG'                    TO F180-DTE-POST WS-RCPT-CD         
              COMPUTE F180-CR-AMT = F736-AMT-GRANT-SRG-CPF                      
              MOVE F736-AMT-GRANT-SRG-CPF   TO WS-CR-AMT                        
                                                                                
              MOVE SPACES                   TO WS-ACC-NO1                       
              MOVE '0'                      TO WS-ACC-LEAD                      
              MOVE '000000'                 TO WS-ACC-INTERNAL                  
              MOVE '10'                     TO WS-ACC-FILLER                    
              MOVE '3617'                   TO WS-ACC-GL                        
              MOVE 'SG'                     TO F180-JR-SC                       
              MOVE 'SOC - CPF GRANT RECOVERY'                                   
                                            TO F180-TRANS-DESC                  
              ADD   1                       TO WS-DR-AMORT-SRG                  
              ADD F180-CR-AMT               TO WS-DR-AMORT-AMT-SRG              
              MOVE WS-ACC-NO1               TO WS-GL-SRG                        
                                               F180-ACC-NO1                     
              WRITE F180-GL-REC                                                 
              PERFORM 710-WRITE-F526        THRU 710-EXIT                       
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***HGT GRANT                                                              
           IF F736-AMT-GRANT-HGT-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'HGT'                    TO F180-DTE-POST WS-RCPT-CD         
              COMPUTE F180-CR-AMT = F736-AMT-GRANT-HGT-CPF                      
              MOVE F736-AMT-GRANT-HGT-CPF   TO WS-CR-AMT                        
                                                                                
              MOVE SPACES                   TO WS-ACC-NO1                       
              MOVE '0'                      TO WS-ACC-LEAD                      
              MOVE '000000'                 TO WS-ACC-INTERNAL                  
              MOVE '10'                     TO WS-ACC-FILLER                    
              MOVE '3617'                   TO WS-ACC-GL                        
              MOVE 'SG'                     TO F180-JR-SC                       
              MOVE 'SOC - CPF GRANT RECOVERY' TO F180-TRANS-DESC                
              ADD   1                       TO WS-DR-AMORT-HGT                  
              ADD F180-CR-AMT               TO WS-DR-AMORT-AMT-HGT              
              MOVE WS-ACC-NO1               TO WS-GL-HGT                        
                                               F180-ACC-NO1                     
              WRITE F180-GL-REC                                                 
              PERFORM 710-WRITE-F526        THRU 710-EXIT                       
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***REG GRANT                                                              
           IF F736-AMT-GRANT-REG-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'REG'                    TO F180-DTE-POST WS-RCPT-CD         
              COMPUTE F180-CR-AMT = F736-AMT-GRANT-REG-CPF                      
              MOVE F736-AMT-GRANT-REG-CPF   TO WS-CR-AMT                        
                                                                                
              MOVE SPACES                   TO WS-ACC-NO1                       
              MOVE '0'                      TO WS-ACC-LEAD                      
              MOVE '000000'                 TO WS-ACC-INTERNAL                  
              MOVE '10'                     TO WS-ACC-FILLER                    
              MOVE '3617'                   TO WS-ACC-GL                        
              MOVE 'SG'                     TO F180-JR-SC                       
              MOVE 'SOC - CPF GRANT RECOVERY'                                   
                                            TO F180-TRANS-DESC                  
              ADD   1                       TO WS-DR-AMORT-REG                  
              ADD F180-CR-AMT               TO WS-DR-AMORT-AMT-REG              
              MOVE WS-ACC-NO1               TO WS-GL-REG                        
                                               F180-ACC-NO1                     
              WRITE F180-GL-REC                                                 
              PERFORM 710-WRITE-F526        THRU 710-EXIT                       
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***FSG GRANT                                                              
           IF F736-AMT-GRANT-FSG-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'FSG'                    TO F180-DTE-POST WS-RCPT-CD         
              COMPUTE F180-CR-AMT = F736-AMT-GRANT-FSG-CPF                      
              MOVE F736-AMT-GRANT-FSG-CPF   TO WS-CR-AMT                        
                                                                                
              MOVE SPACES                   TO WS-ACC-NO1                       
              MOVE '0'                      TO WS-ACC-LEAD                      
              MOVE '000000'                 TO WS-ACC-INTERNAL                  
              MOVE '10'                     TO WS-ACC-FILLER                    
              MOVE '3617'                   TO WS-ACC-GL                        
              MOVE 'SG'                     TO F180-JR-SC                       
              MOVE 'SOC - CPF GRANT RECOVERY'                                   
                                            TO F180-TRANS-DESC                  
              ADD   1                       TO WS-DR-AMORT-FSG                  
              ADD F180-CR-AMT               TO WS-DR-AMORT-AMT-FSG              
              MOVE WS-ACC-NO1               TO WS-GL-FSG                        
                                               F180-ACC-NO1                     
              WRITE F180-GL-REC                                                 
              PERFORM 710-WRITE-F526        THRU 710-EXIT                       
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***TUG GRANT                                                              
           IF F736-AMT-GRANT-TUG-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'TUG'                    TO F180-DTE-POST WS-RCPT-CD         
              COMPUTE F180-CR-AMT = F736-AMT-GRANT-TUG-CPF                      
              MOVE F736-AMT-GRANT-TUG-CPF   TO WS-CR-AMT                        
              MOVE SPACES                   TO WS-ACC-NO1                       
              MOVE '0'                      TO WS-ACC-LEAD                      
              MOVE '000000'                 TO WS-ACC-INTERNAL                  
              MOVE '10'                     TO WS-ACC-FILLER                    
              MOVE '3617'                   TO WS-ACC-GL                        
              MOVE 'SG'                     TO F180-JR-SC                       
              MOVE 'SOC - CPF GRANT RECOVERY' TO F180-TRANS-DESC                
              ADD   1                       TO WS-DR-AMORT-TUG                  
              ADD F180-CR-AMT               TO WS-DR-AMORT-AMT-TUG              
              MOVE WS-ACC-NO1               TO WS-GL-TUG                        
                                               F180-ACC-NO1                     
              WRITE F180-GL-REC                                                 
              PERFORM 710-WRITE-F526        THRU 710-EXIT                       
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***ATG GRANT                                                              
           IF F736-AMT-GRANT-ATG-CPF  NOT = ZEROES                              
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'ATG'                    TO F180-DTE-POST WS-RCPT-CD         
              COMPUTE F180-CR-AMT = F736-AMT-GRANT-ATG-CPF                      
              MOVE F736-AMT-GRANT-ATG-CPF   TO WS-CR-AMT                        
              MOVE SPACES                   TO WS-ACC-NO1                       
              MOVE '0'                      TO WS-ACC-LEAD                      
              MOVE '000000'                 TO WS-ACC-INTERNAL                  
              MOVE '10'                     TO WS-ACC-FILLER                    
              MOVE '3617'                   TO WS-ACC-GL                        
              MOVE 'SG'                     TO F180-JR-SC                       
              MOVE 'SOC - CPF GRANT RECOVERY' TO F180-TRANS-DESC                
              ADD   1                       TO WS-DR-AMORT-ATG                  
              ADD F180-CR-AMT               TO WS-DR-AMORT-AMT-ATG              
              MOVE WS-ACC-NO1               TO WS-GL-ATG                        
                                               F180-ACC-NO1                     
              WRITE F180-GL-REC                                                 
              PERFORM 710-WRITE-F526        THRU 710-EXIT                       
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
      ***INT  GRANT                                                             
           IF F736-AMT-INT-CPF       NOT = ZEROES                               
              MOVE SPACES                   TO F180-GL-REC                      
              MOVE ZEROES                   TO F180-AMT-GST-RATE                
              MOVE WS-F180-TRANS-YY         TO F180-JR-YY F180-TRANS-YY         
              MOVE WS-F180-TRANS-MM         TO F180-JR-MM F180-TRANS-MM         
              MOVE WS-F180-TRANS-DD         TO F180-TRANS-DD                    
              MOVE WS-F180-PERIOD           TO F180-PERIOD                      
              MOVE F736-NUM-HDB-REF         TO F180-NUM-SCH-ACC                 
              MOVE 'INT '                   TO F180-DTE-POST WS-RCPT-CD         
              COMPUTE F180-CR-AMT = F736-AMT-INT-CPF                            
              MOVE F736-AMT-INT-CPF         TO WS-CR-AMT                        
                                                                                
              MOVE SPACES                   TO WS-ACC-NO1                       
              MOVE '0'                      TO WS-ACC-LEAD                      
              MOVE '000000'                 TO WS-ACC-INTERNAL                  
              MOVE '10'                     TO WS-ACC-FILLER                    
              MOVE '3617'                   TO WS-ACC-GL                        
              MOVE 'SG'                     TO F180-JR-SC                       
              MOVE 'SOC - CPF GRANT RECOVERY'                                   
                                            TO F180-TRANS-DESC                  
              ADD   1                       TO WS-DR-AMORT-INT                  
              ADD F180-CR-AMT               TO WS-DR-AMORT-AMT-INT              
              MOVE WS-ACC-NO1               TO WS-GL-INT                        
                                               F180-ACC-NO1                     
              WRITE F180-GL-REC                                                 
              PERFORM 710-WRITE-F526        THRU 710-EXIT                       
              ADD 1                         TO WS-WRITE-F180-COUNT              
           END-IF.                                                              
                                                                                
       520-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------         
      *     PRINT REPORT OF RECORDS READ AND WRITTEN TO CLEARING    *           
      *     FILE BP13F736 AND GENERAL LEDGER BP13F180 RESPECTIVELY. *           
      *----------------------------------------------------------------         
       700-PRINT-REPORT.                                                        
                                                                                
           PERFORM 705-FORMAT-EMAIL-HDR     THRU 705-EXIT.                      
                                                                                
           ADD 1 TO WS-PAGE-COUNT.                                              
                                                                                
           MOVE WS-READ-F736-COUNT          TO LZ3D-READ-F736-CNT.              
           MOVE WS-WRITE-F180-COUNT         TO LZ3D-WRITE-F180-CNT.             
                                                                                
           MOVE FUNCTION CURRENT-DATE TO WS-CURRENT-DATE.                       
           MOVE CORRESPONDING WS-CURRENT-DATE TO LZ3D-EDITED-DATE.              
           MOVE WS-PAGE-COUNT               TO LZ3D-PAGE.                       
                                                                                
           WRITE BP13LZ3D-REPORT FROM WS-TITLE-1.                               
           WRITE BP13LZ3D-REPORT FROM WS-TITLE-2.                               
           WRITE BP13LZ3D-REPORT FROM WS-TITLE-3.                               
           WRITE BP13LZ3D-REPORT FROM MAIL-SPACES.                              
           WRITE BP13LZ3D-REPORT FROM WS-HEADER-LINE-1.                         
           WRITE BP13LZ3D-REPORT FROM WS-HEADER-LINE-2.                         
           WRITE BP13LZ3D-REPORT FROM MAIL-SPACES.                              
           WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-HEADER-1.                      
           WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-HEADER-2.                      
                                                                                
      **PRINT TOTAL FOR AHG GRANT - CR                                          
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'AHG SHRT LSE'              TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-AHG                TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-AHG             TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-AHG         TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR AHG GRANT - CR LONG                                     
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'AHG '                      TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-AHG-L              TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-AHG-L           TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-AHG-L       TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR EHG GRANT - CR                                          
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'EHG SHRT LSE'              TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-EHG                TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-EHG             TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-EHG         TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR EHG GRANT - CR LONG                                     
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'EHG '                      TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-EHG-L              TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-EHG-L           TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-EHG-L       TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR SHG GRANT - CR                                          
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'SHG SHRT LSE'              TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-SHG                TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-SHG             TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-SHG         TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR SHG GRANT - CR LONG                                     
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'SHG '                      TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-SHG-L              TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-SHG-L           TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-SHG-L       TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR SUG GRANT - CR                                          
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'SUG '                      TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-SUG                TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-SUG             TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-SUG         TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR SRG GRANT - CR                                          
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'SRG SHRT LSE'              TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-SRG                TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-SRG             TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-SRG         TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR SRG GRANT - CR                                          
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'SRG '                      TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-SRG-L              TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-SRG-L           TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-SRG-L       TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR HGT GRANT - CR                                          
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'HGT EC   '                 TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-HGT                TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-HGT             TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-HGT         TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR HGT1 GRANT - CR                                         
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'HGT DBSS'                  TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-HGT1               TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-HGT1            TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-HGT1        TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR HGT2 GRANT - CR                                         
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'HGT DBSS AHG'              TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-HGT2               TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-HGT2            TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-HGT2        TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR REG GRANT - CR                                          
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'REG '                      TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-REG                TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-REG             TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-REG         TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR FSG GRANT - CR                                          
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'FSG '                      TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-FSG                TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-FSG             TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-FSG         TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR TUG GRANT - CR                                          
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'TUG EC   '                 TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-TUG                TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-TUG             TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-TUG         TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
      **PRINT TOTAL FOR TUG1 GRANT - CR                                         
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'TUG DBSS'                  TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-TUG1               TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-TUG1            TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-TUG1        TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
      **PRINT TOTAL FOR TUG2 GRANT - CR                                         
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'TUG DBSS AHG'              TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-TUG2               TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-TUG2            TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-TUG2        TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
      **PRINT TOTAL FOR ATG GRANT - CR                                          
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'ATG EC   '                 TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-ATG                TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-ATG             TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-ATG         TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
      **PRINT TOTAL FOR ATG1 GRANT - CR                                         
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'ATG DBSS'                  TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-ATG1               TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-ATG1            TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-ATG1        TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR ATG2 GRANT - CR                                         
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'TUG DBSS AHG'              TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-ATG2               TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-ATG2            TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-ATG2        TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR INT  GRANT - CR                                         
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'INT SHRT LSE'              TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-INT                TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-INT             TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-INT         TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      **PRINT TOTAL FOR INT  GRANT - CR LONG                                    
           INITIALIZE WS-SUMMARY-DETAIL-1.                                      
           MOVE 'INT '                      TO LZ3D-AMORT-DESC1.                
           MOVE WS-CR-GL-INT-L              TO LZ3D-DEFER-GL.                   
           MOVE WS-CR-AMORT-INT-L           TO LZ3D-CR-CASES.                   
           MOVE WS-CR-AMORT-AMT-INT-L       TO LZ3D-CR-DEFER-CREDIT.            
           IF LZ3D-DEFER-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-1 AFTER 1            
           END-IF.                                                              
                                                                                
      *COMPUTE TOTAL DEBIT AND CREDIT AMOUNTS                                   
                                                                                
           COMPUTE WS-DR-TOT =  WS-DR-AMORT-AMT-AHG +                           
                                WS-DR-AMORT-AMT-AHG-L +                         
                                WS-DR-AMORT-AMT-EHG +                           
                                WS-DR-AMORT-AMT-EHG-L +                         
                                WS-DR-AMORT-AMT-SHG +                           
                                WS-DR-AMORT-AMT-SHG-L +                         
                                WS-DR-AMORT-AMT-SUG +                           
                                WS-DR-AMORT-AMT-SRG +                           
                                WS-DR-AMORT-AMT-SRG-L +                         
                                WS-DR-AMORT-AMT-HGT +                           
                                WS-DR-AMORT-AMT-HGT1 +                          
                                WS-DR-AMORT-AMT-HGT2 +                          
                                WS-DR-AMORT-AMT-REG +                           
                                WS-DR-AMORT-AMT-FSG +                           
                                WS-DR-AMORT-AMT-TUG +                           
                                WS-DR-AMORT-AMT-TUG1 +                          
                                WS-DR-AMORT-AMT-TUG2 +                          
                                WS-DR-AMORT-AMT-ATG +                           
                                WS-DR-AMORT-AMT-ATG1 +                          
                                WS-DR-AMORT-AMT-ATG2 +                          
                                WS-DR-AMORT-AMT-INT-L +                         
                                WS-DR-AMORT-AMT-INT.                            
                                                                                
           COMPUTE WS-CR-TOT =  WS-CR-AMORT-AMT-AHG +                           
                                WS-CR-AMORT-AMT-AHG-L +                         
                                WS-CR-AMORT-AMT-EHG +                           
                                WS-CR-AMORT-AMT-EHG-L +                         
                                WS-CR-AMORT-AMT-SHG +                           
                                WS-CR-AMORT-AMT-SHG-L +                         
                                WS-CR-AMORT-AMT-SUG +                           
                                WS-CR-AMORT-AMT-SRG +                           
                                WS-CR-AMORT-AMT-SRG-L +                         
                                WS-CR-AMORT-AMT-HGT +                           
                                WS-CR-AMORT-AMT-HGT1 +                          
                                WS-CR-AMORT-AMT-HGT2 +                          
                                WS-CR-AMORT-AMT-REG +                           
                                WS-CR-AMORT-AMT-FSG +                           
                                WS-CR-AMORT-AMT-TUG +                           
                                WS-CR-AMORT-AMT-TUG1 +                          
                                WS-CR-AMORT-AMT-TUG2 +                          
                                WS-CR-AMORT-AMT-ATG +                           
                                WS-CR-AMORT-AMT-ATG1 +                          
                                WS-CR-AMORT-AMT-ATG2 +                          
                                WS-CR-AMORT-AMT-INT-L +                         
                                WS-CR-AMORT-AMT-INT.                            
                                                                                
           MOVE WS-CR-TOT         TO LZ3D-CR-TOT.                               
           MOVE WS-DR-TOT         TO LZ3D-DR-TOT.                               
                                                                                
      *COMPUTE TOTAL CASES OF DEBIT AND CREDIT                                  
                                                                                
           COMPUTE WS-CR-CASES = WS-CR-AMORT-AHG +                              
                                 WS-CR-AMORT-AHG-L +                            
                                 WS-CR-AMORT-EHG +                              
                                 WS-CR-AMORT-EHG-L +                            
                                 WS-CR-AMORT-SHG +                              
                                 WS-CR-AMORT-SHG-L +                            
                                 WS-CR-AMORT-SUG +                              
                                 WS-CR-AMORT-SRG +                              
                                 WS-CR-AMORT-SRG-L +                            
                                 WS-CR-AMORT-HGT +                              
                                 WS-CR-AMORT-HGT1 +                             
                                 WS-CR-AMORT-HGT2 +                             
                                 WS-CR-AMORT-REG +                              
                                 WS-CR-AMORT-FSG +                              
                                 WS-CR-AMORT-TUG +                              
                                 WS-CR-AMORT-TUG1 +                             
                                 WS-CR-AMORT-TUG2 +                             
                                 WS-CR-AMORT-ATG +                              
                                 WS-CR-AMORT-ATG1 +                             
                                 WS-CR-AMORT-ATG2 +                             
                                 WS-CR-AMORT-INT-L +                            
                                 WS-CR-AMORT-INT.                               
                                                                                
           COMPUTE WS-DR-CASES = WS-DR-AMORT-AHG +                              
                                 WS-DR-AMORT-AHG-L +                            
                                 WS-DR-AMORT-EHG +                              
                                 WS-DR-AMORT-EHG-L +                            
                                 WS-DR-AMORT-SHG +                              
                                 WS-DR-AMORT-SHG-L +                            
                                 WS-DR-AMORT-SUG +                              
                                 WS-DR-AMORT-SRG +                              
                                 WS-DR-AMORT-SRG-L +                            
                                 WS-DR-AMORT-HGT +                              
                                 WS-DR-AMORT-HGT1 +                             
                                 WS-DR-AMORT-HGT2 +                             
                                 WS-DR-AMORT-REG +                              
                                 WS-DR-AMORT-FSG +                              
                                 WS-DR-AMORT-TUG +                              
                                 WS-DR-AMORT-TUG1 +                             
                                 WS-DR-AMORT-TUG2 +                             
                                 WS-DR-AMORT-ATG +                              
                                 WS-DR-AMORT-ATG1 +                             
                                 WS-DR-AMORT-ATG2 +                             
                                 WS-DR-AMORT-INT-L +                            
                                 WS-DR-AMORT-INT.                               
                                                                                
      **PRINT TOTAL FOR AMORTISATION - ALL DEBIT                                
           INITIALIZE WS-SUMMARY-DETAIL-2.                                      
           MOVE 'CPF GRANT & INT '          TO LZ3D-AMORT-DESC.                 
           MOVE WS-GL-AHG                   TO LZ3D-AMORT-GL.                   
           MOVE WS-DR-CASES                 TO LZ3D-DR-AMORT-CASES.             
           MOVE WS-DR-TOT                   TO LZ3D-DR-AMORT-DEBIT.             
           IF LZ3D-AMORT-GL NOT = SPACES                                        
              WRITE BP13LZ3D-REPORT FROM WS-SUMMARY-DETAIL-2 AFTER 1            
           END-IF.                                                              
                                                                                
           MOVE WS-CR-CASES                 TO LZ3D-CR-CASES-TOT.               
           MOVE WS-DR-CASES                 TO LZ3D-DR-CASES-TOT.               
                                                                                
           WRITE BP13LZ3D-REPORT FROM WS-FOOTER-LINE-1 AFTER 4.                 
           WRITE BP13LZ3D-REPORT FROM MAIL-END.                                 
                                                                                
       700-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *=============================================================            
       705-FORMAT-EMAIL-HDR.                                                    
      *=============================================================            
                                                                                
           MOVE SPACES                     TO   MAIL-HDR-MAIL-RCPT-TO           
                                                MAIL-HDR-MAIL-TO.               
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8)  TO  WS-DTE-CURR-8.                  
           MOVE WS-DTE-CURR-8               TO  WS-DTE-FMT8.                    
           MOVE CORR WS-DTE-FMT8            TO  WS-DTE-FMT10.                   
           MOVE WS-DTE-FMT10                TO  WS-DTE-CURR-10.                 
                                                                                
           MOVE WS-DTE-CURR-10             TO   MAIL-DATE.                      
                                                                                
           WRITE BP13LZ3D-REPORT           FROM MAIL-HDR-HELO.                  
           WRITE BP13LZ3D-REPORT           FROM MAIL-HDR-MAIL-FROM.             
           WRITE BP13LZ3D-REPORT           FROM MAIL-HDR-MAIL-RCPT-TO1.         
           WRITE BP13LZ3D-REPORT           FROM MAIL-HDR-MAIL-RCPT-TO2.         
           WRITE BP13LZ3D-REPORT           FROM MAIL-HDR-MAIL-RCPT-CC1.         
           WRITE BP13LZ3D-REPORT           FROM MAIL-HDR-MAIL-RCPT-CC2.         
           WRITE BP13LZ3D-REPORT           FROM MAIL-HDR-MAIL-RCPT-CC3.         
           WRITE BP13LZ3D-REPORT           FROM MAIL-HDR-DATA.                  
           WRITE BP13LZ3D-REPORT           FROM MAIL-HDR-FROM.                  
           WRITE BP13LZ3D-REPORT           FROM MAIL-HDR-MAIL-TO-FARAH.         
           WRITE BP13LZ3D-REPORT           FROM MAIL-HDR-MAIL-TO-SUSANNA        
           WRITE BP13LZ3D-REPORT           FROM MAIL-HDR-MAIL-CC1.              
           WRITE BP13LZ3D-REPORT           FROM MAIL-HDR-MAIL-CC2.              
           WRITE BP13LZ3D-REPORT           FROM MAIL-HDR-MAIL-CC3.              
           WRITE BP13LZ3D-REPORT           FROM MAIL-SUBJECT-LZ3D.              
           WRITE BP13LZ3D-REPORT           FROM MAIL-HDR-DATE.                  
           WRITE BP13LZ3D-REPORT           FROM MAIL-SPACES.                    
                                                                                
       705-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------         
       710-WRITE-F526.                                                          
      *----------------------------------------------------------------         
           MOVE SPACES                      TO AC28F526-REC.                    
           INITIALIZE AC28F526-REC.                                             
                                                                                
           MOVE F736-NUM-HDB-REF            TO F526-NUM-HDBREF                  
           MOVE WS-F180-TRANS-DATE          TO F526-DTE-TXN                     
           MOVE WS-F180-TRANS-DD            TO F526-DTE-DMCY(1:2)               
           MOVE WS-F180-TRANS-MM            TO F526-DTE-DMCY(3:2)               
           MOVE WS-F180-TRANS-CCYY          TO F526-DTE-DMCY(5:4)               
           MOVE 'BP13'                      TO F526-NUM-TXN-ID                  
           MOVE 'HQ'                        TO F526-CDE-BO                      
           MOVE ZEROES                      TO F526-NUM-CNT                     
           COMPUTE F526-AMT-TXN = WS-CR-AMT                                     
           MOVE 'D'                         TO F526-NUM-CRDR                    
           MOVE WS-RCPT-CD                  TO F526-NUM-RCPTCD                  
           MOVE F736-NUM-NRIC               TO F526-NUM-UIN                     
           MOVE F736-NUM-REGN               TO F526-NUM-REF                     
                                                                                
           WRITE AC28F526-REC.                                                  
                                                                                
           ADD 1 TO WS-WRITE-F526-COUNT.                                        
                                                                                
       710-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------         
      *    CORRECTING CALENDAR DATE TO FINANCIAL YEAR PERIOD          *         
      *----------------------------------------------------------------         
       600-CHK-PERIOD.                                                          
                                                                                
           IF WS-F180-TRANS-MM   < 4                                            
              ADD 9  WS-F180-TRANS-MM  GIVING WS-F180-PERIOD.                   
                                                                                
           IF WS-F180-TRANS-MM   > 3                                            
              SUBTRACT 3 FROM WS-F180-TRANS-MM  GIVING WS-F180-PERIOD.          
                                                                                
       600-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------         
      *     CLOSE ALL FILES AND STOP RUN.                           *           
      *----------------------------------------------------------------         
       999-CLOSE-FILES.                                                         
           DISPLAY '  PROGRAM : BP13CZ3D        '.                              
           DISPLAY 'RECORDS READ FROM BP13F736 : ' WS-READ-F736-COUNT.          
           DISPLAY 'RECORDS WRITTEN IN BP13F180: ' WS-WRITE-F180-COUNT          
           DISPLAY 'RECORDS WRITTEN IN AC28F526: ' WS-WRITE-F526-COUNT          
           DISPLAY 'RECORDS FOUND WITH GRANTS  : ' WS-WITH-GRANT.               
                                                                                
           CLOSE BP13F736                                                       
                 BP13F180                                                       
                 SY02F001                                                       
                 AC28F526                                                       
                 BP13LZ3D.                                                      
                                                                                
           STOP RUN.                                                            
                                                                                
       999-EXIT.                                                                
           EXIT.                                                                
