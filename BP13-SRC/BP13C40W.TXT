      *===============================================================*         
       IDENTIFICATION DIVISION.                                                 
      *===============================================================*         
       PROGRAM-ID.    BP13C40W.                                                 
       AUTHOR.        DEEPIKA NALLAM.                                           
       DATE-WRITTEN.  JULY  29,2019.                                            
      *===============================================================*         
      * OBJECTIVE  :  GENERATE A REPORT FOR FTP TO MND                *         
      *===============================================================*         
      *                                                               *         
      * INPUT FILE :  1. BP13F40I                                     *         
      *               2. BP13K40C                                     *         
      *               3. BP13K40I                                     *         
      *               4. BP13K410                                     *         
      *               5. BP13K640                                     *         
      *               6. BP13K800                                     *         
      *               7. BP13K820                                     *         
      *               8. BP13K893                                     *         
      *               9. BM06K100                                     *         
      *              10. BM06K110                                     *         
      *              11. BM06K130                                     *         
      *              12. BM06K510                                     *         
      * OUTPUT FILE:  1. BP13F40F                                     *         
      *                                                               *         
      *===============================================================*         
      * REF NO   DATE       BY   AMENDMENTS/ENHANCEMENTS              *         
      *---------------------------------------------------------------*         
      * BP137956 01/08/2019 DN8  NEW PROGRAM.                         *         
      * BP137956 15/08/2019 DN8  TO INCLUDE HEADER REC                *         
      *                          TO READ K893 IF NOT FOUND IN K800    *         
      *                          CATER ESTATE FROM BM06K510           *         
      * BP137956 16/08/2019 DN8  TO CATER F40F-DTE-KEY-COLL FROM      *         
      *                          K110-DTE-KEY-ISSUED                  *         
      * BP137956 19/08/2019 DN8  TO CATER INCOME FROM K820-AMT-INCOME-TP        
      * BP137956 19/08/2019 DN8  TO USE K410-NUM-REPAY-PERIOD FOR     *         
      *                          LOAN-TENURE-ACTUAL                   *         
      * BP137956 20/08/2019 DN8  TO CATER NEW FIELDS 1ST & 2ND CA INCOME        
      * BP137956 20/08/2019 DN8  TO CORRECT THE DUPLICATE DATA.       *         
      * BP137956 21/08/2019 DN8  TO READ K895 IF REC NOT FND IN K820  *         
      *                          TO CATER INC_1STCA_LESSEX &          *         
      *                          INC_2NDCA_LESSEX FROM BP27K250(HLACA)*         
      *                          BP27K250(HLACA_2NDCA) & CHANGE IN    *         
      *                          LAY OUT AS PER MND                   *         
      * BP137956 22/08/2019 DN8  TO INCLUDE 3960-READ-BP27K250 IF     *         
      *                          K800-NUM-CA-SECOND  NOT  = 'Y'       *         
      * BP137956 22/08/2019 DN8  TO READ NUM-HLA FROM K893 IF NOT FND *         
      *                          IN K800.                             *         
      * BP137956 22/08/2019 DN8  CHANGE K820-STATUS TO K895-STATUS    *         
      * BP138047 25/11/2019 KAC1 RECOMPILE FOR BP27 COPYBOOK UPDATE   *         
      * BP137956 05/03/2020 KAC1 ADDED THE FOLLOWING FIELDS TO OUTFILE*         
      *                          NUM-HLA, DTE-2ND-CA & NUM-2ND-CA-RISK*         
      * BP139605 09/05/2023 KAC1 RECOMPILE TO CATER FOR BP27K250 UPDT *         
      *                          TO CATER FOR POLICY CHANGES WITH     *         
      *                          IMPLEMENTATION OF HFE.               *         
      *===============================================================*         
                                                                                
                                                                                
      **********************                                                    
       ENVIRONMENT DIVISION.                                                    
      **********************                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT  BP13K40C  ASSIGN        TO BP13K40C                          
                             ACCESS MODE   IS DYNAMIC                           
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K40C-KEY-FLD                      
                             FILE STATUS   IS WS-K40C-STATUS.                   
                                                                                
           SELECT  BP13K40I  ASSIGN        TO BP13K40I                          
                             ACCESS MODE   IS DYNAMIC                           
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K40I-KEY-FLD                      
                             FILE STATUS   IS WS-K40I-STATUS.                   
                                                                                
           SELECT  BP13K410  ASSIGN        TO BP13K410                          
                             ACCESS MODE   IS DYNAMIC                           
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K410-KEY-FLD                      
                             FILE STATUS   IS WS-K410-STATUS.                   
                                                                                
           SELECT  BP13K640  ASSIGN        TO BP13K640                          
                             ACCESS MODE   IS DYNAMIC                           
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K640-KEY-FLD                      
                             FILE STATUS   IS WS-K640-STATUS.                   
                                                                                
           SELECT  BP13K800  ASSIGN        TO BP13K800                          
                             ACCESS MODE   IS DYNAMIC                           
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K800-NUM-REGN                     
                             FILE STATUS   IS WS-K800-STATUS.                   
                                                                                
           SELECT  BP13K820  ASSIGN        TO BP13K820                          
                             ACCESS MODE   IS DYNAMIC                           
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K820-KEY-FLD                      
                             FILE STATUS   IS WS-K820-STATUS.                   
                                                                                
           SELECT  BP13K893  ASSIGN        TO BP13K893                          
                             ACCESS MODE   IS DYNAMIC                           
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K893-KEY-FLD                      
                             FILE STATUS   IS WS-K893-STATUS.                   
                                                                                
           SELECT  BP13K895  ASSIGN        TO BP13K895                          
                             ACCESS MODE   IS DYNAMIC                           
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K895-KEY-FLD                      
                             FILE STATUS   IS WS-K895-STATUS.                   
                                                                                
           SELECT  BP27K800  ASSIGN        TO BP27K800                          
                             ACCESS MODE   IS DYNAMIC                           
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K800-NUM-HLA                      
                                                OF BP27K800-MASTER              
                             FILE STATUS   IS WS-BP27K800-STATUS.               
                                                                                
           SELECT  BP27K250  ASSIGN        TO BP27K250                          
                             ACCESS MODE   IS DYNAMIC                           
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K250-KEY-FLD                      
                                                OF BP27K250-REC                 
                             FILE STATUS   IS WS-BP27K250-STATUS.               
                                                                                
           SELECT  BP27K251  ASSIGN        TO BP27K251                          
                             ACCESS MODE   IS DYNAMIC                           
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K250-KEY-FLD                      
                                                OF BP27K251-REC                 
                             FILE STATUS   IS WS-BP27K251-STATUS.               
                                                                                
           SELECT  BM06K100  ASSIGN        TO BM06K100                          
                             ACCESS MODE   IS DYNAMIC                           
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K100-KEY-FLD                      
                             FILE STATUS   IS WS-K100-STATUS.                   
                                                                                
           SELECT  BM06K110  ASSIGN        TO BM06K110                          
                             ACCESS MODE   IS DYNAMIC                           
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K110-KEY-FLD                      
                             FILE STATUS   IS WS-K110-STATUS.                   
                                                                                
           SELECT  BM06K130  ASSIGN        TO BM06K130                          
                             ACCESS MODE   IS DYNAMIC                           
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K130-KEY-FLD                      
                             FILE STATUS   IS WS-K130-STATUS.                   
                                                                                
           SELECT  BM06K510  ASSIGN        TO BM06K510                          
                             ACCESS MODE   IS DYNAMIC                           
                             ORGANIZATION  IS INDEXED                           
                             RECORD KEY    IS K510-ESTCDE                       
                             FILE STATUS   IS WS-K510-STATUS.                   
                                                                                
           SELECT  BP13F40I  ASSIGN        TO BP13F40I.                         
           SELECT  BP13F40F  ASSIGN        TO BP13F40F.                         
                                                                                
      ***************                                                           
       DATA DIVISION.                                                           
      ***************                                                           
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD   BP13K40C                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K40C.                                                           
                                                                                
       FD   BP13K40I                                                            
            RECORD CONTAINS 100  CHARACTERS.                                    
       COPY BP13K40I.                                                           
                                                                                
       FD   BP13K410                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K410.                                                           
                                                                                
       FD   BP13K640                                                            
            RECORD CONTAINS 500  CHARACTERS.                                    
       COPY BP13K640.                                                           
                                                                                
       FD   BP13K800                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K820                                                            
            RECORD CONTAINS 400  CHARACTERS.                                    
       COPY BP13K820.                                                           
                                                                                
       FD   BP13K893                                                            
            RECORD CONTAINS 2050 CHARACTERS.                                    
       COPY BP13K893.                                                           
                                                                                
       FD   BP13K895                                                            
            RECORD CONTAINS 0450 CHARACTERS.                                    
       COPY BP13K895.                                                           
                                                                                
       FD   BP27K800                                                            
            RECORD CONTAINS 1200 CHARACTERS.                                    
       COPY BP27K800.                                                           
                                                                                
       FD   BP27K250                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP27K250.                                                           
                                                                                
       FD   BP27K251                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP27K250 REPLACING BP27K250-REC BY BP27K251-REC.                    
                                                                                
       FD   BM06K100                                                            
            RECORD CONTAINS 500  CHARACTERS.                                    
       COPY BM06K100.                                                           
                                                                                
       FD   BM06K110                                                            
            RECORD CONTAINS 500  CHARACTERS.                                    
       COPY BM06K110.                                                           
                                                                                
       FD   BM06K130                                                            
            RECORD CONTAINS 600  CHARACTERS.                                    
       COPY BM06K130.                                                           
                                                                                
       FD   BM06K510                                                            
            RECORD CONTAINS 060  CHARACTERS.                                    
       COPY BM06K510.                                                           
                                                                                
       FD   BP13F40I                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 100  CHARACTERS                                     
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13F40I.                                                           
                                                                                
       FD   BP13F40F                                                            
            BLOCK CONTAINS 0 RECORDS                                            
            RECORD CONTAINS 1000 CHARACTERS                                     
            LABEL RECORDS ARE STANDARD                                          
            RECORDING MODE IS F.                                                
       COPY BP13F40F.                                                           
                                                                                
       WORKING-STORAGE SECTION.                                                 
      ******************************************************************        
      *                   WORKING-STORAGE AREA                         *        
      ******************************************************************        
       01  FILE-VARIABLES.                                                      
           05  WS-K40C-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K40I-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K410-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K640-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K800-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K820-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K893-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K895-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K100-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K110-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K130-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-K510-STATUS          PIC 9(02) VALUE ZEROES.                  
           05  WS-BP27K800-STATUS      PIC 9(02) VALUE ZEROES.                  
           05  WS-BP27K250-STATUS      PIC 9(02) VALUE ZEROES.                  
           05  WS-BP27K251-STATUS      PIC 9(02) VALUE ZEROES.                  
           05  WS-EOF-F40I             PIC X(01) VALUE 'N'.                     
           05  WS-EOF-K820             PIC X(01) VALUE 'N'.                     
           05  WS-EOF-K893             PIC X(01) VALUE 'N'.                     
           05  WS-EOF-K895             PIC X(01) VALUE 'N'.                     
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-F40I-READ            PIC 9(7)  VALUE ZEROES.                  
           05  WS-CNT-F40F-WRITE       PIC 9(7)  VALUE ZEROES.                  
           05  WS-CNT                  PIC 9(2)  VALUE ZEROES.                  
                                                                                
       01  WS-EDIT-AMT.                                                         
           05  WS-AMT-EDIT8            PIC ZZ,ZZZ,ZZ9.99.                       
           05  WS-AMT-EDIT7            PIC  Z,ZZZ,ZZ9.99.                       
           05  WS-AMT-EDIT5            PIC    ZZZ,ZZ9.99.                       
           05  WS-AMT-EDIT             PIC    ZZZ,ZZ9.                          
                                                                                
       01  WS-AMT-GRANT-AHG-E          PIC  Z,ZZZ,ZZ9.99.                       
       01  WS-AMT-GRANT-SHG-E          PIC  Z,ZZZ,ZZ9.99.                       
                                                                                
       01 WS-CURR-DATE.                                                         
          05  WS-CURR-CCYY                 PIC 9(04).                           
          05  WS-CURR-MM                   PIC 9(02).                           
          05  WS-CURR-DD                   PIC 9(02).                           
                                                                                
       01 WS-NUM-HSEMAIN.                                                       
          05  WS-HASH                      PIC X(01) VALUE '#'.                 
          05  WS-NUM-LEVEL                 PIC X(02) VALUE SPACES.              
          05  WS-HIPHEN                    PIC X(01) VALUE '-'.                 
          05  WS-UNIT-MAIN                 PIC X(04) VALUE SPACES.              
          05  WS-UNIT-SUB                  PIC X(03) VALUE SPACES.              
                                                                                
       01 WS-NUM-BLK                       PIC X(05) VALUE SPACES.              
       01 WS-HOUSE-NO                      PIC X(11) VALUE SPACES.              
       01 WS-NME-STREET                    PIC X(32) VALUE SPACES.              
       01 WS-HEADER-REC                    PIC X(01) VALUE 'Y'.                 
                                                                                
       01 WS-K800-K893-COMMON-FIELDS.                                           
          05 WS-NUM-HLA                    PIC X(09) VALUE SPACES.              
          05 WS-NUM-SCH-ACC                PIC X(11) VALUE SPACES.              
          05 WS-NUM-FLAT-TYPE              PIC X(02) VALUE SPACES.              
          05 WS-DTE-BALLOT                 PIC X(08) VALUE SPACES.              
          05 WS-NUM-HOUSEHOLD              PIC X(03) VALUE SPACES.              
          05 WS-NUM-LOAN-TAG               PIC X(01) VALUE SPACES.              
          05 WS-DTE-SALE-AGMT              PIC X(08) VALUE SPACES.              
          05 WS-DTE-1ST-LETTER             PIC X(08) VALUE SPACES.              
          05 WS-DTE-CANCEL                 PIC X(08) VALUE SPACES.              
          05 WS-DTE-2ND-CA                 PIC X(08) VALUE SPACES.              
          05 WS-NUM-2ND-CA-RISK            PIC X(01) VALUE SPACES.              
                                                                                
       01 WS-CA-INCOME-FIELDS.                                                  
          05 WS-AMT-HA1-1STCA-INCOME      PIC 9(05) VALUE ZEROES.               
          05 WS-AMT-HA2-1STCA-INCOME      PIC 9(05) VALUE ZEROES.               
          05 WS-AMT-HA3-1STCA-INCOME      PIC 9(05) VALUE ZEROES.               
          05 WS-AMT-HA4-1STCA-INCOME      PIC 9(05) VALUE ZEROES.               
          05 WS-AMT-HA1-2NDCA-INCOME      PIC 9(05) VALUE ZEROES.               
          05 WS-AMT-HA2-2NDCA-INCOME      PIC 9(05) VALUE ZEROES.               
          05 WS-AMT-HA3-2NDCA-INCOME      PIC 9(05) VALUE ZEROES.               
          05 WS-AMT-HA4-2NDCA-INCOME      PIC 9(05) VALUE ZEROES.               
                                                                                
       01  WS-GRANT-FIELDS.                                                     
           05  WS-NUM-AHG                  PIC X(3)  VALUE SPACES.              
           05  WS-A                        PIC 9(02).                           
           05  WS-P                        PIC 9(02) VALUE ZEROES.              
           05  WS-I                        PIC 9(02) VALUE ZEROES.              
           05  WS-PRSN                     PIC 9(02) VALUE ZEROES.              
           05  WS-STORED                   PIC X(01) VALUE 'N'.                 
           05  WS-AMT-GRANT-AHG-TOT        PIC 9(07)V99 VALUE ZEROES.           
           05  WS-AMT-GRANT-SHG-TOT        PIC 9(07)V99 VALUE ZEROES.           
                                                                                
       01  WS-PRSN-DTLS.                                                        
           05  WS-PERSON OCCURS 4 TIMES.                                        
               10 WS-NRIC               PIC X(9)     VALUE SPACES.              
               10 WS-AMT-AHG-GRANT      PIC 9(06)V99 VALUE ZEROES.              
               10 WS-AMT-SHG-GRANT      PIC 9(06)V99 VALUE ZEROES.              
                                                                                
       01  WS-K820-DTLS.                                                        
           05  WS-FIELD  OCCURS 4 TIMES.                                        
               10 WS-NRIC-K820          PIC X(9)     VALUE SPACES.              
               10 WS-INCOME-K820        PIC 9(5)     VALUE ZEROES.              
                                                                                
       01 WS-HEADER.                                                            
            05  HDR-NUM-REGN        PIC X(08) VALUE 'REGN NUM'.                 
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-TREAT2          PIC X(06) VALUE 'TREAT2'.                   
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-ESTATE          PIC X(06) VALUE 'ESTATE'.                   
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-PROJECT-NAME    PIC X(09) VALUE 'PROJ NAME'.                
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-NH              PIC X(02) VALUE 'NH'.                       
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-CT              PIC X(02) VALUE 'CT'.                       
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-SCH-ACC-NUM     PIC X(12) VALUE 'SCHM ACT NUM'.             
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-FLAT-TYPE       PIC X(09) VALUE 'FLAT TYPE'.                
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-SALES-LAUNCH    PIC X(12) VALUE 'SALES LAUNCH'.             
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-BLK-NO          PIC X(06) VALUE 'BLK NO'.                   
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-HOUSE-NO        PIC X(08) VALUE 'HOUSE NO'.                 
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-NME-STREET      PIC X(06) VALUE 'STREET'.                   
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-HOUSEHOLD-TYPE  PIC X(14) VALUE 'HOUSEHOLD TYPE'.           
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-LOAN-TYPE       PIC X(09) VALUE 'LOAN TYPE'.                
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-DTE-BOOKING     PIC X(11) VALUE 'DTE-BOOKING'.              
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-DATE-SIGN-AGRMT PIC X(15) VALUE 'DATE-SIGN-AGRMT'.          
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-PCD             PIC X(03) VALUE 'PCD'.                      
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-GROUP           PIC X(05) VALUE 'GROUP'.                    
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-HDBREF          PIC X(06) VALUE 'HDBREF'.                   
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-FLAT-PRICE      PIC X(10) VALUE 'FLAT-PRICE'.               
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-LOAN-TEN-ELIG   PIC X(13) VALUE 'LOAN-TEN-ELIG'.            
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-HDB-LOAN-ELIG   PIC X(17) VALUE 'HDB-LOAN-AMT-ELIG'.        
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-LOAN-TEN-ACTUAL PIC X(15) VALUE 'LOAN-TEN-ACTUAL'.          
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-LOAN-AMT-ACTUAL PIC X(15) VALUE 'LOAN-AMT-ACTUAL'.          
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-ICP-CASH        PIC X(08) VALUE 'ICP-CASH'.                 
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-AMT-ICP-CPF1    PIC X(12) VALUE 'AMT-ICP-CPF1'.             
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-AMT-ICP-CPF2    PIC X(12) VALUE 'AMT-ICP-CPF2'.             
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-AMT-ICP-CPF3    PIC X(12) VALUE 'AMT-ICP-CPF3'.             
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-AMT-ICP-CPF4    PIC X(12) VALUE 'AMT-ICP-CPF4'.             
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-AMT-INST-CASH   PIC X(13) VALUE 'AMT-INST-CASH'.            
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-AMT-INST-CPF1   PIC X(13) VALUE 'AMT-INST-CPF1'.            
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-AMT-INST-CPF2   PIC X(13) VALUE 'AMT-INST-CPF2'.            
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-AMT-INST-CPF3   PIC X(13) VALUE 'AMT-INST-CPF3'.            
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-AMT-INST-CPF4   PIC X(13) VALUE 'AMT-INST-CPF4'.            
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-DTE-KEY-COLL    PIC X(11) VALUE 'DTE-KEY-COL'.              
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-DTE-CANCEL      PIC X(10) VALUE 'DTE-CANCEL'.               
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-DOB-LESSE1      PIC X(09) VALUE 'DOB-LESE1'.                
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-DOB-LESSE2      PIC X(09) VALUE 'DOB-LESE2'.                
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-DOB-LESSE3      PIC X(09) VALUE 'DOB-LESE3'.                
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-DOB-LESSE4      PIC X(09) VALUE 'DOB-LESE4'.                
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-INC-1STCA-LSE1  PIC X(14) VALUE 'INC-1STCA-LSE1'.           
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-INC-1STCA-LSE2  PIC X(14) VALUE 'INC-1STCA-LSE2'.           
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-INC-1STCA-LSE3  PIC X(14) VALUE 'INC-1STCA-LSE3'.           
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-INC-1STCA-LSE4  PIC X(14) VALUE 'INC-1STCA-LSE4'.           
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-INC-2NDCA-LSE1  PIC X(14) VALUE 'INC-2NDCA-LSE1'.           
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-INC-2NDCA-LSE2  PIC X(14) VALUE 'INC-2NDCA-LSE2'.           
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-INC-2NDCA-LSE3  PIC X(14) VALUE 'INC-2NDCA-LSE3'.           
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-INC-2NDCA-LSE4  PIC X(14) VALUE 'INC-2NDCA-LSE4'.           
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-DECL-INC-LSE1   PIC X(13) VALUE 'DECL-INC-LSE1'.            
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-DECL-INC-LSE2   PIC X(13) VALUE 'DECL-INC-LSE2'.            
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-DECL-INC-LSE3   PIC X(13) VALUE 'DECL-INC-LSE3'.            
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-DECL-INC-LSE4   PIC X(13) VALUE 'DECL-INC-LSE4'.            
            05  FILLER              PIC X(01) VALUE ';'.                        
            05  HDR-OA-BAL-LSSE1 PIC X(19) VALUE 'OA-BAL-BEF-PUR-LSE1'.         
            05  FILLER           PIC X(01) VALUE ';'.                           
            05  HDR-OA-BAL-LSSE2 PIC X(19) VALUE 'OA-BAL-BEF-PUR-LSE2'.         
            05  FILLER           PIC X(01) VALUE ';'.                           
            05  HDR-OA-BAL-LSSE3 PIC X(19) VALUE 'OA-BAL-BEF-PUR-LSE3'.         
            05  FILLER           PIC X(01) VALUE ';'.                           
            05  HDR-OA-BAL-LSSE4 PIC X(19) VALUE 'OA-BAL-BEF-PUR-LSE4'.         
            05  FILLER           PIC X(01) VALUE ';'.                           
            05  HDR-OA-RETEN-LSSE1 PIC X(14) VALUE 'OA-RETENT-LSE1'.            
            05  FILLER             PIC X(01) VALUE ';'.                         
            05  HDR-OA-RETEN-LSSE2 PIC X(14) VALUE 'OA-RETENT-LSE2'.            
            05  FILLER             PIC X(01) VALUE ';'.                         
            05  HDR-OA-RETEN-LSSE3 PIC X(14) VALUE 'OA-RETENT-LSE3'.            
            05  FILLER             PIC X(01) VALUE ';'.                         
            05  HDR-OA-RETEN-LSSE4 PIC X(14) VALUE 'OA-RETENT-LSE4'.            
            05  FILLER             PIC X(01) VALUE ';'.                         
            05  HDR-KC-LT-SEND-DTE PIC X(15) VALUE 'KC-LETR-SND-DTE'.           
            05  FILLER             PIC X(01) VALUE ';'.                         
            05  HDR-CASH-TOP-UP-KC PIC X(14) VALUE 'CASH-TOP-UP-KC'.            
            05  FILLER             PIC X(01) VALUE ';'.                         
            05  HDR-AHG-AMOUNT     PIC X(07) VALUE 'AHG-AMT'.                   
            05  FILLER             PIC X(01) VALUE ';'.                         
            05  HDR-SHG-AMOUNT     PIC X(07) VALUE 'SHG-AMT'.                   
            05  FILLER             PIC X(01) VALUE ';'.                         
            05  HDR-NUM-HLA        PIC X(07) VALUE 'NUM-HLA'.                   
            05  FILLER             PIC X(01) VALUE ';'.                         
            05  HDR-DTE-2ND-CA     PIC X(10) VALUE 'DTE-2ND-CA'.                
            05  FILLER             PIC X(01) VALUE ';'.                         
            05  HDR-2ND-CA-RISK    PIC X(11) VALUE '2ND-CA-RISK'.               
            05  FILLER             PIC X(170) VALUE SPACES.                     
                                                                                
       01  SQL-CODE                        PIC 9(4).                            
                                                                                
      *----------------------------------------------------------------*        
      *        LINKAGE FOR SUB-PROGRAM BP13C913                        *        
      *----------------------------------------------------------------*        
       01  WS-LINK-REC.                                                         
           05  WS-LINK-NUM-SCH-ACC.                                             
               10  WS-LINK-NUM-SCH         PIC X(4).                            
               10  WS-LINK-NUM-ACC         PIC X(5).                            
                                                                                
       COPY P13COMM8.                                                           
                                                                                
      *----------------------------------------------------------------*        
      *        LINKAGE FOR SUB-PROGRAM BP13CB4D                        *        
      *----------------------------------------------------------------*        
       01 WS-LINK-VARIABLES.                                                    
          05 WS-NUM-CALL-ACTION             PIC X(01).                          
          05 WS-NUM-RGSTRN-INPUT            PIC X(08).                          
          05 WS-NUM-GRANT-TYPE              PIC X(03).                          
          05 WS-AMT-GRANT-LINK              PIC S9(7)V9(2) USAGE COMP-3.        
          05 WS-CDE-SYSERR                  PIC X(04).                          
          05 WS-CDE-ERROR                   PIC X(04).                          
          05 WS-ERR-MSG                     PIC X(32).                          
                                                                                
       COPY P13COM73.                                                           
                                                                                
      ******************************************************************        
      *                   P R O G R A M     B O D Y                    *        
      ******************************************************************        
                                                                                
      ********************                                                      
       PROCEDURE DIVISION.                                                      
      ********************                                                      
                                                                                
      ******************************************************************        
       0000-MAIN.                                                               
      ******************************************************************        
                                                                                
           PERFORM 1000-OPEN-ROUTINE       THRU 1000-EXIT.                      
                                                                                
           PERFORM 2000-READ-BP13F40I      THRU 2000-EXIT                       
             UNTIL WS-EOF-F40I = 'Y'.                                           
                                                                                
           PERFORM 9999-CLOSE-ROUTINE      THRU 9999-EXIT.                      
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       1000-OPEN-ROUTINE.                                                       
      ******************************************************************        
                                                                                
           OPEN INPUT  BP13F40I                                                 
                       BP13K40C                                                 
                       BP13K40I                                                 
                       BP13K410                                                 
                       BP13K640                                                 
                       BP13K800                                                 
                       BP13K820                                                 
                       BP13K893                                                 
                       BP13K895                                                 
                       BP27K800                                                 
                       BP27K250                                                 
                       BP27K251                                                 
                       BM06K100                                                 
                       BM06K110                                                 
                       BM06K130                                                 
                       BM06K510                                                 
                OUTPUT BP13F40F.                                                
                                                                                
                                                                                
           IF WS-K40C-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K40C - ERROR OPENING : ' WS-K40C-STATUS              
              MOVE WS-K40C-STATUS                   TO RETURN-CODE              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K40I-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K40I - ERROR OPENING : ' WS-K40I-STATUS              
              MOVE WS-K40I-STATUS                   TO RETURN-CODE              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K410-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K410 - ERROR OPENING : ' WS-K410-STATUS              
              MOVE WS-K410-STATUS                   TO RETURN-CODE              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K640-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K640 - ERROR OPENING : ' WS-K640-STATUS              
              MOVE WS-K640-STATUS                   TO RETURN-CODE              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K800 - ERROR OPENING : ' WS-K800-STATUS              
              MOVE WS-K800-STATUS                   TO RETURN-CODE              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K820-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K820 - ERROR OPENING : ' WS-K820-STATUS              
              MOVE WS-K820-STATUS                   TO RETURN-CODE              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K893-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K893 - ERROR OPENING : ' WS-K893-STATUS              
              MOVE WS-K893-STATUS                   TO RETURN-CODE              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K895-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K895 - ERROR OPENING : ' WS-K895-STATUS              
              MOVE WS-K895-STATUS                   TO RETURN-CODE              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-BP27K800-STATUS NOT = 00 AND 97                                
              DISPLAY 'BP27K800 - ERROR OPENING : ' WS-BP27K800-STATUS          
              MOVE WS-BP27K800-STATUS               TO RETURN-CODE              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-BP27K250-STATUS NOT = 00 AND 97                                
              DISPLAY 'BP27K250 - ERROR OPENING : ' WS-BP27K250-STATUS          
              MOVE WS-BP27K250-STATUS               TO RETURN-CODE              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-BP27K251-STATUS NOT = 00 AND 97                                
              DISPLAY 'BP27K251 - ERROR OPENING : ' WS-BP27K251-STATUS          
              MOVE WS-BP27K251-STATUS               TO RETURN-CODE              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K100-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BM06K100 - ERROR OPENING : ' WS-K100-STATUS              
              MOVE WS-K100-STATUS                   TO RETURN-CODE              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K110-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BM06K110 - ERROR OPENING : ' WS-K110-STATUS              
              MOVE WS-K110-STATUS                   TO RETURN-CODE              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K130-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BM06K130 - ERROR OPENING : ' WS-K130-STATUS              
              MOVE WS-K130-STATUS                   TO RETURN-CODE              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
           IF WS-K510-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BM06K510 - ERROR OPENING : ' WS-K510-STATUS              
              MOVE WS-K510-STATUS                   TO RETURN-CODE              
              PERFORM  9999-CLOSE-ROUTINE  THRU 9999-EXIT                       
           END-IF.                                                              
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ******************************************************************        
       2000-READ-BP13F40I.                                                      
      ******************************************************************        
                                                                                
           READ BP13F40I           AT   END                                     
                MOVE 'Y'           TO   WS-EOF-F40I                             
                GO                 TO   2000-EXIT.                              
           ADD  1                  TO WS-F40I-READ.                             
                                                                                
           IF F40I-NUM-REGN  NOT = SPACES AND LOW-VALUES                        
              PERFORM 3000-READ-INPUT-FILES      THRU 3000-EXIT                 
           ELSE                                                                 
              CONTINUE                                                          
           END-IF.                                                              
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *************************************************************             
       3000-READ-INPUT-FILES.                                                   
      *************************************************************             
                                                                                
           PERFORM 3100-READ-BP13K800  THRU 3100-EXIT.                          
           PERFORM 3200-READ-BP13K640  THRU 3200-EXIT.                          
           PERFORM 3300-READ-BP13K410  THRU 3300-EXIT.                          
           PERFORM 3400-READ-BP13K40C  THRU 3400-EXIT.                          
           PERFORM 3450-READ-BP13K40I  THRU 3450-EXIT.                          
                                                                                
           IF WS-NUM-SCH-ACC   NOT = SPACES AND LOW-VALUES                      
              PERFORM 3500-READ-BM06K110  THRU 3500-EXIT                        
           ELSE                                                                 
              MOVE SPACES TO K110-REC                                           
              INITIALIZE     K110-REC                                           
           END-IF                                                               
                                                                                
           IF K110-REC NOT = SPACES AND LOW-VALUES                              
              PERFORM 3600-READ-BM06K100  THRU 3600-EXIT                        
              PERFORM 3700-READ-BM06K130  THRU 3700-EXIT                        
              PERFORM 3860-READ-BM06K510  THRU 3860-EXIT                        
           ELSE                                                                 
              MOVE SPACES TO K100-REC K130-REC K510-REC                         
              INITIALIZE     K100-REC K130-REC K510-REC                         
           END-IF                                                               
                                                                                
           IF WS-NUM-SCH-ACC   NOT = SPACES AND LOW-VALUES AND ZEROES           
               MOVE  SPACES                  TO  BP13COMM8-REC                  
               INITIALIZE                        BP13COMM8-REC                  
               MOVE  WS-NUM-SCH-ACC          TO  WS-LINK-REC                    
               PERFORM 3800-CALL-BP13C913  THRU 3800-EXIT                       
               IF COMM8-CDE-SYSERR = 0                                          
                  PERFORM 3850-MOVE-PIDB-DETLS THRU 3850-EXIT                   
               ELSE                                                             
                  MOVE SPACES             TO  WS-NUM-LEVEL                      
                                              WS-UNIT-MAIN                      
                                              WS-UNIT-SUB                       
                                              WS-NUM-BLK                        
                                              WS-HOUSE-NO                       
                                              WS-NME-STREET                     
               END-IF                                                           
           ELSE                                                                 
               MOVE SPACES                TO  WS-NUM-LEVEL                      
                                              WS-UNIT-MAIN                      
                                              WS-UNIT-SUB                       
                                              WS-NUM-BLK                        
                                              WS-HOUSE-NO                       
                                              WS-NME-STREET                     
           END-IF.                                                              
                                                                                
           PERFORM 3900-CALL-BP13CB4A  THRU 3900-EXIT.                          
                                                                                
           IF WS-NUM-HLA  NOT = SPACES AND  LOW-VALUES                          
              PERFORM 3950-READ-BP27K800  THRU 3950-EXIT                        
           ELSE                                                                 
              MOVE SPACES TO BP27K800-MASTER                                    
              INITIALIZE     BP27K800-MASTER                                    
           END-IF.                                                              
                                                                                
           PERFORM 4000-CHECK-VALID    THRU 4000-EXIT.                          
           PERFORM 4100-MOVE-FIELDS    THRU 4100-EXIT.                          
                                                                                
       3000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
       3100-READ-BP13K800.                                                      
      *************************************************************             
           MOVE SPACES                   TO WS-PRSN-DTLS                        
                                            WS-K800-K893-COMMON-FIELDS.         
           INITIALIZE                       WS-PRSN-DTLS                        
                                            WS-K800-K893-COMMON-FIELDS.         
                                                                                
           MOVE SPACES                   TO BP13K800-MASTER.                    
           INITIALIZE                       BP13K800-MASTER.                    
                                                                                
           MOVE F40I-NUM-REGN            TO K800-NUM-REGN.                      
                                                                                
           READ BP13K800.                                                       
                                                                                
           EVALUATE WS-K800-STATUS                                              
               WHEN 00                                                          
                  MOVE K800-NUM-NRIC1 OF BP13K800-MASTER  TO WS-NRIC(1)         
                  MOVE K800-NUM-NRIC2 OF BP13K800-MASTER  TO WS-NRIC(2)         
                  MOVE K800-NUM-NRIC3 OF BP13K800-MASTER  TO WS-NRIC(3)         
                  MOVE K800-NUM-NRIC4 OF BP13K800-MASTER  TO WS-NRIC(4)         
                  MOVE K800-NUM-HLA OF BP13K800-MASTER    TO WS-NUM-HLA         
                  MOVE K800-NUM-SCH-ACC      TO WS-NUM-SCH-ACC                  
                  MOVE K800-NUM-FLAT-TYPE    TO WS-NUM-FLAT-TYPE                
                  MOVE K800-DTE-BALLOT       TO WS-DTE-BALLOT                   
                  MOVE K800-NUM-HOUSEHOLD OF BP13K800-MASTER                    
                                             TO WS-NUM-HOUSEHOLD                
                  MOVE K800-NUM-LOAN-TAG  OF BP13K800-MASTER                    
                                             TO WS-NUM-LOAN-TAG                 
                  MOVE K800-DTE-1ST-LETTER   TO WS-DTE-1ST-LETTER               
                  MOVE K800-DTE-CANCEL    OF BP13K800-MASTER                    
                                             TO WS-DTE-CANCEL                   
                  MOVE K800-DTE-SALE-AGMT    TO WS-DTE-SALE-AGMT                
                  MOVE K800-DTE-2ND-CA-SENT  TO WS-DTE-2ND-CA                   
                                                                                
               WHEN 10                                                          
               WHEN 23                                                          
                    MOVE SPACES          TO BP13K800-MASTER                     
                    INITIALIZE              BP13K800-MASTER                     
                    DISPLAY 'REC NOT FOUND IN K800' F40I-NUM-REGN               
                    PERFORM 3160-START-BP13K893 THRU 3160-EXIT                  
                                                                                
               WHEN OTHER                                                       
                    DISPLAY 'BP13K800 READ ERROR ' WS-K800-STATUS               
                    MOVE WS-K800-STATUS          TO RETURN-CODE                 
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3100-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
       3150-READ-BP13K820.                                                      
      *************************************************************             
                                                                                
           IF  WS-NRIC-K820(WS-CNT) NOT = SPACES AND LOW-VALUES                 
               MOVE SPACES                   TO BP13K820-REC                    
               INITIALIZE                       BP13K820-REC                    
               MOVE K410-NUM-REGN            TO K820-NUM-REGN                   
               MOVE WS-NRIC-K820(WS-CNT)     TO K820-NUM-NRIC                   
            ELSE                                                                
               MOVE  ZEROES                  TO WS-INCOME-K820(WS-CNT)          
               GO TO 3150-EXIT                                                  
           END-IF.                                                              
                                                                                
           READ BP13K820 KEY IS K820-KEY-FLD.                                   
           EVALUATE WS-K820-STATUS                                              
             WHEN '00'                                                          
               IF K820-AMT-INCOME-TP IS NUMERIC                                 
                  MOVE K820-AMT-INCOME-TP TO WS-INCOME-K820(WS-CNT)             
               ELSE                                                             
                  MOVE  ZEROES          TO WS-INCOME-K820(WS-CNT)               
               END-IF                                                           
                                                                                
             WHEN 10                                                            
             WHEN 23                                                            
                  MOVE  ZEROES          TO WS-INCOME-K820(WS-CNT)               
                  MOVE SPACES           TO BP13K820-REC                         
                  INITIALIZE               BP13K820-REC                         
                  DISPLAY 'REC NOT FOUND IN K820' K820-KEY-FLD                  
                  PERFORM 3155-START-BP13K895  THRU 3155-EXIT                   
                                                                                
             WHEN OTHER                                                         
                  DISPLAY 'BP13K820 READ ERROR ' WS-K820-STATUS                 
                  MOVE WS-K820-STATUS          TO RETURN-CODE                   
                  PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       3150-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
       3155-START-BP13K895.                                                     
      *************************************************************             
                                                                                
           IF  WS-NRIC-K820(WS-CNT) NOT = SPACES AND LOW-VALUES                 
               MOVE SPACES                   TO BP13K895-REC                    
               INITIALIZE                       BP13K895-REC                    
               MOVE K410-NUM-REGN            TO K895-NUM-REGN-HIST              
               MOVE WS-NRIC-K820(WS-CNT)     TO K895-NUM-NRIC-HIST              
            ELSE                                                                
               MOVE  ZEROES                  TO WS-INCOME-K820(WS-CNT)          
               GO TO 3155-EXIT                                                  
           END-IF.                                                              
                                                                                
           START BP13K895 KEY >= K895-KEY-FLD                                   
           EVALUATE WS-K895-STATUS                                              
             WHEN '00'                                                          
                  MOVE 'N'  TO WS-EOF-K895                                      
                  PERFORM 3156-READ-NEXT-K895 THRU 3156-EXIT                    
                                     UNTIL WS-EOF-K895 = 'Y'                    
             WHEN 10                                                            
             WHEN 23                                                            
                  MOVE SPACES          TO BP13K895-REC                          
                  INITIALIZE              BP13K895-REC                          
                  MOVE ZEROES          TO WS-INCOME-K820(WS-CNT)                
                  DISPLAY 'REC NOT FOUND IN K895' F40I-NUM-REGN                 
                                                                                
             WHEN OTHER                                                         
                  DISPLAY 'BP13K895 READ ERROR ' WS-K895-STATUS                 
                  MOVE WS-K895-STATUS          TO RETURN-CODE                   
                  PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                     
           END-EVALUATE.                                                        
                                                                                
       3155-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
       3156-READ-NEXT-K895.                                                     
      *************************************************************             
            READ BP13K895 NEXT RECORD                                           
                 AT END MOVE 'Y'    TO WS-EOF-K895                              
                 NOT AT END                                                     
                                                                                
                 IF WS-K895-STATUS NOT = '00'                                   
                    MOVE SPACES               TO BP13K895-REC                   
                    MOVE WS-K895-STATUS       TO RETURN-CODE                    
                    DISPLAY 'READ ERROR IN K895 ' F40I-NUM-REGN                 
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
                 END-IF                                                         
                                                                                
                 IF K895-NUM-REGN-HIST = F40I-NUM-REGN  AND                     
                    K895-NUM-NRIC-HIST = WS-NRIC-K820(WS-CNT)                   
                   IF K895-AMT-INCOME-TP IS NUMERIC                             
                      MOVE K895-AMT-INCOME-TP TO WS-INCOME-K820(WS-CNT)         
                   ELSE                                                         
                      MOVE  ZEROES            TO WS-INCOME-K820(WS-CNT)         
                   END-IF                                                       
                   MOVE 'Y'                   TO WS-EOF-K895                    
                 ELSE                                                           
                   MOVE ZEROES                TO WS-INCOME-K820(WS-CNT)         
                   MOVE SPACES                TO BP13K895-REC                   
                   INITIALIZE                    BP13K895-REC                   
                   MOVE 'Y'                   TO WS-EOF-K895                    
                   DISPLAY 'REGN NOT FND IN K895 ' F40I-NUM-REGN                
                 END-IF                                                         
            END-READ.                                                           
                                                                                
       3156-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
       3160-START-BP13K893.                                                     
      *************************************************************             
           MOVE SPACES                   TO BP13K893-MASTER.                    
           INITIALIZE                       BP13K893-MASTER.                    
                                                                                
           MOVE F40I-NUM-REGN            TO K893-KEY-FLD.                       
                                                                                
           START BP13K893 KEY  >= K893-KEY-FLD                                  
                                                                                
           EVALUATE WS-K893-STATUS                                              
               WHEN 00                                                          
                    MOVE 'N'  TO WS-EOF-K893                                    
                    PERFORM 3170-READ-NEXT-K893 THRU 3170-EXIT                  
                                     UNTIL WS-EOF-K893 = 'Y'                    
               WHEN 10                                                          
               WHEN 23                                                          
                    MOVE SPACES          TO BP13K893-MASTER                     
                    INITIALIZE              BP13K893-MASTER                     
                    DISPLAY 'REC NOT FOUND IN K893' F40I-NUM-REGN               
                                                                                
               WHEN OTHER                                                       
                    DISPLAY 'BP13K893 READ ERROR ' WS-K893-STATUS               
                    MOVE WS-K893-STATUS          TO RETURN-CODE                 
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3160-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
       3170-READ-NEXT-K893.                                                     
      *************************************************************             
            READ BP13K893 NEXT RECORD                                           
                 AT END MOVE 'Y'    TO WS-EOF-K893                              
                 NOT AT END                                                     
                                                                                
                  IF WS-K893-STATUS NOT = '00'                                  
                     MOVE SPACES               TO BP13K893-MASTER               
                     MOVE WS-K893-STATUS       TO RETURN-CODE                   
                     DISPLAY 'READ ERROR IN K893 ' F40I-NUM-REGN                
                     PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                  
                  END-IF                                                        
                                                                                
                  IF K893-NUM-REGN-HIST = F40I-NUM-REGN                         
                     MOVE K893-NUM-NRIC1        TO WS-NRIC(1)                   
                     MOVE K893-NUM-NRIC2        TO WS-NRIC(2)                   
                     MOVE K893-NUM-NRIC3        TO WS-NRIC(3)                   
                     MOVE K893-NUM-NRIC4        TO WS-NRIC(4)                   
                     MOVE K893-NUM-SCH-ACC      TO WS-NUM-SCH-ACC               
                     MOVE K893-NUM-FLAT-TYPE    TO WS-NUM-FLAT-TYPE             
                     MOVE K893-DTE-BALLOT       TO WS-DTE-BALLOT                
                     MOVE K893-NUM-HOUSEHOLD    TO WS-NUM-HOUSEHOLD             
                     MOVE K893-NUM-LOAN-TAG     TO WS-NUM-LOAN-TAG              
                     MOVE K893-DTE-1ST-LETTER   TO WS-DTE-1ST-LETTER            
                     MOVE K893-DTE-CANCEL       TO WS-DTE-CANCEL                
                     MOVE K893-DTE-SALE-AGMT    TO WS-DTE-SALE-AGMT             
                     MOVE K893-NUM-HLA          TO WS-NUM-HLA                   
                     MOVE K893-DTE-2ND-CA-SENT  TO WS-DTE-2ND-CA                
                     MOVE 'Y'                   TO WS-EOF-K893                  
                  ELSE                                                          
                     MOVE SPACES                TO BP13K893-MASTER              
                     MOVE 'Y'                   TO WS-EOF-K893                  
                     DISPLAY 'REGN NOT FND IN K893 ' F40I-NUM-REGN              
                  END-IF                                                        
            END-READ.                                                           
                                                                                
       3170-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
       3200-READ-BP13K640.                                                      
      *************************************************************             
           MOVE SPACES                   TO BP13K640-TRANS-REC.                 
           INITIALIZE                       BP13K640-TRANS-REC.                 
                                                                                
           MOVE F40I-NUM-REGN            TO K640-KEY-FLD.                       
                                                                                
           READ BP13K640.                                                       
                                                                                
           EVALUATE WS-K640-STATUS                                              
               WHEN 00                                                          
                    CONTINUE                                                    
                                                                                
               WHEN 10                                                          
               WHEN 23                                                          
                    MOVE SPACES          TO BP13K640-TRANS-REC                  
                    INITIALIZE              BP13K640-TRANS-REC                  
                    DISPLAY 'REC NOT FOUND IN K640' F40I-NUM-REGN               
                                                                                
               WHEN OTHER                                                       
                    DISPLAY 'BP13K640 READ ERROR ' WS-K640-STATUS               
                    MOVE WS-K640-STATUS          TO RETURN-CODE                 
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3200-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
       3300-READ-BP13K410.                                                      
      *************************************************************             
           MOVE SPACES                   TO BP13K410-REC.                       
           INITIALIZE                       BP13K410-REC.                       
                                                                                
           MOVE F40I-NUM-REGN            TO K410-KEY-FLD.                       
                                                                                
           READ BP13K410.                                                       
                                                                                
           EVALUATE WS-K410-STATUS                                              
               WHEN 00                                                          
               PERFORM VARYING WS-CNT  FROM 1 BY 1 UNTIL WS-CNT > 4             
                  MOVE SPACES TO WS-NRIC-K820(WS-CNT)                           
                  MOVE ZEROES TO WS-INCOME-K820(WS-CNT)                         
               END-PERFORM                                                      
                                                                                
                IF K410-NRIC1 NOT = SPACES AND LOW-VALUES                       
                   MOVE K410-NRIC1 TO WS-NRIC-K820(1)                           
                END-IF                                                          
                                                                                
                IF K410-NRIC2 NOT = SPACES AND LOW-VALUES                       
                   MOVE K410-NRIC2 TO WS-NRIC-K820(2)                           
                END-IF                                                          
                                                                                
                IF K410-NRIC3 NOT = SPACES AND LOW-VALUES                       
                   MOVE K410-NRIC3 TO WS-NRIC-K820(3)                           
                END-IF                                                          
                                                                                
                IF K410-NRIC4 NOT = SPACES AND LOW-VALUES                       
                   MOVE K410-NRIC4 TO WS-NRIC-K820(4)                           
                END-IF                                                          
                                                                                
                PERFORM 3150-READ-BP13K820 THRU 3150-EXIT                       
                     VARYING WS-CNT FROM 1 BY 1  UNTIL WS-CNT > 4               
                                                                                
               WHEN 10                                                          
               WHEN 23                                                          
                   PERFORM VARYING WS-CNT  FROM 1 BY 1 UNTIL WS-CNT > 4         
                    MOVE SPACES TO WS-NRIC-K820(WS-CNT)                         
                    MOVE ZEROES TO WS-INCOME-K820(WS-CNT)                       
                   END-PERFORM                                                  
                    MOVE SPACES               TO BP13K410-REC                   
                    INITIALIZE                   BP13K410-REC                   
                    DISPLAY 'REC NOT FOUND IN K410' F40I-NUM-REGN               
                                                                                
               WHEN OTHER                                                       
                    DISPLAY 'BP13K410 READ ERROR ' WS-K410-STATUS               
                    MOVE WS-K410-STATUS          TO RETURN-CODE                 
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3300-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
       3400-READ-BP13K40C.                                                      
      *************************************************************             
           MOVE SPACES                   TO BP13K40C-REC.                       
           INITIALIZE                       BP13K40C-REC.                       
                                                                                
           MOVE F40I-NUM-REGN            TO K40C-KEY-FLD.                       
                                                                                
           READ BP13K40C.                                                       
                                                                                
           EVALUATE WS-K40C-STATUS                                              
               WHEN 00                                                          
                    CONTINUE                                                    
                                                                                
               WHEN 10                                                          
               WHEN 23                                                          
                    MOVE SPACES          TO BP13K40C-REC                        
                    INITIALIZE              BP13K40C-REC                        
                    DISPLAY 'REC NOT FOUND IN K40C' K40C-NUM-REGN               
                                                                                
               WHEN OTHER                                                       
                    DISPLAY 'BP13K40C READ ERROR ' WS-K40C-STATUS               
                    MOVE WS-K40C-STATUS          TO RETURN-CODE                 
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3400-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
       3450-READ-BP13K40I.                                                      
      *************************************************************             
           MOVE SPACES                   TO BP13K40I-REC.                       
           INITIALIZE                       BP13K40I-REC.                       
                                                                                
           MOVE F40I-NUM-REGN            TO K40I-KEY-FLD.                       
                                                                                
           READ BP13K40I.                                                       
                                                                                
           EVALUATE WS-K40I-STATUS                                              
               WHEN 00                                                          
                    CONTINUE                                                    
                                                                                
               WHEN 10                                                          
               WHEN 23                                                          
                    MOVE SPACES          TO BP13K40I-REC                        
                    INITIALIZE              BP13K40I-REC                        
                    DISPLAY 'REC NOT FOUND IN K40I' K40I-NUM-REGN               
                                                                                
               WHEN OTHER                                                       
                    DISPLAY 'BP13K40I READ ERROR ' WS-K40I-STATUS               
                    MOVE WS-K40I-STATUS          TO RETURN-CODE                 
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3450-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
       3500-READ-BM06K110.                                                      
      *************************************************************             
           MOVE SPACES                   TO K110-REC.                           
           INITIALIZE                       K110-REC.                           
                                                                                
           MOVE WS-NUM-SCH-ACC           TO K110-KEY-FLD.                       
                                                                                
           READ BM06K110.                                                       
                                                                                
           EVALUATE WS-K110-STATUS                                              
               WHEN 00                                                          
                    CONTINUE                                                    
                                                                                
               WHEN 10                                                          
               WHEN 23                                                          
                    MOVE SPACES          TO K110-REC                            
                    INITIALIZE              K110-REC                            
                    DISPLAY 'REC NOT FOUND IN K110' WS-NUM-SCH-ACC              
                                                                                
               WHEN OTHER                                                       
                    DISPLAY 'BM06K110 READ ERROR ' WS-K110-STATUS               
                    MOVE WS-K110-STATUS          TO RETURN-CODE                 
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3500-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
       3600-READ-BM06K100.                                                      
      *************************************************************             
           MOVE SPACES                   TO K100-REC.                           
           INITIALIZE                       K100-REC.                           
                                                                                
           MOVE K110-AIX1                TO K100-KEY-FLD.                       
                                                                                
           READ BM06K100.                                                       
                                                                                
           EVALUATE WS-K100-STATUS                                              
               WHEN 00                                                          
                    CONTINUE                                                    
                                                                                
               WHEN 10                                                          
               WHEN 23                                                          
                    MOVE SPACES          TO K100-REC                            
                    INITIALIZE              K100-REC                            
                    DISPLAY 'BM06K100 REC NOT FND' K110-AIX1                    
                                                                                
               WHEN OTHER                                                       
                    DISPLAY 'BM06K100 READ ERROR ' WS-K100-STATUS               
                    MOVE WS-K100-STATUS          TO RETURN-CODE                 
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3600-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
       3700-READ-BM06K130.                                                      
      *************************************************************             
           MOVE SPACES                   TO K130-REC.                           
           INITIALIZE                       K130-REC.                           
                                                                                
           MOVE K110-AIX1                TO K130-KEY-FLD.                       
                                                                                
           READ BM06K130.                                                       
                                                                                
           EVALUATE WS-K130-STATUS                                              
               WHEN 00                                                          
                    CONTINUE                                                    
                                                                                
               WHEN 10                                                          
               WHEN 23                                                          
                    MOVE SPACES          TO K130-REC                            
                    INITIALIZE              K130-REC                            
                    DISPLAY 'REC NOT FOUND IN K130' K110-KEY-FLD                
                                                                                
               WHEN OTHER                                                       
                    DISPLAY 'BM06K130 READ ERROR ' WS-K130-STATUS               
                    MOVE WS-K130-STATUS          TO RETURN-CODE                 
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3700-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       3800-CALL-BP13C913.                                                      
      ******************************************************************        
            CALL 'BP13C913' USING WS-LINK-REC,                                  
                                  BP13COMM8-REC.                                
       3800-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       3850-MOVE-PIDB-DETLS.                                                    
      ******************************************************************        
                                                                                
           MOVE SPACES                TO  WS-NUM-LEVEL                          
                                          WS-UNIT-MAIN                          
                                          WS-UNIT-SUB                           
                                          WS-NUM-BLK                            
                                          WS-HOUSE-NO                           
                                          WS-NME-STREET.                        
                                                                                
           MOVE COMM8-NUM-LEVEL       TO  WS-NUM-LEVEL.                         
           MOVE COMM8-NUM-UNIT-MAIN   TO  WS-UNIT-MAIN.                         
           MOVE COMM8-NUM-UNIT-SUB    TO  WS-UNIT-SUB.                          
           MOVE COMM8-NUM-BLK         TO  WS-NUM-BLK.                           
           MOVE COMM8-NME-STREET      TO  WS-NME-STREET.                        
           MOVE WS-NUM-HSEMAIN        TO  WS-HOUSE-NO.                          
                                                                                
       3850-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
       3860-READ-BM06K510.                                                      
      *************************************************************             
           MOVE SPACES                   TO K510-REC.                           
           INITIALIZE                       K510-REC.                           
                                                                                
           MOVE K110-ESTATE              TO K510-ESTCDE.                        
                                                                                
           READ BM06K510.                                                       
                                                                                
           EVALUATE WS-K510-STATUS                                              
               WHEN 00                                                          
                    CONTINUE                                                    
                                                                                
               WHEN 10                                                          
               WHEN 23                                                          
                    MOVE SPACES          TO K510-REC                            
                    INITIALIZE              K510-REC                            
                    DISPLAY 'REC NOT FOUND IN K510' K110-ESTATE                 
                                                                                
               WHEN OTHER                                                       
                    DISPLAY 'BM06K510 READ ERROR ' WS-K510-STATUS               
                    MOVE WS-K510-STATUS          TO RETURN-CODE                 
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3860-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       3900-CALL-BP13CB4A.                                                      
      ******************************************************************        
            MOVE SPACES           TO COM73-COMMAREA.                            
            INITIALIZE               COM73-COMMAREA.                            
            MOVE 'R'              TO COM73-NUM-CALL-ACTION.                     
            MOVE F40I-NUM-REGN    TO COM73-NUM-RGSTRN-INPUT.                    
            CALL 'BP13CB4A'    USING COM73-COMMAREA.                            
                                                                                
            IF COM73-CDE-ERROR = SPACES OR ZEROES                               
               NEXT SENTENCE                                                    
            ELSE                                                                
               MOVE SPACES                TO COM73-COMMAREA                     
               INITIALIZE                    COM73-COMMAREA                     
            END-IF.                                                             
                                                                                
            PERFORM VARYING WS-PRSN FROM 1 BY 1 UNTIL WS-PRSN > 4               
              IF WS-NRIC(WS-PRSN) = SPACES OR LOW-VALUES                        
                 MOVE SPACES TO WS-NRIC(WS-PRSN)                                
              END-IF                                                            
              MOVE ZEROES TO WS-AMT-AHG-GRANT(WS-PRSN)                          
                             WS-AMT-SHG-GRANT(WS-PRSN)                          
            END-PERFORM.                                                        
                                                                                
            MOVE ZEROES TO WS-AMT-GRANT-AHG-TOT WS-AMT-GRANT-SHG-TOT            
                                                                                
            PERFORM VARYING WS-A FROM 1 BY 1 UNTIL WS-A > 5                     
             PERFORM VARYING WS-P FROM 1 BY 1 UNTIL WS-P > 10                   
              IF (COM73-IDNTY-NO(WS-A WS-P) NOT = SPACES AND LOW-VALUES)        
                 MOVE 'N' TO  WS-STORED                                         
                 PERFORM VARYING WS-PRSN FROM 1 BY 1 UNTIL WS-PRSN > 4          
                                                OR WS-STORED = 'Y'              
                  IF WS-NRIC(WS-PRSN) = COM73-IDNTY-NO(WS-A WS-P)               
                     MOVE 'Y' TO WS-STORED                                      
                     IF COM73-NUM-GRANT-TYPE(WS-A) = 'AHG'                      
                        MOVE COM73-AMT-GRANT(WS-A WS-P)                         
                                      TO WS-AMT-AHG-GRANT(WS-PRSN)              
                     ELSE                                                       
                      IF COM73-NUM-GRANT-TYPE(WS-A) = 'SHG'                     
                        MOVE COM73-AMT-GRANT(WS-A WS-P)                         
                                      TO WS-AMT-SHG-GRANT(WS-PRSN)              
                      END-IF                                                    
                     END-IF                                                     
                  END-IF                                                        
                 END-PERFORM                                                    
              END-IF                                                            
             END-PERFORM                                                        
           END-PERFORM.                                                         
                                                                                
           COMPUTE  WS-AMT-GRANT-AHG-TOT = WS-AMT-AHG-GRANT(1) +                
                                           WS-AMT-AHG-GRANT(2) +                
                                           WS-AMT-AHG-GRANT(3) +                
                                           WS-AMT-AHG-GRANT(4).                 
                                                                                
           COMPUTE  WS-AMT-GRANT-SHG-TOT = WS-AMT-SHG-GRANT(1) +                
                                           WS-AMT-SHG-GRANT(2) +                
                                           WS-AMT-SHG-GRANT(3) +                
                                           WS-AMT-SHG-GRANT(4).                 
                                                                                
           MOVE WS-AMT-GRANT-AHG-TOT  TO  WS-AMT-GRANT-AHG-E.                   
           MOVE WS-AMT-GRANT-SHG-TOT  TO  WS-AMT-GRANT-SHG-E.                   
                                                                                
       3900-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
       3950-READ-BP27K800.                                                      
      *************************************************************             
           MOVE SPACES                   TO BP27K800-MASTER.                    
           INITIALIZE                       BP27K800-MASTER.                    
                                                                                
           MOVE WS-NUM-HLA TO K800-NUM-HLA OF BP27K800-MASTER.                  
                                                                                
           READ BP27K800.                                                       
                                                                                
           EVALUATE WS-BP27K800-STATUS                                          
               WHEN 00                                                          
                IF K800-NUM-CA-SECOND  NOT  = 'Y'                               
                                                                                
                  PERFORM 3960-READ-BP27K250 THRU 3960-EXIT                     
                                                                                
      ****  INCOME FOR 2ND CA IS ZEROES          **************                 
                                                                                
                    MOVE ZEROES      TO WS-AMT-HA1-2NDCA-INCOME                 
                                        WS-AMT-HA2-2NDCA-INCOME                 
                                        WS-AMT-HA3-2NDCA-INCOME                 
                                        WS-AMT-HA4-2NDCA-INCOME                 
                                                                                
      ****  INCOME FOR 1ST CA FROM HLACA FILE    **************                 
                                                                                
                  IF K250-AMT-HA1-CA-INCOME OF BP27K250-REC IS NUMERIC          
                     MOVE K250-AMT-HA1-CA-INCOME OF BP27K250-REC TO             
                                        WS-AMT-HA1-1STCA-INCOME                 
                  ELSE                                                          
                     MOVE ZEROES   TO WS-AMT-HA1-1STCA-INCOME                   
                  END-IF                                                        
                                                                                
                  IF K250-AMT-HA2-CA-INCOME OF BP27K250-REC IS NUMERIC          
                     MOVE K250-AMT-HA2-CA-INCOME OF BP27K250-REC TO             
                                        WS-AMT-HA2-1STCA-INCOME                 
                  ELSE                                                          
                     MOVE ZEROES  TO WS-AMT-HA2-1STCA-INCOME                    
                  END-IF                                                        
                                                                                
                  IF K250-AMT-HA3-CA-INCOME OF BP27K250-REC IS NUMERIC          
                     MOVE K250-AMT-HA3-CA-INCOME OF BP27K250-REC TO             
                                        WS-AMT-HA3-1STCA-INCOME                 
                  ELSE                                                          
                     MOVE ZEROES  TO WS-AMT-HA3-1STCA-INCOME                    
                  END-IF                                                        
                                                                                
                  IF K250-AMT-HA4-CA-INCOME OF BP27K250-REC IS NUMERIC          
                     MOVE K250-AMT-HA4-CA-INCOME OF BP27K250-REC TO             
                                       WS-AMT-HA4-1STCA-INCOME                  
                  ELSE                                                          
                     MOVE ZEROES  TO WS-AMT-HA4-1STCA-INCOME                    
                  END-IF                                                        
                                                                                
                ELSE                                                            
                  PERFORM 3960-READ-BP27K250 THRU 3960-EXIT                     
                  PERFORM 3970-READ-BP27K251 THRU 3970-EXIT                     
                                                                                
      ****  INCOME FOR 2ND CA FROM HLACA FILE     ******************            
                                                                                
                  IF K250-AMT-HA1-CA-INCOME OF BP27K250-REC IS NUMERIC          
                     MOVE K250-AMT-HA1-CA-INCOME OF BP27K250-REC TO             
                                        WS-AMT-HA1-2NDCA-INCOME                 
                  ELSE                                                          
                     MOVE ZEROES  TO WS-AMT-HA1-2NDCA-INCOME                    
                  END-IF                                                        
                                                                                
                  IF K250-AMT-HA2-CA-INCOME OF BP27K250-REC IS NUMERIC          
                     MOVE K250-AMT-HA2-CA-INCOME OF BP27K250-REC TO             
                                        WS-AMT-HA2-2NDCA-INCOME                 
                  ELSE                                                          
                     MOVE ZEROES  TO WS-AMT-HA2-2NDCA-INCOME                    
                  END-IF                                                        
                                                                                
                  IF K250-AMT-HA3-CA-INCOME OF BP27K250-REC IS NUMERIC          
                     MOVE K250-AMT-HA3-CA-INCOME OF BP27K250-REC TO             
                                        WS-AMT-HA3-2NDCA-INCOME                 
                  ELSE                                                          
                     MOVE ZEROES  TO WS-AMT-HA3-2NDCA-INCOME                    
                  END-IF                                                        
                                                                                
                  IF K250-AMT-HA4-CA-INCOME OF BP27K250-REC IS NUMERIC          
                     MOVE K250-AMT-HA4-CA-INCOME OF BP27K250-REC TO             
                                        WS-AMT-HA4-2NDCA-INCOME                 
                  ELSE                                                          
                     MOVE ZEROES  TO WS-AMT-HA4-2NDCA-INCOME                    
                  END-IF                                                        
                                                                                
      ****  INCOME FOR 1ST CA FROM HLACA.CA2ND  FILE ***************            
                                                                                
                  IF K250-AMT-HA1-CA-INCOME OF BP27K251-REC IS NUMERIC          
                     MOVE K250-AMT-HA1-CA-INCOME OF BP27K251-REC TO             
                                        WS-AMT-HA1-1STCA-INCOME                 
                  ELSE                                                          
                     MOVE ZEROES   TO WS-AMT-HA1-1STCA-INCOME                   
                  END-IF                                                        
                                                                                
                  IF K250-AMT-HA2-CA-INCOME OF BP27K251-REC IS NUMERIC          
                     MOVE K250-AMT-HA2-CA-INCOME OF BP27K251-REC TO             
                                        WS-AMT-HA2-1STCA-INCOME                 
                  ELSE                                                          
                     MOVE ZEROES  TO WS-AMT-HA2-1STCA-INCOME                    
                  END-IF                                                        
                                                                                
                  IF K250-AMT-HA3-CA-INCOME OF BP27K251-REC IS NUMERIC          
                     MOVE K250-AMT-HA3-CA-INCOME OF BP27K251-REC TO             
                                        WS-AMT-HA3-1STCA-INCOME                 
                  ELSE                                                          
                     MOVE ZEROES  TO WS-AMT-HA3-1STCA-INCOME                    
                  END-IF                                                        
                                                                                
                  IF K250-AMT-HA4-CA-INCOME OF BP27K251-REC IS NUMERIC          
                     MOVE K250-AMT-HA4-CA-INCOME OF BP27K251-REC TO             
                                       WS-AMT-HA4-1STCA-INCOME                  
                  ELSE                                                          
                     MOVE ZEROES  TO WS-AMT-HA4-1STCA-INCOME                    
                  END-IF                                                        
                                                                                
                  IF K800-NUM-CA-SECOND = 'Y'                                   
                     MOVE K800-NUM-RISK   TO WS-NUM-2ND-CA-RISK                 
                  ELSE                                                          
                     MOVE SPACES          TO WS-NUM-2ND-CA-RISK                 
                  END-IF                                                        
                                                                                
                END-IF                                                          
                                                                                
               WHEN 10                                                          
               WHEN 23                                                          
                    MOVE SPACES          TO BP27K800-MASTER                     
                    INITIALIZE              BP27K800-MASTER                     
                    MOVE ZEROES          TO WS-AMT-HA1-1STCA-INCOME             
                                            WS-AMT-HA2-1STCA-INCOME             
                                            WS-AMT-HA3-1STCA-INCOME             
                                            WS-AMT-HA4-1STCA-INCOME             
                                            WS-AMT-HA1-2NDCA-INCOME             
                                            WS-AMT-HA2-2NDCA-INCOME             
                                            WS-AMT-HA3-2NDCA-INCOME             
                                            WS-AMT-HA4-2NDCA-INCOME             
                                            WS-NUM-2ND-CA-RISK                  
                    DISPLAY 'REC NOT FOUND IN BP27K800' F40I-NUM-REGN           
                                                                                
               WHEN OTHER                                                       
                    DISPLAY 'BP27K800 READ ERROR ' WS-BP27K800-STATUS           
                    MOVE WS-BP27K800-STATUS          TO RETURN-CODE             
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3950-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
       3960-READ-BP27K250.                                                      
      *************************************************************             
           MOVE SPACES                   TO BP27K250-REC.                       
           INITIALIZE                       BP27K250-REC,                       
                                                                                
           MOVE K800-NUM-HLA OF BP27K800-MASTER TO                              
                K250-NUM-HLA OF BP27K250-REC.                                   
                                                                                
           READ BP27K250.                                                       
                                                                                
           EVALUATE WS-BP27K250-STATUS                                          
               WHEN 00                                                          
                    CONTINUE                                                    
               WHEN 10                                                          
               WHEN 23                                                          
                    MOVE SPACES          TO BP27K250-REC                        
                    INITIALIZE              BP27K250-REC                        
                    DISPLAY 'REC NOT FOUND IN BP27K250'                         
                               WS-NUM-HLA                                       
               WHEN OTHER                                                       
                    DISPLAY 'BP27K250 READ ERROR ' WS-BP27K250-STATUS           
                    MOVE WS-BP27K250-STATUS          TO RETURN-CODE             
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3960-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *************************************************************             
       3970-READ-BP27K251.                                                      
      *************************************************************             
           MOVE SPACES                   TO BP27K251-REC.                       
           INITIALIZE                       BP27K251-REC,                       
                                                                                
           MOVE K800-NUM-HLA OF BP27K800-MASTER TO                              
                K250-NUM-HLA OF BP27K251-REC.                                   
                                                                                
           READ BP27K251.                                                       
                                                                                
           EVALUATE WS-BP27K251-STATUS                                          
               WHEN 00                                                          
                    CONTINUE                                                    
               WHEN 10                                                          
               WHEN 23                                                          
                    MOVE SPACES          TO BP27K251-REC                        
                    INITIALIZE              BP27K251-REC                        
                    DISPLAY 'REC NOT FOUND IN BP27K251:NUM-CA-SECOND-Y'         
                               WS-NUM-HLA                                       
               WHEN OTHER                                                       
                    DISPLAY 'BP27K251 READ ERROR ' WS-BP27K251-STATUS           
                    MOVE WS-BP27K251-STATUS          TO RETURN-CODE             
                    PERFORM 9999-CLOSE-ROUTINE THRU 9999-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3970-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       4000-CHECK-VALID.                                                        
      ******************************************************************        
           IF K640-AMT-REPAY-PERIOD  NOT NUMERIC                                
              MOVE ZEROS   TO K640-AMT-REPAY-PERIOD.                            
                                                                                
           IF K640-AMT-MAX-LOAN      NOT NUMERIC                                
              MOVE ZEROS   TO K640-AMT-MAX-LOAN.                                
                                                                                
           IF K640-AMT-CA-LOAN       NOT NUMERIC                                
              MOVE ZEROS   TO K640-AMT-CA-LOAN.                                 
                                                                                
           IF K410-NUM-LOAN-REPYMT-MAX NOT NUMERIC                              
              MOVE ZEROS   TO K410-NUM-LOAN-REPYMT-MAX.                         
                                                                                
           IF K410-NUM-REPAY-PERIOD    NOT NUMERIC                              
              MOVE ZEROS   TO K410-NUM-REPAY-PERIOD.                            
                                                                                
           IF K410-AMT-LOAN          NOT NUMERIC                                
              MOVE ZEROS   TO K410-AMT-LOAN.                                    
                                                                                
           IF K410-AMT-ICP-CASH      NOT NUMERIC                                
              MOVE ZEROS   TO K410-AMT-ICP-CASH.                                
                                                                                
           IF K410-AMT-ICP-CPF1      NOT NUMERIC                                
              MOVE ZEROS   TO K410-AMT-ICP-CPF1.                                
                                                                                
           IF K410-AMT-ICP-CPF2      NOT NUMERIC                                
              MOVE ZEROS   TO K410-AMT-ICP-CPF2.                                
                                                                                
           IF K410-AMT-ICP-CPF3      NOT NUMERIC                                
              MOVE ZEROS   TO K410-AMT-ICP-CPF3                                 
                                                                                
           IF K410-AMT-ICP-CPF4        NOT NUMERIC                              
              MOVE ZEROS   TO K410-AMT-ICP-CPF4.                                
                                                                                
           IF K410-AMT-MTHLY-CPF1    NOT NUMERIC                                
              MOVE ZEROS   TO K410-AMT-MTHLY-CPF1.                              
                                                                                
           IF K410-AMT-MTHLY-CPF2    NOT NUMERIC                                
              MOVE ZEROS   TO K410-AMT-MTHLY-CPF2.                              
                                                                                
           IF K410-AMT-MTHLY-CPF3    NOT NUMERIC                                
              MOVE ZEROS   TO K410-AMT-MTHLY-CPF3.                              
                                                                                
           IF K410-AMT-MTHLY-CPF4    NOT NUMERIC                                
              MOVE ZEROS   TO K410-AMT-MTHLY-CPF4.                              
                                                                                
           IF K410-AMT-CPF1-BALANCE  NOT NUMERIC                                
              MOVE ZEROS   TO K410-AMT-CPF1-BALANCE.                            
                                                                                
           IF K410-AMT-CPF2-BALANCE  NOT NUMERIC                                
              MOVE ZEROS   TO K410-AMT-CPF2-BALANCE.                            
                                                                                
           IF K410-AMT-CPF3-BALANCE  NOT NUMERIC                                
              MOVE ZEROS   TO K410-AMT-CPF3-BALANCE.                            
                                                                                
           IF K410-AMT-CPF4-BALANCE  NOT NUMERIC                                
              MOVE ZEROS   TO K410-AMT-CPF4-BALANCE.                            
                                                                                
           IF K40C-AMT-CPF1-RESERVE    NOT NUMERIC                              
              MOVE ZEROS   TO K40C-AMT-CPF1-RESERVE.                            
                                                                                
           IF K40C-AMT-CPF2-RESERVE  NOT NUMERIC                                
              MOVE ZEROS   TO K40C-AMT-CPF2-RESERVE.                            
                                                                                
           IF K40C-AMT-CPF3-RESERVE  NOT NUMERIC                                
              MOVE ZEROS   TO K40C-AMT-CPF3-RESERVE.                            
                                                                                
           IF K40C-AMT-CPF4-RESERVE  NOT NUMERIC                                
              MOVE ZEROS   TO K40C-AMT-CPF4-RESERVE.                            
                                                                                
           IF K40I-AMT-CASH-TOP-UP   NOT NUMERIC                                
              MOVE ZEROS   TO K40I-AMT-CASH-TOP-UP.                             
                                                                                
           IF K110-CURR-SELLING-PRICE NOT NUMERIC                               
              MOVE ZEROS   TO K110-CURR-SELLING-PRICE.                          
                                                                                
           IF K100-DTE-PACD   = LOW-VALUES OR SPACES                            
              MOVE SPACES  TO K100-DTE-PACD.                                    
                                                                                
           IF K110-ESTATE = LOW-VALUES OR SPACES                                
              MOVE SPACES  TO K110-ESTATE.                                      
                                                                                
           IF K110-NEIGHBOURHOOD = LOW-VALUES OR SPACES                         
              MOVE SPACES  TO K110-NEIGHBOURHOOD.                               
                                                                                
           IF K110-DTE-ACCEPTANCE = LOW-VALUES OR SPACES                        
              MOVE SPACES  TO K110-DTE-ACCEPTANCE.                              
                                                                                
           IF K110-CONTRACT-NO = LOW-VALUES OR SPACES                           
              MOVE SPACES  TO K110-CONTRACT-NO.                                 
                                                                                
           IF K130-NME-LOCAL-PRCNCT = LOW-VALUES OR SPACES                      
              MOVE SPACES  TO K130-NME-LOCAL-PRCNCT.                            
                                                                                
           IF K510-NT-NAME = LOW-VALUES OR SPACES                               
              MOVE SPACES  TO K510-NT-NAME.                                     
                                                                                
           IF K410-DOB1   = LOW-VALUES OR SPACES                                
              MOVE SPACES  TO K410-DOB1.                                        
                                                                                
           IF K410-DOB2   = LOW-VALUES OR SPACES                                
              MOVE SPACES  TO K410-DOB2.                                        
                                                                                
           IF K410-DOB3   = LOW-VALUES OR SPACES                                
              MOVE SPACES  TO K410-DOB3.                                        
                                                                                
           IF K410-DOB4   = LOW-VALUES OR SPACES                                
              MOVE SPACES  TO K410-DOB4.                                        
                                                                                
           IF K40I-DTE-LETTER-PRINT = LOW-VALUES OR SPACES                      
              MOVE SPACES  TO K40I-DTE-LETTER-PRINT.                            
                                                                                
           IF K800-AMT-1ST-CA-INC OF BP27K800-MASTER NOT NUMERIC                
              MOVE ZEROES  TO K800-AMT-1ST-CA-INC                               
                                             OF BP27K800-MASTER.                
                                                                                
           IF K800-AMT-CA-INCOME  OF BP27K800-MASTER NOT NUMERIC                
              MOVE ZEROES  TO K800-AMT-CA-INCOME                                
                                             OF BP27K800-MASTER.                
                                                                                
       4000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       4100-MOVE-FIELDS.                                                        
      ******************************************************************        
           MOVE SPACES                  TO BP13F40F-REC.                        
           INITIALIZE                      BP13F40F-REC.                        
           MOVE ZEROES                  TO WS-EDIT-AMT.                         
                                                                                
           IF WS-HEADER-REC = 'Y'                                               
              WRITE BP13F40F-REC FROM WS-HEADER                                 
              MOVE 'N' TO WS-HEADER-REC                                         
           END-IF.                                                              
                                                                                
           MOVE F40I-NUM-REGN           TO F40F-NUM-REGN.                       
           MOVE F40I-NUM-CONTROL        TO F40F-TREAT2.                         
           MOVE F40I-NUM-LETTER-TAG     TO F40F-GROUP.                          
                                                                                
           MOVE K40I-AMT-CASH-TOP-UP    TO WS-AMT-EDIT7.                        
           MOVE WS-AMT-EDIT7            TO F40F-CASH-TOP-UP-KC.                 
                                                                                
           MOVE K40I-DTE-LETTER-PRINT   TO F40F-KC-LETTER-SEND-DTE.             
                                                                                
           MOVE WS-NUM-SCH-ACC          TO F40F-SCH-ACC-NUM.                    
           MOVE WS-NUM-FLAT-TYPE        TO F40F-FLAT-TYPE.                      
           MOVE WS-DTE-BALLOT           TO F40F-SALES-LAUNCH.                   
           MOVE WS-NUM-HOUSEHOLD        TO F40F-HOUSEHOLD-TYPE.                 
           MOVE WS-NUM-LOAN-TAG         TO F40F-LOAN-TYPE.                      
           MOVE WS-DTE-SALE-AGMT        TO F40F-DATE-SIGN-AGRMT.                
           MOVE WS-NUM-SCH-ACC          TO F40F-HDBREF.                         
           MOVE WS-DTE-CANCEL           TO F40F-DTE-CANCELLATION.               
                                                                                
           MOVE K100-DTE-PACD           TO F40F-PCD.                            
                                                                                
           MOVE K110-NEIGHBOURHOOD      TO F40F-NH.                             
           MOVE K110-CONTRACT-NO        TO F40F-CT.                             
           MOVE K110-DTE-ACCEPTANCE     TO F40F-DTE-BOOKING.                    
           MOVE K110-CURR-SELLING-PRICE TO WS-AMT-EDIT8.                        
           MOVE WS-AMT-EDIT8            TO F40F-FLAT-PRICE.                     
           MOVE K110-DTE-KEY-ISSUED     TO F40F-DTE-KEY-COLL.                   
                                                                                
           MOVE K130-NME-LOCAL-PRCNCT   TO F40F-PROJECT-NAME.                   
                                                                                
           MOVE K510-NT-NAME            TO F40F-ESTATE.                         
                                                                                
           MOVE K640-AMT-REPAY-PERIOD   TO F40F-LOAN-TEN-ELIG.                  
           IF K640-AMT-MAX-LOAN  <  K640-AMT-CA-LOAN                            
              MOVE K640-AMT-MAX-LOAN    TO WS-AMT-EDIT7                         
              MOVE WS-AMT-EDIT7         TO F40F-HDB-LOAN-AMT-ELIG               
           ELSE                                                                 
              MOVE K640-AMT-CA-LOAN     TO WS-AMT-EDIT7                         
              MOVE WS-AMT-EDIT7         TO F40F-HDB-LOAN-AMT-ELIG.              
                                                                                
      *    MOVE K410-NUM-LOAN-REPYMT-MAX TO F40F-LOAN-TEN-ACTUAL.               
           MOVE K410-NUM-REPAY-PERIOD    TO F40F-LOAN-TEN-ACTUAL.               
                                                                                
           MOVE K410-AMT-LOAN           TO WS-AMT-EDIT7.                        
           MOVE WS-AMT-EDIT7            TO F40F-LOAN-AMT-ACTUAL.                
                                                                                
           MOVE K410-AMT-ICP-CASH       TO WS-AMT-EDIT7.                        
           MOVE WS-AMT-EDIT7            TO F40F-ICP-CASH.                       
                                                                                
           MOVE K410-AMT-ICP-CPF1       TO WS-AMT-EDIT7.                        
           MOVE WS-AMT-EDIT7            TO F40F-AMT-ICP-CPF1.                   
                                                                                
           MOVE K410-AMT-ICP-CPF2       TO WS-AMT-EDIT7.                        
           MOVE WS-AMT-EDIT7            TO F40F-AMT-ICP-CPF2.                   
                                                                                
           MOVE K410-AMT-ICP-CPF3       TO WS-AMT-EDIT7.                        
           MOVE WS-AMT-EDIT7            TO F40F-AMT-ICP-CPF3.                   
                                                                                
           MOVE K410-AMT-ICP-CPF4       TO WS-AMT-EDIT7.                        
           MOVE WS-AMT-EDIT7            TO F40F-AMT-ICP-CPF4.                   
                                                                                
           MOVE K410-AMT-MTHLY-CASH     TO WS-AMT-EDIT5.                        
           MOVE WS-AMT-EDIT5            TO F40F-AMT-INST-CASH.                  
                                                                                
           MOVE K410-AMT-MTHLY-CPF1     TO WS-AMT-EDIT5.                        
           MOVE WS-AMT-EDIT5            TO F40F-AMT-INST-CPF1.                  
                                                                                
           MOVE K410-AMT-MTHLY-CPF2     TO WS-AMT-EDIT5.                        
           MOVE WS-AMT-EDIT5            TO F40F-AMT-INST-CPF2.                  
                                                                                
           MOVE K410-AMT-MTHLY-CPF3     TO WS-AMT-EDIT5.                        
           MOVE WS-AMT-EDIT5            TO F40F-AMT-INST-CPF3.                  
                                                                                
           MOVE K410-AMT-MTHLY-CPF4     TO WS-AMT-EDIT5.                        
           MOVE WS-AMT-EDIT5            TO F40F-AMT-INST-CPF4.                  
                                                                                
           MOVE K410-DOB1               TO F40F-DOB-LESSE1.                     
           MOVE K410-DOB2               TO F40F-DOB-LESSE2.                     
           MOVE K410-DOB3               TO F40F-DOB-LESSE3.                     
           MOVE K410-DOB4               TO F40F-DOB-LESSE4.                     
                                                                                
           MOVE K410-AMT-CPF1-BALANCE   TO WS-AMT-EDIT7.                        
           MOVE WS-AMT-EDIT7            TO F40F-OA-BAL-BEF-PUR-LSSE1.           
                                                                                
           MOVE K410-AMT-CPF2-BALANCE   TO WS-AMT-EDIT7.                        
           MOVE WS-AMT-EDIT7            TO F40F-OA-BAL-BEF-PUR-LSSE2.           
                                                                                
           MOVE K410-AMT-CPF3-BALANCE   TO WS-AMT-EDIT7.                        
           MOVE WS-AMT-EDIT7            TO F40F-OA-BAL-BEF-PUR-LSSE3.           
                                                                                
           MOVE K410-AMT-CPF4-BALANCE   TO WS-AMT-EDIT7.                        
           MOVE WS-AMT-EDIT7            TO F40F-OA-BAL-BEF-PUR-LSSE4.           
                                                                                
           MOVE K40C-AMT-CPF1-RESERVE   TO WS-AMT-EDIT8.                        
           MOVE WS-AMT-EDIT8            TO F40F-OA-RETENTION-LSSE1.             
                                                                                
           MOVE K40C-AMT-CPF2-RESERVE   TO WS-AMT-EDIT8.                        
           MOVE WS-AMT-EDIT8            TO F40F-OA-RETENTION-LSSE2.             
                                                                                
           MOVE K40C-AMT-CPF3-RESERVE   TO WS-AMT-EDIT8.                        
           MOVE WS-AMT-EDIT8            TO F40F-OA-RETENTION-LSSE3.             
                                                                                
           MOVE K40C-AMT-CPF4-RESERVE   TO WS-AMT-EDIT8.                        
           MOVE WS-AMT-EDIT8            TO F40F-OA-RETENTION-LSSE4.             
                                                                                
           MOVE WS-NUM-BLK              TO F40F-BLK-NO.                         
           MOVE WS-HOUSE-NO             TO F40F-HOUSE-NO.                       
           MOVE WS-NME-STREET           TO F40F-NME-STREET.                     
                                                                                
           MOVE WS-AMT-GRANT-AHG-E      TO F40F-AHG-AMOUNT.                     
           MOVE WS-AMT-GRANT-SHG-E      TO F40F-SHG-AMOUNT.                     
                                                                                
           MOVE WS-INCOME-K820(1)       TO WS-AMT-EDIT.                         
           MOVE WS-AMT-EDIT             TO F40F-DECLARED-INCOME-LSSE1.          
                                                                                
           MOVE WS-INCOME-K820(2)       TO WS-AMT-EDIT.                         
           MOVE WS-AMT-EDIT             TO F40F-DECLARED-INCOME-LSSE2.          
                                                                                
           MOVE WS-INCOME-K820(3)       TO WS-AMT-EDIT.                         
           MOVE WS-AMT-EDIT             TO F40F-DECLARED-INCOME-LSSE3.          
                                                                                
           MOVE WS-INCOME-K820(4)       TO WS-AMT-EDIT.                         
           MOVE WS-AMT-EDIT             TO F40F-DECLARED-INCOME-LSSE4.          
                                                                                
           MOVE WS-AMT-HA1-1STCA-INCOME TO WS-AMT-EDIT.                         
           MOVE WS-AMT-EDIT          TO F40F-INCOME-1STCA-LSSE1.                
                                                                                
           MOVE WS-AMT-HA2-1STCA-INCOME TO WS-AMT-EDIT.                         
           MOVE WS-AMT-EDIT          TO F40F-INCOME-1STCA-LSSE2.                
                                                                                
           MOVE WS-AMT-HA3-1STCA-INCOME TO WS-AMT-EDIT.                         
           MOVE WS-AMT-EDIT          TO F40F-INCOME-1STCA-LSSE3.                
                                                                                
           MOVE WS-AMT-HA4-1STCA-INCOME TO WS-AMT-EDIT.                         
           MOVE WS-AMT-EDIT          TO F40F-INCOME-1STCA-LSSE4.                
                                                                                
           MOVE WS-AMT-HA1-2NDCA-INCOME TO WS-AMT-EDIT.                         
           MOVE WS-AMT-EDIT          TO F40F-INCOME-2NDCA-LSSE1.                
                                                                                
           MOVE WS-AMT-HA2-2NDCA-INCOME TO WS-AMT-EDIT.                         
           MOVE WS-AMT-EDIT          TO F40F-INCOME-2NDCA-LSSE2.                
                                                                                
           MOVE WS-AMT-HA3-2NDCA-INCOME TO WS-AMT-EDIT.                         
           MOVE WS-AMT-EDIT          TO F40F-INCOME-2NDCA-LSSE3.                
                                                                                
           MOVE WS-AMT-HA4-2NDCA-INCOME TO WS-AMT-EDIT.                         
           MOVE WS-AMT-EDIT          TO F40F-INCOME-2NDCA-LSSE4.                
                                                                                
           MOVE WS-NUM-HLA           TO F40F-NUM-HLA.                           
           MOVE WS-DTE-2ND-CA        TO F40F-DTE-2ND-CA.                        
           MOVE WS-NUM-2ND-CA-RISK   TO F40F-NUM-2ND-CA-RISK.                   
                                                                                
           MOVE  ';' TO FILLER-1  FILLER-2  FILLER-3 FILLER-4  FILLER-5         
                        FILLER-6  FILLER-7  FILLER-8 FILLER-9  FILLER-10        
                        FILLER-11 FILLER-12 FILLER-13 FILLER-14                 
                        FILLER-15 FILLER-16 FILLER-17 FILLER-18                 
                        FILLER-19 FILLER-20 FILLER-21 FILLER-22                 
                        FILLER-23 FILLER-24 FILLER-25 FILLER-26                 
                        FILLER-27 FILLER-28 FILLER-29 FILLER-30                 
                        FILLER-31 FILLER-32 FILLER-33 FILLER-34                 
                        FILLER-35 FILLER-36 FILLER-37 FILLER-38                 
                        FILLER-39 FILLER-40 FILLER-41 FILLER-42                 
                        FILLER-43 FILLER-44 FILLER-45 FILLER-46                 
                        FILLER-47 FILLER-48 FILLER-49 FILLER-50                 
                        FILLER-51 FILLER-52 FILLER-53 FILLER-54                 
                        FILLER-55 FILLER-56 FILLER-57 FILLER-58                 
                        FILLER-59 FILLER-60 FILLER-61 FILLER-62                 
                        FILLER-63 FILLER-64 FILLER-65 FILLER-66                 
                        FILLER-67.                                              
                                                                                
           WRITE BP13F40F-REC.                                                  
           ADD 1 TO WS-CNT-F40F-WRITE.                                          
                                                                                
           PERFORM 4200-INITIALIZE-FIELDS THRU 4200-EXIT.                       
                                                                                
       4100-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       4200-INITIALIZE-FIELDS.                                                  
      ******************************************************************        
           MOVE SPACES                TO  WS-NUM-LEVEL                          
                                          WS-UNIT-MAIN                          
                                          WS-UNIT-SUB                           
                                          WS-NUM-BLK                            
                                          WS-HOUSE-NO                           
                                          WS-NME-STREET.                        
                                                                                
           MOVE SPACES                TO  WS-PRSN-DTLS                          
                                          WS-K800-K893-COMMON-FIELDS.           
                                                                                
           INITIALIZE                     WS-PRSN-DTLS                          
                                          WS-K800-K893-COMMON-FIELDS.           
                                                                                
           MOVE ZEROES                TO  WS-AMT-HA1-1STCA-INCOME               
                                          WS-AMT-HA2-1STCA-INCOME               
                                          WS-AMT-HA3-1STCA-INCOME               
                                          WS-AMT-HA4-1STCA-INCOME               
                                          WS-AMT-HA1-2NDCA-INCOME               
                                          WS-AMT-HA2-2NDCA-INCOME               
                                          WS-AMT-HA3-2NDCA-INCOME               
                                          WS-AMT-HA4-2NDCA-INCOME.              
                                                                                
       4200-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ******************************************************************        
       9999-CLOSE-ROUTINE.                                                      
      ******************************************************************        
                                                                                
           DISPLAY '*************** CONTROL    TOTALS ***************'.         
           DISPLAY 'PROGRAM-ID : BP13C40W'.                                     
           DISPLAY '-------------------------------------------------'.         
           DISPLAY '(1) NO OF BP13F40I RECORDS READ............. : '            
                    WS-F40I-READ.                                               
           DISPLAY '(2) NO OF BP13F40F RECORDS WRITTEN INTO .... : '            
                    WS-CNT-F40F-WRITE.                                          
                                                                                
           CLOSE    BP13F40I                                                    
                    BP13K40C                                                    
                    BP13K40I                                                    
                    BP13K410                                                    
                    BP13K640                                                    
                    BP13K800                                                    
                    BP13K820                                                    
                    BP13K893                                                    
                    BP13K895                                                    
                    BP27K800                                                    
                    BP27K250                                                    
                    BP27K251                                                    
                    BM06K100                                                    
                    BM06K110                                                    
                    BM06K130                                                    
                    BM06K510                                                    
                    BP13F40F.                                                   
                                                                                
           IF WS-K40C-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K40C - ERROR CLOSING : ' WS-K40C-STATUS              
              MOVE WS-K40C-STATUS                   TO RETURN-CODE              
           END-IF.                                                              
                                                                                
           IF WS-K40I-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K40I - ERROR CLOSING : ' WS-K40I-STATUS              
              MOVE WS-K40I-STATUS                   TO RETURN-CODE              
           END-IF.                                                              
                                                                                
           IF WS-K410-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K410 - ERROR CLOSING : ' WS-K410-STATUS              
              MOVE WS-K410-STATUS                   TO RETURN-CODE              
           END-IF.                                                              
                                                                                
           IF WS-K640-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K640 - ERROR CLOSING : ' WS-K640-STATUS              
              MOVE WS-K640-STATUS                   TO RETURN-CODE              
           END-IF.                                                              
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K800 - ERROR CLOSING : ' WS-K800-STATUS              
              MOVE WS-K800-STATUS                   TO RETURN-CODE              
           END-IF.                                                              
                                                                                
           IF WS-K820-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K820 - ERROR CLOSING : ' WS-K820-STATUS              
              MOVE WS-K820-STATUS                   TO RETURN-CODE              
           END-IF.                                                              
                                                                                
           IF WS-K893-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K893 - ERROR CLOSING : ' WS-K893-STATUS              
              MOVE WS-K893-STATUS                   TO RETURN-CODE              
           END-IF.                                                              
                                                                                
           IF WS-K895-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K895 - ERROR CLOSING : ' WS-K895-STATUS              
              MOVE WS-K895-STATUS                   TO RETURN-CODE              
           END-IF.                                                              
                                                                                
           IF WS-BP27K800-STATUS NOT = 00 AND 97                                
              DISPLAY 'BP27K800 - ERROR CLOSING : ' WS-BP27K800-STATUS          
              MOVE WS-BP27K800-STATUS                   TO RETURN-CODE          
           END-IF.                                                              
                                                                                
           IF WS-BP27K250-STATUS NOT = 00 AND 97                                
              DISPLAY 'BP27K250 - ERROR CLOSING : ' WS-BP27K250-STATUS          
              MOVE WS-BP27K250-STATUS                   TO RETURN-CODE          
           END-IF.                                                              
                                                                                
           IF WS-BP27K251-STATUS NOT = 00 AND 97                                
              DISPLAY 'BP27K251 - ERROR CLOSING : ' WS-BP27K251-STATUS          
              MOVE WS-BP27K251-STATUS                   TO RETURN-CODE          
           END-IF.                                                              
                                                                                
           IF WS-K100-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BM06K100 - ERROR CLOSING : ' WS-K100-STATUS              
              MOVE WS-K100-STATUS                   TO RETURN-CODE              
           END-IF.                                                              
                                                                                
           IF WS-K110-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BM06K110 - ERROR CLOSING : ' WS-K110-STATUS              
              MOVE WS-K110-STATUS                   TO RETURN-CODE              
           END-IF.                                                              
                                                                                
           IF WS-K130-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BM06K130 - ERROR CLOSING : ' WS-K130-STATUS              
              MOVE WS-K130-STATUS                   TO RETURN-CODE              
           END-IF.                                                              
                                                                                
           IF WS-K510-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BM06K510 - ERROR CLOSING : ' WS-K510-STATUS              
              MOVE WS-K510-STATUS                   TO RETURN-CODE              
           END-IF.                                                              
                                                                                
           STOP RUN.                                                            
                                                                                
       9999-EXIT.                                                               
           EXIT.                                                                
