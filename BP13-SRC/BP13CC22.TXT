       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CC22.                                                 
       AUTHOR. BALA AMUTHAN.                                                    
       DATE-WRITTEN.  17/05/06.                                                 
                                                                                
      **********************************************************                
      *                                                        *                
      *    SYSTEM NAME : SYSTEM OF COMMITMENT                  *                
      *                                                        *                
      *    SYSTEM ID : BP13                                    *                
      *                                                        *                
      *    OBJECTIVE  :                                        *                
      *        1.  THIS PROGRAMME WILL GIVE THE REPORT FOR     *                
      *            MONTHLY BALANCING STATEMENT.                *                
      *                                                        *                
      *     INPUT FILES:                                       *                
      *           1. BP13F136                                  *                
      *           2. BP13KD69                                  *                
      *           3. SY02F001                                  *                
      *                                                        *                
      *     PRINTING:                                          *                
      *           1. BP13LC22                                  *                
      *                                                        *                
      * BP132857 BA2 170506 - NEW PROGRAM                      *                
      * BP132845 BA3 020806 - REMOVE SUB-TOTAL                 *                
      * BP132914 BA3 180906 - ADD SY02F001 INPUT FILE.         *                
      *              260906 - REMOVE NO. OF RECORDS FOR CLOSING*                
      *                       BALANCE.                         *                
      *              080207 - INCLUDE INTEREST REBATE          *                
      * BP133052 BA3 120607 - INCLUDED 'ADJUSTMENTS' FOR JVL   *                
      *                         AND JVP.                       *                
      * BP133175 ED1 110108 - RETRIEVE PREV YEAR HEADER FROM   *                
      *                       F001-DTE-LAST-DAY-PREV(1:4)      *                
      * BP133115 ED1 180308 - CATER FOR CONCESS & NON-CONCESS  *                
      *                       CASES                            *                
      * BP133314 ED1 060508 - ADD 'LS ' FOR 'INS' CONDITIONS   *                
      * BP133535 EA1 220109 - ADDED 'TRANSFER TO SMS LOAN'     *                
      * BP133588 LSB 060509 - TO CATER FOR 'JV-I'              *                
      * BP134033 JB8 261010 - TO PRINT SUMMARY AT THE END OF   *                
      *                       NON-CON LOAN REPORT              *                
      * BP134707 IMC 070313 - ADD NEW REPORT FOR TRANSACTION   *                
      *                       BALANCE CHECKING                 *                
      * BP137132 KR13 300718- ADDED PAGE BREAK FOR REPORTS     *                
      **********************************************************                
                                                                                
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13KD69  ASSIGN TO BP13KD69                                  
                  ORGANIZATION     IS INDEXED                                   
                  RECORD KEY       IS KD69-NUM-TRANS                            
                  FILE STATUS      IS KD69-STATUS                               
                  ACCESS           IS RANDOM.                                   
                                                                                
           SELECT BP13KD60 ASSIGN TO BP13KD60                                   
                ORGANIZATION IS INDEXED                                         
                ACCESS MODE  IS RANDOM                                          
                RECORD KEY   IS KD60-KEY-FLD                                    
                FILE STATUS  IS KD60-STATUS.                                    
                                                                                
           SELECT BP13F136 ASSIGN TO BP13F136.                                  
                                                                                
           SELECT SY02F001 ASSIGN TO SY02F001.                                  
                                                                                
           SELECT BP13LC22 ASSIGN TO BP13LC22.                                  
           SELECT BP13LC2A ASSIGN TO BP13LC2A.                                  
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  BP13KD69                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 150 CHARACTERS                                       
           LABEL RECORDS ARE STANDARD.                                          
       COPY BP13KD69.                                                           
                                                                                
       FD  BP13F136                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 150 CHARACTERS                                       
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F.                                                 
       COPY BP13F136.                                                           
                                                                                
       COPY SY02F001.                                                           
                                                                                
       FD   BP13KD60    RECORD CONTAINS 250 CHARACTERS.                         
       COPY BP13KD60.                                                           
                                                                                
       FD  BP13LC22                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F.                                                 
       01  PRINT-REPORT-LIST              PIC X(132).                           
                                                                                
       FD  BP13LC2A                                                             
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           LABEL RECORDS ARE OMITTED                                            
           RECORDING MODE IS F.                                                 
       01  PRINT-REPORT-LIST-A            PIC X(132).                           
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-STATUS.                                                           
           05 KD69-STATUS                 PIC 99      VALUE ZEROS.              
           05 KD60-STATUS                 PIC 99      VALUE ZEROS.              
                                                                                
       01  WS-SWITCHES.                                                         
           05  WS-F136-EOF                PIC X       VALUE 'N'.                
           05  WS-VALID                   PIC X       VALUE 'N'.                
                                                                                
       01  WS-CNT-BP13F136                PIC 9(5)    VALUE ZEROES.             
       01  WS-LINE-A                      PIC 9(2)    VALUE ZEROES.             
       01  WS-PAGE                        PIC 9(2)    VALUE 01.                 
       01  WS-PREV-REGN                   PIC X(8)    VALUE SPACES.             
       01  WS-CNT-DIFF                    PIC 9(6)    VALUE ZEROES.             
       01  WS-KD60-NOTFND                 PIC 9(6)    VALUE ZEROES.             
       01  WS-DISPLAY-1                   PIC -ZZZ,ZZZ.ZZ.                      
       01  WS-DISPLAY-2                   PIC -ZZZ,ZZZ.ZZ.                      
                                                                                
       01  WS-CURRENT-DATE.                                                     
           05 WS-CCYY                     PIC 9999.                             
           05 WS-MM                       PIC 99.                               
           05 WS-DD                       PIC 99.                               
                                                                                
       01  WS-STORAGE.                                                          
           02  WS-F136-DIFF               PIC S9(6)V99 VALUE  ZEROES.           
           02  WS-KD60-DIFF               PIC S9(6)V99 VALUE  ZEROES.           
           02  WS-TAB-CASH-2              PIC 9(9)V99 VALUE  ZEROES.            
           02  WS-TAB-CPF-2               PIC 9(9)V99 VALUE  ZEROES.            
           02  WS-TAB-ADJ-2               PIC 9(9)V99 VALUE  ZEROES.            
           02  WS-TAB-MTH-2               PIC 9(9)V99 VALUE  ZEROES.            
           02  WS-TAB-GIRO-2              PIC 9(9)V99 VALUE  ZEROES.            
           02  WS-TAB-NEW-LOAN-2          PIC 9(9)V99 VALUE  ZEROES.            
           02  WS-TAB-INT-LOAN-2          PIC 9(9)V99 VALUE  ZEROES.            
           02  WS-TAB-REB-LOAN-2          PIC 9(9)V99 VALUE  ZEROES.            
           02  WS-TAB-SMS-LOAN-2          PIC 9(9)V99 VALUE  ZEROES.            
           02  WS-TAB-2ND-LOAN-2          PIC 9(9)V99 VALUE  ZEROES.            
                                                                                
      ***************************************************************           
      *    WS-TABLE.                                                *           
      ***************************************************************           
       01  WS-TAB.                                                              
           02  FILLER                     PIC X(02)    VALUE '11'.              
           02  WS-TAB-CASH                PIC S9(9)V99 VALUE  ZEROES.           
           02  WS-TAB-CASH-CASE           PIC 9(5)     VALUE  ZEROES.           
           02  FILLER                     PIC X(02)    VALUE '12'.              
           02  WS-TAB-CPF                 PIC S9(9)V99 VALUE  ZEROES.           
           02  WS-TAB-CPF-CASE            PIC 9(5)     VALUE  ZEROES.           
           02  FILLER                     PIC X(02)    VALUE '14'.              
                                                                                
           02  WS-TAB-ADJ                 PIC S9(9)V99 VALUE  ZEROES.           
           02  WS-TAB-ADJ-CASE            PIC 9(5)     VALUE  ZEROES.           
           02  FILLER                     PIC X(02)    VALUE '62'.              
           02  WS-TAB-MTH                 PIC S9(9)V99 VALUE  ZEROES.           
           02  WS-TAB-MTH-CASE            PIC 9(5)     VALUE  ZEROES.           
           02  FILLER                     PIC X(02)    VALUE '64'.              
           02  WS-TAB-GIRO                PIC S9(9)V99 VALUE  ZEROES.           
           02  WS-TAB-GIRO-CASE           PIC 9(5)     VALUE  ZEROES.           
           02  FILLER                     PIC X(02)    VALUE '66'.              
           02  WS-TAB-NEW-LOAN            PIC S9(9)V99 VALUE  ZEROES.           
           02  WS-TAB-NEW-LOAN-CASE       PIC 9(5)     VALUE  ZEROES.           
           02  FILLER                     PIC X(02)    VALUE '67'.              
           02  WS-TAB-INT-LOAN            PIC S9(9)V99 VALUE  ZEROES.           
           02  WS-TAB-INT-LOAN-CASE       PIC 9(5)     VALUE  ZEROES.           
           02  FILLER                     PIC X(02)    VALUE '68'.              
           02  WS-TAB-REB-LOAN            PIC S9(9)V99 VALUE  ZEROES.           
           02  WS-TAB-REB-LOAN-CASE       PIC 9(5)     VALUE  ZEROES.           
           02  FILLER                     PIC X(02)    VALUE '70'.              
           02  WS-TAB-SMS-LOAN            PIC S9(9)V99 VALUE  ZEROES.           
           02  WS-TAB-SMS-LOAN-CASE       PIC 9(5)     VALUE  ZEROES.           
           02  FILLER                     PIC X(02)    VALUE '73'.              
           02  WS-TAB-2ND-LOAN            PIC S9(9)V99 VALUE  ZEROES.           
           02  WS-TAB-2ND-LOAN-CASE       PIC 9(5)     VALUE  ZEROES.           
                                                                                
       01  WS-RPT-TAB REDEFINES WS-TAB.                                         
           05  WS-RPT-DETAIL OCCURS 11 TIMES INDEXED BY WS-IND.                 
               10  WS-RPT-TRANS-TYP       PIC X(2).                             
               10  WS-RPT-AMT             PIC S9(9)V99.                         
               10  WS-RPT-CASE            PIC 9(5).                             
                                                                                
       01  WS-TEMP-VALUE.                                                       
           05  WS-TEMP-RPT-AMT           PIC S9(9)V99.                          
           05  WS-TEMP-RPT-CASE          PIC 9(5).                              
           05  WS-TEMP-TRAN-TYP          PIC X(3).                              
                                                                                
       01  WS-TOTAL.                                                            
           05  WS-CLOSING-TOT      PIC S9(10)V99 VALUE ZEROES.                  
           05  WS-SUB-TOT          PIC S9(10)V99 VALUE ZEROES.                  
           05  WS-TOT-CASE         PIC 9(5)      VALUE ZEROES.                  
           05  WS-MAIN-CASE        PIC 9(5)      VALUE ZEROES.                  
           05  WS-CLOSING-CASE     PIC 9(5)      VALUE ZEROES.                  
           05  WS-CLOSING-BAL      PIC S9(10)V99 VALUE ZEROES.                  
                                                                                
       01  WS-INT-AMT.                                                          
           05 WS-INT-AMT-CHAR        PIC  S9(7)V99.                             
           05 WS-INT-AMT1   REDEFINES  WS-INT-AMT-CHAR.                         
              10 WS-INT-CHAR-AMT        PIC X(2).                               
              10 WS-INT-AMT-NUM         PIC S9(5)V99.                           
                                                                                
       01  WS-REB-AMT.                                                          
           05 WS-REB-AMT-CHAR        PIC  S9(7)V99.                             
           05 WS-REB-AMT1   REDEFINES  WS-REB-AMT-CHAR.                         
              10 WS-REB-CHAR-AMT        PIC X(2).                               
              10 WS-REB-AMT-NUM         PIC S9(5)V99.                           
      ***************************************************************           
      *    WS-REPORT VARIBLE                                        *           
      ***************************************************************           
                                                                                
       01  WS-PRINT-MAIN-HD.                                                    
           05  FILLER              PIC X(08)  VALUE 'BP13LC22'.                 
           05  FILLER              PIC X(04)  VALUE SPACES.                     
           05  FILLER              PIC X(07)  VALUE 'HDBCAT3'.                  
           05  FILLER              PIC X(25)  VALUE SPACES.                     
           05  FILLER              PIC X(20) VALUE                              
                                       'S Y S T E M   O F   '.                  
           05  FILLER              PIC X(19) VALUE                              
                                       'C O M M I T M E N T'.                   
           05  FILLER              PIC X(15)  VALUE SPACES.                     
           05  FILLER              PIC X(07)  VALUE 'DATE : '.                  
           05  RPT-HEAD-DATE       PIC X(10)  VALUE SPACES.                     
           05  FILLER              PIC X(04)  VALUE SPACES.                     
           05  FILLER              PIC X(07)  VALUE 'PAGE : '.                  
           05  RPT-HEAD-PAGE       PIC Z(03)9 VALUE SPACES.                     
                                                                                
       01  WS-PRINT-REPORT-HD.                                                  
           05  FILLER              PIC X(30)         VALUE SPACES.              
           05  FILLER              PIC X(32)         VALUE                      
               'MONTHLY BALANCING STATEMENT FOR '.                              
           05  RPT-HD-DATE         PIC X(08)         VALUE SPACES.              
           05  RPT-TITLE           PIC X(25)         VALUE SPACES.              
                                                                                
       01  WS-PRINT-REPORT-RW1.                                                 
           05  FILLER              PIC X(10)  VALUE SPACES.                     
           05  FILLER              PIC X(11)  VALUE 'OPENING BAL'.              
           05  FILLER              PIC X(50)  VALUE SPACES.                     
           05  WS-RPT-BAL          PIC ZZZ,ZZZ,ZZ9.99                           
                                              VALUE ZEROES.                     
           05  WS-RPT-BAL-SG       PIC X(01)  VALUE SPACES.                     
           05  FILLER              PIC X(09)  VALUE SPACES.                     
           05  WS-RPT-OPEN-CASE    PIC Z(04)9 VALUE ZEROES.                     
           05  FILLER              PIC X(34)  VALUE SPACES.                     
                                                                                
       01  WS-PRINT-REPORT-RW2.                                                 
           05  FILLER              PIC X(10)  VALUE SPACES.                     
           05  FILLER              PIC X(27)  VALUE                             
                  'NEW/ADDITION LOAN DISBURSED'.                                
           05  WS-RPT-NLD          PIC ZZZ,ZZZ,ZZ9.99                           
                                              VALUE ZEROES.                     
           05  WS-RPT-NLD-SG       PIC X(01)  VALUE SPACES.                     
           05  FILLER              PIC X(07)  VALUE SPACES.                     
           05  WS-RPT-NLD-CASE     PIC Z(04)9       VALUE ZEROES.               
           05  FILLER              PIC X(07)  VALUE SPACES.                     
           05  WS-RPT-NLD2         PIC ZZZ,ZZZ,ZZ9.99                           
                                              VALUE ZEROES.                     
           05  FILLER              PIC X(10)  VALUE SPACES.                     
           05  WS-RPT-NLD-SUB-CASE PIC Z(04)9.                                  
           05  FILLER              PIC X(34)  VALUE SPACES.                     
                                                                                
       01  WS-PRINT-REPORT-SUB.                                                 
           05  FILLER              PIC X(10)  VALUE SPACES.                     
           05  FILLER              PIC X(09)  VALUE 'SUB-TOTAL'.                
           05  FILLER              PIC X(52)  VALUE SPACES.                     
           05  WS-RPT-SUB-AMT      PIC ZZZ,ZZZ,ZZ9.99                           
                                              VALUE ZEROES.                     
           05  WS-RPT-SUB-AMT-SG   PIC X(01)  VALUE SPACES.                     
           05  FILLER              PIC X(09)  VALUE SPACES.                     
           05  WS-RPT-SUB-CASE     PIC Z(04)9.                                  
           05  FILLER              PIC X(35)  VALUE SPACES.                     
                                                                                
       01  WS-PRINT-REPORT-RW3.                                                 
           05  FILLER              PIC X(10)  VALUE SPACES.                     
           05  FILLER              PIC X(17)  VALUE                             
                'INT. ON NEW LOANS'.                                            
           05  FILLER              PIC X(10)  VALUE SPACES.                     
           05  WS-RPT-NL           PIC ZZZ,ZZZ,ZZ9.99                           
                                              VALUE ZEROES.                     
           05  WS-RPT-NL-SG        PIC X(1)   VALUE SPACES.                     
           05  FILLER              PIC X(07)  VALUE SPACES.                     
           05  WS-RPT-NL-CASE      PIC Z(04)9.                                  
           05  FILLER              PIC X(70)  VALUE SPACES.                     
                                                                                
       01  WS-PRINT-REPORT-RW4.                                                 
           05  FILLER              PIC X(10)  VALUE SPACES.                     
           05  FILLER              PIC X(12)  VALUE                             
                'INT. MONTHLY'.                                                 
           05  FILLER              PIC X(15)  VALUE SPACES.                     
           05  WS-RPT-INT-MTH      PIC ZZZ,ZZZ,ZZ9.99                           
                                              VALUE ZEROES.                     
           05  WS-RPT-INT-MTH-SG   PIC X(1)   VALUE SPACES.                     
           05  FILLER              PIC X(07)  VALUE SPACES.                     
           05  WS-RPTMTH-CASE      PIC Z(04)9.                                  
           05  FILLER              PIC X(70)  VALUE SPACES.                     
                                                                                
       01  WS-PRINT-REPORT-RW5.                                                 
           05  FILLER              PIC X(10)  VALUE SPACES.                     
           05  FILLER              PIC X(12)  VALUE                             
                'INT. REBATE '.                                                 
           05  FILLER              PIC X(15)  VALUE SPACES.                     
           05  WS-RPT-REB-MTH      PIC ZZZ,ZZZ,ZZ9.99                           
                                              VALUE ZEROES.                     
           05  WS-RPT-REB-REBT-SG  PIC X(1)   VALUE SPACES.                     
           05  FILLER              PIC X(07)  VALUE SPACES.                     
           05  WS-RPTREBT-CASE     PIC Z(04)9.                                  
           05  FILLER              PIC X(70)  VALUE SPACES.                     
                                                                                
       01  WS-PRINT-REPORT-RW6.                                                 
           05  FILLER              PIC X(10)  VALUE SPACES.                     
           05  FILLER              PIC X(12)  VALUE                             
                'CPF         '.                                                 
           05  FILLER              PIC X(15)  VALUE SPACES.                     
           05  WS-RPT-CPF          PIC ZZZ,ZZZ,ZZ9.99                           
                                              VALUE ZEROES.                     
           05  WS-RPT-CPF-SG       PIC X(1)   VALUE SPACES.                     
           05  FILLER              PIC X(07)  VALUE SPACES.                     
           05  WS-RPTCPF-CASE      PIC Z(04)9.                                  
           05  FILLER              PIC X(70)  VALUE SPACES.                     
                                                                                
       01  WS-PRINT-REPORT-RW7.                                                 
           05  FILLER              PIC X(10)  VALUE SPACES.                     
           05  FILLER              PIC X(12)  VALUE                             
                'CASH        '.                                                 
           05  FILLER              PIC X(15)  VALUE SPACES.                     
           05  WS-RPT-CASH         PIC ZZZ,ZZZ,ZZ9.99                           
                                              VALUE ZEROES.                     
           05  WS-RPT-CASH-SG      PIC X(1)   VALUE SPACES.                     
           05  FILLER              PIC X(07)  VALUE SPACES.                     
           05  WS-RPTCASH-CASE     PIC Z(04)9.                                  
           05  FILLER              PIC X(70)  VALUE SPACES.                     
                                                                                
       01  WS-PRINT-REPORT-RW8.                                                 
           05  FILLER              PIC X(10)  VALUE SPACES.                     
           05  FILLER              PIC X(12)  VALUE                             
                'GIRO        '.                                                 
           05  FILLER              PIC X(15)  VALUE SPACES.                     
           05  WS-RPT-GIRO         PIC ZZZ,ZZZ,ZZ9.99                           
                                              VALUE ZEROES.                     
           05  WS-RPT-GIRO-SG      PIC X(1)   VALUE SPACES.                     
           05  FILLER              PIC X(07)  VALUE SPACES.                     
           05  WS-RPTGIRO-CASE     PIC Z(04)9.                                  
           05  FILLER              PIC X(70)  VALUE SPACES.                     
                                                                                
       01  WS-PRINT-REPORT-RW9.                                                 
           05  FILLER              PIC X(10)  VALUE SPACES.                     
           05  FILLER              PIC X(12)  VALUE                             
                'AXS / SAM   '.                                                 
           05  FILLER              PIC X(15)  VALUE SPACES.                     
      *    05  WS-RPT-AXS          PIC Z(8)9.99.                                
           05  WS-RPT-AXS          PIC X(10).                                   
           05  WS-RPT-AXS-SG       PIC X(1)   VALUE SPACES.                     
           05  FILLER              PIC X(07)  VALUE SPACES.                     
      *    05  WS-RPTAXS-CASE      PIC Z(04)9.                                  
           05  WS-RPTAXS-CASE      PIC X(05)  VALUE SPACES.                     
           05  FILLER              PIC X(70)  VALUE SPACES.                     
                                                                                
       01  WS-PRINT-REPORT-RW10.                                                
           05  FILLER              PIC X(10)  VALUE SPACES.                     
           05  FILLER              PIC X(12)  VALUE                             
                'ADJUSTMENTS '.                                                 
           05  FILLER              PIC X(15)  VALUE SPACES.                     
           05  WS-RPT-ADJ          PIC ZZZ,ZZZ,ZZ9.99                           
                                              VALUE ZEROES.                     
           05  WS-RPT-ADJ-SG       PIC X(1)   VALUE SPACES.                     
           05  FILLER              PIC X(07)  VALUE SPACES.                     
           05  WS-RPTADJ-CASE      PIC Z(04)9.                                  
           05  FILLER              PIC X(70)  VALUE SPACES.                     
                                                                                
       01  WS-PRINT-REPORT-RW11.                                                
           05  FILLER              PIC X(10)  VALUE SPACES.                     
           05  FILLER              PIC X(12)  VALUE                             
                'CLOSING BAL '.                                                 
           05  FILLER              PIC X(49)  VALUE SPACES.                     
           05  WS-RPT-CLS-BAL      PIC ZZZ,ZZZ,ZZ9.99                           
                                              VALUE ZEROES.                     
           05  WS-RPT-CLS-BAL-SG   PIC X(1)   VALUE SPACES.                     
           05  FILLER              PIC X(09)  VALUE SPACES.                     
           05  WS-RPTCLS-CASE      PIC Z(04)9.                                  
           05  FILLER              PIC X(40)  VALUE SPACES.                     
                                                                                
       01  WS-PRINT-REPORT-RW12.                                                
           05  FILLER              PIC X(10)  VALUE SPACES.                     
           05  FILLER              PIC X(21)  VALUE                             
                'TRANSFER TO SMS LOAN '.                                        
           05  FILLER              PIC X(6)   VALUE SPACES.                     
           05  WS-RPT-SMS-BAL      PIC ZZZ,ZZZ,ZZ9.99                           
                                              VALUE ZEROES.                     
           05  WS-RPT-SMS-BAL-SG   PIC X(01)  VALUE SPACES.                     
           05  FILLER              PIC X(07)  VALUE SPACES.                     
           05  WS-RPT-SMS-CASE     PIC Z(04)9 VALUE ZEROES.                     
           05  FILLER              PIC X(07)  VALUE SPACES.                     
           05  WS-RPT-SMS2-BAL     PIC ZZZ,ZZZ,ZZ9.99                           
                                              VALUE ZEROES.                     
           05  WS-RPT-SMS2-BAL-SG  PIC X(01)  VALUE SPACES.                     
           05  FILLER              PIC X(09)  VALUE SPACES.                     
           05  WS-RPT-SMS2-CASE    PIC Z(04)9 VALUE ZEROES.                     
           05  FILLER              PIC X(32)  VALUE SPACES.                     
                                                                                
       01  WS-PRINT-REPORT-RW13.                                                
           05  FILLER              PIC X(10)  VALUE SPACES.                     
           05  FILLER              PIC X(26)  VALUE                             
                'CONVERSION TO 2ND CON LOAN'.                                   
           05  FILLER              PIC X(1)   VALUE SPACES.                     
           05  WS-RPT-2ND-BAL      PIC ZZZ,ZZZ,ZZ9.99                           
                                              VALUE ZEROES.                     
           05  WS-RPT-2ND-BAL-SG   PIC X(01)  VALUE SPACES.                     
           05  FILLER              PIC X(07)  VALUE SPACES.                     
           05  WS-RPT-2ND-CASE     PIC Z(04)9 VALUE ZEROES.                     
           05  FILLER              PIC X(07)  VALUE SPACES.                     
           05  WS-RPT-2ND2-BAL     PIC ZZZ,ZZZ,ZZ9.99                           
                                              VALUE ZEROES.                     
           05  WS-RPT-2ND2-BAL-SG  PIC X(01)  VALUE SPACES.                     
           05  FILLER              PIC X(09)  VALUE SPACES.                     
           05  WS-RPT-2ND2-CASE    PIC Z(04)9 VALUE ZEROES.                     
           05  FILLER              PIC X(32)  VALUE SPACES.                     
                                                                                
       01  WS-PRINT-LINE-RW11.                                                  
           05  FILLER              PIC X(72)  VALUE SPACES.                     
           05  FILLER              PIC X(13)  VALUE ALL '-'.                    
           05  FILLER              PIC X(09)  VALUE SPACES.                     
      *    05  FILLER              PIC X(05)  VALUE ALL '-'.                    
           05  FILLER              PIC X(39)  VALUE SPACES.                     
                                                                                
       01  WS-PRINT-REPORT-CL1.                                                 
           05  FILLER              PIC X(41)  VALUE SPACES.                     
           05  FILLER              PIC X(10)  VALUE 'AMOUNT ($)'.               
           05  FILLER              PIC X(05)  VALUE SPACES.                     
           05  FILLER              PIC X(14)  VALUE 'NO. OF RECORDS'.           
           05  FILLER              PIC X(05)  VALUE SPACES.                     
           05  FILLER              PIC X(10)  VALUE 'AMOUNT ($)'.               
           05  FILLER              PIC X(05)  VALUE SPACES.                     
           05  FILLER              PIC X(14)  VALUE 'NO. OF RECORDS'.           
           05  FILLER              PIC X(28)  VALUE SPACES.                     
                                                                                
       01  WS-PRINT-REPORT-LINE.                                                
           05  FILLER              PIC X(41)  VALUE SPACES.                     
           05  FILLER              PIC X(10)  VALUE ALL '-'.                    
           05  FILLER              PIC X(05)  VALUE SPACES.                     
           05  FILLER              PIC X(14)  VALUE ALL '-'.                    
           05  FILLER              PIC X(05)  VALUE SPACES.                     
           05  FILLER              PIC X(10)  VALUE ALL '-'.                    
           05  FILLER              PIC X(05)  VALUE SPACES.                     
           05  FILLER              PIC X(14)  VALUE ALL '-'.                    
           05  FILLER              PIC X(28)  VALUE SPACES.                     
                                                                                
                                                                                
       01  WS-PRINT-REPORT-EMPTY.                                               
           05  FILLER              PIC X(50) VALUE                              
               ' ******  NO RECORD ***** '.                                     
                                                                                
       01  WS-RPT-SPACE.                                                        
           05  FILLER              PIC X(132) VALUE SPACES.                     
                                                                                
       01  WS-PRINT-NONCON         PIC X      VALUE 'N'.                        
                                                                                
       01  WS-PRINT-SUMMARY-TITLE.                                              
           05  FILLER              PIC X(10)  VALUE SPACES.                     
           05  FILLER              PIC X(13)  VALUE                             
                'S U M M A R Y'.                                                
           05  FILLER              PIC X(48)  VALUE SPACES.                     
           05  FILLER              PIC X(31)  VALUE                             
                'NO. OF RECORDS   LOAN AMOUNT($)'.                              
                                                                                
       01  WS-PRINT-SUMMARY-DASH.                                               
           05  FILLER              PIC X(71)  VALUE SPACES.                     
           05  FILLER              PIC X(31)  VALUE                             
                '--------------   --------------'.                              
                                                                                
       01  WS-PRINT-SUMMARY-CON-LOAN.                                           
           05  FILLER                 PIC X(10)          VALUE SPACES.          
           05  FILLER                 PIC X(31)          VALUE                  
                'TOTAL NO. OF CONCESSIONARY LOAN'.                              
           05  FILLER                 PIC X(34)          VALUE SPACES.          
           05  WS-RPTCLS-CON-CASE     PIC ZZ,ZZZ,ZZ9     VALUE ZEROES.          
           05  FILLER                 PIC X(03)          VALUE SPACES.          
           05  WS-RPT-CLS-CON-BAL     PIC ZZZ,ZZZ,ZZ9.99 VALUE ZEROES.          
           05  WS-RPT-CLS-CON-BAL-SG  PIC X(1)           VALUE SPACES.          
                                                                                
       01  WS-PRINT-SUMMARY-NCON-LOAN.                                          
           05  FILLER                 PIC X(10)          VALUE SPACES.          
           05  FILLER                 PIC X(35)          VALUE                  
                'TOTAL NO. OF NON-CONCESSIONARY LOAN'.                          
           05  FILLER                 PIC X(30)          VALUE SPACES.          
           05  WS-RPTCLS-NCON-CASE    PIC ZZ,ZZZ,ZZ9     VALUE ZEROES.          
           05  FILLER                 PIC X(03)          VALUE SPACES.          
           05  WS-RPT-CLS-NCON-BAL    PIC ZZZ,ZZZ,ZZ9.99 VALUE ZEROES.          
           05  WS-RPT-CLS-NCON-BAL-SG PIC X(1)           VALUE SPACES.          
                                                                                
       01  WS-PRINT-SUMMARY-FINAL.                                              
           05  FILLER                 PIC X(10)          VALUE SPACES.          
           05  FILLER                 PIC X(31)          VALUE                  
                'FINAL TOTAL NO. OF RECORDS     '.                              
           05  FILLER                 PIC X(34)          VALUE SPACES.          
           05  WS-RPTCLS-TOT-CASE     PIC ZZ,ZZZ,ZZ9     VALUE ZEROES.          
           05  FILLER                 PIC X(03)          VALUE SPACES.          
           05  WS-RPT-CLS-TOT-BAL     PIC ZZZ,ZZZ,ZZ9.99 VALUE ZEROES.          
           05  WS-RPT-CLS-TOT-BAL-SG  PIC X(1)           VALUE SPACES.          
                                                                                
       01  LC2A-DETAIL-HD.                                                      
           05  FILLER                 PIC X(10)  VALUE SPACES.                  
           05  FILLER                 PIC X(8)   VALUE 'REGN'.                  
           05  FILLER                 PIC X(10)  VALUE SPACES.                  
           05  FILLER                 PIC X(13)  VALUE 'CURR MONTH OP'.         
           05  FILLER                 PIC X(10)  VALUE SPACES.                  
           05  FILLER                 PIC X(13)  VALUE 'PREV MONTH OP'.         
           05  FILLER                 PIC X(10)  VALUE SPACES.                  
           05  FILLER                 PIC X(14)  VALUE 'DIFF CURR-PREV'.        
           05  FILLER                 PIC X(08)  VALUE SPACES.                  
           05  FILLER               PIC X(16)  VALUE 'TRNSCTION (F136)'.        
           05  FILLER               PIC X(10)  VALUE SPACES.                    
                                                                                
       01  LC2A-DETAIL.                                                         
           05  FILLER                 PIC X(10)          VALUE SPACES.          
           05  LC2A-NUM-REGN          PIC X(8)           VALUE SPACES.          
           05  FILLER                 PIC X(10)          VALUE SPACES.          
           05  LC2A-KD60-OPENING      PIC Z,ZZZ,ZZ9.99   VALUE ZEROES.          
           05  FILLER                 PIC X(10)          VALUE SPACES.          
           05  LC2A-KD60-CLOSING      PIC Z,ZZZ,ZZ9.99    VALUE ZEROES.         
           05  FILLER                 PIC X(10)          VALUE SPACES.          
           05  LC2A-KD60-DIFF         PIC -ZZZ,ZZ9.99     VALUE ZEROES.         
           05  FILLER                 PIC X(13)          VALUE SPACES.          
           05  LC2A-F136-DIFF         PIC -ZZZ,ZZ9.99     VALUE ZEROES.         
           05  FILLER                 PIC X(10)          VALUE SPACES.          
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
                                                                                
      ******************************************************************        
      *        MAIN LINE PROCESS                                       *        
      ******************************************************************        
       MAIN-PROCESS.                                                            
           PERFORM 0000-INIT-SETUP              THRU 0000-EXIT.                 
           PERFORM 0100-READ-BP13KD69           THRU 0100-EXIT.                 
                                                                                
           PERFORM 0200-READ-BP13F136           THRU 0200-EXIT.                 
           PERFORM 0300-DETERMINE-TYPE          THRU 0300-EXIT.                 
           PERFORM 0400-CHECK-TRANS-PAY-TYPE    THRU 0400-EXIT                  
                   UNTIL WS-F136-EOF = 'Y'.                                     
           PERFORM 0700-PRINT-HEAD-OPEN-BAL     THRU 0700-EXIT.                 
           PERFORM 0710-PRINT-REPORT1           THRU 0710-EXIT.                 
           PERFORM 0720-PRINT-REPORT2           THRU 0720-EXIT.                 
           PERFORM 0800-PRINT-SUMMARY           THRU 0800-EXIT.                 
           PERFORM 1000-CLOSE-ROUTINE          THRU  1000-EXIT.                 
                                                                                
      ***************************************************************           
      *    OPENING FILES SECTION                                    *           
      ***************************************************************           
                                                                                
       0000-INIT-SETUP.                                                         
           OPEN INPUT  BP13F136                                                 
                       BP13KD60                                                 
                       BP13KD69                                                 
                       SY02F001                                                 
                OUTPUT BP13LC22                                                 
                       BP13LC2A.                                                
                                                                                
           IF  KD69-STATUS NOT = '00' AND '97'                                  
               DISPLAY 'ERROR OPEN BP13KD69 : ' KD69-STATUS                     
               MOVE KD69-STATUS TO RETURN-CODE                                  
               PERFORM 1000-CLOSE-ROUTINE  THRU 1000-EXIT                       
           END-IF.                                                              
                                                                                
           IF  KD60-STATUS NOT = '00' AND '97'                                  
               DISPLAY 'ERROR OPEN BP13KD60 : ' KD60-STATUS                     
               MOVE KD60-STATUS TO RETURN-CODE                                  
               PERFORM 1000-CLOSE-ROUTINE  THRU 1000-EXIT                       
           END-IF.                                                              
                                                                                
           READ SY02F001.                                                       
                                                                                
           MOVE F001-DTE-CURRENT           TO WS-CURRENT-DATE.                  
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ************************************************************              
      *    READ FILE BP13KD69 FOR OPENING/CLOSING BALANCE        *              
      ************************************************************              
                                                                                
       0100-READ-BP13KD69.                                                      
                                                                                
           MOVE   SPACES             TO     BP13KD69-REC.                       
           INITIALIZE                       BP13KD69-REC.                       
           MOVE  'OP'                TO     KD69-NUM-TRANS.                     
           READ BP13KD69.                                                       
           IF KD69-STATUS = 00 OR 02                                            
              CONTINUE                                                          
           ELSE                                                                 
             IF KD69-STATUS = 23                                                
                DISPLAY 'OPENING/CLOSING BALANCE NOT FOUND AT BP13KD69-'        
                       KD69-STATUS                                              
                MOVE   KD69-STATUS   TO   RETURN-CODE                           
                PERFORM 1000-CLOSE-ROUTINE  THRU 1000-EXIT                      
             ELSE                                                               
                DISPLAY 'BP13KD69-READ ERROR. STATUS: '                         
                       KD69-STATUS                                              
                MOVE   KD69-STATUS   TO   RETURN-CODE                           
                PERFORM 1000-CLOSE-ROUTINE  THRU 1000-EXIT                      
             END-IF                                                             
           END-IF.                                                              
                                                                                
       0100-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ************************************************************              
      *    READ SEQUENTIAL FILE BP13F136 FOR OPENING BALANCE.    *              
      ************************************************************              
       0200-READ-BP13F136.                                                      
                                                                                
           MOVE F136-NUM-REGN           TO WS-PREV-REGN                         
                                                                                
           READ BP13F136                                                        
                AT END MOVE SPACES      TO F136-CDE-TRANS-TYPE                  
                MOVE 'Y'                TO WS-F136-EOF                          
                GO TO 0200-EXIT.                                                
           ADD  1                       TO WS-CNT-BP13F136.                     
                                                                                
       0200-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ************************************************************              
      *    TO DETERMINE WHICH REPORT TO PRINT.                   *              
      ************************************************************              
       0300-DETERMINE-TYPE.                                                     
                                                                                
           IF KD69-AMT-OPEN-LOAN-BAL        IS NOT NUMERIC                      
              MOVE 0 TO KD69-AMT-OPEN-LOAN-BAL                                  
           END-IF.                                                              
           IF KD69-AMT-OPEN-LOAN-BAL-NONCON IS NOT NUMERIC                      
              MOVE 0 TO KD69-AMT-OPEN-LOAN-BAL-NONCON                           
           END-IF.                                                              
           IF KD69-NUM-CLOSE-LOAN-CNT       IS NOT NUMERIC                      
              MOVE 0 TO KD69-NUM-CLOSE-LOAN-CNT                                 
           END-IF.                                                              
           IF KD69-NUM-CLOSE-LOAN-CNT-NONCON IS NOT NUMERIC                     
              MOVE 0 TO KD69-NUM-CLOSE-LOAN-CNT-NONCON                          
           END-IF.                                                              
           IF KD69-NUM-OPEN-LOAN-CNT         IS NOT NUMERIC                     
              MOVE 0 TO KD69-NUM-OPEN-LOAN-CNT                                  
           END-IF.                                                              
           IF KD69-NUM-OPEN-LOAN-CNT-NONCON  IS NOT NUMERIC                     
              MOVE 0 TO KD69-NUM-OPEN-LOAN-CNT-NONCON                           
           END-IF.                                                              
                                                                                
           IF F136-NUM-LOAN-SCH NOT = 'P'                                       
              MOVE 'Y' TO WS-PRINT-NONCON                                       
              MOVE KD69-AMT-OPEN-LOAN-BAL-NONCON TO  WS-SUB-TOT                 
           ELSE                                                                 
              MOVE 'N' TO WS-PRINT-NONCON                                       
              MOVE KD69-AMT-OPEN-LOAN-BAL        TO  WS-SUB-TOT                 
           END-IF.                                                              
                                                                                
       0300-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ************************************************************              
      *    TO CHECK THE TRANSACTION TYPE.                        *              
      ************************************************************              
       0400-CHECK-TRANS-PAY-TYPE.                                               
                                                                                
           EVALUATE F136-CDE-TRANS-TYPE ALSO                                    
                    F136-CDE-PAYMENT-TYPE                                       
              WHEN '11' ALSO 'INS'                                              
              WHEN '11' ALSO 'LS '                                              
                                                                                
                COMPUTE WS-TAB-CASH  = WS-TAB-CASH +                            
                                      F136-AMT-RECEIPT                          
                COMPUTE WS-TAB-CASH-2 = WS-TAB-CASH-2 +                         
                                       F136-AMT-RECEIPT                         
                ADD  +1               TO WS-TAB-CASH-CASE                       
                MOVE 'Y'              TO WS-VALID                               
                                                                                
              WHEN  '12' ALSO 'INS'                                             
              WHEN  '12' ALSO 'LS '                                             
                COMPUTE  WS-TAB-CPF =  WS-TAB-CPF +                             
                                     F136-AMT-RECEIPT                           
                COMPUTE  WS-TAB-CPF-2 =  WS-TAB-CPF-2 +                         
                                         F136-AMT-RECEIPT                       
                ADD  +1               TO WS-TAB-CPF-CASE                        
                MOVE 'Y'              TO WS-VALID                               
                                                                                
              WHEN  '13' ALSO 'INS'                                             
              WHEN  '13' ALSO 'LS '                                             
              WHEN  '14' ALSO 'INS'                                             
              WHEN  '14' ALSO 'LS '                                             
              WHEN  '15' ALSO 'INS'                                             
              WHEN  '15' ALSO 'LS '                                             
              WHEN  '16' ALSO 'INS'                                             
              WHEN  '16' ALSO 'LS '                                             
              WHEN  '69' ALSO 'JVP'                                             
              WHEN  '69' ALSO 'JVL'                                             
              WHEN  '69' ALSO 'JVI'                                             
                COMPUTE  WS-TAB-ADJ = WS-TAB-ADJ +                              
                                      F136-AMT-RECEIPT                          
                COMPUTE  WS-TAB-ADJ-2 = WS-TAB-ADJ-2 +                          
                                      F136-AMT-RECEIPT                          
                MOVE 'Y'              TO WS-VALID                               
                ADD  +1               TO WS-TAB-ADJ-CASE                        
                                                                                
              WHEN '62' ALSO 'IT '                                              
                COMPUTE  WS-TAB-MTH  = WS-TAB-MTH +                             
                                   F136-AMT-RECEIPT                             
                COMPUTE  WS-TAB-MTH-2  = WS-TAB-MTH-2 +                         
                                   F136-AMT-RECEIPT                             
                MOVE 'Y'              TO WS-VALID                               
                ADD  +1               TO WS-TAB-MTH-CASE                        
                                                                                
              WHEN '64' ALSO 'INS'                                              
              WHEN '64' ALSO 'LS '                                              
                COMPUTE  WS-TAB-GIRO = WS-TAB-GIRO +                            
                                   F136-AMT-RECEIPT                             
                COMPUTE  WS-TAB-GIRO-2 = WS-TAB-GIRO-2 +                        
                                   F136-AMT-RECEIPT                             
                MOVE 'Y'              TO WS-VALID                               
                ADD  +1               TO WS-TAB-GIRO-CASE                       
                                                                                
              WHEN '66' ALSO 'LON'                                              
                COMPUTE  WS-TAB-NEW-LOAN =  WS-TAB-NEW-LOAN +                   
                                        F136-AMT-RECEIPT                        
                COMPUTE  WS-TAB-NEW-LOAN-2 =  WS-TAB-NEW-LOAN-2 +               
                                        F136-AMT-RECEIPT                        
                MOVE 'Y'              TO WS-VALID                               
                ADD  +1               TO WS-TAB-NEW-LOAN-CASE                   
                                                                                
              WHEN '67'  ALSO 'IT '                                             
                MOVE F136-AMT-RECEIPT TO WS-INT-AMT-CHAR                        
      *         DISPLAY 'WS-INT-AMT-CHAR' WS-INT-AMT-CHAR                       
      *         DISPLAY 'WS-INT-AMT-NUM'  WS-INT-AMT-NUM                        
                COMPUTE WS-TAB-INT-LOAN  =  WS-TAB-INT-LOAN +                   
                                      WS-INT-AMT-NUM                            
                COMPUTE WS-TAB-INT-LOAN-2  =  WS-TAB-INT-LOAN-2 +               
                                      WS-INT-AMT-NUM                            
                MOVE 'Y'              TO WS-VALID                               
                ADD  +1               TO WS-TAB-INT-LOAN-CASE                   
                                                                                
              WHEN '68'  ALSO 'IT '                                             
                MOVE F136-AMT-RECEIPT TO WS-REB-AMT-CHAR                        
                COMPUTE WS-TAB-REB-LOAN  =  WS-TAB-REB-LOAN -                   
                                      WS-REB-AMT-NUM                            
                COMPUTE WS-TAB-REB-LOAN-2  =  WS-TAB-REB-LOAN-2 +               
                                      WS-REB-AMT-NUM                            
                MOVE 'Y'              TO WS-VALID                               
                ADD  +1               TO WS-TAB-REB-LOAN-CASE                   
                                                                                
              WHEN '70' ALSO 'INS'                                              
                COMPUTE  WS-TAB-SMS-LOAN =  WS-TAB-SMS-LOAN +                   
                                        F136-AMT-RECEIPT                        
                COMPUTE  WS-TAB-SMS-LOAN-2 =  WS-TAB-SMS-LOAN-2 +               
                                        F136-AMT-RECEIPT                        
                MOVE 'Y'              TO WS-VALID                               
                ADD  +1               TO WS-TAB-SMS-LOAN-CASE                   
                                                                                
              WHEN '73' ALSO 'LON'                                              
                COMPUTE  WS-TAB-2ND-LOAN =  WS-TAB-2ND-LOAN +                   
                                        F136-AMT-RECEIPT                        
                COMPUTE  WS-TAB-2ND-LOAN-2 =  WS-TAB-2ND-LOAN-2 +               
                                        F136-AMT-RECEIPT                        
                MOVE 'Y'              TO WS-VALID                               
                ADD  +1               TO WS-TAB-2ND-LOAN-CASE                   
                                                                                
           END-EVALUATE.                                                        
                                                                                
           PERFORM 0200-READ-BP13F136     THRU 0200-EXIT.                       
                                                                                
           IF F136-NUM-REGN NOT = WS-PREV-REGN AND                              
              WS-VALID = 'Y'                                                    
              MOVE 'N'              TO WS-VALID                                 
              COMPUTE WS-F136-DIFF   = (WS-TAB-INT-LOAN-2 +                     
                                        WS-TAB-REB-LOAN-2 +                     
                                        WS-TAB-MTH-2  +                         
                                        WS-TAB-NEW-LOAN-2) -                    
                                        WS-TAB-CASH-2 -                         
                                        WS-TAB-CPF-2  -                         
                                        WS-TAB-ADJ-2  -                         
                                        WS-TAB-GIRO-2 -                         
                                        WS-TAB-SMS-LOAN-2 -                     
                                        WS-TAB-2ND-LOAN-2                       
                                                                                
              IF WS-F136-DIFF NOT = ZEROES                                      
                 PERFORM 0900-READ-BP13KD60     THRU 0900-EXIT                  
                                                                                
                 IF KD60-AMT-OPEN-LOAN-BAL NOT NUMERIC                          
                    MOVE ZEROES TO KD60-AMT-OPEN-LOAN-BAL                       
                 END-IF                                                         
                                                                                
                 IF KD60-AMT-OPEN-LOAN-BAL-PREVMTH NOT NUMERIC                  
                    MOVE ZEROES TO KD60-AMT-OPEN-LOAN-BAL-PREVMTH               
                 END-IF                                                         
                 COMPUTE WS-KD60-DIFF = KD60-AMT-OPEN-LOAN-BAL -                
                                        KD60-AMT-OPEN-LOAN-BAL-PREVMTH          
                                                                                
                 IF WS-F136-DIFF NOT = WS-KD60-DIFF                             
                    ADD 1    TO WS-CNT-DIFF                                     
                    IF WS-CNT-DIFF = 1                                          
                       PERFORM 0740-PRINT-DIFFERENCE-HD THRU 0740-EXIT          
                    END-IF                                                      
                    PERFORM 0730-PRINT-DIFFERENCE  THRU 0730-EXIT               
                 END-IF                                                         
              END-IF                                                            
                                                                                
              INITIALIZE WS-STORAGE                                             
                                                                                
           END-IF.                                                              
                                                                                
       0400-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ************************************************************              
      *    TO SEARCH THE CASE.                                   *              
      ************************************************************              
       0600-SEARCH-CASE.                                                        
                                                                                
           SET WS-IND TO 1                                                      
               SEARCH WS-RPT-DETAIL                                             
                  AT END                                                        
                     MOVE ZEROES                 TO WS-TEMP-RPT-AMT             
                     MOVE ZEROES                 TO WS-TEMP-RPT-CASE            
                  WHEN WS-RPT-TRANS-TYP (WS-IND) = WS-TEMP-TRAN-TYP             
                     MOVE WS-RPT-AMT (WS-IND)    TO WS-TEMP-RPT-AMT             
                     MOVE WS-RPT-CASE (WS-IND)   TO WS-TEMP-RPT-CASE            
              END-SEARCH.                                                       
                                                                                
                                                                                
       0600-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ************************************************************              
      *    PRINTING OPENING BALANCE AND HEADING                  *              
      ************************************************************              
       0700-PRINT-HEAD-OPEN-BAL.                                                
           WRITE PRINT-REPORT-LIST    AFTER PAGE                                
           MOVE SPACES                TO PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
           STRING WS-DD    '/'                                                  
                  WS-MM    '/'                                                  
                  WS-CCYY                                                       
              DELIMITED BY SIZE             INTO RPT-HEAD-DATE.                 
           MOVE WS-PAGE               TO RPT-HEAD-PAGE.                         
                                                                                
           MOVE WS-PRINT-MAIN-HD      TO PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
           MOVE SPACES                TO PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
           STRING F001-TXT-PREV-MTH(1:3) ' '                                    
                  F001-DTE-LAST-DAY-PREV(1:4)                                   
                  DELIMITED BY SIZE INTO RPT-HD-DATE.                           
           IF WS-PRINT-NONCON = 'Y'                                             
              MOVE ' (NON-CONCESSIONARY LOAN)' TO RPT-TITLE                     
           ELSE                                                                 
              MOVE ' (CONCESSIONARY LOAN)'     TO RPT-TITLE                     
           END-IF.                                                              
           MOVE WS-PRINT-REPORT-HD    TO PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
           MOVE SPACES                TO PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
           IF WS-CNT-BP13F136 = 0                                               
              MOVE WS-PRINT-REPORT-EMPTY TO PRINT-REPORT-LIST                   
              WRITE PRINT-REPORT-LIST  AFTER 2                                  
              GO TO 0700-EXIT                                                   
           END-IF.                                                              
                                                                                
           MOVE WS-PRINT-REPORT-CL1   TO PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
           MOVE WS-PRINT-REPORT-LINE  TO PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
      *PRINTING OPENING BALANCE.                                                
           IF WS-SUB-TOT < 0                                                    
              MOVE '-'                 TO WS-RPT-BAL-SG                         
           ELSE                                                                 
              MOVE SPACES              TO WS-RPT-BAL-SG                         
           END-IF.                                                              
           MOVE WS-SUB-TOT             TO WS-RPT-BAL.                           
                                                                                
           IF WS-PRINT-NONCON = 'N'                                             
              MOVE KD69-NUM-OPEN-LOAN-CNT        TO WS-RPT-OPEN-CASE            
           ELSE                                                                 
              MOVE KD69-NUM-OPEN-LOAN-CNT-NONCON TO WS-RPT-OPEN-CASE            
           END-IF.                                                              
                                                                                
           MOVE WS-PRINT-REPORT-RW1    TO PRINT-REPORT-LIST.                    
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
       0700-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      *****************************************************************         
      *    PRINT REPORT                                               *         
      *****************************************************************         
                                                                                
       0710-PRINT-REPORT1.                                                      
           IF WS-CNT-BP13F136 = 0                                               
              GO TO 0710-EXIT                                                   
           END-IF.                                                              
                                                                                
      *PRINTING NEW LOAN                                                        
           MOVE '66'                TO   WS-TEMP-TRAN-TYP.                      
           PERFORM 0600-SEARCH-CASE THRU 0600-EXIT.                             
           IF WS-TEMP-RPT-AMT  < 0                                              
              MOVE '-'              TO   WS-RPT-NLD-SG                          
           ELSE                                                                 
              MOVE SPACES           TO   WS-RPT-NLD-SG                          
           END-IF.                                                              
           MOVE WS-TEMP-RPT-AMT     TO   WS-RPT-NLD.                            
           MOVE WS-TEMP-RPT-AMT     TO   WS-RPT-NLD2.                           
           MOVE WS-TEMP-RPT-CASE    TO   WS-RPT-NLD-CASE                        
                                         WS-RPT-NLD-SUB-CASE.                   
           COMPUTE WS-TOT-CASE = WS-TOT-CASE     + WS-TEMP-RPT-CASE.            
           COMPUTE WS-SUB-TOT  = WS-TEMP-RPT-AMT + WS-SUB-TOT.                  
           MOVE SPACES              TO   PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST.                                             
           MOVE WS-PRINT-REPORT-RW2 TO   PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
      *PRINTING SPACES.                                                         
           MOVE SPACES              TO   PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST.                                             
           COMPUTE WS-CLOSING-TOT = WS-CLOSING-TOT + WS-SUB-TOT.                
           MOVE ZEROES              TO   WS-SUB-TOT                             
                                         WS-TOT-CASE.                           
      *PRINTING INT LOAN.                                                       
           MOVE '67'                TO   WS-TEMP-TRAN-TYP.                      
           PERFORM 0600-SEARCH-CASE THRU 0600-EXIT.                             
           IF WS-TEMP-RPT-AMT < 0                                               
              MOVE '-'              TO   WS-RPT-NL-SG                           
           ELSE                                                                 
              MOVE SPACES           TO   WS-RPT-NL-SG                           
           END-IF.                                                              
           MOVE WS-TEMP-RPT-AMT     TO   WS-RPT-NL.                             
           MOVE WS-TEMP-RPT-CASE    TO   WS-RPT-NL-CASE.                        
           COMPUTE WS-SUB-TOT = WS-TEMP-RPT-AMT + WS-SUB-TOT.                   
           COMPUTE WS-TOT-CASE = WS-TOT-CASE + WS-TEMP-RPT-CASE.                
           MOVE WS-PRINT-REPORT-RW3 TO   PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
      *PRINTING INT MONTHLY.                                                    
           MOVE '62'                TO   WS-TEMP-TRAN-TYP.                      
           PERFORM 0600-SEARCH-CASE THRU 0600-EXIT.                             
           IF WS-TEMP-RPT-AMT < 0                                               
              MOVE '-'              TO   WS-RPT-INT-MTH-SG                      
           ELSE                                                                 
              MOVE SPACES           TO   WS-RPT-INT-MTH-SG                      
           END-IF.                                                              
           MOVE WS-TEMP-RPT-AMT     TO   WS-RPT-INT-MTH.                        
           MOVE WS-TEMP-RPT-CASE    TO   WS-RPTMTH-CASE.                        
           COMPUTE WS-SUB-TOT = WS-TEMP-RPT-AMT + WS-SUB-TOT.                   
           COMPUTE WS-TOT-CASE = WS-TOT-CASE + WS-TEMP-RPT-CASE.                
           MOVE WS-PRINT-REPORT-RW4 TO   PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
      *PRINTING INT REBATE.                                                     
           MOVE '68'                TO   WS-TEMP-TRAN-TYP.                      
           PERFORM 0600-SEARCH-CASE THRU 0600-EXIT.                             
           IF WS-TEMP-RPT-AMT  < 0                                              
              MOVE '-'              TO   WS-RPT-REB-REBT-SG                     
           ELSE                                                                 
              MOVE SPACES           TO   WS-RPT-REB-REBT-SG                     
           END-IF.                                                              
           MOVE WS-TEMP-RPT-AMT     TO   WS-RPT-REB-MTH.                        
           MOVE WS-TEMP-RPT-CASE    TO   WS-RPTREBT-CASE.                       
           COMPUTE WS-SUB-TOT = WS-TEMP-RPT-AMT + WS-SUB-TOT.                   
           COMPUTE WS-TOT-CASE = WS-TOT-CASE + WS-TEMP-RPT-CASE.                
           MOVE WS-PRINT-REPORT-RW5 TO   PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
      *PRINTING SUB TOTAL                                                       
           IF WS-SUB-TOT < 0                                                    
              MOVE  '-'             TO   WS-RPT-SUB-AMT-SG                      
           ELSE                                                                 
              MOVE  SPACES          TO   WS-RPT-SUB-AMT-SG                      
           END-IF.                                                              
           MOVE WS-SUB-TOT          TO   WS-RPT-SUB-AMT.                        
           MOVE WS-TOT-CASE         TO   WS-RPT-SUB-CASE.                       
           MOVE WS-PRINT-REPORT-SUB TO   PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST  AFTER 2.                                    
                                                                                
      *PRINTING SPACES.                                                         
           MOVE SPACES              TO   PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST.                                             
           COMPUTE WS-CLOSING-TOT = WS-CLOSING-TOT + WS-SUB-TOT.                
           COMPUTE WS-MAIN-CASE   = WS-TOT-CASE    + WS-MAIN-CASE.              
           MOVE ZEROES              TO   WS-SUB-TOT                             
                                         WS-TOT-CASE.                           
                                                                                
       0710-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
       0720-PRINT-REPORT2.                                                      
           IF WS-CNT-BP13F136 = 0                                               
              GO TO 0720-EXIT                                                   
           END-IF.                                                              
                                                                                
      *PRINTING CASH.                                                           
           MOVE '11'                TO   WS-TEMP-TRAN-TYP.                      
           PERFORM 0600-SEARCH-CASE THRU 0600-EXIT.                             
           IF WS-TEMP-RPT-AMT < 0                                               
              MOVE '-'              TO   WS-RPT-CASH-SG                         
           ELSE                                                                 
              MOVE SPACES           TO   WS-RPT-CASH-SG                         
           END-IF.                                                              
           MOVE WS-TEMP-RPT-AMT     TO   WS-RPT-CASH.                           
           MOVE WS-TEMP-RPT-CASE    TO   WS-RPTCASH-CASE.                       
           COMPUTE WS-SUB-TOT     = WS-TEMP-RPT-AMT + WS-SUB-TOT.               
           COMPUTE WS-CLOSING-TOT = WS-CLOSING-TOT  - WS-TEMP-RPT-AMT.          
           COMPUTE WS-TOT-CASE    = WS-TOT-CASE     + WS-TEMP-RPT-CASE.         
           MOVE WS-PRINT-REPORT-RW7 TO   PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
      *PRINTING CPF.                                                            
           MOVE '12'                TO   WS-TEMP-TRAN-TYP.                      
           PERFORM 0600-SEARCH-CASE THRU 0600-EXIT.                             
           IF WS-TEMP-RPT-AMT < 0                                               
              MOVE '-'              TO   WS-RPT-CPF-SG                          
           ELSE                                                                 
              MOVE SPACES           TO   WS-RPT-CPF-SG                          
           END-IF.                                                              
           MOVE WS-TEMP-RPT-AMT     TO   WS-RPT-CPF.                            
           MOVE WS-TEMP-RPT-CASE    TO   WS-RPTCPF-CASE.                        
           MOVE WS-PRINT-REPORT-RW6 TO   PRINT-REPORT-LIST.                     
           COMPUTE WS-TOT-CASE    = WS-TOT-CASE     + WS-TEMP-RPT-CASE.         
           COMPUTE WS-SUB-TOT     = WS-TEMP-RPT-AMT + WS-SUB-TOT.               
           COMPUTE WS-CLOSING-TOT = WS-CLOSING-TOT  - WS-TEMP-RPT-AMT.          
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
      *PRINTING GIRO.                                                           
           MOVE '64'                TO   WS-TEMP-TRAN-TYP.                      
           PERFORM 0600-SEARCH-CASE THRU 0600-EXIT.                             
           IF WS-TEMP-RPT-AMT  < 0                                              
              MOVE '-'              TO   WS-RPT-GIRO-SG                         
           ELSE                                                                 
              MOVE SPACES           TO   WS-RPT-GIRO-SG                         
           END-IF.                                                              
           MOVE WS-TEMP-RPT-AMT     TO   WS-RPT-GIRO.                           
           MOVE WS-TEMP-RPT-CASE    TO   WS-RPTGIRO-CASE.                       
           COMPUTE WS-SUB-TOT     = WS-TEMP-RPT-AMT + WS-SUB-TOT.               
           COMPUTE WS-CLOSING-TOT = WS-CLOSING-TOT  - WS-TEMP-RPT-AMT.          
           COMPUTE WS-TOT-CASE    = WS-TOT-CASE     + WS-TEMP-RPT-CASE.         
           MOVE WS-PRINT-REPORT-RW8 TO   PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
      *PRINTING AXS /SAM.                                                       
           MOVE SPACES               TO   WS-RPT-AXS                            
                                          WS-RPTAXS-CASE.                       
           MOVE  WS-PRINT-REPORT-RW9 TO   PRINT-REPORT-LIST.                    
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
##    *PRINTING INT ADJUSTMENT.                                                 
           MOVE '14'                 TO   WS-TEMP-TRAN-TYP.                     
           PERFORM 0600-SEARCH-CASE  THRU 0600-EXIT.                            
           IF WS-TEMP-RPT-AMT < 0                                               
              MOVE '-'               TO   WS-RPT-ADJ-SG                         
           ELSE                                                                 
              MOVE SPACES            TO   WS-RPT-ADJ-SG                         
           END-IF.                                                              
           MOVE WS-TEMP-RPT-AMT      TO   WS-RPT-ADJ.                           
           MOVE WS-TEMP-RPT-CASE     TO   WS-RPTADJ-CASE.                       
           COMPUTE WS-SUB-TOT     = WS-TEMP-RPT-AMT + WS-SUB-TOT.               
           COMPUTE WS-CLOSING-TOT = WS-CLOSING-TOT  + WS-TEMP-RPT-AMT.          
           COMPUTE WS-TOT-CASE    = WS-TOT-CASE     + WS-TEMP-RPT-CASE.         
           MOVE WS-PRINT-REPORT-RW10 TO   PRINT-REPORT-LIST.                    
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
      *PRINTING SUB TOTAL                                                       
           IF WS-SUB-TOT < 0                                                    
              MOVE  '-'             TO   WS-RPT-SUB-AMT-SG                      
           ELSE                                                                 
              MOVE  SPACES          TO   WS-RPT-SUB-AMT-SG                      
           END-IF.                                                              
           MOVE WS-SUB-TOT          TO   WS-RPT-SUB-AMT.                        
           MOVE WS-TOT-CASE         TO   WS-RPT-SUB-CASE.                       
           MOVE WS-PRINT-REPORT-SUB TO   PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST  AFTER 2.                                    
                                                                                
      *PRINTING SPACES.                                                         
           MOVE SPACES              TO   PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST.                                             
           MOVE ZEROES              TO   WS-SUB-TOT                             
                                         WS-TOT-CASE.                           
                                                                                
      *PRINTING SMS LOAN.                                                       
           MOVE '70'                 TO   WS-TEMP-TRAN-TYP.                     
           PERFORM 0600-SEARCH-CASE  THRU 0600-EXIT.                            
           IF WS-TEMP-RPT-AMT < 0                                               
              MOVE '-'               TO   WS-RPT-SMS-BAL-SG                     
                                          WS-RPT-SMS2-BAL-SG                    
           ELSE                                                                 
              MOVE SPACES            TO   WS-RPT-SMS-BAL-SG                     
                                          WS-RPT-SMS2-BAL-SG                    
           END-IF.                                                              
           MOVE WS-TEMP-RPT-AMT      TO   WS-RPT-SMS-BAL                        
                                          WS-RPT-SMS2-BAL.                      
           MOVE WS-TEMP-RPT-CASE     TO   WS-RPT-SMS-CASE                       
                                          WS-RPT-SMS2-CASE.                     
           COMPUTE WS-CLOSING-TOT = WS-CLOSING-TOT  - WS-TEMP-RPT-AMT.          
           COMPUTE WS-TOT-CASE    = WS-TOT-CASE     + WS-TEMP-RPT-CASE.         
           MOVE WS-PRINT-REPORT-RW12 TO   PRINT-REPORT-LIST.                    
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
      *PRINTING SPACES.                                                         
           MOVE SPACES              TO   PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST.                                             
           MOVE ZEROES              TO   WS-SUB-TOT                             
                                         WS-TOT-CASE.                           
                                                                                
      *PRINTING CONVERSION                                                      
           MOVE '73'                 TO   WS-TEMP-TRAN-TYP.                     
           PERFORM 0600-SEARCH-CASE  THRU 0600-EXIT.                            
           IF WS-TEMP-RPT-AMT < 0                                               
              MOVE '-'               TO   WS-RPT-2ND-BAL-SG                     
                                          WS-RPT-2ND2-BAL-SG                    
           ELSE                                                                 
              MOVE SPACES            TO   WS-RPT-2ND-BAL-SG                     
                                          WS-RPT-2ND2-BAL-SG                    
           END-IF.                                                              
           MOVE WS-TEMP-RPT-AMT      TO   WS-RPT-2ND-BAL                        
                                          WS-RPT-2ND2-BAL.                      
           MOVE WS-TEMP-RPT-CASE     TO   WS-RPT-2ND-CASE                       
                                          WS-RPT-2ND2-CASE.                     
           COMPUTE WS-CLOSING-TOT = WS-CLOSING-TOT  - WS-TEMP-RPT-AMT.          
           COMPUTE WS-TOT-CASE    = WS-TOT-CASE     + WS-TEMP-RPT-CASE.         
           MOVE WS-PRINT-REPORT-RW13 TO   PRINT-REPORT-LIST.                    
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
      *PRINTING SPACES.                                                         
           MOVE SPACES              TO   PRINT-REPORT-LIST.                     
           WRITE PRINT-REPORT-LIST.                                             
           MOVE ZEROES              TO   WS-SUB-TOT                             
                                         WS-TOT-CASE.                           
                                                                                
      *PRINTING CLOSING BALANCE.                                                
           IF WS-CLOSING-TOT < 0                                                
              MOVE '-'               TO   WS-RPT-CLS-BAL-SG                     
           ELSE                                                                 
              MOVE SPACES            TO   WS-RPT-CLS-BAL-SG                     
           END-IF.                                                              
           MOVE WS-PRINT-LINE-RW11   TO   PRINT-REPORT-LIST.                    
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
           IF WS-PRINT-NONCON = 'N'                                             
              MOVE KD69-AMT-CLOSE-LOAN-BAL        TO WS-RPT-CLS-BAL             
              MOVE KD69-NUM-CLOSE-LOAN-CNT        TO WS-RPTCLS-CASE             
           ELSE                                                                 
              MOVE KD69-AMT-CLOSE-LOAN-BAL-NONCON TO WS-RPT-CLS-BAL             
              MOVE KD69-NUM-CLOSE-LOAN-CNT-NONCON TO WS-RPTCLS-CASE             
           END-IF.                                                              
                                                                                
           MOVE WS-PRINT-REPORT-RW11 TO   PRINT-REPORT-LIST.                    
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
           MOVE WS-PRINT-LINE-RW11   TO   PRINT-REPORT-LIST.                    
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
       0720-EXIT.                                                               
            EXIT.                                                               
                                                                                
       0730-PRINT-DIFFERENCE.                                                   
                                                                                
           IF WS-LINE-A >= 50                                                   
              MOVE 0                  TO WS-LINE-A                              
              ADD 2                   TO WS-LINE-A                              
              PERFORM 0740-PRINT-DIFFERENCE-HD     THRU 0740-EXIT               
           END-IF.                                                              
                                                                                
           MOVE WS-PREV-REGN                   TO LC2A-NUM-REGN.                
           MOVE KD60-AMT-OPEN-LOAN-BAL         TO LC2A-KD60-OPENING.            
           MOVE KD60-AMT-OPEN-LOAN-BAL-PREVMTH TO LC2A-KD60-CLOSING.            
           MOVE WS-KD60-DIFF                   TO LC2A-KD60-DIFF.               
           MOVE WS-F136-DIFF                   TO LC2A-F136-DIFF.               
                                                                                
           WRITE PRINT-REPORT-LIST-A   FROM LC2A-DETAIL.                        
           ADD 1                      TO WS-LINE-A.                             
                                                                                
       0730-EXIT.                                                               
            EXIT.                                                               
                                                                                
       0740-PRINT-DIFFERENCE-HD.                                                
                                                                                
           WRITE PRINT-REPORT-LIST-A  AFTER PAGE                                
           MOVE SPACES                TO PRINT-REPORT-LIST-A.                   
           WRITE PRINT-REPORT-LIST-A.                                           
           ADD 2                      TO WS-LINE-A.                             
                                                                                
           STRING WS-DD    '/'                                                  
                  WS-MM    '/'                                                  
                  WS-CCYY                                                       
              DELIMITED BY SIZE             INTO RPT-HEAD-DATE.                 
           MOVE WS-PAGE               TO RPT-HEAD-PAGE.                         
                                                                                
           MOVE WS-PRINT-MAIN-HD      TO PRINT-REPORT-LIST-A.                   
           WRITE PRINT-REPORT-LIST-A.                                           
                                                                                
           MOVE SPACES                TO PRINT-REPORT-LIST-A.                   
           WRITE PRINT-REPORT-LIST-A.                                           
                                                                                
           WRITE PRINT-REPORT-LIST-A   FROM LC2A-DETAIL-HD.                     
           ADD 3                      TO WS-LINE-A.                             
                                                                                
       0740-EXIT.                                                               
            EXIT.                                                               
                                                                                
       0800-PRINT-SUMMARY.                                                      
                                                                                
           IF WS-PRINT-NONCON NOT = 'Y'                                         
              GO TO 0800-EXIT.                                                  
                                                                                
           MOVE KD69-AMT-CLOSE-LOAN-BAL        TO WS-RPT-CLS-CON-BAL            
           MOVE KD69-NUM-CLOSE-LOAN-CNT        TO WS-RPTCLS-CON-CASE            
           IF KD69-AMT-CLOSE-LOAN-BAL < 0                                       
              MOVE '-'                         TO WS-RPT-CLS-CON-BAL-SG         
           END-IF.                                                              
                                                                                
           MOVE KD69-AMT-CLOSE-LOAN-BAL-NONCON TO WS-RPT-CLS-NCON-BAL           
           MOVE KD69-NUM-CLOSE-LOAN-CNT-NONCON TO WS-RPTCLS-NCON-CASE           
           IF KD69-AMT-CLOSE-LOAN-BAL-NONCON < 0                                
              MOVE '-'                         TO WS-RPT-CLS-NCON-BAL-SG        
           END-IF.                                                              
                                                                                
           COMPUTE WS-CLOSING-BAL = KD69-AMT-CLOSE-LOAN-BAL +                   
                                    KD69-AMT-CLOSE-LOAN-BAL-NONCON              
           COMPUTE WS-CLOSING-CASE = KD69-NUM-CLOSE-LOAN-CNT +                  
                                     KD69-NUM-CLOSE-LOAN-CNT-NONCON             
           MOVE WS-CLOSING-BAL                 TO WS-RPT-CLS-TOT-BAL            
           MOVE WS-CLOSING-CASE                TO WS-RPTCLS-TOT-CASE            
           IF WS-CLOSING-BAL < 0                                                
              MOVE '-'                         TO WS-RPT-CLS-TOT-BAL-SG         
           END-IF.                                                              
                                                                                
           MOVE WS-PRINT-SUMMARY-TITLE         TO PRINT-REPORT-LIST.            
           WRITE PRINT-REPORT-LIST AFTER 10.                                    
                                                                                
           MOVE WS-PRINT-SUMMARY-DASH          TO PRINT-REPORT-LIST.            
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
           MOVE WS-PRINT-SUMMARY-CON-LOAN      TO PRINT-REPORT-LIST.            
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
           MOVE WS-PRINT-SUMMARY-DASH          TO PRINT-REPORT-LIST.            
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
           MOVE WS-PRINT-SUMMARY-NCON-LOAN     TO PRINT-REPORT-LIST.            
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
           MOVE WS-PRINT-SUMMARY-DASH          TO PRINT-REPORT-LIST.            
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
           MOVE WS-PRINT-SUMMARY-FINAL         TO PRINT-REPORT-LIST.            
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
           MOVE WS-PRINT-SUMMARY-DASH          TO PRINT-REPORT-LIST.            
           WRITE PRINT-REPORT-LIST.                                             
                                                                                
       0800-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *----------------------------------------------------------------*        
       0900-READ-BP13KD60.                                                      
      *----------------------------------------------------------------*        
                                                                                
           MOVE SPACES                      TO BP13KD60-REC.                    
           INITIALIZE                          BP13KD60-REC.                    
                                                                                
           MOVE WS-PREV-REGN               TO KD60-NUM-REGN.                    
                                                                                
           READ BP13KD60.                                                       
                                                                                
           IF KD60-STATUS = 00 OR 02                                            
              CONTINUE                                                          
           ELSE                                                                 
              IF KD60-STATUS = 23                                               
                 DISPLAY 'BP13KD60 - RECORD NOT FND : ' KD60-NUM-REGN           
                 ADD 1 TO WS-KD60-NOTFND                                        
              ELSE                                                              
                 DISPLAY ' BP13KD60-READING ERROR, STATUS: '                    
                          KD60-STATUS                                           
                 MOVE KD60-STATUS        TO   RETURN-CODE                       
                 PERFORM 1000-CLOSE-ROUTINE   THRU 1000-EXIT                    
              END-IF                                                            
           END-IF.                                                              
                                                                                
       0900-EXIT.                                                               
           EXIT.                                                                
                                                                                
       1000-CLOSE-ROUTINE.                                                      
                                                                                
           DISPLAY '******  BP13CC22 *************'.                            
           DISPLAY 'NO OF F136 READ  (BP13F136) : '                             
                                               WS-CNT-BP13F136.                 
           DISPLAY 'NO OF KD60 NOT FOUND        : '                             
                                               WS-KD60-NOTFND.                  
                                                                                
           CLOSE BP13F136                                                       
                 BP13KD60                                                       
                 BP13KD69                                                       
                 SY02F001                                                       
                 BP13LC22                                                       
                 BP13LC2A.                                                      
                                                                                
           IF  KD69-STATUS NOT = '00'                                           
               DISPLAY 'ERROR CLOSE BP13KD69 : ' KD69-STATUS                    
               MOVE KD69-STATUS TO RETURN-CODE                                  
           END-IF.                                                              
                                                                                
       1000-EXIT.                                                               
           STOP RUN.                                                            
