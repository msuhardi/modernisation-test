       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C896.                                                 
      *AUTHOR.        ELAINE S ARGA.                                            
      *DATE-WRITTEN.  25 MAR 2014.                                              
      * ========================================================= *             
      *  SYSTEM OF COMMITMENT (BP13)                              *             
      * ========================================================= *             
      *  OBJECTIVE  :  PRINTING OF LETTERS                        *             
      *             :  PRINTING OF PRE E-CHECK REPORT PER SYSTEM  *             
      *                                                           *             
      *  PRINTING OF LETTERS IN BP13.BATCH.COPYCOB                *             
      *                                                           *             
      *  BP13CR48 - PRINTING OF INVITATION & MCPS LETTERS (BTO)   *             
      *  BP13CR49 - PRINTING OF INVITATION & MCPS LETTERS (MGPS)  *             
      *  BP13CR1A - PRINTING OF APPLICATION LETTERS               *             
      *  BP13CR1B - PRINTING OF DOCUMENTS TO BRING                *             
      *  BP13CR2B - PRINTING OF DOCUMENTS TO BRING                *             
      *             FOR K200-NUM-PRINT-TAG = 'T' CASES            *             
      *  BP13CR1C - PRINTING OF PRIVATE PROPERTY FORM             *             
      *                                                           *             
      *  SEQUENCE   :  INVITATION LETTER                          *             
      *             :  MCPS                                       *             
      *             :  DOCUMENTS TO BRING                         *             
      *             :  NON-DELETION                               *             
      *             :  APPLICATION LETTERS FOR INTERNET CASES     *             
      *                                                           *             
      *  INPUT      :  1.  BP13F740 - BP13.F740.MATUREBA          *             
      *                2.  BP13K060 - BP13.K060.CODETAB           *             
      *                3.  BP13K096 - BP13.K096.SECURITY          *             
      *                4.  BP13K757 - BP13.K757.BTO               *             
      *                5.  BP13K800 - BP13.K800.APPLN             *             
      *                6.  BP13K820 - BP13.K820.SOCOCCP           *             
      *                7.  BP13K830 - BP13.K830.ADDR              *             
      *                8.  BP13K200 - BP13.K200.BKAPPMT           *             
      *                9.  BP13K062 - BP13.K062.CODETBL           *             
      *  OUTPUT     :  1.  P13P89DA - INVITITAION LETTER          *             
      *                             - MCPS UNDERTAKING            *             
      *                             - DOCUMENTS                   *             
      *                             - NON-DELETION                *             
      *                             - APPLICATION LETTER AND      *             
      *                               HOUSING LOAN LETTER         *             
      *                             - PRIVATE PROPERTY FORM       *             
      *                2.  P13L89DA - INTERNET CASES W/ PPO       *             
      *                3.  P13L89DB - CONTROL LIST FOR INTERNET   *             
      *                               APPLICATION AND PPO         *             
      *  I/O        :  1.  BP13KF00 - BP13.KF00.FORMID            *             
      *                                                           *             
      * ========================================================= *             
      *  CHG REF  OIC   DATE        DESCRIPTION                   *             
      *  -------- ----  ----------  ----------------------------  *             
      *  BP135517 ESA1  25/03/2014  NEW PROGRAM(MODELLED BP13C89D)*             
      *  BP135591 ESA1  02/12/2014  TO CATER FOR CDE-MCPS-REQ = B *             
      *  BP135591 KAM4  29/01/2015  ADDED PASSING OF CDE-RELATNSHIP             
      *  BP135555 ESA1  11/02/2015  TO CATER FOR SBF LETTERS      *             
      *  BP135198 ESA1  27/02/2015  TO CATER FOR PPS FOR OCCUP    *             
      *  BP135165 ESA1  09/01/2015  TO CATER FOR DOCUMENT RQST UPD*             
      *  BP135849 ESA1  04/08/2015  TO CATER FOR UPDATE OF BP13FP00             
      *                             & BP13FP0A                    *             
      *  BP135941 FNP1  18/09/2015  CREATE NEW ANNEX FOR CASES WITH             
      *                             K200-NUM-PRINT-TAG = 'T'      *             
      *  BP136122 ESA1  20/04/2016  ADD READING OF BP04K010       *             
      *  BP136836 ESA1  17/08/2017  TO CATER FOR 'ROF' SEL-TYPE   *             
      *  BP137144 ESA1  08/01/2018  TO CATER FOR FP00-AHG-DTE-DUE *             
      *  BP137194 ESA1  05/04/2018  TO CATER FOR UPDATED COMPUTATION            
      *                             IN THE LETTER DATE            *             
      *  BP137013 ESA1  11/04/2018  TO CHECK FOR MGPS IN LETTER   *             
      *                             DATE COMPUTATION              *             
      *  BP137065 ESA1  26/06/2018  TO ADD CALLING OF BE01C812 TO *             
      *                             RETRIEVE MRG INFO IN CDB      *             
      *  BP137354 ESA1  09/07/2018  TO CATER FOR PENDING DOCUMENT *             
      *                             FOR EMP-STAT = 'A' AND 'B'    *             
      *  BP137461 ESA1  17/09/2018  TO ADD BP13CR5B FOR 201808    *             
      *  BP137717 CC37  10/04/2019  ADDED WS-C398-GENDER          *             
      *  BP137786  KV6  23/04/2019  TO CATER FOR 'OBF' SEL-TYPE   *             
      *  BP137717 CC37  27/06/2019  ADDED WS-C398-DIVORCE-FNLJDGMT*             
      *                             ADDED WS-C398-DOB             *             
      *                             ADDED WS-C398-CITIZENSHIP     *             
      *  BP138049 SSR1  15/11/2019  CATER FOR PRELIM EHG LANDING PAGE*          
      *  BP138345 MRR5  26/06/2020  NEW GLOBAL VARIABLE TO COUNT  *             
      *                             PGNUM PER CASE ACROSS PROGRAMS*             
      *  BP138201 MRR5  15/07/2020  SUBTRACT 14 INSTEAD OF 31 FROM*             
      *                             WS-NUM-DTE-LETTER             *             
      *  BP138460 MRR5  22/09/2020  BYPASS PRINTING WHEN FND IN K76D            
      *  BP138553 MRR5  19/01/2021  FIX SPOUSE/FIANCE TAGGING AND *             
      *                             ADD 'SAP' FOR WS-C398-ESS-MBRS*             
      *  BP139694 MRR5  04/07/2023  HFE CHANGES                   *             
      *  BP139280 EAA2  07/11/2023  EXPAND BP13K757 FROM 3000 TO 4000           
      *  BP138929 MRR5  31/01/2024  WRITE REGNO AND FORMIDS TO BP13KF00         
      * ========================================================= *             
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
           SELECT BP13F200     ASSIGN       TO BP13F200.                        
           SELECT BP13F205     ASSIGN       TO BP13F205.                        
                                                                                
           SELECT BP13K060     ASSIGN       TO BP13K060                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS RANDOM                           
                               RECORD KEY   IS K060-KEY-FLD                     
                               FILE STATUS  IS WS-K060-STATUS.                  
                                                                                
           SELECT BP13K062     ASSIGN       TO BP13K062                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS RANDOM                           
                               RECORD KEY   IS K062-KEY-FLD                     
                               FILE STATUS  IS WS-K062-STATUS.                  
                                                                                
           SELECT BP13K757     ASSIGN       TO BP13K757                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS RANDOM                           
                               RECORD KEY   IS K757-KEY-FLD                     
                               FILE STATUS  IS WS-K757-STATUS.                  
                                                                                
           SELECT BP13K813     ASSIGN       TO BP13K813                         
                               ACCESS MODE  IS RANDOM                           
                               ORGANIZATION IS INDEXED                          
                               RECORD KEY   IS K813-KEY-FLD                     
                               FILE STATUS  IS WS-K813-STATUS.                  
                                                                                
           SELECT BP13K800     ASSIGN       TO BP13K800                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS RANDOM                           
                               RECORD KEY   IS K800-NUM-REGN                    
                               FILE STATUS  IS WS-K800-STATUS.                  
                                                                                
           SELECT BP13K820     ASSIGN       TO BP13K820                         
                               ORGANIZATION IS INDEXED                          
                               ACCESS MODE  IS DYNAMIC                          
                               RECORD KEY   IS K820-KEY-FLD                     
                               FILE STATUS  IS WS-K820-STATUS.                  
                                                                                
           SELECT BP13K830     ASSIGN       TO BP13K830                         
                               ACCESS MODE  IS RANDOM                           
                               ORGANIZATION IS INDEXED                          
                               RECORD KEY   IS K830-KEY-FLD                     
                               ALTERNATE RECORD KEY IS  K830-NUM-REGN           
                               FILE STATUS  IS WS-K830-STATUS.                  
                                                                                
           SELECT BP13K246     ASSIGN       TO BP13K246                         
                               ACCESS MODE  IS RANDOM                           
                               ORGANIZATION IS INDEXED                          
                               RECORD KEY   IS K246-KEY-FLD                     
                               FILE STATUS  IS WS-K246-STATUS.                  
                                                                                
           SELECT BP13K76D     ASSIGN       TO BP13K76D                         
                               ACCESS MODE  IS RANDOM                           
                               ORGANIZATION IS INDEXED                          
                               RECORD KEY   IS K76D-KEY-FLD                     
                               FILE STATUS  IS WS-K76D-STATUS.                  
                                                                                
           SELECT BP13KF00     ASSIGN       TO BP13KF00                         
                               ACCESS MODE  IS RANDOM                           
                               ORGANIZATION IS INDEXED                          
                               RECORD KEY   IS KF00-KEY-FLD                     
                               FILE STATUS  IS WS-KF00-STATUS.                  
                                                                                
           SELECT BP13K734     ASSIGN       TO BP13K734                         
                               ACCESS MODE  IS RANDOM                           
                               ORGANIZATION IS INDEXED                          
                               RECORD KEY   IS K734-KEY-FLD                     
                               FILE STATUS  IS WS-K734-STATUS.                  
                                                                                
           SELECT BP13K200     ASSIGN       TO BP13K200                         
                               ACCESS MODE  IS RANDOM                           
                               ORGANIZATION IS INDEXED                          
                               ALTERNATE KEY IS K200-NUM-REGN                   
                               RECORD KEY   IS K200-KEY-FLD                     
                               FILE STATUS  IS WS-K200-STATUS.                  
                                                                                
           SELECT BP04K010     ASSIGN       TO BP04K010                         
                               ACCESS MODE  IS DYNAMIC                          
                               ORGANIZATION IS INDEXED                          
                               RECORD KEY   IS K010-PRIME-KEY                   
                               FILE STATUS  IS WS-K010-STATUS.                  
                                                                                
           SELECT BP13FP00     ASSIGN       TO BP13FP00.                        
                                                                                
           SELECT BP13FP0A     ASSIGN       TO BP13FP0A.                        
                                                                                
           SELECT BP13FP0B     ASSIGN       TO BP13FP0B.                        
                                                                                
           SELECT BP13FQ10     ASSIGN       TO BP13FQ10.                        
                                                                                
           SELECT P13P89DA     ASSIGN       TO P13P89DA.                        
                                                                                
           SELECT P13P89DC     ASSIGN       TO P13P89DC.                        
                                                                                
           SELECT P13P89DD     ASSIGN       TO P13P89DD.                        
                                                                                
           SELECT P13P89D2     ASSIGN       TO P13P89D2.                        
                                                                                
           SELECT P13L89DA     ASSIGN       TO P13L89DA.                        
                                                                                
           SELECT P13L89DB     ASSIGN       TO P13L89DB.                        
                                                                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD   BP13F200 IS GLOBAL                                                  
            RECORD CONTAINS 300 CHARACTERS                                      
            LABEL RECORDS IS STANDARD                                           
            RECORDING MODE IS F.                                                
       COPY BP13F200.                                                           
                                                                                
       FD   BP13F205 IS GLOBAL                                                  
            RECORD CONTAINS 80 CHARACTERS                                       
            LABEL RECORDS IS STANDARD                                           
            RECORDING MODE IS F.                                                
       COPY BP13F205.                                                           
                                                                                
       FD   BP13K060 IS GLOBAL                                                  
            RECORD CONTAINS 25 CHARACTERS.                                      
       COPY BP13K060.                                                           
                                                                                
       FD   BP13K062 IS GLOBAL                                                  
            RECORD CONTAINS 150 CHARACTERS.                                     
       COPY BP13K062.                                                           
                                                                                
       FD   BP13K813 IS GLOBAL                                                  
            RECORD CONTAINS 1000 CHARACTERS.                                    
       COPY BP13K813.                                                           
                                                                                
       FD   BP13K757 IS GLOBAL                                                  
            RECORD CONTAINS 4000 CHARACTERS.                                    
       COPY BP13K757.                                                           
                                                                                
       FD   BP13K800 IS GLOBAL                                                  
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K800.                                                           
                                                                                
       FD   BP13K820 IS GLOBAL                                                  
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13K820.                                                           
                                                                                
       FD   BP13KF00 IS GLOBAL                                                  
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BP13KF00.                                                           
                                                                                
       FD   BP13K830 IS GLOBAL                                                  
            RECORD CONTAINS 250 CHARACTERS.                                     
       COPY BP13K830.                                                           
                                                                                
       FD   BP13K246 IS GLOBAL                                                  
            RECORD CONTAINS 80 CHARACTERS.                                      
       COPY BP13K246.                                                           
                                                                                
       FD   BP13K76D IS GLOBAL                                                  
            RECORD CONTAINS 100 CHARACTERS.                                     
       COPY BP13K76D.                                                           
                                                                                
       FD   BP13K734 IS GLOBAL                                                  
            RECORD CONTAINS 200 CHARACTERS.                                     
       COPY BP13K734.                                                           
                                                                                
       FD   BP13K200 IS GLOBAL                                                  
            RECORD CONTAINS 300 CHARACTERS.                                     
       COPY BP13K200.                                                           
                                                                                
       FD   BP04K010 IS GLOBAL                                                  
            RECORD CONTAINS 300 CHARACTERS.                                     
       COPY P04K010.                                                            
                                                                                
       FD   BP13FP00 IS GLOBAL                                                  
            RECORDING MODE IS F                                                 
            RECORD CONTAINS 3800 CHARACTERS.                                    
       COPY BP13FP00.                                                           
                                                                                
       FD   BP13FP0A IS GLOBAL                                                  
            RECORDING MODE IS F                                                 
            RECORD CONTAINS 3800 CHARACTERS.                                    
       01   BP13FP0A-REC        PIC X(3800).                                    
                                                                                
       FD   BP13FP0B IS GLOBAL                                                  
            RECORDING MODE IS F                                                 
            RECORD CONTAINS 3800 CHARACTERS.                                    
       01   BP13FP0B-REC        PIC X(3800).                                    
                                                                                
       FD   BP13FQ10 IS GLOBAL                                                  
            RECORDING MODE IS F                                                 
            RECORD CONTAINS 400 CHARACTERS.                                     
       COPY BP13FQ10.                                                           
                                                                                
       FD   P13P89DA IS GLOBAL                                                  
            RECORD CONTAINS 120 CHARACTERS                                      
            LABEL RECORDS IS STANDARD                                           
            RECORDING MODE IS  F.                                               
       01   P13P89DA-REC    PIC X(120) GLOBAL.                                  
                                                                                
       FD   P13P89DC IS GLOBAL                                                  
            RECORD CONTAINS 100 CHARACTERS                                      
            LABEL RECORDS IS STANDARD                                           
            RECORDING MODE IS  F.                                               
       01   P13P89DC-REC    PIC X(100) GLOBAL.                                  
                                                                                
       FD   P13P89DD IS GLOBAL                                                  
            RECORD CONTAINS 100 CHARACTERS                                      
            LABEL RECORDS IS STANDARD                                           
            RECORDING MODE IS  F.                                               
       01   P13P89DD-REC    PIC X(100) GLOBAL.                                  
                                                                                
       FD   P13P89D2 IS GLOBAL                                                  
            RECORD CONTAINS 100 CHARACTERS                                      
            LABEL RECORDS IS STANDARD                                           
            RECORDING MODE IS  F.                                               
       01   P13P89D2-REC    PIC X(100) GLOBAL.                                  
                                                                                
       FD   P13L89DA IS GLOBAL                                                  
            RECORD CONTAINS 132 CHARACTERS                                      
            LABEL RECORDS IS STANDARD                                           
            RECORDING MODE IS F.                                                
       01   P13L89DA-REC    PIC X(132) GLOBAL.                                  
                                                                                
       FD   P13L89DB IS GLOBAL                                                  
            RECORD CONTAINS 132  CHARACTERS                                     
            LABEL RECORDS IS STANDARD                                           
            RECORDING MODE IS F.                                                
       01   P13L89DB-REC    PIC X(132) GLOBAL.                                  
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       COPY BE01W812.                                                           
       COPY BE01W902.                                                           
                                                                                
       01  WS-FILE-SWITCHES.                                                    
           05  WS-F200-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-F205-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K800-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K820-EOF               PIC X(01)  VALUE 'N'.                  
           05  WS-K010-EOF               PIC X(01)  VALUE 'N'.                  
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-F200-READ-CNT          PIC 9(06)  VALUE ZEROES.               
           05  WS-K820-READ-CNT          PIC 9(06)  VALUE ZEROES.               
           05  WS-K757-FND-CNT           PIC 9(06)  VALUE ZEROES.               
           05  WS-K757-NFND-CNT          PIC 9(06)  VALUE ZEROES.               
           05  WS-K800-FND-CNT           PIC 9(06)  VALUE ZEROES.               
           05  WS-K800-NFND-CNT          PIC 9(06)  VALUE ZEROES.               
           05  WS-K76D-FND-CNT           PIC 9(06)  VALUE ZEROES.               
           05  WS-K76D-NFND-CNT          PIC 9(06)  VALUE ZEROES.               
           05  WS-IDX1                   PIC 9(02)  VALUE ZEROES.               
           05  WS-IDX2                   PIC 9(02)  VALUE ZEROES.               
           05  WS-IDX3                   PIC 9(02)  VALUE ZEROES.               
           05  WS-K800-FND               PIC X(01)  VALUE 'N'.                  
           05  WS-K820-FND               PIC X(01)  VALUE 'N'.                  
           05  WS-K76D-FND               PIC X(01)  VALUE 'N'.                  
           05  WS-K734-FND               PIC X(01)  VALUE 'N'.                  
           05  WS-KF00-FND               PIC X(01)  VALUE 'N'.                  
           05  WS-MRG-TBL-FND            PIC X(01)  VALUE 'N'.                  
           05  WS-MRG-CHK-SKIP           PIC X(01)  VALUE 'N'.                  
           05  WS-HA1-WSP-STAT           PIC X(01)  VALUE 'N'.                  
           05  WS-OC1-GT21               PIC X(01)  VALUE 'N'.                  
           05  WS-EMP-STATUS             PIC X(01)  VALUE SPACE.                
           05  WS-DTE-INCOME1            PIC X(06)  VALUE SPACE.                
           05  WS-DTE-INCOME2            PIC X(06)  VALUE SPACE.                
           05  WS-NUM-INCOME1            PIC X(05)  VALUE SPACE.                
           05  WS-NUM-INCOME2            PIC X(05)  VALUE SPACE.                
           05  WS-NUM-INCOME3            PIC X(05)  VALUE SPACE.                
           05  WS-IDNTY-TYPE             PIC X(03)  VALUE SPACES.               
           05  WS-BE01-UNSUCC            PIC 9(06)  VALUE ZEROES.               
           05  WS-BE01-SUCC              PIC 9(06)  VALUE ZEROES.               
           05  WS-KF00-WRITE             PIC 9(06)  VALUE ZEROES.               
           05  WS-KF00-REWRITE           PIC 9(06)  VALUE ZEROES.               
                                                                                
       01 WS-DTE-REGN                      PIC X(06)  VALUE SPACES.             
       01 WS-NUM-DTE-REGN REDEFINES WS-DTE-REGN.                                
          05  WS-DTE-REGN-CCYY             PIC 9(4).                            
          05  WS-DTE-REGN-MM               PIC 9(2).                            
                                                                                
       01  WS-AGE                        PIC 9(08) VALUE ZEROES.                
       01  WS-NUM-AGE  REDEFINES WS-AGE.                                        
           05 WS-AGE-CMPLTD              PIC 9(04).                             
           05 WS-NUM-REMNG               PIC 9(04).                             
                                                                                
       01  WS-AGE2                       PIC 9(08) VALUE ZEROES.                
       01  WS-NUM-AGE2 REDEFINES WS-AGE2.                                       
           05 WS-AGE-CMPLTD2             PIC 9(04).                             
           05 WS-NUM-REMNG2              PIC 9(04).                             
                                                                                
       01  WS-DTE-LETTER                 PIC 9(08) VALUE ZEROES.                
       01  WS-DTE-LETTER-2               PIC 9(08) VALUE ZEROES.                
       01  WS-NUM-DTE-LETTER             PIC 9(07) VALUE ZEROES.                
       01  WS-PAIRED-REGN                PIC X(08) VALUE SPACES.                
       01  WS-NUM-REGN                   PIC X(08) VALUE SPACES.                
                                                                                
       01  WS-ARRAY-VARIABLES.                                                  
           05  WS-ARRAY-VARS OCCURS 12 TIMES.                                   
               10  WS-NUM-CSTMR          PIC X(09)  VALUE SPACES.               
               10  WS-NUM-NRIC-WIFE      PIC X(09)  VALUE SPACES.               
               10  WS-NUM-NRIC-HSBND     PIC X(09)  VALUE SPACES.               
                                                                                
       01  WS-MONTH.                                                            
           05  WS-YR                     PIC 9(04)  VALUE ZEROES.               
           05  WS-MM                     PIC 9(02)  VALUE ZEROES.               
                                                                                
       01 WS-AHG-SHG-DET GLOBAL.                                                
          05 WS-AHG-APPLN                  PIC X      VALUE 'N'.                
          05 WS-AHG-APPLN-F120             PIC X      VALUE 'N'.                
          05 WS-EHG-APPLN                  PIC X      VALUE 'N'.                
          05 WS-EHG-APPLN-F120             PIC X      VALUE 'N'.                
          05 WS-AHG-SHG-SINGLES            PIC X      VALUE 'N'.                
          05 WS-EHG-SINGLES                PIC X      VALUE 'N'.                
          05 WS-AHG-SHG-COUPLES            PIC X      VALUE 'N'.                
          05 WS-AHG-SHG-FAMILY             PIC X      VALUE 'N'.                
          05 WS-AHG-COUPLES                PIC X      VALUE 'N'.                
          05 WS-AHG-FAMILY                 PIC X      VALUE 'N'.                
          05 WS-EHG-FAMILY                 PIC X      VALUE 'N'.                
          05 WS-AHG-DOC-DUE                PIC 9(08) VALUE ZEROES.              
          05 WS-DTE-DOC-DUE                PIC 9(08) VALUE ZEROES.              
          05 WS-DTE-DUE                    PIC 9(08) VALUE ZEROES.              
          05 WS-DTE-BK-APPT                PIC 9(08) VALUE ZEROES.              
                                                                                
       01  WS-FILE-STATUS-G GLOBAL.                                             
           05  WS-K060-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K062-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K096-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K757-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K800-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K820-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K830-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K555-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K813-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K246-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K76D-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K734-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K200-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-K010-STATUS            PIC 9(02)  VALUE ZEROES.               
           05  WS-KF00-STATUS            PIC 9(02)  VALUE ZEROES.               
                                                                                
       01  WS-VARIABLES-G GLOBAL.                                               
           05  WS-CURRENT-DATE           PIC X(08)  VALUE SPACES.               
           05  WS-DATE                   PIC 9(08)  VALUE ZEROES.               
           05  WS-DTE-APPLN              PIC 9(08)  VALUE ZEROES.               
           05  WS-BIRTH-DATE             PIC 9(08)  VALUE ZEROES.               
           05  WS-TOT-PAGE-CNT           PIC 9(06)  VALUE ZEROES.               
           05  WS-CASE-PAGE-CNT          PIC 9(03)  VALUE ZEROES.               
           05  WS-FP00-WRITE-CNT         PIC 9(08)  VALUE ZEROES.               
           05  WS-FP0A-WRITE-CNT         PIC 9(08)  VALUE ZEROES.               
           05  WS-FP0B-WRITE-CNT         PIC 9(08)  VALUE ZEROES.               
           05  WS-FQ10-WRITE-CNT         PIC 9(08)  VALUE ZEROES.               
           05  WS-CNT-WRITE-L89DA        PIC 9(08)  VALUE ZEROES.               
           05  WS-CNT-WRITE-L89DB        PIC 9(08)  VALUE ZEROES.               
           05  WS-REC-SKIPPED            PIC 9(08)  VALUE ZEROES.               
           05  WS-TOT-LET-PRINT          PIC 9(08)  VALUE ZEROES.               
           05  WS-CNT-LINE-ON-PAGE-A     PIC 9(08)  VALUE ZEROES.               
           05  WS-CNT-LINE-ON-PAGE-B     PIC 9(08)  VALUE ZEROES.               
           05  WS-CNT-PRINT-L89DA        PIC 9(08)  VALUE 1.                    
           05  WS-CNT-PRINT-L89DB        PIC 9(08)  VALUE 1.                    
           05  WS-NO-OF-PAGE-A           PIC 9(08)  VALUE ZEROES.               
           05  WS-NO-OF-PAGE-B           PIC 9(08)  VALUE ZEROES.               
           05  WS-CURR-DATE              PIC X(10)  VALUE SPACES.               
           05  WS-FORM-PRTED             PIC 9(06)  VALUE ZEROES.               
           05  WS-HH                     PIC X(01)  VALUE SPACES.               
           05  WS-FT                     PIC X(01)  VALUE SPACES.               
           05  WS-CTR                    PIC 9(02)  VALUE ZEROES.               
           05  WS-CTR2                   PIC 9(02)  VALUE ZEROES.               
           05  WS-F                      PIC 9(02)  VALUE ZEROES.               
           05  WS-INC-CTR                PIC 9(02)  VALUE ZEROES.               
           05  WS-INC-CTR2               PIC 9(02)  VALUE ZEROES.               
           05  CTR                       PIC 9(02)  VALUE ZEROES.               
           05  WS-NRIC-CNT               PIC 9(02)  VALUE ZEROES.               
           05  WS-APPL-CNT               PIC 9(02)  VALUE ZEROES.               
           05  WS-OCCP-CNT               PIC 9(02)  VALUE ZEROES.               
           05  WS-DOC-CNT                PIC 9(03)  VALUE ZEROES.               
           05  WS-REGN-PAGE-CNT          PIC 9(03)  VALUE ZEROES.               
           05  WS-FORMS-PRINTED          PIC X(01)  VALUE SPACES.               
           05  WS-HFE                    PIC X(01)  VALUE SPACES.               
                                                                                
      * PARAMETERS FOR INVITATION AND UNDERTAKING LETTERS                       
      * SIMILAR FROM BP13C245                                                   
                                                                                
       01  WS-C245-PARAMETERS GLOBAL.                                           
      *    05  WS-C245-LETTER-TYPE        PIC X(01).                            
           05  WS-C245-NUM-ALLO-SCHEME    PIC X(03).                            
           05  WS-C245-ROOM               PIC X(02).                            
           05  WS-C245-REGN-NO            PIC X(08).                            
           05  WS-C245-ALLOC-SCH          PIC X(07).                            
      *    05  WS-C245-HT                 PIC X(01).                            
           05  WS-C245-Q-NO               PIC X(05).                            
           05  WS-C245-ALLOC-DATE         PIC X(10).                            
           05  WS-C245-SELECT-ROOM        PIC X(09).                            
           05  WS-C245-ZONE               PIC X(10).                            
           05  WS-C245-NT-ZONE-NAME       PIC X(20).                            
           05  WS-C245-BALLOT-QTR         PIC X(03).                            
           05  WS-C245-BALLOT-YR          PIC X(04).                            
           05  WS-C245-BALLOT-MNT-YR      PIC X(14).                            
           05  WS-C245-APPMT-DATE         PIC X(10).                            
           05  WS-C245-APPMT-TIME.                                              
               10  WS-C245-APPMT-HR       PIC X(02).                            
               10  WS-C245-APPMT-SEP      PIC X(01).                            
               10  WS-C245-APPMT-MIN      PIC X(02).                            
               10  FILLER                 PIC X(01).                            
               10  WS-C245-APPMT-AM-PM    PIC X(02).                            
           05  WS-C245-BOOKFEE            PIC X(07).                            
           05  WS-C245-PERCENT-DESC       PIC X(07).                            
           05  WS-C245-PERCENT            PIC 9(02).                            
           05  WS-C245-REMAINDER          PIC X(04).                            
           05  WS-C245-TITLE              PIC X(12).                            
           05  WS-C245-APPLN-NAME         PIC X(66).                            
           05  WS-C245-COAPPLN-NAME       PIC X(66).                            
           05  WS-C245-COAPPLN2-NAME      PIC X(66).                            
           05  WS-C245-COAPPLN3-NAME      PIC X(66).                            
           05  WS-C245-APPLN-NRIC         PIC X(09).                            
           05  WS-C245-COAPPLN-NRIC       PIC X(09).                            
           05  WS-C245-COAPPLN2-NRIC      PIC X(09).                            
           05  WS-C245-COAPPLN3-NRIC      PIC X(09).                            
           05  WS-C245-ADDRESS1.                                                
               10  FILLER                 PIC X(10).                            
               10  WS-C245-BLK-NO         PIC X(10).                            
               10  FILLER                 PIC X(2).                             
               10  WS-C245-NUM-FLAT.                                            
                   15  WS-C245-CHAR       PIC X(01).                            
                   15  WS-C245-LEVEL      PIC X(02).                            
                   15  WS-C245-DASH       PIC X(01).                            
                   15  WS-C245-HSE-MAIN   PIC X(04).                            
                   15  WS-C245-HSE-SUB    PIC X(03).                            
           05  WS-C245-ADDRESS2.                                                
               10  WS-C245-STREET-NAME    PIC X(65).                            
           05  WS-C245-CODE               PIC X(16).                            
           05  WS-C245-CC                 PIC X(22).                            
      *    05  WS-C245-BO                 PIC X(02).                            
           05  WS-C245-NME-OIC            PIC X(40).                            
      *    05  WS-C245-OIC-DESIG          PIC X(40).                            
           05  WS-C245-SHOW-FLAT          PIC X(35).                            
           05  WS-C245-BTO-REOPT          PIC X(01).                            
           05  WS-C245-NUM-JB-MTF         PIC X(01).                            
           05  WS-C245-NUM-LOW-FLOOR      PIC X(01).                            
           05  WS-C245-NUM-LOAN-TAG       PIC X(01).                            
           05  FILLER                     PIC X(96).                            
                                                                                
      * PARAMETERS FOR DOCUMENT LETTERS                                         
                                                                                
       01 WS-C398-PARAMETERS GLOBAL.                                            
          02 WS-C398-LTR-VARS.                                                  
             05 WS-C398-NUM-REGN                   PIC X(08).                   
             05 WS-C398-NUM-REGN-PAIRED            PIC X(08).                   
             05 WS-C398-PRT-DATE                   PIC X(10).                   
             05 WS-C398-ESS-MBRS                   PIC X(01).                   
             05 WS-C398-ORPHANS-DECL               PIC X(01).                   
             05 WS-C398-MCPS-FRM                   PIC X(01).                   
             05 WS-C398-APPLN-FRM                  PIC X(01).                   
             05 WS-C398-MGLS-FRM                   PIC X(01).                   
             05 WS-C398-APPS-CERTF                 PIC X(01).                   
             05 WS-C398-OCCUPIERS  OCCURS 12 TIMES.                             
                10 WS-C398-NRIC                    PIC X(09).                   
                10 WS-C398-CDE-OCCUPIER            PIC X(01).                   
                10 WS-C398-NME-OCCUPIER            PIC X(66).                   
                10 WS-C398-AGE-OCCUPIER            PIC 9(03).                   
                10 WS-C398-DEB-OCCUPIER            PIC X(02).                   
                10 WS-C398-GENDER                  PIC X(01).                   
                10 WS-C398-CITIZENSHIP             PIC X(02).                   
                10 WS-C398-DOB                     PIC X(08).                   
                10 WS-C398-DOC-REQD.                                            
                   20 WS-C398-ID-CARD              PIC X(01).                   
                   20 WS-C398-PASS-PERMIT          PIC X(01).                   
                   20 WS-C398-BIRTH-CERTF          PIC X(01).                   
                   20 WS-C398-MARRIAGE-CERTF       PIC X(01).                   
                   20 WS-C398-PAY-SLIP             PIC X(01).                   
                   20 WS-C398-UNEMPLYMNT-DECL      PIC X(01).                   
                   20 WS-C398-STUDENT-PASS         PIC X(01).                   
                   20 WS-C398-DEATH-CERTF          PIC X(01).                   
                   20 WS-C398-NRIC-DTH-CERTF       PIC X(09).                   
                   20 WS-C398-NME-DTH-CERTF        PIC X(66).                   
                   20 WS-C398-DIVORCE-CERTF        PIC X(01).                   
                   20 WS-C398-PHOTOGRAPH           PIC X(01).                   
                   20 WS-C398-MARRIAGE-CONSENT     PIC X(01).                   
                   20 WS-C398-RELATIONSHIP         PIC X(02).                   
                   20 WS-C398-SP-FI                PIC X(01).                   
                   20 WS-C398-DIVORCE-FNLJDGMT     PIC X(01).                   
             05 FILLER                             PIC X(38).                   
          02 WS-C398-LETTER-CNT                    PIC 9(02).                   
                                                                                
       01 WS-C398-INCOME-PARAMETERS GLOBAL.                                     
          02 WS-C398-LTR-VARS2.                                                 
             05 WS-C398-INC  OCCURS 12 TIMES.                                   
                10 WS-C398-AGE2-OCCUPIER            PIC 9(03).                  
                10 WS-C398-INC-REQD.                                            
                   20 WS-C398-EMP-STAT             PIC X(01).                   
                   20 WS-C398-DTE-INCOME1          PIC X(06).                   
                   20 WS-C398-DTE-INCOME2          PIC X(06).                   
                   20 WS-C398-NUM-INCOME1          PIC X(05).                   
                   20 WS-C398-NUM-INCOME2          PIC X(05).                   
                   20 WS-C398-NUM-INCOME3          PIC X(05).                   
                10 WS-C398-PPS-ELIG                PIC X(01).                   
                10 WS-C398-NS-LT12MTH              PIC X(01).                   
                10 WS-C398-EDN-LT12MTH             PIC X(01).                   
          02 FILLER                                PIC X(27).                   
                                                                                
       01  WS-KF00-REC GLOBAL.                                                  
           05  WS-KF00-FORMID OCCURS 50 TIMES.                                  
               10  WS-KF00-FORM-ID      PIC X(06).                              
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
      ************************************************************              
       0000-MAIN.                                                               
      ************************************************************              
           PERFORM 1000-OPEN-ROUTINE   THRU 1000-EXIT.                          
           PERFORM 2000-READ-BP13F200  THRU 2000-EXIT.                          
           PERFORM 2500-READ-BP13F205  THRU 2500-EXIT.                          
           PERFORM 3000-PROCESS-RECORD THRU 3000-EXIT                           
             UNTIL WS-F200-EOF = 'Y'.                                           
           PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT.                           
                                                                                
       0000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ************************************************************              
       1000-OPEN-ROUTINE.                                                       
      ************************************************************              
           OPEN INPUT  BP13F200                                                 
                       BP13F205                                                 
                       BP13K060                                                 
                       BP13K062                                                 
                       BP13K813                                                 
                       BP13K757                                                 
                       BP13K800                                                 
                       BP13K820                                                 
                       BP13K830                                                 
                       BP13K246                                                 
                       BP13K76D                                                 
                       BP13K734                                                 
                       BP13K200                                                 
                       BP04K010                                                 
                I-O    BP13KF00                                                 
                OUTPUT BP13FP00                                                 
                       BP13FP0A                                                 
                       BP13FP0B                                                 
                       BP13FQ10                                                 
                       P13P89DA                                                 
                       P13P89DC                                                 
                       P13P89DD                                                 
                       P13P89D2                                                 
                       P13L89DA                                                 
                       P13L89DB.                                                
                                                                                
           IF WS-K060-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K060 OPEN ERROR, STATUS ' WS-K060-STATUS             
              MOVE WS-K060-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K062-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K062 OPEN ERROR, STATUS ' WS-K062-STATUS             
              MOVE WS-K062-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K813-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K813 OPEN ERROR, STATUS ' WS-K813-STATUS             
              MOVE WS-K813-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K757-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K757 OPEN ERROR, STATUS ' WS-K757-STATUS             
              MOVE WS-K757-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K800 OPEN ERROR, STATUS ' WS-K800-STATUS             
              MOVE WS-K800-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K820-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K820 OPEN ERROR, STATUS ' WS-K820-STATUS             
              MOVE WS-K820-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K830-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K830 OPEN ERROR, STATUS ' WS-K830-STATUS             
              MOVE WS-K830-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K246-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K246 OPEN ERROR, STATUS ' WS-K246-STATUS             
              MOVE WS-K246-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K76D-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K76D OPEN ERROR, STATUS ' WS-K76D-STATUS             
              MOVE WS-K76D-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K734-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K76D OPEN ERROR, STATUS ' WS-K76D-STATUS             
              MOVE WS-K76D-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K200-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13K200 OPEN ERROR, STATUS ' WS-K200-STATUS             
              MOVE WS-K200-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-K010-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP04K010 OPEN ERROR, STATUS ' WS-K010-STATUS             
              MOVE WS-K010-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           IF WS-KF00-STATUS NOT = 00 AND 97                                    
              DISPLAY 'BP13KF00 OPEN ERROR, STATUS ' WS-KF00-STATUS             
              MOVE WS-KF00-STATUS        TO RETURN-CODE                         
              PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                         
           END-IF.                                                              
                                                                                
           MOVE SPACES                     TO BE01W812-INPUT-INFO.              
           MOVE 'OPENS'                    TO BE01W812-IN-RTN-FXN.              
           CALL 'BE01C812' USING BE01W812-COMMAREA.                             
                                                                                
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-CURRENT-DATE.                  
           MOVE FUNCTION CURRENT-DATE(1:8) TO WS-DATE.                          
                                                                                
           STRING WS-CURRENT-DATE(7:2) '/'                                      
                  WS-CURRENT-DATE(5:2) '/'                                      
                  WS-CURRENT-DATE(1:4)                                          
                  DELIMITED BY SIZE                                             
             INTO WS-CURR-DATE.                                                 
                                                                                
           MOVE SPACES  TO P13P89DA-REC.                                        
           WRITE    P13P89DA-REC AFTER PAGE.                                    
           MOVE SPACES  TO P13P89DC-REC.                                        
           WRITE    P13P89DC-REC AFTER PAGE.                                    
           MOVE SPACES  TO P13P89DD-REC.                                        
           WRITE    P13P89DD-REC AFTER PAGE.                                    
           MOVE SPACES  TO P13P89D2-REC.                                        
           WRITE    P13P89D2-REC AFTER PAGE.                                    
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ************************************************************              
       2000-READ-BP13F200.                                                      
      ************************************************************              
           READ BP13F200                                                        
             AT END                                                             
                MOVE 'Y'                 TO WS-F200-EOF                         
            NOT AT END                                                          
                ADD 1                    TO WS-F200-READ-CNT                    
           END-READ.                                                            
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ************************************************************              
       2500-READ-BP13F205.                                                      
      ************************************************************              
                                                                                
           READ BP13F205                                                        
             AT END                                                             
                MOVE 'Y'                 TO WS-F205-EOF                         
           END-READ.                                                            
                                                                                
       2500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       3000-PROCESS-RECORD.                                                     
      ************************************************************              
           PERFORM 3100-INITIALIZE     THRU 3100-EXIT.                          
                                                                                
           MOVE F200-NUM-REGN TO K800-NUM-REGN.                                 
           PERFORM 3200-READ-BP13K800  THRU 3200-EXIT.                          
           IF WS-K800-FND = 'N'                                                 
              DISPLAY 'NOT FOUND K800-NUM-REGN: ' K800-NUM-REGN                 
              ADD 1 TO WS-K800-NFND-CNT                                         
              PERFORM 2000-READ-BP13F200 THRU 2000-EXIT                         
              GO TO 3000-EXIT                                                   
           ELSE                                                                 
              MOVE K800-NUM-ALLO-CAT      TO K76D-NUM-SALES-MODE                
              MOVE K800-DTE-BALLOT        TO K76D-NUM-DTE-BALLOT                
              MOVE K800-NUM-REGN          TO K76D-NUM-REGN                      
              PERFORM 3150-READ-BP13K76D  THRU 3150-EXIT                        
              IF WS-K76D-FND = 'Y'                                              
                 DISPLAY 'REC FOUND K76D-KEY-FLD: ' K76D-KEY-FLD                
                 ADD 1 TO WS-K76D-FND-CNT                                       
                 PERFORM 2000-READ-BP13F200 THRU 2000-EXIT                      
                 GO TO 3000-EXIT                                                
              ELSE                                                              
                 DISPLAY 'NOT FOUND K76D-KEY-FLD: ' K76D-KEY-FLD                
                 ADD 1 TO WS-K76D-NFND-CNT                                      
              END-IF                                                            
              DISPLAY 'FOUND K800-NUM-REGN: ' K800-NUM-REGN                     
              ADD 1 TO WS-K800-FND-CNT                                          
                                                                                
              IF (K800-DTE-BALLOT >= '202305') AND                              
                 (K800-NUM-ALLO-CAT NOT = 'SER') AND                            
                 (K800-NUM-PORT-ELIG-TAG NOT = 'P' AND 'Y')                     
                  MOVE 'Y' TO WS-HFE                                            
              ELSE                                                              
                  MOVE 'N' TO WS-HFE                                            
              END-IF                                                            
                                                                                
              MOVE F200-NUM-REGN            TO WS-C398-NUM-REGN                 
              PERFORM 3300-GET-LETTER-DATE       THRU 3300-EXIT                 
              MOVE 'N'             TO WS-K820-FND                               
              MOVE ZEROES          TO WS-C398-LETTER-CNT                        
                                                                                
              IF K800-NUM-ALLO-CAT = 'ROF' OR 'OBF'                             
                 MOVE SPACES       TO WS-AHG-APPLN                              
              ELSE                                                              
                 IF K800-NUM-ALLO-SCHEME = 'FTS' AND                            
                   (K800-NUM-ELIG-SCHEME = 'SSC' OR 'JSS' OR 'NCS') AND         
                   (K800-NUM-FLAT-TYPE = '2 ' OR '2F')                          
                   MOVE 'Y'          TO WS-AHG-APPLN                            
                 END-IF                                                         
                                                                                
                 IF K800-NUM-FT2T = 'Y'                                         
                   IF K800-NUM-FLAT-TYPE = '2 ' OR '3 ' OR '4 ' OR '3P'         
                                        OR '2F' OR '5 ' OR 'E '                 
                      MOVE 'Y'          TO WS-AHG-APPLN                         
                   END-IF                                                       
                 END-IF                                                         
                                                                                
                 IF (K800-NUM-HOUSEHOLD = 'H') AND                              
                    (K800-NUM-ALLO-SCHEME NOT = 'FTS') AND                      
                    (K800-NUM-ELIG-SCHEME = 'PA ' OR 'FS ' OR 'SI ' OR  ')      
                                            'TCP')                              
                   IF K800-NUM-FLAT-TYPE = '2 ' OR '3 ' OR '4 ' OR '3P'         
                                        OR '2F' OR '5 ' OR 'E '                 
                      MOVE 'Y'    TO WS-AHG-APPLN                               
                   END-IF                                                       
                 END-IF                                                         
              END-IF                                                            
                                                                                
              IF K800-NUM-MGPS = 'P' OR 'C'                                     
                 IF F200-DTE-BKAPPMT-DATE-MGPS NOT = SPACES AND                 
                                                     LOW-VALUES                 
                    MOVE F200-DTE-BKAPPMT-DATE-MGPS                             
                                          TO  WS-DTE-BK-APPT                    
                 ELSE                                                           
                    MOVE K800-DTE-BK-APPT-MGPS TO  WS-DTE-BK-APPT               
                 END-IF                                                         
              ELSE                                                              
                 IF F200-DTE-BKAPPMT-DATE NOT = SPACES AND LOW-VALUES           
                    MOVE F200-DTE-BKAPPMT-DATE                                  
                                         TO  WS-DTE-BK-APPT                     
                 ELSE                                                           
                    MOVE K800-DTE-BK-APPT   TO  WS-DTE-BK-APPT                  
                 END-IF                                                         
              END-IF                                                            
                                                                                
              IF WS-DTE-BK-APPT IS NUMERIC                                      
                 COMPUTE WS-DTE-DUE =                                           
                         FUNCTION INTEGER-OF-DATE (WS-DTE-BK-APPT)              
                 COMPUTE WS-DTE-DUE = WS-DTE-DUE - 7                            
                                                                                
                 COMPUTE WS-DTE-DOC-DUE =                                       
                         FUNCTION DATE-OF-INTEGER (WS-DTE-DUE)                  
                                                                                
                 MOVE WS-DTE-DOC-DUE     TO WS-AHG-DOC-DUE                      
              ELSE                                                              
                 MOVE ZEROES             TO WS-AHG-DOC-DUE                      
              END-IF                                                            
                                                                                
              MOVE SPACES          TO WS-ARRAY-VARIABLES                        
              MOVE ZEROES          TO WS-NRIC-CNT                               
                                      WS-IDX2                                   
                                      WS-IDX3                                   
              MOVE LOW-VALUES      TO K820-KEY-FLD                              
              MOVE K800-NUM-REGN   TO K820-NUM-REGN                             
                                      WS-NUM-REGN                               
              PERFORM 3400-PROCESS-BP13K820      THRU 3400-EXIT                 
              IF K800-NUM-ALLO-CAT NOT = 'NPL'                                  
                 PERFORM 3600-CREATE-BP13FQ10    THRU 3600-EXIT                 
              END-IF                                                            
              MOVE SPACES                   TO BP13K757-REC                     
              INITIALIZE                       BP13K757-REC                     
              MOVE F200-NUM-REGN            TO K757-NUM-REGN                    
              PERFORM 4000-APPLN-HSELOAN-LET  THRU 4000-EXIT                    
           END-IF.                                                              
                                                                                
           PERFORM 8000-UPDT-BP13KF00 THRU 8000-EXIT.                           
           PERFORM 2000-READ-BP13F200 THRU 2000-EXIT.                           
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ************************************************************              
       3100-INITIALIZE.                                                         
      ************************************************************              
           MOVE  ZEROS      TO WS-APPL-CNT                                      
                               WS-REGN-PAGE-CNT.                                
           MOVE   4         TO WS-OCCP-CNT.                                     
           MOVE   'N'       TO WS-K820-EOF.                                     
           MOVE  SPACES     TO WS-C398-LTR-VARS.                                
           INITIALIZE          WS-C398-LTR-VARS.                                
           MOVE  SPACES     TO WS-C398-LTR-VARS2.                               
           INITIALIZE          WS-C398-LTR-VARS2.                               
                                                                                
           PERFORM VARYING WS-F FROM 1 BY 1 UNTIL WS-F > 50                     
              MOVE SPACES TO WS-KF00-FORM-ID(WS-F)                              
           END-PERFORM.                                                         
           MOVE ZEROES TO WS-F.                                                 
                                                                                
       3100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       3150-READ-BP13K76D.                                                      
      ************************************************************              
           READ BP13K76D.                                                       
           EVALUATE WS-K76D-STATUS                                              
             WHEN   00                                                          
                    MOVE 'Y'      TO WS-K76D-FND                                
             WHEN   23                                                          
                    MOVE 'N'      TO WS-K76D-FND                                
             WHEN   OTHER                                                       
                    DISPLAY 'READ BP13K76D ERROR ' K76D-NUM-REGN                
                    DISPLAY 'STATUS ' WS-K800-STATUS                            
                    MOVE WS-K76D-STATUS TO RETURN-CODE                          
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
                                                                                
           END-EVALUATE.                                                        
                                                                                
       3150-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       3200-READ-BP13K800.                                                      
      ************************************************************              
           READ BP13K800.                                                       
           EVALUATE WS-K800-STATUS                                              
             WHEN   00                                                          
                    IF K800-NUM-STATUS = 'C'                                    
                       MOVE 'N'      TO WS-K800-FND                             
                       MOVE SPACES   TO WS-PAIRED-REGN                          
                                        WS-C398-NUM-REGN-PAIRED                 
                    ELSE                                                        
                       MOVE 'Y'      TO WS-K800-FND                             
                       MOVE K800-NUM-JT-BALLOT-REGN   TO WS-PAIRED-REGN         
                                        WS-C398-NUM-REGN-PAIRED                 
                    END-IF                                                      
             WHEN   23                                                          
                    MOVE 'N'         TO WS-K800-FND                             
                    MOVE SPACES      TO WS-PAIRED-REGN                          
                                        WS-C398-NUM-REGN-PAIRED                 
             WHEN   OTHER                                                       
                    DISPLAY 'READ BP13K800 ERROR ' K800-NUM-REGN                
                    DISPLAY 'STATUS ' WS-K800-STATUS                            
                    MOVE WS-K800-STATUS TO RETURN-CODE                          
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
                                                                                
           END-EVALUATE.                                                        
                                                                                
       3200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       3300-GET-LETTER-DATE.                                                    
      ************************************************************              
                                                                                
           MOVE F200-DTE-ALLOC      TO   WS-DTE-LETTER.                         
                                                                                
           IF WS-DTE-LETTER = ZEROES                                            
              MOVE  SPACES          TO   WS-C398-PRT-DATE                       
           ELSE                                                                 
              MOVE F205-DTE-REQUEST       TO WS-DTE-LETTER                      
              IF K800-NUM-MGPS = 'P' OR 'C'                                     
                 IF F200-DTE-BKAPPMT-DATE-MGPS NOT = SPACES AND                 
                                                     LOW-VALUES                 
                    MOVE F200-DTE-BKAPPMT-DATE-MGPS                             
                                          TO  WS-DTE-LETTER-2                   
                 ELSE                                                           
                    MOVE K800-DTE-BK-APPT-MGPS TO WS-DTE-LETTER-2               
                 END-IF                                                         
              ELSE                                                              
                 IF F200-DTE-BKAPPMT-DATE NOT = SPACES AND LOW-VALUES           
                    MOVE F200-DTE-BKAPPMT-DATE                                  
                                         TO  WS-DTE-LETTER-2                    
                 ELSE                                                           
                    MOVE K800-DTE-BK-APPT   TO  WS-DTE-LETTER-2                 
                 END-IF                                                         
              END-IF                                                            
                                                                                
              IF WS-DTE-LETTER-2 IS NUMERIC                                     
                 COMPUTE WS-NUM-DTE-LETTER =                                    
                         FUNCTION INTEGER-OF-DATE(WS-DTE-LETTER-2)              
                 SUBTRACT 14         FROM   WS-NUM-DTE-LETTER                   
                 COMPUTE WS-DTE-LETTER-2 =                                      
                         FUNCTION DATE-OF-INTEGER(WS-NUM-DTE-LETTER)            
                 IF WS-DTE-LETTER-2 > F205-DTE-REQUEST                          
                    STRING WS-DTE-LETTER-2(7:2) '/'                             
                           WS-DTE-LETTER-2(5:2) '/'                             
                           WS-DTE-LETTER-2(1:4)                                 
                           DELIMITED BY SIZE INTO WS-C398-PRT-DATE              
                 ELSE                                                           
                    STRING F205-DTE-REQUEST(7:2) '/'                            
                           F205-DTE-REQUEST(5:2) '/'                            
                           F205-DTE-REQUEST(1:4)                                
                           DELIMITED BY SIZE INTO WS-C398-PRT-DATE              
                 END-IF                                                         
              ELSE                                                              
                 MOVE SPACES      TO WS-C398-PRT-DATE                           
              END-IF                                                            
           END-IF.                                                              
                                                                                
       3300-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       3400-PROCESS-BP13K820.                                                   
      ************************************************************              
                                                                                
           PERFORM 3410-START-BP13K820    THRU 3410-EXIT.                       
                                                                                
           IF WS-K820-FND = 'Y'                                                 
              IF K800-NUM-ALLO-SCHEME =  'MCP'                                  
                 MOVE   'Y'     TO WS-C398-MCPS-FRM                             
              END-IF                                                            
                                                                                
              IF (K800-NUM-ALLO-SCHEME =  'SAP'  AND                            
                 (K800-CDE-MCPS = 'M' OR 'C' OR 'P' OR 'B'))                    
                 MOVE   'S'     TO WS-C398-MCPS-FRM                             
              END-IF                                                            
                                                                                
              IF K800-NUM-FLAT-TYPE = '4P' OR '5P' OR 'SP'                      
                 MOVE   'Y'     TO WS-C398-MGLS-FRM                             
              END-IF                                                            
                                                                                
              IF K800-NUM-APPS NOT = SPACES AND LOW-VALUES                      
                 IF K800-NUM-APPS-ELIG-TAG NOT = 'P' AND 'H'                    
                     MOVE   'Y'       TO                                        
                             WS-C398-APPS-CERTF                                 
                 END-IF                                                         
              END-IF                                                            
                                                                                
              MOVE SPACES   TO  WS-HA1-WSP-STAT                                 
              IF K800-NUM-NRIC2 = SPACES OR LOW-VALUES                          
                 IF (WS-C398-DEATH-CERTF(1) = 'Y' OR                            
                    (WS-C398-DIVORCE-CERTF(1) = 'Y' OR 'S'))                    
                    MOVE 'Y'    TO  WS-HA1-WSP-STAT                             
                 END-IF                                                         
              END-IF                                                            
                                                                                
              MOVE SPACES   TO  WS-OC1-GT21                                     
              IF WS-C398-NRIC(6) = SPACES OR LOW-VALUES                         
                 IF WS-C398-AGE-OCCUPIER(5) >= 21                               
                     MOVE 'Y'  TO WS-OC1-GT21                                   
                 END-IF                                                         
              END-IF                                                            
                                                                                
              MOVE   '1'    TO  WS-C398-ESS-MBRS                                
                                                                                
              IF F200-DTE-BALLOT >= '201808'                                    
                 IF K800-NUM-ALLO-SCHEME = 'PA '                                
                    IF WS-HA1-WSP-STAT = 'Y' AND                                
                       WS-OC1-GT21     = 'Y'                                    
                       MOVE '2'    TO WS-C398-ESS-MBRS                          
                    ELSE                                                        
                       MOVE '1'    TO WS-C398-ESS-MBRS                          
                    END-IF                                                      
                 ELSE                                                           
                    IF K800-NUM-ALLO-SCHEME = 'FSH'                             
                       IF WS-HA1-WSP-STAT = 'Y' AND                             
                          WS-OC1-GT21     = 'Y'                                 
                          MOVE '4' TO WS-C398-ESS-MBRS                          
                       ELSE                                                     
                          MOVE '3' TO WS-C398-ESS-MBRS                          
                       END-IF                                                   
                    END-IF                                                      
                 END-IF                                                         
                 IF K800-NUM-ALLO-SCHEME = 'FTS' OR 'STS' OR 'SAP'              
                    IF K800-NUM-ELIG-SCHEME = 'SSC' OR 'SSE' OR                 
                                              'NCS' OR 'NSC'                    
                       MOVE SPACES TO WS-C398-ESS-MBRS                          
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
                                                                                
              IF K800-NUM-ELIG-SCHEME = 'OR '                                   
                 MOVE  'Y'  TO  WS-C398-ORPHANS-DECL                            
              END-IF                                                            
                                                                                
              IF K800-NUM-APPLN-TYPE = 'I'                                      
                 MOVE  'Y'  TO  WS-C398-APPLN-FRM                               
              END-IF                                                            
                                                                                
              IF WS-C398-LETTER-CNT < 2                                         
                ADD  1      TO  WS-C398-LETTER-CNT                              
              END-IF                                                            
                                                                                
              MOVE SPACES               TO  BP13K813-REC                        
                                                                                
              IF K800-NUM-ALLO-CAT = 'BTO'                                      
                 MOVE K800-NUM-BTO-ZONE TO  K813-NUM-ZONE                       
              ELSE                                                              
                 MOVE K800-NUM-NEW-TOWN TO  K813-NUM-ZONE                       
              END-IF                                                            
              MOVE K800-NUM-FLAT-TYPE   TO  K813-NUM-FLAT-TYPE                  
              MOVE K800-DTE-BALLOT      TO  K813-DTE-BALLOT                     
                                                                                
              PERFORM 3405-READ-K813 THRU 3405-EXIT                             
                                                                                
              IF K800-NUM-ALLO-CAT = 'BTO' OR 'SBF'                             
                 IF K800-NUM-MGPS = 'P' OR 'C'                                  
                    CALL 'BP13CR49'                                             
                 ELSE                                                           
                    IF K800-NUM-ALLO-SCHEME = 'GRO'                             
                       IF K800-NUM-ALLO-CAT = 'BTO'                             
                          CALL 'BP13CR50'                                       
                       ELSE                                                     
                          CALL 'BP13CR51'                                       
                       END-IF                                                   
                    ELSE                                                        
                       CALL 'BP13CR48'                                          
                    END-IF                                                      
                 END-IF                                                         
              END-IF                                                            
                                                                                
              IF K800-NUM-ALLO-CAT = 'ROF' OR 'OBF'                             
                 CALL 'BP13CR48'                                                
              END-IF                                                            
                                                                                
              IF K800-NUM-ALLO-CAT = 'NPL'                                      
                 CALL 'BP13CR26'                                                
              END-IF                                                            
                                                                                
              IF F200-DTE-BALLOT >= '201808'                                    
                 CALL 'BP13CR5B'                                                
              ELSE                                                              
                 IF F200-NUM-PRINT-TAG = 'T' OR                                 
                    F200-DTE-BALLOT >= '201608'                                 
                    CALL 'BP13CR2B'                                             
                 ELSE                                                           
                    CALL 'BP13CR1B'                                             
                 END-IF                                                         
              END-IF                                                            
                                                                                
              IF K800-DTE-BALLOT >= '201109' AND WS-HFE NOT = 'Y'               
                 CALL 'BP13CR1D'                                                
              END-IF                                                            
                                                                                
              IF K800-NUM-ALLO-CAT NOT = 'NPL'                                  
                 CALL 'BP13CR1C'                                                
              END-IF                                                            
                                                                                
           END-IF.                                                              
                                                                                
       3400-EXIT.                                                               
           EXIT.                                                                
                                                                                
       3405-READ-K813.                                                          
           READ BP13K813.                                                       
           IF WS-K813-STATUS = ZERO                                             
              MOVE K813-NME-SITE TO WS-C245-NT-ZONE-NAME                        
           ELSE                                                                 
              MOVE SPACES        TO WS-C245-NT-ZONE-NAME                        
           END-IF.                                                              
                                                                                
       3405-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ** PRINT APPLICATION FORMS AND LOAN LETTER                                
      *-------------------------------------------------------------            
       3410-START-BP13K820.                                                     
      *-------------------------------------------------------------            
                                                                                
           START BP13K820 KEY >= K820-KEY-FLD.                                  
                                                                                
           EVALUATE WS-K820-STATUS                                              
             WHEN   00                                                          
                    PERFORM 3420-READNEXT-BP13K820 THRU 3420-EXIT               
                       UNTIL K820-NUM-REGN NOT = WS-NUM-REGN                    
                        OR   WS-K820-EOF = 'Y'                                  
             WHEN   23                                                          
                    MOVE 'N' TO WS-K820-FND                                     
             WHEN   46                                                          
                    MOVE 'Y' TO WS-K820-EOF                                     
             WHEN   OTHER                                                       
                    DISPLAY 'ERROR BROWSE BP13K820, STAT = '                    
                           K820-KEY-FLD ' ' WS-K820-STATUS                      
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       3410-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       3420-READNEXT-BP13K820.                                                  
      *---------------------------------------------------------------*         
           READ BP13K820 NEXT                                                   
                         AT END MOVE 'Y' TO WS-K820-EOF                         
                         GO TO 3420-EXIT.                                       
                                                                                
           EVALUATE WS-K820-STATUS                                              
             WHEN 00                                                            
                  IF K820-NUM-REGN = WS-NUM-REGN                                
                     ADD    1   TO WS-NRIC-CNT                                  
                     PERFORM 3430-MOVE-K820-FLDS   THRU 3430-EXIT               
                     ADD    1   TO WS-K820-READ-CNT                             
                     MOVE 'Y'   TO WS-K820-FND                                  
                END-IF                                                          
             WHEN 23                                                            
                  MOVE 'Y'   TO WS-K820-FND                                     
             WHEN 46                                                            
                  MOVE 'Y'   TO WS-K820-EOF                                     
             WHEN OTHER                                                         
                DISPLAY 'BP18K820 - READNXT ERROR, STATUS: '                    
                                                     WS-K820-STATUS             
                MOVE     WS-K820-STATUS    TO RETURN-CODE                       
                PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                       
           END-EVALUATE.                                                        
                                                                                
       3420-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       3430-MOVE-K820-FLDS.                                                     
      *---------------------------------------------------------------*         
      *-----------------------------------------*                               
      * CALCULATE COMPLETED AGE FROM BIRTH DATE *                               
      *-----------------------------------------*                               
           IF K820-DTE-BIRTH IS NOT NUMERIC                                     
              MOVE ZEROES                TO K820-DTE-BIRTH                      
           END-IF.                                                              
                                                                                
           MOVE K820-DTE-BIRTH        TO WS-BIRTH-DATE.                         
           COMPUTE WS-AGE  =  WS-DATE  -  WS-BIRTH-DATE.                        
                                                                                
           MOVE K800-DTE-REGN         TO WS-DTE-APPLN.                          
           COMPUTE WS-AGE2 =  WS-DTE-APPLN - WS-BIRTH-DATE.                     
      *---------------------------------------------------*                     
      * INITIALIZE BP13FP00 RECORD                        *                     
      *---------------------------------------------------*                     
           MOVE SPACES        TO BP13FP00-REC.                                  
           INITIALIZE            BP13FP00-REC.                                  
                                                                                
           MOVE K820-NUM-REGN TO FP00-NUM-REGN.                                 
           MOVE K820-NUM-NRIC TO FP00-NUM-NRIC.                                 
                                                                                
      *---------------------------------------------------*                     
      * IF NRIC FOUND IN BP13K800, PERFORM APPLICANT PARA *                     
      * ELSE PERFORM OCCUPIER PARA                        *                     
      *---------------------------------------------------*                     
           IF  (K820-NUM-NRIC  =  K800-NUM-NRIC1)  OR                           
               (K820-NUM-NRIC  =  K800-NUM-NRIC2)  OR                           
               (K820-NUM-NRIC  =  K800-NUM-NRIC3)  OR                           
               (K820-NUM-NRIC  =  K800-NUM-NRIC4)                               
               PERFORM 7000-READ-BP13K734         THRU 7000-EXIT                
               PERFORM 3440-PROCESS-APPLICANT     THRU 3440-EXIT                
               IF K800-NUM-ALLO-CAT NOT = 'NPL'                                 
                  PERFORM 3500-CREATE-FP00-APPL   THRU 3500-EXIT                
               END-IF                                                           
           ELSE                                                                 
               PERFORM 7000-READ-BP13K734         THRU 7000-EXIT                
               PERFORM 3450-PROCESS-OCCUPIER      THRU 3450-EXIT                
               IF K800-NUM-ALLO-CAT NOT = 'NPL'                                 
                  PERFORM 3550-CREATE-FP00-OCCUP  THRU 3550-EXIT                
               END-IF                                                           
           END-IF.                                                              
                                                                                
       3430-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       3440-PROCESS-APPLICANT.                                                  
      *---------------------------------------------------------------*         
           IF  (K820-NUM-NRIC = K800-NUM-NRIC1)                                 
                MOVE  1     TO WS-APPL-CNT                                      
           END-IF.                                                              
                                                                                
           IF  (K820-NUM-NRIC = K800-NUM-NRIC2)                                 
                MOVE  2     TO WS-APPL-CNT                                      
           END-IF.                                                              
                                                                                
           IF  (K820-NUM-NRIC = K800-NUM-NRIC3)                                 
                MOVE  3     TO WS-APPL-CNT                                      
           END-IF.                                                              
                                                                                
           IF  (K820-NUM-NRIC = K800-NUM-NRIC4)                                 
                MOVE  4     TO WS-APPL-CNT                                      
           END-IF.                                                              
                                                                                
      *------------------------------------*                                    
      * NRIC, NAME, AGE AND OCCUPIER CODE  *                                    
      *------------------------------------*                                    
           MOVE K820-NUM-NRIC     TO                                            
                             WS-C398-NRIC(WS-APPL-CNT).                         
           MOVE   'A'             TO                                            
                             WS-C398-CDE-OCCUPIER(WS-APPL-CNT).                 
           MOVE   K820-NME-OCCP   TO                                            
                             WS-C398-NME-OCCUPIER(WS-APPL-CNT).                 
           MOVE   K820-NUM-SEX    TO  WS-C398-GENDER(WS-APPL-CNT).              
           MOVE   WS-AGE-CMPLTD   TO                                            
                             WS-C398-AGE-OCCUPIER(WS-APPL-CNT).                 
           MOVE   WS-AGE-CMPLTD2  TO                                            
                             WS-C398-AGE2-OCCUPIER(WS-APPL-CNT).                
           IF K800-NUM-PPS-ELIG = 'E'                                           
              MOVE   K820-NUM-PPS-PREGNANT                                      
                                  TO WS-C398-PPS-ELIG(WS-APPL-CNT)              
           ELSE                                                                 
              MOVE SPACES         TO WS-C398-PPS-ELIG(WS-APPL-CNT)              
           END-IF.                                                              
                                                                                
           IF K800-NUM-DEFER-INCOME-ASSESS = 'Y' AND                            
              K820-NUM-NS-LT12MTH = 'Y'                                         
              MOVE 'Y'            TO WS-C398-NS-LT12MTH(WS-APPL-CNT)            
           ELSE                                                                 
              MOVE SPACES         TO WS-C398-NS-LT12MTH(WS-APPL-CNT)            
           END-IF.                                                              
                                                                                
           IF K800-NUM-DEFER-INCOME-ASSESS = 'Y' AND                            
              K820-NUM-EDN-LT12MTH = 'Y'                                        
              MOVE 'Y'            TO WS-C398-EDN-LT12MTH(WS-APPL-CNT)           
           ELSE                                                                 
              MOVE SPACES         TO WS-C398-EDN-LT12MTH(WS-APPL-CNT)           
           END-IF.                                                              
                                                                                
           PERFORM 7100-CHECK-BP04K010    THRU 7100-EXIT.                       
                                                                                
      *-------------------------------*                                         
      * IDENTITY CARD                 *                                         
      *-------------------------------*                                         
           MOVE   'Y'             TO                                            
                             WS-C398-ID-CARD(WS-APPL-CNT).                      
                                                                                
      *-------------------------------*                                         
      * RELATIONSHIP                  *                                         
      *-------------------------------*                                         
           MOVE K820-NUM-RELATIONSHIP TO                                        
                             WS-C398-RELATIONSHIP(WS-APPL-CNT).                 
                                                                                
      *-------------------------------*                                         
      * CITIZENSHIP                   *                                         
      *-------------------------------*                                         
           MOVE K820-NUM-CITIZENSHIP TO                                         
                             WS-C398-CITIZENSHIP(WS-APPL-CNT).                  
                                                                                
      *-------------------------------*                                         
      * DATE OF BIRTH                 *                                         
      *-------------------------------*                                         
           MOVE K820-DTE-BIRTH       TO                                         
                             WS-C398-DOB(WS-APPL-CNT).                          
                                                                                
      *------------------------------------*                                    
      * CHECK FOR SPOUSE OR FIANCE/FIANCEE                                      
      *------------------------------------*                                    
           IF K820-NUM-RELATIONSHIP = '09'                                      
              MOVE 'Y'            TO WS-C398-SP-FI(WS-APPL-CNT)                 
           ELSE                                                                 
              IF K820-NUM-NRIC-SPOUSE NOT = SPACES AND LOW-VALUES               
                 IF K820-NUM-NRIC-SPOUSE = K800-NUM-NRIC1 OR                    
                                           K800-NUM-NRIC2 OR                    
                                           K800-NUM-NRIC3 OR                    
                                           K800-NUM-NRIC4                       
                    MOVE 'Y'            TO WS-C398-SP-FI(WS-APPL-CNT)           
                 ELSE                                                           
                    MOVE SPACES         TO WS-C398-SP-FI(WS-APPL-CNT)           
                 END-IF                                                         
              ELSE                                                              
                 MOVE SPACES         TO WS-C398-SP-FI(WS-APPL-CNT)              
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *-------------------------------*                                         
      * BIRTH CERTIFICATE             *                                         
      *-------------------------------*                                         
           IF K820-NUM-RELATIONSHIP = '41' OR '39' OR '06'                      
               MOVE   'Y'         TO                                            
                             WS-C398-BIRTH-CERTF(WS-APPL-CNT)                   
           END-IF.                                                              
                                                                                
           IF K820-NUM-RELATIONSHIP = '02' OR '12' OR '38'                      
               MOVE   'Y'         TO                                            
                             WS-C398-BIRTH-CERTF(1)                             
           END-IF.                                                              
                                                                                
           IF K800-NUM-ELIG-SCHEME = 'OR '                                      
               MOVE   'Y'         TO                                            
                             WS-C398-BIRTH-CERTF(WS-APPL-CNT)                   
           END-IF.                                                              
                                                                                
           IF K800-NUM-ALLO-SCHEME =  'MTF'                                     
              IF K820-NUM-RELATIONSHIP = '02' OR '12' OR '01' OR                
                                         '43' OR '45'                           
                 MOVE   'Y'       TO                                            
                             WS-C398-BIRTH-CERTF(WS-APPL-CNT)                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *-------------------------------*                                         
      * MARRIAGE CERTIFICATE          *                                         
      *-------------------------------*                                         
           IF K820-NUM-MARITAL-STATUS  =  '2' OR 'M'                            
              MOVE 'N'           TO WS-MRG-CHK-SKIP                             
                                    WS-MRG-TBL-FND                              
              PERFORM VARYING WS-IDX3 FROM 1 BY 1 UNTIL                         
                WS-IDX3 > 12  OR                                                
                WS-NUM-CSTMR(WS-IDX3) = SPACES OR LOW-VALUES                    
                IF K820-NUM-NRIC = WS-NUM-NRIC-WIFE(WS-IDX3) OR                 
                   K820-NUM-NRIC = WS-NUM-NRIC-HSBND(WS-IDX3)                   
                   MOVE 'Y'      TO WS-MRG-CHK-SKIP                             
                   MOVE 13       TO WS-IDX3                                     
                END-IF                                                          
              END-PERFORM                                                       
              IF WS-MRG-CHK-SKIP = 'Y'                                          
                 MOVE   'N'  TO  WS-C398-MARRIAGE-CERTF(WS-APPL-CNT)            
                 MOVE   'Y'  TO  WS-MRG-TBL-FND                                 
              ELSE                                                              
                 PERFORM 7300-LINK-BE01C812 THRU 7300-EXIT                      
                 IF WS-MRG-TBL-FND = 'Y'                                        
                    MOVE   'N'  TO  WS-C398-MARRIAGE-CERTF(WS-APPL-CNT)         
                 ELSE                                                           
                    MOVE   'Y'  TO  WS-C398-MARRIAGE-CERTF(WS-APPL-CNT)         
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *----------------------------------*                                      
      * PAYSLIP/UNEMPLOYMENT DECLARATION *                                      
      *----------------------------------*                                      
           IF K820-AMT-INCOME  >  0                                             
               MOVE   'Y'         TO                                            
                             WS-C398-PAY-SLIP(WS-APPL-CNT)                      
           ELSE                                                                 
               IF (WS-AGE-CMPLTD >= 31)  AND (WS-AGE-CMPLTD <= 55)              
                  MOVE   'Y'      TO                                            
                             WS-C398-UNEMPLYMNT-DECL(WS-APPL-CNT)               
               ELSE                                                             
                  IF (WS-AGE-CMPLTD >= 18)  AND (WS-AGE-CMPLTD <= 30)           
                     MOVE   'Y'      TO                                         
                             WS-C398-UNEMPLYMNT-DECL(WS-APPL-CNT)               
                             WS-C398-STUDENT-PASS(WS-APPL-CNT)                  
                  END-IF                                                        
               END-IF                                                           
           END-IF.                                                              
                                                                                
           MOVE WS-EMP-STATUS       TO WS-C398-EMP-STAT(WS-APPL-CNT)            
           MOVE WS-DTE-INCOME1      TO WS-C398-DTE-INCOME1(WS-APPL-CNT).        
           MOVE WS-DTE-INCOME2      TO WS-C398-DTE-INCOME2(WS-APPL-CNT).        
           MOVE WS-NUM-INCOME1      TO WS-C398-NUM-INCOME1(WS-APPL-CNT).        
           MOVE WS-NUM-INCOME2      TO WS-C398-NUM-INCOME2(WS-APPL-CNT).        
           MOVE WS-NUM-INCOME3      TO WS-C398-NUM-INCOME3(WS-APPL-CNT).        
                                                                                
      *-------------------------------*                                         
      * DEATH CERTIFICATE             *                                         
      *-------------------------------*                                         
           IF K820-NUM-MARITAL-STATUS  =  '3' OR 'W'                            
               MOVE   'Y'         TO                                            
                             WS-C398-DEATH-CERTF(WS-APPL-CNT)                   
               MOVE K820-NUM-NRIC-SPOUSE   TO                                   
                             WS-C398-NRIC-DTH-CERTF(WS-APPL-CNT)                
               MOVE K820-NME-SPOUSE        TO                                   
                             WS-C398-NME-DTH-CERTF(WS-APPL-CNT)                 
           END-IF.                                                              
                                                                                
      *-------------------------------*                                         
      * DIVORCE CERTIFICATE           *                                         
      *-------------------------------*                                         
           IF K820-NUM-MARITAL-STATUS  =  '4' OR 'D'                            
               MOVE   'Y'         TO                                            
                             WS-C398-DIVORCE-CERTF(WS-APPL-CNT)                 
           END-IF.                                                              
                                                                                
           MOVE K820-NUM-DIVORCE-FNLJDGMT TO                                    
                             WS-C398-DIVORCE-FNLJDGMT(WS-APPL-CNT)              
                                                                                
      *-------------------------------*                                         
      * DEED OF SEPATION              *                                         
      *-------------------------------*                                         
           IF K820-NUM-MARITAL-STATUS  =  '5' OR 'P'                            
               MOVE   'S'         TO                                            
                             WS-C398-DIVORCE-CERTF(WS-APPL-CNT)                 
           END-IF.                                                              
                                                                                
      *-------------------------------*                                         
      * PHOTOGRAPH                    *                                         
      *-------------------------------*                                         
           MOVE   'Y'             TO                                            
                             WS-C398-PHOTOGRAPH(WS-APPL-CNT).                   
                                                                                
       3440-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *---------------------------------------------------------------*         
       3450-PROCESS-OCCUPIER.                                                   
      *---------------------------------------------------------------*         
           ADD   1     TO WS-OCCP-CNT.                                          
      *------------------------------------*                                    
      * NRIC, NAME, AGE AND OCCUPIER CODE  *                                    
      *------------------------------------*                                    
           MOVE K820-NUM-NRIC     TO                                            
                             WS-C398-NRIC(WS-OCCP-CNT).                         
           MOVE   'O'             TO                                            
                             WS-C398-CDE-OCCUPIER(WS-OCCP-CNT).                 
           MOVE   K820-NME-OCCP   TO                                            
                             WS-C398-NME-OCCUPIER(WS-OCCP-CNT).                 
           MOVE   K820-NUM-SEX    TO  WS-C398-GENDER(WS-OCCP-CNT).              
           MOVE   WS-AGE-CMPLTD   TO                                            
                             WS-C398-AGE-OCCUPIER(WS-OCCP-CNT).                 
           MOVE   WS-AGE-CMPLTD2  TO                                            
                             WS-C398-AGE2-OCCUPIER(WS-OCCP-CNT).                
           MOVE   SPACES                                                        
                                  TO WS-C398-PPS-ELIG(WS-OCCP-CNT)              
                                     WS-C398-DEB-OCCUPIER(WS-OCCP-CNT).         
                                                                                
                                                                                
           IF K800-NUM-PPS-ELIG = 'E'                                           
              MOVE   K820-NUM-PPS-PREGNANT                                      
                                  TO WS-C398-PPS-ELIG(WS-OCCP-CNT)              
           END-IF.                                                              
                                                                                
           MOVE SPACES            TO WS-C398-EDN-LT12MTH(WS-OCCP-CNT)           
                                     WS-C398-NS-LT12MTH(WS-OCCP-CNT).           
                                                                                
      *-------------------------------*                                         
      * IDENTITY CARD                 *                                         
      *-------------------------------*                                         
           IF (K820-NUM-CITIZENSHIP = '10' OR '20')  AND                        
              (WS-AGE-CMPLTD >= 15)                                             
              MOVE   'Y'          TO                                            
                             WS-C398-ID-CARD(WS-OCCP-CNT)                       
           END-IF.                                                              
                                                                                
      *-------------------------------*                                         
      * RELATIONSHIP                  *                                         
      *-------------------------------*                                         
           MOVE K820-NUM-RELATIONSHIP TO                                        
                             WS-C398-RELATIONSHIP(WS-OCCP-CNT).                 
                                                                                
      *-------------------------------*                                         
      * CITIZENSHIP                   *                                         
      *-------------------------------*                                         
           MOVE K820-NUM-CITIZENSHIP TO                                         
                             WS-C398-CITIZENSHIP(WS-OCCP-CNT).                  
                                                                                
      *-------------------------------*                                         
      * DATE OF BIRTH                 *                                         
      *-------------------------------*                                         
           MOVE K820-DTE-BIRTH       TO                                         
                             WS-C398-DOB(WS-OCCP-CNT).                          
                                                                                
      *------------------------------------*                                    
      * CHECK FOR SPOUSE OR FIANCE/FIANCEE                                      
      *------------------------------------*                                    
           IF K820-NUM-RELATIONSHIP = '09'                                      
              MOVE 'Y'            TO WS-C398-SP-FI(WS-OCCP-CNT)                 
           ELSE                                                                 
              IF K820-NUM-NRIC-SPOUSE NOT = SPACES AND LOW-VALUES               
                 IF K820-NUM-NRIC-SPOUSE = K800-NUM-NRIC1 OR                    
                                           K800-NUM-NRIC2 OR                    
                                           K800-NUM-NRIC3 OR                    
                                           K800-NUM-NRIC4                       
                    MOVE 'Y'            TO WS-C398-SP-FI(WS-OCCP-CNT)           
                 ELSE                                                           
                    MOVE SPACES         TO WS-C398-SP-FI(WS-OCCP-CNT)           
                 END-IF                                                         
              ELSE                                                              
                 MOVE SPACES         TO WS-C398-SP-FI(WS-OCCP-CNT)              
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *-------------------------------*                                         
      * EMPLOYMENT PASS/WORK PERMIT   *                                         
      *-------------------------------*                                         
           IF (K820-NUM-CITIZENSHIP  NOT =  '10')                               
              MOVE   'Y'          TO                                            
                             WS-C398-PASS-PERMIT(WS-OCCP-CNT)                   
           END-IF.                                                              
                                                                                
      *-------------------------------*                                         
      * BIRTH CERTIFICATE             *                                         
      *-------------------------------*                                         
           IF K820-NUM-RELATIONSHIP = '41' OR '39' OR '06'                      
               MOVE   'Y'         TO                                            
                             WS-C398-BIRTH-CERTF(WS-OCCP-CNT)                   
           END-IF.                                                              
                                                                                
           IF K820-NUM-RELATIONSHIP = '02' OR '12' OR '38'                      
               MOVE   'Y'         TO                                            
                             WS-C398-BIRTH-CERTF(1)                             
           END-IF.                                                              
                                                                                
           IF K800-NUM-ELIG-SCHEME = 'OR '                                      
               MOVE   'Y'         TO                                            
                             WS-C398-BIRTH-CERTF(WS-OCCP-CNT)                   
           END-IF.                                                              
                                                                                
           IF K800-NUM-ALLO-SCHEME =  'MTF'                                     
              IF K820-NUM-RELATIONSHIP = '02' OR '12' OR '01' OR                
                                         '43' OR '45'                           
                 MOVE   'Y'       TO                                            
                             WS-C398-BIRTH-CERTF(WS-OCCP-CNT)                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *-------------------------------*                                         
      * MARRIAGE CERTIFICATE          *                                         
      *-------------------------------*                                         
           IF K820-NUM-MARITAL-STATUS  =  '2' OR 'M'                            
              MOVE 'N'           TO WS-MRG-CHK-SKIP                             
                                    WS-MRG-TBL-FND                              
              PERFORM VARYING WS-IDX3 FROM 1 BY 1 UNTIL                         
                WS-IDX3 > 12  OR                                                
                WS-NUM-CSTMR(WS-IDX3) = SPACES OR LOW-VALUES                    
                IF K820-NUM-NRIC = WS-NUM-NRIC-WIFE(WS-IDX3) OR                 
                   K820-NUM-NRIC = WS-NUM-NRIC-HSBND(WS-IDX3)                   
                   MOVE 'Y'      TO WS-MRG-CHK-SKIP                             
                   MOVE 13       TO WS-IDX3                                     
                END-IF                                                          
              END-PERFORM                                                       
              IF WS-MRG-CHK-SKIP = 'Y'                                          
                 MOVE   'N'  TO  WS-C398-MARRIAGE-CERTF(WS-OCCP-CNT)            
                 MOVE   'Y'  TO  WS-MRG-TBL-FND                                 
              ELSE                                                              
                 PERFORM 7300-LINK-BE01C812 THRU 7300-EXIT                      
                 IF WS-MRG-TBL-FND = 'Y'                                        
                    MOVE   'N'  TO  WS-C398-MARRIAGE-CERTF(WS-OCCP-CNT)         
                 ELSE                                                           
                    MOVE   'Y'  TO  WS-C398-MARRIAGE-CERTF(WS-OCCP-CNT)         
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *----------------------------------*                                      
      * PAYSLIP/UNEMPLOYMENT DECLARATION *                                      
      *----------------------------------*                                      
           IF K820-AMT-INCOME  >  0                                             
               MOVE   'Y'         TO                                            
                             WS-C398-PAY-SLIP(WS-OCCP-CNT)                      
           ELSE                                                                 
               IF (WS-AGE-CMPLTD >= 31)  AND (WS-AGE-CMPLTD <= 55)              
                  MOVE   'Y'      TO                                            
                             WS-C398-UNEMPLYMNT-DECL(WS-OCCP-CNT)               
               ELSE                                                             
                  IF (WS-AGE-CMPLTD >= 18)  AND (WS-AGE-CMPLTD <= 30)           
                     MOVE   'Y'   TO                                            
                             WS-C398-UNEMPLYMNT-DECL(WS-OCCP-CNT)               
                             WS-C398-STUDENT-PASS(WS-OCCP-CNT)                  
                  END-IF                                                        
               END-IF                                                           
           END-IF.                                                              
                                                                                
           MOVE WS-EMP-STATUS       TO WS-C398-EMP-STAT(WS-OCCP-CNT).           
           MOVE WS-DTE-INCOME1      TO WS-C398-DTE-INCOME1(WS-OCCP-CNT).        
           MOVE WS-DTE-INCOME2      TO WS-C398-DTE-INCOME2(WS-OCCP-CNT).        
           MOVE WS-NUM-INCOME1      TO WS-C398-NUM-INCOME1(WS-OCCP-CNT).        
           MOVE WS-NUM-INCOME2      TO WS-C398-NUM-INCOME2(WS-OCCP-CNT).        
           MOVE WS-NUM-INCOME3      TO WS-C398-NUM-INCOME3(WS-OCCP-CNT).        
                                                                                
      *-------------------------------*                                         
      * DEATH CERTIFICATE             *                                         
      *-------------------------------*                                         
           IF K820-NUM-MARITAL-STATUS  =  '3' OR 'W'                            
               MOVE   'Y'         TO                                            
                             WS-C398-DEATH-CERTF(WS-OCCP-CNT)                   
               MOVE K820-NUM-NRIC-SPOUSE   TO                                   
                             WS-C398-NRIC-DTH-CERTF(WS-OCCP-CNT)                
               MOVE K820-NME-SPOUSE        TO                                   
                             WS-C398-NME-DTH-CERTF(WS-OCCP-CNT)                 
           END-IF.                                                              
                                                                                
      *-------------------------------*                                         
      * DIVORCE CERTIFICATE           *                                         
      *-------------------------------*                                         
           IF K820-NUM-MARITAL-STATUS  =  '4' OR 'D'                            
               MOVE   'Y'         TO                                            
                             WS-C398-DIVORCE-CERTF(WS-OCCP-CNT)                 
           END-IF.                                                              
                                                                                
           IF K820-NUM-MARITAL-STATUS  =  '5' OR 'P'                            
               MOVE   'S'         TO                                            
                             WS-C398-DIVORCE-CERTF(WS-OCCP-CNT)                 
           END-IF.                                                              
                                                                                
           MOVE K820-NUM-DIVORCE-FNLJDGMT TO                                    
                             WS-C398-DIVORCE-FNLJDGMT(WS-OCCP-CNT)              
                                                                                
      *-------------------------------*                                         
      * MARRIAGE CONSENT OF MINOR     *                                         
      *-------------------------------*                                         
           IF (K820-NUM-RELATIONSHIP  =  '09')  AND                             
              (WS-AGE-CMPLTD >= 18  AND  WS-AGE-CMPLTD < 21)                    
               MOVE   'Y'         TO                                            
                             WS-C398-MARRIAGE-CONSENT(WS-OCCP-CNT)              
           END-IF.                                                              
                                                                                
       3450-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       3500-CREATE-FP00-APPL.                                                   
      ************************************************************              
                                                                                
           MOVE ZEROES TO WS-DOC-CNT.                                           
                                                                                
      *------------------------------------*                                    
      *   STOP PENDING OF NRIC IN DOC REQ                                       
      *------------------------------------*                                    
      *** NRIC                                                                  
      *    ADD 1            TO WS-DOC-CNT.                                      
      *    MOVE '001'       TO FP00-NUM-DOC     (WS-DOC-CNT).                   
      *    MOVE  'Y'        TO FP00-NUM-DOC-REQ (WS-DOC-CNT).                   
      *    MOVE  'N'        TO FP00-NUM-DOC-RECVD(WS-DOC-CNT).                  
                                                                                
      *** BIRTH CERTIFICATE                                                     
                                                                                
           IF K820-NUM-RELATIONSHIP = '41' OR '39' OR '06'                      
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '002'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE 'N'      TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
           IF K800-NUM-ALLO-SCHEME =  'MTF'                                     
              IF K820-NUM-RELATIONSHIP = '02' OR '12' OR '01' OR                
                                         '43' OR '45'                           
                 ADD 1      TO WS-DOC-CNT                                       
                 MOVE '002' TO FP00-NUM-DOC     (WS-DOC-CNT)                    
                 MOVE 'Y'   TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
                 MOVE 'N'   TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *** MARRIAGE CERTIFICATE                                                  
           IF K820-NUM-MARITAL-STATUS  =  '2' OR 'M'                            
              IF WS-MRG-TBL-FND = 'N'                                           
                 ADD 1       TO WS-DOC-CNT                                      
                 MOVE '003'  TO FP00-NUM-DOC     (WS-DOC-CNT)                   
                 MOVE  'Y'   TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                   
                 MOVE  'N'   TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *** PAYSLIP                                                               
      **TO GET INCOME AMOUNT IN BP13K734**                                      
           IF WS-AHG-APPLN = 'Y'                                                
              MOVE ZEROES                    TO WS-INC-CTR2                     
              MOVE K800-DTE-REGN(1:6)        TO WS-DTE-REGN                     
              ADD     -1                     TO WS-DTE-REGN-CCYY                
              MOVE K800-DTE-REGN(5:2)        TO WS-INC-CTR                      
              PERFORM VARYING WS-INC-CTR FROM WS-INC-CTR BY 1 UNTIL             
                              WS-INC-CTR2 > 12                                  
                ADD 1           TO WS-DOC-CNT                                   
                                   WS-INC-CTR2                                  
                MOVE '004'      TO FP00-NUM-DOC      (WS-DOC-CNT)               
                MOVE 'Y'        TO FP00-NUM-DOC-REQ  (WS-DOC-CNT)               
                MOVE 'N'        TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)               
                IF WS-INC-CTR = 13                                              
                   ADD  1       TO WS-DTE-REGN-CCYY                             
                   MOVE 1       TO WS-INC-CTR                                   
                END-IF                                                          
                STRING WS-DTE-REGN-CCYY WS-INC-CTR                              
                       DELIMITED BY SIZE                                        
                              INTO FP00-NUM-DOC-DATE (WS-DOC-CNT)               
                END-STRING                                                      
              END-PERFORM                                                       
              MOVE K800-DTE-REGN(1:6)        TO WS-DTE-REGN                     
              ADD     -1                     TO WS-DTE-REGN-CCYY                
              MOVE K800-DTE-REGN(5:2)        TO WS-INC-CTR                      
              COMPUTE WS-INC-CTR = WS-INC-CTR - 2                               
              IF WS-INC-CTR = 0 OR WS-INC-CTR < 0                               
                 ADD 12      TO  WS-INC-CTR                                     
              END-IF                                                            
              ADD 1      TO WS-DOC-CNT                                          
              MOVE '043' TO FP00-NUM-DOC     (WS-DOC-CNT)                       
              MOVE  'Y'  TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                       
              MOVE  'N'  TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                      
              STRING WS-DTE-REGN-CCYY WS-INC-CTR DELIMITED BY SIZE              
                     INTO FP00-NUM-DOC-DATE(WS-DOC-CNT)                         
              END-STRING                                                        
              ADD 1      TO WS-DOC-CNT                                          
              MOVE '044' TO FP00-NUM-DOC     (WS-DOC-CNT)                       
              MOVE  'Y'  TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                       
              MOVE  'N'  TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                      
              STRING WS-DTE-REGN-CCYY '01' DELIMITED BY SIZE                    
                     INTO FP00-NUM-DOC-DATE(WS-DOC-CNT)                         
              END-STRING                                                        
           ELSE                                                                 
            PERFORM VARYING WS-IDX1 FROM 1 BY 1 UNTIL WS-IDX1 > 12              
             IF (K734-DTE-INCOME(WS-IDX1) NOT = SPACES AND LOW-VALUES           
                                           AND ZEROES)                          
                IF (K734-NUM-INCOME(WS-IDX1) = ZEROES) AND                      
                   (K734-NUM-INCOME(1) NOT = SPACES AND LOW-VALUES              
                                          AND ZEROES) AND                       
                   (K734-NUM-EMPLY-STATUS = '5  ' OR '7  ' OR '9  ')            
                   ADD 1           TO WS-DOC-CNT                                
                   MOVE '004'      TO FP00-NUM-DOC      (WS-DOC-CNT)            
                   MOVE 'Y'        TO FP00-NUM-DOC-REQ  (WS-DOC-CNT)            
                   MOVE 'N'        TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)            
                   MOVE K734-DTE-INCOME(WS-IDX1)                                
                              TO FP00-NUM-DOC-DATE (WS-DOC-CNT)                 
                ELSE                                                            
                   ADD 1           TO WS-DOC-CNT                                
                   MOVE '004'      TO FP00-NUM-DOC      (WS-DOC-CNT)            
                   MOVE 'Y'        TO FP00-NUM-DOC-REQ  (WS-DOC-CNT)            
                   MOVE 'N'        TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)            
                   MOVE K734-DTE-INCOME(WS-IDX1)                                
                         TO FP00-NUM-DOC-DATE (WS-DOC-CNT)                      
                END-IF                                                          
             END-IF                                                             
            END-PERFORM                                                         
           END-IF.                                                              
                                                                                
      *** DECLARATION OF GROSS MONTHLY INCOME DETAILS                           
           ADD 1      TO WS-DOC-CNT.                                            
           MOVE '042' TO FP00-NUM-DOC     (WS-DOC-CNT).                         
           MOVE  'Y'  TO FP00-NUM-DOC-REQ (WS-DOC-CNT).                         
           MOVE  'N'  TO FP00-NUM-DOC-RECVD(WS-DOC-CNT).                        
                                                                                
      *** UNEMPLOYMENT/SELF-EMPLOYED DECLARATION FORM                           
           IF K820-AMT-INCOME = 0                                               
               IF ((WS-AGE-CMPLTD >= 31)  AND (WS-AGE-CMPLTD <= 55)) OR         
                  ((WS-AGE-CMPLTD >= 18)  AND (WS-AGE-CMPLTD <= 30))            
                  ADD 1      TO WS-DOC-CNT                                      
                  MOVE '008' TO FP00-NUM-DOC     (WS-DOC-CNT)                   
                  MOVE  'Y'  TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                   
                  MOVE  'N'  TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                  
               END-IF                                                           
           END-IF.                                                              
                                                                                
      *** DEATH CERTIFICATE                                                     
           IF K820-NUM-MARITAL-STATUS  =  '3' OR 'W'                            
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '010'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              MOVE 'SPOUSE'                                                     
                            TO FP00-TXT-DEATH-CERT1                             
           END-IF.                                                              
                                                                                
      *** DIVORCE CERTIFICATE                                                   
           IF K820-NUM-MARITAL-STATUS  =  '4' OR 'D'                            
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '011'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
      *** APPLICATION FORM                                                      
           IF (K800-NUM-APPLN-TYPE = 'I') AND                                   
              (K820-NUM-NRIC = K800-NUM-NRIC1)                                  
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '019'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
      *** STUDENT PASS                                                          
           IF (K820-AMT-INCOME = 0) AND                                         
              (WS-AGE-CMPLTD >= 18) AND (WS-AGE-CMPLTD <= 30)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '020'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
      *** ESSENTIAL OCCUPIER FORM                                               
           IF K820-NUM-NRIC = K800-NUM-NRIC1                                    
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '022'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
      *** MCPS FORM                                                             
           IF (K800-NUM-ALLO-SCHEME = 'MCP') AND                                
              (K820-NUM-NRIC = K800-NUM-NRIC1)                                  
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '023'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
      *** ORPHAN DOCUMENTS                                                      
           IF (K800-NUM-ELIG-SCHEME = 'OR ') AND                                
              (K820-NUM-NRIC = K800-NUM-NRIC1)                                  
                                                                                
      ***** DEATH CERTIFICATE  OF DECEASED PARENTS                              
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '010'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              MOVE 'PARENTS'                                                    
                            TO FP00-TXT-DEATH-CERT1                             
      ***** ORPHAN SCHEME FORM                                                  
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '024'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
                                                                                
      ***** ORPHAN UNDERTAKING                                                  
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '066'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
      *** DEED OF SEPARATION                                                    
           IF K820-NUM-MARITAL-STATUS  =  '5' OR 'P'                            
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '056'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
           IF WS-EMP-STATUS = '1'                                               
              IF WS-NUM-INCOME1 > ZEROES AND                                    
                 WS-NUM-INCOME2 > ZEROES AND                                    
                 WS-NUM-INCOME3 > ZEROES AND                                    
                 WS-AGE-CMPLTD >= 18                                            
                 ADD 1         TO WS-DOC-CNT                                    
                 MOVE '080'    TO FP00-NUM-DOC     (WS-DOC-CNT)                 
                 MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                 
                 MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                
                 ADD 1         TO WS-DOC-CNT                                    
                 MOVE '081'    TO FP00-NUM-DOC     (WS-DOC-CNT)                 
                 MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                 
                 MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-EMP-STATUS = '5'                                               
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '018'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '029'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '006'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '041'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '005'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              MOVE K734-DTE-INCOME(1)                                           
                            TO FP00-NUM-DOC-DATE (WS-DOC-CNT)                   
           END-IF.                                                              
           IF WS-EMP-STATUS = '7'                                               
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '005'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              MOVE K734-DTE-INCOME(1)                                           
                            TO FP00-NUM-DOC-DATE (WS-DOC-CNT)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '006'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '041'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
           IF WS-EMP-STATUS = '9'                                               
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '006'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '041'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '005'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              MOVE K734-DTE-INCOME(1)                                           
                            TO FP00-NUM-DOC-DATE (WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
           IF WS-EMP-STATUS = 'A' AND                                           
              K800-NUM-DEFER-INCOME-ASSESS = 'Y'                                
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '081'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
           IF K800-NUM-DEFER-INCOME-ASSESS = 'Y' AND                            
              K820-NUM-EDN-LT12MTH = 'Y'                                        
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '081'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
           IF WS-EMP-STATUS = 'B' AND                                           
              K800-NUM-DEFER-INCOME-ASSESS = 'Y'                                
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '052'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
           IF K800-NUM-DEFER-INCOME-ASSESS = 'Y' AND                            
              K820-NUM-NS-LT12MTH = 'Y'                                         
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '083'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
           IF (K820-NUM-RELATIONSHIP  =  '09')  AND                             
              (WS-AGE-CMPLTD >= 18  AND  WS-AGE-CMPLTD < 21)                    
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '025'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
           IF WS-AHG-APPLN = 'Y'                                                
              MOVE WS-AHG-DOC-DUE TO FP00-AHG-DTE-DUE                           
           ELSE                                                                 
              MOVE SPACES         TO FP00-AHG-DTE-DUE                           
           END-IF.                                                              
                                                                                
           MOVE WS-CURRENT-DATE TO FP00-DTE-UPDATE.                             
           MOVE 'BP13C89D'      TO FP00-NUM-USERID.                             
           ACCEPT FP00-TME-UPDATE FROM TIME.                                    
           MOVE BP13FP00-REC   TO BP13FP0B-REC.                                 
           WRITE BP13FP0B-REC.                                                  
           ADD   1             TO WS-FP0B-WRITE-CNT.                            
           IF K800-DTE-BALLOT >= '201702'                                       
              MOVE BP13FP00-REC   TO BP13FP0A-REC                               
              WRITE BP13FP0A-REC                                                
              ADD   1             TO WS-FP0A-WRITE-CNT                          
           ELSE                                                                 
              WRITE BP13FP00-REC                                                
              ADD   1            TO WS-FP00-WRITE-CNT                           
           END-IF.                                                              
                                                                                
                                                                                
       3500-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       3550-CREATE-FP00-OCCUP.                                                  
      ************************************************************              
                                                                                
           MOVE ZEROES TO WS-DOC-CNT.                                           
                                                                                
      *------------------------------------*                                    
      *   STOP PENDING OF NRIC IN DOC REQ                                       
      *------------------------------------*                                    
      *** NRIC                                                                  
      *    IF (K820-NUM-CITIZENSHIP = '10' OR '20')  AND                        
      *       (WS-AGE-CMPLTD >= 15)                                             
      *       ADD 1         TO WS-DOC-CNT                                       
      *       MOVE '001'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
      *       MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
      *       MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
      *    END-IF.                                                              
                                                                                
      *** BIRTH CERTIFICATE                                                     
           IF K820-NUM-RELATIONSHIP = '41' OR '39' OR '06'                      
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '002'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
           IF K800-NUM-ALLO-SCHEME =  'MTF'                                     
              IF K820-NUM-RELATIONSHIP = '02' OR '12' OR '01' OR                
                                         '43' OR '45'                           
                 ADD 1      TO WS-DOC-CNT                                       
                 MOVE '002' TO FP00-NUM-DOC     (WS-DOC-CNT)                    
                 MOVE  'Y'  TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
                 MOVE  'N'  TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *** MARRIAGE CERTIFICATE                                                  
           IF K820-NUM-MARITAL-STATUS  =  '2' OR 'M'                            
              IF WS-MRG-TBL-FND = 'N'                                           
                 ADD 1       TO WS-DOC-CNT                                      
                 MOVE '003'  TO FP00-NUM-DOC     (WS-DOC-CNT)                   
                 MOVE  'Y'   TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                   
                 MOVE  'N'   TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                  
              END-IF                                                            
           END-IF.                                                              
                                                                                
      *** PAYSLIP                                                               
      **TO GET INCOME AMOUNT IN BP13K734**                                      
           IF WS-AHG-APPLN = 'Y'                                                
              IF WS-AGE-CMPLTD2 >= 18                                           
                 MOVE ZEROES                    TO WS-INC-CTR2                  
                 MOVE K800-DTE-REGN(1:6)        TO WS-DTE-REGN                  
                 ADD     -1                     TO WS-DTE-REGN-CCYY             
                 MOVE K800-DTE-REGN(5:2)        TO WS-INC-CTR                   
                 PERFORM VARYING WS-INC-CTR FROM WS-INC-CTR BY 1 UNTIL          
                                 WS-INC-CTR2 > 11                               
                  ADD 1           TO WS-DOC-CNT                                 
                                     WS-INC-CTR2                                
                  MOVE '004'      TO FP00-NUM-DOC      (WS-DOC-CNT)             
                  MOVE 'Y'        TO FP00-NUM-DOC-REQ  (WS-DOC-CNT)             
                  MOVE 'N'        TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)             
                  IF WS-INC-CTR = 13                                            
                     ADD  1       TO WS-DTE-REGN-CCYY                           
                     MOVE 1       TO WS-INC-CTR                                 
                  END-IF                                                        
                  STRING WS-DTE-REGN-CCYY WS-INC-CTR                            
                         DELIMITED BY SIZE                                      
                                INTO FP00-NUM-DOC-DATE (WS-DOC-CNT)             
                  END-STRING                                                    
                 END-PERFORM                                                    
                 MOVE K800-DTE-REGN(1:6)        TO WS-DTE-REGN                  
                 ADD     -1                     TO WS-DTE-REGN-CCYY             
                 MOVE K800-DTE-REGN(5:2)        TO WS-INC-CTR                   
                 COMPUTE WS-INC-CTR = WS-INC-CTR - 2                            
                 IF WS-INC-CTR = 0 OR WS-INC-CTR < 0                            
                   ADD 12      TO  WS-INC-CTR                                   
                 END-IF                                                         
                 ADD 1      TO WS-DOC-CNT                                       
                 MOVE '043' TO FP00-NUM-DOC     (WS-DOC-CNT)                    
                 MOVE  'Y'  TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
                 MOVE  'N'  TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
                 STRING WS-DTE-REGN-CCYY WS-INC-CTR DELIMITED BY SIZE           
                        INTO FP00-NUM-DOC-DATE(WS-DOC-CNT)                      
                 END-STRING                                                     
                 ADD 1      TO WS-DOC-CNT                                       
                 MOVE '044' TO FP00-NUM-DOC     (WS-DOC-CNT)                    
                 MOVE  'Y'  TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
                 MOVE  'N'  TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
                 STRING WS-DTE-REGN-CCYY '01' DELIMITED BY SIZE                 
                        INTO FP00-NUM-DOC-DATE(WS-DOC-CNT)                      
                 END-STRING                                                     
              END-IF                                                            
           ELSE                                                                 
            PERFORM VARYING WS-IDX1 FROM 1 BY 1 UNTIL WS-IDX1 > 12              
              IF (K734-DTE-INCOME(WS-IDX1) NOT = SPACES AND LOW-VALUES          
                                            AND ZEROES)                         
                 IF (K734-NUM-INCOME(WS-IDX1) = ZEROES) AND                     
                    (K734-NUM-INCOME(1) NOT = SPACES AND LOW-VALUES             
                                           AND ZEROES) AND                      
                    (K734-NUM-EMPLY-STATUS = '5  ' OR '7  ' OR '9  ')           
                    ADD 1           TO WS-DOC-CNT                               
                    MOVE '004'      TO FP00-NUM-DOC      (WS-DOC-CNT)           
                    MOVE 'Y'        TO FP00-NUM-DOC-REQ  (WS-DOC-CNT)           
                    MOVE 'N'        TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)           
                    MOVE K734-DTE-INCOME(WS-IDX1)                               
                               TO FP00-NUM-DOC-DATE (WS-DOC-CNT)                
                 ELSE                                                           
                    ADD 1           TO WS-DOC-CNT                               
                    MOVE '004'      TO FP00-NUM-DOC      (WS-DOC-CNT)           
                    MOVE 'Y'        TO FP00-NUM-DOC-REQ  (WS-DOC-CNT)           
                    MOVE 'N'        TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)           
                    MOVE K734-DTE-INCOME(WS-IDX1)                               
                          TO FP00-NUM-DOC-DATE (WS-DOC-CNT)                     
                 END-IF                                                         
              END-IF                                                            
            END-PERFORM                                                         
           END-IF.                                                              
                                                                                
      *** DECLARATION OF GROSS MONTHLY INCOME DETAILS                           
           IF WS-AGE-CMPLTD2 >= 18                                              
              ADD 1      TO WS-DOC-CNT                                          
              MOVE '042' TO FP00-NUM-DOC     (WS-DOC-CNT)                       
              MOVE  'Y'  TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                       
              MOVE  'N'  TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                      
           END-IF.                                                              
                                                                                
      *** UNEMPLOYMENT/SELF-EMPLOYED DECLARATION FORM                           
           IF K820-AMT-INCOME = 0                                               
               IF ((WS-AGE-CMPLTD >= 31)  AND (WS-AGE-CMPLTD <= 55)) OR         
                  ((WS-AGE-CMPLTD >= 18)  AND (WS-AGE-CMPLTD <= 30))            
                  ADD 1      TO WS-DOC-CNT                                      
                  MOVE '008' TO FP00-NUM-DOC      (WS-DOC-CNT)                  
                  MOVE  'Y'  TO FP00-NUM-DOC-REQ  (WS-DOC-CNT)                  
                  MOVE  'N'  TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                  
               END-IF                                                           
           END-IF.                                                              
                                                                                
      *** DEATH CERTIFICATE                                                     
           IF K820-NUM-MARITAL-STATUS  =  '3' OR 'W'                            
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '010'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              MOVE 'SPOUSE'                                                     
                            TO FP00-TXT-DEATH-CERT1                             
           END-IF.                                                              
                                                                                
      *** DIVORCE CERTIFICATE                                                   
           IF K820-NUM-MARITAL-STATUS  =  '4' OR 'D'                            
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '011'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
      *** DEED OF SEPARATION                                                    
           IF K820-NUM-MARITAL-STATUS  =  '5' OR 'P'                            
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '056'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
      *** STUDENT PASS                                                          
           IF (K820-AMT-INCOME = 0) AND                                         
              (WS-AGE-CMPLTD >= 18) AND (WS-AGE-CMPLTD <= 30)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '020'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
      *** EMPLOYMENT PASS/WORK PERMIT                                           
           IF (K820-NUM-CITIZENSHIP  NOT =  '10')                               
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '009'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '021'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '028'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
      *** MARRIAGE CONSENT FORM                                                 
           IF (K820-NUM-RELATIONSHIP  =  '09')  AND                             
              (WS-AGE-CMPLTD >= 18  AND  WS-AGE-CMPLTD < 21)                    
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '025'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
           IF WS-EMP-STATUS = '1'                                               
              IF WS-NUM-INCOME1 > ZEROES AND                                    
                 WS-NUM-INCOME2 > ZEROES AND                                    
                 WS-NUM-INCOME3 > ZEROES AND                                    
                 WS-AGE-CMPLTD >= 18                                            
                 ADD 1         TO WS-DOC-CNT                                    
                 MOVE '080'    TO FP00-NUM-DOC     (WS-DOC-CNT)                 
                 MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                 
                 MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                
                 ADD 1         TO WS-DOC-CNT                                    
                 MOVE '081'    TO FP00-NUM-DOC     (WS-DOC-CNT)                 
                 MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                 
                 MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF WS-EMP-STATUS = '5'                                               
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '018'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '029'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '006'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '041'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '005'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              MOVE K734-DTE-INCOME(1)                                           
                            TO FP00-NUM-DOC-DATE (WS-DOC-CNT)                   
           END-IF.                                                              
           IF WS-EMP-STATUS = '7'                                               
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '005'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              MOVE K734-DTE-INCOME(1)                                           
                            TO FP00-NUM-DOC-DATE (WS-DOC-CNT)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '006'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '041'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
           IF WS-EMP-STATUS = '9'                                               
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '006'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '041'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '005'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE 'Y'      TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
              MOVE K734-DTE-INCOME(1)                                           
                            TO FP00-NUM-DOC-DATE (WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
           IF WS-EMP-STATUS = 'A' AND                                           
              K800-NUM-DEFER-INCOME-ASSESS = 'Y'                                
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '081'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
           IF WS-EMP-STATUS = 'B' AND                                           
              K800-NUM-DEFER-INCOME-ASSESS = 'Y'                                
              ADD 1         TO WS-DOC-CNT                                       
              MOVE '052'    TO FP00-NUM-DOC     (WS-DOC-CNT)                    
              MOVE  'Y'     TO FP00-NUM-DOC-REQ (WS-DOC-CNT)                    
              MOVE  'N'     TO FP00-NUM-DOC-RECVD(WS-DOC-CNT)                   
           END-IF.                                                              
                                                                                
           IF WS-AHG-APPLN = 'Y'                                                
              MOVE WS-AHG-DOC-DUE TO FP00-AHG-DTE-DUE                           
           ELSE                                                                 
              MOVE SPACES         TO FP00-AHG-DTE-DUE                           
           END-IF.                                                              
                                                                                
           MOVE WS-CURRENT-DATE TO FP00-DTE-UPDATE.                             
           MOVE 'BP13C89D'      TO FP00-NUM-USERID.                             
           ACCEPT FP00-TME-UPDATE FROM TIME.                                    
           MOVE BP13FP00-REC   TO BP13FP0B-REC.                                 
           WRITE BP13FP0B-REC.                                                  
           ADD   1             TO WS-FP0B-WRITE-CNT.                            
           IF K800-DTE-BALLOT >= '201702'                                       
              MOVE BP13FP00-REC   TO BP13FP0A-REC                               
              WRITE BP13FP0A-REC                                                
              ADD   1             TO WS-FP0A-WRITE-CNT                          
           ELSE                                                                 
              WRITE BP13FP00-REC                                                
              ADD   1            TO WS-FP00-WRITE-CNT                           
           END-IF.                                                              
                                                                                
       3550-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       3600-CREATE-BP13FQ10.                                                    
      ************************************************************              
                                                                                
           MOVE SPACES               TO BP13FQ10-REC.                           
           INITIALIZE                   BP13FQ10-REC.                           
           MOVE K800-NUM-REGN        TO FQ10-NUM-REGN                           
                                        FQ10-NUM-REGN1                          
                                        FQ10-NUM-REGN2                          
                                        FQ10-NUM-REGN3                          
                                        FQ10-NUM-REGN4                          
                                        FQ10-NUM-REGN5.                         
                                                                                
           IF K800-DTE-BALLOT >= '201705'                                       
              IF WS-AHG-APPLN-F120 = 'Y' OR  WS-EHG-APPLN-F120 = 'Y'            
                 IF K800-DTE-REGN >= '20190911'                                 
                    MOVE 'PREEHG'       TO FQ10-NUM-CASE-OWNER                  
                 ELSE                                                           
                    MOVE 'PREAHG'       TO FQ10-NUM-CASE-OWNER                  
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              IF K800-NUM-BTO-ZONE = '378' OR '379' OR '380'                    
                 IF WS-AHG-APPLN-F120 = 'Y'                                     
                    MOVE 'PREAHG'       TO FQ10-NUM-CASE-OWNER                  
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           MOVE K800-DTE-BALLOT      TO FQ10-DTE-BALLOT.                        
           MOVE ALL '9'              TO FQ10-DTE-LATEST-DOC-DUE                 
                                        FQ10-DTE-LATEST-DOC-DUE2.               
           MOVE K800-NUM-NEW-TOWN    TO FQ10-NUM-NEW-TOWN.                      
           MOVE K800-NUM-FLAT-TYPE   TO FQ10-NUM-FLAT-TYPE.                     
           MOVE K800-NUM-ELIG-SCHEME TO FQ10-NUM-ELIG-SCHEME.                   
           MOVE K800-NUM-ALLO-SCHEME TO FQ10-NUM-ALLO-SCHEME.                   
           MOVE K800-NUM-ALLO-CAT    TO FQ10-NUM-SEL-TYPE.                      
           MOVE 'BP13C89D'           TO FQ10-NUM-USERID.                        
           MOVE WS-CURRENT-DATE      TO FQ10-DTE-UPDATE.                        
           ACCEPT FQ10-TME-UPDATE FROM TIME.                                    
           WRITE BP13FQ10-REC.                                                  
           ADD   1                   TO WS-FQ10-WRITE-CNT.                      
                                                                                
       3600-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       4000-APPLN-HSELOAN-LET.                                                  
      ************************************************************              
                                                                                
           READ BP13K757.                                                       
                                                                                
           EVALUATE WS-K757-STATUS                                              
               WHEN 00                                                          
                    ADD 1                TO WS-K757-FND-CNT                     
                    IF K800-NUM-ALLO-CAT NOT = 'NPL'                            
                       CALL 'BP13CR1A'                                          
                    END-IF                                                      
               WHEN 10                                                          
               WHEN 23                                                          
                    ADD 1                TO WS-K757-NFND-CNT                    
                    DISPLAY 'REGN NO. NOT FOUND IN BP13K757. REGN = '           
                            K757-NUM-REGN                                       
               WHEN OTHER                                                       
                    DISPLAY 'READ ERROR BP13K757, STATUS '                      
                            WS-K757-STATUS                                      
                    MOVE WS-K757-STATUS  TO RETURN-CODE                         
                                                                                
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
                                                                                
      ************************************************************              
       5100-READ-BP13K800.                                                      
      ************************************************************              
           READ BP13K800.                                                       
           EVALUATE WS-K800-STATUS                                              
             WHEN   00                                                          
                    IF K800-NUM-STATUS = 'C'                                    
                       MOVE 'N'      TO WS-K800-FND                             
                    ELSE                                                        
                       MOVE 'Y'      TO WS-K800-FND                             
                    END-IF                                                      
             WHEN   23                                                          
                    MOVE 'N'         TO WS-K800-FND                             
             WHEN   OTHER                                                       
                    DISPLAY 'READ BP13K800 ERROR ' K800-NUM-REGN                
                    DISPLAY 'STATUS ' WS-K800-STATUS                            
                    MOVE WS-K800-STATUS TO RETURN-CODE                          
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
                                                                                
           END-EVALUATE.                                                        
                                                                                
       5100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       7000-READ-BP13K734.                                                      
      ************************************************************              
                                                                                
           MOVE K820-KEY-FLD             TO K734-KEY-FLD.                       
                                                                                
           READ BP13K734.                                                       
                                                                                
           EVALUATE WS-K734-STATUS                                              
               WHEN 00                                                          
                    MOVE K734-NUM-EMPLY-STATUS TO WS-EMP-STATUS                 
                    MOVE K734-DTE-INCOME(1)    TO WS-DTE-INCOME1                
                    MOVE K734-DTE-INCOME(2)    TO WS-DTE-INCOME2                
                    MOVE K734-NUM-INCOME(1)    TO WS-NUM-INCOME1                
                    MOVE K734-NUM-INCOME(2)    TO WS-NUM-INCOME2                
                    MOVE K734-NUM-INCOME(3)    TO WS-NUM-INCOME3                
               WHEN 10                                                          
               WHEN 23                                                          
                    MOVE 'N'                   TO WS-EMP-STATUS                 
               WHEN OTHER                                                       
                    DISPLAY 'READ ERROR BP13K734, STATUS '                      
                            WS-K734-STATUS                                      
                    MOVE WS-K734-STATUS  TO RETURN-CODE                         
                                                                                
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       7000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       7100-CHECK-BP04K010.                                                     
      ************************************************************              
                                                                                
           MOVE SPACES           TO P04K010-REC                                 
                                    WS-C398-DEB-OCCUPIER(WS-APPL-CNT).          
                                                                                
           MOVE 'N'                       TO WS-K010-EOF.                       
                                                                                
           MOVE WS-C398-NRIC(WS-APPL-CNT) TO K010-NUM-UINFIN.                   
                                                                                
           START BP04K010 KEY >= K010-PRIME-KEY.                                
           EVALUATE WS-K010-STATUS                                              
               WHEN 00                                                          
                   PERFORM 7200-READNEXT-BP04K010  THRU 7200-EXIT               
                           UNTIL WS-K010-EOF = 'Y'                              
               WHEN 10                                                          
               WHEN 23                                                          
                   CONTINUE                                                     
               WHEN OTHER                                                       
                    DISPLAY 'START BP04K010 ERROR ' K010-NUM-UINFIN             
                    DISPLAY 'STATUS ' WS-K010-STATUS                            
                    MOVE WS-K010-STATUS TO RETURN-CODE                          
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       7100-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       7200-READNEXT-BP04K010.                                                  
      ************************************************************              
                                                                                
           READ BP04K010 NEXT                                                   
              AT END MOVE 'Y'  TO WS-K010-EOF.                                  
                                                                                
           EVALUATE WS-K010-STATUS                                              
               WHEN 00                                                          
                   IF K010-NUM-UINFIN = WS-C398-NRIC(WS-APPL-CNT)               
                      IF K010-REASON-CODE = 'BK'                                
                         MOVE K010-REASON-CODE TO                               
                         WS-C398-DEB-OCCUPIER(WS-APPL-CNT)                      
                      END-IF                                                    
                   ELSE                                                         
                      MOVE 'Y'           TO WS-K010-EOF                         
                   END-IF                                                       
               WHEN 10                                                          
               WHEN 23                                                          
                   MOVE 'Y'           TO WS-K010-EOF                            
               WHEN OTHER                                                       
                    DISPLAY 'READNEXT BP04K010 ERROR ' K010-NUM-UINFIN          
                    DISPLAY 'STATUS ' WS-K010-STATUS                            
                    MOVE WS-K010-STATUS TO RETURN-CODE                          
                    PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                   
           END-EVALUATE.                                                        
                                                                                
       7200-EXIT.                                                               
           EXIT.                                                                
                                                                                
      ************************************************************              
       7300-LINK-BE01C812.                                                      
      ************************************************************              
                                                                                
           MOVE SPACES                 TO BE01W812-COMMAREA.                    
           INITIALIZE                     BE01W812-COMMAREA.                    
                                                                                
           MOVE 'ENQRY'                TO BE01W812-IN-RTN-FXN.                  
           MOVE 'BP13'                 TO BE01W812-IN-NUM-UPDATE-SOURCE.        
           MOVE 'ALL'                  TO BE01W812-IN-ENQRY-TYPE.               
           MOVE 'EXT'                  TO BE01W812-IN-ENQRY-SOURCE.             
                                                                                
           IF K820-NUM-CSTMR-SOURCE = SPACES OR LOW-VALUES                      
              PERFORM 7310-LINK-BE01C902  THRU 7310-EXIT                        
              IF WS-IDNTY-TYPE NOT = 'UIN' AND 'FIN'                            
                 MOVE K820-NME-OCCP       TO BE01W812-IN-NME-PERSON             
              END-IF                                                            
              MOVE K820-NUM-NRIC          TO BE01W812-IN-IDNTY-NO               
              MOVE WS-IDNTY-TYPE          TO BE01W812-IN-IDNTY-NO-TYPE          
           ELSE                                                                 
              MOVE K820-NUM-CSTMR-SOURCE  TO BE01W812-IN-CSTMR-SRC              
           END-IF.                                                              
                                                                                
           CALL 'BE01C812' USING BE01W812-COMMAREA.                             
                                                                                
           MOVE ZEROES            TO WS-IDX2.                                   
           MOVE 'N'               TO WS-MRG-TBL-FND.                            
           MOVE 1                 TO WS-CTR.                                    
                                                                                
           EVALUATE BE01W812-OUT-OUTPUT-TAG                                     
           WHEN 'F'                                                             
                ADD 1                  TO WS-BE01-SUCC                          
                PERFORM 7320-PROCESS-PERSONS THRU 7320-EXIT                     
                   UNTIL WS-CTR > BE01W812-OUT-MRG-REC-CNT                      
                IF BE01W812-OUT-MRG-REC-CNT > ZEROES                            
                   MOVE 'Y'            TO WS-MRG-TBL-FND                        
                END-IF                                                          
           WHEN 'N'                                                             
                DISPLAY 'CUSTOMER NOT FOUND / NO MRG INFO FOUND - '             
                         K820-KEY-FLD                                           
                ADD 1                  TO WS-BE01-UNSUCC                        
                                          WS-IDX2                               
                MOVE K820-NUM-CSTMR-SOURCE                                      
                                       TO WS-NUM-CSTMR(WS-IDX2)                 
                IF K820-NUM-SEX = 'F'                                           
                   MOVE K820-NUM-NRIC                                           
                                       TO WS-NUM-NRIC-WIFE(WS-IDX2)             
                   MOVE K820-NUM-NRIC-SPOUSE                                    
                                       TO WS-NUM-NRIC-HSBND(WS-IDX2)            
                ELSE                                                            
                   MOVE K820-NUM-NRIC                                           
                                       TO WS-NUM-NRIC-HSBND(WS-IDX2)            
                   MOVE K820-NUM-NRIC-SPOUSE                                    
                                       TO WS-NUM-NRIC-WIFE(WS-IDX2)             
                END-IF                                                          
           WHEN 'I'                                                             
                DISPLAY 'INPUT REQUIRED - ' K820-KEY-FLD                        
                ADD 1                  TO WS-BE01-UNSUCC                        
           WHEN 'V'                                                             
                DISPLAY 'INPUT INVALID - ' K820-KEY-FLD                         
                ADD 1                  TO WS-BE01-UNSUCC                        
           WHEN 'M'                                                             
                DISPLAY 'MRG INFO FOUND & EXCEEDED MAX INFO TO '                
                        'RETURN - ' K820-KEY-FLD                                
                ADD 1                  TO WS-BE01-UNSUCC                        
           WHEN OTHER                                                           
                MOVE BE01W812-OUT-RTN-STATCDE TO RETURN-CODE                    
                DISPLAY BE01W812-OUT-RTN-PGMID ' ERROR : '                      
                        BE01W812-OUT-RTN-ACTION                                 
                        BE01W812-OUT-RTN-MSGNO ' / '                            
                        BE01W812-OUT-RTN-STATCDE                                
                PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                       
           END-EVALUATE.                                                        
                                                                                
       7300-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ************************************************************              
       7310-LINK-BE01C902.                                                      
      ************************************************************              
                                                                                
           MOVE SPACES                     TO BE01W902-COMMAREA.                
           INITIALIZE                         BE01W902-COMMAREA.                
                                                                                
           MOVE K820-NUM-NRIC              TO BE01W902-IN-NUM-IDNTY-NO.         
                                                                                
           CALL 'BE01C902' USING BE01W902-COMMAREA.                             
           IF BE01W902-OUT-RTN-MSGNO = SPACES OR LOW-VALUES                     
              MOVE BE01W902-OUT-NUM-IDNTY-NO-TYPE                               
                                           TO WS-IDNTY-TYPE                     
           ELSE                                                                 
              IF BE01W902-OUT-RTN-MSGNO = '0127'                                
                 MOVE 'XIN'                TO WS-IDNTY-TYPE                     
              ELSE                                                              
                 DISPLAY 'ERROR IN BE01C902 NRIC : ' K820-NUM-NRIC              
                         ' / ' BE01W902-OUT-RTN-MSGNO                           
                 PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                      
              END-IF                                                            
           END-IF.                                                              
                                                                                
       7310-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ************************************************************              
       7320-PROCESS-PERSONS.                                                    
      ************************************************************              
                                                                                
           IF K820-NUM-NRIC = BE01W812-OUT-MRG-ID-NO-HSBND(WS-CTR)              
              IF BE01W812-OUT-MRG-ID-NO-WIFE(WS-CTR) =                          
                 K820-NUM-NRIC-SPOUSE                                           
                 ADD  1            TO WS-IDX2                                   
                 MOVE 'Y'          TO  WS-MRG-TBL-FND                           
                 MOVE BE01W812-OUT-MRG-CSTMRID-WIFE(WS-CTR)                     
                                   TO  WS-NUM-CSTMR(WS-IDX2)                    
                 MOVE BE01W812-OUT-MRG-ID-NO-WIFE(WS-CTR)                       
                                   TO  WS-NUM-NRIC-WIFE(WS-IDX2)                
                 MOVE BE01W812-OUT-MRG-ID-NO-HSBND(WS-CTR)                      
                                   TO  WS-NUM-NRIC-HSBND(WS-IDX2)               
              END-IF                                                            
           ELSE                                                                 
              IF K820-NUM-NRIC = BE01W812-OUT-MRG-ID-NO-WIFE(WS-CTR)            
                 IF BE01W812-OUT-MRG-ID-NO-HSBND(WS-CTR) =                      
                    K820-NUM-NRIC-SPOUSE                                        
                    ADD  1            TO WS-IDX2                                
                    MOVE 'Y'          TO  WS-MRG-TBL-FND                        
                    MOVE BE01W812-OUT-MRG-CSTMRID-HSBND(WS-CTR)                 
                                      TO  WS-NUM-CSTMR(WS-IDX2)                 
                    MOVE BE01W812-OUT-MRG-ID-NO-HSBND(WS-CTR)                   
                                      TO  WS-NUM-NRIC-HSBND(WS-IDX2)            
                    MOVE BE01W812-OUT-MRG-ID-NO-WIFE(WS-CTR)                    
                                      TO  WS-NUM-NRIC-WIFE(WS-IDX2)             
                 END-IF                                                         
              END-IF                                                            
           END-IF.                                                              
                                                                                
           ADD 1                           TO WS-CTR.                           
                                                                                
       7320-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ************************************************************              
       8000-UPDT-BP13KF00.                                                      
      ************************************************************              
                                                                                
           MOVE 'N' TO WS-FORMS-PRINTED.                                        
                                                                                
           PERFORM VARYING WS-F FROM 1 BY 1 UNTIL WS-F > 50                     
              IF WS-KF00-FORM-ID(WS-F) NOT = SPACES AND LOW-VALUES              
                 MOVE 'Y' TO WS-FORMS-PRINTED                                   
              END-IF                                                            
           END-PERFORM.                                                         
                                                                                
      * WRITE LIST OF FORMIDS TO BP13KF00                                       
           IF WS-FORMS-PRINTED = 'Y'                                            
              MOVE F200-NUM-REGN TO KF00-REGNO                                  
              MOVE 'IN'          TO KF00-FORM-TYPE                              
              PERFORM 8500-READ-BP13KF00  THRU 8500-EXIT                        
              IF WS-KF00-FND = 'N'                                              
                 PERFORM 8550-WRITE-BP13KF00 THRU 8550-EXIT                     
              ELSE                                                              
                 PERFORM 8560-REWRITE-BP13KF00 THRU 8560-EXIT                   
              END-IF                                                            
           END-IF.                                                              
                                                                                
       8000-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *--------------------------------------------------------------*          
       8500-READ-BP13KF00.                                                      
      *--------------------------------------------------------------*          
                                                                                
           MOVE 'N'          TO WS-KF00-FND.                                    
                                                                                
           READ BP13KF00.                                                       
                                                                                
           EVALUATE WS-KF00-STATUS                                              
              WHEN 00                                                           
              WHEN 02                                                           
                   MOVE 'Y'          TO WS-KF00-FND                             
              WHEN 23                                                           
                   MOVE 'N'          TO WS-KF00-FND                             
              WHEN OTHER                                                        
                   DISPLAY 'ERROR READING BP13KF00. STATUS IS '                 
                           WS-KF00-STATUS                                       
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       8500-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *--------------------------------------------------------------*          
       8550-WRITE-BP13KF00.                                                     
      *--------------------------------------------------------------*          
           MOVE SPACES           TO BP13KF00-REC.                               
           INITIALIZE               BP13KF00-REC.                               
                                                                                
           MOVE F200-NUM-REGN    TO KF00-REGNO.                                 
           MOVE 'IN'             TO KF00-FORM-TYPE.                             
           MOVE 'BP13C896'       TO KF00-PROGNAME.                              
           MOVE WS-CURRENT-DATE  TO KF00-DTE-UPDATE.                            
                                                                                
           PERFORM VARYING WS-F FROM 1 BY 1 UNTIL WS-F > 50                     
              MOVE WS-KF00-FORM-ID(WS-F) TO KF00-NUM-FORM-ID(WS-F)              
           END-PERFORM.                                                         
                                                                                
           WRITE BP13KF00-REC.                                                  
                                                                                
           EVALUATE WS-KF00-STATUS                                              
              WHEN 00                                                           
                   ADD 1             TO WS-KF00-WRITE                           
              WHEN OTHER                                                        
                   DISPLAY 'ERROR WRITING TO BP13KF00. STATUS IS '              
                           WS-KF00-STATUS                                       
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       8550-EXIT.                                                               
            EXIT.                                                               
                                                                                
      *--------------------------------------------------------------*          
       8560-REWRITE-BP13KF00.                                                   
      *--------------------------------------------------------------*          
           MOVE 'BP13C896'       TO KF00-PROGNAME.                              
           MOVE WS-CURRENT-DATE  TO KF00-DTE-UPDATE.                            
                                                                                
           PERFORM VARYING WS-F FROM 1 BY 1 UNTIL WS-F > 50                     
              MOVE WS-KF00-FORM-ID(WS-F) TO KF00-NUM-FORM-ID(WS-F)              
           END-PERFORM.                                                         
                                                                                
           REWRITE BP13KF00-REC.                                                
                                                                                
           EVALUATE WS-KF00-STATUS                                              
              WHEN 00                                                           
                   ADD 1             TO WS-KF00-REWRITE                         
              WHEN OTHER                                                        
                   DISPLAY 'ERROR REWRITING TO BP13KF00. STATUS IS '            
                           WS-KF00-STATUS                                       
                   PERFORM 9000-CLOSE-ROUTINE THRU 9000-EXIT                    
           END-EVALUATE.                                                        
                                                                                
       8560-EXIT.                                                               
            EXIT.                                                               
                                                                                
      ************************************************************              
       9000-CLOSE-ROUTINE.                                                      
      ************************************************************              
           DISPLAY ' '.                                                         
           DISPLAY '- BP13C896 CONTROL TOTAL --------------'.                   
           DISPLAY '                RUN DATE : ' WS-CURR-DATE.                  
           DISPLAY '---------------------------------------'.                   
           DISPLAY ' NO OF RECS READ        (F200): ' WS-F200-READ-CNT.         
           DISPLAY ' NO OF RECS FOUND       (K800): ' WS-K800-FND-CNT.          
           DISPLAY ' NO OF RECS NFND/CANCEL (K800): ' WS-K800-NFND-CNT.         
           DISPLAY ' '.                                                         
           DISPLAY ' NO OF RECS FOUND       (K757): ' WS-K757-FND-CNT.          
           DISPLAY ' NO OF RECS NOT FOUND   (K757): ' WS-K757-NFND-CNT.         
           DISPLAY ' '.                                                         
           DISPLAY ' NO OF TOTAL PAGES WRITTEN    : ' WS-TOT-PAGE-CNT.          
           DISPLAY ' NO. OF QUESTIONNAIRE PRINTED : ' WS-FORM-PRTED.            
           DISPLAY ' '.                                                         
           DISPLAY ' NO OF RECS WRITTEN     (FP00): ' WS-FP00-WRITE-CNT.        
           DISPLAY ' NO OF RECS WRITTEN     (FP0A): ' WS-FP0A-WRITE-CNT.        
           DISPLAY ' NO OF RECS WRITTEN     (FP0B): ' WS-FP0B-WRITE-CNT.        
           DISPLAY ' NO OF RECS WRITTEN     (FQ10): ' WS-FQ10-WRITE-CNT.        
           DISPLAY ' NO OF RECS WRITTEN     (KF00): ' WS-KF00-WRITE.            
           DISPLAY ' NO OF RECS REWRITTEN   (KF00): ' WS-KF00-REWRITE.          
                                                                                
           CLOSE BP13F200                                                       
                 BP13F205                                                       
                 BP13FP00                                                       
                 BP13FP0A                                                       
                 BP13FP0B                                                       
                 BP13FQ10                                                       
                 BP13KF00                                                       
                 BP13K060                                                       
                 BP13K062                                                       
                 BP13K757                                                       
                 BP13K813                                                       
                 BP13K800                                                       
                 BP13K820                                                       
                 BP13K830                                                       
                 BP13K246                                                       
                 BP13K76D                                                       
                 BP13K734                                                       
                 BP13K200                                                       
                 BP04K010                                                       
                 P13P89DA                                                       
                 P13P89DC                                                       
                 P13P89DD                                                       
                 P13P89D2                                                       
                 P13L89DA                                                       
                 P13L89DB.                                                      
                                                                                
           IF WS-K060-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K060, STATUS ' WS-K060-STATUS            
              MOVE WS-K060-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K062-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K062, STATUS ' WS-K062-STATUS            
              MOVE WS-K062-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K757-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K757, STATUS ' WS-K757-STATUS            
              MOVE WS-K757-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K813-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K813, STATUS ' WS-K813-STATUS            
              MOVE WS-K813-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K800-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K800, STATUS ' WS-K800-STATUS            
              MOVE WS-K800-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K820-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K820, STATUS ' WS-K820-STATUS            
              MOVE WS-K820-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K830-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K830, STATUS ' WS-K830-STATUS            
              MOVE WS-K830-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K246-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K246, STATUS ' WS-K246-STATUS            
              MOVE WS-K246-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K76D-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K76D, STATUS ' WS-K76D-STATUS            
              MOVE WS-K76D-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K734-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K734, STATUS ' WS-K734-STATUS            
              MOVE WS-K734-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K200-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13K200, STATUS ' WS-K200-STATUS            
              MOVE WS-K200-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-K010-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP04K010, STATUS ' WS-K010-STATUS            
              MOVE WS-K010-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           IF WS-KF00-STATUS NOT = 00 AND 97                                    
              DISPLAY 'CLOSE ERROR BP13KF00, STATUS ' WS-KF00-STATUS            
              MOVE WS-KF00-STATUS        TO RETURN-CODE                         
           END-IF.                                                              
                                                                                
           MOVE SPACES                     TO BE01W812-INPUT-INFO.              
           MOVE 'CLOSE'                    TO BE01W812-IN-RTN-FXN.              
           CALL 'BE01C812' USING BE01W812-COMMAREA.                             
                                                                                
           STOP RUN.                                                            
                                                                                
       9000-EXIT.                                                               
           EXIT.                                                                
                                                                                
       COPY BP13CR1A.                                                           
       COPY BP13CR1B.                                                           
       COPY BP13CR2B.                                                           
       COPY BP13CR5B.                                                           
       COPY BP13CR1C.                                                           
       COPY BP13CR1D.                                                           
       COPY BP13CR26.                                                           
       COPY BP13CR48.                                                           
       COPY BP13CR49.                                                           
       COPY BP13CR50.                                                           
       COPY BP13CR51.                                                           
       END PROGRAM BP13C896.                                                    
