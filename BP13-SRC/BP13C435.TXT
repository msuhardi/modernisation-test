      *-------------------------*                                               
       IDENTIFICATION DIVISION.                                                 
      *-------------------------*                                               
       PROGRAM-ID.    BP13C435.                                                 
       AUTHOR.        LJL.                                                      
       DATE-WRITTEN.  25/04/90.                                                 
                                                                                
      * ======================================================== *              
      *                SYSTEM OF COMMITMENT   (BP13)             *              
      * ======================================================== *              
      *    OBJECTIVE    :                                        *              
      *        1.  TO PRINT FROM THE FILE BP13F310 ALL THE       *              
      *            LEGAL DOCUMENTS THAT ARE STAMPED              *              
      *            AND ARE READY TO BE SENT TO LEGAL DEPT.       *              
      *                                                          *              
      *     INPUT FILES :                                        *              
      *           1. BP13F310 (SOC TRANSACTION FILE)             *              
      *           2. BM06K110 (FLAT INVENTORY FILE)              *              
      *           3. BP13K410 (ACCUMSO FILE)                     *              
      *           4. AB05K006 (AB05.K006.SFMAST)                 *              
      *                                                          *              
      *     LISTING:                                             *              
      *           1. P13L435A (LEGAL DOCUMENTS TO BE SENT        *              
      *                        TO BO FOR FOLLOW-UP ACTION)       *              
      *                                                          *              
      * ======================================================== *              
      * CHG-NO   BY  DATE   DESCRIPTION                          *              
      * -------- --- ------ -----------                          *              
      * C9210F3  JK  921111 TO CATER FOR FLEXIPLAN               *              
      * I920718  LJL 930111 TO CONVERT TO COBOL II               *              
      * C930106  RAZ 930113 TO REMOVE FSA & REPORT HEADER        *              
      * SOC-PH8  JEP 930724 TO RENAME P10K020 TO BP13K800        *              
      * C9404G4  LJL 940528 TO AMEND 'O' FOR DOA AND SU          *              
      *                     TO 'DUP' AND ALL 'D' TO 'DUP'.       *              
      * C9404E6  BAL 940820 TO CATER FOR SALES TYPE 2B.          *              
      * BP130020 SSS 951018 CONVERT PRINTOUT TO LASER PRINTING   *              
      * BP130135 LJL 960520 TO ENSURE THAT LOAN > 0 AND          *              
      *                     PREMIUM > 0 BEFORE TAGGING THE       *              
      *                     DOCUMENTS PRINTED.                   *              
      * BP130135 LJL 960718 TO CATER FOR DISPENSATING OF         *              
      *                     DUPLICATES FOR MORTGAGE.             *              
      * BP130135 LJL 960831 TO ENSURE THAT THE TOTAL COPIES      *              
      *                     ADD TO THE SUB-TOTAL.                *              
      * BP130180 SSS 960910 INCLUDE IA COMMENTS                  *              
      * BP130311 LJL 980403 TO CATER FOR 6 FIGURES PREMIUM.      *              
      * BP130418 SIA 980804 CHNGE BM06K211 & K210 TO K110 & K100 *              
      * BP132666 JF4 050314 INCLUDE STAMP FEE BALANCE AND KEY    *              
      *                     ISSUE DATE IN THE REPORT.            *              
      * BP132729 JF4 150905 CATER FOR CHANGE IN AB05K006 LENGTH  *              
      * BP134213 RJE 290411 TO CATER FOR REMOVAL OF NOMINAL DUTIES              
      * BP134779 PCL4130613 TO CONVERT THE REPORT TO SENDMAIL    *              
      * BP135537 RJB1230215 CHANGE THE EMAIL RECIPIENT FROM      *              
      *                     NICKNAME INTO COMPLETE NAME          *              
      * BP136477 RJB 181016 TO REPLACE KIM HUAT TO YEE MIEN      *              
      * BP137087 PCL 171117 TO UPDATE EMAIL RECIPIENTS           *              
      * BP137155 PCL 080118 TO UPDATE EMAIL RECIPIENTS           *              
      * BP137554 DN8 112018 TO UPDATE EMAIL RECIPIENTS           *              
      * BP137554 ZS13112818 add NGAI_Chyau_Jiann@hdb.gov.sg      *              
      * BP138757 KV8 230721 TO REPLACE KATHIJAH TO SUZANNE       *              
      * BP139030 ZAR7 070122 REPLACE CHUA YEE MIEN TO LIM KOK CHUN *            
      * BP139159 KAC1 070622 TO ADD HAE Zoe Aw  & AE Jocelyn Seah*              
      *                      TO REMOVE AE Normala Binte Buang    *              
      * BP139159 KAC1 280622 to Removed Afiqah                   *              
      * BP139276 KAC1 050424 REPLACE LIM KOK CHUN BY             *              
      *                              KATHIJAH_BEE_ALI_MOHAMED    *              
      * ======================================================== *              
                                                                                
      ************************                                                  
       ENVIRONMENT DIVISION.                                                    
      ************************                                                  
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BP13F310   ASSIGN        TO  BP13F310.                        
                                                                                
           SELECT BM06K110   ASSIGN        TO  BM06K110                         
                             ACCESS MODE   IS  RANDOM                           
                             ORGANIZATION  IS  INDEXED                          
                             RECORD KEY    IS  K110-KEY-FLD                     
                             FILE STATUS   IS  BM06K110-STATUS.                 
                                                                                
           SELECT BP13K410   ASSIGN        TO  BP13K410                         
                             ACCESS MODE   IS  RANDOM                           
                             ORGANIZATION  IS  INDEXED                          
                             RECORD KEY    IS  K410-KEY-FLD                     
                             FILE STATUS   IS  BP13K410-STATUS.                 
                                                                                
           SELECT AB05K006   ASSIGN        TO  AB05K006                         
                             ACCESS MODE   IS  RANDOM                           
                             ORGANIZATION  IS  INDEXED                          
                             RECORD KEY    IS  K006-HDB-REF-SF                  
                             FILE STATUS   IS  AB05K006-STATUS.                 
                                                                                
           SELECT P13L435A   ASSIGN        TO  P13L435A.                        
                                                                                
      *****************                                                         
       DATA DIVISION.                                                           
      *****************                                                         
       FILE SECTION.                                                            
                                                                                
       FD   BP13F310                                                            
            BLOCK  CONTAINS 0   RECORDS                                         
            RECORD CONTAINS 150 CHARACTERS                                      
            RECORDING  MODE IS  F                                               
            LABEL  RECORD   IS  STANDARD.                                       
       COPY BP13F310.                                                           
                                                                                
       FD   BM06K110                                                            
            RECORD CONTAINS 500 CHARACTERS.                                     
       COPY BM06K110.                                                           
                                                                                
       FD   BP13K410                                                            
            RECORD CONTAINS 2000 CHARACTERS.                                    
       COPY BP13K410.                                                           
                                                                                
       FD   AB05K006                                                            
            RECORD CONTAINS  800 CHARACTERS.                                    
       COPY B05K006.                                                            
                                                                                
       FD  P13L435A                                                             
           RECORD CONTAINS 133 CHARACTERS                                       
           RECORDING  MODE IS  F                                                
           LABEL RECORDS   ARE OMITTED.                                         
       01  L435A-PRINT-REC            PIC X(133).                               
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-EMAIL-RPT-VARIABLES.                                              
           05  WS-DATE-RPT-DTL.                                                 
               10 FILLER                PIC X(6)  VALUE 'DATE: '.               
               10 WS-DATE-RPT           PIC X(10) VALUE SPACES.                 
           05  WS-MAIL-RPT1             PIC X(12) VALUE 'HELO SGPHDB1'.         
           05  WS-MAIL-RPT2             PIC X(27)                               
               VALUE 'MAIL FROM:<OPCP@SGPHDB1>'.                                
           05  WS-MAIL-RPT3             PIC X(60)                               
               VALUE 'RCPT TO:<BALASUBRAMANIAM_ARUNASALAM@HDB.GOV.SG>'.         
           05  WS-MAIL-RPT4             PIC X(60) VALUE                         
              'RCPT TO:<NOORJAHAN_SHAIK_MOHAMED_GULEMKADER@HDB.GOV.SG>'.        
           05  WS-MAIL-RPT5             PIC X(60)                               
               VALUE 'RCPT TO:<MUHAMMED_SHARIFF_SAHROM@HDB.GOV.SG>'.            
           05  WS-MAIL-RPT7             PIC X(60)                               
      *        VALUE 'RCPT TO:<KATHIJAH_BEE_ALI_MOHAMED@HDB.GOV.SG>'.           
               VALUE 'RCPT TO:<SUZANNE_SC_HENG@HDB.GOV.SG>'.                    
           05  WS-MAIL-RPT7B            PIC X(40)                               
               VALUE 'RCPT TO:<PHNG_BEE_LUAN@HDB.GOV.SG>'.                      
           05  WS-MAIL-RPT7B1           PIC X(40)                               
               VALUE 'RCPT TO:<NGAI_CHYAU_JIANN@HDB.GOV.SG>'.                   
           05  WS-MAIL-RPT7C            PIC X(45)                               
               VALUE 'RCPT TO:<KATHIJAH_BEE_ALI_MOHAMED@hdb.gov.sg>'.           
           05  WS-MAIL-RPT7D            PIC X(40)                               
               VALUE 'RCPT TO:<OH_MENG_HUAT@HDB.GOV.SG>'.                       
           05  WS-MAIL-RPT7E            PIC X(40)                               
               VALUE 'RCPT TO:<zoe_sm_aw@hdb.gov.sg>'.                          
           05  WS-MAIL-RPT7F            PIC X(40)                               
               VALUE 'RCPT TO:<jocelyn_wt_seah@hdb.gov.sg>'.                    
           05  WS-MAIL-RPT8             PIC X(4)                                
               VALUE 'DATA'.                                                    
           05  WS-MAIL-RPT9             PIC X(40)                               
               VALUE 'FROM:Soc System - Email Alert'.                           
           05  WS-MAIL-RPT10            PIC X(60)                               
               VALUE 'TO:<BALASUBRAMANIAM_ARUNASALAM@HDB.GOV.SG>'.              
           05  WS-MAIL-RPT11            PIC X(60) VALUE                         
              'TO:<NOORJAHAN_SHAIK_MOHAMED_GULEMKADER@HDB.GOV.SG>'.             
           05  WS-MAIL-RPT12            PIC X(60)                               
               VALUE 'TO:<MUHAMMED_SHARIFF_SAHROM@HDB.GOV.SG>'.                 
           05  WS-MAIL-RPT13B           PIC X(60)                               
      *        VALUE 'TO:<KATHIJAH_BEE_ALI_MOHAMED@HDB.GOV.SG>'.                
               VALUE 'TO:<SUZANNE_SC_HENG@HDB.GOV.SG>'.                         
           05  WS-MAIL-RPT13D           PIC X(40)                               
               VALUE 'TO:<PHNG_BEE_LUAN@HDB.GOV.SG>'.                           
           05  WS-MAIL-RPT13D1          PIC X(40)                               
               VALUE 'TO:<NGAI_Chyau_Jiann@hdb.gov.sg>'.                        
           05  WS-MAIL-RPT13D2          PIC X(40)                               
               VALUE 'TO:<zoe_sm_aw@hdb.gov.sg>'.                               
           05  WS-MAIL-RPT13D3          PIC X(40)                               
               VALUE 'TO:<jocelyn_wt_seah@hdb.gov.sg>'.                         
           05  WS-MAIL-RPT13E           PIC X(40)                               
               VALUE 'CC:<KATHIJAH_BEE_ALI_MOHAMED@hdb.gov.sg>'.                
           05  WS-MAIL-RPT13F           PIC X(40)                               
               VALUE 'CC:<OH_MENG_HUAT@HDB.GOV.SG>'.                            
           05  WS-MAIL-RPT15            PIC X(100)                              
               VALUE 'SUBJECT : LIST OF LEGAL DOCUMENTS SENT TO LEGAL'.         
                                                                                
       01  FILE-STATUS.                                                         
           05  BM06K110-STATUS        PIC 99     VALUE 0.                       
           05  BP13K410-STATUS        PIC 99     VALUE 0.                       
           05  AB05K006-STATUS        PIC 99     VALUE 0.                       
                                                                                
       01  WS1-DATE-VARIABLES.                                                  
           05  WS1-CURRENT-DATE.                                                
               10  WS1-CURRENT-CC     PIC 99.                                   
               10  WS1-CURRENT-YY     PIC 99.                                   
               10  WS1-CURRENT-MM     PIC 99.                                   
               10  WS1-CURRENT-DD     PIC 99.                                   
                                                                                
                                                                                
       01  WS2-REPORT-VARIABLES.                                                
      *----------------------------------------------------------------*        
      *        ACCUMULATORS                                            *        
      *----------------------------------------------------------------*        
           05  WS2-NUM-VARIABLES.                                               
               10  WS2-NUM-SA             PIC S9(4)  VALUE +0.                  
               10  WS2-NUM-LIE            PIC S9(4)  VALUE +0.                  
               10  WS2-NUM-MIE            PIC S9(4)  VALUE +0.                  
               10  WS2-NUM-DOA            PIC S9(4)  VALUE +0.                  
               10  WS2-NUM-SU             PIC S9(4)  VALUE +0.                  
               10  WS2-NUM-DOA-ST         PIC S9(4)  VALUE +0.                  
               10  WS2-NUM-SA-TOTAL       PIC 9(4)   VALUE  0.                  
               10  WS2-NUM-LIE-TOTAL      PIC 9(4)   VALUE  0.                  
               10  WS2-NUM-MIE-TOTAL      PIC 9(4)   VALUE  0.                  
               10  WS2-NUM-DOA-TOTAL      PIC 9(5)   VALUE  0.                  
               10  WS2-NUM-SU-TOTAL       PIC 9(5)   VALUE  0.                  
               10  WS2-NUM-DOA-ST-TOTAL   PIC 9(4)   VALUE  0.                  
                                                                                
      *----------------------------------------------------------------*        
      *        COUNTERS FOR REPORT  (FILE SENT)                        *        
      *----------------------------------------------------------------*        
               10  WS2-CNT-PAGE-FS    PIC 9(5)   COMP-3  VALUE 0.               
               10  WS2-SERIAL-NO-FS   PIC 9(3)   COMP-3  VALUE 0.               
               10  WS2-CNT-LINES-FS   PIC 9(3)   COMP-3  VALUE 0.               
                                                                                
       01  WS3-COUNTERS.                                                        
           05  WS3-CNT-F310-READ      PIC 9(5)   VALUE  0.                      
                                                                                
       01  WS4-SWITCHES-INDICATORS.                                             
           05  WS4-EOF-IND            PIC X(1)   VALUE 'N'.                     
               88  WS4-EOF                       VALUE 'Y'.                     
                                                                                
           05  WS-AB05K006-FND-TAG    PIC X(1)   VALUE SPACE.                   
               88  AB05K006-FND                  VALUE 'Y'.                     
                                                                                
      *----------------------------------------------------------------*        
      *       TO INDICATE THAT A PARTICULAR PAGE  OR  LIST NO  OR      *        
      *          CAHNGE IN BO  WAS READ/PRINTED                        *        
      *----------------------------------------------------------------*        
           05  WS4-PRTED-ACK-IND      PIC X      VALUE SPACE.                   
                                                                                
       01  WS5-DEFAULT-VALUES.                                                  
           05  WS5-MAX-LINE-FS        PIC 9(2)   VALUE 31.                      
                                                                                
      *----------------------------------------------------------------*        
      *        DEFAULT HEADINGS FOR THE VARIOUS LISTINGS               *        
      *----------------------------------------------------------------*        
           05  WS5-HD2B-DESC-FS       PIC X(52)  VALUE                          
               'LIST  OF  LEGAL  DOCUMENTS  SENT  TO  LEGAL DEPT   '.           
                                                                                
       01  WS6-MSIC.                                                            
           05  WS6-SCH-ACC.                                                     
               10  WS6-SCH            PIC X(4).                                 
               10  WS6-ACC            PIC X(4).                                 
               10  WS6-CHK            PIC X(1).                                 
               10  WS6-ACC-TYPE       PIC X(2).                                 
                                                                                
      *----------------------------------------------------------------*        
      *        VARIABLES FOR CHECKING CONTROL IN PAGE BREAK            *        
      *----------------------------------------------------------------*        
           05  WS6-PREV-LIST-NO       PIC X(10)  VALUE SPACES.                  
                                                                                
      *----------------------------------------------------------------*        
      *        C O M M O N     L A Y - O U T   (HEADINGS)  FOR :       *        
      *            LIST OF FILES SENT TO BRANCH OFFICE     AND         *        
      *            LIST OF SALES ORDERS SENT TO BRANCH OFFICE          *        
      *----------------------------------------------------------------*        
       01  L435-HDG-1.                                                          
           05  FILLER                 PIC X(8)   VALUE 'BP13L435'.              
           05  FILLER                 PIC X(37)  VALUE SPACES.                  
           05  FILLER                 PIC X(39)  VALUE                          
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           05  FILLER                 PIC X(30)  VALUE SPACES.                  
           05  FILLER                 PIC X(8)   VALUE ' PAGE : '.              
           05  L435-HD2B-PAGE-NO      PIC ZZZZ9.                                
                                                                                
       01  L435-HDG-2A.                                                         
           05  FILLER                 PIC X(55)  VALUE SPACES.                  
           05  FILLER                 PIC X(30)  VALUE                          
              'AGREEMENT TEAM (SALES)'.                                         
                                                                                
       01  L435-HDG-2B.                                                         
           05  FILLER                 PIC X(43)  VALUE SPACES.                  
           05  L435-HD2B-DESC         PIC X(52)  VALUE SPACES.                  
           05  FILLER                 PIC X(13)  VALUE SPACES.                  
           05  FILLER                 PIC X(8)   VALUE 'DATE :'.                
           05  L435-HD2B-DATE.                                                  
               10  L435-HD2B-DATE-DD  PIC X(2)   VALUE SPACES.                  
               10  FILLER             PIC X      VALUE '/'.                     
               10  L435-HD2B-DATE-MM  PIC X(2)   VALUE SPACES.                  
               10  FILLER             PIC X      VALUE '/'.                     
               10  L435-HD2B-DATE-CC  PIC X(2)   VALUE SPACES.                  
               10  L435-HD2B-DATE-YY  PIC X(2)   VALUE SPACES.                  
                                                                                
       01  L435-HDG-4.                                                          
           05  FILLER                 PIC X(43)  VALUE SPACES.                  
           05  FILLER                 PIC X(10)  VALUE 'LIST-NO :'.             
           05  L435-HD4-LIST-NO       PIC X(10)  VALUE SPACES.                  
                                                                                
      *----------------------------------------------------------------*        
      *        REPORT LAY-OUT FOR LISTING OF FILES SENT TO AREA OFFICE *        
      *----------------------------------------------------------------*        
       01  L435-FS-HDG-5.                                                       
           05  FILLER                 PIC X(76)  VALUE SPACES.                  
           05  FILLER                 PIC X(26)  VALUE                          
               'SA   LIE    MIE  DOA  SU  '.                                    
           05  FILLER                 PIC X(30)  VALUE                          
               'DOA-T  STAMP FEE    KEY ISSUE '.                                
                                                                                
       01  L435-FS-HDG-5A.                                                      
           05  FILLER                 PIC X      VALUE SPACE.                   
           05  FILLER                 PIC X(15)  VALUE 'S/N  REGN NO'.          
           05  FILLER                 PIC X(13)  VALUE 'SCHEME A/C NO'.         
           05  FILLER                 PIC X(04)  VALUE SPACES.                  
           05  FILLER                 PIC X(07)  VALUE 'ADDRESS'.               
           05  FILLER                 PIC X(36)  VALUE SPACES.                  
           05  FILLER                 PIC X(26)  VALUE                          
               ' O   O  DUP  O   DUP  DUP '.                                    
           05  FILLER                 PIC X(25)  VALUE                          
               '  O        BALANCE   DATE'.                                     
           05  FILLER                 PIC X(05)  VALUE SPACES.                  
                                                                                
      *----------------------------------------------------------------*        
      *        DETAIL LINE FOR REPORT FORMAT  (LIST OF FILES SENT)     *        
      *----------------------------------------------------------------*        
       01  L435-FS-DETAIL-1.                                                    
           05  FILLER                 PIC X      VALUE SPACE.                   
           05  L435-FS-SERIAL-NO      PIC ZZ9    VALUE ZEROES.                  
           05  FILLER                 PIC X(2)   VALUE SPACES.                  
           05  L435-FS-REGN-NO        PIC X(8)   VALUE SPACES.                  
           05  FILLER                 PIC X(2)   VALUE SPACE.                   
           05  L435-FS-SCHEME         PIC 9(4)   VALUE ZEROES.                  
           05  FILLER                 PIC X      VALUE '-'.                     
           05  L435-FS-ACC            PIC 9(4)   VALUE ZEROES.                  
           05  FILLER                 PIC X      VALUE '-'.                     
           05  L435-FS-CHK            PIC 9      VALUE ZERO.                    
           05  FILLER                 PIC X      VALUE '-'.                     
           05  L435-FS-ACC-TYPE       PIC 99     VALUE ZEROES.                  
           05  FILLER                 PIC X(3)   VALUE SPACES.                  
           05  FILLER                 PIC X(4)   VALUE 'BLK'.                   
           05  L435-FS-BLK-NO         PIC X(5)   VALUE SPACES.                  
           05  FILLER                 PIC XX     VALUE ' #'.                    
           05  L435-FS-LEVEL-NO       PIC X(2)   VALUE SPACES.                  
           05  FILLER                 PIC X      VALUE '-'.                     
           05  L435-FS-MAIN-UNIT      PIC X(5)   VALUE SPACES.                  
           05  FILLER                 PIC X      VALUE SPACE.                   
           05  L435-FS-ST-NAME        PIC X(20)  VALUE SPACES.                  
           05  FILLER                 PIC X(4)   VALUE SPACES.                  
           05  L435-FS-SA             PIC X      VALUE SPACE.                   
           05  FILLER                 PIC X(3)   VALUE SPACES.                  
           05  L435-FS-LIE            PIC X      VALUE SPACE.                   
           05  FILLER                 PIC X(3)   VALUE SPACES.                  
           05  L435-FS-LIED           PIC X      VALUE SPACE.                   
           05  FILLER                 PIC X(3)   VALUE SPACES.                  
           05  L435-FS-MIE            PIC X      VALUE SPACE.                   
           05  FILLER                 PIC X(4)   VALUE SPACES.                  
           05  L435-FS-DOA            PIC X      VALUE SPACE.                   
           05  FILLER                 PIC X(4)   VALUE SPACES.                  
           05  L435-FS-SU             PIC X      VALUE SPACE.                   
           05  FILLER                 PIC X(4)   VALUE SPACES.                  
           05  L435-FS-DOA-ST         PIC X      VALUE SPACE.                   
           05  FILLER                 PIC X(3)   VALUE SPACES.                  
           05  L435-STAMP-FEE-BAL     PIC Z(8)9.99.                             
           05  FILLER                 PIC X(2)   VALUE SPACES.                  
           05  L435-KEY-ISSUE-DATE    PIC X(10)  VALUE SPACE.                   
                                                                                
      *----------------------------------------------------------------*        
      *       REPORT LAY-OUT FOR ACKNOWLEDGEMENT DETAILS               *        
      *----------------------------------------------------------------*        
       01  L435-SO-DETAIL-1.                                                    
           05  FILLER                 PIC X(65)  VALUE SPACES.                  
           05  FILLER                 PIC X(11)  VALUE 'SUB-TOTAL'.             
           05  L435-FS-NUM-SA         PIC Z9.                                   
           05  FILLER                 PIC X(2)   VALUE SPACES.                  
           05  L435-FS-NUM-LIE        PIC Z9.                                   
           05  FILLER                 PIC X(2)   VALUE SPACE.                   
           05  L435-FS-NUM-LIED       PIC Z9.                                   
           05  FILLER                 PIC X(2)   VALUE SPACES.                  
           05  L435-FS-NUM-MIE        PIC Z9.                                   
           05  FILLER                 PIC X(3)   VALUE SPACES.                  
           05  L435-FS-NUM-DOA        PIC Z9.                                   
           05  FILLER                 PIC X(3)   VALUE SPACES.                  
           05  L435-FS-NUM-SU         PIC Z9.                                   
           05  FILLER                 PIC X(3)   VALUE SPACE.                   
           05  L435-FS-NUM-DOA-ST     PIC Z9.                                   
           05  FILLER                 PIC X(27)  VALUE SPACE.                   
                                                                                
       01  L435-SO-DETAIL-1A.                                                   
           05  FILLER                 PIC X(69)  VALUE SPACES.                  
           05  FILLER                 PIC X(6)   VALUE  'TOTAL'.                
           05  L435-FS-TOT-SA         PIC ZZ9.                                  
           05  FILLER                 PIC X(54)  VALUE SPACES.                  
                                                                                
       01  L435-SO-DETAIL-2.                                                    
           05  FILLER                 PIC X(2)   VALUE SPACES.                  
           05  FILLER                 PIC X(24)  VALUE                          
               'TO: HEAD LEASE ISSUING'.                                        
           05  FILLER                 PIC X(17)  VALUE                          
               'UNIT, LEGAL DEPT'.                                              
                                                                                
       01  L435-SO-DETAIL-3.                                                    
           05  FILLER                 PIC X(6)   VALUE SPACES.                  
           05  FILLER                 PIC X(17)  VALUE                          
               'THE ATTACHED ARE'.                                              
           05  L435-SO-SET1           PIC ZZ9    VALUE ZEROES.                  
           05  FILLER                 PIC X(46)  VALUE                          
               ' COPIES OF LEGAL DOCUMENTS FOR YOUR FOLLOW-UP '.                
           05  FILLER                 PIC X(7)   VALUE 'ACTION.'.               
                                                                                
       01  L435-SO-DETAIL-4.                                                    
           05  FILLER                 PIC X(6)   VALUE SPACES.                  
           05  FILLER                 PIC X(48)  VALUE                          
               'PLEASE ACKNOWLEDGE RECEIPT BY SIGNING BELOW AND'.               
           05  FILLER                 PIC X(43)  VALUE                          
               'RETURNING THE DUPLICATE COPY TO THE SENDER'.                    
           05  FILLER                 PIC X(29)  VALUE                          
               '(SALES UNIT, AGREEMENT TEAM).'.                                 
                                                                                
       01  L435-SO-DETAIL-5.                                                    
           05  FILLER                 PIC X(6)   VALUE SPACES.                  
           05  FILLER                 PIC X(21)  VALUE                          
               'NAME OF SENDER    :'.                                           
           05  FILLER                 PIC X(25)  VALUE ALL '_'.                 
           05  FILLER                 PIC X(10)  VALUE SPACES.                  
           05  FILLER                 PIC X(13)  VALUE 'SIGNATURE :'.           
           05  FILLER                 PIC X(15)  VALUE ALL '_'.                 
           05  FILLER                 PIC X(10)  VALUE SPACES.                  
           05  FILLER                 PIC X(8)   VALUE 'DATE :'.                
           05  FILLER                 PIC X(18)  VALUE ALL '_'.                 
                                                                                
       01  L435-SO-DETAIL-6.                                                    
           05  FILLER                 PIC X(6)   VALUE SPACES.                  
           05  FILLER                 PIC X(21)  VALUE                          
               'NAME OF RECIPIENT :'.                                           
           05  FILLER                 PIC X(25)  VALUE ALL '_'.                 
           05  FILLER                 PIC X(10)  VALUE SPACES.                  
           05  FILLER                 PIC X(13)  VALUE 'SIGNATURE :'.           
           05  FILLER                 PIC X(15)  VALUE ALL '_'.                 
           05  FILLER                 PIC X(10)  VALUE SPACES.                  
           05  FILLER                 PIC X(8)   VALUE 'DATE :'.                
           05  FILLER                 PIC X(18)  VALUE ALL '_'.                 
                                                                                
                                                                                
      **********************                                                    
       PROCEDURE DIVISION.                                                      
      ******************************************************************        
      *    MAIN LOGIC PROCESS SECTION                                  *        
      ******************************************************************        
      *----------------------*                                                  
       000-MAIN-ROUTINE.                                                        
      *----------------------*                                                  
           PERFORM 100-OPEN-ROUTINE      THRU  100-EXIT.                        
           PERFORM 200-READ-BP13F310     THRU  200-EXIT                         
           PERFORM 300-PROCESS-PRINTING  THRU  300-EXIT                         
                       UNTIL WS4-EOF.                                           
           PERFORM 800-FINAL-PRT-ACKNOW  THRU  800-EXIT.                        
           PERFORM 900-CLOSE-ROUTINE     THRU  900-EXIT.                        
                                                                                
       000-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    OPEN FILES SECTION                                          *        
      ******************************************************************        
      *----------------------*                                                  
       100-OPEN-ROUTINE.                                                        
      *----------------------*                                                  
           OPEN INPUT  BP13F310                                                 
                       BM06K110                                                 
                       BP13K410                                                 
                       AB05K006                                                 
                OUTPUT P13L435A.                                                
                                                                                
           IF BM06K110-STATUS NOT = 00 AND NOT = 97                             
              DISPLAY 'OPENING ERROR, K110-STATUS ' BM06K110-STATUS             
              MOVE BM06K110-STATUS TO RETURN-CODE                               
              PERFORM 900-CLOSE-ROUTINE.                                        
                                                                                
           IF BP13K410-STATUS NOT = 00 AND NOT = 97                             
              DISPLAY 'OPENING ERROR, K410-STATUS ' BP13K410-STATUS             
              MOVE BP13K410-STATUS TO RETURN-CODE                               
              PERFORM 900-CLOSE-ROUTINE.                                        
                                                                                
           IF AB05K006-STATUS NOT = 00 AND NOT = 97                             
              DISPLAY 'OPENING ERROR, AB05K006-STATUS ' AB05K006-STATUS         
              MOVE AB05K006-STATUS TO RETURN-CODE                               
              PERFORM 900-CLOSE-ROUTINE.                                        
                                                                                
            PERFORM 5000-HEADER-EMAIL  THRU 5000-EXIT.                          
                                                                                
       100-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    READ SEQUENTIAL FILE BP13F310 AT END SET EOF-IND TO 'Y'     *        
      ******************************************************************        
      *----------------------*                                                  
       200-READ-BP13F310.                                                       
      *----------------------*                                                  
           READ BP13F310 AT END                                                 
                         MOVE 'Y' TO WS4-EOF-IND                                
                         GO TO 200-EXIT.                                        
                                                                                
           ADD  1    TO  WS3-CNT-F310-READ.                                     
                                                                                
       200-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    -  CHECK THE F310-CDE-TRANS = 'LS' TO PROCESS REPORT        *        
      *    -  READ SEQUENTIAL FILE BP13F310 UNTIL END OF FILE REACHED  *        
      ******************************************************************        
      *----------------------*                                                  
       300-PROCESS-PRINTING.                                                    
      *----------------------*                                                  
           IF F310-CDE-TRANS  =  'LS'                                           
              PERFORM 400-PROCESS-REPORT  THRU  400-EXIT.                       
                                                                                
           PERFORM 200-READ-BP13F310      THRU  200-EXIT.                       
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    CONTROL ROUTINE FOR PRINTING REPORT WITH 2 FORMATS FOR      *        
      *            EACH SALES TYPE (01, 02, 03 & 10)                   *        
      ******************************************************************        
      *----------------------*                                                  
       400-PROCESS-REPORT.                                                      
      *----------------------*                                                  
      *------------------------------------------------------------*            
      *    AT START OF PROGRAM (WS2-CNT-LINE-FS = 0)               *            
      *       -  PRINT HEADING OF FILE SENT & SALES ORDER          *            
      *       -  SET VARIABLES FOR CONTROLLING PAGE-THROW          *            
      *------------------------------------------------------------*            
           IF WS2-CNT-LINES-FS = 0                                              
              MOVE ZEROES                      TO    WS2-CNT-PAGE-FS            
              PERFORM 600-PRT-L435-FS-HEADING  THRU  600-EXIT                   
              MOVE F310-NUM-SCHEDULE           TO    WS6-PREV-LIST-NO           
           ELSE                                                                 
                                                                                
      *------------------------------------------------------------*            
      *    CHANGE OF LIST NO. (PRINT HEADINGS FOR FILE SENT)       *            
      *------------------------------------------------------------*            
           IF F310-NUM-SCHEDULE NOT  =  WS6-PREV-LIST-NO                        
              MOVE ZEROES                   TO    WS2-CNT-PAGE-FS               
              PERFORM 500-PRINT-ACKNOW-HDG  THRU  500-EXIT                      
              MOVE F310-NUM-SCHEDULE        TO    WS6-PREV-LIST-NO.             
                                                                                
           MOVE    F310-NUM-LEVEL           TO    L435-FS-LEVEL-NO.             
           MOVE    F310-NUM-MAIN            TO    L435-FS-MAIN-UNIT.            
           MOVE    F310-NUM-BLK             TO    L435-FS-BLK-NO.               
           MOVE    F310-NME-STREET          TO    L435-FS-ST-NAME.              
           MOVE    F310-REGN-NO             TO    L435-FS-REGN-NO.              
                                                                                
           PERFORM 610-STAMP-FEE-BALANCE    THRU  610-EXIT.                     
                                                                                
           PERFORM 620-KEY-ISSUE-DATE       THRU  620-EXIT.                     
                                                                                
           PERFORM 640-MOVE-K410-ACCUMSO    THRU  640-EXIT.                     
           PERFORM 700-LIST-FILE-SENT       THRU  700-EXIT.                     
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    AT CHANGE OF SALES/BRANCH OFFICE                            *        
      *       -   PRINT ACKNOWLEDGEMENT FOR PREVIOUS SALES TYPE        *        
      *       -   PRINT HEADINGS FOR CURRENT SALES TYPE                *        
      ******************************************************************        
      *----------------------*                                                  
       500-PRINT-ACKNOW-HDG.                                                    
      *----------------------*                                                  
           PERFORM 850-PRINT-ACKNOW-LINE    THRU  850-EXIT.                     
           MOVE    F310-NUM-SCHEDULE        TO    WS6-PREV-LIST-NO.             
           MOVE    ZEROES                   TO    WS2-SERIAL-NO-FS.             
           PERFORM 600-PRT-L435-FS-HEADING  THRU  600-EXIT.                     
                                                                                
       500-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    PRINT HEADINGS FOR LIST OF FILES SENT                       *        
      ******************************************************************        
      *----------------------*                                                  
       600-PRT-L435-FS-HEADING.                                                 
      *----------------------*                                                  
           ADD    1                 TO   WS2-CNT-PAGE-FS.                       
           MOVE   1                 TO   WS2-CNT-LINES-FS.                      
                                                                                
           MOVE   WS5-HD2B-DESC-FS  TO   L435-HD2B-DESC.                        
           MOVE   WS2-CNT-PAGE-FS   TO   L435-HD2B-PAGE-NO.                     
                                                                                
           MOVE FUNCTION CURRENT-DATE   TO  WS1-CURRENT-DATE.                   
                                                                                
           MOVE   WS1-CURRENT-DD    TO   L435-HD2B-DATE-DD.                     
           MOVE   WS1-CURRENT-MM    TO   L435-HD2B-DATE-MM.                     
           MOVE   WS1-CURRENT-YY    TO   L435-HD2B-DATE-YY.                     
           MOVE   WS1-CURRENT-CC    TO   L435-HD2B-DATE-CC.                     
                                                                                
           MOVE   F310-NUM-SCHEDULE TO   L435-HD4-LIST-NO.                      
                                                                                
           WRITE L435A-PRINT-REC FROM L435-HDG-1     AFTER PAGE.                
           WRITE L435A-PRINT-REC FROM L435-HDG-2A    AFTER ADVANCING 2.         
           WRITE L435A-PRINT-REC FROM L435-HDG-2B    AFTER ADVANCING 2.         
           WRITE L435A-PRINT-REC FROM L435-HDG-4     AFTER ADVANCING 2.         
           WRITE L435A-PRINT-REC FROM L435-FS-HDG-5  AFTER ADVANCING 3.         
           WRITE L435A-PRINT-REC FROM L435-FS-HDG-5A AFTER ADVANCING 1.         
                                                                                
       600-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    TO GET STAMP FEE BALANCE FROM AB05K006                      *        
      ******************************************************************        
      *----------------------*                                                  
       610-STAMP-FEE-BALANCE.                                                   
      *----------------------*                                                  
           MOVE    F310-SCH-ACC         TO   K006-HDB-REF-SF.                   
           PERFORM 615-READ-AB05K006    THRU 615-EXIT.                          
                                                                                
           IF AB05K006-FND                                                      
              IF K006-BALANCES NOT NUMERIC                                      
                 MOVE ZEROES            TO   K006-BALANCES                      
              END-IF                                                            
              MOVE K006-BALANCES        TO   L435-STAMP-FEE-BAL                 
           ELSE                                                                 
              MOVE  ZERO                TO   L435-STAMP-FEE-BAL                 
           END-IF.                                                              
                                                                                
       610-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    READ VSAM FILE AB05K006 USING F310-SCH-ACC AS KEY           *        
      ******************************************************************        
      *----------------------*                                                  
       615-READ-AB05K006.                                                       
      *----------------------*                                                  
           READ AB05K006.                                                       
                                                                                
           EVALUATE AB05K006-STATUS                                             
           WHEN 00                                                              
              MOVE  'Y'               TO   WS-AB05K006-FND-TAG                  
           WHEN 23                                                              
              MOVE  SPACE             TO   WS-AB05K006-FND-TAG                  
              DISPLAY 'RECORD NOT FOUND IN AB05K006, SCH : '                    
                                           F310-SCH-ACC                         
           WHEN OTHER                                                           
              DISPLAY 'ERROR READING AB05K006, STATUS ' AB05K006-STATUS         
                      ', SCH : '  F310-SCH-ACC                                  
              MOVE AB05K006-STATUS    TO   RETURN-CODE                          
              PERFORM 900-CLOSE-ROUTINE                                         
           END-EVALUATE.                                                        
                                                                                
       615-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    TO GET KEY ISSUE DATE FROM BM06K110                         *        
      ******************************************************************        
      *----------------------*                                                  
       620-KEY-ISSUE-DATE.                                                      
      *----------------------*                                                  
           MOVE    F310-SCH-ACC         TO   K110-KEY-FLD.                      
           PERFORM 625-READ-BM06K110    THRU 625-EXIT.                          
                                                                                
           IF K110-DTE-KEY-ISSUED NOT NUMERIC                                   
              MOVE ZEROES               TO   K110-DTE-KEY-ISSUED                
           END-IF.                                                              
                                                                                
           STRING K110-DTE-KEY-ISSUED(7:2) '/'                                  
                  K110-DTE-KEY-ISSUED(5:2) '/'                                  
                  K110-DTE-KEY-ISSUED(1:4)                                      
                  DELIMITED BY SIZE INTO L435-KEY-ISSUE-DATE                    
           END-STRING.                                                          
                                                                                
       620-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    READ VSAM FILE BM06K110 USING F310-SCH-ACC AS KEY           *        
      ******************************************************************        
      *----------------------*                                                  
       625-READ-BM06K110.                                                       
      *----------------------*                                                  
           READ BM06K110.                                                       
                                                                                
           EVALUATE BM06K110-STATUS                                             
           WHEN 00                                                              
              CONTINUE                                                          
           WHEN 23                                                              
              MOVE ZEROES             TO   K110-DTE-KEY-ISSUED                  
              DISPLAY 'RECORD NOT FOUND IN BM06K110, SCH : '                    
                                           F310-SCH-ACC                         
           WHEN OTHER                                                           
              DISPLAY 'ERROR READING BM06K110, STATUS ' BM06K110-STATUS         
                      ', SCH : '  F310-SCH-ACC                                  
              MOVE BM06K110-STATUS    TO   RETURN-CODE                          
              PERFORM 900-CLOSE-ROUTINE                                         
           END-EVALUATE.                                                        
                                                                                
       625-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    READ BP13K410 RECORD AND MOVE VALUES TO L435 PRINT FIELDS   *        
      ******************************************************************        
      *----------------------*                                                  
       640-MOVE-K410-ACCUMSO.                                                   
      *----------------------*                                                  
           MOVE  F310-REGN-NO TO K410-KEY-FLD.                                  
                                                                                
           READ BP13K410.                                                       
                                                                                
           IF BP13K410-STATUS = 00                                              
              NEXT SENTENCE                                                     
           ELSE                                                                 
           IF BP13K410-STATUS = 23                                              
              DISPLAY 'RECORD NOT FOUND IN K410  ' K410-KEY-FLD                 
              MOVE SPACES TO BP13K410-REC                                       
              INITIALIZE BP13K410-REC                                           
              DISPLAY SPACES                                                    
           ELSE                                                                 
              DISPLAY 'ERROR READING K410, K410-STATUS ' BP13K410-STATUS        
                      ',     K410-KEY-FLD  =  ' K410-KEY-FLD                    
              DISPLAY SPACES                                                    
              MOVE BP13K410-STATUS TO RETURN-CODE                               
              PERFORM 900-CLOSE-ROUTINE.                                        
                                                                                
           IF  K410-AMT-LEASE-REGN-FEE   IS  NOT NUMERIC                        
               MOVE ZEROES               TO  K410-AMT-LEASE-REGN-FEE.           
                                                                                
           IF   K410-AMT-LEASE-REGN-FEE   >   0                                 
                ADD    1                  TO  WS2-NUM-LIE                       
                ADD    1                  TO  WS2-NUM-LIE-TOTAL                 
                MOVE  '1'                 TO  L435-FS-LIE                       
                MOVE  '1'                 TO  L435-FS-LIED                      
           ELSE                                                                 
                MOVE SPACES               TO  L435-FS-LIE                       
                MOVE SPACES               TO  L435-FS-LIED.                     
                                                                                
            IF  K410-AMT-LOAN > ZEROES                                          
                IF  K410-CDE-PRINT-DOA        =   'Y'                           
                    ADD    1                  TO  WS2-NUM-DOA                   
                    ADD    1                  TO  WS2-NUM-DOA-TOTAL             
                    MOVE  '1'                 TO  L435-FS-DOA                   
                ELSE                                                            
                    MOVE SPACES               TO  L435-FS-DOA                   
            ELSE                                                                
                MOVE SPACES               TO  L435-FS-DOA.                      
                                                                                
            IF  K410-AMT-LOAN > ZEROES                                          
              IF   K410-CDE-PRINT-MORT       =   'Y'                            
                ADD    1                  TO   WS2-NUM-MIE                      
                ADD    1                  TO   WS2-NUM-MIE-TOTAL                
                MOVE  '1'                 TO   L435-FS-MIE                      
            ELSE                                                                
                MOVE SPACES               TO   L435-FS-MIE                      
              ELSE                                                              
                MOVE SPACES               TO   L435-FS-MIE.                     
                                                                                
           IF   K410-CDE-SA-TP            =    'Y'                              
                MOVE SPACES               TO   L435-FS-SU                       
           ELSE                                                                 
           IF   K410-AMT-PREMIUM-NEW > 0                                        
               IF   K410-CDE-PRINT-SUPL-AGMT  =    'Y'                          
                ADD    1                  TO   WS2-NUM-SU                       
                ADD    1                  TO   WS2-NUM-SU-TOTAL                 
                MOVE  '1'                 TO   L435-FS-SU                       
               ELSE                                                             
                MOVE SPACES               TO   L435-FS-SU                       
           ELSE                                                                 
                MOVE SPACES               TO   L435-FS-SU.                      
                                                                                
           IF   K410-DTE-ARGORDER NOT = ZEROS  AND SPACES AND LOW-VALUES        
                ADD    1                  TO   WS2-NUM-SA                       
                ADD    1                  TO   WS2-NUM-SA-TOTAL                 
                MOVE  '1'                 TO   L435-FS-SA                       
           ELSE                                                                 
           IF   K410-CDE-SALES-TYPE  NOT = '10'                                 
                IF   K410-DTE-KEY-ISSUE NOT = ZEROS AND SPACES AND              
                                              LOW-VALUES                        
                     ADD    1             TO  WS2-NUM-SA                        
                     ADD    1             TO  WS2-NUM-SA-TOTAL                  
                     MOVE  '1'            TO  L435-FS-SA                        
                ELSE                                                            
                     DISPLAY 'NO SA '                                           
                     MOVE SPACES          TO  L435-FS-SA                        
            ELSE                                                                
                DISPLAY 'NO SA '                                                
                MOVE SPACES               TO  L435-FS-SA.                       
                                                                                
      *  IMPLEMENT OF OMISSION OF DUPLICATES ON 26/8/96 AS                      
      *  ADVISED BY DORIS KONG.                                                 
            IF  K410-CDE-SUB-TRANSFER = 'Y' OR 'I' OR 'O' OR 'D' OR 'W'         
                                        OR 'S'                                  
                ADD    1     TO    WS2-NUM-DOA-ST                               
                                                                                
                ADD    1     TO    WS2-NUM-DOA-ST-TOTAL                         
                                                                                
                MOVE  '1'    TO    L435-FS-DOA-ST                               
                                   L435-FS-SA                                   
            ELSE                                                                
                MOVE SPACES TO     L435-FS-DOA-ST                               
            END-IF.                                                             
                                                                                
       640-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    PRINT DETAILS OF FILES SENT TO AREA OFFICE                  *        
      *          FOR SALES TYPE '01', '02', '03', '5B', '5C'  &  '10'  *        
      *          AND            '2B'.                                  *        
      ******************************************************************        
      *----------------------*                                                  
       700-LIST-FILE-SENT.                                                      
      *----------------------*                                                  
           ADD   1                 TO    WS2-SERIAL-NO-FS                       
                                         WS2-CNT-LINES-FS.                      
                                                                                
           MOVE  WS2-SERIAL-NO-FS  TO    L435-FS-SERIAL-NO.                     
           MOVE  F310-SCH-ACC      TO    WS6-SCH-ACC.                           
           MOVE  WS6-SCH           TO    L435-FS-SCHEME.                        
           MOVE  WS6-ACC           TO    L435-FS-ACC.                           
           MOVE  WS6-CHK           TO    L435-FS-CHK.                           
           MOVE  WS6-ACC-TYPE      TO    L435-FS-ACC-TYPE.                      
                                                                                
           WRITE L435A-PRINT-REC   FROM  L435-FS-DETAIL-1 AFTER 1.              
                                                                                
           IF WS2-CNT-LINES-FS = WS5-MAX-LINE-FS                                
              PERFORM 500-PRINT-ACKNOW-HDG  THRU  500-EXIT                      
              MOVE    1                     TO    WS2-CNT-LINES-FS.             
                                                                                
       700-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    IF THE LAST RECORD (SALES TYPE) READ BEFORE END OF FILE     *        
      *       DOES NOT HAVE ACKNOWLEDGEMENT PRINTED                    *        
      *       -    PRINT ACKNOWLEDGEMENT                               *        
      ******************************************************************        
      *----------------------*                                                  
       800-FINAL-PRT-ACKNOW.                                                    
      *----------------------*                                                  
           IF  WS4-EOF AND WS4-PRTED-ACK-IND =    SPACE                         
               PERFORM 850-PRINT-ACKNOW-LINE THRU 850-EXIT.                     
                                                                                
       800-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
      ******************************************************************        
      *    PRINT ACKNOWLEDGEMENT LINE AT END OF EACH PAGE              *        
      ******************************************************************        
      *----------------------*                                                  
       850-PRINT-ACKNOW-LINE.                                                   
      *----------------------*                                                  
           MOVE    SPACE             TO    WS4-PRTED-ACK-IND.                   
           MOVE    WS2-NUM-SA        TO    L435-FS-NUM-SA.                      
           MOVE    WS2-NUM-SU        TO    L435-FS-NUM-SU.                      
           MOVE    WS2-NUM-DOA       TO    L435-FS-NUM-DOA.                     
           MOVE    WS2-NUM-LIE       TO    L435-FS-NUM-LIE.                     
           MOVE    WS2-NUM-LIE       TO    L435-FS-NUM-LIED.                    
           MOVE    WS2-NUM-MIE       TO    L435-FS-NUM-MIE.                     
           MOVE    WS2-NUM-DOA-ST    TO    L435-FS-NUM-DOA-ST.                  
           WRITE   L435A-PRINT-REC   FROM  L435-SO-DETAIL-1  AFTER 3.           
                                                                                
           COMPUTE WS2-NUM-DOA = WS2-NUM-SU   +  WS2-NUM-DOA    +               
                                 WS2-NUM-LIE  +  WS2-NUM-MIE    +               
                                 WS2-NUM-LIE  +                                 
                                 WS2-NUM-SA   +  WS2-NUM-DOA-ST                 
                                                                                
           MOVE    WS2-NUM-DOA       TO    L435-SO-SET1                         
                                           L435-FS-TOT-SA.                      
                                                                                
           WRITE   L435A-PRINT-REC   FROM  L435-SO-DETAIL-1A AFTER 2.           
           WRITE   L435A-PRINT-REC   FROM  L435-SO-DETAIL-2 AFTER 2.            
           WRITE   L435A-PRINT-REC   FROM  L435-SO-DETAIL-3 AFTER 2.            
           WRITE   L435A-PRINT-REC   FROM  L435-SO-DETAIL-4 AFTER 1.            
           WRITE   L435A-PRINT-REC   FROM  L435-SO-DETAIL-5 AFTER 2.            
           WRITE   L435A-PRINT-REC   FROM  L435-SO-DETAIL-6 AFTER 2.            
           MOVE    SPACES            TO    L435A-PRINT-REC.                     
           WRITE   L435A-PRINT-REC.                                             
                                                                                
           MOVE    ZEROS             TO   WS2-NUM-DOA   WS2-NUM-SU              
                                          WS2-NUM-LIE   WS2-NUM-MIE             
                                          WS2-NUM-SA    WS2-NUM-DOA-ST.         
                                                                                
       850-EXIT.                                                                
           EXIT.                                                                
                                                                                
      *================================================================*        
       5000-HEADER-EMAIL.                                                       
      *================================================================*        
                                                                                
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT1.                            
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT2.                            
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT3.                            
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT4.                            
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT5.                            
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT7.                            
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT7B.                           
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT7B1.                          
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT7C.                           
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT7D.                           
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT7E.                           
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT7F.                           
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT8.                            
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT9.                            
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT10.                           
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT11.                           
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT12.                           
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT13B.                          
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT13D.                          
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT13D1.                         
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT13D2.                         
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT13D3.                         
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT13E.                          
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT13F.                          
            WRITE L435A-PRINT-REC FROM WS-MAIL-RPT15.                           
                                                                                
            STRING  FUNCTION CURRENT-DATE(7:2) '/'                              
                    FUNCTION CURRENT-DATE(5:2) '/'                              
                    FUNCTION CURRENT-DATE(1:4)                                  
            DELIMITED BY SIZE INTO WS-DATE-RPT.                                 
                                                                                
            WRITE L435A-PRINT-REC FROM WS-DATE-RPT-DTL.                         
                                                                                
            MOVE SPACES TO  L435A-PRINT-REC.                                    
            WRITE   L435A-PRINT-REC.                                            
                                                                                
       5000-EXIT.                                                               
            EXIT.                                                               
                                                                                
                                                                                
      ******************************************************************        
      *    -  DISPLAY NECESSARY STATISTICS                             *        
      *    -  CLOSE ALL FILES   AND   STOP RUN                         *        
      ******************************************************************        
      *----------------------*                                                  
       900-CLOSE-ROUTINE.                                                       
      *----------------------*                                                  
           DISPLAY SPACES.                                                      
           DISPLAY ' ****   BP13C435 CONTROL TOTAL   ****'.                     
           DISPLAY SPACES.                                                      
           DISPLAY ' NO. OF RECORDS READ FROM (BP13F310)          :  '          
                     WS3-CNT-F310-READ.                                         
           DISPLAY ' DEED OF ASSIGNMENT        SENT TO LEGAL DEPT :  '          
                     WS2-NUM-DOA-TOTAL.                                         
           DISPLAY ' SUPPLEMENTARY AGREEMENT   SENT TO LEGAL DEPT :  '          
                     WS2-NUM-SU-TOTAL.                                          
                                                                                
           CLOSE BP13F310                                                       
                 BM06K110                                                       
                 BP13K410                                                       
                 AB05K006                                                       
                 P13L435A.                                                      
                                                                                
           IF BM06K110-STATUS NOT = 00                                          
              DISPLAY 'CLOSING ERROR, K110-STATUS ' BM06K110-STATUS             
              MOVE BM06K110-STATUS TO RETURN-CODE.                              
                                                                                
           IF BP13K410-STATUS NOT = 00                                          
              DISPLAY 'CLOSING ERROR, K410-STATUS ' BP13K410-STATUS             
              MOVE BP13K410-STATUS TO RETURN-CODE.                              
                                                                                
           IF AB05K006-STATUS NOT = 00                                          
              DISPLAY 'CLOSING ERROR, AB05K006-STATUS ' AB05K006-STATUS         
              MOVE AB05K006-STATUS TO RETURN-CODE.                              
                                                                                
           STOP RUN.                                                            
                                                                                
       900-EXIT.                                                                
           EXIT.                                                                
