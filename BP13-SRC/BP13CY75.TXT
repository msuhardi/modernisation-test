       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13CY75.                                                 
       AUTHOR.        PAULO CAMIA LEGASPI.                                      
       DATE-WRITTEN.  27 SEPTEMBER 2010.                                        
      *****************************************************************         
      * OBJECTIVE  - TO PRINT MONTHLY REPORT ON BREAKDOWN OF MORTGAGE           
      *              LOAN GIVEN TO PERMANENT RESIDENTS AND OWNERS OF            
      *              PRIVATE RESIDENTIAL PROPERTIES.                            
      *              (NON-CONCESSIONARY ACCTS)                                  
      *                                                                         
      * SUBROUTINE    - BP13C950 - EXTRACT INTEREST TABLE                       
      *                                                                         
      * IDENTICAL PGM - NIL                                                     
      *                                                                         
      *----------------------------------------------------------------         
      * REF NO    DATE     BY   AMENDMENTS/ENHANCEMENTS                         
      * --------  -------- ---  -----------------------                         
      * BP134033  20101028 PCL3 NEW PROGRAM                                     
      *****************************************************************         
                                                                                
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT  BP13FD00  ASSIGN  TO   BP13FD00.                             
           SELECT  SY02F001  ASSIGN  TO   SY02F001.                             
           SELECT  BP13LY75  ASSIGN  TO   BP13LY75.                             
                                                                                
                                                                                
       DATA DIVISION.                                                           
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD  BP13FD00                     BLOCK CONTAINS 0 RECORDS                
                                        RECORD CONTAINS 1600 CHARACTERS         
                                        LABEL RECORDS ARE STANDARD              
                                        RECORDING MODE IS F.                    
       COPY BP13FD00.                                                           
                                                                                
       FD  BP13LY75                     BLOCK CONTAINS 0 RECORDS                
                                        RECORD CONTAINS 132 CHARACTERS          
                                        LABEL RECORDS ARE OMITTED               
                                        RECORDING MODE IS F.                    
       01  BP13LY75-REC                 PIC X(132).                             
                                                                                
                                                                                
       COPY SY02F001.                                                           
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-RETURN-CODE                PIC 9(02)   VALUE 00.                  
                                                                                
       01  WS-VARIABLES.                                                        
           05  WS-FD00-EOF             PIC X         VALUE 'N'.                 
           05  WS-AMT-LOAN-5-MKT       PIC 9(11)V99  VALUE 0.                   
           05  WS-AMT-LOAN-10-MKT      PIC 9(11)V99  VALUE 0.                   
           05  WS-AMT-LOAN-15-MKT      PIC 9(11)V99  VALUE 0.                   
           05  WS-AMT-LOAN-20-MKT      PIC 9(11)V99  VALUE 0.                   
           05  WS-AMT-LOAN-25-MKT      PIC 9(11)V99  VALUE 0.                   
           05  WS-AMT-LOAN-30-MKT      PIC 9(11)V99  VALUE 0.                   
           05  WS-AMT-LOAN-TOT-MKT     PIC 9(11)V99  VALUE 0.                   
           05  WS-AMT-LOAN-5-NC        PIC 9(11)V99  VALUE 0.                   
           05  WS-AMT-LOAN-10-NC       PIC 9(11)V99  VALUE 0.                   
           05  WS-AMT-LOAN-15-NC       PIC 9(11)V99  VALUE 0.                   
           05  WS-AMT-LOAN-20-NC       PIC 9(11)V99  VALUE 0.                   
           05  WS-AMT-LOAN-25-NC       PIC 9(11)V99  VALUE 0.                   
           05  WS-AMT-LOAN-30-NC       PIC 9(11)V99   VALUE 0.                  
           05  WS-AMT-LOAN-TOT-NC      PIC 9(11)V99   VALUE 0.                  
           05  WS-AMT-LOAN-5-FIN       PIC 9(11)V99  VALUE 0.                   
           05  WS-AMT-LOAN-10-FIN      PIC 9(11)V99  VALUE 0.                   
           05  WS-AMT-LOAN-15-FIN      PIC 9(11)V99  VALUE 0.                   
           05  WS-AMT-LOAN-20-FIN      PIC 9(11)V99  VALUE 0.                   
           05  WS-AMT-LOAN-25-FIN      PIC 9(11)V99  VALUE 0.                   
           05  WS-AMT-LOAN-30-FIN      PIC 9(11)V99  VALUE 0.                   
           05  WS-AMT-LOAN-TOT-FIN     PIC 9(11)V99  VALUE 0.                   
           05  WS-AMT-OS-5-NC          PIC S9(11)V99  VALUE +0.                 
           05  WS-AMT-OS-10-NC         PIC S9(11)V99  VALUE +0.                 
           05  WS-AMT-OS-15-NC         PIC S9(11)V99  VALUE +0.                 
           05  WS-AMT-OS-20-NC         PIC S9(11)V99  VALUE +0.                 
           05  WS-AMT-OS-25-NC         PIC S9(11)V99  VALUE +0.                 
           05  WS-AMT-OS-30-NC         PIC S9(11)V99  VALUE +0.                 
           05  WS-AMT-OS-TOT-NC        PIC S9(11)V99  VALUE +0.                 
           05  WS-PCT-INT              PIC 99V99.                               
           05  WS-AMT-OS-5-MKT         PIC S9(11)V99 VALUE +0.                  
           05  WS-AMT-OS-10-MKT        PIC S9(11)V99 VALUE +0.                  
           05  WS-AMT-OS-15-MKT        PIC S9(11)V99 VALUE +0.                  
           05  WS-AMT-OS-20-MKT        PIC S9(11)V99 VALUE +0.                  
           05  WS-AMT-OS-25-MKT        PIC S9(11)V99 VALUE +0.                  
           05  WS-AMT-OS-30-MKT        PIC S9(11)V99 VALUE +0.                  
           05  WS-AMT-OS-TOT-MKT       PIC S9(11)V99 VALUE +0.                  
           05  WS-AMT-OS-5-FIN         PIC S9(11)V99 VALUE +0.                  
           05  WS-AMT-OS-10-FIN        PIC S9(11)V99 VALUE +0.                  
           05  WS-AMT-OS-15-FIN        PIC S9(11)V99 VALUE +0.                  
           05  WS-AMT-OS-20-FIN        PIC S9(11)V99 VALUE +0.                  
           05  WS-AMT-OS-25-FIN        PIC S9(11)V99 VALUE +0.                  
           05  WS-AMT-OS-30-FIN        PIC S9(11)V99 VALUE +0.                  
           05  WS-AMT-OS-TOT-FIN       PIC S9(11)V99 VALUE +0.                  
           05  WS-NUM-REPYMT-PERIOD    PIC 99      VALUE 0.                     
           05  WS-CDE-LOAN-SCH         PIC X(1)      VALUE SPACE.               
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-CNT-FD00             PIC 9(7)  VALUE 0.                       
           05  WS-CNT-5-MKT            PIC 9(7)  VALUE 0.                       
           05  WS-CNT-10-MKT           PIC 9(7)  VALUE 0.                       
           05  WS-CNT-15-MKT           PIC 9(7)  VALUE 0.                       
           05  WS-CNT-20-MKT           PIC 9(7)  VALUE 0.                       
           05  WS-CNT-25-MKT           PIC 9(7)  VALUE 0.                       
           05  WS-CNT-30-MKT           PIC 9(7)  VALUE 0.                       
           05  WS-CNT-TOT-MKT          PIC 9(7)  VALUE 0.                       
           05  WS-CNT-NC               PIC 9(7)  VALUE 0.                       
           05  WS-CNT-5-NC             PIC 9(7)  VALUE 0.                       
           05  WS-CNT-10-NC            PIC 9(7)  VALUE 0.                       
           05  WS-CNT-15-NC            PIC 9(7)  VALUE 0.                       
           05  WS-CNT-20-NC            PIC 9(7)  VALUE 0.                       
           05  WS-CNT-25-NC            PIC 9(7)  VALUE 0.                       
           05  WS-CNT-30-NC            PIC 9(7)  VALUE 0.                       
           05  WS-CNT-TOT-NC           PIC 9(7)  VALUE 0.                       
           05  WS-CNT-5-FIN            PIC 9(7)  VALUE 0.                       
           05  WS-CNT-10-FIN           PIC 9(7)  VALUE 0.                       
           05  WS-CNT-15-FIN           PIC 9(7)  VALUE 0.                       
           05  WS-CNT-20-FIN           PIC 9(7)  VALUE 0.                       
           05  WS-CNT-25-FIN           PIC 9(7)  VALUE 0.                       
           05  WS-CNT-30-FIN           PIC 9(7)  VALUE 0.                       
           05  WS-CNT-TOT-FIN          PIC 9(7)  VALUE 0.                       
           05  WS-CNT-LOAN-SCH-A       PIC 9(7)  VALUE 0.                       
           05  WS-CNT-LOAN-SCH-M       PIC 9(7)  VALUE 0.                       
           05  WS-PAGE-CTR             PIC 9(6)  VALUE 0.                       
                                                                                
       01  WS-DTE-CURRENT.                                                      
           05  WS-DTE-CURRENT-CCYY     PIC 9(4).                                
           05  WS-DTE-CURRENT-MM       PIC 9(2).                                
           05  WS-DTE-CURRENT-DD       PIC 9(2).                                
                                                                                
       01  WS-DTE-PREV.                                                         
           05  WS-DTE-PREV-CCYY        PIC 9(4).                                
           05  WS-DTE-PREV-MM          PIC 9(2).                                
           05  WS-DTE-PREV-DD          PIC 9(2).                                
                                                                                
       01  WS-DTE-INT-EFF-CUR.                                                  
           05  WS-DTE-INT-EFF-CCYY     PIC 9(4).                                
           05  WS-DTE-INT-EFF-MM       PIC 9(2).                                
           05  WS-DTE-INT-EFF-DD       PIC 9(2).                                
                                                                                
      *-----------------------------------------------------------*             
      *    WS VARIABLES PASSED  TO SUB-PROGRAM "BP13C950"         *             
      *-----------------------------------------------------------*             
       01  C950-FIELD.                                                          
           05  C950-PROCESS-DATE       PIC X(08).                               
           05  C950-PROCESS-DATE-NUM REDEFINES C950-PROCESS-DATE.               
               10  C950-PROCESS-CC     PIC 99.                                  
               10  C950-PROCESS-YY     PIC 99.                                  
               10  C950-PROCESS-MM     PIC 99.                                  
               10  C950-PROCESS-DD     PIC 99.                                  
           05  C950-INTREST-RATE       PIC 9(02)V9(4).                          
           05  C950-FACT               PIC 9(02).                               
           05  C950-REPYMT-PERIOD      PIC 9(02).                               
           05  C950-CDE-LOAN-SCH       PIC X(01).                               
                                                                                
       01  WS-HEADING-1.                                                        
           05  WS-LISTID               PIC X(10).                               
           05  FILLER                  PIC X(5) VALUE SPACES.                   
           05  FILLER                  PIC X(4) VALUE 'HDB3'.                   
           05  FILLER                  PIC X(21) VALUE SPACES.                  
           05  FILLER                  PIC X(75) VALUE                          
               'H O U S I N G  &  D E V E L O P M E N T  B O A R D'.            
           05  FILLER                  PIC X(7)  VALUE 'DATE : '.               
           05  WS-HDG-1-DD             PIC XX.                                  
           05  FILLER                  PIC X     VALUE '/'.                     
           05  WS-HDG-1-MM             PIC XX.                                  
           05  FILLER                  PIC X     VALUE '/'.                     
           05  WS-HDG-1-CCYY           PIC X(4).                                
                                                                                
       01  WS-HEADING-2.                                                        
           05  FILLER                  PIC X(45) VALUE SPACES.                  
           05  FILLER                  PIC X(70) VALUE                          
               '          SYSTEM OF COMMITMENT          '.                      
           05  FILLER                  PIC X(7)  VALUE 'PAGE : '.               
           05  WS-HDG-2-PAGE           PIC ZZZ,ZZ9  VALUE ZEROES.               
           05  FILLER                  PIC X(9)  VALUE SPACES.                  
                                                                                
       01  WS-HEADING-3.                                                        
           05  FILLER                  PIC X(31) VALUE                          
               'TO: FINANCE DEPT'.                                              
           05  FILLER                  PIC X(67) VALUE                          
               'BREAKDOWN OF MORTGAGE LOANS GIVEN TO PERMANENT RESIDENTS        
      -        ' AND OWNERS'.                                                   
           05  FILLER                  PIC X(34) VALUE SPACES.                  
                                                                                
       01  WS-HEADING-4.                                                        
           05  FILLER                  PIC X(38) VALUE SPACES.                  
           05  FILLER                  PIC X(40) VALUE                          
               'OF PRIVATE RESIDENTIAL PROPERTIES AS AT'.                       
           05  WS-HDG-4-DD             PIC XX.                                  
           05  FILLER                  PIC X     VALUE '/'.                     
           05  WS-HDG-4-MM             PIC XX.                                  
           05  FILLER                  PIC X     VALUE '/'.                     
           05  WS-HDG-4-CCYY           PIC X(4).                                
           05  FILLER                  PIC X(44) VALUE SPACES.                  
                                                                                
       01  WS-HEADING-5.                                                        
           05  FILLER                  PIC X(40) VALUE SPACES.                  
           05  WS-TITLE                PIC X(50) VALUE SPACES.                  
                                                                                
       01  WS-HEADING-6.                                                        
           05  FILLER                  PIC X(9)  VALUE SPACES.                  
           05  FILLER                  PIC X(23) VALUE                          
               'LOAN REPAY'.                                                    
           05  FILLER                  PIC X(21) VALUE                          
               'NO OF'.                                                         
           05  FILLER                  PIC X(25) VALUE                          
               'INTEREST'.                                                      
           05  FILLER                  PIC X(30) VALUE                          
               'LOAN'.                                                          
           05  FILLER                  PIC X(33) VALUE                          
               'AMOUNT'.                                                        
                                                                                
       01  WS-HEADING-7.                                                        
           05  FILLER                  PIC X(9)  VALUE SPACES.                  
           05  FILLER                  PIC X(23) VALUE                          
               'PERIOD'.                                                        
           05  FILLER                  PIC X(21) VALUE                          
               'CASES'.                                                         
           05  FILLER                  PIC X(25) VALUE                          
               'RATE'.                                                          
           05  FILLER                  PIC X(30) VALUE                          
               'GRANTED'.                                                       
           05  FILLER                  PIC X(33) VALUE                          
               'OUTSTANDING'.                                                   
                                                                                
       01  WS-HEADING-8.                                                        
           05  FILLER                  PIC X(9)  VALUE SPACES.                  
           05  FILLER                  PIC X(23) VALUE                          
               '-----------'.                                                   
           05  FILLER                  PIC X(21) VALUE                          
               '---------'.                                                     
           05  FILLER                  PIC X(20) VALUE                          
               '--------'.                                                      
           05  FILLER                  PIC X(30) VALUE                          
               '-----------------'.                                             
           05  FILLER                  PIC X(33) VALUE                          
               '--------------------'.                                          
                                                                                
       01  WS-HEADING-6B.                                                       
           05  FILLER                  PIC X(9)  VALUE SPACES.                  
           05  FILLER                  PIC X(23) VALUE                          
               'LOAN REPAY'.                                                    
           05  FILLER                  PIC X(21) VALUE                          
               'NO OF'.                                                         
           05  FILLER                  PIC X(25) VALUE SPACES.                  
           05  FILLER                  PIC X(30) VALUE                          
               'LOAN'.                                                          
           05  FILLER                  PIC X(33) VALUE                          
               'AMOUNT'.                                                        
                                                                                
       01  WS-HEADING-7B.                                                       
           05  FILLER                  PIC X(9)  VALUE SPACES.                  
           05  FILLER                  PIC X(23) VALUE                          
               'PERIOD'.                                                        
           05  FILLER                  PIC X(21) VALUE                          
               'CASES'.                                                         
           05  FILLER                  PIC X(25) VALUE SPACES.                  
           05  FILLER                  PIC X(30) VALUE                          
               'GRANTED'.                                                       
           05  FILLER                  PIC X(33) VALUE                          
               'OUTSTANDING'.                                                   
                                                                                
       01  WS-HEADING-8B.                                                       
           05  FILLER                  PIC X(9)  VALUE SPACES.                  
           05  FILLER                  PIC X(23) VALUE                          
               '-----------'.                                                   
           05  FILLER                  PIC X(21) VALUE                          
               '---------'.                                                     
           05  FILLER                  PIC X(20) VALUE SPACES.                  
           05  FILLER                  PIC X(30) VALUE                          
               '-----------------'.                                             
           05  FILLER                  PIC X(33) VALUE                          
               '--------------------'.                                          
                                                                                
       01  WS-DETAIL-LINE.                                                      
           05  FILLER                  PIC X(9)  VALUE SPACES.                  
           05  WS-DET-REPAY-PERIOD     PIC X(23) VALUE SPACES.                  
           05  WS-DET-NO-OF-CASES      PIC Z,ZZZ,ZZ9 VALUE ZEROES.              
           05  FILLER                  PIC X(12) VALUE SPACES.                  
           05  WS-DET-INT-RATE         PIC Z9.99 VALUE ZEROES.                  
           05  FILLER                  PIC X(15) VALUE SPACES.                  
           05  WS-DET-LOAN-GRANTED     PIC ZZ,ZZZ,ZZZ,ZZ9.99                    
                                                       VALUE ZEROES.            
           05  FILLER                  PIC X(12) VALUE SPACES.                  
           05  WS-DET-LOAN-BALANCE     PIC ZZ,ZZZ,ZZZ,ZZ9.99CR                  
                                                       VALUE ZEROES.            
           05  FILLER                  PIC X(17) VALUE SPACES.                  
                                                                                
       01  WS-DETAIL-LINE-FIN.                                                  
           05  FILLER                  PIC X(9)  VALUE SPACES.                  
           05  WS-DET-REPAY-PERIOD-FIN PIC X(23) VALUE SPACES.                  
           05  WS-DET-NO-OF-CASES-FIN  PIC Z,ZZZ,ZZ9 VALUE ZEROES.              
           05  FILLER                  PIC X(32) VALUE SPACES.                  
           05  WS-DET-LOAN-GRANTED-FIN PIC ZZ,ZZZ,ZZZ,ZZ9.99                    
                                                       VALUE ZEROES.            
           05  FILLER                  PIC X(12) VALUE SPACES.                  
           05  WS-DET-LOAN-BALANCE-FIN PIC ZZ,ZZZ,ZZZ,ZZ9.99CR                  
                                                       VALUE ZEROES.            
           05  FILLER                  PIC X(17) VALUE SPACES.                  
                                                                                
       01  WS-FOOTING.                                                          
           05  FILLER                  PIC X(9)  VALUE SPACES.                  
           05  FILLER                  PIC X(23) VALUE 'TOTAL'.                 
           05  WS-FOOT-CASES-TOTAL     PIC Z,ZZZ,ZZ9 VALUE ZEROES.              
           05  FILLER                  PIC X(32) VALUE SPACES.                  
           05  WS-FOOT-LOAN-TOTAL      PIC ZZ,ZZZ,ZZZ,ZZ9.99                    
                                                      VALUE ZEROES.             
           05  FILLER                  PIC X(12) VALUE SPACES.                  
           05  WS-FOOT-OS-TOTAL        PIC ZZ,ZZZ,ZZZ,ZZ9.99CR                  
                                                      VALUE ZEROES.             
           05  FILLER                  PIC X(17) VALUE SPACES.                  
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
                                                                                
      *----------------------------------------------------------------*        
       0000-MAIN-PARA.                                                          
      *----------------------------------------------------------------*        
                                                                                
           PERFORM 1000-START-UP          THRU 1000-EXIT.                       
           PERFORM 2000-PROCESS-BP13FD00  THRU 2000-EXIT                        
              UNTIL WS-FD00-EOF = 'Y'.                                          
           PERFORM 6000-PRINT-MARKET      THRU 6000-EXIT.                       
           PERFORM 7000-PRINT-NON-CONC    THRU 7000-EXIT.                       
           PERFORM 8000-PRINT-FINAL       THRU 8000-EXIT.                       
           PERFORM 9999-WRAP-UP.                                                
                                                                                
       0000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       1000-START-UP.                                                           
      *----------------------------------------------------------------*        
                                                                                
           OPEN INPUT  BP13FD00                                                 
                       SY02F001                                                 
                OUTPUT BP13LY75.                                                
                                                                                
           READ SY02F001.                                                       
           MOVE F001-DTE-CURRENT         TO  WS-DTE-CURRENT.                    
           MOVE F001-DTE-LAST-DAY-PREV   TO  WS-DTE-PREV.                       
                                                                                
           MOVE WS-DTE-CURRENT-DD        TO WS-HDG-1-DD.                        
           MOVE WS-DTE-CURRENT-MM        TO WS-HDG-1-MM.                        
           MOVE WS-DTE-CURRENT-CCYY      TO WS-HDG-1-CCYY.                      
                                                                                
           MOVE WS-DTE-PREV-DD           TO WS-HDG-4-DD.                        
           MOVE WS-DTE-PREV-MM           TO WS-HDG-4-MM.                        
           MOVE WS-DTE-PREV-CCYY         TO WS-HDG-4-CCYY.                      
                                                                                
       1000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       2000-PROCESS-BP13FD00.                                                   
      *----------------------------------------------------------------*        
                                                                                
           READ BP13FD00                                                        
               AT END MOVE 'Y' TO WS-FD00-EOF                                   
               GO TO 2000-EXIT.                                                 
           ADD 1 TO WS-CNT-FD00.                                                
                                                                                
           IF FD00-CDE-ACCT-STAT NOT = 'C' AND 'V' AND 'X'                      
                                   AND 'Z' AND 'F' AND 'A'                      
              GO TO 2000-EXIT.                                                  
                                                                                
           IF FD00-CDE-LOAN-SCH = 'M'                                           
              ADD 1                           TO WS-CNT-LOAN-SCH-M              
              PERFORM 3000-PROCESS-MARKET   THRU 4000-EXIT                      
           ELSE                                                                 
           IF FD00-CDE-LOAN-SCH = 'A'                                           
              ADD 1                           TO WS-CNT-LOAN-SCH-A              
              PERFORM 4000-PROCESS-NON-CONC THRU 4000-EXIT                      
           ELSE                                                                 
              GO TO 2000-EXIT.                                                  
                                                                                
       2000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       3000-PROCESS-MARKET.                                                     
      *----------------------------------------------------------------*        
                                                                                
           IF (FD00-NUM-LOAN-REPYMT-PERIOD <= 5)                                
              ADD 1 TO WS-CNT-5-MKT                                             
              COMPUTE WS-AMT-LOAN-5-MKT = WS-AMT-LOAN-5-MKT +                   
                                          FD00-AMT-LOAN-GRANTED                 
              COMPUTE WS-AMT-OS-5-MKT   = WS-AMT-OS-5-MKT +                     
                                          FD00-AMT-LOAN-BAL                     
           ELSE                                                                 
           IF (FD00-NUM-LOAN-REPYMT-PERIOD >  5) AND                            
              (FD00-NUM-LOAN-REPYMT-PERIOD <= 10)                               
              ADD 1 TO WS-CNT-10-MKT                                            
              COMPUTE WS-AMT-LOAN-10-MKT = WS-AMT-LOAN-10-MKT +                 
                                           FD00-AMT-LOAN-GRANTED                
              COMPUTE WS-AMT-OS-10-MKT   = WS-AMT-OS-10-MKT   +                 
                                           FD00-AMT-LOAN-BAL                    
           ELSE                                                                 
           IF (FD00-NUM-LOAN-REPYMT-PERIOD >  10) AND                           
              (FD00-NUM-LOAN-REPYMT-PERIOD <= 15)                               
                ADD 1 TO WS-CNT-15-MKT                                          
                COMPUTE WS-AMT-LOAN-15-MKT = WS-AMT-LOAN-15-MKT +               
                                             FD00-AMT-LOAN-GRANTED              
                COMPUTE WS-AMT-OS-15-MKT   = WS-AMT-OS-15-MKT +                 
                                             FD00-AMT-LOAN-BAL                  
           ELSE                                                                 
           IF (FD00-NUM-LOAN-REPYMT-PERIOD >  15) AND                           
              (FD00-NUM-LOAN-REPYMT-PERIOD <= 20)                               
                ADD 1 TO WS-CNT-20-MKT                                          
                COMPUTE WS-AMT-LOAN-20-MKT = WS-AMT-LOAN-20-MKT +               
                                             FD00-AMT-LOAN-GRANTED              
                COMPUTE WS-AMT-OS-20-MKT   = WS-AMT-OS-20-MKT +                 
                                             FD00-AMT-LOAN-BAL                  
           ELSE                                                                 
           IF (FD00-NUM-LOAN-REPYMT-PERIOD >  20) AND                           
              (FD00-NUM-LOAN-REPYMT-PERIOD <= 25)                               
                ADD 1 TO WS-CNT-25-MKT                                          
                COMPUTE WS-AMT-LOAN-25-MKT = WS-AMT-LOAN-25-MKT +               
                                             FD00-AMT-LOAN-GRANTED              
                COMPUTE WS-AMT-OS-25-MKT   = WS-AMT-OS-25-MKT +                 
                                             FD00-AMT-LOAN-BAL                  
           ELSE                                                                 
           IF (FD00-NUM-LOAN-REPYMT-PERIOD >  25)                               
                ADD 1 TO WS-CNT-30-MKT                                          
                COMPUTE WS-AMT-LOAN-30-MKT = WS-AMT-LOAN-30-MKT +               
                                             FD00-AMT-LOAN-GRANTED              
                COMPUTE WS-AMT-OS-30-MKT   = WS-AMT-OS-30-MKT +                 
                                             FD00-AMT-LOAN-BAL.                 
                                                                                
       3000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       4000-PROCESS-NON-CONC.                                                   
      *----------------------------------------------------------------*        
                                                                                
           IF (FD00-NUM-LOAN-REPYMT-PERIOD <= 5)                                
              ADD 1 TO WS-CNT-5-NC                                              
              COMPUTE WS-AMT-LOAN-5-NC = WS-AMT-LOAN-5-NC +                     
                                         FD00-AMT-LOAN-GRANTED                  
              COMPUTE WS-AMT-OS-5-NC   = WS-AMT-OS-5-NC +                       
                                         FD00-AMT-LOAN-BAL                      
           ELSE                                                                 
           IF (FD00-NUM-LOAN-REPYMT-PERIOD >  5) AND                            
              (FD00-NUM-LOAN-REPYMT-PERIOD <= 10)                               
              ADD 1 TO WS-CNT-10-NC                                             
              COMPUTE WS-AMT-LOAN-10-NC = WS-AMT-LOAN-10-NC +                   
                                          FD00-AMT-LOAN-GRANTED                 
              COMPUTE WS-AMT-OS-10-NC   = WS-AMT-OS-10-NC +                     
                                          FD00-AMT-LOAN-BAL                     
           ELSE                                                                 
           IF (FD00-NUM-LOAN-REPYMT-PERIOD >  10) AND                           
              (FD00-NUM-LOAN-REPYMT-PERIOD <= 15)                               
                ADD 1 TO WS-CNT-15-NC                                           
                COMPUTE WS-AMT-LOAN-15-NC = WS-AMT-LOAN-15-NC +                 
                                            FD00-AMT-LOAN-GRANTED               
                COMPUTE WS-AMT-OS-15-NC   = WS-AMT-OS-15-NC +                   
                                            FD00-AMT-LOAN-BAL                   
           ELSE                                                                 
           IF (FD00-NUM-LOAN-REPYMT-PERIOD >  15) AND                           
              (FD00-NUM-LOAN-REPYMT-PERIOD <= 20)                               
                ADD 1 TO WS-CNT-20-NC                                           
                COMPUTE WS-AMT-LOAN-20-NC = WS-AMT-LOAN-20-NC +                 
                                            FD00-AMT-LOAN-GRANTED               
                COMPUTE WS-AMT-OS-20-NC   = WS-AMT-OS-20-NC +                   
                                            FD00-AMT-LOAN-BAL                   
           ELSE                                                                 
           IF (FD00-NUM-LOAN-REPYMT-PERIOD >  20) AND                           
              (FD00-NUM-LOAN-REPYMT-PERIOD <= 25)                               
                ADD 1 TO WS-CNT-25-NC                                           
                COMPUTE WS-AMT-LOAN-25-NC = WS-AMT-LOAN-25-NC +                 
                                            FD00-AMT-LOAN-GRANTED               
                COMPUTE WS-AMT-OS-25-NC   = WS-AMT-OS-25-NC +                   
                                            FD00-AMT-LOAN-BAL                   
           ELSE                                                                 
           IF (FD00-NUM-LOAN-REPYMT-PERIOD >  25)                               
                ADD 1 TO WS-CNT-30-NC                                           
                COMPUTE WS-AMT-LOAN-30-NC = WS-AMT-LOAN-30-NC +                 
                                            FD00-AMT-LOAN-GRANTED               
                COMPUTE WS-AMT-OS-30-NC   = WS-AMT-OS-30-NC +                   
                                            FD00-AMT-LOAN-BAL.                  
                                                                                
       4000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       5000-GET-INTEREST-RATE.                                                  
      *----------------------------------------------------------------*        
                                                                                
      *___ CALL C950 TO GET INTEREST RATE                                       
                                                                                
           MOVE WS-DTE-CURRENT           TO C950-PROCESS-DATE.                  
           MOVE WS-NUM-REPYMT-PERIOD     TO C950-REPYMT-PERIOD.                 
           MOVE WS-CDE-LOAN-SCH          TO C950-CDE-LOAN-SCH.                  
                                                                                
           CALL 'BP13C950' USING C950-FIELD.                                    
                                                                                
           IF C950-INTREST-RATE NOT NUMERIC                                     
              MOVE 0                 TO C950-INTREST-RATE                       
           END-IF.                                                              
           MOVE C950-INTREST-RATE    TO WS-PCT-INT.                             
                                                                                
           COMPUTE WS-PCT-INT = C950-INTREST-RATE * 100.                        
           MOVE WS-PCT-INT           TO WS-DET-INT-RATE.                        
                                                                                
       5000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       6000-PRINT-MARKET.                                                       
      *----------------------------------------------------------------*        
                                                                                
           ADD  1                           TO WS-PAGE-CTR.                     
           MOVE WS-PAGE-CTR                 TO WS-HDG-2-PAGE.                   
           MOVE 'BP13LY75'                  TO WS-LISTID.                       
           MOVE 'M'                         TO WS-CDE-LOAN-SCH.                 
           WRITE BP13LY75-REC             FROM WS-HEADING-1 AFTER PAGE.         
           WRITE BP13LY75-REC             FROM WS-HEADING-2 AFTER 1.            
           WRITE BP13LY75-REC             FROM WS-HEADING-3 AFTER 2.            
           WRITE BP13LY75-REC             FROM WS-HEADING-4 AFTER 1.            
           MOVE '          ( MARKET )       ' TO WS-TITLE.                      
           WRITE BP13LY75-REC             FROM WS-HEADING-5 AFTER 3.            
           WRITE BP13LY75-REC             FROM WS-HEADING-6 AFTER 2.            
           WRITE BP13LY75-REC             FROM WS-HEADING-7 AFTER 1.            
           WRITE BP13LY75-REC             FROM WS-HEADING-8 AFTER 1.            
                                                                                
      * ------------------------------*                                         
      *    PRINT  5-YEARS DETAILS.    *                                         
      * ------------------------------*                                         
           MOVE ' <= 5 YEARS'                TO WS-DET-REPAY-PERIOD.            
                                                                                
           MOVE 05                           TO WS-NUM-REPYMT-PERIOD.           
           PERFORM 5000-GET-INTEREST-RATE  THRU 5000-EXIT.                      
                                                                                
           MOVE WS-CNT-5-MKT                 TO WS-DET-NO-OF-CASES.             
           MOVE WS-AMT-LOAN-5-MKT            TO WS-DET-LOAN-GRANTED.            
           MOVE WS-AMT-OS-5-MKT              TO WS-DET-LOAN-BALANCE.            
                                                                                
           WRITE BP13LY75-REC              FROM WS-DETAIL-LINE AFTER 1.         
                                                                                
      * -----------------------------*                                          
      *    PRINT 10-YEARS DETAILS.   *                                          
      * -----------------------------*                                          
           MOVE ' 6-10 YEARS'                TO WS-DET-REPAY-PERIOD.            
           MOVE 06                           TO WS-NUM-REPYMT-PERIOD.           
           PERFORM 5000-GET-INTEREST-RATE  THRU 5000-EXIT.                      
                                                                                
           MOVE WS-CNT-10-MKT                TO WS-DET-NO-OF-CASES.             
           MOVE WS-AMT-LOAN-10-MKT           TO WS-DET-LOAN-GRANTED.            
           MOVE WS-AMT-OS-10-MKT             TO WS-DET-LOAN-BALANCE.            
                                                                                
           WRITE BP13LY75-REC              FROM WS-DETAIL-LINE AFTER 1.         
                                                                                
      * -----------------------------*                                          
      *    PRINT 15-YEARS DETAILS.   *                                          
      * -----------------------------*                                          
           MOVE '11-15 YEARS'                TO WS-DET-REPAY-PERIOD.            
           MOVE 11                           TO WS-NUM-REPYMT-PERIOD.           
           PERFORM 5000-GET-INTEREST-RATE  THRU 5000-EXIT.                      
                                                                                
           MOVE WS-CNT-15-MKT                TO WS-DET-NO-OF-CASES.             
           MOVE WS-AMT-LOAN-15-MKT           TO WS-DET-LOAN-GRANTED.            
           MOVE WS-AMT-OS-15-MKT             TO WS-DET-LOAN-BALANCE.            
           WRITE BP13LY75-REC              FROM WS-DETAIL-LINE AFTER 1.         
                                                                                
      * ----------------------------*                                           
      *    PRINT 20-YEARS DETAILS.  *                                           
      * ----------------------------*                                           
           MOVE '16-20 YEARS'                TO WS-DET-REPAY-PERIOD.            
           MOVE WS-CNT-20-MKT                TO WS-DET-NO-OF-CASES.             
           MOVE WS-AMT-LOAN-20-MKT           TO WS-DET-LOAN-GRANTED.            
           MOVE WS-AMT-OS-20-MKT             TO WS-DET-LOAN-BALANCE.            
                                                                                
           WRITE BP13LY75-REC              FROM WS-DETAIL-LINE AFTER 1.         
                                                                                
      * ------------------------------*                                         
      *    PRINT 25-YEARS DETAILS.    *                                         
      * ------------------------------*                                         
           MOVE '21-25 YEARS'                TO WS-DET-REPAY-PERIOD.            
           MOVE WS-CNT-25-MKT                TO WS-DET-NO-OF-CASES.             
           MOVE WS-AMT-LOAN-25-MKT           TO WS-DET-LOAN-GRANTED.            
           MOVE WS-AMT-OS-25-MKT             TO WS-DET-LOAN-BALANCE.            
                                                                                
           WRITE BP13LY75-REC              FROM WS-DETAIL-LINE AFTER 1.         
                                                                                
      * ------------------------------*                                         
      *    PRINT 30-YEARS DETAILS.    *                                         
      * ------------------------------*                                         
           MOVE '  >25 YEARS'                TO WS-DET-REPAY-PERIOD.            
           MOVE WS-CNT-30-MKT                TO WS-DET-NO-OF-CASES.             
           MOVE WS-AMT-LOAN-30-MKT           TO WS-DET-LOAN-GRANTED.            
           MOVE WS-AMT-OS-30-MKT             TO WS-DET-LOAN-BALANCE.            
                                                                                
           WRITE BP13LY75-REC              FROM WS-DETAIL-LINE AFTER 1.         
                                                                                
      * -------------------------------*                                        
      *    PRINT AMOUNT TOTAL.         *                                        
      * -------------------------------*                                        
                                                                                
           COMPUTE WS-CNT-TOT-MKT = WS-CNT-5-MKT   + WS-CNT-10-MKT +            
                                    WS-CNT-15-MKT  + WS-CNT-20-MKT +            
                                    WS-CNT-25-MKT  + WS-CNT-30-MKT.             
                                                                                
           COMPUTE WS-AMT-LOAN-TOT-MKT = WS-AMT-LOAN-5-MKT  +                   
                                         WS-AMT-LOAN-10-MKT +                   
                                         WS-AMT-LOAN-15-MKT +                   
                                         WS-AMT-LOAN-20-MKT +                   
                                         WS-AMT-LOAN-25-MKT +                   
                                         WS-AMT-LOAN-30-MKT.                    
                                                                                
           COMPUTE WS-AMT-OS-TOT-MKT   = WS-AMT-OS-5-MKT  +                     
                                         WS-AMT-OS-10-MKT +                     
                                         WS-AMT-OS-15-MKT +                     
                                         WS-AMT-OS-20-MKT +                     
                                         WS-AMT-OS-25-MKT +                     
                                         WS-AMT-OS-30-MKT.                      
                                                                                
           MOVE WS-CNT-TOT-MKT           TO WS-FOOT-CASES-TOTAL.                
           MOVE WS-AMT-LOAN-TOT-MKT      TO WS-FOOT-LOAN-TOTAL.                 
           MOVE WS-AMT-OS-TOT-MKT        TO WS-FOOT-OS-TOTAL.                   
                                                                                
           WRITE BP13LY75-REC          FROM WS-FOOTING AFTER 2.                 
                                                                                
       6000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       7000-PRINT-NON-CONC.                                                     
      *----------------------------------------------------------------*        
                                                                                
           MOVE '        ( NON - CONCESSIONARY )' TO WS-TITLE.                  
           MOVE 'A'                           TO WS-CDE-LOAN-SCH.               
           WRITE BP13LY75-REC               FROM WS-HEADING-5 AFTER 4.          
           WRITE BP13LY75-REC               FROM WS-HEADING-6 AFTER 2.          
           WRITE BP13LY75-REC               FROM WS-HEADING-7 AFTER 1.          
           WRITE BP13LY75-REC               FROM WS-HEADING-8 AFTER 1.          
                                                                                
      * ------------------------------*                                         
      *    PRINT  5-YEARS DETAILS.    *                                         
      * ------------------------------*                                         
           MOVE ' <= 5 YEARS'                 TO WS-DET-REPAY-PERIOD.           
                                                                                
           MOVE 05                            TO WS-NUM-REPYMT-PERIOD.          
           PERFORM 5000-GET-INTEREST-RATE   THRU 5000-EXIT.                     
                                                                                
           MOVE WS-CNT-5-NC                   TO WS-DET-NO-OF-CASES.            
           MOVE WS-AMT-LOAN-5-NC              TO WS-DET-LOAN-GRANTED.           
           MOVE WS-AMT-OS-5-NC                TO WS-DET-LOAN-BALANCE.           
                                                                                
           WRITE BP13LY75-REC               FROM WS-DETAIL-LINE AFTER 1.        
                                                                                
      * -----------------------------*                                          
      *    PRINT 10-YEARS DETAILS.   *                                          
      * -----------------------------*                                          
           MOVE ' 6-10 YEARS'                 TO WS-DET-REPAY-PERIOD.           
           MOVE 06                            TO WS-NUM-REPYMT-PERIOD.          
           PERFORM 5000-GET-INTEREST-RATE   THRU 5000-EXIT.                     
                                                                                
           MOVE WS-CNT-10-NC                  TO WS-DET-NO-OF-CASES.            
           MOVE WS-AMT-LOAN-10-NC             TO WS-DET-LOAN-GRANTED.           
           MOVE WS-AMT-OS-10-NC               TO WS-DET-LOAN-BALANCE.           
                                                                                
           WRITE BP13LY75-REC              FROM WS-DETAIL-LINE AFTER 1.         
                                                                                
      * -----------------------------*                                          
      *    PRINT 15-YEARS DETAILS.   *                                          
      * -----------------------------*                                          
           MOVE '11-15 YEARS'                 TO WS-DET-REPAY-PERIOD.           
           MOVE 11                            TO WS-NUM-REPYMT-PERIOD.          
           PERFORM 5000-GET-INTEREST-RATE   THRU 5000-EXIT.                     
                                                                                
           MOVE WS-CNT-15-NC                  TO WS-DET-NO-OF-CASES.            
           MOVE WS-AMT-LOAN-15-NC             TO WS-DET-LOAN-GRANTED.           
           MOVE WS-AMT-OS-15-NC               TO WS-DET-LOAN-BALANCE.           
                                                                                
           WRITE BP13LY75-REC               FROM WS-DETAIL-LINE AFTER 1.        
                                                                                
      * ----------------------------*                                           
      *    PRINT 20-YEARS DETAILS.  *                                           
      * ----------------------------*                                           
           MOVE '16-20 YEARS'                 TO WS-DET-REPAY-PERIOD.           
                                                                                
           MOVE WS-CNT-20-NC                  TO WS-DET-NO-OF-CASES.            
           MOVE WS-AMT-LOAN-20-NC             TO WS-DET-LOAN-GRANTED.           
           MOVE WS-AMT-OS-20-NC               TO WS-DET-LOAN-BALANCE.           
                                                                                
           WRITE BP13LY75-REC               FROM WS-DETAIL-LINE AFTER 1.        
                                                                                
      * ------------------------------*                                         
      *    PRINT 25-YEARS DETAILS.    *                                         
      * ------------------------------*                                         
           MOVE '21-25 YEARS'                 TO WS-DET-REPAY-PERIOD.           
                                                                                
           MOVE WS-CNT-25-NC                  TO WS-DET-NO-OF-CASES.            
           MOVE WS-AMT-LOAN-25-NC             TO WS-DET-LOAN-GRANTED.           
           MOVE WS-AMT-OS-25-NC               TO WS-DET-LOAN-BALANCE.           
                                                                                
           WRITE BP13LY75-REC               FROM WS-DETAIL-LINE AFTER 1.        
                                                                                
      * ------------------------------*                                         
      *    PRINT 30-YEARS DETAILS.    *                                         
      * ------------------------------*                                         
           MOVE '  >25 YEARS'                 TO WS-DET-REPAY-PERIOD.           
                                                                                
           MOVE WS-CNT-30-NC                  TO WS-DET-NO-OF-CASES.            
           MOVE WS-AMT-LOAN-30-NC             TO WS-DET-LOAN-GRANTED.           
           MOVE WS-AMT-OS-30-NC               TO WS-DET-LOAN-BALANCE.           
                                                                                
           WRITE BP13LY75-REC               FROM WS-DETAIL-LINE AFTER 1.        
                                                                                
      * -------------------------------*                                        
      *    PRINT AMOUNT TOTAL.         *                                        
      * -------------------------------*                                        
                                                                                
           COMPUTE WS-CNT-TOT-NC  = WS-CNT-5-NC   + WS-CNT-10-NC +              
                                    WS-CNT-15-NC  + WS-CNT-20-NC +              
                                    WS-CNT-25-NC  + WS-CNT-30-NC.               
                                                                                
           COMPUTE WS-AMT-LOAN-TOT-NC = WS-AMT-LOAN-5-NC  +                     
                                        WS-AMT-LOAN-10-NC +                     
                                        WS-AMT-LOAN-15-NC +                     
                                        WS-AMT-LOAN-20-NC +                     
                                        WS-AMT-LOAN-25-NC +                     
                                        WS-AMT-LOAN-30-NC.                      
                                                                                
           COMPUTE WS-AMT-OS-TOT-NC = WS-AMT-OS-5-NC  +                         
                                      WS-AMT-OS-10-NC +                         
                                      WS-AMT-OS-15-NC +                         
                                      WS-AMT-OS-20-NC +                         
                                      WS-AMT-OS-25-NC +                         
                                      WS-AMT-OS-30-NC.                          
                                                                                
           MOVE WS-CNT-TOT-NC         TO WS-FOOT-CASES-TOTAL.                   
           MOVE WS-AMT-LOAN-TOT-NC    TO WS-FOOT-LOAN-TOTAL.                    
           MOVE WS-AMT-OS-TOT-NC      TO WS-FOOT-OS-TOTAL.                      
                                                                                
           WRITE BP13LY75-REC FROM WS-FOOTING AFTER 2.                          
                                                                                
       7000-EXIT.   EXIT.                                                       
                                                                                
      *----------------------------------------------------------------*        
       8000-PRINT-FINAL.                                                        
      *----------------------------------------------------------------*        
                                                                                
           MOVE '         ( FINAL TOTAL )       '  TO WS-TITLE.                 
           WRITE BP13LY75-REC               FROM WS-HEADING-5  AFTER 4.         
           WRITE BP13LY75-REC               FROM WS-HEADING-6B AFTER 2.         
           WRITE BP13LY75-REC               FROM WS-HEADING-7B AFTER 1.         
           WRITE BP13LY75-REC               FROM WS-HEADING-8B AFTER 1.         
                                                                                
      * ------------------------------*                                         
      *    PRINT  5-YEARS DETAILS.    *                                         
      * ------------------------------*                                         
           MOVE ' <= 5 YEARS'      TO  WS-DET-REPAY-PERIOD-FIN.                 
                                                                                
           COMPUTE  WS-CNT-5-FIN  = WS-CNT-5-MKT + WS-CNT-5-NC.                 
           MOVE WS-CNT-5-FIN       TO  WS-DET-NO-OF-CASES-FIN.                  
                                                                                
           COMPUTE  WS-AMT-LOAN-5-FIN = WS-AMT-LOAN-5-MKT                       
                                      + WS-AMT-LOAN-5-NC.                       
           MOVE WS-AMT-LOAN-5-FIN  TO  WS-DET-LOAN-GRANTED-FIN.                 
                                                                                
           COMPUTE  WS-AMT-OS-5-FIN = WS-AMT-OS-5-MKT                           
                                    + WS-AMT-OS-5-NC.                           
           MOVE WS-AMT-OS-5-FIN    TO  WS-DET-LOAN-BALANCE-FIN.                 
                                                                                
           WRITE BP13LY75-REC FROM WS-DETAIL-LINE-FIN AFTER 1.                  
                                                                                
      * -----------------------------*                                          
      *    PRINT 10-YEARS DETAILS.   *                                          
      * -----------------------------*                                          
           MOVE ' 6-10 YEARS'      TO  WS-DET-REPAY-PERIOD-FIN.                 
                                                                                
           COMPUTE  WS-CNT-10-FIN  = WS-CNT-10-MKT + WS-CNT-10-NC.              
           MOVE WS-CNT-10-FIN      TO  WS-DET-NO-OF-CASES-FIN.                  
                                                                                
           COMPUTE  WS-AMT-LOAN-10-FIN = WS-AMT-LOAN-10-MKT                     
                                       + WS-AMT-LOAN-10-NC.                     
           MOVE WS-AMT-LOAN-10-FIN TO  WS-DET-LOAN-GRANTED-FIN                  
                                                                                
           COMPUTE  WS-AMT-OS-10-FIN = WS-AMT-OS-10-MKT                         
                                     + WS-AMT-OS-10-NC.                         
           MOVE WS-AMT-OS-10-FIN   TO  WS-DET-LOAN-BALANCE-FIN.                 
                                                                                
           WRITE BP13LY75-REC FROM WS-DETAIL-LINE-FIN AFTER 1.                  
                                                                                
      * -----------------------------*                                          
      *    PRINT 15-YEARS DETAILS.   *                                          
      * -----------------------------*                                          
           MOVE '11-15 YEARS'      TO  WS-DET-REPAY-PERIOD-FIN.                 
                                                                                
           COMPUTE  WS-CNT-15-FIN  = WS-CNT-15-MKT + WS-CNT-15-NC.              
           MOVE WS-CNT-15-FIN      TO  WS-DET-NO-OF-CASES-FIN.                  
                                                                                
           COMPUTE  WS-AMT-LOAN-15-FIN = WS-AMT-LOAN-15-MKT                     
                                       + WS-AMT-LOAN-15-NC.                     
           MOVE WS-AMT-LOAN-15-FIN TO  WS-DET-LOAN-GRANTED-FIN.                 
                                                                                
           COMPUTE  WS-AMT-OS-15-FIN = WS-AMT-OS-15-MKT                         
                                     + WS-AMT-OS-15-NC.                         
           MOVE WS-AMT-OS-15-FIN   TO  WS-DET-LOAN-BALANCE-FIN.                 
                                                                                
           WRITE BP13LY75-REC FROM WS-DETAIL-LINE-FIN AFTER 1.                  
                                                                                
      * ----------------------------*                                           
      *    PRINT 20-YEARS DETAILS.  *                                           
      * ----------------------------*                                           
           MOVE '16-20 YEARS'      TO  WS-DET-REPAY-PERIOD-FIN.                 
                                                                                
           COMPUTE  WS-CNT-20-FIN  = WS-CNT-20-MKT + WS-CNT-20-NC.              
           MOVE WS-CNT-20-FIN      TO  WS-DET-NO-OF-CASES-FIN.                  
                                                                                
           COMPUTE  WS-AMT-LOAN-20-FIN = WS-AMT-LOAN-20-MKT                     
                                       + WS-AMT-LOAN-20-NC.                     
           MOVE WS-AMT-LOAN-20-FIN TO  WS-DET-LOAN-GRANTED-FIN.                 
                                                                                
           COMPUTE  WS-AMT-OS-20-FIN = WS-AMT-OS-20-MKT                         
                                     + WS-AMT-OS-20-NC.                         
           MOVE WS-AMT-OS-20-FIN   TO  WS-DET-LOAN-BALANCE-FIN.                 
                                                                                
           WRITE BP13LY75-REC FROM WS-DETAIL-LINE-FIN AFTER 1.                  
                                                                                
      * ------------------------------*                                         
      *    PRINT 25-YEARS DETAILS.    *                                         
      * ------------------------------*                                         
           MOVE '21-25 YEARS'      TO  WS-DET-REPAY-PERIOD-FIN.                 
                                                                                
           COMPUTE  WS-CNT-25-FIN  = WS-CNT-25-MKT + WS-CNT-25-NC.              
           MOVE WS-CNT-25-FIN      TO  WS-DET-NO-OF-CASES-FIN.                  
                                                                                
           COMPUTE  WS-AMT-LOAN-25-FIN = WS-AMT-LOAN-25-MKT                     
                                       + WS-AMT-LOAN-25-NC.                     
           MOVE WS-AMT-LOAN-25-FIN TO  WS-DET-LOAN-GRANTED-FIN.                 
                                                                                
           COMPUTE  WS-AMT-OS-25-FIN = WS-AMT-OS-25-MKT                         
                                     + WS-AMT-OS-25-NC.                         
           MOVE WS-AMT-OS-25-FIN   TO  WS-DET-LOAN-BALANCE-FIN.                 
                                                                                
           WRITE BP13LY75-REC FROM WS-DETAIL-LINE-FIN AFTER 1.                  
                                                                                
      * ------------------------------*                                         
      *    PRINT 30-YEARS DETAILS.    *                                         
      * ------------------------------*                                         
           MOVE '  >25 YEARS'      TO  WS-DET-REPAY-PERIOD-FIN.                 
                                                                                
           COMPUTE  WS-CNT-30-FIN  = WS-CNT-30-MKT + WS-CNT-30-NC.              
           MOVE WS-CNT-30-FIN      TO  WS-DET-NO-OF-CASES-FIN.                  
                                                                                
           COMPUTE  WS-AMT-LOAN-30-FIN = WS-AMT-LOAN-30-MKT                     
                                       + WS-AMT-LOAN-30-NC.                     
           MOVE WS-AMT-LOAN-30-FIN TO  WS-DET-LOAN-GRANTED-FIN.                 
                                                                                
           COMPUTE  WS-AMT-OS-30-FIN = WS-AMT-OS-30-MKT                         
                                     + WS-AMT-OS-30-NC.                         
           MOVE WS-AMT-OS-30-FIN   TO  WS-DET-LOAN-BALANCE-FIN.                 
                                                                                
           WRITE BP13LY75-REC FROM WS-DETAIL-LINE-FIN AFTER 1.                  
                                                                                
      * -------------------------------*                                        
      *    PRINT AMOUNT TOTAL.         *                                        
      * -------------------------------*                                        
                                                                                
           COMPUTE WS-CNT-TOT-FIN = WS-CNT-5-FIN  + WS-CNT-10-FIN +             
                                    WS-CNT-15-FIN + WS-CNT-20-FIN +             
                                    WS-CNT-25-FIN + WS-CNT-30-FIN.              
                                                                                
           COMPUTE WS-AMT-LOAN-TOT-FIN = WS-AMT-LOAN-5-FIN  +                   
                                         WS-AMT-LOAN-10-FIN +                   
                                         WS-AMT-LOAN-15-FIN +                   
                                         WS-AMT-LOAN-20-FIN +                   
                                         WS-AMT-LOAN-25-FIN +                   
                                         WS-AMT-LOAN-30-FIN.                    
                                                                                
           COMPUTE WS-AMT-OS-TOT-FIN = WS-AMT-OS-5-FIN +                        
                                       WS-AMT-OS-10-FIN +                       
                                       WS-AMT-OS-15-FIN +                       
                                       WS-AMT-OS-20-FIN +                       
                                       WS-AMT-OS-25-FIN +                       
                                       WS-AMT-OS-30-FIN.                        
                                                                                
           MOVE WS-CNT-TOT-FIN        TO WS-FOOT-CASES-TOTAL.                   
           MOVE WS-AMT-LOAN-TOT-FIN   TO WS-FOOT-LOAN-TOTAL.                    
           MOVE WS-AMT-OS-TOT-FIN     TO WS-FOOT-OS-TOTAL.                      
                                                                                
           WRITE BP13LY75-REC FROM WS-FOOTING AFTER 2.                          
                                                                                
       8000-EXIT.                                                               
           EXIT.                                                                
                                                                                
      *----------------------------------------------------------------*        
       9999-WRAP-UP.                                                            
      *----------------------------------------------------------------*        
                                                                                
           DISPLAY  SPACES.                                                     
                                                                                
           DISPLAY '******* CONTROL   TOTALS *******'.                          
                                                                                
           DISPLAY 'PROGRAM-ID : BP13CY75'.                                     
                                                                                
           DISPLAY  SPACES.                                                     
                                                                                
           DISPLAY 'NUMBER OF BP13FD00 RECORDS READ         : '                 
                    WS-CNT-FD00.                                                
           DISPLAY 'NUMBER OF BP13FD00 LOAN-SCHEME (M)      : '                 
                    WS-CNT-LOAN-SCH-M.                                          
           DISPLAY 'NUMBER OF BP13FD00 LOAN-SCHEME (A)      : '                 
                    WS-CNT-LOAN-SCH-A.                                          
                                                                                
           CLOSE BP13FD00                                                       
                 SY02F001                                                       
                 BP13LY75.                                                      
                                                                                
                                                                                
           STOP RUN.                                                            
                                                                                
       9999-EXIT.   EXIT.                                                       
