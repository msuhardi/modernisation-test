       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    BP13C117.                                                 
      *AUTHOR.        LEE K. H.                                                 
      *DATE-WRITTEN.  10/10/89.                                                 
      *REMARKS.                                                                 
      *========================================================*                
      *                                                        *                
      *   PROGRAM TO PRINT OUT THE TOTAL BOOKING FEE , TOTAL   *                
      *   COMMITMENT DEPOSIT AND TOTAL SOC DEBTOR FOR 'E'      *                
      *   TYPE OF ROOM AND OTHER ROOM TYPES.                   *                
      *                                                        *                
      *     INPUT FILE :                                       *                
      *           1. BP13K800                                  *                
      *                                                        *                
      *     LISTING :                                          *                
      *           1. BP13L117                                  *                
      *                                                        *                
      *                                                        *                
      *  CHG-NO   BY    NO          DESCRIPTION                *                
      *  -------  ---   --------    -------------------------  *                
      *  SOC-PH8  JEP   10/07/93    USE BP13K800 FILE INSTEAD  *                
      *                                 P10K020  FILE.         *                
      * BP130056  EG    13/11/95    TO ENLARGE THE GRAND TOTAL *                
      *                             TO CATER FOR BILLIONS.     *                
      * BP130103  LJL   16/03/96    TO CATER FOR SUB-TRANSFER. *                
      * BP130130  LJL   22/07/96    TO REFLECT THE SIGN OF SUS.*                
      * BP130320  LJL   25/06/97    TO CATER FOR REGN DEPOSIT. *                
      * BP130418  RHB   25/08/98    TO CATER FOR Y2000.        *                
      * BP134034  ESA1  09/02/11    TO CATER FOR NEW GL CODES  *                
      *========================================================*                
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
           SELECT BP13K800 ASSIGN       TO BP13K800                             
                           ACCESS MODE  IS SEQUENTIAL                           
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K800-NUM-REGN                        
                           FILE STATUS  IS K800-STATUS.                         
                                                                                
           SELECT BP13K885 ASSIGN       TO BP13K885                             
                           ACCESS MODE  IS SEQUENTIAL                           
                           ORGANIZATION IS INDEXED                              
                           RECORD KEY   IS K885-KEY-FLD                         
                           FILE STATUS  IS K885-STATUS.                         
                                                                                
           SELECT BP13L117 ASSIGN       TO BP13L117.                            
                                                                                
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  BP13K800                                                             
           RECORD CONTAINS 2000 CHARACTERS.                                     
       COPY BP13K800.                                                           
                                                                                
       FD  BP13K885                                                             
           RECORD CONTAINS 400 CHARACTERS.                                      
       COPY BP13K885.                                                           
                                                                                
       FD  BP13L117                                                             
           RECORD CONTAINS 132 CHARACTERS                                       
           RECORDING MODE  IS  F                                                
           DATA RECORD     IS  PRINT-REC-1.                                     
       01  PRINT-REC-1                 PIC X(132).                              
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  WS-EOF.                                                              
           05  WS-EOF-K800             PIC X  VALUE 'N'.                        
           05  WS-EOF-K885             PIC X  VALUE 'N'.                        
                                                                                
       01  FILE-STATUS.                                                         
           05  K800-STATUS             PIC 99  VALUE ZEROS.                     
           05  K885-STATUS             PIC 99  VALUE ZEROS.                     
                                                                                
                                                                                
       01  WS-COUNTERS.                                                         
           05  WS-BK-FEE-PA            PIC S9(12)V99 VALUE ZEROS.               
           05  WS-BK-FEE-EX            PIC S9(12)V99 VALUE ZEROS.               
           05  WS-CD-PA                PIC S9(12)V99 VALUE ZEROS.               
           05  WS-CD-EX                PIC S9(12)V99 VALUE ZEROS.               
           05  WS-SOC-DEBTOR-PA        PIC S9(12)V99 VALUE ZEROS.               
           05  WS-SOC-DEBTOR-EX        PIC S9(12)V99 VALUE ZEROS.               
           05  WS-SUSPENSE-PA          PIC S9(12)V99 VALUE ZEROS.               
           05  WS-SUSPENSE-EX          PIC S9(12)V99 VALUE ZEROS.               
           05  WS-REGN-DEP-PA          PIC S9(12)V99 VALUE ZEROS.               
           05  WS-REGN-DEP-EX          PIC S9(12)V99 VALUE ZEROS.               
           05  WS-TOT-BK-FEE           PIC S9(12)V99 VALUE ZEROS.               
           05  WS-TOT-CD               PIC S9(12)V99 VALUE ZEROS.               
           05  WS-TOT-SOC-DEBTOR       PIC S9(12)V99 VALUE ZEROS.               
           05  WS-TOT-SUSPENSE         PIC S9(12)V99 VALUE ZEROS.               
           05  WS-TOT-REGN-DEP         PIC S9(12)V99 VALUE ZEROS.               
           05  WS-GRAND-PA             PIC S9(12)V99 VALUE ZEROS.               
           05  WS-GRAND-EX             PIC S9(12)V99 VALUE ZEROS.               
           05  WS-GRAND-TOT            PIC S9(12)V99 VALUE ZEROS.               
           05  WS-PAGE-NO              PIC 9(4)     VALUE ZEROS.                
                                                                                
       01  WS-CURRENT-DATE.                                                     
           03  WS-CURRENT-CC           PIC 99.                                  
           03  WS-CURRENT-YY           PIC 99.                                  
           03  WS-CURRENT-MM           PIC 99.                                  
           03  WS-CURRENT-DD           PIC 99.                                  
                                                                                
       01  WS-EDITED-DATE.                                                      
           03  WS-DD                   PIC 99.                                  
           03  FILLER                  PIC X        VALUE '/'.                  
           03  WS-MM                   PIC 99.                                  
           03  FILLER                  PIC X        VALUE '/'.                  
           03  WS-CC                   PIC 99.                                  
           03  WS-YY                   PIC 99.                                  
                                                                                
                                                                                
       01  PR-HEAD-1.                                                           
           03  FILLER                  PIC X(46)    VALUE                       
               'BP13L117      HDBCAT3'.                                         
           03  FILLER                  PIC X(51)    VALUE                       
               'S Y S T E M   O F   C O M M I T M E N T'.                       
           03  FILLER                  PIC X(7)     VALUE 'DATE : '.            
           03  PR-SYS-DATE             PIC X(10).                               
           03  FILLER                  PIC X(11)    VALUE                       
               '    PAGE : '.                                                   
           03  PR-PAGE-NO              PIC ZZZ9.                                
                                                                                
       01  PR-HEAD-2.                                                           
           03  FILLER                  PIC X(42)     VALUE SPACES.              
           03  FILLER                  PIC X(39)     VALUE                      
               'ANALYSIS OF BALANCES BY ACTIVITY AS AT '.                       
           03  PR-DATE                 PIC X(10).                               
                                                                                
       01  PR-HEAD-3.                                                           
           03  FILLER                  PIC X(58)     VALUE SPACES.              
           03  FILLER                  PIC X(24)     VALUE                      
               'DEVELOPMENT OF'.                                                
           03  FILLER                  PIC X(30)     VALUE                      
               'DEVELOPMENT OF'.                                                
                                                                                
       01  PR-HEAD-4.                                                           
           03  FILLER                  PIC X(9)      VALUE SPACES.              
           03  FILLER                  PIC X(25)     VALUE                      
               'GL ACCOUNT'.                                                    
           03  FILLER                  PIC X(24)     VALUE                      
               'GL DESCRIPTION'.                                                
           03  FILLER                  PIC X(24)     VALUE                      
               'PUBLIC HOUSING'.                                                
           03  FILLER                  PIC X(32)     VALUE                      
               'EXEC HOUSING'.                                                  
           03  FILLER                  PIC X(10)     VALUE 'TOTAL'.             
                                                                                
       01  PR-HEAD-5.                                                           
           03  FILLER                  PIC X(9)      VALUE SPACES.              
           03  FILLER                  PIC X(25)     VALUE                      
               '0 00 00 00 10 4516'.                                            
           03  FILLER                  PIC X(20)     VALUE                      
               'BOOKING FEE'.                                                   
           03  PR-BK-FEE-PA            PIC ZZZ,ZZZ,ZZZ,ZZ9.99.                  
           03  PR-BK-FEE-PA-SIGN       PIC X(2).                                
           03  FILLER                  PIC X(4)       VALUE SPACES.             
           03  PR-BK-FEE-EX            PIC ZZZ,ZZZ,ZZZ,ZZ9.99.                  
           03  PR-BK-FEE-EX-SIGN       PIC X(2).                                
           03  FILLER                  PIC X(4)       VALUE SPACES.             
           03  PR-TOT-BK-FEE           PIC ZZZ,ZZZ,ZZZ,ZZ9.99.                  
           03  PR-TOT-BK-FEE-SIGN      PIC X(2).                                
                                                                                
       01  PR-HEAD-6.                                                           
           03  FILLER                  PIC X(9)      VALUE SPACES.              
           03  FILLER                  PIC X(25)     VALUE                      
               '0 00 00 00 10 4517'.                                            
           03  FILLER                  PIC X(20)     VALUE                      
               'COMMITMENT DEPOSIT'.                                            
           03  PR-CD-PA                PIC ZZZ,ZZZ,ZZZ,ZZ9.99.                  
           03  PR-CD-PA-SIGN           PIC X(2).                                
           03  FILLER                  PIC X(4)       VALUE SPACES.             
           03  PR-CD-EX                PIC ZZZ,ZZZ,ZZZ,ZZ9.99.                  
           03  PR-CD-EX-SIGN           PIC X(2).                                
           03  FILLER                  PIC X(4)       VALUE SPACES.             
           03  PR-TOT-CD               PIC ZZZ,ZZZ,ZZZ,ZZ9.99.                  
           03  PR-TOT-CD-SIGN          PIC X(2).                                
                                                                                
       01  PR-HEAD-7.                                                           
           03  FILLER                  PIC X(9)      VALUE SPACES.              
           03  FILLER                  PIC X(25)     VALUE                      
               '0 00 00 00 10 4518'.                                            
           03  FILLER                  PIC X(20)     VALUE                      
               'SOC DEBTOR        '.                                            
           03  PR-SOC-DEBTOR-PA        PIC ZZZ,ZZZ,ZZZ,ZZ9.99.                  
           03  PR-SOC-PA-SIGN          PIC X(2).                                
           03  FILLER                  PIC X(4)       VALUE SPACES.             
           03  PR-SOC-DEBTOR-EX        PIC ZZZ,ZZZ,ZZZ,ZZ9.99.                  
           03  PR-SOC-EX-SIGN          PIC X(2).                                
           03  FILLER                  PIC X(4)       VALUE SPACES.             
           03  PR-TOT-SOC-DEBTOR       PIC ZZZ,ZZZ,ZZZ,ZZ9.99.                  
           03  PR-TOT-SOC-SIGN         PIC X(2).                                
                                                                                
       01  PR-HEAD-8A.                                                          
           03  FILLER                  PIC X(9)      VALUE SPACES.              
           03  FILLER                  PIC X(25)     VALUE                      
               '0 00 00 00 10 4009'.                                            
           03  FILLER                  PIC X(20)     VALUE                      
               'SUB-TRANSFER      '.                                            
           03  PR-SUSPENSE-PA          PIC ZZZ,ZZZ,ZZZ,ZZ9.99.                  
           03  PR-SUS-PA-SIGN          PIC X(2).                                
           03  FILLER                  PIC X(4)       VALUE SPACES.             
           03  PR-SUSPENSE-EX          PIC ZZZ,ZZZ,ZZZ,ZZ9.99.                  
           03  PR-SUS-EX-SIGN          PIC X(2).                                
           03  FILLER                  PIC X(4)       VALUE SPACES.             
           03  PR-TOT-SUSPENSE         PIC ZZZ,ZZZ,ZZZ,ZZ9.99.                  
           03  PR-TOT-SUS-SIGN         PIC X(2).                                
                                                                                
       01  PR-HEAD-8B.                                                          
           03  FILLER                  PIC X(9)      VALUE SPACES.              
           03  FILLER                  PIC X(25)     VALUE                      
               '0 00 00 00 10 4515'.                                            
           03  FILLER                  PIC X(20)     VALUE                      
               'REGN DEPOSIT (FS) '.                                            
           03  PR-REGN-DEP-PA          PIC ZZZ,ZZZ,ZZZ,ZZ9.99.                  
           03  PR-RDE-PA-SIGN          PIC X(2).                                
           03  FILLER                  PIC X(4)       VALUE SPACES.             
           03  PR-REGN-DEP-EX          PIC ZZZ,ZZZ,ZZZ,ZZ9.99.                  
           03  PR-RDE-EX-SIGN          PIC X(2).                                
           03  FILLER                  PIC X(4)       VALUE SPACES.             
           03  PR-TOT-REGN-DEP         PIC ZZZ,ZZZ,ZZZ,ZZ9.99.                  
           03  PR-TOT-RDE-SIGN         PIC X(2).                                
                                                                                
       01  PR-HEAD-8.                                                           
           03  FILLER                  PIC X(58)     VALUE SPACES.              
           03  FILLER                  PIC X(16)     VALUE ALL '-'.             
           03  FILLER                  PIC X(8)      VALUE SPACES.              
           03  FILLER                  PIC X(16)     VALUE ALL '-'.             
           03  FILLER                  PIC X(8)      VALUE SPACES.              
           03  FILLER                  PIC X(16)    VALUE ALL '-'.              
                                                                                
       01  PR-HEAD-9.                                                           
           03  FILLER                  PIC X(58)     VALUE SPACES.              
           03  FILLER                  PIC X(16)     VALUE ALL '='.             
           03  FILLER                  PIC X(8)      VALUE SPACES.              
           03  FILLER                  PIC X(16)     VALUE ALL '='.             
           03  FILLER                  PIC X(8)      VALUE SPACES.              
           03  FILLER                  PIC X(16)    VALUE ALL '='.              
                                                                                
       01  PR-HEAD-10.                                                          
           03  FILLER                  PIC X(54)     VALUE SPACES.              
           03  PR-GRAND-PA             PIC ZZZ,ZZZ,ZZZ,ZZ9.99.                  
           03  PR-GRAND-PA-SIGN        PIC X(2).                                
           03  FILLER                  PIC X(4)      VALUE SPACES.              
           03  PR-GRAND-EX             PIC ZZZ,ZZZ,ZZZ,ZZ9.99.                  
           03  PR-GRAND-EX-SIGN        PIC X(2).                                
           03  FILLER                  PIC X(4)      VALUE SPACES.              
           03  PR-GRAND-TOT            PIC ZZZ,ZZZ,ZZZ,ZZ9.99.                  
           03  PR-GRAND-TOT-SIGN       PIC X(2).                                
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
                                                                                
       010-MAIN.                                                                
                                                                                
           OPEN INPUT  BP13K800                                                 
                       BP13K885                                                 
                OUTPUT BP13L117.                                                
                                                                                
           IF K800-STATUS NOT = 00 AND 97                                       
              DISPLAY 'OPENING ERROR K800  ' K800-STATUS                        
              PERFORM 020-CLOSE-ROUTINE.                                        
                                                                                
           IF K885-STATUS NOT = 00 AND 97                                       
              DISPLAY 'OPENING ERROR K885  ' K885-STATUS                        
              PERFORM 020-CLOSE-ROUTINE.                                        
                                                                                
           MOVE ZEROS  TO WS-COUNTERS.                                          
                                                                                
           PERFORM 100-INVALID-KEY-SECT.                                        
           PERFORM 200-READ-K800    THRU 200-EXIT.                              
           PERFORM 300-PROCESS-K800 THRU 300-EXIT                               
                       UNTIL WS-EOF-K800 = 'Y'.                                 
           PERFORM 250-READ-K885    THRU 250-EXIT.                              
           PERFORM 330-PROCESS-K885 THRU 330-EXIT                               
                       UNTIL WS-EOF-K885 = 'Y'.                                 
           PERFORM 400-PRINT-REPORT THRU 400-EXIT.                              
           PERFORM 020-CLOSE-ROUTINE.                                           
                                                                                
                                                                                
       020-CLOSE-ROUTINE.                                                       
           CLOSE BP13K800                                                       
                 BP13K885                                                       
                 BP13L117.                                                      
                                                                                
           IF K800-STATUS NOT = 00 AND 97                                       
              DISPLAY 'K800 CLOSING ERROR  ' K800-STATUS.                       
                                                                                
           IF K885-STATUS NOT = 00 AND 97                                       
              DISPLAY 'K885 CLOSING ERROR  ' K885-STATUS.                       
                                                                                
           STOP RUN.                                                            
                                                                                
                                                                                
       100-INVALID-KEY-SECT.                                                    
           MOVE LOW-VALUES   TO K800-NUM-REGN.                                  
           START BP13K800 KEY > K800-NUM-REGN.                                  
           IF K800-STATUS NOT = 00                                              
              DISPLAY 'START ERROR K800 = ' K800-STATUS                         
              PERFORM 020-CLOSE-ROUTINE.                                        
                                                                                
           MOVE LOW-VALUES   TO K885-KEY-FLD.                                   
           START BP13K885 KEY > K885-KEY-FLD.                                   
           IF K885-STATUS NOT = 00                                              
              DISPLAY 'START ERROR K885 = ' K885-STATUS                         
              PERFORM 020-CLOSE-ROUTINE.                                        
                                                                                
                                                                                
       200-READ-K800.                                                           
            READ BP13K800 NEXT                                                  
                          AT END MOVE 'Y' TO WS-EOF-K800                        
                          GO TO 200-EXIT.                                       
                                                                                
       200-EXIT.                                                                
            EXIT.                                                               
                                                                                
                                                                                
       250-READ-K885.                                                           
            READ BP13K885 NEXT                                                  
                          AT END MOVE 'Y' TO WS-EOF-K885                        
                          GO TO 250-EXIT.                                       
                                                                                
       250-EXIT.                                                                
            EXIT.                                                               
                                                                                
                                                                                
      **************************************************************            
      *   TO CHECK WHETHER THE ROOM TYPE IS EQUAL TO 'E' OR OTHERS *            
      **************************************************************            
                                                                                
       300-PROCESS-K800.                                                        
           PERFORM 350-CHECK-ROOM-TYPE THRU 350-EXIT.                           
           PERFORM 200-READ-K800       THRU 200-EXIT.                           
                                                                                
       300-EXIT.                                                                
           EXIT.                                                                
                                                                                
       330-PROCESS-K885.                                                        
           PERFORM 380-CHECK-ROOM-TYPE THRU 380-EXIT.                           
           PERFORM 250-READ-K885       THRU 250-EXIT.                           
                                                                                
       330-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
       350-CHECK-ROOM-TYPE.                                                     
                                                                                
           IF K800-AMT-BK-PAID NOT NUMERIC                                      
              MOVE ZEROES TO K800-AMT-BK-PAID.                                  
                                                                                
           IF K800-AMT-CD NOT NUMERIC                                           
              MOVE ZEROES TO K800-AMT-CD.                                       
                                                                                
           IF K800-AMT-SOC-DEBTOR NOT NUMERIC                                   
              MOVE ZEROES TO K800-AMT-SOC-DEBTOR.                               
                                                                                
           IF K800-AMT-SUSPENSE-CASH   NOT NUMERIC                              
              MOVE ZEROES TO K800-AMT-SUSPENSE-CASH.                            
                                                                                
           IF K800-AMT-SUSPENSE-CPF1   NOT NUMERIC                              
              MOVE ZEROES TO K800-AMT-SUSPENSE-CPF1.                            
                                                                                
           IF K800-AMT-SUSPENSE-CPF2   NOT NUMERIC                              
              MOVE ZEROES TO K800-AMT-SUSPENSE-CPF2.                            
                                                                                
           IF K800-AMT-SUSPENSE-CPF3   NOT NUMERIC                              
              MOVE ZEROES TO K800-AMT-SUSPENSE-CPF3.                            
                                                                                
           IF K800-AMT-SUSPENSE-CPF4   NOT NUMERIC                              
              MOVE ZEROES TO K800-AMT-SUSPENSE-CPF4.                            
                                                                                
           IF K800-AMT-REGN-DEPOSIT-CASH NOT NUMERIC                            
              MOVE ZEROES TO K800-AMT-REGN-DEPOSIT-CASH.                        
                                                                                
           IF K800-AMT-REGN-DEPOSIT-CPF1 NOT NUMERIC                            
              MOVE ZEROES TO K800-AMT-REGN-DEPOSIT-CPF1.                        
                                                                                
           IF K800-AMT-REGN-DEPOSIT-CPF2 NOT NUMERIC                            
              MOVE ZEROES TO K800-AMT-REGN-DEPOSIT-CPF2.                        
                                                                                
           IF K800-AMT-REGN-DEPOSIT-CPF3 NOT NUMERIC                            
              MOVE ZEROES TO K800-AMT-REGN-DEPOSIT-CPF3.                        
                                                                                
           IF K800-AMT-REGN-DEPOSIT-CPF4 NOT NUMERIC                            
              MOVE ZEROES TO K800-AMT-REGN-DEPOSIT-CPF4.                        
                                                                                
           IF K800-NUM-ROOM = 'E'                                               
              COMPUTE WS-BK-FEE-EX  =  WS-BK-FEE-EX + K800-AMT-BK-PAID          
              COMPUTE WS-CD-EX      =  WS-CD-EX     + K800-AMT-CD               
              COMPUTE WS-SOC-DEBTOR-EX =  WS-SOC-DEBTOR-EX +                    
                                          K800-AMT-SOC-DEBTOR                   
              COMPUTE WS-REGN-DEP-EX = WS-REGN-DEP-EX +                         
                                      K800-AMT-REGN-DEPOSIT-CASH +              
                                      K800-AMT-REGN-DEPOSIT-CPF1 +              
                                      K800-AMT-REGN-DEPOSIT-CPF2 +              
                                      K800-AMT-REGN-DEPOSIT-CPF3 +              
                                      K800-AMT-REGN-DEPOSIT-CPF4                
           ELSE                                                                 
              COMPUTE WS-BK-FEE-PA  =  WS-BK-FEE-PA + K800-AMT-BK-PAID          
              COMPUTE WS-CD-PA      =  WS-CD-PA     + K800-AMT-CD               
              COMPUTE WS-REGN-DEP-PA = WS-REGN-DEP-PA +                         
                                      K800-AMT-REGN-DEPOSIT-CASH +              
                                      K800-AMT-REGN-DEPOSIT-CPF1 +              
                                      K800-AMT-REGN-DEPOSIT-CPF2 +              
                                      K800-AMT-REGN-DEPOSIT-CPF3 +              
                                      K800-AMT-REGN-DEPOSIT-CPF4                
              COMPUTE WS-SOC-DEBTOR-PA =  WS-SOC-DEBTOR-PA +                    
                                          K800-AMT-SOC-DEBTOR.                  
                                                                                
       350-EXIT.                                                                
           EXIT.                                                                
                                                                                
       380-CHECK-ROOM-TYPE.                                                     
                                                                                
           IF K885-AMT-SUSPENSE  NOT NUMERIC                                    
              MOVE ZEROES TO K885-AMT-SUSPENSE.                                 
                                                                                
           IF K885-NUM-FLAT = 'E'                                               
              COMPUTE WS-SUSPENSE-EX   =  WS-SUSPENSE-EX +                      
                                          K885-AMT-SUSPENSE                     
           ELSE                                                                 
              COMPUTE WS-SUSPENSE-PA   =  WS-SUSPENSE-PA +                      
                                          K885-AMT-SUSPENSE.                    
                                                                                
              DISPLAY  ' SUSPENSE '       WS-SUSPENSE-PA .                      
              DISPLAY  ' SUSPENSE EX '    WS-SUSPENSE-EX .                      
                                                                                
       380-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
       400-PRINT-REPORT.                                                        
           PERFORM 500-PRINT-HEAD   THRU 500-EXIT.                              
           PERFORM 501-PRINT-DETAIL THRU 501-EXIT.                              
                                                                                
       400-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
       500-PRINT-HEAD.                                                          
           ADD    1                TO   WS-PAGE-NO.                             
           MOVE   WS-PAGE-NO       TO   PR-PAGE-NO.                             
           MOVE FUNCTION CURRENT-DATE TO WS-CURRENT-DATE.                       
           MOVE   WS-CURRENT-CC    TO   WS-CC.                                  
           MOVE   WS-CURRENT-YY    TO   WS-YY.                                  
           MOVE   WS-CURRENT-MM    TO   WS-MM.                                  
           MOVE   WS-CURRENT-DD    TO   WS-DD.                                  
           MOVE   WS-EDITED-DATE   TO   PR-DATE PR-SYS-DATE.                    
           WRITE  PRINT-REC-1 FROM PR-HEAD-1 AFTER PAGE.                        
           WRITE  PRINT-REC-1 FROM PR-HEAD-2 AFTER 2.                           
           WRITE  PRINT-REC-1 FROM PR-HEAD-3 AFTER 3.                           
           WRITE  PRINT-REC-1 FROM PR-HEAD-4 AFTER 1.                           
                                                                                
       500-EXIT.                                                                
           EXIT.                                                                
                                                                                
                                                                                
       501-PRINT-DETAIL.                                                        
           COMPUTE WS-TOT-BK-FEE  =  WS-BK-FEE-PA + WS-BK-FEE-EX.               
           COMPUTE WS-TOT-CD      =  WS-CD-PA + WS-CD-EX.                       
           COMPUTE WS-TOT-SOC-DEBTOR =  WS-SOC-DEBTOR-PA +                      
                                        WS-SOC-DEBTOR-EX.                       
           COMPUTE WS-TOT-SUSPENSE   =  WS-SUSPENSE-PA +                        
                                        WS-SUSPENSE-EX.                         
           COMPUTE WS-TOT-REGN-DEP   =  WS-REGN-DEP-PA +                        
                                        WS-REGN-DEP-EX.                         
           COMPUTE WS-GRAND-PA  =  WS-BK-FEE-PA  + WS-CD-PA  -                  
                                   WS-SOC-DEBTOR-PA +                           
                                   WS-SUSPENSE-PA +                             
                                   WS-REGN-DEP-PA.                              
           COMPUTE WS-GRAND-EX  =  WS-BK-FEE-EX  + WS-CD-EX  -                  
                                   WS-SOC-DEBTOR-EX +                           
                                   WS-SUSPENSE-EX +                             
                                   WS-REGN-DEP-EX.                              
           COMPUTE WS-GRAND-TOT =  WS-TOT-BK-FEE + WS-TOT-CD -                  
                                   WS-TOT-SOC-DEBTOR +                          
                                   WS-TOT-SUSPENSE +                            
                                   WS-TOT-REGN-DEP.                             
                                                                                
           IF WS-BK-FEE-PA > 0                                                  
              MOVE 'CR' TO PR-BK-FEE-PA-SIGN                                    
           ELSE                                                                 
              IF WS-BK-FEE-PA = 0                                               
                 MOVE '  ' TO PR-BK-FEE-PA-SIGN                                 
              ELSE                                                              
                 MOVE 'DR' TO PR-BK-FEE-PA-SIGN.                                
                                                                                
           IF WS-BK-FEE-EX > 0                                                  
              MOVE 'CR' TO PR-BK-FEE-EX-SIGN                                    
           ELSE                                                                 
              IF WS-BK-FEE-EX = 0                                               
                 MOVE '  ' TO PR-BK-FEE-EX-SIGN                                 
              ELSE                                                              
                 MOVE 'DR' TO PR-BK-FEE-EX-SIGN.                                
                                                                                
           IF WS-CD-PA > 0                                                      
              MOVE 'CR' TO PR-CD-PA-SIGN                                        
           ELSE                                                                 
              IF WS-CD-PA = 0                                                   
                 MOVE '  ' TO PR-CD-PA-SIGN                                     
              ELSE                                                              
                 MOVE 'DR' TO PR-CD-PA-SIGN.                                    
                                                                                
           IF WS-CD-EX > 0                                                      
              MOVE 'CR' TO PR-CD-EX-SIGN                                        
           ELSE                                                                 
              IF WS-CD-EX = 0                                                   
                 MOVE '  ' TO PR-CD-EX-SIGN                                     
              ELSE                                                              
                 MOVE 'DR' TO PR-CD-EX-SIGN.                                    
                                                                                
           IF WS-SOC-DEBTOR-PA > 0                                              
              MOVE 'DR' TO PR-SOC-PA-SIGN                                       
           ELSE                                                                 
              IF WS-SOC-DEBTOR-PA = 0                                           
                 MOVE '  ' TO PR-SOC-PA-SIGN                                    
              ELSE                                                              
                 MOVE 'CR' TO PR-SOC-PA-SIGN.                                   
                                                                                
           IF WS-SOC-DEBTOR-EX > 0                                              
              MOVE 'DR' TO PR-SOC-EX-SIGN                                       
           ELSE                                                                 
              IF WS-SOC-DEBTOR-EX = 0                                           
                 MOVE '  ' TO PR-SOC-EX-SIGN                                    
              ELSE                                                              
                 MOVE 'CR' TO PR-SOC-EX-SIGN.                                   
                                                                                
           IF WS-SUSPENSE-PA > 0                                                
              MOVE 'CR' TO PR-SUS-PA-SIGN                                       
           ELSE                                                                 
              IF WS-SUSPENSE-PA = 0                                             
                 MOVE '  ' TO PR-SUS-PA-SIGN                                    
              ELSE                                                              
                 MOVE 'DR' TO PR-SUS-PA-SIGN.                                   
                                                                                
           IF WS-SUSPENSE-EX > 0                                                
              MOVE 'CR' TO PR-SUS-EX-SIGN                                       
           ELSE                                                                 
              IF WS-SUSPENSE-EX = 0                                             
                 MOVE '  ' TO PR-SUS-EX-SIGN                                    
              ELSE                                                              
                 MOVE 'DR' TO PR-SUS-EX-SIGN.                                   
                                                                                
           IF WS-REGN-DEP-PA > 0                                                
              MOVE 'CR' TO PR-RDE-PA-SIGN                                       
           ELSE                                                                 
              IF WS-REGN-DEP-PA = 0                                             
                 MOVE '  ' TO PR-RDE-PA-SIGN                                    
              ELSE                                                              
                 MOVE 'DR' TO PR-RDE-PA-SIGN.                                   
                                                                                
           IF WS-REGN-DEP-EX > 0                                                
              MOVE 'CR' TO PR-RDE-EX-SIGN                                       
           ELSE                                                                 
              IF WS-REGN-DEP-EX = 0                                             
                 MOVE '  ' TO PR-RDE-EX-SIGN                                    
              ELSE                                                              
                 MOVE 'DR' TO PR-RDE-EX-SIGN.                                   
                                                                                
           IF WS-TOT-BK-FEE > 0                                                 
              MOVE 'CR' TO PR-TOT-BK-FEE-SIGN                                   
           ELSE                                                                 
              IF WS-TOT-BK-FEE = 0                                              
                 MOVE '  ' TO PR-TOT-BK-FEE-SIGN                                
              ELSE                                                              
                 MOVE 'DR' TO PR-TOT-BK-FEE-SIGN.                               
                                                                                
           IF WS-TOT-CD > 0                                                     
              MOVE 'CR' TO PR-TOT-CD-SIGN                                       
           ELSE                                                                 
              IF WS-TOT-CD = 0                                                  
                 MOVE '  ' TO PR-TOT-CD-SIGN                                    
              ELSE                                                              
                 MOVE 'DR' TO PR-TOT-CD-SIGN.                                   
                                                                                
           IF WS-TOT-SOC-DEBTOR > 0                                             
              MOVE 'DR' TO PR-TOT-SOC-SIGN                                      
           ELSE                                                                 
              IF WS-TOT-SOC-DEBTOR = 0                                          
                 MOVE '  ' TO PR-TOT-SOC-SIGN                                   
              ELSE                                                              
                 MOVE 'CR' TO PR-TOT-SOC-SIGN.                                  
                                                                                
           IF WS-TOT-SUSPENSE   > 0                                             
              MOVE 'CR' TO PR-TOT-SUS-SIGN                                      
           ELSE                                                                 
              IF WS-TOT-SUSPENSE   = 0                                          
                 MOVE '  ' TO PR-TOT-SUS-SIGN                                   
              ELSE                                                              
                 MOVE 'DR' TO PR-TOT-SUS-SIGN.                                  
                                                                                
           IF WS-TOT-REGN-DEP   > 0                                             
              MOVE 'CR' TO PR-TOT-RDE-SIGN                                      
           ELSE                                                                 
              IF WS-TOT-REGN-DEP   = 0                                          
                 MOVE '  ' TO PR-TOT-RDE-SIGN                                   
              ELSE                                                              
                 MOVE 'DR' TO PR-TOT-RDE-SIGN.                                  
                                                                                
           IF WS-GRAND-PA   > 0                                                 
              MOVE 'CR' TO PR-GRAND-PA-SIGN                                     
           ELSE                                                                 
              IF WS-GRAND-PA  = 0                                               
              MOVE '  ' TO PR-GRAND-PA-SIGN                                     
           ELSE                                                                 
              MOVE 'DR' TO PR-GRAND-PA-SIGN.                                    
                                                                                
           IF WS-GRAND-EX > 0                                                   
              MOVE 'CR' TO PR-GRAND-EX-SIGN                                     
           ELSE                                                                 
              IF WS-GRAND-EX = 0                                                
                 MOVE '  ' TO PR-GRAND-EX-SIGN                                  
              ELSE                                                              
                 MOVE 'DR' TO PR-GRAND-EX-SIGN.                                 
                                                                                
           IF WS-GRAND-TOT > 0                                                  
              MOVE 'CR' TO PR-GRAND-TOT-SIGN                                    
           ELSE                                                                 
              IF WS-GRAND-TOT = 0                                               
                 MOVE '  ' TO PR-GRAND-TOT-SIGN                                 
              ELSE                                                              
                 MOVE 'DR' TO PR-GRAND-TOT-SIGN.                                
                                                                                
           MOVE WS-BK-FEE-PA       TO  PR-BK-FEE-PA.                            
           MOVE WS-BK-FEE-EX       TO  PR-BK-FEE-EX.                            
           MOVE WS-CD-PA           TO  PR-CD-PA.                                
           MOVE WS-CD-EX           TO  PR-CD-EX.                                
           MOVE WS-SOC-DEBTOR-PA   TO  PR-SOC-DEBTOR-PA.                        
           MOVE WS-SOC-DEBTOR-EX   TO  PR-SOC-DEBTOR-EX.                        
           MOVE WS-SUSPENSE-PA     TO  PR-SUSPENSE-PA.                          
           MOVE WS-SUSPENSE-EX     TO  PR-SUSPENSE-EX.                          
           MOVE WS-REGN-DEP-PA     TO  PR-REGN-DEP-PA.                          
           MOVE WS-REGN-DEP-EX     TO  PR-REGN-DEP-EX.                          
           MOVE WS-TOT-BK-FEE      TO  PR-TOT-BK-FEE.                           
           MOVE WS-TOT-CD          TO  PR-TOT-CD.                               
           MOVE WS-TOT-SOC-DEBTOR  TO  PR-TOT-SOC-DEBTOR.                       
           MOVE WS-TOT-SUSPENSE    TO  PR-TOT-SUSPENSE.                         
           MOVE WS-TOT-REGN-DEP    TO  PR-TOT-REGN-DEP.                         
           MOVE WS-GRAND-PA        TO  PR-GRAND-PA.                             
           MOVE WS-GRAND-EX        TO  PR-GRAND-EX.                             
           MOVE WS-GRAND-TOT       TO  PR-GRAND-TOT.                            
                                                                                
           WRITE PRINT-REC-1 FROM  PR-HEAD-5  AFTER 2.                          
           WRITE PRINT-REC-1 FROM  PR-HEAD-6  AFTER 2.                          
           WRITE PRINT-REC-1 FROM  PR-HEAD-7  AFTER 2.                          
           WRITE PRINT-REC-1 FROM  PR-HEAD-8A AFTER 2.                          
           WRITE PRINT-REC-1 FROM  PR-HEAD-8B AFTER 2.                          
           WRITE PRINT-REC-1 FROM  PR-HEAD-8  AFTER 2.                          
           WRITE PRINT-REC-1 FROM  PR-HEAD-10 AFTER 1.                          
           WRITE PRINT-REC-1 FROM  PR-HEAD-9  AFTER 1.                          
                                                                                
       501-EXIT.                                                                
           EXIT.                                                                
                                                                                
